index,text
2935,this study proposes a novel deep convolutional cycle generative adversarial neural network dc cgan for estimating the hydraulic conductivity field k from the observed head field h the estimation of the heterogeneous hydraulic conductivity is apparently a high dimensional inverse problem although the indirect approach is popularly utilized to solve the inverse problem when compared with the indirect approach the direct approach can conduct the inversion task faster without any iteration process the key of the direct approach is to establish the inverse operator which maps the observed head to hydraulic conductivity however the complex inverse mapping relationship and high dimensional estimation have always challenged the direct approach owing to the potential ability to handle high dimensional images six residual blocks with convolutional kernels have been designed as the generators of dc cgan to capture the potential distribution for enhancing the generation of estimation images similar to the real hydraulic conductivity however the traditional adversarial pattern of one way generator and discriminator might suffer from the equifinality from different parameters therefore to alleviate the equifinality a cycle adversarial training pattern involving two generators and discriminators has been employed to supervise the map particularly this pattern performs a forward map from h to k and then the reconstructed k back to h the reconstruction process has been a supervision to the forward map process a hypothetical case with 40 30 unknown k values has been designed to evaluate the performance of dc cgan and the results indicate that dc cgan has achieved a desired generalization accuracy of mre of 9 25 and ssim of 0 85 with the swift running speed of 0 2 s which outperforms indirect approach the application of the proposed dc cgan shows that it can provide a reliable and fast high dimensional estimation task for the heterogenous hydraulic conductivity keywords inverse estimation generative adversarial neural network direct approach heterogeneous hydraulic conductivity data availability data will be made available on request 1 introduction the groundwater contamination has posed a threat to the safety of human drinking needs groundwater solute transport model is a popular tool for the groundwater assessment and treatment hydraulic conductivity plays a vital role in the concept of a groundwater solute transport model estimating the heterogeneous hydraulic conductivity from the hydraulic head at the observation points is a typical inverse problem which is commonly ill posed the existing inverse approaches can be divided into two categories nassar and ginn 2014 viz the direct and indirect approaches the indirect approach is performed by iteratively invoking the forward simulation model to match the simulation output at the monitoring points with observation data until it reaches a desired tolerance the classical examples involve the methods of simulation optimization leichombam and bhattacharjya 2019 li et al 2020 simulation assimilation ramgraber et al 2019 and simulation statistics zhang et al 2020 although these methods show a potential performance in complex inverse problems the long runtime hinders the practicability of the online estimation the direct approach focuses on establishing the inverse operator and utilizes it to calculate the response of the observation data when compared with the indirect approach the inverse process can be performed instantly once the inverse operator is obtained the advantage of the direct approach is evident in that no iterative matching process is needed for solving the inverse problem this can save a huge amount of computation time moreover the inverse operator of the direct approach can also tackle the issue of trapping into a local minimum a perennial drawback in employing the indirect approach commonly hydrological time series measurements such as hydraulic head temperature and concentration measured at specific locations are used as observation data theoretically if the observations are available it is feasible to generate observation field through some spatial interpolation methods such as kriging interpolation laloy et al 2021 therefore the inverse operator for estimating the hydraulic conductivity field from the hydraulic head field can be broadly described as an image to image regression task which apparently involves the estimation of high dimensional variables particularly the inverse operator to perform the hydraulic conductivity inverse task is a mapping from the hydraulic head field to the hydraulic conductivity field due to the robustness and generalization ability deep neural network dnn has been widely utilized in domains such as computer vision liu et al 2017 sun et al 2020 and natural language processing wu et al 2020 young et al 2018 to handle high dimensional problems compared with the traditional shallow learning methods such as support vector machine and extreme learning machine the deep layers structure with massive training parameters weights and biases enables dnn to characterize the complicated mapping relationship through the multiple nonlinear transformations of the abstract features schmidhuber 2015 recently dnn has been prominent in solving the image recognition or prediction task in the hydrogeology domain a myriad of empirical studies have proved that convolutional neural network cnn can remedy the issues of dimensionality enabling it to handle the high dimensional image mo et al 2019a have proposed a deep autoregressive neural network as a surrogate system for mapping the high dimensional inputs towards outputs in the case of the groundwater contaminant source identification zhou and tartakovsky 2021 have proposed a markov chain monte carlo with a deep convolutional neural network to estimate the unknown pollution features mo et al 2019b have utilized a deep convolutional encoder decoder network to evaluate a 2 500 dimensional stochastic permeability field zhou et al 2020 have explored a deep convolutional neural network to establish the complex relationship between the hydraulic conductivity field and the longitudinal macro dispersity in most of the studies the deep learning technique has been applied as a surrogate strategy to solve the high dimensional inverse problems in the domain of hydrogeology however the potential of the deep learning to perform as an inversion framework needs to be explored particularly the deep learning technique can be utilized to represent the inverse operator in the direct approach to solve the inverse problem generative adversarial network gan is a deep learning algorithm running under the framework of minmax two player game goodfellow et al 2020 the gan aims to study the potential distribution of the training samples and employ it to generate data it generally consists of a generative network to capture the distributions of the training data and a discriminative network to judge the similarity between the generated data and the real data zhu et al 2018 the gan is trained through the adversarial between the generative and discriminative networks until the adversarial reaches nash equilibrium which implies that the generative network can generate the analogous samples of the real ones for a groundwater parameter estimation task gpet the input of gan corresponds to observations of hydraulic head whereas output of that is the parameters to estimate that is to say the gan performs a map from observations to unknown variables however the groundwater system is commonly ill posedness which accompanies by similar observations of different combinations of parameters to estimate this might cause paradox estimation results when using traditional gan thus to alleviate equifinality from different parameters a circular supervision strategy must be introduced to supervise the map of gan recently variants of gan have the focus of attention owing to its promising performance for handling the image to image translation regression task for the 2d to 2d image translation case deep learning architectures such as disco gan kim et al 2017 and cycle gan zhu et al 2017 have been proposed within the influential pix2pix image to image translation framework isola et al 2017 zhu et al 2017 being different from the pix2pix a cgan adopts a bidirectional circulation generating structure instead of a one way generating structure to leverage the robustness of the model zhu et al 2017 particularly a cgan involves the process of generation from the origin domain to the target domain and vice versa saha et al 2021 you et al 2020 moreover a cgan utilizes a cycle consistency loss to supervise the training process godard et al 2017 zhou et al 2016 which realizes one to one mapping rather than many to one mapping this enables the cgan to free from the assumption of paired images when compared with pix2pix related investigations for using gans as direct approach framework to perform inverse estimation task in hydrogeology domain is still at a preliminary stage recently mosser et al 2017 utilized gan to reconstruct three dimensional porous media sun 2018 proposed a state parameter identification gan for learning bidirectional map relationship between parameter space and state space different investigations have established that gan is more suitable for generating high resolution images than the traditional cnn tran minh et al 2018 yi et al 2019 therefore to exploit the advantages of cnn and gan we have adopted a deep convolutional cycle generative adversarial neural network dc cgan to efficiently solve a high dimensional inverse problem the proposed dc cgan embrace inputs in the form of hydraulic head field and generates the hydraulic conductivity field as outputs particularly the dc cgan involves two elements viz the forward mapping and reconstruction mapping the forward mapping generates the hydraulic conductivity by employing the original hydraulic head whereas the reconstruction mapping generates the hydraulic head with the new generated hydraulic conductivity in the forward process we use a cycle consistency loss which can simultaneously guide the forward and reconstruction mapping process which constitutes a closed cycle six residual blocks were designed to alleviate the gradient vanishing brought by the deep layers in dc cgan moreover the dc cgan can be employed in other hydrogeology tasks the forward process is an inverse operator in function whereas the reconstruction process is a forward operator for a groundwater flow transport model this shows the potential of dc cgan to be utilized in various hydrogeology applications for e g the pattern prediction and surrogate task the dc cgan can perform the bidirectional mapping between the hydraulic conductivity field and the observed hydraulic head field our study has adopted the deep learning methods to formulate a deep convolutional cycle generative adversarial neural network to solve the high dimensional image to image regression task in the parameter estimation task moreover the cycle structure of dc cgan can perform a two way mapping task between the parameters and observed state in the hydrogeology domain particularly the forward mapping process can provide the inverse estimation results of parameters whereas the reverse mapping process can be utilized as a surrogate task for the prediction furthermore the closed cycle structure enhances the accuracy and robustness of the model and improve the interpretability of the deep learning methodology utilized in the hydrogeology domain this study proposes a novel deep learning structure and applies it as a direct approach framework for the fast inverse estimation of the high dimensional hydraulic conductivity field 2 methodology 2 1 groundwater flow numerical simulation model a groundwater flow numerical simulation model describes the basic law of groundwater movements the saturated groundwater flow in this study can be expressed by the following governing partial differential equation singh and datta 2006 1 x k h z 0 h x y k h z 0 h y w x y t μ h t x y γ t 0 where k represents the hydraulic conductivity h represents the water level above the sea level z 0 represents the elevation of the aquifer bottom above the sea level μ is the specific yield w is the source and sink term x and y represent the location distances along the respective cartesian coordinate axis and γ is the domain of groundwater flow the governing partial differential equation can be solved by the modflow module in the groundwater modeling system gms aquaveo llc we have assumed that the hydraulic conductivity is heterogenous which can be described as a gaussian random field k the correlation function c k has been adopted to describe the spatial correlation of the hydraulic conductivity zhang et al 2016 2 c k x y x y σ k 2 e x p x x λ x y y λ y where the coordinate x y represents a point that is different from x y σ k 2 represents the variance of hydraulic conductivity and λ x and λ y represent the correlation lengths cholesky decomposition has been adopted to describe k as 3 c k l u 4 k z k z l ξ where z x y k z represents the mean value of hydraulic conductivity k l is the upper triangular matrix generated by cholesky decomposition and ξ is a random number which satisfies the standard normal distribution 2 2 generative adversarial networks generative adversarial network gan is a type of artificial intelligence algorithms designed to learn the data distribution via the adversarial process between the two neural networks which are called generator and discriminator the gan consists of a generator g to capture the potential distribution and a discriminator d to evaluate the probability of a sample originating from a real dataset fig 1 in other words the generator concentrates on generation whereas the discriminator focuses on discrimination the key of generator g is to use a prior random noise variable p z z to transform into the data distribution m g z θ g represents a mapping operator to the data space where θ g represents the parameters of a dnn d m θ d is required to represent the probability of the generated samples m originating from the real samples the purpose of gan is to simultaneously minimize l o g 1 d g z and maximize l o g d m which can be expressed as a two player minmax game using the following value function goodfellow et al 2014 5 min g max d v d g e x p data x l o g d m e z p z z 1 l o g d g z theoretically the terms l o g d m and l o g 1 d g z can be trained to approach zero particularly for gpet the generator performs the map from observed head field h origin domain to hydraulic conductivity field k target domain the m o r represents the real samples of origin domain m t g represents the fake generative samples of target domain derived by the generator and m t r represents the real samples of target domain 2 3 deep convolutional cycle generative adversarial neural networks the most general gans must satisfy the assumption that the training samples are aligned hence the general gans are specialized in generating samples which are similar to the samples of the origin domain however in majority of cases the training samples are possibly unaligned which makes the generative task a mapping from origin domain to different target domain therefore the two cycle consistence loss has been introduced to supervise the samples of the two generators to be consistent to solve image to image regression tasks the generators and discriminators are commonly in terms of convolutional neural networks which brings about deep convolutional cycle generative adversarial neural networks dc cgan the loss can guide the dc cgan to transform from the origin domain to the target domain and vice versa fig 2 we take that the dc cgan for hydrogeology parameter estimation involves two mapping in generators as shown in fig 3 g e n e r a t o r 1 g h k and g e n e r a t o r 2 f k h where h represents the hydraulic head field and k represents the hydraulic conductivity field g and f corresponds to the forward and reconstruction processes respectively moreover two discriminators d k and d h have been designed to distinguish the fake generative k and fake generative h from the real k and h in particular to perform the mapping between k and h the generators involve three main blocks down sampling blocks residual blocks and up sampling blocks the down sampling blocks aim to capture core features of origin images the residual blocks focus on perform nonlinear transformation of these features the up sampling blocks focus on transforming the features derived by residual blocks into the target images the full training loss of dc cgan can be designed as two parts viz the adversarial and cycle consistence losses 2 3 1 adversarial loss for generator g and discriminator d k the adversarial loss can be expressed as 6 l gan g d k h k e k p data k log d k k e h p data h 1 log d h h where g has been trained to generated the fake samples analogous to the real ones through minimizing l gan g d k h k and making it difficult for the discriminator to distinguish them further f has been trained to distinguish the fake samples from the real ones through maximizing l gan g d k h k generally the dc cgan are trained with the adversarial relationship between g and d similarly for the generator f and discriminator d h the adversarial loss can be expressed as 7 l gan f d h k h e h p data h log d h h e k p data k 1 log d k k 2 3 2 cycle consistence loss theoretically only the adversarial loss can guide the transform from the origin domain to the target domain however owing to the massive learning parameters the gan can transform the input image to any of the output image thus a cycle consistence loss must be applied to further supervise the mapping henceforth while training every origin image h has been transformed to the target image k and the target image k must be reconstructed back to the origin image h the cycle consistence loss can be expressed as 8 l cyc g f e k p data k g f k k 1 e h p data h f g h h 1 generally the training objective can be expressed as 9 l g f d h d k l gan g d k h k l gan f d h k h λ l cyc g f where λ represents the relative importance of the cycle consistence loss towards the adversarial loss the g and f of dc cgan aim to minimize l g f d h d k whereas the dk and dh aim to maximize the loss 3 application 3 1 case overview we have designed a synthetic case to evaluate the performance of the proposed dc cgan for the hydrogeology parameter estimation the study domain has been selected as a rectangular area of 400 m 300 m within an unconfined aquifer the domain is spatially discretized by a grid with the resolution of 10 m fig 4 a the assumptions of the aquifer can be given as the north and south boundaries are no flow boundaries whereas the west and east boundaries are specific head boundaries the basic flow gradient is from the west to east and a steady state groundwater flow is simulated by using h t 0 on the right hand side of eq 1 for a synthetic case reference hydraulic conductivity field is allowed to evaluate the proposed framework the reference hydraulic conductivity can be described by a random heterogeneous field according to eqs 2 4 with the mean value k z 40 m d variance term σ k 10 correlation length of λ x 150 m a n d λ y 200 m detailed description can be found in table 1 for the synthetic case the observation data of twelve wells can be obtained by running numeric simulation model with the reference hydraulic conductivity field the observation data can be used to generated the corresponding hydraulic head field fig 4 b via kriging interpolation fig 5 presents the distribution of reference hydraulic conductivity field 3 2 training dataset for the deep learning dl method the large size of the training samples can improve the diversity thus further promoting dl to learn the hierarchical and abstract features theoretically larger samples in the dataset enhance the performance that dl can achieve however owing to the limit of the calculated cost of the acquirement samples 1000 groups of training samples have been designed for training the proposed dc cgan the hydraulic conductivity dataset has been randomly generated according to eqs 2 4 whereas the head dataset is generated by sequentially feeding the parameter dataset to the numeric simulation model particularly the hydraulic conductivity of each single grid must strictly fall into the prior ranges in table 1 to leverage the prominent performance of the proposed dc cgan to handle image like task the hydraulic conductivity dataset and the hydraulic head dataset are set in terms of the images with size 40 30 which are derived by simulation model the hydraulic head dataset and the hydraulic conductivity dataset have been concatenated into a training dataset for dc cgan similarly 200 groups of the test dataset have been generated independently to test the performance of dc cgan 3 3 training details the training of dc cgan has been performed on a pc with intel core i5 10400 cpu 2 90 ghz processor gtx1080ti gpu and 32 0 gb ram the core purpose of the dc cgan is to design the structure of the generator and discriminator for the generator down sampling up sampling and residual blocks have been designed to capture the hidden features of the images and transform them into the target domain it must be noted that the generator structure is similar to a variational autoencoder moreover generators 1 and 2 fig 6 share the identical structure but achieve different weights and biases following the training this phenomenon owes to the generator 1 performing a forward map from the hydraulic head to the hydraulic conductivity whereas the generator 2 performing a reconstruction map from the hydraulic conductivity to the hydraulic head fig 3 fig 7 shows the detailed topological structure of residual blocks of generators similarly the discriminators 1 and 2 fig 8 also share the identical structure but achieve different weights and bias following the training however the complicated structure definitely brings about deep layers which inevitably hinders the gradient from passing down therefore the six residual blocks have been adopted to tackle the vanishing gradient and broaden the learning capacity of dc cgan the experiment has been executed in the python environment and torch package has been utilized to build the network structure the layers presented in figs 6 8 have been quoted from the torch package paszke et al 2019 as table 2 presents the detailed demonstration of the following syntax can be found at https pytorch org docs stable nn html furthermore the adam optimizer has been utilized for the dc cgan training with respect to the hyperparameters λ in eq 9 has been set to 10 and the initial learning rate is set to 0 0002 and linearly decayed from 0 0002 to zero after 100 epochs besides the batch size being set to 1 the detailed core code can be found in the attachment the generators have been trained to minimize the objective function in eq 9 which aims to generate the fake images to cheat the discriminators on the contrary the discriminators have been trained to maximize the objective thus aiming to distinguish between the fake and real images 4 4 result and discussion the performance of dc cgan can be evaluated from two aspects viz the generalization accuracy and calculated burden in this section the root mean square error rmse and mean relative error mre have been employed as the measurement criteria to test the generalization accuracy the total computation time r tol has been introduced to reveal the calculated burden the total computation time must involve two elements viz the time required for model training r tra and the running time for generating the results according to 200 groups of the validation dataset r run 4 1 generalization accuracy as described earlier section 3 2 for dc cgan the generator 1 aims to manufacture the images similar to that of the hydraulic conductivity k in the training dataset and the generator 2 is trained to transform the generated hydraulic conductivity k back to hydraulic head h fig 9 presents the convergence profile of dc cgan which indicates dc cgan reached steady training performance after 400 th epoch according to fig 10 the visual comparison between the estimation k and h and the real k and h of validation dataset indicates that the dc cgan can achieve promising performance on the generating k from h furthermore fig 11 shows that the mre of dc cgan has been reduced with the increasing training dataset and finally reached 15 4 it indicates that the generalization ability of dc cgan can be enhanced with the increasing amounts of training dataset the size of the training dataset in the present study 1000 groups has been limited by the cost of the experiment however the potential of dc cgan can be fully achieved with the sample size of the training dataset such as 10 000 groups or 100 000 groups thus improving the generalization accuracy 4 2 performance of inversion task 4 2 1 non pumping scenario to further test the performance of dc cgan we utilize dc cgan and ensemble kalman filter enkf to perform one realization of inverse task we utilized 1000 realizations of origin simulation model as the ensemble of enkf to estimate k from the observed h in particular those realizations were accomplished by generating 1000 samples of k according to eq 4 and sequentially running simulation model with k it must be noted that the corresponding h was derived by running the simulation model with a reference k see section 3 1 table 3 shows the comparison of the total computation time of dc cgan and enkf typical indirect approach it can be observed that the total computation time of the two patterns have the same magnitude apparently the total calculated burden has not been significantly reduced by employing dc cgan since the model training process has consumed the bulk of the total time nevertheless the running time has been markedly reduced by the dc cgan together with mre structure similarity index structure ssim wang et al 1987 was utilized to evaluate the accuracy of estimated results fig 12 shows the visual comparison of reference estimated k derived by dc cgan and enkf in particular dc cgan with mre of 12 7 and ssim of 0 77 outperforms enkf with mre of 13 2 and ssim of 0 75 when using the indirect approaches such as the optimization and statistical approaches certain number of realizations of the simulation model are commonly required at every iteration however for indirect approaches when the required realizations of simulation model are massive for a real inverse estimation task the calculated burden must not be neglected the advantage of fast estimation using dc cgan becomes significant this was because the long time consuming iterations in indirect approaches are no longer required for a well trained dc cgan to estimate unknown parameters 4 2 2 pumping scenario however the hydraulic head field might be less sensitive on certain parts of hydraulic conductivity field because of the specific head boundaries therefore a scenario of pumping experiment was designed to alleviate the effect of specific head boundaries in particular four pumping wells fig 13 were put in grids 95 115 95 185 305 115 and 305 185 with pumping rate of 80 m3 d it must be noted that the pumping wells were also used for observation the hydraulic conductivity fields and hydraulic head fields dataset can be obtained according to the same process mentioned in section 3 3 the trained generator 1 g can be used to generate inversion estimation of hydraulic conductivity field k and the trained generator 2 f reconstructed the generated k back to h fig 13 presents the visual comparison of hydraulic head fields and estimation hydraulic conductivity fields with different numbers of wells for observation in particular with the number of wells increasing from 6 to 12 the accuracy of inversion estimation of hydraulic conductivity is substantially improved from ssim of 0 73 to that of 0 85 it can be revealed that dc cgan can benefit from sufficient observation data in general although there appear some vague estimations in certain parts the overall accuracy of hydraulic conductivity field is promising moreover when compared with the non pumping scenario the pumping wells can enhance the correlation between hydraulic conductivity and hydraulic head improving the quality of training samples of dc cgan to some degree in particular the pumping scenario evidently improves the inversion accuracy from 0 77 to 0 85 5 conclusion in the present study we utilized a deep learning method as the inverse operator of the direct approach to explore its application on high dimensional hydraulic conductivity field estimation task in terms of the image to image mapping task dc cgan has been proposed to conduct the hydraulic parameter estimation task particularly the convolutional blocks have been utilized to formulate the generator and discriminator of dc cgan moreover an adversarial training pattern has been introduced to capture the potential distribution to generate the images similar to the real ones furthermore a closed cycle adversarial pattern has been applied to supervise the reconstruction process from the target image k to the origin image h thus supervising the mapping from h to k furthermore the dc cgan shows a rising trend of the generalization accuracy with increasing training samples theoretically the dc cgan can achieve a better performance with more adequate training samples with respect to the burden of computation the running speed has been markedly faster when compared with the indirect approaches though the time of model training is relatively long furthermore once the model structure has been determined and saved the no iteration pattern of dc cgan can accelerate the inversion estimation process when compared with the indirect approaches of iteration pattern the proposed dc cgan can be a novel application on the direct approach to solve the high dimensional inverse estimation task the two way mapping strategy of dc cgan can be implemented in various scenarios in the hydrogeology domain viz the model surrogate task prediction task or multi pattern analysis such as the groundwater source contamination estimation its potential to combine with the alternative inverse or prediction methods needs to be explored in our future work credit authorship contribution statement zidong pan conceptualization writing original draft software methodology wenxi lu writing review editing methodology software han wang supervision validation yukun bai supervision validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the national natural science foundation of china no 41972252 and the national key research and development program of china no 2018yfc1800405 funding see the acknowledgments section competing interest none availability of data and materials available from the corresponding author upon reasonable request code availability the codes are available via researchgate https www researchgate net profile zidong pan ethics approval not applicable consent to participate not applicable consent for publication not applicable 
2935,this study proposes a novel deep convolutional cycle generative adversarial neural network dc cgan for estimating the hydraulic conductivity field k from the observed head field h the estimation of the heterogeneous hydraulic conductivity is apparently a high dimensional inverse problem although the indirect approach is popularly utilized to solve the inverse problem when compared with the indirect approach the direct approach can conduct the inversion task faster without any iteration process the key of the direct approach is to establish the inverse operator which maps the observed head to hydraulic conductivity however the complex inverse mapping relationship and high dimensional estimation have always challenged the direct approach owing to the potential ability to handle high dimensional images six residual blocks with convolutional kernels have been designed as the generators of dc cgan to capture the potential distribution for enhancing the generation of estimation images similar to the real hydraulic conductivity however the traditional adversarial pattern of one way generator and discriminator might suffer from the equifinality from different parameters therefore to alleviate the equifinality a cycle adversarial training pattern involving two generators and discriminators has been employed to supervise the map particularly this pattern performs a forward map from h to k and then the reconstructed k back to h the reconstruction process has been a supervision to the forward map process a hypothetical case with 40 30 unknown k values has been designed to evaluate the performance of dc cgan and the results indicate that dc cgan has achieved a desired generalization accuracy of mre of 9 25 and ssim of 0 85 with the swift running speed of 0 2 s which outperforms indirect approach the application of the proposed dc cgan shows that it can provide a reliable and fast high dimensional estimation task for the heterogenous hydraulic conductivity keywords inverse estimation generative adversarial neural network direct approach heterogeneous hydraulic conductivity data availability data will be made available on request 1 introduction the groundwater contamination has posed a threat to the safety of human drinking needs groundwater solute transport model is a popular tool for the groundwater assessment and treatment hydraulic conductivity plays a vital role in the concept of a groundwater solute transport model estimating the heterogeneous hydraulic conductivity from the hydraulic head at the observation points is a typical inverse problem which is commonly ill posed the existing inverse approaches can be divided into two categories nassar and ginn 2014 viz the direct and indirect approaches the indirect approach is performed by iteratively invoking the forward simulation model to match the simulation output at the monitoring points with observation data until it reaches a desired tolerance the classical examples involve the methods of simulation optimization leichombam and bhattacharjya 2019 li et al 2020 simulation assimilation ramgraber et al 2019 and simulation statistics zhang et al 2020 although these methods show a potential performance in complex inverse problems the long runtime hinders the practicability of the online estimation the direct approach focuses on establishing the inverse operator and utilizes it to calculate the response of the observation data when compared with the indirect approach the inverse process can be performed instantly once the inverse operator is obtained the advantage of the direct approach is evident in that no iterative matching process is needed for solving the inverse problem this can save a huge amount of computation time moreover the inverse operator of the direct approach can also tackle the issue of trapping into a local minimum a perennial drawback in employing the indirect approach commonly hydrological time series measurements such as hydraulic head temperature and concentration measured at specific locations are used as observation data theoretically if the observations are available it is feasible to generate observation field through some spatial interpolation methods such as kriging interpolation laloy et al 2021 therefore the inverse operator for estimating the hydraulic conductivity field from the hydraulic head field can be broadly described as an image to image regression task which apparently involves the estimation of high dimensional variables particularly the inverse operator to perform the hydraulic conductivity inverse task is a mapping from the hydraulic head field to the hydraulic conductivity field due to the robustness and generalization ability deep neural network dnn has been widely utilized in domains such as computer vision liu et al 2017 sun et al 2020 and natural language processing wu et al 2020 young et al 2018 to handle high dimensional problems compared with the traditional shallow learning methods such as support vector machine and extreme learning machine the deep layers structure with massive training parameters weights and biases enables dnn to characterize the complicated mapping relationship through the multiple nonlinear transformations of the abstract features schmidhuber 2015 recently dnn has been prominent in solving the image recognition or prediction task in the hydrogeology domain a myriad of empirical studies have proved that convolutional neural network cnn can remedy the issues of dimensionality enabling it to handle the high dimensional image mo et al 2019a have proposed a deep autoregressive neural network as a surrogate system for mapping the high dimensional inputs towards outputs in the case of the groundwater contaminant source identification zhou and tartakovsky 2021 have proposed a markov chain monte carlo with a deep convolutional neural network to estimate the unknown pollution features mo et al 2019b have utilized a deep convolutional encoder decoder network to evaluate a 2 500 dimensional stochastic permeability field zhou et al 2020 have explored a deep convolutional neural network to establish the complex relationship between the hydraulic conductivity field and the longitudinal macro dispersity in most of the studies the deep learning technique has been applied as a surrogate strategy to solve the high dimensional inverse problems in the domain of hydrogeology however the potential of the deep learning to perform as an inversion framework needs to be explored particularly the deep learning technique can be utilized to represent the inverse operator in the direct approach to solve the inverse problem generative adversarial network gan is a deep learning algorithm running under the framework of minmax two player game goodfellow et al 2020 the gan aims to study the potential distribution of the training samples and employ it to generate data it generally consists of a generative network to capture the distributions of the training data and a discriminative network to judge the similarity between the generated data and the real data zhu et al 2018 the gan is trained through the adversarial between the generative and discriminative networks until the adversarial reaches nash equilibrium which implies that the generative network can generate the analogous samples of the real ones for a groundwater parameter estimation task gpet the input of gan corresponds to observations of hydraulic head whereas output of that is the parameters to estimate that is to say the gan performs a map from observations to unknown variables however the groundwater system is commonly ill posedness which accompanies by similar observations of different combinations of parameters to estimate this might cause paradox estimation results when using traditional gan thus to alleviate equifinality from different parameters a circular supervision strategy must be introduced to supervise the map of gan recently variants of gan have the focus of attention owing to its promising performance for handling the image to image translation regression task for the 2d to 2d image translation case deep learning architectures such as disco gan kim et al 2017 and cycle gan zhu et al 2017 have been proposed within the influential pix2pix image to image translation framework isola et al 2017 zhu et al 2017 being different from the pix2pix a cgan adopts a bidirectional circulation generating structure instead of a one way generating structure to leverage the robustness of the model zhu et al 2017 particularly a cgan involves the process of generation from the origin domain to the target domain and vice versa saha et al 2021 you et al 2020 moreover a cgan utilizes a cycle consistency loss to supervise the training process godard et al 2017 zhou et al 2016 which realizes one to one mapping rather than many to one mapping this enables the cgan to free from the assumption of paired images when compared with pix2pix related investigations for using gans as direct approach framework to perform inverse estimation task in hydrogeology domain is still at a preliminary stage recently mosser et al 2017 utilized gan to reconstruct three dimensional porous media sun 2018 proposed a state parameter identification gan for learning bidirectional map relationship between parameter space and state space different investigations have established that gan is more suitable for generating high resolution images than the traditional cnn tran minh et al 2018 yi et al 2019 therefore to exploit the advantages of cnn and gan we have adopted a deep convolutional cycle generative adversarial neural network dc cgan to efficiently solve a high dimensional inverse problem the proposed dc cgan embrace inputs in the form of hydraulic head field and generates the hydraulic conductivity field as outputs particularly the dc cgan involves two elements viz the forward mapping and reconstruction mapping the forward mapping generates the hydraulic conductivity by employing the original hydraulic head whereas the reconstruction mapping generates the hydraulic head with the new generated hydraulic conductivity in the forward process we use a cycle consistency loss which can simultaneously guide the forward and reconstruction mapping process which constitutes a closed cycle six residual blocks were designed to alleviate the gradient vanishing brought by the deep layers in dc cgan moreover the dc cgan can be employed in other hydrogeology tasks the forward process is an inverse operator in function whereas the reconstruction process is a forward operator for a groundwater flow transport model this shows the potential of dc cgan to be utilized in various hydrogeology applications for e g the pattern prediction and surrogate task the dc cgan can perform the bidirectional mapping between the hydraulic conductivity field and the observed hydraulic head field our study has adopted the deep learning methods to formulate a deep convolutional cycle generative adversarial neural network to solve the high dimensional image to image regression task in the parameter estimation task moreover the cycle structure of dc cgan can perform a two way mapping task between the parameters and observed state in the hydrogeology domain particularly the forward mapping process can provide the inverse estimation results of parameters whereas the reverse mapping process can be utilized as a surrogate task for the prediction furthermore the closed cycle structure enhances the accuracy and robustness of the model and improve the interpretability of the deep learning methodology utilized in the hydrogeology domain this study proposes a novel deep learning structure and applies it as a direct approach framework for the fast inverse estimation of the high dimensional hydraulic conductivity field 2 methodology 2 1 groundwater flow numerical simulation model a groundwater flow numerical simulation model describes the basic law of groundwater movements the saturated groundwater flow in this study can be expressed by the following governing partial differential equation singh and datta 2006 1 x k h z 0 h x y k h z 0 h y w x y t μ h t x y γ t 0 where k represents the hydraulic conductivity h represents the water level above the sea level z 0 represents the elevation of the aquifer bottom above the sea level μ is the specific yield w is the source and sink term x and y represent the location distances along the respective cartesian coordinate axis and γ is the domain of groundwater flow the governing partial differential equation can be solved by the modflow module in the groundwater modeling system gms aquaveo llc we have assumed that the hydraulic conductivity is heterogenous which can be described as a gaussian random field k the correlation function c k has been adopted to describe the spatial correlation of the hydraulic conductivity zhang et al 2016 2 c k x y x y σ k 2 e x p x x λ x y y λ y where the coordinate x y represents a point that is different from x y σ k 2 represents the variance of hydraulic conductivity and λ x and λ y represent the correlation lengths cholesky decomposition has been adopted to describe k as 3 c k l u 4 k z k z l ξ where z x y k z represents the mean value of hydraulic conductivity k l is the upper triangular matrix generated by cholesky decomposition and ξ is a random number which satisfies the standard normal distribution 2 2 generative adversarial networks generative adversarial network gan is a type of artificial intelligence algorithms designed to learn the data distribution via the adversarial process between the two neural networks which are called generator and discriminator the gan consists of a generator g to capture the potential distribution and a discriminator d to evaluate the probability of a sample originating from a real dataset fig 1 in other words the generator concentrates on generation whereas the discriminator focuses on discrimination the key of generator g is to use a prior random noise variable p z z to transform into the data distribution m g z θ g represents a mapping operator to the data space where θ g represents the parameters of a dnn d m θ d is required to represent the probability of the generated samples m originating from the real samples the purpose of gan is to simultaneously minimize l o g 1 d g z and maximize l o g d m which can be expressed as a two player minmax game using the following value function goodfellow et al 2014 5 min g max d v d g e x p data x l o g d m e z p z z 1 l o g d g z theoretically the terms l o g d m and l o g 1 d g z can be trained to approach zero particularly for gpet the generator performs the map from observed head field h origin domain to hydraulic conductivity field k target domain the m o r represents the real samples of origin domain m t g represents the fake generative samples of target domain derived by the generator and m t r represents the real samples of target domain 2 3 deep convolutional cycle generative adversarial neural networks the most general gans must satisfy the assumption that the training samples are aligned hence the general gans are specialized in generating samples which are similar to the samples of the origin domain however in majority of cases the training samples are possibly unaligned which makes the generative task a mapping from origin domain to different target domain therefore the two cycle consistence loss has been introduced to supervise the samples of the two generators to be consistent to solve image to image regression tasks the generators and discriminators are commonly in terms of convolutional neural networks which brings about deep convolutional cycle generative adversarial neural networks dc cgan the loss can guide the dc cgan to transform from the origin domain to the target domain and vice versa fig 2 we take that the dc cgan for hydrogeology parameter estimation involves two mapping in generators as shown in fig 3 g e n e r a t o r 1 g h k and g e n e r a t o r 2 f k h where h represents the hydraulic head field and k represents the hydraulic conductivity field g and f corresponds to the forward and reconstruction processes respectively moreover two discriminators d k and d h have been designed to distinguish the fake generative k and fake generative h from the real k and h in particular to perform the mapping between k and h the generators involve three main blocks down sampling blocks residual blocks and up sampling blocks the down sampling blocks aim to capture core features of origin images the residual blocks focus on perform nonlinear transformation of these features the up sampling blocks focus on transforming the features derived by residual blocks into the target images the full training loss of dc cgan can be designed as two parts viz the adversarial and cycle consistence losses 2 3 1 adversarial loss for generator g and discriminator d k the adversarial loss can be expressed as 6 l gan g d k h k e k p data k log d k k e h p data h 1 log d h h where g has been trained to generated the fake samples analogous to the real ones through minimizing l gan g d k h k and making it difficult for the discriminator to distinguish them further f has been trained to distinguish the fake samples from the real ones through maximizing l gan g d k h k generally the dc cgan are trained with the adversarial relationship between g and d similarly for the generator f and discriminator d h the adversarial loss can be expressed as 7 l gan f d h k h e h p data h log d h h e k p data k 1 log d k k 2 3 2 cycle consistence loss theoretically only the adversarial loss can guide the transform from the origin domain to the target domain however owing to the massive learning parameters the gan can transform the input image to any of the output image thus a cycle consistence loss must be applied to further supervise the mapping henceforth while training every origin image h has been transformed to the target image k and the target image k must be reconstructed back to the origin image h the cycle consistence loss can be expressed as 8 l cyc g f e k p data k g f k k 1 e h p data h f g h h 1 generally the training objective can be expressed as 9 l g f d h d k l gan g d k h k l gan f d h k h λ l cyc g f where λ represents the relative importance of the cycle consistence loss towards the adversarial loss the g and f of dc cgan aim to minimize l g f d h d k whereas the dk and dh aim to maximize the loss 3 application 3 1 case overview we have designed a synthetic case to evaluate the performance of the proposed dc cgan for the hydrogeology parameter estimation the study domain has been selected as a rectangular area of 400 m 300 m within an unconfined aquifer the domain is spatially discretized by a grid with the resolution of 10 m fig 4 a the assumptions of the aquifer can be given as the north and south boundaries are no flow boundaries whereas the west and east boundaries are specific head boundaries the basic flow gradient is from the west to east and a steady state groundwater flow is simulated by using h t 0 on the right hand side of eq 1 for a synthetic case reference hydraulic conductivity field is allowed to evaluate the proposed framework the reference hydraulic conductivity can be described by a random heterogeneous field according to eqs 2 4 with the mean value k z 40 m d variance term σ k 10 correlation length of λ x 150 m a n d λ y 200 m detailed description can be found in table 1 for the synthetic case the observation data of twelve wells can be obtained by running numeric simulation model with the reference hydraulic conductivity field the observation data can be used to generated the corresponding hydraulic head field fig 4 b via kriging interpolation fig 5 presents the distribution of reference hydraulic conductivity field 3 2 training dataset for the deep learning dl method the large size of the training samples can improve the diversity thus further promoting dl to learn the hierarchical and abstract features theoretically larger samples in the dataset enhance the performance that dl can achieve however owing to the limit of the calculated cost of the acquirement samples 1000 groups of training samples have been designed for training the proposed dc cgan the hydraulic conductivity dataset has been randomly generated according to eqs 2 4 whereas the head dataset is generated by sequentially feeding the parameter dataset to the numeric simulation model particularly the hydraulic conductivity of each single grid must strictly fall into the prior ranges in table 1 to leverage the prominent performance of the proposed dc cgan to handle image like task the hydraulic conductivity dataset and the hydraulic head dataset are set in terms of the images with size 40 30 which are derived by simulation model the hydraulic head dataset and the hydraulic conductivity dataset have been concatenated into a training dataset for dc cgan similarly 200 groups of the test dataset have been generated independently to test the performance of dc cgan 3 3 training details the training of dc cgan has been performed on a pc with intel core i5 10400 cpu 2 90 ghz processor gtx1080ti gpu and 32 0 gb ram the core purpose of the dc cgan is to design the structure of the generator and discriminator for the generator down sampling up sampling and residual blocks have been designed to capture the hidden features of the images and transform them into the target domain it must be noted that the generator structure is similar to a variational autoencoder moreover generators 1 and 2 fig 6 share the identical structure but achieve different weights and biases following the training this phenomenon owes to the generator 1 performing a forward map from the hydraulic head to the hydraulic conductivity whereas the generator 2 performing a reconstruction map from the hydraulic conductivity to the hydraulic head fig 3 fig 7 shows the detailed topological structure of residual blocks of generators similarly the discriminators 1 and 2 fig 8 also share the identical structure but achieve different weights and bias following the training however the complicated structure definitely brings about deep layers which inevitably hinders the gradient from passing down therefore the six residual blocks have been adopted to tackle the vanishing gradient and broaden the learning capacity of dc cgan the experiment has been executed in the python environment and torch package has been utilized to build the network structure the layers presented in figs 6 8 have been quoted from the torch package paszke et al 2019 as table 2 presents the detailed demonstration of the following syntax can be found at https pytorch org docs stable nn html furthermore the adam optimizer has been utilized for the dc cgan training with respect to the hyperparameters λ in eq 9 has been set to 10 and the initial learning rate is set to 0 0002 and linearly decayed from 0 0002 to zero after 100 epochs besides the batch size being set to 1 the detailed core code can be found in the attachment the generators have been trained to minimize the objective function in eq 9 which aims to generate the fake images to cheat the discriminators on the contrary the discriminators have been trained to maximize the objective thus aiming to distinguish between the fake and real images 4 4 result and discussion the performance of dc cgan can be evaluated from two aspects viz the generalization accuracy and calculated burden in this section the root mean square error rmse and mean relative error mre have been employed as the measurement criteria to test the generalization accuracy the total computation time r tol has been introduced to reveal the calculated burden the total computation time must involve two elements viz the time required for model training r tra and the running time for generating the results according to 200 groups of the validation dataset r run 4 1 generalization accuracy as described earlier section 3 2 for dc cgan the generator 1 aims to manufacture the images similar to that of the hydraulic conductivity k in the training dataset and the generator 2 is trained to transform the generated hydraulic conductivity k back to hydraulic head h fig 9 presents the convergence profile of dc cgan which indicates dc cgan reached steady training performance after 400 th epoch according to fig 10 the visual comparison between the estimation k and h and the real k and h of validation dataset indicates that the dc cgan can achieve promising performance on the generating k from h furthermore fig 11 shows that the mre of dc cgan has been reduced with the increasing training dataset and finally reached 15 4 it indicates that the generalization ability of dc cgan can be enhanced with the increasing amounts of training dataset the size of the training dataset in the present study 1000 groups has been limited by the cost of the experiment however the potential of dc cgan can be fully achieved with the sample size of the training dataset such as 10 000 groups or 100 000 groups thus improving the generalization accuracy 4 2 performance of inversion task 4 2 1 non pumping scenario to further test the performance of dc cgan we utilize dc cgan and ensemble kalman filter enkf to perform one realization of inverse task we utilized 1000 realizations of origin simulation model as the ensemble of enkf to estimate k from the observed h in particular those realizations were accomplished by generating 1000 samples of k according to eq 4 and sequentially running simulation model with k it must be noted that the corresponding h was derived by running the simulation model with a reference k see section 3 1 table 3 shows the comparison of the total computation time of dc cgan and enkf typical indirect approach it can be observed that the total computation time of the two patterns have the same magnitude apparently the total calculated burden has not been significantly reduced by employing dc cgan since the model training process has consumed the bulk of the total time nevertheless the running time has been markedly reduced by the dc cgan together with mre structure similarity index structure ssim wang et al 1987 was utilized to evaluate the accuracy of estimated results fig 12 shows the visual comparison of reference estimated k derived by dc cgan and enkf in particular dc cgan with mre of 12 7 and ssim of 0 77 outperforms enkf with mre of 13 2 and ssim of 0 75 when using the indirect approaches such as the optimization and statistical approaches certain number of realizations of the simulation model are commonly required at every iteration however for indirect approaches when the required realizations of simulation model are massive for a real inverse estimation task the calculated burden must not be neglected the advantage of fast estimation using dc cgan becomes significant this was because the long time consuming iterations in indirect approaches are no longer required for a well trained dc cgan to estimate unknown parameters 4 2 2 pumping scenario however the hydraulic head field might be less sensitive on certain parts of hydraulic conductivity field because of the specific head boundaries therefore a scenario of pumping experiment was designed to alleviate the effect of specific head boundaries in particular four pumping wells fig 13 were put in grids 95 115 95 185 305 115 and 305 185 with pumping rate of 80 m3 d it must be noted that the pumping wells were also used for observation the hydraulic conductivity fields and hydraulic head fields dataset can be obtained according to the same process mentioned in section 3 3 the trained generator 1 g can be used to generate inversion estimation of hydraulic conductivity field k and the trained generator 2 f reconstructed the generated k back to h fig 13 presents the visual comparison of hydraulic head fields and estimation hydraulic conductivity fields with different numbers of wells for observation in particular with the number of wells increasing from 6 to 12 the accuracy of inversion estimation of hydraulic conductivity is substantially improved from ssim of 0 73 to that of 0 85 it can be revealed that dc cgan can benefit from sufficient observation data in general although there appear some vague estimations in certain parts the overall accuracy of hydraulic conductivity field is promising moreover when compared with the non pumping scenario the pumping wells can enhance the correlation between hydraulic conductivity and hydraulic head improving the quality of training samples of dc cgan to some degree in particular the pumping scenario evidently improves the inversion accuracy from 0 77 to 0 85 5 conclusion in the present study we utilized a deep learning method as the inverse operator of the direct approach to explore its application on high dimensional hydraulic conductivity field estimation task in terms of the image to image mapping task dc cgan has been proposed to conduct the hydraulic parameter estimation task particularly the convolutional blocks have been utilized to formulate the generator and discriminator of dc cgan moreover an adversarial training pattern has been introduced to capture the potential distribution to generate the images similar to the real ones furthermore a closed cycle adversarial pattern has been applied to supervise the reconstruction process from the target image k to the origin image h thus supervising the mapping from h to k furthermore the dc cgan shows a rising trend of the generalization accuracy with increasing training samples theoretically the dc cgan can achieve a better performance with more adequate training samples with respect to the burden of computation the running speed has been markedly faster when compared with the indirect approaches though the time of model training is relatively long furthermore once the model structure has been determined and saved the no iteration pattern of dc cgan can accelerate the inversion estimation process when compared with the indirect approaches of iteration pattern the proposed dc cgan can be a novel application on the direct approach to solve the high dimensional inverse estimation task the two way mapping strategy of dc cgan can be implemented in various scenarios in the hydrogeology domain viz the model surrogate task prediction task or multi pattern analysis such as the groundwater source contamination estimation its potential to combine with the alternative inverse or prediction methods needs to be explored in our future work credit authorship contribution statement zidong pan conceptualization writing original draft software methodology wenxi lu writing review editing methodology software han wang supervision validation yukun bai supervision validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the national natural science foundation of china no 41972252 and the national key research and development program of china no 2018yfc1800405 funding see the acknowledgments section competing interest none availability of data and materials available from the corresponding author upon reasonable request code availability the codes are available via researchgate https www researchgate net profile zidong pan ethics approval not applicable consent to participate not applicable consent for publication not applicable 
2936,the soil water characteristic curve swcc is an essential function for unsaturated soils and describes the relationship between soil suction and water content the swcc is a prerequisite for modeling soil water temperature and solute transport in hydrology as a classical and widely used model of the swcc the arya paris ap model 1981 uses a particle size distribution psd to estimate the swcc and the psd is a parimary property of soils and is easy to obtain by a soil mechanical test hence compared with other models the ap model is more convenient and accurate for describing the swcc in the ap model a shape coefficient is proposed to describe complex pore structures and correct tortuous pore lengths however the shape coefficient changes with the mass of the soil samples which is a factual and fatal defect for the ap model to solve this problem we established a superior arya paris sap model to make the shape coefficient independent of the mass of the soil samples in the sap model the pore length in each divided fraction is the summation of the equivalent diameter of every soil particle in the fraction and the diameter amplification factor is denoted by the shape coefficient the total number of soil particles in each fraction is unchangeable in the sap model but is growing in the ap model thus unlike the ap model the sap model has a definite physical meaning and the swccs predicted by the sap model are closer to the observed data than the ap model therefore the sap model provides a better alternative for predicting swccs and provides new insight into the hydrodynamic characteristics of unsaturated soils moreover a continuous sap csap model can be obtained by a continuous function to describe the psd which widely expands the application of the sap keywords soil water characteristic curve arya paris model particle size distribution shape coefficient mass of soil sample data availability data will be made available on request 1 introduction in hydrology the soil water characteristic curve swcc is one of the most basic concepts defining the relationship between soil suction and water content in unsaturated soils and is probably the most essential soil water property of unsaturated soils karup et al 2016 antinoro et al 2014 mohammadi and vanclooster 2011 the swcc can directly or indirectly describe other valuable properties of unsaturated soils such as permeability strength and deformation xu et al 2016 wang et al 2016 it is also a fundamental tool for modeling soil water temperature and solute transport in unsaturated soils chang et al 2019 buczko and gerke 2005 van genuchten 1980 therefore the importance of the swcc has spurred increasing interest in this subject it is always time consuming and expensive to experimentally acquire the swcc thus a mathematical model of the swcc from available soil properties is one of the most feasible alternatives and can also improve the understanding of the water transport process cotet et al 2014 arya and heitman 2015 these existing mathematical models can be generally divided into two categories empirical models van genuchten 1980 fredlund and xing 1994 wang et al 2019 and theoretical models chen et al 2021 xu 2004 mohammadi and meskini vishkaee 2012 the empirical model is often obtained by fitting many scattered measured data forming a continuous function it can fit experimental data well if enough parameters are used van genuchten 1980 bordoni et al 2017 however these empirical models rely on the database used for model calibration and testing mohammadi and meskini vishkaee 2012 and their fitting parameters are meaningless in physics thus many theoretical models of the swcc have been proposed based on material properties such as mineral contents and types soil density and pore shape and size xu 2004 saha and sekharan 2021 compared with empirical models these models can generally reflect the effect of soil properties on the swcc and are independent to plenty of experimental data however the particle size distribution psd a primary property of soils is not taken into account in these models it can describe the soil structure and pore characteristics and is an essential physical index used to research the hydraulic properties of soils cosby et al 1984 therefore considering the influence of the psd on the soil hydraulic properties several swccs were built using the relationships between particle radius and pore radius aubertin et al 2003 haverkamp and parlange 1986 arya and paris 1981 nimmo 1997 bird et al 2000 mohammadi and vanclooster 2011 among these models the ap model is a widely used estimation and was cited in over 1600 published papers nimmo et al 2007 arya et al 2008 li et al 2016 karup et al 2016 wang et al 2018 campos guereta et al 2021 the ap model is theoretically deduced based on the psd and pore ratio of soils arya and paris 1981 in which the pore radius is calculated based on the assumption that the pore is cylindrical the pore height is determined by multiplying the accumulated length of the soil particle with a shape coefficient the shape coefficient is used to approximate the pore irregularity or tortuosity of soils by increasing the number of soil particles its value was determined by a fixed soil mass campos guereta et al 2021 in addition arya et al 1999 2008 proposed a function for the shape coefficient proportional to the number of soil particles since the number of soil particles depends on the mass of the soil samples the shape coefficient changes with the mass of the soil samples in other words the swcc is affected by the mass of the soil samples in the ap model which is a fatal defect to date none of the published literature has provided a reasonable explanation for the influence of the total mass of samples on the shape coefficient and subsequent swcc therefore the reliability of the ap model deserves further study to solve the above defect in the ap model this study proposes a new method to estimate the pore length of soils and establishes a superior ap sap model based on the psd and pore characteristics of soils in the sap model the shape coefficient is used to express the average enlarged ratio of all soil particles to approximate the complexity of the pores the pore length of soils is equivalent to a uniformly enlarged diameter of each particle rather than an increasing number of soil particles as a result a new relationship between the particle radius and pore radius can be determined using the pore ratio of soils according to the relationship and the young laplace equation in unsaturated soil mechanics the swcc is predicted in the sap model which is independent of the total mass of the soil sample soil data in the ap model were borrowed to calibrate the accuracy of the sap model for different masses of soil samples moreover the sap has been further verified by other 12 groups of measured swccs of clay silt and sand in these comparisons the sap shows better agreement with the measured data than the ap model in the discussion section an optimization method of the sap model is discussed and a continuous sap csap model is also proposed in this study the sap model describing the complexity of the pores is more reasonable in physical significance and convenient for calculation therefore the sap model can be directly used to study water transport in unsaturated soils and provides new insight into the hydrodynamic characteristics of unsaturated soils 2 brief description of the ap model the ap model is theoretically deduced based on the psd and pore ratio of soils in which the shape coefficient is used to describe the pore complexity of soils the main idea of the ap model is demonstrated in fig 1 the psd of a soil sample was divided into n fractions according to the particle size the soil properties of each fraction were assumed to be equal to those in the natural structure state assuming the presence of spherical particles and cylindrical pores in soils the particle volume v s i and pore volume v v i in the i th range can be expressed as follows 1 v s i n i 4 π r i 3 3 m i ρ s and 2 v v i π r i 2 h i e ρ s m i where r i is the mean particle radius cm r i is the mean pore radius cm ρ s is the particle density g cm3 e is the pore ratio m s is the mass of the soil sample g ω i and m i are the mass fraction and mass of the i th component respectively and m i m s ω i n i is the number of soil particles and is obtained by solving eq 1 3 n i 3 m s ω i 4 π r i 3 ρ s dividing eq 2 by eq 1 gives the following 4 r i 2 r i 3 4 n i e 3 h i where h i is the length of the cylindrical pore attributed to spherical particles the soil particles however are generally nonspherical and result in pore lengths in more than one dimension arya et al 1999 so the pore length attributed to each particle is larger than the equivalent diameter of the spherical particle which means h i 2 r i n i therefore more spherical particles with radius r i were required to contribute to pore length h i consequently the actual number of spheres was n i α instead of n i and the pore length can be expressed as follows 5 h i 2 r i n i α where α is the shape coefficient substituting eq 3 and eq 5 into eq 4 the relationship between the particle radius and the pore radius was derived 6 r i r i 2 e n i 1 α 3 e 4 α π α ρ s α 2 ρ s π 3 α m s ω i 1 α 2 r i 3 α 1 2 the pore radius corresponds to the particle radius then based on capillary theory the young laplace equation was introduced to calculate the relationship between the particle radius and matric potential of the soil 7 ψ i 2 σ c o s φ r i 2 σ c o s φ e 4 α π α ρ s α 2 ρ s π 3 α m s ω i 1 α 2 r i 3 α 1 2 where ψ i is the matric potential of the i th component kpa σ is the surface tension mn m and φ is the contact angle the pores in components with particle radii less than or equal to r i were assumed to be filled with water and the volumetric water content cm3 cm3 θ v i of soil with particle radii less than or equal to r i can be expressed as follows 8 θ v i j 1 j i v v j v b e 1 e j 1 j i ω j this is the whole deduction of the ap model if the psd of a soil sample is measured by primary tests on soil properties and the mass proportion ω i corresponding to particle radius r i is determined the one to one corresponding matric potential ψ i and volumetric water content θ v i can be calculated by eqs 7 and 8 this is the process extensively used in many studies to predict the swcc by the ap model however according to eqs 7 and 8 we selected different sample masses for the four soils and calculated their swccs as shown in fig 2 the ap model can describe the swccs of different soils if the shape coefficient is calculated with a 1 g soil mass however the influence of the sample mass on the shape coefficient was significant and neglected in arya and paris 1981 see fig 3 there are evident differences in the swccs at different sample masses for example the maximum difference reaches more than 6 if the sample mass varies from 1 g to 5000 g fig 3 a the mass of the soil sample has a noteworthy effect on the matric potential no matter what the water content is fig 4 at the four water contents the matric potentials all showed large changes in the soil mass range of 0 100 g exhibiting an exponential increase the small mass of soil samples leads to a small number of soil particles and the shape coefficient should be small in practice but is fixed in the ap model arya et al 1999 chang et al 2019 hence the ap model cannot well predict the swcc at small masses of soil samples 3 theory of the superior ap model when a soil sample is selected its physical relationship describing the hydraulic or soil mechanics behaviors such as the mass proportion ω i at each particle size r i and soil water characteristic relationship should be definite and independent of the mass of the soil sample campos guereta et al 2021 hence we proposed an alternative method for predicting pore length the pore length caused by the complexity of the pores is uniformly distributed to each spherical particle instead of increasing the number of soil particles see fig 5 in the new method each soil particle contributes to the pore length and the total number of soil particles is invariable the pore length can be expressed as eq 9 the new method is much clearer in concept than the ap model according to this idea the pore length h i is covered by n i particles of radius r i α so that the radius of the particles goes from r i to r i α but the number of particles known from eq 3 remains unchanged therefore the pore length can be derived by the following 9 h i 2 r i α n i where the value of the shape coefficient α is also fitted in addition we substituted eq 9 into the ap model the following formulae can be obtained 10 r i 2 e 3 r i 3 α 2 and 11 ψ i 3 2 e 2 σ c o s φ r i 3 α 2 4 calibration and results of the sap model 4 1 data source to calibrate the accuracy of the sap model we borrowed the basic indices of soils and the swcc data in arya s study arya and paris 1981 four soil samples were prepared by combining different mass proportions of air dried silty clay 2 mm in diameter and sandy loam material the void ratios of these soils were calculated from the bulk density and particle density with a value of 2 64 g cm3 then the soil property and the psd of the four soils are shown in table 1 and fig 6 respectively 4 2 analysis index to verify the efficiency of the improved method the estimated values are compared with the measured results three statistical parameters the coefficient of determination r2 the root mean square error rmse and the relative improvement ri of sap over the ap method minasny and mcbratney 2002 are used to reflect the superiority of the sap model 12 r 2 1 i n θ m i θ p i 2 i n θ m i θ m 2 13 rmse 1 n i 1 n θ p i θ m i 2 14 r i r m s e a p r m s e s a p r m s e a p 100 where n is the number of points θ p is the predicted water content θ m is the measured water content and θ m is the average measured water content 4 3 comparisons between the sap and ap models the swccs predicted by the sap model are shown in fig 7 the sap model is an s shape and is similar to the variation trend of the measured data of the four soil samples in addition the r2 rmses and ris of the two models are given in table 2 the r2 of the sap model is always closer to 1 than that of the ap model which indicates that the swccs predicted by the sap model are closer to the measured data than those predicted by the ap model in addition the rmse values range from 0 01433 to 0 03306 for the sap model average 0 01978 and 0 01611 0 03350 for the ap model average 0 02220 all smaller rmses also prove that the sap model has better prediction of swcc than the ap model and the degree of superiority can be evaluated by the ri for example the accuracy of the swcc predicted by the sap model improved 21 58 for soil sample 1 therefore the sap model well describes the relationship between the suction and water content of soils 4 4 predictions of the sap model to other soils according to the classification system of soil texture issued by the united states department of agriculture usda nemes et al 2001 three soil texture categories including 12 groups of soil are selected to further illustrate the wide application of the sap model the codes of these samples and their psds are summarized in table 3 and fig 8 respectively fig 9 gives the predicted swccs of these soils obviously the swccs of different soils predicted by the sap model see fig 9 all have good agreement with the measured data the r2 or rmse values directly prove that the sap model can accurately predict the swccs of all soils in table 4 5 discussion the shape coefficient in the sap model no longer changes with the total mass of the soil samples and the matric potential and water content are also fixed for a type of soil thus the swcc is only determined by the parameters describing soil properties such as the void ratio the bulk density and the psd therefore many unnecessary fittings on the shape coefficient do not exist in the sap model moreover the shape coefficient in the sap model can directly exhibit the influence of the complex pore structure on the hydraulic path and further determine the water holding capacity of soils rather than a physically meaningless fitted parameter in the ap model as shown in fig 10 with increasing coarse particle content the shape coefficient presents an overall increasing trend this is because according to the assumption of the sap model as shown in fig 1 coarse particles correspond to large pores when more large pores appear it is easy for small particles to be embedded in the large pores which is different from the ideal arrangement of particles and undoubtedly increases the complexity of pores therefore this phenomenon can be reflected by a larger value of the shape coefficient additionally the pore length is equivalent to the accumulation of all enlarged particle diameters in each fraction according to eq 9 in the sap model because the number of particles is usually large the effect of the shape coefficient as an exponent on the number of particles is of concern because the pore length predicted by eq 5 is highly sensitive to the shape coefficient arya et al 2008 however in the sap model this problem can be avoided because the particle radius is generally small so a slight deviation in the value of the shape coefficient will not have a significant impact on the predicted pore length hence the equivalent pore lengths calculated by the sap model are more stable than those calculated by the ap model therefore the improvement in the sap model leads to more accurate and stable swccs in the sap model discretization of the psd is a prerequisite for calculating the swcc campos guereta et al 2021 a few fractions of the psd cannot well describe the overall grading curve of soils and lead to less accuracy of the swcc calculated by the sap model to solve this problem we could make the sap model continuous by integrating all soil particles nimmo et al 2007 campos guereta et al 2021 chen et al 2021 it is assumed that the psd of the soil sample per unit mass can be described by a continuous function f r 15 d f r f r where f r represents the probability density then the corresponding equations in the sap model become 16 n r 3 m s f r 4 π r 3 ρ s 17 h r 2 r α n r 18 r 2 e 3 r 3 α 2 19 dr 2 e 3 3 α 2 r 1 α 2 d r 20 ψ 3 2 e 2 σ c o s φ r 3 α 2 the water content is expressed as 21 θ r min r v v r d r v v by substituting eqs 15 19 into eq 20 a continuous expression between the water content and matric potential can be obtained namely a continuous sap csap model 22 θ ψ 2 e 3 3 α 2 r min 2 σ c o s φ ψ f r r 1 α 2 d r the csap model is not affected by the number of divided fractions on the psd because the csap model is mathematically continuous it is more convenient to be applied to other models or calculations if a function f r is reliable to describe the psd actually there are many probability distribution functions to describe the psd hwang and powers 2003 afrasiabi et al 2019 bayat et al 2017 6 conclusions based on the measured psd and complex pore structure of soils the sap model is proposed to calculate the swcc this new model considers the equivalent pore length by enlarging the soil particle radius which gives significant improvement over the ap model by the enlarged number of soil particles according to the above theoretical deduction and analyses the following conclusions can be drawn 1 the ap model is a classical swcc and is widely cited in the current literature but its shape coefficient changes with the mass of the soil sample and is independent of the pore structure of soils hence the superior ap model is established by considering the psd and particle complexity of unsaturated soils 2 in the sap model a new shape coefficient reflecting the complex pore length is proposed to calculate the pore volume in soils and then the pore radius is related to the particle radius by the void ratio in soils hence a superior swcc is obtained based on this relationship and the young laplace equation in unsaturated soils 3 compared with that predicted by the ap model the swcc predicted by the sap model is closer to the observed data of many soil tests moreover the sap model is more stable than the ap model when calculating the equivalent pore length in soils therefore the sap model can describe the relationship between the suction and water content of unsaturated soils well 4 the sap defines a meaningful shape coefficient in physics to describe the tortuous pore path in soils and provides a better alternative for predicting the swccs which provides new insight into the hydrodynamic characteristics of unsaturated soils 5 the csap model is independent of the interval size of psd and it is more convenient to be applied to other models or calculations due to the continuity in mathematics credit authorship contribution statement tiantian you conceptualization methodology validation formal analysis investigation data curation writing original draft shuangyang li methodology resources writing original draft writing review editing supervision project administration funding acquisition yongqiang guo writing review editing chong wang writing review editing xiaoyu liu conceptualization jianyuan zhao data curation dayan wang project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the key research program of the chinese academy of sciences zdrw zs 2020 1 the national natural science foundation of china 42071092 and 41871054 the science and technology plan project of tibet xz201801 gb 07 the science and technology plan of gansu province 21zd8ja003 and the youth innovation promotion association cas y201975 2015349 
2936,the soil water characteristic curve swcc is an essential function for unsaturated soils and describes the relationship between soil suction and water content the swcc is a prerequisite for modeling soil water temperature and solute transport in hydrology as a classical and widely used model of the swcc the arya paris ap model 1981 uses a particle size distribution psd to estimate the swcc and the psd is a parimary property of soils and is easy to obtain by a soil mechanical test hence compared with other models the ap model is more convenient and accurate for describing the swcc in the ap model a shape coefficient is proposed to describe complex pore structures and correct tortuous pore lengths however the shape coefficient changes with the mass of the soil samples which is a factual and fatal defect for the ap model to solve this problem we established a superior arya paris sap model to make the shape coefficient independent of the mass of the soil samples in the sap model the pore length in each divided fraction is the summation of the equivalent diameter of every soil particle in the fraction and the diameter amplification factor is denoted by the shape coefficient the total number of soil particles in each fraction is unchangeable in the sap model but is growing in the ap model thus unlike the ap model the sap model has a definite physical meaning and the swccs predicted by the sap model are closer to the observed data than the ap model therefore the sap model provides a better alternative for predicting swccs and provides new insight into the hydrodynamic characteristics of unsaturated soils moreover a continuous sap csap model can be obtained by a continuous function to describe the psd which widely expands the application of the sap keywords soil water characteristic curve arya paris model particle size distribution shape coefficient mass of soil sample data availability data will be made available on request 1 introduction in hydrology the soil water characteristic curve swcc is one of the most basic concepts defining the relationship between soil suction and water content in unsaturated soils and is probably the most essential soil water property of unsaturated soils karup et al 2016 antinoro et al 2014 mohammadi and vanclooster 2011 the swcc can directly or indirectly describe other valuable properties of unsaturated soils such as permeability strength and deformation xu et al 2016 wang et al 2016 it is also a fundamental tool for modeling soil water temperature and solute transport in unsaturated soils chang et al 2019 buczko and gerke 2005 van genuchten 1980 therefore the importance of the swcc has spurred increasing interest in this subject it is always time consuming and expensive to experimentally acquire the swcc thus a mathematical model of the swcc from available soil properties is one of the most feasible alternatives and can also improve the understanding of the water transport process cotet et al 2014 arya and heitman 2015 these existing mathematical models can be generally divided into two categories empirical models van genuchten 1980 fredlund and xing 1994 wang et al 2019 and theoretical models chen et al 2021 xu 2004 mohammadi and meskini vishkaee 2012 the empirical model is often obtained by fitting many scattered measured data forming a continuous function it can fit experimental data well if enough parameters are used van genuchten 1980 bordoni et al 2017 however these empirical models rely on the database used for model calibration and testing mohammadi and meskini vishkaee 2012 and their fitting parameters are meaningless in physics thus many theoretical models of the swcc have been proposed based on material properties such as mineral contents and types soil density and pore shape and size xu 2004 saha and sekharan 2021 compared with empirical models these models can generally reflect the effect of soil properties on the swcc and are independent to plenty of experimental data however the particle size distribution psd a primary property of soils is not taken into account in these models it can describe the soil structure and pore characteristics and is an essential physical index used to research the hydraulic properties of soils cosby et al 1984 therefore considering the influence of the psd on the soil hydraulic properties several swccs were built using the relationships between particle radius and pore radius aubertin et al 2003 haverkamp and parlange 1986 arya and paris 1981 nimmo 1997 bird et al 2000 mohammadi and vanclooster 2011 among these models the ap model is a widely used estimation and was cited in over 1600 published papers nimmo et al 2007 arya et al 2008 li et al 2016 karup et al 2016 wang et al 2018 campos guereta et al 2021 the ap model is theoretically deduced based on the psd and pore ratio of soils arya and paris 1981 in which the pore radius is calculated based on the assumption that the pore is cylindrical the pore height is determined by multiplying the accumulated length of the soil particle with a shape coefficient the shape coefficient is used to approximate the pore irregularity or tortuosity of soils by increasing the number of soil particles its value was determined by a fixed soil mass campos guereta et al 2021 in addition arya et al 1999 2008 proposed a function for the shape coefficient proportional to the number of soil particles since the number of soil particles depends on the mass of the soil samples the shape coefficient changes with the mass of the soil samples in other words the swcc is affected by the mass of the soil samples in the ap model which is a fatal defect to date none of the published literature has provided a reasonable explanation for the influence of the total mass of samples on the shape coefficient and subsequent swcc therefore the reliability of the ap model deserves further study to solve the above defect in the ap model this study proposes a new method to estimate the pore length of soils and establishes a superior ap sap model based on the psd and pore characteristics of soils in the sap model the shape coefficient is used to express the average enlarged ratio of all soil particles to approximate the complexity of the pores the pore length of soils is equivalent to a uniformly enlarged diameter of each particle rather than an increasing number of soil particles as a result a new relationship between the particle radius and pore radius can be determined using the pore ratio of soils according to the relationship and the young laplace equation in unsaturated soil mechanics the swcc is predicted in the sap model which is independent of the total mass of the soil sample soil data in the ap model were borrowed to calibrate the accuracy of the sap model for different masses of soil samples moreover the sap has been further verified by other 12 groups of measured swccs of clay silt and sand in these comparisons the sap shows better agreement with the measured data than the ap model in the discussion section an optimization method of the sap model is discussed and a continuous sap csap model is also proposed in this study the sap model describing the complexity of the pores is more reasonable in physical significance and convenient for calculation therefore the sap model can be directly used to study water transport in unsaturated soils and provides new insight into the hydrodynamic characteristics of unsaturated soils 2 brief description of the ap model the ap model is theoretically deduced based on the psd and pore ratio of soils in which the shape coefficient is used to describe the pore complexity of soils the main idea of the ap model is demonstrated in fig 1 the psd of a soil sample was divided into n fractions according to the particle size the soil properties of each fraction were assumed to be equal to those in the natural structure state assuming the presence of spherical particles and cylindrical pores in soils the particle volume v s i and pore volume v v i in the i th range can be expressed as follows 1 v s i n i 4 π r i 3 3 m i ρ s and 2 v v i π r i 2 h i e ρ s m i where r i is the mean particle radius cm r i is the mean pore radius cm ρ s is the particle density g cm3 e is the pore ratio m s is the mass of the soil sample g ω i and m i are the mass fraction and mass of the i th component respectively and m i m s ω i n i is the number of soil particles and is obtained by solving eq 1 3 n i 3 m s ω i 4 π r i 3 ρ s dividing eq 2 by eq 1 gives the following 4 r i 2 r i 3 4 n i e 3 h i where h i is the length of the cylindrical pore attributed to spherical particles the soil particles however are generally nonspherical and result in pore lengths in more than one dimension arya et al 1999 so the pore length attributed to each particle is larger than the equivalent diameter of the spherical particle which means h i 2 r i n i therefore more spherical particles with radius r i were required to contribute to pore length h i consequently the actual number of spheres was n i α instead of n i and the pore length can be expressed as follows 5 h i 2 r i n i α where α is the shape coefficient substituting eq 3 and eq 5 into eq 4 the relationship between the particle radius and the pore radius was derived 6 r i r i 2 e n i 1 α 3 e 4 α π α ρ s α 2 ρ s π 3 α m s ω i 1 α 2 r i 3 α 1 2 the pore radius corresponds to the particle radius then based on capillary theory the young laplace equation was introduced to calculate the relationship between the particle radius and matric potential of the soil 7 ψ i 2 σ c o s φ r i 2 σ c o s φ e 4 α π α ρ s α 2 ρ s π 3 α m s ω i 1 α 2 r i 3 α 1 2 where ψ i is the matric potential of the i th component kpa σ is the surface tension mn m and φ is the contact angle the pores in components with particle radii less than or equal to r i were assumed to be filled with water and the volumetric water content cm3 cm3 θ v i of soil with particle radii less than or equal to r i can be expressed as follows 8 θ v i j 1 j i v v j v b e 1 e j 1 j i ω j this is the whole deduction of the ap model if the psd of a soil sample is measured by primary tests on soil properties and the mass proportion ω i corresponding to particle radius r i is determined the one to one corresponding matric potential ψ i and volumetric water content θ v i can be calculated by eqs 7 and 8 this is the process extensively used in many studies to predict the swcc by the ap model however according to eqs 7 and 8 we selected different sample masses for the four soils and calculated their swccs as shown in fig 2 the ap model can describe the swccs of different soils if the shape coefficient is calculated with a 1 g soil mass however the influence of the sample mass on the shape coefficient was significant and neglected in arya and paris 1981 see fig 3 there are evident differences in the swccs at different sample masses for example the maximum difference reaches more than 6 if the sample mass varies from 1 g to 5000 g fig 3 a the mass of the soil sample has a noteworthy effect on the matric potential no matter what the water content is fig 4 at the four water contents the matric potentials all showed large changes in the soil mass range of 0 100 g exhibiting an exponential increase the small mass of soil samples leads to a small number of soil particles and the shape coefficient should be small in practice but is fixed in the ap model arya et al 1999 chang et al 2019 hence the ap model cannot well predict the swcc at small masses of soil samples 3 theory of the superior ap model when a soil sample is selected its physical relationship describing the hydraulic or soil mechanics behaviors such as the mass proportion ω i at each particle size r i and soil water characteristic relationship should be definite and independent of the mass of the soil sample campos guereta et al 2021 hence we proposed an alternative method for predicting pore length the pore length caused by the complexity of the pores is uniformly distributed to each spherical particle instead of increasing the number of soil particles see fig 5 in the new method each soil particle contributes to the pore length and the total number of soil particles is invariable the pore length can be expressed as eq 9 the new method is much clearer in concept than the ap model according to this idea the pore length h i is covered by n i particles of radius r i α so that the radius of the particles goes from r i to r i α but the number of particles known from eq 3 remains unchanged therefore the pore length can be derived by the following 9 h i 2 r i α n i where the value of the shape coefficient α is also fitted in addition we substituted eq 9 into the ap model the following formulae can be obtained 10 r i 2 e 3 r i 3 α 2 and 11 ψ i 3 2 e 2 σ c o s φ r i 3 α 2 4 calibration and results of the sap model 4 1 data source to calibrate the accuracy of the sap model we borrowed the basic indices of soils and the swcc data in arya s study arya and paris 1981 four soil samples were prepared by combining different mass proportions of air dried silty clay 2 mm in diameter and sandy loam material the void ratios of these soils were calculated from the bulk density and particle density with a value of 2 64 g cm3 then the soil property and the psd of the four soils are shown in table 1 and fig 6 respectively 4 2 analysis index to verify the efficiency of the improved method the estimated values are compared with the measured results three statistical parameters the coefficient of determination r2 the root mean square error rmse and the relative improvement ri of sap over the ap method minasny and mcbratney 2002 are used to reflect the superiority of the sap model 12 r 2 1 i n θ m i θ p i 2 i n θ m i θ m 2 13 rmse 1 n i 1 n θ p i θ m i 2 14 r i r m s e a p r m s e s a p r m s e a p 100 where n is the number of points θ p is the predicted water content θ m is the measured water content and θ m is the average measured water content 4 3 comparisons between the sap and ap models the swccs predicted by the sap model are shown in fig 7 the sap model is an s shape and is similar to the variation trend of the measured data of the four soil samples in addition the r2 rmses and ris of the two models are given in table 2 the r2 of the sap model is always closer to 1 than that of the ap model which indicates that the swccs predicted by the sap model are closer to the measured data than those predicted by the ap model in addition the rmse values range from 0 01433 to 0 03306 for the sap model average 0 01978 and 0 01611 0 03350 for the ap model average 0 02220 all smaller rmses also prove that the sap model has better prediction of swcc than the ap model and the degree of superiority can be evaluated by the ri for example the accuracy of the swcc predicted by the sap model improved 21 58 for soil sample 1 therefore the sap model well describes the relationship between the suction and water content of soils 4 4 predictions of the sap model to other soils according to the classification system of soil texture issued by the united states department of agriculture usda nemes et al 2001 three soil texture categories including 12 groups of soil are selected to further illustrate the wide application of the sap model the codes of these samples and their psds are summarized in table 3 and fig 8 respectively fig 9 gives the predicted swccs of these soils obviously the swccs of different soils predicted by the sap model see fig 9 all have good agreement with the measured data the r2 or rmse values directly prove that the sap model can accurately predict the swccs of all soils in table 4 5 discussion the shape coefficient in the sap model no longer changes with the total mass of the soil samples and the matric potential and water content are also fixed for a type of soil thus the swcc is only determined by the parameters describing soil properties such as the void ratio the bulk density and the psd therefore many unnecessary fittings on the shape coefficient do not exist in the sap model moreover the shape coefficient in the sap model can directly exhibit the influence of the complex pore structure on the hydraulic path and further determine the water holding capacity of soils rather than a physically meaningless fitted parameter in the ap model as shown in fig 10 with increasing coarse particle content the shape coefficient presents an overall increasing trend this is because according to the assumption of the sap model as shown in fig 1 coarse particles correspond to large pores when more large pores appear it is easy for small particles to be embedded in the large pores which is different from the ideal arrangement of particles and undoubtedly increases the complexity of pores therefore this phenomenon can be reflected by a larger value of the shape coefficient additionally the pore length is equivalent to the accumulation of all enlarged particle diameters in each fraction according to eq 9 in the sap model because the number of particles is usually large the effect of the shape coefficient as an exponent on the number of particles is of concern because the pore length predicted by eq 5 is highly sensitive to the shape coefficient arya et al 2008 however in the sap model this problem can be avoided because the particle radius is generally small so a slight deviation in the value of the shape coefficient will not have a significant impact on the predicted pore length hence the equivalent pore lengths calculated by the sap model are more stable than those calculated by the ap model therefore the improvement in the sap model leads to more accurate and stable swccs in the sap model discretization of the psd is a prerequisite for calculating the swcc campos guereta et al 2021 a few fractions of the psd cannot well describe the overall grading curve of soils and lead to less accuracy of the swcc calculated by the sap model to solve this problem we could make the sap model continuous by integrating all soil particles nimmo et al 2007 campos guereta et al 2021 chen et al 2021 it is assumed that the psd of the soil sample per unit mass can be described by a continuous function f r 15 d f r f r where f r represents the probability density then the corresponding equations in the sap model become 16 n r 3 m s f r 4 π r 3 ρ s 17 h r 2 r α n r 18 r 2 e 3 r 3 α 2 19 dr 2 e 3 3 α 2 r 1 α 2 d r 20 ψ 3 2 e 2 σ c o s φ r 3 α 2 the water content is expressed as 21 θ r min r v v r d r v v by substituting eqs 15 19 into eq 20 a continuous expression between the water content and matric potential can be obtained namely a continuous sap csap model 22 θ ψ 2 e 3 3 α 2 r min 2 σ c o s φ ψ f r r 1 α 2 d r the csap model is not affected by the number of divided fractions on the psd because the csap model is mathematically continuous it is more convenient to be applied to other models or calculations if a function f r is reliable to describe the psd actually there are many probability distribution functions to describe the psd hwang and powers 2003 afrasiabi et al 2019 bayat et al 2017 6 conclusions based on the measured psd and complex pore structure of soils the sap model is proposed to calculate the swcc this new model considers the equivalent pore length by enlarging the soil particle radius which gives significant improvement over the ap model by the enlarged number of soil particles according to the above theoretical deduction and analyses the following conclusions can be drawn 1 the ap model is a classical swcc and is widely cited in the current literature but its shape coefficient changes with the mass of the soil sample and is independent of the pore structure of soils hence the superior ap model is established by considering the psd and particle complexity of unsaturated soils 2 in the sap model a new shape coefficient reflecting the complex pore length is proposed to calculate the pore volume in soils and then the pore radius is related to the particle radius by the void ratio in soils hence a superior swcc is obtained based on this relationship and the young laplace equation in unsaturated soils 3 compared with that predicted by the ap model the swcc predicted by the sap model is closer to the observed data of many soil tests moreover the sap model is more stable than the ap model when calculating the equivalent pore length in soils therefore the sap model can describe the relationship between the suction and water content of unsaturated soils well 4 the sap defines a meaningful shape coefficient in physics to describe the tortuous pore path in soils and provides a better alternative for predicting the swccs which provides new insight into the hydrodynamic characteristics of unsaturated soils 5 the csap model is independent of the interval size of psd and it is more convenient to be applied to other models or calculations due to the continuity in mathematics credit authorship contribution statement tiantian you conceptualization methodology validation formal analysis investigation data curation writing original draft shuangyang li methodology resources writing original draft writing review editing supervision project administration funding acquisition yongqiang guo writing review editing chong wang writing review editing xiaoyu liu conceptualization jianyuan zhao data curation dayan wang project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the key research program of the chinese academy of sciences zdrw zs 2020 1 the national natural science foundation of china 42071092 and 41871054 the science and technology plan project of tibet xz201801 gb 07 the science and technology plan of gansu province 21zd8ja003 and the youth innovation promotion association cas y201975 2015349 
2937,in spite of the insistence of a variety of studies on floods triggered by a dam failure the effects of channel unevenness and vegetation have not been fully explored some hydrological aspects such as the sudden change in the topography of a river section the density of vegetation and its influence on flood development need to be further addressed therefore the present work investigates the complex effects of vegetation and channel s step on wave propagation during a dam break across a dry downstream channel the flow 3d computational fluid dynamics package was used to simulate the flow phenomena during a dam break adopting different geometric conditions and a densely vegetated area of the downstream channel in the far field three dimensional flow characteristics were reproduced by solutions of navier stokes equations coupled with the standard volume of fluid to track the evolution of the free surface the turbulent flow characteristics were represented by different approaches frequently used in the scientific literature the computational model was optimized and validated using experimental data published in the literature the results showed that the model had high accuracy in predicting the evolution of the free surface moving hydraulic jump flow velocity and flow regime in addition the model was able to predict the formation and development of transitional rotational and transverse flows jet flow nappe flow wave breaking the bore evolution in different directions and the change of the flow regime under the influence of the channel step and vegetation accordingly the flow fluctuations during dam break wave attenuation flow separation and turbulence structure evolution in the vegetated area were predicted keywords dam break vegetation channel step free surface flows flooding data availability data will be made available on request 1 introduction the infrastructures topographic features and vegetation covering the main channel and floodplain play an important role in the development of catastrophic floods triggered by real dam failures topographic features such as slope steps the material of the riverbed and river shorelines can significantly affect the development of floods during a dam failure indeed the unevenness of the riverbed and the vegetation cover have resistant effects on flood development in the downstream channel song et al 2011 he et al 2017 harada et al 2017 accordingly evaluating the effects of topographic features and vegetation could be very useful in flood dynamics and flood hazard management studies to mitigate the loss of life and properties aureli et al 2021 many numerical and experimental studies have been conducted to investigate the effects of complex geometric and topographic features such as obstacles humps lateral transitions bed slope and erodible beds on flood propagation during a dam failure koshizuka et al 1996 begnudelli and sanders 2007 kocaman and güzel 2011 kocaman and ozmen cagatay 2012 kusuma et al 2019 soleimani and ketabdari 2020 kocaman et al 2020 palu and julien 2020 bahmanpouri et al 2021 issakhov and borsikbayeva 2021 venturi et al 2021 ahadiyan et al 2022 khoshkonesh et al 2019 2021 2022 they showed that a decrease in flow velocity a change in the flow direction and the development of cross flows were observed where the channel cross section was altered by topographic features on the other hand there are few numerical and experimental studies on the effects of vegetation cover on flood development during dam failures zhang et al 2013 uotani et al 2014 melis et al 2019 melis et al 2019 these studies examined the effects of height and density of vegetation and the distance and degree of inundation on free surface evolution across the near field however they did not examine the drag effects of vegetation on wave development at the far field dam failures where the complex effect of downstream topography was considered accordingly there are few studies on the dam break flow dynamics and structure over the channels with both positive and negative steps chanson 2004 bukreev et al 2008 ostapenko 2012 degtyarev et al 2014 however the resistive effects of vegetation cover on wave propagation during a dam failure in a stepped channel have not yet been studied the first objective of this paper is to examine the complex effects of channel steps and vegetation on flow characteristics using a numerical approach the novelties of this study are the evaluation of the effects of the step direction and step height of the channel in the far field on the flow characteristics during dam failure and subsequent phenomena and the study of the drag and drive effects of the vegetation above the stepped channel on the wave deformations and flow regime using a 3d numerical model the flow 3d computational fluid dynamics cfd package was used in all modeling flow science 2012 the model discretizes the navier stokes equations and the turbulence features were represented by different approaches the evolution of the free surface was tracked by the volume of fluid vof method flow characteristics during a dam break were investigated including free surface evolution temporal variation in flow depth wave reflection and bore development second wave formation splashing wave breaking transitional and jet flow and change in flow regime the model was optimized and validated against the experimental data in the literature the effects of the obstacle on wave development at dam break the performance of the model in reproducing the velocity field and the effects of the transitions on backflow development were examined using different experimental results published in the literature in the optimization tests a sensitivity analysis of the turbulence models and the mesh resolution was performed being the main parameters affecting the performance of the model the best combination of mesh resolution and turbulence model was selected and applied to validation test cases then the model with the same mesh resolution and turbulence model was used to predict the flow characteristics during dam break over the stepped channel with vegetation in different cases in addition the effects of step direction step height and vegetation on the flow characteristics of dam break were investigated both quantitatively and qualitatively 2 mathematical model three dimensional navier stokes equations were solved in a structured computational domain to reproduce the dam break wave evolution hirt and nichols 1981 yang et al 2018 the model involved the scalar functions fractional area and volume of fluid added to the equations of motion as additional terms to track the free surface evolution across the channel the turbulence structures and the influence of flow disturbance on wave propagation during dam failure represented by six different approaches the prandtl mixing length bradshaw 1974 one equation model holton 2004 both single equation models the standard k ε launder and spalding 1974 the renormalized groups rng ahmadi dehrashid et al 2022 k ω wilcox 2008 two equations models and the large eddies simulation les lee and abd wahab 2019 finally the equations of motion were discretized using the finite difference method and in the central scheme with the second order space time accuracy khoshkonesh et al 2019 2021 2022 2 1 model optimization for dam break flows the mathematical model was optimized for dam break flow simulation by determining the specific combination of turbulence models and mesh resolution that maximized the performance of the cfd model in reproducing flow characteristics during a dam failure the model was calibrated using experimental data from the literature data from ferrari et al 2010 and kocaman and ozmen cagatay 2012 figs 1 5 and tables 1 and 2 were used to find the best combination of mesh size and turbulence approach through a sensitivity analysis that allowed the experimental evidence to be fitted the goodness of the model performances was determined considering the normalized root mean square error rmse in the free surface estimation as the objective function the optimal parameter combination was then used to validate this specific model in similar test cases section 2 2 to demonstrate the goodness of choice the experimental studies were selected to evaluate the effects of obstacles lateral transitions openings in the dam and geometric features of the channel on wave propagation during dam failure then the best turbulence model les and mesh resolution dc 7 5 mm were selected taking into account the accuracy of the results simulation time resolution to capture the turbulent structures and computational cost accordingly the numerical diffusion and fluid loss were evaluated depending on the mesh resolution and the type of turbulent models all simulations were performed using a laptop with an 11th generation intel r core tm processor i7 1165g7 2 80 ghz with 8 threads and 16 0 gb ram dam failure phenomena were reproduced using the six turbulent models and five mesh cells with mean sizes of dc 5 mm 7 5 mm 11 mm 14 mm and 25 mm fig 1 and table 1 these diameters were selected based on a convergence and stability criteria b dimensions of the computational domain and vegetation elements c numerical diffusion and d benchmark testing the minimum simulation time was ts 0 005 h for 12 915 cells and 610 iterations which corresponded to 0 0014 s for each cell 0 0295 s for each iteration and 2 25 s for each cpu thread in case 24 there was significant agreement between the experimental and numerical results in tracking the free surface evolution as highlighted by the result of the sensitivity analysis performed in model validation all turbulence models were very good at capturing the turbulence structures and free surface deformations however les had the highest accuracy in reproducing the profile of the free surface especially at 1 3 m fig 2a to 2f the performance of the models in reproducing the profile of the free surface was the same especially before 0 5 m and after 2 m however the lowest discrepancy between the experimental and numerical results was observed at dc 7 5 mm before 1 3 m fig 3a to 3d the numerical model was able to reproduce the formation and evolution of one dimensional flows in opposite directions by changing the specific energy values in the lateral transitions the accuracy of the model in capturing the subsequent events was remarkable at all three mesh resolutions of dc 5 mm 7 5 mm and 11 mm fig 4a to 4 h in all turbulence models the model overestimated depth averaged velocity values in the vicinity of the dam in fact the dam break wave moved faster across the channel compared to the experimental results the possible reasons for this were the absence of the sluice gate in the numerical model and the stronger disturbance of the flow in the near field in experimental results fig 5a to 5f the result was consistent with those reported by purbasari et al 2018 in addition good agreement was found between experimental and numerical results at cell sizes of dc 7 5 mm and dc 14 mm however all models underestimated the maximum height of the moving hydraulic jump as shown in fig 5g to 5j 2 1 1 mesh resolution turbulence models and simulation times simulation time and the number of iterations ni were lower for the single equation turbulence models and les ts 2 8 h 3 5 h compared to the two equation models ts 5 h for the same number of mesh cells of nc 2100000 in dam break cases 1 to 6 it is worth noting that the number of mesh cells or mesh resolution had a greater effect on ts and ni compared to the turbulent models in cases 7 to 10 the simulation time was over 21 h for over 5 5 million cells similarly the simulation time in cases 11 to 16 was lower in the single equation and les models than in the k ω and rng models however the number of iterations did not change significantly for the different turbulence models in case 17 the simulation time was about 21 h for about 5 5 million cells similar to case 7 accordingly the maximum and minimum simulation time and the number of iterations belonged to the models with the highest and lowest mesh resolution respectively thus the simulation time was directly correlated with the mesh resolution in the dam break models with different geometric conditions 2 1 2 effect of mesh resolution and turbulence models on the evolution of free surface the performance of the model in reproducing the evolution of the free surface and the temporal variation of the flow depth stage hydrograph was evaluated using the normalized root mean square nrmse values eq 7 according to table 4 7 nrmse i 1 n o e o m 2 o e max o e min oe om oe max oe m in stand for the experimental numerical maximum experimental and minimum experimental values respectively the nrmse values showed the performance of the model in reproducing the dam break flow evolution the performance of the model was considered perfect for nrmse 0 1 and good for nrmse 0 1 0 2 nouri et al 2017 therefore the performance of the model was perfect in all cases except case 2 the two equation turbulence models nrmse 6 85 showed higher accuracy in reproducing the free surface profile compared to the single equation models and les in cases 1 to 6 however the highest accuracy nrmse 6 5 belonged to the finest mesh dc 5 mm in cases 6 to 10 it is worth noting that there was no direct correlation between the mesh resolution and the accuracy of the model in cases 6 to 10 there were no significant differences between the turbulent models except for the rng model in reproducing the stage hydrograph in cases 11 to 16 table 2 2 1 3 effect of mesh resolution and turbulence models on fluid loss fluid loss in iterative solutions represents the pseudo mass source negative or sink positive triggered by numerical diffusion during momentum advection mampaey and xu 1995 khoshkonesh et al 2019 2021 2022 the values for fluid loss were negligible at the early stage of the dam break evolution in all cases the possible reason for this was the formation of the dam break wave and the low development of the wave within the computational domain fig 6 a 6d fig 6 the negative fluid loss increased from zero at tt 0 2 s to approximately 2 at tt 0 4 s and then remained constant in fig 6a the fluid loss was approximately zero at all mesh resolutions except for the finest mesh cells of dc 5 mm according to fig 6c although fluid loss changed with mesh cell size there was no clear correlation between them in contrast the effect of the turbulence models on fluid loss was negligible fig 7 a and 7b 2 2 model validation free surface evolution in dam break with obstacle the experimental data of koshizuka and oka 1996 kocaman et al 2020 were used to verify the agreement of the evolution of the free surface at dam break with an obstacle the model parameters used for the simulations are listed in table 3 table 3 model set up for dam break with obstacle test cases a tongue shaped jet flow was formed at the wave front leading edge however the numerical model could not fully reproduce the discretization of the free surface and the formation of the droplets after impact with the obstacle within the wave body the curvature length and thickness of the tongue shaped region increased as the reservoir discharge increased while the jet flow was flung out of the channel the breaking of the wave occurred after impact with the downstream wall both in experimental and numerical results fig 8 as shown in fig 9 a mushroom shaped bore was formed in both the experimental and numerical results however the numerical model overestimated the flow velocity and the wave progression over the downstream channel the dimensions of the mushroom shaped wave increased symmetrically until the wave touched the left and upper sides of the rectangular obstacle then due to the flow separation and the obstacle angle the wave was divided into two bores with tongue shaped leading edges in the tip region the length of the tongue shaped regions was longer in the numerical results than in the experimental results the tongue shaped bores changed into parabolic ones on two sides of the obstacle it became clear that the turning of the wave toward the walls in the dam site was higher in the experimental results than in the numerical results the area of the shadow region the blank area formed by flow separation behind the wave between the dam site and the wave body was larger in the experimental results than in the numerical results 3 influence of channel s step and vegetation on dam break flows after validation tests were completed the numerical model was used to predict wave evolution during a dam failure in a stepped channel with a vegetated area above the downstream channel the height of the step was considered as an independent variable in 6 different cases as shown in table 3 the positive step was perpendicular to the upstream channel and had an upward direction in contrast the negative step had a downward direction zhi yong and hun wei 2006 bukreev et al 2008 liang and borthwick 2009 wilcox et al 2011 degtyarev et al 2014 accordingly the dimensions and spacing of vegetation elements were selected based on zhang et al 2013 uotani et al 2014 melis et al 2019 and melis et al 2019 the dimensions of the flume were selected considering the dimensions of the experimental setup used by kocaman and ozmen cagatay 2012 in our model validation the width of our flume was the same as in the study of kocaman and ozmen cagatay 2012 the length of the channel was less than in that study considering the computational effort and the presence of a step in the middle of the downstream channel as shown in fig 10 and table 4 the dam break configuration was divided into three distinct parts from left to right including the reservoir the downstream channel before the step and the vegetated downstream channel downstream of the step the computational domain was covered with five mesh blocks the channel bottom the left wall and the side walls were considered no slip boundary conditions the interface between the mesh blocks and the top of the channel was considered a free slip condition in addition the stagnation pressure for the water column in the reservoir was used as the boundary condition in the left wall the endpoint of the channel was also considered an outlet condition initial conditions were imposed considering a static water column within the dam constant in all six modeling cases the numerical setup was designed without a sluice gate therefore the shear resistant effects of the sluice gate were eliminated in the early stages of modeling vegetation elements and channel bottom were simulated as geometric elements of the models the channel contained a step with higher and lower elevations in the middle of the channel in six different cases as positive and negative steps including ps1 ps2 ps3 ns1 ns2 and ns3 respectively bukreev et al 2008 ostapenko 2012 uotani et al 2014 the diameter height and distance of the vegetation elements were reported in table 3 to meet the mesh quality criteria the aspect ratios in the x y y z and z x cartesian coordinates were 2 throughout the channel except in the vegetated area this was because the mesh had the highest resolution for calculating the effects of the vegetation elements 4 results the complex effects of the step direction step height and vegetated area on the propagation of the dam failure wave across the downstream channel were investigated numerically table 5 the formation and development of the dam break wave and subsequent events were predicted during the 10 s of the total time of the dam break accordingly six control points cp were considered to evaluate the dynamics of the dam break wave in the dam site cp0 above the step cp1 beginning the vegetated area cp2 within the vegetated area in the middle of the downstream channel cp3 the endpoint of the vegetated area cp4 and after the vegetated area cp5 table 6 4 1 dam break wave evolution the evolution of the dam break wave through the positive and negative steps led to the development of various phenomena the leading edge deformed significantly and an oblique toe shaped upward jet formed over the step and downstream channel at tt 0 7 s the jet was asleep over the downstream channel and violent splashes and flow detachments were observed during the propagation of the wave over the vegetated area from tt 0 8 s to tt 1 s the development of the jump resulted in a change in the curvature of the free surface from convex to concave in the vegetated area fig 11 a to 11 g the flow depth in the upstream channel was about higher than in ps1 due to a greater step height accordingly the crest of the moving jump and flow depth in the upstream channel was higher in ps2 compared to ps1 although one dimensional flow developed in the upstream channel before the step local three dimensional flow developed around the vegetation and additional one dimensional flow developed downstream and out of the vegetated area at tt 4 s fig 12 a to 12d the jet flow propagation over the vegetated channel at tt 1 s was lower in ps3 compared to ps1 and ps2 the secondary wave formed after the jump hit the left wall in the last stages tt 5 s a considerable amount of water accumulated in the upstream channel fig 13 a to 13d the free surface profile developed like a free falling nappe flow while the cavity was formed under the free falling jet chanson 2004 however the sequence of free falling nappe flow nappe impact and horizontal development was not fully observed under the influence of vegetation rather wave plunging was observed in upstream downstream transverse and vertical directions wave propagation over the vegetated area continued without significant deformation or discretization of the free surface from tt 0 8 s to tt 1 s however flow separation and interference around the vegetation elements within the wave body occurred the jump did not move into the upstream channel due to the downward direction of the step fig 14 a to 14 g the distance of the wave front from the step at the impact point and the flow disturbance were increased by increasing the step height in addition the height of the free surface and its fluctuations above the vegetated area increased by increasing the step height fig 15 a to 15d as shown in fig 16 a the distance of the wave front from the step at the point of impact and the flow disturbance due to the step height were larger compared to ns1 and ns2 the area of the cavity region increased however it filled more slowly when the step height was increased than in ns1 and ns2 flow disturbance and free surface fluctuations were higher at tt 2 s than at ns1 and ns2 fig 16b to 16d in cases ps1 to ps3 the progression of the dam break wave front increased constantly until tt 0 6 s before the wave reached the positive step thereafter it increased with a nonlinear shape from tt 0 6 s to tt 1 s which was due to the reflection of the wave from the step and the vegetated area accordingly the mean velocity uwfm δx δt of the wave front decreased from about 3 7 m s to about 2 8 m s from ps1 to ps3 in cases ns1 to ns3 unlike cases ps1 to ps3 the wavefront xf was approximately linear with time this was because there was no reflection from the step in the downstream channel accordingly the mean velocity of the wave front increased from about 3 2 m s to about 4 m s from ns1 to ns3 fig 17 d to 17f the possible reason for this increase was the increase in the velocity of the free falling nappe flow over the negative step by increasing the step height in the initial stage tt 1 s 4 2 dam break stage hydrograph the reservoir discharge depth decreased with a steep slope from d 0 3 m to d 0 14 m at the early stage tt 0 6 s after that it remained constant at d 0 14 m from tt 0 6 s to tt 2 s due to the balance between the kinetic energy of the wave and dissipation by potential energy subsequently it decreased from d 0 14 m at tt 2 s to d 0 07 m at tt 4 s in all models due to wave damping channel step and vegetation had no significant effect on reservoir discharge during the early to middle stages tt 4 s the reason was their approximately far distance from the dam site however the depth of the outflow increased after tt 4 s as the back flow was imported into the reservoir in cases ns1 to ns3 no backflow formed and the outflow depth decreased uniformly during wave progression over the downstream channel the negative step height had no significant effect on the reservoir discharge from the middle stage to the last stage fig 18 a to 18f dam break flow depth above control point 1 increased in model ps1 from zero at tt 0 6 s to a peak value of about dmax 0 16 m at tt peak 3 6 s fig 19 a to 19c although the peak time tt peak decreased from 3 6 s in ps1 to 2 2 s in ps3 the maximum flow depth dmax increased from 0 16 m in ps1 to 0 165 m in ps2 and then decreased to 0 146 m in ps3 for ps1 to ps3 fluctuations in flow depth increased at control point 3 due to the development of local 3d cross flows and flow separation behind vegetation elements in contrast the maximum flow depth decreased to dmax 0 116 m at tt 2 s due to the drag force of vegetation elements fig 19d to 19f the lowest values of flow depth were observed at control point 5 downstream of the vegetation area fig 19g to 19i the rising limb had a steep slope whereas the falling limb had a gentle slope that increased at tt 7 7 s due to downstream flow control and progression of the back flow toward the upstream in model ns1 fig 20 a however an increase in flow depth at tt 7 7 s was not observed in model ns3 the back flow did not form over the step at this time accordingly the maximum flow depth dmax 0 08 m at tt max 2 8 s did not change significantly due to an increase in negative step height from ns1 to ns3 this was because upstream flow control dominated over the step at tt 2 8 s while jet flow developed over the downstream channel from ns1 to ns3 fig 20a to 20c an increase in flow depth due to the development of back flow toward the upstream was observed at tt 7 2 s in ns1 tt 8 s in ns2 and tt 8 4 s in ns3 the distance of sleep point of the jet flow from the step increased with increasing step height fig 20d to 20f the same trends were observed at control point 5 fig 20g to 20i 4 3 dam break break flow regime as shown in fig 21 a through 21f the flow regime changed from subcritical to supercritical and then back to subcritical however the maximum froude number decreased from frmax 4 4 at tt 0 8 s in ps1 to frmax 2 04 at tt 0 8 s in ps3 by increasing the step height sudden changes in a flow regime from subcritical to supercritical were observed between tt 0 5 s and tt 1 s due to the rapid progression of the dam break wave front across the step in control point 1 of all models froude number values decreased significantly after tt 3 s in both models ps1 and ps3 fig 21a to 21f the maximum froude number decreased from frmax 4 90 in ps1 to 2 5 in ps3 with increasing step height a transition from supercritical to subcritical flow was observed at tt 4 s fig 21g to 21i the maximum values of the froude number in the models of ns were higher than in the corresponding models of ps at control point 3 a change in the flow regime from supercritical to subcritical was observed at tt 5 s it is worth noting that the effects of step direction and height were more significant than the drag effects of vegetation on froude number values and changes in flow regime fig 21d to 21f multiple shifts from subcritical to supercritical flow from tt 1 s to tt 3 s were observed at control point 5 accordingly the flow regime in models ps1 to ps3 remained in a transitional state after tt 3 s the maximum froude number values were frmax 5 7 5 3 and 4 5 in models ps1 ps2 and ps3 respectively the froude number values were higher downstream outside the vegetated area than inside the vegetated area fig 21m to 21o 5 discussion in this study a tongue shaped jet flow formed above the positive step which deformed into a toe shaped jet as it fell asleep and plunged over the vegetated area over the positive step in ps models the development of a back flow low step height and moving hydraulic jump high step height toward the reservoir was observed while wave attenuation within the vegetated area resulted in a parallel profile over the downstream channel in the final stages the phenomena resembled those of dam break flow over a hump cheng et al 2017 gu et al 2017 garoosi et al 2022a 2022b zuo et al 2022 yang et al 2018 2022 however jet trapping above the positive step was not observed due to the low height of the step in ps1 over the negative step in ns models a free falling jet formed over the negative step while it developed as a nappe flow over the downstream vegetated channel during the wave development the plunging of the wave front the deformation of the free surface with a change in profile curvature and the development of the jump to the reservoir were observed the area of the cavity under the nappe flow increased in contrast the flow depth over the upstream channel decreased significantly with increasing step height the results were not reported by chanson 2004 badarch et al 2016 and yang et al 2017 the dissipation of kinetic energy was significantly increased due to the difference in elevation between the upstream and downstream channels the free falling jet circulation and the drag effects of vegetation in the downstream channel in ps models the flow depth and height of the jump s crest the development of 1d flow in the upstream channel and local 3d flow in the vegetated area a significant change in the curvature of the free surface profile in the vegetated area and a significant decrease in the flow depth in the downstream channel were observed due to an increase in step height accordingly the progression of the wave front leading edge over the downstream vegetated area was nonlinear while the progression decreased with increasing step height in contrast in ns models the wave front leading edge profile was approximately linear while the profile increased roughly with increasing step height due to an increase in mean velocity the drag effect of vegetation on the progression of the wave front leading edge was not significant the results were consistent with those of begnudelli and sanders 2007 melis et al 2019 and melis et al 2019 however the effects of bed and sidewalls roughness vegetation roughness and the manning coefficient were not considered in the modeling in the current study step height and vegetation had no significant effect on the reservoir outflow stage hydrograph during the early and middle stages but returning the back flow into the reservoir increased the outflow depth during the latter stages in ps models the vegetation enhanced the progression of the back flow toward the step in the opposite direction to the jet flow evolution in ps models biscarini et al 2010 biscarini et al 2016 lobovsky et al 2014 and gu et al 2017 showed that a second wave was formed after the dam failure wave hits a hump or the downstream channel wall however in the present study the step height could lead to an increase in the back flow depth the intensity and the number of fluctuations of the dam break wave at the step in addition zhang et al 2013 2016 showed that a decrease in flow velocity in the vegetated area resulted in an increase in flow depth in the vegetated area however in the current study the increase in flow depth was observed only at the control point 3 but not in the whole vegetated area in contrast in ns models step height and the vegetated area had no significant effect on temporal variation in reservoir outflow depth in addition the complex effects of step height and vegetation resulted in significant variations in flow depth within the vegetated area however maximum flow depth did not change with increasing step height the development of the jump over the downstream channel resulted in an increase in flow depth across the vegetated area at different moments due to the increase in step height increasing in velocity of jet flow over the negative step was reported by chamani and beirami 2002 chamani et al 2008 and wang et al 2021 however they did not examine the effects of vegetation cover on velocity distribution and values downstream of the step in the present study the vegetated area enhanced the evolution of the back flow toward the step in the opposite direction to the jet evolution at the dam site the transitional regime and the subcritical regime were formed with increasing step height the flow regime across the vegetated area changed significantly the maximum froude number decreased with increasing step height above the step and across the vegetated area except at the end point of the vegetated area in ps models in ns models the flow regime during dam failure was transitional and subcritical in the dam site as in models with a positive step despite the positive step the fluctuations and sudden decrease in froude number were not observed in the model with a negative step from the middle to the last stage maximum froude number values were higher in the ns models than in the ps models over the entire vegetated area a change in the flow regime the formation of cross flows and jumps after impact with the sill lateral transitions and obstacles were reported by hogg and pritchard 2004 hogg 2006 ozmen cagatay and kocaman 2011 karimpour ghannadi and chu 2014 kusuma et al 2019 palu and julien 2020 however in the present study the temporal fluctuations of the froude number increased significantly this can be attributed to the complex effect of wave reflection over the step and the development of cross flows across the vegetation 6 conclusions evaluating the effects of the channel topography and vegetation on flow dynamics during dam failures is very important for flood hazard analysis and flood control programs although there are few numerical and experimental studies on modeling flow at dam failure over a stepped channel studies over a stepped vegetated channel are even more scarce indeed the resistive or driving effects of the channel step and vegetation on wave propagation flow dynamics and subsequent events during the dam failure are not fully addressed in the literature therefore in this study a cfd model was used to reproduce wave development in the downstream channel by considering the effects of an obstacle transitions and partial breaches using experimental data from the literature the model was optimized validated and tested with experimental data and showed high accuracy in reproducing the subsequent events of dam break fluctuations and deformations of the free surface the evolution of the moving hydraulic jump flow separation and interference jet impingement and wave breaking the optimization and validation tests were performed with four different experimental data published in the literature the accuracy of the model in reproducing the effects of obstacles and lateral transitions on the free surface evolution was investigated using different mesh resolutions and turbulence models the performance of the model in reproducing the velocity field and flow regime was examined using the experimental data then the best mesh resolution and turbulence model were selected considering the test results and modeling criteria the model was finally used to predict the flow characteristics during a dam break considering the effects of step direction step height and vegetation in the downstream channel it has been satisfactorily established that this model achieves high accuracy in predicting the phenomena associated with wave development during dam failure in a stepped channel with vegetation the performance of the model depends on the initial configuration mesh resolution and turbulence approaches the results of this study are fully applicable in flood hazard analyses related to dam failures they are also of great interest to civil engineers hydrologists and marine and coastal engineers in the current study the performance of the model was strongly dependent on the mesh resolution especially in the vegetated area however increasing the mesh resolution led to an increase in the computational costs and numerical diffusion in high resolution in addition it affected the mesh quality and aspect ratio in different directions of the computational domain another limitation was related to the modeling and capturing of the thin vegetation elements as geometrical features across the downstream channel the experimental data on velocity field was also scarce for future developments the effects of the density of the vegetation the submergence and emergence conditions and the position of the vegetation across the main channel or floodplain on the dam break flow over the stepped channel would be modeled both numerically and experimentally credit authorship contribution statement alireza khoshkonesh conceptualization investigation methodology visualization formal analysis writing original draft mohammad daliri visualization investigation formal analysis khuram riaz investigation formal analysis fariba ahmadi dehrashid investigation visualization formal analysis farhad bahmanpouri investigation silvia di francesco investigation methodology visualization formal analysis writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors 
2937,in spite of the insistence of a variety of studies on floods triggered by a dam failure the effects of channel unevenness and vegetation have not been fully explored some hydrological aspects such as the sudden change in the topography of a river section the density of vegetation and its influence on flood development need to be further addressed therefore the present work investigates the complex effects of vegetation and channel s step on wave propagation during a dam break across a dry downstream channel the flow 3d computational fluid dynamics package was used to simulate the flow phenomena during a dam break adopting different geometric conditions and a densely vegetated area of the downstream channel in the far field three dimensional flow characteristics were reproduced by solutions of navier stokes equations coupled with the standard volume of fluid to track the evolution of the free surface the turbulent flow characteristics were represented by different approaches frequently used in the scientific literature the computational model was optimized and validated using experimental data published in the literature the results showed that the model had high accuracy in predicting the evolution of the free surface moving hydraulic jump flow velocity and flow regime in addition the model was able to predict the formation and development of transitional rotational and transverse flows jet flow nappe flow wave breaking the bore evolution in different directions and the change of the flow regime under the influence of the channel step and vegetation accordingly the flow fluctuations during dam break wave attenuation flow separation and turbulence structure evolution in the vegetated area were predicted keywords dam break vegetation channel step free surface flows flooding data availability data will be made available on request 1 introduction the infrastructures topographic features and vegetation covering the main channel and floodplain play an important role in the development of catastrophic floods triggered by real dam failures topographic features such as slope steps the material of the riverbed and river shorelines can significantly affect the development of floods during a dam failure indeed the unevenness of the riverbed and the vegetation cover have resistant effects on flood development in the downstream channel song et al 2011 he et al 2017 harada et al 2017 accordingly evaluating the effects of topographic features and vegetation could be very useful in flood dynamics and flood hazard management studies to mitigate the loss of life and properties aureli et al 2021 many numerical and experimental studies have been conducted to investigate the effects of complex geometric and topographic features such as obstacles humps lateral transitions bed slope and erodible beds on flood propagation during a dam failure koshizuka et al 1996 begnudelli and sanders 2007 kocaman and güzel 2011 kocaman and ozmen cagatay 2012 kusuma et al 2019 soleimani and ketabdari 2020 kocaman et al 2020 palu and julien 2020 bahmanpouri et al 2021 issakhov and borsikbayeva 2021 venturi et al 2021 ahadiyan et al 2022 khoshkonesh et al 2019 2021 2022 they showed that a decrease in flow velocity a change in the flow direction and the development of cross flows were observed where the channel cross section was altered by topographic features on the other hand there are few numerical and experimental studies on the effects of vegetation cover on flood development during dam failures zhang et al 2013 uotani et al 2014 melis et al 2019 melis et al 2019 these studies examined the effects of height and density of vegetation and the distance and degree of inundation on free surface evolution across the near field however they did not examine the drag effects of vegetation on wave development at the far field dam failures where the complex effect of downstream topography was considered accordingly there are few studies on the dam break flow dynamics and structure over the channels with both positive and negative steps chanson 2004 bukreev et al 2008 ostapenko 2012 degtyarev et al 2014 however the resistive effects of vegetation cover on wave propagation during a dam failure in a stepped channel have not yet been studied the first objective of this paper is to examine the complex effects of channel steps and vegetation on flow characteristics using a numerical approach the novelties of this study are the evaluation of the effects of the step direction and step height of the channel in the far field on the flow characteristics during dam failure and subsequent phenomena and the study of the drag and drive effects of the vegetation above the stepped channel on the wave deformations and flow regime using a 3d numerical model the flow 3d computational fluid dynamics cfd package was used in all modeling flow science 2012 the model discretizes the navier stokes equations and the turbulence features were represented by different approaches the evolution of the free surface was tracked by the volume of fluid vof method flow characteristics during a dam break were investigated including free surface evolution temporal variation in flow depth wave reflection and bore development second wave formation splashing wave breaking transitional and jet flow and change in flow regime the model was optimized and validated against the experimental data in the literature the effects of the obstacle on wave development at dam break the performance of the model in reproducing the velocity field and the effects of the transitions on backflow development were examined using different experimental results published in the literature in the optimization tests a sensitivity analysis of the turbulence models and the mesh resolution was performed being the main parameters affecting the performance of the model the best combination of mesh resolution and turbulence model was selected and applied to validation test cases then the model with the same mesh resolution and turbulence model was used to predict the flow characteristics during dam break over the stepped channel with vegetation in different cases in addition the effects of step direction step height and vegetation on the flow characteristics of dam break were investigated both quantitatively and qualitatively 2 mathematical model three dimensional navier stokes equations were solved in a structured computational domain to reproduce the dam break wave evolution hirt and nichols 1981 yang et al 2018 the model involved the scalar functions fractional area and volume of fluid added to the equations of motion as additional terms to track the free surface evolution across the channel the turbulence structures and the influence of flow disturbance on wave propagation during dam failure represented by six different approaches the prandtl mixing length bradshaw 1974 one equation model holton 2004 both single equation models the standard k ε launder and spalding 1974 the renormalized groups rng ahmadi dehrashid et al 2022 k ω wilcox 2008 two equations models and the large eddies simulation les lee and abd wahab 2019 finally the equations of motion were discretized using the finite difference method and in the central scheme with the second order space time accuracy khoshkonesh et al 2019 2021 2022 2 1 model optimization for dam break flows the mathematical model was optimized for dam break flow simulation by determining the specific combination of turbulence models and mesh resolution that maximized the performance of the cfd model in reproducing flow characteristics during a dam failure the model was calibrated using experimental data from the literature data from ferrari et al 2010 and kocaman and ozmen cagatay 2012 figs 1 5 and tables 1 and 2 were used to find the best combination of mesh size and turbulence approach through a sensitivity analysis that allowed the experimental evidence to be fitted the goodness of the model performances was determined considering the normalized root mean square error rmse in the free surface estimation as the objective function the optimal parameter combination was then used to validate this specific model in similar test cases section 2 2 to demonstrate the goodness of choice the experimental studies were selected to evaluate the effects of obstacles lateral transitions openings in the dam and geometric features of the channel on wave propagation during dam failure then the best turbulence model les and mesh resolution dc 7 5 mm were selected taking into account the accuracy of the results simulation time resolution to capture the turbulent structures and computational cost accordingly the numerical diffusion and fluid loss were evaluated depending on the mesh resolution and the type of turbulent models all simulations were performed using a laptop with an 11th generation intel r core tm processor i7 1165g7 2 80 ghz with 8 threads and 16 0 gb ram dam failure phenomena were reproduced using the six turbulent models and five mesh cells with mean sizes of dc 5 mm 7 5 mm 11 mm 14 mm and 25 mm fig 1 and table 1 these diameters were selected based on a convergence and stability criteria b dimensions of the computational domain and vegetation elements c numerical diffusion and d benchmark testing the minimum simulation time was ts 0 005 h for 12 915 cells and 610 iterations which corresponded to 0 0014 s for each cell 0 0295 s for each iteration and 2 25 s for each cpu thread in case 24 there was significant agreement between the experimental and numerical results in tracking the free surface evolution as highlighted by the result of the sensitivity analysis performed in model validation all turbulence models were very good at capturing the turbulence structures and free surface deformations however les had the highest accuracy in reproducing the profile of the free surface especially at 1 3 m fig 2a to 2f the performance of the models in reproducing the profile of the free surface was the same especially before 0 5 m and after 2 m however the lowest discrepancy between the experimental and numerical results was observed at dc 7 5 mm before 1 3 m fig 3a to 3d the numerical model was able to reproduce the formation and evolution of one dimensional flows in opposite directions by changing the specific energy values in the lateral transitions the accuracy of the model in capturing the subsequent events was remarkable at all three mesh resolutions of dc 5 mm 7 5 mm and 11 mm fig 4a to 4 h in all turbulence models the model overestimated depth averaged velocity values in the vicinity of the dam in fact the dam break wave moved faster across the channel compared to the experimental results the possible reasons for this were the absence of the sluice gate in the numerical model and the stronger disturbance of the flow in the near field in experimental results fig 5a to 5f the result was consistent with those reported by purbasari et al 2018 in addition good agreement was found between experimental and numerical results at cell sizes of dc 7 5 mm and dc 14 mm however all models underestimated the maximum height of the moving hydraulic jump as shown in fig 5g to 5j 2 1 1 mesh resolution turbulence models and simulation times simulation time and the number of iterations ni were lower for the single equation turbulence models and les ts 2 8 h 3 5 h compared to the two equation models ts 5 h for the same number of mesh cells of nc 2100000 in dam break cases 1 to 6 it is worth noting that the number of mesh cells or mesh resolution had a greater effect on ts and ni compared to the turbulent models in cases 7 to 10 the simulation time was over 21 h for over 5 5 million cells similarly the simulation time in cases 11 to 16 was lower in the single equation and les models than in the k ω and rng models however the number of iterations did not change significantly for the different turbulence models in case 17 the simulation time was about 21 h for about 5 5 million cells similar to case 7 accordingly the maximum and minimum simulation time and the number of iterations belonged to the models with the highest and lowest mesh resolution respectively thus the simulation time was directly correlated with the mesh resolution in the dam break models with different geometric conditions 2 1 2 effect of mesh resolution and turbulence models on the evolution of free surface the performance of the model in reproducing the evolution of the free surface and the temporal variation of the flow depth stage hydrograph was evaluated using the normalized root mean square nrmse values eq 7 according to table 4 7 nrmse i 1 n o e o m 2 o e max o e min oe om oe max oe m in stand for the experimental numerical maximum experimental and minimum experimental values respectively the nrmse values showed the performance of the model in reproducing the dam break flow evolution the performance of the model was considered perfect for nrmse 0 1 and good for nrmse 0 1 0 2 nouri et al 2017 therefore the performance of the model was perfect in all cases except case 2 the two equation turbulence models nrmse 6 85 showed higher accuracy in reproducing the free surface profile compared to the single equation models and les in cases 1 to 6 however the highest accuracy nrmse 6 5 belonged to the finest mesh dc 5 mm in cases 6 to 10 it is worth noting that there was no direct correlation between the mesh resolution and the accuracy of the model in cases 6 to 10 there were no significant differences between the turbulent models except for the rng model in reproducing the stage hydrograph in cases 11 to 16 table 2 2 1 3 effect of mesh resolution and turbulence models on fluid loss fluid loss in iterative solutions represents the pseudo mass source negative or sink positive triggered by numerical diffusion during momentum advection mampaey and xu 1995 khoshkonesh et al 2019 2021 2022 the values for fluid loss were negligible at the early stage of the dam break evolution in all cases the possible reason for this was the formation of the dam break wave and the low development of the wave within the computational domain fig 6 a 6d fig 6 the negative fluid loss increased from zero at tt 0 2 s to approximately 2 at tt 0 4 s and then remained constant in fig 6a the fluid loss was approximately zero at all mesh resolutions except for the finest mesh cells of dc 5 mm according to fig 6c although fluid loss changed with mesh cell size there was no clear correlation between them in contrast the effect of the turbulence models on fluid loss was negligible fig 7 a and 7b 2 2 model validation free surface evolution in dam break with obstacle the experimental data of koshizuka and oka 1996 kocaman et al 2020 were used to verify the agreement of the evolution of the free surface at dam break with an obstacle the model parameters used for the simulations are listed in table 3 table 3 model set up for dam break with obstacle test cases a tongue shaped jet flow was formed at the wave front leading edge however the numerical model could not fully reproduce the discretization of the free surface and the formation of the droplets after impact with the obstacle within the wave body the curvature length and thickness of the tongue shaped region increased as the reservoir discharge increased while the jet flow was flung out of the channel the breaking of the wave occurred after impact with the downstream wall both in experimental and numerical results fig 8 as shown in fig 9 a mushroom shaped bore was formed in both the experimental and numerical results however the numerical model overestimated the flow velocity and the wave progression over the downstream channel the dimensions of the mushroom shaped wave increased symmetrically until the wave touched the left and upper sides of the rectangular obstacle then due to the flow separation and the obstacle angle the wave was divided into two bores with tongue shaped leading edges in the tip region the length of the tongue shaped regions was longer in the numerical results than in the experimental results the tongue shaped bores changed into parabolic ones on two sides of the obstacle it became clear that the turning of the wave toward the walls in the dam site was higher in the experimental results than in the numerical results the area of the shadow region the blank area formed by flow separation behind the wave between the dam site and the wave body was larger in the experimental results than in the numerical results 3 influence of channel s step and vegetation on dam break flows after validation tests were completed the numerical model was used to predict wave evolution during a dam failure in a stepped channel with a vegetated area above the downstream channel the height of the step was considered as an independent variable in 6 different cases as shown in table 3 the positive step was perpendicular to the upstream channel and had an upward direction in contrast the negative step had a downward direction zhi yong and hun wei 2006 bukreev et al 2008 liang and borthwick 2009 wilcox et al 2011 degtyarev et al 2014 accordingly the dimensions and spacing of vegetation elements were selected based on zhang et al 2013 uotani et al 2014 melis et al 2019 and melis et al 2019 the dimensions of the flume were selected considering the dimensions of the experimental setup used by kocaman and ozmen cagatay 2012 in our model validation the width of our flume was the same as in the study of kocaman and ozmen cagatay 2012 the length of the channel was less than in that study considering the computational effort and the presence of a step in the middle of the downstream channel as shown in fig 10 and table 4 the dam break configuration was divided into three distinct parts from left to right including the reservoir the downstream channel before the step and the vegetated downstream channel downstream of the step the computational domain was covered with five mesh blocks the channel bottom the left wall and the side walls were considered no slip boundary conditions the interface between the mesh blocks and the top of the channel was considered a free slip condition in addition the stagnation pressure for the water column in the reservoir was used as the boundary condition in the left wall the endpoint of the channel was also considered an outlet condition initial conditions were imposed considering a static water column within the dam constant in all six modeling cases the numerical setup was designed without a sluice gate therefore the shear resistant effects of the sluice gate were eliminated in the early stages of modeling vegetation elements and channel bottom were simulated as geometric elements of the models the channel contained a step with higher and lower elevations in the middle of the channel in six different cases as positive and negative steps including ps1 ps2 ps3 ns1 ns2 and ns3 respectively bukreev et al 2008 ostapenko 2012 uotani et al 2014 the diameter height and distance of the vegetation elements were reported in table 3 to meet the mesh quality criteria the aspect ratios in the x y y z and z x cartesian coordinates were 2 throughout the channel except in the vegetated area this was because the mesh had the highest resolution for calculating the effects of the vegetation elements 4 results the complex effects of the step direction step height and vegetated area on the propagation of the dam failure wave across the downstream channel were investigated numerically table 5 the formation and development of the dam break wave and subsequent events were predicted during the 10 s of the total time of the dam break accordingly six control points cp were considered to evaluate the dynamics of the dam break wave in the dam site cp0 above the step cp1 beginning the vegetated area cp2 within the vegetated area in the middle of the downstream channel cp3 the endpoint of the vegetated area cp4 and after the vegetated area cp5 table 6 4 1 dam break wave evolution the evolution of the dam break wave through the positive and negative steps led to the development of various phenomena the leading edge deformed significantly and an oblique toe shaped upward jet formed over the step and downstream channel at tt 0 7 s the jet was asleep over the downstream channel and violent splashes and flow detachments were observed during the propagation of the wave over the vegetated area from tt 0 8 s to tt 1 s the development of the jump resulted in a change in the curvature of the free surface from convex to concave in the vegetated area fig 11 a to 11 g the flow depth in the upstream channel was about higher than in ps1 due to a greater step height accordingly the crest of the moving jump and flow depth in the upstream channel was higher in ps2 compared to ps1 although one dimensional flow developed in the upstream channel before the step local three dimensional flow developed around the vegetation and additional one dimensional flow developed downstream and out of the vegetated area at tt 4 s fig 12 a to 12d the jet flow propagation over the vegetated channel at tt 1 s was lower in ps3 compared to ps1 and ps2 the secondary wave formed after the jump hit the left wall in the last stages tt 5 s a considerable amount of water accumulated in the upstream channel fig 13 a to 13d the free surface profile developed like a free falling nappe flow while the cavity was formed under the free falling jet chanson 2004 however the sequence of free falling nappe flow nappe impact and horizontal development was not fully observed under the influence of vegetation rather wave plunging was observed in upstream downstream transverse and vertical directions wave propagation over the vegetated area continued without significant deformation or discretization of the free surface from tt 0 8 s to tt 1 s however flow separation and interference around the vegetation elements within the wave body occurred the jump did not move into the upstream channel due to the downward direction of the step fig 14 a to 14 g the distance of the wave front from the step at the impact point and the flow disturbance were increased by increasing the step height in addition the height of the free surface and its fluctuations above the vegetated area increased by increasing the step height fig 15 a to 15d as shown in fig 16 a the distance of the wave front from the step at the point of impact and the flow disturbance due to the step height were larger compared to ns1 and ns2 the area of the cavity region increased however it filled more slowly when the step height was increased than in ns1 and ns2 flow disturbance and free surface fluctuations were higher at tt 2 s than at ns1 and ns2 fig 16b to 16d in cases ps1 to ps3 the progression of the dam break wave front increased constantly until tt 0 6 s before the wave reached the positive step thereafter it increased with a nonlinear shape from tt 0 6 s to tt 1 s which was due to the reflection of the wave from the step and the vegetated area accordingly the mean velocity uwfm δx δt of the wave front decreased from about 3 7 m s to about 2 8 m s from ps1 to ps3 in cases ns1 to ns3 unlike cases ps1 to ps3 the wavefront xf was approximately linear with time this was because there was no reflection from the step in the downstream channel accordingly the mean velocity of the wave front increased from about 3 2 m s to about 4 m s from ns1 to ns3 fig 17 d to 17f the possible reason for this increase was the increase in the velocity of the free falling nappe flow over the negative step by increasing the step height in the initial stage tt 1 s 4 2 dam break stage hydrograph the reservoir discharge depth decreased with a steep slope from d 0 3 m to d 0 14 m at the early stage tt 0 6 s after that it remained constant at d 0 14 m from tt 0 6 s to tt 2 s due to the balance between the kinetic energy of the wave and dissipation by potential energy subsequently it decreased from d 0 14 m at tt 2 s to d 0 07 m at tt 4 s in all models due to wave damping channel step and vegetation had no significant effect on reservoir discharge during the early to middle stages tt 4 s the reason was their approximately far distance from the dam site however the depth of the outflow increased after tt 4 s as the back flow was imported into the reservoir in cases ns1 to ns3 no backflow formed and the outflow depth decreased uniformly during wave progression over the downstream channel the negative step height had no significant effect on the reservoir discharge from the middle stage to the last stage fig 18 a to 18f dam break flow depth above control point 1 increased in model ps1 from zero at tt 0 6 s to a peak value of about dmax 0 16 m at tt peak 3 6 s fig 19 a to 19c although the peak time tt peak decreased from 3 6 s in ps1 to 2 2 s in ps3 the maximum flow depth dmax increased from 0 16 m in ps1 to 0 165 m in ps2 and then decreased to 0 146 m in ps3 for ps1 to ps3 fluctuations in flow depth increased at control point 3 due to the development of local 3d cross flows and flow separation behind vegetation elements in contrast the maximum flow depth decreased to dmax 0 116 m at tt 2 s due to the drag force of vegetation elements fig 19d to 19f the lowest values of flow depth were observed at control point 5 downstream of the vegetation area fig 19g to 19i the rising limb had a steep slope whereas the falling limb had a gentle slope that increased at tt 7 7 s due to downstream flow control and progression of the back flow toward the upstream in model ns1 fig 20 a however an increase in flow depth at tt 7 7 s was not observed in model ns3 the back flow did not form over the step at this time accordingly the maximum flow depth dmax 0 08 m at tt max 2 8 s did not change significantly due to an increase in negative step height from ns1 to ns3 this was because upstream flow control dominated over the step at tt 2 8 s while jet flow developed over the downstream channel from ns1 to ns3 fig 20a to 20c an increase in flow depth due to the development of back flow toward the upstream was observed at tt 7 2 s in ns1 tt 8 s in ns2 and tt 8 4 s in ns3 the distance of sleep point of the jet flow from the step increased with increasing step height fig 20d to 20f the same trends were observed at control point 5 fig 20g to 20i 4 3 dam break break flow regime as shown in fig 21 a through 21f the flow regime changed from subcritical to supercritical and then back to subcritical however the maximum froude number decreased from frmax 4 4 at tt 0 8 s in ps1 to frmax 2 04 at tt 0 8 s in ps3 by increasing the step height sudden changes in a flow regime from subcritical to supercritical were observed between tt 0 5 s and tt 1 s due to the rapid progression of the dam break wave front across the step in control point 1 of all models froude number values decreased significantly after tt 3 s in both models ps1 and ps3 fig 21a to 21f the maximum froude number decreased from frmax 4 90 in ps1 to 2 5 in ps3 with increasing step height a transition from supercritical to subcritical flow was observed at tt 4 s fig 21g to 21i the maximum values of the froude number in the models of ns were higher than in the corresponding models of ps at control point 3 a change in the flow regime from supercritical to subcritical was observed at tt 5 s it is worth noting that the effects of step direction and height were more significant than the drag effects of vegetation on froude number values and changes in flow regime fig 21d to 21f multiple shifts from subcritical to supercritical flow from tt 1 s to tt 3 s were observed at control point 5 accordingly the flow regime in models ps1 to ps3 remained in a transitional state after tt 3 s the maximum froude number values were frmax 5 7 5 3 and 4 5 in models ps1 ps2 and ps3 respectively the froude number values were higher downstream outside the vegetated area than inside the vegetated area fig 21m to 21o 5 discussion in this study a tongue shaped jet flow formed above the positive step which deformed into a toe shaped jet as it fell asleep and plunged over the vegetated area over the positive step in ps models the development of a back flow low step height and moving hydraulic jump high step height toward the reservoir was observed while wave attenuation within the vegetated area resulted in a parallel profile over the downstream channel in the final stages the phenomena resembled those of dam break flow over a hump cheng et al 2017 gu et al 2017 garoosi et al 2022a 2022b zuo et al 2022 yang et al 2018 2022 however jet trapping above the positive step was not observed due to the low height of the step in ps1 over the negative step in ns models a free falling jet formed over the negative step while it developed as a nappe flow over the downstream vegetated channel during the wave development the plunging of the wave front the deformation of the free surface with a change in profile curvature and the development of the jump to the reservoir were observed the area of the cavity under the nappe flow increased in contrast the flow depth over the upstream channel decreased significantly with increasing step height the results were not reported by chanson 2004 badarch et al 2016 and yang et al 2017 the dissipation of kinetic energy was significantly increased due to the difference in elevation between the upstream and downstream channels the free falling jet circulation and the drag effects of vegetation in the downstream channel in ps models the flow depth and height of the jump s crest the development of 1d flow in the upstream channel and local 3d flow in the vegetated area a significant change in the curvature of the free surface profile in the vegetated area and a significant decrease in the flow depth in the downstream channel were observed due to an increase in step height accordingly the progression of the wave front leading edge over the downstream vegetated area was nonlinear while the progression decreased with increasing step height in contrast in ns models the wave front leading edge profile was approximately linear while the profile increased roughly with increasing step height due to an increase in mean velocity the drag effect of vegetation on the progression of the wave front leading edge was not significant the results were consistent with those of begnudelli and sanders 2007 melis et al 2019 and melis et al 2019 however the effects of bed and sidewalls roughness vegetation roughness and the manning coefficient were not considered in the modeling in the current study step height and vegetation had no significant effect on the reservoir outflow stage hydrograph during the early and middle stages but returning the back flow into the reservoir increased the outflow depth during the latter stages in ps models the vegetation enhanced the progression of the back flow toward the step in the opposite direction to the jet flow evolution in ps models biscarini et al 2010 biscarini et al 2016 lobovsky et al 2014 and gu et al 2017 showed that a second wave was formed after the dam failure wave hits a hump or the downstream channel wall however in the present study the step height could lead to an increase in the back flow depth the intensity and the number of fluctuations of the dam break wave at the step in addition zhang et al 2013 2016 showed that a decrease in flow velocity in the vegetated area resulted in an increase in flow depth in the vegetated area however in the current study the increase in flow depth was observed only at the control point 3 but not in the whole vegetated area in contrast in ns models step height and the vegetated area had no significant effect on temporal variation in reservoir outflow depth in addition the complex effects of step height and vegetation resulted in significant variations in flow depth within the vegetated area however maximum flow depth did not change with increasing step height the development of the jump over the downstream channel resulted in an increase in flow depth across the vegetated area at different moments due to the increase in step height increasing in velocity of jet flow over the negative step was reported by chamani and beirami 2002 chamani et al 2008 and wang et al 2021 however they did not examine the effects of vegetation cover on velocity distribution and values downstream of the step in the present study the vegetated area enhanced the evolution of the back flow toward the step in the opposite direction to the jet evolution at the dam site the transitional regime and the subcritical regime were formed with increasing step height the flow regime across the vegetated area changed significantly the maximum froude number decreased with increasing step height above the step and across the vegetated area except at the end point of the vegetated area in ps models in ns models the flow regime during dam failure was transitional and subcritical in the dam site as in models with a positive step despite the positive step the fluctuations and sudden decrease in froude number were not observed in the model with a negative step from the middle to the last stage maximum froude number values were higher in the ns models than in the ps models over the entire vegetated area a change in the flow regime the formation of cross flows and jumps after impact with the sill lateral transitions and obstacles were reported by hogg and pritchard 2004 hogg 2006 ozmen cagatay and kocaman 2011 karimpour ghannadi and chu 2014 kusuma et al 2019 palu and julien 2020 however in the present study the temporal fluctuations of the froude number increased significantly this can be attributed to the complex effect of wave reflection over the step and the development of cross flows across the vegetation 6 conclusions evaluating the effects of the channel topography and vegetation on flow dynamics during dam failures is very important for flood hazard analysis and flood control programs although there are few numerical and experimental studies on modeling flow at dam failure over a stepped channel studies over a stepped vegetated channel are even more scarce indeed the resistive or driving effects of the channel step and vegetation on wave propagation flow dynamics and subsequent events during the dam failure are not fully addressed in the literature therefore in this study a cfd model was used to reproduce wave development in the downstream channel by considering the effects of an obstacle transitions and partial breaches using experimental data from the literature the model was optimized validated and tested with experimental data and showed high accuracy in reproducing the subsequent events of dam break fluctuations and deformations of the free surface the evolution of the moving hydraulic jump flow separation and interference jet impingement and wave breaking the optimization and validation tests were performed with four different experimental data published in the literature the accuracy of the model in reproducing the effects of obstacles and lateral transitions on the free surface evolution was investigated using different mesh resolutions and turbulence models the performance of the model in reproducing the velocity field and flow regime was examined using the experimental data then the best mesh resolution and turbulence model were selected considering the test results and modeling criteria the model was finally used to predict the flow characteristics during a dam break considering the effects of step direction step height and vegetation in the downstream channel it has been satisfactorily established that this model achieves high accuracy in predicting the phenomena associated with wave development during dam failure in a stepped channel with vegetation the performance of the model depends on the initial configuration mesh resolution and turbulence approaches the results of this study are fully applicable in flood hazard analyses related to dam failures they are also of great interest to civil engineers hydrologists and marine and coastal engineers in the current study the performance of the model was strongly dependent on the mesh resolution especially in the vegetated area however increasing the mesh resolution led to an increase in the computational costs and numerical diffusion in high resolution in addition it affected the mesh quality and aspect ratio in different directions of the computational domain another limitation was related to the modeling and capturing of the thin vegetation elements as geometrical features across the downstream channel the experimental data on velocity field was also scarce for future developments the effects of the density of the vegetation the submergence and emergence conditions and the position of the vegetation across the main channel or floodplain on the dam break flow over the stepped channel would be modeled both numerically and experimentally credit authorship contribution statement alireza khoshkonesh conceptualization investigation methodology visualization formal analysis writing original draft mohammad daliri visualization investigation formal analysis khuram riaz investigation formal analysis fariba ahmadi dehrashid investigation visualization formal analysis farhad bahmanpouri investigation silvia di francesco investigation methodology visualization formal analysis writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors 
2938,the nonstationarity of hydrological variables makes the application of autoregressive ar models challenging therefore this study introduces a new time varying ar tvar model in the field of hydrology specifically in this study we focus the parameter estimation of the tvar model and exploring the model s performance for predicting groundwater depth we demonstrate the application of the model to the monthly groundwater depth series obtained on the guanzhong plain china we summarize the process of parameter estimation of the tvar model first the tvar model is transformed into the time invariance regression problem by expanding the time varying coefficients into a set of fourier or legendre basis functions then a fading memory recursive least squares fmrls algorithm is used to estimate the parameters of the regression problem in this process the model order and dimension of the basis function are determined by minimizing our proposed improved bayesian information criterion ibic with a range of dimensions greater than 0 to further demonstrate the effectiveness of the parameter estimation method and the generalizable performance of the model the method is applied to nonstationary series simulated in statistical experiments the study results indicate that the tvar model based on such a parameter estimation process exhibits better prediction performance lower model complexity and more straight forward application compared with the autoregressive integrated ari and seasonal ari sari models in conclusion using the tvar model as an alternative to the time invariance ari and sari models results in a model that is more flexible and suitable for nonstationary groundwater depth prediction keywords time varying autoregressive model groundwater depth prediction basis functions fading memory recursive least squares algorithm improved bayesian information criterion data availability data will be made available on request 1 introduction groundwater depth prediction is key to the sustainable yield of groundwater resources shirmohammadi et al 2013 because of the interaction of climate change and anthropic disturbance groundwater depth data exhibit high nonstationarity which poses great challenges for modelling guo et al 2021 pascucci et al 2020 among the variety of models employed to predict groundwater depth the autoregressive ar model is a benchmark method and plays a significant role in the field of hydrology cui and singh 2015 in recent years much work has been done to improve the modelling and prediction performance of the ar model by studying estimation methods such as maximum entropy and bayesian methods cui and singh 2017 2016 guo et al 2020 wan and xiao 2016 however the fact that the ar model is constructed under the assumption of stationarity remains a drawback bringmann et al 2017 making the ar model unsuitable for the fitting and prediction of nonstationary hydrological variables especially groundwater depth unless the nonstationary data are converted into stationary data by difference methods in advance two commonly used models autoregressive integrated ari models and seasonal autoregressive integrated sari models are a combination of ar models and difference methods however when using difference methods the problem of over differencing often arises in such cases it is necessarily guaranteed that nonstationary series become stationary and some useful information of the series may be lost to overcome these limitations in this study we introduce a new nonstationary time series model namely the time varying autoregressive tvar model to the hydrology field for modelling and predicting nonstationary groundwater depth series the tvar model is an extension of the conventional ar model which considers the model parameters to be time varying unlike the ar model the tvar model can be used directly in the modelling of nonstationary time series without any preprocessing due to its straightforward structure and the incorporation of time varying coefficients the tvar model has been proven to be an effective tool for nonstationary time series analysis wang et al 2021 in the last few years the tvar model has been applied in various fields such as speech parchami et al 2019 economics giraitis et al 2014 lanne and luoto 2017 neuroscience li et al 2019 biomedical science lee and chon 2011 and psychology albers and bringmann 2020 casini et al 2020 it has been applied to various topics such as signal detection and classification gutierrez and salazar varas 2011 li et al 2016a wang et al 2021 spectral estimation fuentealba et al 2019 li et al 2016b and suppression of reverberation parchami et al 2019 the breadth of previous work demonstrated that the results of the tvar model have many applications but the tvar model has not been applied in the field of hydrology and the performance of forecasting based on the model has not been studied the main class of methods for the parameter estimation of the tvar model combine a basis function expansion method with a regression algorithm li et al 2018 the steps for implementing these methods are as follows first the basis function expression method is used to transform the tvar model to the time invariant regression problem then the regression algorithm is used to estimate the parameters of the regression problem the number of unknown parameters of the tvar model that must be estimated using this combined method is substantially reduced xu et al 2017 the most critical issues for the structure identification and parameter estimation of the tvar model are the proper selection of the type and dimension of the basis function tsatsanis and giannakis 1993 the model order khorshidi et al 2011 and the regression algorithm albers and bringmann 2020 however previous researchers overlooked these issues based on the premise that the tvar model yields good fitting results which does not guarantee that the tvar model has good prediction performance therefore the previous parameter estimation methods for the tvar model may not be appropriate for establishing a model for the purpose of prediction although there are many choices for the basis function such as fourier legendre and wavelet basis functions it is difficult to know what class of functions is most suitable for the diverse forms of nonstationary groundwater depth series in fact each family of basis functions has its own unique tractability and accuracy wei and billings 2010 for instance legendre and fourier are appropriate for smooth or slow changing parameters lee and chon 2011 while wavelet is efficient for sharp or fast changing parameters li et al 2011 indeed if the dimension of the basis function is large enough any complete set of basis functions can approximate the coefficients of the tvar model with acceptable accuracy however one must be careful to avoid overfitting the tvar model and increasing its computational complexity both dimension selection and the model order determination are critical to the tvar model to avoid issues such as underfitting overfitting and increasing the computation time of the tvar model order determination is usually performed using the traditional order selection criteria such as the akaike information criterion aic and bayesian information criterion bic to select the number of model coefficients and strike a balance between improving model fit and increasing model complexity li et al 2016a li et al 2016b wang et al 2021 xu et al 2017 these criteria were proposed for the time invariant ar model for which only the influence of model order on model complexity is considered however the complexity of the tvar model is related not only to the model order but also to the dimension of the basis function thus these criteria may not be suitable for the order determination of the tvar model therefore developing a method for reasonably selecting the model order and the dimension of the basis function for the tvar model requires further study for the regression problem the least square ls method is the most commonly used because it can be configured to give unbiased consistent and efficient estimates when the residuals satisfy the basic assumption of white noise guo et al 2016 different from the ordinary least squares ols method the recursive least squares rls algorithm does not require matrix inversion and reduces the memory footprint sung and lee 2019 however increasing the amount of data may introduce the issue of data saturation where adding new data does not improve the estimation of the parameter in the rls model data saturation accentuates the rounding error of the rls algorithm leading to an increasing deviation between the estimated value and the true value jiang et al 2020 to overcome this problem a fading memory recursive least squares fmrls approach was proposed it is an extension of the rls that increases the contribution of new data and reduces the influence of old data by introducing a forgetting factor for old data li et al 2021 su et al 2021 in this paper we use the fmrls algorithm to solve the regression problem in this study we introduce the tvar model to the field of hydrology to predict nonstationary groundwater depths to better estimate the parameter of the tvar model we address the key problems of how to properly select the type and dimension of the basis function the model order and the regression algorithm specifically in this study we select the optimal basis function by comparing fourier with legendre and select the optimal regression algorithm by comparing the rls and fmrls algorithms we propose an improved bic ibic criterion to better determine the model order and dimension of the basis function and compare it with bic to demonstrate the superiority of the tvar model the time invariant ari and sari models are also compared the performance of these models is assessed using both the monthly groundwater depth series of seven monitoring wells in the guanzhong plain in china and nonstationary series simulated by statistical experiments to the authors knowledge this study is the first to provide details regarding the implementation process for parameter estimation in the tvar model for the purpose of prediction we expect that this study will provide some useful insights and perspectives for future work on the prediction of nonstationary hydrological variables 2 development of the tvar model 2 1 basis function expansions of the tvar model considering a zero mean nonstationary process x t t 1 2 n the tvar model of order p is given by 1 x t i 1 p a i t x t i w t where a i t i 1 2 p are the time varying coefficients of the tvar model and w t is white noise with mean of zero and variance σ 2 the time varying coefficients a i t are approximated to linear combinations of a set of basis functions f j t j 0 1 m 2 a i t j 0 m a ij f j t where a ij i 1 2 p j 0 1 m is the weighting coefficient and m is the dimensions of f j t the choice of the basis function is an important part of the modelling process in this study we compare the fourier basis function 3 f j t cos j π t 2 n j e v e n sin j 1 π t 2 n j o d d and the legendre basis function 4 f j t 1 j 0 x j 1 1 n 2 j 1 x f j 1 t j 1 f j 2 t j 1 substituting 2 into 1 yields 5 5 x t i 1 p j 0 m a ij f j t i x t i w t i 1 p j 0 m a ij f j t i x t i w t a new vector x t can be defined as 6 x t f 0 t x t f 1 t x t f m t x t t substituting 6 into 5 yields 7 x t x t t 1 x t t 2 x t t p θ w t where θ a 10 a 11 a 1 m a 20 a 21 a 2 m a p 0 a p 1 a pm t and the upper script t represents the transpose of a matrix equation 7 shows that the tvar model can be treated as a time invariant model since the coefficient vector θ is time invariant denote y x p 1 x p 2 x n t w w p 1 w p 2 w n t x x t p x t p 1 x t p 1 x t p x t n 1 x t n 2 x t 1 x t 2 x t n p t then equation 5 can be written as 8 y x θ w 2 2 recursive least squares for the tvar model equation 8 is a linear regression model and can be solved using the ls method from the perspective of the ls method θ can be obtained by minimizing the total squared error j which can be written as 9 j t p 1 n w t 2 w t w the minimum of equation 9 can be determined by setting the derivative of j with respect to θ to 0 10 j θ θ θ y x θ t y x θ θ θ θ 2 x t y 2 x t x θ 0 then the ls solution of θ can be written as 11 θ x t x 1 x t y let us define the vector y n and the matrix p n 12 y n x n 1 t x n 2 t x n p t t 13 p n i 1 n y t 1 y t 1 t 1 the rls algorithm of θ can be written as 14 θ n θ n 1 k n x n y n t θ n 1 k n p n 1 y n i y n t p n 1 y n p n i k n y n t p n 1 where the initial values of θ n and p n are set to θ 0 0 and p 0 μ i respectively and μ is the mean of x t 2 3 fading memory recursive least squares for the tvar model to attach greater importance to more recent data we introduce the fmrls model which de emphasizes older data by utilizing the forgetting factor λ li et al 2021 for the fmrls θ can be obtained by minimizing the weighted least squares error function j which can be written as 15 j t p 1 n λ n t w t 2 where λ influences the performance of the fmrls algorithm from the aspects of convergence rate tracking misadjustment and stability paleologu et al 2008 and λ 0 1 when the forgetting factor is 1 the fmrls algorithm is equivalent to the traditional rls algorithm motivated by previous studies mirhoseini and tabatabaei 2018 sun et al 2019 λ was set as 0 98 in this study let us define the matrix p n 16 p n 1 λ i 1 n y t 1 y t 1 t 1 the fmrls algorithm of θ can be written as 17 θ n θ n 1 k n x n y n t θ n 1 k n p n 1 y n λ y n t p n 1 y n p n 1 λ i k n y n t p n 1 2 4 determination of the model order and dimension of the basis function for the widely used model selection criteria the bic has greater penalties for free parameters than the aic however the bic may still not be suitable for the order determination of the tvar model because it only considers the influence of model order on model complexity therefore we propose the improved bic ibic which considers the influence of both order p and dimension m on the complexity of the tvar model the ibic is defined as 18 i b i c p m ln σ p m 2 p m 1 n l n n where σ p m 2 is the variance of the residuals of the tvar model 3 results we first applied the tvar model to the simulation and prediction of the monthly groundwater depth series of seven monitoring wells in the guanzhong plain of china through this case study we summarized the implementation process for parameter estimation of the tvar model then to demonstrate the superiority of the tvar model the ari and sari models were compared the model performance was evaluated using two commonly used error analysis indicators the root mean square error r m s e and nash sutcliffe coefficient nse zhang et al 2022 the closer the value of nse is to 1 and the closer the rmse value is to 0 the better the model performance 3 1 study areas and data in this study the monthly groundwater depth data of seven monitoring wells namely k214 n10 589 232 267 cq19 and w15 were used to verify the performance of the tvar model the seven monitoring wells were located in the guanzhong plain shaanxi province china fig 1 the guanzhong plain is found in the middle and lower reaches of the weihe river and is surrounded by mountains in the north south and west zhang et al 2019 it belongs to a continental monsoon climate characterized by abundant precipitation and high temperatures in the summer and little precipitation and low temperatures in winter huang et al 2014 the per capita water resource availability of the guanzhong plain is small and groundwater resources are scarce the monthly groundwater depth data were acquired from the shaanxi province groundwater level yearbooks which were compiled by the shaanxi geological environment monitoring station fig 2 shows graphs of the groundwater depth data and table 1 reports their descriptive statistics in fig 2 the vertical dashed line is the demarcation between the training set and test set the data from the past 5 years formed the test set and the remaining data formed the training set the training set was used to build the tvar model and the test set was used to investigate the prediction performance of the model the time series diagram in fig 2 and the mean and standard deviation stdev deviation coefficients and mean squared successive difference in table 1 showed that all the wells selected exhibited different groundwater dynamics the kwiatkowski phillips schmidt shin kpss test kwiatkowski et al 1992 was used to test the stationarity of the monthly groundwater depth series the null hypothesis of the kpss test is that the time series is stationary and the alternative is that the time series has a unit root which means the time series is nonstationary the p values of the kpss test for all the monthly groundwater depth series were less than the critical value α 0 05 indicating that all monthly groundwater depth series were nonstationary at a specified significance level α 0 05 the nonstationarity of groundwater depth series is mainly caused by trends so the ari model rather than the sari model was compared to the tvar model 3 2 result analysis we first developed the method to identify model order basis function type and dimension and regression algorithm for the tvar model then we selected the best tvar model by comparing the fitting and forecasting performance of tvar models and analysed the variation in the coefficient of the best tvar model finally to demonstrate the benefits of the tvar model we compared the results of the ari model with those of the best tvar model 3 2 1 results analysis of the tvar model to select the optimal information criterion we analysed and compared the variation in the bic ibic and error indicator values of the training and test periods with the order and dimension then based on the optimal criterion selected we compared the performance of the tvar model with different algorithms rls and fmrls and basis functions fourier and legendre functions to select the optimal basis function and algorithm based on the above optimal results we then established the process of implementing parameter estimation for the tvar model finally we analysed the variation in the coefficient of the best tvar model clarification of the intended objectives of modelling has a significant influence on the methods used in the model development process in this study the objective of developing the tvar model was to obtain better prediction performance while balancing this with good model fit therefore the desired method achieves a good fit as well as optimal prediction performance while avoiding underfitting or overfitting we selected the optimal criterion by analysing and comparing the variation in the bic ibic and error indicator values of the training and test periods with order p and dimension m we considered two basis functions and two algorithms so the total number of results that were compared and analysed for the groundwater depth at seven wells was 7 2 2 28 due to space considerations we only reported the results for w15 using the fourier basis function and rls algorithm the maximum dimension was set to 19 and the maximum order was set to 10 fig 3 shows the bic ibic rmse and nse values of the tvar models in the training and test periods with changes in the order and dimension for the groundwater depth at w15 the detailed results for the other 27 conditions are presented in the supplemental material in fig 3 the blue circle marks the minimum of the bic ibic and rmse and the maximum of nse these represent the optimal values of these indicators clearly when p 2 and m 19 the optimal rmse and nse of the training period and bic were obtained when p 2 and m 2 the optimal rmse and nse of the test period were obtained when p 2 and m 0 the optimal ibic was obtained based on these indicators the optimal order was 2 moreover when p 2 the corresponding bic values were significantly smaller than those for other values of the indicating that the order of the tvar model was well determined by minimizing bic however when p 2 with the increase in dimension the bic gradually decreased and the fitting accuracy of the tvar model of the training period gradually improved but the prediction accuracy of the tvar model of the test period gradually worsened when the bic was at its minimum the performance of the tvar model in the training period was excellent but that in the test period was very poor this indicated that when both order and dimension were determined by the minimum bic the computation time increased and poor prediction results were obtained failing to meet the goal of our modelling however when both the order and dimension were determined by the minimum ibic the tvar model exhibited good performance for both the training and test periods therefore we concluded that the ibic was more suitable for selection of the order and dimension of the tvar model than the bic furthermore the results reported in the supplementary materials also showed that the optimal information criterion for all wells was ibic regardless of the algorithm or the basis function to select the optimal basis function type and the regression algorithm we compared the performance of the tvar model under using algorithms rls and fmrls and basis functions fourier and legendre functions where the order of the tvar model and dimension of the basis functions were determined by minimizing ibic the results of the comparison are given in table 2 where the values in bold and the values in bold and italics indicate the optimal prediction results of the tvar model when using the rls and fmrls algorithms respectively table 2 shows the results of two specific tvar models the first is m 0 where m 0 indicates that the tvar model is equivalent to the time invariant ar model the second model is m 0 indicating a time varying model we first discuss the results of the rls algorithm when m 0 the dimension of the basis functions of the tvar models for k214 n10 589 267 cq19 and w15 was 0 since the model explored was a time varying model we reidentified the tvar model in the range of m 0 obviously for the groundwater depth at all wells the dimensions of the tvar models with the optimal prediction results values in bold were greater than 0 similarly when using the fmrls algorithm all the models with the optimal prediction results values in bold and italics were the tvar models with dimensions greater than 0 however the fitting performance of these models in the training period was not the best in summary our conclusion regarding the method for identifying the structure of the tvar model is as follows the model order and dimension of the basis functions for the tvar model should be determined by minimizing ibic in the range of m 0 after comparing the optimal models solved using rls with the optimal models of the models solved using fmrls we concluded that the fmrls algorithm was better values in bold and italics furthermore the optimal models using the fmrls algorithm were also the best among all tvar models these results indicated that the fmrls algorithm outperformed the rls algorithm for the tvar model and all the best tvar models were obtained using the fmrls algorithm however in the training period the model obtained using the fmrls algorithm was superior to that obtained using the rls algorithm in only one case for the groundwater depth at well 267 we examined the basis functions of the best tvar models for wells 589 and w15 the basis function of the best tvar model was the fourier basis function for wells k214 n10 232 267 and cq19 the basis function of the best models was the legendre basis function these results indicated that neither of the two basis functions was consistently better than the other in conclusion when using the fmrls algorithm and the fourier or legendre basis functions and determining the model order and dimension of the basis function by minimizing ibic in the range of m 0 the best tvar models were obtained in summary the following process of implementing parameter estimation for the tvar model is proposed first the tvar model is transformed into the time invariance regression problem by expanding the time varying coefficients into a set of fourier or legendre basis functions then an fmrls regression algorithm is used to estimate the parameters of this regression problem in this process the model order and dimension of the basis function are determined by minimizing ibic in the range of dimensions greater than 0 the tvar models that follow were all identified by the parameter estimation method summarized above and were the best models mentioned previously fig 4 shows the estimation results for the coefficients of the tvar models in fig 4 for wells k214 232 cq19 and w15 the two time varying coefficients a 1 t and a 2 t are shown while for wells n10 589 and 267 only one time varying coefficient a 1 t is shown this is because for wells k214 232 cq19 and w15 the order of the tvar model was 2 while for wells n10 589 and 267 the order was 1 it is obvious from fig 4 that for wells 589 and w15 the variation graph of coefficients of the tvar models were approximately sine or cosine curves while for wells k214 n10 232 267 and cq19 they were straight lines as shown in table 2 for wells 589 and w15 the basis functions of the tvar model was the fourier basis function while for wells k214 n10 232 267 and cq19 the basis function was the legendre basis functions this indicated that the variation in the coefficient of the tvar model was related to the basis function selected 3 2 2 comparison of the tvar models with the ari models fig 5 shows the scatter plots of the observed and predicted groundwater depths from the ari and tvar models in the test period in fig 5 the black line represents the 1 1 line and the blue and yellow lines and r2 represent the linear fit lines and r2 values of the ari and tvar models respectively compared with the ari model the fit lines of the tvar models were closer to the 1 1 line and the distribution was more compact moreover the tvar models produced larger r2 values than the ari models these findings suggested that the tvar model outperformed the ari model for the prediction of groundwater depth to compare the model performance in more detail the error indictors of the tvar and ari models in the training and test periods are presented in table 3 in table 3 tvar p 1 m represents the tvar model with order p 1 and dimension m and ari p 2 1 represents the first order differential ar model with order p 2 for the tvar p 1 m model the number of coefficients to be estimated was p 1 m 1 while for the ari p 2 1 model the number of coefficients to be estimated was p 2 as shown in table 3 for all the tvar models the model orders were not greater than 2 and all the dimensions were 1 while for all the ari models the model orders ranged from 1 to 19 this indicated that the tvar model had lower model complexity than the ari model in the test period for the groundwater depth at all wells the tvar models produced smaller rmse and larger nse values than the ari models this further demonstrated that the tvar models exhibited better prediction performance than the ari model however in the training period except for well 232 the error indictors of the tvar models for the other 6 wells were worse than those of the ari models this indicated that the fitting performance of the tvar models was worse than that of the ari model in conclusion compared with the ari model the tvar model both exhibited better prediction performance and had lower model complexity 4 simulation examples to further demonstrate the effectiveness of the model parameter estimation method and the generalization performance of the model we applied the tvar model to the fitting and prediction of the nonstationary series simulated by statistical experiments using the monte carlo method first we simulated four types of nonstationary time series based on the equations labelled a d in table 4 for each equation we simulated 1000 nonstationary series with a length of 312 where the first 252 data points represented the training period and the last 60 data points represented the test period then a tvar model and an ari or sari model were generated for each time series thus for each type of nonstationary series both the tvar and ari or sari models and 1000 corresponding values for the rmse nse model order and dimension of the basis function were obtained finally the performance of the tvar model and ari or sari model was compared by comparing the distribution the mean and standard deviation of the rmse and nse values and the variation in the model order and dimension of the basis function fig 6 shows the time series plots of the simulated series and the results of the models for these simulated series table 5 presents the mean and standard deviation of the rmse and nse for the models in table 4 equation a is the time varying coefficient ar model and equation b is the random walk model with drift to ensure that the time series were nonstationary the autoregressive coefficients in these equations were set to at least 1 equation c is the linear trend model and equation d is the trigonometric function the simulated series based on equation 3 exhibited a trend and those based on equation 4 exhibited periodicity therefore the simulated series based on the above four equations were all nonstationary and moreover they all contained a white noise component as shown in column 1 of fig 6 the 1000 simulated series based on equation a and equation d both exhibited a clear periodicity while those based on equation b and equation c both exhibited a clear trend therefore ari models were generated for the simulated series based on equation b and equation c while sari models were generated for the simulated series based on equation a and equation d in table 5 the sari p 2 1 s represents the first order seasonal differential ar model with order p 2 and s represents the length of the seasons and was determined by the fourier transformation method as shown in columns 2 4 of fig 6 the distributions of the rmse and nse of the ari and sari models were more discrete and their outliers were greater than those of the tvar models for all types of nonstationary series in both the training and test periods this indicated that the ari and sari models fit and predicted some of the simulated series very poorly while the tvar model fit and predicted all the simulated series very well moreover as shown in table 5 for all four types of nonstationary series the tvar models produced a smaller mean rmse larger mean nse and smaller standard deviation rmse and nse than the ari and sari models in both the training and test periods these results indicated that compared with the ari and sari models the tvar model exhibited better fitting and prediction performance for the simulated series and had superior generalization performance in addition as shown in column 6 of fig 6 the orders p 2 of the ari and sari models ranged from 0 to 200 while the orders p 1 of the tvar models ranged from 0 to 10 and their dimensions m ranged from 0 to 5 indicating that the model complexity of the tvar model was lower than that of the ari and sari models in conclusion the statistical experiment further demonstrated the superior prediction performance and lower model complexity of the tvar model compared to the ari and sari models moreover it surprisingly demonstrated that the tvar model exhibited superior fitting performance compared to the ari and sari models which is different from our findings regarding groundwater depth prediction 5 discussion the results of the models for both the groundwater depth series study and the simulated series showed that the tvar model both achieved more accurate prediction results and also had lower model complexity than the time invariant ari and sari models moreover when the ari or sari model is applied to nonstationary time series modelling nonstationary data should be converted into stationary data by ordinary and seasonal difference methods in advance while the tvar model can be directly applied to nonstationary time series without any data preprocessing thus the application of the tvar model to the prediction of nonstationary groundwater depth is more straightforward for the simulated series the tvar produced better fitting results than the ari and sari models while for the nonstationary groundwater depth series the tvar model produced worse fitting results than the ari model this is because when we summarized the parameter estimation methods for the tvar model we considered the prediction performance of the model to be the main objective and although the fitting performance of the model was also taken into account optimizing the fitting performance was not the main objective as shown in fig 3 if the dimension of the basis function was large enough the tvar model achieved excellent fitting performance in conclusion building a tvar model instead of a time invariant ari and sari model results in a model that is more flexible and suitable for the prediction of nonstationary groundwater depth this study provides only a preliminary assessment of the prediction performance for the tvar model which deserves further research to further verify the generalizability of the tvar model a variety of types of hydrological data from different regions of the world should be used in further studies until now basis functions representing only the slow changing parameters have been studied we suggest that further research be conducted to select basis functions representing the sharply changing parameters so that the model structure and the variation of the parameters can be better identified when the point of an abrupt change is known only the tvar model was studied in this paper but since any autoregressive moving average arma model can be equivalently replaced by a higher order ar model future studies could examine the parameter estimation of the time varying autoregressive moving average tvarma model in addition the tvar model is only suitable for a single variable but the time varying vector ar tvvar model is also worthy of study because groundwater depth is generally not forecasted by itself but along with other variables we could also consider combining the tvar model with the time varying variance model such as the generalized autoregressive conditional heteroscedasticity garch model and stochastic volatility sv model to predict the hydrological variables in future studies 6 conclusions the nonstationarity of hydrological variables makes the application of the ar model challenging therefore in this study we introduced a tvar model to the field of hydrology for groundwater depth prediction in this study the parameters of the tvar model were estimated using a method that combines a basis function expansion method with a regression algorithm where the most critical issues are the proper selection of the type and dimension of the basis function the model order and the regression algorithm in this study the optimal basis function was selected by comparing the fourier and legendre functions and the optimal regression algorithm was selected by comparing the rls with the fmrls algorithms moreover the ibic was proposed and compared with the bic for determining the model order and dimension of the basis function to further demonstrate the superiority of the tvar model the time invariant ari and sari models were compared the performance of these models was assessed using both the monthly groundwater depth series of seven monitoring wells in the guanzhong plain china and using nonstationary series simulated in statistical experiments the main contributions of this study were as follows 1 we summarized the process of parameter estimation for the tvar model first the tvar model is transformed into the time invariance regression problem by expanding the time varying coefficients into a set of fourier or legendre basis functions then an fmrls regression algorithm is used to estimate the parameters of this regression problem in this process the model order and dimension of the basis function are determined by minimizing ibic in the range of dimensions greater than 0 2 when compared with the ari and sari models the tvar model exhibited better prediction performance lower model complexity and more convenient and simpler application in conclusion using the tvar model as an alternative to the time invariance ari and sari models results in a model that is more flexible and suitable for the prediction of nonstationary groundwater depth we expect that this work will provide some useful insights and perspectives for future work on the prediction of nonstationary variables in hydrology there are many potential applications of the tvar model in the field of hydrology such as nonstationary diagnostics time frequency analysis and abrupt change detection credit authorship contribution statement tianli guo conceptualization methodology visualization software writing original draft songbai song conceptualization methodology data curation writing review editing supervision validation yating yan visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement and data the authors acknowledge the grant support from the national natural science foundation in china grand number 52079110 the authors wish to thank the respected editor and anonymous reviewers for their valuable comments and insightful suggestions that improve the quality of this manuscript data are available acquired from groundwater level yearbook of shaanxi province compiled by the shaanxi geological environment monitoring station https cugp cug edu cn appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128394 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2938,the nonstationarity of hydrological variables makes the application of autoregressive ar models challenging therefore this study introduces a new time varying ar tvar model in the field of hydrology specifically in this study we focus the parameter estimation of the tvar model and exploring the model s performance for predicting groundwater depth we demonstrate the application of the model to the monthly groundwater depth series obtained on the guanzhong plain china we summarize the process of parameter estimation of the tvar model first the tvar model is transformed into the time invariance regression problem by expanding the time varying coefficients into a set of fourier or legendre basis functions then a fading memory recursive least squares fmrls algorithm is used to estimate the parameters of the regression problem in this process the model order and dimension of the basis function are determined by minimizing our proposed improved bayesian information criterion ibic with a range of dimensions greater than 0 to further demonstrate the effectiveness of the parameter estimation method and the generalizable performance of the model the method is applied to nonstationary series simulated in statistical experiments the study results indicate that the tvar model based on such a parameter estimation process exhibits better prediction performance lower model complexity and more straight forward application compared with the autoregressive integrated ari and seasonal ari sari models in conclusion using the tvar model as an alternative to the time invariance ari and sari models results in a model that is more flexible and suitable for nonstationary groundwater depth prediction keywords time varying autoregressive model groundwater depth prediction basis functions fading memory recursive least squares algorithm improved bayesian information criterion data availability data will be made available on request 1 introduction groundwater depth prediction is key to the sustainable yield of groundwater resources shirmohammadi et al 2013 because of the interaction of climate change and anthropic disturbance groundwater depth data exhibit high nonstationarity which poses great challenges for modelling guo et al 2021 pascucci et al 2020 among the variety of models employed to predict groundwater depth the autoregressive ar model is a benchmark method and plays a significant role in the field of hydrology cui and singh 2015 in recent years much work has been done to improve the modelling and prediction performance of the ar model by studying estimation methods such as maximum entropy and bayesian methods cui and singh 2017 2016 guo et al 2020 wan and xiao 2016 however the fact that the ar model is constructed under the assumption of stationarity remains a drawback bringmann et al 2017 making the ar model unsuitable for the fitting and prediction of nonstationary hydrological variables especially groundwater depth unless the nonstationary data are converted into stationary data by difference methods in advance two commonly used models autoregressive integrated ari models and seasonal autoregressive integrated sari models are a combination of ar models and difference methods however when using difference methods the problem of over differencing often arises in such cases it is necessarily guaranteed that nonstationary series become stationary and some useful information of the series may be lost to overcome these limitations in this study we introduce a new nonstationary time series model namely the time varying autoregressive tvar model to the hydrology field for modelling and predicting nonstationary groundwater depth series the tvar model is an extension of the conventional ar model which considers the model parameters to be time varying unlike the ar model the tvar model can be used directly in the modelling of nonstationary time series without any preprocessing due to its straightforward structure and the incorporation of time varying coefficients the tvar model has been proven to be an effective tool for nonstationary time series analysis wang et al 2021 in the last few years the tvar model has been applied in various fields such as speech parchami et al 2019 economics giraitis et al 2014 lanne and luoto 2017 neuroscience li et al 2019 biomedical science lee and chon 2011 and psychology albers and bringmann 2020 casini et al 2020 it has been applied to various topics such as signal detection and classification gutierrez and salazar varas 2011 li et al 2016a wang et al 2021 spectral estimation fuentealba et al 2019 li et al 2016b and suppression of reverberation parchami et al 2019 the breadth of previous work demonstrated that the results of the tvar model have many applications but the tvar model has not been applied in the field of hydrology and the performance of forecasting based on the model has not been studied the main class of methods for the parameter estimation of the tvar model combine a basis function expansion method with a regression algorithm li et al 2018 the steps for implementing these methods are as follows first the basis function expression method is used to transform the tvar model to the time invariant regression problem then the regression algorithm is used to estimate the parameters of the regression problem the number of unknown parameters of the tvar model that must be estimated using this combined method is substantially reduced xu et al 2017 the most critical issues for the structure identification and parameter estimation of the tvar model are the proper selection of the type and dimension of the basis function tsatsanis and giannakis 1993 the model order khorshidi et al 2011 and the regression algorithm albers and bringmann 2020 however previous researchers overlooked these issues based on the premise that the tvar model yields good fitting results which does not guarantee that the tvar model has good prediction performance therefore the previous parameter estimation methods for the tvar model may not be appropriate for establishing a model for the purpose of prediction although there are many choices for the basis function such as fourier legendre and wavelet basis functions it is difficult to know what class of functions is most suitable for the diverse forms of nonstationary groundwater depth series in fact each family of basis functions has its own unique tractability and accuracy wei and billings 2010 for instance legendre and fourier are appropriate for smooth or slow changing parameters lee and chon 2011 while wavelet is efficient for sharp or fast changing parameters li et al 2011 indeed if the dimension of the basis function is large enough any complete set of basis functions can approximate the coefficients of the tvar model with acceptable accuracy however one must be careful to avoid overfitting the tvar model and increasing its computational complexity both dimension selection and the model order determination are critical to the tvar model to avoid issues such as underfitting overfitting and increasing the computation time of the tvar model order determination is usually performed using the traditional order selection criteria such as the akaike information criterion aic and bayesian information criterion bic to select the number of model coefficients and strike a balance between improving model fit and increasing model complexity li et al 2016a li et al 2016b wang et al 2021 xu et al 2017 these criteria were proposed for the time invariant ar model for which only the influence of model order on model complexity is considered however the complexity of the tvar model is related not only to the model order but also to the dimension of the basis function thus these criteria may not be suitable for the order determination of the tvar model therefore developing a method for reasonably selecting the model order and the dimension of the basis function for the tvar model requires further study for the regression problem the least square ls method is the most commonly used because it can be configured to give unbiased consistent and efficient estimates when the residuals satisfy the basic assumption of white noise guo et al 2016 different from the ordinary least squares ols method the recursive least squares rls algorithm does not require matrix inversion and reduces the memory footprint sung and lee 2019 however increasing the amount of data may introduce the issue of data saturation where adding new data does not improve the estimation of the parameter in the rls model data saturation accentuates the rounding error of the rls algorithm leading to an increasing deviation between the estimated value and the true value jiang et al 2020 to overcome this problem a fading memory recursive least squares fmrls approach was proposed it is an extension of the rls that increases the contribution of new data and reduces the influence of old data by introducing a forgetting factor for old data li et al 2021 su et al 2021 in this paper we use the fmrls algorithm to solve the regression problem in this study we introduce the tvar model to the field of hydrology to predict nonstationary groundwater depths to better estimate the parameter of the tvar model we address the key problems of how to properly select the type and dimension of the basis function the model order and the regression algorithm specifically in this study we select the optimal basis function by comparing fourier with legendre and select the optimal regression algorithm by comparing the rls and fmrls algorithms we propose an improved bic ibic criterion to better determine the model order and dimension of the basis function and compare it with bic to demonstrate the superiority of the tvar model the time invariant ari and sari models are also compared the performance of these models is assessed using both the monthly groundwater depth series of seven monitoring wells in the guanzhong plain in china and nonstationary series simulated by statistical experiments to the authors knowledge this study is the first to provide details regarding the implementation process for parameter estimation in the tvar model for the purpose of prediction we expect that this study will provide some useful insights and perspectives for future work on the prediction of nonstationary hydrological variables 2 development of the tvar model 2 1 basis function expansions of the tvar model considering a zero mean nonstationary process x t t 1 2 n the tvar model of order p is given by 1 x t i 1 p a i t x t i w t where a i t i 1 2 p are the time varying coefficients of the tvar model and w t is white noise with mean of zero and variance σ 2 the time varying coefficients a i t are approximated to linear combinations of a set of basis functions f j t j 0 1 m 2 a i t j 0 m a ij f j t where a ij i 1 2 p j 0 1 m is the weighting coefficient and m is the dimensions of f j t the choice of the basis function is an important part of the modelling process in this study we compare the fourier basis function 3 f j t cos j π t 2 n j e v e n sin j 1 π t 2 n j o d d and the legendre basis function 4 f j t 1 j 0 x j 1 1 n 2 j 1 x f j 1 t j 1 f j 2 t j 1 substituting 2 into 1 yields 5 5 x t i 1 p j 0 m a ij f j t i x t i w t i 1 p j 0 m a ij f j t i x t i w t a new vector x t can be defined as 6 x t f 0 t x t f 1 t x t f m t x t t substituting 6 into 5 yields 7 x t x t t 1 x t t 2 x t t p θ w t where θ a 10 a 11 a 1 m a 20 a 21 a 2 m a p 0 a p 1 a pm t and the upper script t represents the transpose of a matrix equation 7 shows that the tvar model can be treated as a time invariant model since the coefficient vector θ is time invariant denote y x p 1 x p 2 x n t w w p 1 w p 2 w n t x x t p x t p 1 x t p 1 x t p x t n 1 x t n 2 x t 1 x t 2 x t n p t then equation 5 can be written as 8 y x θ w 2 2 recursive least squares for the tvar model equation 8 is a linear regression model and can be solved using the ls method from the perspective of the ls method θ can be obtained by minimizing the total squared error j which can be written as 9 j t p 1 n w t 2 w t w the minimum of equation 9 can be determined by setting the derivative of j with respect to θ to 0 10 j θ θ θ y x θ t y x θ θ θ θ 2 x t y 2 x t x θ 0 then the ls solution of θ can be written as 11 θ x t x 1 x t y let us define the vector y n and the matrix p n 12 y n x n 1 t x n 2 t x n p t t 13 p n i 1 n y t 1 y t 1 t 1 the rls algorithm of θ can be written as 14 θ n θ n 1 k n x n y n t θ n 1 k n p n 1 y n i y n t p n 1 y n p n i k n y n t p n 1 where the initial values of θ n and p n are set to θ 0 0 and p 0 μ i respectively and μ is the mean of x t 2 3 fading memory recursive least squares for the tvar model to attach greater importance to more recent data we introduce the fmrls model which de emphasizes older data by utilizing the forgetting factor λ li et al 2021 for the fmrls θ can be obtained by minimizing the weighted least squares error function j which can be written as 15 j t p 1 n λ n t w t 2 where λ influences the performance of the fmrls algorithm from the aspects of convergence rate tracking misadjustment and stability paleologu et al 2008 and λ 0 1 when the forgetting factor is 1 the fmrls algorithm is equivalent to the traditional rls algorithm motivated by previous studies mirhoseini and tabatabaei 2018 sun et al 2019 λ was set as 0 98 in this study let us define the matrix p n 16 p n 1 λ i 1 n y t 1 y t 1 t 1 the fmrls algorithm of θ can be written as 17 θ n θ n 1 k n x n y n t θ n 1 k n p n 1 y n λ y n t p n 1 y n p n 1 λ i k n y n t p n 1 2 4 determination of the model order and dimension of the basis function for the widely used model selection criteria the bic has greater penalties for free parameters than the aic however the bic may still not be suitable for the order determination of the tvar model because it only considers the influence of model order on model complexity therefore we propose the improved bic ibic which considers the influence of both order p and dimension m on the complexity of the tvar model the ibic is defined as 18 i b i c p m ln σ p m 2 p m 1 n l n n where σ p m 2 is the variance of the residuals of the tvar model 3 results we first applied the tvar model to the simulation and prediction of the monthly groundwater depth series of seven monitoring wells in the guanzhong plain of china through this case study we summarized the implementation process for parameter estimation of the tvar model then to demonstrate the superiority of the tvar model the ari and sari models were compared the model performance was evaluated using two commonly used error analysis indicators the root mean square error r m s e and nash sutcliffe coefficient nse zhang et al 2022 the closer the value of nse is to 1 and the closer the rmse value is to 0 the better the model performance 3 1 study areas and data in this study the monthly groundwater depth data of seven monitoring wells namely k214 n10 589 232 267 cq19 and w15 were used to verify the performance of the tvar model the seven monitoring wells were located in the guanzhong plain shaanxi province china fig 1 the guanzhong plain is found in the middle and lower reaches of the weihe river and is surrounded by mountains in the north south and west zhang et al 2019 it belongs to a continental monsoon climate characterized by abundant precipitation and high temperatures in the summer and little precipitation and low temperatures in winter huang et al 2014 the per capita water resource availability of the guanzhong plain is small and groundwater resources are scarce the monthly groundwater depth data were acquired from the shaanxi province groundwater level yearbooks which were compiled by the shaanxi geological environment monitoring station fig 2 shows graphs of the groundwater depth data and table 1 reports their descriptive statistics in fig 2 the vertical dashed line is the demarcation between the training set and test set the data from the past 5 years formed the test set and the remaining data formed the training set the training set was used to build the tvar model and the test set was used to investigate the prediction performance of the model the time series diagram in fig 2 and the mean and standard deviation stdev deviation coefficients and mean squared successive difference in table 1 showed that all the wells selected exhibited different groundwater dynamics the kwiatkowski phillips schmidt shin kpss test kwiatkowski et al 1992 was used to test the stationarity of the monthly groundwater depth series the null hypothesis of the kpss test is that the time series is stationary and the alternative is that the time series has a unit root which means the time series is nonstationary the p values of the kpss test for all the monthly groundwater depth series were less than the critical value α 0 05 indicating that all monthly groundwater depth series were nonstationary at a specified significance level α 0 05 the nonstationarity of groundwater depth series is mainly caused by trends so the ari model rather than the sari model was compared to the tvar model 3 2 result analysis we first developed the method to identify model order basis function type and dimension and regression algorithm for the tvar model then we selected the best tvar model by comparing the fitting and forecasting performance of tvar models and analysed the variation in the coefficient of the best tvar model finally to demonstrate the benefits of the tvar model we compared the results of the ari model with those of the best tvar model 3 2 1 results analysis of the tvar model to select the optimal information criterion we analysed and compared the variation in the bic ibic and error indicator values of the training and test periods with the order and dimension then based on the optimal criterion selected we compared the performance of the tvar model with different algorithms rls and fmrls and basis functions fourier and legendre functions to select the optimal basis function and algorithm based on the above optimal results we then established the process of implementing parameter estimation for the tvar model finally we analysed the variation in the coefficient of the best tvar model clarification of the intended objectives of modelling has a significant influence on the methods used in the model development process in this study the objective of developing the tvar model was to obtain better prediction performance while balancing this with good model fit therefore the desired method achieves a good fit as well as optimal prediction performance while avoiding underfitting or overfitting we selected the optimal criterion by analysing and comparing the variation in the bic ibic and error indicator values of the training and test periods with order p and dimension m we considered two basis functions and two algorithms so the total number of results that were compared and analysed for the groundwater depth at seven wells was 7 2 2 28 due to space considerations we only reported the results for w15 using the fourier basis function and rls algorithm the maximum dimension was set to 19 and the maximum order was set to 10 fig 3 shows the bic ibic rmse and nse values of the tvar models in the training and test periods with changes in the order and dimension for the groundwater depth at w15 the detailed results for the other 27 conditions are presented in the supplemental material in fig 3 the blue circle marks the minimum of the bic ibic and rmse and the maximum of nse these represent the optimal values of these indicators clearly when p 2 and m 19 the optimal rmse and nse of the training period and bic were obtained when p 2 and m 2 the optimal rmse and nse of the test period were obtained when p 2 and m 0 the optimal ibic was obtained based on these indicators the optimal order was 2 moreover when p 2 the corresponding bic values were significantly smaller than those for other values of the indicating that the order of the tvar model was well determined by minimizing bic however when p 2 with the increase in dimension the bic gradually decreased and the fitting accuracy of the tvar model of the training period gradually improved but the prediction accuracy of the tvar model of the test period gradually worsened when the bic was at its minimum the performance of the tvar model in the training period was excellent but that in the test period was very poor this indicated that when both order and dimension were determined by the minimum bic the computation time increased and poor prediction results were obtained failing to meet the goal of our modelling however when both the order and dimension were determined by the minimum ibic the tvar model exhibited good performance for both the training and test periods therefore we concluded that the ibic was more suitable for selection of the order and dimension of the tvar model than the bic furthermore the results reported in the supplementary materials also showed that the optimal information criterion for all wells was ibic regardless of the algorithm or the basis function to select the optimal basis function type and the regression algorithm we compared the performance of the tvar model under using algorithms rls and fmrls and basis functions fourier and legendre functions where the order of the tvar model and dimension of the basis functions were determined by minimizing ibic the results of the comparison are given in table 2 where the values in bold and the values in bold and italics indicate the optimal prediction results of the tvar model when using the rls and fmrls algorithms respectively table 2 shows the results of two specific tvar models the first is m 0 where m 0 indicates that the tvar model is equivalent to the time invariant ar model the second model is m 0 indicating a time varying model we first discuss the results of the rls algorithm when m 0 the dimension of the basis functions of the tvar models for k214 n10 589 267 cq19 and w15 was 0 since the model explored was a time varying model we reidentified the tvar model in the range of m 0 obviously for the groundwater depth at all wells the dimensions of the tvar models with the optimal prediction results values in bold were greater than 0 similarly when using the fmrls algorithm all the models with the optimal prediction results values in bold and italics were the tvar models with dimensions greater than 0 however the fitting performance of these models in the training period was not the best in summary our conclusion regarding the method for identifying the structure of the tvar model is as follows the model order and dimension of the basis functions for the tvar model should be determined by minimizing ibic in the range of m 0 after comparing the optimal models solved using rls with the optimal models of the models solved using fmrls we concluded that the fmrls algorithm was better values in bold and italics furthermore the optimal models using the fmrls algorithm were also the best among all tvar models these results indicated that the fmrls algorithm outperformed the rls algorithm for the tvar model and all the best tvar models were obtained using the fmrls algorithm however in the training period the model obtained using the fmrls algorithm was superior to that obtained using the rls algorithm in only one case for the groundwater depth at well 267 we examined the basis functions of the best tvar models for wells 589 and w15 the basis function of the best tvar model was the fourier basis function for wells k214 n10 232 267 and cq19 the basis function of the best models was the legendre basis function these results indicated that neither of the two basis functions was consistently better than the other in conclusion when using the fmrls algorithm and the fourier or legendre basis functions and determining the model order and dimension of the basis function by minimizing ibic in the range of m 0 the best tvar models were obtained in summary the following process of implementing parameter estimation for the tvar model is proposed first the tvar model is transformed into the time invariance regression problem by expanding the time varying coefficients into a set of fourier or legendre basis functions then an fmrls regression algorithm is used to estimate the parameters of this regression problem in this process the model order and dimension of the basis function are determined by minimizing ibic in the range of dimensions greater than 0 the tvar models that follow were all identified by the parameter estimation method summarized above and were the best models mentioned previously fig 4 shows the estimation results for the coefficients of the tvar models in fig 4 for wells k214 232 cq19 and w15 the two time varying coefficients a 1 t and a 2 t are shown while for wells n10 589 and 267 only one time varying coefficient a 1 t is shown this is because for wells k214 232 cq19 and w15 the order of the tvar model was 2 while for wells n10 589 and 267 the order was 1 it is obvious from fig 4 that for wells 589 and w15 the variation graph of coefficients of the tvar models were approximately sine or cosine curves while for wells k214 n10 232 267 and cq19 they were straight lines as shown in table 2 for wells 589 and w15 the basis functions of the tvar model was the fourier basis function while for wells k214 n10 232 267 and cq19 the basis function was the legendre basis functions this indicated that the variation in the coefficient of the tvar model was related to the basis function selected 3 2 2 comparison of the tvar models with the ari models fig 5 shows the scatter plots of the observed and predicted groundwater depths from the ari and tvar models in the test period in fig 5 the black line represents the 1 1 line and the blue and yellow lines and r2 represent the linear fit lines and r2 values of the ari and tvar models respectively compared with the ari model the fit lines of the tvar models were closer to the 1 1 line and the distribution was more compact moreover the tvar models produced larger r2 values than the ari models these findings suggested that the tvar model outperformed the ari model for the prediction of groundwater depth to compare the model performance in more detail the error indictors of the tvar and ari models in the training and test periods are presented in table 3 in table 3 tvar p 1 m represents the tvar model with order p 1 and dimension m and ari p 2 1 represents the first order differential ar model with order p 2 for the tvar p 1 m model the number of coefficients to be estimated was p 1 m 1 while for the ari p 2 1 model the number of coefficients to be estimated was p 2 as shown in table 3 for all the tvar models the model orders were not greater than 2 and all the dimensions were 1 while for all the ari models the model orders ranged from 1 to 19 this indicated that the tvar model had lower model complexity than the ari model in the test period for the groundwater depth at all wells the tvar models produced smaller rmse and larger nse values than the ari models this further demonstrated that the tvar models exhibited better prediction performance than the ari model however in the training period except for well 232 the error indictors of the tvar models for the other 6 wells were worse than those of the ari models this indicated that the fitting performance of the tvar models was worse than that of the ari model in conclusion compared with the ari model the tvar model both exhibited better prediction performance and had lower model complexity 4 simulation examples to further demonstrate the effectiveness of the model parameter estimation method and the generalization performance of the model we applied the tvar model to the fitting and prediction of the nonstationary series simulated by statistical experiments using the monte carlo method first we simulated four types of nonstationary time series based on the equations labelled a d in table 4 for each equation we simulated 1000 nonstationary series with a length of 312 where the first 252 data points represented the training period and the last 60 data points represented the test period then a tvar model and an ari or sari model were generated for each time series thus for each type of nonstationary series both the tvar and ari or sari models and 1000 corresponding values for the rmse nse model order and dimension of the basis function were obtained finally the performance of the tvar model and ari or sari model was compared by comparing the distribution the mean and standard deviation of the rmse and nse values and the variation in the model order and dimension of the basis function fig 6 shows the time series plots of the simulated series and the results of the models for these simulated series table 5 presents the mean and standard deviation of the rmse and nse for the models in table 4 equation a is the time varying coefficient ar model and equation b is the random walk model with drift to ensure that the time series were nonstationary the autoregressive coefficients in these equations were set to at least 1 equation c is the linear trend model and equation d is the trigonometric function the simulated series based on equation 3 exhibited a trend and those based on equation 4 exhibited periodicity therefore the simulated series based on the above four equations were all nonstationary and moreover they all contained a white noise component as shown in column 1 of fig 6 the 1000 simulated series based on equation a and equation d both exhibited a clear periodicity while those based on equation b and equation c both exhibited a clear trend therefore ari models were generated for the simulated series based on equation b and equation c while sari models were generated for the simulated series based on equation a and equation d in table 5 the sari p 2 1 s represents the first order seasonal differential ar model with order p 2 and s represents the length of the seasons and was determined by the fourier transformation method as shown in columns 2 4 of fig 6 the distributions of the rmse and nse of the ari and sari models were more discrete and their outliers were greater than those of the tvar models for all types of nonstationary series in both the training and test periods this indicated that the ari and sari models fit and predicted some of the simulated series very poorly while the tvar model fit and predicted all the simulated series very well moreover as shown in table 5 for all four types of nonstationary series the tvar models produced a smaller mean rmse larger mean nse and smaller standard deviation rmse and nse than the ari and sari models in both the training and test periods these results indicated that compared with the ari and sari models the tvar model exhibited better fitting and prediction performance for the simulated series and had superior generalization performance in addition as shown in column 6 of fig 6 the orders p 2 of the ari and sari models ranged from 0 to 200 while the orders p 1 of the tvar models ranged from 0 to 10 and their dimensions m ranged from 0 to 5 indicating that the model complexity of the tvar model was lower than that of the ari and sari models in conclusion the statistical experiment further demonstrated the superior prediction performance and lower model complexity of the tvar model compared to the ari and sari models moreover it surprisingly demonstrated that the tvar model exhibited superior fitting performance compared to the ari and sari models which is different from our findings regarding groundwater depth prediction 5 discussion the results of the models for both the groundwater depth series study and the simulated series showed that the tvar model both achieved more accurate prediction results and also had lower model complexity than the time invariant ari and sari models moreover when the ari or sari model is applied to nonstationary time series modelling nonstationary data should be converted into stationary data by ordinary and seasonal difference methods in advance while the tvar model can be directly applied to nonstationary time series without any data preprocessing thus the application of the tvar model to the prediction of nonstationary groundwater depth is more straightforward for the simulated series the tvar produced better fitting results than the ari and sari models while for the nonstationary groundwater depth series the tvar model produced worse fitting results than the ari model this is because when we summarized the parameter estimation methods for the tvar model we considered the prediction performance of the model to be the main objective and although the fitting performance of the model was also taken into account optimizing the fitting performance was not the main objective as shown in fig 3 if the dimension of the basis function was large enough the tvar model achieved excellent fitting performance in conclusion building a tvar model instead of a time invariant ari and sari model results in a model that is more flexible and suitable for the prediction of nonstationary groundwater depth this study provides only a preliminary assessment of the prediction performance for the tvar model which deserves further research to further verify the generalizability of the tvar model a variety of types of hydrological data from different regions of the world should be used in further studies until now basis functions representing only the slow changing parameters have been studied we suggest that further research be conducted to select basis functions representing the sharply changing parameters so that the model structure and the variation of the parameters can be better identified when the point of an abrupt change is known only the tvar model was studied in this paper but since any autoregressive moving average arma model can be equivalently replaced by a higher order ar model future studies could examine the parameter estimation of the time varying autoregressive moving average tvarma model in addition the tvar model is only suitable for a single variable but the time varying vector ar tvvar model is also worthy of study because groundwater depth is generally not forecasted by itself but along with other variables we could also consider combining the tvar model with the time varying variance model such as the generalized autoregressive conditional heteroscedasticity garch model and stochastic volatility sv model to predict the hydrological variables in future studies 6 conclusions the nonstationarity of hydrological variables makes the application of the ar model challenging therefore in this study we introduced a tvar model to the field of hydrology for groundwater depth prediction in this study the parameters of the tvar model were estimated using a method that combines a basis function expansion method with a regression algorithm where the most critical issues are the proper selection of the type and dimension of the basis function the model order and the regression algorithm in this study the optimal basis function was selected by comparing the fourier and legendre functions and the optimal regression algorithm was selected by comparing the rls with the fmrls algorithms moreover the ibic was proposed and compared with the bic for determining the model order and dimension of the basis function to further demonstrate the superiority of the tvar model the time invariant ari and sari models were compared the performance of these models was assessed using both the monthly groundwater depth series of seven monitoring wells in the guanzhong plain china and using nonstationary series simulated in statistical experiments the main contributions of this study were as follows 1 we summarized the process of parameter estimation for the tvar model first the tvar model is transformed into the time invariance regression problem by expanding the time varying coefficients into a set of fourier or legendre basis functions then an fmrls regression algorithm is used to estimate the parameters of this regression problem in this process the model order and dimension of the basis function are determined by minimizing ibic in the range of dimensions greater than 0 2 when compared with the ari and sari models the tvar model exhibited better prediction performance lower model complexity and more convenient and simpler application in conclusion using the tvar model as an alternative to the time invariance ari and sari models results in a model that is more flexible and suitable for the prediction of nonstationary groundwater depth we expect that this work will provide some useful insights and perspectives for future work on the prediction of nonstationary variables in hydrology there are many potential applications of the tvar model in the field of hydrology such as nonstationary diagnostics time frequency analysis and abrupt change detection credit authorship contribution statement tianli guo conceptualization methodology visualization software writing original draft songbai song conceptualization methodology data curation writing review editing supervision validation yating yan visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement and data the authors acknowledge the grant support from the national natural science foundation in china grand number 52079110 the authors wish to thank the respected editor and anonymous reviewers for their valuable comments and insightful suggestions that improve the quality of this manuscript data are available acquired from groundwater level yearbook of shaanxi province compiled by the shaanxi geological environment monitoring station https cugp cug edu cn appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128394 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2939,excellent water quality wq is an indispensable element in ensuring sustainable water resource development it is highly associated with the 3rd good health and well being the 6th clean water and sanitation and the 14th life below water listed items of the united nations sustainable development goals thus policymakers have always been seeking strategies to manage wq efficiently recent advancements in computational technologies have created enthusiasm for using artificial intelligence particularly deep learning dl in wq management this review provides a comprehensive overview of the application of dl in wq management covering developments from 2011 to 2022 in maintaining the temporal relevance of this review in this paper a brief description of different variants of dl models including the recurrent neural network rnn long short term memory network lstm convolutional neural network cnn etc are presented the distinct approaches in the optimization hybridization and relevant data pre processing techniques suitable for the dl models are also discussed this is the first review paper that extensively discusses the application of dl models for forecasting wq parameters in various water bodies such as rivers lakes coastal areas etc the emergence of the internet of things iot and cloud computing that revolutionized dl approaches in wq management are also presented this review paper serves as a complete easy guideline for the researchers in the field of dl based wq management the findings of this review paper may help policymakers to enhance their decision making process with the hope that regional environmental welfare can drastically be improved keywords deep learning water quality prediction signal denoising convolutional neural network long short term memory gated recurrent unit data availability data will be made available on request nomenclature abbreviations 3d three dimensional ae autoencoders ai artificial intelligence an ammoniacal nitrogen anfis adaptive neuro fuzzy inference system ann artificial neural network arima autoregressive integrated moving average bi gru bi directional gated recurrent unit bi lstm bi directional long short term memory bi rnn bi directional recurrent neural network bod biochemical oxygen demand bpnn back propagation neural network ceemdan complete ensemble empirical mode decomposition with adaptive noise cnn convolutional neural network dbn deep belief network dl deep learning do dissolved oxygen dt decision tree ec electrical conductivity ed encoder decoder eemd ensemble empirical mode decomposition efdc environment fluid dynamics code el event triggered learning elm extreme learning machine emd empirical mode decomposition esn echo state network ga genetic algorithm gbdt gradient boosting decision tree gbrt gradient boosted regression tree h hour hopls higher order partial least squares imf intrinsic mode function iot internet of things knn k nearest neighbours lr linear regression lssvm least squares support vector machines lssvr least squares support vector regression mae mean absolute error ml machine learning mlp multilayer perceptron mt multi task learning nse nash sutcliffe efficiency pca principal component analysis pg process guided pso particle swarm optimization r2 coefficient of determination rbf radial basis function rf random forest rgn recurrent graph network rmse root mean squared error rnn recurrent neural network sae sparse autoencoder sarima seasonal autoregressive integrated moving average sg savitzky golay smote synthetic minority oversampling technique sru simple recurrent unit sss sea surface salinity stvar space time autocorrelation svm support vector machine svr support vector regression tcn temporal convolutional network tds total dissolved solids tl transfer learning tn total nitrogen tp total phosphorus tss total suspended solids vmd variational mode decomposition wq water quality wqi water quality index wwtp wastewater treatment plant 1 introduction the management and regulation of water quality wq are worldwide challenges since the wq is affected by both local processes e g point source pollution and global processes weather patterns some of these involve human decisions that are difficult to predict or manage e g the use of fertilizers while some are beyond that of a manager s control e g accidental events de paul obade and moore 2018 salerno et al 2018 kachroud et al 2019 destandau and zaiter 2020 vast efforts have been made to resolve the issues related to wq management including real time monitoring wq parameters modelling and forecasting based on computer simulation or artificial intelligence ai these efforts are aligned well with the 6th sustainable development goal clean water and sanitation as endorsed by the united nations over the past decade there has been growing interest amongst the scientific community to apply machine learning ml or ai tools for modelling wq this evolution is proven through the increase in the number of scopus indexed publications on managing wq using ml or ai tools fig 1 shows the results of this comprehensive statistical study using the scopus search engine over the past decade to obtain the number of publications discussing the application of ml or ai for wq management a paper search was done on the scopus database using several keywords including machine learning artificial intelligence and water quality from 2011 to 2022 similarly the search term deep learning was included to obtain the number of publications that had applied dl models for wq management it can be seen that since 2016 the number of research publications concerning wq management using ai or ml has been increasing annually this observation is in agreement with the increase in the proportion of studies using dl models in wq related research works in other words the research field is experiencing tremendous growth with the improvement of computing facilities alongside the development of various technologies and algorithms the potential of ml of ai in wq management particularly within the aspect of decision relevant prediction has been proven varadharajan et al 2022 numerous studies had been conducted to investigate the feasibility practicability and efficiency of ml or ai in wq management while several review articles had been published to summarize and criticize the available literature despite this the authors are still eager to build on the previous reviews in the literature as there is insufficient coverage in certain key areas for instance zhao et al 2020 only focused on reporting the utilization of ai in the operation of wastewater treatment plants wwtp the ai tool is usually used for estimating the influent and effluent wq parameters and controlling the operations of the wwtp to improve cost efficiency as such the scope of the review remains relatively narrow and thus can be extended tiyasha et al 2020 conducted a literature survey of wq modelling using ai models over the past two decades i e 2000 to 2020 the review stressed various types of data input in terms of the time scales and parameters and output wq parameters performance metrics used and the variant of ai models it should be noted that the papers reviewed by tiyasha et al 2020 only encompassed some well known conventional ai models such as the artificial neural network ann support vector machine svm and the adaptive neuro fuzzy inference system anfis models as well as their hybrid counterparts nature inspired algorithms and wavelet transformation but inadvertently having left out reviewing studies related to dl models it must be stressed that the authors were only interested in the wq of river water which somehow or rather made the review lack comprehensiveness in another similar review rajaee et al 2020 reassessed the single and hybrid models in wq management of river waters the key difference between this review and that of tiyasha et al 2020 is that the technical focus of this review is on the techniques used for data preparation before the wq modelling which involves data splitting and data normalization however this review complemented the previous work of tiyasha et al 2020 by including some other models that are time scales dependent such as the autoregressive integrated moving average arima model and the mann kendall analysis content wise the works of tiyasha et al 2020 and rajaee et al 2020 exhibited high similarities and whereby extended works are needed in the future in a recent study ighalo et al 2021 enhanced the review scope to include all surface water bodies although the authors strived to include more water bodies in their review paper the comprehensiveness of this publication was limited because the authors only reviewed ml or ai tools that had utilized the ann model another literature survey by mustafa et al 2021 included the deployment of the internet of things iot devices in a similar application however the paper only included an introduction to the iot devices without going into the substantial analysis and discussion on the importance of the subject matter taking a closer look at fig 1 readers might observe that the share of publications related to the application of dl models in wq management has been increasing since 2017 this can be attributed to the improvement in the computational facilities and the rejuvenation of dl models in the scientific communities yet all the previous review papers did not include the role of dl models in wq management in the scope of the study thus a review paper that discusses the role and significance of dl models in the context of wq management would indeed be most helpful and much needed hence the authors of this review attempt to provide an inclusive review and literature survey on the application of dl models in wq management the scope of this review paper shall not be constrained to the river water only as portrayed by several earlier reviews but also include every possible kind of water body this review paper is expected to cover necessary elements such as background theories modifications and applications of dl models in advanced wq management the structure of this review paper is partitioned into several sections section 2 introduces the dl models that are commonly used for wq management section 3 extends the discussion to include hybrid dl models via different hybridization techniques in section 4 the application of dl models in various wq management scenarios is thoroughly reviewed section 5 provides an outlook for the iot application concerning the dl model application in wq management sections 6 and 7 give a visionary future trend and prospect of this research field before the concluding remarks fig 2 illustrates the overall review framework which was created upon obtaining some meaningful inspiration from herman et al 2015 table 1 is presented to ease the readers in locating the topics and information that they might be interested in it summarizes the reading priorities recommendations for researchers and readers who may have different needs 2 deep learning dl models dl as the ml subdomain comprises algorithms that build neural networks imitating the human brain for learning and analysis purposes dogo et al 2019 it is described as an ann approach with many layers of depth in the architecture hence the associated phrase deep unlike the traditional shallow learning method deep architectures model high level abstractions in data via multiple non linear transformations and enhance the extraction of in depth information fig 3 illustrates the types of dl architecture widely adopted for feature detection clustering dimensionality reduction solving classification and regression problems in the field of wq management the recurrent based neural networks are widely adopted for wq parameter forecasting 2 1 recurrent neural network rnn 2 1 1 architecture of recurrent neural network rnn the recurrent neural network rnn is an ann that is specifically designed for handling sequential data a typical ann can be represented by a system of interconnected neurons as shown in fig 4 where the input layer receives the inputs the hidden layers process the information and the output layer generates the outcome chia et al 2020 the neurons in different layers are interconnected with some weights and run specific activation functions to map inputs to the output in general the neurons of the same layer should run identical activation functions hence the type of the layer can be determined by the activation function itself sit et al 2020 the multilayer perceptron mlp the most common form of the ann contains at least a hidden layer with each neuron connected to every neuron in the adjacent layer to form a fully connected fc neural network the ann is also known as a feed forward neural network because inputs were only processed in the forward direction owing to this the ann is unable to capture sequential information from the input data which is crucial for time series forecasting from fig 5 the forward propagation of the rnn is similar to that of the ann with a single hidden layer but the rnn receives an additional value calculated by the activation function at the previous time step this looping constraint allows the rnn to generate memory states and build the relationship between data from different time steps despite being a strong learning model capable of handling temporal features the rnn is difficult to be trained and suffers from exploding or vanishing gradient problems riedmiller 1994 chen et al 2018 with the conventional back propagation through time or real time recurrent learning the error signals backflow in time would lead to oscillating weights rendering the learning process not working at all bengio et al 1994 werbos 1988 echo state network esn and simple recurrent unit sru the base rnn is rarely used for wq forecasting but many researchers would compare their newly developed model with the base rnn to outline how much significant improvement has been achieved some variants were developed based on the rnn architecture such as the echo state network esn and the simple recurrent unit sru liu et al 2019a liu et al 2020 the sru simplifies the computation in such a way that each step is only dependent on the current input of the recurrence lei et al 2017 this initiative helps to avoid the costly computation of matrix multiplication and hence the sru could be trained as fast as a convolutional layer when applied to water temperature and ph forecasting the sru demonstrated a higher degree of fitting than that of the rnn liu et al 2019a it was believed that the additional cell state in the hidden layer of the sru was responsible for judging and filtering effective information during the training process liu et al 2020 further improved the sru model by designing a bi directional stacked sru model whereby the forward and backward sru were superimposed into each training sequence so that each point would have both the past and future context information the proposed model was able to achieve 94 of accuracy for multistep ahead forecasting and outperformed the rnn lstm and sru in comparison the rnn was over fitting due to model complexity and did not converge to the global minimum apart from these a deep esn was also developed for wq prediction the esn model is an rnn with a hidden layer defining the state dynamics of the network jaeger 2007 kim et al 2020b designed a deep esn model that is comprised of a hierarchy of stacked recurrent layers for which the output of each layer will be fed into the next layer the proposed deep esn model has demonstrated lower prediction errors than the extreme learning machine elm random forest rf and gradient boosted regression trees gbrt in the prediction of bod however the authors seldom compare their model performance with the benchmark lstm and gru models as both the sru and esn were reported to have a lower computational cost along with better prediction performance further studies focussing on the subject are highly recommended 2 2 long short term memory lstm to solve the long term dependency issues of the rnn hochreiter and schmidhuber 1997 proposed the lstm model with a gating mechanism it is a type of recurrent neural network that has a cell state for remembering longer term dependencies information usage and storage are modulated by a series of gates that can remove and add information to the cell state a thorough explanation of the lstm architecture can be found in shen 2018 and chen et al 2018 in wq parameter forecasting the lstm serves as a benchmark for comparison whenever researchers built a new model the lstm model also serves as the fundamental block for hybridization with other statistical tools ml or dl models for the do and total phosphorus tp forecasting the lstm outperformed the back propagation neural network bpnn and the online sequential elm by demonstrating higher prediction accuracy and generalization regardless of data quality wang et al 2017 liang et al 2020 showed that a simple lstm structure with five hidden layers could simulate the forecast capacity of the environment fluid dynamics code efdc in predicting chlorophyll α concentration up to 31 days ahead apart from these the lstm was used to process remote sensing based datasets and make predictions on coastal algae bloom shin et al 2019 the lstm has been frequently modified by researchers and now comes in several variants graves and schmidhuber 2005 first proposed the bi directional lstm bi lstm whereby the data was fed in both the normal and reversed time order while there will be no communication between both hidden layers to ensure that the expanded graph is acyclic some researchers reported that the bi lstm learns faster than the unidirectional approach in handling sequential data siami namini et al 2019 abduljabbar et al 2021 for wastewater cod prediction the bi lstm outperformed the ml models svm and regression tree as the former could control data propagation to prevent gradient explosion guang et al 2019 however the standard lstm fared relatively well than the bi lstm since the cod prediction is a one sided problem this finding is in contradiction to that of cheng et al 2020 who found that the bi lstm outperformed the lstm in wwtp key features forecasting the authors believed that the bi lstm employed both historical and future data to improve its prediction performance since a valid conclusion could not be drawn from these studies further studies on the above subject are recommended to challenge the models in more wq datasets cho and park 2019 designed a merged lstm that combined the outputs from three parallel lstms into a fully connected layer for multi step ahead chlorophyll α prediction unlike a conventional lstm model additional wq and weather data from a nearby station were fed into different lstms and trained separately the merged lstm performed better than the conventional lstm and mlp models but at a higher computational time cost nevertheless song et al 2020b used the merged lstm for sea surface height anomaly detection this is a time series forecasting problem where the hidden discipline in short time series was extracted to tackle the long term dependence of series changes the application of the merged lstm could be extended to the spatiotemporal prediction of wq in lakes mariculture ponds and wwtp based on auxiliary data collected from nearby stations the correlation analysis or dimensionality reduction tools may be handy in terms of reducing the complexity of the auxiliary data other recurrent based networks could also be merged for better performance in the spatiotemporal prediction of wq parameters 2 3 gated recurrent unit gru cho et al 2014 introduced a gated recurrent unit gru network that modulates information flow without using separate storage where only two gates are present in the base gru the reset gate is responsible for the short term memory by combining new input and historical memory which is analogous to the combination of input and forgot gates in the lstm the update gate on the other hand behaves like an output gate and decides how much of the previous state shall be kept for long term memory a detailed explanation on the gru model architecture and its structure is given in chen et al 2018 in general the gru exhibited better performance than the lstm on a small dataset gruber and jockisch 2020 the gru also converged much faster than the lstm with a higher training efficiency cheng et al 2020 qin 2019 reported that the gru outperformed the convolutional neural network cnn lstm temporal convolutional network tcn and the bi directional rnn bi rnn for forecasting do time series however on the contrary loc et al 2020 showed that the gru was sensitive to the extreme values in the dataset while the lstm was more successful in representing a time series with smooth and repeating patterns without random fluctuations when dealing with a large dataset the gru may fail to capture a long term correlation and be trapped in a gradient vanishing problem song et al 2020a thus the gru provides a trade off between accuracy and training time for practical problems involving a large dataset with a long temporal sequence zhang et al 2018a it is worth mentioning that both the lstm and the gru often outperformed the rnn and other ml models given that the former can preserve important features through various gates to ensure they will not be lost during long term propagation as a result both the gru and lstm currently represent the state of the art and most highly benchmarked modern models in many applications 2 4 convolutional neural network cnn a typical cnn is comprised of the convolutional pooling and fc layers and adopts the way of local connection and weight sharing the convolution layer contains a series of filters that slide across the image to make a dot product with the input data the pooling layer reduces the dimension of the matrix produced and the fc layer condenses the extracted feature to produce the final result hu et al 2020a for a more extensive explanation of the cnn architecture and computational approaches readers could refer to a state of art review article published by alzubaidi et al 2021 as the cnn is capable of extracting sophisticated features from multidimensional data it can be used to process imagery data for regression and classification for instance song and kim 2020 employed the cnn for building pollutants load prediction model using hydrological images as the input the cnn was also trained on spatiotemporal wq data generated by a hydrological model for the algal bloom prediction pyo et al 2020 the model maintained a satisfying performance with a significant decrease in the temporal frequency and the volume of spatial data xue et al 2021 reported that the cnn outperformed the traditional models such as the linear regression lr and partial least squares regression plsr in estimating lake chlorophyll α based on remote sensing images apart from the prediction accuracy the weight sharing characteristic of the cnn decreases the number of trainable network parameters and speeds up the training process the neurons corresponding to the same features will be triggered in varied scenarios hence would improve the generalization ability of the model also training a model on low resolution data saves time and allows for high resolution data to be predicted more quickly alzubaidi et al 2021 owing to this researchers hybridized the cnn with other time series forecasting models to extract important features from a large dataset such a hybridization network would significantly lower computational time cost and improve model prediction performance and this is discussed in the next section 2 5 temporal convolutional network tcn the temporal convolutional network tcn was proposed by bai et al 2018 for sequence modelling tasks the tcn adopts the 1d fully convolutional network architecture so that both input and output would share the same length the building block of tcn which is commonly known as the residual unit stacks two dilated causal convolution layers together where the causal convolutions ensure that future information does not leak into the past qin 2019 by skipping the connection within the residual unit the tcn allows propagation with a larger but stable gradient along the neural network however the tcn takes in the raw sequence up to the effective history length during evaluation and may perform poorly during domain transfer due to a small receptive field the tcn has demonstrated excellent performance in anomaly detection owing to its capability in exploring the temporal dependencies over a remarkably long historical period song et al 2020a owing to the same reason the tcn also exhibited better performance than the recurrent counterparts in predicting the brunett river dissolved oxygen do and water temperature zhang et al 2019 it was believed that the tcn adopted convolutional filters of different sizes to collect temporal dependencies at different time scales with the dilated convolutions that increase the receptive field the long historical data can be utilized for learning and prediction purposes however qin 2019 reported that the gru outperformed the tcn in predicting do at the yangtze river based on the study the gru is probably a better option over the tcn for wq prediction despite of the plenty factors that may affect the performance of the models as such more studies can be conducted to challenge the tcn in different types of wq datasets before a valid conclusion is drawn 2 6 deep belief network dbn and restricted boltzmann machine rbm the restricted boltzmann machine rbm comprised of a visible and a hidden layer which can automatically detect inherent patterns in the data by reconstructing the inputs however the rbm is unable to tackle vanishing gradient problems hence using the deep belief network dbn would be more favourable in most situations the dbn is designed in such a way that multiple rbms are stacked together where the output of a low level rbm would serve as the input for the high level rbm wu et al 2015 the training process is repeated for all layers to ensure each rbm learns the entire input unlike in the cnn where the convolutional layer detects patterns and the pooling layer recombines them subsequently a detailed explanation of the architecture of the dbn can be found in shen 2018 the dbn has been widely adopted for many applications including wq point estimation and time series forecasting most wq related studies employed a five layered dbn with three stacked rbms as hidden layers zhang et al 2016 lin et al 2018 ren et al 2020 the first rbm receives the inputs while the high level rbms further extract the characteristic of influencing factors with their weights updated automatically the deep architecture of the dbn with adequate hidden layers has demonstrated better generalization and accuracy than the bpnn zhang et al 2016 similarly ren et al 2020 found that the dbn outperformed the decision tree dt and cnn regression models in aquaculture pond do prediction however the authors did not compare their models with the lstm and gru despite both being well known for handling temporal sequence data the genetic algorithm ga was used to optimize the dbn for effluent cod and ss prediction niu et al 2020 the study showed that the optimal number of rbm layers varies according to different datasets and applications and scholars may refer to the methods proposed by montúfar 2014 to approximate the minimum number of layers required for their dbn network apart from modifying the internal structure the dbn applications in wq related studies involving hybridization with other models and this will be discussed in section 3 2 7 comparisons of deep learning models table 2 summarizes the architecture and characteristics of each of the dl models this could serve as a quick reference for future scholars who wish to have a fresh start in selecting an appropriate dl model in the wq prediction as a rule of thumb the researchers shall first adopt the lstm and the gru for conventional wq time series forecasting 3 deep learning hybrid models 3 1 convolutional neural network cnn hybrid models hybridization of models of different architectures may allow inherent information about the data to be extracted given that the cnn is specifically designed to handle data with similar grid weight the characteristic of local connection weight sharing and pooling could effectively reduce network complexity and training parameters for instance fan and zhang 2020 reported that the cnn outperformed the principal component analysis pca in extracting useful features when coupling with the svr for bod prediction in another study lee et al 2020b opined that each layer of the cnn takes a few adjacent features and may not fully consider relationships among all input features a higher order partial least squares hopls regression model was hybridized with the cnn to improve its performance in algal bloom prediction despite the cnn could effectively extract key input features from multi dimensional datasets the standalone cnn gave the worst performance in predicting ammonia as compared to the gru lstm and svr wang et al 2020a similar findings were reported by wang et al 2019b and barzegar et al 2020 who developed the cnn lstm for the wwtp and lake wq prediction respectively in the studies the cnn serves as an ideal feature extractor when hybridized with the time series forecasting model apart from improving prediction accuracy the cnn reduces the complexity of the training parameters and converges with lesser epochs balderas et al 2019 3 2 lstm based and gru based hybrid models 3 2 1 hybridization with convolutional neural network cnn wang et al 2016 first designed the cnn lstm to predict valence arousal ratings the regional cnn divides input text into several regions so that useful information in each region could be extracted and weighted then sequentially integrated via the lstm for valence arousal rating prediction similarly the cnn lstm was adopted for handling multi dimensional wq where the cnn extracts deep features of the main elements while the lstm performs temporal forecasting based on these in depth features the cnn lstm has been reported with higher stability when handling data with large fluctuations wang et al 2019b baek et al 2020 in another study barzegar et al 2020 discovered that the lstm was better in predicting the high concentration of parameters while the cnn was good at low concentration situations the hybrid cnn lstm model combined the strengths of both models and enhanced the prediction accuracy baek et al 2020 the gru which regularly outperforms the lstm was also hybridized with the cnn for wq prediction tu et al 2019 hu et al 2020a song et al 2020a the strength possessed by the cnn and gru in processing high dimensional and time sequence data respectively renders both models a perfect match for handling spatiotemporal datasets the architecture of the cnn gru is nearly comparable to that of the cnn lstm except for the recurrent module apart from the superior stability the cnn gru could be trained faster as the cnn had sped up the process of inherent feature extraction tu et al 2019 pan et al 2020 in another study song et al 2020a used the cnn as a down sampling network and assisted the grus in extracting the overall trend and the local short term pattern from the dataset as a result the cnn gru outperformed the statistical arima ml svr and ann and dl rnn and tcn models in predicting sea surface salinity sss 14 days ahead 3 2 2 hybridization with statistical models traditional statistical models use the linear relationship between data to capture its trend and face some shortcomings when dealing with complex non linear relationships between features on the other hand the dl models offered better predictions but a massive amount of training data would be required as such xu et al 2019 coupled the seasonal autoregressive integrated moving average sarima and the lstm for coastal pollutant prediction the authors first reported that the sarima could not react to the sudden change while the lstm failed to capture annual periodicity probably due to the limited amount of training data provided the sarima lstm hybrid model was improved based on these two models and resulted in a lower prediction bias by providing auxiliary data to the multi featured sarima lstm the model prediction accuracy and stability were further enhanced to the best of the authors knowledge the hybridization of the statistical model and the gru for wq modelling is rarely reported thus could be an avenue for future study 3 2 3 hybridization with other ml algorithms as an unsupervised learning neural network the autoencoder ae had been widely used in data compression dimensionality reduction and feature extraction projects for decades a conventional ae comprises an encoder that maps the inputs into the code while a decoder performs a decoding task to reconstruct the inputs for a detailed explanation of the algorithm the readers are referred to zhang and jin 2020 in terms of application the ae was employed for filling missing data in the wq time series shu et al 2021 li et al 2018 adopted the sparse autoencoder sae to extract deep latent features from wq and meteorological data and significantly improved the performance of the lstm however the spatiotemporal correlation of the wq fluctuations was not considered hence there is still room for improvement since then zhang and jin 2020 proposed the ae lstm for spatiotemporal prediction of river nutrients which had outperformed the conventional lstm the excellent performance of this hybrid model can be attributed to i establishing spatiotemporal characteristics of the wq parameters in the upstream and downstream stations ii feature dimensionality reduction using the ae iii superiority of the lstm algorithm for processing time series the gradient boosting decision tree gbdt was also coupled with the lstm for aquaculture do forecasting huan et al 2020 the gbdt effectively performed feature selection to reduce unnecessary information in the model thus resulting in higher prediction accuracy it is surmised here that the proposed gbdt lstm models could be gainfully challenged with the gru a competing model of the lstm as such the performance of the cnn ae and gbdt as feature extraction tools could be compared accordingly to handle a sparse dataset the factorization machine with the seq2seq framework was coupled with the gru for do forecasting xu et al 2021 the factorization machine obtained interacting correlations between diverse index values and processed them as an input to the gru model thus significantly improving model prediction accuracy and outperforming the conventional dl ml and statistical models in another study the gradient boosting regression tree gbrt was coupled with the attention based gru for three dimensional 3d do forecasting where the gbrt was used as a spatial prediction model to estimate local do concentration in the pond cao et al 2021 the gbrt is capable of processing a wide range of data types and is quite resilient when dealing with outlier data points thus granting the model additional advantages when dealing with a small dataset of fewer features 3 3 deep belief network dbn hybrid models given that improper design would lead to longer training time and poor accuracy qiao et al 2018 proposed a self organizing dbn network to adjust the number of hidden layers and hidden neurons based on an automatic growing and pruning algorithm the self organising dbn has accelerated the learning process and demonstrated robustness in tolerating input fluctuations wang et al 2020b proposed the recursive time dbn in such a way that the input layer received the current moments and historical time values of the characterization factors and influencing factors the resulted hybrid model outperformed the base dbn and lstm models in forecasting algae density to improve the model training efficiency wang et al 2021 proposed the dbn with an event triggered learning algorithm dbn el to ignore ineffective data pairs such as outliers the dbn el converged much faster without noticeable fluctuations as it benefited from the selective response mechanism nevertheless the prediction accuracy of the dbn el was higher than the conventional dbn and sparse deep belief fuzzy neural network by demonstrating higher fitting further experiments also showed that the dbn el has a stronger capability in predicting tp concentration with a shorter runtime apart from using the dbn as a forecasting model qin et al 2017 used the dbn as an unsupervised feature extractor to assist the arima in red tide biomass forecasting wang et al 2020c coupled the dbn with multivariate space time autocorrelation stvar to extract useful features from the multivariate wq and weather data then fused it into the anfis for spatiotemporal chlorophyll α prediction in another study the dbn excavated essential characteristics of the wq parameters for total nitrogen tn prediction and effectively reduced overall prediction errors by 50 as compared to that of standalone lssvr yan et al 2020 3 4 denoising based hybrid models denoising algorithms such as the empirical mode decomposition emd ensemble emd eemd and the ceemdan are frequently used to decompose original time series data into several stable intrinsic mode functions imfs to ease modelling in some cases the high frequency imfs may be recognized as noise and are to be removed from the model input the emd is a signal adaptive decomposition technique proposed by huang et al 1998 that decomposes complicated signals according to the local characteristic time scale the eemd which was proposed by wu and huang 2009 is mainly used to overcome the mode mixing problem in the emd through the addition of an ensemble of white noise to the signal the added white noise generates a uniform reference frame in the time frequency space so that the signal of a similar scale can be collated into the same imf torres et al 2011 then invented the ceemdan that removes residue white noise completely upon decomposition which ensured a better spectral separation of modes at lower computational cost the mathematical theories behind the denoising algorithms could be referred to in the said literature the excellent performance of denoising algorithms in improving the ml models has been reported by lu and ma 2020 the authors also suggested that choosing an appropriate signal denoising method is more crucial than the model since the data quality is the essence of modelling eze and ajmal 2020 decomposed do time series data and selected the highly correlated imfs for the lstm training the eemd lstm was able to follow the trend of do closely up to 12 h and outperformed the sae lstm proposed by li et al 2018 zhang and yang 2020 reported that the ceemdan gru has consistently captured the trend of suspended sediment concentration in the yellow river and had outperformed the gru without a denoising algorithm huang et al 2021 further improved the performance of the ceemdan through the addition of the lempel ziv complexity which is a symbolic dynamic algorithm used for quantifying the uncertainty in time series data lempel and ziv 1976 the imfs with similar lempel ziv complexity values were stacked for the gru training the proposed model demonstrated lower prediction errors and higher fitting than the ceemdan gru a similar result was observed when the gru was replaced with the lstm and rnn dragomiretskiy and zosso 2014 developed the variational mode decomposition vmd that non recursively decomposes an input signal into imfs comprised of amplitude and frequency modulated waves with the aid of the wiener filter the vmd is not prone to background noise thus outperforming the emd in many applications maji and pal 2016 uzunoglu 2018 ren et al 2020 reported that the vmd significantly reduced the noise and highlighted key data features for better do prediction in aquaculture ponds in another study fijani et al 2019 proposed a two staged decomposition method upon the ceemdan decomposition the high frequency imf was further resolved into finer scale components by the vmd so that the model could be more responsive to the fine scale data patterns the ceemdan vmd based models were validated more accurately than the ceemdan based models similar findings were also reported by dong and zhang 2021 where the ceemdan vmd based models were better in extracting multiscale periodicity and non linearity of the pollutant time series hence the two staged decomposition involving different signal denoising techniques could be attempted whenever a single decomposition technique did not perform satisfactorily and a comparison between different denoising algorithms on model performance could be studied 3 5 attention based hybrid models the attention algorithm was proposed to improve model performance in machine translation by attributing the highest weights to the most relevant parts of the input sequence zhu et al 2019 a detailed illustration of the mechanism is given in the literature bahdanau et al 2014 in wq prediction the weather or wq parameters could be some influencing factors hence the attention mechanism may select key input features for target prediction by assigning larger weight to the essential parameters bi et al 2020 incorporated an attention layer into the lstm for effective information extraction from the long temporal dependence do dataset zhu et al 2021 designed a hybrid model comprised of the resnet bi lstm and multi head attention to extract features from different wq time series then concatenated into fc layers for output prediction in another study the cnn lstm coupled with a self attention mechanism has led to a better global convergence in predicting the effluent quality of wwtp li et al 2021c the author explained that the cnn lstm model was driven by the attention mechanism and thus can easily stay focused on the salient features in the dataset for 3d wq modelling in an aquaculture system the attention mechanism established long distance dependence between input sequences and highlighted the impact of key features on do prediction cao et al 2021 liu et al 2019c compared different types of attention mechanisms and reported that the temporal and spatiotemporal joint attention mechanisms outperformed others in do forecasting the temporal attention based rnns can maintain higher accuracy over a long term do prediction and are highly recommended for the wq time series prediction 3 6 transfer learning based hybrid models being different from the traditional ml techniques where the model tries to learn everything from scratch the transfer learning tl based model typically transfers knowledge from the previous task to the target task where the latter has less training data pan and yang 2010 by applying the knowledge learned from the source domain the tl algorithm would improve generalization in the target domain and avoid overfitting yosinski et al 2014 knowledge transfer can be categorized into a data distribution transfer domain transfer and task transfer and most studies involve domain transfer lumini and nanni 2019 zhou 2020 zhu et al 2021 wang et al 2019a designed a growing dbn network based on tl a single layer dbn was pre trained as the source domain transferred to the target domain to initialize its weights and allowed the dbn to grow in depth when applied to the actual dataset the tl dbn demonstrated higher learning speed and was more robust than the existing structure tian et al 2019 applied tl on the ann rnn and lstm for chlorophyll α dynamic prediction the models were pre trained using wq data collected in june then fine tuned and applied for chlorophyll α prediction based on test data collected three months later the tl based models have reduced the influence of mutable data distribution and maintained higher accuracy for prediction in the next three months the authors also reported that the tl was better than the parameter norm penalties and dropout methods in improving model generalization ability the tl was applied to wq classification based on remote sensing images pu et al 2019 in situ data were first collected from a lake in china and calibrated with landsat 8 images as a pre training for the tl cnn the model was then applied to another lake lacking in situ measurement data the tl cnn model outperformed the standard cnn svm and rf along with satisfying generalization ability and thus it was recommended for inland lake monitoring where in situ data collections are rather difficult in another study the tl lstm was used for river do forecasting under severe data missing scenarios where direct training of the model is not feasible zhou 2020 the lstm was first trained with complete data to learn its pattern then transferred to the target temporal sequence with missing data for do forecasting as a result the tl lstm could follow the do trend adequately under different data missing scenarios unlike the lstm model that demonstrated apparent flatten prediction similarly zhu et al 2021 pre trained their do prediction model at taihu lake using a large dataset and subsequently applied the model at yixing lake with limited data it was found that the tl based model had higher prediction accuracy and shorter training duration than the model that was only trained with data collected from lake yixing despite the differing water characteristic at both lakes the tl was proven effective and significantly reduced the amount of data required in most situations the tl algorithm was paired with the dl to solve the data limitation and reduce training time in the target domain since only a small amount of labelled data is available model training is rather difficult and tends to overfit by having the model pre trained in a larger dataset it could initialize model weights for the target domain and hence contributes to better performance than starting from scratch this would avoid random initialization of parameter weights and increase model training efficiency typically in a deep architecture qureshi et al 2017 as such the tl algorithm is highly recommended for wq prediction as data availability is always a major issue 3 7 process based hybrid models the process based models are mechanistic models that work on general physical relationships such as mass and energy conservation to simulate the target variables as these models are strongly rooted in scientific theory they were designed with a rigid relationship with several constraints and often diverged from the theory when calibrated with real world data read et al 2019 when applied in the field of hydrology the auxiliary parameters like climate or topography data would increase the difficulties of model calibration on the other hand the dl models have no assumptions of processes underlying the data it might be difficult in several ways for prediction in unmonitored regions or long term projection due to data sparseness limited auxiliary data weather or wq data from nearby stations and the impact of some expected climate changes varadharajan et al 2022 a large dataset would also be required for the dl to learn the dynamics of the complex systems and to make accurate predictions in recent years the idea of integrating scientific knowledge and the rnn based models gained momentum and growing interest amongst researchers willard et al 2020 the knowledge guided dl hybrid models were developed for downscaling inverse modelling creating synthetic data discovering governing equations simplifying the complex mechanistic model and parameterization this parameterization is not the commonly defined terminology found in the mathematics field but refers to the process of replacing a complex mechanistic model with a simplified one so that it can be modelled using dl strategies some process based hybrid models attempt to make physically consistent and robust predictions by designing a loss function to penalize the model when a known physical law or relationship is violated read et al 2019 a process guided pg recurrent graph network was proposed for modelling interacting segments in the river network jia et al 2020 the prior knowledge embedded in the physical model was used to improve the learning of latent representation while the loss function was optimized to improve global and local prediction on each river segment sadler et al 2022 in turn proposed a pg based lstm to forecast streamflow and temperature simultaneously via a multi task learning approach given that streamflow and temperature formed part of the energy transfer processes the model established their relationship for multi objective optimization and showed significant improvement over the single task model that predicted both parameters separately from these studies the hybridization of recurrent based models with process based models has shown promising results in different applications it remains as a great research direction to solve to complex science and engineering problems by integrating traditional physics based modeling approaches with different state of the art dl models 3 8 concluding remarks a prediction model that is solely based on an individual algorithm typically contains only partial information about the object singha et al 2021 combining the dl model with other algorithms may allow for more comprehensive information to be extracted here we summarise the common hybrid models employed for wq prediction as the cnn is capable of extracting time invariant features it is commonly hybridized with the other models as a feature extractor through the extraction of effective representation and local features from a huge dataset the cnn improves model computation efficiency minimizes model complexity and eventually had been claimed to be able to outperform many other algorithms like the pca and hopls when coupled with the dl models as reported earlier the cnn was often associated with the lstm for time series forecasting in different applications and had also outperformed most dl models the fusion of spatial and temporal information by the cnn and the lstm module allows for relevant variables information to be fully extracted leading to its adaptability for complex non linear systems in wq prediction despite having a longer training time the hybrid models typically converged with fewer training epochs it was also found that limited comparisons were made for the cnn gru in algal bloom forecasting and wqi time series forecasting hence future studies are recommended on these gaps the recurrent based lstm and gru mainly serve as a temporal forecasting model in some studies where the lstm had failed to capture long term trends a statistical model like the sarima was adopted to capture the linear trend of the wq parameter for better lstm prediction the recurrent based models were also coupled with process based mechanistic models to integrate scientific knowledge into the black box models the resulted physic guided hybrids often showed higher robustness and accuracy in wq forecasting across different seasons or spatial coverage it was noted that the gbdt combined weak learners with strong learners and was able to assist the gru with the 3d do prediction through the unsupervised encoder decoder process the ae also performed dimensionality reduction and in depth features for the lstm even though many types of ae have been proposed only the conventional ae and sae have been coupled with the lstm for wq forecasting other types of aes could be hybridized with the lstm and gru and then be compared with the popular cnn lstm and cnn gru models given that the lstm typically trains slower than the gru however the performance of the hybrid models was seldom compared hence future studies may focus on this direction combining different denoising algorithms such as the ceemdan and the vmd has been reported with better signal decomposition and denoising performance can be achieved given that different datasets may require different denoising algorithms further research and development of creating a guideline on this topic would be beneficiary the rbm was seldom used for wq prediction studies owing to its weak ability in handling sequential data the stacked rbms more generally known as the dbn are commonly employed for extracting inherent correlations between wq variables by having a self learning capability the dbn could form hybrids with other dl algorithms to serve as a feature extractor and become a prediction model as there are more parameters to be trained researchers may pay more attention to optimizing the dbn structure and consider coupling the dbn with different algorithms to improve its dbn performance such as event triggered algorithm recursive time algorithm statistical model and so forth the attention algorithm was coupled with dl models to allocate more computation power to the important parts of the data without introducing abundant parameters the attention algorithm helps to select key input features for target prediction and improve training efficiency several attention mechanisms have been identified and comparisons should be made for the different wq prediction studies using datasets collected from different water environments in the event of insufficient training data a tl algorithm was hybridized with dl models to realize model training knowledge transfer has been adopted in optimizing the dbn network parameters and transferring knowledge learned in a large dataset to a small dataset most studies hybridized with the tl algorithm have reported a positive result where the fine tuning would shorten training time and require fewer data than training everything from scratch nevertheless the model with the tl typically demonstrated higher generalization ability with higher prediction accuracy and is highly recommended if the target dataset is too small for sufficient dl training 4 application of deep learning algorithms for wq prediction 4 1 rivers many mechanistic models have been developed to forecast wq in rivers including the river and stream water quality model qual2k water quality analysis simulation program wasp and so forth ahmed 2017 zhu and heddam 2020 however expert knowledge is needed to pre set the boundary conditions and system characteristics cox 2003 these mechanistic models also take upstream boundary flow conditions water level pollutant concentration and other parameters in time series format for dynamic modelling and this further increases the amount of data required some complex hydraulic models even seek boundary conditions at the bottom of the river system and the data of each reach whenever there are some influencing tributaries or effluent discharge points apart from the mechanistic model traditional statistical models were used for river wq parameter time series forecasting given that the wq parameters are influenced by complicated factors conventional models based on linear distribution cannot comprehensively consider the influence of these factors bi et al 2020 non linear ml models usually performed better than the statistical models but their shallow architecture was unable to extract inherent features for better model training especially when the datasets were sufficiently large and complex lu et al 2021 owing to this the dl based models with recurrent architecture such as the lstm and the gru become the most popular time series modelling tools in river wq forecasting barzegar et al 2020 xu et al 2021 table 3 summarizes the studies conducted in river wq forecasting using dl algorithms researchers reported that dl algorithms typically outperformed the traditional statistical models and shallow ml models dong et al 2019 bi et al 2020 lu et al 2021 from the summary of past studies listed in table 3 it was found that the do is the most frequently studied parameter followed by the organic pollutants parameters like cod bod chlorophyll α and so forth some researchers adopted the cod and bod as a comprehensive index to reflect the wq evaluation of rivers ye et al 2019 research concerning nutrients heavy metals or other pollutants is still limited most studies focused on short term prediction using hourly data probably since the wq variable can be easily influenced by different parameters further studies can be conducted to improve the long term river wq prediction by developing a robust model with a stronger ability to capture short term and long term temporal patterns the dl models could be hybridized with denoising algorithms which aim to smoothen the input signal for better model learning and prediction the tl algorithm could also be hybridized with dl models for river wq forecasting for instance pre training the model using data from the upstream station then fine tuning and applying it to the downstream station for wq forecasting the water quality index wqi is a single number designed to turn the complex wq data structure into a simpler description to ease water management the process of obtaining the wq parameter data through sampling at different points would be very costly and time consuming chia et al 2021 nevertheless calculating the wqi via an empirical equation is a tedious process and the computation of the wqi would not be possible in case of any missing wq parameter owing to these reasons researchers have been adopting the ml models such as the lssvm chia et al 2021 ann gazzaz et al 2012 hameed et al 2017 and hybridized elm abba et al 2020 for river wqi prediction whilst the applications of dl algorithms for wqi prediction have rarely been reported therefore future studies that focus on such directions would be highly recommended and welcomed 4 2 lakes for lake pollutants forecasting lu et al 2022 reported that the lstm performed better when the historical data for both inflows and internal loads were provided based on our literature search the majority of the studies used dl models to predict harmful algal bloom and relevant wq parameters such as chlorophyll α and nutrients table 4 presents the past research on lake wq prediction using dl algorithms it was generally believed that a chlorophyll α concentration higher than 10 µg l or a density of cyanobacteria above 2 107 cells l was the critical value for cyanobacterial blooms oliver and ganf 2006 the water temperature of 26 c seemed to be the most suitable temperature for the aggregation of cyanobacteria and the formation of bloom deyu et al 2008 harmful algal bloom prediction is a difficult task as most of the aquatic system data are sparse and incomplete thus hindering the development of a good multivariate predictive model traditional chlorophyll α modelling was performed based on the hydrodynamic and wq models such as the efdc and ce qual w2 which require expert calibration lee et al 2020b with the rapid growth of ai various ml techniques have been reported for their application in the prediction of chlorophyll α including ann li et al 2017b lee and lee 2018 anfis loc et al 2020 svr dt barzegar et al 2020 and so forth one major assumption in the ml approach is that the training and testing data must be of the same distribution which may not hold for chlorophyll α prediction the process of algal bloom in rivers and lakes is highly non stationary and non linear wang et al 2020c the prediction accuracy of certain ml models gradually decreases over time when the model is used to predict chlorophyll α outside the training sample dataset tian et al 2019 as shown in table 4 the dbn and its hybrids remain among the most popular dl algorithms for chlorophyll α forecasting and harmful algal bloom prediction given that algal bloom is a rare event the chlorophyll α dataset would be highly skewed and synthetic data could be used to solve the data imbalance by enlarging the minority dataset choi et al 2019 showed that the synthetic minority oversampling technique smote improved the performance of the cnn in predicting algal bloom the variation of chlorophyll α concentration is seasonal and is affected by many parameters such as water temperature yu et al 2020b wind speed ma et al 2015 nutrients and so forth knowing that the wq parameters could be influenced by the weather data it is recommended that meteorological sensors be installed in the vicinity of the wq monitoring stations so that auxiliary weather data could be used to improve model performance it has been reported that wind field data played an important role in forecasting the turbidity of lake water song and zhang 2020 tl and remote sensing technology could be adopted for lakes where accessibility poses a problem the model could be pre trained using in situ data and calibrated satellite images and then fine tuned and applied for wq forecasting at the targeted lake 4 3 coastal zones the release of agricultural and sewage runoff into the coastal regions has resulted in severe coastal algal blooms and has been regularly reported in china su et al 2021 zhang et al 2016 south korea kown et al 2018 lee et al 2020a hong kong deng et al 2021 united states karki et al 2018 yu and shen 2021 and many other countries these algal blooms have devastating effects on coastal fisheries and mariculture practices on the open seas as different coastal areas have their dominant factors with highly complicated non linear characteristics scientists are unable to attribute algal blooms to any specific factor owing to the mechanism causing algal blooms to be unclear predicting algal blooms based on theoretical dynamic models has been rather difficult often demonstrating poor generalization performance with the establishment of a marine water monitoring system in many countries data driven approaches that handle non linearity and complex relationships between parameters have become a better option for predicting algal blooms as shown in table 5 the dbn and lstm and their hybrids are most commonly used in coastal wq forecasting typically researchers have to cover a wider region in coastal wq forecasting to ensure that their predictions are representative of the whole study area it is rather difficult to gain a synoptic view of the spatial extent and temporal variation of wq for such a vast area thus in situ monitoring remains a challenge to cover such a large scale event like algal blooms or marine water pollution consequently satellite remote sensing is used as a supplementary algal bloom observation tool with some algorithms developed based on ocean color data from optical satellites kown et al 2018 karki et al 2018 most studies focused on the optically active variables such as sea surface temperature sss chlorophyll α and so forth in contrast fewer studies were conducted on the optically inactive variables such as cod and bod probably due to insufficient in situ sampling coverage for spatial prediction in coastal areas unlike the optically active parameters which could be determined from remote sensing images the detection of the optically inactive cod and bod parameters relies wholly on physical sensors installed at sampling sites however these optically inactive parameters are also crucial for determining marine wq hence further research on the optically inactive parameters from remote sensing images is highly recommended 4 4 aquaculture ponds the aquaculture is a dynamic system with the wq intensely affected by external factors owing to the open environment of the pond mariculture in turn is a subset of aquaculture whereby seawater is used for farming marine organisms for indoor recirculating aquaculture systems which are mostly shielded from the outer environment only several parameters were deemed significant including temperature ph conductivity turbidity and an do remains the most essential factor for the survival of aquatic creatures where it directly affects the feed intake bait conversion rate and disease resistance of aquatic products cao et al 2020 stunted growth may be observed among the fishes and diseases can easily outbreak when the do is low a sharp decline in the do caused by wq deterioration in hainan xincun port has resulted in large scale fish kill in 2017 hu et al 2020b in a smart aquaculture farm artificial aeration helps to maintain do levels by setting the aerator to commence automatically whenever the do level falls below the threshold given that oxygen diffusion is a slow process early prediction of do changes would thus be advantageous so that the aeration rate could be adjusted simultaneously prediction of do in an aquaculture environment falls into two categories i single parameter prediction that predicts do based on historical do data without considering the correlation with other parameters ii multi parameter prediction that fully considers the complexity of do changes with other correlated wq parameters and meteorological factors most aquaculture monitoring systems adopt multi parameter prediction and consider do water temperature water ph atmospheric humidity atmospheric temperature atmospheric pressure wind speed and wind level in their calculations due to the complex relationship between do and other input variables statistical models hardly guarantee the accuracy of do prediction and demonstrate poor self adaptability on the other hand the non linear ml models lack a memory function of historical data thus performing poorly in long term prediction dl algorithm models were proposed to solve the memory problem of historical data input recent studies undertaken in aquaculture wq forecasting have been summarised in table 6 some studies have successfully proven that the accuracy of do prediction in outdoor aquaculture ponds would be higher if weather data were provided as auxiliary data since solar radiation wind speed atmospheric temperature and relative humidity may affect the rate of oxygen diffusion li et al 2018 cao et al 2021 however the turbidity should be included given that turbid water may reduce sunlight penetration and photosynthesis rate providing a variety of factors as input data can allow for consideration of more possible relationships between wq parameters but having too much information in the model may increase the computation burden and could also reduce learning efficiency dimensionality reduction tools such as the pca would be useful in reducing the redundancy of the feed data in most studies a multivariate time series prediction could be attempted instead of a univariate time series prediction the low dissolved oxygen ldo algorithm proposed by zhu et al 2019 is a great idea to improve model sensitivity where it could be applied for other critical wq parameters so that any deviation could be detected in advance to safeguard the aquaculture livestock indeed a local point prediction may not reflect the actual do in the pond the 3d do distribution modelling conducted by cao et al 2021 and zhou et al 2021 provided a better understanding of the spatiotemporal changes of the do within the area of interest and paved the way for future wq modelling in different water bodies 4 5 wastewater treatment plant wwtp the activated sludge process is widely adopted in municipal wwtp to remove both organic carbon and nitrogen substances however the wwtp modelling becomes challenging due to its complex non linear dynamics with significant disturbances and uncertain time delays a wwtp is a combination of hydraulic and biochemical processes wang et al 2021 the hydraulic model describes the non linear dynamic of flow rates and recirculation to the reactor whereas the biochemical model represents the dynamics of the variable evolution process interaction between the variables goes along the whole wwtp leading to a strong coupling effect among parameters and giving rise to uncertainties that increase the difficulties for modelling the presence of outliers further contributes to ubiquitous uncertainties and ineffective iterations under strict environmental regulations soft sensing models for wwtp effluent quality are vital soft sensing is an indirect measurement of a target parameter such as bod where the actual value cannot be determined directly using hardware in real time it is accomplished by feeding a measured parameter into a pre defined model to predict the target parameter a fast and accurate soft sensing model for effluent quality not only gives an explicit description of dynamics but also provides an alert reference for the pre planning of necessary remedies or operational parameters tuning action in advance of an abnormal operation occurring the ml techniques have been widely applied to existing soft sensing models on effluent quality in wwtp fernandez de canete et al 2016 han et al 2016 however ml techniques have a poor capability of extracting deep features from the datasets which is deemed crucial for an efficient learning process the absence of this information may lead to a high computation effort with unsatisfying prediction outcomes to solve this issue efforts have been made by applying dl algorithms for the prediction of wwtp effluent quality guang et al 2019 li et al 2021c wang et al 2021 effluent flow rate wang et al 2019b power consumption cheng et al 2020 and so forth the event triggered learning algorithm has been adopted to ignore non valuable data pairs and improve model learning thus converging the model much faster with higher accuracy wang et al 2021 as shown in table 7 the cod was the most frequently studied parameter followed by ss nutrients and wwtp operational parameters such as inflow and power consumption the ss and bod were found to strongly correlate with cod guang et al 2019 the cod is the major monitoring parameter for wastewater quality by reflecting on the quantity of organic matter in the wastewater wang et al 2021 when the cod reaches a threshold value the water sample becomes rancid as the water self purification process consumes most oxygen to degrade various organic substances this phenomenon kills aerobic microorganisms breaks the natural balance of the environment and leads to the extinction of aquatic organisms if not treated initially impurities such as numerous biological corpses will be absorbed by the sludge and thus silt up which will in turn cause irreversible harm to the whole biosphere in the long run guang et al 2019 owing to this the control strategy of aeration systems is mainly based on the influent cod measured by a cod analyser that takes a long time to stabilize the delay of cod measurement is a major challenge for process control which practically increases the treatment cost due to the amount of aeration needed and chemicals added wang et al 2019b scholars have developed some dynamic cod forecasting models using dl algorithms and their hybrids wang et al 2019b adopted a hybrid cnn lstm for dynamic modelling of wwtp effluent cod and reported that direct forecasting of cod mass flow has a lower prediction error than the indirect method where the cod mass flow was calculated based on the predicted sewage inflow and cod concentration for multi parameter forecasting researchers reported that physical parameters such as water temperature inflow and power consumption were easier to be predicted unlike the chemical parameters where complicated biochemical reactions may increase the difficulties of forecasting cheng et al 2020 the wwtp operational parameters pump rate aeration chemical dosage and so forth could also be fed into the model to optimize cost savings it is believed that soft sensing of the wwtp effluent bod should be thoroughly studied which aims to replace the traditional bod measurement that is time consuming and labour extensive apart from these researchers may also consider more auxiliary data when training the dl models including drinking water supply data sewage flow data weather data and social population data a study conducted by jiang et al 2021b has successfully proven the effectiveness of using such auxiliary data to improve wq parameter forecasting in wwtp 5 iot and cloud computing for water quality monitoring using dl with the development of efficient dl models to handle large datasets continuous monitoring of wq has become an interesting but challenging area of research smart environmental monitoring is made possible with the emergence of modern sensors which are a central part of the ecosystem of the iot the iot comprises devices including servers sensors and actuators that are interconnected wirelessly to the internet for monitoring controlling and data logging ullo and sinha 2020 the development of mobile sensors which allows for the spatial variation in point measurement increases the need for data communication among these devices when manpower is unable to track the mobile sensors at all times this provides real time analysis to be carried out and the spontaneous adjustment to the sampling strategies li et al 2017a the data generated by the iot devices are typically stored in the cloud systems for future retrieval consequently the big data environment for future smart environmental monitoring may approach a stage where the setup is more mature and friendly not only for monitoring but also for considering statistical anticipation as well the merging of iot based data collection and dl has provided a new outlook for researchers this is coupled with the recent reduction in the cost of applying iot devices for wq parameter monitoring wong et al 2021 one of the earlier works proved that neural networks with multiple layers could cope with data collected with iot devices and classify the real time wq into three levels chowdury et al 2019 a water potability classification had also been pursued using iot data driven dl models alipio 2020 in china combining the iot and the lstm network has turned into one of the innovations in the predictive modelling of wq it was reported that the predictions of the wq parameters by the lstm network matched well with the actual data collected by the iot devices for comparison purposes the svm and arima models were deployed for similar functions however their performances were far from satisfactory when contrasted with the lstm network liu et al 2019b barzegar et al 2020 conducted a similar study in albania greece and macedonia three dl models including the conventional lstm the cnn and the hybrid cnn lstm were compared with shallow models such as the svm and dt the authors reported that the three dl models performed similarly in predicting do and chlorophyll using multivariate inputs conversely the kernel based svm and binary dt tended to underestimate the two parameters of interest it is important to note that although the dl models had predicted well generally however the results of this study revealed that these models are still susceptible to extreme values or outliers this would make real time monitoring a crucial aspect of smart environmental monitoring these studies justified the ability of the dl models in handling real time data from iot devices and subsequently make meaningful predictions however the use of iot means that data will be collected continuously and the size of the database eventually can become too massive for a typical workstation to process some technological giants have offered cloud computing facilities to the public such as the amazon web service google colab and microsoft azure these enable the researchers and the public to use such platforms to train and test their dl models before field deployment thus easing substantial costly technical computing requirements performing cloud computing for real time wq monitoring and prediction modelling could result in lesser data communication among devices this eventually could lead to higher efficiency the current iot dl model frameworks require data to be sent from the sensors to both the cloud system for storage and the user interface remote and local to obtain user inputs the user inputs then have to move in the opposite direction to the in situ actuators to execute any actions meanwhile the user might have to communicate with the cloud system to retrieve data or store historical actions these steps can be simplified if the dl models are trained using cloud computing and the users are only required to set up rules for plausible executions human interference may only occur when unforeseen circumstances happen this was suggested by sagan et al 2020 where the authors used this framework for satellite image processing the use of cloud computing would ease other innovations of dl models for wq monitoring for instance zhou 2020 proposed a tl scheme whereby the lstm network trained in the reference domain was transferred to a target domain with a high ratio of defective data the transfer involved data pattern transfers model transfers and task transfers which can be overwhelming communication between devices the work can be hastened by integrating iot devices with cloud computing equipped with dl models 6 limitations on water quality prediction 6 1 data limitation dl models are data hungry and require a large dataset for training in many studies the authors only performed one step forecasting using a small dataset it is recommended to consider sensor networks that offer datasets of larger dimensions and higher frequency for example some countries like malaysia have most of the river wq data collected bi monthly in the past decades whereby the dataset could not reflect any short term wq changes due to limited dataset availability researchers may only be privileged to train the model using a single monsoon dataset collected over several months thus the model would demonstrate poor generalization ability in predicting wq across the different seasons the lacking of weather data may affect the training and performance of the models as some meteorological parameters like wind speed atmospheric temperature and pressure would have a certain impact on some wq parameters 6 2 poor data quality unlike the aquaculture pond and wwtp the data collection for surface waters can be rather difficult and is also subject to additional errors for iot sensors many issues are reported on the devices such as power supply issues and network communication problems which inevitably deteriorate data accuracies the sampling frequency is very low for manual data collection since tremendous efforts would be needed in any case specific physical parameters must be measured in situ and are subject to human errors arising from the inexperienced operation faulty sensors incorrect calibration and other factors for chemical parameters that must be analyzed in the lab the wq parameters may change during transportation and storage unfortunately some data may not be collected due to poor weather and this would invariably influence the quality of the dataset this would result in many missing data situations or the presence of outlier data points in the dataset this would also render the need for extra efforts for data processing and subsequently increases the difficulty of model training hence the incomplete and highly sparse aquatic data often hinder the development of a good multivariate predictive model 6 3 lack of integrated real time water monitoring system the water supply in some areas can be considered as that of a multi level water system covering both the surface water and underground water for which both wq have an impact on each other there is a lack of research work in these areas for instance a study addresses wq impacts on different water levels due to water pollution from a specific water source existing published works usually adopted specific ml and dl techniques for water resources in a limited location during a specific period hence there is a huge demand for advanced technologies integrating multi level water monitoring and evaluation systems using sensor networks and iot infrastructures dl techniques are always closely associated with big data varadharajan et al 2022 the deployment of various sensors and iot devices enables the collection of high velocity data which is useful for dl applications in wq management in two ways firstly more data with different resolutions can be used to enhance the accuracy and performance of the dl models through a more rigorous training process secondly the collected real time data can be fed to an existing dl model for predictive modelling using cloud computing as a precautionary approach current iot applications in most developing countries are still insufficient to emphasize their values throughout the whole stream of dl based wq management jan et al 2021 6 4 different parameters and threshold limit for comparison it is almost impossible to make a fair comparison between models developed in different studies owing to the different datasets adopted and the parameters of interest given that a model may work well on dataset a it may in some probability not perform similarly on another dataset b researchers often face difficulties in making a general comparison for the developed models most countries have their standard of discharge limit for different wq parameters thus paving the way for more cumbersome and additional difficulties for model comparison wq datasets collected from different institutions would contain different wq parameters whilst there are limited comparisons among dl models using the same dataset 6 5 computation power and hyperparameter tuning most dl networks are complicated and contain plenty of hyperparameters to be tuned despite some of the variants reducing the number of parameters by merging their gates the training speed does not improve drastically this is because the rnn based models would still have to work through all the sequences which is a time consuming process and exponentially worsen for cases with long sequential data as such the rnn based models require intensive computational power not to mention that the model may fall into a vanishing or exploding gradient problem similarly the dbn networks typically perform better with additional rbm layers and neurons but this drastically increases computational time cost researchers would need to optimize the trade off between prediction accuracy and training time by designing parameters for their networks in some studies dimensionality reduction tools and feature extractors were employed to reduce training complexity so that only effective and useful information was provided to the model critically there is no standard practice for tuning hyperparameters and researchers are relegated to optimizing the model manually or using an optimization tool 7 recommendation for future works 7 1 model optimization the structure of the dl networks number of layers neurons gates can be optimized to reduce model complexity and computational effort some researchers suggested extending the number of hidden layers in a multi layer network for better prediction performance typically the number of the rbms layers in the dbn could be increased for better feature learning output but at the cost of higher training time a more effective memory block for the lstm should be designed to overcome the long training cycle in the lstm critically future research direction may focus on designing effective self adjusting strategies for hyperparameters learning rate dropout activation functions etc and model structure historical time step forecasting horizon numbers of hidden layers and neurons where current research mainly adopted optimization algorithms like the adam genetic algorithm particle swarm optimization and so forth for the wwtp operation the trained model can be incorporated with optimization scenarios to target daily optimal wwtp operation pollutant removal and cost minimization similarly mariculture farmers may integrate pump and aeration rates into the model for multi feature prediction so that operating parameters could be optimized for lower operation costs 7 2 development of powerful hybrid models and ensemble modelling new hybrid models can be developed by combining the dl ml statistical tools and other learning algorithms different models possess unique individual characteristics that allow certain inherent features to be extracted hence most of the hybrid models outperformed their standalone counterparts for instance the combination of the cnn lstm allowed for both spatial and temporal features to be captured for better prediction performance an unsupervised algorithm like the ae could be used as an automatic feature extractor the dl networks may be improved with other learning algorithms such as event triggered learning so that model could avoid meaningless iterations attention algorithms could be hybridized to allocate more computation power to important data while the ensemble model could combine complementary advantages of multiple forecasting models to achieve better forecasting performance as the direct ensemble would increase the complexity of the model and lead to overfitting undeniably appropriate weight location must be determined so that models can be combined organically different ensemble modelling strategies could be considered either by using different modelling algorithms or using different training datasets which aim to minimize the generalization error of different base models process based physical knowledge can be embedded into the dl models for better representation of the complex flow and chemical transport dynamics in different water bodies which paves the way for developing a spatiotemporal wq forecasting model of higher generalization ability the interacting wq parameters driven by the same underlying physical processes can be modelled simultaneously for multi objective optimization via a multi task learning approach by leveraging information from related wq parameters the stability of the model could be improved especially in sparse data conditions 7 3 real time monitoring and data assimilation there is a lack of integrated real time monitoring and supervision handling system for the wq evaluation application of sensors network and the iot for real time evaluation of wq would be essential for immediate response of the operators in mariculture and the wwtp for the lakes and rivers the authorities should be notified immediately so that remedies can be planned such as stopping the intake points of water purification plants whenever pollution is predicted there is a minimal combination of research work on wq prediction and related pollution control at various levels like running water underground water and surface water data assimilation can be attempted for which the trained model integrates data obtained from real time monitoring sensors updates and improves itself through continuous iteration this could be one of the research directions to be followed aiming to develop a real time prediction model with low computation complexity high prediction accuracy and robustness 7 4 transfer learning tl and synthetic data in situations where the wq data collected were insufficient to train a dl model or contained too many missing data points which would render model training impossible a tl method could be applied by having a pre trained model using a similar or related dataset the model could learn with lesser data in the actual task during the fine tuning process nevertheless the computation time can be shortened without compromising prediction accuracy for example the continuous monitoring data of river a can be used for model pre training which is then applied to predict wq at river b with limited data upon fine tuning similar works can be attempted for different applications such as transferring a model trained in an upstream station to a downstream station without these training a model using a small dataset would easily lead to model overfitting researchers also recommended the bayesian regularization and ensemble averaging method in the case of a small dataset training the dl models with a larger number of hidden neurons and layers could be one of the appropriate solutions for datasets with extreme skewness such as in the case of algal blooms synthetic data could be adopted to increase minority data and solve the data imbalance problem 7 5 multi dimensional data for water quality prediction apart from designing the prediction model future research may focus on the quantity and quality of the data collected given that all dl models are data hungry smart iot sensors should be employed to collect more data at fixed intervals so that a multi dimensional input dataset with higher frequency would improve the extraction of hidden interactions between influencing wq factors for the wwtp related studies researchers may consider more relevant parameters like precipitation and climate factors over a longer research period since the concentration of pollutants fluctuates daily similarly the study of surface wq must consider seasonality as the wq may change with the seasons some researchers opined that hybrid models should be created to forecast the wq at peak and non peak times as the sequence of the environmental variable could be useful for surface wq prediction the weather and remote sensing data can be incorporated as auxiliary data the pooled features meteorological and geographical can be used to identify the appropriate parameters to predict the wq multivariate prediction typically works better than the univariate counterpart as the former realizes comprehensive prediction of the water body as a whole however this comes with higher model complexity but with the chance of introducing uncertainty to propagate within the model researchers should always be cautious when handling multi parameter datasets and dimensionality reduction tools should be employed 7 6 remote sensing spatial prediction and 3d modelling remote sensing images can be used for the wide area wq prediction involving optically active parameters such as chlorophyll α turbidity colored dissolved organic matter and so forth by studying the image color and textures a better strategy of extracting optically passive parameters such as the cod bod and nutrients could be a future research direction given that the do is strongly influenced by surface water temperature which can be easily interpreted from satellite images a combination of remote sensing images and environmental variables sequence may predict the do patterns in surface waters by building a tl based model by installing do sensors at different underwater positions a 3d spatial do prediction model could be developed to understand better the do patterns in different regions of the water environment so that remedies could be planned similar work can be extended to other wq parameters whenever the 3d spatial modelling is deemed necessary since a local point prediction may not represent the entire water environment instead of predicting upper ocean salinity the 3d spatial modelling of ocean salinity would combine the temporal and spatial information where the output could be used to infer other variables related to sea salinity like freshwater flux and direction of the ocean current successful works can pave the way for other surface water bodies and aquaculture implementation 7 7 advanced denoising techniques and dimensionality reduction wq and meteorological time series typically contain temporal noises where effective noise reduction must be conducted before model training more advanced denoising strategies can be studied for instance a decomposition algorithm that can adaptively determine the optimal decomposition level should be investigated to replace existing manually designed methods based on the user s experience hence future studies may focus on multi level denoising similar to those reported in the literature fijani et al 2019 bi et al 2020 even suggested that the dl methods like the stacked ae rbm and generative adversarial network could be used for signal pre processing given that wq parameters may have unknown interactions with each other most researchers tend to feed all collected data for model training including auxiliary features like weather data providing too much invaluable data would burden the training process without improving its prediction accuracy thus data dimension reduction and feature extraction would be helpful to adaptively select the most crucial input features from the context effectively dimensionality reduction tools like the pca and ae and their hybrids are highly recommended the effects of increasing network layers of the ae for deeper latent features extraction and dimensionality reduction could be further investigated 8 conclusions this review paper serves to cover the importance of the dl models in numerous instances related to wq management it began with the introduction of the ann and rnn models researchers attempted to fix the pitfalls of the rnn model in solving massive time series by introducing the different variants of the lstm gru cnn tcn and dbn models the characteristics of the different dl models were compared and contrasted many studies claimed that the performance of the dl models could be improved with various hybridization techniques these hybridization techniques come in various forms including of the combinations of different base dl models e g cnn lstm model process based hybridization e g pg lstm statistical based hybridization e g sarima lstm model ml based hybridization e g gbdt lstm model attention based hybridization e g attention gru gbrt model and tl hybridization e g tl lstm model evidently from the perspective of wq management the hybrid dl models were found to have outperformed the conventional dl models in terms of accuracy and fitting based on the results of the available literature this could be due to the fact that the hybrid dl models excel in various specific tasks including feature extraction trend learning and data manipulation throughout the review paper the application of the dl models in wq management has been discussed extensively most importantly the scope of this review paper was extended to cover as many types of water bodies as possible including rivers lakes coastal aquaculture water and even the wwtp for each water body the applications of dl models on the specific wq parameters of interest were discussed separately as the importance of parameters of one particular water body could be irrelevant in another the wqi a multi parameter wq metric was also explained in conjunction with the application of dl models technological advancement has driven the deployment of iot devices and cloud computing for wq management alongside the dl models the review pointed out the ways of merging iot cloud computing and dl models as a real time monitoring scheme the inclusion of cloud computing is beneficial when dealing with a gigantic scale of real time data and higher modelling efficiency less human interference is anticipated if the proposed system begins to mature although the dl models possess promising potential in the field of wq management several limitations and challenges await to be overcome to reach its full scale application at present the availability of data is still ranked the biggest difficulty whereby many regions worldwide still lack a proper data collection system and infrastructure this consequentially leads to the lack of data amount poor data quality and lack of systems or devices that can monitor the wq of various water bodies on a real time basis finally the development of high performance dl models is always accompanied by a large number of hyperparameters to be tuned this would pose a severe challenge to the need for computational power lastly the authors of this review paper suggested several recommendations for future works and studies for the dl models upcoming research works can focus on developing lightweight yet powerful dl models by modifying the architecture of the current dl models taking it a step further the researchers can also experiment with different ways of hybridizing the dl models to achieve better performance in wq management data wise the authors suggested that the current data collection infrastructures can be further improved with the deployment of more iot devices and advanced instruments this can help to mitigate the problem of missing data and at the same time provides more information on the wq in different dimensions alternatively the data structure can be modified via tl and the generation of synthetic data the remote sensing images can be utilized to spatially map the wq to better understand its dynamics also pre processing including denoising and dimensionality reduction shall be useful for extracting valuable and essential information from the available raw data by improving the techniques from the aspects of the dl models and data it is believed that the efficiency and effectiveness of wq management can be further enhanced appreciated and boosted to benefit the economy and social welfare of the local communities the premise which echoes the call of the 6th sustainable development goals of the united nations fig 6 illustrates a word cloud demonstrating the various dl models adopted for wq prediction it is noticeable that the gru and lstm are more visually appealing than the other dl models for wq prediction declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by universiti tunku abdul rahman utar malaysia through the universiti tunku abdul rahman research fund under project number ipsr rmc utarrf 2020 c2 k03 the authors are very grateful and appreciate very much the financial support provided 
2939,excellent water quality wq is an indispensable element in ensuring sustainable water resource development it is highly associated with the 3rd good health and well being the 6th clean water and sanitation and the 14th life below water listed items of the united nations sustainable development goals thus policymakers have always been seeking strategies to manage wq efficiently recent advancements in computational technologies have created enthusiasm for using artificial intelligence particularly deep learning dl in wq management this review provides a comprehensive overview of the application of dl in wq management covering developments from 2011 to 2022 in maintaining the temporal relevance of this review in this paper a brief description of different variants of dl models including the recurrent neural network rnn long short term memory network lstm convolutional neural network cnn etc are presented the distinct approaches in the optimization hybridization and relevant data pre processing techniques suitable for the dl models are also discussed this is the first review paper that extensively discusses the application of dl models for forecasting wq parameters in various water bodies such as rivers lakes coastal areas etc the emergence of the internet of things iot and cloud computing that revolutionized dl approaches in wq management are also presented this review paper serves as a complete easy guideline for the researchers in the field of dl based wq management the findings of this review paper may help policymakers to enhance their decision making process with the hope that regional environmental welfare can drastically be improved keywords deep learning water quality prediction signal denoising convolutional neural network long short term memory gated recurrent unit data availability data will be made available on request nomenclature abbreviations 3d three dimensional ae autoencoders ai artificial intelligence an ammoniacal nitrogen anfis adaptive neuro fuzzy inference system ann artificial neural network arima autoregressive integrated moving average bi gru bi directional gated recurrent unit bi lstm bi directional long short term memory bi rnn bi directional recurrent neural network bod biochemical oxygen demand bpnn back propagation neural network ceemdan complete ensemble empirical mode decomposition with adaptive noise cnn convolutional neural network dbn deep belief network dl deep learning do dissolved oxygen dt decision tree ec electrical conductivity ed encoder decoder eemd ensemble empirical mode decomposition efdc environment fluid dynamics code el event triggered learning elm extreme learning machine emd empirical mode decomposition esn echo state network ga genetic algorithm gbdt gradient boosting decision tree gbrt gradient boosted regression tree h hour hopls higher order partial least squares imf intrinsic mode function iot internet of things knn k nearest neighbours lr linear regression lssvm least squares support vector machines lssvr least squares support vector regression mae mean absolute error ml machine learning mlp multilayer perceptron mt multi task learning nse nash sutcliffe efficiency pca principal component analysis pg process guided pso particle swarm optimization r2 coefficient of determination rbf radial basis function rf random forest rgn recurrent graph network rmse root mean squared error rnn recurrent neural network sae sparse autoencoder sarima seasonal autoregressive integrated moving average sg savitzky golay smote synthetic minority oversampling technique sru simple recurrent unit sss sea surface salinity stvar space time autocorrelation svm support vector machine svr support vector regression tcn temporal convolutional network tds total dissolved solids tl transfer learning tn total nitrogen tp total phosphorus tss total suspended solids vmd variational mode decomposition wq water quality wqi water quality index wwtp wastewater treatment plant 1 introduction the management and regulation of water quality wq are worldwide challenges since the wq is affected by both local processes e g point source pollution and global processes weather patterns some of these involve human decisions that are difficult to predict or manage e g the use of fertilizers while some are beyond that of a manager s control e g accidental events de paul obade and moore 2018 salerno et al 2018 kachroud et al 2019 destandau and zaiter 2020 vast efforts have been made to resolve the issues related to wq management including real time monitoring wq parameters modelling and forecasting based on computer simulation or artificial intelligence ai these efforts are aligned well with the 6th sustainable development goal clean water and sanitation as endorsed by the united nations over the past decade there has been growing interest amongst the scientific community to apply machine learning ml or ai tools for modelling wq this evolution is proven through the increase in the number of scopus indexed publications on managing wq using ml or ai tools fig 1 shows the results of this comprehensive statistical study using the scopus search engine over the past decade to obtain the number of publications discussing the application of ml or ai for wq management a paper search was done on the scopus database using several keywords including machine learning artificial intelligence and water quality from 2011 to 2022 similarly the search term deep learning was included to obtain the number of publications that had applied dl models for wq management it can be seen that since 2016 the number of research publications concerning wq management using ai or ml has been increasing annually this observation is in agreement with the increase in the proportion of studies using dl models in wq related research works in other words the research field is experiencing tremendous growth with the improvement of computing facilities alongside the development of various technologies and algorithms the potential of ml of ai in wq management particularly within the aspect of decision relevant prediction has been proven varadharajan et al 2022 numerous studies had been conducted to investigate the feasibility practicability and efficiency of ml or ai in wq management while several review articles had been published to summarize and criticize the available literature despite this the authors are still eager to build on the previous reviews in the literature as there is insufficient coverage in certain key areas for instance zhao et al 2020 only focused on reporting the utilization of ai in the operation of wastewater treatment plants wwtp the ai tool is usually used for estimating the influent and effluent wq parameters and controlling the operations of the wwtp to improve cost efficiency as such the scope of the review remains relatively narrow and thus can be extended tiyasha et al 2020 conducted a literature survey of wq modelling using ai models over the past two decades i e 2000 to 2020 the review stressed various types of data input in terms of the time scales and parameters and output wq parameters performance metrics used and the variant of ai models it should be noted that the papers reviewed by tiyasha et al 2020 only encompassed some well known conventional ai models such as the artificial neural network ann support vector machine svm and the adaptive neuro fuzzy inference system anfis models as well as their hybrid counterparts nature inspired algorithms and wavelet transformation but inadvertently having left out reviewing studies related to dl models it must be stressed that the authors were only interested in the wq of river water which somehow or rather made the review lack comprehensiveness in another similar review rajaee et al 2020 reassessed the single and hybrid models in wq management of river waters the key difference between this review and that of tiyasha et al 2020 is that the technical focus of this review is on the techniques used for data preparation before the wq modelling which involves data splitting and data normalization however this review complemented the previous work of tiyasha et al 2020 by including some other models that are time scales dependent such as the autoregressive integrated moving average arima model and the mann kendall analysis content wise the works of tiyasha et al 2020 and rajaee et al 2020 exhibited high similarities and whereby extended works are needed in the future in a recent study ighalo et al 2021 enhanced the review scope to include all surface water bodies although the authors strived to include more water bodies in their review paper the comprehensiveness of this publication was limited because the authors only reviewed ml or ai tools that had utilized the ann model another literature survey by mustafa et al 2021 included the deployment of the internet of things iot devices in a similar application however the paper only included an introduction to the iot devices without going into the substantial analysis and discussion on the importance of the subject matter taking a closer look at fig 1 readers might observe that the share of publications related to the application of dl models in wq management has been increasing since 2017 this can be attributed to the improvement in the computational facilities and the rejuvenation of dl models in the scientific communities yet all the previous review papers did not include the role of dl models in wq management in the scope of the study thus a review paper that discusses the role and significance of dl models in the context of wq management would indeed be most helpful and much needed hence the authors of this review attempt to provide an inclusive review and literature survey on the application of dl models in wq management the scope of this review paper shall not be constrained to the river water only as portrayed by several earlier reviews but also include every possible kind of water body this review paper is expected to cover necessary elements such as background theories modifications and applications of dl models in advanced wq management the structure of this review paper is partitioned into several sections section 2 introduces the dl models that are commonly used for wq management section 3 extends the discussion to include hybrid dl models via different hybridization techniques in section 4 the application of dl models in various wq management scenarios is thoroughly reviewed section 5 provides an outlook for the iot application concerning the dl model application in wq management sections 6 and 7 give a visionary future trend and prospect of this research field before the concluding remarks fig 2 illustrates the overall review framework which was created upon obtaining some meaningful inspiration from herman et al 2015 table 1 is presented to ease the readers in locating the topics and information that they might be interested in it summarizes the reading priorities recommendations for researchers and readers who may have different needs 2 deep learning dl models dl as the ml subdomain comprises algorithms that build neural networks imitating the human brain for learning and analysis purposes dogo et al 2019 it is described as an ann approach with many layers of depth in the architecture hence the associated phrase deep unlike the traditional shallow learning method deep architectures model high level abstractions in data via multiple non linear transformations and enhance the extraction of in depth information fig 3 illustrates the types of dl architecture widely adopted for feature detection clustering dimensionality reduction solving classification and regression problems in the field of wq management the recurrent based neural networks are widely adopted for wq parameter forecasting 2 1 recurrent neural network rnn 2 1 1 architecture of recurrent neural network rnn the recurrent neural network rnn is an ann that is specifically designed for handling sequential data a typical ann can be represented by a system of interconnected neurons as shown in fig 4 where the input layer receives the inputs the hidden layers process the information and the output layer generates the outcome chia et al 2020 the neurons in different layers are interconnected with some weights and run specific activation functions to map inputs to the output in general the neurons of the same layer should run identical activation functions hence the type of the layer can be determined by the activation function itself sit et al 2020 the multilayer perceptron mlp the most common form of the ann contains at least a hidden layer with each neuron connected to every neuron in the adjacent layer to form a fully connected fc neural network the ann is also known as a feed forward neural network because inputs were only processed in the forward direction owing to this the ann is unable to capture sequential information from the input data which is crucial for time series forecasting from fig 5 the forward propagation of the rnn is similar to that of the ann with a single hidden layer but the rnn receives an additional value calculated by the activation function at the previous time step this looping constraint allows the rnn to generate memory states and build the relationship between data from different time steps despite being a strong learning model capable of handling temporal features the rnn is difficult to be trained and suffers from exploding or vanishing gradient problems riedmiller 1994 chen et al 2018 with the conventional back propagation through time or real time recurrent learning the error signals backflow in time would lead to oscillating weights rendering the learning process not working at all bengio et al 1994 werbos 1988 echo state network esn and simple recurrent unit sru the base rnn is rarely used for wq forecasting but many researchers would compare their newly developed model with the base rnn to outline how much significant improvement has been achieved some variants were developed based on the rnn architecture such as the echo state network esn and the simple recurrent unit sru liu et al 2019a liu et al 2020 the sru simplifies the computation in such a way that each step is only dependent on the current input of the recurrence lei et al 2017 this initiative helps to avoid the costly computation of matrix multiplication and hence the sru could be trained as fast as a convolutional layer when applied to water temperature and ph forecasting the sru demonstrated a higher degree of fitting than that of the rnn liu et al 2019a it was believed that the additional cell state in the hidden layer of the sru was responsible for judging and filtering effective information during the training process liu et al 2020 further improved the sru model by designing a bi directional stacked sru model whereby the forward and backward sru were superimposed into each training sequence so that each point would have both the past and future context information the proposed model was able to achieve 94 of accuracy for multistep ahead forecasting and outperformed the rnn lstm and sru in comparison the rnn was over fitting due to model complexity and did not converge to the global minimum apart from these a deep esn was also developed for wq prediction the esn model is an rnn with a hidden layer defining the state dynamics of the network jaeger 2007 kim et al 2020b designed a deep esn model that is comprised of a hierarchy of stacked recurrent layers for which the output of each layer will be fed into the next layer the proposed deep esn model has demonstrated lower prediction errors than the extreme learning machine elm random forest rf and gradient boosted regression trees gbrt in the prediction of bod however the authors seldom compare their model performance with the benchmark lstm and gru models as both the sru and esn were reported to have a lower computational cost along with better prediction performance further studies focussing on the subject are highly recommended 2 2 long short term memory lstm to solve the long term dependency issues of the rnn hochreiter and schmidhuber 1997 proposed the lstm model with a gating mechanism it is a type of recurrent neural network that has a cell state for remembering longer term dependencies information usage and storage are modulated by a series of gates that can remove and add information to the cell state a thorough explanation of the lstm architecture can be found in shen 2018 and chen et al 2018 in wq parameter forecasting the lstm serves as a benchmark for comparison whenever researchers built a new model the lstm model also serves as the fundamental block for hybridization with other statistical tools ml or dl models for the do and total phosphorus tp forecasting the lstm outperformed the back propagation neural network bpnn and the online sequential elm by demonstrating higher prediction accuracy and generalization regardless of data quality wang et al 2017 liang et al 2020 showed that a simple lstm structure with five hidden layers could simulate the forecast capacity of the environment fluid dynamics code efdc in predicting chlorophyll α concentration up to 31 days ahead apart from these the lstm was used to process remote sensing based datasets and make predictions on coastal algae bloom shin et al 2019 the lstm has been frequently modified by researchers and now comes in several variants graves and schmidhuber 2005 first proposed the bi directional lstm bi lstm whereby the data was fed in both the normal and reversed time order while there will be no communication between both hidden layers to ensure that the expanded graph is acyclic some researchers reported that the bi lstm learns faster than the unidirectional approach in handling sequential data siami namini et al 2019 abduljabbar et al 2021 for wastewater cod prediction the bi lstm outperformed the ml models svm and regression tree as the former could control data propagation to prevent gradient explosion guang et al 2019 however the standard lstm fared relatively well than the bi lstm since the cod prediction is a one sided problem this finding is in contradiction to that of cheng et al 2020 who found that the bi lstm outperformed the lstm in wwtp key features forecasting the authors believed that the bi lstm employed both historical and future data to improve its prediction performance since a valid conclusion could not be drawn from these studies further studies on the above subject are recommended to challenge the models in more wq datasets cho and park 2019 designed a merged lstm that combined the outputs from three parallel lstms into a fully connected layer for multi step ahead chlorophyll α prediction unlike a conventional lstm model additional wq and weather data from a nearby station were fed into different lstms and trained separately the merged lstm performed better than the conventional lstm and mlp models but at a higher computational time cost nevertheless song et al 2020b used the merged lstm for sea surface height anomaly detection this is a time series forecasting problem where the hidden discipline in short time series was extracted to tackle the long term dependence of series changes the application of the merged lstm could be extended to the spatiotemporal prediction of wq in lakes mariculture ponds and wwtp based on auxiliary data collected from nearby stations the correlation analysis or dimensionality reduction tools may be handy in terms of reducing the complexity of the auxiliary data other recurrent based networks could also be merged for better performance in the spatiotemporal prediction of wq parameters 2 3 gated recurrent unit gru cho et al 2014 introduced a gated recurrent unit gru network that modulates information flow without using separate storage where only two gates are present in the base gru the reset gate is responsible for the short term memory by combining new input and historical memory which is analogous to the combination of input and forgot gates in the lstm the update gate on the other hand behaves like an output gate and decides how much of the previous state shall be kept for long term memory a detailed explanation on the gru model architecture and its structure is given in chen et al 2018 in general the gru exhibited better performance than the lstm on a small dataset gruber and jockisch 2020 the gru also converged much faster than the lstm with a higher training efficiency cheng et al 2020 qin 2019 reported that the gru outperformed the convolutional neural network cnn lstm temporal convolutional network tcn and the bi directional rnn bi rnn for forecasting do time series however on the contrary loc et al 2020 showed that the gru was sensitive to the extreme values in the dataset while the lstm was more successful in representing a time series with smooth and repeating patterns without random fluctuations when dealing with a large dataset the gru may fail to capture a long term correlation and be trapped in a gradient vanishing problem song et al 2020a thus the gru provides a trade off between accuracy and training time for practical problems involving a large dataset with a long temporal sequence zhang et al 2018a it is worth mentioning that both the lstm and the gru often outperformed the rnn and other ml models given that the former can preserve important features through various gates to ensure they will not be lost during long term propagation as a result both the gru and lstm currently represent the state of the art and most highly benchmarked modern models in many applications 2 4 convolutional neural network cnn a typical cnn is comprised of the convolutional pooling and fc layers and adopts the way of local connection and weight sharing the convolution layer contains a series of filters that slide across the image to make a dot product with the input data the pooling layer reduces the dimension of the matrix produced and the fc layer condenses the extracted feature to produce the final result hu et al 2020a for a more extensive explanation of the cnn architecture and computational approaches readers could refer to a state of art review article published by alzubaidi et al 2021 as the cnn is capable of extracting sophisticated features from multidimensional data it can be used to process imagery data for regression and classification for instance song and kim 2020 employed the cnn for building pollutants load prediction model using hydrological images as the input the cnn was also trained on spatiotemporal wq data generated by a hydrological model for the algal bloom prediction pyo et al 2020 the model maintained a satisfying performance with a significant decrease in the temporal frequency and the volume of spatial data xue et al 2021 reported that the cnn outperformed the traditional models such as the linear regression lr and partial least squares regression plsr in estimating lake chlorophyll α based on remote sensing images apart from the prediction accuracy the weight sharing characteristic of the cnn decreases the number of trainable network parameters and speeds up the training process the neurons corresponding to the same features will be triggered in varied scenarios hence would improve the generalization ability of the model also training a model on low resolution data saves time and allows for high resolution data to be predicted more quickly alzubaidi et al 2021 owing to this researchers hybridized the cnn with other time series forecasting models to extract important features from a large dataset such a hybridization network would significantly lower computational time cost and improve model prediction performance and this is discussed in the next section 2 5 temporal convolutional network tcn the temporal convolutional network tcn was proposed by bai et al 2018 for sequence modelling tasks the tcn adopts the 1d fully convolutional network architecture so that both input and output would share the same length the building block of tcn which is commonly known as the residual unit stacks two dilated causal convolution layers together where the causal convolutions ensure that future information does not leak into the past qin 2019 by skipping the connection within the residual unit the tcn allows propagation with a larger but stable gradient along the neural network however the tcn takes in the raw sequence up to the effective history length during evaluation and may perform poorly during domain transfer due to a small receptive field the tcn has demonstrated excellent performance in anomaly detection owing to its capability in exploring the temporal dependencies over a remarkably long historical period song et al 2020a owing to the same reason the tcn also exhibited better performance than the recurrent counterparts in predicting the brunett river dissolved oxygen do and water temperature zhang et al 2019 it was believed that the tcn adopted convolutional filters of different sizes to collect temporal dependencies at different time scales with the dilated convolutions that increase the receptive field the long historical data can be utilized for learning and prediction purposes however qin 2019 reported that the gru outperformed the tcn in predicting do at the yangtze river based on the study the gru is probably a better option over the tcn for wq prediction despite of the plenty factors that may affect the performance of the models as such more studies can be conducted to challenge the tcn in different types of wq datasets before a valid conclusion is drawn 2 6 deep belief network dbn and restricted boltzmann machine rbm the restricted boltzmann machine rbm comprised of a visible and a hidden layer which can automatically detect inherent patterns in the data by reconstructing the inputs however the rbm is unable to tackle vanishing gradient problems hence using the deep belief network dbn would be more favourable in most situations the dbn is designed in such a way that multiple rbms are stacked together where the output of a low level rbm would serve as the input for the high level rbm wu et al 2015 the training process is repeated for all layers to ensure each rbm learns the entire input unlike in the cnn where the convolutional layer detects patterns and the pooling layer recombines them subsequently a detailed explanation of the architecture of the dbn can be found in shen 2018 the dbn has been widely adopted for many applications including wq point estimation and time series forecasting most wq related studies employed a five layered dbn with three stacked rbms as hidden layers zhang et al 2016 lin et al 2018 ren et al 2020 the first rbm receives the inputs while the high level rbms further extract the characteristic of influencing factors with their weights updated automatically the deep architecture of the dbn with adequate hidden layers has demonstrated better generalization and accuracy than the bpnn zhang et al 2016 similarly ren et al 2020 found that the dbn outperformed the decision tree dt and cnn regression models in aquaculture pond do prediction however the authors did not compare their models with the lstm and gru despite both being well known for handling temporal sequence data the genetic algorithm ga was used to optimize the dbn for effluent cod and ss prediction niu et al 2020 the study showed that the optimal number of rbm layers varies according to different datasets and applications and scholars may refer to the methods proposed by montúfar 2014 to approximate the minimum number of layers required for their dbn network apart from modifying the internal structure the dbn applications in wq related studies involving hybridization with other models and this will be discussed in section 3 2 7 comparisons of deep learning models table 2 summarizes the architecture and characteristics of each of the dl models this could serve as a quick reference for future scholars who wish to have a fresh start in selecting an appropriate dl model in the wq prediction as a rule of thumb the researchers shall first adopt the lstm and the gru for conventional wq time series forecasting 3 deep learning hybrid models 3 1 convolutional neural network cnn hybrid models hybridization of models of different architectures may allow inherent information about the data to be extracted given that the cnn is specifically designed to handle data with similar grid weight the characteristic of local connection weight sharing and pooling could effectively reduce network complexity and training parameters for instance fan and zhang 2020 reported that the cnn outperformed the principal component analysis pca in extracting useful features when coupling with the svr for bod prediction in another study lee et al 2020b opined that each layer of the cnn takes a few adjacent features and may not fully consider relationships among all input features a higher order partial least squares hopls regression model was hybridized with the cnn to improve its performance in algal bloom prediction despite the cnn could effectively extract key input features from multi dimensional datasets the standalone cnn gave the worst performance in predicting ammonia as compared to the gru lstm and svr wang et al 2020a similar findings were reported by wang et al 2019b and barzegar et al 2020 who developed the cnn lstm for the wwtp and lake wq prediction respectively in the studies the cnn serves as an ideal feature extractor when hybridized with the time series forecasting model apart from improving prediction accuracy the cnn reduces the complexity of the training parameters and converges with lesser epochs balderas et al 2019 3 2 lstm based and gru based hybrid models 3 2 1 hybridization with convolutional neural network cnn wang et al 2016 first designed the cnn lstm to predict valence arousal ratings the regional cnn divides input text into several regions so that useful information in each region could be extracted and weighted then sequentially integrated via the lstm for valence arousal rating prediction similarly the cnn lstm was adopted for handling multi dimensional wq where the cnn extracts deep features of the main elements while the lstm performs temporal forecasting based on these in depth features the cnn lstm has been reported with higher stability when handling data with large fluctuations wang et al 2019b baek et al 2020 in another study barzegar et al 2020 discovered that the lstm was better in predicting the high concentration of parameters while the cnn was good at low concentration situations the hybrid cnn lstm model combined the strengths of both models and enhanced the prediction accuracy baek et al 2020 the gru which regularly outperforms the lstm was also hybridized with the cnn for wq prediction tu et al 2019 hu et al 2020a song et al 2020a the strength possessed by the cnn and gru in processing high dimensional and time sequence data respectively renders both models a perfect match for handling spatiotemporal datasets the architecture of the cnn gru is nearly comparable to that of the cnn lstm except for the recurrent module apart from the superior stability the cnn gru could be trained faster as the cnn had sped up the process of inherent feature extraction tu et al 2019 pan et al 2020 in another study song et al 2020a used the cnn as a down sampling network and assisted the grus in extracting the overall trend and the local short term pattern from the dataset as a result the cnn gru outperformed the statistical arima ml svr and ann and dl rnn and tcn models in predicting sea surface salinity sss 14 days ahead 3 2 2 hybridization with statistical models traditional statistical models use the linear relationship between data to capture its trend and face some shortcomings when dealing with complex non linear relationships between features on the other hand the dl models offered better predictions but a massive amount of training data would be required as such xu et al 2019 coupled the seasonal autoregressive integrated moving average sarima and the lstm for coastal pollutant prediction the authors first reported that the sarima could not react to the sudden change while the lstm failed to capture annual periodicity probably due to the limited amount of training data provided the sarima lstm hybrid model was improved based on these two models and resulted in a lower prediction bias by providing auxiliary data to the multi featured sarima lstm the model prediction accuracy and stability were further enhanced to the best of the authors knowledge the hybridization of the statistical model and the gru for wq modelling is rarely reported thus could be an avenue for future study 3 2 3 hybridization with other ml algorithms as an unsupervised learning neural network the autoencoder ae had been widely used in data compression dimensionality reduction and feature extraction projects for decades a conventional ae comprises an encoder that maps the inputs into the code while a decoder performs a decoding task to reconstruct the inputs for a detailed explanation of the algorithm the readers are referred to zhang and jin 2020 in terms of application the ae was employed for filling missing data in the wq time series shu et al 2021 li et al 2018 adopted the sparse autoencoder sae to extract deep latent features from wq and meteorological data and significantly improved the performance of the lstm however the spatiotemporal correlation of the wq fluctuations was not considered hence there is still room for improvement since then zhang and jin 2020 proposed the ae lstm for spatiotemporal prediction of river nutrients which had outperformed the conventional lstm the excellent performance of this hybrid model can be attributed to i establishing spatiotemporal characteristics of the wq parameters in the upstream and downstream stations ii feature dimensionality reduction using the ae iii superiority of the lstm algorithm for processing time series the gradient boosting decision tree gbdt was also coupled with the lstm for aquaculture do forecasting huan et al 2020 the gbdt effectively performed feature selection to reduce unnecessary information in the model thus resulting in higher prediction accuracy it is surmised here that the proposed gbdt lstm models could be gainfully challenged with the gru a competing model of the lstm as such the performance of the cnn ae and gbdt as feature extraction tools could be compared accordingly to handle a sparse dataset the factorization machine with the seq2seq framework was coupled with the gru for do forecasting xu et al 2021 the factorization machine obtained interacting correlations between diverse index values and processed them as an input to the gru model thus significantly improving model prediction accuracy and outperforming the conventional dl ml and statistical models in another study the gradient boosting regression tree gbrt was coupled with the attention based gru for three dimensional 3d do forecasting where the gbrt was used as a spatial prediction model to estimate local do concentration in the pond cao et al 2021 the gbrt is capable of processing a wide range of data types and is quite resilient when dealing with outlier data points thus granting the model additional advantages when dealing with a small dataset of fewer features 3 3 deep belief network dbn hybrid models given that improper design would lead to longer training time and poor accuracy qiao et al 2018 proposed a self organizing dbn network to adjust the number of hidden layers and hidden neurons based on an automatic growing and pruning algorithm the self organising dbn has accelerated the learning process and demonstrated robustness in tolerating input fluctuations wang et al 2020b proposed the recursive time dbn in such a way that the input layer received the current moments and historical time values of the characterization factors and influencing factors the resulted hybrid model outperformed the base dbn and lstm models in forecasting algae density to improve the model training efficiency wang et al 2021 proposed the dbn with an event triggered learning algorithm dbn el to ignore ineffective data pairs such as outliers the dbn el converged much faster without noticeable fluctuations as it benefited from the selective response mechanism nevertheless the prediction accuracy of the dbn el was higher than the conventional dbn and sparse deep belief fuzzy neural network by demonstrating higher fitting further experiments also showed that the dbn el has a stronger capability in predicting tp concentration with a shorter runtime apart from using the dbn as a forecasting model qin et al 2017 used the dbn as an unsupervised feature extractor to assist the arima in red tide biomass forecasting wang et al 2020c coupled the dbn with multivariate space time autocorrelation stvar to extract useful features from the multivariate wq and weather data then fused it into the anfis for spatiotemporal chlorophyll α prediction in another study the dbn excavated essential characteristics of the wq parameters for total nitrogen tn prediction and effectively reduced overall prediction errors by 50 as compared to that of standalone lssvr yan et al 2020 3 4 denoising based hybrid models denoising algorithms such as the empirical mode decomposition emd ensemble emd eemd and the ceemdan are frequently used to decompose original time series data into several stable intrinsic mode functions imfs to ease modelling in some cases the high frequency imfs may be recognized as noise and are to be removed from the model input the emd is a signal adaptive decomposition technique proposed by huang et al 1998 that decomposes complicated signals according to the local characteristic time scale the eemd which was proposed by wu and huang 2009 is mainly used to overcome the mode mixing problem in the emd through the addition of an ensemble of white noise to the signal the added white noise generates a uniform reference frame in the time frequency space so that the signal of a similar scale can be collated into the same imf torres et al 2011 then invented the ceemdan that removes residue white noise completely upon decomposition which ensured a better spectral separation of modes at lower computational cost the mathematical theories behind the denoising algorithms could be referred to in the said literature the excellent performance of denoising algorithms in improving the ml models has been reported by lu and ma 2020 the authors also suggested that choosing an appropriate signal denoising method is more crucial than the model since the data quality is the essence of modelling eze and ajmal 2020 decomposed do time series data and selected the highly correlated imfs for the lstm training the eemd lstm was able to follow the trend of do closely up to 12 h and outperformed the sae lstm proposed by li et al 2018 zhang and yang 2020 reported that the ceemdan gru has consistently captured the trend of suspended sediment concentration in the yellow river and had outperformed the gru without a denoising algorithm huang et al 2021 further improved the performance of the ceemdan through the addition of the lempel ziv complexity which is a symbolic dynamic algorithm used for quantifying the uncertainty in time series data lempel and ziv 1976 the imfs with similar lempel ziv complexity values were stacked for the gru training the proposed model demonstrated lower prediction errors and higher fitting than the ceemdan gru a similar result was observed when the gru was replaced with the lstm and rnn dragomiretskiy and zosso 2014 developed the variational mode decomposition vmd that non recursively decomposes an input signal into imfs comprised of amplitude and frequency modulated waves with the aid of the wiener filter the vmd is not prone to background noise thus outperforming the emd in many applications maji and pal 2016 uzunoglu 2018 ren et al 2020 reported that the vmd significantly reduced the noise and highlighted key data features for better do prediction in aquaculture ponds in another study fijani et al 2019 proposed a two staged decomposition method upon the ceemdan decomposition the high frequency imf was further resolved into finer scale components by the vmd so that the model could be more responsive to the fine scale data patterns the ceemdan vmd based models were validated more accurately than the ceemdan based models similar findings were also reported by dong and zhang 2021 where the ceemdan vmd based models were better in extracting multiscale periodicity and non linearity of the pollutant time series hence the two staged decomposition involving different signal denoising techniques could be attempted whenever a single decomposition technique did not perform satisfactorily and a comparison between different denoising algorithms on model performance could be studied 3 5 attention based hybrid models the attention algorithm was proposed to improve model performance in machine translation by attributing the highest weights to the most relevant parts of the input sequence zhu et al 2019 a detailed illustration of the mechanism is given in the literature bahdanau et al 2014 in wq prediction the weather or wq parameters could be some influencing factors hence the attention mechanism may select key input features for target prediction by assigning larger weight to the essential parameters bi et al 2020 incorporated an attention layer into the lstm for effective information extraction from the long temporal dependence do dataset zhu et al 2021 designed a hybrid model comprised of the resnet bi lstm and multi head attention to extract features from different wq time series then concatenated into fc layers for output prediction in another study the cnn lstm coupled with a self attention mechanism has led to a better global convergence in predicting the effluent quality of wwtp li et al 2021c the author explained that the cnn lstm model was driven by the attention mechanism and thus can easily stay focused on the salient features in the dataset for 3d wq modelling in an aquaculture system the attention mechanism established long distance dependence between input sequences and highlighted the impact of key features on do prediction cao et al 2021 liu et al 2019c compared different types of attention mechanisms and reported that the temporal and spatiotemporal joint attention mechanisms outperformed others in do forecasting the temporal attention based rnns can maintain higher accuracy over a long term do prediction and are highly recommended for the wq time series prediction 3 6 transfer learning based hybrid models being different from the traditional ml techniques where the model tries to learn everything from scratch the transfer learning tl based model typically transfers knowledge from the previous task to the target task where the latter has less training data pan and yang 2010 by applying the knowledge learned from the source domain the tl algorithm would improve generalization in the target domain and avoid overfitting yosinski et al 2014 knowledge transfer can be categorized into a data distribution transfer domain transfer and task transfer and most studies involve domain transfer lumini and nanni 2019 zhou 2020 zhu et al 2021 wang et al 2019a designed a growing dbn network based on tl a single layer dbn was pre trained as the source domain transferred to the target domain to initialize its weights and allowed the dbn to grow in depth when applied to the actual dataset the tl dbn demonstrated higher learning speed and was more robust than the existing structure tian et al 2019 applied tl on the ann rnn and lstm for chlorophyll α dynamic prediction the models were pre trained using wq data collected in june then fine tuned and applied for chlorophyll α prediction based on test data collected three months later the tl based models have reduced the influence of mutable data distribution and maintained higher accuracy for prediction in the next three months the authors also reported that the tl was better than the parameter norm penalties and dropout methods in improving model generalization ability the tl was applied to wq classification based on remote sensing images pu et al 2019 in situ data were first collected from a lake in china and calibrated with landsat 8 images as a pre training for the tl cnn the model was then applied to another lake lacking in situ measurement data the tl cnn model outperformed the standard cnn svm and rf along with satisfying generalization ability and thus it was recommended for inland lake monitoring where in situ data collections are rather difficult in another study the tl lstm was used for river do forecasting under severe data missing scenarios where direct training of the model is not feasible zhou 2020 the lstm was first trained with complete data to learn its pattern then transferred to the target temporal sequence with missing data for do forecasting as a result the tl lstm could follow the do trend adequately under different data missing scenarios unlike the lstm model that demonstrated apparent flatten prediction similarly zhu et al 2021 pre trained their do prediction model at taihu lake using a large dataset and subsequently applied the model at yixing lake with limited data it was found that the tl based model had higher prediction accuracy and shorter training duration than the model that was only trained with data collected from lake yixing despite the differing water characteristic at both lakes the tl was proven effective and significantly reduced the amount of data required in most situations the tl algorithm was paired with the dl to solve the data limitation and reduce training time in the target domain since only a small amount of labelled data is available model training is rather difficult and tends to overfit by having the model pre trained in a larger dataset it could initialize model weights for the target domain and hence contributes to better performance than starting from scratch this would avoid random initialization of parameter weights and increase model training efficiency typically in a deep architecture qureshi et al 2017 as such the tl algorithm is highly recommended for wq prediction as data availability is always a major issue 3 7 process based hybrid models the process based models are mechanistic models that work on general physical relationships such as mass and energy conservation to simulate the target variables as these models are strongly rooted in scientific theory they were designed with a rigid relationship with several constraints and often diverged from the theory when calibrated with real world data read et al 2019 when applied in the field of hydrology the auxiliary parameters like climate or topography data would increase the difficulties of model calibration on the other hand the dl models have no assumptions of processes underlying the data it might be difficult in several ways for prediction in unmonitored regions or long term projection due to data sparseness limited auxiliary data weather or wq data from nearby stations and the impact of some expected climate changes varadharajan et al 2022 a large dataset would also be required for the dl to learn the dynamics of the complex systems and to make accurate predictions in recent years the idea of integrating scientific knowledge and the rnn based models gained momentum and growing interest amongst researchers willard et al 2020 the knowledge guided dl hybrid models were developed for downscaling inverse modelling creating synthetic data discovering governing equations simplifying the complex mechanistic model and parameterization this parameterization is not the commonly defined terminology found in the mathematics field but refers to the process of replacing a complex mechanistic model with a simplified one so that it can be modelled using dl strategies some process based hybrid models attempt to make physically consistent and robust predictions by designing a loss function to penalize the model when a known physical law or relationship is violated read et al 2019 a process guided pg recurrent graph network was proposed for modelling interacting segments in the river network jia et al 2020 the prior knowledge embedded in the physical model was used to improve the learning of latent representation while the loss function was optimized to improve global and local prediction on each river segment sadler et al 2022 in turn proposed a pg based lstm to forecast streamflow and temperature simultaneously via a multi task learning approach given that streamflow and temperature formed part of the energy transfer processes the model established their relationship for multi objective optimization and showed significant improvement over the single task model that predicted both parameters separately from these studies the hybridization of recurrent based models with process based models has shown promising results in different applications it remains as a great research direction to solve to complex science and engineering problems by integrating traditional physics based modeling approaches with different state of the art dl models 3 8 concluding remarks a prediction model that is solely based on an individual algorithm typically contains only partial information about the object singha et al 2021 combining the dl model with other algorithms may allow for more comprehensive information to be extracted here we summarise the common hybrid models employed for wq prediction as the cnn is capable of extracting time invariant features it is commonly hybridized with the other models as a feature extractor through the extraction of effective representation and local features from a huge dataset the cnn improves model computation efficiency minimizes model complexity and eventually had been claimed to be able to outperform many other algorithms like the pca and hopls when coupled with the dl models as reported earlier the cnn was often associated with the lstm for time series forecasting in different applications and had also outperformed most dl models the fusion of spatial and temporal information by the cnn and the lstm module allows for relevant variables information to be fully extracted leading to its adaptability for complex non linear systems in wq prediction despite having a longer training time the hybrid models typically converged with fewer training epochs it was also found that limited comparisons were made for the cnn gru in algal bloom forecasting and wqi time series forecasting hence future studies are recommended on these gaps the recurrent based lstm and gru mainly serve as a temporal forecasting model in some studies where the lstm had failed to capture long term trends a statistical model like the sarima was adopted to capture the linear trend of the wq parameter for better lstm prediction the recurrent based models were also coupled with process based mechanistic models to integrate scientific knowledge into the black box models the resulted physic guided hybrids often showed higher robustness and accuracy in wq forecasting across different seasons or spatial coverage it was noted that the gbdt combined weak learners with strong learners and was able to assist the gru with the 3d do prediction through the unsupervised encoder decoder process the ae also performed dimensionality reduction and in depth features for the lstm even though many types of ae have been proposed only the conventional ae and sae have been coupled with the lstm for wq forecasting other types of aes could be hybridized with the lstm and gru and then be compared with the popular cnn lstm and cnn gru models given that the lstm typically trains slower than the gru however the performance of the hybrid models was seldom compared hence future studies may focus on this direction combining different denoising algorithms such as the ceemdan and the vmd has been reported with better signal decomposition and denoising performance can be achieved given that different datasets may require different denoising algorithms further research and development of creating a guideline on this topic would be beneficiary the rbm was seldom used for wq prediction studies owing to its weak ability in handling sequential data the stacked rbms more generally known as the dbn are commonly employed for extracting inherent correlations between wq variables by having a self learning capability the dbn could form hybrids with other dl algorithms to serve as a feature extractor and become a prediction model as there are more parameters to be trained researchers may pay more attention to optimizing the dbn structure and consider coupling the dbn with different algorithms to improve its dbn performance such as event triggered algorithm recursive time algorithm statistical model and so forth the attention algorithm was coupled with dl models to allocate more computation power to the important parts of the data without introducing abundant parameters the attention algorithm helps to select key input features for target prediction and improve training efficiency several attention mechanisms have been identified and comparisons should be made for the different wq prediction studies using datasets collected from different water environments in the event of insufficient training data a tl algorithm was hybridized with dl models to realize model training knowledge transfer has been adopted in optimizing the dbn network parameters and transferring knowledge learned in a large dataset to a small dataset most studies hybridized with the tl algorithm have reported a positive result where the fine tuning would shorten training time and require fewer data than training everything from scratch nevertheless the model with the tl typically demonstrated higher generalization ability with higher prediction accuracy and is highly recommended if the target dataset is too small for sufficient dl training 4 application of deep learning algorithms for wq prediction 4 1 rivers many mechanistic models have been developed to forecast wq in rivers including the river and stream water quality model qual2k water quality analysis simulation program wasp and so forth ahmed 2017 zhu and heddam 2020 however expert knowledge is needed to pre set the boundary conditions and system characteristics cox 2003 these mechanistic models also take upstream boundary flow conditions water level pollutant concentration and other parameters in time series format for dynamic modelling and this further increases the amount of data required some complex hydraulic models even seek boundary conditions at the bottom of the river system and the data of each reach whenever there are some influencing tributaries or effluent discharge points apart from the mechanistic model traditional statistical models were used for river wq parameter time series forecasting given that the wq parameters are influenced by complicated factors conventional models based on linear distribution cannot comprehensively consider the influence of these factors bi et al 2020 non linear ml models usually performed better than the statistical models but their shallow architecture was unable to extract inherent features for better model training especially when the datasets were sufficiently large and complex lu et al 2021 owing to this the dl based models with recurrent architecture such as the lstm and the gru become the most popular time series modelling tools in river wq forecasting barzegar et al 2020 xu et al 2021 table 3 summarizes the studies conducted in river wq forecasting using dl algorithms researchers reported that dl algorithms typically outperformed the traditional statistical models and shallow ml models dong et al 2019 bi et al 2020 lu et al 2021 from the summary of past studies listed in table 3 it was found that the do is the most frequently studied parameter followed by the organic pollutants parameters like cod bod chlorophyll α and so forth some researchers adopted the cod and bod as a comprehensive index to reflect the wq evaluation of rivers ye et al 2019 research concerning nutrients heavy metals or other pollutants is still limited most studies focused on short term prediction using hourly data probably since the wq variable can be easily influenced by different parameters further studies can be conducted to improve the long term river wq prediction by developing a robust model with a stronger ability to capture short term and long term temporal patterns the dl models could be hybridized with denoising algorithms which aim to smoothen the input signal for better model learning and prediction the tl algorithm could also be hybridized with dl models for river wq forecasting for instance pre training the model using data from the upstream station then fine tuning and applying it to the downstream station for wq forecasting the water quality index wqi is a single number designed to turn the complex wq data structure into a simpler description to ease water management the process of obtaining the wq parameter data through sampling at different points would be very costly and time consuming chia et al 2021 nevertheless calculating the wqi via an empirical equation is a tedious process and the computation of the wqi would not be possible in case of any missing wq parameter owing to these reasons researchers have been adopting the ml models such as the lssvm chia et al 2021 ann gazzaz et al 2012 hameed et al 2017 and hybridized elm abba et al 2020 for river wqi prediction whilst the applications of dl algorithms for wqi prediction have rarely been reported therefore future studies that focus on such directions would be highly recommended and welcomed 4 2 lakes for lake pollutants forecasting lu et al 2022 reported that the lstm performed better when the historical data for both inflows and internal loads were provided based on our literature search the majority of the studies used dl models to predict harmful algal bloom and relevant wq parameters such as chlorophyll α and nutrients table 4 presents the past research on lake wq prediction using dl algorithms it was generally believed that a chlorophyll α concentration higher than 10 µg l or a density of cyanobacteria above 2 107 cells l was the critical value for cyanobacterial blooms oliver and ganf 2006 the water temperature of 26 c seemed to be the most suitable temperature for the aggregation of cyanobacteria and the formation of bloom deyu et al 2008 harmful algal bloom prediction is a difficult task as most of the aquatic system data are sparse and incomplete thus hindering the development of a good multivariate predictive model traditional chlorophyll α modelling was performed based on the hydrodynamic and wq models such as the efdc and ce qual w2 which require expert calibration lee et al 2020b with the rapid growth of ai various ml techniques have been reported for their application in the prediction of chlorophyll α including ann li et al 2017b lee and lee 2018 anfis loc et al 2020 svr dt barzegar et al 2020 and so forth one major assumption in the ml approach is that the training and testing data must be of the same distribution which may not hold for chlorophyll α prediction the process of algal bloom in rivers and lakes is highly non stationary and non linear wang et al 2020c the prediction accuracy of certain ml models gradually decreases over time when the model is used to predict chlorophyll α outside the training sample dataset tian et al 2019 as shown in table 4 the dbn and its hybrids remain among the most popular dl algorithms for chlorophyll α forecasting and harmful algal bloom prediction given that algal bloom is a rare event the chlorophyll α dataset would be highly skewed and synthetic data could be used to solve the data imbalance by enlarging the minority dataset choi et al 2019 showed that the synthetic minority oversampling technique smote improved the performance of the cnn in predicting algal bloom the variation of chlorophyll α concentration is seasonal and is affected by many parameters such as water temperature yu et al 2020b wind speed ma et al 2015 nutrients and so forth knowing that the wq parameters could be influenced by the weather data it is recommended that meteorological sensors be installed in the vicinity of the wq monitoring stations so that auxiliary weather data could be used to improve model performance it has been reported that wind field data played an important role in forecasting the turbidity of lake water song and zhang 2020 tl and remote sensing technology could be adopted for lakes where accessibility poses a problem the model could be pre trained using in situ data and calibrated satellite images and then fine tuned and applied for wq forecasting at the targeted lake 4 3 coastal zones the release of agricultural and sewage runoff into the coastal regions has resulted in severe coastal algal blooms and has been regularly reported in china su et al 2021 zhang et al 2016 south korea kown et al 2018 lee et al 2020a hong kong deng et al 2021 united states karki et al 2018 yu and shen 2021 and many other countries these algal blooms have devastating effects on coastal fisheries and mariculture practices on the open seas as different coastal areas have their dominant factors with highly complicated non linear characteristics scientists are unable to attribute algal blooms to any specific factor owing to the mechanism causing algal blooms to be unclear predicting algal blooms based on theoretical dynamic models has been rather difficult often demonstrating poor generalization performance with the establishment of a marine water monitoring system in many countries data driven approaches that handle non linearity and complex relationships between parameters have become a better option for predicting algal blooms as shown in table 5 the dbn and lstm and their hybrids are most commonly used in coastal wq forecasting typically researchers have to cover a wider region in coastal wq forecasting to ensure that their predictions are representative of the whole study area it is rather difficult to gain a synoptic view of the spatial extent and temporal variation of wq for such a vast area thus in situ monitoring remains a challenge to cover such a large scale event like algal blooms or marine water pollution consequently satellite remote sensing is used as a supplementary algal bloom observation tool with some algorithms developed based on ocean color data from optical satellites kown et al 2018 karki et al 2018 most studies focused on the optically active variables such as sea surface temperature sss chlorophyll α and so forth in contrast fewer studies were conducted on the optically inactive variables such as cod and bod probably due to insufficient in situ sampling coverage for spatial prediction in coastal areas unlike the optically active parameters which could be determined from remote sensing images the detection of the optically inactive cod and bod parameters relies wholly on physical sensors installed at sampling sites however these optically inactive parameters are also crucial for determining marine wq hence further research on the optically inactive parameters from remote sensing images is highly recommended 4 4 aquaculture ponds the aquaculture is a dynamic system with the wq intensely affected by external factors owing to the open environment of the pond mariculture in turn is a subset of aquaculture whereby seawater is used for farming marine organisms for indoor recirculating aquaculture systems which are mostly shielded from the outer environment only several parameters were deemed significant including temperature ph conductivity turbidity and an do remains the most essential factor for the survival of aquatic creatures where it directly affects the feed intake bait conversion rate and disease resistance of aquatic products cao et al 2020 stunted growth may be observed among the fishes and diseases can easily outbreak when the do is low a sharp decline in the do caused by wq deterioration in hainan xincun port has resulted in large scale fish kill in 2017 hu et al 2020b in a smart aquaculture farm artificial aeration helps to maintain do levels by setting the aerator to commence automatically whenever the do level falls below the threshold given that oxygen diffusion is a slow process early prediction of do changes would thus be advantageous so that the aeration rate could be adjusted simultaneously prediction of do in an aquaculture environment falls into two categories i single parameter prediction that predicts do based on historical do data without considering the correlation with other parameters ii multi parameter prediction that fully considers the complexity of do changes with other correlated wq parameters and meteorological factors most aquaculture monitoring systems adopt multi parameter prediction and consider do water temperature water ph atmospheric humidity atmospheric temperature atmospheric pressure wind speed and wind level in their calculations due to the complex relationship between do and other input variables statistical models hardly guarantee the accuracy of do prediction and demonstrate poor self adaptability on the other hand the non linear ml models lack a memory function of historical data thus performing poorly in long term prediction dl algorithm models were proposed to solve the memory problem of historical data input recent studies undertaken in aquaculture wq forecasting have been summarised in table 6 some studies have successfully proven that the accuracy of do prediction in outdoor aquaculture ponds would be higher if weather data were provided as auxiliary data since solar radiation wind speed atmospheric temperature and relative humidity may affect the rate of oxygen diffusion li et al 2018 cao et al 2021 however the turbidity should be included given that turbid water may reduce sunlight penetration and photosynthesis rate providing a variety of factors as input data can allow for consideration of more possible relationships between wq parameters but having too much information in the model may increase the computation burden and could also reduce learning efficiency dimensionality reduction tools such as the pca would be useful in reducing the redundancy of the feed data in most studies a multivariate time series prediction could be attempted instead of a univariate time series prediction the low dissolved oxygen ldo algorithm proposed by zhu et al 2019 is a great idea to improve model sensitivity where it could be applied for other critical wq parameters so that any deviation could be detected in advance to safeguard the aquaculture livestock indeed a local point prediction may not reflect the actual do in the pond the 3d do distribution modelling conducted by cao et al 2021 and zhou et al 2021 provided a better understanding of the spatiotemporal changes of the do within the area of interest and paved the way for future wq modelling in different water bodies 4 5 wastewater treatment plant wwtp the activated sludge process is widely adopted in municipal wwtp to remove both organic carbon and nitrogen substances however the wwtp modelling becomes challenging due to its complex non linear dynamics with significant disturbances and uncertain time delays a wwtp is a combination of hydraulic and biochemical processes wang et al 2021 the hydraulic model describes the non linear dynamic of flow rates and recirculation to the reactor whereas the biochemical model represents the dynamics of the variable evolution process interaction between the variables goes along the whole wwtp leading to a strong coupling effect among parameters and giving rise to uncertainties that increase the difficulties for modelling the presence of outliers further contributes to ubiquitous uncertainties and ineffective iterations under strict environmental regulations soft sensing models for wwtp effluent quality are vital soft sensing is an indirect measurement of a target parameter such as bod where the actual value cannot be determined directly using hardware in real time it is accomplished by feeding a measured parameter into a pre defined model to predict the target parameter a fast and accurate soft sensing model for effluent quality not only gives an explicit description of dynamics but also provides an alert reference for the pre planning of necessary remedies or operational parameters tuning action in advance of an abnormal operation occurring the ml techniques have been widely applied to existing soft sensing models on effluent quality in wwtp fernandez de canete et al 2016 han et al 2016 however ml techniques have a poor capability of extracting deep features from the datasets which is deemed crucial for an efficient learning process the absence of this information may lead to a high computation effort with unsatisfying prediction outcomes to solve this issue efforts have been made by applying dl algorithms for the prediction of wwtp effluent quality guang et al 2019 li et al 2021c wang et al 2021 effluent flow rate wang et al 2019b power consumption cheng et al 2020 and so forth the event triggered learning algorithm has been adopted to ignore non valuable data pairs and improve model learning thus converging the model much faster with higher accuracy wang et al 2021 as shown in table 7 the cod was the most frequently studied parameter followed by ss nutrients and wwtp operational parameters such as inflow and power consumption the ss and bod were found to strongly correlate with cod guang et al 2019 the cod is the major monitoring parameter for wastewater quality by reflecting on the quantity of organic matter in the wastewater wang et al 2021 when the cod reaches a threshold value the water sample becomes rancid as the water self purification process consumes most oxygen to degrade various organic substances this phenomenon kills aerobic microorganisms breaks the natural balance of the environment and leads to the extinction of aquatic organisms if not treated initially impurities such as numerous biological corpses will be absorbed by the sludge and thus silt up which will in turn cause irreversible harm to the whole biosphere in the long run guang et al 2019 owing to this the control strategy of aeration systems is mainly based on the influent cod measured by a cod analyser that takes a long time to stabilize the delay of cod measurement is a major challenge for process control which practically increases the treatment cost due to the amount of aeration needed and chemicals added wang et al 2019b scholars have developed some dynamic cod forecasting models using dl algorithms and their hybrids wang et al 2019b adopted a hybrid cnn lstm for dynamic modelling of wwtp effluent cod and reported that direct forecasting of cod mass flow has a lower prediction error than the indirect method where the cod mass flow was calculated based on the predicted sewage inflow and cod concentration for multi parameter forecasting researchers reported that physical parameters such as water temperature inflow and power consumption were easier to be predicted unlike the chemical parameters where complicated biochemical reactions may increase the difficulties of forecasting cheng et al 2020 the wwtp operational parameters pump rate aeration chemical dosage and so forth could also be fed into the model to optimize cost savings it is believed that soft sensing of the wwtp effluent bod should be thoroughly studied which aims to replace the traditional bod measurement that is time consuming and labour extensive apart from these researchers may also consider more auxiliary data when training the dl models including drinking water supply data sewage flow data weather data and social population data a study conducted by jiang et al 2021b has successfully proven the effectiveness of using such auxiliary data to improve wq parameter forecasting in wwtp 5 iot and cloud computing for water quality monitoring using dl with the development of efficient dl models to handle large datasets continuous monitoring of wq has become an interesting but challenging area of research smart environmental monitoring is made possible with the emergence of modern sensors which are a central part of the ecosystem of the iot the iot comprises devices including servers sensors and actuators that are interconnected wirelessly to the internet for monitoring controlling and data logging ullo and sinha 2020 the development of mobile sensors which allows for the spatial variation in point measurement increases the need for data communication among these devices when manpower is unable to track the mobile sensors at all times this provides real time analysis to be carried out and the spontaneous adjustment to the sampling strategies li et al 2017a the data generated by the iot devices are typically stored in the cloud systems for future retrieval consequently the big data environment for future smart environmental monitoring may approach a stage where the setup is more mature and friendly not only for monitoring but also for considering statistical anticipation as well the merging of iot based data collection and dl has provided a new outlook for researchers this is coupled with the recent reduction in the cost of applying iot devices for wq parameter monitoring wong et al 2021 one of the earlier works proved that neural networks with multiple layers could cope with data collected with iot devices and classify the real time wq into three levels chowdury et al 2019 a water potability classification had also been pursued using iot data driven dl models alipio 2020 in china combining the iot and the lstm network has turned into one of the innovations in the predictive modelling of wq it was reported that the predictions of the wq parameters by the lstm network matched well with the actual data collected by the iot devices for comparison purposes the svm and arima models were deployed for similar functions however their performances were far from satisfactory when contrasted with the lstm network liu et al 2019b barzegar et al 2020 conducted a similar study in albania greece and macedonia three dl models including the conventional lstm the cnn and the hybrid cnn lstm were compared with shallow models such as the svm and dt the authors reported that the three dl models performed similarly in predicting do and chlorophyll using multivariate inputs conversely the kernel based svm and binary dt tended to underestimate the two parameters of interest it is important to note that although the dl models had predicted well generally however the results of this study revealed that these models are still susceptible to extreme values or outliers this would make real time monitoring a crucial aspect of smart environmental monitoring these studies justified the ability of the dl models in handling real time data from iot devices and subsequently make meaningful predictions however the use of iot means that data will be collected continuously and the size of the database eventually can become too massive for a typical workstation to process some technological giants have offered cloud computing facilities to the public such as the amazon web service google colab and microsoft azure these enable the researchers and the public to use such platforms to train and test their dl models before field deployment thus easing substantial costly technical computing requirements performing cloud computing for real time wq monitoring and prediction modelling could result in lesser data communication among devices this eventually could lead to higher efficiency the current iot dl model frameworks require data to be sent from the sensors to both the cloud system for storage and the user interface remote and local to obtain user inputs the user inputs then have to move in the opposite direction to the in situ actuators to execute any actions meanwhile the user might have to communicate with the cloud system to retrieve data or store historical actions these steps can be simplified if the dl models are trained using cloud computing and the users are only required to set up rules for plausible executions human interference may only occur when unforeseen circumstances happen this was suggested by sagan et al 2020 where the authors used this framework for satellite image processing the use of cloud computing would ease other innovations of dl models for wq monitoring for instance zhou 2020 proposed a tl scheme whereby the lstm network trained in the reference domain was transferred to a target domain with a high ratio of defective data the transfer involved data pattern transfers model transfers and task transfers which can be overwhelming communication between devices the work can be hastened by integrating iot devices with cloud computing equipped with dl models 6 limitations on water quality prediction 6 1 data limitation dl models are data hungry and require a large dataset for training in many studies the authors only performed one step forecasting using a small dataset it is recommended to consider sensor networks that offer datasets of larger dimensions and higher frequency for example some countries like malaysia have most of the river wq data collected bi monthly in the past decades whereby the dataset could not reflect any short term wq changes due to limited dataset availability researchers may only be privileged to train the model using a single monsoon dataset collected over several months thus the model would demonstrate poor generalization ability in predicting wq across the different seasons the lacking of weather data may affect the training and performance of the models as some meteorological parameters like wind speed atmospheric temperature and pressure would have a certain impact on some wq parameters 6 2 poor data quality unlike the aquaculture pond and wwtp the data collection for surface waters can be rather difficult and is also subject to additional errors for iot sensors many issues are reported on the devices such as power supply issues and network communication problems which inevitably deteriorate data accuracies the sampling frequency is very low for manual data collection since tremendous efforts would be needed in any case specific physical parameters must be measured in situ and are subject to human errors arising from the inexperienced operation faulty sensors incorrect calibration and other factors for chemical parameters that must be analyzed in the lab the wq parameters may change during transportation and storage unfortunately some data may not be collected due to poor weather and this would invariably influence the quality of the dataset this would result in many missing data situations or the presence of outlier data points in the dataset this would also render the need for extra efforts for data processing and subsequently increases the difficulty of model training hence the incomplete and highly sparse aquatic data often hinder the development of a good multivariate predictive model 6 3 lack of integrated real time water monitoring system the water supply in some areas can be considered as that of a multi level water system covering both the surface water and underground water for which both wq have an impact on each other there is a lack of research work in these areas for instance a study addresses wq impacts on different water levels due to water pollution from a specific water source existing published works usually adopted specific ml and dl techniques for water resources in a limited location during a specific period hence there is a huge demand for advanced technologies integrating multi level water monitoring and evaluation systems using sensor networks and iot infrastructures dl techniques are always closely associated with big data varadharajan et al 2022 the deployment of various sensors and iot devices enables the collection of high velocity data which is useful for dl applications in wq management in two ways firstly more data with different resolutions can be used to enhance the accuracy and performance of the dl models through a more rigorous training process secondly the collected real time data can be fed to an existing dl model for predictive modelling using cloud computing as a precautionary approach current iot applications in most developing countries are still insufficient to emphasize their values throughout the whole stream of dl based wq management jan et al 2021 6 4 different parameters and threshold limit for comparison it is almost impossible to make a fair comparison between models developed in different studies owing to the different datasets adopted and the parameters of interest given that a model may work well on dataset a it may in some probability not perform similarly on another dataset b researchers often face difficulties in making a general comparison for the developed models most countries have their standard of discharge limit for different wq parameters thus paving the way for more cumbersome and additional difficulties for model comparison wq datasets collected from different institutions would contain different wq parameters whilst there are limited comparisons among dl models using the same dataset 6 5 computation power and hyperparameter tuning most dl networks are complicated and contain plenty of hyperparameters to be tuned despite some of the variants reducing the number of parameters by merging their gates the training speed does not improve drastically this is because the rnn based models would still have to work through all the sequences which is a time consuming process and exponentially worsen for cases with long sequential data as such the rnn based models require intensive computational power not to mention that the model may fall into a vanishing or exploding gradient problem similarly the dbn networks typically perform better with additional rbm layers and neurons but this drastically increases computational time cost researchers would need to optimize the trade off between prediction accuracy and training time by designing parameters for their networks in some studies dimensionality reduction tools and feature extractors were employed to reduce training complexity so that only effective and useful information was provided to the model critically there is no standard practice for tuning hyperparameters and researchers are relegated to optimizing the model manually or using an optimization tool 7 recommendation for future works 7 1 model optimization the structure of the dl networks number of layers neurons gates can be optimized to reduce model complexity and computational effort some researchers suggested extending the number of hidden layers in a multi layer network for better prediction performance typically the number of the rbms layers in the dbn could be increased for better feature learning output but at the cost of higher training time a more effective memory block for the lstm should be designed to overcome the long training cycle in the lstm critically future research direction may focus on designing effective self adjusting strategies for hyperparameters learning rate dropout activation functions etc and model structure historical time step forecasting horizon numbers of hidden layers and neurons where current research mainly adopted optimization algorithms like the adam genetic algorithm particle swarm optimization and so forth for the wwtp operation the trained model can be incorporated with optimization scenarios to target daily optimal wwtp operation pollutant removal and cost minimization similarly mariculture farmers may integrate pump and aeration rates into the model for multi feature prediction so that operating parameters could be optimized for lower operation costs 7 2 development of powerful hybrid models and ensemble modelling new hybrid models can be developed by combining the dl ml statistical tools and other learning algorithms different models possess unique individual characteristics that allow certain inherent features to be extracted hence most of the hybrid models outperformed their standalone counterparts for instance the combination of the cnn lstm allowed for both spatial and temporal features to be captured for better prediction performance an unsupervised algorithm like the ae could be used as an automatic feature extractor the dl networks may be improved with other learning algorithms such as event triggered learning so that model could avoid meaningless iterations attention algorithms could be hybridized to allocate more computation power to important data while the ensemble model could combine complementary advantages of multiple forecasting models to achieve better forecasting performance as the direct ensemble would increase the complexity of the model and lead to overfitting undeniably appropriate weight location must be determined so that models can be combined organically different ensemble modelling strategies could be considered either by using different modelling algorithms or using different training datasets which aim to minimize the generalization error of different base models process based physical knowledge can be embedded into the dl models for better representation of the complex flow and chemical transport dynamics in different water bodies which paves the way for developing a spatiotemporal wq forecasting model of higher generalization ability the interacting wq parameters driven by the same underlying physical processes can be modelled simultaneously for multi objective optimization via a multi task learning approach by leveraging information from related wq parameters the stability of the model could be improved especially in sparse data conditions 7 3 real time monitoring and data assimilation there is a lack of integrated real time monitoring and supervision handling system for the wq evaluation application of sensors network and the iot for real time evaluation of wq would be essential for immediate response of the operators in mariculture and the wwtp for the lakes and rivers the authorities should be notified immediately so that remedies can be planned such as stopping the intake points of water purification plants whenever pollution is predicted there is a minimal combination of research work on wq prediction and related pollution control at various levels like running water underground water and surface water data assimilation can be attempted for which the trained model integrates data obtained from real time monitoring sensors updates and improves itself through continuous iteration this could be one of the research directions to be followed aiming to develop a real time prediction model with low computation complexity high prediction accuracy and robustness 7 4 transfer learning tl and synthetic data in situations where the wq data collected were insufficient to train a dl model or contained too many missing data points which would render model training impossible a tl method could be applied by having a pre trained model using a similar or related dataset the model could learn with lesser data in the actual task during the fine tuning process nevertheless the computation time can be shortened without compromising prediction accuracy for example the continuous monitoring data of river a can be used for model pre training which is then applied to predict wq at river b with limited data upon fine tuning similar works can be attempted for different applications such as transferring a model trained in an upstream station to a downstream station without these training a model using a small dataset would easily lead to model overfitting researchers also recommended the bayesian regularization and ensemble averaging method in the case of a small dataset training the dl models with a larger number of hidden neurons and layers could be one of the appropriate solutions for datasets with extreme skewness such as in the case of algal blooms synthetic data could be adopted to increase minority data and solve the data imbalance problem 7 5 multi dimensional data for water quality prediction apart from designing the prediction model future research may focus on the quantity and quality of the data collected given that all dl models are data hungry smart iot sensors should be employed to collect more data at fixed intervals so that a multi dimensional input dataset with higher frequency would improve the extraction of hidden interactions between influencing wq factors for the wwtp related studies researchers may consider more relevant parameters like precipitation and climate factors over a longer research period since the concentration of pollutants fluctuates daily similarly the study of surface wq must consider seasonality as the wq may change with the seasons some researchers opined that hybrid models should be created to forecast the wq at peak and non peak times as the sequence of the environmental variable could be useful for surface wq prediction the weather and remote sensing data can be incorporated as auxiliary data the pooled features meteorological and geographical can be used to identify the appropriate parameters to predict the wq multivariate prediction typically works better than the univariate counterpart as the former realizes comprehensive prediction of the water body as a whole however this comes with higher model complexity but with the chance of introducing uncertainty to propagate within the model researchers should always be cautious when handling multi parameter datasets and dimensionality reduction tools should be employed 7 6 remote sensing spatial prediction and 3d modelling remote sensing images can be used for the wide area wq prediction involving optically active parameters such as chlorophyll α turbidity colored dissolved organic matter and so forth by studying the image color and textures a better strategy of extracting optically passive parameters such as the cod bod and nutrients could be a future research direction given that the do is strongly influenced by surface water temperature which can be easily interpreted from satellite images a combination of remote sensing images and environmental variables sequence may predict the do patterns in surface waters by building a tl based model by installing do sensors at different underwater positions a 3d spatial do prediction model could be developed to understand better the do patterns in different regions of the water environment so that remedies could be planned similar work can be extended to other wq parameters whenever the 3d spatial modelling is deemed necessary since a local point prediction may not represent the entire water environment instead of predicting upper ocean salinity the 3d spatial modelling of ocean salinity would combine the temporal and spatial information where the output could be used to infer other variables related to sea salinity like freshwater flux and direction of the ocean current successful works can pave the way for other surface water bodies and aquaculture implementation 7 7 advanced denoising techniques and dimensionality reduction wq and meteorological time series typically contain temporal noises where effective noise reduction must be conducted before model training more advanced denoising strategies can be studied for instance a decomposition algorithm that can adaptively determine the optimal decomposition level should be investigated to replace existing manually designed methods based on the user s experience hence future studies may focus on multi level denoising similar to those reported in the literature fijani et al 2019 bi et al 2020 even suggested that the dl methods like the stacked ae rbm and generative adversarial network could be used for signal pre processing given that wq parameters may have unknown interactions with each other most researchers tend to feed all collected data for model training including auxiliary features like weather data providing too much invaluable data would burden the training process without improving its prediction accuracy thus data dimension reduction and feature extraction would be helpful to adaptively select the most crucial input features from the context effectively dimensionality reduction tools like the pca and ae and their hybrids are highly recommended the effects of increasing network layers of the ae for deeper latent features extraction and dimensionality reduction could be further investigated 8 conclusions this review paper serves to cover the importance of the dl models in numerous instances related to wq management it began with the introduction of the ann and rnn models researchers attempted to fix the pitfalls of the rnn model in solving massive time series by introducing the different variants of the lstm gru cnn tcn and dbn models the characteristics of the different dl models were compared and contrasted many studies claimed that the performance of the dl models could be improved with various hybridization techniques these hybridization techniques come in various forms including of the combinations of different base dl models e g cnn lstm model process based hybridization e g pg lstm statistical based hybridization e g sarima lstm model ml based hybridization e g gbdt lstm model attention based hybridization e g attention gru gbrt model and tl hybridization e g tl lstm model evidently from the perspective of wq management the hybrid dl models were found to have outperformed the conventional dl models in terms of accuracy and fitting based on the results of the available literature this could be due to the fact that the hybrid dl models excel in various specific tasks including feature extraction trend learning and data manipulation throughout the review paper the application of the dl models in wq management has been discussed extensively most importantly the scope of this review paper was extended to cover as many types of water bodies as possible including rivers lakes coastal aquaculture water and even the wwtp for each water body the applications of dl models on the specific wq parameters of interest were discussed separately as the importance of parameters of one particular water body could be irrelevant in another the wqi a multi parameter wq metric was also explained in conjunction with the application of dl models technological advancement has driven the deployment of iot devices and cloud computing for wq management alongside the dl models the review pointed out the ways of merging iot cloud computing and dl models as a real time monitoring scheme the inclusion of cloud computing is beneficial when dealing with a gigantic scale of real time data and higher modelling efficiency less human interference is anticipated if the proposed system begins to mature although the dl models possess promising potential in the field of wq management several limitations and challenges await to be overcome to reach its full scale application at present the availability of data is still ranked the biggest difficulty whereby many regions worldwide still lack a proper data collection system and infrastructure this consequentially leads to the lack of data amount poor data quality and lack of systems or devices that can monitor the wq of various water bodies on a real time basis finally the development of high performance dl models is always accompanied by a large number of hyperparameters to be tuned this would pose a severe challenge to the need for computational power lastly the authors of this review paper suggested several recommendations for future works and studies for the dl models upcoming research works can focus on developing lightweight yet powerful dl models by modifying the architecture of the current dl models taking it a step further the researchers can also experiment with different ways of hybridizing the dl models to achieve better performance in wq management data wise the authors suggested that the current data collection infrastructures can be further improved with the deployment of more iot devices and advanced instruments this can help to mitigate the problem of missing data and at the same time provides more information on the wq in different dimensions alternatively the data structure can be modified via tl and the generation of synthetic data the remote sensing images can be utilized to spatially map the wq to better understand its dynamics also pre processing including denoising and dimensionality reduction shall be useful for extracting valuable and essential information from the available raw data by improving the techniques from the aspects of the dl models and data it is believed that the efficiency and effectiveness of wq management can be further enhanced appreciated and boosted to benefit the economy and social welfare of the local communities the premise which echoes the call of the 6th sustainable development goals of the united nations fig 6 illustrates a word cloud demonstrating the various dl models adopted for wq prediction it is noticeable that the gru and lstm are more visually appealing than the other dl models for wq prediction declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by universiti tunku abdul rahman utar malaysia through the universiti tunku abdul rahman research fund under project number ipsr rmc utarrf 2020 c2 k03 the authors are very grateful and appreciate very much the financial support provided 
