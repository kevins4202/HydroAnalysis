index,text
22015,vortex induced vibration of a circular cylinder near a plane boundary has been investigated experimentally for 2 500 r e d 10 000 3 0 u 12 0 0 3 s 8 and m 5 3 where r e d is the reynolds number based on cylinder diameter u is the reduced velocity s is the gap distance between the planar wall and the cylinder and m is the system s mass ratio the experimental data includes simultaneous amplitude response and wake measurements via time resolved planar particle image velocimetry piv from experimental raw data frequency content of the oscillations as well as wake velocity and vorticity fields are analyzed a new vortex shedding flow regime map is proposed illustrating dominant vortex shedding patterns in the wake across the investigated non dimensional parameter space the quantitative relationship between the cylinder s motion and instantaneous vortex dynamics is shown keywords vortex induced vibrations boundary layer vortex amplitude response low order model particle image velocimetry 1 introduction vortex induced vibrations viv of cylindrical structures is of interest to many engineering applications for example viv influences the dynamic loading on offshore risers transporting oil from the seabed to the surface it is important to the design of such engineering structures as off shore platforms wind turbine masts cable supported bridge decks pipelines at water crossings and tethered structures in the ocean numerous practical applications of viv in engineering problems has led to large number of studies in this field many of which are presented in thorough reviews of williamson govardhan williamson and govardhan 2004 sarpkaya 2004 and bearman 1984 common non dimensional parameters used in the characterization of the response for a single degree of freedom 1dof viv system include the response amplitude a a d where d is the cylinder diameter and a is the oscillation amplitude frequency f f f n where f is the dominant peak from the spectra of the cylinder displacement and f n is the natural frequency of the system reduced velocity u u f n d where u is the free stream velocity mass ratio m 4 m π ρ d 2 l where m is the mass of the system and damping ratio ζ c 2 k m where k is the system stiffness and c is the damping coefficient feng 1968 investigated the amplitude response of a high mass ratio system m 248 by measuring the oscillations of a circular cylinder in a wind tunnel the corresponding results can be found in fig 1 a for low mass ratio systems e g the results from williamson govardhan williamson and govardhan 2004 at m 2 4 significant changes to the response are observed in particular the amplitude response can be divided into four main response regimes including initial branch u 4 5 upper branch 4 5 u 7 5 lower branch 7 5 u 10 and de synchronization region u 10 as illustrated in fig 1 it is noted that the specific u range corresponding to each branch has been shown to depend upon both m and ζ e g see riches and morton 2018 distinct changes in the frequency response of the cylinder occur within each response regime for the initial branch it has been shown that two dominant frequencies define the cylinder s oscillation the strouhal vortex shedding and system s natural frequency fig 1b the transition between the initial and the upper branch occurs as the strouhal frequency reaches the natural frequency of the system in water f o f n w a t e r williamson and govardhan 2004 the oscillation frequency in the upper branch continues to increase with an increase in u up to u 7 fig 1b at u 7 as the oscillation frequency reaches the natural frequency of the system in vacuum f o f n v a c u u m fig 1b and this corresponds to the transition to the lower branch fig 1a in the lower branch the oscillation frequency is locked at a frequency higher than the natural frequency of the system this is attributed to decreasing added mass effect in the lock in range williamson and govardhan 2004 for about u 10 the amplitude response begins to decay into the de synchronization region the cylinder motion is no longer synchronized with the vortex shedding giving rise to a two frequencies defining the cylinder oscillation the strouhal frequency and lock in frequency the amplitude and the frequency response of the system are linked with the vortex dynamics in the wake williamson and govardhan 2004 in the initial branch the dominant vortex shedding pattern is 2 s fig 2 a while the wake topology for the lower branch is 2 p fig 2b as observed by govardhan and williamson 2000 cagney and balabani 2013 the wake in the upper branch is referred to as 2 p 0 mode govardhan and williamson 2000 wherein the secondary vortex in each pair p 2 and p 4 in fig 2b is of a significantly lower strength than the leading vortex p 1 and p 3 in fig 2b in the de synchronization region no clear vortex pattern is synchronized to the cylinder motion khalak and williamson 2006 for the case of vortex induced vibration for a two degree of freedom 2dof cylinder with low mass ratio and damping experiments carried out by jauvtis and williamson 2004 have shown the typical three branch response of a 1dof system williamson and govardhan 2004 is modified such that the characteristic 2s wake mode within the initial branch transitions to a super upper branch this is in contrast with the upper branch classification for a 1dof system in the super upper branch the vibration response reaches its highest amplitude and this is accompanied by a 2t mode of vortex shedding jauvtis and williamson 2004 the 2t mode involves three vortices being shed from the cylinder each half oscillation cycle in contrast with the 2p or 2po shedding patterns observed in 1dof system response and illustrated in fig 2 it is recognized that the present work focuses on 1dof constrained systems such as that employed in the vivace energy converter lee and bernitsas 2011 in many engineering applications viv of a structure takes place in the vicinity of a wall boundary and thus different dynamics in terms of both the vibration response and the wake are expected for conceptual energy harvesting systems which make use of viv lee and bernitsas 2011 the cylinder is placed in the vicinity to a river bed or sea floor within the oil and gas industry pipelines at river crossings may undergo viv the pipelines are buried in the riverbed however with the passage of time they may become fully or partially exposed to water flow due to soil erosion yang et al 2008 the exposure may result in flow induced fluctuating loading along the pipeline and lead to structure s fatigue failure such hazardous incidents are detrimental from both financial and environmental perspectives while numerous studies have investigated different aspects of viv in free stream there is a lack of detailed information on viv of cylindrical bodies placed near a planar boundary such as a riverbed with the introduction of a planar boundary a new non dimensional parameter is introduced as the gap ratio s s d in which s is the distance between the wall and cylinder s tangent s plays an important role in the cylinder s response as well as wake dynamics a summary of experimental and numerical studies pertaining to flow induced vibrations of a circular cylinder near a wall boundary is presented in table 1 a review of the pertinent literature has revealed the following key dynamical features of the wake and cylindrical body for s 2 3 wall influence on the amplitude and frequency response is negligible as no significant changes in vortex shedding frequency and amplitude are observed grass et al 1984 yang et al 2006 2009 for smaller gap ratios s 2 the vortex shedding frequency increases progressively as the gap ratio decreases grass et al 1984 for s 1 significant asymmetry in the wake is induced and therefore different flow behavior is observed fig 3 qualitatively illustrates how the instantaneous flow behavior is influenced by the existence of a planar boundary the sketch in fig 3 depicts 3 vortices v 1 v 2 and v 3 vortices v 1 and v 2 comprise the traditional von kármán wake vortices while v 3 is a vortex formed from wall boundary layer separation the separation of the wall boundary layer is induced by a coupling synchronization between the shear layer shed from the inner side of the cylinder and the wall boundary layer price et al 2002 in this case decreasing the gap ratio further yields the following a larger reduced velocity at which the maximum vibration amplitude takes place b larger size of lock in region and c smaller maximum vibration amplitude chung 2016 when the gap ratio is smaller than a critical gap ratio s 0 2 0 75 the cylinder impacts the wall chung 2016 found no significant difference in terms of wake topology between oscillation free scenarios and physical impact cases while zhao cheng zhao and cheng 2011 observed a new vortex shedding pattern i e vortex shedding after bounce back as a result of distortion of regular vortex shedding patterns although the amplitude response tends to decline as the gap ratio decreases once a physical impact between the wall and the cylinder takes place both amplitude and frequency response of the system increases manuel et al 2017 in some cases vortex suppression is observed for smaller gap ratios resulting in a drastic decrease in the amplitude of oscillation lei et al 1999 analyzed the lift force coefficient and identified that vortex suppression is linked to the wall s boundary layer thickness resulting in vortex suppression at s 0 2 0 3 the vortex shedding suppression is attributed to viscous wall effects and the separation bubble formed on the wall which impedes the shear layer roll up into a vortex in addition having an opposite sign vorticity the separation bubble annihilates the vorticity in the inner shear layer of the cylinder suppressing vortex formation for small gap ratios grass et al 1984 li et al 1063 martinuzzi et al 2003 li et al li et al 2016 li et al 1063 looked at the flow physics in the wake of a 2 dof system and mentioned that similar to stationary cylinder a separation bubble forming on the wall suppresses the vortex shedding from the inner side of the cylinder and consequently results in oscillation damping in the transverse direction and stream wise frequency lock in and eventually enhanced stream wise oscillations the results of previous experimental and numerical studies has revealed that no consensus has been reached on the critical gap ratio for a 1dof system in which a physical impact between the cylinder and the wall takes place and the gap ratio at which vortex suppression is observed the lack of consensus may be attributed to different driving parameters in these studies such as mass damping ratio and wall s boundary layer thickness to date no study has investigated the fluid structure coupling of an oscillating cylinder near a planar wall boundary for a comprehensive range of u and s so that all oscillation branches are investigated thoroughly for different wall positions with respect to the cylinder in addition in the previous literature vortex shedding patterns are investigated qualitatively and no detailed quantitative study in this regard has been performed in view of these gaps in the literature the present study investigates 1dof viv of an elastically mounted circular cylinder in the vicinity of a wall boundary for a wide range of dimensionless parameters s u m and ζ the goal is to provide a quantitative characterization of the wake including dominant vortex shedding patterns and identify key aspects of the wake development near the critical gap ratio 2 methodology 2 1 data acquisition experiments were carried out in the water tunnel facility at the university of calgary an experimental viv apparatus was designed fabricated and placed in the water tunnel this experimental rig is also employed by riches et al refer to riches and morton 2018 and riches et al 2018 where additional information can be found as can be seen in fig 4 a the apparatus is composed of an acrylic cylinder d 25 4 mm 1 attached to two linear springs k 36 n m as well as two air bushings to facilitate near frictionless 1 dof oscillation in the transverse direction the mass ratio of the system is m 5 3 the natural frequency of the system is f n 1 2 h z in water the damping ratio was estimated to be ζ 0 0013 in air via free decay testing the aspect ratio of the immersed portion of the cylinder is 17 a rigid smooth aluminum plate with the size of 20 d 0 125 d 17 d was mounted vertically to investigate the wall effects on vortex dynamics as well as amplitude response the wall laminar boundary layer had a thickness of δ d 0 05 at the cylinders stream wise location x d 0 a 3 d rendering of the experimental setup including viv apparatus the planar wall high speed camera range finder and laser generator is shown in fig 4b a summary of the parameters pertaining to the experimental setup is shown table 2 the system was validated in a previous experimental study conducted by riches et al 2018 through amplitude and frequency response measurements in the water tunnel facility results are compared with those of other low mass ratio systems as shown in fig 5 riches et al 2018 explains that the amplitude response of the system within the initial and upper branches are in good agreement with wong et al 2017 due to the closeness of the mass ratio in the two studies within the lower branch and desynchronization regions the results do not match with that of wong et al 2017 this is due to the substantially lower structural damping in the present study previous works of klamo et al 2006 riches et al riches and morton 2018 and others have shown that a decrease in structural damping extends the range of synchronization significantly for a given mass ratio the cylinder s sinusoidal oscillations were recorded directly using a laser range finder sensor model cp24mht80 with a resolution of 20 μ m planar particle image velocimetry piv was conducted at cylinder s mid span a phantom lab m340 high speed camera was used to capture particle images in the cylinder s wake a laser sheet was generated by a high energy photonics dm30 nd ylf pulsed laser to illuminate the particles in the wake 10 μ m hollow spherical glass particles were used as flow seeding for piv a lavision high speed controller is used to trigger the laser and the camera simultaneously the laser was operated in double pulse mode such that two laser pulses are fired within a small time frame d t following the recommendations by raffel et al 1989 this time difference is selected so that the particle displacement between two consecutive images is approximately 7 pixels in the free stream the camera recorded the particle images pairs at the frame rate of 12 hz in a rectangular field of view with a 7 d 6 d dimension for a given the camera frame rate and oscillation frequency of the system 10 12 images were acquired per oscillation cycle two data sets each containing 1 462 particle image pairs were collected for each of the test cases 2 2 data processing using fourier analysis the frequency content of the oscillation was computed as follows each amplitude response viv time series data set is divided into smaller segments each 30 s long with 50 overlap a total of 14 segments per data set a fourier transform was performed on each time series segment and the ensemble average of the spectra is presented as the oscillation frequency response the frequency resolution is 0 01 h z lavision davis 8 3 was utilized to process images using an iterative multi grid cross correlation algorithm scarano and riethmuller 1999 in order to obtain the velocity fields from the particle images two passes with interrogation window size of 48 48 pixels followed by three passes with the window size of 24 24 pixels are performed the overlap between the adjacent windows was selected to be 75 yielding a final vector spacing of 0 03d universal outlier detection westerweel and scarano 2005 was used such that a vector with small peak ratio charonko and vlachos 2013 q 1 8 is removed and replaced via interpolation and a 3 3 smoothing the uncertainty of piv measurements was quantified according to correlation statistics method wieneke 2015 and is less than 1 in the free stream and less than 7 in the wake based on instantaneous velocity fields a decomposition of the flow field data was completed using the raw vector fields using triple decomposition hussain 1986 the velocity field in the cylinder s wake at a given location and time can be written as the sum of the average velocity and the velocity of coherent and incoherent structures in the fluctuating field 1 u x t u x u c x t u i c x t proper orthogonal decomposition pod is a popular tool used to distinguish between coherent and incoherent structures in the wake using snapshot method sirovich 1987 an orthonormal basis of the velocity field is obtained such that each space time realization of the fluctuating velocity field u i x t u c x t u i c x t where the subscript i denotes the cartesian tensor component can be expanded as the sum of the products of spatial functions φ i and corresponding temporal coefficients a i tropea et al 2007 2 u i x t i 1 n a i t φ i x sorting the modes according to their contribution to turbulent kinetic energy tke one is able to discern those modes associated with vortex shedding and other coherent phenomena and those corresponding to stochastic fluctuations after reorganizing the modes based on this criterion using only the first few modes extracted from pod analysis one is able to reconstruct a low order model lom liberge and hamdouni 2010 of the flow field which provides a more concise and potentially more informative description of the wake behavior as only the dominant modes contributing to the coherent wake fluctuations are retained while turbulent fluctuations are removed schmid 2010 the final relevant component to the flow analysis is the fluctuating turbulent kinetic energy k 1 2 u 2 v 2 it is the mean kinetic energy associated with eddies in turbulent flows equation 3 represents the total turbulent kinetic energy tke encompassed in the piv domain ω mohebi et al 2017 3 t k e ω k d a ω u 2 v 2 d a it is important to identify a quantitative metric to determine how many modes to include in a pod based low order model in the present study two criteria are used i the contribution of modes to tke should be more than 2 and ii the fluctuating velocity components u and v associated with the modes are correlated if the contribution of a mode to shear reynolds stresses in any region of the wake is less than 2 then the mode is assumed to be mainly linked with incoherent structures and hence is not used in the model the thresholds selected above for the pod series truncation are based on previous experimental studies linking pod modes to coherent and important dynamical features of cylinder wakes e g riches et al 2018 the stream wise and transverse components of the fluctuating velocity field u and v associated with incoherent structures are expected to be uncorrelated delville et al 1999 therefore the shear reynolds stress u v associated with the incoherent modes is very small throughout the wake the residual of the shear reynolds stress between lom s containing the first n and n 1 pod modes is expressed in equation 4 this residual is used in determining an appropriate number of modes to include in a pod based low order representation and was carried out on all data sets 4 u v u v n 1 u v n fig 6 a c illustrate the residuals of shear reynolds stresses u v between the reconstructed wake using n and n 1 number of modes defined in equation 4 at s 8 for u 4 0 initial branch u 5 3 upper branch and u 6 6 lower branch for the initial branch the contribution to shear reynolds stress drops below 2 at n 6 while for the upper as well as the lower branches n 5 therefore using only limited number of modes for these specific cases one can resolve the majority of the contribution to the coherent reynolds stresses while minimizing stochastic contributions 3 results 3 1 cylinder s response fig 7 illustrates the maximum amplitude response of the system a as a function of the flow reduced velocity u for different gap ratios s in the present study s 8 is considered approximately equivalent to an unbounded free stream the results for s 8 are in agreement with previous studies conducted in free stream as shown previously in fig 5 for the case of an open free stream it is relatively straightforward to classify the response of a low mass damping system by its typical three branches and desynchronization region williamson and govardhan 2004 the transition from the initial to the upper branch is marked by an abrupt increase in the amplitude response of the system and accompanied by a change in the frequency response the cylinder oscillation frequency approaches the natural frequency of the system the transition from the upper to the lower branch is identified based on a decrease in the amplitude response of the system and this is linked to a change in the wake vortex shedding mode from 2po to 2p shedding pattern the frequency response in the lower branch exhibits a single dominant peak due to the complete synchronization between the cylinder oscillation and the flow finally the transition from the lower branch to the desynchronization region is associated with a decay in the amplitude response and a change in frequency response the flow development is no longer synchronized to the cylinders motion giving rise to a strouhal vortex shedding signature in the frequency domain of the system response therefore for s 8 the u ranges for the identified response branches are i initial branch 3 u 5 ii upper branch 5 u 7 iii lower branch 7 u 10 5 and iv de synchronization u 9 5 these results are approximately matching s 3 indicating that wall boundary effects do not appreciably affect the system response for approximately s 3 for s 3 the vibrations are damped significantly across all branches in particular for s 1 the same criteria as the free stream case can be used to identify the branches of motion for s 1 the upper branch begins at u 4 8 the lower branch begins at u 5 5 and the de synchronization branch beings at u 10 as indicated via color coding in fig 7 for s 0 5 and s 0 3 the cylinder starts impacting the wall at u 4 2 the impact persists through a wide range of u 4 2 u 7 0 hence a new branch corresponding to 4 2 u 7 0 is identified and named as the impact branch also known as the bounce back branch in previous works e g zang and zhou 2017 chung 2016 in this branch the amplitude response does not change and is equal to the gap ratio a s for 7 u 9 the amplitude response decreases slightly such that no impact with the wall takes place for u 9 the system enters the de synchronization region in which the oscillation amplitude decreases significantly fig 8 presents the dominant frequency response normalized by the natural frequency of the system in water representative spectra power spectral density of the amplitude response are shown in fig 9 for all cases of s 1 in the initial branch 3 u 5 there are two dominant frequencies one corresponding to the strouhal vortex shedding frequency indicated by a dashed line in fig 8 and the other corresponding to the dominant oscillation frequency it is observed that in the free stream case s 8 f increases monotonically with u at u 5 f approaches 1 and the system enters the upper branch 5 u 7 in this branch only one dominant frequency the oscillation frequency is detectable in the amplitude response data in addition the oscillation frequency increases almost linearly with u for s 8 3 1 for about u 7 the oscillation frequency locks in to a constant frequency f l o c k i n 1 15 across all s in agreement with previous literature on viv two dominant frequencies are observed as the system enters desynchronization one frequency associated to the lock in f l o c k i n and the other at the strouhal vortex shedding frequency not shown in fig 8 for its magnitude was near the noise level for s 1 the frequency response follows the same general trend as that observed for s 3 and 8 cf 9a and 9b two dominant frequencies are observed in the initial branch frequency response in all other branches only a single dominant frequency is observed for s 0 5 in the initial branch the oscillation frequency approximately matches with the strouhal frequency of stationary cylinder in free stream unlike s 8 and s 1 only one dominant frequency f 0 95 is identified at u 4 0 when impact between the cylinder and the wall boundary takes place significant changes are observed in the power spectra of the amplitude response where an impact frequency f i m p a c t is the dominant frequency and the secondary peaks appear at its harmonics fig 9c in general the impact frequency is observed to increase linearly with increasing u up to about u 7 2 fig 8 as can be seen in fig 7 an impact between the cylinder and the wall boundary occurs for u 5 3 as well as u 6 5 in the impact branch several peaks in the spectra are detectable with second as well as third harmonics of the impact frequency identifiable in fig 9b at u 9 0 corresponding to the de synchronization region the dominant frequency decreases to f l o c k i n 1 16 3 2 low order reconstruction of vortex shedding planar piv measurements were carried out in order to gain a better understanding of the wake dynamics associated to the cylinder s response the instantaneous velocity fields obtained from piv measurements and their corresponding vorticity fields were analyzed using proper orthogonal decomposition pod as outlined in section 2 2 the goal is to extract the coherent motions from the turbulent field and identify the dominant vortex shedding modes associated to each response regime illustrated in fig 7 the distribution of turbulent kinetic energy tke for the first 10 most energetic modes obtained from pod analysis as well as their cumulative contribution are presented in fig 10 at u 4 0 and 5 3 corresponding to the initial as well as upper branch respectively these modes were analyzed following the procedure outlined in section 2 2 to establish a metric by which dynamically important modes could be selected for low order reconstruction the results of this analysis revealed the following there are 5 dynamically relevant modes in the initial and desynchronization branches as well as 6 dynamically important modes in the upper lower and impact branches the energy level of the first two pod modes is expected to be significantly influenced by the dominant vortex shedding pattern in the wake as well as the coherence of the vortex shedding jeon and gharib 2001 as can be seen in fig 10a at u 4 0 and s 0 5 44 of tke is resolved within the first two modes while for higher s these modes contain approximately 60 of tke this difference is even more apparent for s 0 3 such that the cumulative tke of the first two modes is less than 20 in the initial branch given the low contribution of these modes to tke in the wake and the fact these modes have been confirmed to represent the fundamental mode pair associated with vortex shedding from the cylinder spatial eigenfunctions have been omitted for brevity see riches et al riches et al 2018 for further details at s 8 one can deduce that the vortex shedding is likely significantly altered at s 0 3 and warrants further investigations through low order model lom reconstruction the mode energy distribution in the upper branch or impact branch fig 10b shows a completely different trend with cumulative energy in the first two modes at s 0 3 being higher than all other cases at 57 the results suggest that upon vortex wake and cylinder synchronization the impact branch contains coherent motions of similar relative contribution as the upper and lower branches consistent with the results shown by riches et al 2018 pod analysis in the upper branch or lower branch yields mode pairs with disparate energy content fig 10b fig 11 shows the lom of the wake depicting 2s vortex shedding for s 8 and u 4 0 as shown in fig 11a at t 0 the lower shear layer starts to roll up to form the vortex v 1 as the cylinder is moving in y direction v 2 gains strength from the shear layer on the opposite side of the cylinder at t 0 5 when the cylinder reaches the maximum amplitude in its oscillation in the y direction the growing vortex v 2 cuts off v 1 from its source of vorticity lower shear layer and the separated vortex is advected downstream fig 11b at t 1 v 2 separates from the shear layer as the growing vortex v 3 cuts off the supply of vorticity to v 2 fig 11c the process is periodic with the vortex shedding synchronized to cylinder s transverse location this behavior is in agreement with the description provide by brika brika and laneville 1993 as well as williamson and roshko 1988 and others given their trajectories observed in fig 11 shed vortices tend to advect inward toward the wake centerline fig 12 shows 2p0 vortex shedding for s 8 and u 5 3 which is observed in the upper and lower branches at t 0 the cylinder has reached the maximum amplitude of oscillation in y direction and starts to move in y direction at this instant vortex v 1 is separated from the shear layer on the upper side of the cylinder fig 12a the cylinder moves in y direction and at t 0 25 vortex v 2 is cut off from its source of vorticity fig 12b counter rotating vortices v 1 and v 2 form a vortex pair and are advected together downstream the process is periodic with counter rotating pairs of vortices being shed each half cycle of cylinder oscillation with synchronization between the wake and cylinder motion similar results are observed within the lower branch 2 p type vortex shedding and are omitted for brevity this behavior is in agreement with the description provide by brika brika and laneville 1993 as well as williamson and roshko 1988 the vortex shedding at s 1 and u 4 0 appears to be similar to that for s 8 and u 4 0 fig 13 a shows the roll up of lower vortex v 1 at t 0 when the cylinder reaches the maximum amplitude response in y direction v 1 is cut off from the shear layer and v 2 with opposite orientation starts forming on the other side of the cylinder fig 13b reveals the formation of a vortex on the wall v 3 synchronized with the separation of v 1 from the shear layer at t 1 when the cylinder reaches the maximum amplitude of oscillation in y direction v 2 is separated from the shear layer and is shed from the cylinder hence in each shedding cycle three vortices are introduced into the wake and the dominant shedding pattern can be considered to be 2s s wherein the 2s pertains to traditional von kármán vortex shedding and the s is associated with the roll up of the boundary layer into a single vortex in the wake fig 14 depicts the vortex shedding for s 1 and u 5 3 at t 0 fig 14a while the cylinder reaches its peak amplitude in y direction v 1 is shed from the lower side of the cylinder and induces the separation of the wall s boundary layer vortex v 2 at x d 2 and y d 1 5 separated vortices v 1 and v 2 are convected downstream at t 0 5 fig 14b vortex v 4 is shed from the opposite side of the cylinder as the cylinder reaches the maximum amplitude response in y direction starts to move in the opposite direction note that at t 0 25 and t 0 75 respectively v 3 and v 5 are shed from the cylinder and form a pair with leading vortices v 1 and v 4 however the corresponding figures are not illustrated for the sake of brevity at t 1 fig 14c similar to t 0 v 6 is shed from the lower side of the cylinder leading to the separation of the planar wall s boundary layer in addition with respect to convective streamlines the wall s boundary layer roll ups to a single vortex v 3 and is separated from the wall therefore the dominant vortex shedding pattern is found to be 2 p 0 s vortex shedding in a typical shedding cycle for s 0 5 and u 4 0 corresponding to the initial branch is presented in fig 15 to investigate the effect of boundary layer on vortex shedding in detail at t 0 as the cylinder is moving in y direction vortex v 1 is forming on the outer side of the cylinder fig 15a when the cylinder reaches its maximum amplitude in y direction at t 0 5 v 1 is completely formed and about to be separated from the upper shear layer due to roll up of vortex v 2 on the opposite side of cylinder the small gap between the cylinder and the wall results in the roll up of the planar wall s boundary layer into the vortex v 3 at x d 2 and y d 1 the roll up is synchronized with vortex shedding such that v 3 and v 2 separate simultaneously it appears that v 3 inhibits the full formation of v 2 from the shear layer fig 15c perhaps through annihilation in addition to disturbance to v 2 formation as can be seen in fig 15c v 3 connects to v 1 and supplies it with vorticity at t 1 5 strength of v 2 is decayed such that it is not detectable in the corresponding vorticity field fig 15d therefore in each shedding cycle one of the shed vortices is annihilated via mixing with the counter rotating boundary layer vortex resulting in the s vortex shedding pattern vortex shedding for s 0 5 and u 5 3 corresponding to the impact branch is presented in fig 16 at t 0 as the cylinder passes the wake centerline vortex v 1 is forming from the upper shear layer concurrently forming from the lower shear layer v 2 induces the separation of v 3 from the planar wall at x d 1 at t 0 25 the cylinder impacts the wall and vortices v 2 and v 3 are separated from their shear layers at t 1 counter rotating vortices v 2 and v 3 are not clearly detectable in the near wake suggesting an interaction between them resulting in mixing and annihilation at t 1 5 only v 1 can be detected in the wake as the vortices in the 2p0 pattern are advected outward away from the wake centerline it is unlikely that v 3 interacts with v 2 therefore the suggested a shedding pattern classification is p0 as only the outer pair of shed vortices are detectable in the far wake note that since the oscillation amplitude is limited in this case the formation of the trailing vortex is interrupted by a collision with a wall and hence the trailing vortex is much weaker when compared to higher s based on the above discussion vortex shedding patterns can be categorized with respect to u and s as can be seen in fig 17 for viv of a circular cylinder in free stream high values of s three patterns are observed 2 s 2 p 0 and 2 p bringing the wall closer to the cylinder the interference between the shed vortices from the cylinder and the wall s boundary layer results in the roll up of a boundary layer vortex the onset of this single vortex in the wake results in different patterns which are referred to as 2 s s 2 p 0 s and 2 p s in this study for even lower values of s the interaction of shed vortices and the boundary layer vortex leads to vortex annihilation introducing new vortex shedding patterns s p 0 and p schematics of the aforementioned shedding patterns are presented in fig 18 and supplementary video files provide direct access to low order representations of the vorticity shedding process the critical dependency of the nature of the boundary layer vortex and the corresponding shedding pattern observed in the wall boundary layer indicates that vorticity flux contained in the wall boundary layer as well as distribution of the vorticity are critical parameters in determining the system s response and wake patterns further investigations are needed to investigate the effects of the boundary layer as well as energy exchange between the wall boundary and the cylinder 4 conclusion synchronized amplitude and piv measurements were conducted to characterize 1dof viv of a elastically mounted circular cylinder in the vicinity of a planar wall boundary the results indicate that the existence of the wall results in changes to the response of the system and its synchronization with the wake decreasing s leads to a decrease in the oscillation amplitude at a critical s a physical impact between the cylinder and the wall takes place resulting in a distinct frequency response pod analysis has revealed that a small number of modes between 5 and 6 modes are dynamically important to describe the wake a low order representation of the coherent motions in the wake are captured in order to describe the vortex shedding process together with synchronized motion of the cylinder in total six distinct vortex shedding patterns have been observed for the range of 3 u 12 and 0 3 s 8 the vortex shedding pattern for s 3 resembles that in free stream 2 s and 2 p 0 2 p patterns in the initial and upper lower branches respectively for s 1 shed vortices from the cylinder influence the planar wall s boundary layer such that it rolls up into a single vortex on each cylinder oscillation cycle resulting in different vortex shedding patterns referred to as 2 s s and 2 p s for s 0 5 the interaction between the boundary layer vortex and the counter rotating shed vortex from the cylinder results in vorticity annihilation via mixing as a result of annihilation for each oscillation cycle a single vortex or pair of vortices are observed in the wake which are referred to as s and p vortex shedding patterns credit authorship contribution statement sina daneshvar methodology software formal analysis writing original draft chris morton conceptualization investigation data curation writing review editing supervision funding acquisition project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknolwedge the natural sciences and engineering research council of canada nserc and canada foundation for innovation cfi for the funding of this work nserc application id rgpin 2016 04079 and cfi project 34707 appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 multimedia component 5 multimedia component 5 multimedia component 6 multimedia component 6 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107109 
22015,vortex induced vibration of a circular cylinder near a plane boundary has been investigated experimentally for 2 500 r e d 10 000 3 0 u 12 0 0 3 s 8 and m 5 3 where r e d is the reynolds number based on cylinder diameter u is the reduced velocity s is the gap distance between the planar wall and the cylinder and m is the system s mass ratio the experimental data includes simultaneous amplitude response and wake measurements via time resolved planar particle image velocimetry piv from experimental raw data frequency content of the oscillations as well as wake velocity and vorticity fields are analyzed a new vortex shedding flow regime map is proposed illustrating dominant vortex shedding patterns in the wake across the investigated non dimensional parameter space the quantitative relationship between the cylinder s motion and instantaneous vortex dynamics is shown keywords vortex induced vibrations boundary layer vortex amplitude response low order model particle image velocimetry 1 introduction vortex induced vibrations viv of cylindrical structures is of interest to many engineering applications for example viv influences the dynamic loading on offshore risers transporting oil from the seabed to the surface it is important to the design of such engineering structures as off shore platforms wind turbine masts cable supported bridge decks pipelines at water crossings and tethered structures in the ocean numerous practical applications of viv in engineering problems has led to large number of studies in this field many of which are presented in thorough reviews of williamson govardhan williamson and govardhan 2004 sarpkaya 2004 and bearman 1984 common non dimensional parameters used in the characterization of the response for a single degree of freedom 1dof viv system include the response amplitude a a d where d is the cylinder diameter and a is the oscillation amplitude frequency f f f n where f is the dominant peak from the spectra of the cylinder displacement and f n is the natural frequency of the system reduced velocity u u f n d where u is the free stream velocity mass ratio m 4 m π ρ d 2 l where m is the mass of the system and damping ratio ζ c 2 k m where k is the system stiffness and c is the damping coefficient feng 1968 investigated the amplitude response of a high mass ratio system m 248 by measuring the oscillations of a circular cylinder in a wind tunnel the corresponding results can be found in fig 1 a for low mass ratio systems e g the results from williamson govardhan williamson and govardhan 2004 at m 2 4 significant changes to the response are observed in particular the amplitude response can be divided into four main response regimes including initial branch u 4 5 upper branch 4 5 u 7 5 lower branch 7 5 u 10 and de synchronization region u 10 as illustrated in fig 1 it is noted that the specific u range corresponding to each branch has been shown to depend upon both m and ζ e g see riches and morton 2018 distinct changes in the frequency response of the cylinder occur within each response regime for the initial branch it has been shown that two dominant frequencies define the cylinder s oscillation the strouhal vortex shedding and system s natural frequency fig 1b the transition between the initial and the upper branch occurs as the strouhal frequency reaches the natural frequency of the system in water f o f n w a t e r williamson and govardhan 2004 the oscillation frequency in the upper branch continues to increase with an increase in u up to u 7 fig 1b at u 7 as the oscillation frequency reaches the natural frequency of the system in vacuum f o f n v a c u u m fig 1b and this corresponds to the transition to the lower branch fig 1a in the lower branch the oscillation frequency is locked at a frequency higher than the natural frequency of the system this is attributed to decreasing added mass effect in the lock in range williamson and govardhan 2004 for about u 10 the amplitude response begins to decay into the de synchronization region the cylinder motion is no longer synchronized with the vortex shedding giving rise to a two frequencies defining the cylinder oscillation the strouhal frequency and lock in frequency the amplitude and the frequency response of the system are linked with the vortex dynamics in the wake williamson and govardhan 2004 in the initial branch the dominant vortex shedding pattern is 2 s fig 2 a while the wake topology for the lower branch is 2 p fig 2b as observed by govardhan and williamson 2000 cagney and balabani 2013 the wake in the upper branch is referred to as 2 p 0 mode govardhan and williamson 2000 wherein the secondary vortex in each pair p 2 and p 4 in fig 2b is of a significantly lower strength than the leading vortex p 1 and p 3 in fig 2b in the de synchronization region no clear vortex pattern is synchronized to the cylinder motion khalak and williamson 2006 for the case of vortex induced vibration for a two degree of freedom 2dof cylinder with low mass ratio and damping experiments carried out by jauvtis and williamson 2004 have shown the typical three branch response of a 1dof system williamson and govardhan 2004 is modified such that the characteristic 2s wake mode within the initial branch transitions to a super upper branch this is in contrast with the upper branch classification for a 1dof system in the super upper branch the vibration response reaches its highest amplitude and this is accompanied by a 2t mode of vortex shedding jauvtis and williamson 2004 the 2t mode involves three vortices being shed from the cylinder each half oscillation cycle in contrast with the 2p or 2po shedding patterns observed in 1dof system response and illustrated in fig 2 it is recognized that the present work focuses on 1dof constrained systems such as that employed in the vivace energy converter lee and bernitsas 2011 in many engineering applications viv of a structure takes place in the vicinity of a wall boundary and thus different dynamics in terms of both the vibration response and the wake are expected for conceptual energy harvesting systems which make use of viv lee and bernitsas 2011 the cylinder is placed in the vicinity to a river bed or sea floor within the oil and gas industry pipelines at river crossings may undergo viv the pipelines are buried in the riverbed however with the passage of time they may become fully or partially exposed to water flow due to soil erosion yang et al 2008 the exposure may result in flow induced fluctuating loading along the pipeline and lead to structure s fatigue failure such hazardous incidents are detrimental from both financial and environmental perspectives while numerous studies have investigated different aspects of viv in free stream there is a lack of detailed information on viv of cylindrical bodies placed near a planar boundary such as a riverbed with the introduction of a planar boundary a new non dimensional parameter is introduced as the gap ratio s s d in which s is the distance between the wall and cylinder s tangent s plays an important role in the cylinder s response as well as wake dynamics a summary of experimental and numerical studies pertaining to flow induced vibrations of a circular cylinder near a wall boundary is presented in table 1 a review of the pertinent literature has revealed the following key dynamical features of the wake and cylindrical body for s 2 3 wall influence on the amplitude and frequency response is negligible as no significant changes in vortex shedding frequency and amplitude are observed grass et al 1984 yang et al 2006 2009 for smaller gap ratios s 2 the vortex shedding frequency increases progressively as the gap ratio decreases grass et al 1984 for s 1 significant asymmetry in the wake is induced and therefore different flow behavior is observed fig 3 qualitatively illustrates how the instantaneous flow behavior is influenced by the existence of a planar boundary the sketch in fig 3 depicts 3 vortices v 1 v 2 and v 3 vortices v 1 and v 2 comprise the traditional von kármán wake vortices while v 3 is a vortex formed from wall boundary layer separation the separation of the wall boundary layer is induced by a coupling synchronization between the shear layer shed from the inner side of the cylinder and the wall boundary layer price et al 2002 in this case decreasing the gap ratio further yields the following a larger reduced velocity at which the maximum vibration amplitude takes place b larger size of lock in region and c smaller maximum vibration amplitude chung 2016 when the gap ratio is smaller than a critical gap ratio s 0 2 0 75 the cylinder impacts the wall chung 2016 found no significant difference in terms of wake topology between oscillation free scenarios and physical impact cases while zhao cheng zhao and cheng 2011 observed a new vortex shedding pattern i e vortex shedding after bounce back as a result of distortion of regular vortex shedding patterns although the amplitude response tends to decline as the gap ratio decreases once a physical impact between the wall and the cylinder takes place both amplitude and frequency response of the system increases manuel et al 2017 in some cases vortex suppression is observed for smaller gap ratios resulting in a drastic decrease in the amplitude of oscillation lei et al 1999 analyzed the lift force coefficient and identified that vortex suppression is linked to the wall s boundary layer thickness resulting in vortex suppression at s 0 2 0 3 the vortex shedding suppression is attributed to viscous wall effects and the separation bubble formed on the wall which impedes the shear layer roll up into a vortex in addition having an opposite sign vorticity the separation bubble annihilates the vorticity in the inner shear layer of the cylinder suppressing vortex formation for small gap ratios grass et al 1984 li et al 1063 martinuzzi et al 2003 li et al li et al 2016 li et al 1063 looked at the flow physics in the wake of a 2 dof system and mentioned that similar to stationary cylinder a separation bubble forming on the wall suppresses the vortex shedding from the inner side of the cylinder and consequently results in oscillation damping in the transverse direction and stream wise frequency lock in and eventually enhanced stream wise oscillations the results of previous experimental and numerical studies has revealed that no consensus has been reached on the critical gap ratio for a 1dof system in which a physical impact between the cylinder and the wall takes place and the gap ratio at which vortex suppression is observed the lack of consensus may be attributed to different driving parameters in these studies such as mass damping ratio and wall s boundary layer thickness to date no study has investigated the fluid structure coupling of an oscillating cylinder near a planar wall boundary for a comprehensive range of u and s so that all oscillation branches are investigated thoroughly for different wall positions with respect to the cylinder in addition in the previous literature vortex shedding patterns are investigated qualitatively and no detailed quantitative study in this regard has been performed in view of these gaps in the literature the present study investigates 1dof viv of an elastically mounted circular cylinder in the vicinity of a wall boundary for a wide range of dimensionless parameters s u m and ζ the goal is to provide a quantitative characterization of the wake including dominant vortex shedding patterns and identify key aspects of the wake development near the critical gap ratio 2 methodology 2 1 data acquisition experiments were carried out in the water tunnel facility at the university of calgary an experimental viv apparatus was designed fabricated and placed in the water tunnel this experimental rig is also employed by riches et al refer to riches and morton 2018 and riches et al 2018 where additional information can be found as can be seen in fig 4 a the apparatus is composed of an acrylic cylinder d 25 4 mm 1 attached to two linear springs k 36 n m as well as two air bushings to facilitate near frictionless 1 dof oscillation in the transverse direction the mass ratio of the system is m 5 3 the natural frequency of the system is f n 1 2 h z in water the damping ratio was estimated to be ζ 0 0013 in air via free decay testing the aspect ratio of the immersed portion of the cylinder is 17 a rigid smooth aluminum plate with the size of 20 d 0 125 d 17 d was mounted vertically to investigate the wall effects on vortex dynamics as well as amplitude response the wall laminar boundary layer had a thickness of δ d 0 05 at the cylinders stream wise location x d 0 a 3 d rendering of the experimental setup including viv apparatus the planar wall high speed camera range finder and laser generator is shown in fig 4b a summary of the parameters pertaining to the experimental setup is shown table 2 the system was validated in a previous experimental study conducted by riches et al 2018 through amplitude and frequency response measurements in the water tunnel facility results are compared with those of other low mass ratio systems as shown in fig 5 riches et al 2018 explains that the amplitude response of the system within the initial and upper branches are in good agreement with wong et al 2017 due to the closeness of the mass ratio in the two studies within the lower branch and desynchronization regions the results do not match with that of wong et al 2017 this is due to the substantially lower structural damping in the present study previous works of klamo et al 2006 riches et al riches and morton 2018 and others have shown that a decrease in structural damping extends the range of synchronization significantly for a given mass ratio the cylinder s sinusoidal oscillations were recorded directly using a laser range finder sensor model cp24mht80 with a resolution of 20 μ m planar particle image velocimetry piv was conducted at cylinder s mid span a phantom lab m340 high speed camera was used to capture particle images in the cylinder s wake a laser sheet was generated by a high energy photonics dm30 nd ylf pulsed laser to illuminate the particles in the wake 10 μ m hollow spherical glass particles were used as flow seeding for piv a lavision high speed controller is used to trigger the laser and the camera simultaneously the laser was operated in double pulse mode such that two laser pulses are fired within a small time frame d t following the recommendations by raffel et al 1989 this time difference is selected so that the particle displacement between two consecutive images is approximately 7 pixels in the free stream the camera recorded the particle images pairs at the frame rate of 12 hz in a rectangular field of view with a 7 d 6 d dimension for a given the camera frame rate and oscillation frequency of the system 10 12 images were acquired per oscillation cycle two data sets each containing 1 462 particle image pairs were collected for each of the test cases 2 2 data processing using fourier analysis the frequency content of the oscillation was computed as follows each amplitude response viv time series data set is divided into smaller segments each 30 s long with 50 overlap a total of 14 segments per data set a fourier transform was performed on each time series segment and the ensemble average of the spectra is presented as the oscillation frequency response the frequency resolution is 0 01 h z lavision davis 8 3 was utilized to process images using an iterative multi grid cross correlation algorithm scarano and riethmuller 1999 in order to obtain the velocity fields from the particle images two passes with interrogation window size of 48 48 pixels followed by three passes with the window size of 24 24 pixels are performed the overlap between the adjacent windows was selected to be 75 yielding a final vector spacing of 0 03d universal outlier detection westerweel and scarano 2005 was used such that a vector with small peak ratio charonko and vlachos 2013 q 1 8 is removed and replaced via interpolation and a 3 3 smoothing the uncertainty of piv measurements was quantified according to correlation statistics method wieneke 2015 and is less than 1 in the free stream and less than 7 in the wake based on instantaneous velocity fields a decomposition of the flow field data was completed using the raw vector fields using triple decomposition hussain 1986 the velocity field in the cylinder s wake at a given location and time can be written as the sum of the average velocity and the velocity of coherent and incoherent structures in the fluctuating field 1 u x t u x u c x t u i c x t proper orthogonal decomposition pod is a popular tool used to distinguish between coherent and incoherent structures in the wake using snapshot method sirovich 1987 an orthonormal basis of the velocity field is obtained such that each space time realization of the fluctuating velocity field u i x t u c x t u i c x t where the subscript i denotes the cartesian tensor component can be expanded as the sum of the products of spatial functions φ i and corresponding temporal coefficients a i tropea et al 2007 2 u i x t i 1 n a i t φ i x sorting the modes according to their contribution to turbulent kinetic energy tke one is able to discern those modes associated with vortex shedding and other coherent phenomena and those corresponding to stochastic fluctuations after reorganizing the modes based on this criterion using only the first few modes extracted from pod analysis one is able to reconstruct a low order model lom liberge and hamdouni 2010 of the flow field which provides a more concise and potentially more informative description of the wake behavior as only the dominant modes contributing to the coherent wake fluctuations are retained while turbulent fluctuations are removed schmid 2010 the final relevant component to the flow analysis is the fluctuating turbulent kinetic energy k 1 2 u 2 v 2 it is the mean kinetic energy associated with eddies in turbulent flows equation 3 represents the total turbulent kinetic energy tke encompassed in the piv domain ω mohebi et al 2017 3 t k e ω k d a ω u 2 v 2 d a it is important to identify a quantitative metric to determine how many modes to include in a pod based low order model in the present study two criteria are used i the contribution of modes to tke should be more than 2 and ii the fluctuating velocity components u and v associated with the modes are correlated if the contribution of a mode to shear reynolds stresses in any region of the wake is less than 2 then the mode is assumed to be mainly linked with incoherent structures and hence is not used in the model the thresholds selected above for the pod series truncation are based on previous experimental studies linking pod modes to coherent and important dynamical features of cylinder wakes e g riches et al 2018 the stream wise and transverse components of the fluctuating velocity field u and v associated with incoherent structures are expected to be uncorrelated delville et al 1999 therefore the shear reynolds stress u v associated with the incoherent modes is very small throughout the wake the residual of the shear reynolds stress between lom s containing the first n and n 1 pod modes is expressed in equation 4 this residual is used in determining an appropriate number of modes to include in a pod based low order representation and was carried out on all data sets 4 u v u v n 1 u v n fig 6 a c illustrate the residuals of shear reynolds stresses u v between the reconstructed wake using n and n 1 number of modes defined in equation 4 at s 8 for u 4 0 initial branch u 5 3 upper branch and u 6 6 lower branch for the initial branch the contribution to shear reynolds stress drops below 2 at n 6 while for the upper as well as the lower branches n 5 therefore using only limited number of modes for these specific cases one can resolve the majority of the contribution to the coherent reynolds stresses while minimizing stochastic contributions 3 results 3 1 cylinder s response fig 7 illustrates the maximum amplitude response of the system a as a function of the flow reduced velocity u for different gap ratios s in the present study s 8 is considered approximately equivalent to an unbounded free stream the results for s 8 are in agreement with previous studies conducted in free stream as shown previously in fig 5 for the case of an open free stream it is relatively straightforward to classify the response of a low mass damping system by its typical three branches and desynchronization region williamson and govardhan 2004 the transition from the initial to the upper branch is marked by an abrupt increase in the amplitude response of the system and accompanied by a change in the frequency response the cylinder oscillation frequency approaches the natural frequency of the system the transition from the upper to the lower branch is identified based on a decrease in the amplitude response of the system and this is linked to a change in the wake vortex shedding mode from 2po to 2p shedding pattern the frequency response in the lower branch exhibits a single dominant peak due to the complete synchronization between the cylinder oscillation and the flow finally the transition from the lower branch to the desynchronization region is associated with a decay in the amplitude response and a change in frequency response the flow development is no longer synchronized to the cylinders motion giving rise to a strouhal vortex shedding signature in the frequency domain of the system response therefore for s 8 the u ranges for the identified response branches are i initial branch 3 u 5 ii upper branch 5 u 7 iii lower branch 7 u 10 5 and iv de synchronization u 9 5 these results are approximately matching s 3 indicating that wall boundary effects do not appreciably affect the system response for approximately s 3 for s 3 the vibrations are damped significantly across all branches in particular for s 1 the same criteria as the free stream case can be used to identify the branches of motion for s 1 the upper branch begins at u 4 8 the lower branch begins at u 5 5 and the de synchronization branch beings at u 10 as indicated via color coding in fig 7 for s 0 5 and s 0 3 the cylinder starts impacting the wall at u 4 2 the impact persists through a wide range of u 4 2 u 7 0 hence a new branch corresponding to 4 2 u 7 0 is identified and named as the impact branch also known as the bounce back branch in previous works e g zang and zhou 2017 chung 2016 in this branch the amplitude response does not change and is equal to the gap ratio a s for 7 u 9 the amplitude response decreases slightly such that no impact with the wall takes place for u 9 the system enters the de synchronization region in which the oscillation amplitude decreases significantly fig 8 presents the dominant frequency response normalized by the natural frequency of the system in water representative spectra power spectral density of the amplitude response are shown in fig 9 for all cases of s 1 in the initial branch 3 u 5 there are two dominant frequencies one corresponding to the strouhal vortex shedding frequency indicated by a dashed line in fig 8 and the other corresponding to the dominant oscillation frequency it is observed that in the free stream case s 8 f increases monotonically with u at u 5 f approaches 1 and the system enters the upper branch 5 u 7 in this branch only one dominant frequency the oscillation frequency is detectable in the amplitude response data in addition the oscillation frequency increases almost linearly with u for s 8 3 1 for about u 7 the oscillation frequency locks in to a constant frequency f l o c k i n 1 15 across all s in agreement with previous literature on viv two dominant frequencies are observed as the system enters desynchronization one frequency associated to the lock in f l o c k i n and the other at the strouhal vortex shedding frequency not shown in fig 8 for its magnitude was near the noise level for s 1 the frequency response follows the same general trend as that observed for s 3 and 8 cf 9a and 9b two dominant frequencies are observed in the initial branch frequency response in all other branches only a single dominant frequency is observed for s 0 5 in the initial branch the oscillation frequency approximately matches with the strouhal frequency of stationary cylinder in free stream unlike s 8 and s 1 only one dominant frequency f 0 95 is identified at u 4 0 when impact between the cylinder and the wall boundary takes place significant changes are observed in the power spectra of the amplitude response where an impact frequency f i m p a c t is the dominant frequency and the secondary peaks appear at its harmonics fig 9c in general the impact frequency is observed to increase linearly with increasing u up to about u 7 2 fig 8 as can be seen in fig 7 an impact between the cylinder and the wall boundary occurs for u 5 3 as well as u 6 5 in the impact branch several peaks in the spectra are detectable with second as well as third harmonics of the impact frequency identifiable in fig 9b at u 9 0 corresponding to the de synchronization region the dominant frequency decreases to f l o c k i n 1 16 3 2 low order reconstruction of vortex shedding planar piv measurements were carried out in order to gain a better understanding of the wake dynamics associated to the cylinder s response the instantaneous velocity fields obtained from piv measurements and their corresponding vorticity fields were analyzed using proper orthogonal decomposition pod as outlined in section 2 2 the goal is to extract the coherent motions from the turbulent field and identify the dominant vortex shedding modes associated to each response regime illustrated in fig 7 the distribution of turbulent kinetic energy tke for the first 10 most energetic modes obtained from pod analysis as well as their cumulative contribution are presented in fig 10 at u 4 0 and 5 3 corresponding to the initial as well as upper branch respectively these modes were analyzed following the procedure outlined in section 2 2 to establish a metric by which dynamically important modes could be selected for low order reconstruction the results of this analysis revealed the following there are 5 dynamically relevant modes in the initial and desynchronization branches as well as 6 dynamically important modes in the upper lower and impact branches the energy level of the first two pod modes is expected to be significantly influenced by the dominant vortex shedding pattern in the wake as well as the coherence of the vortex shedding jeon and gharib 2001 as can be seen in fig 10a at u 4 0 and s 0 5 44 of tke is resolved within the first two modes while for higher s these modes contain approximately 60 of tke this difference is even more apparent for s 0 3 such that the cumulative tke of the first two modes is less than 20 in the initial branch given the low contribution of these modes to tke in the wake and the fact these modes have been confirmed to represent the fundamental mode pair associated with vortex shedding from the cylinder spatial eigenfunctions have been omitted for brevity see riches et al riches et al 2018 for further details at s 8 one can deduce that the vortex shedding is likely significantly altered at s 0 3 and warrants further investigations through low order model lom reconstruction the mode energy distribution in the upper branch or impact branch fig 10b shows a completely different trend with cumulative energy in the first two modes at s 0 3 being higher than all other cases at 57 the results suggest that upon vortex wake and cylinder synchronization the impact branch contains coherent motions of similar relative contribution as the upper and lower branches consistent with the results shown by riches et al 2018 pod analysis in the upper branch or lower branch yields mode pairs with disparate energy content fig 10b fig 11 shows the lom of the wake depicting 2s vortex shedding for s 8 and u 4 0 as shown in fig 11a at t 0 the lower shear layer starts to roll up to form the vortex v 1 as the cylinder is moving in y direction v 2 gains strength from the shear layer on the opposite side of the cylinder at t 0 5 when the cylinder reaches the maximum amplitude in its oscillation in the y direction the growing vortex v 2 cuts off v 1 from its source of vorticity lower shear layer and the separated vortex is advected downstream fig 11b at t 1 v 2 separates from the shear layer as the growing vortex v 3 cuts off the supply of vorticity to v 2 fig 11c the process is periodic with the vortex shedding synchronized to cylinder s transverse location this behavior is in agreement with the description provide by brika brika and laneville 1993 as well as williamson and roshko 1988 and others given their trajectories observed in fig 11 shed vortices tend to advect inward toward the wake centerline fig 12 shows 2p0 vortex shedding for s 8 and u 5 3 which is observed in the upper and lower branches at t 0 the cylinder has reached the maximum amplitude of oscillation in y direction and starts to move in y direction at this instant vortex v 1 is separated from the shear layer on the upper side of the cylinder fig 12a the cylinder moves in y direction and at t 0 25 vortex v 2 is cut off from its source of vorticity fig 12b counter rotating vortices v 1 and v 2 form a vortex pair and are advected together downstream the process is periodic with counter rotating pairs of vortices being shed each half cycle of cylinder oscillation with synchronization between the wake and cylinder motion similar results are observed within the lower branch 2 p type vortex shedding and are omitted for brevity this behavior is in agreement with the description provide by brika brika and laneville 1993 as well as williamson and roshko 1988 the vortex shedding at s 1 and u 4 0 appears to be similar to that for s 8 and u 4 0 fig 13 a shows the roll up of lower vortex v 1 at t 0 when the cylinder reaches the maximum amplitude response in y direction v 1 is cut off from the shear layer and v 2 with opposite orientation starts forming on the other side of the cylinder fig 13b reveals the formation of a vortex on the wall v 3 synchronized with the separation of v 1 from the shear layer at t 1 when the cylinder reaches the maximum amplitude of oscillation in y direction v 2 is separated from the shear layer and is shed from the cylinder hence in each shedding cycle three vortices are introduced into the wake and the dominant shedding pattern can be considered to be 2s s wherein the 2s pertains to traditional von kármán vortex shedding and the s is associated with the roll up of the boundary layer into a single vortex in the wake fig 14 depicts the vortex shedding for s 1 and u 5 3 at t 0 fig 14a while the cylinder reaches its peak amplitude in y direction v 1 is shed from the lower side of the cylinder and induces the separation of the wall s boundary layer vortex v 2 at x d 2 and y d 1 5 separated vortices v 1 and v 2 are convected downstream at t 0 5 fig 14b vortex v 4 is shed from the opposite side of the cylinder as the cylinder reaches the maximum amplitude response in y direction starts to move in the opposite direction note that at t 0 25 and t 0 75 respectively v 3 and v 5 are shed from the cylinder and form a pair with leading vortices v 1 and v 4 however the corresponding figures are not illustrated for the sake of brevity at t 1 fig 14c similar to t 0 v 6 is shed from the lower side of the cylinder leading to the separation of the planar wall s boundary layer in addition with respect to convective streamlines the wall s boundary layer roll ups to a single vortex v 3 and is separated from the wall therefore the dominant vortex shedding pattern is found to be 2 p 0 s vortex shedding in a typical shedding cycle for s 0 5 and u 4 0 corresponding to the initial branch is presented in fig 15 to investigate the effect of boundary layer on vortex shedding in detail at t 0 as the cylinder is moving in y direction vortex v 1 is forming on the outer side of the cylinder fig 15a when the cylinder reaches its maximum amplitude in y direction at t 0 5 v 1 is completely formed and about to be separated from the upper shear layer due to roll up of vortex v 2 on the opposite side of cylinder the small gap between the cylinder and the wall results in the roll up of the planar wall s boundary layer into the vortex v 3 at x d 2 and y d 1 the roll up is synchronized with vortex shedding such that v 3 and v 2 separate simultaneously it appears that v 3 inhibits the full formation of v 2 from the shear layer fig 15c perhaps through annihilation in addition to disturbance to v 2 formation as can be seen in fig 15c v 3 connects to v 1 and supplies it with vorticity at t 1 5 strength of v 2 is decayed such that it is not detectable in the corresponding vorticity field fig 15d therefore in each shedding cycle one of the shed vortices is annihilated via mixing with the counter rotating boundary layer vortex resulting in the s vortex shedding pattern vortex shedding for s 0 5 and u 5 3 corresponding to the impact branch is presented in fig 16 at t 0 as the cylinder passes the wake centerline vortex v 1 is forming from the upper shear layer concurrently forming from the lower shear layer v 2 induces the separation of v 3 from the planar wall at x d 1 at t 0 25 the cylinder impacts the wall and vortices v 2 and v 3 are separated from their shear layers at t 1 counter rotating vortices v 2 and v 3 are not clearly detectable in the near wake suggesting an interaction between them resulting in mixing and annihilation at t 1 5 only v 1 can be detected in the wake as the vortices in the 2p0 pattern are advected outward away from the wake centerline it is unlikely that v 3 interacts with v 2 therefore the suggested a shedding pattern classification is p0 as only the outer pair of shed vortices are detectable in the far wake note that since the oscillation amplitude is limited in this case the formation of the trailing vortex is interrupted by a collision with a wall and hence the trailing vortex is much weaker when compared to higher s based on the above discussion vortex shedding patterns can be categorized with respect to u and s as can be seen in fig 17 for viv of a circular cylinder in free stream high values of s three patterns are observed 2 s 2 p 0 and 2 p bringing the wall closer to the cylinder the interference between the shed vortices from the cylinder and the wall s boundary layer results in the roll up of a boundary layer vortex the onset of this single vortex in the wake results in different patterns which are referred to as 2 s s 2 p 0 s and 2 p s in this study for even lower values of s the interaction of shed vortices and the boundary layer vortex leads to vortex annihilation introducing new vortex shedding patterns s p 0 and p schematics of the aforementioned shedding patterns are presented in fig 18 and supplementary video files provide direct access to low order representations of the vorticity shedding process the critical dependency of the nature of the boundary layer vortex and the corresponding shedding pattern observed in the wall boundary layer indicates that vorticity flux contained in the wall boundary layer as well as distribution of the vorticity are critical parameters in determining the system s response and wake patterns further investigations are needed to investigate the effects of the boundary layer as well as energy exchange between the wall boundary and the cylinder 4 conclusion synchronized amplitude and piv measurements were conducted to characterize 1dof viv of a elastically mounted circular cylinder in the vicinity of a planar wall boundary the results indicate that the existence of the wall results in changes to the response of the system and its synchronization with the wake decreasing s leads to a decrease in the oscillation amplitude at a critical s a physical impact between the cylinder and the wall takes place resulting in a distinct frequency response pod analysis has revealed that a small number of modes between 5 and 6 modes are dynamically important to describe the wake a low order representation of the coherent motions in the wake are captured in order to describe the vortex shedding process together with synchronized motion of the cylinder in total six distinct vortex shedding patterns have been observed for the range of 3 u 12 and 0 3 s 8 the vortex shedding pattern for s 3 resembles that in free stream 2 s and 2 p 0 2 p patterns in the initial and upper lower branches respectively for s 1 shed vortices from the cylinder influence the planar wall s boundary layer such that it rolls up into a single vortex on each cylinder oscillation cycle resulting in different vortex shedding patterns referred to as 2 s s and 2 p s for s 0 5 the interaction between the boundary layer vortex and the counter rotating shed vortex from the cylinder results in vorticity annihilation via mixing as a result of annihilation for each oscillation cycle a single vortex or pair of vortices are observed in the wake which are referred to as s and p vortex shedding patterns credit authorship contribution statement sina daneshvar methodology software formal analysis writing original draft chris morton conceptualization investigation data curation writing review editing supervision funding acquisition project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknolwedge the natural sciences and engineering research council of canada nserc and canada foundation for innovation cfi for the funding of this work nserc application id rgpin 2016 04079 and cfi project 34707 appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 multimedia component 5 multimedia component 5 multimedia component 6 multimedia component 6 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107109 
22016,the safety and reliability of ship navigation depend heavily on the performance of the marine machinery system which can be maintained at a high level by condition based maintenance intelligent condition monitoring is the key to achieve condition based maintenance however it is not easy to realize intelligent condition monitoring in a real ship because there are not enough labeled fault samples to train an accurate detection model in fact the potential value of a large number of normal samples collected by the shipboard monitoring system has not been mined out since one class classifiers only need one class samples to train the detection models they are very suitable for such occasions in this paper we investigate the performance of several representative one class classifiers such as ocsvm one class support vector machine svdd support vector data description gknn global k nearest neighbors lof local outlier factor iforest isolation forest and abod angle based outlier detection in condition monitoring of the marine machinery system the dataset of a marine gas turbine propulsion system is used for a case study which is a simulation dataset verified by the real ship data compared with previous literatures our new work is to investigate the performance of a variety of key one class classifiers not only considering the common evaluation indexes for machine learning but also considering the sample combinations of the training dataset distribution of misclassified samples and the tolerance to contaminated data the experimental results show that these algorithms have good performance in the dataset in some common evaluation indexes however they show some obvious performance differences in some novel evaluation indexes we proposed this can provide decision support for the application of one class classifiers in the condition monitoring of many other marine machinery systems keywords one class classifier condition monitoring marine machinery condition based maintenance nomenclature prp propeller hll hull gtc gas turbine compressor gt gas turbine ocsvm one class support vector machine svdd support vector data description gknn global k nearest neighbors lof local outlier factor iforest isolation forest abod angle based outlier detection itree isolation tree abof angle based outlier factor tp true positive tn true negative fp false positive fn true negative auc area under curve 1 introduction the safety and reliability of the marine machinery system are essential for the normal operation of ships and it can be beneficial from good maintenance bayer et al 2018 cheliotis and lazakis 2018 lazakis et al 2018b however the complexity of the marine machinery system makes its maintenance extremely difficult krystosik gromadzinska 2018 in particular each subsystem in the marine machinery system is related to each other and a small fault may lead to disastrous consequences therefore the faults must be prevented in the early stages before causing more serious chain disasters kowalski et al 2017 for a long time these disasters are prevented by reactive maintenance and time based maintenance lazakis et al 2018a raptodimos and lazakis 2019 reactive maintenance is the oldest and most common maintenance strategy and it can also be called fix it until it breaks cullum et al 2018 kothamasu and huang 2007 it will probably cause chain disasters and unacceptable losses to the ship owners once a part of the ship system breaks down unless the faulty component is completely independent and inexpensive tan et al 2019 therefore this maintenance strategy is only applicable to non critical and cheap components for ships on the voyage reactive maintenance is usually carried out by the marine engineers on board due to the limitation of spare parts maintenance tools maintenance site and the professional level of marine engineers such maintenance quality can only meet the emergency needs but cannot guarantee the long term operation of the ships in addition it also puts forward high requirements for the number of spare parts and the experience of marine engineers so it is not an economic and safety guaranteed maintenance strategy another current maintenance strategy in the ship industry is time based maintenance cullum et al 2018 for example ships need to be docked for inspection every few years most faults and risks are prevented at this stage tan et al 2019 this maintenance strategy requires a suitable time interval but the best time interval is uncertain in most cases usually the time interval is based on a large number of previous experiences for similar ships without a clear scientific stipulation now it has been enforced by solas international convention for safety of life at sea and classification societies lazakis et al 2016 regardless of the actual state of the ships however each ship and its running profiles are different so the best time interval is probably different for different ships furthermore different machines on the same ship have different running profiles and it is impossible to determine a consistent maintenance cycle for all the machines as a result many equipment and components are maintained or replaced with a long residual life therefore the most critical problem of this maintenance strategy is the potential for over maintenance which will lead to an increase in unnecessary expenses although the above two maintenance strategies can probably prevent the machinery system from further damage by repairing or replacing some components they are either under maintenance or over maintenance emovon et al 2015 therefore neither of them is an ideal maintenance strategy recent literatures have shown that condition based maintenance is an advanced maintenance strategy in many industrial fields and it is also the same in the maritime field lazakis et al 2018a lazakis and ölçer 2015 the idea of condition based maintenance is to analyze the historical data collected by the shipboard monitoring system through some intelligent analysis tools to assess the status of the machinery system so as to guide planned maintenance jardine et al 2006 lazakis et al 2018b it enables the maintenance work to be carried out according to the actual state of the machines kandemir and celik 2019 making the maintenance work more scientific more planned and more cost effective liu and frangopol 2019 therefore it will be a promising strategy for ship maintenance in the future cullum et al 2018 condition monitoring of the marine machinery system is vital to realize its condition based maintenance raptodimos and lazakis 2018 with the development of smart ship technology the data collected by shipboard monitoring system will be more and more abundant garcia et al 2019 and it will provide a favorable condition for data driven intelligent monitoring machine learning is a common method to realize data driven models it can be classified into supervised learning semi supervised learning and unsupervised learning the one class classification algorithms investigated in this paper are belonging to semi supervised learning algorithms due to the huge advantages of machine learning in many other fields data driven condition monitoring methods based on machine learning will become an important aspect of the development of smart ships 1 1 related literatures although machine learning has been widely used in many other fields it is still a new research in the field of maritime affairs to monitor the state of machinery and realize condition based maintenance in the past few years researchers have made some significant progress especially in the application of supervised learning algorithms porteiro et al 2011 presented a multi net fault diagnosis system to provide power estimation and fault identification of a diesel engine wei and wang 2011 proposed an evolutionary neural networks model to predict the content of metal elements contained in the lubricating oil of a marine diesel engine coraddu et al 2014 proposed an application of supervised machine learning approaches to estimate the decay status of a naval propulsion plant for improving condition based maintenance basurko and uriondo 2015 trained a three layer feed forward neural network with the monitored data of a marine medium speed diesel engine to generate a performance model for condition based maintenance lazakis and ölçer 2015 used an existing fuzzy multiple attributive group decision making technique enhanced with the use of analytical hierarchy process to select the best maintenance approach for shipboard equipment tahan et al 2017 presented a systematic review of the recently developed techniques of the gas turbine performance monitoring diagnosis and prognostication cipollini et al 2018a b proposed some supervised and unsupervised approaches for condition based maintenance of a naval gas propulsion plant lazakis et al 2018a investigated a one class support vector machine based approach to realize condition monitoring of a marine diesel generator with the noon report data then lazakis et al 2018b used the artificial neural networks to predict the upcoming exhaust gas temperatures of the main engine cylinders of a panamax size container ship raptodimos and lazakis 2018 realized condition monitoring of the main engine cylinder of a panamax container ship by using the artificial neural network self organising map zhou et al 2018 established an observer based residual generator and multiple evaluation functions were employed as the classification features of the support vector machine for fault detection of the ship propulsion system brandsæter et al 2019 developed an on line anomaly detection approach based on multivariate signal reconstruction followed by residuals analysis for anomaly detection of a marine diesel engine in operation cheliotis et al 2019 developed a method that employs a hybrid knnk nn and micemice imputation algorithm to improve the quality of performance monitoring of the main engine system of an oceangoing vessel coraddu et al 2019a investigated the one class support vector machine and global k nearest neighbor for diagnosing the hull and propeller fouling then coraddu et al 2019b developed a data driven digital twin of a ship leveraging on the data collected from the on board sensors to estimate the speed loss due to marine fouling tan et al 2019 proposed a one class svm based approach to estimate the decay degree and main decay direction of a marine propulsion plant with limited labeled samples 1 2 aim of this paper condition monitoring of the marine machinery system requires to develop an accurate detection model although many supervised learning algorithms have been proposed for condition monitoring of the marine machinery system they tend to be unrealistic because the fact that most of the samples monitored by the shipboard monitoring system are normal samples is ignored and the required labeled samples are not easy to obtain intuitively unsupervised learning is the ideal learning method for outlier detection but unsupervised learning method can achieve good results in very limited occasions because it requires that the abnormal samples should have significantly different characteristics from normal samples in density distance or distribution in practice such occasions are not very common it is certain that there are differences in density distance or distribution between abnormal samples and normal samples in most cases but these differences may not be obvious enough that unsupervised learning algorithms can correctly distinguish them a new alternative method is to use one class classification technology which does not need to train a model based on multi class labeled samples it only needs one class samples to train the model one class classification algorithms can distinguish the difference that is not very obvious between the abnormal and normal samples for anomaly detection its advantage is that it can accurately determine a classification threshold according to the training dataset rather than extract it from the characteristics of all samples like unsupervised learning method therefore as long as enough normal samples can be obtained the classification threshold determined by one class classification algorithms will be accurate enough to detect the abnormal samples since most of the data collected by the shipboard monitoring system is normal data the one class classification algorithms are particularly suitable for such an occasion in practice the training dataset is likely to have some defects such as insufficient training samples incomplete sample combinations and contaminated data in our work we simulate these defects in the experiment by reconstructing the training dataset to further test the performance of the algorithms in some novel perspectives which have not been considered in previous literatures for the same dataset we will compare six representative one class classification algorithms including ocsvm svdd gknn lof iforest and abod based on the preliminary exploration of ocsvm and gknn by cipollini et al 2018b the rest of the paper is organized as follows section 2 elaborates on the proposed methodology concerning the framework of one class classifiers algorithms we compared and a case study section 3 presents the results obtained from the case study section 4 presents the discussion referring to the results the conclusion is drawn in section 5 2 methodology 2 1 proposed method in this paper we choose to use one class classification algorithms to train the anomaly detection model because the detection model is trained by one class samples the selection of training samples has an important impact on the performance of the model in practice due to the influence of sampling frequency sampling scale sampling condition data contamination and other factors normal datasets may also be diverse therefore it is not rigorous for us to test only one kind of training dataset in our work we will consider the influence of the number of training samples the combinations of training samples and the proportion of contaminated samples on the performance of the algorithms all the situations considered can be regarded as simulations of the real conditions as shown in fig 1 the methodology elaborated in this section consists of the following steps a repartition of the training dataset and testing dataset b data preprocessing c model training including k fold cross validation and hyper parameter optimization d model evaluation considering the five aspects to identify the algorithm that shows the best performance 2 2 framework of one class classifiers 2 2 1 one class classifiers different from the common multi class classification methods the one class classification methods only need one class data points to train the detection model when a new data point is input the model does not need to determine which class the data point belongs to but needs to determine whether the data point belongs to the training class similar to the supervised methods one class classification methods can distinguish negative data points according to their distance density distribution or angle usually the one class methods can be categorized into boundary based method density based method and reconstruction method swersky et al 2016 2 2 2 from supervised classifiers to one class classifiers in theory almost any supervised classification algorithm can be re designed to be a one class classifier aggarwal 2017 the one class classification algorithm is actually treated as a binary classification problem in the algorithm design the negative class is represented by a hypothetical negative data point for example in ocsvm the coordinate origin is treated as the only negative data point to train the model therefore as long as suitable hypothetical negative data point can be determined and the appropriate technique can be used to classify the negative data point and the one class training data points a one class classifier can be constructed 2 2 3 from unsupervised classifiers to one class classifiers it has been proved that unsupervised classifiers can be adapted to one class classifiers swersky et al 2016 the steps of transforming unsupervised algorithms into one class classification algorithms can be summarized as follows 1 pre compute the abnormal scores of each training sample by running the unsupervised algorithm on the training dataset 2 compute the abnormal score of a testing sample relative to the training samples 3 compare the abnormal score of the testing sample with the pre computed scores of the training samples during this process two aspects require special attention firstly the testing samples should not affect the trained model which is the basic principle of one class classification secondly the testing samples should be classified one by one in order to eliminate the influence between each testing sample compared with unsupervised learning methods one class classification methods can usually get more stable performance therefore we should give priority to one class classification methods on the occasion that we can get enough one class samples 2 3 algorithms compared 2 3 1 one class support vector machine ocsvm ocsvm is an extension of the classical svm and it is a common semi supervised learning technology used to solve one class classification problem khan and madden 2009 the core idea of svm is to map the data points that are not easy to classify in the original space to a higher dimensional space through the mapping function making them easy to classify schölkopf and smola 2001 in the classical svm it can determine an optimal hyper plane by maximizing the interval between the support vectors of two classes however in ocsvm there are only one class data points involved in model training which makes it impossible to find the optimal hyper plane like the classical svm in fact it regards the origin as the only negative data point and all training data as positive points the goal of model training is to make the classification hyper plane as far away from the origin as possible consequently the optimal hyper plane will wrap the training samples very closely in the original space for normal dataset x x 1 x n t r n d to obtain classification hyper plane f x ω t φ x ρ 0 the following optimization problem needs to be solved schölkopf et al 2000 1 m i n w ξ i ρ 1 2 ω 2 1 v n i 1 n ξ i ρ s t ω t φ x i ρ ξ i ξ i 0 i where n is the number of input samples v 0 1 is the upper bound of classification error rate and lower bound of the number of all support vectors wu and srihari 2003 ξ i is the slack variable corresponding to x i i 0 n ω is the normal vector of the hyper plane and ρ is the offset φ x is a mapping function which can map the data from the original space to the feature space the kernel function can be defined as 2 k x i x j φ x i φ x j where x i and x j can be any two points of the input vector x i i 0 n there are many kinds of kernel functions and rbf kernel function k x i x j exp γ x i x j 2 can usually achieve better performance so it is generally used as the first choice hsu et al 2003 by introducing lagrange multiplier method the problem described in formula 1 can be solved and the decision function can be defined as 3 f x sgn i 1 n α i k x i x ρ where α i can be obtained by solving a dual problem as follows 4 m i n α i 1 2 i 1 n j 1 n α i α j k x i x j s t 0 α i 1 v n i 1 n α i 1 ρ can be obtained from any sample that satisfies the requirement that 0 α j 1 v n and that sample is a support vector 5 ρ j 1 n α j k x i x j in the process of model training the hyper parameters need to be tuned during the process of model training are v and γ in libssvm the default value of v is 0 5 and the default value of γ is 1 d d is the dimension of the dataset 2 3 2 support vector data description svdd svdd tax and duin 2004 is a one class classification method similar to ocsvm its basic idea is to map samples from a low dimensional space to a high dimensional feature space by using a kernel function and establish a tightest hyper sphere with enough training samples in this process it is necessary to balance the radius of the hyper sphere and the number of samples wrapped by the hyper sphere whether a new sample is normal or abnormal is determined by comparing the sample s distance to the center of the hyper sphere with the hyper sphere s radius let x x i i 1 n be the training dataset in r d space the final optimization problem can be transformed into 6 max α i l d i 1 n α i k x i x j i j 1 n α i α j k x i x j s t 0 α i c i 1 n α i 1 k k t r 2 ξ i φ x i a 2 α i 0 a n d ξ i β i 0 where a and r represent the center and radius of the hyper sphere respectively ξ i is the slack variable corresponding to x i i 0 n c is the error penalty coefficient which is used to balance the misclassification error and the sphere volume k x i x j is the kernel function and k x i x j φ x i φ x j α i and β i are the lagrange multipliers the square of any sample s distance to the center of the hyper sphere can be defined as 7 d 2 x k x x 2 i 1 n α i k x i x i j 1 n α i α j k x i x j then the final classification function can be defined as 8 f x sgn r 2 d 2 x the hyper parameters that need to be tuned during the process of model training are c and γ γ is the parameter in the rbf kernel function in libsvm the default value for c is 1 and the default value for γ is 1 d d is the dimension of the dataset 2 3 3 global k nearest neighbors gknn gknn is usually used as an unsupervised method its abnormal score is defined as follows ramaswamy et al 2000 9 gknn x i k d x i n n k x i where n n k x i is the k t h nearest neighbor of data point x i d is used to calculate the distance of two data points for gknn the higher the abnormal score the higher the probability of the sample tends to be abnormal when it is used as a one class classification algorithm it is necessary to firstly find the maximum abnormal score according to the training dataset as the classification threshold then calculate the abnormal scores of the testing samples relative to the training samples one by one finally by comparing the abnormal score and abnormal threshold we can determine whether the testing sample is abnormal or not the hyper parameter needs to be tuned during the process of model training is k 2 3 4 local outlier factor lof lof is a density based unsupervised anomaly detection algorithm breunig et al 2000 it compares the density of each data point and its neighbors to determine whether the data point is an outlier the distance between data points is represented by the reachability distance which is defined as 10 r e a c h d i s t a n c e k x i x j m a x d x j n n k x j d x i x j where n n k x j is the k t h nearest neighbor of data point x j d is used to calculate the distance of two data points the local reachability density is defined as 11 l r d k x i 1 x j k n n x i r e a c h d i s t a n c e k x i x j k n n x i where k n n x i is the neighbors of point x i within its k t h nearest distance the local outlier factor is defined as 12 l o f k x i x j k n n x i l r d k x j l r d k x i k n n x i if l o f k x i 1 it indicates that the local density of data point x i is similar to its neighbors if l o f k x i 1 it indicates that data point x i is in a dense area and it is unlikely to be an outlier if l o f k x i 1 it indicates that data point x i is likely to be an outlier the hyper parameter needs to be tuned during the process of model training is k 2 3 5 isolation forest iforest iforest is an unsupervised ensemble learning method inspired by random forest liu et al 2008 its basic idea is to construct a series of random binary itrees for each dimension of the data each node of these itrees either has two children or belongs to the leaf node the itrees are used to measure the path length of testing samples samples with longer path length than the average path lengths are usually considered to be abnormal samples the average path length can be defined as 13 c n 2 h n 1 2 n 1 n where n is the number of samples c n is the average path length h i ln i e u l e r c o n s t a n t is the harmonic number the abnormal score of sample x can be defined as 14 s x n 2 e h x c n where e h x is the expected path length of sample x in a batch of itrees a testing sample can be estimated to be normal or abnormal according to 15 s x n 0 5 u n c e r t a i n 1 a b n o r m a l 0 n o r m a l the hyper parameter needs to be tuned during the process of model training is the number of itrees n estimators 2 3 6 angle based outlier detection abod abod can determine whether a new data point is normal or abnormal by measuring the variance in the angles between the data point and pairs of other data points kriegel et al 2008 high variance indicates that the sample is likely to be normal while low variance indicates that the sample is likely to be abnormal the angle based outlier factor abof can be defined as 16 abof x i v a r i a n c e x j x k d t r a i n x i x j x i x k x i x j 2 x i x k 2 where represents the scalar product represents the euler distance there is no hyper parameter needs to be tuned during the process of model training in abod 2 4 case study for the convenience of description we introduced some definitions as follows comprehensive performance including accuracy precision recall specificity auc and f1 score contaminated dataset a mixed dataset containing normal and abnormal samples contamination ratio proportion of abnormal samples in a contaminated dataset sample combinations the combinations of different values of sensor measurements since the running profiles of the machinery are usually not diverse enough in practice these combinations may not be sufficient enough to train a data driven model with good generalization performance 2 4 1 dataset description the dataset we used in this paper is from a real data validated numerical simulator developed for a frigate characterized by a combined diesel electric and gas propulsion plant it has been used in several machine learning applications for condition monitoring of the marine machinery system carrega et al 2019 cipollini et al 2018a b in this dataset the authors considered the decay process of four main components of the propulsion system including gas turbine gt gas turbine compressor gtc hull hll and propeller prp as shown in table 1 all attributes of the dataset are listed including the sensor measurements and decay coefficients the performance of the above four components can be estimated by the measured values of these sensors among the 30 attributes the first 25 are sensor measurements and the last 5 are decay coefficients since attribute 26 kk t and attribute 27 kk q are linearly related either of them can represent the decay state of the propeller and we choose to use kk t in our work in addition the dataset contains various samples at different ship speeds cipollini et al 2018b has proved that the ship speed has no significant impact on the detection results and the cruise speed of the vessel is approximately 15 knots in practice so we choose the data when the ship speed is 15 knots for experiments in this way the total number of experimental samples is 50570 the dataset can be labeled according to the decay coefficients each time we will only consider the decay of one component according to cipollini et al 2018b the weak decay can be treated as non decay and the decay thresholds determined by the decay coefficients are defined as shown in table 2 the normal dataset original training dataset and decayed dataset original testing dataset are separated from the original dataset 50570 according to these decay thresholds the training dataset used in the experiments is randomly sampled from the original training dataset and the testing dataset is the combination of the original testing dataset and the remaining samples in the original training dataset 2 4 2 error measurement in our work we investigate several state of the art one class classification algorithms for anomaly detection of marine machinery system and their performance will be compared the evaluation indexes we used are as follows sokolova and lapalme 2009 precision t p t p f p the percentage of true positive samples in predicted positive samples recall t p t p f n the percentage of true positive samples in real positive samples specificity t n f p t n the percentage of true negative samples in real negative samples accuracy t p t n t p f n f p t n the percentage of correctly classified samples in all samples auc area under roc curve the ability of the approach to avoid misclassification f 1 score 2 p r e c i s i o n r e c a l l p r e c i s i o n r e c a l l the relation between recall and precision where tp is the number of true positive samples tn is the number of true negative samples fp is the number of false positive samples and fn is the number of false negative samples the value range of precision recall specificity accuracy auc and f 1 score is 0 1 and the larger the values the better the performance of the classifier 2 4 3 data preprocessing the dataset contains some linearly related attributes which are useless for training an accurate detection model it is beneficial for machine learning to remove the redundant attributes to reduce the dimension of the dataset according to carrega et al 2019 the attributes that need to be considered can be reduced to those shown in table 3 another work of data preprocessing is to normalize samples to a certain range according to the attributes to avoid the influence of different dimensional data on data analysis generally the normalization limits are between 0 and 1 the normalization function we used is the mapminmax function built in matlab 2018 however because iforest can deal with data without normalization we did not normalize the data for iforest 2 4 4 hyper parameter optimization the hyper parameters have a significant impact on the performance of the detection models generally there are three methods to optimize the hyper parameters 1 hold out method this method directly divides the dataset into two mutually exclusive subsets one as the training set and another as the validation set in this method the division of the dataset is a challenging problem which can easily lead to the instability of evaluation results in addition there are always some samples that cannot participate in the training of the model resulting in the waste of data therefore this method is not very commonly used 2 k fold cross validation method this method is one of the most popular methods to optimize hyper parameters in machine learning firstly it divides the prepared training dataset into k subsets with almost the same size secondly a new dataset composed of k 1 subsets is used as the new training dataset and the remaining subset is used as a validation set to evaluate the performance of the classifier then repeat this step until each subset has been used as the validation set for one time thirdly calculate the average classification accuracy of the k models as the comprehensive performance index compared with hold out method all samples are used as training samples and validation samples respectively which improves the rate of data utilization the disadvantage of this method is that it is usually time consuming 3 bootstrap method the bootstrap method is based on bootstrap sampling it can make use of the existing samples to a large extent and it is suitable for the situation where the dataset is small and it is difficult to effectively divide the training set and the validation set however this method is likely to change the distribution of the original dataset resulting in estimation bias therefore this method is generally not used when the original dataset is sufficient in our work it is unnecessary to use the bootstrap method because we have enough data in addition we expect to make full use of the original dataset so hold out method is also not a good choice for us therefore we choose a time consuming but reliable method k fold cross validation method based on the above analysis the process of searching the best hyper parameters can be completed automatically by some searching algorithms since the intelligent searching algorithms such as particle swarm optimization method and genetic algorithm are easy to fall into the local optimal solution we choose to use the grid search optimization method although the computation of grid search optimization method is large it can usually find the global optimal solution for each one class classification algorithm we use 10 folds cross validation combined with grid search method to optimize the hyper parameters the set of hyper parameters tested during model evaluation is shown as follows 1 ocsvm v γ 2 10 2 9 9 2 1 0 2 10 2 9 9 2 3 2 svdd c γ 2 4 2 3 9 2 0 2 14 2 13 9 2 4 3 gknn k 1 3 7 11 15 21 27 51 4 lof k 1 3 7 11 15 21 27 51 5 iforest n estimators 10 50 100 6 abod none 2 4 5 model evaluation 2 4 5 1 impact of the size of training dataset the number of samples in the training dataset has a significant influence on the performance of the detection model to test this influence we will use a random sampling method to reconstruct a series of new training datasets to train the model the sampling scale is 10 50 100 500 and 1000 respectively each group of samples with the constant number mentioned above will be sampled 100 times from the normal dataset to eliminate the interference of accidental factors all the training samples are normal and the rest samples are used as the testing samples we take the average result of 100 experiments as the final result in the next experiments we will fix the size of the training dataset at 500 2 4 5 2 impact of sample combinations in training dataset on the premise of a fixed number of training samples the sample combinations may also affect the performance of the algorithms therefore we will also record the fluctuation of model performance in 100 experiments with a fixed number of training samples in this comparison we will show the performance stability of the algorithms under the condition that the number of training samples is fixed but the sample combinations are changed the sample combinations can be changed by resampling the original training dataset 2 4 5 3 distribution of misclassified samples in the field of machine learning no algorithm is perfect and there will always be some misclassified samples the distribution of misclassified samples can also reflect the performance of the algorithms in this case we will take the decay coefficients as the index of the sample distribution we will mainly consider the concentration and balance of misclassified samples and we will record all the misclassified samples in the 100 experiments 2 4 5 4 comprehensive performance previous literature bezerra et al 2019 has shown that accuracy precision recall specificity auc and f1 score can intuitively reflect the common comprehensive performance of the algorithms therefore we will record the average values of these indexes in 100 experiments to compare the comprehensive performance of the algorithms 2 4 5 5 tolerance to contaminated data considering that it is difficult to obtain pure normal training datasets in practice due to data contamination the algorithms are expected to have a certain tolerance to the contaminated data we will test the tolerance of the algorithms to the contaminated data with an artificially manufactured contaminated dataset this contaminated dataset is constructed by randomly taking some abnormal samples from the abnormal dataset and adding them into the normal training dataset to replace some randomly selected normal samples in this process the size of the training dataset remains unchanged we take the contamination ratio as the changing index in each experiment the contamination ratio we considered ranges from 0 to 0 5 we will experiment 100 times at each contamination ratio and the final result is the average value in 100 experiments all the experiments are carried out in matlab 2018 running on a pc with intel core i7 processor and 16 gb ram the toolboxes of the algorithms we used are as follows libsvm chang and lin 2011 ocsvm and svdd https www csie ntu edu tw cjlin libsvmtools anomaly detection toolbox lof iforest and abod http dsmi lab ntust github io anomalydetectiontoolbox 3 results in this section we present the results of experiments described in section 2 4 5 based on the dataset described in section 2 4 1 the detection accuracy of the models varying with the size of the training dataset is presented in table 4 in fig 2 we present the fluctuation of the detection accuracy with different combinations of training samples in 100 experiments in fig 3 we present the distribution of decay coefficients of misclassified samples which contains all the misclassified samples in 100 experiments in table 5 we present the comprehensive performance of the algorithms considering accuracy precision recall specificity auc and f1 score in 100 experiments in fig 4 we present the algorithms tolerance to contaminated data at each contamination ratio 4 discussion in this section we present a discussion of the results described in section 3 overall we find that the detection accuracy of the models increases with the number of training samples table 4 abod shows the best performance when the size of training dataset is big enough 500 1000 however ocsvm svdd and iforest show better performance when the size of the training dataset is small 50 100 which indicates that they are suitable for occasions of small datasets there is no significant performance difference between the algorithms when the size of the training dataset is only 10 lof shows the worst performance no matter the size of the training dataset is big or small in practice the number of normal samples is generally big enough so abod should be the first choice in anomaly detection of marine machinery system when the size of the training dataset reaches 500 the detection accuracy of the algorithms has been high enough therefore in the remaining experiments we fixed the size of the training dataset at 500 from fig 2 we find that the classification accuracy corresponding to the six algorithms fluctuates with the changing of sample combinations but the fluctuation range is different in this aspect abod shows the best stable performance and ocsvm and svdd show a similar bad performance as two of the most popular one class classification algorithms ocsvm and svdd are not as good as expected this is because the random combinations of the training samples may lead to an obvious change of the support vectors if the new training dataset does not contain all the original support vectors it will reduce the area covered by the decision hyper plane consequently it will lead to a great reduction of the final classification accuracy in practice it is almost impossible to obtain a dataset containing all decay combinations of the four components therefore ocsvm and svdd are likely to achieve good results only in some unrealistic datasets but it is not necessarily in the actual datasets from fig 3 we find that most misclassified samples are concentrated near the thresholds this is a symptom of good performance for the algorithms and it shows that most misclassified samples are approaching to decay or slightly decayed if the decay is obvious enough the algorithms are likely to detect it correctly however if we further analyze the distribution of the misclassified samples we can find that the performance of different algorithms on different datasets is quite different the more concentrated and symmetrical the distribution is on the decay thresholds the better the performance of the algorithm is the more concentrated the distribution the smaller the ranges of misclassification and the more symmetrical the distribution the smaller the bias of classification boundary taking the boxplot of prp as an example gknn shows the best balanced classification performance for both normal samples and abnormal samples ocsvm and svdd tend to classify some weakly decayed samples into normal samples which indicates that the decision boundary is a little biased towards abnormal samples lof and iforest tend to classify some normal samples into abnormal samples abod shows more misclassification in abnormal samples than normal samples from the distribution of misclassified samples the performance of the algorithms is not only affected by the characteristics of the algorithms themselves but also by the dataset therefore in practical application we need to adopt different algorithms for different dataset we can comprehensively evaluate the performance of the algorithms according to table 5 overall a single algorithm shows similar characteristics in the anomaly detection of the four components which indicates that the dataset has little impact on the comprehensive performance of the algorithms the comprehensive performance of the six algorithms can be sorted as abod ocsvm svdd gknn iforest lof from the above analysis abod is the best choice when the training dataset is a pure normal dataset in the above experiments we use the pure normal training dataset to train the detection model but in practice this kind of training dataset is not easy to obtain and it is likely to be contaminated by some abnormal samples or noise therefore we hope that the algorithms can tolerate the contaminated training dataset to some extent from fig 4 we find that the algorithms performance declines with the increase of the contamination ratio however iforest and lof show strong tolerance to contaminated data although the comprehensive performance of iforest and lof is not very good compared with the other four algorithms it is still a good alternative when the training dataset contains a lot of contaminated data however the tolerance of iforest and lof to contaminated data shows different characteristics when the contamination ratio is low iforest shows stronger tolerance when the contamination ratio is high lof shows stronger tolerance therefore in practical application it should be noted that iforest is suitable for lightly contaminated data and lof is suitable for severely contaminated data 5 conclusion in this paper we investigate the performance of many one class classifiers in anomaly detection of the marine machinery system the classifiers are experimented with a dataset produced by a real data validated simulator of a frigate characterized by a combined diesel electric and gas propulsion plant compared with previous literatures the algorithms we investigated are more various and more comprehensive evaluation indexes are considered by us the main findings of our investigation are as follows the classification accuracy of one class classifiers increases with the number of training samples and about 500 training samples can train a good detection model abod is more suitable for big datasets however ocsvm svdd and iforest are more suitable for small datasets the boundary based algorithms ocsvm and svdd show unstable performance when the sample combinations of training datasets are changed in practice the performance of boundary based algorithms is probably not as good as expected because the training dataset in practice is probably not ideal as the original dataset used in this paper which considered all combinations of decay combinations in the analysis of misclassified samples we find that most misclassified samples are concentrated near the decay thresholds this implies that they can be classified correctly by the experimented algorithms with the deepening of the decay from the distribution of misclassified samples different algorithms show different performances in different datasets and no algorithm is the winner in the analysis of comprehensive performance the six algorithms can be sorted as abod ocsvm svdd gknn iforest lof therefore abod is probably the best choice when the training dataset is a pure normal dataset in terms of the tolerance to contaminated data iforest and lof show their outstanding advantage this greatly reduces the requirement for the purity of training dataset in practice it can be a good alternative when the pure normal dataset is difficult to obtain in conclusion we compare the performance of many representative one class classification algorithms in anomaly detection of marine machinery system although different algorithms show similar results in accuracy they show different characteristics in some other evaluation indexes which can be used as decision support for the application of one class classification algorithms in anomaly detection of marine machinery systems credit authorship contribution statement yanghui tan conceptualization methodology formal analysis writing review editing hui tian software formal analysis visualization writing original draft ruizheng jiang investigation data curation validation yejin lin supervision validation jundong zhang supervision resources project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement our research is financed by the fund of research on intelligent ship testing and verification 2018 473 the authors are responsible for the contents of this publication in addition the work presented in this paper is the continuation of altosole et al 2014 cipollini et al 2018a b coraddu et al 2014 lazakis et al 2018a so we would like to express our sincere gratitude to all the previous authors for their creative work and sharing of the dataset 
22016,the safety and reliability of ship navigation depend heavily on the performance of the marine machinery system which can be maintained at a high level by condition based maintenance intelligent condition monitoring is the key to achieve condition based maintenance however it is not easy to realize intelligent condition monitoring in a real ship because there are not enough labeled fault samples to train an accurate detection model in fact the potential value of a large number of normal samples collected by the shipboard monitoring system has not been mined out since one class classifiers only need one class samples to train the detection models they are very suitable for such occasions in this paper we investigate the performance of several representative one class classifiers such as ocsvm one class support vector machine svdd support vector data description gknn global k nearest neighbors lof local outlier factor iforest isolation forest and abod angle based outlier detection in condition monitoring of the marine machinery system the dataset of a marine gas turbine propulsion system is used for a case study which is a simulation dataset verified by the real ship data compared with previous literatures our new work is to investigate the performance of a variety of key one class classifiers not only considering the common evaluation indexes for machine learning but also considering the sample combinations of the training dataset distribution of misclassified samples and the tolerance to contaminated data the experimental results show that these algorithms have good performance in the dataset in some common evaluation indexes however they show some obvious performance differences in some novel evaluation indexes we proposed this can provide decision support for the application of one class classifiers in the condition monitoring of many other marine machinery systems keywords one class classifier condition monitoring marine machinery condition based maintenance nomenclature prp propeller hll hull gtc gas turbine compressor gt gas turbine ocsvm one class support vector machine svdd support vector data description gknn global k nearest neighbors lof local outlier factor iforest isolation forest abod angle based outlier detection itree isolation tree abof angle based outlier factor tp true positive tn true negative fp false positive fn true negative auc area under curve 1 introduction the safety and reliability of the marine machinery system are essential for the normal operation of ships and it can be beneficial from good maintenance bayer et al 2018 cheliotis and lazakis 2018 lazakis et al 2018b however the complexity of the marine machinery system makes its maintenance extremely difficult krystosik gromadzinska 2018 in particular each subsystem in the marine machinery system is related to each other and a small fault may lead to disastrous consequences therefore the faults must be prevented in the early stages before causing more serious chain disasters kowalski et al 2017 for a long time these disasters are prevented by reactive maintenance and time based maintenance lazakis et al 2018a raptodimos and lazakis 2019 reactive maintenance is the oldest and most common maintenance strategy and it can also be called fix it until it breaks cullum et al 2018 kothamasu and huang 2007 it will probably cause chain disasters and unacceptable losses to the ship owners once a part of the ship system breaks down unless the faulty component is completely independent and inexpensive tan et al 2019 therefore this maintenance strategy is only applicable to non critical and cheap components for ships on the voyage reactive maintenance is usually carried out by the marine engineers on board due to the limitation of spare parts maintenance tools maintenance site and the professional level of marine engineers such maintenance quality can only meet the emergency needs but cannot guarantee the long term operation of the ships in addition it also puts forward high requirements for the number of spare parts and the experience of marine engineers so it is not an economic and safety guaranteed maintenance strategy another current maintenance strategy in the ship industry is time based maintenance cullum et al 2018 for example ships need to be docked for inspection every few years most faults and risks are prevented at this stage tan et al 2019 this maintenance strategy requires a suitable time interval but the best time interval is uncertain in most cases usually the time interval is based on a large number of previous experiences for similar ships without a clear scientific stipulation now it has been enforced by solas international convention for safety of life at sea and classification societies lazakis et al 2016 regardless of the actual state of the ships however each ship and its running profiles are different so the best time interval is probably different for different ships furthermore different machines on the same ship have different running profiles and it is impossible to determine a consistent maintenance cycle for all the machines as a result many equipment and components are maintained or replaced with a long residual life therefore the most critical problem of this maintenance strategy is the potential for over maintenance which will lead to an increase in unnecessary expenses although the above two maintenance strategies can probably prevent the machinery system from further damage by repairing or replacing some components they are either under maintenance or over maintenance emovon et al 2015 therefore neither of them is an ideal maintenance strategy recent literatures have shown that condition based maintenance is an advanced maintenance strategy in many industrial fields and it is also the same in the maritime field lazakis et al 2018a lazakis and ölçer 2015 the idea of condition based maintenance is to analyze the historical data collected by the shipboard monitoring system through some intelligent analysis tools to assess the status of the machinery system so as to guide planned maintenance jardine et al 2006 lazakis et al 2018b it enables the maintenance work to be carried out according to the actual state of the machines kandemir and celik 2019 making the maintenance work more scientific more planned and more cost effective liu and frangopol 2019 therefore it will be a promising strategy for ship maintenance in the future cullum et al 2018 condition monitoring of the marine machinery system is vital to realize its condition based maintenance raptodimos and lazakis 2018 with the development of smart ship technology the data collected by shipboard monitoring system will be more and more abundant garcia et al 2019 and it will provide a favorable condition for data driven intelligent monitoring machine learning is a common method to realize data driven models it can be classified into supervised learning semi supervised learning and unsupervised learning the one class classification algorithms investigated in this paper are belonging to semi supervised learning algorithms due to the huge advantages of machine learning in many other fields data driven condition monitoring methods based on machine learning will become an important aspect of the development of smart ships 1 1 related literatures although machine learning has been widely used in many other fields it is still a new research in the field of maritime affairs to monitor the state of machinery and realize condition based maintenance in the past few years researchers have made some significant progress especially in the application of supervised learning algorithms porteiro et al 2011 presented a multi net fault diagnosis system to provide power estimation and fault identification of a diesel engine wei and wang 2011 proposed an evolutionary neural networks model to predict the content of metal elements contained in the lubricating oil of a marine diesel engine coraddu et al 2014 proposed an application of supervised machine learning approaches to estimate the decay status of a naval propulsion plant for improving condition based maintenance basurko and uriondo 2015 trained a three layer feed forward neural network with the monitored data of a marine medium speed diesel engine to generate a performance model for condition based maintenance lazakis and ölçer 2015 used an existing fuzzy multiple attributive group decision making technique enhanced with the use of analytical hierarchy process to select the best maintenance approach for shipboard equipment tahan et al 2017 presented a systematic review of the recently developed techniques of the gas turbine performance monitoring diagnosis and prognostication cipollini et al 2018a b proposed some supervised and unsupervised approaches for condition based maintenance of a naval gas propulsion plant lazakis et al 2018a investigated a one class support vector machine based approach to realize condition monitoring of a marine diesel generator with the noon report data then lazakis et al 2018b used the artificial neural networks to predict the upcoming exhaust gas temperatures of the main engine cylinders of a panamax size container ship raptodimos and lazakis 2018 realized condition monitoring of the main engine cylinder of a panamax container ship by using the artificial neural network self organising map zhou et al 2018 established an observer based residual generator and multiple evaluation functions were employed as the classification features of the support vector machine for fault detection of the ship propulsion system brandsæter et al 2019 developed an on line anomaly detection approach based on multivariate signal reconstruction followed by residuals analysis for anomaly detection of a marine diesel engine in operation cheliotis et al 2019 developed a method that employs a hybrid knnk nn and micemice imputation algorithm to improve the quality of performance monitoring of the main engine system of an oceangoing vessel coraddu et al 2019a investigated the one class support vector machine and global k nearest neighbor for diagnosing the hull and propeller fouling then coraddu et al 2019b developed a data driven digital twin of a ship leveraging on the data collected from the on board sensors to estimate the speed loss due to marine fouling tan et al 2019 proposed a one class svm based approach to estimate the decay degree and main decay direction of a marine propulsion plant with limited labeled samples 1 2 aim of this paper condition monitoring of the marine machinery system requires to develop an accurate detection model although many supervised learning algorithms have been proposed for condition monitoring of the marine machinery system they tend to be unrealistic because the fact that most of the samples monitored by the shipboard monitoring system are normal samples is ignored and the required labeled samples are not easy to obtain intuitively unsupervised learning is the ideal learning method for outlier detection but unsupervised learning method can achieve good results in very limited occasions because it requires that the abnormal samples should have significantly different characteristics from normal samples in density distance or distribution in practice such occasions are not very common it is certain that there are differences in density distance or distribution between abnormal samples and normal samples in most cases but these differences may not be obvious enough that unsupervised learning algorithms can correctly distinguish them a new alternative method is to use one class classification technology which does not need to train a model based on multi class labeled samples it only needs one class samples to train the model one class classification algorithms can distinguish the difference that is not very obvious between the abnormal and normal samples for anomaly detection its advantage is that it can accurately determine a classification threshold according to the training dataset rather than extract it from the characteristics of all samples like unsupervised learning method therefore as long as enough normal samples can be obtained the classification threshold determined by one class classification algorithms will be accurate enough to detect the abnormal samples since most of the data collected by the shipboard monitoring system is normal data the one class classification algorithms are particularly suitable for such an occasion in practice the training dataset is likely to have some defects such as insufficient training samples incomplete sample combinations and contaminated data in our work we simulate these defects in the experiment by reconstructing the training dataset to further test the performance of the algorithms in some novel perspectives which have not been considered in previous literatures for the same dataset we will compare six representative one class classification algorithms including ocsvm svdd gknn lof iforest and abod based on the preliminary exploration of ocsvm and gknn by cipollini et al 2018b the rest of the paper is organized as follows section 2 elaborates on the proposed methodology concerning the framework of one class classifiers algorithms we compared and a case study section 3 presents the results obtained from the case study section 4 presents the discussion referring to the results the conclusion is drawn in section 5 2 methodology 2 1 proposed method in this paper we choose to use one class classification algorithms to train the anomaly detection model because the detection model is trained by one class samples the selection of training samples has an important impact on the performance of the model in practice due to the influence of sampling frequency sampling scale sampling condition data contamination and other factors normal datasets may also be diverse therefore it is not rigorous for us to test only one kind of training dataset in our work we will consider the influence of the number of training samples the combinations of training samples and the proportion of contaminated samples on the performance of the algorithms all the situations considered can be regarded as simulations of the real conditions as shown in fig 1 the methodology elaborated in this section consists of the following steps a repartition of the training dataset and testing dataset b data preprocessing c model training including k fold cross validation and hyper parameter optimization d model evaluation considering the five aspects to identify the algorithm that shows the best performance 2 2 framework of one class classifiers 2 2 1 one class classifiers different from the common multi class classification methods the one class classification methods only need one class data points to train the detection model when a new data point is input the model does not need to determine which class the data point belongs to but needs to determine whether the data point belongs to the training class similar to the supervised methods one class classification methods can distinguish negative data points according to their distance density distribution or angle usually the one class methods can be categorized into boundary based method density based method and reconstruction method swersky et al 2016 2 2 2 from supervised classifiers to one class classifiers in theory almost any supervised classification algorithm can be re designed to be a one class classifier aggarwal 2017 the one class classification algorithm is actually treated as a binary classification problem in the algorithm design the negative class is represented by a hypothetical negative data point for example in ocsvm the coordinate origin is treated as the only negative data point to train the model therefore as long as suitable hypothetical negative data point can be determined and the appropriate technique can be used to classify the negative data point and the one class training data points a one class classifier can be constructed 2 2 3 from unsupervised classifiers to one class classifiers it has been proved that unsupervised classifiers can be adapted to one class classifiers swersky et al 2016 the steps of transforming unsupervised algorithms into one class classification algorithms can be summarized as follows 1 pre compute the abnormal scores of each training sample by running the unsupervised algorithm on the training dataset 2 compute the abnormal score of a testing sample relative to the training samples 3 compare the abnormal score of the testing sample with the pre computed scores of the training samples during this process two aspects require special attention firstly the testing samples should not affect the trained model which is the basic principle of one class classification secondly the testing samples should be classified one by one in order to eliminate the influence between each testing sample compared with unsupervised learning methods one class classification methods can usually get more stable performance therefore we should give priority to one class classification methods on the occasion that we can get enough one class samples 2 3 algorithms compared 2 3 1 one class support vector machine ocsvm ocsvm is an extension of the classical svm and it is a common semi supervised learning technology used to solve one class classification problem khan and madden 2009 the core idea of svm is to map the data points that are not easy to classify in the original space to a higher dimensional space through the mapping function making them easy to classify schölkopf and smola 2001 in the classical svm it can determine an optimal hyper plane by maximizing the interval between the support vectors of two classes however in ocsvm there are only one class data points involved in model training which makes it impossible to find the optimal hyper plane like the classical svm in fact it regards the origin as the only negative data point and all training data as positive points the goal of model training is to make the classification hyper plane as far away from the origin as possible consequently the optimal hyper plane will wrap the training samples very closely in the original space for normal dataset x x 1 x n t r n d to obtain classification hyper plane f x ω t φ x ρ 0 the following optimization problem needs to be solved schölkopf et al 2000 1 m i n w ξ i ρ 1 2 ω 2 1 v n i 1 n ξ i ρ s t ω t φ x i ρ ξ i ξ i 0 i where n is the number of input samples v 0 1 is the upper bound of classification error rate and lower bound of the number of all support vectors wu and srihari 2003 ξ i is the slack variable corresponding to x i i 0 n ω is the normal vector of the hyper plane and ρ is the offset φ x is a mapping function which can map the data from the original space to the feature space the kernel function can be defined as 2 k x i x j φ x i φ x j where x i and x j can be any two points of the input vector x i i 0 n there are many kinds of kernel functions and rbf kernel function k x i x j exp γ x i x j 2 can usually achieve better performance so it is generally used as the first choice hsu et al 2003 by introducing lagrange multiplier method the problem described in formula 1 can be solved and the decision function can be defined as 3 f x sgn i 1 n α i k x i x ρ where α i can be obtained by solving a dual problem as follows 4 m i n α i 1 2 i 1 n j 1 n α i α j k x i x j s t 0 α i 1 v n i 1 n α i 1 ρ can be obtained from any sample that satisfies the requirement that 0 α j 1 v n and that sample is a support vector 5 ρ j 1 n α j k x i x j in the process of model training the hyper parameters need to be tuned during the process of model training are v and γ in libssvm the default value of v is 0 5 and the default value of γ is 1 d d is the dimension of the dataset 2 3 2 support vector data description svdd svdd tax and duin 2004 is a one class classification method similar to ocsvm its basic idea is to map samples from a low dimensional space to a high dimensional feature space by using a kernel function and establish a tightest hyper sphere with enough training samples in this process it is necessary to balance the radius of the hyper sphere and the number of samples wrapped by the hyper sphere whether a new sample is normal or abnormal is determined by comparing the sample s distance to the center of the hyper sphere with the hyper sphere s radius let x x i i 1 n be the training dataset in r d space the final optimization problem can be transformed into 6 max α i l d i 1 n α i k x i x j i j 1 n α i α j k x i x j s t 0 α i c i 1 n α i 1 k k t r 2 ξ i φ x i a 2 α i 0 a n d ξ i β i 0 where a and r represent the center and radius of the hyper sphere respectively ξ i is the slack variable corresponding to x i i 0 n c is the error penalty coefficient which is used to balance the misclassification error and the sphere volume k x i x j is the kernel function and k x i x j φ x i φ x j α i and β i are the lagrange multipliers the square of any sample s distance to the center of the hyper sphere can be defined as 7 d 2 x k x x 2 i 1 n α i k x i x i j 1 n α i α j k x i x j then the final classification function can be defined as 8 f x sgn r 2 d 2 x the hyper parameters that need to be tuned during the process of model training are c and γ γ is the parameter in the rbf kernel function in libsvm the default value for c is 1 and the default value for γ is 1 d d is the dimension of the dataset 2 3 3 global k nearest neighbors gknn gknn is usually used as an unsupervised method its abnormal score is defined as follows ramaswamy et al 2000 9 gknn x i k d x i n n k x i where n n k x i is the k t h nearest neighbor of data point x i d is used to calculate the distance of two data points for gknn the higher the abnormal score the higher the probability of the sample tends to be abnormal when it is used as a one class classification algorithm it is necessary to firstly find the maximum abnormal score according to the training dataset as the classification threshold then calculate the abnormal scores of the testing samples relative to the training samples one by one finally by comparing the abnormal score and abnormal threshold we can determine whether the testing sample is abnormal or not the hyper parameter needs to be tuned during the process of model training is k 2 3 4 local outlier factor lof lof is a density based unsupervised anomaly detection algorithm breunig et al 2000 it compares the density of each data point and its neighbors to determine whether the data point is an outlier the distance between data points is represented by the reachability distance which is defined as 10 r e a c h d i s t a n c e k x i x j m a x d x j n n k x j d x i x j where n n k x j is the k t h nearest neighbor of data point x j d is used to calculate the distance of two data points the local reachability density is defined as 11 l r d k x i 1 x j k n n x i r e a c h d i s t a n c e k x i x j k n n x i where k n n x i is the neighbors of point x i within its k t h nearest distance the local outlier factor is defined as 12 l o f k x i x j k n n x i l r d k x j l r d k x i k n n x i if l o f k x i 1 it indicates that the local density of data point x i is similar to its neighbors if l o f k x i 1 it indicates that data point x i is in a dense area and it is unlikely to be an outlier if l o f k x i 1 it indicates that data point x i is likely to be an outlier the hyper parameter needs to be tuned during the process of model training is k 2 3 5 isolation forest iforest iforest is an unsupervised ensemble learning method inspired by random forest liu et al 2008 its basic idea is to construct a series of random binary itrees for each dimension of the data each node of these itrees either has two children or belongs to the leaf node the itrees are used to measure the path length of testing samples samples with longer path length than the average path lengths are usually considered to be abnormal samples the average path length can be defined as 13 c n 2 h n 1 2 n 1 n where n is the number of samples c n is the average path length h i ln i e u l e r c o n s t a n t is the harmonic number the abnormal score of sample x can be defined as 14 s x n 2 e h x c n where e h x is the expected path length of sample x in a batch of itrees a testing sample can be estimated to be normal or abnormal according to 15 s x n 0 5 u n c e r t a i n 1 a b n o r m a l 0 n o r m a l the hyper parameter needs to be tuned during the process of model training is the number of itrees n estimators 2 3 6 angle based outlier detection abod abod can determine whether a new data point is normal or abnormal by measuring the variance in the angles between the data point and pairs of other data points kriegel et al 2008 high variance indicates that the sample is likely to be normal while low variance indicates that the sample is likely to be abnormal the angle based outlier factor abof can be defined as 16 abof x i v a r i a n c e x j x k d t r a i n x i x j x i x k x i x j 2 x i x k 2 where represents the scalar product represents the euler distance there is no hyper parameter needs to be tuned during the process of model training in abod 2 4 case study for the convenience of description we introduced some definitions as follows comprehensive performance including accuracy precision recall specificity auc and f1 score contaminated dataset a mixed dataset containing normal and abnormal samples contamination ratio proportion of abnormal samples in a contaminated dataset sample combinations the combinations of different values of sensor measurements since the running profiles of the machinery are usually not diverse enough in practice these combinations may not be sufficient enough to train a data driven model with good generalization performance 2 4 1 dataset description the dataset we used in this paper is from a real data validated numerical simulator developed for a frigate characterized by a combined diesel electric and gas propulsion plant it has been used in several machine learning applications for condition monitoring of the marine machinery system carrega et al 2019 cipollini et al 2018a b in this dataset the authors considered the decay process of four main components of the propulsion system including gas turbine gt gas turbine compressor gtc hull hll and propeller prp as shown in table 1 all attributes of the dataset are listed including the sensor measurements and decay coefficients the performance of the above four components can be estimated by the measured values of these sensors among the 30 attributes the first 25 are sensor measurements and the last 5 are decay coefficients since attribute 26 kk t and attribute 27 kk q are linearly related either of them can represent the decay state of the propeller and we choose to use kk t in our work in addition the dataset contains various samples at different ship speeds cipollini et al 2018b has proved that the ship speed has no significant impact on the detection results and the cruise speed of the vessel is approximately 15 knots in practice so we choose the data when the ship speed is 15 knots for experiments in this way the total number of experimental samples is 50570 the dataset can be labeled according to the decay coefficients each time we will only consider the decay of one component according to cipollini et al 2018b the weak decay can be treated as non decay and the decay thresholds determined by the decay coefficients are defined as shown in table 2 the normal dataset original training dataset and decayed dataset original testing dataset are separated from the original dataset 50570 according to these decay thresholds the training dataset used in the experiments is randomly sampled from the original training dataset and the testing dataset is the combination of the original testing dataset and the remaining samples in the original training dataset 2 4 2 error measurement in our work we investigate several state of the art one class classification algorithms for anomaly detection of marine machinery system and their performance will be compared the evaluation indexes we used are as follows sokolova and lapalme 2009 precision t p t p f p the percentage of true positive samples in predicted positive samples recall t p t p f n the percentage of true positive samples in real positive samples specificity t n f p t n the percentage of true negative samples in real negative samples accuracy t p t n t p f n f p t n the percentage of correctly classified samples in all samples auc area under roc curve the ability of the approach to avoid misclassification f 1 score 2 p r e c i s i o n r e c a l l p r e c i s i o n r e c a l l the relation between recall and precision where tp is the number of true positive samples tn is the number of true negative samples fp is the number of false positive samples and fn is the number of false negative samples the value range of precision recall specificity accuracy auc and f 1 score is 0 1 and the larger the values the better the performance of the classifier 2 4 3 data preprocessing the dataset contains some linearly related attributes which are useless for training an accurate detection model it is beneficial for machine learning to remove the redundant attributes to reduce the dimension of the dataset according to carrega et al 2019 the attributes that need to be considered can be reduced to those shown in table 3 another work of data preprocessing is to normalize samples to a certain range according to the attributes to avoid the influence of different dimensional data on data analysis generally the normalization limits are between 0 and 1 the normalization function we used is the mapminmax function built in matlab 2018 however because iforest can deal with data without normalization we did not normalize the data for iforest 2 4 4 hyper parameter optimization the hyper parameters have a significant impact on the performance of the detection models generally there are three methods to optimize the hyper parameters 1 hold out method this method directly divides the dataset into two mutually exclusive subsets one as the training set and another as the validation set in this method the division of the dataset is a challenging problem which can easily lead to the instability of evaluation results in addition there are always some samples that cannot participate in the training of the model resulting in the waste of data therefore this method is not very commonly used 2 k fold cross validation method this method is one of the most popular methods to optimize hyper parameters in machine learning firstly it divides the prepared training dataset into k subsets with almost the same size secondly a new dataset composed of k 1 subsets is used as the new training dataset and the remaining subset is used as a validation set to evaluate the performance of the classifier then repeat this step until each subset has been used as the validation set for one time thirdly calculate the average classification accuracy of the k models as the comprehensive performance index compared with hold out method all samples are used as training samples and validation samples respectively which improves the rate of data utilization the disadvantage of this method is that it is usually time consuming 3 bootstrap method the bootstrap method is based on bootstrap sampling it can make use of the existing samples to a large extent and it is suitable for the situation where the dataset is small and it is difficult to effectively divide the training set and the validation set however this method is likely to change the distribution of the original dataset resulting in estimation bias therefore this method is generally not used when the original dataset is sufficient in our work it is unnecessary to use the bootstrap method because we have enough data in addition we expect to make full use of the original dataset so hold out method is also not a good choice for us therefore we choose a time consuming but reliable method k fold cross validation method based on the above analysis the process of searching the best hyper parameters can be completed automatically by some searching algorithms since the intelligent searching algorithms such as particle swarm optimization method and genetic algorithm are easy to fall into the local optimal solution we choose to use the grid search optimization method although the computation of grid search optimization method is large it can usually find the global optimal solution for each one class classification algorithm we use 10 folds cross validation combined with grid search method to optimize the hyper parameters the set of hyper parameters tested during model evaluation is shown as follows 1 ocsvm v γ 2 10 2 9 9 2 1 0 2 10 2 9 9 2 3 2 svdd c γ 2 4 2 3 9 2 0 2 14 2 13 9 2 4 3 gknn k 1 3 7 11 15 21 27 51 4 lof k 1 3 7 11 15 21 27 51 5 iforest n estimators 10 50 100 6 abod none 2 4 5 model evaluation 2 4 5 1 impact of the size of training dataset the number of samples in the training dataset has a significant influence on the performance of the detection model to test this influence we will use a random sampling method to reconstruct a series of new training datasets to train the model the sampling scale is 10 50 100 500 and 1000 respectively each group of samples with the constant number mentioned above will be sampled 100 times from the normal dataset to eliminate the interference of accidental factors all the training samples are normal and the rest samples are used as the testing samples we take the average result of 100 experiments as the final result in the next experiments we will fix the size of the training dataset at 500 2 4 5 2 impact of sample combinations in training dataset on the premise of a fixed number of training samples the sample combinations may also affect the performance of the algorithms therefore we will also record the fluctuation of model performance in 100 experiments with a fixed number of training samples in this comparison we will show the performance stability of the algorithms under the condition that the number of training samples is fixed but the sample combinations are changed the sample combinations can be changed by resampling the original training dataset 2 4 5 3 distribution of misclassified samples in the field of machine learning no algorithm is perfect and there will always be some misclassified samples the distribution of misclassified samples can also reflect the performance of the algorithms in this case we will take the decay coefficients as the index of the sample distribution we will mainly consider the concentration and balance of misclassified samples and we will record all the misclassified samples in the 100 experiments 2 4 5 4 comprehensive performance previous literature bezerra et al 2019 has shown that accuracy precision recall specificity auc and f1 score can intuitively reflect the common comprehensive performance of the algorithms therefore we will record the average values of these indexes in 100 experiments to compare the comprehensive performance of the algorithms 2 4 5 5 tolerance to contaminated data considering that it is difficult to obtain pure normal training datasets in practice due to data contamination the algorithms are expected to have a certain tolerance to the contaminated data we will test the tolerance of the algorithms to the contaminated data with an artificially manufactured contaminated dataset this contaminated dataset is constructed by randomly taking some abnormal samples from the abnormal dataset and adding them into the normal training dataset to replace some randomly selected normal samples in this process the size of the training dataset remains unchanged we take the contamination ratio as the changing index in each experiment the contamination ratio we considered ranges from 0 to 0 5 we will experiment 100 times at each contamination ratio and the final result is the average value in 100 experiments all the experiments are carried out in matlab 2018 running on a pc with intel core i7 processor and 16 gb ram the toolboxes of the algorithms we used are as follows libsvm chang and lin 2011 ocsvm and svdd https www csie ntu edu tw cjlin libsvmtools anomaly detection toolbox lof iforest and abod http dsmi lab ntust github io anomalydetectiontoolbox 3 results in this section we present the results of experiments described in section 2 4 5 based on the dataset described in section 2 4 1 the detection accuracy of the models varying with the size of the training dataset is presented in table 4 in fig 2 we present the fluctuation of the detection accuracy with different combinations of training samples in 100 experiments in fig 3 we present the distribution of decay coefficients of misclassified samples which contains all the misclassified samples in 100 experiments in table 5 we present the comprehensive performance of the algorithms considering accuracy precision recall specificity auc and f1 score in 100 experiments in fig 4 we present the algorithms tolerance to contaminated data at each contamination ratio 4 discussion in this section we present a discussion of the results described in section 3 overall we find that the detection accuracy of the models increases with the number of training samples table 4 abod shows the best performance when the size of training dataset is big enough 500 1000 however ocsvm svdd and iforest show better performance when the size of the training dataset is small 50 100 which indicates that they are suitable for occasions of small datasets there is no significant performance difference between the algorithms when the size of the training dataset is only 10 lof shows the worst performance no matter the size of the training dataset is big or small in practice the number of normal samples is generally big enough so abod should be the first choice in anomaly detection of marine machinery system when the size of the training dataset reaches 500 the detection accuracy of the algorithms has been high enough therefore in the remaining experiments we fixed the size of the training dataset at 500 from fig 2 we find that the classification accuracy corresponding to the six algorithms fluctuates with the changing of sample combinations but the fluctuation range is different in this aspect abod shows the best stable performance and ocsvm and svdd show a similar bad performance as two of the most popular one class classification algorithms ocsvm and svdd are not as good as expected this is because the random combinations of the training samples may lead to an obvious change of the support vectors if the new training dataset does not contain all the original support vectors it will reduce the area covered by the decision hyper plane consequently it will lead to a great reduction of the final classification accuracy in practice it is almost impossible to obtain a dataset containing all decay combinations of the four components therefore ocsvm and svdd are likely to achieve good results only in some unrealistic datasets but it is not necessarily in the actual datasets from fig 3 we find that most misclassified samples are concentrated near the thresholds this is a symptom of good performance for the algorithms and it shows that most misclassified samples are approaching to decay or slightly decayed if the decay is obvious enough the algorithms are likely to detect it correctly however if we further analyze the distribution of the misclassified samples we can find that the performance of different algorithms on different datasets is quite different the more concentrated and symmetrical the distribution is on the decay thresholds the better the performance of the algorithm is the more concentrated the distribution the smaller the ranges of misclassification and the more symmetrical the distribution the smaller the bias of classification boundary taking the boxplot of prp as an example gknn shows the best balanced classification performance for both normal samples and abnormal samples ocsvm and svdd tend to classify some weakly decayed samples into normal samples which indicates that the decision boundary is a little biased towards abnormal samples lof and iforest tend to classify some normal samples into abnormal samples abod shows more misclassification in abnormal samples than normal samples from the distribution of misclassified samples the performance of the algorithms is not only affected by the characteristics of the algorithms themselves but also by the dataset therefore in practical application we need to adopt different algorithms for different dataset we can comprehensively evaluate the performance of the algorithms according to table 5 overall a single algorithm shows similar characteristics in the anomaly detection of the four components which indicates that the dataset has little impact on the comprehensive performance of the algorithms the comprehensive performance of the six algorithms can be sorted as abod ocsvm svdd gknn iforest lof from the above analysis abod is the best choice when the training dataset is a pure normal dataset in the above experiments we use the pure normal training dataset to train the detection model but in practice this kind of training dataset is not easy to obtain and it is likely to be contaminated by some abnormal samples or noise therefore we hope that the algorithms can tolerate the contaminated training dataset to some extent from fig 4 we find that the algorithms performance declines with the increase of the contamination ratio however iforest and lof show strong tolerance to contaminated data although the comprehensive performance of iforest and lof is not very good compared with the other four algorithms it is still a good alternative when the training dataset contains a lot of contaminated data however the tolerance of iforest and lof to contaminated data shows different characteristics when the contamination ratio is low iforest shows stronger tolerance when the contamination ratio is high lof shows stronger tolerance therefore in practical application it should be noted that iforest is suitable for lightly contaminated data and lof is suitable for severely contaminated data 5 conclusion in this paper we investigate the performance of many one class classifiers in anomaly detection of the marine machinery system the classifiers are experimented with a dataset produced by a real data validated simulator of a frigate characterized by a combined diesel electric and gas propulsion plant compared with previous literatures the algorithms we investigated are more various and more comprehensive evaluation indexes are considered by us the main findings of our investigation are as follows the classification accuracy of one class classifiers increases with the number of training samples and about 500 training samples can train a good detection model abod is more suitable for big datasets however ocsvm svdd and iforest are more suitable for small datasets the boundary based algorithms ocsvm and svdd show unstable performance when the sample combinations of training datasets are changed in practice the performance of boundary based algorithms is probably not as good as expected because the training dataset in practice is probably not ideal as the original dataset used in this paper which considered all combinations of decay combinations in the analysis of misclassified samples we find that most misclassified samples are concentrated near the decay thresholds this implies that they can be classified correctly by the experimented algorithms with the deepening of the decay from the distribution of misclassified samples different algorithms show different performances in different datasets and no algorithm is the winner in the analysis of comprehensive performance the six algorithms can be sorted as abod ocsvm svdd gknn iforest lof therefore abod is probably the best choice when the training dataset is a pure normal dataset in terms of the tolerance to contaminated data iforest and lof show their outstanding advantage this greatly reduces the requirement for the purity of training dataset in practice it can be a good alternative when the pure normal dataset is difficult to obtain in conclusion we compare the performance of many representative one class classification algorithms in anomaly detection of marine machinery system although different algorithms show similar results in accuracy they show different characteristics in some other evaluation indexes which can be used as decision support for the application of one class classification algorithms in anomaly detection of marine machinery systems credit authorship contribution statement yanghui tan conceptualization methodology formal analysis writing review editing hui tian software formal analysis visualization writing original draft ruizheng jiang investigation data curation validation yejin lin supervision validation jundong zhang supervision resources project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement our research is financed by the fund of research on intelligent ship testing and verification 2018 473 the authors are responsible for the contents of this publication in addition the work presented in this paper is the continuation of altosole et al 2014 cipollini et al 2018a b coraddu et al 2014 lazakis et al 2018a so we would like to express our sincere gratitude to all the previous authors for their creative work and sharing of the dataset 
22017,a hybrid structure of pile supported wharf connecting with pile breakwater is tested in a flume with a scale factor of 1 30 based on generating regular and irregular waves and accurately reproducing bed profile by using pulverized coal both wave scour and load characteristic of this structure are investigated when structure under wave impact violent wave reflection is observed and wave transmission is small with the large wave height and water depth wave overtopping is significant and induces bigger green water height compared with bed without covering layer rubble covering layer obviously decreases the scour range of bed profile pressures of the structure have distinct spatial distribution characteristics the existing plates between piles of breakwater can easily trap the air during wave attack and induce significant impact pressure besides superstructure of pile supported wharf is mainly suffered from uplift pressure and attains the maximum pressure when air gap becomes zero due to dynamic response of structure measured forces have smaller values and larger periods than integrated forces and both horizontal and vertical measured forces decrease with increasing relative wave height the findings and data presented here may be used by oceanic numerical modelers and engineers for future research as well as predesign keywords hybrid structure pile breakwater pile supported wharf scour characteristic wave impact 1 introduction for the past decades oceanic and coastal engineering have attained a booming development however the wave is always playing a negative role on the safety and steady of oceanic and coastal structures such as breakwaters sea walls and wharf besides due to the strengthening environmental consciousness and the increasing need of the deep water ports the relatively small scaled vertical breakwaters and pile supported wharf are winning more attentions and applications against with the conventional rubble breakwater and gravity wharf nevertheless the horizontal wave impact on the vertical breakwater as well as the uplifted wave load beneath the deck still can not be ignored the qualitative and quantitative determination of wave loads on vertical structures has already been examined widely in the past decades bagnold 1939 studied the wave pressure induced by waves on a vertical wall and found the importance of wave s breaking condition breaking or non breaking on the measured wave pressure hull and muller 2002 also pointed out the resulting wave pressures are dependent on various wave shapes based on these work the shape of the incoming wave has been payed more attention in the researches oumeraci et al 1993 carried out flume tests on wave impact on the caisson breakwater and firstly described four main breaker types of incoming waves turbulent bore well developed plunging breaker plunging breaker upward deflected breaker faraci et al 2012 2015 further studied reflection of sea waves by combined caissons kisacik et al 2012a implemented the theory by oumeraci et al 1993 for the vertical wall with overhanging horizontal cantilever slab and further classified the wave breakers into breaking wave sbw breaking wave small air trap bwsat and breaking wave large air trap bwlat similarly ravindar et al 2017 classified the breaking wave impact into three different types based on the large scale experiment of breaking waves on a vertical wall with a recurve considering the wave overtopping streicher et al 2019 classified five bore interaction patterns and three impact types from a large scale model test on storm waves impacting the dike mounted vertical walls besides other scholars payed more attention on the magnitude distribution and occurrence probability of the wave impact load on the vertical structures hattori and arami 1993 calabrese and buccino 2000 wienke and oumeraci 2005 cuomo et al 2010a hofland et al 2011 faraci and liu 2014 marzeddu et al 2017 in addition to the wave impact acting on the vertical walls the uplifted wave impact on the horizontal slabs are also catching scholars eyes takahashi et al 1985 introduced a theoretical model and calculated method of the wave uplift forces on the ceiling slab which was well conformed by experimental data and field measurements cuomo et al 2007 payed attention to the wave in deck and improved the dimensionless equations for calculation of wave loads on deck in the same year van raaij and gudmestad 2007 aimed at the fixed steel jacket decks and presented a simplified but acceptable estimate for wave in deck load based on the physical experiments due to the heavy failures of coastal bridges during extreme storm events mazinani et al 2015 hayatdavoodi et al 2016 such as hurricane katrina striking the coasts of alabama mississippi and louisiana the need for research on wave in deck loads on coastal bridges are increasing cuomo et al 2009 modeled the wave impacting on the coastal bridges in a wave basin and emphasized the dynamic behavior of the wave impact as well as the effect of air on the wave in deck loads depending on the same experimental wave impacts serinaldi and cuomo 2011 further characterized impulsive wave in deck loads on coastal bridges by probabilistic models of impact maximum and rise times besides the increasing complication of coastal structures promoted the study of wave structure interaction kisacik et al 2012a 2012b 2014 carried out a series of wave model tests of a vertical structure with an overhanging horizontal cantilever slab and have made a comprehensive research based on the experimental record four wave breaker types can be observed during the model tests similar to oumeraci et al 1993 according to different breaker types wave impact pressures on the vertical structure as well as the horizontal slab were analyzed and three various pressure distributions were described in detail finally kisacik et al summarized different influences of wave height wave period as well as the clearance height on the pressure and total force acting on vertical and horizontal parts and presented a series of corrected empirical formulas based on the scale test results similarly chen et al 2019 used the wave impulses to further determine the reaction force of a hydraulic structure with an overhang due to wave impact except for the conventional experimental study numerical simulation due to its low cost and flexibility has become much more preference to be used to investigate the wave structure interaction issue in recent years liu and faraci 2014 used new semi analytical solution to study the orthogonal wave reflection by a caisson with open front chamber filled with sloping rubble mound noar and greenhow 2015 and noar et al 2019 presented a simplified model of wave impact on structures with rectangular geometries such seawall deck and baffles buccino et al 2016 studied the features of plunging breaker generated wave forces on a wave energy converted and observed a remarkable consistency between physical model results and cfd simulations chen et al 2018 studied the wave in deck loading on a solid box and a more realistic case of under deck beams with plated and porous decks by the volume of fluid vof method which provides a useful benchmark for predicting wave loading on platform decks under different incident wave directions using the boundary element method bem song and zhang 2018 achieved the complete process simulation of wave impact with air entrapment and analyzed the effects of the air pressure on the impact process with air entrapment buccino et al 2019a 2019b carried out wave cfd experiments on a low crested sloping top caisson breakwater and studied the nature of loading global stability and analyzed the plume impact respectively based on the experiment results yan et al 2019 further achieved a numerical study of plunging wave impact on a box shape structure by using an improved immersed boundary method and presented pressure distributions along the front and bottom walls as well as the range of normalized maximal pressures the wave structure interaction issue has been cared about for a long time and except for the main concern on the wave impact load acting on oceanic and coastal structures else problems are also focused by research workers and engineers such as the scale effect bullock et al 2001 cuomo et al 2010b heller 2011 trapped air effect wood et al 2000 plurnerault et al 2012 bredmose et al 2015 as well as the dynamic response of structures kirkgöz and mengi 1986 oumeraci and kortenhaus 1994 hattori and tsujioka 1996 takahashi et al 1999 chen et al 2019 although a number of researches on the wave structure interaction this issue will be developed and enriched due to different new oceanic and coastal structures such as overtopping wave energy conversion contestabile et al 2017 or stepped revetments kerpen et al 2018 in this study a new case of wave structure interaction has been presented in which a new hybrid structure is studied which will be constructed in zhejiang china this hybrid structure is a pile supported wharf connecting with a pile breakwater and it can also be called as self wave dissipation pile supported wharf as we known breakwater is a protection for ports in which wharf is the main component but with the increasing need of deep water ports the cost of constructing additional breakwater is very high thus the hybrid structure i e pile supported wharf with pile breakwater has been pointed out and recommended to practically apply in this research the wave hybrid structure interaction has been focused on experimentally and influence of wave action on the scour characteristic around hybrid structure as well as the wave loading on the structure are presented this paper is structured as follows in chapter 1 review of wave impact on marine structure is presented in chapter 2 a detail introduction of experimental setup is given including physical model setup and bed profile reproduction then in chapter 3 experimental observations and results discussion are given wave reflection and transmission scour characteristic of bed profile local wave pressure and total force of hybrid structure are highlighted finally conclusions useful for design purposes are drawn in chapter 4 2 experimental setup 2 1 physical model setup in the flume physical model tests have been carried out in the wave flume 80 m 1 m 1 5 m of hohai university china the piston type wave maker assembly is designated in fig 1 and specified as the origin for wave generation x 0 00 m both regular and irregular waves can be generated by the hydraulic actuator assembly of the wave maker which is equipped with an active wave absorption system for reflected wave the physical model is located 54 3 m away from the wave paddle on a seabed composed of two sections a 2 5 m long 1 10 slope followed by a 1 8 m long 1 20 slope based on the froude number similarity a scale factor of 1 30 is adopted to ensure correct reproduction of all wave processes the scaled structure model is 0 54 m hm high and 0 7 m long lm totally which is consisted of the forward pile breakwater and the backward pile supported wharf the pile breakwater is a wall formed from contiguous circular piles with the interval of 0 055 m the diameter of piles is 0 04 m and both sides of each pile are equipped with thin plates of 0 01 m width the detail of pile breakwater can be seen in fig 2 secondly the pile supported wharf is comprised with bearing piles pile caps transverse beams longitudinal beams and deck the final tested hybrid model is formed by combining the forward pile breakwater with the backward pile supported wharf through the deck behind the structure a passive spending beach consist of rubble is set up to absorb the wave energy and decrease the wave reflection along flume the entire physical model is built from plexglass and more descriptions is shown in fig 2 2 2 reproduction of seabed in order to investigate the scour characteristic around the hybrid structure under oceanic dynamic the seabed under the hybrid structure is reproduced accurately compared with the other similarity laws the sediment incipience similarity law plays a significant role in the study on sediment scour characteristic under wave action the wave height for sediment incipient motion can be calculated as follow dou et al 2001 1 h c t π sinh 2 π h l a l δ 1 2 3 6 ρ s ρ ρ g d β w β ε 0 g h δ δ d 1 2 d b π l t 2 b π l t where a is the coefficient about the sediment incipience condition b is the constant δ is roughness height ρ s and ρ are the density of sediment and water respectively d is the diameter of sediment β is the compactness coefficient of sediment β w is the reduction coefficient of β equal to d d 1 3 4 d 1 is the characteristic diameter of sediment and equal to 0 15 mm especially when d d 1 β w is 1 δ is the film water thickness ε 0 is the parameter of cohesive force of sediment h is the water depth t is the wave period and l is the wave length in this study pulverized coal with 0 2 mm diameter and 1 35 t m3 density is selected to model the sediment of the slope the prototype values of diameter and density of sediment is 0 0278 mm and 2 65 t m3 respectively both of the model and prototype sediments have cohesive behaviour to some extent based on the formula above the wave height for sediment incipient motion for prototype and model is 0 56 m and 0 018 m respectively the similarity scale of wave height for sediment incipient motion is about 1 30 which is similar to the scale of froude number similarity mentioned above values for other parameters can be seen in table 1 moreover to accurately measure the elevation change of the seabed under wave action several transparent plates marked with scale line with a 5 cm scale interval are put at the side of the flume as shown in fig 3 2 3 wave conditions instrument and methods in addition to scour characteristic around the hybrid structure the wave elevation is also recorded by 9 wave gauges among which 5 wave gauges wg1 wg5 are located before the structure and 4 wave gauges wg6 wg9 are set after the structure the space arrangement of all wave gauges are shown in fig 1 in this study significant wave height h s and peak period t p are used for irregular wave and mean wave height h and mean period t are used for regular wave besides four water depths d are considered and combinations of all test conditions for each experimental trial are summarized in table 2 irregular waves were generated using the jonswap spectrum with γ 3 3 and the duration of each irregular wave case was determined by requiring at least 100 waves for each trial based on the expected wave peak period as shown in table 2 a range of wave conditions with characteristic wave heights measured at wg1 located x 35 5 m from the wave maker between 0 06 m and 0 21 m periods between 1 10s and 1 48s and offshore water depths at the wave maker between 0 59 m and 0 78 m were generated to assess the effects of increasing wave height wave period and still water depth on increasing impact acting on the hybrid structure in order to observe the local and total wave loads at the same time 27 pressure sensors and a total force measured system are adopted to measure the local wave pressures and total forces for all wave trials all the pressure sensors are installed at different parts of the hybrid structure such as pile breakwater ps1 ps10 ps26 ps27 bearing piles ps11 ps13 pile caps ps15 transverse beams ps16 ps17 longitudinal beams ps18 ps19 and the deck ps20 ps25 and specific locations of pressure sensors can be seen in fig 2 and table 3 besides the total force measured system are consisted of the steel frame and four load cells installed on the top corners of the hybrid structure both the sampling rates of pressure transducers and load cell are 100 hz and the sketch of the hybrid structure and load instruments are shown in fig 2 pressure total force and wave elevation measurements were balanced to zero before each test for all wave trials in order to ensure the accurate of the test result each wave trial is generated three times and averaging the results of pressure total force and wave elevation measurements as the final result 3 results and discussion 3 1 wave characteristics this section presents the detailed identification of the incident and reflected wave characteristics all the tested incident wave conditions are presented in table 2 both regular and irregular waves fig 4 shows an example of the calculated incident wave elevation for x3 the signal is stable in time since the wave absorption system retards the re reflection the signal at the very beginning of the test is not real due to the filtering procedure that separates incident and reflected waves and is not shown in this section fig 4 shows that the wave generator makes an effort to hold the incident wave constant to the value h 0 21 m because of the nonlinear effects and the presence of the strong reflection of the structure although deviations of some millimeters between different waves are visible however the pattern of the amplitude is repeated in a consistent way fig 4 also shows that due to the short term generator ramp up process stationary conditions are reached only after 5 6 waves measured incident wave height is very similar to target value both for regular and irregular wave trials the wave frequency is almost exactly defined and the wave height deviates just marginally from the desired one fig 5 shows the reflection coefficient k r ratio between reflected and incident h rms against the relative wave height h s d ratio between wave height and water depth both for regular and irregular wave trials with the same t or t p 1 48s the reflection is always larger than 50 and increases with relative wave height fig 6 shows the relation between k r and wave steepness h s l ratio between wave height and wave length for all wave trials in total the reflection increases with the wave steepness besides for different water depths the larger water depth can carry out the bigger reflection except for the wave reflection mentioned above the wave transmission also plays an important role and wave height attenuation coefficient k t is usually adopted as significant indices to evaluate the efficiency of wave transmission waves are used to be characterized by the significant wave height h s however other definitions of wave height such as the maximum wave height h max or the average of the highest specified percentage of the waves e g h 4 h 1 100 may be used in this section the significant wave height is adopted as the characterized wave height and wave transmission coefficient k t is calculated as the ratio between the significant wave height behind the structure and the incident wave height k t is plotted in fig 7 against the wave steepness it can be noted that k t is very small ranging between 20 and 40 and it varies slightly along the flume from wg6 to wg9 for different wave trials k t decreases with the increasing wave steepness which is relatively opposite to the wave reflection illustrated above when intensified under severe weather conditions and by extreme geophysical forces such as hurricanes and earthquakes the wave heights increase and can overtop the decks of marine structures the resulting breaking waves may generate the so called green water phenomenon song et al 2015 in this section the green water height is defined as the difference between wave crest elevation and deck elevation similarly the green water height is characterized by the significant green water height as well fig 8 shows the green water height of front edge and back edge of the hybrid structure the positive value represents that the wave crest is higher than the deck and vice versa from the figure point of view green water height is large at front edge which is due to the large wave overtopping induced by violent wave attacking on the pile breakwater the back edge is not influenced by wave overtopping and the green water height here is negative for all trials the green water height is ranging between 0 25 m and 0 25 m and it depends significantly on water depth and wave height the larger water depth and wave height can bring out larger green water high and increasing the elevation of deck can decrease the green water height effectively 3 2 scour characteristics 3 2 1 change of the bed profile under wave action in general the toe of marine structures plays an crucial role in the steady and safety of the whole marine structure scour in the vicinity of structural toe is the main cause for the marine structures failure in the past decades breakwater failures due to scour have been reported by oumeraci 1994 and oumeraci 1995 at the same time scour at marine structures has been studied fairly extensively including not only the traditional rubble mound breakwater and vertical breakwater sumer et al 2005 tahersima et al 2011 but also the new structural forms such as pile breakwater submerged reef and so on faraci et al 2014 faraci 2018 aminia and solaimani 2017 qi et al 2018 in this study a pile breakwater is connected with a pile supported wharf forming a hybrid structure as seen in fig 2 due to the resistance against incident wave of pile breakwater the wave dynamic will be strengthened before the hybrid structure in such way the seabed around the hybrid structure will be effected significantly the final scour profiles are shown in fig 9 under different wave trials the original seabed is consisted of two parts i e a 1 10 slope followed by a 1 20 slope as shown in fig 1 which reproduced using the pulverized coal according to the similarity scale of wave height for sediment incipient motion the figure shows that after wave action the bed ranging between 50 m and 51 3 m is deposited and that between 51 3 m and 54 7 m is scoured due to the violent interaction between wave and pile breakwater scour in the vicinity of pile breakwater is heavy in total two slopes before pile breakwater are scoured becoming into flat and the toe of pile breakwater is eroded significantly causing such a large elevation difference at the pile breakwater and forming a scarp behind the pile breakwater in order to decrease the scour at the hybrid structure 0 0111 0 0185 kg rubble is set up on the bed before the pile breakwater toe with the cover range of 0 33 m long and 0 067 m depth fig 10 shows the scour profiles after covering rubble under the same wave conditions it can be easily noted that the covering layer of rubble significantly decreases the scour around the hybrid structure as a whole the scour pattern with covering layer is similar to that without covering layer in which the 1 10 slope is mainly deposited and the 1 20 slope is mainly scour however compared with the bed without covering layer the bed with covering layer has a smaller scour range and there is a sand bar forming after the scour hole which is agree well with xu et al 2019 3 2 2 effects of wave height and water depth on the characteristics of scour and deposit through the comparison between the original bed profiles and that after wave action several parameters are further considered including the ratio between maximum scour depth and maximum deposition height d s d d and the ratio between maximum scour area and maximum deposition area a s a d fig 11 shows the relation between d s d d and relative wave height h s d ratio between wave height and water depth as expected compared with the bed without cover layer d s d d is smaller when the bed is protected by rubble covering it can be seen that both the d s d d under two conditions increase with h s d this result reveals that the bigger wave height and smaller water depth can cause more violent sediment motion fig 12 plots a s a d against wave steepness h s l from the figure point of view when the bed is protected by cover layer a s a d is much smaller and keeps constant influenced slightly by h s l however when the bed is without cover layer with the increasing h s l a s a d firstly decreases and then increases it may be concluded from the results in this section that i both wave height and water depth have effect on bed scour and deposit and ii there may be large relative distinguish between d s d d and a s a d which makes them not good to be adopted at the same time 3 3 wave pressures 3 3 1 time series of pressures at different parts due to the complication of the hybrid structure in this study different parts are suffered from different wave impact which cause the significant different spatial distribution of wave dynamic pressures in the model test all pressure sensors are synchronized to allow a more accurate relation between the wave pressures measured in different parts as for an example a time series of pressure about 3s is shown in fig 13 for regular wave trial x7 considering the limitation of article space only pressure series of ps4 ps6 ps9 ps10 ps15 and ps21 are presented as can be seen in the figure time series of pressure measured in different parts shows a identical period however the value of maximum pressure at different parts is obviously different fig 13 a shows a typical dynamic impact pressure wave impact with a relative large pressure in a short duration followed by a distinctly separated quasi static pressure wave impact with a relative small pressure in a long duration at ps9 this phenomenon can be also observed on a vertical wall with an overhanging horizontal cantilever slab as well as a vertical wall with recurved parapet kisacik et al 2012b castellino et al 2018 martinelli et al 2018 according to previous researches when the vertical wall is equipped with overhanging horizontal component the connected corner can easily concentrate the wave energy and trap the air during the wave attacking process inducing the significant impact pressure fig 13 b and 13 c present a large pressure in a relative long duration at ps6 and ps4 which can be adopted as quasi static pressure compared with the impact pressure quasi static pressure occurs much more commonly and has been analyzed in a long time for a long time it has been reached a consensus that impact pressure has no significant effect on the coastal structure due to its higher frequency than the nature frequency of structure nevertheless with the increasing destroy of built marine structure which is designed only considering the quasi static pressure researchers found that impact pressure can not be ignored as always in recent decades many researches have payed more attention to the influence of impact pressure on the coastal and oceanic structure marzeddu et al 2013 chen et al 2019 ghadirian and bredmose 2019 compared with the large wave pressures measured at ps9 ps6 and ps4 fig 13 d and 13 e present a smaller wave pressures at ps10 and ps15 and fig 13 f just shows a slight oscillation of wave pressure at ps21 on one hand the obvious difference of wave pressures between ps9 ps6 ps4 and ps10 ps15 ps21 indicates the spatial distribution characteristic of pressures on the other hand the smaller pressure reveals the ability of pile breakwater and beams to decrease the wave attacking based on these observation the relationship between wave height water depth and wave induced loads are discussed further in the following sections from horizontal and vertical point of view respectively 3 3 2 horizontal wave pressures on the pile breakwater similar to wave height and green water height depicted above the wave induced pressure acting on the hybrid structure can be analyzed by using different definitions for a characteristic wave pressure several characteristic pressures have been considered previously for example kisacik et al 2012b and ravindar et al 2017 considered a characteristic p max the maximum of all pressures meanwhile the significant pressure p 13 may also be important for resisting high probability loads and other definitions may be considered based on a structure s importance or use park et al 2017 analyzed the p mean p 1 3 p 1 10 p 1 50 p 1 100 p 1 250 and p max at the same time representing the mean significant average of the highest 10 2 1 0 4 and maximum pressure respectively in this study p max p 1 p 4 p 13 p mean are calculated and analyzed at the same time for each of the wave trials in the horizontal and vertical directions fig 14 shows the p max of ps5 ps26 and ps27 for all wave trials the locations of those three pressure sensors can be seen in fig 2 due to the elevation of three pressure sensors is almost equal to the water surface elevation of x8 and x11 those three pressure sensors are directly suffered from wave impact during x8 and x11 inducing much larger pressure values compared to other wave trials besides for all wave trials it can be noted that p max of ps5 is smaller than that of ps26 and ps27 this result is not well agreed with that of ghadirian and bredmose 2019 who pointed out that the wave pressure decreased with the increased azimuth theoretically the difference between such two results is due to different structural forms considered in each study compared with the single pile analyzed in the research of ghadirian and bredmose 2019 pile breakwater in this study is equipped with the ribbed plates to block off the interval between piles thus unlike wave can diffract through the single pile causing a smaller wave pressure at the location of bigger azimuth the existing ribbed plates strengthens the block to wave besides the connected locations between piles and plates can more easily trap the air during the wave attack where inducing a more violent wave impact pressure fig 15 shows the time series of pressure on ps5 ps26 and ps27 for x11 wave trial in the figure compared with the relative small pressure at ps5 ps26 and ps27 present the much more obvious wave impact and appear the larger pressure values fig 16 presents the distribution of wave pressures along the pile breakwater for the irregular wave trial x8 in the figure p max p 1 p 4 p 13 and p mean are plotted together as for p max p 1 the locations of maximum pressure are about 0 88 m however as for p 4 p 13 and p mean locations of maximum pressure change from 0 88 m to 0 62 m the different distributions of pressure occur when using different characteristic pressures thus in order to better understand the wave impact on coastal structure both p max and other characteristic pressures should be analyzed at the same time fig 17 a presents the pressure distributions under 4 irregular wave trials x1 x4 x8 x11 as can be seen in the figure both values and locations of maximum pressure are different for 4 trials x8 and x11 show a larger value and lower site than x1 and x4 those distinguish observed are the results of different water depths according to table water depth of x1 and x4 are larger than that of x8 and x11 as illustrated in section bigger water depth carries out larger wave overtopping inducing a number of dissipation of wave energy as a result the wave impact on the pile breakwater is decreased in order to strengthen the acknowledge on pressure distribution fig 17 b shows the normalized pressure distribution in the figure y is normalized by the water depth d and significant wave pressure p 13 is normalized by ρ g h s in which ρ is the water density and g is the gravity acceleration the black horizontal line at the center marks the position of swl from the figure point of view it is expect to found that the values of maximum p 13 ρ g h s for x8 and x11 are still larger than that for x1 and x4 besides the location of maximum p 13 ρ g h s for 4 trials are similar to each other and near the swl which is agreed with previous researches such as kirkgöz 1982 allsop et al 1996 cuomo et al 2010a and marzeddu et al 2017 further observing it can also note that when the wave steepness decreases the location of maximum p 13 ρ g h s shifts from below the swl to above the swl defining the pressure profile is one of the critical points to consider for structural designers and it may be concluded from the results above that i adopting different characteristic wave pressures can attain different pressure distributions and ii it is reasonable to taking the location of swl as the position of maximum pressure but it should bear in mind that the maximum pressure position may be effected by the wave breaker types as well as the wave steepness to some extent 3 3 3 pressures on pile supported wharf while above illustrates the wave impact on pile breakwater the pressures of pile supported wharf also play a important role on the safety and steady of the whole hybrid structure only dynamic pressure is being considered here fig 18 shows the horizontal pressures acting on other positions such as pile foundation and berthing member to better compare the pressure of pile breakwater and that of other positions the ratio between pressures of other positions and pressure of ps4 located on pile breakwater is plotted in fig 18 in the figure abscissa is wave steepness h s l and ordinate is p 13 i p 13 4 in which the subscript 4 presents ps4 and i presents other pressure sensors i e from ps10 to ps14 it is expected that pressures on pile foundation and other positions are smaller than that of pile breakwater p 13 i p 13 4 is small and almost ranging between 2 and 40 with the increasing h s l p 13 i p 13 4 presents a increasing trend generally these results can be adopted as scientific reference in the future preliminary design of the pile foundation behind the protection of pile breakwater generally marine structure is suffered from both horizontal and vertical wave impact in this study when the pile foundation is acted by the horizontal pressure the superstructure of pile supported wharf is mainly impacted by uplift pressure therefore a representative pressure p max is normalized by the ρ g h s where ρ is the water density g is the gravity acceleration and h s is the incident significant wave height fig 19 depicts these normalized pressures plotted against clearance height c normalized by the water depth c d for all wave trials in the figure normalized wave pressures on different parts are presented such as pile cap transverse beam longitudinal beam and the deck it can be found that the normalized vertical pressure shows a firstly increasing and then decreasing trend with increasing clearance height with the largest normalized pressure for each part occurring near the water level c d 0 such findings are in agreement with that in wharf chen et al 2016 elevated coastal structure park et al 2017 and vertical wall with an overhanging horizontal cantilever slab kisacik et al 2014 these results are important for marine structure designer vertical wave impact will not always decrease with the increasing clearance height and when the structure or part is located at the still water level the uplifted pressure can be strengthened heavily a submerged structure or part will suffered from smaller vertical wave impact however it can be also found that the vertical wave induced pressure can be decreased to zero if the clearance height is large enough 3 4 wave forces both total forces and local pressures are measured for all trials integrating the pressures as integrated force horizontally and vertically as an example fig 20 shows the time series of measured horizontal force and integrated horizontal force for the regular wave trial x7 in the figure measured force is smaller than integrated force during all the time series the period of measured force is larger than that of integrated force as illustrated in humar 2002 wave loads can be divided into three domains according to the duration of impacts acting on structure such as impulsive dynamical and quasi static impacts the duration is regarded relative to the natural frequency of the structure during impulsive domain the subjected load is over well before the structure reaches its maximum deflection and therefore the actual reacted load will be smaller than the measured ones in this study impulsive impact is observed as seen in fig 13 a thus the actually reacted force i e measured force induced by the dynamic response of the hybrid structure is smaller than the integrated force which is attained by integrating the pressures of sensors fig 21 plots the measured force f 1 m and integrated force f 1 i together for all wave trials the subscript m and i represent measured and integrated values and 1 represents the average of the highest 1 maximum value the black slant line presents the function of y 2 x it can be found that all data points are almost on such line that f 1 m is twice of f 1 i this ratio between measured and integrated force is not constant and may be influenced by the wave conditions structure forms as well as sample frequency of devices up to now the dynamic response of coastal structure under wave impact has been examined experimentally numerically and theoretically tanrikulu et al 2002 chen et al 2019 however this is still difficulty in the handling of impact pressure measured as well as the scale effect between the prototypes and models thus more efforts still need to made in the future furthermore fig 22 shows the horizontal and vertical measured forces for x1 x4 x8 and x11 in fig 22 a with the increasing hs d both horizontal and vertical forces decrease such phenomenon is the result of large wave height inducing significant wave overtopping on one hand wave overtopping produces the energy dissipation which reduces the horizontal wave impact on structure on the other hand the water body of wave overtopping strikes directly on the deck and cause the downward force which counteracts the vertical force to some extend the variation of horizontal and vertical forces with increasing hs d also cause the variation of the ratio between horizontal and vertical forces as was expected f 1 h f 1 v shows a increased trend with increasing hs d as seen in fig 22 b which has a agreement with the research of park et al 2017 4 conclusion a hybrid structure which is a pile breakwater connecting to a pile supported wharf is tested on a two dimensional flume under loading conditions of regular and irregular wave impacts the tests are carried out in a small scale test set up with a scale factor of 1 30 and wave characteristic scour characteristic local wave pressure and measured force are investigated together when the hybrid structure under the wave action a significant wave reflection can be observed due to the existing pile breakwater wave reflection is influenced by wave conditions and increases with increased relative wave height and wave steepness it corresponds to strong reflection that the wave transmission is small ranging between 20 and 40 and decreases with increasing wave steepness besides due to the violent wave structure interaction wave overtopping is observed especially for large wave height and induces the larger green water height i e wave overtopping height water depth and wave height have a obvious effect on green water height and increasing the elevation of deck can decrease the green water height effectively scour characteristics of two bed profiles are considered without covering layer and with rubble covering layer for both profiles the change pattern under wave action is similar in which the toe of slope is deposited and the position of structure is scoured significantly compared with bed profile without covering layer the bed profile with rubble covering layer has a smaller scour range and forms a sand bar after the scour hole both wave height and water depth have effect on bed scour and deposit the bigger wave height and smaller water depth can cause more violent sediment motion and larger scour depth due to the complication of the hybrid structure there is obvious spatial distributions characteristic between pressures of different parts various wave loads can be observed such as impulsive dynamical and quasi static wave pressure compared with the conventional pile breakwater the pile breakwater with plates between intervals of piles can easily concentrate the wave energy and trap the air during wave impact and inducing the obvious impact pressure near the connected corner between piles and plates wave distribution of pile breakwater is influenced by both characteristic pressure used and wave conditions with the decreasing wave steepness the location of maximum pressure shifts from below the still water level to above the still water level compared with the large pressure on pile breakwater horizontal pressure of other positions have a smaller value ranging between 2 and 40 of pressure on pile breakwater and increase with increasing wave steepness besides superstructure of pile supported wharf is mainly effected by uplift load pressures on the superstructure can change depending on the structure s clearance height c i e the difference between structure and water elevation and water depth d it can be found that with the increasing c d vertical pressure on superstructure increases firstly and then decreases and reaches the maximum at c d 0 both force and pressure are measured and integrating the pressures as integrated force comparing the integrated force and measured force it can be noted that measured force has a smaller value and larger period because of the dynamic response of the hybrid structure for all wave trials integrated horizontal forces are about twice measured horizontal force with the increasing relative wave height h s d both horizontal and vertical measured force decrease and the ratio between horizontal and vertical measured force increases the current paper introduces a hybrid structure i e a pile breakwater connected with a pile supported wharf and investigates the wave scour and load characteristic all the results are based on the analysis of experimental data and limited by the range of the model test the findings here may be used by oceanic planners numerical modelers and engineers for future research and predesign credit authorship contribution statement jianjun huang conceptualization methodology formal analysis data curation writing original draft guoping chen resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
22017,a hybrid structure of pile supported wharf connecting with pile breakwater is tested in a flume with a scale factor of 1 30 based on generating regular and irregular waves and accurately reproducing bed profile by using pulverized coal both wave scour and load characteristic of this structure are investigated when structure under wave impact violent wave reflection is observed and wave transmission is small with the large wave height and water depth wave overtopping is significant and induces bigger green water height compared with bed without covering layer rubble covering layer obviously decreases the scour range of bed profile pressures of the structure have distinct spatial distribution characteristics the existing plates between piles of breakwater can easily trap the air during wave attack and induce significant impact pressure besides superstructure of pile supported wharf is mainly suffered from uplift pressure and attains the maximum pressure when air gap becomes zero due to dynamic response of structure measured forces have smaller values and larger periods than integrated forces and both horizontal and vertical measured forces decrease with increasing relative wave height the findings and data presented here may be used by oceanic numerical modelers and engineers for future research as well as predesign keywords hybrid structure pile breakwater pile supported wharf scour characteristic wave impact 1 introduction for the past decades oceanic and coastal engineering have attained a booming development however the wave is always playing a negative role on the safety and steady of oceanic and coastal structures such as breakwaters sea walls and wharf besides due to the strengthening environmental consciousness and the increasing need of the deep water ports the relatively small scaled vertical breakwaters and pile supported wharf are winning more attentions and applications against with the conventional rubble breakwater and gravity wharf nevertheless the horizontal wave impact on the vertical breakwater as well as the uplifted wave load beneath the deck still can not be ignored the qualitative and quantitative determination of wave loads on vertical structures has already been examined widely in the past decades bagnold 1939 studied the wave pressure induced by waves on a vertical wall and found the importance of wave s breaking condition breaking or non breaking on the measured wave pressure hull and muller 2002 also pointed out the resulting wave pressures are dependent on various wave shapes based on these work the shape of the incoming wave has been payed more attention in the researches oumeraci et al 1993 carried out flume tests on wave impact on the caisson breakwater and firstly described four main breaker types of incoming waves turbulent bore well developed plunging breaker plunging breaker upward deflected breaker faraci et al 2012 2015 further studied reflection of sea waves by combined caissons kisacik et al 2012a implemented the theory by oumeraci et al 1993 for the vertical wall with overhanging horizontal cantilever slab and further classified the wave breakers into breaking wave sbw breaking wave small air trap bwsat and breaking wave large air trap bwlat similarly ravindar et al 2017 classified the breaking wave impact into three different types based on the large scale experiment of breaking waves on a vertical wall with a recurve considering the wave overtopping streicher et al 2019 classified five bore interaction patterns and three impact types from a large scale model test on storm waves impacting the dike mounted vertical walls besides other scholars payed more attention on the magnitude distribution and occurrence probability of the wave impact load on the vertical structures hattori and arami 1993 calabrese and buccino 2000 wienke and oumeraci 2005 cuomo et al 2010a hofland et al 2011 faraci and liu 2014 marzeddu et al 2017 in addition to the wave impact acting on the vertical walls the uplifted wave impact on the horizontal slabs are also catching scholars eyes takahashi et al 1985 introduced a theoretical model and calculated method of the wave uplift forces on the ceiling slab which was well conformed by experimental data and field measurements cuomo et al 2007 payed attention to the wave in deck and improved the dimensionless equations for calculation of wave loads on deck in the same year van raaij and gudmestad 2007 aimed at the fixed steel jacket decks and presented a simplified but acceptable estimate for wave in deck load based on the physical experiments due to the heavy failures of coastal bridges during extreme storm events mazinani et al 2015 hayatdavoodi et al 2016 such as hurricane katrina striking the coasts of alabama mississippi and louisiana the need for research on wave in deck loads on coastal bridges are increasing cuomo et al 2009 modeled the wave impacting on the coastal bridges in a wave basin and emphasized the dynamic behavior of the wave impact as well as the effect of air on the wave in deck loads depending on the same experimental wave impacts serinaldi and cuomo 2011 further characterized impulsive wave in deck loads on coastal bridges by probabilistic models of impact maximum and rise times besides the increasing complication of coastal structures promoted the study of wave structure interaction kisacik et al 2012a 2012b 2014 carried out a series of wave model tests of a vertical structure with an overhanging horizontal cantilever slab and have made a comprehensive research based on the experimental record four wave breaker types can be observed during the model tests similar to oumeraci et al 1993 according to different breaker types wave impact pressures on the vertical structure as well as the horizontal slab were analyzed and three various pressure distributions were described in detail finally kisacik et al summarized different influences of wave height wave period as well as the clearance height on the pressure and total force acting on vertical and horizontal parts and presented a series of corrected empirical formulas based on the scale test results similarly chen et al 2019 used the wave impulses to further determine the reaction force of a hydraulic structure with an overhang due to wave impact except for the conventional experimental study numerical simulation due to its low cost and flexibility has become much more preference to be used to investigate the wave structure interaction issue in recent years liu and faraci 2014 used new semi analytical solution to study the orthogonal wave reflection by a caisson with open front chamber filled with sloping rubble mound noar and greenhow 2015 and noar et al 2019 presented a simplified model of wave impact on structures with rectangular geometries such seawall deck and baffles buccino et al 2016 studied the features of plunging breaker generated wave forces on a wave energy converted and observed a remarkable consistency between physical model results and cfd simulations chen et al 2018 studied the wave in deck loading on a solid box and a more realistic case of under deck beams with plated and porous decks by the volume of fluid vof method which provides a useful benchmark for predicting wave loading on platform decks under different incident wave directions using the boundary element method bem song and zhang 2018 achieved the complete process simulation of wave impact with air entrapment and analyzed the effects of the air pressure on the impact process with air entrapment buccino et al 2019a 2019b carried out wave cfd experiments on a low crested sloping top caisson breakwater and studied the nature of loading global stability and analyzed the plume impact respectively based on the experiment results yan et al 2019 further achieved a numerical study of plunging wave impact on a box shape structure by using an improved immersed boundary method and presented pressure distributions along the front and bottom walls as well as the range of normalized maximal pressures the wave structure interaction issue has been cared about for a long time and except for the main concern on the wave impact load acting on oceanic and coastal structures else problems are also focused by research workers and engineers such as the scale effect bullock et al 2001 cuomo et al 2010b heller 2011 trapped air effect wood et al 2000 plurnerault et al 2012 bredmose et al 2015 as well as the dynamic response of structures kirkgöz and mengi 1986 oumeraci and kortenhaus 1994 hattori and tsujioka 1996 takahashi et al 1999 chen et al 2019 although a number of researches on the wave structure interaction this issue will be developed and enriched due to different new oceanic and coastal structures such as overtopping wave energy conversion contestabile et al 2017 or stepped revetments kerpen et al 2018 in this study a new case of wave structure interaction has been presented in which a new hybrid structure is studied which will be constructed in zhejiang china this hybrid structure is a pile supported wharf connecting with a pile breakwater and it can also be called as self wave dissipation pile supported wharf as we known breakwater is a protection for ports in which wharf is the main component but with the increasing need of deep water ports the cost of constructing additional breakwater is very high thus the hybrid structure i e pile supported wharf with pile breakwater has been pointed out and recommended to practically apply in this research the wave hybrid structure interaction has been focused on experimentally and influence of wave action on the scour characteristic around hybrid structure as well as the wave loading on the structure are presented this paper is structured as follows in chapter 1 review of wave impact on marine structure is presented in chapter 2 a detail introduction of experimental setup is given including physical model setup and bed profile reproduction then in chapter 3 experimental observations and results discussion are given wave reflection and transmission scour characteristic of bed profile local wave pressure and total force of hybrid structure are highlighted finally conclusions useful for design purposes are drawn in chapter 4 2 experimental setup 2 1 physical model setup in the flume physical model tests have been carried out in the wave flume 80 m 1 m 1 5 m of hohai university china the piston type wave maker assembly is designated in fig 1 and specified as the origin for wave generation x 0 00 m both regular and irregular waves can be generated by the hydraulic actuator assembly of the wave maker which is equipped with an active wave absorption system for reflected wave the physical model is located 54 3 m away from the wave paddle on a seabed composed of two sections a 2 5 m long 1 10 slope followed by a 1 8 m long 1 20 slope based on the froude number similarity a scale factor of 1 30 is adopted to ensure correct reproduction of all wave processes the scaled structure model is 0 54 m hm high and 0 7 m long lm totally which is consisted of the forward pile breakwater and the backward pile supported wharf the pile breakwater is a wall formed from contiguous circular piles with the interval of 0 055 m the diameter of piles is 0 04 m and both sides of each pile are equipped with thin plates of 0 01 m width the detail of pile breakwater can be seen in fig 2 secondly the pile supported wharf is comprised with bearing piles pile caps transverse beams longitudinal beams and deck the final tested hybrid model is formed by combining the forward pile breakwater with the backward pile supported wharf through the deck behind the structure a passive spending beach consist of rubble is set up to absorb the wave energy and decrease the wave reflection along flume the entire physical model is built from plexglass and more descriptions is shown in fig 2 2 2 reproduction of seabed in order to investigate the scour characteristic around the hybrid structure under oceanic dynamic the seabed under the hybrid structure is reproduced accurately compared with the other similarity laws the sediment incipience similarity law plays a significant role in the study on sediment scour characteristic under wave action the wave height for sediment incipient motion can be calculated as follow dou et al 2001 1 h c t π sinh 2 π h l a l δ 1 2 3 6 ρ s ρ ρ g d β w β ε 0 g h δ δ d 1 2 d b π l t 2 b π l t where a is the coefficient about the sediment incipience condition b is the constant δ is roughness height ρ s and ρ are the density of sediment and water respectively d is the diameter of sediment β is the compactness coefficient of sediment β w is the reduction coefficient of β equal to d d 1 3 4 d 1 is the characteristic diameter of sediment and equal to 0 15 mm especially when d d 1 β w is 1 δ is the film water thickness ε 0 is the parameter of cohesive force of sediment h is the water depth t is the wave period and l is the wave length in this study pulverized coal with 0 2 mm diameter and 1 35 t m3 density is selected to model the sediment of the slope the prototype values of diameter and density of sediment is 0 0278 mm and 2 65 t m3 respectively both of the model and prototype sediments have cohesive behaviour to some extent based on the formula above the wave height for sediment incipient motion for prototype and model is 0 56 m and 0 018 m respectively the similarity scale of wave height for sediment incipient motion is about 1 30 which is similar to the scale of froude number similarity mentioned above values for other parameters can be seen in table 1 moreover to accurately measure the elevation change of the seabed under wave action several transparent plates marked with scale line with a 5 cm scale interval are put at the side of the flume as shown in fig 3 2 3 wave conditions instrument and methods in addition to scour characteristic around the hybrid structure the wave elevation is also recorded by 9 wave gauges among which 5 wave gauges wg1 wg5 are located before the structure and 4 wave gauges wg6 wg9 are set after the structure the space arrangement of all wave gauges are shown in fig 1 in this study significant wave height h s and peak period t p are used for irregular wave and mean wave height h and mean period t are used for regular wave besides four water depths d are considered and combinations of all test conditions for each experimental trial are summarized in table 2 irregular waves were generated using the jonswap spectrum with γ 3 3 and the duration of each irregular wave case was determined by requiring at least 100 waves for each trial based on the expected wave peak period as shown in table 2 a range of wave conditions with characteristic wave heights measured at wg1 located x 35 5 m from the wave maker between 0 06 m and 0 21 m periods between 1 10s and 1 48s and offshore water depths at the wave maker between 0 59 m and 0 78 m were generated to assess the effects of increasing wave height wave period and still water depth on increasing impact acting on the hybrid structure in order to observe the local and total wave loads at the same time 27 pressure sensors and a total force measured system are adopted to measure the local wave pressures and total forces for all wave trials all the pressure sensors are installed at different parts of the hybrid structure such as pile breakwater ps1 ps10 ps26 ps27 bearing piles ps11 ps13 pile caps ps15 transverse beams ps16 ps17 longitudinal beams ps18 ps19 and the deck ps20 ps25 and specific locations of pressure sensors can be seen in fig 2 and table 3 besides the total force measured system are consisted of the steel frame and four load cells installed on the top corners of the hybrid structure both the sampling rates of pressure transducers and load cell are 100 hz and the sketch of the hybrid structure and load instruments are shown in fig 2 pressure total force and wave elevation measurements were balanced to zero before each test for all wave trials in order to ensure the accurate of the test result each wave trial is generated three times and averaging the results of pressure total force and wave elevation measurements as the final result 3 results and discussion 3 1 wave characteristics this section presents the detailed identification of the incident and reflected wave characteristics all the tested incident wave conditions are presented in table 2 both regular and irregular waves fig 4 shows an example of the calculated incident wave elevation for x3 the signal is stable in time since the wave absorption system retards the re reflection the signal at the very beginning of the test is not real due to the filtering procedure that separates incident and reflected waves and is not shown in this section fig 4 shows that the wave generator makes an effort to hold the incident wave constant to the value h 0 21 m because of the nonlinear effects and the presence of the strong reflection of the structure although deviations of some millimeters between different waves are visible however the pattern of the amplitude is repeated in a consistent way fig 4 also shows that due to the short term generator ramp up process stationary conditions are reached only after 5 6 waves measured incident wave height is very similar to target value both for regular and irregular wave trials the wave frequency is almost exactly defined and the wave height deviates just marginally from the desired one fig 5 shows the reflection coefficient k r ratio between reflected and incident h rms against the relative wave height h s d ratio between wave height and water depth both for regular and irregular wave trials with the same t or t p 1 48s the reflection is always larger than 50 and increases with relative wave height fig 6 shows the relation between k r and wave steepness h s l ratio between wave height and wave length for all wave trials in total the reflection increases with the wave steepness besides for different water depths the larger water depth can carry out the bigger reflection except for the wave reflection mentioned above the wave transmission also plays an important role and wave height attenuation coefficient k t is usually adopted as significant indices to evaluate the efficiency of wave transmission waves are used to be characterized by the significant wave height h s however other definitions of wave height such as the maximum wave height h max or the average of the highest specified percentage of the waves e g h 4 h 1 100 may be used in this section the significant wave height is adopted as the characterized wave height and wave transmission coefficient k t is calculated as the ratio between the significant wave height behind the structure and the incident wave height k t is plotted in fig 7 against the wave steepness it can be noted that k t is very small ranging between 20 and 40 and it varies slightly along the flume from wg6 to wg9 for different wave trials k t decreases with the increasing wave steepness which is relatively opposite to the wave reflection illustrated above when intensified under severe weather conditions and by extreme geophysical forces such as hurricanes and earthquakes the wave heights increase and can overtop the decks of marine structures the resulting breaking waves may generate the so called green water phenomenon song et al 2015 in this section the green water height is defined as the difference between wave crest elevation and deck elevation similarly the green water height is characterized by the significant green water height as well fig 8 shows the green water height of front edge and back edge of the hybrid structure the positive value represents that the wave crest is higher than the deck and vice versa from the figure point of view green water height is large at front edge which is due to the large wave overtopping induced by violent wave attacking on the pile breakwater the back edge is not influenced by wave overtopping and the green water height here is negative for all trials the green water height is ranging between 0 25 m and 0 25 m and it depends significantly on water depth and wave height the larger water depth and wave height can bring out larger green water high and increasing the elevation of deck can decrease the green water height effectively 3 2 scour characteristics 3 2 1 change of the bed profile under wave action in general the toe of marine structures plays an crucial role in the steady and safety of the whole marine structure scour in the vicinity of structural toe is the main cause for the marine structures failure in the past decades breakwater failures due to scour have been reported by oumeraci 1994 and oumeraci 1995 at the same time scour at marine structures has been studied fairly extensively including not only the traditional rubble mound breakwater and vertical breakwater sumer et al 2005 tahersima et al 2011 but also the new structural forms such as pile breakwater submerged reef and so on faraci et al 2014 faraci 2018 aminia and solaimani 2017 qi et al 2018 in this study a pile breakwater is connected with a pile supported wharf forming a hybrid structure as seen in fig 2 due to the resistance against incident wave of pile breakwater the wave dynamic will be strengthened before the hybrid structure in such way the seabed around the hybrid structure will be effected significantly the final scour profiles are shown in fig 9 under different wave trials the original seabed is consisted of two parts i e a 1 10 slope followed by a 1 20 slope as shown in fig 1 which reproduced using the pulverized coal according to the similarity scale of wave height for sediment incipient motion the figure shows that after wave action the bed ranging between 50 m and 51 3 m is deposited and that between 51 3 m and 54 7 m is scoured due to the violent interaction between wave and pile breakwater scour in the vicinity of pile breakwater is heavy in total two slopes before pile breakwater are scoured becoming into flat and the toe of pile breakwater is eroded significantly causing such a large elevation difference at the pile breakwater and forming a scarp behind the pile breakwater in order to decrease the scour at the hybrid structure 0 0111 0 0185 kg rubble is set up on the bed before the pile breakwater toe with the cover range of 0 33 m long and 0 067 m depth fig 10 shows the scour profiles after covering rubble under the same wave conditions it can be easily noted that the covering layer of rubble significantly decreases the scour around the hybrid structure as a whole the scour pattern with covering layer is similar to that without covering layer in which the 1 10 slope is mainly deposited and the 1 20 slope is mainly scour however compared with the bed without covering layer the bed with covering layer has a smaller scour range and there is a sand bar forming after the scour hole which is agree well with xu et al 2019 3 2 2 effects of wave height and water depth on the characteristics of scour and deposit through the comparison between the original bed profiles and that after wave action several parameters are further considered including the ratio between maximum scour depth and maximum deposition height d s d d and the ratio between maximum scour area and maximum deposition area a s a d fig 11 shows the relation between d s d d and relative wave height h s d ratio between wave height and water depth as expected compared with the bed without cover layer d s d d is smaller when the bed is protected by rubble covering it can be seen that both the d s d d under two conditions increase with h s d this result reveals that the bigger wave height and smaller water depth can cause more violent sediment motion fig 12 plots a s a d against wave steepness h s l from the figure point of view when the bed is protected by cover layer a s a d is much smaller and keeps constant influenced slightly by h s l however when the bed is without cover layer with the increasing h s l a s a d firstly decreases and then increases it may be concluded from the results in this section that i both wave height and water depth have effect on bed scour and deposit and ii there may be large relative distinguish between d s d d and a s a d which makes them not good to be adopted at the same time 3 3 wave pressures 3 3 1 time series of pressures at different parts due to the complication of the hybrid structure in this study different parts are suffered from different wave impact which cause the significant different spatial distribution of wave dynamic pressures in the model test all pressure sensors are synchronized to allow a more accurate relation between the wave pressures measured in different parts as for an example a time series of pressure about 3s is shown in fig 13 for regular wave trial x7 considering the limitation of article space only pressure series of ps4 ps6 ps9 ps10 ps15 and ps21 are presented as can be seen in the figure time series of pressure measured in different parts shows a identical period however the value of maximum pressure at different parts is obviously different fig 13 a shows a typical dynamic impact pressure wave impact with a relative large pressure in a short duration followed by a distinctly separated quasi static pressure wave impact with a relative small pressure in a long duration at ps9 this phenomenon can be also observed on a vertical wall with an overhanging horizontal cantilever slab as well as a vertical wall with recurved parapet kisacik et al 2012b castellino et al 2018 martinelli et al 2018 according to previous researches when the vertical wall is equipped with overhanging horizontal component the connected corner can easily concentrate the wave energy and trap the air during the wave attacking process inducing the significant impact pressure fig 13 b and 13 c present a large pressure in a relative long duration at ps6 and ps4 which can be adopted as quasi static pressure compared with the impact pressure quasi static pressure occurs much more commonly and has been analyzed in a long time for a long time it has been reached a consensus that impact pressure has no significant effect on the coastal structure due to its higher frequency than the nature frequency of structure nevertheless with the increasing destroy of built marine structure which is designed only considering the quasi static pressure researchers found that impact pressure can not be ignored as always in recent decades many researches have payed more attention to the influence of impact pressure on the coastal and oceanic structure marzeddu et al 2013 chen et al 2019 ghadirian and bredmose 2019 compared with the large wave pressures measured at ps9 ps6 and ps4 fig 13 d and 13 e present a smaller wave pressures at ps10 and ps15 and fig 13 f just shows a slight oscillation of wave pressure at ps21 on one hand the obvious difference of wave pressures between ps9 ps6 ps4 and ps10 ps15 ps21 indicates the spatial distribution characteristic of pressures on the other hand the smaller pressure reveals the ability of pile breakwater and beams to decrease the wave attacking based on these observation the relationship between wave height water depth and wave induced loads are discussed further in the following sections from horizontal and vertical point of view respectively 3 3 2 horizontal wave pressures on the pile breakwater similar to wave height and green water height depicted above the wave induced pressure acting on the hybrid structure can be analyzed by using different definitions for a characteristic wave pressure several characteristic pressures have been considered previously for example kisacik et al 2012b and ravindar et al 2017 considered a characteristic p max the maximum of all pressures meanwhile the significant pressure p 13 may also be important for resisting high probability loads and other definitions may be considered based on a structure s importance or use park et al 2017 analyzed the p mean p 1 3 p 1 10 p 1 50 p 1 100 p 1 250 and p max at the same time representing the mean significant average of the highest 10 2 1 0 4 and maximum pressure respectively in this study p max p 1 p 4 p 13 p mean are calculated and analyzed at the same time for each of the wave trials in the horizontal and vertical directions fig 14 shows the p max of ps5 ps26 and ps27 for all wave trials the locations of those three pressure sensors can be seen in fig 2 due to the elevation of three pressure sensors is almost equal to the water surface elevation of x8 and x11 those three pressure sensors are directly suffered from wave impact during x8 and x11 inducing much larger pressure values compared to other wave trials besides for all wave trials it can be noted that p max of ps5 is smaller than that of ps26 and ps27 this result is not well agreed with that of ghadirian and bredmose 2019 who pointed out that the wave pressure decreased with the increased azimuth theoretically the difference between such two results is due to different structural forms considered in each study compared with the single pile analyzed in the research of ghadirian and bredmose 2019 pile breakwater in this study is equipped with the ribbed plates to block off the interval between piles thus unlike wave can diffract through the single pile causing a smaller wave pressure at the location of bigger azimuth the existing ribbed plates strengthens the block to wave besides the connected locations between piles and plates can more easily trap the air during the wave attack where inducing a more violent wave impact pressure fig 15 shows the time series of pressure on ps5 ps26 and ps27 for x11 wave trial in the figure compared with the relative small pressure at ps5 ps26 and ps27 present the much more obvious wave impact and appear the larger pressure values fig 16 presents the distribution of wave pressures along the pile breakwater for the irregular wave trial x8 in the figure p max p 1 p 4 p 13 and p mean are plotted together as for p max p 1 the locations of maximum pressure are about 0 88 m however as for p 4 p 13 and p mean locations of maximum pressure change from 0 88 m to 0 62 m the different distributions of pressure occur when using different characteristic pressures thus in order to better understand the wave impact on coastal structure both p max and other characteristic pressures should be analyzed at the same time fig 17 a presents the pressure distributions under 4 irregular wave trials x1 x4 x8 x11 as can be seen in the figure both values and locations of maximum pressure are different for 4 trials x8 and x11 show a larger value and lower site than x1 and x4 those distinguish observed are the results of different water depths according to table water depth of x1 and x4 are larger than that of x8 and x11 as illustrated in section bigger water depth carries out larger wave overtopping inducing a number of dissipation of wave energy as a result the wave impact on the pile breakwater is decreased in order to strengthen the acknowledge on pressure distribution fig 17 b shows the normalized pressure distribution in the figure y is normalized by the water depth d and significant wave pressure p 13 is normalized by ρ g h s in which ρ is the water density and g is the gravity acceleration the black horizontal line at the center marks the position of swl from the figure point of view it is expect to found that the values of maximum p 13 ρ g h s for x8 and x11 are still larger than that for x1 and x4 besides the location of maximum p 13 ρ g h s for 4 trials are similar to each other and near the swl which is agreed with previous researches such as kirkgöz 1982 allsop et al 1996 cuomo et al 2010a and marzeddu et al 2017 further observing it can also note that when the wave steepness decreases the location of maximum p 13 ρ g h s shifts from below the swl to above the swl defining the pressure profile is one of the critical points to consider for structural designers and it may be concluded from the results above that i adopting different characteristic wave pressures can attain different pressure distributions and ii it is reasonable to taking the location of swl as the position of maximum pressure but it should bear in mind that the maximum pressure position may be effected by the wave breaker types as well as the wave steepness to some extent 3 3 3 pressures on pile supported wharf while above illustrates the wave impact on pile breakwater the pressures of pile supported wharf also play a important role on the safety and steady of the whole hybrid structure only dynamic pressure is being considered here fig 18 shows the horizontal pressures acting on other positions such as pile foundation and berthing member to better compare the pressure of pile breakwater and that of other positions the ratio between pressures of other positions and pressure of ps4 located on pile breakwater is plotted in fig 18 in the figure abscissa is wave steepness h s l and ordinate is p 13 i p 13 4 in which the subscript 4 presents ps4 and i presents other pressure sensors i e from ps10 to ps14 it is expected that pressures on pile foundation and other positions are smaller than that of pile breakwater p 13 i p 13 4 is small and almost ranging between 2 and 40 with the increasing h s l p 13 i p 13 4 presents a increasing trend generally these results can be adopted as scientific reference in the future preliminary design of the pile foundation behind the protection of pile breakwater generally marine structure is suffered from both horizontal and vertical wave impact in this study when the pile foundation is acted by the horizontal pressure the superstructure of pile supported wharf is mainly impacted by uplift pressure therefore a representative pressure p max is normalized by the ρ g h s where ρ is the water density g is the gravity acceleration and h s is the incident significant wave height fig 19 depicts these normalized pressures plotted against clearance height c normalized by the water depth c d for all wave trials in the figure normalized wave pressures on different parts are presented such as pile cap transverse beam longitudinal beam and the deck it can be found that the normalized vertical pressure shows a firstly increasing and then decreasing trend with increasing clearance height with the largest normalized pressure for each part occurring near the water level c d 0 such findings are in agreement with that in wharf chen et al 2016 elevated coastal structure park et al 2017 and vertical wall with an overhanging horizontal cantilever slab kisacik et al 2014 these results are important for marine structure designer vertical wave impact will not always decrease with the increasing clearance height and when the structure or part is located at the still water level the uplifted pressure can be strengthened heavily a submerged structure or part will suffered from smaller vertical wave impact however it can be also found that the vertical wave induced pressure can be decreased to zero if the clearance height is large enough 3 4 wave forces both total forces and local pressures are measured for all trials integrating the pressures as integrated force horizontally and vertically as an example fig 20 shows the time series of measured horizontal force and integrated horizontal force for the regular wave trial x7 in the figure measured force is smaller than integrated force during all the time series the period of measured force is larger than that of integrated force as illustrated in humar 2002 wave loads can be divided into three domains according to the duration of impacts acting on structure such as impulsive dynamical and quasi static impacts the duration is regarded relative to the natural frequency of the structure during impulsive domain the subjected load is over well before the structure reaches its maximum deflection and therefore the actual reacted load will be smaller than the measured ones in this study impulsive impact is observed as seen in fig 13 a thus the actually reacted force i e measured force induced by the dynamic response of the hybrid structure is smaller than the integrated force which is attained by integrating the pressures of sensors fig 21 plots the measured force f 1 m and integrated force f 1 i together for all wave trials the subscript m and i represent measured and integrated values and 1 represents the average of the highest 1 maximum value the black slant line presents the function of y 2 x it can be found that all data points are almost on such line that f 1 m is twice of f 1 i this ratio between measured and integrated force is not constant and may be influenced by the wave conditions structure forms as well as sample frequency of devices up to now the dynamic response of coastal structure under wave impact has been examined experimentally numerically and theoretically tanrikulu et al 2002 chen et al 2019 however this is still difficulty in the handling of impact pressure measured as well as the scale effect between the prototypes and models thus more efforts still need to made in the future furthermore fig 22 shows the horizontal and vertical measured forces for x1 x4 x8 and x11 in fig 22 a with the increasing hs d both horizontal and vertical forces decrease such phenomenon is the result of large wave height inducing significant wave overtopping on one hand wave overtopping produces the energy dissipation which reduces the horizontal wave impact on structure on the other hand the water body of wave overtopping strikes directly on the deck and cause the downward force which counteracts the vertical force to some extend the variation of horizontal and vertical forces with increasing hs d also cause the variation of the ratio between horizontal and vertical forces as was expected f 1 h f 1 v shows a increased trend with increasing hs d as seen in fig 22 b which has a agreement with the research of park et al 2017 4 conclusion a hybrid structure which is a pile breakwater connecting to a pile supported wharf is tested on a two dimensional flume under loading conditions of regular and irregular wave impacts the tests are carried out in a small scale test set up with a scale factor of 1 30 and wave characteristic scour characteristic local wave pressure and measured force are investigated together when the hybrid structure under the wave action a significant wave reflection can be observed due to the existing pile breakwater wave reflection is influenced by wave conditions and increases with increased relative wave height and wave steepness it corresponds to strong reflection that the wave transmission is small ranging between 20 and 40 and decreases with increasing wave steepness besides due to the violent wave structure interaction wave overtopping is observed especially for large wave height and induces the larger green water height i e wave overtopping height water depth and wave height have a obvious effect on green water height and increasing the elevation of deck can decrease the green water height effectively scour characteristics of two bed profiles are considered without covering layer and with rubble covering layer for both profiles the change pattern under wave action is similar in which the toe of slope is deposited and the position of structure is scoured significantly compared with bed profile without covering layer the bed profile with rubble covering layer has a smaller scour range and forms a sand bar after the scour hole both wave height and water depth have effect on bed scour and deposit the bigger wave height and smaller water depth can cause more violent sediment motion and larger scour depth due to the complication of the hybrid structure there is obvious spatial distributions characteristic between pressures of different parts various wave loads can be observed such as impulsive dynamical and quasi static wave pressure compared with the conventional pile breakwater the pile breakwater with plates between intervals of piles can easily concentrate the wave energy and trap the air during wave impact and inducing the obvious impact pressure near the connected corner between piles and plates wave distribution of pile breakwater is influenced by both characteristic pressure used and wave conditions with the decreasing wave steepness the location of maximum pressure shifts from below the still water level to above the still water level compared with the large pressure on pile breakwater horizontal pressure of other positions have a smaller value ranging between 2 and 40 of pressure on pile breakwater and increase with increasing wave steepness besides superstructure of pile supported wharf is mainly effected by uplift load pressures on the superstructure can change depending on the structure s clearance height c i e the difference between structure and water elevation and water depth d it can be found that with the increasing c d vertical pressure on superstructure increases firstly and then decreases and reaches the maximum at c d 0 both force and pressure are measured and integrating the pressures as integrated force comparing the integrated force and measured force it can be noted that measured force has a smaller value and larger period because of the dynamic response of the hybrid structure for all wave trials integrated horizontal forces are about twice measured horizontal force with the increasing relative wave height h s d both horizontal and vertical measured force decrease and the ratio between horizontal and vertical measured force increases the current paper introduces a hybrid structure i e a pile breakwater connected with a pile supported wharf and investigates the wave scour and load characteristic all the results are based on the analysis of experimental data and limited by the range of the model test the findings here may be used by oceanic planners numerical modelers and engineers for future research and predesign credit authorship contribution statement jianjun huang conceptualization methodology formal analysis data curation writing original draft guoping chen resources writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
22018,shape sensing can provide insight into the structural health and operating conditions of slender engineered lifting and control surfaces in aerospace and maritime applications shape sensing often relies upon digital image correlation inertial measurement or inverse finite element methods which can be impractical in applications involving real time reconstructions static and dynamic deformations or dynamic mode shape identification especially outside of controlled laboratory environments this work describes ongoing efforts to design build and validate a low cost and robust tool for real time shape sensing the sensor consists of a simple aluminum spar instrumented with strategically placed strain gauges a kinematic model is used to reconstruct bi axial bending and torsional displacements along the spar the model is validated against fem simulations and canonical analytical solutions a prototype of the spar is benchmarked using a motion capture system the pre calibrated errors are correlated with the direction of bending permitting a directionally compensative calibration scheme after calibration of the spar and kinematic model validation errors are 2 18 in bending magnitude and 0 97 in bending direction this work addresses the emerging need for new low cost sensors for structural health monitoring in environments where other sensing methods do not perform well keywords shape sensing strain gauge fluid structure interactions fsi kinematic model 1 introduction shape sensing refers to methods for inferring the deflections of flexible bodies these deflections give important insight into the structural health and operating conditions of slender engineered lifting surfaces in aerospace and maritime application where fluid loads are high and structural responses are impactful upon both the safety and the efficiency of those systems operation shape sensors have been applied to a variety of measurement tasks including in situ loaded deflection monitoring and normal mode shape reconstruction by harwood et al 2019 2020 and the inverse modeling of loading conditions by harwood et al 2017 ward et al 2018 and young et al 2018 fluid structure interaction fsi describes the coupling of a structure s motions with the fluid dynamic forces on that structure fsi in dense viscous fluids known as hydroelasticity is filled with rich physics that affect marine propulsion systems biological flows and energy harvesting as well as other disciplines relative to fsi in lighter fluids and gases hydroelastic interactions are highly nonlinear and the frequency domain approaches devised for aeroelastic systems are either extremely unconservative or completely unable to predict instabilities abramson and ransleben 1965 robust adaptive control offers a path toward improving the safety and efficiency in such hydroelastic systems however control strategies necessitate accurate models which in turn require suitable sensing capabilities to ensure observability of the system to be controlled moreover an in depth understanding of fsi physics enables designers to better cope with hydroelasticity or to harness fsi responses for improved performance of compliant marine systems numerical predictions look to couple computational fluid dynamics cfd and finite element models fem to capture complex hydroelastic interactions these models require accurate resolution of energy transport transfer storage and dissipation mechanisms physical insights that are currently lacking experimental measurements which seek to characterize the effects of fluid flows on the dynamics of a structure are sparse and exhibit high uncertainties this is due in part to the non linear nature of fluid forces and in part to the lack of established experimental methods both for the acquisition and interpretation of data compounding the difficulty of experiments accurate measurements are often difficult to obtain because of undesirable flow conditions such as multiphase corrosive or opaque flows conditions that are especially pervasive outside of well controlled lab environments shape sensing can produce detailed experimental records of structural motions in situ improving the ability of researchers to investigate fsi both inside and outside of the lab shape sensing is usually achieved using digital image correlation inertial measurements or strain based methods which are briefly reviewed in the following paragraphs a more detailed review of the state of the art can be found in di napoli et al 2019 inertial methods accelerometry being most common capture the dynamic motions of a structure and through time integration or the assumption of harmonic motion produce estimated velocities and positions ortel et al 2013 the most common application is experimental modal analysis where the band limited nature of inertial measurements is easily accounted for this method provides accurate results for dynamic systems however accelerometers and gyroscopes are second order sensors which limits their useful frequency range inertial reconstruction also suffers from significant drift in the integrated kinematic quantities especially when motions are not harmonic digital image correlation dic is a photogrammetric method wherein high resolution imaging is used to estimate the deflections of a structure relative to its undeformed condition savio 2015 randomized high contrast speckle patterns visible to several cameras are mapped into deformation fields by cross correlation this method also produces accurate results but it is reliant on the surrounding environment a steady field of view with uninterrupted optical access is imperative to the success of optical reconstruction also external mounting of cameras introduces concerns of corrosion and fouling due to the environment making photogrammetry most effective in laboratory settings another approach to shape sensing uses discrete measurements of strain on an object which are processed using one of several modeling approaches to produce structural deformations the inverse finite element method ifem is one such model used to reconstruct a displacement field gherlone et al 2014 kefal and oterkus 2017 tessler and spangler 2005 often with startling fidelity the ifem process however first requires a suitable finite element model of the structure in question it follows that a new model and mesh including detailed structural and material properties must be generated and validated for each structure to be tested also accurate solutions are dependent on the mesh size which implies that more computation time is needed for accurate reconstruction these considerations suggest that ifem while invaluable for the measurement of complex well characterized structures is not ideal for real time reconstruction of deflections on objects that do not have pre existing fe models kinematic modeling is a lower cost alternative to ifem a kinematic model uses strain deflection relationships to reconstruct the shape of a deflected object without invoking any of the material properties of the structure this makes kinematic models useful in cases where the details of the measured structure are unknown moreover kinematic models are typically orders of magnitude less computationally expensive than ifem which makes them suitable for the real time reconstruction of deflections di napoli et al 2019 used one such kinematic model involving curve fitting and integration of the strain distributions along a pair of one dimensional beams by reconstructing the deflections along the lengths of two non collinear beams the bending and twisting deflections of a flexible hydrofoil were measured with accuracies on par with camera based methods however the kinematic model was limited to small relative deformations 10 of the span beyond which the measurement error increased substantially moreover the spar was limited to one dimensional bending so the system was unable to measure lead lag bending deformations and two independently calibrated spars were needed to measure torsion the work presented here describes ongoing efforts to design build and validate a low cost and robust tool for accurate shape sensing in real time the tool consists of a spar with a simple geometry which is instrumented with strategically placed strain gauges a kinematic model similar to the one used by di napoli et al 2019 is used to infer bi axial bending and torsional displacements with large amplitudes along the spar one or more spars may be affixed to or inserted into a parent structure with a more complex geometry enabling measurement of the 3d deformations of the parent structure 1 1 objectives and overview the overall aim of this work is to develop a robust easily deployed and low cost shape sensor that improves upon the state of the art solutions for structural health monitoring and on line measurement of compliant lifting surfaces to this end this paper will address the following three sub objectives a develop a robust and computationally inexpensive kinematic model for both bending and torsion b validate the kinematic model using finite element method fem simulations and c construct and benchmark a physical prototype of a shape sensing spar undergoing static deformations in flexure torsion to be address in future work this work will describe the design of the physical spar and show the development of an enhanced kinematic reconstruction algorithm which is validated using synthetic data from finite element simulations fem simulations and the kinematic model are also used to inform the placement of strain gauges on the spar the physical prototype of the spar will be described and benchmarked against static reference measurements from a commercially available motion capture system this work will contribute to the emerging need for new low cost sensors for measuring fluid structure interactions in harsh or extreme environments where other sensing methods may not perform well 2 kinematic model and physical spar design 2 1 spar design the physical spar is a circular rod with a length of 1 m and a nominal diameter 2 r c of 3 8 in 9 5 mm 6061 aluminum alloy was selected because it is lightweight easily machined and the resulting rod is very compliant a circular cross section benefits from a simple relationship between shear strain and torsion angle but makes it difficult to ensure that the torsion of the spar tracks that of the parent structure this issue is addressed by the addition of keyways to the spar which were machined along the entire length of the rod the implementation of keyways alters the relationship between the shear strain and the torsion angle however this is countered by the implementation of a linear shape factor to the shear displacement equation fig 1 shows the modeled cross section of the spar and the angular locations of the strain gauges note that the while all the strain gauges are shown in fig 1 they are not necessarily placed at the same span wise locations in each of the two bending directions the respective strain gauges omega sgd 3 350 ly13 are affixed to opposite sides of the spar and wired in half bridge configurations the two bending pairs are separated by a 90 degree angle shear strains are measured using omega sgt 2dd 350 sy13 gauges affixed 90 from the keyway the shear strain gauges include four grids on a single carrier wired in a full bridge configuration strain gauges were bonded to the spar with cyanoacrylate glue the quantities and locations of each type of gauge are described in section 2 4 2 2 kinematic model the kinematic model allows deflections to be reconstructed from measurements of strain only without the need to know the detailed geometry or material properties of the specimen three coordinate systems are defined a global cartesian coordinate system x y z a spar aligned local cartesian coordinate system x y z and a bending plane coordinate system s n t coordinate system x y z is defined with its origin at the root of the spar the x axis points toward a keyway the z axis points along the length of the undeformed spar and the y axis follows the right hand convention the x y z coordinates are defined with x and y passing through perpendicular bending gauges see fig 1 and z is tangent to the elastic axis of the spar coordinate system s n t is a rotation of coordinate system x y z with n defined positive toward the direction of curvature s is coincident with z and t is defined using the right hand convention the input for the kinematic model is a vector of 2 p bending strain measurements p measurements taken from each of the two orthogonal half bridge arrays along with l shear strain measurements independent p 1 degree polynomial interpolants are fitted to the measured bending strains in each of the two x y bending directions the spar is discretized into m segments each with length δ s and the polynomial interpolants are evaluated at the m 1 node locations to yield vectors ε x and ε y at each segment node the interpolated strains are transformed into polar coordinates expressed in terms of the resultant bending strains ε n and local curvature directions α 1 ε n i ε x i 2 ε y i 2 2 α i a r c t a n ε y i ε x i deformation reconstruction proceeds in two steps the bending strain measurements are used to calculate the bending deformation for each segment as well as the orientation of each respective local bending plane the combined effects of spar torsion and changing α i are then superimposed to calculate the reorientation of the global bending direction fig 2 shows the discretized progression of two segments with their respective s n t coordinate systems used to calculate local in plane bending where e ˆ represents a unit vector in the subscripted direction at each node the bending strain used to find the local radius of curvature 1 k using linearized beam theory given by equations 3 and 4 3 ε n i r c k i 4 k β s with sufficiently fine discretization each segment can be approximated by an arc of length 5 δ s l m where l is the total spar length the radius of curvature is used to find the local arc angle β using 6 β i δ s k i this local arc angle is then used to find the coordinates of the i 1 point in the i th s n t coordinate system using equations 7 and 8 7 s i s i n β i k i 8 n i 1 c o s β i k i using fig 2 the following rotation matrix may be used to express the orientation of the i th s n t coordinate system in the i 1 s n t coordinate system 9 e ˆ n i 1 1 e ˆ s i 1 c o s β i 1 s i n β i 1 0 0 0 1 s i n β i 1 c o s β i 1 0 e ˆ n i 1 e ˆ s i fig 3 shows a cross section of the spar with the x y z and s n t coordinate systems shown axes s and z are pointing out of the page the direction of principal strain which defines the s n planes in which bending is resolved for each segment changes along the length of the spar as a result of both torsion of the spar and changes in the direction of the resultant bending strain torsion is accounted for using the shear strain gauges and using the linear relationship between the shear strain ε s θ and the twist rate δ θ given in equation 10 10 δ θ i ε s θ i r c δ s θ represents the rigid body rotation of both the x y z and the s n t coordinate systems a change in the direction of the principal bending strain is represented by d α i where α i represents the rotation of the t n axes relative to the x y axes the local bending plane is then rotated by an angle taken to be the sum of the two components 11 φ i θ i d α i similar to bending the i t h s n t coordinates are expressed in the i 1 s n t coordinate system using equation 12 12 e ˆ n i 1 e ˆ t i 1 1 c o s φ i s i n φ i 0 s i n φ i c o s φ i 0 0 0 1 e ˆ n i e ˆ t i 1 combining the torsion and the bending components the i t h s n t coordinate system can be expressed in the i 1 s n t coordinate system using the following rotation matrix 13 r i 1 i c o s φ i s i n φ i 0 s i n φ i c o s φ i 0 0 0 1 c o s β i 1 s i n β i 1 0 0 0 1 s i n β i 1 c o s β i 1 0 by pre multiplying all rotation matrices up to and including r i 1 i the i t h node fixed coordinate system can be expressed in the global cartesian coordinate system thus reconstruction is performed by marching along the length of the spar transforming local coordinates into global coordinates and using a forward euler integration the complete local coordinate system rotation with forward euler integration becomes 14 x i e ˆ x y i e ˆ y z i e ˆ z c o s γ s i n γ 0 s i n γ c o s γ 0 0 0 1 m 1 i r m 1 m n i e ˆ n i t i e ˆ t i s i e ˆ s i n 1 i 1 x n e ˆ x y n e ˆ y z n e ˆ z note that γ is included as a rigid body rotation at the root used to transform the coordinate system from s n t to x y z 2 3 fem model to assist in design decisions and to perform a synthetic benchmarking of the kinematic model fem simulations of the spar were performed all fem simulations were performed in calculix using a non linear solver in order to support cases with large deformations dhondt 2017 the model was composed of 36 000 hexahedron type elements as shown in fig 4 in all simulated cases the spar was cantilevered with nodes at the clamped end constrained in all degrees of freedom numerical probes were used as virtual strain gauges values from which were provided as inputs to the kinematic model 2 4 sensor placement the kinematic model is sensitive to the number of sensors and sensor placement due to the least squares curve fitting scheme the effects of sensor placement and quantity were investigated using fem by simulating a single case with static deformation in response to a point load applied at the free tip bending reconstruction was performed using 18 different quantities and placements of the probes the bending strain gauge distribution schemes investigated were linear selected for simplicity and ease of application half cosine selected to concentrate measurements near the static end of the cantilevered beam and half chebyshev root spacing selected to compliment the polynomial fitting scheme by improving interpolant stability the unitless sobolev norm shown in equation 15 was used to quantify the error between the fem results and the reconstructed deformations v r represents the reconstructed data and v s represents the simulated data the resulting error ranges from zero to one where an error of zero means the data are perfectly similar and one means the data are completely independent 15 e r r o r v r v s v r v s fig 5 shows the results from the sensor placement investigation a half cosine spacing with four bending strain locations was selected based both upon these results and upon the desire to minimize measurement channels the number of physical channels needed would be 2 p l 2 p channels for two normal bending directions and l channels for torsion measurement a total of twelve channels were available which restricts the number of gauges to eight bending strain gauges four for each direction and four shear strain gauges within this limitation the half cosine spacing offers the lowest error at least for cases with simple loading torsion and shear strain are related by a first order equation so a piecewise linear interpolant was selected for shear strain and the shear strain gauges were uniformly distributed along the length of the spar the final gauge locations are shown in fig 6 3 fem and analytical validation the performance of the kinematic model separate from the strain measurements themselves was assessed using synthetic data from fem simulations as before discrete strain measurements were sampled from the strain field data at locations corresponding to the physical strain gauges and used as inputs to the kinematic model the resulting bending and twisting deflections were compared to the simulated results a range of loading conditions were evaluated including point forces opposing forces and distributed forces both with and without point or distributed twisting moments table 1 shows the results from the fem validation for all loading conditions all of which demonstrate good agreement the largest dimensionless torsion error occurs for the case with distributed force and moment however the dimensional error in this case was only about one tenth of a degree the largest dimensionless bending error occurs for the case with opposing point forces one at the middle of the spar and one at the free tip the elevated error is a result of the least squares curve fit the actual bending strain distribution had a higher order than the third order polynomial used as an interpolant the interpolation error thus propagates into a higher bending error fig 7 shows an example of the good agreement between the reconstructed and simulated results for the case with combined bending and twisting concentrated at the free tip case 3 the kinematic model was also validated using known analytical strain distributions for canonical deformations two analytical cases were selected bending into a closed circle given a constant strain equal to the spar radius divided by the desired radius of the circle and the reconstruction of a helical spiral given by a constant bending strain and a constant shear strain similar to the fem validation discrete strain values were taken from the analytical strain field and used as inputs for the reconstruction model while the results are omitted here for the sake of brevity the kinematic model produced the theoretical shapes exactly in both cases both synthetic and analytical benchmarking demonstrated that the kinematic model was able to reconstruct arbitrarily large deformations accurately 4 experimental benchmarking 4 1 experimental setup the physical shape sensing spar was benchmarked using the vicon tracker 3 motion capture system vicon 2015 steady state bending data were simultaneously captured from the strain gauges and the motion capture system four tracking locations were established along the spar s length shown in fig 8 the fifth set of markers closest to the root was omitted because the relative deflections at that location were too small for the motion capture system to produce reliable data at each location a 3d printed block was affixed with reflective markers visible in fig 7a which were used to construct a local plane co planar with the x y and n t planes defined in section 2 2 the translations and rotations of each plane were reconstructed in post processing using the unloaded state as the undeformed condition point loads were applied to the tip of the spar the loads were applied at directions α t i p varying from 0 to 315 with respect to the global x axis which was taken to be aligned with a keyway as shown in fig 7b note that this definition of a global coordinate system corresponds to a rigid body rotation of γ 45 in equation 14 a total of 80 trials were conducted with a zero load reference recorded immediately before each trial 4 2 pre calibrated results fig 9 shows the bending magnitudes for the first 40 test cases with the bending directions α t i p indicated by line color all data are normalized by the displacement magnitude of the vicon measurement location a nearest the free tip denoted δ a this figure shows that there is significant variability in the strain gauge data relative to the motion capture data on the other hand when normalized by the maximum deflection reconstructed from strain gauge data the variance in the motion capture data becomes large while the strain gauge deformations collapse together to describe a common shape function based on the maturity of the system we chose the motion capture data as the more reliable of the two but a third measurement method should be included in future work fig 10 shows the comparisons of the strain gauge reconstruction versus the vicon measurements at the four vicon measurement locations a c for each bending direction the deflection patterns for the vicon and reconstructed measurements are in qualitative agreement however there is visible error in both the magnitude and the direction of the reconstructed measurements in most cases the strain gauge reconstruction under predicts the deflection magnitude and the directional error tends to be biased clockwise both figs 9 and 10 imply that the bending errors both in magnitude and direction are correlated with the bending direction α t i p 4 3 spar calibration figs 11 and 12 illustrate the effect of bending direction on the relative bending magnitude and direction error respectively at each measurement location the patterns in the measurement errors suggest a correlation with the bending direction the errors were fit using a three term sine series for each shown in equations 16 and 17 16 e m α s g i 0 3 a i sin b i α s g c i 17 e d α s g i 0 3 a i sin b i α s g c i regressions produced r 2 values of greater than 0 95 implying strong correlation between the bending magnitude errors and the bending direction the fitted errors in equations 16 and 17 were used to implement a directionally compensative calibration scheme at each of the four vicon measurement locations the bending direction and magnitude were estimated and a linear interpolation was used for points located between these locations the percentage error correctors e m and e d are then cast into a multiplicative gain which is applied to the raw data 4 4 calibration benchmarking the directionally compensative calibration was developed using a training data set of 40 different static loading conditions to fit error terms a second independent validation data set of 40 loading conditions was used to assess the calibration error fig 13 shows the normalized deflections of both the vicon and the calibrated shape sensing spar results the deflections still show some variability with direction but it is much reduced relative to fig 8 the calibrated data show variability similar to that of the vicon data fig 14 shows the complete results of the calibrated trials again presented as polar plots at the four vicon measurement locations the calibrated results shown in green exhibit much lower errors in bending 2 18 and in direction 0 97 for the bending range of zero to 220 mm the calibration scheme is shown to correct both the magnitude error and the directional error to produce extremely accurate measurements of bending deflections along the length of the spar without any external reference data 5 discussion the preliminary static test results show an average bending error of about 8 4 before any calibration that bending magnitude error is highly correlated with the bending direction at the spar s free tip the highest errors were observed at 90 from the keyway and the lowest errors were observed in the direction of the keyways the exact opposite was observed near the spar s root these error were used to inform a directionally compensative calibration scheme which was evaluated using an independent dataset the calibration was shown to correct both the magnitude and direction errors more significantly the corrective gains are calculated using the raw strain measurements so no external reference is required residual error may be indicative of nonlinearity introduced by the physical application of the strain gauges e g adhesion or alignment it should also be noted that the normalized vicon measurements do not all collapse in fig 13 in measurement locations d and c the strain gauge reconstruction method exhibits lower variability because locations d and c are located closer to the root the relative change in marker position at each is much smaller than at other measurement locations this implies that the precision of the motion capture system traced to camera resolution lens linearization and camera extensive properties may be insufficient to resolve small motions the shape sensing spar s performance in torsion was also intended to be evaluated however the vicon resolution proved to be too course to reliably measure the rotations of individual section planes for the same reasons described above it is likely that the motion camera system simply does not possess the precision required to benchmark the spar s performance in torsion to remedy this markers are being mounted further from the elastic axis of the spar in ongoing experiments nonetheless future work should seek to benchmark both the bending and the torsional performance of the shape sensing spar using a separate method to ensure a high quality reference for both systems 6 conclusions and future work real time shape sensing provides vital insight into the structural health and operating conditions of marine and aerospace structures although accurate state of the art methods exist they are often best suited for laboratory settings this paper outlines an approach to shape reconstruction using a kinematic model and conventional foil strain gauges intended to be used in both laboratory and field settings this work presents an accurate low cost solution for the shape sensing of lifting surfaces in complex flows a robust and computationally inexpensive kinematic model which is independent from structural properties ensures that the model may be applied to the real time deflection reconstruction of a wide range of structures the proposed kinematic model takes advantage of the kinematic relationship between strains and deflections by using a least squares curve fit through discrete span aligned bending strain gauges a local coordinate system integration approach allows the kinematic model to reconstruct both small and large deflections on a single core processor the kinematic model can run on the order of 100 s of reconstructions per second making the model suitable for on line reconstructions during experiments or operation the model also uses shear strain measurements to reconstruct torsion along the spar though torsional validation is left as a topic for future work at this point the kinematic model was validated by using discrete strain measurements sampled from fem solutions and canonical analytical solutions as inputs to reconstruct the deflections a prototype of the spar was benchmarked using an established motion capture system data show that the bending magnitude error has an average of 8 4 and a direction error of 4 before calibration the bending magnitude and direction error was found to be highly correlated to the bending direction these errors were included into a directionally compensative calibration post calibration error were found to be an average of 2 18 for bending magnitude and 0 97 for bending direction declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the author would like to thank prof venanzio cichella and the university of iowa cas laboratory for the use of their motion capture system this work was supported by the dod smart scholarship which is funded by usd r e the under secretary of defense research and engineering national defense education program ndep ba 1 basic research 
22018,shape sensing can provide insight into the structural health and operating conditions of slender engineered lifting and control surfaces in aerospace and maritime applications shape sensing often relies upon digital image correlation inertial measurement or inverse finite element methods which can be impractical in applications involving real time reconstructions static and dynamic deformations or dynamic mode shape identification especially outside of controlled laboratory environments this work describes ongoing efforts to design build and validate a low cost and robust tool for real time shape sensing the sensor consists of a simple aluminum spar instrumented with strategically placed strain gauges a kinematic model is used to reconstruct bi axial bending and torsional displacements along the spar the model is validated against fem simulations and canonical analytical solutions a prototype of the spar is benchmarked using a motion capture system the pre calibrated errors are correlated with the direction of bending permitting a directionally compensative calibration scheme after calibration of the spar and kinematic model validation errors are 2 18 in bending magnitude and 0 97 in bending direction this work addresses the emerging need for new low cost sensors for structural health monitoring in environments where other sensing methods do not perform well keywords shape sensing strain gauge fluid structure interactions fsi kinematic model 1 introduction shape sensing refers to methods for inferring the deflections of flexible bodies these deflections give important insight into the structural health and operating conditions of slender engineered lifting surfaces in aerospace and maritime application where fluid loads are high and structural responses are impactful upon both the safety and the efficiency of those systems operation shape sensors have been applied to a variety of measurement tasks including in situ loaded deflection monitoring and normal mode shape reconstruction by harwood et al 2019 2020 and the inverse modeling of loading conditions by harwood et al 2017 ward et al 2018 and young et al 2018 fluid structure interaction fsi describes the coupling of a structure s motions with the fluid dynamic forces on that structure fsi in dense viscous fluids known as hydroelasticity is filled with rich physics that affect marine propulsion systems biological flows and energy harvesting as well as other disciplines relative to fsi in lighter fluids and gases hydroelastic interactions are highly nonlinear and the frequency domain approaches devised for aeroelastic systems are either extremely unconservative or completely unable to predict instabilities abramson and ransleben 1965 robust adaptive control offers a path toward improving the safety and efficiency in such hydroelastic systems however control strategies necessitate accurate models which in turn require suitable sensing capabilities to ensure observability of the system to be controlled moreover an in depth understanding of fsi physics enables designers to better cope with hydroelasticity or to harness fsi responses for improved performance of compliant marine systems numerical predictions look to couple computational fluid dynamics cfd and finite element models fem to capture complex hydroelastic interactions these models require accurate resolution of energy transport transfer storage and dissipation mechanisms physical insights that are currently lacking experimental measurements which seek to characterize the effects of fluid flows on the dynamics of a structure are sparse and exhibit high uncertainties this is due in part to the non linear nature of fluid forces and in part to the lack of established experimental methods both for the acquisition and interpretation of data compounding the difficulty of experiments accurate measurements are often difficult to obtain because of undesirable flow conditions such as multiphase corrosive or opaque flows conditions that are especially pervasive outside of well controlled lab environments shape sensing can produce detailed experimental records of structural motions in situ improving the ability of researchers to investigate fsi both inside and outside of the lab shape sensing is usually achieved using digital image correlation inertial measurements or strain based methods which are briefly reviewed in the following paragraphs a more detailed review of the state of the art can be found in di napoli et al 2019 inertial methods accelerometry being most common capture the dynamic motions of a structure and through time integration or the assumption of harmonic motion produce estimated velocities and positions ortel et al 2013 the most common application is experimental modal analysis where the band limited nature of inertial measurements is easily accounted for this method provides accurate results for dynamic systems however accelerometers and gyroscopes are second order sensors which limits their useful frequency range inertial reconstruction also suffers from significant drift in the integrated kinematic quantities especially when motions are not harmonic digital image correlation dic is a photogrammetric method wherein high resolution imaging is used to estimate the deflections of a structure relative to its undeformed condition savio 2015 randomized high contrast speckle patterns visible to several cameras are mapped into deformation fields by cross correlation this method also produces accurate results but it is reliant on the surrounding environment a steady field of view with uninterrupted optical access is imperative to the success of optical reconstruction also external mounting of cameras introduces concerns of corrosion and fouling due to the environment making photogrammetry most effective in laboratory settings another approach to shape sensing uses discrete measurements of strain on an object which are processed using one of several modeling approaches to produce structural deformations the inverse finite element method ifem is one such model used to reconstruct a displacement field gherlone et al 2014 kefal and oterkus 2017 tessler and spangler 2005 often with startling fidelity the ifem process however first requires a suitable finite element model of the structure in question it follows that a new model and mesh including detailed structural and material properties must be generated and validated for each structure to be tested also accurate solutions are dependent on the mesh size which implies that more computation time is needed for accurate reconstruction these considerations suggest that ifem while invaluable for the measurement of complex well characterized structures is not ideal for real time reconstruction of deflections on objects that do not have pre existing fe models kinematic modeling is a lower cost alternative to ifem a kinematic model uses strain deflection relationships to reconstruct the shape of a deflected object without invoking any of the material properties of the structure this makes kinematic models useful in cases where the details of the measured structure are unknown moreover kinematic models are typically orders of magnitude less computationally expensive than ifem which makes them suitable for the real time reconstruction of deflections di napoli et al 2019 used one such kinematic model involving curve fitting and integration of the strain distributions along a pair of one dimensional beams by reconstructing the deflections along the lengths of two non collinear beams the bending and twisting deflections of a flexible hydrofoil were measured with accuracies on par with camera based methods however the kinematic model was limited to small relative deformations 10 of the span beyond which the measurement error increased substantially moreover the spar was limited to one dimensional bending so the system was unable to measure lead lag bending deformations and two independently calibrated spars were needed to measure torsion the work presented here describes ongoing efforts to design build and validate a low cost and robust tool for accurate shape sensing in real time the tool consists of a spar with a simple geometry which is instrumented with strategically placed strain gauges a kinematic model similar to the one used by di napoli et al 2019 is used to infer bi axial bending and torsional displacements with large amplitudes along the spar one or more spars may be affixed to or inserted into a parent structure with a more complex geometry enabling measurement of the 3d deformations of the parent structure 1 1 objectives and overview the overall aim of this work is to develop a robust easily deployed and low cost shape sensor that improves upon the state of the art solutions for structural health monitoring and on line measurement of compliant lifting surfaces to this end this paper will address the following three sub objectives a develop a robust and computationally inexpensive kinematic model for both bending and torsion b validate the kinematic model using finite element method fem simulations and c construct and benchmark a physical prototype of a shape sensing spar undergoing static deformations in flexure torsion to be address in future work this work will describe the design of the physical spar and show the development of an enhanced kinematic reconstruction algorithm which is validated using synthetic data from finite element simulations fem simulations and the kinematic model are also used to inform the placement of strain gauges on the spar the physical prototype of the spar will be described and benchmarked against static reference measurements from a commercially available motion capture system this work will contribute to the emerging need for new low cost sensors for measuring fluid structure interactions in harsh or extreme environments where other sensing methods may not perform well 2 kinematic model and physical spar design 2 1 spar design the physical spar is a circular rod with a length of 1 m and a nominal diameter 2 r c of 3 8 in 9 5 mm 6061 aluminum alloy was selected because it is lightweight easily machined and the resulting rod is very compliant a circular cross section benefits from a simple relationship between shear strain and torsion angle but makes it difficult to ensure that the torsion of the spar tracks that of the parent structure this issue is addressed by the addition of keyways to the spar which were machined along the entire length of the rod the implementation of keyways alters the relationship between the shear strain and the torsion angle however this is countered by the implementation of a linear shape factor to the shear displacement equation fig 1 shows the modeled cross section of the spar and the angular locations of the strain gauges note that the while all the strain gauges are shown in fig 1 they are not necessarily placed at the same span wise locations in each of the two bending directions the respective strain gauges omega sgd 3 350 ly13 are affixed to opposite sides of the spar and wired in half bridge configurations the two bending pairs are separated by a 90 degree angle shear strains are measured using omega sgt 2dd 350 sy13 gauges affixed 90 from the keyway the shear strain gauges include four grids on a single carrier wired in a full bridge configuration strain gauges were bonded to the spar with cyanoacrylate glue the quantities and locations of each type of gauge are described in section 2 4 2 2 kinematic model the kinematic model allows deflections to be reconstructed from measurements of strain only without the need to know the detailed geometry or material properties of the specimen three coordinate systems are defined a global cartesian coordinate system x y z a spar aligned local cartesian coordinate system x y z and a bending plane coordinate system s n t coordinate system x y z is defined with its origin at the root of the spar the x axis points toward a keyway the z axis points along the length of the undeformed spar and the y axis follows the right hand convention the x y z coordinates are defined with x and y passing through perpendicular bending gauges see fig 1 and z is tangent to the elastic axis of the spar coordinate system s n t is a rotation of coordinate system x y z with n defined positive toward the direction of curvature s is coincident with z and t is defined using the right hand convention the input for the kinematic model is a vector of 2 p bending strain measurements p measurements taken from each of the two orthogonal half bridge arrays along with l shear strain measurements independent p 1 degree polynomial interpolants are fitted to the measured bending strains in each of the two x y bending directions the spar is discretized into m segments each with length δ s and the polynomial interpolants are evaluated at the m 1 node locations to yield vectors ε x and ε y at each segment node the interpolated strains are transformed into polar coordinates expressed in terms of the resultant bending strains ε n and local curvature directions α 1 ε n i ε x i 2 ε y i 2 2 α i a r c t a n ε y i ε x i deformation reconstruction proceeds in two steps the bending strain measurements are used to calculate the bending deformation for each segment as well as the orientation of each respective local bending plane the combined effects of spar torsion and changing α i are then superimposed to calculate the reorientation of the global bending direction fig 2 shows the discretized progression of two segments with their respective s n t coordinate systems used to calculate local in plane bending where e ˆ represents a unit vector in the subscripted direction at each node the bending strain used to find the local radius of curvature 1 k using linearized beam theory given by equations 3 and 4 3 ε n i r c k i 4 k β s with sufficiently fine discretization each segment can be approximated by an arc of length 5 δ s l m where l is the total spar length the radius of curvature is used to find the local arc angle β using 6 β i δ s k i this local arc angle is then used to find the coordinates of the i 1 point in the i th s n t coordinate system using equations 7 and 8 7 s i s i n β i k i 8 n i 1 c o s β i k i using fig 2 the following rotation matrix may be used to express the orientation of the i th s n t coordinate system in the i 1 s n t coordinate system 9 e ˆ n i 1 1 e ˆ s i 1 c o s β i 1 s i n β i 1 0 0 0 1 s i n β i 1 c o s β i 1 0 e ˆ n i 1 e ˆ s i fig 3 shows a cross section of the spar with the x y z and s n t coordinate systems shown axes s and z are pointing out of the page the direction of principal strain which defines the s n planes in which bending is resolved for each segment changes along the length of the spar as a result of both torsion of the spar and changes in the direction of the resultant bending strain torsion is accounted for using the shear strain gauges and using the linear relationship between the shear strain ε s θ and the twist rate δ θ given in equation 10 10 δ θ i ε s θ i r c δ s θ represents the rigid body rotation of both the x y z and the s n t coordinate systems a change in the direction of the principal bending strain is represented by d α i where α i represents the rotation of the t n axes relative to the x y axes the local bending plane is then rotated by an angle taken to be the sum of the two components 11 φ i θ i d α i similar to bending the i t h s n t coordinates are expressed in the i 1 s n t coordinate system using equation 12 12 e ˆ n i 1 e ˆ t i 1 1 c o s φ i s i n φ i 0 s i n φ i c o s φ i 0 0 0 1 e ˆ n i e ˆ t i 1 combining the torsion and the bending components the i t h s n t coordinate system can be expressed in the i 1 s n t coordinate system using the following rotation matrix 13 r i 1 i c o s φ i s i n φ i 0 s i n φ i c o s φ i 0 0 0 1 c o s β i 1 s i n β i 1 0 0 0 1 s i n β i 1 c o s β i 1 0 by pre multiplying all rotation matrices up to and including r i 1 i the i t h node fixed coordinate system can be expressed in the global cartesian coordinate system thus reconstruction is performed by marching along the length of the spar transforming local coordinates into global coordinates and using a forward euler integration the complete local coordinate system rotation with forward euler integration becomes 14 x i e ˆ x y i e ˆ y z i e ˆ z c o s γ s i n γ 0 s i n γ c o s γ 0 0 0 1 m 1 i r m 1 m n i e ˆ n i t i e ˆ t i s i e ˆ s i n 1 i 1 x n e ˆ x y n e ˆ y z n e ˆ z note that γ is included as a rigid body rotation at the root used to transform the coordinate system from s n t to x y z 2 3 fem model to assist in design decisions and to perform a synthetic benchmarking of the kinematic model fem simulations of the spar were performed all fem simulations were performed in calculix using a non linear solver in order to support cases with large deformations dhondt 2017 the model was composed of 36 000 hexahedron type elements as shown in fig 4 in all simulated cases the spar was cantilevered with nodes at the clamped end constrained in all degrees of freedom numerical probes were used as virtual strain gauges values from which were provided as inputs to the kinematic model 2 4 sensor placement the kinematic model is sensitive to the number of sensors and sensor placement due to the least squares curve fitting scheme the effects of sensor placement and quantity were investigated using fem by simulating a single case with static deformation in response to a point load applied at the free tip bending reconstruction was performed using 18 different quantities and placements of the probes the bending strain gauge distribution schemes investigated were linear selected for simplicity and ease of application half cosine selected to concentrate measurements near the static end of the cantilevered beam and half chebyshev root spacing selected to compliment the polynomial fitting scheme by improving interpolant stability the unitless sobolev norm shown in equation 15 was used to quantify the error between the fem results and the reconstructed deformations v r represents the reconstructed data and v s represents the simulated data the resulting error ranges from zero to one where an error of zero means the data are perfectly similar and one means the data are completely independent 15 e r r o r v r v s v r v s fig 5 shows the results from the sensor placement investigation a half cosine spacing with four bending strain locations was selected based both upon these results and upon the desire to minimize measurement channels the number of physical channels needed would be 2 p l 2 p channels for two normal bending directions and l channels for torsion measurement a total of twelve channels were available which restricts the number of gauges to eight bending strain gauges four for each direction and four shear strain gauges within this limitation the half cosine spacing offers the lowest error at least for cases with simple loading torsion and shear strain are related by a first order equation so a piecewise linear interpolant was selected for shear strain and the shear strain gauges were uniformly distributed along the length of the spar the final gauge locations are shown in fig 6 3 fem and analytical validation the performance of the kinematic model separate from the strain measurements themselves was assessed using synthetic data from fem simulations as before discrete strain measurements were sampled from the strain field data at locations corresponding to the physical strain gauges and used as inputs to the kinematic model the resulting bending and twisting deflections were compared to the simulated results a range of loading conditions were evaluated including point forces opposing forces and distributed forces both with and without point or distributed twisting moments table 1 shows the results from the fem validation for all loading conditions all of which demonstrate good agreement the largest dimensionless torsion error occurs for the case with distributed force and moment however the dimensional error in this case was only about one tenth of a degree the largest dimensionless bending error occurs for the case with opposing point forces one at the middle of the spar and one at the free tip the elevated error is a result of the least squares curve fit the actual bending strain distribution had a higher order than the third order polynomial used as an interpolant the interpolation error thus propagates into a higher bending error fig 7 shows an example of the good agreement between the reconstructed and simulated results for the case with combined bending and twisting concentrated at the free tip case 3 the kinematic model was also validated using known analytical strain distributions for canonical deformations two analytical cases were selected bending into a closed circle given a constant strain equal to the spar radius divided by the desired radius of the circle and the reconstruction of a helical spiral given by a constant bending strain and a constant shear strain similar to the fem validation discrete strain values were taken from the analytical strain field and used as inputs for the reconstruction model while the results are omitted here for the sake of brevity the kinematic model produced the theoretical shapes exactly in both cases both synthetic and analytical benchmarking demonstrated that the kinematic model was able to reconstruct arbitrarily large deformations accurately 4 experimental benchmarking 4 1 experimental setup the physical shape sensing spar was benchmarked using the vicon tracker 3 motion capture system vicon 2015 steady state bending data were simultaneously captured from the strain gauges and the motion capture system four tracking locations were established along the spar s length shown in fig 8 the fifth set of markers closest to the root was omitted because the relative deflections at that location were too small for the motion capture system to produce reliable data at each location a 3d printed block was affixed with reflective markers visible in fig 7a which were used to construct a local plane co planar with the x y and n t planes defined in section 2 2 the translations and rotations of each plane were reconstructed in post processing using the unloaded state as the undeformed condition point loads were applied to the tip of the spar the loads were applied at directions α t i p varying from 0 to 315 with respect to the global x axis which was taken to be aligned with a keyway as shown in fig 7b note that this definition of a global coordinate system corresponds to a rigid body rotation of γ 45 in equation 14 a total of 80 trials were conducted with a zero load reference recorded immediately before each trial 4 2 pre calibrated results fig 9 shows the bending magnitudes for the first 40 test cases with the bending directions α t i p indicated by line color all data are normalized by the displacement magnitude of the vicon measurement location a nearest the free tip denoted δ a this figure shows that there is significant variability in the strain gauge data relative to the motion capture data on the other hand when normalized by the maximum deflection reconstructed from strain gauge data the variance in the motion capture data becomes large while the strain gauge deformations collapse together to describe a common shape function based on the maturity of the system we chose the motion capture data as the more reliable of the two but a third measurement method should be included in future work fig 10 shows the comparisons of the strain gauge reconstruction versus the vicon measurements at the four vicon measurement locations a c for each bending direction the deflection patterns for the vicon and reconstructed measurements are in qualitative agreement however there is visible error in both the magnitude and the direction of the reconstructed measurements in most cases the strain gauge reconstruction under predicts the deflection magnitude and the directional error tends to be biased clockwise both figs 9 and 10 imply that the bending errors both in magnitude and direction are correlated with the bending direction α t i p 4 3 spar calibration figs 11 and 12 illustrate the effect of bending direction on the relative bending magnitude and direction error respectively at each measurement location the patterns in the measurement errors suggest a correlation with the bending direction the errors were fit using a three term sine series for each shown in equations 16 and 17 16 e m α s g i 0 3 a i sin b i α s g c i 17 e d α s g i 0 3 a i sin b i α s g c i regressions produced r 2 values of greater than 0 95 implying strong correlation between the bending magnitude errors and the bending direction the fitted errors in equations 16 and 17 were used to implement a directionally compensative calibration scheme at each of the four vicon measurement locations the bending direction and magnitude were estimated and a linear interpolation was used for points located between these locations the percentage error correctors e m and e d are then cast into a multiplicative gain which is applied to the raw data 4 4 calibration benchmarking the directionally compensative calibration was developed using a training data set of 40 different static loading conditions to fit error terms a second independent validation data set of 40 loading conditions was used to assess the calibration error fig 13 shows the normalized deflections of both the vicon and the calibrated shape sensing spar results the deflections still show some variability with direction but it is much reduced relative to fig 8 the calibrated data show variability similar to that of the vicon data fig 14 shows the complete results of the calibrated trials again presented as polar plots at the four vicon measurement locations the calibrated results shown in green exhibit much lower errors in bending 2 18 and in direction 0 97 for the bending range of zero to 220 mm the calibration scheme is shown to correct both the magnitude error and the directional error to produce extremely accurate measurements of bending deflections along the length of the spar without any external reference data 5 discussion the preliminary static test results show an average bending error of about 8 4 before any calibration that bending magnitude error is highly correlated with the bending direction at the spar s free tip the highest errors were observed at 90 from the keyway and the lowest errors were observed in the direction of the keyways the exact opposite was observed near the spar s root these error were used to inform a directionally compensative calibration scheme which was evaluated using an independent dataset the calibration was shown to correct both the magnitude and direction errors more significantly the corrective gains are calculated using the raw strain measurements so no external reference is required residual error may be indicative of nonlinearity introduced by the physical application of the strain gauges e g adhesion or alignment it should also be noted that the normalized vicon measurements do not all collapse in fig 13 in measurement locations d and c the strain gauge reconstruction method exhibits lower variability because locations d and c are located closer to the root the relative change in marker position at each is much smaller than at other measurement locations this implies that the precision of the motion capture system traced to camera resolution lens linearization and camera extensive properties may be insufficient to resolve small motions the shape sensing spar s performance in torsion was also intended to be evaluated however the vicon resolution proved to be too course to reliably measure the rotations of individual section planes for the same reasons described above it is likely that the motion camera system simply does not possess the precision required to benchmark the spar s performance in torsion to remedy this markers are being mounted further from the elastic axis of the spar in ongoing experiments nonetheless future work should seek to benchmark both the bending and the torsional performance of the shape sensing spar using a separate method to ensure a high quality reference for both systems 6 conclusions and future work real time shape sensing provides vital insight into the structural health and operating conditions of marine and aerospace structures although accurate state of the art methods exist they are often best suited for laboratory settings this paper outlines an approach to shape reconstruction using a kinematic model and conventional foil strain gauges intended to be used in both laboratory and field settings this work presents an accurate low cost solution for the shape sensing of lifting surfaces in complex flows a robust and computationally inexpensive kinematic model which is independent from structural properties ensures that the model may be applied to the real time deflection reconstruction of a wide range of structures the proposed kinematic model takes advantage of the kinematic relationship between strains and deflections by using a least squares curve fit through discrete span aligned bending strain gauges a local coordinate system integration approach allows the kinematic model to reconstruct both small and large deflections on a single core processor the kinematic model can run on the order of 100 s of reconstructions per second making the model suitable for on line reconstructions during experiments or operation the model also uses shear strain measurements to reconstruct torsion along the spar though torsional validation is left as a topic for future work at this point the kinematic model was validated by using discrete strain measurements sampled from fem solutions and canonical analytical solutions as inputs to reconstruct the deflections a prototype of the spar was benchmarked using an established motion capture system data show that the bending magnitude error has an average of 8 4 and a direction error of 4 before calibration the bending magnitude and direction error was found to be highly correlated to the bending direction these errors were included into a directionally compensative calibration post calibration error were found to be an average of 2 18 for bending magnitude and 0 97 for bending direction declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the author would like to thank prof venanzio cichella and the university of iowa cas laboratory for the use of their motion capture system this work was supported by the dod smart scholarship which is funded by usd r e the under secretary of defense research and engineering national defense education program ndep ba 1 basic research 
22019,a reynolds averaged navier stokes computational fluid dynamics rans cfd package will be one of the primary tools used during the development of a performance prediction program for wind assisted commercial ships this paper describes the simulation verification exercise performed in support of the experimental validation presented in part 1 of this two part series describing the rans cfd method employed in this research the predominance of large scale separated flow structures in the wake of the sailing ship an artefact of sideforce production necessary for sailing points to a careful verification exercise and estimate for the numerical uncertainty to support the systematic investigation of wind assisted ship hydromechanics and meshing guidelines within the available computer resources methods for cfd uncertainty quantification are defined and implemented for verification cases at leeway angles equal to 0ᵒ 6ᵒ and 9ᵒ analysis for four sets of grids with different meshing strategies and for varying time steps results in a grid definition and time step for simulation validation numerical uncertainty as adopted in part 1 for validation is defined finally the meshing strategy for full scale simulation is described as used for the production runs of the delft wind assist series keywords numerical error rans computational fluid dynamics sailing vessels emission control areas green shipping 1 introduction wind energy as an auxiliary form of propulsion for commercial ships has again become of great interest as a possible response to volatile fuel prices and increasingly stringent environmental regulations as hybrid vessels the performance of a wind assist concept will depend on the contribution of the wind propulsor alongside the efficiency of the conventional propulsion system and the drag penalty associated with heel and leeway the sailing condition of course the introduction of a sail plan will only benefit the vessel if the net thrust gained outweighs any loss in main propulsor efficiency or increase in resistance also the manoeuvrability of the vessel may be compromised the expansion and refinement of regression based modelling for a generic wind assist vessel is the subject of ongoing work at delft university of technology dwa the maturity of reynolds averaged navier stokes computational fluid dynamics rans cfd solvers offers the ready inexpensive analysis for a large number of hull variations however simulations that remain computationally affordable may be unable to model the flow patterns occurring near a sailing commercial ship fluid flow around the wind assisted ship operating at a leeway angle will experience separation effects and will become entrained in large vortices in the wake of the ship modeling the occurrence of separation and the evolution of these vortices is the principal simulation challenge as both phenomena may challenge modeling assumptions made in the simulation setup this paper is part 2 of a series describing the simulation method used during the study of the hydromechanics of wind assist ships an experimental validation of the simulation method was presented in part 1 this paper describes the development of a rans cfd methodology for computationally affordable assessment of large numbers of ship hull variations this simulation work is performed in the service of a regression based modeling for the performance of wind assist vessels production runs are performed with a six million cell grid which gave numerical uncertainties that were commensurate with the uncertainties in the experimental data of the validation data presented in part 1 of this series the meshing strategy for simulation validation and for full scale production runs is informed by a grid verification and parameter study where numerical uncertainty is computed for several grid sets with differing meshing strategies for a range of courant numbers and considering modeling choices such as wall treatment and turbulence models 2 methodology 2 1 rans cfd verification procedure a numerical simulation will have some error associated with discretization and an error associated with the iterative solution approach for the non linear flow equations the numeric error is written as the sum of discretization errors and iterative errors with corresponding uncertainty while disregarding round off errors wilson et al 2006 1 δ num 2 δ d 2 δ i 2 u num 2 u d 2 u i 2 several governing bodies publish standards for cfd simulation verification including the international towing tank committee ittc and the american society of mechanical engineers asme the grid convergence index gci of roache is commonly accepted thanks in part to his strong advocacy for standardization of journal policies regarding uncertainty reporting for computational fluid dynamics his influence is seen throughout subsequent work on this topic the ittc recommendations include the correction factor method of stern and wilson stern et al 2001 the gci of roache and an approach for oscillatory convergence several methods are investigated in van der kolk et al 2016 the gci of roache 1997 its elaboration by eça and hoekstra eça and hoekstra 2014 the correction factor of stern stern et al 2001 and the approximate error spline of celik celik et al 2005 the method of eça and hoekstra was most robust for its ability to cope with nonconforming observed order of convergence and otherwise anomalous convergence behaviour and this method is followed for the discretization uncertainty for the remainder of this study the iterative uncertainty is assessed by reviewing the normalized l2 residuals for the flow equations and the standard deviation for the integrated body forces used as verification quantities presented in section 2 3 most cfd verification procedures for discretization errors originate in the work of richardson 1927 who identified the asymptotic approach to a continuum solution for finite difference calculations with increasing grid refinement the so called richardson extrapolation was adopted by roache 1997 to estimate the uncertainty due to discretization errors in cfd beginning with the generalized richardson extrapolation 2 φ 0 φ 1 φ 1 φ 2 r p 1 r h 2 h 1 is the grid refinement ratio for a characteristic grid height h this is an expression for the function value at zero grid spacing based on the function value φ 1 at a series of geometrically similar grids h 1 for unsteady simulations the time step has been scaled together with the grid spacing to achieve a constant courant number for all grids the exponent p is either the theoretical second order for space and time or observed order of convergence the observed order of convergence is calculated from a grid triplet as 3 p o b s ln φ 3 φ 2 φ 2 φ 1 ln r the difference δ r e φ 0 φ 1 is an estimate of the error for grid one corresponding to a 50 uncertainty band when this value is interpreted as a single realization of that error thus 4 u 50 δ r e φ 1 φ 2 r p 1 one might argue that δ r e is derived from multiple realizations of the function φ 1 φ 2 φ 3 finally to extend the confidence interval to 95 roache defines the grid convergence index gci as 5 g c i f s δ r e f s is interpreted as the coverage factor or in engineering parlance as the factor of safety roache suggests f s 3 for rudimentary grid convergence studies involving two grids and f s 1 25 for more rigorous studies the method is predicated on monotonic convergence behaviour for simulations with increasing mesh refinement or decreasing time step the convergence ratio r must satisfy the following condition 6 0 r 1 7 r φ 2 φ 1 φ 3 φ 2 this requirement leads to essential practical issues that complicate the application of richardson extrapolation theory to rans cfd chief among which is the definition of a family of systematically refined grids that lies within the asymptotic range and yet remains computationally feasible also problematic are limiters used in the discretization of the flow equations modelling requirements for the 1st cell height at the ship hull and non conforming convergence rate where higher order terms in the power series expansion play a role the efforts of roache have been carried further by eça and hoekstra eça and hoekstra 2014 eça et al 2010 who applied a least squared approach to the determination of p o b s to accommodate data scatter for the grid solution φ i eça and hoekstra also incorporate the error estimates with prescribed orders oberkampf 1994 when data scatter is such that a reliable estimate for the order of convergence p is not feasible in these cases convergence is assumed to proceed with either first or second order or with mixed order 8 δ 1 c 1 h 9 δ 2 c 2 h 2 10 δ 12 c 1 h c 2 h 2 also recognizing that cfd for practical ship flows precludes the true approach to the asymptotic range while using systematically refined grids eça and hoekstra propose a weighting within the least squared minimization that favours the fine grid solutions a selection is made among the available error estimates based on the observed order of convergence and the standard deviation for each fit for the solution on n grids the extents of what is considered to be an expected value for p may be discussed as the safety factor more than doubles at the boundary of this set eça and hoekstra state that values of p o b s that fall between 0 6 and 2 1 may be treated with confidence so that f s 1 25 for cases where p o b s is greater or less than the expected order of convergence the power series estimates with prescribed orders that best fits the data is selected with an increased f s 3 other researchers have questioned this substantial penalty for the uncertainty especially for datasets that exhibit monotonic convergence with an order that is near to two stern et al 2005a b coleman and stern 1997 viola et al 2013 11 δ φ max φ min φ n 1 when the error estimator has been selected the uncertainty is determined by comparing the data range parameter δ φ with the standard deviation of the fit σ f i t 12 u eça f s δ i σ f i t φ i φ f i t σ f i t δ φ 3 σ f i t δ φ f s δ i σ f i t φ i φ f i t σ f i t δ φ the first term may be recognized as the gci of roache the remaining terms are the standard deviation of the fit and the difference between the data value φ i and the fit φ f i t the ratio σ f i t δ φ serves as metric for the quality of the data available for error estimation for σ f i t δ φ 1 the factor of safety is increased in proportion to this ratio a full description of this procedure is given in eça and hoekstra 2014 2 2 grid set definition simulation verification as described above requires a set of grids that are geometrically similar and cover a range of grid sizes within the asymptotic range geometric similitude is achieved in the simplest sense by progressive subdivision of mesh cells for three dimensional problems the resulting grids may grow to exceed computing limits so that a compromise is necessary according to the available computational power three grid sets were defined for this verification exercise including one subset without boundary layer cells grid sets were defined to test the influence of cell distribution within the domain the influence of refinement diffusion ratio and the effect of grid similarity on the discretization uncertainty each set is composed of four grids spanning approximately one complete subdivision of the coarse grid r 2 an unstructured mesh for three dimensional complex geometries requires a definition for grid size this dimension must be a length that is descriptive of the grid and should decrease monotonically for a set of grids preferably with constant refinement ratio r roache suggests the following 13 h v o l v o l n 3 in which v o l is the volume of the computational domain and n the number of cells this definition for cell height is a global quantity it does not reflect the distribution of cells throughout the domain according to the refinement diffusion which is of particular importance for capturing flow structures around the hull as a consequence of these ambiguities in the volumetric cell height metric h v o l defined in equation 13 the observed order of convergence may not agree with the theoretical order of convergence in other words a second order discretization that is expected to converge with d x 2 may not behave accordingly with h v o l 2 simulation verification as described above requires a set of grids that are geometrically similar and cover a range of grid sizes within the asymptotic range geometric similitude is achieved in the simplest sense by progressive subdivision of mesh cells for three dimensional problems the resulting grids may grow to exceed computing limits so that a compromise is necessary according to the available computational power the construction of a systematically refined set of unstructured grids using the numeca meshing tool hexpress is achieved by varying initial cell subdivision which defines the cell size and refinement diffusion which defines the thickness of each refinement level such that refinement diffusion doubles with each grid subdivision d x 2 in fig 1 cells adjacent to a surface are given to illustrate these concepts in fig 2 a the wall has a refinement level equal to two and a refinement diffusion equal to one the size of the largest cell on the right is defined by the initial subdivision of the computational domain that cell is refined twice in the vicinity of the wall and each refinement level is one cell thick fig 2 b is a detail of the cells adjacent to the wall the refinement diffusion or the thickness of each refinement level is one in 2 c these cells have been divided once so that r 2 here the thickness of each refinement level is two which is to say that the refinement diffusion has doubled three grid sets were defined for this verification exercise including one subset without boundary layer cells grid sets were defined to test the influence of cell distribution within the domain the influence of refinement diffusion ratio and the effect of grid similarity on the discretization uncertainty each set is composed of four grids spanning approximately one complete subdivision of the coarse grid r 2 grid set a higher refinement diffusion grid set b smaller cell size at hull grid set c twice diffusion rate grid set cnobl no boundary layers inserted grid sets were defined such that refinement diffusion doubled when grid spacing was halved the domain refinements in the near and far field are varied for grid sets a and b the balance favours refinement in the far field for grid set a and refinement at the ship for grid set b meaning that for similar cell counts the cell size at the ship hull is larger for set a than for set b see fig 2 grid set c was defined with particular interest for the influence of refinement diffusion on the uncertainty for lateral force compared with sets a and b the refinement diffusion is increased at twice the rate while the cells at the hull were elongated to an aspect ratio of four to manage the size of the computational grids the d x reported for grid c is the average of the cell dimensions at the hull finally a subset of grid set c was defined that does not contain boundary layer cells for grid set cnobl not shown in fig 2 the fitting for diffusion rate vs cell size h v o l returns s h 2 06 a further complication is the inclusion of boundary layer cells at the hull which will vary in number according to size of the eulerian mesh d x and physical modelling requirement for the cell height adjacent to the hull for log law wall modelling the first cell height is defined to maintain 30 y 100 in so far as possible due to the recirculation region near the transom y values smaller than 15 were present for approximately 1 5 of the hull wetted surface the maximum y along the leading bilge was considered to be the driving consideration as separation is expected at that location simulations are carried out at model scale with a relatively low reynold s number of 2 3 106 and the requirements of the log law wall model were quickly satisfied with increasing grid refinement by relaxing the requirements for the log law model it was possible to define a grid subset without boundary layer cells for grid c2nobl the compromise between cell height metrics d x h v o l and refinement diffusion is apparent in the initial cell height which is smaller than desired for y details of grid construction are given in table 1 2 3 simulation method the simulation method for the production runs is designed for the assessment of hull geometry variants of the delft wind assist series considering the volume of work to be done at full scale a premium must be placed on economical simulations simulation verification is performed at model scale for the purposes of the validation as described in part 1 of this publication the validation statement and the extents of the range for modelling error made out of necessity at model scale is not directly transferable to full scale simulations whereas the reynolds number for the verification and validation exercise was 2 3e6 full scale simulations are performed for a reynolds number of 8 3e8 this difference of approximately 3 orders of magnitude means that the turbulence model will have to model a larger range of flow scales which is presumably detrimental for the modelling error on the other hand reynold s number 3e8 is above the transition regime to fully turbulent flow the ability to perform simulations at full scale is considered desirable in particular the ability to reproduce the full scale boundary layer the setup of the computational domain boundary conditions and the drift sweep procedure which are identical for the verification and validation exercise and for the full scale production runs will be described here the meshing strategy for validation runs is described under results in section 3 3 the rans equations are solved with the isis cfd flow solver developed at ecole centrale nantes the isis cfd flow solver is an incompressible unsteady rans method the unstructured spatial discretization for the transport equations is based on the finite volume method free surface flows are simulated with a conservation equation for the mass fraction a detailed description of the solver is provided in deng et al 2005 deng et al 2006 duvigneau and visonneau 2003 queutey and visonneau 2007 though the unsteady components of the vessel sailing response are not of interest the context of this study the flow condition is essentially unsteady and an unsteady rans simulation urans is performed the explicit algebraic stress model easm is selected as turbulence model to attempt a balance between a boussinesq type modelling and more elaborate modelling of reynolds stresses this k ω variant includes modeling for anisotropic turbulence which is understood to play a key role for the sailing performance of the ship hull while remaining viable within the scope of work and the available computational resources the evaluation of convective terms in the momentum equation and the turbulent stresses is performed with the alvsmart scheme a blended upwind central scheme based on the local courant number numeca int n d the solution for the free surface is determined following the volume of fluid method using the brics algorithm numeca int n d that is likewise dependent on the local courant number a summary of computation settings is provided in table 2 domain construction boundary conditions and meshing for the free surface are indicated in figs 3 and 4 a logarithmic wall model boundary condition is applied to the ship hull though it is understood that the correct prediction of separation strength and location is critical for correct modelling some components of the transverse force and that a logarithmic wall model is essentially unfit for this task however the increase in cell count for a wall resolved simulation no slip boundary condition is not realistic for the routine evaluation of hull variants besides controlling the total cell count and simulation computational cost the logarithmic law boundary condition resolves potential issues with the contact line problem finally the first cell height requirement of a wall resolved simulation that includes the free surface for full scale reynolds numbers may lead to stability issues for the flow solver the drift sweep procedure toxopeus 2011 was adopted for the efficient analysis of a series of leeway angles and speeds the domain is meshed once with the ship aligned with the x axis and assigned a prescribed motion including a leeway angle within a quiescent fluid as in fig 5 simulation cases proceed from a converged solution to the next combination of leeway angle and vessel speed using a gradual transition such that the time required for the convergence of the new solution is reduced compared with reinitializing the computation a coarse time step corresponding to a courant number of approximately 100 is adopted during this stage to accelerate the convergence of the flow field the time step is reduced in the final stage to the target courant number and integrated fluid forces on the ship hull are determined in the coordinate system aligned with the direction of forward motion vessel response may be unsteady due to shedding behaviour around the hull but only averaged forces are of interest within the context of this study integrated fluid forces on the hull are averaged over one characteristic time interval equal to l u the standard deviation for averaged quantities is returned as a measure of the convergence of the simulation to the steady state solution the parent hull of the delft wind assist series is used for this verification exercise the lines plan for the bare hull is given in fig 6 and the main particulars are given in table 3 the verification exercise is performed at model scale with a froude number equal to 0 168 equivalent to 12 knots at full scale the reynolds number for simulations is 2 33 106 integrated fluid forces on the model are determined in the coordinate system aligned with the direction of forward motion resistance x sideforce y and yaw moment n the sample interval for the verification exercise was 2 l u shown also in fig 6 see fig 7 see table 4 simulation convergence for the simulation residuals for the u 1 velocity component and the pressure p are reported as 14 l 2 i 1 n p δ φ i 2 n p where δ φ i is the normalized residual a measure of the change in the flow quantity φ between time steps for the verification exercise the integrated forces on the ship are the quantities of interest they are averaged over a sample interval equal to two characteristic time intervals 2 l u as in fig 6 the standard deviation for these quantities is reported as a metric for simulation convergence to the steady solution that is of interest table 4 the contribution of statistical errors associated with averaging of unsteady phenomena is neglected the simulation residuals are reduced to at least 10 5 for all cases the contribution of iterative errors to the numerical uncertainty as in equation 1 is assumed to be negligible 2 4 courant number study in the aforementioned procedure the time step is scaled together with the grid cell size maintaining a constant courant number and a consistency for the numerical method for the grid set the discretization uncertainty obtained with the procedure includes the effect of space and time discretization however it is desired to inform the choice of time step for validation runs and production runs as the blending switching of discretization schemes and the interface compression algorithm are functions of the local courant number the influence of the choice of time step is investigated with a series of simulations for varying time step courant values between 0 25 and 50 were achieved based on cell refinement at the hull away from the free surface the target courant number for validation and production runs is selected based on systematic variations in the courant number performed on three grids a2 b1 and b3 simulations for variations in courant number were performed at 6ᵒ leeway details for the courant number study are presented in table 5 3 numerical uncertainty the simulation verification exercise is performed for the forces integrated over the ship hull resistance x sideforce y and yaw moment n in the following the calculation of the simulation discretization uncertainty u d will be discussed for each component also the results for the courant number study are presented finally the meshing strategy grid spacing and target courant number are defined for validation simulations the numerical uncertainty is calculated according to the method of eça and hoekstra for the discretization uncertainty which includes the influence of errors due to spatial and temporal discretization the time step is scaled together with the grid spacing to maintain a constant courant number and a consistent numerical method simulation for grid set a were performed at 0ᵒ and 6ᵒ leeway simulations for grid set b was performed at 6ᵒ leeway simulations for grid set c and cnobl were performed at 0ᵒ and 9ᵒ all simulations for discretization uncertainty were performed for target courant number equal to four see table 8 for each component x y and n the following calculation details are reported the convergence ratio r p o b s the fit selected by the uncertainty procedure the ratio σ f i t δ φ the factor of safety applied the richardson extrapolated value φ 0 and the uncertainty u h v o l 0 07 for each grid set where all four grid sets overlap see table 1 this corresponds to a cell count of approximately 2e6 or grids a4 b4 and c2 finally uncertainties computed for each component on all grids are provided in table 9 the results for discretization uncertainty for β 0 appear to be congruent figs 7 and 8 the observed order of convergence is greater than the upper bound prescribed by eça and hoekstra so that a safety factor of three is applied for both cases table 6 a similar high observed order of convergence for resistance has been reported by eça and hoekstra eça and hoekstra 2008 the method switches to the second order fit the richardson extrapolated values for these grid sets show excellent agreement for all leeway angles tested for leeway angle β 6 the meshing approach taken for grid set a is apparently superior returning approximately half the uncertainty as grid set b even as the δ r e fitting is used in the uncertainty procedure for grid set b on the other hand the convergence ratio r is less than one for grid set b indicating oscillatory convergence leading to σ f i t δ φ 1 and a safety factor of 3 the uncertainty estimation for sideforce is compelling fig 9 the value of p o b s and the ratio σ f i t δ φ indicates that confidence is placed on these table 7 grid set b where resolution of the ship is favoured has an observed order of convergence that is in accordance with the interval specified by eça and hoekstra an 11 8 difference between the φ 0 value for grid set a and b is observed the discrepancy may be a product of the differing fits δ 12 and δ r e this discrepancy underscores the substantial grid uncertainty for sideforce still the largest grids a1 and c1nobl have an uncertainty of approximately 3 grid set cnobl constructed without boundary layer cells return the smallest uncertainties see fig 10 calculation details indicate that the quality of the fit and the degree of confidence in the uncertainty assessment are superior to that of grid set c grid set c and cnobl are otherwise identical in fact the grid quality for cnobl is detrimentally impacted by the absence of boundary layer cells as seen in fig 3 the boundary layer cells of grid set c have disrupted geometric similitude and while the physical modelling inconsistent y spacing and numerical properties non orthogonal cells near to the wall have both been compromised grid set cnobl returns superior calculation metrics and lower uncertainties this is interpreted as the influence of geometric similitude on the uncertainty assessment methods suggesting that the uncertainties returned following the methodologies in this paper may be overstated the procedure for the grid uncertainty of the yaw moment is very well behaved for grid set a fig 10 table 8 for other grid sets the convergence behaviour is such that the safety factor is increased to three and a second order fit is applied results from grids c and cnobl are poorly fit as indicated by σ f i t δ φ in particular c2nobl which exhibits oscillatory convergence and where the large difference for the term φ i φ f i t eqn 12 results in large uncertainties the richardson extrapolation value for zero grid spacing differs by 8 for grid c and cnobl the values for zero grid spacing of grid sets a and b lie within 3 of each other the results presented above can be better interpreted by recalling the grid set definition in terms of the cell size d x and the refinement diffusion see figs 1 and 2 first the large uncertainty values reported for grid set b are interesting as the cell size d x for grids b1 b3 is smaller than the cell size d x for grid a2 on the other hand the two largest grids a1 and c1nobl where quite small uncertainties are computed for all force components have the largest refinement diffusion this is interpreted as a consequence of proper resolution of the wake of shed vorticity associated with sideforce production for the grid definition for validation simulations the refinement diffusion parameter should be prioritised over cell size d x the general trend for the poor performance of grid set b does not hold for the uncertainty for sideforce u n u m y for grids a2 a4 and b2 b4 where the refinement diffusion varies uniformly one can observe in fig 9 the influence of the cell size d x on the sideforce uncertainty which increases quickly for grid set a after grid a2 cell size d x 0 006 l 500 3 1 courant number study time discretization uncertainties are determined for three grids a2 b1 and b3 following the same procedure as above the temporal uncertainty corresponding to a target courant number of four is reported this is the same target courant number used for the discretization uncertainty calculations presented above calculation details for grids a2 b1 and b3 indicate that confidence is placed in the time uncertainty estimates see table 10 the richardson extrapolations for zero time step and zero grid spacing show close agreements for resistance the φ 0 value for grid a2 and b1 differ by 2 3 finally the φ 0 values for zero time step and zero grid spacing for grid sets a and b differ by less than 1 each a marked increase in the uncertainty estimate is observed for the set of large courant numbers performed with grid set b1 see fig 11 table 10 for sideforce fig 12 courant number variation on grid b1 returns an observed order of convergence equal to 1 55 and σ f i t δ φ less than one yet the uncertainty u c o 4 is the largest calculated table 11 by contrast grids a2 and b3 returned an observed order of convergence outside the range prescribed by eça and hoekstra and switch to the mixed order fit δ 12 with safety factor equal to three the φ 0 value for grids a2 and b3 differ from φ 0 value of grid b1 by 5 9 and 3 1 respectively which is in accordance with the presence of considerable discretization uncertainty calculated for sideforce on these grids for a2 u d 13 b1 u d 14 b3 u d 17 finally the φ 0 value for zero time step for grid a2 differs from the φ 0 value for zero grid spacing for grid set a by 6 3 while the extrapolated values for zero time step for grid b1 and zero grid spacing for grid set b differ by 10 the value for yaw moment varies very little with courant number and the time discretization uncertainty is insignificant extrapolations for zero time step lie within 1 of each other and within 6 of the extrapolated zero grid size value see fig 13 table 12 the fitting for the observed order of convergence does not succeed the method of eça and hoekstra returns the safety factor of three with very small values for σ f i t δ φ except for grid b3 where oscillatory convergence is observed the time discretization uncertainties obtained by systematically varying the courant number are averaged at each target courant number and presented in table 13 along with the uncertainties determined on each grid the discretization uncertainty which includes the time uncertainty at c o 4 is provided for context if an rss combination for the simulation error is assumed as in equation 1 wilson et al 2006 15 u d 2 u g 2 u t 2 then the results calculated for u d and u t at c o 4 may be used to infer conclusions about the composition of the numerical uncertainty iterative errors have been neglected throughout this study the influence of the range of data in relation to the extents of the asymptotic range has been discussed the increased safety factor for anomalous convergence behaviour reflects the poor confidence placed on the uncertainty estimation results for courant variations on grid a2 are regarded as the most meaningful for this grid the contribution of time discretization uncertainty is only significant for the resistance for which u d 4 4 u g 3 9 and u t 2 1 a target courant number is determined by linear interpolation of the averaged values for u t such that the contributions of the spatial and temporal uncertainties to the discretization uncertainty are equal this condition is satisfied for courant number equal to 8 3 2 turbulence model and wall treatment the selection of the easm turbulence model is motivated by an appreciation for the physics of sideforce production where anisotropy in the dissipation of shed vorticity is understood to play a key role this is borne out in comparisons made using the validation data set for simulations with wall function using the k ω sst turbulence model and the easm turbulence model the result is reported as the comparison error for sideforce which is given as a percentage of the range of experimental values 16 e ens 100 s i m e x p 1 2 m a x e x p m i n e x p the comparison error for two wall treatments are plotted as histograms in fig 14 the wall resolved mesh is based on mesh a3 shown also in fig 15 below the statistics of the distributions are presented in table 14 including a 95 confidence interval of the ensemble comparison error which is understood as an estimate for the expected range of comparison errors for simulation of the delft wind assist series the negative outliers in fig 14 left correspond to hull 16 with sharp bilges where pronounced separation of bilge vortices is expected simulation for sideforce using log law boundary condition is consistently under predicted for this hull the results for the k ω sst turbulence model affirm the selection of the easm turbulence model as the modeling of anisotropic turbulence has centered the distribution and reduced the number of outliers whereas the results for a wall resolved simulation show further improvement this approach is not considered to be feasible in light of the scope of full scale production runs further discussion and results for the ensemble comparison error are included in part 1 the absence of boundary layer cells for grid set cnobl influences the solution near the wall as seen in fig 15 where a detail of the hull is shown as the keel line turns from the parallel midbody towards the upward sloping buttock lines of the pram stern a cross section of the computational domain is shown in the x z plane including cell borders and colour contours for the eddy viscosity ratio three solutions are shown grid a3 with four boundary layer cells top grid c2nobl middle and a wall resolved mesh bottom where a no slip boundary condition is imposed at the hull for this mesh thirty boundary layer cells are inserted to achieve a y less than one the thickness of the region of eddy viscosity production is similar for all meshes and lies within the thickness of the boundary layer cell region for grid a3 top the reduction in eddy viscosity ratio along the upward sloping keel observed for the wall resolved simulation is less evident for grid a3 finally the absence of boundary layer cells for grid cnobl clearly influences the flow inside the boundary layer where mesh irregularities were introduced in the snap to geometry step during mesh construction interestingly the quality of the data for richardson extrapolation as measured by p o b s and the ratio σ f i t δ φ indicate that greater confidence is placed in the uncertainty estimates based on grid set cnobl see section 3 2 as discussed in section 2 1 the methods for uncertainty assessment are predicated on geometric similitude which is better preserved for the grid set without boundary layer cells 3 3 mesh definition for validation and full scale production simulations a mesh for validation simulation is defined based on the results presented above for simulation verification and the parameter studies for courant number wall modelling and turbulence model selection the mesh resolution and time step is defined such that the contribution of the numerical uncertainty is commensurate with the other uncertainties in the validation exercise at the same time the mesh definition must be computationally affordable considering the volume of simulations planned precluding for example a wall resolved mesh the following guidelines are adopted for the meshing strategy the discretization uncertainty is reduced for grids with larger refinement diffusion or when the refinement of the domain is prioritised over refinement at the ship for both cases this is interpreted as a consequence of the resolution of the wake of the ship therefore the refinement diffusion in the downstream direction is favoured over the upstream direction cell size d x corresponding to l 500 is selected following the discussion of results for sideforce uncertainty for grids a2 a4 and b2 b4 four layers of boundary layer cells are inserted to satisfy modelling requirement for y at full scale 21 boundary layer cells are needed to satisfy the same requirement the mesh topology is otherwise identical shown also in fig 3 estimates for numerical uncertainty for validation simulations are given in table 15 with a cell size d x 0 0054 m and a refinement diffusion equal to 10 in the downstream direction the corresponding grid size h v o l 0 05 for a cell count of approximately 6e6 the mesh so defined for validation is not one of the grids studied as part of this verification exercise and numerical uncertainties were approximated by linear interpolation using h v o l and available results on grids sets a and c the time step is selected to achieve a target courant number of 8 following the discussion in section 3 2 these values are adopted in part 1 of this series describing the experimental validation for this simulation methodology 4 conclusion the numerical uncertainty for rans cfd simulations for integrated forces for the wind assist ship hull has been investigated the verification exercise described herein is a necessary prerequisite for the assessment of wind assist hull form variants using rans cfd simulations this work complements the validation exercise presented in part 1 of this series the sailing vessel operating with a leeway angle to produce hydrodynamic sideforce will trail a wake of large vortices the separation and evolution of which is understood to be the principal simulation challenge this two part series describes the development of a simulation method that can capture this phenomenon yet remain computationally affordable in light of the volume of simulations anticipated it was observed that grids with a large refinement diffusion exhibited superior performance as measured by the calculated uncertainties this is interpreted as a requirement on the refinement of the wake of the sailing vessel the influence of cell size at the ship hull was most apparent for the sideforce uncertainty improvement in geometric similarity for grid set cnobl defined without boundary layer cells gave better behaved convergence and resulted in lower uncertainty estimates implying that the uncertainty estimates for practical meshes with boundary layer cells may be overstated parameter studies included modeling choices such as wall treatment and turbulence model selection where an ensemble error and simulation computation time was used to design the methodology for full scale production runs of the delt wind assist series the meshing strategy and time step adopted for validation and production runs was defined numerical uncertainty for validation runs as adopted for the validation exercise presented in part 1 of this paper are presented in table 15 credit authorship contribution statement n j van der kolk conceptualization data curation formal analysis investigation methodology validation visualization writing original draft i akkerman writing review editing supervision j a keuning supervision r h m huijsmans supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is conducted with the support of the european commission as part of the joules project the author would also like to thank the vaderland fonds and the bijlboeg fonds for their support computations were performed at the sara supercomputer facility surf sara n d as part of sponsorship by nwo exacte natuur en wetenschappen enw nwo physical sciences division 
22019,a reynolds averaged navier stokes computational fluid dynamics rans cfd package will be one of the primary tools used during the development of a performance prediction program for wind assisted commercial ships this paper describes the simulation verification exercise performed in support of the experimental validation presented in part 1 of this two part series describing the rans cfd method employed in this research the predominance of large scale separated flow structures in the wake of the sailing ship an artefact of sideforce production necessary for sailing points to a careful verification exercise and estimate for the numerical uncertainty to support the systematic investigation of wind assisted ship hydromechanics and meshing guidelines within the available computer resources methods for cfd uncertainty quantification are defined and implemented for verification cases at leeway angles equal to 0ᵒ 6ᵒ and 9ᵒ analysis for four sets of grids with different meshing strategies and for varying time steps results in a grid definition and time step for simulation validation numerical uncertainty as adopted in part 1 for validation is defined finally the meshing strategy for full scale simulation is described as used for the production runs of the delft wind assist series keywords numerical error rans computational fluid dynamics sailing vessels emission control areas green shipping 1 introduction wind energy as an auxiliary form of propulsion for commercial ships has again become of great interest as a possible response to volatile fuel prices and increasingly stringent environmental regulations as hybrid vessels the performance of a wind assist concept will depend on the contribution of the wind propulsor alongside the efficiency of the conventional propulsion system and the drag penalty associated with heel and leeway the sailing condition of course the introduction of a sail plan will only benefit the vessel if the net thrust gained outweighs any loss in main propulsor efficiency or increase in resistance also the manoeuvrability of the vessel may be compromised the expansion and refinement of regression based modelling for a generic wind assist vessel is the subject of ongoing work at delft university of technology dwa the maturity of reynolds averaged navier stokes computational fluid dynamics rans cfd solvers offers the ready inexpensive analysis for a large number of hull variations however simulations that remain computationally affordable may be unable to model the flow patterns occurring near a sailing commercial ship fluid flow around the wind assisted ship operating at a leeway angle will experience separation effects and will become entrained in large vortices in the wake of the ship modeling the occurrence of separation and the evolution of these vortices is the principal simulation challenge as both phenomena may challenge modeling assumptions made in the simulation setup this paper is part 2 of a series describing the simulation method used during the study of the hydromechanics of wind assist ships an experimental validation of the simulation method was presented in part 1 this paper describes the development of a rans cfd methodology for computationally affordable assessment of large numbers of ship hull variations this simulation work is performed in the service of a regression based modeling for the performance of wind assist vessels production runs are performed with a six million cell grid which gave numerical uncertainties that were commensurate with the uncertainties in the experimental data of the validation data presented in part 1 of this series the meshing strategy for simulation validation and for full scale production runs is informed by a grid verification and parameter study where numerical uncertainty is computed for several grid sets with differing meshing strategies for a range of courant numbers and considering modeling choices such as wall treatment and turbulence models 2 methodology 2 1 rans cfd verification procedure a numerical simulation will have some error associated with discretization and an error associated with the iterative solution approach for the non linear flow equations the numeric error is written as the sum of discretization errors and iterative errors with corresponding uncertainty while disregarding round off errors wilson et al 2006 1 δ num 2 δ d 2 δ i 2 u num 2 u d 2 u i 2 several governing bodies publish standards for cfd simulation verification including the international towing tank committee ittc and the american society of mechanical engineers asme the grid convergence index gci of roache is commonly accepted thanks in part to his strong advocacy for standardization of journal policies regarding uncertainty reporting for computational fluid dynamics his influence is seen throughout subsequent work on this topic the ittc recommendations include the correction factor method of stern and wilson stern et al 2001 the gci of roache and an approach for oscillatory convergence several methods are investigated in van der kolk et al 2016 the gci of roache 1997 its elaboration by eça and hoekstra eça and hoekstra 2014 the correction factor of stern stern et al 2001 and the approximate error spline of celik celik et al 2005 the method of eça and hoekstra was most robust for its ability to cope with nonconforming observed order of convergence and otherwise anomalous convergence behaviour and this method is followed for the discretization uncertainty for the remainder of this study the iterative uncertainty is assessed by reviewing the normalized l2 residuals for the flow equations and the standard deviation for the integrated body forces used as verification quantities presented in section 2 3 most cfd verification procedures for discretization errors originate in the work of richardson 1927 who identified the asymptotic approach to a continuum solution for finite difference calculations with increasing grid refinement the so called richardson extrapolation was adopted by roache 1997 to estimate the uncertainty due to discretization errors in cfd beginning with the generalized richardson extrapolation 2 φ 0 φ 1 φ 1 φ 2 r p 1 r h 2 h 1 is the grid refinement ratio for a characteristic grid height h this is an expression for the function value at zero grid spacing based on the function value φ 1 at a series of geometrically similar grids h 1 for unsteady simulations the time step has been scaled together with the grid spacing to achieve a constant courant number for all grids the exponent p is either the theoretical second order for space and time or observed order of convergence the observed order of convergence is calculated from a grid triplet as 3 p o b s ln φ 3 φ 2 φ 2 φ 1 ln r the difference δ r e φ 0 φ 1 is an estimate of the error for grid one corresponding to a 50 uncertainty band when this value is interpreted as a single realization of that error thus 4 u 50 δ r e φ 1 φ 2 r p 1 one might argue that δ r e is derived from multiple realizations of the function φ 1 φ 2 φ 3 finally to extend the confidence interval to 95 roache defines the grid convergence index gci as 5 g c i f s δ r e f s is interpreted as the coverage factor or in engineering parlance as the factor of safety roache suggests f s 3 for rudimentary grid convergence studies involving two grids and f s 1 25 for more rigorous studies the method is predicated on monotonic convergence behaviour for simulations with increasing mesh refinement or decreasing time step the convergence ratio r must satisfy the following condition 6 0 r 1 7 r φ 2 φ 1 φ 3 φ 2 this requirement leads to essential practical issues that complicate the application of richardson extrapolation theory to rans cfd chief among which is the definition of a family of systematically refined grids that lies within the asymptotic range and yet remains computationally feasible also problematic are limiters used in the discretization of the flow equations modelling requirements for the 1st cell height at the ship hull and non conforming convergence rate where higher order terms in the power series expansion play a role the efforts of roache have been carried further by eça and hoekstra eça and hoekstra 2014 eça et al 2010 who applied a least squared approach to the determination of p o b s to accommodate data scatter for the grid solution φ i eça and hoekstra also incorporate the error estimates with prescribed orders oberkampf 1994 when data scatter is such that a reliable estimate for the order of convergence p is not feasible in these cases convergence is assumed to proceed with either first or second order or with mixed order 8 δ 1 c 1 h 9 δ 2 c 2 h 2 10 δ 12 c 1 h c 2 h 2 also recognizing that cfd for practical ship flows precludes the true approach to the asymptotic range while using systematically refined grids eça and hoekstra propose a weighting within the least squared minimization that favours the fine grid solutions a selection is made among the available error estimates based on the observed order of convergence and the standard deviation for each fit for the solution on n grids the extents of what is considered to be an expected value for p may be discussed as the safety factor more than doubles at the boundary of this set eça and hoekstra state that values of p o b s that fall between 0 6 and 2 1 may be treated with confidence so that f s 1 25 for cases where p o b s is greater or less than the expected order of convergence the power series estimates with prescribed orders that best fits the data is selected with an increased f s 3 other researchers have questioned this substantial penalty for the uncertainty especially for datasets that exhibit monotonic convergence with an order that is near to two stern et al 2005a b coleman and stern 1997 viola et al 2013 11 δ φ max φ min φ n 1 when the error estimator has been selected the uncertainty is determined by comparing the data range parameter δ φ with the standard deviation of the fit σ f i t 12 u eça f s δ i σ f i t φ i φ f i t σ f i t δ φ 3 σ f i t δ φ f s δ i σ f i t φ i φ f i t σ f i t δ φ the first term may be recognized as the gci of roache the remaining terms are the standard deviation of the fit and the difference between the data value φ i and the fit φ f i t the ratio σ f i t δ φ serves as metric for the quality of the data available for error estimation for σ f i t δ φ 1 the factor of safety is increased in proportion to this ratio a full description of this procedure is given in eça and hoekstra 2014 2 2 grid set definition simulation verification as described above requires a set of grids that are geometrically similar and cover a range of grid sizes within the asymptotic range geometric similitude is achieved in the simplest sense by progressive subdivision of mesh cells for three dimensional problems the resulting grids may grow to exceed computing limits so that a compromise is necessary according to the available computational power three grid sets were defined for this verification exercise including one subset without boundary layer cells grid sets were defined to test the influence of cell distribution within the domain the influence of refinement diffusion ratio and the effect of grid similarity on the discretization uncertainty each set is composed of four grids spanning approximately one complete subdivision of the coarse grid r 2 an unstructured mesh for three dimensional complex geometries requires a definition for grid size this dimension must be a length that is descriptive of the grid and should decrease monotonically for a set of grids preferably with constant refinement ratio r roache suggests the following 13 h v o l v o l n 3 in which v o l is the volume of the computational domain and n the number of cells this definition for cell height is a global quantity it does not reflect the distribution of cells throughout the domain according to the refinement diffusion which is of particular importance for capturing flow structures around the hull as a consequence of these ambiguities in the volumetric cell height metric h v o l defined in equation 13 the observed order of convergence may not agree with the theoretical order of convergence in other words a second order discretization that is expected to converge with d x 2 may not behave accordingly with h v o l 2 simulation verification as described above requires a set of grids that are geometrically similar and cover a range of grid sizes within the asymptotic range geometric similitude is achieved in the simplest sense by progressive subdivision of mesh cells for three dimensional problems the resulting grids may grow to exceed computing limits so that a compromise is necessary according to the available computational power the construction of a systematically refined set of unstructured grids using the numeca meshing tool hexpress is achieved by varying initial cell subdivision which defines the cell size and refinement diffusion which defines the thickness of each refinement level such that refinement diffusion doubles with each grid subdivision d x 2 in fig 1 cells adjacent to a surface are given to illustrate these concepts in fig 2 a the wall has a refinement level equal to two and a refinement diffusion equal to one the size of the largest cell on the right is defined by the initial subdivision of the computational domain that cell is refined twice in the vicinity of the wall and each refinement level is one cell thick fig 2 b is a detail of the cells adjacent to the wall the refinement diffusion or the thickness of each refinement level is one in 2 c these cells have been divided once so that r 2 here the thickness of each refinement level is two which is to say that the refinement diffusion has doubled three grid sets were defined for this verification exercise including one subset without boundary layer cells grid sets were defined to test the influence of cell distribution within the domain the influence of refinement diffusion ratio and the effect of grid similarity on the discretization uncertainty each set is composed of four grids spanning approximately one complete subdivision of the coarse grid r 2 grid set a higher refinement diffusion grid set b smaller cell size at hull grid set c twice diffusion rate grid set cnobl no boundary layers inserted grid sets were defined such that refinement diffusion doubled when grid spacing was halved the domain refinements in the near and far field are varied for grid sets a and b the balance favours refinement in the far field for grid set a and refinement at the ship for grid set b meaning that for similar cell counts the cell size at the ship hull is larger for set a than for set b see fig 2 grid set c was defined with particular interest for the influence of refinement diffusion on the uncertainty for lateral force compared with sets a and b the refinement diffusion is increased at twice the rate while the cells at the hull were elongated to an aspect ratio of four to manage the size of the computational grids the d x reported for grid c is the average of the cell dimensions at the hull finally a subset of grid set c was defined that does not contain boundary layer cells for grid set cnobl not shown in fig 2 the fitting for diffusion rate vs cell size h v o l returns s h 2 06 a further complication is the inclusion of boundary layer cells at the hull which will vary in number according to size of the eulerian mesh d x and physical modelling requirement for the cell height adjacent to the hull for log law wall modelling the first cell height is defined to maintain 30 y 100 in so far as possible due to the recirculation region near the transom y values smaller than 15 were present for approximately 1 5 of the hull wetted surface the maximum y along the leading bilge was considered to be the driving consideration as separation is expected at that location simulations are carried out at model scale with a relatively low reynold s number of 2 3 106 and the requirements of the log law wall model were quickly satisfied with increasing grid refinement by relaxing the requirements for the log law model it was possible to define a grid subset without boundary layer cells for grid c2nobl the compromise between cell height metrics d x h v o l and refinement diffusion is apparent in the initial cell height which is smaller than desired for y details of grid construction are given in table 1 2 3 simulation method the simulation method for the production runs is designed for the assessment of hull geometry variants of the delft wind assist series considering the volume of work to be done at full scale a premium must be placed on economical simulations simulation verification is performed at model scale for the purposes of the validation as described in part 1 of this publication the validation statement and the extents of the range for modelling error made out of necessity at model scale is not directly transferable to full scale simulations whereas the reynolds number for the verification and validation exercise was 2 3e6 full scale simulations are performed for a reynolds number of 8 3e8 this difference of approximately 3 orders of magnitude means that the turbulence model will have to model a larger range of flow scales which is presumably detrimental for the modelling error on the other hand reynold s number 3e8 is above the transition regime to fully turbulent flow the ability to perform simulations at full scale is considered desirable in particular the ability to reproduce the full scale boundary layer the setup of the computational domain boundary conditions and the drift sweep procedure which are identical for the verification and validation exercise and for the full scale production runs will be described here the meshing strategy for validation runs is described under results in section 3 3 the rans equations are solved with the isis cfd flow solver developed at ecole centrale nantes the isis cfd flow solver is an incompressible unsteady rans method the unstructured spatial discretization for the transport equations is based on the finite volume method free surface flows are simulated with a conservation equation for the mass fraction a detailed description of the solver is provided in deng et al 2005 deng et al 2006 duvigneau and visonneau 2003 queutey and visonneau 2007 though the unsteady components of the vessel sailing response are not of interest the context of this study the flow condition is essentially unsteady and an unsteady rans simulation urans is performed the explicit algebraic stress model easm is selected as turbulence model to attempt a balance between a boussinesq type modelling and more elaborate modelling of reynolds stresses this k ω variant includes modeling for anisotropic turbulence which is understood to play a key role for the sailing performance of the ship hull while remaining viable within the scope of work and the available computational resources the evaluation of convective terms in the momentum equation and the turbulent stresses is performed with the alvsmart scheme a blended upwind central scheme based on the local courant number numeca int n d the solution for the free surface is determined following the volume of fluid method using the brics algorithm numeca int n d that is likewise dependent on the local courant number a summary of computation settings is provided in table 2 domain construction boundary conditions and meshing for the free surface are indicated in figs 3 and 4 a logarithmic wall model boundary condition is applied to the ship hull though it is understood that the correct prediction of separation strength and location is critical for correct modelling some components of the transverse force and that a logarithmic wall model is essentially unfit for this task however the increase in cell count for a wall resolved simulation no slip boundary condition is not realistic for the routine evaluation of hull variants besides controlling the total cell count and simulation computational cost the logarithmic law boundary condition resolves potential issues with the contact line problem finally the first cell height requirement of a wall resolved simulation that includes the free surface for full scale reynolds numbers may lead to stability issues for the flow solver the drift sweep procedure toxopeus 2011 was adopted for the efficient analysis of a series of leeway angles and speeds the domain is meshed once with the ship aligned with the x axis and assigned a prescribed motion including a leeway angle within a quiescent fluid as in fig 5 simulation cases proceed from a converged solution to the next combination of leeway angle and vessel speed using a gradual transition such that the time required for the convergence of the new solution is reduced compared with reinitializing the computation a coarse time step corresponding to a courant number of approximately 100 is adopted during this stage to accelerate the convergence of the flow field the time step is reduced in the final stage to the target courant number and integrated fluid forces on the ship hull are determined in the coordinate system aligned with the direction of forward motion vessel response may be unsteady due to shedding behaviour around the hull but only averaged forces are of interest within the context of this study integrated fluid forces on the hull are averaged over one characteristic time interval equal to l u the standard deviation for averaged quantities is returned as a measure of the convergence of the simulation to the steady state solution the parent hull of the delft wind assist series is used for this verification exercise the lines plan for the bare hull is given in fig 6 and the main particulars are given in table 3 the verification exercise is performed at model scale with a froude number equal to 0 168 equivalent to 12 knots at full scale the reynolds number for simulations is 2 33 106 integrated fluid forces on the model are determined in the coordinate system aligned with the direction of forward motion resistance x sideforce y and yaw moment n the sample interval for the verification exercise was 2 l u shown also in fig 6 see fig 7 see table 4 simulation convergence for the simulation residuals for the u 1 velocity component and the pressure p are reported as 14 l 2 i 1 n p δ φ i 2 n p where δ φ i is the normalized residual a measure of the change in the flow quantity φ between time steps for the verification exercise the integrated forces on the ship are the quantities of interest they are averaged over a sample interval equal to two characteristic time intervals 2 l u as in fig 6 the standard deviation for these quantities is reported as a metric for simulation convergence to the steady solution that is of interest table 4 the contribution of statistical errors associated with averaging of unsteady phenomena is neglected the simulation residuals are reduced to at least 10 5 for all cases the contribution of iterative errors to the numerical uncertainty as in equation 1 is assumed to be negligible 2 4 courant number study in the aforementioned procedure the time step is scaled together with the grid cell size maintaining a constant courant number and a consistency for the numerical method for the grid set the discretization uncertainty obtained with the procedure includes the effect of space and time discretization however it is desired to inform the choice of time step for validation runs and production runs as the blending switching of discretization schemes and the interface compression algorithm are functions of the local courant number the influence of the choice of time step is investigated with a series of simulations for varying time step courant values between 0 25 and 50 were achieved based on cell refinement at the hull away from the free surface the target courant number for validation and production runs is selected based on systematic variations in the courant number performed on three grids a2 b1 and b3 simulations for variations in courant number were performed at 6ᵒ leeway details for the courant number study are presented in table 5 3 numerical uncertainty the simulation verification exercise is performed for the forces integrated over the ship hull resistance x sideforce y and yaw moment n in the following the calculation of the simulation discretization uncertainty u d will be discussed for each component also the results for the courant number study are presented finally the meshing strategy grid spacing and target courant number are defined for validation simulations the numerical uncertainty is calculated according to the method of eça and hoekstra for the discretization uncertainty which includes the influence of errors due to spatial and temporal discretization the time step is scaled together with the grid spacing to maintain a constant courant number and a consistent numerical method simulation for grid set a were performed at 0ᵒ and 6ᵒ leeway simulations for grid set b was performed at 6ᵒ leeway simulations for grid set c and cnobl were performed at 0ᵒ and 9ᵒ all simulations for discretization uncertainty were performed for target courant number equal to four see table 8 for each component x y and n the following calculation details are reported the convergence ratio r p o b s the fit selected by the uncertainty procedure the ratio σ f i t δ φ the factor of safety applied the richardson extrapolated value φ 0 and the uncertainty u h v o l 0 07 for each grid set where all four grid sets overlap see table 1 this corresponds to a cell count of approximately 2e6 or grids a4 b4 and c2 finally uncertainties computed for each component on all grids are provided in table 9 the results for discretization uncertainty for β 0 appear to be congruent figs 7 and 8 the observed order of convergence is greater than the upper bound prescribed by eça and hoekstra so that a safety factor of three is applied for both cases table 6 a similar high observed order of convergence for resistance has been reported by eça and hoekstra eça and hoekstra 2008 the method switches to the second order fit the richardson extrapolated values for these grid sets show excellent agreement for all leeway angles tested for leeway angle β 6 the meshing approach taken for grid set a is apparently superior returning approximately half the uncertainty as grid set b even as the δ r e fitting is used in the uncertainty procedure for grid set b on the other hand the convergence ratio r is less than one for grid set b indicating oscillatory convergence leading to σ f i t δ φ 1 and a safety factor of 3 the uncertainty estimation for sideforce is compelling fig 9 the value of p o b s and the ratio σ f i t δ φ indicates that confidence is placed on these table 7 grid set b where resolution of the ship is favoured has an observed order of convergence that is in accordance with the interval specified by eça and hoekstra an 11 8 difference between the φ 0 value for grid set a and b is observed the discrepancy may be a product of the differing fits δ 12 and δ r e this discrepancy underscores the substantial grid uncertainty for sideforce still the largest grids a1 and c1nobl have an uncertainty of approximately 3 grid set cnobl constructed without boundary layer cells return the smallest uncertainties see fig 10 calculation details indicate that the quality of the fit and the degree of confidence in the uncertainty assessment are superior to that of grid set c grid set c and cnobl are otherwise identical in fact the grid quality for cnobl is detrimentally impacted by the absence of boundary layer cells as seen in fig 3 the boundary layer cells of grid set c have disrupted geometric similitude and while the physical modelling inconsistent y spacing and numerical properties non orthogonal cells near to the wall have both been compromised grid set cnobl returns superior calculation metrics and lower uncertainties this is interpreted as the influence of geometric similitude on the uncertainty assessment methods suggesting that the uncertainties returned following the methodologies in this paper may be overstated the procedure for the grid uncertainty of the yaw moment is very well behaved for grid set a fig 10 table 8 for other grid sets the convergence behaviour is such that the safety factor is increased to three and a second order fit is applied results from grids c and cnobl are poorly fit as indicated by σ f i t δ φ in particular c2nobl which exhibits oscillatory convergence and where the large difference for the term φ i φ f i t eqn 12 results in large uncertainties the richardson extrapolation value for zero grid spacing differs by 8 for grid c and cnobl the values for zero grid spacing of grid sets a and b lie within 3 of each other the results presented above can be better interpreted by recalling the grid set definition in terms of the cell size d x and the refinement diffusion see figs 1 and 2 first the large uncertainty values reported for grid set b are interesting as the cell size d x for grids b1 b3 is smaller than the cell size d x for grid a2 on the other hand the two largest grids a1 and c1nobl where quite small uncertainties are computed for all force components have the largest refinement diffusion this is interpreted as a consequence of proper resolution of the wake of shed vorticity associated with sideforce production for the grid definition for validation simulations the refinement diffusion parameter should be prioritised over cell size d x the general trend for the poor performance of grid set b does not hold for the uncertainty for sideforce u n u m y for grids a2 a4 and b2 b4 where the refinement diffusion varies uniformly one can observe in fig 9 the influence of the cell size d x on the sideforce uncertainty which increases quickly for grid set a after grid a2 cell size d x 0 006 l 500 3 1 courant number study time discretization uncertainties are determined for three grids a2 b1 and b3 following the same procedure as above the temporal uncertainty corresponding to a target courant number of four is reported this is the same target courant number used for the discretization uncertainty calculations presented above calculation details for grids a2 b1 and b3 indicate that confidence is placed in the time uncertainty estimates see table 10 the richardson extrapolations for zero time step and zero grid spacing show close agreements for resistance the φ 0 value for grid a2 and b1 differ by 2 3 finally the φ 0 values for zero time step and zero grid spacing for grid sets a and b differ by less than 1 each a marked increase in the uncertainty estimate is observed for the set of large courant numbers performed with grid set b1 see fig 11 table 10 for sideforce fig 12 courant number variation on grid b1 returns an observed order of convergence equal to 1 55 and σ f i t δ φ less than one yet the uncertainty u c o 4 is the largest calculated table 11 by contrast grids a2 and b3 returned an observed order of convergence outside the range prescribed by eça and hoekstra and switch to the mixed order fit δ 12 with safety factor equal to three the φ 0 value for grids a2 and b3 differ from φ 0 value of grid b1 by 5 9 and 3 1 respectively which is in accordance with the presence of considerable discretization uncertainty calculated for sideforce on these grids for a2 u d 13 b1 u d 14 b3 u d 17 finally the φ 0 value for zero time step for grid a2 differs from the φ 0 value for zero grid spacing for grid set a by 6 3 while the extrapolated values for zero time step for grid b1 and zero grid spacing for grid set b differ by 10 the value for yaw moment varies very little with courant number and the time discretization uncertainty is insignificant extrapolations for zero time step lie within 1 of each other and within 6 of the extrapolated zero grid size value see fig 13 table 12 the fitting for the observed order of convergence does not succeed the method of eça and hoekstra returns the safety factor of three with very small values for σ f i t δ φ except for grid b3 where oscillatory convergence is observed the time discretization uncertainties obtained by systematically varying the courant number are averaged at each target courant number and presented in table 13 along with the uncertainties determined on each grid the discretization uncertainty which includes the time uncertainty at c o 4 is provided for context if an rss combination for the simulation error is assumed as in equation 1 wilson et al 2006 15 u d 2 u g 2 u t 2 then the results calculated for u d and u t at c o 4 may be used to infer conclusions about the composition of the numerical uncertainty iterative errors have been neglected throughout this study the influence of the range of data in relation to the extents of the asymptotic range has been discussed the increased safety factor for anomalous convergence behaviour reflects the poor confidence placed on the uncertainty estimation results for courant variations on grid a2 are regarded as the most meaningful for this grid the contribution of time discretization uncertainty is only significant for the resistance for which u d 4 4 u g 3 9 and u t 2 1 a target courant number is determined by linear interpolation of the averaged values for u t such that the contributions of the spatial and temporal uncertainties to the discretization uncertainty are equal this condition is satisfied for courant number equal to 8 3 2 turbulence model and wall treatment the selection of the easm turbulence model is motivated by an appreciation for the physics of sideforce production where anisotropy in the dissipation of shed vorticity is understood to play a key role this is borne out in comparisons made using the validation data set for simulations with wall function using the k ω sst turbulence model and the easm turbulence model the result is reported as the comparison error for sideforce which is given as a percentage of the range of experimental values 16 e ens 100 s i m e x p 1 2 m a x e x p m i n e x p the comparison error for two wall treatments are plotted as histograms in fig 14 the wall resolved mesh is based on mesh a3 shown also in fig 15 below the statistics of the distributions are presented in table 14 including a 95 confidence interval of the ensemble comparison error which is understood as an estimate for the expected range of comparison errors for simulation of the delft wind assist series the negative outliers in fig 14 left correspond to hull 16 with sharp bilges where pronounced separation of bilge vortices is expected simulation for sideforce using log law boundary condition is consistently under predicted for this hull the results for the k ω sst turbulence model affirm the selection of the easm turbulence model as the modeling of anisotropic turbulence has centered the distribution and reduced the number of outliers whereas the results for a wall resolved simulation show further improvement this approach is not considered to be feasible in light of the scope of full scale production runs further discussion and results for the ensemble comparison error are included in part 1 the absence of boundary layer cells for grid set cnobl influences the solution near the wall as seen in fig 15 where a detail of the hull is shown as the keel line turns from the parallel midbody towards the upward sloping buttock lines of the pram stern a cross section of the computational domain is shown in the x z plane including cell borders and colour contours for the eddy viscosity ratio three solutions are shown grid a3 with four boundary layer cells top grid c2nobl middle and a wall resolved mesh bottom where a no slip boundary condition is imposed at the hull for this mesh thirty boundary layer cells are inserted to achieve a y less than one the thickness of the region of eddy viscosity production is similar for all meshes and lies within the thickness of the boundary layer cell region for grid a3 top the reduction in eddy viscosity ratio along the upward sloping keel observed for the wall resolved simulation is less evident for grid a3 finally the absence of boundary layer cells for grid cnobl clearly influences the flow inside the boundary layer where mesh irregularities were introduced in the snap to geometry step during mesh construction interestingly the quality of the data for richardson extrapolation as measured by p o b s and the ratio σ f i t δ φ indicate that greater confidence is placed in the uncertainty estimates based on grid set cnobl see section 3 2 as discussed in section 2 1 the methods for uncertainty assessment are predicated on geometric similitude which is better preserved for the grid set without boundary layer cells 3 3 mesh definition for validation and full scale production simulations a mesh for validation simulation is defined based on the results presented above for simulation verification and the parameter studies for courant number wall modelling and turbulence model selection the mesh resolution and time step is defined such that the contribution of the numerical uncertainty is commensurate with the other uncertainties in the validation exercise at the same time the mesh definition must be computationally affordable considering the volume of simulations planned precluding for example a wall resolved mesh the following guidelines are adopted for the meshing strategy the discretization uncertainty is reduced for grids with larger refinement diffusion or when the refinement of the domain is prioritised over refinement at the ship for both cases this is interpreted as a consequence of the resolution of the wake of the ship therefore the refinement diffusion in the downstream direction is favoured over the upstream direction cell size d x corresponding to l 500 is selected following the discussion of results for sideforce uncertainty for grids a2 a4 and b2 b4 four layers of boundary layer cells are inserted to satisfy modelling requirement for y at full scale 21 boundary layer cells are needed to satisfy the same requirement the mesh topology is otherwise identical shown also in fig 3 estimates for numerical uncertainty for validation simulations are given in table 15 with a cell size d x 0 0054 m and a refinement diffusion equal to 10 in the downstream direction the corresponding grid size h v o l 0 05 for a cell count of approximately 6e6 the mesh so defined for validation is not one of the grids studied as part of this verification exercise and numerical uncertainties were approximated by linear interpolation using h v o l and available results on grids sets a and c the time step is selected to achieve a target courant number of 8 following the discussion in section 3 2 these values are adopted in part 1 of this series describing the experimental validation for this simulation methodology 4 conclusion the numerical uncertainty for rans cfd simulations for integrated forces for the wind assist ship hull has been investigated the verification exercise described herein is a necessary prerequisite for the assessment of wind assist hull form variants using rans cfd simulations this work complements the validation exercise presented in part 1 of this series the sailing vessel operating with a leeway angle to produce hydrodynamic sideforce will trail a wake of large vortices the separation and evolution of which is understood to be the principal simulation challenge this two part series describes the development of a simulation method that can capture this phenomenon yet remain computationally affordable in light of the volume of simulations anticipated it was observed that grids with a large refinement diffusion exhibited superior performance as measured by the calculated uncertainties this is interpreted as a requirement on the refinement of the wake of the sailing vessel the influence of cell size at the ship hull was most apparent for the sideforce uncertainty improvement in geometric similarity for grid set cnobl defined without boundary layer cells gave better behaved convergence and resulted in lower uncertainty estimates implying that the uncertainty estimates for practical meshes with boundary layer cells may be overstated parameter studies included modeling choices such as wall treatment and turbulence model selection where an ensemble error and simulation computation time was used to design the methodology for full scale production runs of the delt wind assist series the meshing strategy and time step adopted for validation and production runs was defined numerical uncertainty for validation runs as adopted for the validation exercise presented in part 1 of this paper are presented in table 15 credit authorship contribution statement n j van der kolk conceptualization data curation formal analysis investigation methodology validation visualization writing original draft i akkerman writing review editing supervision j a keuning supervision r h m huijsmans supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is conducted with the support of the european commission as part of the joules project the author would also like to thank the vaderland fonds and the bijlboeg fonds for their support computations were performed at the sara supercomputer facility surf sara n d as part of sponsorship by nwo exacte natuur en wetenschappen enw nwo physical sciences division 
