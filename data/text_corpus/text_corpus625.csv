index,text
3125,cascade reservoirs are complex engineering systems the operation of these reservoirs is not only affected by external effects such as natural flow conditions but is also related to the state of the reservoir project the operating rules of the reservoirs and the operating mode of the discharge facilities the realization of refined simulations that can consider various natural and engineering factors is of great significance to improve the reservoir management level as a method to study the dynamic behavior of complex systems system dynamics sd simulation models have the potential to realize the refined simulation of cascade reservoirs however when the sd model is controlled by deterministic rules the various functional objectives of reservoirs cannot be weighed and emergent scenarios cannot be addressed in this paper a mechanical artificial intelligence ai coupling modeling paradigm is proposed in which the ai algorithm is used to extract adaptive operating rules and the sd method is used to refined simulate the operations of cascade reservoirs and the mechanism model and the ai algorithm are coupled to build the cascade reservoir adaptive refined crar simulation model the example application shows that the proposed model can be used to effectively reflect the dynamic change in system operations and realize the refined simulation of system operations and adaptive scheduling decisions under various conditions from this study a new idea and a reference for the simulation of cascade reservoir operations are provided keywords cascade reservoir system dynamics adaptive refined simulation artificial intelligence lstm data availability data will be made available on request 1 introduction currently cascade reservoirs are the main form of water resource development and are utilized in major rivers worldwide grill et al 2019 by changing the natural hydrological condition of rivers and reasonably allocating water cascade reservoirs can play an important role in flood control power generation irrigation and water supply management hogeboom et al 2018 on the one hand the construction of cascade reservoirs improves the defense ability against floods extreme rainfall droughts and other natural disaster events jing et al 2022 on the other hand cascade reservoirs have a high storage capacity and more flexible dispatching mode which helps maintain the stable operation of power grids and the optimal navigable flow state of rivers maximizes the water energy benefits of rivers li et al 2021b li et al 2022a and greatly reduce the impact of reservoir construction on the natural environment li et al 2022b yang et al 2020 based on the accelerated development of green and low carbon economies worldwide there is a growing call for the construction of a new energy system that is mainly focused on hydro wind solar integration this is an important component of the overall sustainable development strategy xu et al 2021 as a clean and zero carbon energy source dranka and ferreira 2018 hydropower is an important power source that provides flexibility and storage capacity thus playing a vital role in the construction of new energy systems chen et al 2020 pazheri et al 2014 however a reservoir does not always perform its functions as expected due to a variety of reasons there are phenomena such as insufficient power generation ecological deficits unreliable water supply and irrigation de silva and hornberger 2019 li et al 2021a raje and mujumdar 2010 simonovic and arunkumar 2016 and sometimes uncontrolled flow discharge which causes casualties and economic losses hartford et al 2016 king et al 2017 the causes of these phenomena include not only extreme natural conditions e g floods droughts and landslides and abnormal engineering components e g spillway cavitation damage and turbine excitation and gate failures but are also related to the operating rules of the reservoir and the operation mode of the discharge facilities according to an investigation of reservoir safety events the normality of the system function is often related to a large number of factors hartford et al 2016 leanna et al 2016 regan 2010 therefore to ensure the safe operation of a cascade reservoir system it is necessary to understand the operation logic and operation dynamics of the system under the influence of various complex factors currently reservoir operation simulation technology guided by mechanisms is the main modeling paradigm used to describe reservoir operation dynamics and is also an important means of reservoir operation planning and management fayaed et al 2013 rani and moreira 2010 many general simulation models e g hec ressim wrap modsim mikebase and weap have been developed and applied to decision making research optimal water resource allocation flood control power generation and other operation schemes for cascade reservoirs bangash et al 2012 hamlat et al 2013 kim and wurbs 2011 loucks and beek 2017 matrosov et al 2011 ozkaya and zerberg 2021 shourian et al 2008 theara et al 2020 generally in the operation of cascade reservoirs the outflow and power generation plan are formulated under the system operating rules according to the system state of upstream and downstream reservoirs at all levels including the water level and facility state of each reservoir in addition the operation actions through the generator units and other facilities are completed to drive the dynamic development of the system state of the reservoir at the next moment the generalized main link logic and driving relationship during the operation of cascade reservoirs are shown in fig 1 the dynamic process of a cascade reservoir is a large nonlinear and complex system dynamics problem that evolves under the joint action of many uncertain external environmental conditions and thousands of detailed components although the above general simulation model has a good operating interface the simulation process does not show the logical relationship between the operation links and components of the reservoir system in an obvious manner in addition the dynamic operation process cannot be shown therefore watershed managers or hydropower station operators may have difficulty understanding them prasad and mohan 2005 russell and campbell 1996 william and yeh 1985 furthermore the simulation model mainly focuses on the evolution of water flow in basins and rivers and the temporal and spatial distribution of the water volume in hydrological processes and the cascade reservoir space as there is a lack of refined simulations for the operation process of a reservoir system based on links to physical components such as the failure of engineering components and the application priority of discharge facilities deviations between the simulation results and actual operations may easily occur hartford et al 2016 system dynamics sd is a kind of simulation method that is used to study the complex structure causal logic and dynamic behavior of a system sd is based on the modeling of a feedback loop positive feedback and negative feedback between components and from the local to the whole system the component subsystem system as a result sd is better at analyzing the local detail dynamics and even the impact on the whole system and can be used to provide a favorable tool for solving the problem of refined reservoir simulation ahmad et al ahmad and simonovic 2000 proposed a general sd framework to simulate reservoir operations and applied it to the flood management of the shellmouth reservoir in canada they compared the reservoir operations under different rules and explored the impact of gated and unregulated spillways on flood management capacity teegavarapu et al teegavarapu and simonovic 2014 developed a real time dynamic simulation model to understand the dynamic behavior of a hydraulically coupled multi reservoir system king et al king et al 2017 used sd to evaluate the safety of the reservoir system and described each part of the system in detail jiang et al jiang et al 2020a jiang et al 2020b used sd to explore the impact of the operation of the three gorges reservoir on the environment these previous studies have provided insight into the potential of the system dynamics approach for refined reservoir simulation however the current reservoir simulation models based on sd mostly give the operating rules in the form of predefined condition functions and simulate the reservoir operation process based on these functions it only very superficial operating rules are defined in practical application scenarios the operation of reservoirs is very complex and does not only include balancing multiple objectives such as regulating the power grid load yuan and zhou 2017 stimulating fish spawning li et al 2022b and improving shipping conditions but also includes addressing various emergencies such as emergency operations for unexpected floods and landslides saavedra valeriano et al 2010 zhang et al 2018 the reservoir discharge and power generation processes calculated by predefined operating rules are bound to deviate greatly from the actual situation especially when the reservoir is under off design operation conditions to address the uncertainty of reservoir inflow and the nonlinear trade off between different objectives many researchers are devoted to studying the adaptive operating rules of reservoirs to extract the characteristics or laws of the operating rules from historical operation experience or the results of optimization simulations adaptive operating rules can be divided into explicit and implicit operating rules according to their forms bin et al 2017 explicit operating rules have definite functional expressions the fitting method and simulation based optimization sbo are the most common methods used to determine the explicit operating rules liu et al 2014 after determining the function expression of the operating rules the fitting method uses linear regression or the nonlinear fitting method to determine the operating rules from the results of the deterministic optimization model bhaskar and whitlatch 1980 young 1967 the sbo takes the parameters of the operating rule function as decision variables and uses the optimization method to determine the best function parameters in the iterative search process of the simulation model celeste and billib 2009 chang et al 2005 feng et al 2017 zhou et al 2019 however both the fitting method and sbo involve solving rules within the optimization framework for multiobjective reservoirs there are often many optimization objectives and singular results are not usually obtained instead the results are usually in the form of pareto sets therefore managers need to make continuous intervention decisions according to the reservoir characteristics which requires a manager with a higher professional level and more practical experience in recent years with the development of the internet of things and cloud computing technology there has been rapid growth in all kinds of data frankel and reid 2008 researchers have begun to pay attention to the laws and values behind the data itself and scientific research has begun to enter the big data research paradigm of data driven scientific discovery xue qi 2012 as an important analysis method in the era of big data the artificial intelligence ai model is good at finding hidden causality from massive data realizing the accurate simulation and scientific prediction of complex systems and promoting the transformation of the scientific research paradigm in physics chemistry hydrology the environment and many other fields oussous et al 2018 in the field of reservoir operations the ai model shows unique advantages in the extraction of implicit reservoir operating rules zhang et al 2018 different from the solution method that determines the expression form of a function the ai model can be used to independently learn the operating rules from a large amount of historical operation data comprehensive optimization decision making results that are in line with the characteristics of the reservoir under various complex conditions result from these models moreover these results are feasible rules that have been tested in practice yang et al 2021 zhang et al 2019 in addition the ai model has a fast response time after the model is built decisions can be made according to real time information without human selection or intervention hejazi and cai 2009 currently classical ai models such as backpropagation bp neural networks support vector regression svr support vector machine svm and new ai models such as long short term memory lstm gated recurrent units grus and extreme learning machines elms have been successfully applied to the extraction of reservoir operating rules chaves and chang 2008 chen and chang 2009 feng et al 2019 hipni et al 2013 ji et al 2014 su et al 2013 in summary a mechanism ai coupling modeling paradigm is proposed to realize the adaptive and refined operation simulation of cascade reservoirs under the influence of various complex factors the main research points include the following 1 the cascade reservoir system dynamics crsd model is constructed by using the sd method to realize the refined simulation of the system 2 the adaptive operating rule extraction model is constructed by using the lstm algorithm 3 the cascade reservoir adaptive refined crar simulation model is constructed by coupling lstm and crsd which is then combined with the proposed sequential cyclic iterative solution method to realize the refined simulation of the reservoir operation process at each time and the adaptive decision making of the operation scheme 4 the xiluodu xiangjiaba xld xjb cascade reservoir in china is taken as a demonstrative case to verify the applicability of the model 5 the advantages and limitations of the model are discussed and the direction of future research is described thus we aim to provide ideas and references for simulating cascade reservoir operation 2 methodology 2 1 overview the building process of the cascade reservoir adaptive refined simulation model based on the mechanism ai coupling modeling paradigm is shown in fig 2 first according to the operation mechanism characteristics of the artificial regulating system the sd method is used to build the crsd model to realize the refined simulation of the system operation second the adaptive operating rule of the reservoir is extracted from the historical operation data by using artificial intelligence technology lstm is selected in this study finally the crar model is constructed by coupling these two models 2 2 crsd model almost all major rivers in the world have built cascade reservoirs thus the natural river system has gradually evolved into an artificial runoff regulation system with reservoirs in series or in parallel junqiang et al 2022 this is an open complex and mega system structure state and actuator are three typical dimensions used to describe complex artificial systems as shown in fig 3 the structure of the cascade reservoir system includes river topography the spatial distribution of upstream and downstream cascade reservoirs reservoir characteristics and the hydraulic relationships determined by the reservoirs when various external factors such as rainfall upstream inflow and interval confluence act on the system structure the state of the system will be changed the state of the cascade reservoir system includes the water level storage capacity facility state and flow of downstream rivers according to the current system state and the reservoir operating rules outside the system the action of system facilities will be affected changes in the action of the system will change the state of the system as a result the feedback adjustment mechanism of the artificial system is formed based on the typical dimensions of the complex artificial system described above and the mechanism characteristics of the driving feedback of the cascade reservoir system we attempt to build a general crsd model by applying the sd modeling theory in the construction of the sd model it is first necessary to determine the variables that reflect the system operation structure according to the developer s understanding of the operation logic of the system according to their different functions all variables can be divided into stock flow and auxiliary variables each variable is connected through connectors that represent causal relationships the stock variable represents the accumulation of system status and the flow variable represents the rate of system accumulation auxiliary variables represent other variables related to system operation the stock and flow diagrams composed of each variable and connector are the most intuitive representations of the sd model according to the operation process of the cascade reservoir system shown in fig 3 we divide the crsd model into three parts structure state and action this section describes the composition of each part in detail and the stock and flow diagrams of each part is given in the appendix 2 2 1 system structure sector the cascade reservoir system consists of several interconnected reservoirs built on a river therefore the system structure should consider the number of reservoirs and the hydraulic connection between them generally the hydraulic connection between cascades can be divided into two aspects the impact of upstream reservoirs on downstream reservoirs and the impact of downstream reservoirs on upstream reservoirs teegavarapu and simonovic 2014 on the one hand the discharge of the upstream reservoir will affect the inflow of the downstream reservoir on the other hand affected by the backwater of the downstream reservoir the tail water level of the upstream reservoir will change which will affect the power generation head of the upstream reservoir and lead to a difference in the power generation of the reservoir therefore the crsd uses tailwater elevation curves to calculate the head required for energy generation the system structure sector of the crsd is shown in fig a1 2 2 2 system state sector the system state sector includes the main process of reservoir water storage and water conveyance in this sector the stock variable is reservoir storage the flow variables include the inflow outflow overflow and other losses of the reservoir for the first reservoir in the cascade reservoir system the inflow comes from the external input of the model which may be historical data or results obtained from other prediction models for the other reservoirs in the cascade the inflow comes from the outflow of the upstream reservoir and the local inflow between the two reservoirs overflow refers to the overtopping flow when the reservoir storage exceeds the maximum storage capacity during reservoir operation water loss caused by evaporation is a problem that cannot be ignored tilmant et al 2002 therefore another system loss is set up in this study to calculate the change in the water amount caused by water surface evaporation according to the engineering characteristics of most reservoirs there are three outflow modes the power outflow gate outflow and spillway outflow the appropriate outflow modes can be modified by different reservoirs according to engineering construction differences when the reservoir inflow is determined the outflow plan of the reservoir can be obtained through the operating rules the actual outflow of different facilities can be determined by combining the outflow plan with the operation mode of the discharge facilities the system state sector of the crsd is shown in fig a2 2 2 3 actuator sector the purpose of the actuator sector is to determine the actual outflow of each facility of the reservoir according to the outflow plan and operation mode of the facility in addition as the power generation of the reservoir is closely related to the power outflow the energy of the reservoir is modeled as the stock variable in the actuator sector among the renewable energy systems hydropower accounts for more than 85 of the world s renewable electricity production and more than 150 countries now produce hydroelectricity pazheri et al 2014 almost all of the constructed cascade reservoirs have the function of power generation in addition based on operability the discharge structures at a given reservoir can be divided into controllable discharge facilities and uncontrolled discharge facilities controllable discharge facilities control the outflow through a gate operated by a hoist and uncontrolled discharge facilities involve structures such as spillways therefore the reservoir discharge facilities considered in this study include three parts generator units gates and spillways it should be noted that researchers can add and modify the discharge facilities according to the actual situation in their own research projects generally there is a corresponding relationship between the discharge capacity of different facilities and the reservoir water level which can be defined according to the actual situation of the project to simulate the operation conditions of damaged engineering components three variables the availability of the gate the availability of the spillway and the availability of the turbine which range from 0 to 1 are added in the actuator sector to control different damage conditions of the engineering components it should be noted that the structure of the reservoir discharge facilities in actual operations is highly complex and there are many reasons why damage to the engineering components may occur for example the possible sources of damage to the power outflow include guide vane damage and motor damage the gate can also be unavailable due to the failure of the gate itself or failure of the hoist hartford et al 2016 in this study the project damage is simplified in the model the actuator sector of the crsd is shown in fig a3 2 3 lstm model lstm is an improved recurrent neural network rnn that was developed by hochreiter in 1997 hochreiter and schmidhuber 1997 as a sequential deep learning model it can fully exploit the time sequence information in the training data and can effectively avoid the problems of gradient disappearance and gradient explosion that affect traditional artificial neural networks in recent years the use of lstm to extract the operating rules of reservoirs has attracted increasing attention zheng et al 2022 the core components of each lstm cell include the forget gate input gate cell state and output gate as shown in fig a4 first the forget gate is used to filter and discard the output information from the previous cell and the current input information then the retained information is transmitted to the input gate eq 1 next the input gate is used to determine which of the information it received needs to be updated and added to the cell state eq 2 and eq 3 finally the output gate is used to determine which information in the current cell is output to the next cell eq 4 and eq 5 the lstm model utilized in this study includes one input layer one hidden layer and one output layer the real time backpropagation through time bptt algorithm is used to continuously adjust the weight and threshold to train the network forget g a t e f t σ w f x t u f h t 1 b f input g a t e i t σ w i x t u i h t 1 b i cell s t a t e c t f t c t 1 i t tanh w c x t u c h t 1 b c output s t a t e o t σ w o x t u o h t 1 b o hidden s t a t e h t o t tanh c t in the above equations f t i t c t and o t represent the forget gate input gate cell state and output gate respectively x t represents the current input vector and h t denotes the hidden output additionally w f w i w c w o u f u i u c u o b f b i b c b o represent the input weight matrix recurrent weight matrix and bias vectors of the forget input output and potential cell gates respectively finally σ and tanh represent the logistic sigmoid function and hyperbolic tangent activation function respectively 2 4 crar simulation model the crar model is used to realize the adaptive refined simulation of cascade reservoirs under different operating conditions by coupling the crsd model and lstm model the crsd and lstm coupling mode for each crar block is shown in fig 4 the current system inflow and reservoir water level which are provided by the crsd are used as the input of the lstm cell the outflow plan which is automatically generated through the lstm cell is then fed back to the crsd so that the actual distribution scheme of the total outflow between different discharge facilities based on the engineering conditions and the discharge capacity of different discharge facilities can be generated considering the operation of cascade reservoirs at each moment will have an impact on the system state at the next moment therefore a sequential cyclic iterative solution method for the crar model is proposed the outflow at the previous moment is fed back to the current moment as a boundary condition to calculate the system state at the current moment combined with the current inflow the solution of the reservoir outflow plan using crar is fed back to the next moment therefore the cyclic iteration is realized between every moment 3 application 3 1 system description and data source the xiluodu xiangjiaba xld xjb cascade reservoir is located in the jinsha river tributary in the upper reaches of the yangtze river both reservoirs are mainly for power generation and have comprehensive benefits such as flood control sediment detention and improved shipping conditions the total storage of xld is 129 1 108 m3 with an installed capacity of 13860 mw and it is the fourth largest hydropower station in the world the available outflow facilities of the reservoir include 18 generator units expressed as power outflow 8 bottom outlets expressed as gate outflow 7 crest outlets and 4 spillways the total storage of xjb is 51 63 108 m3 with an installed capacity of 6400 mw and it is the eleventh largest hydropower station in the world the available outflow facilities of the reservoir include 8 generator units mid level outlets and crest outlets since the outflow capacity and operation mode of the mid level and crest holes of xjb are not clearly explained by the data collected in this study they are simplified and unified as gate outflow in addition the xld and xjb control basins account for 96 and 97 of the total area of the jinsha river basin respectively and the two reservoirs are relatively close to each other therefore the local inflow of the two reservoirs is not considered in this paper the locations of the two reservoirs and the layout of the outflow facilities are shown in fig 5 the data used in this study were collected from the two reservoirs from january 1 2016 to december 31 2020 and include the historical operation data i e daily inflow reservoir water level and outflow the daily power generation reservoir water level different facilities outflow capacity curves water level storage capacity area curves and tailwater elevation outflow curves all data were collected from the cascade dispatching center of china yangtze power co ltd 3 2 model building according to the model construction method described in section 2 the crar model is built following the actual xld xjb conditions the main contents include the following 1 use the sd method to structure the xld xjb system and 2 set the lstm model parameters and extract the adaptive operating rules based on the historical operation data 3 2 1 crsd of xld xjb referring to the generic crsd model structure in section 2 2 a crsd model suitable for xld xjb is built fig 6 in this figure the pink text represents the lstm input and the red text represents the lstm output the model in this paper is constructed by vensim9 0 due to the lack of vensim9 0 programming ability the whole model is developed by using the python language through the pysd houghton and siegel 2015 software package table 2 provided a detailed description of all variables in combination with the example application of the model since the simulation principle of each reservoir in the cascade reservoir system is the same the function expression of most variables is applicable to any reservoir in the cascade system therefore a single reservoir is taken as an example to explain the function and only the necessary differential variables of cascade reservoirs and the variable function differences caused by the setting of scenario conditions are specifically explained 3 2 2 lstm model building based on the commonly accepted 80 20 split rule when using lstm to extract the operating rule the data from january 1 2016 to december 31 2019 are used as the training data and the other data are used as test data the collected historical data are used as input and output to lstm to facilitate coupling with crsd to realize real time decision making the input data of lstm are set as the reservoir inflow and reservoir water level at the particular moment and the output data are the outflow at the particular moment the maximum iteration mi of lstm in reservoir operation simulation has the greatest influence on the simulation accuracy zhang et al 2018 therefore in this paper when using lstm to extract the operating rules of xld and xjb we set the number of hidden nodes to 50 and the mi to 50 100 150 and 200 the most appropriate model parameters are selected by comparing the corresponding statistical indicators 3 3 scenario design to demonstrate the application of crar in the adaptive refined simulation of cascade reservoirs four possible scenarios of system operation are set up according to the operation conditions of the discharge facilities and engineering component failures the system inflow is set as shown in fig 7 the applicability of the model is explored with a one year simulation period table 1 presents each simulated scenario in detail it should be noted that the operation scenario designed in this paper was only used for the application of the model and is not representative of the actual operational policy of xld xjb 4 results 4 1 comparison of the lstm parameter settings the extraction effect of the lstm model using four groups of parameter settings on the operating rules of the two reservoirs is compared by taylor diagram as shown in fig 8 and table 3 the red dots at the bottom axis of the diagram represent the observation and the markers with different shapes represent lstm with different parameter settings the closer of the markers to the observation the better performance in the context of the pearson correlation coefficient r2 the root mean square error rmse and the standard deviation std taylor 2001 notably the r2 values of the lstm model under different parameter settings are all greater than 0 9 further confirming the advantage of lstm in the extraction of the reservoir operating rules when mi is 200 the simulated result is closest to the observed value therefore the lstm model with 50 hidden layer nodes and an mi of 200 is adopted to extract the operating rules of the two reservoirs in the example application 4 2 applicability of the crar model in this paper the applicability of the crar model is explored from two aspects model validation and simulation error model validation is used to quantify our judgment of the predictive power of the model by comparing the output data of the model with the measured data to fully illustrate the operation capability of the crar simulation system the differences between the three main variables calculated by the model and the measured data from january 2018 to january 2021 are compared fig 9 the simulation results from the crar model have a similar general trend with the observation data which proves that the model has good reproducibility for the operation characteristics of the actual cascade reservoirs the nash sutcliffe efficiency nse coefficient is used to calculate the simulation effect of the model table 4 previous studies have shown that when the nse is greater than 0 5 the simulation effect can be considered to meet the needs of the study moriasi et al 2007 therefore the crar model proposed in this paper can be used to solve the problem of the adaptive refined simulation of cascade reservoirs it is also shown that the reservoir operating rules extracted by the lstm model are real and effective we used the mean absolute error mae and mean relative error mre to analyze the simulation error and performance of the crar model mae reflects the difference between the simulation results and observed values and is a common indicator of model error willmott and matsuura 2005 mre reflects the difference between simulated error and observed values eliminating the influence of different dimensions thus mre can be used to analyze the error difference between different variables the indicators calculations are shown in eq 6 7 to eliminate the influence of model randomness as much as possible the model was run 20 times on the same computer the results are shown in fig 10 6 mae 1 n i 1 n o i s i 7 mre 1 n i 1 n o i s i o i where o i and s i are the observed and simulated values respectively and n is the total number of observations the average maes of the outflows of the two reservoirs are 626 84 m3 s and 697 34 m3 s respectively and the error for xld is obviously smaller than that for xjb affected by the hydraulic connection between the cascades the outflow error of the upstream reservoir will lead to an error in the inflow of the downstream reservoir further increasing the error of the outflow flow of the downstream reservoir however there is no significant difference in the mre values of the outflows between the two reservoirs with averages of 0 175 and 0 176 respectively due to the large storage capacity of xld the water level of xld changes within the range of 540 600 m during the whole simulation period while the water level of xjb only changes within the range of 370 380 m therefore the mae of the water level of xld 5 17 m is clearly higher than that of xjb 2 51 m according to fig 6 the change in daily power generation is closely related to the outflow and the water head influenced by the errors in these two variables the mre of daily power generation is higher than the mre of outflow and the mre of water level with average values of 0 215 and 0 182 respectively in addition the mae value of the daily power generation of xld is higher than that of xjb with average mae values of 0 30 and 0 15 respectively 4 3 simulation results of the different scenarios the crar model was used to achieve the adaptive simulation of the system under different refined conditions in section 3 2 four scenarios of system operation were designed the operation details of the system under the four scenarios are shown in figs 11 and 12 the same change trend was generally observed for the total outflow of the system under the four scenarios presented before june 1 the total outflow of the two reservoirs remained between 1000 m3 s and 3000 m3 s and no significant difference was found between the four scenarios after june 1 the flood season began and the total outflow gradually increased reaching its peak on august 20 in scenario 4 to minimize water abandonment the total outflow was limited during the maintenance period of the unit therefore in june and july the total outflow of the two reservoirs was significantly lower for scenario 4 compared with that of the other three scenarios for scenario 4 the maximum discharge of xld was 3725 m3 s and that of xjb was 3505 m3 s figs 11a and 12a from january to june the water level of the two reservoirs showed a downward trend but after june with the arrival of the flood season the water level of the reservoirs gradually increased in scenarios 1 3 the normal water level was reached by the end of august due to the limited discharge water level of the two reservoirs in scenario 4 reached the normal water level as early as july 1 figs 11b and 12b the operation details of the discharge facilities of the two reservoirs are shown in figs 11c e and 12c d before june 1 the outflow plan was low due to the small inflow of the system therefore all the outflows of the two reservoirs in all scenarios were discharged through the generator units and the outflows through the gate and spillway were 0 after june 1 the system inflow gradually increased the two reservoirs began to use other discharge facilities in addition to the generator units as the outflow capacity of the generator units in scenario 3 and scenario 4 was damaged the maximum outflow of the generator units in the two reservoirs in these scenarios from june to september was lower than that in scenario 1 and scenario 2 the maximum outflow was 3725 m3 s and 3352 m3 s for scenario 3 and scenario 4 respectively figs 11c and 12c however the operation mode of the reservoir was not adjusted in scenario 3 resulting in the difference between the two scenarios therefore in scenario 3 xld was the first to use the gates for discharge under the insufficient discharge capacity condition of the generator units in scenario 4 the xld gates were not used for discharge until the reservoir water level reached the normal water level figs 11d and 12d during the flood season when the maximum discharge capacity of the generator units was reached other discharge facilities were opened for additional discharge in the four scenarios in scenario 2 the application mode of the xld discharge facilities was changed as only two gates were opened for discharge therefore the maximum gate outflow of xld in scenario 2 was 3076 m3 s fig 11d which was lower than the maximum gate outflow for the other three scenarios and a large amount of flood was discharged through the spillway on august 20 the spillway outflow peaked at 15299 m3 s fig 11e in addition due to the damaged discharge capacity of the generator units the gate outflow in scenario 3 and scenario 4 was significantly higher than that in scenario 1 and scenario 2 figs 11d and 12d figs 11f and 12e show the daily generation of the two reservoirs the daily generation in the flood season was significantly higher than that in the nonflood season the difference in power flow is the main reason leading to the change in the daily generation therefore daily generation and power outflow show the same trend figs 11c f and 12c e in scenario 3 and scenario 4 the reduction in the maximum generator discharge capacity was the main factor leading to smaller daily generation it should be noted that although the maximum generator discharge capacity in scenario 3 and scenario 4 was the same in scenario 4 the daily generation of the two reservoirs was increased in june due to the rise in the reservoir water level which also indicates that the increase of head will lead to the increase in the daily generation 5 discussion 5 1 optimization of the system operation mode in different scenarios figs 11b and 12b show that during the whole simulation period the water level of xld is lower than 600 m and that of xjb is lower than 380 m thus in the four scenarios simulated in this paper the two reservoirs are both in a safe state and there is no overtopping fig 13 shows the comparison of the energy of the system under the four scenarios under the same engineering conditions scenario 2 and scenario 4 improved the generation head by changing the operation mode of the discharge facilities thus increasing the overall capacity of the system compared with that in scenario 1 the system power generation in scenario 2 increased by 5 0 108 kw h and compared with that in scenario 3 the system power generation in scenario 4 increased by 10 3 108 kw h therefore for xld xjb the main goal of which is to generate electricity under the condition that the generator units are not damaged the discharge mode of using the gate and spillway tunnel together scenario 2 is beneficial for improving power generation in the case of generator unit damage the overall power generation of the system can be improved by reducing system leakage during the maintenance period and reducing abandoned water scenario 4 5 2 model uncertainty due to the inherent uncertainty in reservoir operations it is necessary to analyze the uncertainty of the model liu et al 2019 in general model uncertainty may exist in any of the three parts the model input model itself and model output zhou et al 2019 the input of the crar model includes the system inflow and engineering conditions for the scenario simulation as well as historical operation data for extracting the operating rules the system inflows are denoted as inflow and local inflow in the model and the engineering conditions are input through several sets of if then else functions the historical operation data are obtained according to actual measurements so there is no possibility of uncertainty but for possible operation scenarios in the future the system inflow and engineering conditions must be uncertain chen et al 2016 however this study is only to illustrate the application of the model therefore a certain operation scenario is given in other words if a probabilistic prediction model that can describe the uncertainty of the system inflow and the uncertainty of the engineering condition damage is constructed and used as input in crar the application of the crar model will be greatly encouraged in practice zhao et al 2012 in addition the crar structure developed by the sd method is essentially rigid however it should be noted that relevant ai algorithms are used in the crar solving process ai technology is essentially based on data driven rule fitting which is susceptible to the influence of the model parameters that are set and the training data therefore there is uncertainty in the outflow plan generated by ai technology tapoglou et al 2020 however in the crar actuator sector the outflow plan is converted into actual outflow according to the actual operation conditions of the project therefore the impact of the uncertainty is minimized in a certain sense with the continuous increase in data acquisition in the future it is expected that the uncertainty of the ai model will be reduced through massive data training furthermore the crar output in this study takes into account the reservoir outflow the reservoir water level the daily power generation the outflow of different facilities and the total power generation in the simulation period in fact the model constructed by the sd method has the advantage of user defined model output for example in simonovic s study the model outputs are power generation performance and irrigation performance simonovic and arunkumar 2016 and in jiang s study the model outputs consider the amount of spawning and sediment flushing jiang et al 2020a jiang et al 2020b however the output variable itself is completely generated by the solution of the model structure relationship so reducing the input uncertainty of crar will inevitably reduce the output uncertainty 5 3 model advantages as a necessary means to solve the problem of scientific operations of cascade reservoirs the model used should be easy to understand and operate the model can be intelligent with respect to the decision making process as well as with the basic physical laws of reservoir operations in addition the model can be used to realize the system operation simulation under various complex conditions therefore a crar model with intelligibility intellectuality universality extendibility and refined simulation is developed in this study the crar structure developed by the sd method is based on graphic modeling according to the basic logic of cascade reservoir operations the cascade reservoir system is divided into three sectors the system structure state and actuator sectors the transparent model development mode fully reveals the internal logical relationship of cascade reservoir operations compared with traditional simulation methods it is more helpful for operators to understand and analyze the dynamic behavior of complex systems in the actuator sector of the model the crar is used to independently model different discharge facilities according to the actual situation of the reservoir and control the use priority of different discharge facilities through the condition function furthermore in crar the equipment availability is represented as a constant from 0 to 1 users can simulate the possible operating conditions of system damage by adjusting the equipment availability value therefore crar can be used for refined simulation of cascade reservoir operation crar uses ai technology to autonomously learn operating rules from historical data in the simulation process the ai model generates the outflow plan according to the real time state of the system reservoir inflow and water level at each moment transforms the outflow plan into actual outflow according to the actual situation of the facility for operation and changes the system state at the next moment the self feedback iterative solution of the system is realized the state of the system at different moments is constrained by the water balance equation therefore crar is more intelligent than the physical model based purely on the water balance equation approximately two thirds of the world s rivers contain cascade reservoirs with the continuous improvement of engineering construction the research focus of cascade reservoirs has gradually transferred from engineering construction to engineering operation management hogeboom et al 2018 due to the water regime of different river basins and the design differences of different reservoir projects different research objects and objectives also have different requirements for reservoir simulation models the construction of the crar follows the general form of a cascade reservoir and takes the water balance equation and power generation calculation equation as the governing equations of the model the model structure is suitable for any reservoir with storage and power generation functions for different research objects only the corresponding research data such as water level storage capacity area curves and tailwater elevation outflow curves need to be replaced in addition the sd method has fixed model composition forms stock flow auxiliary variables and connection lines users can modify or add the composition of the model according to different research needs to build models that meet their own research objectives in fact relevant studies have used the sd method to combine the operation of reservoir systems with other systems such as the environment agricultural yield and slope safety systems de silva and hornberger 2019 jia et al 2021 jiang et al 2020a jiang et al 2020b therefore crar has both universality and extendibility in practical applications 5 4 limitations and future research cascade reservoir operation is a complex system process due to the limitations of cognition and the availability of data this study also has some limitations first although the overall structure of the crar provides some operational details of the system it is still somewhat simplified in many areas for example 1 the flow transmission delay between reservoirs is ignored and 2 only the availability is used to represent the possible damage of engineering components secondly there are a variety of model applications in the field of reservoir operations for current ai technology such as ann svr gru and elm only lstm is used in this paper to extract the adaptive operating rules of the reservoir and the performance comparison of using different ai models to extract the operating rules in the crar model is lacking only lstm is used in this paper to extract the adaptive operating rules and a comparison between various models is not provided in addition due to the influence of hydrological forecasting errors there is a high uncertainty in the runoff process of the reservoir scenario simulations based on historical measurement data are conducted assuming that all runoff inputs are known which may limit the application of crar in practice therefore future studies based on this study may include 1 adding a more comprehensively detailed representation and mathematical description to the current model structure according to the growth of knowledge to achieve more complex and accurate operation simulations and 2 comparing the rule extraction effects of various ai models and selecting the most appropriate ai model 3 the crar model was coupled with a hydrological forecasting model and the uncertain runoff process was used as a model input to evaluate the simulation ability of the crar model under uncertain conditions 6 conclusion the simulation of reservoir operations is an essential research method for scientific reservoir management the sd method can reflect the causal dynamic relationship in system operations and can be used to realize the refined simulation of reservoir operations however a large number of reservoir simulation models constructed by the sd method are solved in the form of a specified operating rule in the simulation process which cannot be used to weigh various functional objectives of reservoirs and deal with emergent scenarios in the actual operation process therefore the application of the sd method is limited in practice operating rules extracted from historical data based on ai technology hide the decision preferences of managers when weighing various scheduling objectives and dealing with emergencies however these methods have the advantage of real time decision making in this paper a cascade reservoir adaptive refined crar simulation model based on a mechanism ai coupling modeling paradigm is proposed this model combines the operating rule extracted by ai technology with the sd method taking xld xjb in china as a case study the practical applicability of crsr is explored the main conclusions are as follows 1 the developed crar model can effectively reflect the dynamic changes of the cascade reservoir system and the transparent model structure based on sd provides some details in the operation of the cascade reservoir system which has good intelligibility in addition the model can consider the water distribution among the discharge facilities and the damage condition of engineering components to carry out refined operation simulation 2 crar takes the water level and inflow at the time of the system operation as the input conditions of the model takes the reservoir operating rule extracted by ai technology as the guidance controls the operation of the system through the sequential cyclic iterative solution method and provides the reservoir operation scheme to deal with various operating conditions to realize the adaptive intelligent decision making of the system 3 the applicability of the model in actual scheduling management is verified by an example for xld xjb under the condition that the generator units are not damaged the operation mode of the gate combined with the spillway is helpful to improve the power generation when the generator units are damaged the total power generation of the system can be improved by reducing the outflow during the maintenance period thus reducing the amount of abandoned water the results show that the model can be used for refined operation simulation and operation strategy formulation of cascade reservoirs in response to various daily and emergency situations providing a scientific guiding tool for reservoir operation management credit authorship contribution statement boran zhu writing original draft methodology conceptualization investigation jun liu writing review editing supervision junqiang lin writing review editing resources yi liu project administration resources di zhang visualization writing review editing yufeng ren data curation validation qidong peng funding acquisition visualization jing yang funding acquisition supervision huaijie he software supervision qiong feng software data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china no 52192672 the national key research and development program of china no 2018yfe0128500 the state key laboratory of simulation and regulation of water cycle in river basin skl2020zy10 the science and technology project of huaneng group headquarters hnkj20 h26 appendix in order to facilitate readers to understand the modeling method proposed in this paper and to promote the application of crar model this appendix provides all concept diagrams involved in the process of model construction including the stock and flow diagram of each part of crsd model and the schematic diagram of lstm model 
3125,cascade reservoirs are complex engineering systems the operation of these reservoirs is not only affected by external effects such as natural flow conditions but is also related to the state of the reservoir project the operating rules of the reservoirs and the operating mode of the discharge facilities the realization of refined simulations that can consider various natural and engineering factors is of great significance to improve the reservoir management level as a method to study the dynamic behavior of complex systems system dynamics sd simulation models have the potential to realize the refined simulation of cascade reservoirs however when the sd model is controlled by deterministic rules the various functional objectives of reservoirs cannot be weighed and emergent scenarios cannot be addressed in this paper a mechanical artificial intelligence ai coupling modeling paradigm is proposed in which the ai algorithm is used to extract adaptive operating rules and the sd method is used to refined simulate the operations of cascade reservoirs and the mechanism model and the ai algorithm are coupled to build the cascade reservoir adaptive refined crar simulation model the example application shows that the proposed model can be used to effectively reflect the dynamic change in system operations and realize the refined simulation of system operations and adaptive scheduling decisions under various conditions from this study a new idea and a reference for the simulation of cascade reservoir operations are provided keywords cascade reservoir system dynamics adaptive refined simulation artificial intelligence lstm data availability data will be made available on request 1 introduction currently cascade reservoirs are the main form of water resource development and are utilized in major rivers worldwide grill et al 2019 by changing the natural hydrological condition of rivers and reasonably allocating water cascade reservoirs can play an important role in flood control power generation irrigation and water supply management hogeboom et al 2018 on the one hand the construction of cascade reservoirs improves the defense ability against floods extreme rainfall droughts and other natural disaster events jing et al 2022 on the other hand cascade reservoirs have a high storage capacity and more flexible dispatching mode which helps maintain the stable operation of power grids and the optimal navigable flow state of rivers maximizes the water energy benefits of rivers li et al 2021b li et al 2022a and greatly reduce the impact of reservoir construction on the natural environment li et al 2022b yang et al 2020 based on the accelerated development of green and low carbon economies worldwide there is a growing call for the construction of a new energy system that is mainly focused on hydro wind solar integration this is an important component of the overall sustainable development strategy xu et al 2021 as a clean and zero carbon energy source dranka and ferreira 2018 hydropower is an important power source that provides flexibility and storage capacity thus playing a vital role in the construction of new energy systems chen et al 2020 pazheri et al 2014 however a reservoir does not always perform its functions as expected due to a variety of reasons there are phenomena such as insufficient power generation ecological deficits unreliable water supply and irrigation de silva and hornberger 2019 li et al 2021a raje and mujumdar 2010 simonovic and arunkumar 2016 and sometimes uncontrolled flow discharge which causes casualties and economic losses hartford et al 2016 king et al 2017 the causes of these phenomena include not only extreme natural conditions e g floods droughts and landslides and abnormal engineering components e g spillway cavitation damage and turbine excitation and gate failures but are also related to the operating rules of the reservoir and the operation mode of the discharge facilities according to an investigation of reservoir safety events the normality of the system function is often related to a large number of factors hartford et al 2016 leanna et al 2016 regan 2010 therefore to ensure the safe operation of a cascade reservoir system it is necessary to understand the operation logic and operation dynamics of the system under the influence of various complex factors currently reservoir operation simulation technology guided by mechanisms is the main modeling paradigm used to describe reservoir operation dynamics and is also an important means of reservoir operation planning and management fayaed et al 2013 rani and moreira 2010 many general simulation models e g hec ressim wrap modsim mikebase and weap have been developed and applied to decision making research optimal water resource allocation flood control power generation and other operation schemes for cascade reservoirs bangash et al 2012 hamlat et al 2013 kim and wurbs 2011 loucks and beek 2017 matrosov et al 2011 ozkaya and zerberg 2021 shourian et al 2008 theara et al 2020 generally in the operation of cascade reservoirs the outflow and power generation plan are formulated under the system operating rules according to the system state of upstream and downstream reservoirs at all levels including the water level and facility state of each reservoir in addition the operation actions through the generator units and other facilities are completed to drive the dynamic development of the system state of the reservoir at the next moment the generalized main link logic and driving relationship during the operation of cascade reservoirs are shown in fig 1 the dynamic process of a cascade reservoir is a large nonlinear and complex system dynamics problem that evolves under the joint action of many uncertain external environmental conditions and thousands of detailed components although the above general simulation model has a good operating interface the simulation process does not show the logical relationship between the operation links and components of the reservoir system in an obvious manner in addition the dynamic operation process cannot be shown therefore watershed managers or hydropower station operators may have difficulty understanding them prasad and mohan 2005 russell and campbell 1996 william and yeh 1985 furthermore the simulation model mainly focuses on the evolution of water flow in basins and rivers and the temporal and spatial distribution of the water volume in hydrological processes and the cascade reservoir space as there is a lack of refined simulations for the operation process of a reservoir system based on links to physical components such as the failure of engineering components and the application priority of discharge facilities deviations between the simulation results and actual operations may easily occur hartford et al 2016 system dynamics sd is a kind of simulation method that is used to study the complex structure causal logic and dynamic behavior of a system sd is based on the modeling of a feedback loop positive feedback and negative feedback between components and from the local to the whole system the component subsystem system as a result sd is better at analyzing the local detail dynamics and even the impact on the whole system and can be used to provide a favorable tool for solving the problem of refined reservoir simulation ahmad et al ahmad and simonovic 2000 proposed a general sd framework to simulate reservoir operations and applied it to the flood management of the shellmouth reservoir in canada they compared the reservoir operations under different rules and explored the impact of gated and unregulated spillways on flood management capacity teegavarapu et al teegavarapu and simonovic 2014 developed a real time dynamic simulation model to understand the dynamic behavior of a hydraulically coupled multi reservoir system king et al king et al 2017 used sd to evaluate the safety of the reservoir system and described each part of the system in detail jiang et al jiang et al 2020a jiang et al 2020b used sd to explore the impact of the operation of the three gorges reservoir on the environment these previous studies have provided insight into the potential of the system dynamics approach for refined reservoir simulation however the current reservoir simulation models based on sd mostly give the operating rules in the form of predefined condition functions and simulate the reservoir operation process based on these functions it only very superficial operating rules are defined in practical application scenarios the operation of reservoirs is very complex and does not only include balancing multiple objectives such as regulating the power grid load yuan and zhou 2017 stimulating fish spawning li et al 2022b and improving shipping conditions but also includes addressing various emergencies such as emergency operations for unexpected floods and landslides saavedra valeriano et al 2010 zhang et al 2018 the reservoir discharge and power generation processes calculated by predefined operating rules are bound to deviate greatly from the actual situation especially when the reservoir is under off design operation conditions to address the uncertainty of reservoir inflow and the nonlinear trade off between different objectives many researchers are devoted to studying the adaptive operating rules of reservoirs to extract the characteristics or laws of the operating rules from historical operation experience or the results of optimization simulations adaptive operating rules can be divided into explicit and implicit operating rules according to their forms bin et al 2017 explicit operating rules have definite functional expressions the fitting method and simulation based optimization sbo are the most common methods used to determine the explicit operating rules liu et al 2014 after determining the function expression of the operating rules the fitting method uses linear regression or the nonlinear fitting method to determine the operating rules from the results of the deterministic optimization model bhaskar and whitlatch 1980 young 1967 the sbo takes the parameters of the operating rule function as decision variables and uses the optimization method to determine the best function parameters in the iterative search process of the simulation model celeste and billib 2009 chang et al 2005 feng et al 2017 zhou et al 2019 however both the fitting method and sbo involve solving rules within the optimization framework for multiobjective reservoirs there are often many optimization objectives and singular results are not usually obtained instead the results are usually in the form of pareto sets therefore managers need to make continuous intervention decisions according to the reservoir characteristics which requires a manager with a higher professional level and more practical experience in recent years with the development of the internet of things and cloud computing technology there has been rapid growth in all kinds of data frankel and reid 2008 researchers have begun to pay attention to the laws and values behind the data itself and scientific research has begun to enter the big data research paradigm of data driven scientific discovery xue qi 2012 as an important analysis method in the era of big data the artificial intelligence ai model is good at finding hidden causality from massive data realizing the accurate simulation and scientific prediction of complex systems and promoting the transformation of the scientific research paradigm in physics chemistry hydrology the environment and many other fields oussous et al 2018 in the field of reservoir operations the ai model shows unique advantages in the extraction of implicit reservoir operating rules zhang et al 2018 different from the solution method that determines the expression form of a function the ai model can be used to independently learn the operating rules from a large amount of historical operation data comprehensive optimization decision making results that are in line with the characteristics of the reservoir under various complex conditions result from these models moreover these results are feasible rules that have been tested in practice yang et al 2021 zhang et al 2019 in addition the ai model has a fast response time after the model is built decisions can be made according to real time information without human selection or intervention hejazi and cai 2009 currently classical ai models such as backpropagation bp neural networks support vector regression svr support vector machine svm and new ai models such as long short term memory lstm gated recurrent units grus and extreme learning machines elms have been successfully applied to the extraction of reservoir operating rules chaves and chang 2008 chen and chang 2009 feng et al 2019 hipni et al 2013 ji et al 2014 su et al 2013 in summary a mechanism ai coupling modeling paradigm is proposed to realize the adaptive and refined operation simulation of cascade reservoirs under the influence of various complex factors the main research points include the following 1 the cascade reservoir system dynamics crsd model is constructed by using the sd method to realize the refined simulation of the system 2 the adaptive operating rule extraction model is constructed by using the lstm algorithm 3 the cascade reservoir adaptive refined crar simulation model is constructed by coupling lstm and crsd which is then combined with the proposed sequential cyclic iterative solution method to realize the refined simulation of the reservoir operation process at each time and the adaptive decision making of the operation scheme 4 the xiluodu xiangjiaba xld xjb cascade reservoir in china is taken as a demonstrative case to verify the applicability of the model 5 the advantages and limitations of the model are discussed and the direction of future research is described thus we aim to provide ideas and references for simulating cascade reservoir operation 2 methodology 2 1 overview the building process of the cascade reservoir adaptive refined simulation model based on the mechanism ai coupling modeling paradigm is shown in fig 2 first according to the operation mechanism characteristics of the artificial regulating system the sd method is used to build the crsd model to realize the refined simulation of the system operation second the adaptive operating rule of the reservoir is extracted from the historical operation data by using artificial intelligence technology lstm is selected in this study finally the crar model is constructed by coupling these two models 2 2 crsd model almost all major rivers in the world have built cascade reservoirs thus the natural river system has gradually evolved into an artificial runoff regulation system with reservoirs in series or in parallel junqiang et al 2022 this is an open complex and mega system structure state and actuator are three typical dimensions used to describe complex artificial systems as shown in fig 3 the structure of the cascade reservoir system includes river topography the spatial distribution of upstream and downstream cascade reservoirs reservoir characteristics and the hydraulic relationships determined by the reservoirs when various external factors such as rainfall upstream inflow and interval confluence act on the system structure the state of the system will be changed the state of the cascade reservoir system includes the water level storage capacity facility state and flow of downstream rivers according to the current system state and the reservoir operating rules outside the system the action of system facilities will be affected changes in the action of the system will change the state of the system as a result the feedback adjustment mechanism of the artificial system is formed based on the typical dimensions of the complex artificial system described above and the mechanism characteristics of the driving feedback of the cascade reservoir system we attempt to build a general crsd model by applying the sd modeling theory in the construction of the sd model it is first necessary to determine the variables that reflect the system operation structure according to the developer s understanding of the operation logic of the system according to their different functions all variables can be divided into stock flow and auxiliary variables each variable is connected through connectors that represent causal relationships the stock variable represents the accumulation of system status and the flow variable represents the rate of system accumulation auxiliary variables represent other variables related to system operation the stock and flow diagrams composed of each variable and connector are the most intuitive representations of the sd model according to the operation process of the cascade reservoir system shown in fig 3 we divide the crsd model into three parts structure state and action this section describes the composition of each part in detail and the stock and flow diagrams of each part is given in the appendix 2 2 1 system structure sector the cascade reservoir system consists of several interconnected reservoirs built on a river therefore the system structure should consider the number of reservoirs and the hydraulic connection between them generally the hydraulic connection between cascades can be divided into two aspects the impact of upstream reservoirs on downstream reservoirs and the impact of downstream reservoirs on upstream reservoirs teegavarapu and simonovic 2014 on the one hand the discharge of the upstream reservoir will affect the inflow of the downstream reservoir on the other hand affected by the backwater of the downstream reservoir the tail water level of the upstream reservoir will change which will affect the power generation head of the upstream reservoir and lead to a difference in the power generation of the reservoir therefore the crsd uses tailwater elevation curves to calculate the head required for energy generation the system structure sector of the crsd is shown in fig a1 2 2 2 system state sector the system state sector includes the main process of reservoir water storage and water conveyance in this sector the stock variable is reservoir storage the flow variables include the inflow outflow overflow and other losses of the reservoir for the first reservoir in the cascade reservoir system the inflow comes from the external input of the model which may be historical data or results obtained from other prediction models for the other reservoirs in the cascade the inflow comes from the outflow of the upstream reservoir and the local inflow between the two reservoirs overflow refers to the overtopping flow when the reservoir storage exceeds the maximum storage capacity during reservoir operation water loss caused by evaporation is a problem that cannot be ignored tilmant et al 2002 therefore another system loss is set up in this study to calculate the change in the water amount caused by water surface evaporation according to the engineering characteristics of most reservoirs there are three outflow modes the power outflow gate outflow and spillway outflow the appropriate outflow modes can be modified by different reservoirs according to engineering construction differences when the reservoir inflow is determined the outflow plan of the reservoir can be obtained through the operating rules the actual outflow of different facilities can be determined by combining the outflow plan with the operation mode of the discharge facilities the system state sector of the crsd is shown in fig a2 2 2 3 actuator sector the purpose of the actuator sector is to determine the actual outflow of each facility of the reservoir according to the outflow plan and operation mode of the facility in addition as the power generation of the reservoir is closely related to the power outflow the energy of the reservoir is modeled as the stock variable in the actuator sector among the renewable energy systems hydropower accounts for more than 85 of the world s renewable electricity production and more than 150 countries now produce hydroelectricity pazheri et al 2014 almost all of the constructed cascade reservoirs have the function of power generation in addition based on operability the discharge structures at a given reservoir can be divided into controllable discharge facilities and uncontrolled discharge facilities controllable discharge facilities control the outflow through a gate operated by a hoist and uncontrolled discharge facilities involve structures such as spillways therefore the reservoir discharge facilities considered in this study include three parts generator units gates and spillways it should be noted that researchers can add and modify the discharge facilities according to the actual situation in their own research projects generally there is a corresponding relationship between the discharge capacity of different facilities and the reservoir water level which can be defined according to the actual situation of the project to simulate the operation conditions of damaged engineering components three variables the availability of the gate the availability of the spillway and the availability of the turbine which range from 0 to 1 are added in the actuator sector to control different damage conditions of the engineering components it should be noted that the structure of the reservoir discharge facilities in actual operations is highly complex and there are many reasons why damage to the engineering components may occur for example the possible sources of damage to the power outflow include guide vane damage and motor damage the gate can also be unavailable due to the failure of the gate itself or failure of the hoist hartford et al 2016 in this study the project damage is simplified in the model the actuator sector of the crsd is shown in fig a3 2 3 lstm model lstm is an improved recurrent neural network rnn that was developed by hochreiter in 1997 hochreiter and schmidhuber 1997 as a sequential deep learning model it can fully exploit the time sequence information in the training data and can effectively avoid the problems of gradient disappearance and gradient explosion that affect traditional artificial neural networks in recent years the use of lstm to extract the operating rules of reservoirs has attracted increasing attention zheng et al 2022 the core components of each lstm cell include the forget gate input gate cell state and output gate as shown in fig a4 first the forget gate is used to filter and discard the output information from the previous cell and the current input information then the retained information is transmitted to the input gate eq 1 next the input gate is used to determine which of the information it received needs to be updated and added to the cell state eq 2 and eq 3 finally the output gate is used to determine which information in the current cell is output to the next cell eq 4 and eq 5 the lstm model utilized in this study includes one input layer one hidden layer and one output layer the real time backpropagation through time bptt algorithm is used to continuously adjust the weight and threshold to train the network forget g a t e f t σ w f x t u f h t 1 b f input g a t e i t σ w i x t u i h t 1 b i cell s t a t e c t f t c t 1 i t tanh w c x t u c h t 1 b c output s t a t e o t σ w o x t u o h t 1 b o hidden s t a t e h t o t tanh c t in the above equations f t i t c t and o t represent the forget gate input gate cell state and output gate respectively x t represents the current input vector and h t denotes the hidden output additionally w f w i w c w o u f u i u c u o b f b i b c b o represent the input weight matrix recurrent weight matrix and bias vectors of the forget input output and potential cell gates respectively finally σ and tanh represent the logistic sigmoid function and hyperbolic tangent activation function respectively 2 4 crar simulation model the crar model is used to realize the adaptive refined simulation of cascade reservoirs under different operating conditions by coupling the crsd model and lstm model the crsd and lstm coupling mode for each crar block is shown in fig 4 the current system inflow and reservoir water level which are provided by the crsd are used as the input of the lstm cell the outflow plan which is automatically generated through the lstm cell is then fed back to the crsd so that the actual distribution scheme of the total outflow between different discharge facilities based on the engineering conditions and the discharge capacity of different discharge facilities can be generated considering the operation of cascade reservoirs at each moment will have an impact on the system state at the next moment therefore a sequential cyclic iterative solution method for the crar model is proposed the outflow at the previous moment is fed back to the current moment as a boundary condition to calculate the system state at the current moment combined with the current inflow the solution of the reservoir outflow plan using crar is fed back to the next moment therefore the cyclic iteration is realized between every moment 3 application 3 1 system description and data source the xiluodu xiangjiaba xld xjb cascade reservoir is located in the jinsha river tributary in the upper reaches of the yangtze river both reservoirs are mainly for power generation and have comprehensive benefits such as flood control sediment detention and improved shipping conditions the total storage of xld is 129 1 108 m3 with an installed capacity of 13860 mw and it is the fourth largest hydropower station in the world the available outflow facilities of the reservoir include 18 generator units expressed as power outflow 8 bottom outlets expressed as gate outflow 7 crest outlets and 4 spillways the total storage of xjb is 51 63 108 m3 with an installed capacity of 6400 mw and it is the eleventh largest hydropower station in the world the available outflow facilities of the reservoir include 8 generator units mid level outlets and crest outlets since the outflow capacity and operation mode of the mid level and crest holes of xjb are not clearly explained by the data collected in this study they are simplified and unified as gate outflow in addition the xld and xjb control basins account for 96 and 97 of the total area of the jinsha river basin respectively and the two reservoirs are relatively close to each other therefore the local inflow of the two reservoirs is not considered in this paper the locations of the two reservoirs and the layout of the outflow facilities are shown in fig 5 the data used in this study were collected from the two reservoirs from january 1 2016 to december 31 2020 and include the historical operation data i e daily inflow reservoir water level and outflow the daily power generation reservoir water level different facilities outflow capacity curves water level storage capacity area curves and tailwater elevation outflow curves all data were collected from the cascade dispatching center of china yangtze power co ltd 3 2 model building according to the model construction method described in section 2 the crar model is built following the actual xld xjb conditions the main contents include the following 1 use the sd method to structure the xld xjb system and 2 set the lstm model parameters and extract the adaptive operating rules based on the historical operation data 3 2 1 crsd of xld xjb referring to the generic crsd model structure in section 2 2 a crsd model suitable for xld xjb is built fig 6 in this figure the pink text represents the lstm input and the red text represents the lstm output the model in this paper is constructed by vensim9 0 due to the lack of vensim9 0 programming ability the whole model is developed by using the python language through the pysd houghton and siegel 2015 software package table 2 provided a detailed description of all variables in combination with the example application of the model since the simulation principle of each reservoir in the cascade reservoir system is the same the function expression of most variables is applicable to any reservoir in the cascade system therefore a single reservoir is taken as an example to explain the function and only the necessary differential variables of cascade reservoirs and the variable function differences caused by the setting of scenario conditions are specifically explained 3 2 2 lstm model building based on the commonly accepted 80 20 split rule when using lstm to extract the operating rule the data from january 1 2016 to december 31 2019 are used as the training data and the other data are used as test data the collected historical data are used as input and output to lstm to facilitate coupling with crsd to realize real time decision making the input data of lstm are set as the reservoir inflow and reservoir water level at the particular moment and the output data are the outflow at the particular moment the maximum iteration mi of lstm in reservoir operation simulation has the greatest influence on the simulation accuracy zhang et al 2018 therefore in this paper when using lstm to extract the operating rules of xld and xjb we set the number of hidden nodes to 50 and the mi to 50 100 150 and 200 the most appropriate model parameters are selected by comparing the corresponding statistical indicators 3 3 scenario design to demonstrate the application of crar in the adaptive refined simulation of cascade reservoirs four possible scenarios of system operation are set up according to the operation conditions of the discharge facilities and engineering component failures the system inflow is set as shown in fig 7 the applicability of the model is explored with a one year simulation period table 1 presents each simulated scenario in detail it should be noted that the operation scenario designed in this paper was only used for the application of the model and is not representative of the actual operational policy of xld xjb 4 results 4 1 comparison of the lstm parameter settings the extraction effect of the lstm model using four groups of parameter settings on the operating rules of the two reservoirs is compared by taylor diagram as shown in fig 8 and table 3 the red dots at the bottom axis of the diagram represent the observation and the markers with different shapes represent lstm with different parameter settings the closer of the markers to the observation the better performance in the context of the pearson correlation coefficient r2 the root mean square error rmse and the standard deviation std taylor 2001 notably the r2 values of the lstm model under different parameter settings are all greater than 0 9 further confirming the advantage of lstm in the extraction of the reservoir operating rules when mi is 200 the simulated result is closest to the observed value therefore the lstm model with 50 hidden layer nodes and an mi of 200 is adopted to extract the operating rules of the two reservoirs in the example application 4 2 applicability of the crar model in this paper the applicability of the crar model is explored from two aspects model validation and simulation error model validation is used to quantify our judgment of the predictive power of the model by comparing the output data of the model with the measured data to fully illustrate the operation capability of the crar simulation system the differences between the three main variables calculated by the model and the measured data from january 2018 to january 2021 are compared fig 9 the simulation results from the crar model have a similar general trend with the observation data which proves that the model has good reproducibility for the operation characteristics of the actual cascade reservoirs the nash sutcliffe efficiency nse coefficient is used to calculate the simulation effect of the model table 4 previous studies have shown that when the nse is greater than 0 5 the simulation effect can be considered to meet the needs of the study moriasi et al 2007 therefore the crar model proposed in this paper can be used to solve the problem of the adaptive refined simulation of cascade reservoirs it is also shown that the reservoir operating rules extracted by the lstm model are real and effective we used the mean absolute error mae and mean relative error mre to analyze the simulation error and performance of the crar model mae reflects the difference between the simulation results and observed values and is a common indicator of model error willmott and matsuura 2005 mre reflects the difference between simulated error and observed values eliminating the influence of different dimensions thus mre can be used to analyze the error difference between different variables the indicators calculations are shown in eq 6 7 to eliminate the influence of model randomness as much as possible the model was run 20 times on the same computer the results are shown in fig 10 6 mae 1 n i 1 n o i s i 7 mre 1 n i 1 n o i s i o i where o i and s i are the observed and simulated values respectively and n is the total number of observations the average maes of the outflows of the two reservoirs are 626 84 m3 s and 697 34 m3 s respectively and the error for xld is obviously smaller than that for xjb affected by the hydraulic connection between the cascades the outflow error of the upstream reservoir will lead to an error in the inflow of the downstream reservoir further increasing the error of the outflow flow of the downstream reservoir however there is no significant difference in the mre values of the outflows between the two reservoirs with averages of 0 175 and 0 176 respectively due to the large storage capacity of xld the water level of xld changes within the range of 540 600 m during the whole simulation period while the water level of xjb only changes within the range of 370 380 m therefore the mae of the water level of xld 5 17 m is clearly higher than that of xjb 2 51 m according to fig 6 the change in daily power generation is closely related to the outflow and the water head influenced by the errors in these two variables the mre of daily power generation is higher than the mre of outflow and the mre of water level with average values of 0 215 and 0 182 respectively in addition the mae value of the daily power generation of xld is higher than that of xjb with average mae values of 0 30 and 0 15 respectively 4 3 simulation results of the different scenarios the crar model was used to achieve the adaptive simulation of the system under different refined conditions in section 3 2 four scenarios of system operation were designed the operation details of the system under the four scenarios are shown in figs 11 and 12 the same change trend was generally observed for the total outflow of the system under the four scenarios presented before june 1 the total outflow of the two reservoirs remained between 1000 m3 s and 3000 m3 s and no significant difference was found between the four scenarios after june 1 the flood season began and the total outflow gradually increased reaching its peak on august 20 in scenario 4 to minimize water abandonment the total outflow was limited during the maintenance period of the unit therefore in june and july the total outflow of the two reservoirs was significantly lower for scenario 4 compared with that of the other three scenarios for scenario 4 the maximum discharge of xld was 3725 m3 s and that of xjb was 3505 m3 s figs 11a and 12a from january to june the water level of the two reservoirs showed a downward trend but after june with the arrival of the flood season the water level of the reservoirs gradually increased in scenarios 1 3 the normal water level was reached by the end of august due to the limited discharge water level of the two reservoirs in scenario 4 reached the normal water level as early as july 1 figs 11b and 12b the operation details of the discharge facilities of the two reservoirs are shown in figs 11c e and 12c d before june 1 the outflow plan was low due to the small inflow of the system therefore all the outflows of the two reservoirs in all scenarios were discharged through the generator units and the outflows through the gate and spillway were 0 after june 1 the system inflow gradually increased the two reservoirs began to use other discharge facilities in addition to the generator units as the outflow capacity of the generator units in scenario 3 and scenario 4 was damaged the maximum outflow of the generator units in the two reservoirs in these scenarios from june to september was lower than that in scenario 1 and scenario 2 the maximum outflow was 3725 m3 s and 3352 m3 s for scenario 3 and scenario 4 respectively figs 11c and 12c however the operation mode of the reservoir was not adjusted in scenario 3 resulting in the difference between the two scenarios therefore in scenario 3 xld was the first to use the gates for discharge under the insufficient discharge capacity condition of the generator units in scenario 4 the xld gates were not used for discharge until the reservoir water level reached the normal water level figs 11d and 12d during the flood season when the maximum discharge capacity of the generator units was reached other discharge facilities were opened for additional discharge in the four scenarios in scenario 2 the application mode of the xld discharge facilities was changed as only two gates were opened for discharge therefore the maximum gate outflow of xld in scenario 2 was 3076 m3 s fig 11d which was lower than the maximum gate outflow for the other three scenarios and a large amount of flood was discharged through the spillway on august 20 the spillway outflow peaked at 15299 m3 s fig 11e in addition due to the damaged discharge capacity of the generator units the gate outflow in scenario 3 and scenario 4 was significantly higher than that in scenario 1 and scenario 2 figs 11d and 12d figs 11f and 12e show the daily generation of the two reservoirs the daily generation in the flood season was significantly higher than that in the nonflood season the difference in power flow is the main reason leading to the change in the daily generation therefore daily generation and power outflow show the same trend figs 11c f and 12c e in scenario 3 and scenario 4 the reduction in the maximum generator discharge capacity was the main factor leading to smaller daily generation it should be noted that although the maximum generator discharge capacity in scenario 3 and scenario 4 was the same in scenario 4 the daily generation of the two reservoirs was increased in june due to the rise in the reservoir water level which also indicates that the increase of head will lead to the increase in the daily generation 5 discussion 5 1 optimization of the system operation mode in different scenarios figs 11b and 12b show that during the whole simulation period the water level of xld is lower than 600 m and that of xjb is lower than 380 m thus in the four scenarios simulated in this paper the two reservoirs are both in a safe state and there is no overtopping fig 13 shows the comparison of the energy of the system under the four scenarios under the same engineering conditions scenario 2 and scenario 4 improved the generation head by changing the operation mode of the discharge facilities thus increasing the overall capacity of the system compared with that in scenario 1 the system power generation in scenario 2 increased by 5 0 108 kw h and compared with that in scenario 3 the system power generation in scenario 4 increased by 10 3 108 kw h therefore for xld xjb the main goal of which is to generate electricity under the condition that the generator units are not damaged the discharge mode of using the gate and spillway tunnel together scenario 2 is beneficial for improving power generation in the case of generator unit damage the overall power generation of the system can be improved by reducing system leakage during the maintenance period and reducing abandoned water scenario 4 5 2 model uncertainty due to the inherent uncertainty in reservoir operations it is necessary to analyze the uncertainty of the model liu et al 2019 in general model uncertainty may exist in any of the three parts the model input model itself and model output zhou et al 2019 the input of the crar model includes the system inflow and engineering conditions for the scenario simulation as well as historical operation data for extracting the operating rules the system inflows are denoted as inflow and local inflow in the model and the engineering conditions are input through several sets of if then else functions the historical operation data are obtained according to actual measurements so there is no possibility of uncertainty but for possible operation scenarios in the future the system inflow and engineering conditions must be uncertain chen et al 2016 however this study is only to illustrate the application of the model therefore a certain operation scenario is given in other words if a probabilistic prediction model that can describe the uncertainty of the system inflow and the uncertainty of the engineering condition damage is constructed and used as input in crar the application of the crar model will be greatly encouraged in practice zhao et al 2012 in addition the crar structure developed by the sd method is essentially rigid however it should be noted that relevant ai algorithms are used in the crar solving process ai technology is essentially based on data driven rule fitting which is susceptible to the influence of the model parameters that are set and the training data therefore there is uncertainty in the outflow plan generated by ai technology tapoglou et al 2020 however in the crar actuator sector the outflow plan is converted into actual outflow according to the actual operation conditions of the project therefore the impact of the uncertainty is minimized in a certain sense with the continuous increase in data acquisition in the future it is expected that the uncertainty of the ai model will be reduced through massive data training furthermore the crar output in this study takes into account the reservoir outflow the reservoir water level the daily power generation the outflow of different facilities and the total power generation in the simulation period in fact the model constructed by the sd method has the advantage of user defined model output for example in simonovic s study the model outputs are power generation performance and irrigation performance simonovic and arunkumar 2016 and in jiang s study the model outputs consider the amount of spawning and sediment flushing jiang et al 2020a jiang et al 2020b however the output variable itself is completely generated by the solution of the model structure relationship so reducing the input uncertainty of crar will inevitably reduce the output uncertainty 5 3 model advantages as a necessary means to solve the problem of scientific operations of cascade reservoirs the model used should be easy to understand and operate the model can be intelligent with respect to the decision making process as well as with the basic physical laws of reservoir operations in addition the model can be used to realize the system operation simulation under various complex conditions therefore a crar model with intelligibility intellectuality universality extendibility and refined simulation is developed in this study the crar structure developed by the sd method is based on graphic modeling according to the basic logic of cascade reservoir operations the cascade reservoir system is divided into three sectors the system structure state and actuator sectors the transparent model development mode fully reveals the internal logical relationship of cascade reservoir operations compared with traditional simulation methods it is more helpful for operators to understand and analyze the dynamic behavior of complex systems in the actuator sector of the model the crar is used to independently model different discharge facilities according to the actual situation of the reservoir and control the use priority of different discharge facilities through the condition function furthermore in crar the equipment availability is represented as a constant from 0 to 1 users can simulate the possible operating conditions of system damage by adjusting the equipment availability value therefore crar can be used for refined simulation of cascade reservoir operation crar uses ai technology to autonomously learn operating rules from historical data in the simulation process the ai model generates the outflow plan according to the real time state of the system reservoir inflow and water level at each moment transforms the outflow plan into actual outflow according to the actual situation of the facility for operation and changes the system state at the next moment the self feedback iterative solution of the system is realized the state of the system at different moments is constrained by the water balance equation therefore crar is more intelligent than the physical model based purely on the water balance equation approximately two thirds of the world s rivers contain cascade reservoirs with the continuous improvement of engineering construction the research focus of cascade reservoirs has gradually transferred from engineering construction to engineering operation management hogeboom et al 2018 due to the water regime of different river basins and the design differences of different reservoir projects different research objects and objectives also have different requirements for reservoir simulation models the construction of the crar follows the general form of a cascade reservoir and takes the water balance equation and power generation calculation equation as the governing equations of the model the model structure is suitable for any reservoir with storage and power generation functions for different research objects only the corresponding research data such as water level storage capacity area curves and tailwater elevation outflow curves need to be replaced in addition the sd method has fixed model composition forms stock flow auxiliary variables and connection lines users can modify or add the composition of the model according to different research needs to build models that meet their own research objectives in fact relevant studies have used the sd method to combine the operation of reservoir systems with other systems such as the environment agricultural yield and slope safety systems de silva and hornberger 2019 jia et al 2021 jiang et al 2020a jiang et al 2020b therefore crar has both universality and extendibility in practical applications 5 4 limitations and future research cascade reservoir operation is a complex system process due to the limitations of cognition and the availability of data this study also has some limitations first although the overall structure of the crar provides some operational details of the system it is still somewhat simplified in many areas for example 1 the flow transmission delay between reservoirs is ignored and 2 only the availability is used to represent the possible damage of engineering components secondly there are a variety of model applications in the field of reservoir operations for current ai technology such as ann svr gru and elm only lstm is used in this paper to extract the adaptive operating rules of the reservoir and the performance comparison of using different ai models to extract the operating rules in the crar model is lacking only lstm is used in this paper to extract the adaptive operating rules and a comparison between various models is not provided in addition due to the influence of hydrological forecasting errors there is a high uncertainty in the runoff process of the reservoir scenario simulations based on historical measurement data are conducted assuming that all runoff inputs are known which may limit the application of crar in practice therefore future studies based on this study may include 1 adding a more comprehensively detailed representation and mathematical description to the current model structure according to the growth of knowledge to achieve more complex and accurate operation simulations and 2 comparing the rule extraction effects of various ai models and selecting the most appropriate ai model 3 the crar model was coupled with a hydrological forecasting model and the uncertain runoff process was used as a model input to evaluate the simulation ability of the crar model under uncertain conditions 6 conclusion the simulation of reservoir operations is an essential research method for scientific reservoir management the sd method can reflect the causal dynamic relationship in system operations and can be used to realize the refined simulation of reservoir operations however a large number of reservoir simulation models constructed by the sd method are solved in the form of a specified operating rule in the simulation process which cannot be used to weigh various functional objectives of reservoirs and deal with emergent scenarios in the actual operation process therefore the application of the sd method is limited in practice operating rules extracted from historical data based on ai technology hide the decision preferences of managers when weighing various scheduling objectives and dealing with emergencies however these methods have the advantage of real time decision making in this paper a cascade reservoir adaptive refined crar simulation model based on a mechanism ai coupling modeling paradigm is proposed this model combines the operating rule extracted by ai technology with the sd method taking xld xjb in china as a case study the practical applicability of crsr is explored the main conclusions are as follows 1 the developed crar model can effectively reflect the dynamic changes of the cascade reservoir system and the transparent model structure based on sd provides some details in the operation of the cascade reservoir system which has good intelligibility in addition the model can consider the water distribution among the discharge facilities and the damage condition of engineering components to carry out refined operation simulation 2 crar takes the water level and inflow at the time of the system operation as the input conditions of the model takes the reservoir operating rule extracted by ai technology as the guidance controls the operation of the system through the sequential cyclic iterative solution method and provides the reservoir operation scheme to deal with various operating conditions to realize the adaptive intelligent decision making of the system 3 the applicability of the model in actual scheduling management is verified by an example for xld xjb under the condition that the generator units are not damaged the operation mode of the gate combined with the spillway is helpful to improve the power generation when the generator units are damaged the total power generation of the system can be improved by reducing the outflow during the maintenance period thus reducing the amount of abandoned water the results show that the model can be used for refined operation simulation and operation strategy formulation of cascade reservoirs in response to various daily and emergency situations providing a scientific guiding tool for reservoir operation management credit authorship contribution statement boran zhu writing original draft methodology conceptualization investigation jun liu writing review editing supervision junqiang lin writing review editing resources yi liu project administration resources di zhang visualization writing review editing yufeng ren data curation validation qidong peng funding acquisition visualization jing yang funding acquisition supervision huaijie he software supervision qiong feng software data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china no 52192672 the national key research and development program of china no 2018yfe0128500 the state key laboratory of simulation and regulation of water cycle in river basin skl2020zy10 the science and technology project of huaneng group headquarters hnkj20 h26 appendix in order to facilitate readers to understand the modeling method proposed in this paper and to promote the application of crar model this appendix provides all concept diagrams involved in the process of model construction including the stock and flow diagram of each part of crsd model and the schematic diagram of lstm model 
3126,large scale monitoring of surface water bodies is of great significance to the sustainable development of regional ecosystems remote sensing is currently the main method of global earth observation on the one hand the traditional water index is simple and efficient but it relies on a fixed global threshold which leads to low accuracy for water extraction on the other hand deep learning has achieved state of the art results in classification of spectral data but it consumes a substantial amount of manpower and time to label sufficient high quality samples furthermore spectral characteristics of water bodies in different areas vary greatly due to changes in atmospheric conditions and viewing geometry in this paper we propose a new accurate water extraction framework based on unsupervised deep learning and ndwi of multispectral images binarized ndwi images are used to identify potential water bodies and deep learning training is performed using these pseudo samples and labels this process realizes the conversion from unlabeled learning to noisy label learning first we proposed a simple and fast binarization algorithm to segment as many real water bodies as possible from ndwi images then a set of water confidence assessment rules was constructed from the four aspects of the spectrum shape agglomeration and range the water segments were scored and sorted to make the model start learning from easy samples and gradually advance to complex samples finally the adjusted co teaching learning strategy is adopted to filter errors introduced by noisy labels through peer networks with different learning capabilities during training we tested the accuracy of our method using gaofen image dataset gid sentinel 2 and landsat images of several water bodies in china compared with other methods our method improved the f1 score by 18 1 40 3 and 6 8 22 2 for gid and sentinel 2 images respectively in addition our method is more stable in long term water monitoring the proposed method has the potential to be used for extracting water bodies with high accuracy on a large scale especially in areas with complex environments and a lack of deep learning samples and it provides a new idea for unsupervised learning in the current remote sensing field by fully combining remote sensing expertise and spectral information of ground objects keywords water extraction remote sensing imagery ndwi unsupervised deep learning noisy labels data availability data will be made available on request 1 introduction water is essential for life and nature which can provide the necessary material foundation and ecosystem services for human survival social and economic development and the environment chen et al 2020a pekel et al 2016 westall and brack 2018 human activities such as inter basin water transfer urbanization massive pumping of groundwater deforestation and lake reclamation will affect the regional water budget leading to lake shrinkage and water shortages fang and jawitz 2019 kummu et al 2011 more than 70 of the earth s surface is covered by water but inland surface water bodies such as rivers lakes and reservoirs only account for 3 of the global land mass klein et al 2017 therefore effective and timely monitoring of the distribution of large scale surface water bodies can help the scientific management and protection of water resources and is of great significance to the sustainable development of regional ecosystems remote sensing is currently the main method of global earth observation and lucc land use and land cover change the temporal availability and wide coverage of remote sensing images strongly support the large scale extraction and mapping of surface water bodies and a large number of experiments and applications have verified their high accuracy and effectiveness davranche et al 2010 feyisa et al 2014 fisher et al 2016 frazier and page 2000 klein et al 2017 li et al 2018 pekel et al 2016 song et al 2007 yang et al 2015 mcfeeters 1996 first introduced the normalized difference water index ndwi to detect water bodies using the green band and near infrared band of landsat multi spectral scanner mss data ndwi subsequently developed into one of the most important remote sensing indexes a large number of researchers have carried out extensive research on water mapping kaplan and avdan 2017 watson et al 2018 worden and de beurs 2020 yang et al 2017 yang et al 2018 lake and sea shoreline extraction duru 2017 maglione et al 2014 shah 2011 flood mapping ganaie et al 2013 huang et al 2018 li et al 2018 desertification assessment lee et al 2009 li et al 2006 noyola medrano and martínez sías 2017 and inland lake monitoring bai et al 2012 eid et al 2020 neeraj and kamal 2016 zhang et al 2020 based on ndwi or its modified forms the key to ratio based water indexes is to select and fine tune appropriate thresholds to distinguish between water and nonwater sekertekin 2021 worden and de beurs 2020 at present methods for setting thresholds mainly involve 1 manual selection chen et al 2020a ding 2009 feyisa et al 2014 mcfeeters 1996 xu 2006 yang et al 2018 for which thresholds are chosen by observing the values of different pixels of the water index grayscale images or comparing the extraction accuracy under different thresholds in advance or 2 automatic binarization algorithms representative binarization algorithms include otsu bangira et al 2019 duy 2015 guo and zhang 2017 ling et al 2020 otsu 1979 sui and xu 2012 isodata eid et al 2020 konko et al 2020 ridler and calvard 1978 sekertekin 2021 intermodes also called bimodal bangira et al 2019 li et al 2021 liu and jezek 2004 prewitt and mendelsohn 1966 sekertekin 2021 and mean gray value hereinafter referred to as mean glasbey 1993 sekertekin 2021 among which otsu is one of the most commonly used algorithms for image thresholding and the threshold is determined by maximizing the inter class variance between foreground and background pixels however it is widely noted that a local optimal threshold is difficult to apply to images of different regions acquired by different sensors at different times and these ratio based indexes are sensitive to aerosol interference and variable viewing geometry feng et al 2012 feyisa et al 2014 hu 2009 xu et al 2020 therefore the water thresholds of images in the same area vary greatly due to changes in atmospheric conditions cloud cover and aerosol distribution over time imagery in different regions will also cause great differences in thresholds due to different land surface coverage and viewing geometry in addition suspended matter aquatic vegetation algae and dissolved organic matter in inland water bodies as well as water depth differences obscure the spectral signals of water and nonwater which makes it more difficult to select thresholds in recent years with the development of deep learning convolutional neural networks cnns are increasingly used to identify water bodies and other objects from high resolution satellite images and have produced state of the art results chen et al 2018 chen et al 2020b dong et al 2019 wang et al 2020a wang et al 2020b zhang et al 2021 compared with ratio based indexes to extract water bodies cnns can effectively extract low level location information and high level semantic information and have powerful multi scale feature representation capabilities in general the detection of continuous surface objects such as water bodies and roads is regarded as a semantic segmentation task and the models used include unet ronneberger et al 2015 pspnet zhao et al 2017 deeplab chen et al 2017 segnet badrinarayanan et al 2017 and refinenet lin et al 2017 these models usually include two parts encoder and decoder the encoder is responsible for mining the multi level features of the image and the decoder is used to restore pixel details and generate semantic information however high quality training samples have always been the main obstacle and challenge for cnns to identify water bodies first cnns rely on a large number of samples with high accuracy especially for water bodies with irregular shapes and complex boundaries making quantities of samples very time consuming and laborious second there may be significant differences in the characteristics of water bodies in different regions which makes the water body samples in one region not applicable to other regions therefore in the practical large scale surface water monitoring and long time series analysis most researchers prefer water index to achieve rapid and reproducible open water detection xu et al 2020 zhou et al 2017 as a result this leads to low automation and low efficiency of water body extraction and massive manual postprocessing is required to improve accuracy to overcome the aforementioned limitations we propose an accurate water extraction method based on ndwi of multispectral images and unsupervised deep learning the core idea of the proposed method is to use the binarized ndwi image as the potential water bodies and then the images and corresponding pseudo labels are included in the training procedure of the model we designed a novel binarization algorithm for ndwi and applied advanced training strategies to help identify and eliminate the errors and noise in these automatically generated pseudo labels so that the model can converge to the correct feature space without being disturbed by noise our method can not only improve the low accuracy of the ndwi method but also solve the problem of difficult acquisition of deep learning samples therefore greatly improving the accuracy and efficiency of large scale water monitoring the remainder of this article is structured as follows section 2 introduces the data we used the details of the proposed method are presented in section 3 section 4 describes the training details and experimental results section 5 discusses the effects of different parts and some hyperparameters of our method finally in section 6 conclusions are drawn and future research is recommended 2 data used to fully test the effectiveness of our method we prepared three challenging datasets of remote sensing imagery the first dataset is gid gaofen image dataset gid is a large scale land cover classification dataset released by tong et al 2020 which consists of 150 high resolution gaofen 2 images acquired from more than 60 different cities in china including built up farmland forest meadow and water since there is currently no publicly released water body dataset for semantic segmentation we selected 90 images containing water from gid for water body extraction each image is 6800 7200 pixels with a resolution of 4 m pixel the data source used by gid is mainly gaofen 2 images and the band information is shown in table 1 the second dataset includes several sentinel 2 images we manually downloaded from copernicus open access hub which contains different types of water bodies in different regions of china hereinafter referred to as sentinel 2 dataset we selected the most representative lakes and reservoirs from the seven geographical regions of china as the test areas namely qinghai lake poyang lake siling co lake dongting lake xinfengjiang reservoir fengman reservoir and miyun reservoir these water bodies have different causes surface coverage climate conditions and geological environment the location and detailed information of the test areas are shown in fig 1 and table 2 in addition in order to evaluate our approach for hydrological applications we took poyang lake as the study area and used the landsat images landsat 5 8 from 2000 to 2020 to explore the dynamic changes of lake area in long term series these landsat images were downloaded from usgs earthexplorer all manually downloaded images including sentinel 2 and landsat were cloud free level 1 terrain corrected images from june to september atmospheric corrections for sentinel 2 images and landsat images were performed using the sentinel application platform snap and envi software respectively 3 methods in this paper a new automated large scale water extraction framework based on ndwi and unsupervised deep learning is proposed to extract water from remote sensing imagery as shown in fig 2 in the following subsections we first introduce the precision first thresholding pft algorithm and the confidence assessment ca rules of water bodies we then elaborate on the principle and implementation of the adjusted co teaching act 3 1 ndwi calculation and precision first thresholding the water index proposed by mcfeeters 1996 can be expressed as 1 n d w i ρ g ρ nir ρ g ρ nir where ρg and ρnir represent the reflectance values of the green band and the near infrared band respectively the purpose of segmentation algorithms such as otsu and intermodes is to find the appropriate threshold based on the distribution characteristics of the ndwi data so that more real water bodies can be segmented the main problem is that it is difficult to balance the accuracy and recall rate of water extraction at the same time in other words the larger the threshold value the higher the accuracy of identifying water bodies but a large number of low value water bodies may be missed the lower the threshold value is set a large amount of nonwater body interference will be introduced since our subsequent work is based on the pseudo labels generated by ndwi we propose a simple and fast binarization algorithm called precision first thresholding pft whose purpose is to segment as many real water bodies as possible and reliable pft is defined as 2 threshold 0 i f n 2 1 2 k n k n 1 i f n 2 o r n 2 a n d k n 1 0 5 1 2 k n 1 k n 2 i f n 2 a n d k n 1 0 5 where n represents the number of peaks in the ndwi histogram and kn represents the ndwi value corresponding to the nth peak generally we assume that ndwi is an ideal bimodal distribution as shown in fig 3 a which is also the premise of binarization algorithms such as otsu and intermodes however due to the influence of factors such as mountain shadows buildings farmland and green algae in the water the number of peaks in the ndwi histogram is generally more than two as shown in fig 3 b and fig 3 c we assume that 0 5 is a reliable water body threshold when the ndwi value corresponding to the penultimate peak is less than 0 5 we believe that the pixel corresponding to the current peak may be a nonwater body and the average value of the ndwi corresponding to the last two peaks is used as the threshold as shown in fig 3 b when the ndwi value corresponding to the penultimate peak is greater than 0 5 there may be different types of water bodies in the image at this time resulting in multiple peaks in the high value area we calculate the average value of the ndwi corresponding to the second to last peak and the ndwi corresponding to the third to last peak as the threshold as shown in fig 3 c the binarized ndwi images can be used as pseudo labels for water samples which contain a lot of noise now the problem of unsupervised deep learning is transformed into deep learning with noisy labels the advantage of pft is that it ensures the accuracy of segmentation as much as possible which can bring great help to the training and convergence of the subsequent model 3 2 confidence assessment of water bodies bengio et al 2009 first proposed curriculum learning cl the core idea is to make the model imitate the learning process of humans and animals by start learning from easy samples first and gradually advancing to complex samples and knowledge cl can regularize the training towards better regions in parameter space and denoise the pseudo labels with low confidence to make model more robust and generalizable wang et al 2021 therefore a key issue that needs to be resolved is which of the pseudo labels generated by ndwi are easier water bodies with high confidence and which are noisy pixels with low confidence examples of water bodies and noise obtained by calculating ndwi and binarization are shown in fig 4 we use each connected domain in the ndwi binary image as the basic unit and design a set of water confidence assessment rules from the four aspects of the spectrum shape agglomeration and range 1 spectrum c1 we use the average value of ndwi in the water segments to represent the spectrum characteristics of the pixels in the area and the formula is as follows 3 c 1 1 m i 1 m g i where gi represents the ndwi value of pixel i and m represents the number of pixels in the water segment the larger the c1 the more likely the pixels in the area are water bodies 2 shape c2 water bodies in nature generally have irregular shapes and complex boundaries at the same time there are islands formed by the accumulation of sediment in the water which appear as holes in the water on the water segments however the boundaries of noise segments are relatively simple for example most buildings appear as long strip quadrilaterals as shown in fig 4 brinkhoff et al 1995 suggested using the three parameters of vibration frequency vibration amplitude and deviation from the convex hull to describe the complexity of a spatial object we have improved this and proposed a shape complexity description operator suitable for distinguishing water bodies from noise the formula is as follows 4 c 2 0 5 f a 0 2 1 r 0 3 p where f represents the frequency of the vibration the edges of polygons with a high frequency of the vibration change their direction very often brinkhoff et al 1995 according to brinkhoff et al 1995 f can be calculated as follows 5 f 16 notches norm 0 5 4 8 notches norm 0 5 2 1 where notchesnorm is the number of notches after normalization and notches can be used to describe the non convex parts of a polygon notchesnorm can be expressed as 6 notches norm notches vertices 3 where notches and vertices represent the number of notches and vertices of the polygon respectively a in eq 4 represents the amplitude of the vibration the amplitude of the vibration is used to measure the increase of the boundary of the polygon compared to the boundary of its convex hull a can be calculated as follows 7 a num b num conv b num b where numb represents the number of vertices of the boundary of the polygon and numconv b represents the number of vertices of the boundary of its convex hull if the polygon is convex then a 0 the value range of a is 0 1 the more meandering the boundary of the polygon the greater the value of a the frequency f and the amplitude a in eq 4 are used to describe the local vibration of an object in order to express and characterize the global shape and complexity of the object we introduce rectangularity r and porosity p in eq 4 r is used to describe the filling degree of the polygon the value of r is relatively large for regular buildings while r is relatively small for water bodies with complex curves r can be defined as 8 r s 0 s mer where s0 and smer represent the area of the polygon and the area of the minimum enclosing rectangle of the polygon respectively the value range of r is 0 to 1 in the field of gis an island is an important evaluation criterion for the complexity of polygons because it divides the rings of polygons into inner and outer rings jiang et al 2020 therefore we use porosity p to describe the number of islands or holes in the polygon p can be defined as 9 p holes holes 1 where holes represents the number of holes in the polygon and we use a normalized ratio to limit the value range of p to 0 to 1 it can not only ensure that the greater the number of holes the greater the p value but also limit the extreme existence of a large number of holes because the increase of the p value will gradually slow down as the holes increase 3 agglomeration c3 mountain shadows and buildings tend to be relatively concentrated and their size and shape are not very different we can summarize their characteristics as follows there are many similar polygons in the adjacent space showing the state of agglomeration the formula is as follows 10 c 3 neighbors neighbors max where neighbors represents the number of similar polygons in a certain range around the polygon and neighborsmax represents the maximum value of neighbors of different polygons in an image the conditions for us to judge whether polygon pi is similar to polygon pj are as follows 11 d i s t a n c e center i center j d s i s j 0 1 s i s j min l i l j 0 1 l i l j min where centeri represents the pixel coordinates of the center point of polygon pi in this paper we set d 1000 pixels si and li represent the area and perimeter of polygon pi respectively in order to simplify the calculation we roughly judge whether the two polygons are similar through the area and perimeter 4 range c4 on the whole the area of mountain shadows and buildings is small while the area of lakes reservoirs and rivers in nature is large we also consider the area of the polygon as an important indicator and the calculation formula is as follows 12 c 4 s i s min s max s min where c4 represents the normalized area index and smin and smax represent the minimum and maximum areas of water segments in a binarized ndwi image finally the confidence of the water body cow can be expressed as 13 cow 0 25 c 1 c 2 c 3 c 4 it can be proved that the value range of cow is 0 1 we calculate the confidence of each water segment in the binarized ndwi image the higher the confidence the easier the water segment sample is considered based on the easy to hard idea of cl we sort these water segments from large to small according to cow and divide these water segments into three parts the first part is the top 30 with the highest confidence denoted as t1 the second part is the water segments with a confidence level of 30 to 60 denoted as t2 and the third part is the remaining water segments with the least confidence level denoted as t3 the supplementary explanation here is that the water confidence in a single remote sensing image is t1 t2 t3 but in the entire dataset the water confidence of a single sample in t2 is not necessarily lower than that in t1 because we use a normalized method when calculating cow in an image in addition t1 t2 and t3 will be fully shuffled before input 3 3 adjusted co teaching section 3 1 obtains the water samples and the corresponding pseudo labels and section 3 2 calculates the confidence of the water samples one issue is that the low confidence samples may be real water bodies and the high confidence samples may be noise therefore in addition to noise reduction through pft at the data level we also introduced the training strategy of co teaching han et al 2018 to further reduce noise in water pseudo labels co teaching is a training method proposed by han et al to reduce the noise of image classification the core idea is that in each mini batch training each network treats its small loss instances as useful knowledge and passes these useful instances to its peer network to update parameters it can get rid of the cumulative effect of errors in a single network and filter errors introduced by noisy labels through two networks with different learning capabilities we modify the original co teaching strategy applied to image classification to accommodate unsupervised semantic segmentation of water bodies the specific training process is as follows assuming that the number of input images is n the pseudo labels obtained through the previous two sections can be expressed as 14 y t 1 t 2 t 3 where t 1 t 1 1 t 1 2 t 1 i t 1 n t 1 i represents the pseudo labels of water segments with the top 30 confidence in the ith ndwi image we shuffle the pseudo labels in t 1 then let t 1 y 1 y 2 y i y k y i is the ith pseudo label in t 1 the remote sensing image sample corresponding to y i is denoted as xi and the image samples corresponding to t 1 can be denoted as follows 15 x 1 x 1 x 2 x i x k suppose mini batch x 1 x 1 x 2 x m x 1 y 1 t 1 and related water confidence c 1 c 1 c 2 c m the two parallel models are denoted as ma and mb respectively and the loss function is f then the loss of each sample can be expressed as 16 l 1 x 1 x 2 x m f m a x 1 y 1 17 l 2 x 1 x 2 x m f m b x 1 y 1 sort the loss of each sample in l1 and l2 from large to small and then selects only r e d percentage of small loss instances out of the mini batch suppose that the samples retained after x 1 passes through ma is x 1 a the samples retained after x 1 passes through mb is x 1 b and then use x 1 a to update the weights and bias of the model mb and use x 1 b to update the weights and bias of the model ma repeat the above process after the data training in t 1 is completed then train t 2 and finally train t 3 and then enter the next epoch the calculation formula of r e d is as follows 18 r e d α 1 m i 1 m c i e j e 0 1 min where ej represents the epoch of the current training and e represents the decay steps for example e 5 means that r e d is reduced to 10 every 5 epochs in the initial training stage the network can learn clean and simple patterns and has the ability to filter out noise but as the number of epochs gets larger they will eventually overfit on noisy labels the role of e j e 0 1 in r e d is to keep more instances at the beginning of training as the number of epochs increases more instances are discarded so that we can keep clean instances and delete those noisy instances before the network remembers them we know that the samples in t 1 have higher confidence than the samples in t 2 although there are deviations for different images this assumption is generally true therefore we introduce 1 m i 1 m c i into r e d in the same epoch samples with high confidence are more worth keeping while samples with low confidence are more likely to be discarded in addition samples with low confidence levels may be completely discarded in the later stage of training so we set a minimum sample retention rate α this parameter represents the estimated minimum non noise ratio and we will discuss this parameter later finally we clarify the difference between our adjusted co teaching and the original co teaching first for noise reduction algorithms such as co teaching the noise is artificially added to the standard dataset which means that the noise rate is controllable while our noise is uncertain and uncontrollable second we designed a new powerful and dynamic function to consider the retention of samples with different confidence in the same epoch and the retention of samples between different epochs third co teaching is aimed at image classification tasks with a small amount of calculation we segmented the connected domains of the water bodies through ndwi and transferred the image level classification to the complex pixel level semantic segmentation task 4 experiments and results 4 1 experimental details we implemented our method and carried out experiments on gid and sentinel 2 dataset two semantic segmentation networks ma and mb in adjusted co teaching use the same unet structure due to the difference in random initialization two models with the same structure can also have different representation capabilities unet mainly consists of two parts the contracting path aims to extract complex contextual information for water bodies and the expansive path restores the semantic water information to the original input size through successive upsampling operations in our models we used resnet he et al 2016 to replace the contracting path of unet resnet can solve vanishing or exploding gradient issues caused by error back propagation through skip connections of the residual module our models were implemented using pytorch and all experiments were executed on a supercomputing platform with nvidia tesla v100 32 gb gpus we used an imagenet deng et al 2009 pretrained model in our network to accelerate convergence and the adam optimizer to minimize losses cross entropy was selected as the loss function the learning rate was initially set to 0 001 and reduced by a factor of 0 1 after 30 epochs the models were trained with a batch size of 16 for 50 epochs furthermore we tested the traditional random forest rf algorithm on our datasets 8000 and 4000 training samples were selected for the gid and sentinel 2 datasets respectively and the number of estimators in the rf algorithm was set to 30 4 2 evaluation metrics to quantitatively evaluate the performance of different water extraction methods we compare the modeling results with real water data the ground truth of sentinel 2 dataset is manually edited and calibrated by domain experts based on ndwi the precision p recall r and f1 score were used as metrics precision represents the ratio of the true water bodies in the recognized water bodies and recall represents the ratio of the recognized real water bodies in the retrieved image f1 score is a comprehensive index that considers both precision and recall they can be calculated as 19 p tp tp f p 20 r tp tp f n 21 f 1 2 p r p r where tp fp and fn represent the numbers of true positives false positives and false negatives at the pixel level respectively 4 3 results in order to verify the effectiveness of our proposed method the experimental results of this paper are compared with other methods fig 5 shows the water extraction results on gid dataset on the whole our method performs significantly better than other threshold segmentation methods whereas intermodes is relatively ineffective the first and second rows in fig 5 are the urban water extraction results with many buildings it can be seen that a large number of buildings bridges and roads are mistakenly identified as water bodies in other water extraction results our method can avoid this problem well and even resist cloud coverage the details are shown in fig 6 the third and fourth rows in fig 5 are suburbs and villages where buildings are sparsely distributed the traditional segmentation algorithms and random forest algorithm still cannot solve the problem of interference of buildings and roads we divided sentinel 2 dataset into three different types of water bodies reservoirs salt lakes and freshwater lakes as shown in fig 7 it can be seen that during the reservoir extraction other threshold algorithms misidentified a large number of buildings roads farmland and mountains as water bodies this is because reservoirs are generally distributed in alpine valleys with large undulating terrain resulting in complex surface radiation and the details are shown in fig 8 except for intermodes all methods are effective in identifying salt lakes because salt lakes are generally distributed in arid or semi arid inland areas of high evaporation and there are few fish and algae in salt lakes because of the high salinity in addition the boundaries of the salt lakes often have white salt belts formed by the migration and deposition of salt materials which makes the boundaries between the lakes and the lands very obvious different methods are effective in identifying freshwater lakes but compared to our method traditional methods are affected by waterside fishing nets farmland and algae resulting in many small and incorrectly extracted water bodies we also quantitatively compared the water extraction effects of different methods as given in table 3 the precision recall and f1 score of our method are much higher than those of the other methods other threshold methods have a high recall rate and low accuracy due to a large number of misrecognition problems we are trying to make up for the drawbacks of these methods it can be seen from the experimental results that our method can significantly improve the accuracy of water body recognition although the recall rate has decreased it still remains at a high level mean gray value has the worst performance although the recall rate is the highest the accuracy rate is the lowest at the same time overall otsu and isodata outperform intermodes and mean gray value specifically on the gid dataset our method achieves increases of 28 4 57 6 for the precision rate and 18 1 40 3 for the f1 score compared with gid the performance difference of different methods on sentinel 2 dataset is smaller our method still achieves increases of 9 5 38 4 for the precision rate and 6 8 22 2 for the f1 score 5 discussion 5 1 the importance of pft our purpose in designing pft is to ensure the accuracy of pseudo samples so that as many real water bodies as possible participate in the training in table 3 we can see that obviously pft achieves this goal pft achieves increases of 30 8 47 2 for gid and 13 8 38 0 for sentinel 2 images in order to further verify the effectiveness and irreplaceability of the pft module we used otsu intermodes isodata and mean gray value instead of pft to generate pseudo labels other modules and parameters remain unchanged the experimental results are shown in table 4 for gid pft has higher accuracy recall and f1 score than other threshold algorithms for sentinel 2 dataset although isodata achieves the highest recall rate the precision and f1 score of pft are still the highest this confirms that pft can extract the real water bodies as much as possible on the basis of reducing the error segmentation which is very important for the subsequent unsupervised training in addition we compared the accuracy of different threshold algorithms before and after adding ca and act modules based on table 3 and table 4 as shown in fig 9 it can be seen that except for the poor performance of intermodes on sentinel 2 dataset all methods have significant improvements on f1 score after using ca and act modules on the whole the modules greatly improve the accuracy of each algorithm despite compromising the recall rate 5 2 the effect of sample sorting in order to make the model easier to train and learn we calculated the confidence of different water segments in an image and then divided the samples into three parts t1 t2 and t3 according to the water confidence from large to small to verify the rationality and effectiveness we conducted a comparative test mixing the samples of t1 t2 and t3 and then randomly sampling them into mini batch training denoted as shuffle t the experimental results are shown in table 5 it can be seen that the sorted samples can improve the accuracy and f1 score of the model which shows that the data division we designed is reliable 5 3 parameters in act in this section we first discuss the influence of the threshold α an important parameter in adjusted co teaching α represents the proportion of real water in the pseudo samples that we estimated in advance also known as the non noise rate when α is close to 0 as the number of training epochs increases eventually all pseudo samples will be discarded as α increases more samples will be retained the other parameters in the experiment are unchanged and the value of α takes a value from 0 to 0 5 with an interval of 0 1 the experimental results are shown in table 6 and fig 10 when α 0 2 gid and sentinel 2 datasets have the highest f1 scores at the same time gid has the highest recall rate and the sentinel 2 dataset has the highest precision rate in the four subfigures of fig 10 the vertical axes on the left and right represent the evaluation values on the gid and sentinel 2 dataset respectively in general the trends of gid and sentinel 2 change with α are the same as α increases f1 score first increases and then decreases then we discuss the influence of the decay steps e this parameter is used to adjust the proportion of small loss instances retained by different epochs the other parameters in the experiment are unchanged and the value of e takes a value from 5 to 10 with an interval of 5 the experimental results are shown in table 7 it can be seen that as e increases the overall effect of the model gradually deteriorates when e 5 gid and sentinel 2 dataset achieve the best results our interpretation of the results is that when the value of e is too large the model will continue to train on pseudo samples full of noise and try to fit these noisy data therefore long enough training is required to correct these errors while when e is small even if the wrong samples are fitted part of the wrong samples can be quickly eliminated in the next stage of training thus guiding the model training back on track 5 4 the influence of the proportion of water bodies we further explored the impact of the proportion of water bodies in the remote sensing image on the recognition accuracy we first calculated the proportion of pixels belonging to the water body in each sample in gid and sentinel 2 dataset and then drew the scatter plots of the precision recall and f1 score with respect to the proportion of water respectively as shown in fig 11 the proportion of water bodies in the gid samples is concentrated between 0 and 0 2 on the whole the precision recall and f1 score have the same trends as the proportion of the water body changes when there are few water bodies in the image the quality of the extraction fluctuates as the proportion of water in the image increases the precision recall and f1 score all increase significantly and they tend to approach 1 which shows that our algorithm can be well adapted to large scale water extraction 5 5 hydrological application of our method poyang lake is the largest freshwater lake in china and its inter annual area changes are driven by both climate changes and human activities we used different methods to monitor the inter annual variation of the area of poyang lake from 2000 to 2020 to verify the feasibility of our method in hydrological application we counted the area of poyang lake every summer in the jrc global surface water dataset pekel et al 2016 as the true value and used the root mean square error rmse to quantitatively evaluate the effectiveness of various algorithms only landsat 7 images with striping problems were available in 2012 in the test area which were excluded because the jrc water data had obvious errors as not processed for striping repair and were not suitable to be validation data therefore we did not use the water extraction results in 2012 the experimental results are shown in fig 12 it can be seen that the variation trend of water body area extracted by different methods is generally consistent with jrc the rmse of our algorithm is the smallest which indicates that our algorithm performs more stable in long term water body monitoring 6 conclusions in this paper we designed an automated water extraction framework without human intervention by evaluating the confidence of the water segments and combining cl and act this method has the following advantages first samples are automatically obtained by segmenting the ndwi images which greatly saves the cost of producing samples second compared with the traditional water index method our method greatly improves the accuracy by introducing deep learning technology third unsupervised deep learning is realized through expertise and prior knowledge in remote sensing this is a new way that helps to improve the current lack of remote sensing datasets in the field of deep learning it should be noted that our method is suitable for a wide range of scenes with a large number of remote sensing images in future work we will focus on leveraging the full potential of deep learning combining more spectral information and remote sensing expertise and expanding the work to automatic high precision extraction of buildings vegetation and other ground objects credit authorship contribution statement junjie li conceptualization methodology software writing original draft yizhuo meng methodology validation yuanxi li formal analysis data curation qian cui resources investigation xining yang writing review editing chongxin tao conceptualization visualization zhe wang investigation linyi li project administration wen zhang writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the anonymous reviewers for their valuable comments that substantially improve the quality of this paper the numerical calculations in this article were performed on the supercomputing system at the supercomputing center of wuhan university this work was funded by the national key research and development program of china no 2021yfb3900603 
3126,large scale monitoring of surface water bodies is of great significance to the sustainable development of regional ecosystems remote sensing is currently the main method of global earth observation on the one hand the traditional water index is simple and efficient but it relies on a fixed global threshold which leads to low accuracy for water extraction on the other hand deep learning has achieved state of the art results in classification of spectral data but it consumes a substantial amount of manpower and time to label sufficient high quality samples furthermore spectral characteristics of water bodies in different areas vary greatly due to changes in atmospheric conditions and viewing geometry in this paper we propose a new accurate water extraction framework based on unsupervised deep learning and ndwi of multispectral images binarized ndwi images are used to identify potential water bodies and deep learning training is performed using these pseudo samples and labels this process realizes the conversion from unlabeled learning to noisy label learning first we proposed a simple and fast binarization algorithm to segment as many real water bodies as possible from ndwi images then a set of water confidence assessment rules was constructed from the four aspects of the spectrum shape agglomeration and range the water segments were scored and sorted to make the model start learning from easy samples and gradually advance to complex samples finally the adjusted co teaching learning strategy is adopted to filter errors introduced by noisy labels through peer networks with different learning capabilities during training we tested the accuracy of our method using gaofen image dataset gid sentinel 2 and landsat images of several water bodies in china compared with other methods our method improved the f1 score by 18 1 40 3 and 6 8 22 2 for gid and sentinel 2 images respectively in addition our method is more stable in long term water monitoring the proposed method has the potential to be used for extracting water bodies with high accuracy on a large scale especially in areas with complex environments and a lack of deep learning samples and it provides a new idea for unsupervised learning in the current remote sensing field by fully combining remote sensing expertise and spectral information of ground objects keywords water extraction remote sensing imagery ndwi unsupervised deep learning noisy labels data availability data will be made available on request 1 introduction water is essential for life and nature which can provide the necessary material foundation and ecosystem services for human survival social and economic development and the environment chen et al 2020a pekel et al 2016 westall and brack 2018 human activities such as inter basin water transfer urbanization massive pumping of groundwater deforestation and lake reclamation will affect the regional water budget leading to lake shrinkage and water shortages fang and jawitz 2019 kummu et al 2011 more than 70 of the earth s surface is covered by water but inland surface water bodies such as rivers lakes and reservoirs only account for 3 of the global land mass klein et al 2017 therefore effective and timely monitoring of the distribution of large scale surface water bodies can help the scientific management and protection of water resources and is of great significance to the sustainable development of regional ecosystems remote sensing is currently the main method of global earth observation and lucc land use and land cover change the temporal availability and wide coverage of remote sensing images strongly support the large scale extraction and mapping of surface water bodies and a large number of experiments and applications have verified their high accuracy and effectiveness davranche et al 2010 feyisa et al 2014 fisher et al 2016 frazier and page 2000 klein et al 2017 li et al 2018 pekel et al 2016 song et al 2007 yang et al 2015 mcfeeters 1996 first introduced the normalized difference water index ndwi to detect water bodies using the green band and near infrared band of landsat multi spectral scanner mss data ndwi subsequently developed into one of the most important remote sensing indexes a large number of researchers have carried out extensive research on water mapping kaplan and avdan 2017 watson et al 2018 worden and de beurs 2020 yang et al 2017 yang et al 2018 lake and sea shoreline extraction duru 2017 maglione et al 2014 shah 2011 flood mapping ganaie et al 2013 huang et al 2018 li et al 2018 desertification assessment lee et al 2009 li et al 2006 noyola medrano and martínez sías 2017 and inland lake monitoring bai et al 2012 eid et al 2020 neeraj and kamal 2016 zhang et al 2020 based on ndwi or its modified forms the key to ratio based water indexes is to select and fine tune appropriate thresholds to distinguish between water and nonwater sekertekin 2021 worden and de beurs 2020 at present methods for setting thresholds mainly involve 1 manual selection chen et al 2020a ding 2009 feyisa et al 2014 mcfeeters 1996 xu 2006 yang et al 2018 for which thresholds are chosen by observing the values of different pixels of the water index grayscale images or comparing the extraction accuracy under different thresholds in advance or 2 automatic binarization algorithms representative binarization algorithms include otsu bangira et al 2019 duy 2015 guo and zhang 2017 ling et al 2020 otsu 1979 sui and xu 2012 isodata eid et al 2020 konko et al 2020 ridler and calvard 1978 sekertekin 2021 intermodes also called bimodal bangira et al 2019 li et al 2021 liu and jezek 2004 prewitt and mendelsohn 1966 sekertekin 2021 and mean gray value hereinafter referred to as mean glasbey 1993 sekertekin 2021 among which otsu is one of the most commonly used algorithms for image thresholding and the threshold is determined by maximizing the inter class variance between foreground and background pixels however it is widely noted that a local optimal threshold is difficult to apply to images of different regions acquired by different sensors at different times and these ratio based indexes are sensitive to aerosol interference and variable viewing geometry feng et al 2012 feyisa et al 2014 hu 2009 xu et al 2020 therefore the water thresholds of images in the same area vary greatly due to changes in atmospheric conditions cloud cover and aerosol distribution over time imagery in different regions will also cause great differences in thresholds due to different land surface coverage and viewing geometry in addition suspended matter aquatic vegetation algae and dissolved organic matter in inland water bodies as well as water depth differences obscure the spectral signals of water and nonwater which makes it more difficult to select thresholds in recent years with the development of deep learning convolutional neural networks cnns are increasingly used to identify water bodies and other objects from high resolution satellite images and have produced state of the art results chen et al 2018 chen et al 2020b dong et al 2019 wang et al 2020a wang et al 2020b zhang et al 2021 compared with ratio based indexes to extract water bodies cnns can effectively extract low level location information and high level semantic information and have powerful multi scale feature representation capabilities in general the detection of continuous surface objects such as water bodies and roads is regarded as a semantic segmentation task and the models used include unet ronneberger et al 2015 pspnet zhao et al 2017 deeplab chen et al 2017 segnet badrinarayanan et al 2017 and refinenet lin et al 2017 these models usually include two parts encoder and decoder the encoder is responsible for mining the multi level features of the image and the decoder is used to restore pixel details and generate semantic information however high quality training samples have always been the main obstacle and challenge for cnns to identify water bodies first cnns rely on a large number of samples with high accuracy especially for water bodies with irregular shapes and complex boundaries making quantities of samples very time consuming and laborious second there may be significant differences in the characteristics of water bodies in different regions which makes the water body samples in one region not applicable to other regions therefore in the practical large scale surface water monitoring and long time series analysis most researchers prefer water index to achieve rapid and reproducible open water detection xu et al 2020 zhou et al 2017 as a result this leads to low automation and low efficiency of water body extraction and massive manual postprocessing is required to improve accuracy to overcome the aforementioned limitations we propose an accurate water extraction method based on ndwi of multispectral images and unsupervised deep learning the core idea of the proposed method is to use the binarized ndwi image as the potential water bodies and then the images and corresponding pseudo labels are included in the training procedure of the model we designed a novel binarization algorithm for ndwi and applied advanced training strategies to help identify and eliminate the errors and noise in these automatically generated pseudo labels so that the model can converge to the correct feature space without being disturbed by noise our method can not only improve the low accuracy of the ndwi method but also solve the problem of difficult acquisition of deep learning samples therefore greatly improving the accuracy and efficiency of large scale water monitoring the remainder of this article is structured as follows section 2 introduces the data we used the details of the proposed method are presented in section 3 section 4 describes the training details and experimental results section 5 discusses the effects of different parts and some hyperparameters of our method finally in section 6 conclusions are drawn and future research is recommended 2 data used to fully test the effectiveness of our method we prepared three challenging datasets of remote sensing imagery the first dataset is gid gaofen image dataset gid is a large scale land cover classification dataset released by tong et al 2020 which consists of 150 high resolution gaofen 2 images acquired from more than 60 different cities in china including built up farmland forest meadow and water since there is currently no publicly released water body dataset for semantic segmentation we selected 90 images containing water from gid for water body extraction each image is 6800 7200 pixels with a resolution of 4 m pixel the data source used by gid is mainly gaofen 2 images and the band information is shown in table 1 the second dataset includes several sentinel 2 images we manually downloaded from copernicus open access hub which contains different types of water bodies in different regions of china hereinafter referred to as sentinel 2 dataset we selected the most representative lakes and reservoirs from the seven geographical regions of china as the test areas namely qinghai lake poyang lake siling co lake dongting lake xinfengjiang reservoir fengman reservoir and miyun reservoir these water bodies have different causes surface coverage climate conditions and geological environment the location and detailed information of the test areas are shown in fig 1 and table 2 in addition in order to evaluate our approach for hydrological applications we took poyang lake as the study area and used the landsat images landsat 5 8 from 2000 to 2020 to explore the dynamic changes of lake area in long term series these landsat images were downloaded from usgs earthexplorer all manually downloaded images including sentinel 2 and landsat were cloud free level 1 terrain corrected images from june to september atmospheric corrections for sentinel 2 images and landsat images were performed using the sentinel application platform snap and envi software respectively 3 methods in this paper a new automated large scale water extraction framework based on ndwi and unsupervised deep learning is proposed to extract water from remote sensing imagery as shown in fig 2 in the following subsections we first introduce the precision first thresholding pft algorithm and the confidence assessment ca rules of water bodies we then elaborate on the principle and implementation of the adjusted co teaching act 3 1 ndwi calculation and precision first thresholding the water index proposed by mcfeeters 1996 can be expressed as 1 n d w i ρ g ρ nir ρ g ρ nir where ρg and ρnir represent the reflectance values of the green band and the near infrared band respectively the purpose of segmentation algorithms such as otsu and intermodes is to find the appropriate threshold based on the distribution characteristics of the ndwi data so that more real water bodies can be segmented the main problem is that it is difficult to balance the accuracy and recall rate of water extraction at the same time in other words the larger the threshold value the higher the accuracy of identifying water bodies but a large number of low value water bodies may be missed the lower the threshold value is set a large amount of nonwater body interference will be introduced since our subsequent work is based on the pseudo labels generated by ndwi we propose a simple and fast binarization algorithm called precision first thresholding pft whose purpose is to segment as many real water bodies as possible and reliable pft is defined as 2 threshold 0 i f n 2 1 2 k n k n 1 i f n 2 o r n 2 a n d k n 1 0 5 1 2 k n 1 k n 2 i f n 2 a n d k n 1 0 5 where n represents the number of peaks in the ndwi histogram and kn represents the ndwi value corresponding to the nth peak generally we assume that ndwi is an ideal bimodal distribution as shown in fig 3 a which is also the premise of binarization algorithms such as otsu and intermodes however due to the influence of factors such as mountain shadows buildings farmland and green algae in the water the number of peaks in the ndwi histogram is generally more than two as shown in fig 3 b and fig 3 c we assume that 0 5 is a reliable water body threshold when the ndwi value corresponding to the penultimate peak is less than 0 5 we believe that the pixel corresponding to the current peak may be a nonwater body and the average value of the ndwi corresponding to the last two peaks is used as the threshold as shown in fig 3 b when the ndwi value corresponding to the penultimate peak is greater than 0 5 there may be different types of water bodies in the image at this time resulting in multiple peaks in the high value area we calculate the average value of the ndwi corresponding to the second to last peak and the ndwi corresponding to the third to last peak as the threshold as shown in fig 3 c the binarized ndwi images can be used as pseudo labels for water samples which contain a lot of noise now the problem of unsupervised deep learning is transformed into deep learning with noisy labels the advantage of pft is that it ensures the accuracy of segmentation as much as possible which can bring great help to the training and convergence of the subsequent model 3 2 confidence assessment of water bodies bengio et al 2009 first proposed curriculum learning cl the core idea is to make the model imitate the learning process of humans and animals by start learning from easy samples first and gradually advancing to complex samples and knowledge cl can regularize the training towards better regions in parameter space and denoise the pseudo labels with low confidence to make model more robust and generalizable wang et al 2021 therefore a key issue that needs to be resolved is which of the pseudo labels generated by ndwi are easier water bodies with high confidence and which are noisy pixels with low confidence examples of water bodies and noise obtained by calculating ndwi and binarization are shown in fig 4 we use each connected domain in the ndwi binary image as the basic unit and design a set of water confidence assessment rules from the four aspects of the spectrum shape agglomeration and range 1 spectrum c1 we use the average value of ndwi in the water segments to represent the spectrum characteristics of the pixels in the area and the formula is as follows 3 c 1 1 m i 1 m g i where gi represents the ndwi value of pixel i and m represents the number of pixels in the water segment the larger the c1 the more likely the pixels in the area are water bodies 2 shape c2 water bodies in nature generally have irregular shapes and complex boundaries at the same time there are islands formed by the accumulation of sediment in the water which appear as holes in the water on the water segments however the boundaries of noise segments are relatively simple for example most buildings appear as long strip quadrilaterals as shown in fig 4 brinkhoff et al 1995 suggested using the three parameters of vibration frequency vibration amplitude and deviation from the convex hull to describe the complexity of a spatial object we have improved this and proposed a shape complexity description operator suitable for distinguishing water bodies from noise the formula is as follows 4 c 2 0 5 f a 0 2 1 r 0 3 p where f represents the frequency of the vibration the edges of polygons with a high frequency of the vibration change their direction very often brinkhoff et al 1995 according to brinkhoff et al 1995 f can be calculated as follows 5 f 16 notches norm 0 5 4 8 notches norm 0 5 2 1 where notchesnorm is the number of notches after normalization and notches can be used to describe the non convex parts of a polygon notchesnorm can be expressed as 6 notches norm notches vertices 3 where notches and vertices represent the number of notches and vertices of the polygon respectively a in eq 4 represents the amplitude of the vibration the amplitude of the vibration is used to measure the increase of the boundary of the polygon compared to the boundary of its convex hull a can be calculated as follows 7 a num b num conv b num b where numb represents the number of vertices of the boundary of the polygon and numconv b represents the number of vertices of the boundary of its convex hull if the polygon is convex then a 0 the value range of a is 0 1 the more meandering the boundary of the polygon the greater the value of a the frequency f and the amplitude a in eq 4 are used to describe the local vibration of an object in order to express and characterize the global shape and complexity of the object we introduce rectangularity r and porosity p in eq 4 r is used to describe the filling degree of the polygon the value of r is relatively large for regular buildings while r is relatively small for water bodies with complex curves r can be defined as 8 r s 0 s mer where s0 and smer represent the area of the polygon and the area of the minimum enclosing rectangle of the polygon respectively the value range of r is 0 to 1 in the field of gis an island is an important evaluation criterion for the complexity of polygons because it divides the rings of polygons into inner and outer rings jiang et al 2020 therefore we use porosity p to describe the number of islands or holes in the polygon p can be defined as 9 p holes holes 1 where holes represents the number of holes in the polygon and we use a normalized ratio to limit the value range of p to 0 to 1 it can not only ensure that the greater the number of holes the greater the p value but also limit the extreme existence of a large number of holes because the increase of the p value will gradually slow down as the holes increase 3 agglomeration c3 mountain shadows and buildings tend to be relatively concentrated and their size and shape are not very different we can summarize their characteristics as follows there are many similar polygons in the adjacent space showing the state of agglomeration the formula is as follows 10 c 3 neighbors neighbors max where neighbors represents the number of similar polygons in a certain range around the polygon and neighborsmax represents the maximum value of neighbors of different polygons in an image the conditions for us to judge whether polygon pi is similar to polygon pj are as follows 11 d i s t a n c e center i center j d s i s j 0 1 s i s j min l i l j 0 1 l i l j min where centeri represents the pixel coordinates of the center point of polygon pi in this paper we set d 1000 pixels si and li represent the area and perimeter of polygon pi respectively in order to simplify the calculation we roughly judge whether the two polygons are similar through the area and perimeter 4 range c4 on the whole the area of mountain shadows and buildings is small while the area of lakes reservoirs and rivers in nature is large we also consider the area of the polygon as an important indicator and the calculation formula is as follows 12 c 4 s i s min s max s min where c4 represents the normalized area index and smin and smax represent the minimum and maximum areas of water segments in a binarized ndwi image finally the confidence of the water body cow can be expressed as 13 cow 0 25 c 1 c 2 c 3 c 4 it can be proved that the value range of cow is 0 1 we calculate the confidence of each water segment in the binarized ndwi image the higher the confidence the easier the water segment sample is considered based on the easy to hard idea of cl we sort these water segments from large to small according to cow and divide these water segments into three parts the first part is the top 30 with the highest confidence denoted as t1 the second part is the water segments with a confidence level of 30 to 60 denoted as t2 and the third part is the remaining water segments with the least confidence level denoted as t3 the supplementary explanation here is that the water confidence in a single remote sensing image is t1 t2 t3 but in the entire dataset the water confidence of a single sample in t2 is not necessarily lower than that in t1 because we use a normalized method when calculating cow in an image in addition t1 t2 and t3 will be fully shuffled before input 3 3 adjusted co teaching section 3 1 obtains the water samples and the corresponding pseudo labels and section 3 2 calculates the confidence of the water samples one issue is that the low confidence samples may be real water bodies and the high confidence samples may be noise therefore in addition to noise reduction through pft at the data level we also introduced the training strategy of co teaching han et al 2018 to further reduce noise in water pseudo labels co teaching is a training method proposed by han et al to reduce the noise of image classification the core idea is that in each mini batch training each network treats its small loss instances as useful knowledge and passes these useful instances to its peer network to update parameters it can get rid of the cumulative effect of errors in a single network and filter errors introduced by noisy labels through two networks with different learning capabilities we modify the original co teaching strategy applied to image classification to accommodate unsupervised semantic segmentation of water bodies the specific training process is as follows assuming that the number of input images is n the pseudo labels obtained through the previous two sections can be expressed as 14 y t 1 t 2 t 3 where t 1 t 1 1 t 1 2 t 1 i t 1 n t 1 i represents the pseudo labels of water segments with the top 30 confidence in the ith ndwi image we shuffle the pseudo labels in t 1 then let t 1 y 1 y 2 y i y k y i is the ith pseudo label in t 1 the remote sensing image sample corresponding to y i is denoted as xi and the image samples corresponding to t 1 can be denoted as follows 15 x 1 x 1 x 2 x i x k suppose mini batch x 1 x 1 x 2 x m x 1 y 1 t 1 and related water confidence c 1 c 1 c 2 c m the two parallel models are denoted as ma and mb respectively and the loss function is f then the loss of each sample can be expressed as 16 l 1 x 1 x 2 x m f m a x 1 y 1 17 l 2 x 1 x 2 x m f m b x 1 y 1 sort the loss of each sample in l1 and l2 from large to small and then selects only r e d percentage of small loss instances out of the mini batch suppose that the samples retained after x 1 passes through ma is x 1 a the samples retained after x 1 passes through mb is x 1 b and then use x 1 a to update the weights and bias of the model mb and use x 1 b to update the weights and bias of the model ma repeat the above process after the data training in t 1 is completed then train t 2 and finally train t 3 and then enter the next epoch the calculation formula of r e d is as follows 18 r e d α 1 m i 1 m c i e j e 0 1 min where ej represents the epoch of the current training and e represents the decay steps for example e 5 means that r e d is reduced to 10 every 5 epochs in the initial training stage the network can learn clean and simple patterns and has the ability to filter out noise but as the number of epochs gets larger they will eventually overfit on noisy labels the role of e j e 0 1 in r e d is to keep more instances at the beginning of training as the number of epochs increases more instances are discarded so that we can keep clean instances and delete those noisy instances before the network remembers them we know that the samples in t 1 have higher confidence than the samples in t 2 although there are deviations for different images this assumption is generally true therefore we introduce 1 m i 1 m c i into r e d in the same epoch samples with high confidence are more worth keeping while samples with low confidence are more likely to be discarded in addition samples with low confidence levels may be completely discarded in the later stage of training so we set a minimum sample retention rate α this parameter represents the estimated minimum non noise ratio and we will discuss this parameter later finally we clarify the difference between our adjusted co teaching and the original co teaching first for noise reduction algorithms such as co teaching the noise is artificially added to the standard dataset which means that the noise rate is controllable while our noise is uncertain and uncontrollable second we designed a new powerful and dynamic function to consider the retention of samples with different confidence in the same epoch and the retention of samples between different epochs third co teaching is aimed at image classification tasks with a small amount of calculation we segmented the connected domains of the water bodies through ndwi and transferred the image level classification to the complex pixel level semantic segmentation task 4 experiments and results 4 1 experimental details we implemented our method and carried out experiments on gid and sentinel 2 dataset two semantic segmentation networks ma and mb in adjusted co teaching use the same unet structure due to the difference in random initialization two models with the same structure can also have different representation capabilities unet mainly consists of two parts the contracting path aims to extract complex contextual information for water bodies and the expansive path restores the semantic water information to the original input size through successive upsampling operations in our models we used resnet he et al 2016 to replace the contracting path of unet resnet can solve vanishing or exploding gradient issues caused by error back propagation through skip connections of the residual module our models were implemented using pytorch and all experiments were executed on a supercomputing platform with nvidia tesla v100 32 gb gpus we used an imagenet deng et al 2009 pretrained model in our network to accelerate convergence and the adam optimizer to minimize losses cross entropy was selected as the loss function the learning rate was initially set to 0 001 and reduced by a factor of 0 1 after 30 epochs the models were trained with a batch size of 16 for 50 epochs furthermore we tested the traditional random forest rf algorithm on our datasets 8000 and 4000 training samples were selected for the gid and sentinel 2 datasets respectively and the number of estimators in the rf algorithm was set to 30 4 2 evaluation metrics to quantitatively evaluate the performance of different water extraction methods we compare the modeling results with real water data the ground truth of sentinel 2 dataset is manually edited and calibrated by domain experts based on ndwi the precision p recall r and f1 score were used as metrics precision represents the ratio of the true water bodies in the recognized water bodies and recall represents the ratio of the recognized real water bodies in the retrieved image f1 score is a comprehensive index that considers both precision and recall they can be calculated as 19 p tp tp f p 20 r tp tp f n 21 f 1 2 p r p r where tp fp and fn represent the numbers of true positives false positives and false negatives at the pixel level respectively 4 3 results in order to verify the effectiveness of our proposed method the experimental results of this paper are compared with other methods fig 5 shows the water extraction results on gid dataset on the whole our method performs significantly better than other threshold segmentation methods whereas intermodes is relatively ineffective the first and second rows in fig 5 are the urban water extraction results with many buildings it can be seen that a large number of buildings bridges and roads are mistakenly identified as water bodies in other water extraction results our method can avoid this problem well and even resist cloud coverage the details are shown in fig 6 the third and fourth rows in fig 5 are suburbs and villages where buildings are sparsely distributed the traditional segmentation algorithms and random forest algorithm still cannot solve the problem of interference of buildings and roads we divided sentinel 2 dataset into three different types of water bodies reservoirs salt lakes and freshwater lakes as shown in fig 7 it can be seen that during the reservoir extraction other threshold algorithms misidentified a large number of buildings roads farmland and mountains as water bodies this is because reservoirs are generally distributed in alpine valleys with large undulating terrain resulting in complex surface radiation and the details are shown in fig 8 except for intermodes all methods are effective in identifying salt lakes because salt lakes are generally distributed in arid or semi arid inland areas of high evaporation and there are few fish and algae in salt lakes because of the high salinity in addition the boundaries of the salt lakes often have white salt belts formed by the migration and deposition of salt materials which makes the boundaries between the lakes and the lands very obvious different methods are effective in identifying freshwater lakes but compared to our method traditional methods are affected by waterside fishing nets farmland and algae resulting in many small and incorrectly extracted water bodies we also quantitatively compared the water extraction effects of different methods as given in table 3 the precision recall and f1 score of our method are much higher than those of the other methods other threshold methods have a high recall rate and low accuracy due to a large number of misrecognition problems we are trying to make up for the drawbacks of these methods it can be seen from the experimental results that our method can significantly improve the accuracy of water body recognition although the recall rate has decreased it still remains at a high level mean gray value has the worst performance although the recall rate is the highest the accuracy rate is the lowest at the same time overall otsu and isodata outperform intermodes and mean gray value specifically on the gid dataset our method achieves increases of 28 4 57 6 for the precision rate and 18 1 40 3 for the f1 score compared with gid the performance difference of different methods on sentinel 2 dataset is smaller our method still achieves increases of 9 5 38 4 for the precision rate and 6 8 22 2 for the f1 score 5 discussion 5 1 the importance of pft our purpose in designing pft is to ensure the accuracy of pseudo samples so that as many real water bodies as possible participate in the training in table 3 we can see that obviously pft achieves this goal pft achieves increases of 30 8 47 2 for gid and 13 8 38 0 for sentinel 2 images in order to further verify the effectiveness and irreplaceability of the pft module we used otsu intermodes isodata and mean gray value instead of pft to generate pseudo labels other modules and parameters remain unchanged the experimental results are shown in table 4 for gid pft has higher accuracy recall and f1 score than other threshold algorithms for sentinel 2 dataset although isodata achieves the highest recall rate the precision and f1 score of pft are still the highest this confirms that pft can extract the real water bodies as much as possible on the basis of reducing the error segmentation which is very important for the subsequent unsupervised training in addition we compared the accuracy of different threshold algorithms before and after adding ca and act modules based on table 3 and table 4 as shown in fig 9 it can be seen that except for the poor performance of intermodes on sentinel 2 dataset all methods have significant improvements on f1 score after using ca and act modules on the whole the modules greatly improve the accuracy of each algorithm despite compromising the recall rate 5 2 the effect of sample sorting in order to make the model easier to train and learn we calculated the confidence of different water segments in an image and then divided the samples into three parts t1 t2 and t3 according to the water confidence from large to small to verify the rationality and effectiveness we conducted a comparative test mixing the samples of t1 t2 and t3 and then randomly sampling them into mini batch training denoted as shuffle t the experimental results are shown in table 5 it can be seen that the sorted samples can improve the accuracy and f1 score of the model which shows that the data division we designed is reliable 5 3 parameters in act in this section we first discuss the influence of the threshold α an important parameter in adjusted co teaching α represents the proportion of real water in the pseudo samples that we estimated in advance also known as the non noise rate when α is close to 0 as the number of training epochs increases eventually all pseudo samples will be discarded as α increases more samples will be retained the other parameters in the experiment are unchanged and the value of α takes a value from 0 to 0 5 with an interval of 0 1 the experimental results are shown in table 6 and fig 10 when α 0 2 gid and sentinel 2 datasets have the highest f1 scores at the same time gid has the highest recall rate and the sentinel 2 dataset has the highest precision rate in the four subfigures of fig 10 the vertical axes on the left and right represent the evaluation values on the gid and sentinel 2 dataset respectively in general the trends of gid and sentinel 2 change with α are the same as α increases f1 score first increases and then decreases then we discuss the influence of the decay steps e this parameter is used to adjust the proportion of small loss instances retained by different epochs the other parameters in the experiment are unchanged and the value of e takes a value from 5 to 10 with an interval of 5 the experimental results are shown in table 7 it can be seen that as e increases the overall effect of the model gradually deteriorates when e 5 gid and sentinel 2 dataset achieve the best results our interpretation of the results is that when the value of e is too large the model will continue to train on pseudo samples full of noise and try to fit these noisy data therefore long enough training is required to correct these errors while when e is small even if the wrong samples are fitted part of the wrong samples can be quickly eliminated in the next stage of training thus guiding the model training back on track 5 4 the influence of the proportion of water bodies we further explored the impact of the proportion of water bodies in the remote sensing image on the recognition accuracy we first calculated the proportion of pixels belonging to the water body in each sample in gid and sentinel 2 dataset and then drew the scatter plots of the precision recall and f1 score with respect to the proportion of water respectively as shown in fig 11 the proportion of water bodies in the gid samples is concentrated between 0 and 0 2 on the whole the precision recall and f1 score have the same trends as the proportion of the water body changes when there are few water bodies in the image the quality of the extraction fluctuates as the proportion of water in the image increases the precision recall and f1 score all increase significantly and they tend to approach 1 which shows that our algorithm can be well adapted to large scale water extraction 5 5 hydrological application of our method poyang lake is the largest freshwater lake in china and its inter annual area changes are driven by both climate changes and human activities we used different methods to monitor the inter annual variation of the area of poyang lake from 2000 to 2020 to verify the feasibility of our method in hydrological application we counted the area of poyang lake every summer in the jrc global surface water dataset pekel et al 2016 as the true value and used the root mean square error rmse to quantitatively evaluate the effectiveness of various algorithms only landsat 7 images with striping problems were available in 2012 in the test area which were excluded because the jrc water data had obvious errors as not processed for striping repair and were not suitable to be validation data therefore we did not use the water extraction results in 2012 the experimental results are shown in fig 12 it can be seen that the variation trend of water body area extracted by different methods is generally consistent with jrc the rmse of our algorithm is the smallest which indicates that our algorithm performs more stable in long term water body monitoring 6 conclusions in this paper we designed an automated water extraction framework without human intervention by evaluating the confidence of the water segments and combining cl and act this method has the following advantages first samples are automatically obtained by segmenting the ndwi images which greatly saves the cost of producing samples second compared with the traditional water index method our method greatly improves the accuracy by introducing deep learning technology third unsupervised deep learning is realized through expertise and prior knowledge in remote sensing this is a new way that helps to improve the current lack of remote sensing datasets in the field of deep learning it should be noted that our method is suitable for a wide range of scenes with a large number of remote sensing images in future work we will focus on leveraging the full potential of deep learning combining more spectral information and remote sensing expertise and expanding the work to automatic high precision extraction of buildings vegetation and other ground objects credit authorship contribution statement junjie li conceptualization methodology software writing original draft yizhuo meng methodology validation yuanxi li formal analysis data curation qian cui resources investigation xining yang writing review editing chongxin tao conceptualization visualization zhe wang investigation linyi li project administration wen zhang writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to thank the anonymous reviewers for their valuable comments that substantially improve the quality of this paper the numerical calculations in this article were performed on the supercomputing system at the supercomputing center of wuhan university this work was funded by the national key research and development program of china no 2021yfb3900603 
3127,the relationship between groundwater and discharge in arctic and sub arctic regions is strongly controlled by permafrost previous work has shown that catchments with thawing frozen soils due to the warming climate are expected to show changes in their storage discharge relationship in this study we use a mechanistic modelling approach to demonstrate that a thawing catchment underlain with continuous permafrost undergoes a dramatic change in storage discharge relationship we demonstrate that the effect of permafrost thaw conceptualized as a reduction of an impermeable layer in the subsurface will likely only be clearly observable as a change in slope of the recession curve of catchments with hillslope gradients 5 for flat catchments 1 hillslope gradient we find no relation with permafrost extent and change in recession curve slope will likely be dominated by changes in active layer parameters such as in shallow surface permeability hydraulic conductivity above permafrost and shallow surface and subsurface water retention specific yield of groundwater specific yield of surface for mildly sloped arctic catchments 5 hillslope gradient change in recession curve slope is controlled both by changes in permafrost extent and the subsurface flow length and subsurface hydraulic properties for the shallow flow with minimal impact from overland flow properties and changes in meteorological factors for moderately sloped arctic catchments 10 hillslope gradient change in recession curve slope change is dominated by changes in permafrost extent and secondly by changes in the subsurface flow length and subsurface hydraulic properties with no impact from meteorological factors or changes in overland flow properties several of the parameters found to be driving shifts in recession curve slopes in our modeling such as changes in active layer thickness and the formation of taliks are more likely than others to evolve with the ongoing arctic climate change in hillslopes helping us understand what drives the real world increases in non linearity of storage discharge relationships keywords permafrost recession curve arctic hydrology thaw storage discharge data availability data will be made available on request 1 introduction as polar regions are warming at a greater rate than any other place on earth research into how these landscapes are changing is paramount taylor et al 2013 the effects of permafrost thaw are major unknowns in current climate and hydrosphere projections walvoord et al 2012 permafrost is such a controlling factor on the landscape that any change has a reverberating effect on the entire system including terrestrial hydrology and the ecosystem schuur and mack 2016 an important hydrological shift occurs once an area of thawed ground i e a talik develops in a permafrost landscape specifically the aquifers above and below the permafrost become connected enabling exchange of groundwater thawing thereby generally leads to increased flow of groundwater in arctic regions as observed by yoshikawa hinzman 2003 walvoord striegl 2007 lyon et al 2009 st jacques and sauchyn 2009 rennermalm et al 2010 and sjöberg et al 2013 this increased hydrological connectivity between the surface and subsurface may not only reduce the length of the drainage network of rivers as more water flows through the subsurface but also allow previously isolated catchments to become interconnected as observed by haynes et al 2018 how shifts in hydrologic connectivity or shifts from surface dominated flows to groundwater dominated flows occur however are fundamentally contingent on the landscape where permafrost is thawing one study walvoord kurylyk 2016 reviewed the hydrologic impact of thawing permafrost and summarized different parameters and their unique impact on an arctic catchment their conclusion was that the trajectories of change are highly influenced by permafrost coverage the non uniformity in thaw patterns subsurface heterogeneity and regional meteorological changes research on arctic catchments with long historic data records of river discharge has revealed increasing trends in catchment base flow and decreasing peaks of discharge indicating that the storage discharge relationship of arctic catchments is changing evans et al 2020 such changes can be quantified by recession analysis as originally developed by brutsaert nieber 1977 the recession curve slope rcs is a direct indication of the non linearity of the storage discharge relationship and can be estimated from stream discharge time series hinzman et al 2020 hypothesized that thawing of permafrost can be observed as an increased non linearity of the storage discharge relationship caused by an increase in hydrologic connectivity catchments underlain with continuous and functionally impervious permafrost typically have one dominate flow path which leads the discharge to increase exponentially with storage essentially a linear reservoir similar to a shallow unconfined aquifer with thawing the number and density of flow paths through the subsurface increase allowing lower order streams to activate and deactivate as a catchment moves from wet to dry conditions creating a non linear reservoir rcs 1 5 analysis of recession curves from boreal and sub arctic catchments in sweden have shown that storage discharge relationships have become more non linear in most catchments but that relatively wide ranges of recession curve slopes rcss and their trends were found even though all catchments have experienced similar climatic trends sjöberg et al 2013 karlsen et al 2019 ploum et al 2019 hinzman et al 2020 while in these studies changes in recession curves were attributed to thawing of permafrost and seasonal frost based on the above stated theoretical considerations their results also point toward additional factors related to either climate or physical properties of catchments being important in how the linearity of the storage discharge relationship is affected by changes in permafrost studies that have used methods other than rcs have found generally the same hydrologic response to permafrost degradation evans and ge 2017 jutebring sterte et al 2018 the variation in climate geology vegetation and topography found within arctic permafrost regions impacts the hydrological cycle through the partitioning of precipitation into runoff evapotranspiration and storage the arctic has a landscape that ranges from high mountainous peaks to low coastal plains with biomes like dry deserts tundra wetlands forests and roches moutonées therefore the impact of permafrost thaw on the storage discharge relationship may depend on such landscape characteristics tananaev and lotsari 2022 examined potential responses of permafrost degradation on fluvial systems and concluded that the influence of permafrost varies across landscapes for example on hillslopes where permafrost controls the hydrology overland flow decreases as the active later expands so permafrost thaw will have a greater impact on hydrologic connectivity in a landscape with steep hillslope gradients rather than in a flat landscape with the same hydrologic connectivity to a certain point permafrost thaw will also have a greater impact on hydrologic connectivity in wetland dominated catchments with saturated soils than arctic desert catchments with unsaturated soils and can confine hillslope runoff to water tracks which is not part of the storage discharge contexts but remains an important role levy et al 2018 while there have been studies of changes in recession flow in catchments with thawing permafrost lyon and destouni 2010 few investigations concern the role of landscape characteristics for the interpreting recession analysis results in the context of permafrost thaw bogaart et al 2016 as we seek to understand why different hydrologic responses emerge from different configurations of arctic landscapes undergoing thaw modelling studies have served to provide a better mechanistic understanding of the effects of permafrost thaw on river discharge however most modelling studies have so far primarily focused on explaining observed increases in winter base flow from across the arctic permafrost has been represented in models either as an impermeable layer in scenarios with decreasing permafrost extents walvoord et al 2012 or by solving the combined water and heat flows and thereby actively capturing declining permafrost extent as climate warms bense et al 2009 sjöberg et al 2013 walvoord et al 2012 could indeed show that with declining permafrost extent in the yukon valley water is re routed to longer and deeper groundwater flow paths to the river similar results were modeled by bense et al 2009 who found increasing groundwater discharge even with surface temperatures stabilizing based on these studies we believe that mechanistic models provide opportunities to also investigate the sensitivity of the non linearity of storage discharge relationships as described by the rcs to permafrost thaw independently from additional factors related to climate and catchment properties as such using models as hypothesis testing tools should allow us to isolate the various dominant landscape properties that control the rcs across the myriad of landscapes present in the arctic specifically models can allow for a systemic comparison of impacts across relevant model parameters that serve to represent the main factors controlling storage discharge conditions for catchments from this perspective the objective of our study is to identify and isolate the potential mechanisms behind observed changes in storage discharge relationships under current warming trends we use a simple hillslope model for a range of scenarios representing varying extents of permafrost from completely frozen to completely thawed to define various degrees of connectivity between surficial active layer and deeper groundwater flow paths first we explore with what different topographic conditions spanning from sloped to flat landscapes a decreasing extent of frozen soils can cause an increase in the non linearity of the storage discharge relationship similar to that previously observed in northern sweden by hinzman et al 2020 secondly we explore the control of physical characteristics on the linearity of the storage discharge relationship the focus here is on physical characteristics that could be expected to affect the recession behavior of catchments such as hydraulic parameters and hillslope length using the modeling approach as a tool for investigation we anticipate these subsurface processes may yield alternative hypotheses for the observed increasing rcs by hinzman et al 2020 and allow for a more generalizable and mechanistically underpinned interpretation of landscape responses to thawing of permafrost 2 methods we aim to explore the potential effects of a frozen layer that inhibits exchange of water between the active layer and the deeper groundwater layer on the response of discharge to rainfall events to do so we propose a simple hillslope water flow model section 2 1 where the goal is not to realistically reproduce catchment scale water balance but rather to capture the response of groundwater discharge to changes in connectivity the model is run with a range of parameter settings and input data covering potential realistic ranges of current and future climate and landscape characteristics for the arctic section 2 2 for ten different permafrost scenarios section 2 3 the simulated water discharge from the hillslope model is then used to quantify the non linearity of the storage discharge relationship through the rcs as proposed by hinzman et al 2020 section 2 4 finally the rcss derived from model output are compared to observed trends in rcs from rivers in northern sweden to put model findings in a real world context 2 1 model the simple hillslope model which is mathematically derived in eq 1 through eq 6 below runs in r using the reactran and desolve packages soetaert et al 2010 soetaert and meysman 2012 the model consists of two 1d groundwater layers representing an unconfined upper layer and a deeper ground layer fig 1 which can be confined or unconfined depending on the extent of the frozen soil layer which separates the two aquifer layers the horizontal domain is 100 m long spatially discretized with each cell being 1 m in length the top aquifer and confining permafrost layers are an arbitrary 1 m thick while the bottom aquifer is 2 m thick groundwater flow between the unconfined active layer and the aquifer confined below the permafrost is calculated by the last terms of eq 1 from the perspective of the upper unconfined aquifer layer 1 and by the last term of eq 3 from the perspective of the layer below the permafrost layer 2 permafrost is represented as a resistance to vertical flow c d taliks are represented as small patches of low resistance in a high resistance permafrost layer see section 2 3 calculation of the groundwater flux comes from the combination of the conservation of mass equation darcy s law and the dupuit assumption bresciani et al 2014 1 h 1 t sy 1 t 1 h 1 x x p e t h 1 h 2 c 2 sy 1 sy gw i f h 1 s u r f a c e d 1 sy s i f h 1 s u r f a c e d 1 3 h 2 t s y 2 t 2 h 2 x x h 1 h 2 c 4 sy 2 sy gw i f h 2 d 3 s aq i f h 2 d 3 in these equations h1 and h2 m are the hydraulic head for layer 1 and 2 respectively t d is time p m d 1 is precipitation and c d is the resistance of the permafrost thawed layer to groundwater flow sy 1 is specific yield for layer 1 and t 1 m2 d 1 is transmissivity of layer 1 when groundwater level in layer 1 exceeds the surface surface flows occur the dynamics of these surface flows are controlled by the sys specific yield of surface flows in eq 3 sy 2 is specific yield for layer 2 which depends on whether the aquifer is unconfined first condition or confined second condition t2 m2 d 1 is transmissivity of layer 2 throughout the vertical model domain we assumed a uniform non linear conductivity profile k y with k0 m d 1 at the bottom of layer 2 and k d m d 1 at the surface of layer 1 following the formulation of rupp selker 2005 where y m denotes the position and d1 the position of the surface fig 1 above the bottom of layer 2 5 k y k 0 k d k 0 y d 1 n where n denotes the curve of the depth profile of conductivity this becomes a function when integrating over the depth of the layers eq 6 transmissivity m2 d 1 eq 7 for the active layer t 1 above the permafrost is obtained by integrating the hydraulic conductivity profile from the bottom of layer 1 d 2 to either the water table h 1 when the water table is below the surface d 1 or the surface when the water table is above the surface the transmissivity of the ponded layer on top of the surface is added to the transmissivity of layer 1 eq 7 6 f y 0 y k y d y y k 0 k d k 0 n 1 y d 1 n 7 t 1 f y m i n h 1 d 1 f y d 2 r s d p 8 t 2 f y m i n h 2 d 3 where f is a function that calculates the full transmissivity of the subsurface from the bottom of layer 2 to the position of interest y m rs m d is a high conductivity for surface flows and dp m is the ponding depth transmissivity of layer 2 eq 8 t 2 below the permafrost is obtained by integrating from the bottom of layer 2 to lowest of the hydraulic head in layer 2 h 2 or the top of layer 2 d 2 boundary conditions of the model are as follows 1 p and et enter and leave every cell of layer 1 2 upstream left side has no flow boundary for both layers 3 downstream right side has a constant head 0 5 m below the surface d 1 in layer 1 and no flow in layer 2 all water thus leaves through layer 1 and is considered discharge q the model runs with daily input and output but the solver calculates sub daily time steps using the lsodes solver from the desolve package soetaert et al 2010 2 2 permafrost scenarios we constructed 10 scenarios ranging from 100 permafrost to 0 permafrost following the scenarios proposed by walvoord et al 2012 we followed their configurations as closely as possible to represent realistic degradation of the permafrost table 1 and fig 2 the scenarios can be seen as a collection of individual coverages of different locations that typify the current arctic condition or expressed as a temporal sequence of possible long term permafrost thaw where each scenario builds upon the last scenario with increased thawing in the cont100 scenario the layer between the two aquifers is completely frozen 100 permafrost in cont95 95 permafrost which represent realistic continuous permafrost distribution a talik is formed at the base of the hillslope adjacent to the river representing a river talik the broadening of thawed ground section e g dis89 is seen in nature with the formation of taliks when permafrost is discontinuous or sporadic connon et al 2018 taliks develop typically under water bodies streams rivers or thawed lakebeds and can also develop in locations with thick snow cover or after exceptionally deep seasonal thawing of the active layer which does not freeze completely back during the following winter in scenarios dis88t and spor30 new taliks are opened up on the hillslope and there is a shift from mostly permafrost to mostly non permafrost coverage across the hillslope respectively scenario spor13 has three small spots of permafrost while the spor0 scenario is completely free of permafrost representing an unconfined 2 layer aquifer 2 3 input data and parameter ranges the hillslope model was setup with base case scenario parameter values table 2 for each of the ten permafrost scenarios additionally we considered three hillslope gradients 1 5 and 10 slope to allow for representation of the relatively flat to more alpine landscapes that can occur across the arctic for each model set up specifically a total of 30 setups of 10 permafrost scenarios by 3 hillslopes the model parameters table 2 were tested we adopted parameter value ranges from the literature to be representative of conditions that are prevalent in the arctic or come from modeled predictions of arctic climate in the future as such we conducted 4 sensitivity scenarios for each parameter so that 120 individual set ups of the model were run for each parameter with 1080 set ups overall for each variable we selected a base case value and a parameter range observed precipitation p and estimated evaporation et from karats a catchment in northern sweden were used as model input evapotranspiration was estimated using maximum and minimum annual air temperatures using the priestley taylor approach priestley and taylor 1972 karats was chosen due to the length and completeness of data collection from 1951 to 2018 precipitation and air temperature data were retrieved from the swedish meteorological and hydrological institute smhi shmi 2018 the average precipitation for the time period used was approximately 1200 mm y and the annual potential evapotranspiration was a low 210 mm y daily time series of p and et for the period 1952 2018 were used as input to the model p and et ranges came from stocker et al 2013 who projected a range of future arctic precipitation and evapotranspiration from a drier climate 0 8 times the original dataset to a wetter climate 1 3 times the original dataset the model s subsurface flow length dl has a base case of 100 m we varied dl from half of the base case 50 to double the base case 200 the base case for n which controls the curvature of the hydraulic conductivity profile was chosen to be 2 and was varied from 1 to 4 representative of values applied in rupp selker 2006 the conductivity profile influences the ease of groundwater flow through the aquifer when n 1 the hydraulic conductivity decreases linearly with depth while with a larger n the hydraulic conductivity decreases exponentially the base cases for specific yield sygw the hydraulic conductivity at the top boundary of the aquifer k d and the hydraulic conductivity at the bottom boundary of the aquifer k0 were taken from the yukon basin groundwater model study by walvoord et al 2012 hydraulic conductivities relate to the lithology k0 and k d represents the ease at which water flows through the ground which is a function of grain size density and the overall structure of the soil in permafrost the hydraulic conductivity is extremely low almost 0 for k d for the base value we adopted 10 m d 1 representative of a medium coarse alluvium walvoord et al 2012 the k d range was double and half of the base case which reflects the range of fine to course alluvium reported by walvoord et al 2012 stevens et al 2018 a k0 s base value of 1 m d 1 was chosen to represent the deeper mountain alluvium walvoord et al 2012 the range of k0 was half and double that of the base case reflecting the range from fine alluvium to mountain alluvium walvoord et al 2012 stevens et al 2018 although these k values are representative for common lithologies they do not take into account relationships between conductivity lithology and landscape position such as the typically found higher lower conductivity on steeper flatter slopes the ranges for sygw was half and double the base case and is within the range of specific yields found from samples taken by price schlotzhauer 1999 and quinton et al 2000 rs is meant to be high as it represents surface flows and very shallow groundwater flow with little to no resistance therefore rs and its range was chosen as an order of magnitude larger than k d but not as high as suggested in gao et al 2015 specific yield for surface flows sys has a base value of 1 0 due to the flow of water being above ground and cannot be exceeded the range goes from the maximum specific yield 1 0 to the base value of specific yield sygw 0 20 values below 1 0 can be interpreted as the effect of partial ponding of the lowest sections within a grid cell 2 4 recession curve analysis the recession analysis method of the modeled discharge follows that of hinzman et al 2020 recession analysis quantifies the storage discharge relationship of a catchment during recession periods the discharge q is plotted as log dq dt against log q after which the intercept α and slope β are estimated eq 9 during periods when groundwater discharge is the only water leaving or entering the catchment the rate of discharge change dq dt mm d d during the recession is denoted as 9 dq dt q dq ds α q β in which discharge q mm d and the sensitivity of discharge to changes in storage dq ds d 1 is empirically related to the intercept α m m 1 β d β 2 and the slope of a straight line fitted to the data β as seen in kirchner 2009 our recession analysis focuses on the slope of the recession line as indicator of flow path complexity our recession analysis was expanded to the form in eq 10 to take into consideration the effect of rain and evapotranspiration conditions 10 log dq dt log 1 e q p q log α β l o g q in which small amounts of precipitation p mm d and evapotranspiration et mm d relative to discharge are allowed for inclusion of more data points we thus use eq 10 to estimate the α and β constants by logarithmic regression to the modeled data four criteria must be met for including a modelled discharge data point in a recession curve analysis 1 discharge must be declining 2 there must be at least two consecutive days of declining discharge for the points to be included 3 the first day of the recession is excluded in the analysis to insure the points are absolutely recessions and 4 precipitation is small less than20 compared to discharge a binning procedure taken from kirchner 2009 was implemented to avoid a bias towards an overrepresentation of low flows in this procedure discharge is divided into 100 bins of equal range the average discharge value in each bin is then used for the recession analysis fig 3 bottom 3 results 3 1 base case effect of hillslope for the base case model we find that as permafrost presence decreases the rcs increases for all three hillslope gradients fig 4 furthermore this increase in rcs is much more pronounced for steeper hillslopes gradient of 10 than for shallower hillslopes gradient of 1 fig 4 for the 10 hillslopes gradient the rcs increases from 0 98 in continuous permafrost cont100 to 1 7 in the permafrost free spor0 condition while the recession slope only varies between 1 2 and 1 4 for the 1 hillslope gradient for the 5 hillslope gradient we see an increase in rcs from 1 2 to 1 5 with a strong increase in the rcs at the first introduction of a small upslope talik in the permafrost dis88t further scenarios with bigger taliks or more upslope taliks than dis67 do not exhibit the same strong effect on the rcs 3 2 sensitivity analysis we evaluated the sensitivity of the rcs for each of the model parameters and for each of the permafrost scenarios the change of the rcs over the parameter range was considered the parameter impact fig 5 gives the direction of change and fig 6 shows the impact range of each parameter for the 10 hillslope gradient specific yield sygw curvature of the hydraulic conductivity profile n hydraulic conductivity on the top of unconfined aquifer k d hydraulic conductivity on the bottom of confined aquifer k0 and subsurface flow length dl had the largest impacts 0 15 parameters which had the largest impacts for 5 hillslope gradient were sygw n and dl 0 15 the largest impacts for the 1 hillslope gradient came from specific yield on the surface sys sygw precipitation p and dl 0 15 however the 1 hillslope gradient simulation results indicated a very large rcs range throughout the permafrost scenarios yet the base case does not change between permafrost scenarios indicating high sensitivity to changing parameters but not thawing permafrost the gradient of steep hillslopes controlled the impact of surface related parameters on the rcs the impact of the surface related parameters on flatter hillslopes were however not controlled by the hillslope gradient this variation in surface related parameter control is illustrated by the smaller range of sys on hillslopes gradient of 10 and 5 fig 6 compared to the sys range seen on a 1 hillslope gradient fig 5 a change in correlation between parameter and rcs with decreasing permafrost was found for p k d and dl for the 10 hillslope gradient and sys p roughness coefficient of the surface rs k d k0 evapotranspiration et and dl in the 5 hillslope gradient for the 1 hillslope gradient k0 was the only parameter that changed correlation however k0 had only minor impact on the rcs specific yield sygw had a small positive impact on the rcs for catchments with a hillslope gradient of 10 the average increase per scenario is 0 14 fig 6 for 5 hillslope gradients sygw had a negative impact on the rcs up to the development of the mid slope talik dis88t with an average increase of 0 11 per scenario afterwards afterwards sygw had a positive impact on rcs from discontinuous dis67 up to permafrost free spor0 with an average increase of 0 20 fig 5 the rcs for 1 hillslope gradients was extremely sensitive to changes in sygw for all permafrost scenarios with an average increase of 0 48 per scenario the hydraulic conductivity profile of the model controlled by the three parameters k d k0 and n affected the storage discharge relationship mainly in the scenarios with steeper hillslope gradients hydraulic conductivity at the top of the aquifer k d for the 10 hillslope gradient had a negative impact on the rcs for the first four permafrost scenarios cont100 dis88t the average decrease per scenario was 0 22 afterwards k d had a positive impact average increase of 0 39 per scenario for the 5 hillslope gradient k d had a negative impact on the recession slope until dis55 with an average decrease of 0 24 for each scenario after dis55 there was a positive impact with average increase of 0 12 per scenario for the 1 hillslope gradient all rcs had a small positive relationship for k d with an average increase of 0 10 hydraulic conductivity at the bottom of the aquifer k0 had a negative influence on the rcs for the 10 hillslope gradient that became stronger as the permafrost presence decreased up to a decrease of 0 37 for the permafrost free scenario for the 1 and 5 simulations k 0 had only minor effects on the rcs both negative and positive that did not change the rcs 0 10 the curvature of the hydraulic conductivity profile n had a positive correlation with rcs for 10 and 5 hillslope gradients with average increases of 0 18 and 0 16 per scenario respectively for 1 hillslope gradients effects of n did not exceed 0 06 for any scenario near surface and surface flows were controlled by the rs and sys parameters in the model and affected the rcs mainly in simulations with low slope the effects of the roughness coefficient on the rcs did not change 0 1 for any of the simulations the specific yield of near surface flows sys did not impact the rcs for any of the 10 or 5 hillslope gradients but was highly influential for the 1 hillslope gradient with a negative influence in all permafrost scenarios average decrease of 0 34 for each scenario fig 6 the overall change of the rcs given the range in parameters as permafrost presence decreased for all hillslope gradients was still positive fig 6 for the 10 hillslope gradient the change in permafrost has a stronger effect on rcs than any of the other parameters for the 5 hillslope gradient half of the parameters especially dl have a larger impact than the reduction in permafrost while for the 1 hillslope gradient almost all parameters have a stronger effect than permafrost presence 3 3 real world comparison we compared the results from the modeled hillslopes to observations from catchments in northern sweden fig 7 we extracted the average slope of the catchment using the 2010 slu forest map slu 2005 nine catchments had a hillslope gradient of roughly 10 three catchments had a hillslope gradient close to 5 there are no catchments with a hillslope gradient of 1 thus a direct comparison based on hillslope gradient cannot be made with the exception of one catchment the rcss were between the ranges seen in the cont100 and spor0 scenarios 12 out of 16 swedish catchments experienced a significant increase in rcs while none of the catchments had a significant decrease hinzman et al 2020 no significant correlation was found between the average slope of catchments and the average rcs nor with the average catchment slope and change in rcs we see that the average swedish catchment had an rcs that increased an average of 0 0058 per year over a sixty year period this increase was comparable to the increase in rcs from fully permafrost to permafrost free for the 5 and 10 hillslope gradients of our model fig 7 4 discussion 4 1 effect of hillslope gradient categorizing arctic hillslope gradients by using arcticdem porter et al 2018 50 of the area have hillslope gradients of 2 5 22 of the area is moderately sloped hillslope gradients between 2 5 and 7 5 and 11 of the area categorized as steep hillslope gradients between 7 5 and 12 5 this is a good indicator that the hillslope gradients we selected are good representatives for the arctic most arctic landscapes with continuous permafrost are flat or mildly sloped 0 8 75 hamm and frampton 2021 unlike for the 10 and 5 hillslope gradient models the difference of rcs between permafrost scenarios in 1 hillslope gradient is not large as seen in figs 6 and 7 our results suggest that the hillslope gradient of the catchment strongly controls the direct effects of permafrost thaw on river discharge dynamics the model with the 10 hillslope gradient showed a strong change in rcs with declining permafrost extent while the simulations with the 1 hillslope gradient hardly showed any effect of permafrost thaw previous studies already demonstrated that hillslope gradient itself has a strong relation with rcs e g bogaart et al 2016 based on our results we can go further and hypothesize that the effects of permafrost thaw on river discharge dynamics are much stronger for sloped than flat catchments from our model results we see that flat catchments tend to be wetland catchments under the climate of northern sweden there is only a small gradient to drive water flow and this lack of energy to drive flow causes catchments to become saturated with or without permafrost these catchments fill up with water and the permeable shallow subsurface and surface flow transport the bulk of the water for both cases in flat catchments our 1 gradient model regardless of permafrost presence the shallow flow paths dominate water transport therefore there is little difference in rcs the sloped simulations show that the energy created by the hillslope itself is enough to support substantial flow through the deeper less permeable layers under the complete permafrost scenario the deeper layer receives little water and most flow occurs above the permafrost fig 2 left column once permafrost starts to thaw water will infiltrate to the deeper layer and a substantial part of the water from then on will flow through the deeper layer towards the river driven by the topographic gradient when the sloped system drains from a wet to dry state the ratio of above and below permafrost flows decreases which in combination with the non linear permeability depth profile causes the non linear storage discharge behavior observed based on the increase of the rcs between scenarios seen in fig 6 we now expect a stronger direct effect of permafrost thaw on rcss for steeper catchments these results thus notably nuances the conceptual ideas proposed by hinzman et al 2020 the proposed conceptual model is clearly more appropriate for sloped than flat catchments based on our results we cannot pinpoint at which hillslope gradient percentage or when permafrost thaw affects rcs moreover this is likely an interplay between hillslope potential energy driving water flow hillslope length and climate the amount of water and the subsurface permeability the resistance against flow which thus may yield site dependent critical slopes harman and sivapalan 2009 in this analysis it was not possible to distinguish hydrologic responses associated with an increasing active layer from those caused by thawing of deeper permafrost walvoord and kurylyk 2016 4 2 sensitivity analysis flat catchments did not show a direct effect of permafrost thaw on the rcs but instead showed sensitivity to physical properties and to lesser extent climatic factors with our sensitivity analysis we determined that in flat catchments the rcs is most sensitive to the specific yield of the shallow unsaturated zone sygw the specific yield used for surface flows resembling the effects of surface topography variations sys a representation of increase of ponding depth per added water layer and the high end permeability at the surface of the permeability depth profile k d these factors control water flow near the ground surface of our model domain and in the flat model scenario much of the change in groundwater level also occurs in the shallow surface fig 8 to illustrate the point in both the cont95 and spor18 scenarios the groundwater levels of the unconfined and confined aquifers are distinct and do not converge until the end of the hillslope for the 10 and 5 hillslope gradients for the 1 hillslope gradient the groundwater level for the confined aquifer rises above the permafrost and is now in shallow surface for much of the hillslope represented by the model fig 8 while these near surface factors are often viewed as constant in time they may be indirectly affected by a warming climate through changes in organic matter accumulation or decomposition ise and moorcroft 2006 or rooting of new vegetation types as an example from tundra to boreal forests gonzalez et al 2010 or expansion of burrowing of earthworm into the arctic blume werry et al 2020 seasonal ground freezing which is not represented in our model also strongly controls the hydraulic properties of the near surface soil and changes as a consequence of climate warming wang et al 2019 liu et al 2020 thus while our results suggest that the direct effect of permafrost thaw on recession slope curves are small in flat landscapes other climate warming induced processes may still cause a change in rcs for 5 hillslope gradient dl plays in important role in every permafrost scenario we expect that due to permafrost thaw water flow paths deepen and groundwater flow increases relative to near surface flow frey mcclelland 2009 frampton et al 2013 a longer hillslope length suggests catchments connecting which means more area open to precipitation input creating wetter conditions near the stream which causes a more non linear system with higher rcs fig 9 under sporadic permafrost conditions the extra water transport that accompanies a longer hillslope length is routed through deeper subsurface flow paths fig 9 if the surface permeability increases with decreasing permafrost for example due to extra vegetation growth or weathering we see an increase in rcs this may further increase the rcs in addition to the primary effects of permafrost thaw evans et al 2020 also suggested that various permafrost states e g continuous discontinuous sporadic have different hydrologic parameters which impact the catchment s recession for the hillslope gradient of 10 we found a strong effect of declining permafrost on the rcs in contrast to the 1 hillslope gradient the steeper model domains had a much lower groundwater level throughout most of the domain and were less sensitive to the near surface parameters that strongly affected the results from the 1 hillslope gradient we found in the 10 hillslope gradient model the most sensitive parameters had an opposing effect on the rcs for complete permafrost and permafrost free conditions dl k d in fig 5 this opposing effect means that the direction of the effect from these parameters on the rcs depended on the amount of permafrost turning this result around means that the effect of permafrost thaw on the rcs was stronger for smaller hillslope lengths dl i e a small dl reduces rcs under full permafrost and increases rcs under permafrost free condition and for higher k d values we put forth that the combination of permafrost and hillslope gradient does not allow precipitation to easily infiltrate and instead becomes surface runoff until the permafrost thaws enough for infiltration when infiltration begins the steep gradient means the longer hillslope length causes more shallow groundwater and surface flows than a shorter hillslope length creating a more linear system and decreasing the rcs fig 9 with the greater volume of shallow water flows associated with a longer hillslope the hydraulic conductivity of the subsurface becomes more important dampening the reaction time of the system and also causing a more linear storage discharge relationship thus over the timescale of a continuous permafrost catchment becoming a sporadic permafrost catchment limited infiltration of precipitation and shallow subsurface flow will be increasing factors for the rcs after most of the permafrost has thawed infiltration and shallow subsurface flow will be decreasing factors for the rcs an increase in p means more precipitation entering the model and in the flat catchments or catchments with less than 50 permafrost that influx of water makes the rcs more linear the explanation for the difference in direction for steeper catchments with 50 permafrost is the increased amount of precipitation cannot completely infiltrate the ground causing surface flow and an increase in rcs an increase in et means more precipitation is removed from the model which lowers the rcs both p and et have minimal effects on the rcs an increase in dl has a similar effect on the rcs as an increase in p for flat catchments and steep scenarios with less than 50 permafrost there is a decrease in rcs driven by an increase in discharge q for scenarios with 50 permafrost and in mildly sloped catchments an increase in dl has a positive impact on the rcs dl is more influential on the rcs than p and et fig 5 as dl was allowed to vary between 0 5 and 2 times the base value while p and et where varied between 0 8 and 1 3 times the base value table 2 the sensitivity to the climatic factors p and et varied between both permafrost and hillslope gradient scenarios but did not exceed a change of 0 10 in any scenario this result agreed with our assumption that the rcs was primarily a measure of landscape features that control how landscapes release water via rivers which is thus not strongly controlled by meteorological conditions an increase in sygw means a greater volume of water is drained from the same volume of soil per unit of groundwater level change which causes a more stable groundwater level this has a small impact in steeper catchments but for flat catchments an increase in sygw has a notable positive influence on the rcs this is likely due to ponding and a subsequent quicker response via surface flows in response to precipitation events an increase in k d and k0 is more impactful on the rcs in sloped catchments as an increase in free movement of water on a gradient means gravity can act on more water at any given time the directional influence of increasing k d changes as permafrost thaws in steep and moderately sloped catchments this happens after the introduction of the talik in scenario dis99t in steep hillslopes and after the majority of permafrost has thawed in moderate hillslopes in scenarios with large amounts of permafrost 67 the exchange of water between confined and unconfined aquifers can be hampered by permafrost which results in the negative correlation found when increasing k d as the permafrost limits the groundwater exchange k0 becomes more influential as permafrost thaws with an increase of k0 more groundwater can flow in the confined aquifer underneath the permafrost layer hydraulic conductivity is generally greater nearer the surface and decreases exponentially with depth an increase in the curvature of the hydraulic conductivity profile n indicates the hydraulic conductivity becomes even greater as one approaches the surface higher values of n therefore promote more shallow groundwater flow and a more non linear increase of hydraulic conductivity with increasing groundwater levels an increase in rs has no impact on sloped catchments and minimal impact on flat catchments a decrease in the specific yield of surface flow sys means that the surface water layer is more variable over time under influence from precipitation and evapotranspiration than for the base value of 1 in sloped catchments the hillslope gradient is large enough that all precipitation can be transported through the shallow subsurface and therefore changing the specific yield for surface flows has no impact for flat catchments it is more stagnant and therefore any change of sys has a large impact on the rcs in this case a decrease in sys will increase surface water layer dynamics and results in a more non linear rcs 4 3 swedish catchments the range of rcss from our simple model simulations corresponds well to values found for the 16 swedish catchments although the range derived from the catchment discharges is slightly larger than from the simulations this is expected as in reality there are many more non linear processes involved in runoff generation such as dynamics drainage networks kokelj et al 2020 and flow dependent river levels blaen et al 2014 which are not accounted for in our simulations but are likely to yield more non linear storage discharge relationships and thus larger rcss the change in simulated rcs for 5 and 10 hillslope gradients going from completely permafrost to permafrost free is fairly similar to the observed increases in rcss for these catchments during the last 70 years however we do not clearly see the difference in the observed change in rcss between more steep and more flat catchments that is suggested by our model results for the real catchments this distinction is difficult to make because these catchments are all larger catchments with steeper and flatter sections two out of the three flattest catchments show a significant increase in rcs for metajärvi 390 km2 the flattest and smallest catchment we indeed see no significant change in rcs all the steep catchments 15 show an significant increase in the rcs 0 008 per year however the increase also depends on the size of these levy et al 2018 catchments localized impacts vs regional impacts of thaw if and how fast permafrost is thawing mckenzie and voss 2013 sjöberg et al 2013 4 4 limitations and applicability we simulated the hydrologic response to the net result of changes in the surface and subsurface distribution of frozen ground without including the seasonal frost dynamics in our model as such the model did not capture a distinction between changes in the active layer from that of thawing of deeper permafrost our domain included an unfrozen aquifer on top of a layer of permafrost similar to a real world seasonally thawed active layer overlaying permafrost during summer seasonal changes in soil frost are expected across the arctic and are likely to also impact the hydrology of cold regions bringing about greater subsurface storage and general increases in low flows due to the strengthened hydrologic connectivity bring et al 2016 hydraulic conductivity is expected to vary with landscape position thus selecting a base conductivity averaged over multiple lithologies while changing the hillslope gradient does not take into account landscape relations between permeability lithology and slope our results may thus be primarily representative for catchments with high permeability throughout the soil profile and limited anisotropy in hydraulic conductivity walvoord et al 2012 a gradual thickening of the active layer which is expected following warming was also not explicitly included in our model our results are therefore perhaps most representative for identifying differences in summer conditions related to permafrost extent but may not be capturing the full extent of hydrological changes expected in arctic catchments however it would be possible to elucidate the consequences of changes in frozen state of the surface and subsurface ground using our approach if one restricted this analysis to only winter baseflow for example when surface hydrologic processes were inactive it would be possible to better understand the effects of thawing permafrost if one then compared those results to the analyses presented here it would be possible to describe the results of deepening active layer our model set up is based on a thin permafrost layer underlain with unfrozen material this situation is reflective of areas in the southern permafrost boundary such as central alaska sweden and western russia but globally this a unique setting for example permafrost in the northern permafrost boundary has thicker permafrost layers this should not take away from the importance of our results the southern permafrost boundary is undergoing the greater change in terms of permafrost thaw and could be representative of the future of the far north permafrost 4 5 the value of models in explaining real world changes in permafrost landscapes models are often generalizations of real world situations designed to provide insight to specific problems in the world around us in our 2d hillslope water flow model we generalize for example the representation of permafrost as a layer with high resistance which greatly simplifies the actual complexity of permafrost sjöberg et al 2016 however the features that are part of the proposed model setup namely permafrost scenarios hillslope gradient slope length and non linear conductivity depth profiles deep shallow and surface flows are expected to affect the relationship between storage and discharge more specifically the rcs based on results of previous studies rupp selker 2006 hinzman et al 2020 typically derives interpretation from such simplified representations of groundwater aquifers brutsaert and nieber 1977 troch et al 2013 since the 1950 s permafrost has been declining in the mountain range of northern sweden we expected that this decline in permafrost significantly affected river flows in the region however to date it remains very difficult to separate direct precipitation and temperature change effects on river flows from the more indirect subsurface and surface change effects on river flows rushlow godsey 2017 docherty et al 2019 especially because long term measurements of permafrost or soil permeability are rare in the arctic river discharges are the only measurement that is systematically being recorded in northern sweden and to a lesser extent throughout the arctic laudon et al 2017 and contain the integrated signal of all upstream processes therefore it will be advantageous to untangle the changing surface and subsurface signals found in river discharge in response to climate warming specifically because these changes do impact climate change impact studies for the arctic and therefore constitute a major source of uncertainty mckenzie et al 2021 looking to the recession curve slope as measure for the non linearity of the relation between storage and discharge of catchments in our view is a promising venue to identify the changes in how catchment release their water however such an approach requires a further mechanistic underpinning of which the initial steps are undertaken by this study to our knowledge this is the first study that systematically investigates how landscape features in conjunction with permafrost affect the storage discharge relationship within such a simple model setup several modelling studies also with more realistic model setups looked at the effects of permafrost thaw on river discharges however these studies used stationary models focusing on winter low flows sjöberg et al 2013 or focused on the combined heat water transport and the actual thawing processes sjöberg et al 2016 to date none of these models have been able to explain the observed increase in non linearity of storage discharge relationships in northern sweden during the last 6 decades hinzman et al 2020 in this regard we expect that our results give direction for follow up studies exploring interacting impacts that might exist within a complex heterogeneous landscape we stress that this study only finds potential controls on rcs that fall within the model assumptions regardless our results illuminate on the impact of permafrost on river runoff under different hillslope and subsurface characteristics that build on the conceptual interpretations previously proposed by hinzman et al 2020 5 conclusion this study explores with a basic mechanistic water flow model the potential effects of permafrost thaw on the storage discharge relationships of catchments the storage discharge relationship is quantified through the recession curve slope rcs this study has shown that the actual effect of permafrost thaw conceptualized as the reduction of an impermeable layer in the subsurface will likely be most clearly visible in the rcs of sloped catchments for flat catchments 1 hillslope gradient no clear effects of permafrost were found on the rcs here a change of rcs with climate change will likely be dominated by changes in shallow surface parameters such as surface permeability k d and shallow surface water retention sygw and sys for moderately sloped arctic catchments 5 hillslope gradient we did find a clear effect of permafrost thaw at the moment the first upstream talik a permeable connection between the surface and the aquifer below the permafrost is formed up to and after this moment the rcs signal will likely be dominated by changes in subsurface length per area dl and the aquifer hydraulic properties k d and sygw for steep arctic catchments 10 hillslope gradient we found the strongest signal of permafrost thaw with a strong increase in rcs from completely frozen rcs 1 to unfrozen conditions rcs 1 8 the rcs signal in the later stages of permafrost thaw will likely be dominated by changes in the subsurface flow length dl and hydraulic conductivity profile k d k 0 and n parameters all of these parameters are also likely to change with the ongoing arctic climate change for example k d sys and sygw are likely to change through the development of vegetation that changes the surface water flow or an increase in the organic layer of soil due to increasing bioturbation by invertebrates migrating north and changes in the active layer depth hydraulic conductivity k d and k0 will exert increasing control on rcs as permafrost thaws changing active layer thickness previously isolated catchments connecting or the formation of taliks facilitating the exchange of groundwater sygw dl and n will all cause the storage discharge relationship to evolve these findings based on a basic model of hillslope water flows provide a step forward in the interpretation of rcss for the arctic credit authorship contribution statement alexa marion hinzman conceptualization methodology formal analysis writing original draft visualization ylva sjöberg conceptualization writing review editing steve lyon conceptualization writing review editing peter schaap methodology software writing review editing ype van der velde conceptualization methodology software writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is part of the research program netherlands polar programme with project number alwpp 2016 014 which is financed by the dutch research council nwo 
3127,the relationship between groundwater and discharge in arctic and sub arctic regions is strongly controlled by permafrost previous work has shown that catchments with thawing frozen soils due to the warming climate are expected to show changes in their storage discharge relationship in this study we use a mechanistic modelling approach to demonstrate that a thawing catchment underlain with continuous permafrost undergoes a dramatic change in storage discharge relationship we demonstrate that the effect of permafrost thaw conceptualized as a reduction of an impermeable layer in the subsurface will likely only be clearly observable as a change in slope of the recession curve of catchments with hillslope gradients 5 for flat catchments 1 hillslope gradient we find no relation with permafrost extent and change in recession curve slope will likely be dominated by changes in active layer parameters such as in shallow surface permeability hydraulic conductivity above permafrost and shallow surface and subsurface water retention specific yield of groundwater specific yield of surface for mildly sloped arctic catchments 5 hillslope gradient change in recession curve slope is controlled both by changes in permafrost extent and the subsurface flow length and subsurface hydraulic properties for the shallow flow with minimal impact from overland flow properties and changes in meteorological factors for moderately sloped arctic catchments 10 hillslope gradient change in recession curve slope change is dominated by changes in permafrost extent and secondly by changes in the subsurface flow length and subsurface hydraulic properties with no impact from meteorological factors or changes in overland flow properties several of the parameters found to be driving shifts in recession curve slopes in our modeling such as changes in active layer thickness and the formation of taliks are more likely than others to evolve with the ongoing arctic climate change in hillslopes helping us understand what drives the real world increases in non linearity of storage discharge relationships keywords permafrost recession curve arctic hydrology thaw storage discharge data availability data will be made available on request 1 introduction as polar regions are warming at a greater rate than any other place on earth research into how these landscapes are changing is paramount taylor et al 2013 the effects of permafrost thaw are major unknowns in current climate and hydrosphere projections walvoord et al 2012 permafrost is such a controlling factor on the landscape that any change has a reverberating effect on the entire system including terrestrial hydrology and the ecosystem schuur and mack 2016 an important hydrological shift occurs once an area of thawed ground i e a talik develops in a permafrost landscape specifically the aquifers above and below the permafrost become connected enabling exchange of groundwater thawing thereby generally leads to increased flow of groundwater in arctic regions as observed by yoshikawa hinzman 2003 walvoord striegl 2007 lyon et al 2009 st jacques and sauchyn 2009 rennermalm et al 2010 and sjöberg et al 2013 this increased hydrological connectivity between the surface and subsurface may not only reduce the length of the drainage network of rivers as more water flows through the subsurface but also allow previously isolated catchments to become interconnected as observed by haynes et al 2018 how shifts in hydrologic connectivity or shifts from surface dominated flows to groundwater dominated flows occur however are fundamentally contingent on the landscape where permafrost is thawing one study walvoord kurylyk 2016 reviewed the hydrologic impact of thawing permafrost and summarized different parameters and their unique impact on an arctic catchment their conclusion was that the trajectories of change are highly influenced by permafrost coverage the non uniformity in thaw patterns subsurface heterogeneity and regional meteorological changes research on arctic catchments with long historic data records of river discharge has revealed increasing trends in catchment base flow and decreasing peaks of discharge indicating that the storage discharge relationship of arctic catchments is changing evans et al 2020 such changes can be quantified by recession analysis as originally developed by brutsaert nieber 1977 the recession curve slope rcs is a direct indication of the non linearity of the storage discharge relationship and can be estimated from stream discharge time series hinzman et al 2020 hypothesized that thawing of permafrost can be observed as an increased non linearity of the storage discharge relationship caused by an increase in hydrologic connectivity catchments underlain with continuous and functionally impervious permafrost typically have one dominate flow path which leads the discharge to increase exponentially with storage essentially a linear reservoir similar to a shallow unconfined aquifer with thawing the number and density of flow paths through the subsurface increase allowing lower order streams to activate and deactivate as a catchment moves from wet to dry conditions creating a non linear reservoir rcs 1 5 analysis of recession curves from boreal and sub arctic catchments in sweden have shown that storage discharge relationships have become more non linear in most catchments but that relatively wide ranges of recession curve slopes rcss and their trends were found even though all catchments have experienced similar climatic trends sjöberg et al 2013 karlsen et al 2019 ploum et al 2019 hinzman et al 2020 while in these studies changes in recession curves were attributed to thawing of permafrost and seasonal frost based on the above stated theoretical considerations their results also point toward additional factors related to either climate or physical properties of catchments being important in how the linearity of the storage discharge relationship is affected by changes in permafrost studies that have used methods other than rcs have found generally the same hydrologic response to permafrost degradation evans and ge 2017 jutebring sterte et al 2018 the variation in climate geology vegetation and topography found within arctic permafrost regions impacts the hydrological cycle through the partitioning of precipitation into runoff evapotranspiration and storage the arctic has a landscape that ranges from high mountainous peaks to low coastal plains with biomes like dry deserts tundra wetlands forests and roches moutonées therefore the impact of permafrost thaw on the storage discharge relationship may depend on such landscape characteristics tananaev and lotsari 2022 examined potential responses of permafrost degradation on fluvial systems and concluded that the influence of permafrost varies across landscapes for example on hillslopes where permafrost controls the hydrology overland flow decreases as the active later expands so permafrost thaw will have a greater impact on hydrologic connectivity in a landscape with steep hillslope gradients rather than in a flat landscape with the same hydrologic connectivity to a certain point permafrost thaw will also have a greater impact on hydrologic connectivity in wetland dominated catchments with saturated soils than arctic desert catchments with unsaturated soils and can confine hillslope runoff to water tracks which is not part of the storage discharge contexts but remains an important role levy et al 2018 while there have been studies of changes in recession flow in catchments with thawing permafrost lyon and destouni 2010 few investigations concern the role of landscape characteristics for the interpreting recession analysis results in the context of permafrost thaw bogaart et al 2016 as we seek to understand why different hydrologic responses emerge from different configurations of arctic landscapes undergoing thaw modelling studies have served to provide a better mechanistic understanding of the effects of permafrost thaw on river discharge however most modelling studies have so far primarily focused on explaining observed increases in winter base flow from across the arctic permafrost has been represented in models either as an impermeable layer in scenarios with decreasing permafrost extents walvoord et al 2012 or by solving the combined water and heat flows and thereby actively capturing declining permafrost extent as climate warms bense et al 2009 sjöberg et al 2013 walvoord et al 2012 could indeed show that with declining permafrost extent in the yukon valley water is re routed to longer and deeper groundwater flow paths to the river similar results were modeled by bense et al 2009 who found increasing groundwater discharge even with surface temperatures stabilizing based on these studies we believe that mechanistic models provide opportunities to also investigate the sensitivity of the non linearity of storage discharge relationships as described by the rcs to permafrost thaw independently from additional factors related to climate and catchment properties as such using models as hypothesis testing tools should allow us to isolate the various dominant landscape properties that control the rcs across the myriad of landscapes present in the arctic specifically models can allow for a systemic comparison of impacts across relevant model parameters that serve to represent the main factors controlling storage discharge conditions for catchments from this perspective the objective of our study is to identify and isolate the potential mechanisms behind observed changes in storage discharge relationships under current warming trends we use a simple hillslope model for a range of scenarios representing varying extents of permafrost from completely frozen to completely thawed to define various degrees of connectivity between surficial active layer and deeper groundwater flow paths first we explore with what different topographic conditions spanning from sloped to flat landscapes a decreasing extent of frozen soils can cause an increase in the non linearity of the storage discharge relationship similar to that previously observed in northern sweden by hinzman et al 2020 secondly we explore the control of physical characteristics on the linearity of the storage discharge relationship the focus here is on physical characteristics that could be expected to affect the recession behavior of catchments such as hydraulic parameters and hillslope length using the modeling approach as a tool for investigation we anticipate these subsurface processes may yield alternative hypotheses for the observed increasing rcs by hinzman et al 2020 and allow for a more generalizable and mechanistically underpinned interpretation of landscape responses to thawing of permafrost 2 methods we aim to explore the potential effects of a frozen layer that inhibits exchange of water between the active layer and the deeper groundwater layer on the response of discharge to rainfall events to do so we propose a simple hillslope water flow model section 2 1 where the goal is not to realistically reproduce catchment scale water balance but rather to capture the response of groundwater discharge to changes in connectivity the model is run with a range of parameter settings and input data covering potential realistic ranges of current and future climate and landscape characteristics for the arctic section 2 2 for ten different permafrost scenarios section 2 3 the simulated water discharge from the hillslope model is then used to quantify the non linearity of the storage discharge relationship through the rcs as proposed by hinzman et al 2020 section 2 4 finally the rcss derived from model output are compared to observed trends in rcs from rivers in northern sweden to put model findings in a real world context 2 1 model the simple hillslope model which is mathematically derived in eq 1 through eq 6 below runs in r using the reactran and desolve packages soetaert et al 2010 soetaert and meysman 2012 the model consists of two 1d groundwater layers representing an unconfined upper layer and a deeper ground layer fig 1 which can be confined or unconfined depending on the extent of the frozen soil layer which separates the two aquifer layers the horizontal domain is 100 m long spatially discretized with each cell being 1 m in length the top aquifer and confining permafrost layers are an arbitrary 1 m thick while the bottom aquifer is 2 m thick groundwater flow between the unconfined active layer and the aquifer confined below the permafrost is calculated by the last terms of eq 1 from the perspective of the upper unconfined aquifer layer 1 and by the last term of eq 3 from the perspective of the layer below the permafrost layer 2 permafrost is represented as a resistance to vertical flow c d taliks are represented as small patches of low resistance in a high resistance permafrost layer see section 2 3 calculation of the groundwater flux comes from the combination of the conservation of mass equation darcy s law and the dupuit assumption bresciani et al 2014 1 h 1 t sy 1 t 1 h 1 x x p e t h 1 h 2 c 2 sy 1 sy gw i f h 1 s u r f a c e d 1 sy s i f h 1 s u r f a c e d 1 3 h 2 t s y 2 t 2 h 2 x x h 1 h 2 c 4 sy 2 sy gw i f h 2 d 3 s aq i f h 2 d 3 in these equations h1 and h2 m are the hydraulic head for layer 1 and 2 respectively t d is time p m d 1 is precipitation and c d is the resistance of the permafrost thawed layer to groundwater flow sy 1 is specific yield for layer 1 and t 1 m2 d 1 is transmissivity of layer 1 when groundwater level in layer 1 exceeds the surface surface flows occur the dynamics of these surface flows are controlled by the sys specific yield of surface flows in eq 3 sy 2 is specific yield for layer 2 which depends on whether the aquifer is unconfined first condition or confined second condition t2 m2 d 1 is transmissivity of layer 2 throughout the vertical model domain we assumed a uniform non linear conductivity profile k y with k0 m d 1 at the bottom of layer 2 and k d m d 1 at the surface of layer 1 following the formulation of rupp selker 2005 where y m denotes the position and d1 the position of the surface fig 1 above the bottom of layer 2 5 k y k 0 k d k 0 y d 1 n where n denotes the curve of the depth profile of conductivity this becomes a function when integrating over the depth of the layers eq 6 transmissivity m2 d 1 eq 7 for the active layer t 1 above the permafrost is obtained by integrating the hydraulic conductivity profile from the bottom of layer 1 d 2 to either the water table h 1 when the water table is below the surface d 1 or the surface when the water table is above the surface the transmissivity of the ponded layer on top of the surface is added to the transmissivity of layer 1 eq 7 6 f y 0 y k y d y y k 0 k d k 0 n 1 y d 1 n 7 t 1 f y m i n h 1 d 1 f y d 2 r s d p 8 t 2 f y m i n h 2 d 3 where f is a function that calculates the full transmissivity of the subsurface from the bottom of layer 2 to the position of interest y m rs m d is a high conductivity for surface flows and dp m is the ponding depth transmissivity of layer 2 eq 8 t 2 below the permafrost is obtained by integrating from the bottom of layer 2 to lowest of the hydraulic head in layer 2 h 2 or the top of layer 2 d 2 boundary conditions of the model are as follows 1 p and et enter and leave every cell of layer 1 2 upstream left side has no flow boundary for both layers 3 downstream right side has a constant head 0 5 m below the surface d 1 in layer 1 and no flow in layer 2 all water thus leaves through layer 1 and is considered discharge q the model runs with daily input and output but the solver calculates sub daily time steps using the lsodes solver from the desolve package soetaert et al 2010 2 2 permafrost scenarios we constructed 10 scenarios ranging from 100 permafrost to 0 permafrost following the scenarios proposed by walvoord et al 2012 we followed their configurations as closely as possible to represent realistic degradation of the permafrost table 1 and fig 2 the scenarios can be seen as a collection of individual coverages of different locations that typify the current arctic condition or expressed as a temporal sequence of possible long term permafrost thaw where each scenario builds upon the last scenario with increased thawing in the cont100 scenario the layer between the two aquifers is completely frozen 100 permafrost in cont95 95 permafrost which represent realistic continuous permafrost distribution a talik is formed at the base of the hillslope adjacent to the river representing a river talik the broadening of thawed ground section e g dis89 is seen in nature with the formation of taliks when permafrost is discontinuous or sporadic connon et al 2018 taliks develop typically under water bodies streams rivers or thawed lakebeds and can also develop in locations with thick snow cover or after exceptionally deep seasonal thawing of the active layer which does not freeze completely back during the following winter in scenarios dis88t and spor30 new taliks are opened up on the hillslope and there is a shift from mostly permafrost to mostly non permafrost coverage across the hillslope respectively scenario spor13 has three small spots of permafrost while the spor0 scenario is completely free of permafrost representing an unconfined 2 layer aquifer 2 3 input data and parameter ranges the hillslope model was setup with base case scenario parameter values table 2 for each of the ten permafrost scenarios additionally we considered three hillslope gradients 1 5 and 10 slope to allow for representation of the relatively flat to more alpine landscapes that can occur across the arctic for each model set up specifically a total of 30 setups of 10 permafrost scenarios by 3 hillslopes the model parameters table 2 were tested we adopted parameter value ranges from the literature to be representative of conditions that are prevalent in the arctic or come from modeled predictions of arctic climate in the future as such we conducted 4 sensitivity scenarios for each parameter so that 120 individual set ups of the model were run for each parameter with 1080 set ups overall for each variable we selected a base case value and a parameter range observed precipitation p and estimated evaporation et from karats a catchment in northern sweden were used as model input evapotranspiration was estimated using maximum and minimum annual air temperatures using the priestley taylor approach priestley and taylor 1972 karats was chosen due to the length and completeness of data collection from 1951 to 2018 precipitation and air temperature data were retrieved from the swedish meteorological and hydrological institute smhi shmi 2018 the average precipitation for the time period used was approximately 1200 mm y and the annual potential evapotranspiration was a low 210 mm y daily time series of p and et for the period 1952 2018 were used as input to the model p and et ranges came from stocker et al 2013 who projected a range of future arctic precipitation and evapotranspiration from a drier climate 0 8 times the original dataset to a wetter climate 1 3 times the original dataset the model s subsurface flow length dl has a base case of 100 m we varied dl from half of the base case 50 to double the base case 200 the base case for n which controls the curvature of the hydraulic conductivity profile was chosen to be 2 and was varied from 1 to 4 representative of values applied in rupp selker 2006 the conductivity profile influences the ease of groundwater flow through the aquifer when n 1 the hydraulic conductivity decreases linearly with depth while with a larger n the hydraulic conductivity decreases exponentially the base cases for specific yield sygw the hydraulic conductivity at the top boundary of the aquifer k d and the hydraulic conductivity at the bottom boundary of the aquifer k0 were taken from the yukon basin groundwater model study by walvoord et al 2012 hydraulic conductivities relate to the lithology k0 and k d represents the ease at which water flows through the ground which is a function of grain size density and the overall structure of the soil in permafrost the hydraulic conductivity is extremely low almost 0 for k d for the base value we adopted 10 m d 1 representative of a medium coarse alluvium walvoord et al 2012 the k d range was double and half of the base case which reflects the range of fine to course alluvium reported by walvoord et al 2012 stevens et al 2018 a k0 s base value of 1 m d 1 was chosen to represent the deeper mountain alluvium walvoord et al 2012 the range of k0 was half and double that of the base case reflecting the range from fine alluvium to mountain alluvium walvoord et al 2012 stevens et al 2018 although these k values are representative for common lithologies they do not take into account relationships between conductivity lithology and landscape position such as the typically found higher lower conductivity on steeper flatter slopes the ranges for sygw was half and double the base case and is within the range of specific yields found from samples taken by price schlotzhauer 1999 and quinton et al 2000 rs is meant to be high as it represents surface flows and very shallow groundwater flow with little to no resistance therefore rs and its range was chosen as an order of magnitude larger than k d but not as high as suggested in gao et al 2015 specific yield for surface flows sys has a base value of 1 0 due to the flow of water being above ground and cannot be exceeded the range goes from the maximum specific yield 1 0 to the base value of specific yield sygw 0 20 values below 1 0 can be interpreted as the effect of partial ponding of the lowest sections within a grid cell 2 4 recession curve analysis the recession analysis method of the modeled discharge follows that of hinzman et al 2020 recession analysis quantifies the storage discharge relationship of a catchment during recession periods the discharge q is plotted as log dq dt against log q after which the intercept α and slope β are estimated eq 9 during periods when groundwater discharge is the only water leaving or entering the catchment the rate of discharge change dq dt mm d d during the recession is denoted as 9 dq dt q dq ds α q β in which discharge q mm d and the sensitivity of discharge to changes in storage dq ds d 1 is empirically related to the intercept α m m 1 β d β 2 and the slope of a straight line fitted to the data β as seen in kirchner 2009 our recession analysis focuses on the slope of the recession line as indicator of flow path complexity our recession analysis was expanded to the form in eq 10 to take into consideration the effect of rain and evapotranspiration conditions 10 log dq dt log 1 e q p q log α β l o g q in which small amounts of precipitation p mm d and evapotranspiration et mm d relative to discharge are allowed for inclusion of more data points we thus use eq 10 to estimate the α and β constants by logarithmic regression to the modeled data four criteria must be met for including a modelled discharge data point in a recession curve analysis 1 discharge must be declining 2 there must be at least two consecutive days of declining discharge for the points to be included 3 the first day of the recession is excluded in the analysis to insure the points are absolutely recessions and 4 precipitation is small less than20 compared to discharge a binning procedure taken from kirchner 2009 was implemented to avoid a bias towards an overrepresentation of low flows in this procedure discharge is divided into 100 bins of equal range the average discharge value in each bin is then used for the recession analysis fig 3 bottom 3 results 3 1 base case effect of hillslope for the base case model we find that as permafrost presence decreases the rcs increases for all three hillslope gradients fig 4 furthermore this increase in rcs is much more pronounced for steeper hillslopes gradient of 10 than for shallower hillslopes gradient of 1 fig 4 for the 10 hillslopes gradient the rcs increases from 0 98 in continuous permafrost cont100 to 1 7 in the permafrost free spor0 condition while the recession slope only varies between 1 2 and 1 4 for the 1 hillslope gradient for the 5 hillslope gradient we see an increase in rcs from 1 2 to 1 5 with a strong increase in the rcs at the first introduction of a small upslope talik in the permafrost dis88t further scenarios with bigger taliks or more upslope taliks than dis67 do not exhibit the same strong effect on the rcs 3 2 sensitivity analysis we evaluated the sensitivity of the rcs for each of the model parameters and for each of the permafrost scenarios the change of the rcs over the parameter range was considered the parameter impact fig 5 gives the direction of change and fig 6 shows the impact range of each parameter for the 10 hillslope gradient specific yield sygw curvature of the hydraulic conductivity profile n hydraulic conductivity on the top of unconfined aquifer k d hydraulic conductivity on the bottom of confined aquifer k0 and subsurface flow length dl had the largest impacts 0 15 parameters which had the largest impacts for 5 hillslope gradient were sygw n and dl 0 15 the largest impacts for the 1 hillslope gradient came from specific yield on the surface sys sygw precipitation p and dl 0 15 however the 1 hillslope gradient simulation results indicated a very large rcs range throughout the permafrost scenarios yet the base case does not change between permafrost scenarios indicating high sensitivity to changing parameters but not thawing permafrost the gradient of steep hillslopes controlled the impact of surface related parameters on the rcs the impact of the surface related parameters on flatter hillslopes were however not controlled by the hillslope gradient this variation in surface related parameter control is illustrated by the smaller range of sys on hillslopes gradient of 10 and 5 fig 6 compared to the sys range seen on a 1 hillslope gradient fig 5 a change in correlation between parameter and rcs with decreasing permafrost was found for p k d and dl for the 10 hillslope gradient and sys p roughness coefficient of the surface rs k d k0 evapotranspiration et and dl in the 5 hillslope gradient for the 1 hillslope gradient k0 was the only parameter that changed correlation however k0 had only minor impact on the rcs specific yield sygw had a small positive impact on the rcs for catchments with a hillslope gradient of 10 the average increase per scenario is 0 14 fig 6 for 5 hillslope gradients sygw had a negative impact on the rcs up to the development of the mid slope talik dis88t with an average increase of 0 11 per scenario afterwards afterwards sygw had a positive impact on rcs from discontinuous dis67 up to permafrost free spor0 with an average increase of 0 20 fig 5 the rcs for 1 hillslope gradients was extremely sensitive to changes in sygw for all permafrost scenarios with an average increase of 0 48 per scenario the hydraulic conductivity profile of the model controlled by the three parameters k d k0 and n affected the storage discharge relationship mainly in the scenarios with steeper hillslope gradients hydraulic conductivity at the top of the aquifer k d for the 10 hillslope gradient had a negative impact on the rcs for the first four permafrost scenarios cont100 dis88t the average decrease per scenario was 0 22 afterwards k d had a positive impact average increase of 0 39 per scenario for the 5 hillslope gradient k d had a negative impact on the recession slope until dis55 with an average decrease of 0 24 for each scenario after dis55 there was a positive impact with average increase of 0 12 per scenario for the 1 hillslope gradient all rcs had a small positive relationship for k d with an average increase of 0 10 hydraulic conductivity at the bottom of the aquifer k0 had a negative influence on the rcs for the 10 hillslope gradient that became stronger as the permafrost presence decreased up to a decrease of 0 37 for the permafrost free scenario for the 1 and 5 simulations k 0 had only minor effects on the rcs both negative and positive that did not change the rcs 0 10 the curvature of the hydraulic conductivity profile n had a positive correlation with rcs for 10 and 5 hillslope gradients with average increases of 0 18 and 0 16 per scenario respectively for 1 hillslope gradients effects of n did not exceed 0 06 for any scenario near surface and surface flows were controlled by the rs and sys parameters in the model and affected the rcs mainly in simulations with low slope the effects of the roughness coefficient on the rcs did not change 0 1 for any of the simulations the specific yield of near surface flows sys did not impact the rcs for any of the 10 or 5 hillslope gradients but was highly influential for the 1 hillslope gradient with a negative influence in all permafrost scenarios average decrease of 0 34 for each scenario fig 6 the overall change of the rcs given the range in parameters as permafrost presence decreased for all hillslope gradients was still positive fig 6 for the 10 hillslope gradient the change in permafrost has a stronger effect on rcs than any of the other parameters for the 5 hillslope gradient half of the parameters especially dl have a larger impact than the reduction in permafrost while for the 1 hillslope gradient almost all parameters have a stronger effect than permafrost presence 3 3 real world comparison we compared the results from the modeled hillslopes to observations from catchments in northern sweden fig 7 we extracted the average slope of the catchment using the 2010 slu forest map slu 2005 nine catchments had a hillslope gradient of roughly 10 three catchments had a hillslope gradient close to 5 there are no catchments with a hillslope gradient of 1 thus a direct comparison based on hillslope gradient cannot be made with the exception of one catchment the rcss were between the ranges seen in the cont100 and spor0 scenarios 12 out of 16 swedish catchments experienced a significant increase in rcs while none of the catchments had a significant decrease hinzman et al 2020 no significant correlation was found between the average slope of catchments and the average rcs nor with the average catchment slope and change in rcs we see that the average swedish catchment had an rcs that increased an average of 0 0058 per year over a sixty year period this increase was comparable to the increase in rcs from fully permafrost to permafrost free for the 5 and 10 hillslope gradients of our model fig 7 4 discussion 4 1 effect of hillslope gradient categorizing arctic hillslope gradients by using arcticdem porter et al 2018 50 of the area have hillslope gradients of 2 5 22 of the area is moderately sloped hillslope gradients between 2 5 and 7 5 and 11 of the area categorized as steep hillslope gradients between 7 5 and 12 5 this is a good indicator that the hillslope gradients we selected are good representatives for the arctic most arctic landscapes with continuous permafrost are flat or mildly sloped 0 8 75 hamm and frampton 2021 unlike for the 10 and 5 hillslope gradient models the difference of rcs between permafrost scenarios in 1 hillslope gradient is not large as seen in figs 6 and 7 our results suggest that the hillslope gradient of the catchment strongly controls the direct effects of permafrost thaw on river discharge dynamics the model with the 10 hillslope gradient showed a strong change in rcs with declining permafrost extent while the simulations with the 1 hillslope gradient hardly showed any effect of permafrost thaw previous studies already demonstrated that hillslope gradient itself has a strong relation with rcs e g bogaart et al 2016 based on our results we can go further and hypothesize that the effects of permafrost thaw on river discharge dynamics are much stronger for sloped than flat catchments from our model results we see that flat catchments tend to be wetland catchments under the climate of northern sweden there is only a small gradient to drive water flow and this lack of energy to drive flow causes catchments to become saturated with or without permafrost these catchments fill up with water and the permeable shallow subsurface and surface flow transport the bulk of the water for both cases in flat catchments our 1 gradient model regardless of permafrost presence the shallow flow paths dominate water transport therefore there is little difference in rcs the sloped simulations show that the energy created by the hillslope itself is enough to support substantial flow through the deeper less permeable layers under the complete permafrost scenario the deeper layer receives little water and most flow occurs above the permafrost fig 2 left column once permafrost starts to thaw water will infiltrate to the deeper layer and a substantial part of the water from then on will flow through the deeper layer towards the river driven by the topographic gradient when the sloped system drains from a wet to dry state the ratio of above and below permafrost flows decreases which in combination with the non linear permeability depth profile causes the non linear storage discharge behavior observed based on the increase of the rcs between scenarios seen in fig 6 we now expect a stronger direct effect of permafrost thaw on rcss for steeper catchments these results thus notably nuances the conceptual ideas proposed by hinzman et al 2020 the proposed conceptual model is clearly more appropriate for sloped than flat catchments based on our results we cannot pinpoint at which hillslope gradient percentage or when permafrost thaw affects rcs moreover this is likely an interplay between hillslope potential energy driving water flow hillslope length and climate the amount of water and the subsurface permeability the resistance against flow which thus may yield site dependent critical slopes harman and sivapalan 2009 in this analysis it was not possible to distinguish hydrologic responses associated with an increasing active layer from those caused by thawing of deeper permafrost walvoord and kurylyk 2016 4 2 sensitivity analysis flat catchments did not show a direct effect of permafrost thaw on the rcs but instead showed sensitivity to physical properties and to lesser extent climatic factors with our sensitivity analysis we determined that in flat catchments the rcs is most sensitive to the specific yield of the shallow unsaturated zone sygw the specific yield used for surface flows resembling the effects of surface topography variations sys a representation of increase of ponding depth per added water layer and the high end permeability at the surface of the permeability depth profile k d these factors control water flow near the ground surface of our model domain and in the flat model scenario much of the change in groundwater level also occurs in the shallow surface fig 8 to illustrate the point in both the cont95 and spor18 scenarios the groundwater levels of the unconfined and confined aquifers are distinct and do not converge until the end of the hillslope for the 10 and 5 hillslope gradients for the 1 hillslope gradient the groundwater level for the confined aquifer rises above the permafrost and is now in shallow surface for much of the hillslope represented by the model fig 8 while these near surface factors are often viewed as constant in time they may be indirectly affected by a warming climate through changes in organic matter accumulation or decomposition ise and moorcroft 2006 or rooting of new vegetation types as an example from tundra to boreal forests gonzalez et al 2010 or expansion of burrowing of earthworm into the arctic blume werry et al 2020 seasonal ground freezing which is not represented in our model also strongly controls the hydraulic properties of the near surface soil and changes as a consequence of climate warming wang et al 2019 liu et al 2020 thus while our results suggest that the direct effect of permafrost thaw on recession slope curves are small in flat landscapes other climate warming induced processes may still cause a change in rcs for 5 hillslope gradient dl plays in important role in every permafrost scenario we expect that due to permafrost thaw water flow paths deepen and groundwater flow increases relative to near surface flow frey mcclelland 2009 frampton et al 2013 a longer hillslope length suggests catchments connecting which means more area open to precipitation input creating wetter conditions near the stream which causes a more non linear system with higher rcs fig 9 under sporadic permafrost conditions the extra water transport that accompanies a longer hillslope length is routed through deeper subsurface flow paths fig 9 if the surface permeability increases with decreasing permafrost for example due to extra vegetation growth or weathering we see an increase in rcs this may further increase the rcs in addition to the primary effects of permafrost thaw evans et al 2020 also suggested that various permafrost states e g continuous discontinuous sporadic have different hydrologic parameters which impact the catchment s recession for the hillslope gradient of 10 we found a strong effect of declining permafrost on the rcs in contrast to the 1 hillslope gradient the steeper model domains had a much lower groundwater level throughout most of the domain and were less sensitive to the near surface parameters that strongly affected the results from the 1 hillslope gradient we found in the 10 hillslope gradient model the most sensitive parameters had an opposing effect on the rcs for complete permafrost and permafrost free conditions dl k d in fig 5 this opposing effect means that the direction of the effect from these parameters on the rcs depended on the amount of permafrost turning this result around means that the effect of permafrost thaw on the rcs was stronger for smaller hillslope lengths dl i e a small dl reduces rcs under full permafrost and increases rcs under permafrost free condition and for higher k d values we put forth that the combination of permafrost and hillslope gradient does not allow precipitation to easily infiltrate and instead becomes surface runoff until the permafrost thaws enough for infiltration when infiltration begins the steep gradient means the longer hillslope length causes more shallow groundwater and surface flows than a shorter hillslope length creating a more linear system and decreasing the rcs fig 9 with the greater volume of shallow water flows associated with a longer hillslope the hydraulic conductivity of the subsurface becomes more important dampening the reaction time of the system and also causing a more linear storage discharge relationship thus over the timescale of a continuous permafrost catchment becoming a sporadic permafrost catchment limited infiltration of precipitation and shallow subsurface flow will be increasing factors for the rcs after most of the permafrost has thawed infiltration and shallow subsurface flow will be decreasing factors for the rcs an increase in p means more precipitation entering the model and in the flat catchments or catchments with less than 50 permafrost that influx of water makes the rcs more linear the explanation for the difference in direction for steeper catchments with 50 permafrost is the increased amount of precipitation cannot completely infiltrate the ground causing surface flow and an increase in rcs an increase in et means more precipitation is removed from the model which lowers the rcs both p and et have minimal effects on the rcs an increase in dl has a similar effect on the rcs as an increase in p for flat catchments and steep scenarios with less than 50 permafrost there is a decrease in rcs driven by an increase in discharge q for scenarios with 50 permafrost and in mildly sloped catchments an increase in dl has a positive impact on the rcs dl is more influential on the rcs than p and et fig 5 as dl was allowed to vary between 0 5 and 2 times the base value while p and et where varied between 0 8 and 1 3 times the base value table 2 the sensitivity to the climatic factors p and et varied between both permafrost and hillslope gradient scenarios but did not exceed a change of 0 10 in any scenario this result agreed with our assumption that the rcs was primarily a measure of landscape features that control how landscapes release water via rivers which is thus not strongly controlled by meteorological conditions an increase in sygw means a greater volume of water is drained from the same volume of soil per unit of groundwater level change which causes a more stable groundwater level this has a small impact in steeper catchments but for flat catchments an increase in sygw has a notable positive influence on the rcs this is likely due to ponding and a subsequent quicker response via surface flows in response to precipitation events an increase in k d and k0 is more impactful on the rcs in sloped catchments as an increase in free movement of water on a gradient means gravity can act on more water at any given time the directional influence of increasing k d changes as permafrost thaws in steep and moderately sloped catchments this happens after the introduction of the talik in scenario dis99t in steep hillslopes and after the majority of permafrost has thawed in moderate hillslopes in scenarios with large amounts of permafrost 67 the exchange of water between confined and unconfined aquifers can be hampered by permafrost which results in the negative correlation found when increasing k d as the permafrost limits the groundwater exchange k0 becomes more influential as permafrost thaws with an increase of k0 more groundwater can flow in the confined aquifer underneath the permafrost layer hydraulic conductivity is generally greater nearer the surface and decreases exponentially with depth an increase in the curvature of the hydraulic conductivity profile n indicates the hydraulic conductivity becomes even greater as one approaches the surface higher values of n therefore promote more shallow groundwater flow and a more non linear increase of hydraulic conductivity with increasing groundwater levels an increase in rs has no impact on sloped catchments and minimal impact on flat catchments a decrease in the specific yield of surface flow sys means that the surface water layer is more variable over time under influence from precipitation and evapotranspiration than for the base value of 1 in sloped catchments the hillslope gradient is large enough that all precipitation can be transported through the shallow subsurface and therefore changing the specific yield for surface flows has no impact for flat catchments it is more stagnant and therefore any change of sys has a large impact on the rcs in this case a decrease in sys will increase surface water layer dynamics and results in a more non linear rcs 4 3 swedish catchments the range of rcss from our simple model simulations corresponds well to values found for the 16 swedish catchments although the range derived from the catchment discharges is slightly larger than from the simulations this is expected as in reality there are many more non linear processes involved in runoff generation such as dynamics drainage networks kokelj et al 2020 and flow dependent river levels blaen et al 2014 which are not accounted for in our simulations but are likely to yield more non linear storage discharge relationships and thus larger rcss the change in simulated rcs for 5 and 10 hillslope gradients going from completely permafrost to permafrost free is fairly similar to the observed increases in rcss for these catchments during the last 70 years however we do not clearly see the difference in the observed change in rcss between more steep and more flat catchments that is suggested by our model results for the real catchments this distinction is difficult to make because these catchments are all larger catchments with steeper and flatter sections two out of the three flattest catchments show a significant increase in rcs for metajärvi 390 km2 the flattest and smallest catchment we indeed see no significant change in rcs all the steep catchments 15 show an significant increase in the rcs 0 008 per year however the increase also depends on the size of these levy et al 2018 catchments localized impacts vs regional impacts of thaw if and how fast permafrost is thawing mckenzie and voss 2013 sjöberg et al 2013 4 4 limitations and applicability we simulated the hydrologic response to the net result of changes in the surface and subsurface distribution of frozen ground without including the seasonal frost dynamics in our model as such the model did not capture a distinction between changes in the active layer from that of thawing of deeper permafrost our domain included an unfrozen aquifer on top of a layer of permafrost similar to a real world seasonally thawed active layer overlaying permafrost during summer seasonal changes in soil frost are expected across the arctic and are likely to also impact the hydrology of cold regions bringing about greater subsurface storage and general increases in low flows due to the strengthened hydrologic connectivity bring et al 2016 hydraulic conductivity is expected to vary with landscape position thus selecting a base conductivity averaged over multiple lithologies while changing the hillslope gradient does not take into account landscape relations between permeability lithology and slope our results may thus be primarily representative for catchments with high permeability throughout the soil profile and limited anisotropy in hydraulic conductivity walvoord et al 2012 a gradual thickening of the active layer which is expected following warming was also not explicitly included in our model our results are therefore perhaps most representative for identifying differences in summer conditions related to permafrost extent but may not be capturing the full extent of hydrological changes expected in arctic catchments however it would be possible to elucidate the consequences of changes in frozen state of the surface and subsurface ground using our approach if one restricted this analysis to only winter baseflow for example when surface hydrologic processes were inactive it would be possible to better understand the effects of thawing permafrost if one then compared those results to the analyses presented here it would be possible to describe the results of deepening active layer our model set up is based on a thin permafrost layer underlain with unfrozen material this situation is reflective of areas in the southern permafrost boundary such as central alaska sweden and western russia but globally this a unique setting for example permafrost in the northern permafrost boundary has thicker permafrost layers this should not take away from the importance of our results the southern permafrost boundary is undergoing the greater change in terms of permafrost thaw and could be representative of the future of the far north permafrost 4 5 the value of models in explaining real world changes in permafrost landscapes models are often generalizations of real world situations designed to provide insight to specific problems in the world around us in our 2d hillslope water flow model we generalize for example the representation of permafrost as a layer with high resistance which greatly simplifies the actual complexity of permafrost sjöberg et al 2016 however the features that are part of the proposed model setup namely permafrost scenarios hillslope gradient slope length and non linear conductivity depth profiles deep shallow and surface flows are expected to affect the relationship between storage and discharge more specifically the rcs based on results of previous studies rupp selker 2006 hinzman et al 2020 typically derives interpretation from such simplified representations of groundwater aquifers brutsaert and nieber 1977 troch et al 2013 since the 1950 s permafrost has been declining in the mountain range of northern sweden we expected that this decline in permafrost significantly affected river flows in the region however to date it remains very difficult to separate direct precipitation and temperature change effects on river flows from the more indirect subsurface and surface change effects on river flows rushlow godsey 2017 docherty et al 2019 especially because long term measurements of permafrost or soil permeability are rare in the arctic river discharges are the only measurement that is systematically being recorded in northern sweden and to a lesser extent throughout the arctic laudon et al 2017 and contain the integrated signal of all upstream processes therefore it will be advantageous to untangle the changing surface and subsurface signals found in river discharge in response to climate warming specifically because these changes do impact climate change impact studies for the arctic and therefore constitute a major source of uncertainty mckenzie et al 2021 looking to the recession curve slope as measure for the non linearity of the relation between storage and discharge of catchments in our view is a promising venue to identify the changes in how catchment release their water however such an approach requires a further mechanistic underpinning of which the initial steps are undertaken by this study to our knowledge this is the first study that systematically investigates how landscape features in conjunction with permafrost affect the storage discharge relationship within such a simple model setup several modelling studies also with more realistic model setups looked at the effects of permafrost thaw on river discharges however these studies used stationary models focusing on winter low flows sjöberg et al 2013 or focused on the combined heat water transport and the actual thawing processes sjöberg et al 2016 to date none of these models have been able to explain the observed increase in non linearity of storage discharge relationships in northern sweden during the last 6 decades hinzman et al 2020 in this regard we expect that our results give direction for follow up studies exploring interacting impacts that might exist within a complex heterogeneous landscape we stress that this study only finds potential controls on rcs that fall within the model assumptions regardless our results illuminate on the impact of permafrost on river runoff under different hillslope and subsurface characteristics that build on the conceptual interpretations previously proposed by hinzman et al 2020 5 conclusion this study explores with a basic mechanistic water flow model the potential effects of permafrost thaw on the storage discharge relationships of catchments the storage discharge relationship is quantified through the recession curve slope rcs this study has shown that the actual effect of permafrost thaw conceptualized as the reduction of an impermeable layer in the subsurface will likely be most clearly visible in the rcs of sloped catchments for flat catchments 1 hillslope gradient no clear effects of permafrost were found on the rcs here a change of rcs with climate change will likely be dominated by changes in shallow surface parameters such as surface permeability k d and shallow surface water retention sygw and sys for moderately sloped arctic catchments 5 hillslope gradient we did find a clear effect of permafrost thaw at the moment the first upstream talik a permeable connection between the surface and the aquifer below the permafrost is formed up to and after this moment the rcs signal will likely be dominated by changes in subsurface length per area dl and the aquifer hydraulic properties k d and sygw for steep arctic catchments 10 hillslope gradient we found the strongest signal of permafrost thaw with a strong increase in rcs from completely frozen rcs 1 to unfrozen conditions rcs 1 8 the rcs signal in the later stages of permafrost thaw will likely be dominated by changes in the subsurface flow length dl and hydraulic conductivity profile k d k 0 and n parameters all of these parameters are also likely to change with the ongoing arctic climate change for example k d sys and sygw are likely to change through the development of vegetation that changes the surface water flow or an increase in the organic layer of soil due to increasing bioturbation by invertebrates migrating north and changes in the active layer depth hydraulic conductivity k d and k0 will exert increasing control on rcs as permafrost thaws changing active layer thickness previously isolated catchments connecting or the formation of taliks facilitating the exchange of groundwater sygw dl and n will all cause the storage discharge relationship to evolve these findings based on a basic model of hillslope water flows provide a step forward in the interpretation of rcss for the arctic credit authorship contribution statement alexa marion hinzman conceptualization methodology formal analysis writing original draft visualization ylva sjöberg conceptualization writing review editing steve lyon conceptualization writing review editing peter schaap methodology software writing review editing ype van der velde conceptualization methodology software writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is part of the research program netherlands polar programme with project number alwpp 2016 014 which is financed by the dutch research council nwo 
3128,a novel hybrid modified continuous time markov chain mctmc based single site stochastic model is proposed for the synthetic generation of daily streamflow sequences the inherent characteristic of the continuous time markov chain ctmc process to represent the dynamic and continuous behaviour of stochastic systems through discrete states and their persistence in time has been perceived to be suitable for modelling the daily streamflows the structure of the original ctmc is modified to model the asymmetry of the daily flow hydrograph and the seasonality characteristics involved the de seasonalized streamflow space is discretized into an appropriate number of markov states and a normal probability distribution parametric component is fitted to each state the state occurrences are modelled using the embedded transition probability matrix within the month and the state holding times the state holding times are conditioned on the preceding state and the month of occurrence to reflect the inherent historical dependence and the non homogeneity of the daily streamflows and are resampled from the observed data the normal distribution generated values within the state are reshuffled according to the ranks of the resampled historical sequence the competence of the proposed model is illustrated through its application to the observed daily flows at three rivers in the colorado basin the model is shown to reproduce the summary statistics and the distributional characteristics at the daily as well as the aggregated time scales the short term and the long term dependence the asymmetric shape of the hydrograph as well as the water use statistics are well preserved in the simulations the efficacy of the proposed model is also brought out through a comparison with the frequency based model of brunner et al 2019 keywords daily stochastic streamflow model hybrid modified continuous time markov chain embedded transition probability state holding time resampling reshuffling abbreviations ctmc continuous time markov chain mctmc modified continuous time markov chain data availability data will be made available on request 1 introduction streamflows at a daily scale are often modelled using spatially distributed rainfall runoff models that characterize the dynamic response of the watershed to the rainfall input arising from a number of surface and subsurface processes and their interactions complex combination of the various flow generation mechanisms added with soil heterogeneity and the changes in the moisture state owing to alternating wetting and drying cycles pose formidable challenges to the daily streamflow modelling using rainfall runoff models a simpler alternative approach has been to develop lumped conceptual models for the watersheds considering uncertainty in the storm events that will be useful for decision making at the planning level especially for ungauged watersheds in this regard weiss 1977 came up with a pioneering effort to model the daily streamflows developing on the filtered poisson process shot noise process the effective rainfall pulses were modelled as a point process and the intensities as exponentially distributed and this stochastic input was filtered through a deterministic system response function consisting of base flow and direct runoff components a major drawback of the weiss approach was the estimation of the shot noise parameters directly from the runoff data which did not offer scope for validating the correspondence between the correlated effective rainfall pulses generated and the runoff this was overcome by treiber and plate 1977 who adopted a conceptually based stochastic formulation employing a markov process to model the correlated effective rainfall input and a non linear deterministic response model inverse estimation technique was adopted to reconstruct the unknown correlated effective rainfall pulses further improvements were effected by cowpertwait and o connell 1992 and murrone et al 1997 in modelling the effective rainfall pulses although the shot noise models are well founded the modelling exercise is quite involved claps et al 2005 moreover a number of drawbacks such as overestimation of low flows generation of too many rises and recessions rapid decay of recession flows are reported sargent 1979 you et al 2014 another variation of the conceptually based stochastic modelling approach for daily streamflow generation is a hybrid discrete markov chain based model that consists of two basic steps i determination of the state of flow from the observed daily streamflow hydrograph wet or dry depending on increase or decrease in the flow compared with the previous day s flow and ii computation of the ascension indicating wet state or recession indicating dry state curve of the streamflow hydrograph based on the state of flow the ascension limb of the daily streamflow hydrograph is modelled by randomly generating daily flow increments from gamma or weibull distribution and ranking them in increasing order with the largest one occurring at the peak of the hydrograph according to aksoy 2003 this is supposed to preserve the correlation structure of the ascension limb of the hydrograph the flow recessions are modelled as upper event runoff component and lower base flow component exponential recessions using a least square fitting algorithm this kind of approach was adopted by sargent 1979 aksoy and bayazit 2000 aksoy 2003 szilagyi et al 2006 stagge and moglen 2013 mathai and mujumdar 2019 with some variations sargent 1979 modelled the pulse occurrences using a modified markov model and the pulse heights with a modified exponential distribution also scaling adjustments were done to ensure compatibility among daily monthly and annual flows aksoy 2003 adopted a three state markov chain to capture the occurrences while modelling the daily streamflows in an intermittent stream the two state increasing decreasing markov chain based daily streamflow generation model was further extended by szilagyi et al 2006 to model the daily streamflows at multiple sites in a basin in which the spatial correlations in the increments of the ascension limb were captured using second or third order polynomials further they used the concept of conditional heteroscedasticity to adjust the ascension increments generated from seasonally varying weibull distribution the full range of the recession curves was modelled using a non linear reservoir model stagge and moglen 2013 proposed a hybrid model combining a monthly climate model with a daily streamflow model to generate hydrographs based on the discrete climate states generated although their model is reported to perform well some bias is noted in the daily autocorrelations and the flow duration curve of the simulated flows the discrete markov chain based hybrid models have a tendency to overestimate high flows since they determine the state of occurrence first and then independently generate the flow increments using a probability distribution for deriving the ascension part of the hydrograph you et al 2014 moreover continuity in flow magnitudes across months could be affected as they are modelled using different sets of model parameters also the highest flow increment need not necessarily happen at the peak of the hydrograph recently mathai and mujumdar 2019 proposed a simple multi site daily streamflow modelling framework integrating a non parametric hybrid k nearest neighbour k nn resampling scheme lee and singh 2019 for modelling the spatially and temporally correlated occurrence states with the conceptually based ascension recession modelling of daily flow magnitudes despite the improvement in the modelling of occurrences the model could not effectively simulate the extreme flows and the upper segment of the recession flow dynamics mathai and mujumdar 2019 with a view to improve the ability of daily streamflow models in simulating the extreme flows pender et al 2016 used the hidden markov model hmm in combination with the generalized extreme value distribution hmm gev and the generalized pareto distribution hmm gp this was extended by patidar et al 2021 for simulating the daily streamflows under climate change scenarios the hmms realise unobserved states through the emission probability matrix which enables in effectively simulating the high and the low flow ranges of the daily streamflow sequence one more class of models belong to the empirical stochastic modelling category stochastic modelling of daily streamflows was first attempted by beard 1967 and quimpo 1968 using a second order markov model which could not simulate the characteristics of the daily flow hydrograph effectively subsequently linear stochastic models of the box jenkins type ar arma and arfima models have been employed for modelling annual and seasonal streamflows for nearly five decades salas 1993 koutsoyiannis 2000 the basic limitation with these popular parametric stochastic models is the requirement of satisfying the assumptions of linearity and normality chen et al 2015 and hence may not be suited for modelling daily streamflows which are often skewed and non linear also the asymmetry in the shape of the daily streamflow hydrograph and the complex nonlinear dynamics of the daily streamflows cannot be captured by these parametric stochastic models sharma et al 1997 mathai and mujumdar 2019 also since these models could not reproduce the flow statistics at the aggregated spatial and temporal scales various parametric disaggregation models were proposed grygier and stedinger 1988 koutsoyiannis and manetas 1996 mejia and rousselle 1976 santos and salas 1992 valencia and schakke 1973 but these models are not parsimonious and the corrections done to preserve the additivity at the aggregated scales grygier and stedinger 1988 are found to distort the correlation structure at the lower levels srinivas and srinivasan 2001 srivastav et al 2016 more recently bivariate conditional copula based parametric stochastic models lee and salas 2011 hao and singh 2013 have been applied to model the non linear dependence of the current period flow on the previous flows and the same was extended by chen et al 2015 to model multi site daily streamflows although these models were found to be effective in capturing the summary statistics and the ranked correlations kendall s tau large number of parameters had to be estimated resulting in parsimony issues chen et al 2015 a further improvement of this method was proposed by chen et al 2019 by considering lag 2 autocorrelations in which conditional copulas were used to tackle the parsimony issue recently a unified stationary parametric stochastic modelling framework has been proposed by papalexiou 2018 which is shown to simulate hydroclimatic process of any spatio temporal scale with specified marginal distribution and linear autocorrelation structure including intermittency this is achieved by introducing flexible parametric correlation transformation functions that enable mapping the parent gaussian process with the arbitrary target process this framework is applicable to multi variate modelling as well following this unified stochastic framework papalexiou et al 2018 have proposed a one step disaggregation method that disaggregates the coarse time scale values to the target time scale values under stationary as well as non stationary conditions which preserves the actual marginal distribution and the actual correlation structure of the fine scale process while ensuring the preservation of the coarse scale values moreover papalexiou and serinaldi 2020 have introduced a blueprint for the effective simulation of spatiotemporal random fields that are described by different random variables with arbitrary marginal distributions and specified spatiotemporal correlation structures including intermittency the above set of three publications have significantly advanced the parametric stochastic modelling in hydrology which can be effectively used for simulating the complex daily streamflow process several non parametric disaggregation techniques have been proposed in the last three decades which do not make any assumption about the underlying distribution of the streamflow sequence the nonparametric temporal spatial disaggregation of streamflows was attempted using a gaussian kernel density estimate tarboton et al 1998 wang and ding 2007 or the k nn method lall and sharma 1996 prairie et al 2007 lee et al 2010 although the non parametric disaggregation models are capable of capturing the summary statistics the marginal distributions and the serial correlations at the disaggregated level the kernel methods require flow adjustments from the disaggregated level to the aggregated level and encounter dimensionality and boundary leakage related issues while the k nn models do not generate values beyond the observed range also the smoothing value and the variability in the simulated flows may be limited srinivas and srinivasan 2005 in any case these non parametric methods are reported to be effective only in disaggregating the annual streamflows to the monthly level nowak et al 2010 and not to the finer time scale moreover they may not be able to model the transitions between years effectively which may affect the continuity of the generated streamflows at the disaggregation boundaries in the last decade other simple non parametric methods such as the method of flow proportion vectors kumar et al 2000 nowak et al 2010 and the method of fragments silva and portela 2012 have gained attention for daily streamflow disaggregation the method of flow proportion vectors is reported to be parsimonious and effective in generating disaggregated daily streamflows that preserve continuity summability dependence and summary statistics at different levels however the mean flows and the minimum and the maximum flows generated at the daily level seem to exhibit bias when compared with that of the observed flows plots 15 and 16 of nowak et al 2010 inability to model the transitions between successive years less frequent generation of extreme flows nowak et al 2010 and lack of variability you et al 2014 are a few limitations of this model further acharya and ryu 2014 proposed a simple adaptive linear statistical method for disaggregating the flows of a particular month to daily flows at a target station based on a streamflow index computed for each day in that month at the source station also a cubic spline interpolation was suggested to smoothen the jumps transitions between consecutive months in the simulated flows with an intent to maintain the continuity silva and portela 2012 employed the method of fragments srinkanthan and mcmahon 1980 to disaggregate the annual streamflows to monthly flows fragments are sampled from the class to which the aggregated flow belongs this method is based on the assumption that the streamflow pattern at the finer scale is similar in years with similar annual flows this was subsequently extended by portela and silva 2016 to generate daily streamflows directly from the generated annual streamflows even though the method of fragments is easy to implement its effect largely depends on the number and the division of classes or fragments silva and portela 2012 portela and silva 2016 the frequency domain based models are less commonly applied in the context of simulating the daily streamflows wang et al 2011 used the trous discrete wavelet algorithm to decompose the observed daily streamflows and reconstruct synthetic daily streamflow sequences the discrete wavelet transforms provide information only on amplitude but not on phase recently brunner et al 2019 proposed a continuous daily streamflow simulation model in which phase randomization was applied on fourier transformed normalized and de seasonalized daily flows and the phase randomization simulation was combined with the robust 4 parameter kappa distribution with a view to generate significant number of unobserved extreme flow values this model is reported to reproduce the distributional and temporal characteristics at the individual sites well brunner et al 2019 although brunner et al 2019 is a continuous time streamflow model it has the following limitations i fitting the 4 parameter kappa distribution on a daily scale makes the model non parsimonious ii non linear back transformation from the gaussian domain to the skewed domain reduces the strength of the linear correlations embrechts et al 2010 moreover the investigations done in this study presented later show that the brunner et al 2019 model may yield large extreme flows and the variability of the generated daily mean flows could be limited subsequently brunner and gilleland 2020 have proposed the continuous wavelet transformation based multi site daily streamflow model wherein the limitations of brunner et al 2019 concerning the back transformation are overcome however some of the other limitations of brunner et al 2019 seem to remain although non stationarity and oscillatory nature present in the daily time series are reported to have been captured sensing the limitations of the hybrid discrete time markov chain dtmc based models in the stochastic simulation of daily streamflows mentioned earlier a novel alternative hybrid stochastic model based on continuous time markov chain ctmc is proposed in this research the inherent characteristic of the ctmc process to represent the dynamic and continuous behaviour of stochastic systems through discrete states and their persistence in time has been perceived in this research work to be suitable for modelling the daily streamflows however the ctmc model in its original structure is not suited to model the asymmetric shape of the daily streamflow hydrograph and the seasonality exhibited by the daily streamflows to model these characteristics of the daily streamflows in this research study the ctmc model is suitably modified by introducing non homogeneity and history dependence the ctmc in its traditional form has been applied in various areas such as queueing theory population growth lithology sedimentation molecular chemistry krumbein and dacey 1969 gillespie 1977 rolke 1991 osaki 2012 while several modified versions of the same have also been applied to solve problems concerning utility of financial strategy development of clinical symptoms of diseases reliability of system components krak et al 2017 however to the best of the knowledge of the authors ctmc or any of its modified versions has not been applied in the context of stochastic streamflow modelling hence a fervent attempt is made in the current research work to develop a single site hybrid modified continuous time markov chain hybrid mctmc based stochastic daily streamflow model that would be able to preserve the shape of the continuous daily flow hydrograph and the associated distributional characteristics and the short term and the long term dependence structure in the proposed model the daily streamflow hydrographs are viewed to be consisting of flow classes states in the increasing order till the peak flow rising limb and then in the gradually decreasing order recession limb the proposed framework allows flexibility in modelling daily streamflows in the original plane or the standardized plane the standardization is done at the daily level with a view to remove certain amount of seasonality present in the daily streamflows the daily streamflows standardized otherwise are divided into states based on their respective magnitudes the flow variates in each state are fitted to an appropriate probability distribution which is normal distribution in case of standardized flows in the present study the same set of distribution parameters fitted statewise are retained for all the months with a view to preserve continuity between months in the generation process this feature of the model in combination with the end of the month transition probability is expected to overcome the deficiency of jumps at the transitions between months also the use of a parametric distribution allows generation of variates beyond the observed ones the transition of states within the season month are represented by an embedded transition probability matrix as in ctmc while the duration holding time in each state is conditioned based on the preceding state and the season month of occurrence modification of ctmc to model history dependence and non homogeneity this largely takes care of the deficiency of generating too many rises and recessions which may increase the uncertainty in daily flow patterns the gradual transition of states in the decreasing order of flow magnitudes together with the resampling of the respective state holding times enable modelling the hydrograph recessions and their variability appropriately the continuity across seasons months is modelled by the end of the month transition probability matrix the de seasonalized streamflow amounts generated from the parametric distribution of each state are reshuffled based on the ranks of the resampled standardized historical daily streamflow amounts within that state the flow magnitude based state classification along with the resampling reshuffling operation is likely to avoid overestimation and or underestimation of daily streamflows to a great extent the idea of resampling reshuffling adapted from breinl et al 2013 also enables the preservation of daily autocorrelations of the generated data within the state it is to be mentioned that standardization of the observed flows is not mandatory an appropriate robust distribution can be fitted directly to the observed streamflows without standardization and the same hybrid mctmc model is applicable the remaining parts of the paper are organized as follows the proposed methodology is detailed in section 2 the subsequent section presents a brief description of the three case examples of daily streamflows to which the proposed model is applied the results of the model application to the three case examples are presented and discussed in detail in the penultimate section following this the efficacy of the proposed model is brought out through a performance comparison with the hybrid continuous time daily simulation model proposed by brunner et al 2019 moreover a brief discussion of the preliminary ideas towards building a regional level hybrid mctmc model is also presented section 5 covers the summary and conclusions of the study along with the listing of the limitations and the future scope of the proposed model 2 methodology 2 1 overview the discrete time markov chain dtmc has been used to model various hydrological processes at different time scales haan et al 1976 aksoy 2003 in which the state space as well as the parameter space are supposed to be discrete on the other hand the continuous time markov chain ctmc model describes the stochastic evolution of dynamic systems x t t 0 through a discrete state space and continuous parameter space in other words the system remains in each state for an amount of time sojourn time or state holding time which is described by an exponential distribution before making a transition to the next state specified by the stochastic matrix of discrete markov states the inverse of the mean sojourn time in a given state is called the transition rate according to the markovian property the exponential distribution as well as the dtmcs are memoryless the transition probability in a ctmc model is known as embedded transition probability p ij t s which is associated with the transition of state i to j and can be calculated by summing over the entire intermediate state k at time t and moving to state j from state k at the remaining time s this is given by the continuous version of the chapman kolmogorov equation ross et al 1996 for any state i and j as in eq 1 and schematically represented in fig 1 1 p ij t s k 0 p ik t p kj s if the system moves from the initial state i to a state k at time t in the state space s then 2 p x t k i s p x t k x 0 i p x 0 i in which the first term on the rhs of eq 2 refers to the transition probability vector p ik t and the second term denotes the initial state probability vector a ctmc ideally requires i the point estimates for the initial probabilities and the rate parameters to be exact ii the model to be differentiable so that the rate parameters can be defined iii the future behaviour of the system to depend only on its current state and not on the past states prior history iv the rate parameters of the system to remain constant over time and not to depend on history krak et al 2017 so ctmc in its original form may not be directly suited to describe the dynamic behaviour of daily streamflows or similar geophysical processes that are continuous and stochastic in nature and also exhibit asymmetry irreversibility and within year seasonal and over year variabilities hence in this research study the ctmc model is suitably modified by introducing non homogeneity and history dependence so that the modified ctmc mctmc can be used for daily streamflow modelling in this model non homogeneity is introduced through monthly varying embedded transition probabilities and the state holding times are conditioned on the preceding state history dependence and the month of occurrence non homogeneity the limitation regarding the lack of exact knowledge about the rate parameters is overcome by resampling the state holding times from the historical record in this study additionally a suitable parametric model is integrated to the mctmc to develop the hybrid mctmc model for single site daily streamflow simulation the proposed methodology to simulate synthetic daily streamflow sequence uses daily data de seasonalized standardized using the daily mean and standard deviation the de seasonalized flow data are divided into a certain number of classes with pre defined magnitude ranges which are known as the markov states s s i of the model the simulation of synthetic daily streamflow occurrences using the mctmc requires the following components to be empirically estimated from the historical data a the embedded transition probability matrix derived for each season month m separately depending on the number of states existing in the season allows state transitions within the season b the state holding sojourn times estimated for every state in the season month conditioned on the preceding state c the vector of the initial probabilities of the various observed initial states d the holding times of the observed initial states e the end transition probability matrix estimated for the state transition between the last day of the current season month and the first day of the next season month the embedded transition probability matrix for a season with 10 states is given in eq 3 from which it may be noted that there are no self transitions diagonal elements of the matrix are zero 3 p m 0 p 1 2 p 1 3 p 1 10 p 2 1 0 p 2 3 p 2 10 p 3 1 p 3 2 0 p 3 10 p 10 1 p 10 2 p 10 3 0 further to model the streamflow amounts the de seasonalized flow magnitudes in each class state are fitted to a normal distribution from which they are sampled any other suitable probability distribution could also be used instead these values are reshuffled based on the ranks of the resampled historical values breinl et al 2013 which enables modelling the autocorrelations within each state finally the resampled reshuffled values are inverse standardized to obtain the synthetic daily streamflow sequence 2 2 stochastic streamflow generation using the hybrid mctmc model the following are the steps involved in the generation of ns number of synthetic sequences using the hybrid mctmc model i the initial state s i for the given season m is selected through a probability picking using a uniform distribution in the interval 0 1 using the initial probability vector of the season ii the holding time for the initial state t ini is sampled from the set of values empirically estimated from the observed data iii the de seasonalized observed flow sequence with duration equal to t ini is resampled from the historical record iv the normal probability distribution n x s i σ s i for the state is used to generate t ini random variates which are the de seasonalized flow values v the randomly generated values from step iv are reshuffled in the order of the ranks of the resampled sequence obtained in step iii vi the reshuffled de seasonalized flow values obtained in step v are inverse standardized using the mean and standard deviation of the corresponding days in the year to obtain the synthetic streamflow values the rarely occurring negative values are corrected to zero or a small positive value between zero and observed minimum flow vii the next state s k s i w h e r e k i in the season is found using the embedded transition probability matrix p m through a probability picking using a uniform distribution in the interval 0 1 and the corresponding holding time t s k s i m is sampled through a probability picking using a uniform distribution in the interval 0 1 with replacement from among the durations available for the given season and preceding state viii steps iii to vi are repeated for every state and its corresponding holding time obtained in step vii to generate temporally correlated daily flow sequence till the end of the season m ix the first state in the next season m 1 is found through a probability picking using a uniform distribution in the interval 0 1 from the end transition probability matrix of the season m and the corresponding holding time is sampled randomly with replacement from the initial holding times estimated for the season m 1 x the steps iii to ix are repeated to generate one synthetic flow sequence of n years xi steps i to x are repeated to generate ns synthetic streamflow sequences in the proposed hybrid mctmc model it is not mandatory to do the standardization de seasonalization of the observed flow data and follow it up with the fitting of the normal distribution instead any other robust distribution can be fitted to each classified state of the observed streamflows directly in which case the standardization and the inverse standardization steps would be skipped it is also possible to normalise the observed streamflow data using a logarithmic or other appropriate transformation before the standardization operation if required in which case the generated synthetic daily flow variates are to be inverse standardized followed by the corresponding inverse transformation the above steps of synthetic generation of the proposed model are coded in matlab version r2020b math 2020 and could be made available to researchers based on a personal request 3 model application the proposed methodology for the generation of daily synthetic streamflow sequences is illustrated using the observed flows at three gauging sites located in the upper colorado river basin namely usgs 09306500 site1 usgs 09260000 site 2 and usgs 09342500 site 3 site 1 is located on the white river utah state site 2 is on the little snake river colorado state and site 3 is on the san juan river colorado state the daily streamflow data in cfs for the three sites are collected from the usgs national water information system web interface https waterdata usgs gov nwis the site details and the respective daily streamflow summary statistics are presented in table 1 the length of the daily streamflow record available for the white river is 35 years while it is 99 years for the little snake river and 85 years in case of the san juan river the daily streamflow summary statistics are presented on a monthly basis in table a 1 in appendix a it may be noted from table 1 that there is a wide variability in the daily streamflows in case of all the three rivers and the observed minimum flows could approach zero also a distinct seasonality is observed with a clear demarcation of the low flow months from the high flow months table a 1 daily flows in some of the months have a high coefficient of variation and or high values of coefficient of skewness moreover the low flow months seem to exhibit a more long term correlation when compared with the high flow months 4 results and discussion the presentation and the discussion of results are dealt with under four sub sections a detailed discussion regarding the appropriate number of states and their classification is presented in the first sub section since the number of parameters in the proposed model increases non linearly with the number of states the state classification is an important issue of discussion following the state classification a brief discussion is presented on the monthly state transition probabilities embedded and end transition probabilities and state holding sojourn times in the second sub section the third sub section deals with the investigation of the efficacy of performance of the proposed hybrid mctmc model although most part of the results and discussion in this article pertains to the case of fitting normal distribution to the standardized flow variates a brief comparison of the simulation performance of the same with three other variations of the proposed model is presented in this sub section the three other variations considered are i log transformation normalisation of the observed daily streamflows followed by de seasonalization using standardization and then fitting normal distribution ii directly fitting the observed flows using a robust 4 parameter kappa distribution using l moments hosking and wallis 1997 iii fitting the 4 parameter kappa distribution using l moments to the standardized flow variates the performance of the proposed hybrid modified continuous time markov chain hybrid mctmc model is evaluated based on its ability to preserve the following statistics of the observed streamflows i the markov state embedded and end transition probabilities and the state holding times ii the summary statistics mean standard deviation median skewness coefficient minimum and maximum at the daily level and the aggregated monthly and annual time scales iii the daily autocorrelation structure acs at the daily as well as the monthly levels iv the empirical cumulative distribution functions of the streamflow amounts in each state the aggregated monthly flows and the annual mean flows the generated daily streamflow sequences are also evaluated for their suitability to be used for water resources system design evaluation and management known as validation in this regard the preservation of the water use statistics namely the flow duration curve the annual maxima the low flow index 7 q 10 and the wet and the dry spells are considered further the efficacy of the proposed model is also brought out through a comparison with the flexible hybrid continuous time simulation model proposed by brunner et al 2019 that couples the phase randomization non parametric approach to generate the time dependence structure with the flexible 4 parameter kappa distribution parametric component for random generation 4 1 selection of number and division of classes states with a view to select suitable number of classes states the k means clustering algorithm kmeans function from matlab r2020b followed by the elbow plot and the silhouette validation index are employed both the cluster validity methods identify the optimum of number of clusters states to be either two or three in case of all the three stations to confirm if two or three states would be sufficient to model the intricacies of the daily streamflows the simulation performance of the hybrid mtcmc model in terms of capturing the daily autocorrelations for 60 lags is presented for the state classifications 2 3 8 10 15 and 20 for the station on the white river near watson in fig 2 it is noted from fig 2 that the daily serial correlations improve significantly from 2 states to 10 states but beyond that the improvement is not significant however it is noted that the number of classes do not notably affect the preservation of monthly summary statistics not shown herein for brevity the preservation of the daily flow statistics is presented in fig 3 for the states 2 8 10 and 20 to decide on the minimum number of states required to effectively model the streamflows it may be noted from fig 3 that the preservation of daily skewness improves with increasing number of states however the improvement in the preservation of the various daily level statistics beyond 10 states is only marginal hence taking into account the model performance as well as the parsimony consideration with respect to the higher state hybrid mctmc models a 10 state hybrid mctmc model was found to be an appropriate choice for the daily streamflow generation in case of the white river near watson however it is to be mentioned that for shorter data length a lesser number of states may be sufficient to achieve the required preservation of daily streamflow characteristics in any case if the number of states are reduced to two or three the performance of the model dwindles considerably and hence not acceptable now that the number of states is identified the k means and the k medoids clustering algorithms are employed to identify the range of the flow states for a predefined number of clusters say n 10 this yielded non uniform percentile classes states which are presented in table 2 along with the uniform percentile classes states and the ones adopted in the manuscript from table 2 it is observed that both the clustering algorithms have identified the state classifications to be nearly the same and they seem to be covering the ranges of all the states effectively which are quite different from the uniform percentile classes that do not seem to identify the state classifications effectively in the higher flow states the identification of states as uniform percentiles may not be appropriate since the distribution of flow magnitudes are seldom uniform however the clusters states identified through the clustering algorithm may give a lead to start with but would require considerable fine tuning considering the gaps in the observed flows especially in the high flow states and the varying slopes of the transitions in the rising and the recession limbs of the hydrograph this has required some more trials to arrive at the actual state classification that has been adopted in the study presented in the last row of table 2 which was confirmed through the efficacy of the simulation performance the same procedure is adopted to obtain the non uniform percentile based class divisions for the other two rivers also however there is definitely considerable scope for finding the optimal number of states and the corresponding state classifications from the point of view of simulation performance 4 2 modelling of state transition probabilities and holding times it is to be noted that the 10 state classification is the same for the entire daily streamflow sequence irrespective of the month it is not necessary that all the states will be present in every month the embedded state transition probabilities are empirically estimated for each month separately based on the states present in that month the mean of the embedded state transition probabilities estimated for each month from the 50 synthetic sequences are found to be in good agreement with their counterparts from the observed daily streamflow sequence for all the sites table 3 shows the preservation of the monthly embedded transition probabilities estimated from the observed o sequence compared with the mean of their counterparts estimated from the synthetic sequences ss for november typical low flow month for the site on the white river near watson it may be seen from table 3 that the embedded transition probabilities are well simulated in the synthetic flow sequences preservation of the embedded transition probabilities in the month of may high flow month for the white river is presented in table b 1 appendix b the embedded transition probabilities are preserved in all the months in this station as well as in the other two stations not presented herein for brevity the continuity in occurrences from the end of a month to the start of the next succeeding month is modelled using the month end transition probabilities empirically estimated from the observed sequence table 4 shows the month end transition probabilities estimated from the observed o sequence and the mean of the same estimated from the 50 synthetic sequences ss for november december each row in table 4 shows the transition of an ending state say s5 in november to all possible starting states s2 s4 s5 and s6 in the successive month december it may be noted from table 4 that in addition to the nine observed states in november one unobserved state s10 is encountered in the synthetic sequences likewise in may in addition to the eight ending states observed two unobserved states s9 and s10 have occurred in the synthetic sequences table b 2 the transition of the unobserved ending states is achieved through a probability based picking from the initial probability matrix of the successive month it could be seen from table 4 that the end transition probabilities are satisfactorily preserved in the synthetic generations similar results are observed for the other months of the site on the white river and for all the months of the other two sites as well not presented herein due to brevity the continuity of a markov state in time is modelled using the monthly state holding times estimated from the historical data fig 4 shows the state holding times estimated from the observed sequence o and the 10 representative synthetic sequences ss for november month and fig s1 in supplementary material shows the same for may month for the white river from which it is noted that the median state holding time is satisfactorily preserved with enough variability around it for all states similar results are observed for the other months in the site mentioned and all the months of the other two sites as well herein it is to be noted that the resampling of the sojourn holding times from the observed sequence restrains the generation of unobserved holding times in the synthetic sequences 4 3 modelling of daily streamflow magnitudes once the streamflow occurrence sequences are simulated the de seasonalized daily streamflow amounts contained within each state are modelled with a normal distribution whose parameters are estimated using the maximum likelihood estimation mle technique and the same are presented in table 5 the de seasonalized daily streamflow amounts for each state are generated using the respective set of normal distribution parameters the generated data are reshuffled based on the ranks of the resampled observed sequence which enables preservation of the dependence structure the reshuffled amounts are then inverse standardized using the respective days mean and standard deviation to obtain the synthetic daily streamflows in order to evaluate the performance of the proposed hybrid mctmc model 50 sequences each of length equal to the observed data are generated through monte carlo simulation fig 5 shows the observed and the simulated daily streamflow sequences at the three sites for 3 consecutive years arbitrarily selected it could be seen from fig 5 that appropriate modelling of the states and their persistence holding times in the 10 state hybrid mctmc model have enabled the overall reproduction of the daily streamflow pattern including the start date and the duration of the high flow season additionally due to the use of normal distribution parametric component streamflows beyond the observed range are also generated to bring out the essence of the variability in the synthetic simulations with regard to the variability in the observed flows ensemble plots are prepared exclusively and are presented in fig b1 in appendix b for the white river and in fig s2 and fig s3 in the supplement for the little snake river and the san juan river respectively from the figures it may be observed that the median flows as well as the variability in the observed flows are well replicated in the synthetically generated daily streamflows from the proposed model and a reasonable percent of unobserved flows including those beyond the extremes are also generated before proceeding further with the investigation of the performance of the proposed hybrid mctmc model pertaining to the case of fitting normal distribution to the standardized flow variates it may be worthwhile to make a brief comparison of the simulation performance of this model with a few other potential variates of the hybrid mctmc model in this regard the following three variations are considered for the comparison i log transformation normalisation of the observed daily streamflows followed by de seasonalization using standardization and then fitting normal distribution ii directly fitting the observed flows using a robust 4 parameter kappa distribution using l moments hosking and wallis 1997 iii fitting the 4 parameter kappa distribution using l moments to the standardized flow variates in case of all the 4 variations compared a 10 state mctmc model is coupled with the respective parametric part the first variation was tried with the intent of utilizing the advantages of making the flow data normal through a log transformation before de seasonalization the second variation of directly modelling the skewed observed flow data with the robust 4 parameter kappa distribution is included in the performance comparison since it has been recommended as the best fitting distribution by blum et al 2017 for modelling the daily streamflows of most of the rivers in the usa the third variation is attempted to examine whether there would be an improvement in performance if the robust kappa distribution is fitted to the de seasonalized flow variates fig 6 shows the preservation of the daily streamflow summary statistics for the variations i ii and iii respectively in row 1 row 2 and row 3 for the white river near watson it could be seen from fig 6 that fitting the 4 parameter kappa distribution to the standardized flow variates variation iii highly overestimates the maximum and the standard deviation of the daily flows on the other hand the 4 parameter kappa distribution fitted to the observed daily flows variation ii underestimates the peak of the mean flows at the daily level also the generation of values beyond the observed daily maximum is found to be limited since the upper bound of the highest state state 10 gets fixed at 5314cfs while the highest observed flow is 4980cfs since the shape parameter is positive however the overestimation of the daily minimum flows during the high flow season is found to be considerably reduced and the daily skewness is also better replicated in comparison to the other variations in case of log transformed daily streamflows variation i even though the maximum and the standard deviation of the daily flows are slightly overestimated the daily mean flows are well reproduced it is observed that the model in which the normal distribution is fitted to the standardized flow variates fig 6 row 4 performs equivalently or better than the other three variations in terms of reproducing the mean the standard deviation and the maximum daily flows moreover this variation exhibits better preservation of long memory dependence as could be typically seen for october month low flow month in fig 7 herein it is to be mentioned that owing to the semi parametric nature of the proposed model even the simple normal distribution fitted to the standardized flows without any normalizing transformation is able to reproduce most of the distributional features of the observed flows including the maximum flows furthermore the preservation of the water use validation statistics is found to be better for this model when compared with the three variations considered supplementary material fig s4 hence from here on the detailed results are presented and discussed only for the mctmc model coupled to a normal distribution which is fitted to the standardized daily flows and is referred to as the hybrid mctmc model in the remaining part of the paper fig 8 compares the observed and the synthetic daily streamflow summary statistics for the white river it could be seen that the mean the standard deviation std the maximum max and the median statistics are well simulated in the synthetic sequences while the minimum min is found to be overestimated during the high flow period april july the pattern of reproduction of the daily streamflow summary statistics is similar in case of the other two sites also as could be seen from fig s5 supplementary material fig 9 shows the preservation of the daily skewness and kurtosis in the three sites it could be seen that the general pattern of daily skewness and kurtosis are reproduced in the synthetic sequences however the higher values are not captured the relative bias in percentage in standard deviation of the daily streamflows are 6 7 2 1 and 4 3 for the white river the little snake river and the san juan river respectively fig 10 shows the monthly autocorrelation structure for 25 lags computed from the observed black scatter and the simulated cyan band streamflow sequences at white river it could be seen that the autocorrelation coefficients for the first few lags 5 lags are well replicated in the synthetic sequences for all the months also for the high flow months the correlation coefficients are well preserved throughout however in the low flow months certain amount of bias is experienced at higher lags appropriate state classification simultaneous modelling of state occurrences and their respective durations followed by resampling and reshuffling of the generated flow magnitudes have enabled satisfactory preservation of the monthly autocorrelation structure the preservation of monthly autocorrelation structure is similar in case of the other two stations also refer supplementary fig s6 fig s7 fig 11 shows the empirical cumulative distribution function ecdf of the streamflow amounts in each state s1 s10 computed using the weibull plotting position formula for the white river from which it is seen that the distributional characteristics of the daily streamflow amounts contained in the higher states are satisfactorily preserved however the state 1 s1 and lower magnitudes of state 2 s2 experience slight under estimation the ecdfs at the other two sites also exhibit a similar kind of preservation not shown herein for brevity the suitability of the proposed model was examined at aggregated time levels also fig 12 shows the summary statistics of the aggregated monthly streamflows for the white river it can be seen that the mean flows are well preserved whereas the standard deviation and the maximum statistics are slightly underestimated in all the months the relative bias in the mean of the aggregated monthly flows ranges between 0 for august month and 5 for february month while that in the standard deviation ranges between 4 in march to 18 in september except for 34 in february the minimum aggregated monthly flows are significantly overestimated in the high flow months and slightly deviant in the rest of the months further the reproduction of summary statistics for a sample day 15th day in every month for all the three sites are presented in supplementary material fig s8 the mean flows are well reproduced with sufficient variability while the standard deviation and the maximum values are reasonably modelled in the synthetic simulation for most of the months fig 13 shows that the proposed model effectively preserves the ecdfs of the aggregated monthly flows of the white river in all the months and also produces enough variability around and beyond the observed values which would be useful in evaluating risk reliability in water resources planning and design applications this can be ascribed to the generation of the flow magnitudes using an appropriate normal distribution fitted for the respective state in addition significant number of flows are generated in the gaps between the observed values in all the months thus providing adequate smoothing value the preservation patterns are quite similar for the other two rivers as well refer supplementary fig s9 fig s10 table 6 presents the comparison of the summary statistics of flows at the aggregated annual level for the three sites for the synthetic flow sequences mean and standard deviation of the ensemble of the same are presented it is to be mentioned that the mean flows are well preserved with a relative bias in percent of 1 5 1 9 and 1 1 for the white river the little snake river and the san juan river respectively while the standard deviation of the same are underestimated with a relative bias of 33 14 and 21 percentages further it may be noted from table 6 that the maximum flows are underestimated while the minimum flows are overestimated in all the three rivers however the skewness of the aggregated annual streamflows is well reproduced in case of all the three sites fig b2 in appendix b shows the ecdf of the annual mean daily streamflows constructed from observed and synthetic streamflow sequences using the weibull plotting position formula chow et al 1988 it is seen that the annual mean daily flows in the medium and the high flow ranges are well captured for the little snake river and the san juan river while in case of the white river the high flows are underestimated and the low flows are overestimated 4 4 preservation of water use statistics the synthetic sequences generated using the hybrid mctmc model are evaluated for the preservation of the water use statistics namely flow duration annual maxima low flow index 7q10 and duration of wet dry spells flow duration curves have found profound applications in the areas of water quality management hydropower instream flow requirements and river and reservoir sedimentation vogel and fennessey 1995 the row 1 of fig 14 shows the flow duration curve fdc derived from the observed and the simulated sequences for the three sites the ensemble of simulated fdcs is in good agreement with the observed fdc in all the three sites further the suitability of the synthetic sequence to be used for design applications is evaluated based on its ability to reproduce the empirical probabilities of annual maximum daily streamflow series it may be observed from fig 14 row 2 that the ecdf of the observed annual maximum flows are well preserved in the synthetic simulations and hence the same could be used in applications regarding the design of hydraulic structures preservation of the fdc and the annual maximums can be attributed to the reproduction of the distributional characteristics according to the united states environmental protection agency epa the design low flow index 7q10 is defined as the lowest 7 day average flow that occurs once in 10 years on an average the 7q10 flow index is widely used to set the minimum discharge limits and the preservation of it is useful in the ecological applications you et al 2014 it may be observed from fig 14 row 3 that the 7q10 index is well preserved in the synthetic simulations the preservation of the low flow index could be ascribed to the appropriate state classification and the reproduction of the states and their respective holding times in addition to the preservation of the daily autocorrelation structure for the first 10 lags in the low flow months the complex and dynamic nature of the rainfall runoff process can be visualized from the seasonal and annual variability in the wet and dry spells eighty percent of the monthly mean daily flow is used as the threshold to separate wet and dry flows the spread of the durations of the wet and dry spells estimated from the observed o as well as 10 representative simulated sequences ss are presented in fig 15 for all the three sites from which it is clear that the median and the spread of the wet dry spells are satisfactorily reproduced this is due to the appropriate resampling of state holding time use of appropriate parametric distribution for generation and the resampling reshuffling operation 4 5 performance comparison with the hybrid model of brunner et al 2019 the single site daily streamflow generation model of brunner et al 2019 is chosen for comparison with the hybrid mctmc model due to the following reasons i it is a flexible hybrid model that couples the phase randomization non parametric approach to generate a time dependence structure with the flexible 4 parameter kappa distribution parametric component for random generation ii it is a continuous time simulation model iii it is one of the latest daily streamflow generation models proposed that has a good simulation performance they have provided a function prsim in the r package https cran r project org web packages prsim index html for the synthetic generation of daily streamflows the observed daily streamflow data from 1981 to 2018 at one of the stations nehalem river near foss oregon usgs 14301000 in the pacific northwest given in brunner and gilleland 2020 is considered herein for performance comparison between the hybrid mctmc model and the single site model of brunner et al 2019 referred to as prsm from here on the mean flow pattern at this site is different from the three sites for which the results were presented earlier fig 16 shows the mean the standard deviation std the maximum max and the minimum min daily flow statistics estimated from the synthetic sequences simulated using the proposed model and the prsm it could be seen that the mean and the standard deviation of the daily streamflows are well preserved by both the models however the proposed model slightly underestimates the maximum and shows high variability in case of minimum flows while the prsm significantly overestimates the minimum daily flows moreover the proposed model is able to perform better in capturing the complex pattern of the daily autocorrelation function at the site especially at higher lags fig c1 appendix c further the models were tested for their efficacy in reproducing the flow statistics at the aggregated levels fig 17 shows the mean and the standard deviation of the aggregated monthly streamflows from the proposed model and the prsm although both the models satisfactorily preserve the mean aggregated monthly streamflows the proposed model shows better variability also the standard deviation of the aggregated monthly flows is better captured by the proposed model both the models are found to overestimate the monthly minimum flows fig c2 appendix c shows that the proposed model performs better in reproducing the summary statistics at the aggregated annual level the ecdfs presented in fig 18 show that the hybrid mctmc is able to model the features of the annual maximum and the annual mean flows better than prsm moreover the models are tested for their suitability in reproducing the fdc fig 19 row 1 and the low flow index fig 19 row 2 it may be noted from fig 19 row 1 that the variability in the synthetic flows is very less for the prsm but the proposed model gives a consistent band around the observed flows on the other hand prsm overestimates the extreme unobserved flows at low exceedance probability levels also the prsm is seen to underestimate the low flow index 7q10 while the hybrid mctmc model performs better 4 6 ideas towards building a regional hybrid mctmc model a plausible approach to regionalize the hybrid mctmc model and transfer of information from the gauged stations to the ungauged station for synthetic generation of the daily streamflows at the ungauged station is presented here and is underway synthetic daily streamflow generation at an ungauged station target station ts using hybrid mctmc model requires model parameters to be appropriately transferred from the gauged stations source stations ss to the ts all the stations preferably belonging to the same homogeneous region the hybrid mctmc model parameters that need to be transferred are the transition probabilities initial embedded end of month state sojourn time and the theoretical distribution parameters the first step towards estimating the model parameters is to identify the flow states in order to ensure uniformity across the source stations and facilitate transferability of information to the ts the flow values corresponding to a range of return periods are pre selected as the class state divisions the flow magnitudes for the above return periods which are the state divisions in the ts could be obtained from a regional flow frequency curve developed using a regional frequency analysis procedure the state divisions of the ts and the streamflow sequences of the source stations are normalized using a flow value index value corresponding to a return period higher than the pre selected ones now that in the non dimensional plane the flow variates in all the stations vary between zero and one and the same number of states exist across all sites in the region transferring information in terms of parameters from the gauged sites to the ungauged site becomes possible for the pooled non dimensional flow data corresponding to each state an appropriate distribution can be fitted which will form the parametric part of the regional mctmc model the initial the embedded and the end of the month transition probabilities are then empirically computed for each month for the ss the weighted average of the state transition probabilities computed from the source stations for a given month is presumed to reasonably represent the respective month s state transition probabilities at the ts the weightage assigned to the ss is computed as inversely proportional to the square of the respective distance from the ts or an appropriate distance measure computed from the significant physical characteristics next the state holding times sojourn times are empirically estimated for all the states and for all source stations while sampling the state holding time during the synthetic generation and further for the resampling reshuffling operation at the target site ts one of the source stations is selected through a probability picking based on the weightage assigned to them and the state holding time of the respective state sampled from the selected ss is considered to be the state holding time at the ts having obtained the hybrid mctmc parameters the non dimensional daily flow variates at the target site are generated and are transformed to the original flow domain using the index flow value a detailed description is provided in the supplementary material s11 5 summary and conclusions the novelty of the present research work arises from the identification and the conceptualization of using the ctmc model for daily streamflow simulation and introducing the non homogeneity and the history dependence features appropriately to model the asymmetry of the daily streamflow hydrograph and the seasonality this is achieved by means of introducing the monthly varying embedded state transition probabilities non homogeneity calculated based on a common multiple state classification of flows for the entire year with a view to account for the monthly within year variation of flows and their state transitions so that the rising and falling nature of the daily streamflows is continuously modelled in addition the state sojourn times are modelled through a probability based resampling from the historical observations conditioned on the preceding state history dependence and the month of occurrence non homogeneity moreover the continuity across months is preserved by empirically sampling from the month end transition probability matrix once the occurrence sequences are continuously generated by the modified ctmc model the amounts are generated from a suitable parametric distribution fitted for the respective state and arranged in each state for a duration as per the sampled state holding time the above arrangement of the generated random variates will be done by reshuffling based on the ranks of the resampled historical daily streamflow amounts within that state by this hybridization unobserved daily streamflow amounts as well as values beyond the observed extremes are generated the structure of the proposed model framework is flexible to accommodate the following variations i skewed observed daily flows could be used directly or transformed flow variates could be used option for using standardized or transformed and standardized flow variates are also available ii depending on the range and the nature of the flow variates transformed or otherwise the number of states and the state divisions could be varied iii alternate parametric distributions could be coupled with the continuous time markov chain to improve the performance of the hybrid mctmc model iv the flow variates in different states could be fitted to different distributions and or different conditional resampling schemes could be employed for sampling the holding times the proposed model has been applied to the daily streamflows measured at three individual sites located in the upper colorado river basin the proposed model mimics the observed streamflow hydrograph pattern well and is capable of producing events beyond the observed extremes the ensemble of daily streamflow sequences generated model the uncertainty associated with daily streamflows moreover the model is found to replicate the various summary statistics at the daily time scale and also preserve the long term and short term dependence the reproduction of basic summary statistics at the aggregated monthly level is found to be satisfactory in addition the model successfully preserves the state wise distributional pattern at the daily level as well as the monthly aggregated level the efficacy of the model in reproducing the annual maximum flows validates its use for risk based design of hydro systems the preservation of the flow duration curve enables the estimation of the uncertainty associated with the release to the run of the river hydropower plant to ensure the reliability in energy production the ability of the proposed model in reproducing the low flow index validates its capability in handling the uncertainty associated with environmental flow requirements at the reservoir level the model captures the duration of wet dry spells satisfactorily which enables the assessment of the variability in critical drought durations the comparison of the results obtained from the hybrid mctmc model with that of brunner et al 2019 reveals the competence of the proposed model further the applicability of the proposed model has been tested at some more sites with different daily flow hydrograph patterns and varying dependence structure and found to be performing well the number of states and the state classification have a significant effect on the simulation performance of the proposed model in the present study the classification has been done based on a few trials there is scope for optimizing the division of number of classes states and the corresponding intervals moreover the model has a tendency to overestimate the minimum flows also it does not preserve the serial correlations at the aggregated monthly level since it is not tailored to do so the flows exhibit higher relative dispersion at the aggregated annual level it is to be mentioned that even though the model requires estimation of many parameters the computation involved are simple arithmetic calculations the hybrid mctmc model is capable of producing alternate stochastic series and gives representative extension of the historic sequence however the model is not designed to capture the non stationarity in the daily flows the extension of the proposed model to capture non stationarity in daily streamflows may require the transition probabilities to be modified for instance using a fourier polynomial spirkl and ries 1986 and the modification of the location and or scale parameters of the probability distribution adopted in the parametric part the potential of the proposed structure of the hybrid mctmc model in modelling the hourly streamflow hydrographs is to be tested and is underway the model may be used to simulate other geophysical time series like temperature and solar radiation that display seasonal effects and possess long memory in their dependence the proposed single site hybrid modified continuous time markov model can be easily extended to the regional context so that the regional level information can be transferred through the parameters of the regional model to stations where data are not available at daily scale and to ungauged sites to enable the generation of daily streamflows at those sites the crux of the preliminary ideas towards building a regional level hybrid mctmc model is also presented further the extension of the proposed model to the multi site daily streamflow modelling is to be explored credit authorship contribution statement l s shilpa conceptualization methodology software validation formal analysis investigation data curation writing original draft k srinivasan supervision writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to express their sincere gratitude to indian institute of technology madras chennai india for providing the facilities required to carry out the research work the first author is thankful for the fellowship provided by the ministry of human resources and development government of india during the course of the research work we are thankful to the associate editor one of the reviewers simon michael papalexiou and the other anonymous reviewer for their comments and suggestions on the earlier version of this manuscript which has helped to improve the overall quality presentation and organization of the paper appendix a appendix b appendix c appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128206 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 
3128,a novel hybrid modified continuous time markov chain mctmc based single site stochastic model is proposed for the synthetic generation of daily streamflow sequences the inherent characteristic of the continuous time markov chain ctmc process to represent the dynamic and continuous behaviour of stochastic systems through discrete states and their persistence in time has been perceived to be suitable for modelling the daily streamflows the structure of the original ctmc is modified to model the asymmetry of the daily flow hydrograph and the seasonality characteristics involved the de seasonalized streamflow space is discretized into an appropriate number of markov states and a normal probability distribution parametric component is fitted to each state the state occurrences are modelled using the embedded transition probability matrix within the month and the state holding times the state holding times are conditioned on the preceding state and the month of occurrence to reflect the inherent historical dependence and the non homogeneity of the daily streamflows and are resampled from the observed data the normal distribution generated values within the state are reshuffled according to the ranks of the resampled historical sequence the competence of the proposed model is illustrated through its application to the observed daily flows at three rivers in the colorado basin the model is shown to reproduce the summary statistics and the distributional characteristics at the daily as well as the aggregated time scales the short term and the long term dependence the asymmetric shape of the hydrograph as well as the water use statistics are well preserved in the simulations the efficacy of the proposed model is also brought out through a comparison with the frequency based model of brunner et al 2019 keywords daily stochastic streamflow model hybrid modified continuous time markov chain embedded transition probability state holding time resampling reshuffling abbreviations ctmc continuous time markov chain mctmc modified continuous time markov chain data availability data will be made available on request 1 introduction streamflows at a daily scale are often modelled using spatially distributed rainfall runoff models that characterize the dynamic response of the watershed to the rainfall input arising from a number of surface and subsurface processes and their interactions complex combination of the various flow generation mechanisms added with soil heterogeneity and the changes in the moisture state owing to alternating wetting and drying cycles pose formidable challenges to the daily streamflow modelling using rainfall runoff models a simpler alternative approach has been to develop lumped conceptual models for the watersheds considering uncertainty in the storm events that will be useful for decision making at the planning level especially for ungauged watersheds in this regard weiss 1977 came up with a pioneering effort to model the daily streamflows developing on the filtered poisson process shot noise process the effective rainfall pulses were modelled as a point process and the intensities as exponentially distributed and this stochastic input was filtered through a deterministic system response function consisting of base flow and direct runoff components a major drawback of the weiss approach was the estimation of the shot noise parameters directly from the runoff data which did not offer scope for validating the correspondence between the correlated effective rainfall pulses generated and the runoff this was overcome by treiber and plate 1977 who adopted a conceptually based stochastic formulation employing a markov process to model the correlated effective rainfall input and a non linear deterministic response model inverse estimation technique was adopted to reconstruct the unknown correlated effective rainfall pulses further improvements were effected by cowpertwait and o connell 1992 and murrone et al 1997 in modelling the effective rainfall pulses although the shot noise models are well founded the modelling exercise is quite involved claps et al 2005 moreover a number of drawbacks such as overestimation of low flows generation of too many rises and recessions rapid decay of recession flows are reported sargent 1979 you et al 2014 another variation of the conceptually based stochastic modelling approach for daily streamflow generation is a hybrid discrete markov chain based model that consists of two basic steps i determination of the state of flow from the observed daily streamflow hydrograph wet or dry depending on increase or decrease in the flow compared with the previous day s flow and ii computation of the ascension indicating wet state or recession indicating dry state curve of the streamflow hydrograph based on the state of flow the ascension limb of the daily streamflow hydrograph is modelled by randomly generating daily flow increments from gamma or weibull distribution and ranking them in increasing order with the largest one occurring at the peak of the hydrograph according to aksoy 2003 this is supposed to preserve the correlation structure of the ascension limb of the hydrograph the flow recessions are modelled as upper event runoff component and lower base flow component exponential recessions using a least square fitting algorithm this kind of approach was adopted by sargent 1979 aksoy and bayazit 2000 aksoy 2003 szilagyi et al 2006 stagge and moglen 2013 mathai and mujumdar 2019 with some variations sargent 1979 modelled the pulse occurrences using a modified markov model and the pulse heights with a modified exponential distribution also scaling adjustments were done to ensure compatibility among daily monthly and annual flows aksoy 2003 adopted a three state markov chain to capture the occurrences while modelling the daily streamflows in an intermittent stream the two state increasing decreasing markov chain based daily streamflow generation model was further extended by szilagyi et al 2006 to model the daily streamflows at multiple sites in a basin in which the spatial correlations in the increments of the ascension limb were captured using second or third order polynomials further they used the concept of conditional heteroscedasticity to adjust the ascension increments generated from seasonally varying weibull distribution the full range of the recession curves was modelled using a non linear reservoir model stagge and moglen 2013 proposed a hybrid model combining a monthly climate model with a daily streamflow model to generate hydrographs based on the discrete climate states generated although their model is reported to perform well some bias is noted in the daily autocorrelations and the flow duration curve of the simulated flows the discrete markov chain based hybrid models have a tendency to overestimate high flows since they determine the state of occurrence first and then independently generate the flow increments using a probability distribution for deriving the ascension part of the hydrograph you et al 2014 moreover continuity in flow magnitudes across months could be affected as they are modelled using different sets of model parameters also the highest flow increment need not necessarily happen at the peak of the hydrograph recently mathai and mujumdar 2019 proposed a simple multi site daily streamflow modelling framework integrating a non parametric hybrid k nearest neighbour k nn resampling scheme lee and singh 2019 for modelling the spatially and temporally correlated occurrence states with the conceptually based ascension recession modelling of daily flow magnitudes despite the improvement in the modelling of occurrences the model could not effectively simulate the extreme flows and the upper segment of the recession flow dynamics mathai and mujumdar 2019 with a view to improve the ability of daily streamflow models in simulating the extreme flows pender et al 2016 used the hidden markov model hmm in combination with the generalized extreme value distribution hmm gev and the generalized pareto distribution hmm gp this was extended by patidar et al 2021 for simulating the daily streamflows under climate change scenarios the hmms realise unobserved states through the emission probability matrix which enables in effectively simulating the high and the low flow ranges of the daily streamflow sequence one more class of models belong to the empirical stochastic modelling category stochastic modelling of daily streamflows was first attempted by beard 1967 and quimpo 1968 using a second order markov model which could not simulate the characteristics of the daily flow hydrograph effectively subsequently linear stochastic models of the box jenkins type ar arma and arfima models have been employed for modelling annual and seasonal streamflows for nearly five decades salas 1993 koutsoyiannis 2000 the basic limitation with these popular parametric stochastic models is the requirement of satisfying the assumptions of linearity and normality chen et al 2015 and hence may not be suited for modelling daily streamflows which are often skewed and non linear also the asymmetry in the shape of the daily streamflow hydrograph and the complex nonlinear dynamics of the daily streamflows cannot be captured by these parametric stochastic models sharma et al 1997 mathai and mujumdar 2019 also since these models could not reproduce the flow statistics at the aggregated spatial and temporal scales various parametric disaggregation models were proposed grygier and stedinger 1988 koutsoyiannis and manetas 1996 mejia and rousselle 1976 santos and salas 1992 valencia and schakke 1973 but these models are not parsimonious and the corrections done to preserve the additivity at the aggregated scales grygier and stedinger 1988 are found to distort the correlation structure at the lower levels srinivas and srinivasan 2001 srivastav et al 2016 more recently bivariate conditional copula based parametric stochastic models lee and salas 2011 hao and singh 2013 have been applied to model the non linear dependence of the current period flow on the previous flows and the same was extended by chen et al 2015 to model multi site daily streamflows although these models were found to be effective in capturing the summary statistics and the ranked correlations kendall s tau large number of parameters had to be estimated resulting in parsimony issues chen et al 2015 a further improvement of this method was proposed by chen et al 2019 by considering lag 2 autocorrelations in which conditional copulas were used to tackle the parsimony issue recently a unified stationary parametric stochastic modelling framework has been proposed by papalexiou 2018 which is shown to simulate hydroclimatic process of any spatio temporal scale with specified marginal distribution and linear autocorrelation structure including intermittency this is achieved by introducing flexible parametric correlation transformation functions that enable mapping the parent gaussian process with the arbitrary target process this framework is applicable to multi variate modelling as well following this unified stochastic framework papalexiou et al 2018 have proposed a one step disaggregation method that disaggregates the coarse time scale values to the target time scale values under stationary as well as non stationary conditions which preserves the actual marginal distribution and the actual correlation structure of the fine scale process while ensuring the preservation of the coarse scale values moreover papalexiou and serinaldi 2020 have introduced a blueprint for the effective simulation of spatiotemporal random fields that are described by different random variables with arbitrary marginal distributions and specified spatiotemporal correlation structures including intermittency the above set of three publications have significantly advanced the parametric stochastic modelling in hydrology which can be effectively used for simulating the complex daily streamflow process several non parametric disaggregation techniques have been proposed in the last three decades which do not make any assumption about the underlying distribution of the streamflow sequence the nonparametric temporal spatial disaggregation of streamflows was attempted using a gaussian kernel density estimate tarboton et al 1998 wang and ding 2007 or the k nn method lall and sharma 1996 prairie et al 2007 lee et al 2010 although the non parametric disaggregation models are capable of capturing the summary statistics the marginal distributions and the serial correlations at the disaggregated level the kernel methods require flow adjustments from the disaggregated level to the aggregated level and encounter dimensionality and boundary leakage related issues while the k nn models do not generate values beyond the observed range also the smoothing value and the variability in the simulated flows may be limited srinivas and srinivasan 2005 in any case these non parametric methods are reported to be effective only in disaggregating the annual streamflows to the monthly level nowak et al 2010 and not to the finer time scale moreover they may not be able to model the transitions between years effectively which may affect the continuity of the generated streamflows at the disaggregation boundaries in the last decade other simple non parametric methods such as the method of flow proportion vectors kumar et al 2000 nowak et al 2010 and the method of fragments silva and portela 2012 have gained attention for daily streamflow disaggregation the method of flow proportion vectors is reported to be parsimonious and effective in generating disaggregated daily streamflows that preserve continuity summability dependence and summary statistics at different levels however the mean flows and the minimum and the maximum flows generated at the daily level seem to exhibit bias when compared with that of the observed flows plots 15 and 16 of nowak et al 2010 inability to model the transitions between successive years less frequent generation of extreme flows nowak et al 2010 and lack of variability you et al 2014 are a few limitations of this model further acharya and ryu 2014 proposed a simple adaptive linear statistical method for disaggregating the flows of a particular month to daily flows at a target station based on a streamflow index computed for each day in that month at the source station also a cubic spline interpolation was suggested to smoothen the jumps transitions between consecutive months in the simulated flows with an intent to maintain the continuity silva and portela 2012 employed the method of fragments srinkanthan and mcmahon 1980 to disaggregate the annual streamflows to monthly flows fragments are sampled from the class to which the aggregated flow belongs this method is based on the assumption that the streamflow pattern at the finer scale is similar in years with similar annual flows this was subsequently extended by portela and silva 2016 to generate daily streamflows directly from the generated annual streamflows even though the method of fragments is easy to implement its effect largely depends on the number and the division of classes or fragments silva and portela 2012 portela and silva 2016 the frequency domain based models are less commonly applied in the context of simulating the daily streamflows wang et al 2011 used the trous discrete wavelet algorithm to decompose the observed daily streamflows and reconstruct synthetic daily streamflow sequences the discrete wavelet transforms provide information only on amplitude but not on phase recently brunner et al 2019 proposed a continuous daily streamflow simulation model in which phase randomization was applied on fourier transformed normalized and de seasonalized daily flows and the phase randomization simulation was combined with the robust 4 parameter kappa distribution with a view to generate significant number of unobserved extreme flow values this model is reported to reproduce the distributional and temporal characteristics at the individual sites well brunner et al 2019 although brunner et al 2019 is a continuous time streamflow model it has the following limitations i fitting the 4 parameter kappa distribution on a daily scale makes the model non parsimonious ii non linear back transformation from the gaussian domain to the skewed domain reduces the strength of the linear correlations embrechts et al 2010 moreover the investigations done in this study presented later show that the brunner et al 2019 model may yield large extreme flows and the variability of the generated daily mean flows could be limited subsequently brunner and gilleland 2020 have proposed the continuous wavelet transformation based multi site daily streamflow model wherein the limitations of brunner et al 2019 concerning the back transformation are overcome however some of the other limitations of brunner et al 2019 seem to remain although non stationarity and oscillatory nature present in the daily time series are reported to have been captured sensing the limitations of the hybrid discrete time markov chain dtmc based models in the stochastic simulation of daily streamflows mentioned earlier a novel alternative hybrid stochastic model based on continuous time markov chain ctmc is proposed in this research the inherent characteristic of the ctmc process to represent the dynamic and continuous behaviour of stochastic systems through discrete states and their persistence in time has been perceived in this research work to be suitable for modelling the daily streamflows however the ctmc model in its original structure is not suited to model the asymmetric shape of the daily streamflow hydrograph and the seasonality exhibited by the daily streamflows to model these characteristics of the daily streamflows in this research study the ctmc model is suitably modified by introducing non homogeneity and history dependence the ctmc in its traditional form has been applied in various areas such as queueing theory population growth lithology sedimentation molecular chemistry krumbein and dacey 1969 gillespie 1977 rolke 1991 osaki 2012 while several modified versions of the same have also been applied to solve problems concerning utility of financial strategy development of clinical symptoms of diseases reliability of system components krak et al 2017 however to the best of the knowledge of the authors ctmc or any of its modified versions has not been applied in the context of stochastic streamflow modelling hence a fervent attempt is made in the current research work to develop a single site hybrid modified continuous time markov chain hybrid mctmc based stochastic daily streamflow model that would be able to preserve the shape of the continuous daily flow hydrograph and the associated distributional characteristics and the short term and the long term dependence structure in the proposed model the daily streamflow hydrographs are viewed to be consisting of flow classes states in the increasing order till the peak flow rising limb and then in the gradually decreasing order recession limb the proposed framework allows flexibility in modelling daily streamflows in the original plane or the standardized plane the standardization is done at the daily level with a view to remove certain amount of seasonality present in the daily streamflows the daily streamflows standardized otherwise are divided into states based on their respective magnitudes the flow variates in each state are fitted to an appropriate probability distribution which is normal distribution in case of standardized flows in the present study the same set of distribution parameters fitted statewise are retained for all the months with a view to preserve continuity between months in the generation process this feature of the model in combination with the end of the month transition probability is expected to overcome the deficiency of jumps at the transitions between months also the use of a parametric distribution allows generation of variates beyond the observed ones the transition of states within the season month are represented by an embedded transition probability matrix as in ctmc while the duration holding time in each state is conditioned based on the preceding state and the season month of occurrence modification of ctmc to model history dependence and non homogeneity this largely takes care of the deficiency of generating too many rises and recessions which may increase the uncertainty in daily flow patterns the gradual transition of states in the decreasing order of flow magnitudes together with the resampling of the respective state holding times enable modelling the hydrograph recessions and their variability appropriately the continuity across seasons months is modelled by the end of the month transition probability matrix the de seasonalized streamflow amounts generated from the parametric distribution of each state are reshuffled based on the ranks of the resampled standardized historical daily streamflow amounts within that state the flow magnitude based state classification along with the resampling reshuffling operation is likely to avoid overestimation and or underestimation of daily streamflows to a great extent the idea of resampling reshuffling adapted from breinl et al 2013 also enables the preservation of daily autocorrelations of the generated data within the state it is to be mentioned that standardization of the observed flows is not mandatory an appropriate robust distribution can be fitted directly to the observed streamflows without standardization and the same hybrid mctmc model is applicable the remaining parts of the paper are organized as follows the proposed methodology is detailed in section 2 the subsequent section presents a brief description of the three case examples of daily streamflows to which the proposed model is applied the results of the model application to the three case examples are presented and discussed in detail in the penultimate section following this the efficacy of the proposed model is brought out through a performance comparison with the hybrid continuous time daily simulation model proposed by brunner et al 2019 moreover a brief discussion of the preliminary ideas towards building a regional level hybrid mctmc model is also presented section 5 covers the summary and conclusions of the study along with the listing of the limitations and the future scope of the proposed model 2 methodology 2 1 overview the discrete time markov chain dtmc has been used to model various hydrological processes at different time scales haan et al 1976 aksoy 2003 in which the state space as well as the parameter space are supposed to be discrete on the other hand the continuous time markov chain ctmc model describes the stochastic evolution of dynamic systems x t t 0 through a discrete state space and continuous parameter space in other words the system remains in each state for an amount of time sojourn time or state holding time which is described by an exponential distribution before making a transition to the next state specified by the stochastic matrix of discrete markov states the inverse of the mean sojourn time in a given state is called the transition rate according to the markovian property the exponential distribution as well as the dtmcs are memoryless the transition probability in a ctmc model is known as embedded transition probability p ij t s which is associated with the transition of state i to j and can be calculated by summing over the entire intermediate state k at time t and moving to state j from state k at the remaining time s this is given by the continuous version of the chapman kolmogorov equation ross et al 1996 for any state i and j as in eq 1 and schematically represented in fig 1 1 p ij t s k 0 p ik t p kj s if the system moves from the initial state i to a state k at time t in the state space s then 2 p x t k i s p x t k x 0 i p x 0 i in which the first term on the rhs of eq 2 refers to the transition probability vector p ik t and the second term denotes the initial state probability vector a ctmc ideally requires i the point estimates for the initial probabilities and the rate parameters to be exact ii the model to be differentiable so that the rate parameters can be defined iii the future behaviour of the system to depend only on its current state and not on the past states prior history iv the rate parameters of the system to remain constant over time and not to depend on history krak et al 2017 so ctmc in its original form may not be directly suited to describe the dynamic behaviour of daily streamflows or similar geophysical processes that are continuous and stochastic in nature and also exhibit asymmetry irreversibility and within year seasonal and over year variabilities hence in this research study the ctmc model is suitably modified by introducing non homogeneity and history dependence so that the modified ctmc mctmc can be used for daily streamflow modelling in this model non homogeneity is introduced through monthly varying embedded transition probabilities and the state holding times are conditioned on the preceding state history dependence and the month of occurrence non homogeneity the limitation regarding the lack of exact knowledge about the rate parameters is overcome by resampling the state holding times from the historical record in this study additionally a suitable parametric model is integrated to the mctmc to develop the hybrid mctmc model for single site daily streamflow simulation the proposed methodology to simulate synthetic daily streamflow sequence uses daily data de seasonalized standardized using the daily mean and standard deviation the de seasonalized flow data are divided into a certain number of classes with pre defined magnitude ranges which are known as the markov states s s i of the model the simulation of synthetic daily streamflow occurrences using the mctmc requires the following components to be empirically estimated from the historical data a the embedded transition probability matrix derived for each season month m separately depending on the number of states existing in the season allows state transitions within the season b the state holding sojourn times estimated for every state in the season month conditioned on the preceding state c the vector of the initial probabilities of the various observed initial states d the holding times of the observed initial states e the end transition probability matrix estimated for the state transition between the last day of the current season month and the first day of the next season month the embedded transition probability matrix for a season with 10 states is given in eq 3 from which it may be noted that there are no self transitions diagonal elements of the matrix are zero 3 p m 0 p 1 2 p 1 3 p 1 10 p 2 1 0 p 2 3 p 2 10 p 3 1 p 3 2 0 p 3 10 p 10 1 p 10 2 p 10 3 0 further to model the streamflow amounts the de seasonalized flow magnitudes in each class state are fitted to a normal distribution from which they are sampled any other suitable probability distribution could also be used instead these values are reshuffled based on the ranks of the resampled historical values breinl et al 2013 which enables modelling the autocorrelations within each state finally the resampled reshuffled values are inverse standardized to obtain the synthetic daily streamflow sequence 2 2 stochastic streamflow generation using the hybrid mctmc model the following are the steps involved in the generation of ns number of synthetic sequences using the hybrid mctmc model i the initial state s i for the given season m is selected through a probability picking using a uniform distribution in the interval 0 1 using the initial probability vector of the season ii the holding time for the initial state t ini is sampled from the set of values empirically estimated from the observed data iii the de seasonalized observed flow sequence with duration equal to t ini is resampled from the historical record iv the normal probability distribution n x s i σ s i for the state is used to generate t ini random variates which are the de seasonalized flow values v the randomly generated values from step iv are reshuffled in the order of the ranks of the resampled sequence obtained in step iii vi the reshuffled de seasonalized flow values obtained in step v are inverse standardized using the mean and standard deviation of the corresponding days in the year to obtain the synthetic streamflow values the rarely occurring negative values are corrected to zero or a small positive value between zero and observed minimum flow vii the next state s k s i w h e r e k i in the season is found using the embedded transition probability matrix p m through a probability picking using a uniform distribution in the interval 0 1 and the corresponding holding time t s k s i m is sampled through a probability picking using a uniform distribution in the interval 0 1 with replacement from among the durations available for the given season and preceding state viii steps iii to vi are repeated for every state and its corresponding holding time obtained in step vii to generate temporally correlated daily flow sequence till the end of the season m ix the first state in the next season m 1 is found through a probability picking using a uniform distribution in the interval 0 1 from the end transition probability matrix of the season m and the corresponding holding time is sampled randomly with replacement from the initial holding times estimated for the season m 1 x the steps iii to ix are repeated to generate one synthetic flow sequence of n years xi steps i to x are repeated to generate ns synthetic streamflow sequences in the proposed hybrid mctmc model it is not mandatory to do the standardization de seasonalization of the observed flow data and follow it up with the fitting of the normal distribution instead any other robust distribution can be fitted to each classified state of the observed streamflows directly in which case the standardization and the inverse standardization steps would be skipped it is also possible to normalise the observed streamflow data using a logarithmic or other appropriate transformation before the standardization operation if required in which case the generated synthetic daily flow variates are to be inverse standardized followed by the corresponding inverse transformation the above steps of synthetic generation of the proposed model are coded in matlab version r2020b math 2020 and could be made available to researchers based on a personal request 3 model application the proposed methodology for the generation of daily synthetic streamflow sequences is illustrated using the observed flows at three gauging sites located in the upper colorado river basin namely usgs 09306500 site1 usgs 09260000 site 2 and usgs 09342500 site 3 site 1 is located on the white river utah state site 2 is on the little snake river colorado state and site 3 is on the san juan river colorado state the daily streamflow data in cfs for the three sites are collected from the usgs national water information system web interface https waterdata usgs gov nwis the site details and the respective daily streamflow summary statistics are presented in table 1 the length of the daily streamflow record available for the white river is 35 years while it is 99 years for the little snake river and 85 years in case of the san juan river the daily streamflow summary statistics are presented on a monthly basis in table a 1 in appendix a it may be noted from table 1 that there is a wide variability in the daily streamflows in case of all the three rivers and the observed minimum flows could approach zero also a distinct seasonality is observed with a clear demarcation of the low flow months from the high flow months table a 1 daily flows in some of the months have a high coefficient of variation and or high values of coefficient of skewness moreover the low flow months seem to exhibit a more long term correlation when compared with the high flow months 4 results and discussion the presentation and the discussion of results are dealt with under four sub sections a detailed discussion regarding the appropriate number of states and their classification is presented in the first sub section since the number of parameters in the proposed model increases non linearly with the number of states the state classification is an important issue of discussion following the state classification a brief discussion is presented on the monthly state transition probabilities embedded and end transition probabilities and state holding sojourn times in the second sub section the third sub section deals with the investigation of the efficacy of performance of the proposed hybrid mctmc model although most part of the results and discussion in this article pertains to the case of fitting normal distribution to the standardized flow variates a brief comparison of the simulation performance of the same with three other variations of the proposed model is presented in this sub section the three other variations considered are i log transformation normalisation of the observed daily streamflows followed by de seasonalization using standardization and then fitting normal distribution ii directly fitting the observed flows using a robust 4 parameter kappa distribution using l moments hosking and wallis 1997 iii fitting the 4 parameter kappa distribution using l moments to the standardized flow variates the performance of the proposed hybrid modified continuous time markov chain hybrid mctmc model is evaluated based on its ability to preserve the following statistics of the observed streamflows i the markov state embedded and end transition probabilities and the state holding times ii the summary statistics mean standard deviation median skewness coefficient minimum and maximum at the daily level and the aggregated monthly and annual time scales iii the daily autocorrelation structure acs at the daily as well as the monthly levels iv the empirical cumulative distribution functions of the streamflow amounts in each state the aggregated monthly flows and the annual mean flows the generated daily streamflow sequences are also evaluated for their suitability to be used for water resources system design evaluation and management known as validation in this regard the preservation of the water use statistics namely the flow duration curve the annual maxima the low flow index 7 q 10 and the wet and the dry spells are considered further the efficacy of the proposed model is also brought out through a comparison with the flexible hybrid continuous time simulation model proposed by brunner et al 2019 that couples the phase randomization non parametric approach to generate the time dependence structure with the flexible 4 parameter kappa distribution parametric component for random generation 4 1 selection of number and division of classes states with a view to select suitable number of classes states the k means clustering algorithm kmeans function from matlab r2020b followed by the elbow plot and the silhouette validation index are employed both the cluster validity methods identify the optimum of number of clusters states to be either two or three in case of all the three stations to confirm if two or three states would be sufficient to model the intricacies of the daily streamflows the simulation performance of the hybrid mtcmc model in terms of capturing the daily autocorrelations for 60 lags is presented for the state classifications 2 3 8 10 15 and 20 for the station on the white river near watson in fig 2 it is noted from fig 2 that the daily serial correlations improve significantly from 2 states to 10 states but beyond that the improvement is not significant however it is noted that the number of classes do not notably affect the preservation of monthly summary statistics not shown herein for brevity the preservation of the daily flow statistics is presented in fig 3 for the states 2 8 10 and 20 to decide on the minimum number of states required to effectively model the streamflows it may be noted from fig 3 that the preservation of daily skewness improves with increasing number of states however the improvement in the preservation of the various daily level statistics beyond 10 states is only marginal hence taking into account the model performance as well as the parsimony consideration with respect to the higher state hybrid mctmc models a 10 state hybrid mctmc model was found to be an appropriate choice for the daily streamflow generation in case of the white river near watson however it is to be mentioned that for shorter data length a lesser number of states may be sufficient to achieve the required preservation of daily streamflow characteristics in any case if the number of states are reduced to two or three the performance of the model dwindles considerably and hence not acceptable now that the number of states is identified the k means and the k medoids clustering algorithms are employed to identify the range of the flow states for a predefined number of clusters say n 10 this yielded non uniform percentile classes states which are presented in table 2 along with the uniform percentile classes states and the ones adopted in the manuscript from table 2 it is observed that both the clustering algorithms have identified the state classifications to be nearly the same and they seem to be covering the ranges of all the states effectively which are quite different from the uniform percentile classes that do not seem to identify the state classifications effectively in the higher flow states the identification of states as uniform percentiles may not be appropriate since the distribution of flow magnitudes are seldom uniform however the clusters states identified through the clustering algorithm may give a lead to start with but would require considerable fine tuning considering the gaps in the observed flows especially in the high flow states and the varying slopes of the transitions in the rising and the recession limbs of the hydrograph this has required some more trials to arrive at the actual state classification that has been adopted in the study presented in the last row of table 2 which was confirmed through the efficacy of the simulation performance the same procedure is adopted to obtain the non uniform percentile based class divisions for the other two rivers also however there is definitely considerable scope for finding the optimal number of states and the corresponding state classifications from the point of view of simulation performance 4 2 modelling of state transition probabilities and holding times it is to be noted that the 10 state classification is the same for the entire daily streamflow sequence irrespective of the month it is not necessary that all the states will be present in every month the embedded state transition probabilities are empirically estimated for each month separately based on the states present in that month the mean of the embedded state transition probabilities estimated for each month from the 50 synthetic sequences are found to be in good agreement with their counterparts from the observed daily streamflow sequence for all the sites table 3 shows the preservation of the monthly embedded transition probabilities estimated from the observed o sequence compared with the mean of their counterparts estimated from the synthetic sequences ss for november typical low flow month for the site on the white river near watson it may be seen from table 3 that the embedded transition probabilities are well simulated in the synthetic flow sequences preservation of the embedded transition probabilities in the month of may high flow month for the white river is presented in table b 1 appendix b the embedded transition probabilities are preserved in all the months in this station as well as in the other two stations not presented herein for brevity the continuity in occurrences from the end of a month to the start of the next succeeding month is modelled using the month end transition probabilities empirically estimated from the observed sequence table 4 shows the month end transition probabilities estimated from the observed o sequence and the mean of the same estimated from the 50 synthetic sequences ss for november december each row in table 4 shows the transition of an ending state say s5 in november to all possible starting states s2 s4 s5 and s6 in the successive month december it may be noted from table 4 that in addition to the nine observed states in november one unobserved state s10 is encountered in the synthetic sequences likewise in may in addition to the eight ending states observed two unobserved states s9 and s10 have occurred in the synthetic sequences table b 2 the transition of the unobserved ending states is achieved through a probability based picking from the initial probability matrix of the successive month it could be seen from table 4 that the end transition probabilities are satisfactorily preserved in the synthetic generations similar results are observed for the other months of the site on the white river and for all the months of the other two sites as well not presented herein due to brevity the continuity of a markov state in time is modelled using the monthly state holding times estimated from the historical data fig 4 shows the state holding times estimated from the observed sequence o and the 10 representative synthetic sequences ss for november month and fig s1 in supplementary material shows the same for may month for the white river from which it is noted that the median state holding time is satisfactorily preserved with enough variability around it for all states similar results are observed for the other months in the site mentioned and all the months of the other two sites as well herein it is to be noted that the resampling of the sojourn holding times from the observed sequence restrains the generation of unobserved holding times in the synthetic sequences 4 3 modelling of daily streamflow magnitudes once the streamflow occurrence sequences are simulated the de seasonalized daily streamflow amounts contained within each state are modelled with a normal distribution whose parameters are estimated using the maximum likelihood estimation mle technique and the same are presented in table 5 the de seasonalized daily streamflow amounts for each state are generated using the respective set of normal distribution parameters the generated data are reshuffled based on the ranks of the resampled observed sequence which enables preservation of the dependence structure the reshuffled amounts are then inverse standardized using the respective days mean and standard deviation to obtain the synthetic daily streamflows in order to evaluate the performance of the proposed hybrid mctmc model 50 sequences each of length equal to the observed data are generated through monte carlo simulation fig 5 shows the observed and the simulated daily streamflow sequences at the three sites for 3 consecutive years arbitrarily selected it could be seen from fig 5 that appropriate modelling of the states and their persistence holding times in the 10 state hybrid mctmc model have enabled the overall reproduction of the daily streamflow pattern including the start date and the duration of the high flow season additionally due to the use of normal distribution parametric component streamflows beyond the observed range are also generated to bring out the essence of the variability in the synthetic simulations with regard to the variability in the observed flows ensemble plots are prepared exclusively and are presented in fig b1 in appendix b for the white river and in fig s2 and fig s3 in the supplement for the little snake river and the san juan river respectively from the figures it may be observed that the median flows as well as the variability in the observed flows are well replicated in the synthetically generated daily streamflows from the proposed model and a reasonable percent of unobserved flows including those beyond the extremes are also generated before proceeding further with the investigation of the performance of the proposed hybrid mctmc model pertaining to the case of fitting normal distribution to the standardized flow variates it may be worthwhile to make a brief comparison of the simulation performance of this model with a few other potential variates of the hybrid mctmc model in this regard the following three variations are considered for the comparison i log transformation normalisation of the observed daily streamflows followed by de seasonalization using standardization and then fitting normal distribution ii directly fitting the observed flows using a robust 4 parameter kappa distribution using l moments hosking and wallis 1997 iii fitting the 4 parameter kappa distribution using l moments to the standardized flow variates in case of all the 4 variations compared a 10 state mctmc model is coupled with the respective parametric part the first variation was tried with the intent of utilizing the advantages of making the flow data normal through a log transformation before de seasonalization the second variation of directly modelling the skewed observed flow data with the robust 4 parameter kappa distribution is included in the performance comparison since it has been recommended as the best fitting distribution by blum et al 2017 for modelling the daily streamflows of most of the rivers in the usa the third variation is attempted to examine whether there would be an improvement in performance if the robust kappa distribution is fitted to the de seasonalized flow variates fig 6 shows the preservation of the daily streamflow summary statistics for the variations i ii and iii respectively in row 1 row 2 and row 3 for the white river near watson it could be seen from fig 6 that fitting the 4 parameter kappa distribution to the standardized flow variates variation iii highly overestimates the maximum and the standard deviation of the daily flows on the other hand the 4 parameter kappa distribution fitted to the observed daily flows variation ii underestimates the peak of the mean flows at the daily level also the generation of values beyond the observed daily maximum is found to be limited since the upper bound of the highest state state 10 gets fixed at 5314cfs while the highest observed flow is 4980cfs since the shape parameter is positive however the overestimation of the daily minimum flows during the high flow season is found to be considerably reduced and the daily skewness is also better replicated in comparison to the other variations in case of log transformed daily streamflows variation i even though the maximum and the standard deviation of the daily flows are slightly overestimated the daily mean flows are well reproduced it is observed that the model in which the normal distribution is fitted to the standardized flow variates fig 6 row 4 performs equivalently or better than the other three variations in terms of reproducing the mean the standard deviation and the maximum daily flows moreover this variation exhibits better preservation of long memory dependence as could be typically seen for october month low flow month in fig 7 herein it is to be mentioned that owing to the semi parametric nature of the proposed model even the simple normal distribution fitted to the standardized flows without any normalizing transformation is able to reproduce most of the distributional features of the observed flows including the maximum flows furthermore the preservation of the water use validation statistics is found to be better for this model when compared with the three variations considered supplementary material fig s4 hence from here on the detailed results are presented and discussed only for the mctmc model coupled to a normal distribution which is fitted to the standardized daily flows and is referred to as the hybrid mctmc model in the remaining part of the paper fig 8 compares the observed and the synthetic daily streamflow summary statistics for the white river it could be seen that the mean the standard deviation std the maximum max and the median statistics are well simulated in the synthetic sequences while the minimum min is found to be overestimated during the high flow period april july the pattern of reproduction of the daily streamflow summary statistics is similar in case of the other two sites also as could be seen from fig s5 supplementary material fig 9 shows the preservation of the daily skewness and kurtosis in the three sites it could be seen that the general pattern of daily skewness and kurtosis are reproduced in the synthetic sequences however the higher values are not captured the relative bias in percentage in standard deviation of the daily streamflows are 6 7 2 1 and 4 3 for the white river the little snake river and the san juan river respectively fig 10 shows the monthly autocorrelation structure for 25 lags computed from the observed black scatter and the simulated cyan band streamflow sequences at white river it could be seen that the autocorrelation coefficients for the first few lags 5 lags are well replicated in the synthetic sequences for all the months also for the high flow months the correlation coefficients are well preserved throughout however in the low flow months certain amount of bias is experienced at higher lags appropriate state classification simultaneous modelling of state occurrences and their respective durations followed by resampling and reshuffling of the generated flow magnitudes have enabled satisfactory preservation of the monthly autocorrelation structure the preservation of monthly autocorrelation structure is similar in case of the other two stations also refer supplementary fig s6 fig s7 fig 11 shows the empirical cumulative distribution function ecdf of the streamflow amounts in each state s1 s10 computed using the weibull plotting position formula for the white river from which it is seen that the distributional characteristics of the daily streamflow amounts contained in the higher states are satisfactorily preserved however the state 1 s1 and lower magnitudes of state 2 s2 experience slight under estimation the ecdfs at the other two sites also exhibit a similar kind of preservation not shown herein for brevity the suitability of the proposed model was examined at aggregated time levels also fig 12 shows the summary statistics of the aggregated monthly streamflows for the white river it can be seen that the mean flows are well preserved whereas the standard deviation and the maximum statistics are slightly underestimated in all the months the relative bias in the mean of the aggregated monthly flows ranges between 0 for august month and 5 for february month while that in the standard deviation ranges between 4 in march to 18 in september except for 34 in february the minimum aggregated monthly flows are significantly overestimated in the high flow months and slightly deviant in the rest of the months further the reproduction of summary statistics for a sample day 15th day in every month for all the three sites are presented in supplementary material fig s8 the mean flows are well reproduced with sufficient variability while the standard deviation and the maximum values are reasonably modelled in the synthetic simulation for most of the months fig 13 shows that the proposed model effectively preserves the ecdfs of the aggregated monthly flows of the white river in all the months and also produces enough variability around and beyond the observed values which would be useful in evaluating risk reliability in water resources planning and design applications this can be ascribed to the generation of the flow magnitudes using an appropriate normal distribution fitted for the respective state in addition significant number of flows are generated in the gaps between the observed values in all the months thus providing adequate smoothing value the preservation patterns are quite similar for the other two rivers as well refer supplementary fig s9 fig s10 table 6 presents the comparison of the summary statistics of flows at the aggregated annual level for the three sites for the synthetic flow sequences mean and standard deviation of the ensemble of the same are presented it is to be mentioned that the mean flows are well preserved with a relative bias in percent of 1 5 1 9 and 1 1 for the white river the little snake river and the san juan river respectively while the standard deviation of the same are underestimated with a relative bias of 33 14 and 21 percentages further it may be noted from table 6 that the maximum flows are underestimated while the minimum flows are overestimated in all the three rivers however the skewness of the aggregated annual streamflows is well reproduced in case of all the three sites fig b2 in appendix b shows the ecdf of the annual mean daily streamflows constructed from observed and synthetic streamflow sequences using the weibull plotting position formula chow et al 1988 it is seen that the annual mean daily flows in the medium and the high flow ranges are well captured for the little snake river and the san juan river while in case of the white river the high flows are underestimated and the low flows are overestimated 4 4 preservation of water use statistics the synthetic sequences generated using the hybrid mctmc model are evaluated for the preservation of the water use statistics namely flow duration annual maxima low flow index 7q10 and duration of wet dry spells flow duration curves have found profound applications in the areas of water quality management hydropower instream flow requirements and river and reservoir sedimentation vogel and fennessey 1995 the row 1 of fig 14 shows the flow duration curve fdc derived from the observed and the simulated sequences for the three sites the ensemble of simulated fdcs is in good agreement with the observed fdc in all the three sites further the suitability of the synthetic sequence to be used for design applications is evaluated based on its ability to reproduce the empirical probabilities of annual maximum daily streamflow series it may be observed from fig 14 row 2 that the ecdf of the observed annual maximum flows are well preserved in the synthetic simulations and hence the same could be used in applications regarding the design of hydraulic structures preservation of the fdc and the annual maximums can be attributed to the reproduction of the distributional characteristics according to the united states environmental protection agency epa the design low flow index 7q10 is defined as the lowest 7 day average flow that occurs once in 10 years on an average the 7q10 flow index is widely used to set the minimum discharge limits and the preservation of it is useful in the ecological applications you et al 2014 it may be observed from fig 14 row 3 that the 7q10 index is well preserved in the synthetic simulations the preservation of the low flow index could be ascribed to the appropriate state classification and the reproduction of the states and their respective holding times in addition to the preservation of the daily autocorrelation structure for the first 10 lags in the low flow months the complex and dynamic nature of the rainfall runoff process can be visualized from the seasonal and annual variability in the wet and dry spells eighty percent of the monthly mean daily flow is used as the threshold to separate wet and dry flows the spread of the durations of the wet and dry spells estimated from the observed o as well as 10 representative simulated sequences ss are presented in fig 15 for all the three sites from which it is clear that the median and the spread of the wet dry spells are satisfactorily reproduced this is due to the appropriate resampling of state holding time use of appropriate parametric distribution for generation and the resampling reshuffling operation 4 5 performance comparison with the hybrid model of brunner et al 2019 the single site daily streamflow generation model of brunner et al 2019 is chosen for comparison with the hybrid mctmc model due to the following reasons i it is a flexible hybrid model that couples the phase randomization non parametric approach to generate a time dependence structure with the flexible 4 parameter kappa distribution parametric component for random generation ii it is a continuous time simulation model iii it is one of the latest daily streamflow generation models proposed that has a good simulation performance they have provided a function prsim in the r package https cran r project org web packages prsim index html for the synthetic generation of daily streamflows the observed daily streamflow data from 1981 to 2018 at one of the stations nehalem river near foss oregon usgs 14301000 in the pacific northwest given in brunner and gilleland 2020 is considered herein for performance comparison between the hybrid mctmc model and the single site model of brunner et al 2019 referred to as prsm from here on the mean flow pattern at this site is different from the three sites for which the results were presented earlier fig 16 shows the mean the standard deviation std the maximum max and the minimum min daily flow statistics estimated from the synthetic sequences simulated using the proposed model and the prsm it could be seen that the mean and the standard deviation of the daily streamflows are well preserved by both the models however the proposed model slightly underestimates the maximum and shows high variability in case of minimum flows while the prsm significantly overestimates the minimum daily flows moreover the proposed model is able to perform better in capturing the complex pattern of the daily autocorrelation function at the site especially at higher lags fig c1 appendix c further the models were tested for their efficacy in reproducing the flow statistics at the aggregated levels fig 17 shows the mean and the standard deviation of the aggregated monthly streamflows from the proposed model and the prsm although both the models satisfactorily preserve the mean aggregated monthly streamflows the proposed model shows better variability also the standard deviation of the aggregated monthly flows is better captured by the proposed model both the models are found to overestimate the monthly minimum flows fig c2 appendix c shows that the proposed model performs better in reproducing the summary statistics at the aggregated annual level the ecdfs presented in fig 18 show that the hybrid mctmc is able to model the features of the annual maximum and the annual mean flows better than prsm moreover the models are tested for their suitability in reproducing the fdc fig 19 row 1 and the low flow index fig 19 row 2 it may be noted from fig 19 row 1 that the variability in the synthetic flows is very less for the prsm but the proposed model gives a consistent band around the observed flows on the other hand prsm overestimates the extreme unobserved flows at low exceedance probability levels also the prsm is seen to underestimate the low flow index 7q10 while the hybrid mctmc model performs better 4 6 ideas towards building a regional hybrid mctmc model a plausible approach to regionalize the hybrid mctmc model and transfer of information from the gauged stations to the ungauged station for synthetic generation of the daily streamflows at the ungauged station is presented here and is underway synthetic daily streamflow generation at an ungauged station target station ts using hybrid mctmc model requires model parameters to be appropriately transferred from the gauged stations source stations ss to the ts all the stations preferably belonging to the same homogeneous region the hybrid mctmc model parameters that need to be transferred are the transition probabilities initial embedded end of month state sojourn time and the theoretical distribution parameters the first step towards estimating the model parameters is to identify the flow states in order to ensure uniformity across the source stations and facilitate transferability of information to the ts the flow values corresponding to a range of return periods are pre selected as the class state divisions the flow magnitudes for the above return periods which are the state divisions in the ts could be obtained from a regional flow frequency curve developed using a regional frequency analysis procedure the state divisions of the ts and the streamflow sequences of the source stations are normalized using a flow value index value corresponding to a return period higher than the pre selected ones now that in the non dimensional plane the flow variates in all the stations vary between zero and one and the same number of states exist across all sites in the region transferring information in terms of parameters from the gauged sites to the ungauged site becomes possible for the pooled non dimensional flow data corresponding to each state an appropriate distribution can be fitted which will form the parametric part of the regional mctmc model the initial the embedded and the end of the month transition probabilities are then empirically computed for each month for the ss the weighted average of the state transition probabilities computed from the source stations for a given month is presumed to reasonably represent the respective month s state transition probabilities at the ts the weightage assigned to the ss is computed as inversely proportional to the square of the respective distance from the ts or an appropriate distance measure computed from the significant physical characteristics next the state holding times sojourn times are empirically estimated for all the states and for all source stations while sampling the state holding time during the synthetic generation and further for the resampling reshuffling operation at the target site ts one of the source stations is selected through a probability picking based on the weightage assigned to them and the state holding time of the respective state sampled from the selected ss is considered to be the state holding time at the ts having obtained the hybrid mctmc parameters the non dimensional daily flow variates at the target site are generated and are transformed to the original flow domain using the index flow value a detailed description is provided in the supplementary material s11 5 summary and conclusions the novelty of the present research work arises from the identification and the conceptualization of using the ctmc model for daily streamflow simulation and introducing the non homogeneity and the history dependence features appropriately to model the asymmetry of the daily streamflow hydrograph and the seasonality this is achieved by means of introducing the monthly varying embedded state transition probabilities non homogeneity calculated based on a common multiple state classification of flows for the entire year with a view to account for the monthly within year variation of flows and their state transitions so that the rising and falling nature of the daily streamflows is continuously modelled in addition the state sojourn times are modelled through a probability based resampling from the historical observations conditioned on the preceding state history dependence and the month of occurrence non homogeneity moreover the continuity across months is preserved by empirically sampling from the month end transition probability matrix once the occurrence sequences are continuously generated by the modified ctmc model the amounts are generated from a suitable parametric distribution fitted for the respective state and arranged in each state for a duration as per the sampled state holding time the above arrangement of the generated random variates will be done by reshuffling based on the ranks of the resampled historical daily streamflow amounts within that state by this hybridization unobserved daily streamflow amounts as well as values beyond the observed extremes are generated the structure of the proposed model framework is flexible to accommodate the following variations i skewed observed daily flows could be used directly or transformed flow variates could be used option for using standardized or transformed and standardized flow variates are also available ii depending on the range and the nature of the flow variates transformed or otherwise the number of states and the state divisions could be varied iii alternate parametric distributions could be coupled with the continuous time markov chain to improve the performance of the hybrid mctmc model iv the flow variates in different states could be fitted to different distributions and or different conditional resampling schemes could be employed for sampling the holding times the proposed model has been applied to the daily streamflows measured at three individual sites located in the upper colorado river basin the proposed model mimics the observed streamflow hydrograph pattern well and is capable of producing events beyond the observed extremes the ensemble of daily streamflow sequences generated model the uncertainty associated with daily streamflows moreover the model is found to replicate the various summary statistics at the daily time scale and also preserve the long term and short term dependence the reproduction of basic summary statistics at the aggregated monthly level is found to be satisfactory in addition the model successfully preserves the state wise distributional pattern at the daily level as well as the monthly aggregated level the efficacy of the model in reproducing the annual maximum flows validates its use for risk based design of hydro systems the preservation of the flow duration curve enables the estimation of the uncertainty associated with the release to the run of the river hydropower plant to ensure the reliability in energy production the ability of the proposed model in reproducing the low flow index validates its capability in handling the uncertainty associated with environmental flow requirements at the reservoir level the model captures the duration of wet dry spells satisfactorily which enables the assessment of the variability in critical drought durations the comparison of the results obtained from the hybrid mctmc model with that of brunner et al 2019 reveals the competence of the proposed model further the applicability of the proposed model has been tested at some more sites with different daily flow hydrograph patterns and varying dependence structure and found to be performing well the number of states and the state classification have a significant effect on the simulation performance of the proposed model in the present study the classification has been done based on a few trials there is scope for optimizing the division of number of classes states and the corresponding intervals moreover the model has a tendency to overestimate the minimum flows also it does not preserve the serial correlations at the aggregated monthly level since it is not tailored to do so the flows exhibit higher relative dispersion at the aggregated annual level it is to be mentioned that even though the model requires estimation of many parameters the computation involved are simple arithmetic calculations the hybrid mctmc model is capable of producing alternate stochastic series and gives representative extension of the historic sequence however the model is not designed to capture the non stationarity in the daily flows the extension of the proposed model to capture non stationarity in daily streamflows may require the transition probabilities to be modified for instance using a fourier polynomial spirkl and ries 1986 and the modification of the location and or scale parameters of the probability distribution adopted in the parametric part the potential of the proposed structure of the hybrid mctmc model in modelling the hourly streamflow hydrographs is to be tested and is underway the model may be used to simulate other geophysical time series like temperature and solar radiation that display seasonal effects and possess long memory in their dependence the proposed single site hybrid modified continuous time markov model can be easily extended to the regional context so that the regional level information can be transferred through the parameters of the regional model to stations where data are not available at daily scale and to ungauged sites to enable the generation of daily streamflows at those sites the crux of the preliminary ideas towards building a regional level hybrid mctmc model is also presented further the extension of the proposed model to the multi site daily streamflow modelling is to be explored credit authorship contribution statement l s shilpa conceptualization methodology software validation formal analysis investigation data curation writing original draft k srinivasan supervision writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to express their sincere gratitude to indian institute of technology madras chennai india for providing the facilities required to carry out the research work the first author is thankful for the fellowship provided by the ministry of human resources and development government of india during the course of the research work we are thankful to the associate editor one of the reviewers simon michael papalexiou and the other anonymous reviewer for their comments and suggestions on the earlier version of this manuscript which has helped to improve the overall quality presentation and organization of the paper appendix a appendix b appendix c appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128206 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 
3129,simulating water infiltration in unsaturated soils is an important step in analyzing a wide range of engineering and geosciences applications the infiltration problem inherently possesses a coupled hydro mechanical problem in which the unsaturated flow and the soil deformation interact and affect each other this hydro mechanical coupling however has been ignored in the majority of existing analytical solutions mainly due to the complexity associated with the mathematical derivation this paper presents a novel analytical solution for coupled hydro mechanical modeling of one dimensional vertical infiltration in unsaturated soils we present an analytical solution for two problems where infiltration is applied at the top boundary as a constant pressure head first problem or as a constant flow rate second problem a parametric study was performed to examine the effects of hydro mechanical coupling and various soil parameters on pressure head and strain profiles versus depth results reveal that the coupling effect can be pronounced for various values of saturated hydraulic conductivity gardner s α parameter and young s modulus the solution can be readily incorporated into site specific e g groundwater modeling slope stability or regional scale e g landslide mapping analyses of unsaturated natural and man made slopes and earthen structures subject to infiltration further the presented analytical framework offers a benchmark for the validation of numerical methods keywords unsaturated soil infiltration hydro mechanical coupling analytical solution groundwater modeling vadose zone 1 introduction water infiltration in saturated and unsaturated soils is of particular interest in different fields such as hydrogeology hydrology engineering geology geotechnical engineering and civil engineering for instance infiltration induced changes in pore water pressure or suction can degrade key engineering attributes e g shear strength compressibility of soils which in turn can adversely affect the stability and integrity of man made and natural slopes and earthen structures rainfall triggered landslides in natural slopes are reported to pose multi billion dollars of losses and several deaths in the united states and other parts of the world annually larsen 2008 gariano and guzzetti 2016 forensic studies suggest that several rainfall induced failures happened when slopes and earthen structures were not fully saturated and still undergoing different levels of saturation e g lu and godt 2008 godt et al 2012 kim and borden 2013 leshchinsky et al 2015 yang et al 2019 the latter highlights the importance of accurately modeling infiltration in unsaturated soils an aspect that can become even more important as climate change is projected to worsen the intensity and frequency of heavy precipitations in several areas ipcc 2013 robinson et al 2017 vahedifard et al 2016a 2018 jasim et al 2017 ragno et al 2018 several attempts have been made in the literature to develop analytical solutions for infiltration in unsaturated soils analytical solutions offer an attractive means due to their versatility relatively easy integration into other analyses of unsaturated soils and application as a benchmark for validating more complex numerical methods while the solution by green and ampt 1911 can be arguably credited as the first analytical solution the majority of existing analytical solutions e g srivastava and yeh 1991 warrick 2003 hogarth and parlange 2000 chen et al 2001 tracy 1995 2006 2007 hooshyar and wang 2016 baiamonte 2020 are developed by solving richards equation richards 1931 as the governing equation to represent fluid flow in unsaturated soils these analytical solutions have been extensively incorporated into the modeling of infiltration in various engineering applications including slope stability e g lu and godt 2008 godt et al 2012 vahedifard et al 2016b lateral earth pressure vahedifard et al 2015 shahrokhabadi et al 2019 abdollahi et al 2021 abdollahi and vahedifard 2021 bearing capacity vahedifard and robinson 2016 and regional scale landslide mapping baum et al 2008 infiltration into unsaturated soils inherently involves a coupled hydro mechanical phenomenon where the pore water pressure or suction and the soil deformation interact and affect each other this hydro mechanical coupling is commonly accounted for when modeling unsaturated infiltration using numerical methods such as the finite element method e g leshchinsky et al 2015 robinson et al 2017 vahedifard et al 2017 vahedifard et al 2020 the hydro mechanical coupling however has been ignored in the majority of existing analytical solutions e g srivastava and yeh 1991 warrick 2003 hogarth and parlange 2000 chen et al 2001 tracy 1995 2006 2007 hooshyar and wang 2016 baiamonte 2020 mainly due to complexity associated with the mathematical derivation limited studies e g wu and zhang 2009 wu et al 2013 wu et al 2020 have presented analytical solutions for coupled unsaturated infiltration based on the independent stress state variables approach the aforementioned solutions however involve rather complex mathematical procedures which make their verification difficult and prohibit their widespread application further they do not explicitly consider the effect of water content or suction on elastic moduli this study aims to develop a practical yet sound analytical solution for coupled hydro mechanical modeling of infiltration in unsaturated soils we present solutions using the proposed analytical framework for two problems in which the infiltration is applied at the top of a one dimensional 1 d soil column as a constant pressure head first problem or as a constant flow rate second problem the presented analytical solution is then employed in a set of parametric studies to examine the effects of hydro mechanical coupling and various soil parameters starting with a base set of soil parameters a comparison of coupled and uncoupled results is performed finally the analytical solution was used as a tool to develop and implement iterative procedures for allowing young s modulus and bishop s effective stress parameter to vary as a function of the pressure head which has not been done in previous studies 2 modeling setup and assumptions fig 1 schematically illustrates the geometry soil parameters and boundary conditions of the one dimensional infiltration used in our derivation two problems are considered in which infiltration is applied at the top of the column with the first problem being pressure head h h top 0 and the second problem of the infiltration being a constant flow rate q q again applied at the top in fig 1 h represents the pressure head q denotes the infiltration rate γ is the unit weight of soil υ is poisson s ratio se is the effective degree of saturation defined using an exponential soil water retention curve swrc model k is the hydraulic conductivity of soil linked to the saturated hydraulic conductivity ks through an exponential hydraulic conductivity function hcf m is a fitting parameter e is young s modulus of soil es and ed represent young s modulus of soil at saturated and dry conditions respectively we employed a set of conventions and assumptions in deriving the analytical solution the assumptions were made to facilitate the derivation of an analytical solution as done in similar analytical derivations yet reasonably represent actual conditions our assumptions include a the problem is one dimensional in which the head and strain only change in the vertical direction b the soil is treated as a homogeneous isotropic and elastic material undergoing small strains c the compressibility of water and solid grains is neglected d the volume change of the soil is only due to infiltration and no volume change due to total stress changes is considered e the saturated hydraulic conductivity does not change with soil deformation f the effects of hydraulic hysteresis and temperature are not considered g the pore air pressure is assumed to be equal to the atmospheric pressure and is set to zero and h the unit weight of soil is constant it is noted that these assumptions are comparable with those made in alternative analytical solutions e g wu and zhang 2009 wu et al 2013 wu et al 2020 adapted from green and ampt 1911 the modeling domain includes a vertical column of homogenous isotropic elastic soil with a length of l the origin z 0 is set at the bottom of the column and is positive upward fig 1 the soil is initially saturated at z 0 as the initial water level is at and below z 0 and hydrostatic conditions of constant total head equal zero are assumed following gardner 1958 we use exponential functions to represent swrc and hcf using the gardner exponential functions for the hcf and swrc enables us to linearize richards equation warrick 1974 after applying the weight of the soil no further external stresses are considered also young s modulus e and poisson s ratio υ representing elastic stress strain are considered constant in the analytical solution however the analytical solution is used in a separate numerical iterative procedure to account for young s modulus being a function of the pressure head 3 general stress strain and flow equations 3 1 stress strain equations 3 1 1 effective stress consider a 3 d block of soil where x is to the right y is outward from the vertical x z plane and z is up fig 2 using bishop s effective stress principle bishop 1959 with compressive stress being positive the effective stress tensor in the cartesian coordinate system can be obtained as 1 σ x σ y σ z σ x u a 0 0 0 σ y u a 0 0 0 σ z u a χ u a u w 0 0 0 χ u a u w 0 0 0 χ u a u w where σ x σ y and σ z normal effective stress in x y and z directions respectively σ x σ y and σ z normal total stress in x y and z directions respectively positive stresses are compressive χ bishop s effective stress parameter u a pore air pressure u w pore water pressure γ w h with γ w unit weight of water and h pressure head assuming u a 0 a common assumption setting the pore air pressure equal to the atmospheric pressure and using the pressure head the effective stress tensor becomes 2 σ x σ y σ z σ x 0 0 0 σ y 0 0 0 σ z χ γ w h 0 0 0 χ γ w h 0 0 0 χ γ w h 3 1 2 strain using hooke s law to establish stress strain relations for a linear elastic element we have 3 x y z 1 e 1 υ υ υ 1 υ υ υ 1 σ x σ y σ z where x y and z strains in the x y and z directions respectively positive strains lead to a decrease in the sample size eq 3 can also be written as 4 σ x σ y σ z e 1 υ 1 2 υ 1 υ υ υ υ 1 υ υ υ υ 1 υ x y z leading to 5 σ x σ y σ z χ γ w h 1 1 1 e 1 υ 1 2 υ 1 υ υ υ υ 1 υ υ υ υ 1 υ x y z 3 1 3 one dimensional equation the 1 d problem for which the analytical solution is presented assumes x y 0 thus eq 5 is reduced to 6 σ z χ γ w h e 1 υ 1 υ 1 2 υ z the problem is formulated for the case where no external stress is applied because the soil is unsaturated and the pressure head is less than zero there is no standing water to apply weight thus no external stress is applied in the problem beyond the initial weight of the soil the following equation can be used 7 z χ γ w 1 υ 1 2 υ e 1 υ h 3 2 bishop s effective stress parameter several studies have shown that bishop s effective stress parameter χ can be represented using the effective degree of saturation se as bolzon et al 1996 lu et al 2010 8 χ s e where 9 s e θ θ d θ s θ d where θ volumetric water content θ d residual water content θ s saturated water content 3 3 young s modulus in unsaturated soils young s modulus is shown to be a function of water content or degree of saturation adopted from the model proposed by lu and kaya 2014 we use the following model for young s modulus 10 e e d e s e d s e m 3 4 porosity the change in porosity n or saturated water content θ s with respect to time t is given by 11 n t θ s t ε x t ε y t ε z t a detailed derivation of eq 11 is provided in appendix a of the supplementary information the 1 d version of eq 11 combined with eq 7 for given constants h χ h χ and e h e is given by 12 θ s t χ γ w 1 υ 1 2 υ e 1 υ h t eq 12 will be used in deriving the analytical solution a numerical iterative solution is also used where for a given time t and z 1 for the initial iteration k 0 use the values of χ 1 and e e s and solve for h 0 for nonlinear iteration k 1 2 set h h k and update χ and e 3 compute the new analytical solution h k 1 4 increment k k 1 and repeat steps 2 3 5 continue the loop until h k h k 1 it is important to distinguish between the initial conditions at time t 0 and at any other time at t 0 h z however at any other time h is unknown so the above iterative process is arbitrarily started at saturated flow conditions 3 5 unsaturated flow equation conservation of mass yields 13 x k h x y k h y z k h z 1 θ t where k hydraulic conductivity which can be defined as 14 k k r k s where k s saturated hydraulic conductivity k r relative hydraulic conductivity as a function of h 0 k r 1 we assumed an isotropic saturated hydraulic conductivity using eq 14 along with eq 9 gives 15 k s x k r h x k s y k r h y k s z k r h z 1 s e θ s t θ s θ r s e t the 1 d version of eq 15 when combined with eq 12 yields 16 k s z k r h z 1 s e χ γ w 1 υ 1 2 υ e 1 υ h t θ s θ r s e t in the proposed analytical solution similar to the gardner 1958 model the following hcf and swrc models are used 17 k h e α h k s 18 s e h e α h where α a fitting parameter the effect of hydraulic hysteresis can be considered by adjusting the α parameter one can determine the swrc fitting parameters for the main drying path using experimental tests and then use them with empirical correlations to estimate the wetting swrc parameters likos et al 2014 substituting eqs 17 and 18 into eq 16 leads to the equation to be solved for the analytical solution as follows 19 z e α h h z 1 1 k s χ γ w 1 υ 1 2 υ e 1 υ α θ s θ r e α h h t 4 problem 1 modeling infiltration as an applied constant head at the top 4 1 initial and boundary conditions the groundwater level is initially at z 0 implying that the total head is ϕ 0 throughout the column fig 1 this gives for initial conditions 20 h z 0 z when the water at the top is applied the boundary conditions are 21 h 0 t 0 22 h l t h top where h top constant pressure head at z l 4 2 derivation of analytical solution this section provides a brief discussion of the derivation of the analytical solution further details are provided in appendix b of the supplementary information 4 2 1 first change of variables eq 19 is a nonlinear partial differential equation pde the first challenge is to convert this equation into a linear pde this is done by the following change of variables 23 h e α h e α z this results in 24 2 h z 2 α h z c h t where c is defined as 25 c 1 k s χ γ w 1 ν 1 2 ν e 1 ν α θ s θ r the initial condition for eq 24 is 26 h 0 the lower and top boundary conditions for eq 24 are 27 h 0 t 0 28 h l t e α h top e α l 4 2 2 steady state solution the governing pde for the steady state solution is 29 2 h ss z 2 α h ss z 0 the general solution is 30 h ss a 1 e m 1 z a 2 e m 2 z where a 1 and a 2 constants evaluated from boundary conditions the steady state solution is 31 h ss e α h top e α l 1 e α z 1 e α l an alternate form that will be used here is 32 h ss e α h top e α l e α 2 l z sinh α 2 z sinh α 2 l 4 2 3 second change of variables to solve eq 24 a second change of variables is used as 33 h h h ss that yields 34 2 h z 2 α h z c h t with initial conditions 35 h z 0 h ss and boundary conditions 36 h 0 t 0 37 h l t 0 4 2 4 separation of variables a common way to solve eq 34 is to use the separation of variables this is done by assuming a solution in the form of 38 h z t ξ z ψ t defining 39 λ k π k l k 0 1 2 and 40 μ k 1 c α 2 4 λ k 2 the final solution for h is 41 h 2 e α h top e α l l e α 2 l z k 1 1 k λ k α 2 4 λ k 2 sin λ k z e μ k t going back to the original variable the solution is 42 h h h ss 43 h 1 α ln h e α z 4 3 uncoupled solution the uncoupled solution is the same as the coupled solution except that the pressure head is considered independent of stress and strain for the uncoupled solution c can be obtained by deleting the first term in the parenthesis of eq 25 as 44 c α k s θ s θ r 4 4 results for problem 1 the proposed analytical solution is used in a set of parametric studies to examine the effects of hydro mechanical coupling and various soil parameters the following parameters are used for the base model l 10 m h top 5 m γ w 9 8 k n m 3 e d 10 000 k p a e s 1 000 k p a ν 0 4 θ r 0 θ s 0 4 m 1 k s 1 10 6 m s e c and α 0 001 m 1 the base model parameters are mostly adopted from those used by wu and zhang 2009 for similar parametric study purposes the parameters for the young s modulus model e d e s and m are adopted from lu and kaya 2014 the parametric study is motivated to link the analytical solution to the physical behavior of unsaturated soil that is it is aimed to examine the effect of hydro mechanical coupling as well as key constitutive parameters representing the physical behavior of soil on the calculated results in the first step we examined under what conditions for what soil types and to what extent the hydro mechanical coupling matters this will provide insight into when using a coupled solution is really needed and can make a difference in the next step we aimed to investigate the sensitivity of results to variations in soil stiffness represented by e d e s and m and hydraulic proprieties represented by k s and α the parametric study can assist in further understanding the relative importance of different variables for each set of parametric study only one parameter of interest is varied in the base model and the rest of the parameters are kept constant 4 4 1 coupling effect fig 3 a compares the pressure head profiles obtained from the coupled versus uncoupled solutions for the base model at times of 0 01 0 05 0 1 and 0 5 day as seen the calculated pressure heads are significantly different between the coupled and uncoupled solutions both the coupled and uncoupled solutions should go toward the steady state solution as time increases fig 3b depicts the strain profiles from the coupled solution as noted before there is no external load applied and the strain solely depends on the value of the pressure head through eq 7 since the pressure heads at the top and bottom are constant and imposed as boundary conditions the strains at the top and bottom remain constant as well when a constant flow is applied to the top boundary problem 2 the pressure head on the boundary changes with time so the strain will also change in this case the latter can more realistically represent an infiltration problem under field conditions in fig 3a the question is why the steady state solution looks like a straight line from eqs 31 and 43 the steady state solution is given by 45 h ss 1 α ln h ss e α z 1 α ln e α h top e α l 1 e α z 1 e α l e α z this is a rather complicated expression but looks like a straight line this can be explained by considering the taylor s series approximation 46 e α z 1 α z 1 2 α z 2 1 0 001 z 0 000001 z 2 1 0 001 z only two terms are needed because α is small so eq 45 is approximated by 47 h ss 1 α ln 1 α h top 1 α l z l 1 α z 1 α ln 1 α h top α l z l α z a further taylor s series approximation is used as follows 48 ln 1 1 2 2 eq 45 is finally approximated by 49 h ss 1 α α h top α l z l α z h top l z l z this is a straight line where h 0 at z 0 and h h top at z l which is shown in fig 3a the next question is why the pressure heads from the uncoupled solution are different from the coupled ones physically the difference can be attributed to the fact that the uncoupled solution does not consider the effect of stresses and strains in the solution of the pressure head this change from the coupled to uncoupled can be visualized by the plot of relative change in pressure head r as 50 r h u h c h c 100 as depicted in fig 4 the pressure heads obtained from the coupled and uncoupled solutions are clearly significantly different up to over 40 this difference can be explained by looking at the difference in the terms in c as defined in eqs 25 and 44 the uncoupled term being considered is 51 t u α θ s θ r the coupled term is 52 t c t u χ γ w 1 ν 1 2 ν e 1 ν the relative change percentage from the coupled to uncoupled analysis is given by 53 p t u t c t c table 1 presents values for t u t c and p at different times at z 5 m the values for the uncoupled analysis are more than 90 less than those of the coupled analysis so it would be expected that the results to be different also the values are almost the same for different times next we answer why the uncoupled results go faster toward steady state than do the coupled values first consider the time dependent term s in the solution as given by 54 s k 1 1 k λ k α 2 4 λ k 2 sin λ k z e μ k t table 2 provides values of s μ 1 and μ 2 at z 5 m at different times here we see that values of s for the uncoupled analysis are much smaller than those of the coupled analysis the smaller s is the closer a given solution is to steady state in fact for the uncoupled analysis at time 0 5 day s is so small that the transient solution is almost identical to the steady state solution further the reason why s is smaller for the uncoupled solution can be seen by the values of μ k table 2 shows these values for the first two values of μ k where the uncoupled values are much larger than the coupled values this would make the term e μ k t much smaller for the uncoupled analysis 4 4 2 effect of ks fig 5 illustrates pressure head fig 5a and strain fig 5b profiles for k s 1 10 5 1 10 6 a n d 1 10 7 m s e c at t 0 01 and 0 5 day in fig 5a we see that smaller values of k s take longer to achieve steady state this can be explained by examining μ k as given in eq 55 below which is determined from eqs 25 and 40 55 μ k 1 c α 2 4 λ k 2 k s χ γ w 1 ν 1 2 ν e 1 ν α θ s θ r α 2 4 λ k 2 where we observe that μ k has k s in the numerator with all the other variables remaining the same this shows that μ k is larger as k s is larger and thus goes quicker to steady state as k s becomes larger as shown in eq 7 strain is not explicitly changed when changing k s so the strain profiles shown in fig 5b are implicitly affected by changes in the pressure head trends shown in fig 5a at a given time increasing k s can lead to the development of larger strains this can be attributed to the effect of k s on the pressure head which controls the strain magnitude 4 4 3 effect of α to examine the effect of α fig 6 shows pressure head fig 6a and strain fig 6b profiles for α 0 001 0 01 and 0 1 1 m at t 0 01 and 0 5 day we observe that the larger α is the slower pressure heads vary from initial conditions the α parameter is in the solution in a very complex way but these results show a consistent trend as shown in fig 6b varying α causes a notable effect on strain profiles since α affects both stiffness through e and effective stress through χ and the swrc strain significantly changes by varying α for the same pressure head 4 4 4 effect of ed fig 7 depicts pressure head fig 7a and strain fig 7b profiles for varying e d the results are shown for e d 5 000 10 000 and 20 000 kpa from rewriting eq 10 and setting m 1 as its beginning value 56 e 1 s e e d e s s e in this case very little change occurred when e d was varied as seen in table 3 showing values of s e the pressure head does not vary with different e d because s e 1 in all cases making e e s see eq 56 similarly fig 7b shows that varying e d has minimal impacts on strain profiles 4 4 5 effect of es fig 8 delineates the effects of e s on pressure head fig 8a and strain fig 8b profiles the results are presented for e s 500 1 000 and 2 000 kpa at t 0 01 and 0 5 day as e s decreases the pressure head reaches to the steady state condition slower from eq 55 μ k becomes smaller as e s decreases from the previous discussion this explains the observed trends the pervious discussion showed that varying e s has a significant effect on the value of e as reflected in eq 7 strain at the top as well as interior in the domain is explicitly affected by both values of e and h keeping all other parameters constant the strain profiles in fig 8b are significantly changed with changing e s 4 4 6 effect of m the impact of m on pressure head and strain head profiles are illustrated in fig 9 a and 9b respectively the results are plotted for m 0 5 1 and 1 5 at t 0 01 and 0 5 day almost no change in pressure head and strain head profiles occurred by varying m table 4 presents values of s e m for z 5 m for different m and different times showing very little difference in the s e m values thus e and therefore pressure head and strain vary little as m changes 5 problem 2 modeling a constant infiltration flow rate applied at the top boundary the only difference between this problem and the first problem is that a constant flow rate q is applied for an indefinite period of time at z l this flow v f is computed by darcy s law 57 v f k z k s e α h h z z k s e α h h z 1 let s define r as 58 r q k s e α h z l h z z l 1 5 1 steady state solution the equation to be solved from eq 19 is 59 d dz e α h ss d h ss dz 1 0 using the following same change of variables as before 60 h e α h e α z gives the steady state equation as before 61 d h ss d z 2 α d h ss dz 0 5 1 1 boundary conditions for h s s at z 0 h ss 0 at z l 62 r e α h z l d h ss dz z l 1 1 α d h ss dz z l e α l h ss z l e α l 1 α d h ss dz z l h ss z l 5 1 2 steady state solution the solution to eq 61 as before is 63 h ss a 1 a 2 e α z applying the boundary conditions gives 64 h ss r 1 e α z the final steady state solution is 65 h ss 1 α ln h ss e α z 1 α ln r 1 e α z e α z as before with small values of α this solution is approximated by a straight line as shown below 66 h ss 1 α ln r α z 1 α z r 1 z 5 2 transient solution the methods used to solve problem 1 do not work for this problem rather than search for a complicated and different fourier series solution a much simpler solution is used first we use an iterative procedure to find h top for a given t and r and then use the solution for problem 1 so r is approximated using eq 58 by 67 r e α 2 h top h l h top h l 1 the regula falsi galdino 2011 algorithm using eq 67 is given in fig 10 the idea of the algorithm is to establish two values of h top with the first being h top h t o p 1 and the second being h top h t o p 2 l the steps are as follows 1 set h top h t o p 1 2 compute h l from the analytical solution 3 compute r 1 from eq 67 4 set h top h t o p 2 l 5 compute h l from the analytical solution 6 compute r 2 from eq 67 7 using the straight line h t o p 1 r 1 h t o p 2 r 2 compute a new h top from eq 68 8 compute h l from the analytical solution 9 compute r test from eq 67 10 if r test r set r 2 r test and h t o p 2 h top then return to step 7 11 if r test r set r 1 r test and h t o p 1 h top then return to step 7 12 the algorithm ends because r test r 68 h top h t o p 2 h t o p 1 r 2 r 1 r r 1 h t o p 1 for problem 2 only two iterations were needed for all the times and ratios considered fig 11 depicts pressure head profiles for r 0 9 and fig 12 gives results for r 0 5 for the base model both coupled and uncoupled solutions are given from the results we see that the search algorithm in fig 10 works well and the difference in coupled and uncoupled results are the same as that observed previously in problem 1 this can be further seen in figs 13 and 14 by using eq 50 for the relative change in pressure head r these plots show that the percentages are again large 6 conclusions this paper presented an analytical framework for modeling one dimensional infiltration in unsaturated soils we used this developed analytical solution for two problems in which infiltration was represented as a constant pressure head or a constant flow applied at the top boundary the analytical solution is straightforward and needs only a few input parameters all related to soil physical properties and can be readily obtained using laboratory testing or from the literature the first study where an initial or base set of soil parameters was used to compare coupled versus uncoupled analyses showed a significant difference between coupled and uncoupled results parametric studies using the coupled analytical solution showed noticeable differences when varying saturated hydraulic conductivity gardner s α parameter and young s modulus at saturated conditions the presented analytical framework offers a benchmark for the validation of numerical methods further the solution can be readily incorporated into site specific e g groundwater modeling slope stability lateral earth pressure bearing capacity or regional scale e g landslide mapping analyses of unsaturated natural and man made slopes and earthen structures subject to infiltration this was successfully illustrated in this work by using the presented analytical solution where constant pressure head at the top was specified to iteratively solve the problem where constant flow at the top was set also using the analytical solution as a function to iteratively allow young s modulus and bishop s effective stress parameter to vary as a function of pressure head was successfully accomplished an aspect overlooked in most analytical solutions credit authorship contribution statement fred t tracy conceptualization methodology formal analysis visualization writing original draft farshid vahedifard conceptualization methodology writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128198 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3129,simulating water infiltration in unsaturated soils is an important step in analyzing a wide range of engineering and geosciences applications the infiltration problem inherently possesses a coupled hydro mechanical problem in which the unsaturated flow and the soil deformation interact and affect each other this hydro mechanical coupling however has been ignored in the majority of existing analytical solutions mainly due to the complexity associated with the mathematical derivation this paper presents a novel analytical solution for coupled hydro mechanical modeling of one dimensional vertical infiltration in unsaturated soils we present an analytical solution for two problems where infiltration is applied at the top boundary as a constant pressure head first problem or as a constant flow rate second problem a parametric study was performed to examine the effects of hydro mechanical coupling and various soil parameters on pressure head and strain profiles versus depth results reveal that the coupling effect can be pronounced for various values of saturated hydraulic conductivity gardner s α parameter and young s modulus the solution can be readily incorporated into site specific e g groundwater modeling slope stability or regional scale e g landslide mapping analyses of unsaturated natural and man made slopes and earthen structures subject to infiltration further the presented analytical framework offers a benchmark for the validation of numerical methods keywords unsaturated soil infiltration hydro mechanical coupling analytical solution groundwater modeling vadose zone 1 introduction water infiltration in saturated and unsaturated soils is of particular interest in different fields such as hydrogeology hydrology engineering geology geotechnical engineering and civil engineering for instance infiltration induced changes in pore water pressure or suction can degrade key engineering attributes e g shear strength compressibility of soils which in turn can adversely affect the stability and integrity of man made and natural slopes and earthen structures rainfall triggered landslides in natural slopes are reported to pose multi billion dollars of losses and several deaths in the united states and other parts of the world annually larsen 2008 gariano and guzzetti 2016 forensic studies suggest that several rainfall induced failures happened when slopes and earthen structures were not fully saturated and still undergoing different levels of saturation e g lu and godt 2008 godt et al 2012 kim and borden 2013 leshchinsky et al 2015 yang et al 2019 the latter highlights the importance of accurately modeling infiltration in unsaturated soils an aspect that can become even more important as climate change is projected to worsen the intensity and frequency of heavy precipitations in several areas ipcc 2013 robinson et al 2017 vahedifard et al 2016a 2018 jasim et al 2017 ragno et al 2018 several attempts have been made in the literature to develop analytical solutions for infiltration in unsaturated soils analytical solutions offer an attractive means due to their versatility relatively easy integration into other analyses of unsaturated soils and application as a benchmark for validating more complex numerical methods while the solution by green and ampt 1911 can be arguably credited as the first analytical solution the majority of existing analytical solutions e g srivastava and yeh 1991 warrick 2003 hogarth and parlange 2000 chen et al 2001 tracy 1995 2006 2007 hooshyar and wang 2016 baiamonte 2020 are developed by solving richards equation richards 1931 as the governing equation to represent fluid flow in unsaturated soils these analytical solutions have been extensively incorporated into the modeling of infiltration in various engineering applications including slope stability e g lu and godt 2008 godt et al 2012 vahedifard et al 2016b lateral earth pressure vahedifard et al 2015 shahrokhabadi et al 2019 abdollahi et al 2021 abdollahi and vahedifard 2021 bearing capacity vahedifard and robinson 2016 and regional scale landslide mapping baum et al 2008 infiltration into unsaturated soils inherently involves a coupled hydro mechanical phenomenon where the pore water pressure or suction and the soil deformation interact and affect each other this hydro mechanical coupling is commonly accounted for when modeling unsaturated infiltration using numerical methods such as the finite element method e g leshchinsky et al 2015 robinson et al 2017 vahedifard et al 2017 vahedifard et al 2020 the hydro mechanical coupling however has been ignored in the majority of existing analytical solutions e g srivastava and yeh 1991 warrick 2003 hogarth and parlange 2000 chen et al 2001 tracy 1995 2006 2007 hooshyar and wang 2016 baiamonte 2020 mainly due to complexity associated with the mathematical derivation limited studies e g wu and zhang 2009 wu et al 2013 wu et al 2020 have presented analytical solutions for coupled unsaturated infiltration based on the independent stress state variables approach the aforementioned solutions however involve rather complex mathematical procedures which make their verification difficult and prohibit their widespread application further they do not explicitly consider the effect of water content or suction on elastic moduli this study aims to develop a practical yet sound analytical solution for coupled hydro mechanical modeling of infiltration in unsaturated soils we present solutions using the proposed analytical framework for two problems in which the infiltration is applied at the top of a one dimensional 1 d soil column as a constant pressure head first problem or as a constant flow rate second problem the presented analytical solution is then employed in a set of parametric studies to examine the effects of hydro mechanical coupling and various soil parameters starting with a base set of soil parameters a comparison of coupled and uncoupled results is performed finally the analytical solution was used as a tool to develop and implement iterative procedures for allowing young s modulus and bishop s effective stress parameter to vary as a function of the pressure head which has not been done in previous studies 2 modeling setup and assumptions fig 1 schematically illustrates the geometry soil parameters and boundary conditions of the one dimensional infiltration used in our derivation two problems are considered in which infiltration is applied at the top of the column with the first problem being pressure head h h top 0 and the second problem of the infiltration being a constant flow rate q q again applied at the top in fig 1 h represents the pressure head q denotes the infiltration rate γ is the unit weight of soil υ is poisson s ratio se is the effective degree of saturation defined using an exponential soil water retention curve swrc model k is the hydraulic conductivity of soil linked to the saturated hydraulic conductivity ks through an exponential hydraulic conductivity function hcf m is a fitting parameter e is young s modulus of soil es and ed represent young s modulus of soil at saturated and dry conditions respectively we employed a set of conventions and assumptions in deriving the analytical solution the assumptions were made to facilitate the derivation of an analytical solution as done in similar analytical derivations yet reasonably represent actual conditions our assumptions include a the problem is one dimensional in which the head and strain only change in the vertical direction b the soil is treated as a homogeneous isotropic and elastic material undergoing small strains c the compressibility of water and solid grains is neglected d the volume change of the soil is only due to infiltration and no volume change due to total stress changes is considered e the saturated hydraulic conductivity does not change with soil deformation f the effects of hydraulic hysteresis and temperature are not considered g the pore air pressure is assumed to be equal to the atmospheric pressure and is set to zero and h the unit weight of soil is constant it is noted that these assumptions are comparable with those made in alternative analytical solutions e g wu and zhang 2009 wu et al 2013 wu et al 2020 adapted from green and ampt 1911 the modeling domain includes a vertical column of homogenous isotropic elastic soil with a length of l the origin z 0 is set at the bottom of the column and is positive upward fig 1 the soil is initially saturated at z 0 as the initial water level is at and below z 0 and hydrostatic conditions of constant total head equal zero are assumed following gardner 1958 we use exponential functions to represent swrc and hcf using the gardner exponential functions for the hcf and swrc enables us to linearize richards equation warrick 1974 after applying the weight of the soil no further external stresses are considered also young s modulus e and poisson s ratio υ representing elastic stress strain are considered constant in the analytical solution however the analytical solution is used in a separate numerical iterative procedure to account for young s modulus being a function of the pressure head 3 general stress strain and flow equations 3 1 stress strain equations 3 1 1 effective stress consider a 3 d block of soil where x is to the right y is outward from the vertical x z plane and z is up fig 2 using bishop s effective stress principle bishop 1959 with compressive stress being positive the effective stress tensor in the cartesian coordinate system can be obtained as 1 σ x σ y σ z σ x u a 0 0 0 σ y u a 0 0 0 σ z u a χ u a u w 0 0 0 χ u a u w 0 0 0 χ u a u w where σ x σ y and σ z normal effective stress in x y and z directions respectively σ x σ y and σ z normal total stress in x y and z directions respectively positive stresses are compressive χ bishop s effective stress parameter u a pore air pressure u w pore water pressure γ w h with γ w unit weight of water and h pressure head assuming u a 0 a common assumption setting the pore air pressure equal to the atmospheric pressure and using the pressure head the effective stress tensor becomes 2 σ x σ y σ z σ x 0 0 0 σ y 0 0 0 σ z χ γ w h 0 0 0 χ γ w h 0 0 0 χ γ w h 3 1 2 strain using hooke s law to establish stress strain relations for a linear elastic element we have 3 x y z 1 e 1 υ υ υ 1 υ υ υ 1 σ x σ y σ z where x y and z strains in the x y and z directions respectively positive strains lead to a decrease in the sample size eq 3 can also be written as 4 σ x σ y σ z e 1 υ 1 2 υ 1 υ υ υ υ 1 υ υ υ υ 1 υ x y z leading to 5 σ x σ y σ z χ γ w h 1 1 1 e 1 υ 1 2 υ 1 υ υ υ υ 1 υ υ υ υ 1 υ x y z 3 1 3 one dimensional equation the 1 d problem for which the analytical solution is presented assumes x y 0 thus eq 5 is reduced to 6 σ z χ γ w h e 1 υ 1 υ 1 2 υ z the problem is formulated for the case where no external stress is applied because the soil is unsaturated and the pressure head is less than zero there is no standing water to apply weight thus no external stress is applied in the problem beyond the initial weight of the soil the following equation can be used 7 z χ γ w 1 υ 1 2 υ e 1 υ h 3 2 bishop s effective stress parameter several studies have shown that bishop s effective stress parameter χ can be represented using the effective degree of saturation se as bolzon et al 1996 lu et al 2010 8 χ s e where 9 s e θ θ d θ s θ d where θ volumetric water content θ d residual water content θ s saturated water content 3 3 young s modulus in unsaturated soils young s modulus is shown to be a function of water content or degree of saturation adopted from the model proposed by lu and kaya 2014 we use the following model for young s modulus 10 e e d e s e d s e m 3 4 porosity the change in porosity n or saturated water content θ s with respect to time t is given by 11 n t θ s t ε x t ε y t ε z t a detailed derivation of eq 11 is provided in appendix a of the supplementary information the 1 d version of eq 11 combined with eq 7 for given constants h χ h χ and e h e is given by 12 θ s t χ γ w 1 υ 1 2 υ e 1 υ h t eq 12 will be used in deriving the analytical solution a numerical iterative solution is also used where for a given time t and z 1 for the initial iteration k 0 use the values of χ 1 and e e s and solve for h 0 for nonlinear iteration k 1 2 set h h k and update χ and e 3 compute the new analytical solution h k 1 4 increment k k 1 and repeat steps 2 3 5 continue the loop until h k h k 1 it is important to distinguish between the initial conditions at time t 0 and at any other time at t 0 h z however at any other time h is unknown so the above iterative process is arbitrarily started at saturated flow conditions 3 5 unsaturated flow equation conservation of mass yields 13 x k h x y k h y z k h z 1 θ t where k hydraulic conductivity which can be defined as 14 k k r k s where k s saturated hydraulic conductivity k r relative hydraulic conductivity as a function of h 0 k r 1 we assumed an isotropic saturated hydraulic conductivity using eq 14 along with eq 9 gives 15 k s x k r h x k s y k r h y k s z k r h z 1 s e θ s t θ s θ r s e t the 1 d version of eq 15 when combined with eq 12 yields 16 k s z k r h z 1 s e χ γ w 1 υ 1 2 υ e 1 υ h t θ s θ r s e t in the proposed analytical solution similar to the gardner 1958 model the following hcf and swrc models are used 17 k h e α h k s 18 s e h e α h where α a fitting parameter the effect of hydraulic hysteresis can be considered by adjusting the α parameter one can determine the swrc fitting parameters for the main drying path using experimental tests and then use them with empirical correlations to estimate the wetting swrc parameters likos et al 2014 substituting eqs 17 and 18 into eq 16 leads to the equation to be solved for the analytical solution as follows 19 z e α h h z 1 1 k s χ γ w 1 υ 1 2 υ e 1 υ α θ s θ r e α h h t 4 problem 1 modeling infiltration as an applied constant head at the top 4 1 initial and boundary conditions the groundwater level is initially at z 0 implying that the total head is ϕ 0 throughout the column fig 1 this gives for initial conditions 20 h z 0 z when the water at the top is applied the boundary conditions are 21 h 0 t 0 22 h l t h top where h top constant pressure head at z l 4 2 derivation of analytical solution this section provides a brief discussion of the derivation of the analytical solution further details are provided in appendix b of the supplementary information 4 2 1 first change of variables eq 19 is a nonlinear partial differential equation pde the first challenge is to convert this equation into a linear pde this is done by the following change of variables 23 h e α h e α z this results in 24 2 h z 2 α h z c h t where c is defined as 25 c 1 k s χ γ w 1 ν 1 2 ν e 1 ν α θ s θ r the initial condition for eq 24 is 26 h 0 the lower and top boundary conditions for eq 24 are 27 h 0 t 0 28 h l t e α h top e α l 4 2 2 steady state solution the governing pde for the steady state solution is 29 2 h ss z 2 α h ss z 0 the general solution is 30 h ss a 1 e m 1 z a 2 e m 2 z where a 1 and a 2 constants evaluated from boundary conditions the steady state solution is 31 h ss e α h top e α l 1 e α z 1 e α l an alternate form that will be used here is 32 h ss e α h top e α l e α 2 l z sinh α 2 z sinh α 2 l 4 2 3 second change of variables to solve eq 24 a second change of variables is used as 33 h h h ss that yields 34 2 h z 2 α h z c h t with initial conditions 35 h z 0 h ss and boundary conditions 36 h 0 t 0 37 h l t 0 4 2 4 separation of variables a common way to solve eq 34 is to use the separation of variables this is done by assuming a solution in the form of 38 h z t ξ z ψ t defining 39 λ k π k l k 0 1 2 and 40 μ k 1 c α 2 4 λ k 2 the final solution for h is 41 h 2 e α h top e α l l e α 2 l z k 1 1 k λ k α 2 4 λ k 2 sin λ k z e μ k t going back to the original variable the solution is 42 h h h ss 43 h 1 α ln h e α z 4 3 uncoupled solution the uncoupled solution is the same as the coupled solution except that the pressure head is considered independent of stress and strain for the uncoupled solution c can be obtained by deleting the first term in the parenthesis of eq 25 as 44 c α k s θ s θ r 4 4 results for problem 1 the proposed analytical solution is used in a set of parametric studies to examine the effects of hydro mechanical coupling and various soil parameters the following parameters are used for the base model l 10 m h top 5 m γ w 9 8 k n m 3 e d 10 000 k p a e s 1 000 k p a ν 0 4 θ r 0 θ s 0 4 m 1 k s 1 10 6 m s e c and α 0 001 m 1 the base model parameters are mostly adopted from those used by wu and zhang 2009 for similar parametric study purposes the parameters for the young s modulus model e d e s and m are adopted from lu and kaya 2014 the parametric study is motivated to link the analytical solution to the physical behavior of unsaturated soil that is it is aimed to examine the effect of hydro mechanical coupling as well as key constitutive parameters representing the physical behavior of soil on the calculated results in the first step we examined under what conditions for what soil types and to what extent the hydro mechanical coupling matters this will provide insight into when using a coupled solution is really needed and can make a difference in the next step we aimed to investigate the sensitivity of results to variations in soil stiffness represented by e d e s and m and hydraulic proprieties represented by k s and α the parametric study can assist in further understanding the relative importance of different variables for each set of parametric study only one parameter of interest is varied in the base model and the rest of the parameters are kept constant 4 4 1 coupling effect fig 3 a compares the pressure head profiles obtained from the coupled versus uncoupled solutions for the base model at times of 0 01 0 05 0 1 and 0 5 day as seen the calculated pressure heads are significantly different between the coupled and uncoupled solutions both the coupled and uncoupled solutions should go toward the steady state solution as time increases fig 3b depicts the strain profiles from the coupled solution as noted before there is no external load applied and the strain solely depends on the value of the pressure head through eq 7 since the pressure heads at the top and bottom are constant and imposed as boundary conditions the strains at the top and bottom remain constant as well when a constant flow is applied to the top boundary problem 2 the pressure head on the boundary changes with time so the strain will also change in this case the latter can more realistically represent an infiltration problem under field conditions in fig 3a the question is why the steady state solution looks like a straight line from eqs 31 and 43 the steady state solution is given by 45 h ss 1 α ln h ss e α z 1 α ln e α h top e α l 1 e α z 1 e α l e α z this is a rather complicated expression but looks like a straight line this can be explained by considering the taylor s series approximation 46 e α z 1 α z 1 2 α z 2 1 0 001 z 0 000001 z 2 1 0 001 z only two terms are needed because α is small so eq 45 is approximated by 47 h ss 1 α ln 1 α h top 1 α l z l 1 α z 1 α ln 1 α h top α l z l α z a further taylor s series approximation is used as follows 48 ln 1 1 2 2 eq 45 is finally approximated by 49 h ss 1 α α h top α l z l α z h top l z l z this is a straight line where h 0 at z 0 and h h top at z l which is shown in fig 3a the next question is why the pressure heads from the uncoupled solution are different from the coupled ones physically the difference can be attributed to the fact that the uncoupled solution does not consider the effect of stresses and strains in the solution of the pressure head this change from the coupled to uncoupled can be visualized by the plot of relative change in pressure head r as 50 r h u h c h c 100 as depicted in fig 4 the pressure heads obtained from the coupled and uncoupled solutions are clearly significantly different up to over 40 this difference can be explained by looking at the difference in the terms in c as defined in eqs 25 and 44 the uncoupled term being considered is 51 t u α θ s θ r the coupled term is 52 t c t u χ γ w 1 ν 1 2 ν e 1 ν the relative change percentage from the coupled to uncoupled analysis is given by 53 p t u t c t c table 1 presents values for t u t c and p at different times at z 5 m the values for the uncoupled analysis are more than 90 less than those of the coupled analysis so it would be expected that the results to be different also the values are almost the same for different times next we answer why the uncoupled results go faster toward steady state than do the coupled values first consider the time dependent term s in the solution as given by 54 s k 1 1 k λ k α 2 4 λ k 2 sin λ k z e μ k t table 2 provides values of s μ 1 and μ 2 at z 5 m at different times here we see that values of s for the uncoupled analysis are much smaller than those of the coupled analysis the smaller s is the closer a given solution is to steady state in fact for the uncoupled analysis at time 0 5 day s is so small that the transient solution is almost identical to the steady state solution further the reason why s is smaller for the uncoupled solution can be seen by the values of μ k table 2 shows these values for the first two values of μ k where the uncoupled values are much larger than the coupled values this would make the term e μ k t much smaller for the uncoupled analysis 4 4 2 effect of ks fig 5 illustrates pressure head fig 5a and strain fig 5b profiles for k s 1 10 5 1 10 6 a n d 1 10 7 m s e c at t 0 01 and 0 5 day in fig 5a we see that smaller values of k s take longer to achieve steady state this can be explained by examining μ k as given in eq 55 below which is determined from eqs 25 and 40 55 μ k 1 c α 2 4 λ k 2 k s χ γ w 1 ν 1 2 ν e 1 ν α θ s θ r α 2 4 λ k 2 where we observe that μ k has k s in the numerator with all the other variables remaining the same this shows that μ k is larger as k s is larger and thus goes quicker to steady state as k s becomes larger as shown in eq 7 strain is not explicitly changed when changing k s so the strain profiles shown in fig 5b are implicitly affected by changes in the pressure head trends shown in fig 5a at a given time increasing k s can lead to the development of larger strains this can be attributed to the effect of k s on the pressure head which controls the strain magnitude 4 4 3 effect of α to examine the effect of α fig 6 shows pressure head fig 6a and strain fig 6b profiles for α 0 001 0 01 and 0 1 1 m at t 0 01 and 0 5 day we observe that the larger α is the slower pressure heads vary from initial conditions the α parameter is in the solution in a very complex way but these results show a consistent trend as shown in fig 6b varying α causes a notable effect on strain profiles since α affects both stiffness through e and effective stress through χ and the swrc strain significantly changes by varying α for the same pressure head 4 4 4 effect of ed fig 7 depicts pressure head fig 7a and strain fig 7b profiles for varying e d the results are shown for e d 5 000 10 000 and 20 000 kpa from rewriting eq 10 and setting m 1 as its beginning value 56 e 1 s e e d e s s e in this case very little change occurred when e d was varied as seen in table 3 showing values of s e the pressure head does not vary with different e d because s e 1 in all cases making e e s see eq 56 similarly fig 7b shows that varying e d has minimal impacts on strain profiles 4 4 5 effect of es fig 8 delineates the effects of e s on pressure head fig 8a and strain fig 8b profiles the results are presented for e s 500 1 000 and 2 000 kpa at t 0 01 and 0 5 day as e s decreases the pressure head reaches to the steady state condition slower from eq 55 μ k becomes smaller as e s decreases from the previous discussion this explains the observed trends the pervious discussion showed that varying e s has a significant effect on the value of e as reflected in eq 7 strain at the top as well as interior in the domain is explicitly affected by both values of e and h keeping all other parameters constant the strain profiles in fig 8b are significantly changed with changing e s 4 4 6 effect of m the impact of m on pressure head and strain head profiles are illustrated in fig 9 a and 9b respectively the results are plotted for m 0 5 1 and 1 5 at t 0 01 and 0 5 day almost no change in pressure head and strain head profiles occurred by varying m table 4 presents values of s e m for z 5 m for different m and different times showing very little difference in the s e m values thus e and therefore pressure head and strain vary little as m changes 5 problem 2 modeling a constant infiltration flow rate applied at the top boundary the only difference between this problem and the first problem is that a constant flow rate q is applied for an indefinite period of time at z l this flow v f is computed by darcy s law 57 v f k z k s e α h h z z k s e α h h z 1 let s define r as 58 r q k s e α h z l h z z l 1 5 1 steady state solution the equation to be solved from eq 19 is 59 d dz e α h ss d h ss dz 1 0 using the following same change of variables as before 60 h e α h e α z gives the steady state equation as before 61 d h ss d z 2 α d h ss dz 0 5 1 1 boundary conditions for h s s at z 0 h ss 0 at z l 62 r e α h z l d h ss dz z l 1 1 α d h ss dz z l e α l h ss z l e α l 1 α d h ss dz z l h ss z l 5 1 2 steady state solution the solution to eq 61 as before is 63 h ss a 1 a 2 e α z applying the boundary conditions gives 64 h ss r 1 e α z the final steady state solution is 65 h ss 1 α ln h ss e α z 1 α ln r 1 e α z e α z as before with small values of α this solution is approximated by a straight line as shown below 66 h ss 1 α ln r α z 1 α z r 1 z 5 2 transient solution the methods used to solve problem 1 do not work for this problem rather than search for a complicated and different fourier series solution a much simpler solution is used first we use an iterative procedure to find h top for a given t and r and then use the solution for problem 1 so r is approximated using eq 58 by 67 r e α 2 h top h l h top h l 1 the regula falsi galdino 2011 algorithm using eq 67 is given in fig 10 the idea of the algorithm is to establish two values of h top with the first being h top h t o p 1 and the second being h top h t o p 2 l the steps are as follows 1 set h top h t o p 1 2 compute h l from the analytical solution 3 compute r 1 from eq 67 4 set h top h t o p 2 l 5 compute h l from the analytical solution 6 compute r 2 from eq 67 7 using the straight line h t o p 1 r 1 h t o p 2 r 2 compute a new h top from eq 68 8 compute h l from the analytical solution 9 compute r test from eq 67 10 if r test r set r 2 r test and h t o p 2 h top then return to step 7 11 if r test r set r 1 r test and h t o p 1 h top then return to step 7 12 the algorithm ends because r test r 68 h top h t o p 2 h t o p 1 r 2 r 1 r r 1 h t o p 1 for problem 2 only two iterations were needed for all the times and ratios considered fig 11 depicts pressure head profiles for r 0 9 and fig 12 gives results for r 0 5 for the base model both coupled and uncoupled solutions are given from the results we see that the search algorithm in fig 10 works well and the difference in coupled and uncoupled results are the same as that observed previously in problem 1 this can be further seen in figs 13 and 14 by using eq 50 for the relative change in pressure head r these plots show that the percentages are again large 6 conclusions this paper presented an analytical framework for modeling one dimensional infiltration in unsaturated soils we used this developed analytical solution for two problems in which infiltration was represented as a constant pressure head or a constant flow applied at the top boundary the analytical solution is straightforward and needs only a few input parameters all related to soil physical properties and can be readily obtained using laboratory testing or from the literature the first study where an initial or base set of soil parameters was used to compare coupled versus uncoupled analyses showed a significant difference between coupled and uncoupled results parametric studies using the coupled analytical solution showed noticeable differences when varying saturated hydraulic conductivity gardner s α parameter and young s modulus at saturated conditions the presented analytical framework offers a benchmark for the validation of numerical methods further the solution can be readily incorporated into site specific e g groundwater modeling slope stability lateral earth pressure bearing capacity or regional scale e g landslide mapping analyses of unsaturated natural and man made slopes and earthen structures subject to infiltration this was successfully illustrated in this work by using the presented analytical solution where constant pressure head at the top was specified to iteratively solve the problem where constant flow at the top was set also using the analytical solution as a function to iteratively allow young s modulus and bishop s effective stress parameter to vary as a function of pressure head was successfully accomplished an aspect overlooked in most analytical solutions credit authorship contribution statement fred t tracy conceptualization methodology formal analysis visualization writing original draft farshid vahedifard conceptualization methodology writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128198 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
