index,text
25545,the soil and water assessment tool swat is one of the most widely used and well tested eco hydrological models however parameter calibration sensitivity analysis and uncertainty analysis remain among the most challenging tasks existing swat parameter calibration sensitivity analysis and uncertainty analysis tools are either commercial products or free tools with limited options this study demonstrates an interactive graphical user interface tool in the r environment for swat parameter calibration sensitivity and uncertainty analyses and visualization called r swat different r functions packages for parameter calibration sensitivity analysis and uncertainty analysis have been incorporated into r swat third party packages can be integrated into r swat with minimum effort the application of r swat for a test case study demonstrates its functionalities in general r swat 1 is a potential platform for developing and testing new sensitivity or optimization packages and 2 promotes the understanding of hydrological processes with open source swat and r keywords graphical user interface model calibration parameter sensitivity uncertainty analysis r swat model software availability name of software r swat version v1 0 0 developer and contact address tam v nguyen tam nguyen ufz de department of hydrogeology helmholtz centre for environmental research ufz 04318 leipzig germany year available 2021 programming language r availability and cost the source code including links to tutorial videos and discussion group is freely available at https github com tamnva r swat 1 introduction hydrological models are a simplified representation of real world physical processes e g evapotranspiration surface and subsurface flows soil biogeochemical processes among others hydrological models assist scientists and engineers in managing water resources in the last few decades various models simulating different physical processes and levels of spatial detail have been developed ranging from lumped conceptual models to physically based distributed models some examples of these models are the génie rural à 4 paramètres journalier grj4 perrin et al 2003 the soil and water assessment tool swat arnold et al 1998 arnold et al 2012a the hydrological predictions for the environment model hype lindström et al 2010 the mesoscale hydrologic model mhm samaniego et al 2010 and hydrogeosphere hgs brunner and simmons 2011 hydrological models often have to be calibrated using a set of effective parameters skaggs et al 2012 to make sure that the models can represent the process of interest swat is one of the most widely used hydrological models and it is the most used water quality model fu et al 2019 swat has been applied to evaluate the impact of land use management practices on water sediments and nutrient yields at the catchment scale arnold et al 1998 arnold et al 2012b swat has been tested at various catchments worldwide arnold et al 2012b the number of published studies related to swat has increased drastically with more than 5000 papers to date https www card iastate edu swat articles accessed march 10 2022 five main reasons that explain the success of swat are 1 technical support via different platforms 2 accessibility to model input data at the global scale 3 user friendly gis based graphical user interface gui for model processing e g arcswat and qswat 4 free open source code with different community tools for input data preparation and post processing a list of these tools can be found at https swat tamu edu accessed march 10 2022 and 5 a well connected worldwide user community one of the challenges when working with swat is to perform parameter calibration sensitivity analysis and uncertainty analysis there could be up to thousands of swat parameters located in different files in ascii format neitsch et al 2011 to help swat users perform parameter calibration sensitivity analysis and uncertainty analysis swat cup abbaspour 2015 was introduced however swat cup is a commercial software and its free version is available for swat users with some restrictions e g on the maximum number of simulations and the parallel simulation options the source code of swat cup is not available so users cannot adapt the tool to their specific needs for example they cannot use objective functions or extract model outputs that are not defined in swat cup in addition to swat cup arcswat and swateditor https swat tamu edu software accessed march 10 2022 also offer options for running swat with a given list of modified parameter values however they do not contain any technique for automatic parameter calibration sensitivity analysis and uncertainty analysis in contrast several free or open source tools have been developed for either automatic or manual calibration parameter sensitivity and uncertainty analysis with swat bieger et al 2017 which is a completely restructured version of swat two examples of these tools are the swat toolbox chawanda 2021 and the integrated parameter estimation and uncertainty analysis tool plus ipeat yen et al 2019 developing such tools for swat is necessary considering the wide use of swat in recent years r r core team 2019 has emerged as a potential platform for developing open source packages for hydrological research slater et al 2019 various r packages exist for parameter calibration sensitivity analysis uncertainty analysis e g husmann et al 2017 iooss et al 2021 zambrano bigiarini and rojas 2020 and parallelization e g microsoft corporation and weston 2020 r core team 2019 in the field of hydrological science the r community is growing and now includes numerous packages for hydrological research https cran r project org web views hydrology html accessed march 10 2022 in addition different packages for visualization and creating gui are available in r such as ggplot2 wickham 2011 plotly chang et al 2021 and shiny packages chang et al 2021 which facilitate visual evaluation of model outputs the main advantage of r is that all packages are open source and free for the community therefore it would be beneficial to have a tool that connects swat with r several r packages or scripts were developed for swat the swatplusr package schürz 2019 was introduced for performing swat and swat simulations with provided parameters and returning model outputs swatplusr is well documented with a workflow and illustrative examples e g model calibration parameter sensitivity analysis and uncertainty analysis guillaume and andrews 2012 developed r scripts for swat parameter uncertainty analysis with the dream differential evolution adaptive metropolis package hartig et al 2019 the swatmodel package was created for running different swat versions swat2005 swat2009 and swat2012 on different operating systems and processor platforms with given parameter values fuka et al 2014 one of the advantages of these tools is that they are open source so users can further modify the source code for certain purposes however this requires a certain r knowledge level as well as knowledge of the provided source code therefore having a gui in addition to the open source code and various ready to use techniques for parameter calibration sensitivity analysis uncertainty analysis and visualization of the model outputs would benefit swat users of different levels beginners and experienced r users this will potentially promote hydrological research using swat and r reducing the technical barrier between swat and r this paper introduces a new free and open source r based tool called r swat with an interactive graphical user interface for swat parameter calibration sensitivity analysis uncertainty analysis and visualization of the swat outputs the proposed tool can be adapted to other models e g swat bieger et al 2017 hype lindström et al 2010 or mhm samaniego et al 2010 here swat was chosen as an example rather than the only possible hydrological model to couple with r 2 structure and functionalities of r swat to use r swat all swat input files in the txtinout folder must be created beforehand by external programs e g arcswat or qswat r swat provides functions for 1 updating swat input files 2 parameter sensitivity analysis 3 calibration and uncertainty analysis 4 parallelization 5 model output extraction and model performance evaluation and 6 visualization of the model results fig 1 details of these functions are described in the subsequent sections 2 1 updating swat parameters the number of swat parameters could be up to a thousand or more depending on the modeling area and the model setup this is because swat can be implemented as a distributed model with parameters that are defined at different spatial levels e g hydrological response unit hru subbasin and basin to modify swat parameter values knowledge of the input file and model structure is required swat inputs are in the ascii file format with various file extensions e g hru sub and bsn representing different spatial modelling units and or processes each file includes different parameters located in different lines with different number formats in addition new input files and new parameters can be introduced as swat is constantly being developed for specific purposes e g nguyen et al 2020 nguyen and dietrich 2018 therefore this study developed a general approach that allows modification of any parameter defined via the text file swatparam txt please see the supporting material r swat pdf this facilitates the use of r swat with any given swat version without reading modifying the r swat source code r swat modifies multiple parameters in a single file and saves the file only once instead of in sequence e g rewriting the same input file multiple times modifying only one parameter each time to reduce the writing time similar to swat cup abbaspour 2014 r swat uses three methods relative change equation 1 absolute change equation 2 and replace equation 3 for modifying swat parameters fig 2 1 p n e w p o r i g i n a l 1 x 2 p n e w p o r i g i n a l x 3 p n e w x where p n e w is the modified parameter value p o r i g i n a l is the original parameter value created during the model setup and x is the modified factor value 2 2 parameter sensitivity analysis the current r swat version uses the sensitivity r package iooss et al 2021 which provides different functions for factor screening and global sensitivity analysis with robustness analysis users need to type r functions from the sensitivity package in the user input box of r swat fig 2 to couple r swat with the sensitivity package we use keywords to pass functions and variables from r swat to functions of the sensitivity package user input box fig 2 for example 1 swat is the function that takes parameter values as inputs all user settings from the r swat interface were also passed to the swat function and returns objective function values 2 mincol and 3 maxcol are the vectors of minimum and maximum ranges of the selected parameters respectively and 4 nparam is the number of selected parameters fig 2 this option allows r swat to use different functions of the sensitivity packages examples of the available sensitivity approaches in the sensitivity package are given in table 1 while a complete list is given by iooss et al 2021 integrating new sensitivity packages into r swat only requires changing a single line in the r swat code as documented in the supporting material r swat pdf given the large number of parameters and the model runtime of swat computationally cheaper methods such as multiple start perturbation methods including the morris 1991 and delsa methods rakovec et al 2014 are often preferred nossent et al 2011 however a much larger range of methods could be envisaged to examine the sensitivities of swat for instance previous studies have showed that the application of computationally expensive methods such as the sobol 1993 method can also be feasible depending on the purpose of sensitivity analysis nossent et al 2011 sarrazin et al 2016 the choice of the sensitivity analysis approach is beyond the scope of this study we refer to pianosi et al 2016 for a review of the different available methods and their computational cost in addition the global sensitivity analysis method using multivariate linear regression with parameters generated from a uniform latin hypercube sampling e g sequential uncertainty fitting algorithm sufi 2 abbaspour et al 2004 was also added to r swat furthermore r swat provides an option for running swat with parameter sets generated by other sensitivity analysis tools by changing the option in the drop down box fig 2 then r swat returns the objective function values or the simulated values of the selected variables section 2 5 for further analysis this allows r swat to be coupled with other sensitivity analysis toolboxes that were written either in r or in other programming languages e g the sensitivity analysis for everybody safe pianosi et al 2015 2 3 parameter calibration or optimization parameter calibration is a process of adjusting model parameter values within their plausible ranges to minimize the differences between simulated and observed values there are various methods for parameter calibration arsenault et al 2014 and many of them have been implemented as r packages husmann et al 2017 mullen 2014 zambrano bigiarini and rojas 2020 r swat uses the hydropso zambrano bigiarini and rojas 2020 optimization husmann et al 2017 and nloptr ypma et al 2020 packages which were designed for the optimization of complex loss functions some examples of the calibration optimization approach with r swat are in table 2 integrating new optimization packages into r swat only requires changing a single line in the r swat code as documented in the supporting material r swat pdf in addition a similar approach to sufi 2 abbaspour et al 2004 and the dynamically dimensioned search algorithm dds tolson and shoemaker 2007 was included table 2 sufi 2 is often used for swat calibration and uncertainty analysis abbaspour et al 2017 arnold et al 2012 the dds approach has been proven to be more efficient than others arsenault et al 2014 a detailed description of the sufi 2 and dds approaches was presented elsewhere abbaspour 2014 tolson and shoemaker 2007 and different optimization approaches have also been covered in other publications arsenault et al 2014 khoi and thom 2015 wu and chen 2015 users could run swat with specific parameter sets e g for manual calibration local sensitivity analysis or re run the model with the optimal parameter set from an external file please see the supporting material r swat pdf 2 4 parallelization r swat executes swat in parallel to make use of available multi core processors to save the user time fig 3 parallel execution of swat is applied for the whole swat model instead of hru or subbasin level processing e g zhang et al 2021 because the latter option would require modification of the swat source code if all parameter sets are known at the beginning e g using the latin hypercube sampling lhs approach for parameter sensitivity and calibration the number of models run on each core is determined by the number of parameter sets divided by the number of cores e g swat cup abbaspour et al 2004 if the number of model runs is not a multiplier of the number of cores the remaining number of model runs is assigned to the last core in case the parameter sets are generated in sequence e g in the dds optimization approach the next parameter set is only generated if the model run is completed and evaluated with the previous parameter set and different parallelization options are proposed fig 4 as described below parallel option 1 dds is run in parallel on each core independently in other words there is no communication of the intermediate results among cores after all iterations e g 10 iterations as in fig 4 are completed the best parameter set is the one that gives the best objective function value among all cores parallel option 2 r swat evaluates the objective function and finds the best parameter set among all cores after each iteration this parameter set is assigned as an initial parameter set for all cores in the next run then the dds approach is used independently for each core to generate the next parameter set thus after all iterations the best parameter set is the one that gives the best objective function value the efficiency of these different parallel options could vary on a case by case basis and this needs to be investigated in future studies 2 5 output extraction model performance evaluation and uncertainty analysis r swat is flexible in terms of extracting model outputs after each model run for model performance evaluation users can extract model outputs from different swat output files fig 3 and evaluate the model performance using standard objective functions such as the nash sutcliffe efficiency nse nash and sutcliffe 1970 the kling gupta efficiency kge gupta et al 2009 absolute bias abias the root mean square error rmse moriasi et al 2007 and coefficient of determination r2 krause et al 2005 in addition there are options allowing users to define any model outputs and objective functions userreadswatoutput and userobjfunction a specific r script file with examples is provided for users as specified in the supporting material r swat pdf users can modify the script without having to read the entire code of r swat therefore evaluating the model performance at different spatial hru to basin and temporal e g daily to yearly scales is possible in case the swat model is modified and new output files are created this option can be used to extract model outputs from the new files to evaluate the model prediction uncertainty r swat uses the sufi 2 concept for all parameter calibration optimization approaches except the glue approach table 2 the objective of sufi 2 abbaspour et al 2004 is not to search for an optimal parameter set but instead to cover as much observed data as possible within the 95 percent prediction uncertainty 95ppu band with the 95ppu band being as small as possible the 95ppu band at 2 5 and 97 5 percentiles of the simulated results at every time step is calculated based on a given behavioral threshold value of the objective function defined by users the 95ppu is evaluated using the r factor the average thickness of the 95ppu band divided by the standard deviation of the measured data and the p factor the percentage of measured data bracketed by the 95ppu band abbaspour et al 2004 with the glue approach the simulated results are sorted according to their likelihood values and the 95ppu band is calculated with the sorted values beven and binley 1992 2 6 visualization interactive user interface and technical support we use visualization r packages such as ggplot2 wickham 2011 and plotly chang et al 2021 to facilitate the visual evaluation of model outputs the model outputs can be evaluated at different spatial e g hru subbasin or basin and temporal daily monthly or yearly scales this allows swat modelers to examine the model results potentially assisting in detecting spatial and temporal issues as well as helping to understand model behaviors users interact with r swat via an interactive gui created with the shiny package as shown in figs 2 3 and in the supporting material r swat pdf the user manual was included in the tool users can click on the help tooltip at each input item to see which input should be provided to become familiar with r swat tutorial videos and a discussion group were created where users could directly interact with others and developers 3 illustrative examples in this section we demonstrate specific functions of r swat e g parameter sensitivity and parameter calibration with specific approaches running r swat with other approaches are highlighted in the user manual https github com tamnva r swat wiki r swat user manual accessed march 25 2022 3 1 study area and data the study area 12 0 18 22 n 107 41 16 51 e is the dak nong river basin fig 5 located in the central highland region of vietnam the elevation of the study area ranges from 558 to 1344 m above the mean sea level forest frse and agricultural land agrl mainly coffee and commodity crops meyfroidt et al 2013 are the two dominant types of land use accounting for 56 6 and 43 3 of the study area respectively the main soil type is rhodic ferrasols with a red to dusky red b horizon the local climate is characterized by a tropical monsoon climate with distinct rainy april may to october and dry seasons ngo thanh et al 2018 as a result the study area s flow regime has high seasonality with 84 of the annual streamflow occurring in the rainy season the digital elevation model dem was obtained from the shuttle radar topography mission https dwtkns com srtm30m land use land cover was derived from landsat satellite images www usgs gov using the maximum likelihood classifier results of land use classification were qualitatively evaluated using google earth images the soil map was taken from the fao unesco global soil map http www fao org climate data daily precipitation air temperature and daily observed streamflow at the catchment outlet were provided by the viet nam meteorological and hydrological administration in this study daily observed streamflow data at the catchment outlet were used for evaluating the model performance parameter sensitivity analysis and calibration 3 2 parameter sensitivity analysis different parameters were selected to perform sensitivity analysis to demonstrate the ability of r swat in modifying different types of swat parameters table 3 the selected parameters are also the most commonly used for streamflow calibration arnold et al 2012b the parameter ranges were taken from literature arnold et al 2012a and our local knowledge of the study area sensitivity analysis was performed for the period 2000 2007 including two years 1998 1999 for warm up the nse for streamflow was used to measure model responses to changes in the model parameters in the sensitivity analysis the morris s elementary effects screening method campolongo et al 2007 iooss et al 2021 morris 1991 implemented in r swat was used for global parameter sensitivity analysis as an example 20 trajectories and 14 parameters were selected and consequently 300 simulations were performed for parameter sensitivity analysis results from the sensitivity analysis were used to select the six most sensitive parameters cn2 mgt ch n1 sub ch k2 rte ov n hru ch n2 rte and gw revap gw for model calibration fig 6 3 3 parameter calibration and uncertainty analysis for the model calibration demonstration we generated 1000 parameter sets using the uniform lhs approach that was implemented in r swat the nse for streamflow calculated for the period 2000 2007 was used to evaluate the model performance simulations with nse 0 65 were defined as behavioral resulting in a total of 52 simulations the characteristics of the behavioral parameter sets are presented in table 4 and the simulated streamflow at the catchment outlet is shown in fig 7 in general it can be said that the model was satisfactorily calibrated using r swat p factor 0 24 r factor 0 17 however visual inspection using the interactive plot option in r swat shows a clear mismatch between the simulated and observed streamflow series at shorter time scales and differences in flow magnitudes such as the underestimation of low flows fig 7b the overestimation of high flows fig 7c and the presence of high flows in the simulations which does not exist in the observed data fig 7d this could be due to uncertainties either in the observed data or in the model structure that would need further investigation 3 4 visualization of simulation results in this study the results from the best simulation were used to demonstrate the visualization functions of r swat spatial 2 d visualization of the model outputs was performed at the hru and subbasin level with swat outputs taken from the output hru and output sub files respectively fig 8 1 d visualization of the model outputs from output rch and watout dat files are in the supporting material r swat pdf 4 comparing r swat with swat cup to demonstrate the validity and effectiveness of r swat we used swat cup as a benchmark since swat cup was widely used and well tested specifically we compare several functions used in r swat version 1 0 0 with the corresponding functions used in swat cup version 5 2 1 1 the following aspects were compared between r swat and swat cup 1 the required time for updating swat input files 2 the simulated streamflow with updated swat input files 3 the results of parameter sensitivity analysis with the multivariate linear regression approach and 4 the calibrated streamflow statistics with three different calibration approaches sufi 2 pso and glue in all simulations below we used the swat project setup for the dak nong river basin and the model performance was evaluated if required using the nse for daily streamflow at the catchment outlet during the period 2000 2007 our results show that the required time for updating swat input files with a new parameter set table 3 with r swat is 0 10 s while that with swat cup is 0 52 s all simulations are performed with the same computer and with one core less time is required with r swat as it rewrites a file with all updated parameter values at once section 2 1 however swat cup rewrites a file multiple times depending on the number of updated parameters in that file to compare the calibrated streamflows with updated swat input files from r swat and swat cup we generated one random parameter set with the parameters reported in table 3 and used this parameter set for running both r swat and swat cup the simulated results e g discharge at the catchment outlet with the updated input files from r swat and swat cup are similar but not identical correlation r2 0 99994 fig 9 this is because r swat and swat cup use different standards for rounding of a 5 e g the rounded number of 0 185 with two decimal places in r swat and swat cup is 0 18 https stat ethz ch r manual r devel library base html round html accessed june 12 2022 and 0 19 respectively in addition when writing input files with the updated parameter values r swat uses the number of decimal places as defined in swat while swat cup mostly uses six decimal places a comparison between the updated files from r swat and the original files shows that r swat can correctly update swat input files with a given parameter set as demonstrated in the user manual to compare the results of parameter sensitivity analysis by the multivariate linear regression used in r swat and swat cup we generated 1000 parameter sets within their pre defined ranges table 3 with lhs and then run r swat and swat cup to calculate the objective function nse for streamflow at the catchment outlet results show that the parameter sensitivity ranking from r swat and swat cup are identical table 5 there are minor differences in the t stat and p value table 5 numbers in bold which could be due to round off and precision errors the comparison of the calibrated streamflow statistics best nse r factor and p factor with three different approaches sufi 2 glue and pso from r swat and swat cup was conducted by calibrating the swat model for streamflow the parameters subjected to calibration were given in table 3 and their ranges were defined in table 6 in each calibration approach the number of model runs is 1000 and the behavioral threshold is nse 0 65 results from r swat and swat cup are comparable and acceptable table 6 minor differences in the results are due to the randomness of the three approaches 5 outlook the primary purpose of r swat is to advance hydrological research with swat and r r swat is expected to rely not only on its original developers but also on its community for long term development currently we included some r functions packages into r swat incorporating new packages e g for parameter sensitivity and calibration will be straightforward since it only requires adding the package name to the r swat code see the supporting material r swat pdf therefore r swat is a flexible platform for developing and testing new parameter sensitivity and optimization packages with complex hydrological models swat future efforts to improve r swat could focus on the following aspects 1 enabling statistical analysis of the model results using existing r packages 2 expanding r swat for swat and 3 creating an r script for running r swat in high performance computing clusters without a graphical user interface author contributions t v n developed r swat and took the lead in writing the manuscript d a t and b v d collected the data and carried out the illustrative examples j d t d d f s k a and r s wrote and commented on the manuscript all authors discussed the results and contributed to the final manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the r swat users https groups google com g r swat and sushant mehan for feedback on the functionalities and visual interface of r swat during its initial release we thank the developers of swat and r packages that were used in this study special thanks are given to the editor the two anonymous reviewers and christoph schürz whose comments have helped to considerably improve the quality of the manuscript and the software we thank the members of the modeling and assessment of sustainable systems mass group at the university of south florida tampa for proofreading the article appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105497 
25545,the soil and water assessment tool swat is one of the most widely used and well tested eco hydrological models however parameter calibration sensitivity analysis and uncertainty analysis remain among the most challenging tasks existing swat parameter calibration sensitivity analysis and uncertainty analysis tools are either commercial products or free tools with limited options this study demonstrates an interactive graphical user interface tool in the r environment for swat parameter calibration sensitivity and uncertainty analyses and visualization called r swat different r functions packages for parameter calibration sensitivity analysis and uncertainty analysis have been incorporated into r swat third party packages can be integrated into r swat with minimum effort the application of r swat for a test case study demonstrates its functionalities in general r swat 1 is a potential platform for developing and testing new sensitivity or optimization packages and 2 promotes the understanding of hydrological processes with open source swat and r keywords graphical user interface model calibration parameter sensitivity uncertainty analysis r swat model software availability name of software r swat version v1 0 0 developer and contact address tam v nguyen tam nguyen ufz de department of hydrogeology helmholtz centre for environmental research ufz 04318 leipzig germany year available 2021 programming language r availability and cost the source code including links to tutorial videos and discussion group is freely available at https github com tamnva r swat 1 introduction hydrological models are a simplified representation of real world physical processes e g evapotranspiration surface and subsurface flows soil biogeochemical processes among others hydrological models assist scientists and engineers in managing water resources in the last few decades various models simulating different physical processes and levels of spatial detail have been developed ranging from lumped conceptual models to physically based distributed models some examples of these models are the génie rural à 4 paramètres journalier grj4 perrin et al 2003 the soil and water assessment tool swat arnold et al 1998 arnold et al 2012a the hydrological predictions for the environment model hype lindström et al 2010 the mesoscale hydrologic model mhm samaniego et al 2010 and hydrogeosphere hgs brunner and simmons 2011 hydrological models often have to be calibrated using a set of effective parameters skaggs et al 2012 to make sure that the models can represent the process of interest swat is one of the most widely used hydrological models and it is the most used water quality model fu et al 2019 swat has been applied to evaluate the impact of land use management practices on water sediments and nutrient yields at the catchment scale arnold et al 1998 arnold et al 2012b swat has been tested at various catchments worldwide arnold et al 2012b the number of published studies related to swat has increased drastically with more than 5000 papers to date https www card iastate edu swat articles accessed march 10 2022 five main reasons that explain the success of swat are 1 technical support via different platforms 2 accessibility to model input data at the global scale 3 user friendly gis based graphical user interface gui for model processing e g arcswat and qswat 4 free open source code with different community tools for input data preparation and post processing a list of these tools can be found at https swat tamu edu accessed march 10 2022 and 5 a well connected worldwide user community one of the challenges when working with swat is to perform parameter calibration sensitivity analysis and uncertainty analysis there could be up to thousands of swat parameters located in different files in ascii format neitsch et al 2011 to help swat users perform parameter calibration sensitivity analysis and uncertainty analysis swat cup abbaspour 2015 was introduced however swat cup is a commercial software and its free version is available for swat users with some restrictions e g on the maximum number of simulations and the parallel simulation options the source code of swat cup is not available so users cannot adapt the tool to their specific needs for example they cannot use objective functions or extract model outputs that are not defined in swat cup in addition to swat cup arcswat and swateditor https swat tamu edu software accessed march 10 2022 also offer options for running swat with a given list of modified parameter values however they do not contain any technique for automatic parameter calibration sensitivity analysis and uncertainty analysis in contrast several free or open source tools have been developed for either automatic or manual calibration parameter sensitivity and uncertainty analysis with swat bieger et al 2017 which is a completely restructured version of swat two examples of these tools are the swat toolbox chawanda 2021 and the integrated parameter estimation and uncertainty analysis tool plus ipeat yen et al 2019 developing such tools for swat is necessary considering the wide use of swat in recent years r r core team 2019 has emerged as a potential platform for developing open source packages for hydrological research slater et al 2019 various r packages exist for parameter calibration sensitivity analysis uncertainty analysis e g husmann et al 2017 iooss et al 2021 zambrano bigiarini and rojas 2020 and parallelization e g microsoft corporation and weston 2020 r core team 2019 in the field of hydrological science the r community is growing and now includes numerous packages for hydrological research https cran r project org web views hydrology html accessed march 10 2022 in addition different packages for visualization and creating gui are available in r such as ggplot2 wickham 2011 plotly chang et al 2021 and shiny packages chang et al 2021 which facilitate visual evaluation of model outputs the main advantage of r is that all packages are open source and free for the community therefore it would be beneficial to have a tool that connects swat with r several r packages or scripts were developed for swat the swatplusr package schürz 2019 was introduced for performing swat and swat simulations with provided parameters and returning model outputs swatplusr is well documented with a workflow and illustrative examples e g model calibration parameter sensitivity analysis and uncertainty analysis guillaume and andrews 2012 developed r scripts for swat parameter uncertainty analysis with the dream differential evolution adaptive metropolis package hartig et al 2019 the swatmodel package was created for running different swat versions swat2005 swat2009 and swat2012 on different operating systems and processor platforms with given parameter values fuka et al 2014 one of the advantages of these tools is that they are open source so users can further modify the source code for certain purposes however this requires a certain r knowledge level as well as knowledge of the provided source code therefore having a gui in addition to the open source code and various ready to use techniques for parameter calibration sensitivity analysis uncertainty analysis and visualization of the model outputs would benefit swat users of different levels beginners and experienced r users this will potentially promote hydrological research using swat and r reducing the technical barrier between swat and r this paper introduces a new free and open source r based tool called r swat with an interactive graphical user interface for swat parameter calibration sensitivity analysis uncertainty analysis and visualization of the swat outputs the proposed tool can be adapted to other models e g swat bieger et al 2017 hype lindström et al 2010 or mhm samaniego et al 2010 here swat was chosen as an example rather than the only possible hydrological model to couple with r 2 structure and functionalities of r swat to use r swat all swat input files in the txtinout folder must be created beforehand by external programs e g arcswat or qswat r swat provides functions for 1 updating swat input files 2 parameter sensitivity analysis 3 calibration and uncertainty analysis 4 parallelization 5 model output extraction and model performance evaluation and 6 visualization of the model results fig 1 details of these functions are described in the subsequent sections 2 1 updating swat parameters the number of swat parameters could be up to a thousand or more depending on the modeling area and the model setup this is because swat can be implemented as a distributed model with parameters that are defined at different spatial levels e g hydrological response unit hru subbasin and basin to modify swat parameter values knowledge of the input file and model structure is required swat inputs are in the ascii file format with various file extensions e g hru sub and bsn representing different spatial modelling units and or processes each file includes different parameters located in different lines with different number formats in addition new input files and new parameters can be introduced as swat is constantly being developed for specific purposes e g nguyen et al 2020 nguyen and dietrich 2018 therefore this study developed a general approach that allows modification of any parameter defined via the text file swatparam txt please see the supporting material r swat pdf this facilitates the use of r swat with any given swat version without reading modifying the r swat source code r swat modifies multiple parameters in a single file and saves the file only once instead of in sequence e g rewriting the same input file multiple times modifying only one parameter each time to reduce the writing time similar to swat cup abbaspour 2014 r swat uses three methods relative change equation 1 absolute change equation 2 and replace equation 3 for modifying swat parameters fig 2 1 p n e w p o r i g i n a l 1 x 2 p n e w p o r i g i n a l x 3 p n e w x where p n e w is the modified parameter value p o r i g i n a l is the original parameter value created during the model setup and x is the modified factor value 2 2 parameter sensitivity analysis the current r swat version uses the sensitivity r package iooss et al 2021 which provides different functions for factor screening and global sensitivity analysis with robustness analysis users need to type r functions from the sensitivity package in the user input box of r swat fig 2 to couple r swat with the sensitivity package we use keywords to pass functions and variables from r swat to functions of the sensitivity package user input box fig 2 for example 1 swat is the function that takes parameter values as inputs all user settings from the r swat interface were also passed to the swat function and returns objective function values 2 mincol and 3 maxcol are the vectors of minimum and maximum ranges of the selected parameters respectively and 4 nparam is the number of selected parameters fig 2 this option allows r swat to use different functions of the sensitivity packages examples of the available sensitivity approaches in the sensitivity package are given in table 1 while a complete list is given by iooss et al 2021 integrating new sensitivity packages into r swat only requires changing a single line in the r swat code as documented in the supporting material r swat pdf given the large number of parameters and the model runtime of swat computationally cheaper methods such as multiple start perturbation methods including the morris 1991 and delsa methods rakovec et al 2014 are often preferred nossent et al 2011 however a much larger range of methods could be envisaged to examine the sensitivities of swat for instance previous studies have showed that the application of computationally expensive methods such as the sobol 1993 method can also be feasible depending on the purpose of sensitivity analysis nossent et al 2011 sarrazin et al 2016 the choice of the sensitivity analysis approach is beyond the scope of this study we refer to pianosi et al 2016 for a review of the different available methods and their computational cost in addition the global sensitivity analysis method using multivariate linear regression with parameters generated from a uniform latin hypercube sampling e g sequential uncertainty fitting algorithm sufi 2 abbaspour et al 2004 was also added to r swat furthermore r swat provides an option for running swat with parameter sets generated by other sensitivity analysis tools by changing the option in the drop down box fig 2 then r swat returns the objective function values or the simulated values of the selected variables section 2 5 for further analysis this allows r swat to be coupled with other sensitivity analysis toolboxes that were written either in r or in other programming languages e g the sensitivity analysis for everybody safe pianosi et al 2015 2 3 parameter calibration or optimization parameter calibration is a process of adjusting model parameter values within their plausible ranges to minimize the differences between simulated and observed values there are various methods for parameter calibration arsenault et al 2014 and many of them have been implemented as r packages husmann et al 2017 mullen 2014 zambrano bigiarini and rojas 2020 r swat uses the hydropso zambrano bigiarini and rojas 2020 optimization husmann et al 2017 and nloptr ypma et al 2020 packages which were designed for the optimization of complex loss functions some examples of the calibration optimization approach with r swat are in table 2 integrating new optimization packages into r swat only requires changing a single line in the r swat code as documented in the supporting material r swat pdf in addition a similar approach to sufi 2 abbaspour et al 2004 and the dynamically dimensioned search algorithm dds tolson and shoemaker 2007 was included table 2 sufi 2 is often used for swat calibration and uncertainty analysis abbaspour et al 2017 arnold et al 2012 the dds approach has been proven to be more efficient than others arsenault et al 2014 a detailed description of the sufi 2 and dds approaches was presented elsewhere abbaspour 2014 tolson and shoemaker 2007 and different optimization approaches have also been covered in other publications arsenault et al 2014 khoi and thom 2015 wu and chen 2015 users could run swat with specific parameter sets e g for manual calibration local sensitivity analysis or re run the model with the optimal parameter set from an external file please see the supporting material r swat pdf 2 4 parallelization r swat executes swat in parallel to make use of available multi core processors to save the user time fig 3 parallel execution of swat is applied for the whole swat model instead of hru or subbasin level processing e g zhang et al 2021 because the latter option would require modification of the swat source code if all parameter sets are known at the beginning e g using the latin hypercube sampling lhs approach for parameter sensitivity and calibration the number of models run on each core is determined by the number of parameter sets divided by the number of cores e g swat cup abbaspour et al 2004 if the number of model runs is not a multiplier of the number of cores the remaining number of model runs is assigned to the last core in case the parameter sets are generated in sequence e g in the dds optimization approach the next parameter set is only generated if the model run is completed and evaluated with the previous parameter set and different parallelization options are proposed fig 4 as described below parallel option 1 dds is run in parallel on each core independently in other words there is no communication of the intermediate results among cores after all iterations e g 10 iterations as in fig 4 are completed the best parameter set is the one that gives the best objective function value among all cores parallel option 2 r swat evaluates the objective function and finds the best parameter set among all cores after each iteration this parameter set is assigned as an initial parameter set for all cores in the next run then the dds approach is used independently for each core to generate the next parameter set thus after all iterations the best parameter set is the one that gives the best objective function value the efficiency of these different parallel options could vary on a case by case basis and this needs to be investigated in future studies 2 5 output extraction model performance evaluation and uncertainty analysis r swat is flexible in terms of extracting model outputs after each model run for model performance evaluation users can extract model outputs from different swat output files fig 3 and evaluate the model performance using standard objective functions such as the nash sutcliffe efficiency nse nash and sutcliffe 1970 the kling gupta efficiency kge gupta et al 2009 absolute bias abias the root mean square error rmse moriasi et al 2007 and coefficient of determination r2 krause et al 2005 in addition there are options allowing users to define any model outputs and objective functions userreadswatoutput and userobjfunction a specific r script file with examples is provided for users as specified in the supporting material r swat pdf users can modify the script without having to read the entire code of r swat therefore evaluating the model performance at different spatial hru to basin and temporal e g daily to yearly scales is possible in case the swat model is modified and new output files are created this option can be used to extract model outputs from the new files to evaluate the model prediction uncertainty r swat uses the sufi 2 concept for all parameter calibration optimization approaches except the glue approach table 2 the objective of sufi 2 abbaspour et al 2004 is not to search for an optimal parameter set but instead to cover as much observed data as possible within the 95 percent prediction uncertainty 95ppu band with the 95ppu band being as small as possible the 95ppu band at 2 5 and 97 5 percentiles of the simulated results at every time step is calculated based on a given behavioral threshold value of the objective function defined by users the 95ppu is evaluated using the r factor the average thickness of the 95ppu band divided by the standard deviation of the measured data and the p factor the percentage of measured data bracketed by the 95ppu band abbaspour et al 2004 with the glue approach the simulated results are sorted according to their likelihood values and the 95ppu band is calculated with the sorted values beven and binley 1992 2 6 visualization interactive user interface and technical support we use visualization r packages such as ggplot2 wickham 2011 and plotly chang et al 2021 to facilitate the visual evaluation of model outputs the model outputs can be evaluated at different spatial e g hru subbasin or basin and temporal daily monthly or yearly scales this allows swat modelers to examine the model results potentially assisting in detecting spatial and temporal issues as well as helping to understand model behaviors users interact with r swat via an interactive gui created with the shiny package as shown in figs 2 3 and in the supporting material r swat pdf the user manual was included in the tool users can click on the help tooltip at each input item to see which input should be provided to become familiar with r swat tutorial videos and a discussion group were created where users could directly interact with others and developers 3 illustrative examples in this section we demonstrate specific functions of r swat e g parameter sensitivity and parameter calibration with specific approaches running r swat with other approaches are highlighted in the user manual https github com tamnva r swat wiki r swat user manual accessed march 25 2022 3 1 study area and data the study area 12 0 18 22 n 107 41 16 51 e is the dak nong river basin fig 5 located in the central highland region of vietnam the elevation of the study area ranges from 558 to 1344 m above the mean sea level forest frse and agricultural land agrl mainly coffee and commodity crops meyfroidt et al 2013 are the two dominant types of land use accounting for 56 6 and 43 3 of the study area respectively the main soil type is rhodic ferrasols with a red to dusky red b horizon the local climate is characterized by a tropical monsoon climate with distinct rainy april may to october and dry seasons ngo thanh et al 2018 as a result the study area s flow regime has high seasonality with 84 of the annual streamflow occurring in the rainy season the digital elevation model dem was obtained from the shuttle radar topography mission https dwtkns com srtm30m land use land cover was derived from landsat satellite images www usgs gov using the maximum likelihood classifier results of land use classification were qualitatively evaluated using google earth images the soil map was taken from the fao unesco global soil map http www fao org climate data daily precipitation air temperature and daily observed streamflow at the catchment outlet were provided by the viet nam meteorological and hydrological administration in this study daily observed streamflow data at the catchment outlet were used for evaluating the model performance parameter sensitivity analysis and calibration 3 2 parameter sensitivity analysis different parameters were selected to perform sensitivity analysis to demonstrate the ability of r swat in modifying different types of swat parameters table 3 the selected parameters are also the most commonly used for streamflow calibration arnold et al 2012b the parameter ranges were taken from literature arnold et al 2012a and our local knowledge of the study area sensitivity analysis was performed for the period 2000 2007 including two years 1998 1999 for warm up the nse for streamflow was used to measure model responses to changes in the model parameters in the sensitivity analysis the morris s elementary effects screening method campolongo et al 2007 iooss et al 2021 morris 1991 implemented in r swat was used for global parameter sensitivity analysis as an example 20 trajectories and 14 parameters were selected and consequently 300 simulations were performed for parameter sensitivity analysis results from the sensitivity analysis were used to select the six most sensitive parameters cn2 mgt ch n1 sub ch k2 rte ov n hru ch n2 rte and gw revap gw for model calibration fig 6 3 3 parameter calibration and uncertainty analysis for the model calibration demonstration we generated 1000 parameter sets using the uniform lhs approach that was implemented in r swat the nse for streamflow calculated for the period 2000 2007 was used to evaluate the model performance simulations with nse 0 65 were defined as behavioral resulting in a total of 52 simulations the characteristics of the behavioral parameter sets are presented in table 4 and the simulated streamflow at the catchment outlet is shown in fig 7 in general it can be said that the model was satisfactorily calibrated using r swat p factor 0 24 r factor 0 17 however visual inspection using the interactive plot option in r swat shows a clear mismatch between the simulated and observed streamflow series at shorter time scales and differences in flow magnitudes such as the underestimation of low flows fig 7b the overestimation of high flows fig 7c and the presence of high flows in the simulations which does not exist in the observed data fig 7d this could be due to uncertainties either in the observed data or in the model structure that would need further investigation 3 4 visualization of simulation results in this study the results from the best simulation were used to demonstrate the visualization functions of r swat spatial 2 d visualization of the model outputs was performed at the hru and subbasin level with swat outputs taken from the output hru and output sub files respectively fig 8 1 d visualization of the model outputs from output rch and watout dat files are in the supporting material r swat pdf 4 comparing r swat with swat cup to demonstrate the validity and effectiveness of r swat we used swat cup as a benchmark since swat cup was widely used and well tested specifically we compare several functions used in r swat version 1 0 0 with the corresponding functions used in swat cup version 5 2 1 1 the following aspects were compared between r swat and swat cup 1 the required time for updating swat input files 2 the simulated streamflow with updated swat input files 3 the results of parameter sensitivity analysis with the multivariate linear regression approach and 4 the calibrated streamflow statistics with three different calibration approaches sufi 2 pso and glue in all simulations below we used the swat project setup for the dak nong river basin and the model performance was evaluated if required using the nse for daily streamflow at the catchment outlet during the period 2000 2007 our results show that the required time for updating swat input files with a new parameter set table 3 with r swat is 0 10 s while that with swat cup is 0 52 s all simulations are performed with the same computer and with one core less time is required with r swat as it rewrites a file with all updated parameter values at once section 2 1 however swat cup rewrites a file multiple times depending on the number of updated parameters in that file to compare the calibrated streamflows with updated swat input files from r swat and swat cup we generated one random parameter set with the parameters reported in table 3 and used this parameter set for running both r swat and swat cup the simulated results e g discharge at the catchment outlet with the updated input files from r swat and swat cup are similar but not identical correlation r2 0 99994 fig 9 this is because r swat and swat cup use different standards for rounding of a 5 e g the rounded number of 0 185 with two decimal places in r swat and swat cup is 0 18 https stat ethz ch r manual r devel library base html round html accessed june 12 2022 and 0 19 respectively in addition when writing input files with the updated parameter values r swat uses the number of decimal places as defined in swat while swat cup mostly uses six decimal places a comparison between the updated files from r swat and the original files shows that r swat can correctly update swat input files with a given parameter set as demonstrated in the user manual to compare the results of parameter sensitivity analysis by the multivariate linear regression used in r swat and swat cup we generated 1000 parameter sets within their pre defined ranges table 3 with lhs and then run r swat and swat cup to calculate the objective function nse for streamflow at the catchment outlet results show that the parameter sensitivity ranking from r swat and swat cup are identical table 5 there are minor differences in the t stat and p value table 5 numbers in bold which could be due to round off and precision errors the comparison of the calibrated streamflow statistics best nse r factor and p factor with three different approaches sufi 2 glue and pso from r swat and swat cup was conducted by calibrating the swat model for streamflow the parameters subjected to calibration were given in table 3 and their ranges were defined in table 6 in each calibration approach the number of model runs is 1000 and the behavioral threshold is nse 0 65 results from r swat and swat cup are comparable and acceptable table 6 minor differences in the results are due to the randomness of the three approaches 5 outlook the primary purpose of r swat is to advance hydrological research with swat and r r swat is expected to rely not only on its original developers but also on its community for long term development currently we included some r functions packages into r swat incorporating new packages e g for parameter sensitivity and calibration will be straightforward since it only requires adding the package name to the r swat code see the supporting material r swat pdf therefore r swat is a flexible platform for developing and testing new parameter sensitivity and optimization packages with complex hydrological models swat future efforts to improve r swat could focus on the following aspects 1 enabling statistical analysis of the model results using existing r packages 2 expanding r swat for swat and 3 creating an r script for running r swat in high performance computing clusters without a graphical user interface author contributions t v n developed r swat and took the lead in writing the manuscript d a t and b v d collected the data and carried out the illustrative examples j d t d d f s k a and r s wrote and commented on the manuscript all authors discussed the results and contributed to the final manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the r swat users https groups google com g r swat and sushant mehan for feedback on the functionalities and visual interface of r swat during its initial release we thank the developers of swat and r packages that were used in this study special thanks are given to the editor the two anonymous reviewers and christoph schürz whose comments have helped to considerably improve the quality of the manuscript and the software we thank the members of the modeling and assessment of sustainable systems mass group at the university of south florida tampa for proofreading the article appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105497 
25546,soil and water assessment tool swat is widely used for watershed scale assessment of climate change impacts but post processing of model outputs is a tedious job an r tool was developed in this study for batch processing of swat output results a case study was then performed in the double mountain fork brazos watershed in the texas panhandle using an improved swat model with the r tool to evaluate the simulated future changes in water balance components total nitrogen tn load and crop growth over the watershed the results showed that the average annual future surface runoff increased by 8 9 17 9 mm and 11 5 22 6 mm in the irrigated and dryland cotton areas respectively similarly future tn load in irrigated and dryland cotton areas increased by approximately 0 4 0 9 kg ha 1 and 1 9 2 4 kg ha 1 the yields of irrigated and dryland cotton increased by 91 1 122 1 and 47 5 84 0 under the future climate scenarios respectively graphical abstract image 1 keywords swat mad cmip6 hydrologic cycle total nitrogen load cotton semi arid region 1 introduction climate change is expected to present critical challenges for supply chain and production systems throughout the world papadopoulos and balta 2022 changes in climatic conditions and the occurrence of extreme climatic events can have a substantial impact on the water ecological and agricultural resources arnell and reynard 1996 the average global surface temperature has increased by approximately 1 c since 1850 intergovernmental panel on climate change ipcc 2014 climate warming accelerates the regional water cycle processes causing the spatio temporal redistribution of water resources this also leads to changes in water resources availability which in turn leads to changes in hydrological regimes and further impacts on regional socio economic systems gleick 1989 al mukhtar et al 2014 at the same time climate change also aggravates the occurrence of extreme weather events such as drought flooding etc and thereby directly affects crop growth and development the extremely high temperatures could reach the critical tolerance threshold of crop health extreme drought could result in water stress and induce a series of problems such as yield reduction or crop failure wing et al 2021 vesco et al 2021 kukal and irmak 2018 in addition with the changes in rainfall runoff relationships the generation and migration of pollutants with the hydrologic cycle as the carrier and the driving force will also vary zhang et al 2021a wagner riddle et al 2017 which can seriously threaten crop growth and environmental quality therefore assessing the impact of climate change is of immense significance for effectively preventing the destruction of the agricultural environment of a basin and optimizing the management practices for soil and water conservation scenario construction is the foundation of climate change modeling assessing climate change impacts and vulnerabilities evaluating adaptation and mitigation strategies and analyzing climate change related policies nakićenović 1996 a physically based distributed hydrological model not only considers the spatial heterogeneity of the watershed but also accurately describes the hydrological process of the watershed it can effectively simulate the long term impact of climate change and land use conversion in a watershed and perform continuous simulation and therefore it is appropriate for watersheds with large differences in spatial characteristics abbott and refsgaard 1996 the soil and water assessment tool swat model is used extensively and effectively for simulating water quantity and quality in different watersheds around the world hosseini and bailey 2022 samimi et al 2020 kuti and ewemoje 2021 the model discretizes the watershed in various ways to represent the spatial heterogeneity and hydrological processes of the watershed at a daily time step swat can well simulate the impact of climate change on the watershed scale hydrological cycle neitsch et al 2009 arnold et al 2012 recently swat has been extensively used to evaluate hydrological and water quality responses to climate variability and land use change marras et al 2021 utilized the coupled euro cordex and swat model to show decreases in mean discharge and runoff due to decreased precipitation son et al 2022 found that all hydrological components were decreased such as evapotranspiration by 2 3 percolation by 9 8 and surface runoff by 11 5 under climate change scenarios and evapotranspiration et and surface runoff were the most sensitive hydrological parameters in the future wang et al 2020 examined responses of nitrate loading to climate change in the upper mississippi river basin using an improved swat model with freeze thaw cycle representation swat ft and found that the swat ft model simulated approximately a 50 increase in riverine nitrate loadings under the rcp8 5 scenario tan et al 2022 utilized an improved swat model and simulated that yields of winter wheat 10 0 17 1 and summer maize 6 1 12 6 could increase in the future under ssp2 4 5 and ssp5 8 5 scenarios in the middle 2041 2070 and end 2071 2100 of 21st century respectively when assessing the impacts of climate change using hydrological models and general circulation models gcms uncertainty in the simulated hydro climatic variables is inevitable wilby and harris 2006 gcm credibility plays a significant role in the robustness of system modeling and decision making downplaying gcm credibility may lead to over or under estimation in future scenarios leading to biased climate change adaptation decisions zhang et al 2021b thereby choosing a single or several gcms to analyze climate change neither covers enough uncertainties nor guarantees the reliability of the results mehr et al 2020 taking into account the uncertainty of gcm climate data for example shen et al 2018 predicted future changes in both climate precipitation and air temperature and the hydrological responses of the hanjiang river watershed based on 20 different gcms and found that the uncertainty increased dramatically over time based on the data from 28 gcms for the manicouagan basin chen et al 2017 reported an increase in precipitation from 9 7 to 27 8 and an increase in air temperature from 3 8 c to 8 4 c under rcp8 5 scenario these studies demonstrated the importance of using data from multiple gcms to evaluate the impacts of climate change on hydrology lee et al 2021 predictions from an ensemble of multiple models can reduce the uncertainty of simulation results faramarzi et al 2013 asseng et al 2019 yun et al 2021 therefore 27 gcms were selected from different countries and regions in this study coupled model intercomparison project cmip has been rigorously refined over the years to address uncertainties from cmip1 to the latest version of cmip6 o neill et al 2016 unlike previous cmips the cmip6 includes more gcms and provides a more accurate description of geophysical processes in addition the future climate change scenarios in cmip6 provide data for combined scenarios of representative concentration pathways rcps used in cmip5 and shared socioeconomic pathways ssps o neill et al 2016 schlund et al 2020 which consider future social and economic developments and cmip6 added 3 new emission paths which greatly enriched the future climate database when such huge meteorological data are invoked as the input data for swat to simulate the future hydrology water quality and crop growth large output data becomes available manual processing of such massive data is not only time consuming and labor intensive but also prone to accidental errors currently available data processing methods limit the availability of climate scenarios and gcms to be used for some studies in response to this challenge in this study r code was developed to design an algorithm specifically used for post processing the swat output data output hru at daily monthly and yearly time scales this algorithm can quickly extract the required variables and organize them into csv files for further use the double mountain fork brazos dmfb watershed in the semi arid texas panhandle was selected for this case study cotton gossypium hirsutum l land use accounts for approximately 30 of the study watershed area and approximately 40 of this cotton area is irrigated national agricultural statistics service nass 2021 the ogallala aquifer serves as an important groundwater source for cotton irrigation however decades of intensive irrigation pumping combined with limited recharge have led to rapidly declining water levels colaizzi et al 2009 therefore understanding the status of water resources in this region under global warming is of profound significance for developing appropriate management practices for cotton production in this study the downscaled cmip6 meteorological data were used to drive an improved swat model the impacts of projected future climate change on major water balance components water quality and cotton yield in the dmfb watershed were assessed the specific objectives of the study were to 1 develop an algorithm for rapidly post processing swat output data 2 assess the long term climate change effects on the hydrologic cycle and total nitrogen load in the dmfb watershed under both irrigated and dryland cotton land uses and 3 evaluate how the projected climate change affects the irrigated and dryland cotton production 2 materials and methods 2 1 study area this study was conducted in the dmfb watershed in the semi arid texas panhandle the delineated area of this watershed is approximately 6000 km2 the topography of the watershed is fairly flat it is situated above the southern ogallala aquifer and more than 90 of agricultural irrigation in the area relies on this groundwater extraction cotton is a dominant crop and cotton production holds enormous potential in this region in general cotton is planted around mid may and harvested around the end of october in the texas panhandle defoliant is typically applied two weeks before harvesting when needed the long term average annual rainfall across the watershed varies between 457 and 559 mm and the long term average annual maximum air temperature tmax and minimum air temperature tmin are approximately 24 c and 9 c respectively 2 2 swat and swat mad the swat model is a continuous time semi distributed process based and watershed scale hydrologic model arnold et al 1998 primary components include a hydrology module non point source pollution module crop growth module etc arnold et al 2012 the arcswat revision 664 developed for the arcgis 10 2 platform was used in this study irrigation in hrus may be scheduled manually by users or automatically applied by swat neitsch et al 2011 chen et al 2018a developed a more representative approach to automatically schedule irrigation and integrated a management allowed depletion mad auto irrigation method into the swat model the mad method triggers irrigation according to a user defined allowable depletion percentage of plant available water determined by the crop specific maximum rooting depth and site specific soil properties chen et al 2018a 1 mad method sol sumfc sol sw paw mad where sol sumfc is the amount of water held in the soil profile at field capacity mm sol sw is the amount of water stored in soil profile on any given day mm paw is plant available water determined by both plant maximum rooting depth and soil properties and mad is users defined water stress threshold that triggers irrigation which expressed as a decimal value ranging from 0 to 1 mad values approaching 0 indicate irrigation management that allows relatively less depletion of soil water before triggering irrigation resulting in low crop water stress by contrast values approaching 1 denote irrigation management that allows relatively more depletion of soil water before applying irrigation leading to high crop water stress in this study the swat mad model was calibrated and validated for streamflow data at two united states geological survey usgs gages and county level crop yields of both irrigated and dryland cotton the swat mad model was also evaluated by county level seasonal irrigation requirements of cotton and percolation amount the total nitrogen tn load at the watershed outlet was also calibrated and validated in this study the calibrated parameter values for the swat mad model are listed in table s1 the swat mad model calibration and validation performance statistics for monthly streamflow at the stream gages table 1 were well above the satisfactory range suggested by moriasi et al 2007 the r 2 and overall pbias were 0 21 and 2 3 when comparing swat mad simulated and observed irrigated cotton lint yield in lynn county in the dmfb watershed nass 2020 the simulated irrigation for cotton by the mad auto irrigation method 346 9 mm was very close to the local survey data of 345 4 mm nass 2020 the swat mad model simulated percolation amount was also comparable with the values from local reports and literature chen et al 2018b the nse r 2 and pbias for monthly tn load prediction at the watershed outlet during the calibration period were 0 72 0 75 and 13 8 respectively table 1 those values during the validation were 0 73 0 88 and 17 0 the model performance ratings for the monthly tn load simulations using swat mad in the dmfb watershed were considered good for both the calibration and validation periods according to moriasi et al 2007 criteria 2 3 cmip6 gcm data and scenario design observed daily climate data for the study watershed including tmax tmin solar radiation and precipitation from 1981 to 2010 were obtained for seven weather stations from the iowa environmental mesonet https mesonet agron iastate edu schoolnet future climate scenario data were obtained from 27 gcms which are provided by the world climate research program wcrp of cmip6 https esgf node llnl gov projects cmip6 the raw gcms from wcrp were in low spatial and temporal resolutions hence the downscaled and bias corrected methods developed by liu and zuo 2012 were used to generate the daily datasets the 27 cmip6 gcms were listed in table 2 in this study the water balances tn load and crop growth attributes of the watershed under climate change scenarios in the mid 21st century and the end of the 21st century were simulated two 35 year periods from 2036 to 2070 and from 2066 to 2100 were selected to conduct future scenario simulations forced with both ssp2 4 5 and ssp5 8 5 scenarios the first five years of 2036 2040 and 2066 2070 served as the warmup periods the co2 concentration in swat was modified while inputting future climate data the current version of swat does not allow inputting variable co2 concentration values that change dynamically with time and it allows only a fixed value for a period of simulation therefore according to meinshausen et al 2011 and van vuuren et al 2007 the 35 year average co2 concentrations of the future climate scenarios ssp2 4 5 and ssp5 8 5 in each of the two time periods were estimated and used as the co2 concentrations in the swat mad model the co2 concentration in the historical period was kept as the default value of 330 ppm the average co2 concentrations in the two time periods under the two ssp scenarios were shown in table 3 2 4 overall r framework design in this study post processing r codes were developed for batch processing of swat outputs of the future climate change scenarios the r code intellectualized the swat output post processing procedure compared to the conventional manual processing allowing for flexibility to obtain the climate hydrological water quality and crop growth variables of the swat model from output hru for different time steps daily monthly and yearly in this study climatic variables hydrological variables tn load and crop yield could be obtained from the monthly output hru results while the dynamic change of biomass biom and leaf area index lai had to be obtained from the daily output hru results the monthly output hru file of the swat model included both monthly and yearly results so the yearly simulation results were not needed to output separately using the newly developed r code the future climate data of 27 gcms for two time periods and two ssp scenarios were inputted into swat mad first in addition the swat mad projects were run at both the monthly and daily scales and a total of 218 output hru files were obtained all output hru files were renamed according to the user s need naming example is shown in figs s1 s2 and then saved into two folders for monthly scale and daily scale separately as for how the r tool functions firstly the function determined the position information of the output variable fig 1 the mon column was used to distinguish results between monthly yearly and multi year totals because the monthly scale output contained information on all three aspects specifically when mon column values are greater than 999 they were identified as yearly scale results simulation starting year in this case needs to be greater than 1000 a d when the value of the mon column was less than or equal to 12 and the row ordinal number was less than that of the last row for the yearly scale results monthly scale results were obtained this way the row ordinal of the mon column starting from the first row below the last row ordinal of the yearly scale results to the end of all results in the output hru file was the multi year summary results appendix s1 for the daily scale results the values of the mon column represented the day of the year doy since the lai and biomass values on the 366th day were 0 for cotton the values on the 366th day of a leap year were deleted at the daily scale which was conducive to the smooth operation of the code appendix s2 the r codes read all hru files in the folders for monthly scale and daily scale and cycled through all files in the order of file name acquisition read data data filtering save data finally the results for each time scale of 27 gcms were combined into an independent csv file for further data analysis or chart making fig 1 3 results 3 1 projected changes in the future climate of the watershed overall the long term changes in annual tmax tmin and solar radiation showed increasing trends in the dmfb watershed from 2041 to 2100 tables s2 s3 but the projected changes of annual precipitation were relatively small with the mean and median percent changes of less than 3 fig 2 especially under the 2071 2100 ssp5 8 5 scenario the mean percent changes in annual precipitation for irrigated and dryland cotton production areas were 1 5 and 1 2 and the median percent changes were 2 7 and 2 0 respectively fig 2 this study revealed that the average annual precipitation gradually increased with increasing co2 concentrations while the average annual solar radiation decreased in contrast to the ssp2 4 5 scenario the ssp5 8 5 scenario showed a greater uncertainty in predicted future climate parameters for different time scales compared to the baseline period 1981 2010 the average annual precipitation during the growing season was projected to increase by 2 0 for irrigated cotton areas and 1 7 for dryland cotton areas during 2041 2070 and those increases were 5 0 and 4 7 during 2071 2100 figs s3 s4 the average annual tmax during the growing season for irrigated cotton is expected to increase by 2 03 c 2 62 c 2 67 c and 4 55 c and the average annual tmin is projected to increase by 1 97 c 2 68 c 2 62 c and 4 89 c under the 2041 2070 ssp2 4 5 2041 2070 ssp5 8 5 2071 2100 ssp2 4 5 and 2071 2100 ssp5 8 5 scenarios respectively figs s5 and s7 the mean annual tmax for the dryland cotton growing period could rise by 2 44 c and 3 71 c and the mean annual tmin could rise by 2 47 c and 4 07 c during the period of 2041 2100 under two emission scenarios table 4 figs s6 and s8 for both cotton management practices the increases in solar radiation were greater under the ssp2 4 5 scenario than the ssp5 8 5 scenario the median percent changes in solar radiation during the growing season under the ssp2 4 5 and ssp5 8 5 scenarios were 0 6 and 0 2 for irrigated cotton and 0 7 and 0 2 for dryland cotton respectively table 5 figs s9 s10 3 2 climate change impacts on hydrology the annual actual evapotranspiration eta for dryland cotton was projected to decrease during 2041 2100 under two ssp scenarios for irrigated cotton only the 2071 2100 ssp5 8 5 scenario showed a 9 3 decrease in the mean annual eta whereas the rest of the scenarios showed slight increases fig 3 a high variation in annual eta was found among different gcms especially under the ssp5 8 5 scenario the percent changes in annual eta ranged from 4 1 to 13 9 for irrigated cotton and 29 5 to 29 4 for dryland cotton during 2071 2100 fig 3 based on the future climate data projected by 27 gcms the results showed greater uncertainty under dryland conditions than under irrigated conditions the eta indicated a higher level of uncertainty during april and september for both cotton management practices the projected changes in mean and median eta during the growing season for irrigated cotton ranged from 13 4 to 1 4 and 11 2 1 9 respectively the decrease in mean and median eta during the growing season for dryland cotton varied from 5 1 to 7 9 and 2 9 8 1 respectively figs s11 s12 the future irrigation water use showed similar increasing trends under all scenarios except for the 2071 2100 ssp5 8 5 scenario in which the median percent change in irrigation water use was 17 5 fig 3 nevertheless the magnitude of change in irrigation water use during the cotton growing season was slightly larger with values of 5 6 2 5 and 6 8 under the 2041 2070 ssp2 4 5 2041 2070 ssp5 8 5 and 2071 2100 ssp2 4 5 scenarios respectively fig s13 the change in irrigation water use decreased by 18 0 under the 2071 2100 ssp5 8 5 scenario the mean annual surface runoff in the dmfb watershed indicated an increasing trend under all climate change scenarios fig 3 under the 2041 2070 ssp2 4 5 and 2041 2070 ssp5 8 5 scenarios the mean annual surface runoff increased by 8 9 mm and 13 4 mm respectively for irrigated cotton and 11 5 mm and 17 8 mm respectively for dryland cotton during the period of 2071 2100 the annual mean surface runoff for irrigated cotton increased by 10 1 mm under the ssp2 4 5 scenario and 17 9 mm under the ssp5 8 5 scenario and the increased values for dryland cotton were 14 1 mm and 22 6 mm however the simulated surface runoff results under the ssp5 8 5 scenario exhibited substantial uncertainty for both cotton management practices for example the projected change range in surface runoff among 27 gcms was approximately 30 mm under the ssp2 4 5 scenario and it was over 60 mm under the ssp5 8 5 scenario fig 3 based on the monthly analysis the change in surface runoff during the non growing season was small and showed a low uncertainty during the growing season the maximum increase in monthly surface runoff is expected to occur in september with a high uncertainty figs s14 s15 the surface runoff changes during the growing season in irrigated areas could increase with increasing co2 concentrations results also found that the average increase in annual surface runoff differed from 1 4 mm to 2 1 mm in the mid 21st century and 1 6 mm 2 7 mm by the end of the 21st century a similar trend was observed for dryland cotton and the average surface runoff showed an annual increase from 1 8 mm to 2 8 mm in the mid 21st century and 2 2 mm 3 5 mm by the end of the 21st century the above results indicated that the hydrological cycle in the dmfb watershed was strongly influenced by future climate with a greater magnitude of changes under the ssp5 8 5 scenario 3 3 climate change effects on water quality surface runoff has been recognized as one of the common causes and transport pathways for agricultural non point source pollution and changes in surface runoff caused by climate change could affect the future tn load in the dmfb watershed the simulated results for tn load were consistent with the trend of surface runoff which showed an increasing trend in the future under four climate change scenarios the mean and median tn load for irrigated cotton increased by 0 4 kg ha 1 to 0 9 kg ha 1 and 0 3 kg ha 1 to 0 7 kg ha 1 respectively the mean and median annual tn load for dryland cotton ranged from 1 9 kg ha 1 to 2 4 kg ha 1 and from 1 7 kg ha 1 to 2 1 kg ha 1 respectively fig 4 meanwhile the two ssp emission scenarios consistently projected increasing trends in tn load during the growing season under both irrigated and dryland conditions and the change in tn load was negligible during the non growing season as expected the mean and median change in tn load during the growing season increased from 0 06 kg ha 1 to 0 13 kg ha 1 and from 0 02 kg ha 1 to 0 05 kg ha 1 irrigated cotton and from 0 30 kg ha 1 to 0 37 kg ha 1 and from 0 10 kg ha 1 to 0 18 kg ha 1 dryland cotton respectively figs s16 s17 3 4 responses of cotton yields to climate change the future cotton lint yields biomass and lai for both irrigated and dryland conditions were simulated using the swat mad model and gcm projected future climate data in the mid to late 21st century under the ssp2 4 5 and ssp5 8 5 scenarios the future cotton lint yield simulated by all gcms changed remarkably the simulated cotton lint yield in the dmfb watershed increased from 91 1 to 122 1 under irrigated conditions and from 47 5 to 84 0 under dryland conditions fig 5 compared to the results from the ssp2 4 5 scenario the ssp5 8 5 scenario showed higher co2 concentration and greater increases in cotton lint yields the simulated cotton lint yields under both irrigated and dryland conditions increased by 98 4 and 50 6 respectively under the ssp2 4 5 scenario the simulated percent changes in cotton lint yields under both irrigated and dryland conditions were 116 7 and 72 3 respectively under the ssp5 8 5 scenario table s3 dry matter accumulation is the material basis for crop yield the simulated changes in biomass approximately exhibited s shaped curves for both irrigated and dryland cotton the biomass could increase with increasing co2 concentrations and the stage of rapid biomass accumulation could occur earlier simulated biomass increased by 4 mg ha 1 to 6 4 mg ha 1 for irrigated cotton and 1 5 mg ha 1 to 2 5 mg ha 1 for dryland cotton under future scenarios compared to the historical period fig 5 the simulated lai during the baseline period 1981 2021 showed an s shape curve however lai showed a downward opening parabola during the simulation periods of 2041 2070 and 2071 2100 the simulated lai increased rapidly in the early growth stage and reached the maximum at the full development stage the simulated lai was generally lower in dryland conditions than in irrigated conditions under all scenarios fig 5 under the baseline scenario co2 330 ppm the simulated lai leveled off around doy 111 for irrigated cotton 4 6 m2 m 2 and around doy 105 for dryland cotton 2 8 m2 m 2 for irrigated cotton the lai reached a maximum value of 4 7 m2 m 2 on doy 108 and began to decline after 20 days under the 2041 2070 ssp2 4 5 scenario the trends of lai were similar under the 2071 2100 ssp2 4 5 and 2041 2070 ssp5 8 5 scenarios which reached a maximum value of 4 6 m2 m 2 on doy 84 and doy 85 respectively and began to decline on doy 127 and doy 122 respectively under the ssp5 8 5 scenario the simulated lai reached a maximum value of 4 5 m2 m 2 on doy 77 and started to decrease after one month for dryland cotton lai reached a maximum value of 3 1 m2 m 2 on doy 102 under the 2041 2070 ssp2 4 5 scenario and started to decrease after 19 days the 2071 2100 ssp2 4 5 and 2041 2070 ssp5 8 5 scenarios simulated similar trends in lai which reached a maximum value of 3 1 m2 m 2 on doy 79 and 82 and began to decline on doy 127 and 122 respectively the simulated lai reached a maximum value of 3 5 m2 m 2 on doy 77 and started to decrease after 24 days under the 2071 2100 ssp5 8 5 scenario fig 5 4 discussion the cmip6 projected air temperatures showed that the climate in the dmfb watershed could generally become warmer under most scenarios and all 27 gcms projected air temperature increases ranging from 1 5 c to 5 c by the mid to late 21st century awal et al 2016 predicted that tmin and tmax could increase by 2 c and 3 c on average in the 2055s and 2090s respectively under three greenhouse gas emissions scenarios a2 a1b and b1 in the brazos headwaters basin texas projected climate data used in this study showed that overall future precipitation remained nearly unchanged compared to the baseline venkataraman et al 2016 reported that precipitation could increase in most parts of texas by the second half of the 21st century under the rcp4 5 scenario while herrera pantoja and hiscock 2015 reported a decrease in precipitation in some semi arid areas li et al 2012 used the data from 36 gcms and reported the trend of precipitation change for the period 1950 2099 in houston texas they found that annual average precipitation could decrease apparently under the rcp8 5 scenario but remain relatively constant under the rcp2 6 scenario in this study solar radiation was found to increase noticeably by approximately 10 other studies also reported similar increasing trends in solar radiation in the future rempel et al 2021 xiao et al 2020 the results from this study showed a decrease less than 3 5 in future annual eta for dryland cotton under the ssp2 4 5 and ssp5 8 5 scenarios the projected increase in air temperatures did not lead to an increase in eta which was consistent with other long term climate change studies dinpashoh et al 2011 jhajharia et al 2015 venkataraman et al 2016 simulated annual eta for irrigated cotton showed increasing trends under all climate change scenarios except for the 2071 2100 ssp5 8 5 scenario which projected a decrease in eta by up to 9 3 the changes in eta could be directly or indirectly affected by many factors such as co2 concentrations air temperatures precipitation solar radiation irrigation managment etc therefore it was difficult to determine which single factor attributed to the changes in eta the simulated changes in irrigation water use and eta by coupling the swat mad model and gcms in the study watershed showed similar trends moreover under the 2041 2070 ssp2 4 5 2071 2100 ssp2 4 5 and 2041 2070 ssp5 8 5 scenarios the results showed an increase in simulated annual irrigation water use which was most probably due to the increase in eta while holding precipitation relatively constant however under the 2071 2100 ssp5 8 5 scenario the highest co2 concentration 807 ppm was simulated which led to the partial closure of stomatal apertures and hence inhibited transpiration conley et al 2001 leuzinger and körner 2007 bunce and nasyrov 2012 the decrease in eta in this study would then lead to reductions in the annual irrigation water use by cotton the simulated median annual surface runoff for both irrigated and dryland cotton showed evident increases under all four scenarios with greater increases under dryland conditions in the irrigated cotton areas an adequate supply of water and fertilizer would lead to better crop growth and sufficient ground cover therefore under future climate scenarios precipitation or irrigation water might be trapped by branches and leaves or used mainly for crop transpiration which would increase the cotton biomass and hence reduce the surface runoff accordingly the changes in tn load were closely correlated to surface runoff and the increase in surface runoff under future climate scenarios would inevitably increase nitrogen loss from the cotton fields and thus cause surface water pollution wei et al 2021 hanrahan et al 2021 therefore appropriate mitigation and adaptation strategies need to be implemented to reduce the negative impact of climate change on hydrology and water quality the projected climate change caused an increase in simulated cotton lint yield in the dbmf watershed which was comparable to the results reported in other studies adhikari et al 2016 kothari et al 2021 but the magnitude of increase was different this study showed increases in cotton lint yields in the range of 91 1 122 1 for irrigated cotton and 47 5 84 0 for dryland cotton which were higher than the cotton lint yield change 14 29 increase projected in the study of adhikari et al 2016 for simulation period of 2041 2070 other relative parameters such as biomass and lai were analyzed in this study to investigate possible factors that would influence the cotton lint yield the simulated maximum biomass yields for both cotton management practices were higher than the biomass yields under the respective baseline scenarios which supported the findings of increases in cotton lint yields in the future the changes in simulated lai under all four climate change scenarios demonstrated that climate change would lead to a shorter growing season in cotton as higher air temperatures could accelerate maturation and shorten the growth period sharma et al 2021 cotton plants are heat tolerant and can grow well within an optimum air temperature range and low air temperature can adversely affect the cotton lint yield the accumulated temperature 10 c might result in a positive effect on the growth and development of cotton and thus influence the final yield pettigrew 2008 li et al 2020 thereby under the ssp2 4 5 and ssp5 8 5 scenarios elevated air temperatures promoted increases in cotton lint yield the natural cotton defoliation during the baseline period was not sufficient to support direct harvesting by machinery but the early defoliation under the future climate scenarios implied an earlier shedding of cotton leaves which would potentially reduce the use of defoliants in harvesting and simplify the production processes liao et al 2020 due to the complexity of climate change issues and the limitations of human cognition the projected changes in future climate showed a high variation among different gcms there were many causes of uncertainties in climate projections e g downscaling approach gcm selection etc with the gcm selections being the primary reason for uncertainties in future climate projections lee et al 2021 gcms have different underlying assumptions and the more gcms were selected in a study the more it could reflect the variety of situations that might occur in the future lutz et al 2016 the newly developed r code can be used to extract and analyze the swat outputs more efficiently and obtain the corresponding changes in hydrology water quality and crop growth at yearly monthly and daily scales the r code accurately extracted and organized the data of all 109 scenarios in approximately 24 32 h which saved a substantial amount of labor and prevented potential errors caused by manual processing when evaluating the impact of future climate change on regional water resources and crop production it is important to use more gcms to capture the uncertainty with the continuous improvement and increase in the number of gcms this r code will become an important post processing tool for the swat users to study climate change impacts on the soil water food coupling systems 5 conclusions the changes in meteorological variables water balance components total nitrogen load and cotton growth parameters were simulated under changing climate based on 27 cmip6 gcm projections and a well calibrated swat mad model under four climate change scenarios in the dmfb watershed of the texas panhandle the simulation results demonstrated that air temperatures and solar radiation increased under future climate scenarios while the precipitation slightly decreased in future climate scenarios eta declined during the dryland cotton growing season however in the irrigated cotton growing season only in the 2071 2100 ssp5 8 5 scenario the amount of irrigation and eta showed a downward trend and the median values of the reductions were 16 3 and 11 2 respectively the irrigation amount and eta in the growing season of irrigated cotton under the other three scenarios showed an upward trend and the median percentage changes were 3 2 7 5 and 0 2 1 9 respectively clearly elevated co2 concentration was the major factor for the decrease in eta and irrigation under the 2071 2100 ssp5 8 5 scenario in addition both surface runoff and tn load increased for two cotton management practices under the four climate scenarios which increased the risk of non point source pollution in the watershed both cotton yields were expected to increase under the four climate change scenarios and the average annual increase in irrigated cotton yield was nearly double compared to that of dryland cotton yield predicting potential ecological and environmental threats in the watershed in the future enable making scientific and reasonable decisions on production and ecological protection for watershed management agencies the use of the newly developed r code has greatly improved the processing capabilities for long term multi scenario and multi variable swat mad output results and it can serve as a useful tool and provide technical support for efficiently studying the future climate change impacts software availability name of software swat post processing r tool description the swat post processing r tool was developed for batch processing of swat outputs of the future climate change scenarios allowing for flexibility to obtain the climate hydrological water quality and crop growth variables of the swat model from output hru for different time steps daily monthly and yearly developers haipeng liu and yong chen year available 2022 availability and cost open source language r funding this research was supported by the chinese universities scientific fund under award numbers 1191 15051002 1191 15052008 1191 10092004 and 1191 31051204 the research was also partially supported by the national institute of food and agriculture u s department of agriculture under award numbers nifa 2021 67019 33684 and nifa 2012 67009 19595 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported in part by the ogallala aquifer program a consortium between usda agricultural research service kansas state university texas a m agrilife research texas a m agrilife extension service texas tech university and west texas a m university appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105492 
25546,soil and water assessment tool swat is widely used for watershed scale assessment of climate change impacts but post processing of model outputs is a tedious job an r tool was developed in this study for batch processing of swat output results a case study was then performed in the double mountain fork brazos watershed in the texas panhandle using an improved swat model with the r tool to evaluate the simulated future changes in water balance components total nitrogen tn load and crop growth over the watershed the results showed that the average annual future surface runoff increased by 8 9 17 9 mm and 11 5 22 6 mm in the irrigated and dryland cotton areas respectively similarly future tn load in irrigated and dryland cotton areas increased by approximately 0 4 0 9 kg ha 1 and 1 9 2 4 kg ha 1 the yields of irrigated and dryland cotton increased by 91 1 122 1 and 47 5 84 0 under the future climate scenarios respectively graphical abstract image 1 keywords swat mad cmip6 hydrologic cycle total nitrogen load cotton semi arid region 1 introduction climate change is expected to present critical challenges for supply chain and production systems throughout the world papadopoulos and balta 2022 changes in climatic conditions and the occurrence of extreme climatic events can have a substantial impact on the water ecological and agricultural resources arnell and reynard 1996 the average global surface temperature has increased by approximately 1 c since 1850 intergovernmental panel on climate change ipcc 2014 climate warming accelerates the regional water cycle processes causing the spatio temporal redistribution of water resources this also leads to changes in water resources availability which in turn leads to changes in hydrological regimes and further impacts on regional socio economic systems gleick 1989 al mukhtar et al 2014 at the same time climate change also aggravates the occurrence of extreme weather events such as drought flooding etc and thereby directly affects crop growth and development the extremely high temperatures could reach the critical tolerance threshold of crop health extreme drought could result in water stress and induce a series of problems such as yield reduction or crop failure wing et al 2021 vesco et al 2021 kukal and irmak 2018 in addition with the changes in rainfall runoff relationships the generation and migration of pollutants with the hydrologic cycle as the carrier and the driving force will also vary zhang et al 2021a wagner riddle et al 2017 which can seriously threaten crop growth and environmental quality therefore assessing the impact of climate change is of immense significance for effectively preventing the destruction of the agricultural environment of a basin and optimizing the management practices for soil and water conservation scenario construction is the foundation of climate change modeling assessing climate change impacts and vulnerabilities evaluating adaptation and mitigation strategies and analyzing climate change related policies nakićenović 1996 a physically based distributed hydrological model not only considers the spatial heterogeneity of the watershed but also accurately describes the hydrological process of the watershed it can effectively simulate the long term impact of climate change and land use conversion in a watershed and perform continuous simulation and therefore it is appropriate for watersheds with large differences in spatial characteristics abbott and refsgaard 1996 the soil and water assessment tool swat model is used extensively and effectively for simulating water quantity and quality in different watersheds around the world hosseini and bailey 2022 samimi et al 2020 kuti and ewemoje 2021 the model discretizes the watershed in various ways to represent the spatial heterogeneity and hydrological processes of the watershed at a daily time step swat can well simulate the impact of climate change on the watershed scale hydrological cycle neitsch et al 2009 arnold et al 2012 recently swat has been extensively used to evaluate hydrological and water quality responses to climate variability and land use change marras et al 2021 utilized the coupled euro cordex and swat model to show decreases in mean discharge and runoff due to decreased precipitation son et al 2022 found that all hydrological components were decreased such as evapotranspiration by 2 3 percolation by 9 8 and surface runoff by 11 5 under climate change scenarios and evapotranspiration et and surface runoff were the most sensitive hydrological parameters in the future wang et al 2020 examined responses of nitrate loading to climate change in the upper mississippi river basin using an improved swat model with freeze thaw cycle representation swat ft and found that the swat ft model simulated approximately a 50 increase in riverine nitrate loadings under the rcp8 5 scenario tan et al 2022 utilized an improved swat model and simulated that yields of winter wheat 10 0 17 1 and summer maize 6 1 12 6 could increase in the future under ssp2 4 5 and ssp5 8 5 scenarios in the middle 2041 2070 and end 2071 2100 of 21st century respectively when assessing the impacts of climate change using hydrological models and general circulation models gcms uncertainty in the simulated hydro climatic variables is inevitable wilby and harris 2006 gcm credibility plays a significant role in the robustness of system modeling and decision making downplaying gcm credibility may lead to over or under estimation in future scenarios leading to biased climate change adaptation decisions zhang et al 2021b thereby choosing a single or several gcms to analyze climate change neither covers enough uncertainties nor guarantees the reliability of the results mehr et al 2020 taking into account the uncertainty of gcm climate data for example shen et al 2018 predicted future changes in both climate precipitation and air temperature and the hydrological responses of the hanjiang river watershed based on 20 different gcms and found that the uncertainty increased dramatically over time based on the data from 28 gcms for the manicouagan basin chen et al 2017 reported an increase in precipitation from 9 7 to 27 8 and an increase in air temperature from 3 8 c to 8 4 c under rcp8 5 scenario these studies demonstrated the importance of using data from multiple gcms to evaluate the impacts of climate change on hydrology lee et al 2021 predictions from an ensemble of multiple models can reduce the uncertainty of simulation results faramarzi et al 2013 asseng et al 2019 yun et al 2021 therefore 27 gcms were selected from different countries and regions in this study coupled model intercomparison project cmip has been rigorously refined over the years to address uncertainties from cmip1 to the latest version of cmip6 o neill et al 2016 unlike previous cmips the cmip6 includes more gcms and provides a more accurate description of geophysical processes in addition the future climate change scenarios in cmip6 provide data for combined scenarios of representative concentration pathways rcps used in cmip5 and shared socioeconomic pathways ssps o neill et al 2016 schlund et al 2020 which consider future social and economic developments and cmip6 added 3 new emission paths which greatly enriched the future climate database when such huge meteorological data are invoked as the input data for swat to simulate the future hydrology water quality and crop growth large output data becomes available manual processing of such massive data is not only time consuming and labor intensive but also prone to accidental errors currently available data processing methods limit the availability of climate scenarios and gcms to be used for some studies in response to this challenge in this study r code was developed to design an algorithm specifically used for post processing the swat output data output hru at daily monthly and yearly time scales this algorithm can quickly extract the required variables and organize them into csv files for further use the double mountain fork brazos dmfb watershed in the semi arid texas panhandle was selected for this case study cotton gossypium hirsutum l land use accounts for approximately 30 of the study watershed area and approximately 40 of this cotton area is irrigated national agricultural statistics service nass 2021 the ogallala aquifer serves as an important groundwater source for cotton irrigation however decades of intensive irrigation pumping combined with limited recharge have led to rapidly declining water levels colaizzi et al 2009 therefore understanding the status of water resources in this region under global warming is of profound significance for developing appropriate management practices for cotton production in this study the downscaled cmip6 meteorological data were used to drive an improved swat model the impacts of projected future climate change on major water balance components water quality and cotton yield in the dmfb watershed were assessed the specific objectives of the study were to 1 develop an algorithm for rapidly post processing swat output data 2 assess the long term climate change effects on the hydrologic cycle and total nitrogen load in the dmfb watershed under both irrigated and dryland cotton land uses and 3 evaluate how the projected climate change affects the irrigated and dryland cotton production 2 materials and methods 2 1 study area this study was conducted in the dmfb watershed in the semi arid texas panhandle the delineated area of this watershed is approximately 6000 km2 the topography of the watershed is fairly flat it is situated above the southern ogallala aquifer and more than 90 of agricultural irrigation in the area relies on this groundwater extraction cotton is a dominant crop and cotton production holds enormous potential in this region in general cotton is planted around mid may and harvested around the end of october in the texas panhandle defoliant is typically applied two weeks before harvesting when needed the long term average annual rainfall across the watershed varies between 457 and 559 mm and the long term average annual maximum air temperature tmax and minimum air temperature tmin are approximately 24 c and 9 c respectively 2 2 swat and swat mad the swat model is a continuous time semi distributed process based and watershed scale hydrologic model arnold et al 1998 primary components include a hydrology module non point source pollution module crop growth module etc arnold et al 2012 the arcswat revision 664 developed for the arcgis 10 2 platform was used in this study irrigation in hrus may be scheduled manually by users or automatically applied by swat neitsch et al 2011 chen et al 2018a developed a more representative approach to automatically schedule irrigation and integrated a management allowed depletion mad auto irrigation method into the swat model the mad method triggers irrigation according to a user defined allowable depletion percentage of plant available water determined by the crop specific maximum rooting depth and site specific soil properties chen et al 2018a 1 mad method sol sumfc sol sw paw mad where sol sumfc is the amount of water held in the soil profile at field capacity mm sol sw is the amount of water stored in soil profile on any given day mm paw is plant available water determined by both plant maximum rooting depth and soil properties and mad is users defined water stress threshold that triggers irrigation which expressed as a decimal value ranging from 0 to 1 mad values approaching 0 indicate irrigation management that allows relatively less depletion of soil water before triggering irrigation resulting in low crop water stress by contrast values approaching 1 denote irrigation management that allows relatively more depletion of soil water before applying irrigation leading to high crop water stress in this study the swat mad model was calibrated and validated for streamflow data at two united states geological survey usgs gages and county level crop yields of both irrigated and dryland cotton the swat mad model was also evaluated by county level seasonal irrigation requirements of cotton and percolation amount the total nitrogen tn load at the watershed outlet was also calibrated and validated in this study the calibrated parameter values for the swat mad model are listed in table s1 the swat mad model calibration and validation performance statistics for monthly streamflow at the stream gages table 1 were well above the satisfactory range suggested by moriasi et al 2007 the r 2 and overall pbias were 0 21 and 2 3 when comparing swat mad simulated and observed irrigated cotton lint yield in lynn county in the dmfb watershed nass 2020 the simulated irrigation for cotton by the mad auto irrigation method 346 9 mm was very close to the local survey data of 345 4 mm nass 2020 the swat mad model simulated percolation amount was also comparable with the values from local reports and literature chen et al 2018b the nse r 2 and pbias for monthly tn load prediction at the watershed outlet during the calibration period were 0 72 0 75 and 13 8 respectively table 1 those values during the validation were 0 73 0 88 and 17 0 the model performance ratings for the monthly tn load simulations using swat mad in the dmfb watershed were considered good for both the calibration and validation periods according to moriasi et al 2007 criteria 2 3 cmip6 gcm data and scenario design observed daily climate data for the study watershed including tmax tmin solar radiation and precipitation from 1981 to 2010 were obtained for seven weather stations from the iowa environmental mesonet https mesonet agron iastate edu schoolnet future climate scenario data were obtained from 27 gcms which are provided by the world climate research program wcrp of cmip6 https esgf node llnl gov projects cmip6 the raw gcms from wcrp were in low spatial and temporal resolutions hence the downscaled and bias corrected methods developed by liu and zuo 2012 were used to generate the daily datasets the 27 cmip6 gcms were listed in table 2 in this study the water balances tn load and crop growth attributes of the watershed under climate change scenarios in the mid 21st century and the end of the 21st century were simulated two 35 year periods from 2036 to 2070 and from 2066 to 2100 were selected to conduct future scenario simulations forced with both ssp2 4 5 and ssp5 8 5 scenarios the first five years of 2036 2040 and 2066 2070 served as the warmup periods the co2 concentration in swat was modified while inputting future climate data the current version of swat does not allow inputting variable co2 concentration values that change dynamically with time and it allows only a fixed value for a period of simulation therefore according to meinshausen et al 2011 and van vuuren et al 2007 the 35 year average co2 concentrations of the future climate scenarios ssp2 4 5 and ssp5 8 5 in each of the two time periods were estimated and used as the co2 concentrations in the swat mad model the co2 concentration in the historical period was kept as the default value of 330 ppm the average co2 concentrations in the two time periods under the two ssp scenarios were shown in table 3 2 4 overall r framework design in this study post processing r codes were developed for batch processing of swat outputs of the future climate change scenarios the r code intellectualized the swat output post processing procedure compared to the conventional manual processing allowing for flexibility to obtain the climate hydrological water quality and crop growth variables of the swat model from output hru for different time steps daily monthly and yearly in this study climatic variables hydrological variables tn load and crop yield could be obtained from the monthly output hru results while the dynamic change of biomass biom and leaf area index lai had to be obtained from the daily output hru results the monthly output hru file of the swat model included both monthly and yearly results so the yearly simulation results were not needed to output separately using the newly developed r code the future climate data of 27 gcms for two time periods and two ssp scenarios were inputted into swat mad first in addition the swat mad projects were run at both the monthly and daily scales and a total of 218 output hru files were obtained all output hru files were renamed according to the user s need naming example is shown in figs s1 s2 and then saved into two folders for monthly scale and daily scale separately as for how the r tool functions firstly the function determined the position information of the output variable fig 1 the mon column was used to distinguish results between monthly yearly and multi year totals because the monthly scale output contained information on all three aspects specifically when mon column values are greater than 999 they were identified as yearly scale results simulation starting year in this case needs to be greater than 1000 a d when the value of the mon column was less than or equal to 12 and the row ordinal number was less than that of the last row for the yearly scale results monthly scale results were obtained this way the row ordinal of the mon column starting from the first row below the last row ordinal of the yearly scale results to the end of all results in the output hru file was the multi year summary results appendix s1 for the daily scale results the values of the mon column represented the day of the year doy since the lai and biomass values on the 366th day were 0 for cotton the values on the 366th day of a leap year were deleted at the daily scale which was conducive to the smooth operation of the code appendix s2 the r codes read all hru files in the folders for monthly scale and daily scale and cycled through all files in the order of file name acquisition read data data filtering save data finally the results for each time scale of 27 gcms were combined into an independent csv file for further data analysis or chart making fig 1 3 results 3 1 projected changes in the future climate of the watershed overall the long term changes in annual tmax tmin and solar radiation showed increasing trends in the dmfb watershed from 2041 to 2100 tables s2 s3 but the projected changes of annual precipitation were relatively small with the mean and median percent changes of less than 3 fig 2 especially under the 2071 2100 ssp5 8 5 scenario the mean percent changes in annual precipitation for irrigated and dryland cotton production areas were 1 5 and 1 2 and the median percent changes were 2 7 and 2 0 respectively fig 2 this study revealed that the average annual precipitation gradually increased with increasing co2 concentrations while the average annual solar radiation decreased in contrast to the ssp2 4 5 scenario the ssp5 8 5 scenario showed a greater uncertainty in predicted future climate parameters for different time scales compared to the baseline period 1981 2010 the average annual precipitation during the growing season was projected to increase by 2 0 for irrigated cotton areas and 1 7 for dryland cotton areas during 2041 2070 and those increases were 5 0 and 4 7 during 2071 2100 figs s3 s4 the average annual tmax during the growing season for irrigated cotton is expected to increase by 2 03 c 2 62 c 2 67 c and 4 55 c and the average annual tmin is projected to increase by 1 97 c 2 68 c 2 62 c and 4 89 c under the 2041 2070 ssp2 4 5 2041 2070 ssp5 8 5 2071 2100 ssp2 4 5 and 2071 2100 ssp5 8 5 scenarios respectively figs s5 and s7 the mean annual tmax for the dryland cotton growing period could rise by 2 44 c and 3 71 c and the mean annual tmin could rise by 2 47 c and 4 07 c during the period of 2041 2100 under two emission scenarios table 4 figs s6 and s8 for both cotton management practices the increases in solar radiation were greater under the ssp2 4 5 scenario than the ssp5 8 5 scenario the median percent changes in solar radiation during the growing season under the ssp2 4 5 and ssp5 8 5 scenarios were 0 6 and 0 2 for irrigated cotton and 0 7 and 0 2 for dryland cotton respectively table 5 figs s9 s10 3 2 climate change impacts on hydrology the annual actual evapotranspiration eta for dryland cotton was projected to decrease during 2041 2100 under two ssp scenarios for irrigated cotton only the 2071 2100 ssp5 8 5 scenario showed a 9 3 decrease in the mean annual eta whereas the rest of the scenarios showed slight increases fig 3 a high variation in annual eta was found among different gcms especially under the ssp5 8 5 scenario the percent changes in annual eta ranged from 4 1 to 13 9 for irrigated cotton and 29 5 to 29 4 for dryland cotton during 2071 2100 fig 3 based on the future climate data projected by 27 gcms the results showed greater uncertainty under dryland conditions than under irrigated conditions the eta indicated a higher level of uncertainty during april and september for both cotton management practices the projected changes in mean and median eta during the growing season for irrigated cotton ranged from 13 4 to 1 4 and 11 2 1 9 respectively the decrease in mean and median eta during the growing season for dryland cotton varied from 5 1 to 7 9 and 2 9 8 1 respectively figs s11 s12 the future irrigation water use showed similar increasing trends under all scenarios except for the 2071 2100 ssp5 8 5 scenario in which the median percent change in irrigation water use was 17 5 fig 3 nevertheless the magnitude of change in irrigation water use during the cotton growing season was slightly larger with values of 5 6 2 5 and 6 8 under the 2041 2070 ssp2 4 5 2041 2070 ssp5 8 5 and 2071 2100 ssp2 4 5 scenarios respectively fig s13 the change in irrigation water use decreased by 18 0 under the 2071 2100 ssp5 8 5 scenario the mean annual surface runoff in the dmfb watershed indicated an increasing trend under all climate change scenarios fig 3 under the 2041 2070 ssp2 4 5 and 2041 2070 ssp5 8 5 scenarios the mean annual surface runoff increased by 8 9 mm and 13 4 mm respectively for irrigated cotton and 11 5 mm and 17 8 mm respectively for dryland cotton during the period of 2071 2100 the annual mean surface runoff for irrigated cotton increased by 10 1 mm under the ssp2 4 5 scenario and 17 9 mm under the ssp5 8 5 scenario and the increased values for dryland cotton were 14 1 mm and 22 6 mm however the simulated surface runoff results under the ssp5 8 5 scenario exhibited substantial uncertainty for both cotton management practices for example the projected change range in surface runoff among 27 gcms was approximately 30 mm under the ssp2 4 5 scenario and it was over 60 mm under the ssp5 8 5 scenario fig 3 based on the monthly analysis the change in surface runoff during the non growing season was small and showed a low uncertainty during the growing season the maximum increase in monthly surface runoff is expected to occur in september with a high uncertainty figs s14 s15 the surface runoff changes during the growing season in irrigated areas could increase with increasing co2 concentrations results also found that the average increase in annual surface runoff differed from 1 4 mm to 2 1 mm in the mid 21st century and 1 6 mm 2 7 mm by the end of the 21st century a similar trend was observed for dryland cotton and the average surface runoff showed an annual increase from 1 8 mm to 2 8 mm in the mid 21st century and 2 2 mm 3 5 mm by the end of the 21st century the above results indicated that the hydrological cycle in the dmfb watershed was strongly influenced by future climate with a greater magnitude of changes under the ssp5 8 5 scenario 3 3 climate change effects on water quality surface runoff has been recognized as one of the common causes and transport pathways for agricultural non point source pollution and changes in surface runoff caused by climate change could affect the future tn load in the dmfb watershed the simulated results for tn load were consistent with the trend of surface runoff which showed an increasing trend in the future under four climate change scenarios the mean and median tn load for irrigated cotton increased by 0 4 kg ha 1 to 0 9 kg ha 1 and 0 3 kg ha 1 to 0 7 kg ha 1 respectively the mean and median annual tn load for dryland cotton ranged from 1 9 kg ha 1 to 2 4 kg ha 1 and from 1 7 kg ha 1 to 2 1 kg ha 1 respectively fig 4 meanwhile the two ssp emission scenarios consistently projected increasing trends in tn load during the growing season under both irrigated and dryland conditions and the change in tn load was negligible during the non growing season as expected the mean and median change in tn load during the growing season increased from 0 06 kg ha 1 to 0 13 kg ha 1 and from 0 02 kg ha 1 to 0 05 kg ha 1 irrigated cotton and from 0 30 kg ha 1 to 0 37 kg ha 1 and from 0 10 kg ha 1 to 0 18 kg ha 1 dryland cotton respectively figs s16 s17 3 4 responses of cotton yields to climate change the future cotton lint yields biomass and lai for both irrigated and dryland conditions were simulated using the swat mad model and gcm projected future climate data in the mid to late 21st century under the ssp2 4 5 and ssp5 8 5 scenarios the future cotton lint yield simulated by all gcms changed remarkably the simulated cotton lint yield in the dmfb watershed increased from 91 1 to 122 1 under irrigated conditions and from 47 5 to 84 0 under dryland conditions fig 5 compared to the results from the ssp2 4 5 scenario the ssp5 8 5 scenario showed higher co2 concentration and greater increases in cotton lint yields the simulated cotton lint yields under both irrigated and dryland conditions increased by 98 4 and 50 6 respectively under the ssp2 4 5 scenario the simulated percent changes in cotton lint yields under both irrigated and dryland conditions were 116 7 and 72 3 respectively under the ssp5 8 5 scenario table s3 dry matter accumulation is the material basis for crop yield the simulated changes in biomass approximately exhibited s shaped curves for both irrigated and dryland cotton the biomass could increase with increasing co2 concentrations and the stage of rapid biomass accumulation could occur earlier simulated biomass increased by 4 mg ha 1 to 6 4 mg ha 1 for irrigated cotton and 1 5 mg ha 1 to 2 5 mg ha 1 for dryland cotton under future scenarios compared to the historical period fig 5 the simulated lai during the baseline period 1981 2021 showed an s shape curve however lai showed a downward opening parabola during the simulation periods of 2041 2070 and 2071 2100 the simulated lai increased rapidly in the early growth stage and reached the maximum at the full development stage the simulated lai was generally lower in dryland conditions than in irrigated conditions under all scenarios fig 5 under the baseline scenario co2 330 ppm the simulated lai leveled off around doy 111 for irrigated cotton 4 6 m2 m 2 and around doy 105 for dryland cotton 2 8 m2 m 2 for irrigated cotton the lai reached a maximum value of 4 7 m2 m 2 on doy 108 and began to decline after 20 days under the 2041 2070 ssp2 4 5 scenario the trends of lai were similar under the 2071 2100 ssp2 4 5 and 2041 2070 ssp5 8 5 scenarios which reached a maximum value of 4 6 m2 m 2 on doy 84 and doy 85 respectively and began to decline on doy 127 and doy 122 respectively under the ssp5 8 5 scenario the simulated lai reached a maximum value of 4 5 m2 m 2 on doy 77 and started to decrease after one month for dryland cotton lai reached a maximum value of 3 1 m2 m 2 on doy 102 under the 2041 2070 ssp2 4 5 scenario and started to decrease after 19 days the 2071 2100 ssp2 4 5 and 2041 2070 ssp5 8 5 scenarios simulated similar trends in lai which reached a maximum value of 3 1 m2 m 2 on doy 79 and 82 and began to decline on doy 127 and 122 respectively the simulated lai reached a maximum value of 3 5 m2 m 2 on doy 77 and started to decrease after 24 days under the 2071 2100 ssp5 8 5 scenario fig 5 4 discussion the cmip6 projected air temperatures showed that the climate in the dmfb watershed could generally become warmer under most scenarios and all 27 gcms projected air temperature increases ranging from 1 5 c to 5 c by the mid to late 21st century awal et al 2016 predicted that tmin and tmax could increase by 2 c and 3 c on average in the 2055s and 2090s respectively under three greenhouse gas emissions scenarios a2 a1b and b1 in the brazos headwaters basin texas projected climate data used in this study showed that overall future precipitation remained nearly unchanged compared to the baseline venkataraman et al 2016 reported that precipitation could increase in most parts of texas by the second half of the 21st century under the rcp4 5 scenario while herrera pantoja and hiscock 2015 reported a decrease in precipitation in some semi arid areas li et al 2012 used the data from 36 gcms and reported the trend of precipitation change for the period 1950 2099 in houston texas they found that annual average precipitation could decrease apparently under the rcp8 5 scenario but remain relatively constant under the rcp2 6 scenario in this study solar radiation was found to increase noticeably by approximately 10 other studies also reported similar increasing trends in solar radiation in the future rempel et al 2021 xiao et al 2020 the results from this study showed a decrease less than 3 5 in future annual eta for dryland cotton under the ssp2 4 5 and ssp5 8 5 scenarios the projected increase in air temperatures did not lead to an increase in eta which was consistent with other long term climate change studies dinpashoh et al 2011 jhajharia et al 2015 venkataraman et al 2016 simulated annual eta for irrigated cotton showed increasing trends under all climate change scenarios except for the 2071 2100 ssp5 8 5 scenario which projected a decrease in eta by up to 9 3 the changes in eta could be directly or indirectly affected by many factors such as co2 concentrations air temperatures precipitation solar radiation irrigation managment etc therefore it was difficult to determine which single factor attributed to the changes in eta the simulated changes in irrigation water use and eta by coupling the swat mad model and gcms in the study watershed showed similar trends moreover under the 2041 2070 ssp2 4 5 2071 2100 ssp2 4 5 and 2041 2070 ssp5 8 5 scenarios the results showed an increase in simulated annual irrigation water use which was most probably due to the increase in eta while holding precipitation relatively constant however under the 2071 2100 ssp5 8 5 scenario the highest co2 concentration 807 ppm was simulated which led to the partial closure of stomatal apertures and hence inhibited transpiration conley et al 2001 leuzinger and körner 2007 bunce and nasyrov 2012 the decrease in eta in this study would then lead to reductions in the annual irrigation water use by cotton the simulated median annual surface runoff for both irrigated and dryland cotton showed evident increases under all four scenarios with greater increases under dryland conditions in the irrigated cotton areas an adequate supply of water and fertilizer would lead to better crop growth and sufficient ground cover therefore under future climate scenarios precipitation or irrigation water might be trapped by branches and leaves or used mainly for crop transpiration which would increase the cotton biomass and hence reduce the surface runoff accordingly the changes in tn load were closely correlated to surface runoff and the increase in surface runoff under future climate scenarios would inevitably increase nitrogen loss from the cotton fields and thus cause surface water pollution wei et al 2021 hanrahan et al 2021 therefore appropriate mitigation and adaptation strategies need to be implemented to reduce the negative impact of climate change on hydrology and water quality the projected climate change caused an increase in simulated cotton lint yield in the dbmf watershed which was comparable to the results reported in other studies adhikari et al 2016 kothari et al 2021 but the magnitude of increase was different this study showed increases in cotton lint yields in the range of 91 1 122 1 for irrigated cotton and 47 5 84 0 for dryland cotton which were higher than the cotton lint yield change 14 29 increase projected in the study of adhikari et al 2016 for simulation period of 2041 2070 other relative parameters such as biomass and lai were analyzed in this study to investigate possible factors that would influence the cotton lint yield the simulated maximum biomass yields for both cotton management practices were higher than the biomass yields under the respective baseline scenarios which supported the findings of increases in cotton lint yields in the future the changes in simulated lai under all four climate change scenarios demonstrated that climate change would lead to a shorter growing season in cotton as higher air temperatures could accelerate maturation and shorten the growth period sharma et al 2021 cotton plants are heat tolerant and can grow well within an optimum air temperature range and low air temperature can adversely affect the cotton lint yield the accumulated temperature 10 c might result in a positive effect on the growth and development of cotton and thus influence the final yield pettigrew 2008 li et al 2020 thereby under the ssp2 4 5 and ssp5 8 5 scenarios elevated air temperatures promoted increases in cotton lint yield the natural cotton defoliation during the baseline period was not sufficient to support direct harvesting by machinery but the early defoliation under the future climate scenarios implied an earlier shedding of cotton leaves which would potentially reduce the use of defoliants in harvesting and simplify the production processes liao et al 2020 due to the complexity of climate change issues and the limitations of human cognition the projected changes in future climate showed a high variation among different gcms there were many causes of uncertainties in climate projections e g downscaling approach gcm selection etc with the gcm selections being the primary reason for uncertainties in future climate projections lee et al 2021 gcms have different underlying assumptions and the more gcms were selected in a study the more it could reflect the variety of situations that might occur in the future lutz et al 2016 the newly developed r code can be used to extract and analyze the swat outputs more efficiently and obtain the corresponding changes in hydrology water quality and crop growth at yearly monthly and daily scales the r code accurately extracted and organized the data of all 109 scenarios in approximately 24 32 h which saved a substantial amount of labor and prevented potential errors caused by manual processing when evaluating the impact of future climate change on regional water resources and crop production it is important to use more gcms to capture the uncertainty with the continuous improvement and increase in the number of gcms this r code will become an important post processing tool for the swat users to study climate change impacts on the soil water food coupling systems 5 conclusions the changes in meteorological variables water balance components total nitrogen load and cotton growth parameters were simulated under changing climate based on 27 cmip6 gcm projections and a well calibrated swat mad model under four climate change scenarios in the dmfb watershed of the texas panhandle the simulation results demonstrated that air temperatures and solar radiation increased under future climate scenarios while the precipitation slightly decreased in future climate scenarios eta declined during the dryland cotton growing season however in the irrigated cotton growing season only in the 2071 2100 ssp5 8 5 scenario the amount of irrigation and eta showed a downward trend and the median values of the reductions were 16 3 and 11 2 respectively the irrigation amount and eta in the growing season of irrigated cotton under the other three scenarios showed an upward trend and the median percentage changes were 3 2 7 5 and 0 2 1 9 respectively clearly elevated co2 concentration was the major factor for the decrease in eta and irrigation under the 2071 2100 ssp5 8 5 scenario in addition both surface runoff and tn load increased for two cotton management practices under the four climate scenarios which increased the risk of non point source pollution in the watershed both cotton yields were expected to increase under the four climate change scenarios and the average annual increase in irrigated cotton yield was nearly double compared to that of dryland cotton yield predicting potential ecological and environmental threats in the watershed in the future enable making scientific and reasonable decisions on production and ecological protection for watershed management agencies the use of the newly developed r code has greatly improved the processing capabilities for long term multi scenario and multi variable swat mad output results and it can serve as a useful tool and provide technical support for efficiently studying the future climate change impacts software availability name of software swat post processing r tool description the swat post processing r tool was developed for batch processing of swat outputs of the future climate change scenarios allowing for flexibility to obtain the climate hydrological water quality and crop growth variables of the swat model from output hru for different time steps daily monthly and yearly developers haipeng liu and yong chen year available 2022 availability and cost open source language r funding this research was supported by the chinese universities scientific fund under award numbers 1191 15051002 1191 15052008 1191 10092004 and 1191 31051204 the research was also partially supported by the national institute of food and agriculture u s department of agriculture under award numbers nifa 2021 67019 33684 and nifa 2012 67009 19595 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported in part by the ogallala aquifer program a consortium between usda agricultural research service kansas state university texas a m agrilife research texas a m agrilife extension service texas tech university and west texas a m university appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105492 
25547,the aims of this study are to characterize river network patterns and identify whether the slope of preexisting surfaces relatively unaffected by modern landscape processes influences the formation of networks on the peninsula the distributional properties of the tributary junction angles by the beta distribution are examined and support vector machines based on the parameter estimates of the distribution are used to distinguish the different river network types the classified river networks are validated using three measures drainage area increment stream course irregularity and tributary junction angle derived from scaling invariance 41 river networks are analyzed for the characterization and classification of networks in the region among the river networks 12 networks represent the parallel network type and 29 networks represent the rectangular network type these results imply that the preexisting slope does not seem to have a main effect on the development of the networks on south korea keywords river network patterns support vector machines scaling invariance south korea preexisting slope data availability data will be made available on request 1 introduction south korea is located in east asia extending southward for approximately 1100 km from continental asia into the pacific ocean the country is surrounded by the east sea to the east and the yellow sea to the west numerous mountains and hills are a significant component of the korean landscape and sedimentary plutonic and volcanic rocks have been deposited over a complex geomorphologic and tectonic history cummings et al 2015 the main rivers in the region flow westward including the han river the geum river and the yeongsan river as the eastern part of the peninsula mostly consists of mountainous regions two other main rivers the nakdong river and seomjin river flow southward south korea is generally characterized based on the passive eastern margin of the amurian plate in northeast eurasia and is assumed to be tectonically stable heki et al 1997 jin et al 2007 the mountain ranges on the peninsula feature tectonic movement and erosional processes on existing surfaces as a major mountain range the taebaek mountains show asymmetric topography these mountains experienced initial uplift during the opening of the east sea during the oligocene middle miocene park and kim 1971 yoon and chough 1995 geomorphologists have long examined river networks as they can contain different environments and regions the development of channel networks generally depends on climatic physiographic and topographic variables which cause different network types to have particular attributes the differences among network types have encouraged the improvement of classification systems that distinguish river network types such as dendritic parallel pinnate rectangular and trellis networks abrahams and flint 1983 argialas et al 1988 ichoku and chorowicz 1994 jung et al 2015 parvis 1950 a dendritic network typically has a tree like pattern and is characterized as having a broad basin shape with moderate tributary junction angles a parallel network features a narrow basin shape and has a parallel pattern with a relatively straight stream course this type of river network has small tributaries that join the main rivers and large tributaries that merge at acute junction angles a pinnate network presents a feather like pattern based on its relatively straight stream courses and small tributaries that join the main rivers at highly acute junction angles a rectangular network is characterized by stream sinuosity resulting from numerous right angle bends with tributaries merging at right angles a trellis network has a lattice line pattern with a large number of short tributaries merging at moderate and right angles among the river networks some networks have been observed to exhibit platform self similarity presenting scaling invariance properties of the drainage networks rodriguez iturbe et al 1992 rigon et al 1996 rodriguez iturbe and rinaldo 1997 platform self similarity refers to the river network and its boundary which are features represented in the horizontal plane more descriptions about this characteristic are provided in section 3 2 fig 1 provides examples of the five drainage network types to facilitate the identification of different river network types several studies have been conducted based on the quantitative analysis of river network attributes howard 1967 investigated river network characteristics using geological interpretation and identified drainage patterns according to the structural properties of the networks argialas et al 1988 examined third order drainage networks and provided a classification tree constructed on the basis of empirical thresholds derived from river network features ichoku and chorowicz 1994 also proposed a quantitative classification system for drainage network types with 14 characteristics based on digital elevation models dems de bartolo et al 2004 studied the fractal dimensions of channel networks to assess the supplementary angle with howard s junction angle at given hierarchical orders and de bartolo et al 2016 examined grid networks and channel networks to identify topological features by considering the average junction degree mejía and niemann 2008 used three measures including drainage area increment stream course irregularity and tributary junction angle which are based on planform geometry to identify five river network types in a more recent study jung et al 2019 presented another quantitative classification approach using a support vector machine and a beta distribution of tributary junction angles pereira claren et al 2019 studied river network properties in high relief environments and other network types considering vertical and horizontal network properties most studies however have focused on drainage networks in the united states of america usa and river networks in other regions such as south korea have rarely been examined in terms of drainage network patterns based on the quantitative classification method due to the different conditions that influence the development of river networks several quantitative and experimental studies have been carried out to provide a better understanding of network attributes mosley 1974 conducted an experimental study by constructing a large flume 15 3 9 2 m and identified that dendritic patterns occur at a low surface slope while parallel network patterns occur at a large surface slope when artificial precipitation is generated moreover phillips and schumm 1987 performed another experimental analysis based on a flume 2 3 m by increasing the initial surface slope in this study transitions between a dendritic network at 1 slope subdendritic network at 2 slope subparallel network at 3 slope and parallel network at 5 slope were observed and the authors determined that the change from the dendritic pattern to the parallel pattern can occur at a low slope khan et al 2016 examined topographic relief catchments based on the dem analysis and the aerial photographs analysis for applicable of hydrologic response units in river networks li et al 2020 improved a d8 compatible high efficient approach to determine channel heads which is identified as the geomorphological change point by calculating the geomorphologic parameter series along with flow paths to analyze the conditions affecting river network development natural river basins were also investigated in nonarid regions such as colorado tennessee utah and wyoming and arid regions such as arizona and california jung et al 2011 jung and ouarda 2017 for the river networks in nonarid regions a transition between dendritic and parallel networks was identified and the parallel network type was observed when the preexisting slope exceeded approximately 3 details on the preexisting slope will be described in the methodology section for the river networks in arid regions the pinnate network pattern was observed at a low preexisting slope and in association with an erodible surface investigating drainage network types with their properties is to provide precious information on developing hydrological models which can be used to improve flood quantile estimation for preparing for flood disasters regional flood frequency analysis as a hydrological model is generally applied in the field of water resources and hydrology to transfer hydrological information from gauged sites to ungauged sites haddad and rahman 2012 hosking and wallis 1993 this analysis is commonly comprised of two procedures delineation of homogenous groups and hydrological information transfer within the groups alobaidi et al 2015 durocher et al 2016 the quality of the hydrological information the final estimate depends on the quality of the homogenous groups the delicate tradeoff is sought between the homogeneous level and the amount of information derived from the geomorphological analysis the homogenous groups can be defined as the same river network types where hydrological and geomorphological properties seem to be similar also the regional frequency analysis process can be enhanced when the proper estimation of the physiographical features from the gauged sites is gained the results from the present work in defining river network patterns in south korea will be worth doing further research on the improvement of hydrological models to manage water resources and water related disasters in the future the objectives of the present study are to classify the river network patterns on south korea which has various geological and geomorphological features and four distinct seasons and determine whether the preexisting slope may affect the occurrence of network types the classification of river networks is performed based on the beta distribution of the tributary junction angles the shape parameters of the distributions are used to distinguish among the different networks with support vector machines svms in addition the measures derived from scaling invariance are applied for the validation of the classified river network types then the preexisting slopes are estimated to identify the specific conditions under which the river basins on south korea develop 2 data set a dataset of 41 river networks on south korea was obtained to perform river network classification the 41 networks representing significant river basins in the area were selected based on previous studies involving flood and low flow quantile estimation and river network characterization to manage water resources ahn and lyu 2017 cho et al 2007 kim et al 2016 table 1 presents the locations of the outlet drainage area main channel length and mean basin slope for each river network the average basin area is 794 km2 ranging from 44 to 6771 km2 the average main channel length is 60 km ranging from 13 to 284 km and the average mean basin slope is 0 338 ranging from 0 106 to 0 464 the outlets of the 41 river networks used in the present study for the analysis of the network features are shown in fig 2 to examine the drainage networks on south korea dems were acquired from the advanced spaceborne thermal emission and reflection radiometer aster satellite which represents the global dem these dems have a horizontal resolution of 1 arc second and contain approximately 30 m grid cells and are widely applied in river network studies ijjasz vasquez and bras 1995 moglen and bras 1995 o callaghan and mark 1984 pereira claren et al 2019 after we obtained the dems for each network the flow direction was estimated considering different elevations and the contributing area was approximated by summing all grid cells to identify a watershed of interest then the flow direction and contributing area were used for river network classification it should be noted that mejía and niemann 2008 analyzed river network patterns using different grid cells with measurements on the basis of scaling invariance mejía and niemann 2008 and jung and ouarda 2017 reported that the different resolutions do not affect the classification in their analysis as the river networks used for the present work have different grid cell dimensions the average dimensions are estimated based on the east west south and north boundaries for each river network using the eight flow direction method 3 methodology 3 1 classification of river network types 3 1 1 estimation of tributary junction angles to analyze the drainage network patterns on south korea we use one of the most important properties of river networks the tributary junction angle the tributary junction angle has been previously used to characterize various drainage networks hackney and carling 2011 jung et al 2015 phillips and schumm 1987 in general the dendritic network type has moderate junction angles while the parallel and pinnate network types present acute junction angles the rectangular and trellis network patterns have an abundance of nearly right junction angles the calculation of the tributary junction angles is based on the primary and secondary tributaries identified for the classification of the river networks jung et al 2015 mejía and niemann 2008 the primary tributary can be distinguished using a chord between a junction and a point defined by the upstream direction with the euclidean distance from the junction on the larger tributary while the secondary tributary can be estimated using a chord between a junction and a point defined by the upstream direction with the distance from the junction on the smaller tributary these two tributaries were applied for the identification of river network development based on incision rates niemann et al 2001 and the ratios between the slopes and magnitudes of the tributaries were analyzed to identify the features of the junction angles pieri 1984 a more detailed description of the junction angle estimation procedure including a figure is presented in section 3 3 3 1 2 beta distribution in the present study we use the beta distribution of tributary junction angles calculated from the primary and secondary tributaries for the classification of river networks the beta distribution of the angles was applied for identification of the drainage network patterns jung et al 2019 and this distribution has been used for examination and classification in geomorphology and hydrology arai et al 1995 bhunya et al 2004 in classification analysis based on the beta distribution two shape parameters are used by determining natural patterns and processes gupta and nadarajah 2004 the tributary junction angles have a range of 0 180 indicating a decent fit for the analysis and the angles are rescaled to from 0 to 1 to apply the beta distribution the equation to rescale the angles is as follows 1 x θ 180 where x indicates the rescaled tributary junction angles and θ represents the original junction angles the probability density function based on the beta distribution of the rescaled angles can be estimated using the following equation 2 f x α β γ α β γ α γ β x α 1 1 x β 1 where α is the 1st shape parameter β is the 2nd shape parameter and γ is the gamma function in the beta distribution the maximum likelihood approach is applied to fit the distribution as this method has good performance in fitting the beta distribution with two parameters gupta and nadarajah 2004 owen 2008 with the maximum likelihood method estimates of the parameters are obtained and applied for river network classification 3 1 3 support vector machine svms which represent supervised machine learning classifiers are used to distinguish between various river networks on south korea after obtaining estimates of the two parameters derived from the beta distribution of the angles svms have been commonly used for classification analysis in various fields furey et al 2000 kavzoglu and colkesen 2009 melgani and bruzzone 2004 by maximizing the margin indicating the distance between any two groups the method can provide a classifier for classification analysis this distance can be defined by the distance of support vectors indicating the closest vector to other groups svms aim to define a function to identify whether a weighted value w is within the target value y i additionally the maximum deviation δ is determined for a given input value x i based on training data the following equation provides the function of the svms 3 f x w t x i b where t is the transpose of w and b is the basis based on this function a slack variable ξ i is applied to solve an optimization issue by finding the hyperplane that maximizes the margin of the support vectors to identify a solution for the optimization issue the function can be solved by using the following equation 4 m i n 1 2 w 2 c i 1 m ξ i 5 s u b j e c t t o y i f θ i 1 ξ i ξ i 0 where c is a parameter that identifies a penalty for an error with a generalization level θ i represents the parameter estimates of the beta distribution using the tributary junction angles and y i is an indicator used to define any groups to which a vector belongs the slack variable which permits the use of linearly inseparable data has the following conditions 6 ξ 0 i f ξ δ ξ δ o t h e r w i s e based on the svms the error correcting output code ecoc multiclass model is used for the classification of drainage networks this model provides a classification system with several binary classifiers dietterich and bakiri 1994 escalera et al 2009 the overall procedure for the analysis of the drainage network classification is shown in fig 3 3 2 evaluation of classified river networks for the river networks classified using the svms based on beta distribution parameters we validate the networks based on measures of scaling invariance the use of measures involving river network properties such as the drainage area increment stream course irregularity and tributary junction angle in network classification analysis was proposed by mejía and niemann 2008 of note the authors distinguished between self similar and self affine networks the horizontal features of a subbasin in a self similar network appear to be statistically similar to the same features of a larger basin if the small basin is isotropically rescaled on the other hand a self affine network can be identified if the same is true when the subbasin is anisotropically rescaled a self similar network can be of the dendritic rectangular and trellis network types while a self affine network can be of the parallel and pinnate network types for the scaling invariance measures the drainage area increment is used to determine the horizontal characteristics of the river basins as the first measure this measure is based on the basin area and is written as follows 7 a l d r 2 a r l where l represents the euclidean or linear distance between the outlet of a small basin and the main stream source and r is a rescaling factor associated with the linear sizes of the small and larger basins the symbol d means that the left and right sides of the equation have statistically identical distributions for this measure one can consider a site that is the euclidean distance l from the source of the main stream and an associated upstream site that is the euclidean distance l bl from the same site where b is a factor used to determine the scale of the drainage area increment then the area a l bl which produces the denotation of δ a b l l is used for the analysis to estimate δ a b l l l 2 the plot of δ a b l l l 2 against l is then examined to distinguish between self similar and self affine network types stream course irregularity is used as the second measure derived from scaling invariance in this study the standard deviation of lengths perpendicularly estimated from stream segments of the subbasin represents the stream course irregularity the equation of this measure is as follows 8 σ l d r 1 σ b l r l where σ b l is the standard deviation of the lengths based on the same process as the drainage area increment we obtain σ b l l l and plot σ b l l l against l for the river network classification procedure the tributary junction angle is used as the third measure associated with scaling invariance by considering any point where the channels merge with the primary and secondary tributaries the associated equation is as follows 9 ψ b b l d ψ r b r b r l where ψ represents the junction angle and the subscript of this symbol indicates a factor that can control the chord length of the tributaries based on this equation one can obtain the denotation of ψ b l b l t l where l is the distance to the source of the main stream for the primary tributary and lt is the distance to the source of the main stream for the secondary tributary the plot of ψ b l b l t l against l is then used to identify the river network types fig 4 presents the three measures detailed information on the calculation of the measures can be found in the paper by mejía and niemann 2008 3 3 calculation of preexisting topographic slope to identify the conditions influencing the formation of the river networks the preexisting slope is estimated on the basis of the preexisting surfaces the preexisting slope can be defined as the slope that presents portions of the area remaining relatively unaffected by the modern landscape evolution of the topography jung et al 2011 in the study by jung et al 2011 they examined the preexisting slope to identify the typical conditions such as the initial slope of the topography that can affect the development of river networks the preexisting slope is estimated by determining locations based on small drainage areas which can be assumed to have been altered from hillslope procedures the hillslopes are known to be locations of channel heads in a river basin and are calculated with the application of laplace curvature by identifying specified thresholds related to the curvature such curvature is defined using the following equation 10 k f x x f y y where f x x and f y y are the second order derivatives based on the x and y directions in terms of elevation in a river basin it should be noted that positive curvature seems to be associated with locations generated by hillslope processes while negative curvature tends to be associated with locations influenced by valley networks evans 1972 mitášová and hofierka 1993 in this work we follow the processes used by jung et al 2011 with the values of thresholds considering evolution and hillslope procedures to obtain information on the preexisting surfaces after the preexisting surfaces are determined the average slope between a grid cell and its downstream cell in the surface is estimated the average slope is used as the preexisting slope to identify the conditions affecting the development of river networks 4 results for classification 4 1 river network classification the classification of the river networks on south korea is carried out using svms based on the parameter estimates α and β derived from the beta distribution of the tributary junction angles in this study the classification diagram developed from the svms with the estimates from the analysis performed by jung et al 2019 is applied to distinguish the various networks as shown in fig 5 a note that the parameters of the beta distribution appear as exponents of the random variable parameterized by two shape parameters and are determined based on the maximum likelihood method by fitting the beta distribution as the study by owen 2008 the boundaries for the classification diagram can be identified using the svm which provides classifiers maximizing the margin between groups in this study the groups are determined from the two shape parameters that can show the properties of the river networks the diagram is proposed based on the five river network types described in previous studies and its applicability for the identification of network patterns has been demonstrated the classification diagram shows that four groups can be identified the dendritic parallel and pinnate river network types are clearly grouped while the rectangular and trellis network patterns seem to be difficult to distinguish this might be because the latter two network types are characterized by abundant right angles and the distributional properties of the junction angles tend not to be sufficient for the identification of any patterns although the rectangular and trellis patterns tend to be indistinct according to this methodology they are physically different and can be distinguished using other river network characteristics such as stream course irregularity fig 5 b presents the results indicating the river network types of the river basins considered in the present study based on the classification diagram among the 41 evaluated river basins 12 networks are classified as parallel networks whereas 29 are determined to be rectangular and trellis networks parameter α for the parallel networks ranges from 2 985 to 2 572 with an average value of 2 705 parameter β for the same network type ranges from 7 639 to 6 111 with an average value of 6 605 on the other hand parameter α ranges between 2 601 and 2 095 with an average value of 2 303 and parameter β ranges between 5 960 and 4 659 with an average of 5 412 for the rectangular and trellis networks table 2 a provides the two parameters for each network and table 2 b presents the maximum minimum and average values of the parameters for the different river network types based on fig 6 we tried to identify the characteristics of the tributary junction angles for the parallel networks and the rectangular and trellis networks for the comparison we examine the box plots using the angles for the 41 river basins in south korea fig 6 shows the box plots of the angles for the different river network types determined from the classification diagram for the parallel networks the range between the upper quartile and the lower quartile seems to be narrower than this range for the rectangular and trellis networks for example im gy dy and gj in the parallel network type show the narrower ranges of the angles while bo ep ad ms and nj in the rectangular and trellis network type present the wider range of the angle although the values are more or less similar for the cases most of the median values for the parallel networks seem to be less than 50 and most of the median values for the rectangular and trellis networks tend to be more than 50 moreover most of the maximum values of the junction angles seem to be lower than 150 for the parallel type while most of these values tend to be larger than 150 for the rectangular and trellis types the rectangular and trellis networks present a number of outliers representing junction angles above 150 the differences in the features of the angles of the parallel network and the rectangular and trellis networks cause their distinct classification and provide meaning for understanding geomorphological processes 4 2 evaluation of classified network to validate the river network classification procedure proposed in this study three measures based on the drainage area increment stream course irregularity and tributary junction angles are used mejía and niemann 2008 proposed a classification tree derived from each river network type and jung and ouarda 2017 used this method to characterize the network types in arid and semiarid regions fig 7 presents the classification approach using the three measures when the slope of the stream course irregularity is smaller than 0 091 we can distinguish parallel and pinnate networks from dendritic rectangular and trellis networks based on the tributary junction angle of 0 01 the parallel and pinnate networks can be further classified using the average value of the stream course irregularity 0 0175 the dendritic and trellis networks can be distinguished from the rectangular network an average drainage area increment of 0 1347 can be used to classify dendritic and trellis networks based on the classification tree the 29 rectangular and trellis networks identified on the basis of the svm diagram are classified as rectangular networks these river networks have slopes of stream course irregularity below 0 091 and average stream course irregularity above 0 0175 the 12 parallel networks are also identified using the tree and the svm diagram table 3 shows the data on the slope of the stream course irregularity average stream course irregularity and tributary junction angle used for the classification of the river basins according to the three measures based on scaling invariance the self similar and self affine networks can be distinguished fig 8 shows a plot of the average values for the three measures based on δ a b l l l 2 σ b l l l and ψ b l b l t l as a function of l in the parallel networks in the figure the dashed lines are the regression lines the figure indicates that the drainage area increment and stream course irregularity produce negative slopes indicating that the networks are characterized by self affinity with acute junction angles the tributary junction angle has a positive slope indicating that the networks are classified as being of the parallel network type instead of the pinnate network type fluctuations are observed at large basin scales because fewer channels affect the estimation of the average measures when large basin lengths occur fig 9 includes plots of the average values for the measures similar to the figure for the parallel networks in this figure we can identify that most of the plots seem to be approximately horizontal based on the drainage area increment and stream course irregularity the trend of the regression line shown in this figure indicates that the river basins are characterized by self similarity rectangular networks tend to have more irregular stream courses than parallel networks figs 8 and 9 therefore provide the identification of the drainage network types based on the three measures for instance the stream course irregularity shows the negative slope and the tributary junction angle presents the positive slope for hyoryeong gyeongan wonju and imokjeonggyo in fig 8 this information provides the river network classification as the parallel type on the other hand the stream course irregularity shows the positive slope or horizontal line for yeongwol misung goesan dam and epyunggyo in fig 9 the information from fig 9 represents the networks as the rectangular or trellis types in the present study fig 10 presents the indication of the classified river networks including the parallel network and the rectangular network in south korea 5 discussion an analysis of 41 river networks on south korea is conducted here to determine how the preexisting slope affects their development fig 11 provides examples of the preexisting surfaces associated with the parallel and rectangular networks examined in this study based on the preexisting surfaces the preexisting slope is estimated by averaging the slope calculated between each grid cell and its downstream neighbor in this figure the goro river basin representing parallel networks has a slope of 2 49 and the epyunggyo river basin representing rectangular networks has a slope of 2 04 the preexisting slopes of the parallel networks range between 1 84 and 2 89 with an average of 2 26 jung et al 2011 identified that self affine networks including parallel networks can occur when the preexisting slope is above 3 00 phillips and schumm 1987 indicated that a transition in the network form between 2 00 and 3 00 occurred in an experimental study a transition from a dendritic network at a 1 slope a subdendritic network at a 2 slope to a subparallel network at a 3 slope was observed thus it is possible that the networks classified as parallel can share characteristics with the subparallel networks moreover the slopes of the rectangular network range from 1 52 to 2 92 with an average of 1 99 jung et al 2011 suggested that self similar networks can occur when the preexisting slope is below 3 00 the rectangular networks analyzed in the present study seem to have a small preexisting slope similar to the self similar networks the preexisting slope tends not to significantly affect the occurrence of the rectangular network type since the dendric network type is also characterized by a small slope in a recent study pereira claren et al 2019 examined high relief environments where more conditions can influence the development of river basins by comparing them to low relief environments and proposed that other river network forms can exist the authors determined that three different network types including herringbone barbed and high relief pinnate networks can be observed based on the analysis of landcover climate and geology in south korea which is a part of the korean peninsula flooding is the most common water related disaster derived from geomorphological conditions characterized by high mountains with steep slopes ex jiri mountain height 1 950m seorak mountain height 1 708m and deogyu mountain height 1 614m the topography and limited drainage capacity with the monsoon climate result in huge flood damages and high flood risk lei et al 2021 although the flood estimation models for quantiles are required to design flood protection infrastructures by focusing on characteristics of discharge with geomorphology the rainfall runoff models are commonly used to investigate the amount of flood for hydrological structures in south korea most advanced research in other countries have focused on developing hydrological models such as the regional flood frequency analysis model based on hydrological and geomorphological features to improve the flood quantile estimates at ungauged sites chebana and ouarda 2008 jung et al 2021 msilini et al 2022 shu and ouarda 2007 by determining the patterns of korean river networks with their properties the model for the regional flood frequency analysis can be enhanced in estimating flood quantiles and eventually can provide better information on the design of the hydrological structures against the flood disasters in south korea the innovation of this study is the provision of a better understanding of river network properties in south korea based on several methodologies the peninsula has geographical importance and is located in northeast asia between china and japan it also includes a climate with four distinct seasons and mountains covering 70 percent of korea these characteristics cause water related disasters such as floods and droughts thus the identification of river network characteristics in the peninsula can help develop hydrological models including regional hydrological frequency analysis to control water resources affected by peninsular properties in the regional frequency analysis it is significant to define homogenous regions that can enhance the quality of the final hydrological estimate if the region is relatively small it may not have enough information content for developing hydrological models on the other hand if the region is relatively large the level of homogeneity based on hydrological characteristics may be significantly reduced although new statistical approaches have been analyzed to define homogenous regions the physiographical variables that improve model performance have not substantially evolved significant gains can be obtained from the definition of the regions using the river network features and integration of new variables jung et al 2021 investigated the homogenous regions defined by the river network types and enhanced the quality of the hydrological estimate using the river network features which are decidedly correlated with hydrological dynamics in drainage networks of the usa the geomorphological results derived from the application of the methodology and analysis in the present work contribute crucial information to the practical hydrological field in south korea based on the understanding of river network characterization in addition jung et al 2019 proposed a new classification system for the river network patterns by only focusing on the channel networks in the usa jung et al 2019 used the tributary junction angle for classification but they did not identify the preexisting slope for the river network property in the present study we classify drainage network types in south korea that have rarely been investigated for the classification of the networks using two robust classification methods we apply three network features including the drainage area increment stream course irregularity and tributary junction angle to distinguish between the different networks the geomorphological conditions that influence the development of river networks are also examined to provide a better understanding of the network characteristics in the peninsula which has not been analyzed in previous studies the relevance of the river basin characteristics in the hydrological frequency analysis will be investigated as future work for water resource management in the peninsula 6 conclusions in the present work 41 river basins on south korea are investigated for classification and characterization the parameter estimates derived from the beta distribution of the tributary junction angles are applied to provide a classification diagram based on the svm model furthermore three measures including drainage area increment stream course irregularity and tributary junction angle based on scaling invariance are used to validate the classified river networks the slope of the preexisting surfaces is estimated and analyzed to assess the conditions under which river networks develop in this region the river networks examined in this study are classified as parallel networks and rectangular and trellis networks on the basis of the beta distribution parameters implemented in svms among the 41 examined river networks 12 have parallel network patterns and 29 have rectangular and trellis network patterns this approach exhibits a limitation in distinguishing between rectangular networks and trellis networks since the distributional features of the junction angles seem to be similar an analysis of the box plots based on the angles for the classified river networks is performed to identify differences the parallel networks present a small range between the upper and lower quartiles and most of the angles tend to be lower than 150 on the other hand the rectangular and trellis networks show a large range between the upper and lower quartiles and have a large number of angles above 150 in addition three measures producing the classification tree are used to validate the classified networks based on this methodology the rectangular network type is determined in the rectangular and trellis networks grouped by the svm diagram the parallel network type is identified as the result of the svm model from the analysis of the preexisting slope we determine that the parallel network type as a self affine network presents an average slope of 2 26 and the rectangular network type as a self similar network shows an average slope of 1 99 both network types on south korea are characterized by a low preexisting slope in the drainage networks in this area other factors including geologic and climatic features rather than slope seem to affect the occurrence of the different networks future research should focus on improving this classification system in terms of distinguishing the various river network patterns secondary tributary lengths may be applied for the construction of the classification diagram with the svm model as this network feature was investigated in the analysis performed by jung et al 2015 additionally regional factors related to the development of river basins in korea considering peninsular properties can be integrated other methodologies such as high relief characterization of networks can be used to characterize more specific network types software information name of software and data set support vector machines using the statistical and machine learning toolbox in matlab https www mathworks com help stats and digital elevation models dems from the global dem derived from the data of advanced spaceborne thermal emission and reflection radiometer aster satellite https asterweb jpl nasa gov contact name kichul jung telephone 82 44 415 7965 email address kcjung kei re kr hardware required ibm pc software required matlab and arc gis availability and cost free declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the national research foundation of korea nrf grant funded by the korea government msit nrf 2019r1a2c1007447 and by korea environment industry technology institute keiti through aquatic ecosystem conservation research program or project funded by korea ministry of environment moe 2022003050007 
25547,the aims of this study are to characterize river network patterns and identify whether the slope of preexisting surfaces relatively unaffected by modern landscape processes influences the formation of networks on the peninsula the distributional properties of the tributary junction angles by the beta distribution are examined and support vector machines based on the parameter estimates of the distribution are used to distinguish the different river network types the classified river networks are validated using three measures drainage area increment stream course irregularity and tributary junction angle derived from scaling invariance 41 river networks are analyzed for the characterization and classification of networks in the region among the river networks 12 networks represent the parallel network type and 29 networks represent the rectangular network type these results imply that the preexisting slope does not seem to have a main effect on the development of the networks on south korea keywords river network patterns support vector machines scaling invariance south korea preexisting slope data availability data will be made available on request 1 introduction south korea is located in east asia extending southward for approximately 1100 km from continental asia into the pacific ocean the country is surrounded by the east sea to the east and the yellow sea to the west numerous mountains and hills are a significant component of the korean landscape and sedimentary plutonic and volcanic rocks have been deposited over a complex geomorphologic and tectonic history cummings et al 2015 the main rivers in the region flow westward including the han river the geum river and the yeongsan river as the eastern part of the peninsula mostly consists of mountainous regions two other main rivers the nakdong river and seomjin river flow southward south korea is generally characterized based on the passive eastern margin of the amurian plate in northeast eurasia and is assumed to be tectonically stable heki et al 1997 jin et al 2007 the mountain ranges on the peninsula feature tectonic movement and erosional processes on existing surfaces as a major mountain range the taebaek mountains show asymmetric topography these mountains experienced initial uplift during the opening of the east sea during the oligocene middle miocene park and kim 1971 yoon and chough 1995 geomorphologists have long examined river networks as they can contain different environments and regions the development of channel networks generally depends on climatic physiographic and topographic variables which cause different network types to have particular attributes the differences among network types have encouraged the improvement of classification systems that distinguish river network types such as dendritic parallel pinnate rectangular and trellis networks abrahams and flint 1983 argialas et al 1988 ichoku and chorowicz 1994 jung et al 2015 parvis 1950 a dendritic network typically has a tree like pattern and is characterized as having a broad basin shape with moderate tributary junction angles a parallel network features a narrow basin shape and has a parallel pattern with a relatively straight stream course this type of river network has small tributaries that join the main rivers and large tributaries that merge at acute junction angles a pinnate network presents a feather like pattern based on its relatively straight stream courses and small tributaries that join the main rivers at highly acute junction angles a rectangular network is characterized by stream sinuosity resulting from numerous right angle bends with tributaries merging at right angles a trellis network has a lattice line pattern with a large number of short tributaries merging at moderate and right angles among the river networks some networks have been observed to exhibit platform self similarity presenting scaling invariance properties of the drainage networks rodriguez iturbe et al 1992 rigon et al 1996 rodriguez iturbe and rinaldo 1997 platform self similarity refers to the river network and its boundary which are features represented in the horizontal plane more descriptions about this characteristic are provided in section 3 2 fig 1 provides examples of the five drainage network types to facilitate the identification of different river network types several studies have been conducted based on the quantitative analysis of river network attributes howard 1967 investigated river network characteristics using geological interpretation and identified drainage patterns according to the structural properties of the networks argialas et al 1988 examined third order drainage networks and provided a classification tree constructed on the basis of empirical thresholds derived from river network features ichoku and chorowicz 1994 also proposed a quantitative classification system for drainage network types with 14 characteristics based on digital elevation models dems de bartolo et al 2004 studied the fractal dimensions of channel networks to assess the supplementary angle with howard s junction angle at given hierarchical orders and de bartolo et al 2016 examined grid networks and channel networks to identify topological features by considering the average junction degree mejía and niemann 2008 used three measures including drainage area increment stream course irregularity and tributary junction angle which are based on planform geometry to identify five river network types in a more recent study jung et al 2019 presented another quantitative classification approach using a support vector machine and a beta distribution of tributary junction angles pereira claren et al 2019 studied river network properties in high relief environments and other network types considering vertical and horizontal network properties most studies however have focused on drainage networks in the united states of america usa and river networks in other regions such as south korea have rarely been examined in terms of drainage network patterns based on the quantitative classification method due to the different conditions that influence the development of river networks several quantitative and experimental studies have been carried out to provide a better understanding of network attributes mosley 1974 conducted an experimental study by constructing a large flume 15 3 9 2 m and identified that dendritic patterns occur at a low surface slope while parallel network patterns occur at a large surface slope when artificial precipitation is generated moreover phillips and schumm 1987 performed another experimental analysis based on a flume 2 3 m by increasing the initial surface slope in this study transitions between a dendritic network at 1 slope subdendritic network at 2 slope subparallel network at 3 slope and parallel network at 5 slope were observed and the authors determined that the change from the dendritic pattern to the parallel pattern can occur at a low slope khan et al 2016 examined topographic relief catchments based on the dem analysis and the aerial photographs analysis for applicable of hydrologic response units in river networks li et al 2020 improved a d8 compatible high efficient approach to determine channel heads which is identified as the geomorphological change point by calculating the geomorphologic parameter series along with flow paths to analyze the conditions affecting river network development natural river basins were also investigated in nonarid regions such as colorado tennessee utah and wyoming and arid regions such as arizona and california jung et al 2011 jung and ouarda 2017 for the river networks in nonarid regions a transition between dendritic and parallel networks was identified and the parallel network type was observed when the preexisting slope exceeded approximately 3 details on the preexisting slope will be described in the methodology section for the river networks in arid regions the pinnate network pattern was observed at a low preexisting slope and in association with an erodible surface investigating drainage network types with their properties is to provide precious information on developing hydrological models which can be used to improve flood quantile estimation for preparing for flood disasters regional flood frequency analysis as a hydrological model is generally applied in the field of water resources and hydrology to transfer hydrological information from gauged sites to ungauged sites haddad and rahman 2012 hosking and wallis 1993 this analysis is commonly comprised of two procedures delineation of homogenous groups and hydrological information transfer within the groups alobaidi et al 2015 durocher et al 2016 the quality of the hydrological information the final estimate depends on the quality of the homogenous groups the delicate tradeoff is sought between the homogeneous level and the amount of information derived from the geomorphological analysis the homogenous groups can be defined as the same river network types where hydrological and geomorphological properties seem to be similar also the regional frequency analysis process can be enhanced when the proper estimation of the physiographical features from the gauged sites is gained the results from the present work in defining river network patterns in south korea will be worth doing further research on the improvement of hydrological models to manage water resources and water related disasters in the future the objectives of the present study are to classify the river network patterns on south korea which has various geological and geomorphological features and four distinct seasons and determine whether the preexisting slope may affect the occurrence of network types the classification of river networks is performed based on the beta distribution of the tributary junction angles the shape parameters of the distributions are used to distinguish among the different networks with support vector machines svms in addition the measures derived from scaling invariance are applied for the validation of the classified river network types then the preexisting slopes are estimated to identify the specific conditions under which the river basins on south korea develop 2 data set a dataset of 41 river networks on south korea was obtained to perform river network classification the 41 networks representing significant river basins in the area were selected based on previous studies involving flood and low flow quantile estimation and river network characterization to manage water resources ahn and lyu 2017 cho et al 2007 kim et al 2016 table 1 presents the locations of the outlet drainage area main channel length and mean basin slope for each river network the average basin area is 794 km2 ranging from 44 to 6771 km2 the average main channel length is 60 km ranging from 13 to 284 km and the average mean basin slope is 0 338 ranging from 0 106 to 0 464 the outlets of the 41 river networks used in the present study for the analysis of the network features are shown in fig 2 to examine the drainage networks on south korea dems were acquired from the advanced spaceborne thermal emission and reflection radiometer aster satellite which represents the global dem these dems have a horizontal resolution of 1 arc second and contain approximately 30 m grid cells and are widely applied in river network studies ijjasz vasquez and bras 1995 moglen and bras 1995 o callaghan and mark 1984 pereira claren et al 2019 after we obtained the dems for each network the flow direction was estimated considering different elevations and the contributing area was approximated by summing all grid cells to identify a watershed of interest then the flow direction and contributing area were used for river network classification it should be noted that mejía and niemann 2008 analyzed river network patterns using different grid cells with measurements on the basis of scaling invariance mejía and niemann 2008 and jung and ouarda 2017 reported that the different resolutions do not affect the classification in their analysis as the river networks used for the present work have different grid cell dimensions the average dimensions are estimated based on the east west south and north boundaries for each river network using the eight flow direction method 3 methodology 3 1 classification of river network types 3 1 1 estimation of tributary junction angles to analyze the drainage network patterns on south korea we use one of the most important properties of river networks the tributary junction angle the tributary junction angle has been previously used to characterize various drainage networks hackney and carling 2011 jung et al 2015 phillips and schumm 1987 in general the dendritic network type has moderate junction angles while the parallel and pinnate network types present acute junction angles the rectangular and trellis network patterns have an abundance of nearly right junction angles the calculation of the tributary junction angles is based on the primary and secondary tributaries identified for the classification of the river networks jung et al 2015 mejía and niemann 2008 the primary tributary can be distinguished using a chord between a junction and a point defined by the upstream direction with the euclidean distance from the junction on the larger tributary while the secondary tributary can be estimated using a chord between a junction and a point defined by the upstream direction with the distance from the junction on the smaller tributary these two tributaries were applied for the identification of river network development based on incision rates niemann et al 2001 and the ratios between the slopes and magnitudes of the tributaries were analyzed to identify the features of the junction angles pieri 1984 a more detailed description of the junction angle estimation procedure including a figure is presented in section 3 3 3 1 2 beta distribution in the present study we use the beta distribution of tributary junction angles calculated from the primary and secondary tributaries for the classification of river networks the beta distribution of the angles was applied for identification of the drainage network patterns jung et al 2019 and this distribution has been used for examination and classification in geomorphology and hydrology arai et al 1995 bhunya et al 2004 in classification analysis based on the beta distribution two shape parameters are used by determining natural patterns and processes gupta and nadarajah 2004 the tributary junction angles have a range of 0 180 indicating a decent fit for the analysis and the angles are rescaled to from 0 to 1 to apply the beta distribution the equation to rescale the angles is as follows 1 x θ 180 where x indicates the rescaled tributary junction angles and θ represents the original junction angles the probability density function based on the beta distribution of the rescaled angles can be estimated using the following equation 2 f x α β γ α β γ α γ β x α 1 1 x β 1 where α is the 1st shape parameter β is the 2nd shape parameter and γ is the gamma function in the beta distribution the maximum likelihood approach is applied to fit the distribution as this method has good performance in fitting the beta distribution with two parameters gupta and nadarajah 2004 owen 2008 with the maximum likelihood method estimates of the parameters are obtained and applied for river network classification 3 1 3 support vector machine svms which represent supervised machine learning classifiers are used to distinguish between various river networks on south korea after obtaining estimates of the two parameters derived from the beta distribution of the angles svms have been commonly used for classification analysis in various fields furey et al 2000 kavzoglu and colkesen 2009 melgani and bruzzone 2004 by maximizing the margin indicating the distance between any two groups the method can provide a classifier for classification analysis this distance can be defined by the distance of support vectors indicating the closest vector to other groups svms aim to define a function to identify whether a weighted value w is within the target value y i additionally the maximum deviation δ is determined for a given input value x i based on training data the following equation provides the function of the svms 3 f x w t x i b where t is the transpose of w and b is the basis based on this function a slack variable ξ i is applied to solve an optimization issue by finding the hyperplane that maximizes the margin of the support vectors to identify a solution for the optimization issue the function can be solved by using the following equation 4 m i n 1 2 w 2 c i 1 m ξ i 5 s u b j e c t t o y i f θ i 1 ξ i ξ i 0 where c is a parameter that identifies a penalty for an error with a generalization level θ i represents the parameter estimates of the beta distribution using the tributary junction angles and y i is an indicator used to define any groups to which a vector belongs the slack variable which permits the use of linearly inseparable data has the following conditions 6 ξ 0 i f ξ δ ξ δ o t h e r w i s e based on the svms the error correcting output code ecoc multiclass model is used for the classification of drainage networks this model provides a classification system with several binary classifiers dietterich and bakiri 1994 escalera et al 2009 the overall procedure for the analysis of the drainage network classification is shown in fig 3 3 2 evaluation of classified river networks for the river networks classified using the svms based on beta distribution parameters we validate the networks based on measures of scaling invariance the use of measures involving river network properties such as the drainage area increment stream course irregularity and tributary junction angle in network classification analysis was proposed by mejía and niemann 2008 of note the authors distinguished between self similar and self affine networks the horizontal features of a subbasin in a self similar network appear to be statistically similar to the same features of a larger basin if the small basin is isotropically rescaled on the other hand a self affine network can be identified if the same is true when the subbasin is anisotropically rescaled a self similar network can be of the dendritic rectangular and trellis network types while a self affine network can be of the parallel and pinnate network types for the scaling invariance measures the drainage area increment is used to determine the horizontal characteristics of the river basins as the first measure this measure is based on the basin area and is written as follows 7 a l d r 2 a r l where l represents the euclidean or linear distance between the outlet of a small basin and the main stream source and r is a rescaling factor associated with the linear sizes of the small and larger basins the symbol d means that the left and right sides of the equation have statistically identical distributions for this measure one can consider a site that is the euclidean distance l from the source of the main stream and an associated upstream site that is the euclidean distance l bl from the same site where b is a factor used to determine the scale of the drainage area increment then the area a l bl which produces the denotation of δ a b l l is used for the analysis to estimate δ a b l l l 2 the plot of δ a b l l l 2 against l is then examined to distinguish between self similar and self affine network types stream course irregularity is used as the second measure derived from scaling invariance in this study the standard deviation of lengths perpendicularly estimated from stream segments of the subbasin represents the stream course irregularity the equation of this measure is as follows 8 σ l d r 1 σ b l r l where σ b l is the standard deviation of the lengths based on the same process as the drainage area increment we obtain σ b l l l and plot σ b l l l against l for the river network classification procedure the tributary junction angle is used as the third measure associated with scaling invariance by considering any point where the channels merge with the primary and secondary tributaries the associated equation is as follows 9 ψ b b l d ψ r b r b r l where ψ represents the junction angle and the subscript of this symbol indicates a factor that can control the chord length of the tributaries based on this equation one can obtain the denotation of ψ b l b l t l where l is the distance to the source of the main stream for the primary tributary and lt is the distance to the source of the main stream for the secondary tributary the plot of ψ b l b l t l against l is then used to identify the river network types fig 4 presents the three measures detailed information on the calculation of the measures can be found in the paper by mejía and niemann 2008 3 3 calculation of preexisting topographic slope to identify the conditions influencing the formation of the river networks the preexisting slope is estimated on the basis of the preexisting surfaces the preexisting slope can be defined as the slope that presents portions of the area remaining relatively unaffected by the modern landscape evolution of the topography jung et al 2011 in the study by jung et al 2011 they examined the preexisting slope to identify the typical conditions such as the initial slope of the topography that can affect the development of river networks the preexisting slope is estimated by determining locations based on small drainage areas which can be assumed to have been altered from hillslope procedures the hillslopes are known to be locations of channel heads in a river basin and are calculated with the application of laplace curvature by identifying specified thresholds related to the curvature such curvature is defined using the following equation 10 k f x x f y y where f x x and f y y are the second order derivatives based on the x and y directions in terms of elevation in a river basin it should be noted that positive curvature seems to be associated with locations generated by hillslope processes while negative curvature tends to be associated with locations influenced by valley networks evans 1972 mitášová and hofierka 1993 in this work we follow the processes used by jung et al 2011 with the values of thresholds considering evolution and hillslope procedures to obtain information on the preexisting surfaces after the preexisting surfaces are determined the average slope between a grid cell and its downstream cell in the surface is estimated the average slope is used as the preexisting slope to identify the conditions affecting the development of river networks 4 results for classification 4 1 river network classification the classification of the river networks on south korea is carried out using svms based on the parameter estimates α and β derived from the beta distribution of the tributary junction angles in this study the classification diagram developed from the svms with the estimates from the analysis performed by jung et al 2019 is applied to distinguish the various networks as shown in fig 5 a note that the parameters of the beta distribution appear as exponents of the random variable parameterized by two shape parameters and are determined based on the maximum likelihood method by fitting the beta distribution as the study by owen 2008 the boundaries for the classification diagram can be identified using the svm which provides classifiers maximizing the margin between groups in this study the groups are determined from the two shape parameters that can show the properties of the river networks the diagram is proposed based on the five river network types described in previous studies and its applicability for the identification of network patterns has been demonstrated the classification diagram shows that four groups can be identified the dendritic parallel and pinnate river network types are clearly grouped while the rectangular and trellis network patterns seem to be difficult to distinguish this might be because the latter two network types are characterized by abundant right angles and the distributional properties of the junction angles tend not to be sufficient for the identification of any patterns although the rectangular and trellis patterns tend to be indistinct according to this methodology they are physically different and can be distinguished using other river network characteristics such as stream course irregularity fig 5 b presents the results indicating the river network types of the river basins considered in the present study based on the classification diagram among the 41 evaluated river basins 12 networks are classified as parallel networks whereas 29 are determined to be rectangular and trellis networks parameter α for the parallel networks ranges from 2 985 to 2 572 with an average value of 2 705 parameter β for the same network type ranges from 7 639 to 6 111 with an average value of 6 605 on the other hand parameter α ranges between 2 601 and 2 095 with an average value of 2 303 and parameter β ranges between 5 960 and 4 659 with an average of 5 412 for the rectangular and trellis networks table 2 a provides the two parameters for each network and table 2 b presents the maximum minimum and average values of the parameters for the different river network types based on fig 6 we tried to identify the characteristics of the tributary junction angles for the parallel networks and the rectangular and trellis networks for the comparison we examine the box plots using the angles for the 41 river basins in south korea fig 6 shows the box plots of the angles for the different river network types determined from the classification diagram for the parallel networks the range between the upper quartile and the lower quartile seems to be narrower than this range for the rectangular and trellis networks for example im gy dy and gj in the parallel network type show the narrower ranges of the angles while bo ep ad ms and nj in the rectangular and trellis network type present the wider range of the angle although the values are more or less similar for the cases most of the median values for the parallel networks seem to be less than 50 and most of the median values for the rectangular and trellis networks tend to be more than 50 moreover most of the maximum values of the junction angles seem to be lower than 150 for the parallel type while most of these values tend to be larger than 150 for the rectangular and trellis types the rectangular and trellis networks present a number of outliers representing junction angles above 150 the differences in the features of the angles of the parallel network and the rectangular and trellis networks cause their distinct classification and provide meaning for understanding geomorphological processes 4 2 evaluation of classified network to validate the river network classification procedure proposed in this study three measures based on the drainage area increment stream course irregularity and tributary junction angles are used mejía and niemann 2008 proposed a classification tree derived from each river network type and jung and ouarda 2017 used this method to characterize the network types in arid and semiarid regions fig 7 presents the classification approach using the three measures when the slope of the stream course irregularity is smaller than 0 091 we can distinguish parallel and pinnate networks from dendritic rectangular and trellis networks based on the tributary junction angle of 0 01 the parallel and pinnate networks can be further classified using the average value of the stream course irregularity 0 0175 the dendritic and trellis networks can be distinguished from the rectangular network an average drainage area increment of 0 1347 can be used to classify dendritic and trellis networks based on the classification tree the 29 rectangular and trellis networks identified on the basis of the svm diagram are classified as rectangular networks these river networks have slopes of stream course irregularity below 0 091 and average stream course irregularity above 0 0175 the 12 parallel networks are also identified using the tree and the svm diagram table 3 shows the data on the slope of the stream course irregularity average stream course irregularity and tributary junction angle used for the classification of the river basins according to the three measures based on scaling invariance the self similar and self affine networks can be distinguished fig 8 shows a plot of the average values for the three measures based on δ a b l l l 2 σ b l l l and ψ b l b l t l as a function of l in the parallel networks in the figure the dashed lines are the regression lines the figure indicates that the drainage area increment and stream course irregularity produce negative slopes indicating that the networks are characterized by self affinity with acute junction angles the tributary junction angle has a positive slope indicating that the networks are classified as being of the parallel network type instead of the pinnate network type fluctuations are observed at large basin scales because fewer channels affect the estimation of the average measures when large basin lengths occur fig 9 includes plots of the average values for the measures similar to the figure for the parallel networks in this figure we can identify that most of the plots seem to be approximately horizontal based on the drainage area increment and stream course irregularity the trend of the regression line shown in this figure indicates that the river basins are characterized by self similarity rectangular networks tend to have more irregular stream courses than parallel networks figs 8 and 9 therefore provide the identification of the drainage network types based on the three measures for instance the stream course irregularity shows the negative slope and the tributary junction angle presents the positive slope for hyoryeong gyeongan wonju and imokjeonggyo in fig 8 this information provides the river network classification as the parallel type on the other hand the stream course irregularity shows the positive slope or horizontal line for yeongwol misung goesan dam and epyunggyo in fig 9 the information from fig 9 represents the networks as the rectangular or trellis types in the present study fig 10 presents the indication of the classified river networks including the parallel network and the rectangular network in south korea 5 discussion an analysis of 41 river networks on south korea is conducted here to determine how the preexisting slope affects their development fig 11 provides examples of the preexisting surfaces associated with the parallel and rectangular networks examined in this study based on the preexisting surfaces the preexisting slope is estimated by averaging the slope calculated between each grid cell and its downstream neighbor in this figure the goro river basin representing parallel networks has a slope of 2 49 and the epyunggyo river basin representing rectangular networks has a slope of 2 04 the preexisting slopes of the parallel networks range between 1 84 and 2 89 with an average of 2 26 jung et al 2011 identified that self affine networks including parallel networks can occur when the preexisting slope is above 3 00 phillips and schumm 1987 indicated that a transition in the network form between 2 00 and 3 00 occurred in an experimental study a transition from a dendritic network at a 1 slope a subdendritic network at a 2 slope to a subparallel network at a 3 slope was observed thus it is possible that the networks classified as parallel can share characteristics with the subparallel networks moreover the slopes of the rectangular network range from 1 52 to 2 92 with an average of 1 99 jung et al 2011 suggested that self similar networks can occur when the preexisting slope is below 3 00 the rectangular networks analyzed in the present study seem to have a small preexisting slope similar to the self similar networks the preexisting slope tends not to significantly affect the occurrence of the rectangular network type since the dendric network type is also characterized by a small slope in a recent study pereira claren et al 2019 examined high relief environments where more conditions can influence the development of river basins by comparing them to low relief environments and proposed that other river network forms can exist the authors determined that three different network types including herringbone barbed and high relief pinnate networks can be observed based on the analysis of landcover climate and geology in south korea which is a part of the korean peninsula flooding is the most common water related disaster derived from geomorphological conditions characterized by high mountains with steep slopes ex jiri mountain height 1 950m seorak mountain height 1 708m and deogyu mountain height 1 614m the topography and limited drainage capacity with the monsoon climate result in huge flood damages and high flood risk lei et al 2021 although the flood estimation models for quantiles are required to design flood protection infrastructures by focusing on characteristics of discharge with geomorphology the rainfall runoff models are commonly used to investigate the amount of flood for hydrological structures in south korea most advanced research in other countries have focused on developing hydrological models such as the regional flood frequency analysis model based on hydrological and geomorphological features to improve the flood quantile estimates at ungauged sites chebana and ouarda 2008 jung et al 2021 msilini et al 2022 shu and ouarda 2007 by determining the patterns of korean river networks with their properties the model for the regional flood frequency analysis can be enhanced in estimating flood quantiles and eventually can provide better information on the design of the hydrological structures against the flood disasters in south korea the innovation of this study is the provision of a better understanding of river network properties in south korea based on several methodologies the peninsula has geographical importance and is located in northeast asia between china and japan it also includes a climate with four distinct seasons and mountains covering 70 percent of korea these characteristics cause water related disasters such as floods and droughts thus the identification of river network characteristics in the peninsula can help develop hydrological models including regional hydrological frequency analysis to control water resources affected by peninsular properties in the regional frequency analysis it is significant to define homogenous regions that can enhance the quality of the final hydrological estimate if the region is relatively small it may not have enough information content for developing hydrological models on the other hand if the region is relatively large the level of homogeneity based on hydrological characteristics may be significantly reduced although new statistical approaches have been analyzed to define homogenous regions the physiographical variables that improve model performance have not substantially evolved significant gains can be obtained from the definition of the regions using the river network features and integration of new variables jung et al 2021 investigated the homogenous regions defined by the river network types and enhanced the quality of the hydrological estimate using the river network features which are decidedly correlated with hydrological dynamics in drainage networks of the usa the geomorphological results derived from the application of the methodology and analysis in the present work contribute crucial information to the practical hydrological field in south korea based on the understanding of river network characterization in addition jung et al 2019 proposed a new classification system for the river network patterns by only focusing on the channel networks in the usa jung et al 2019 used the tributary junction angle for classification but they did not identify the preexisting slope for the river network property in the present study we classify drainage network types in south korea that have rarely been investigated for the classification of the networks using two robust classification methods we apply three network features including the drainage area increment stream course irregularity and tributary junction angle to distinguish between the different networks the geomorphological conditions that influence the development of river networks are also examined to provide a better understanding of the network characteristics in the peninsula which has not been analyzed in previous studies the relevance of the river basin characteristics in the hydrological frequency analysis will be investigated as future work for water resource management in the peninsula 6 conclusions in the present work 41 river basins on south korea are investigated for classification and characterization the parameter estimates derived from the beta distribution of the tributary junction angles are applied to provide a classification diagram based on the svm model furthermore three measures including drainage area increment stream course irregularity and tributary junction angle based on scaling invariance are used to validate the classified river networks the slope of the preexisting surfaces is estimated and analyzed to assess the conditions under which river networks develop in this region the river networks examined in this study are classified as parallel networks and rectangular and trellis networks on the basis of the beta distribution parameters implemented in svms among the 41 examined river networks 12 have parallel network patterns and 29 have rectangular and trellis network patterns this approach exhibits a limitation in distinguishing between rectangular networks and trellis networks since the distributional features of the junction angles seem to be similar an analysis of the box plots based on the angles for the classified river networks is performed to identify differences the parallel networks present a small range between the upper and lower quartiles and most of the angles tend to be lower than 150 on the other hand the rectangular and trellis networks show a large range between the upper and lower quartiles and have a large number of angles above 150 in addition three measures producing the classification tree are used to validate the classified networks based on this methodology the rectangular network type is determined in the rectangular and trellis networks grouped by the svm diagram the parallel network type is identified as the result of the svm model from the analysis of the preexisting slope we determine that the parallel network type as a self affine network presents an average slope of 2 26 and the rectangular network type as a self similar network shows an average slope of 1 99 both network types on south korea are characterized by a low preexisting slope in the drainage networks in this area other factors including geologic and climatic features rather than slope seem to affect the occurrence of the different networks future research should focus on improving this classification system in terms of distinguishing the various river network patterns secondary tributary lengths may be applied for the construction of the classification diagram with the svm model as this network feature was investigated in the analysis performed by jung et al 2015 additionally regional factors related to the development of river basins in korea considering peninsular properties can be integrated other methodologies such as high relief characterization of networks can be used to characterize more specific network types software information name of software and data set support vector machines using the statistical and machine learning toolbox in matlab https www mathworks com help stats and digital elevation models dems from the global dem derived from the data of advanced spaceborne thermal emission and reflection radiometer aster satellite https asterweb jpl nasa gov contact name kichul jung telephone 82 44 415 7965 email address kcjung kei re kr hardware required ibm pc software required matlab and arc gis availability and cost free declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the national research foundation of korea nrf grant funded by the korea government msit nrf 2019r1a2c1007447 and by korea environment industry technology institute keiti through aquatic ecosystem conservation research program or project funded by korea ministry of environment moe 2022003050007 
25548,strategic land conservation investments that prioritize stakeholder priorities show promise for protection of ecological integrity and associated socioeconomic benefits of land conservation however despite many known benefits decisions on where and what to conserve are often made without effective ecological and socioeconomic considerations ideally multiple measurable attributes relevant to the ecological and socioeconomic priorities of stakeholders should be brought into an efficient data driven framework to evaluate areas of interest and help optimize decisions on conservation investments planners need to have access to a dynamic web based platform that assesses and compares conservation areas based on geospatial science based and stakeholder driven data in this work we provide a co produced framework for a multi criteria conservation prioritization tool cpt that is based on available geospatial data reflecting stakeholder priorities for land conservation the framework allows for flexible and hierarchical weighting of goals and data measures by the decision maker and allows for optimization of conservation decisions through a geospatial multi criteria decision analysis mcda geospatial mcda is a popular approach for evaluating decision alternatives in conservation problems but the scarcity of functional tools that are widely accessible still limits their breadth of use in this work we describe the structure and creation of the cpt and demonstrate its application in the united states gulf of mexico coastal region an area over 700 000 km2 in size we designed and implemented a dynamic cloud based software tool that both considers and ranks user priorities and utilizes geospatial mcda to evaluate areas of interest for land conservation this tool improves the effectiveness and efficiency of land conservation actions by reducing the time needed to gather ecological evidence increasing the transparency of decision processes and encouraging inter organizational partnerships the versatile and open access nature of the cpt broadens the availability of the geospatial mcda methodology for conservation planners across large regions we intentionally developed the cpt framework and procedures therein to be transferable and open source to other objectives for any desired spatial geography 1 introduction land conservation through acquisition easement and stewardship is a means by which natural resource managers may protect and restore the current and future integrity of natural systems however limited financial resources and a lack of strategic methods to select conservation areas that are efficient and effective in achieving conservation objectives is a pervasive problem messer and allen 2018 when deployed effectively strategic conservation approaches have been shown to provide triple the ecological gain while reducing costs of conservation by half strassburg et al 2019 prioritizing conservation projects by carefully evaluating their ecosystem benefits has frequently been shown as superior to approaches that simply maximize the size of land acquired within an available budget grand et al 2017 yet despite broad awareness of these issues decisions on where and what to conserve are frequently made without effective ecological and socioeconomic considerations land conservation prioritization is an evaluation process where potential areas of interest aoi are assessed classified or ranked for acquisition easement or stewardship moilanen et al 2011 prioritization is a crucial aspect for state and federal agencies non governmental organizations ngos and private landowners who may need to evaluate a portfolio of properties efficient data driven and science based methods developed from stakeholder priorities can help these organizations optimize decisions on land conservation investments the prioritization process should take into consideration the preferences of stakeholders and decision makers with respect to the goals of conservation and measurable attributes hereafter termed data measures representing the ecosystem socioeconomic benefits of potential land conservation projects moreover engaging conservation stakeholders from the very beginning in a co production process increases buy in and the chances of eventual tool and research product use especially for application to complex societal or conservation challenges beier et al 2016 given a set of goals preferences and data measures prioritizing a set of aois is an optimization problem in geospatial form conservation prioritization has frequently been performed using benefit targeting and cost effectiveness analysis duke et al 2013 messer and allen 2018 mathematical optimization has been applied to natural resource conservation problems billionnet 2013 including multi criteria decision analysis mcda adem esmail and geneletti 2018 langemeyer et al 2016 mcda is a decision analysis method that incorporates alternative solutions data measures conservation goals and user priorities huang et al 2011 mcda decomposes complex problems into a set of criteria reflective of conservation goals and systematically evaluates them against alternatives mendoza and martins 2006 mcda provides a formalization of the common sense way that decisions are usually made keeney 1996 mcda is particularly effective at analyzing alternatives across dissimilar criteria a key feature given the importance of including factors related to not only ecological benefits but also land costs and the likelihood for land use change in land conservation prioritization davies et al 2013 specific uses of mcda for natural resource conservation prioritization include agriculture and other land uses ecosystem or habitat conservation and watershed planning dynamic maps that reflect individual user priorities are emerging as the future of conservation planning thogmartin et al 2008 li et al 2020 while spatial mcda is a promising method for evaluating land conservation value existing applications are limited in scope and use limitations may be due to 1 lack of geospatially explicit data or a geospatially explicit analysis framework 2 lack of stakeholder input and or access to tools that incorporate mcda components and 3 static processes that leave no room for flexibility and the mutability of priorities land conservation is inherently a spatial problem thus a geospatially explicit mcda tool that evaluates areas for land conservation is preferential conducting a spatial mcda over a large geographic extent e g states regions watersheds is important because decision makers often allocate funding for individual land conservation projects across large spatial scales for example regional funds for land conservation may be distributed to projects across several states or watersheds at the same time the resolution of spatial data within these large geographic extents should be fine enough to adequately address ecological and socioeconomic priorities at an appropriate scale of application web based spatial mcda tools that allow stakeholder access to such data are especially challenging to develop because they require computationally intensive on the fly processing of user preferences often at fine spatial resolutions across large geographies the objective of this work was to develop a dynamic and flexible geospatial web based mcda tool applied to a large area to help inform robust land conservation decisions the conservation prioritization tool cpt was developed iteratively with over 650 stakeholders to allow for the evaluation of potential land conservation projects i e aois based on their ecological and socioeconomic merit within the us gulf of mexico coastal region sesser et al in review achieving this objective will meet a need in practical decision making applications by providing transparent scientific justification to conservation prioritization efforts we used the stochastic multicriteria acceptability analysis smaa algorithm a mcda method that is capable of handling problems with multiple constraints and insufficient missing data the smaa algorithm used in this work incorporates priorities of over 100 000 random iterations by assigning stochastic weights that are uniformly distributed in the preference space in addition to the mcda analysis users can define their own weights based on the conservation goals and priorities of their organization s this latter feature allows the evaluation to be customized and flexible to user needs the cpt provides a platform that requires minimal prior knowledge to operate is freely available online and is preloaded with data reflective of widely relevant concerns to stakeholders within the geographic region in this paper we describe a specific application of the cpt but also present the tool as a transferable framework that can be applied to any spatial geography the cpt is made available via an online graphical user interface and as an open source code base such that other researchers can easily modify the application to other geographical regions around the world unique contributions of this research 1 development of an online geospatial data driven cpt using mcda 2 adaptation of the mcda smaa algorithm for conservation prioritization with multiple goals and data measures over a large geographical region 3 regional level stakeholder engagement to identify data measures in the study region 2 materials and methods 2 1 study area we used the united states us gulf of mexico coast region gcr an area of approximately 700 000 km2 fig 1 to demonstrate the proposed conservation prioritization framework the geographic extent of the gcr was defined within a 40 km inland buffer of the coastal management zone for each us state bordering the gulf of mexico the gcr contains a vast and diverse natural landscape which includes coastal wetlands submerged vegetation bayous uplands and offshore marine areas this region is also rich in culture with deep socioeconomic ties to the abundant natural resources since natural and societal values depend on the ecological richness of the gcr conservation is a shared priority among many stakeholders characterizing and comparing heterogeneous data types on the fly across the gcr required subdividing the region into finer homogeneous units this process of subdividing is often referred to as zone mapping goldsmith n d zone mapping can be achieved by either using criteria such as natural delineations e g watershed land cover geopolitical delineations e g county city or by using a fixed grid system subdividing geospatial data with a fixed grid system has unique advantages over other methods especially when undertaking decision analysis as it coarsely represents the underlying data without the complexities of data size konstantinos n d in this work we partitioned the gcr into an equal area 1 km2 hexagonal grid fig 2 hexagonal grids are preferred over other geometrical shapes e g square or triangle because they are characterized by elements that do not have gaps or overlaps and the center to center distances between neighboring cells are equal also hexagonal cells have a topology that is symmetrical invariant and of equal area and can be recursively partitioned into smaller divisions of grids when required to represent finer resolution data types in total we included 413 992 one km2 hexagons representing complete or partial intersection with land area in the gcr we excluded hexagons falling completely within open water areas as our focus was exclusively on land conservation priorities 2 2 conservation prioritization tool architecture the proposed framework prioritizes n different aois based on 5 conservation goals and 26 data measures fig 3 the cpt allows the user to input aois that are either customized i e digitized polygons or sub basin watersheds a user can input one or more customized aoi by uploading a shapefile or by drawing the footprint directly on the interactive map aois can also be selected as sub basin watersheds specifically at the 12 digit hydrologic unit size huc12 approximately 40 160 km2 once aois are selected the hexagons that intersect with aois and their associated data measures are selected as the units of analysis table 1 the database of 26 measures developed for the cpt is published as an open source geospatial database table 3 updated from shamaskin et al 2019 the geodatabase was developed either directly from existing datasets or by building datasets from the analysis of existing spatial data all the data measures in the cpt were derived from conservation priorities i e priority attributes identified in eight stakeholder design charrettes held within each gcr state from december 2017 to may 2018 sesser et al in review a design charrette is a type of meeting where stakeholders and decision makers collaborate during a series of activities to identify solutions to problems stakeholders in the 2017 2018 round of charrettes n 176 represented various federal state and local agencies and ngos that regularly engage in land conservation through acquisition easement and stewardship the charrettes were conducted to 1 review and discuss priority attributes that land conservation strategies can address 2 develop a list of shared priority attributes 3 brainstorm a list of data measures for each of the priority attributes and 4 rank the conservation goals table 1 with respect to land conservation strategies a priority attribute is defined here as a broader characterization of an ecological or socioeconomic indicator that could be represented by one or more data measures a data measure is then defined as a specific indicator and its associated geospatial data that address a priority attribute in part or completely for a measure to be included in the database it required gulf wide data availability direct relevance to identified priority attributes and relevance to land conservation in total a list of 46 priority attributes and 260 tentative data measures were developed from stakeholder input we then used seven distinct methods to process the source data into measures depending on the data type i e raster or vector and the type of measure being created i e index binary percentage count length a more thorough description of the data processing can be found in shamaskin et al 2019 2 3 hexagonal data aggregation and scaling each of the 26 data measures were clipped to the gcr geography and data values were stored within the hexagonal grid the hexagonal grid has an attribute table with 703 261 rows representing each individual hexagon within the gcr and contains q number of columns representing each data measure associated with one of the five restore goals to prioritize multiple aois we extracted the data stored in the hexagonal grid using a process called hex data aggregation fig 4 in this process we overlaid the aois represented by a geospatial polygon on the underlying hex database of measures we then extracted the hexagons that intersected with the aois for aggregation aois can span multiple hexagons since the area of each hexagon is only 1 km2 so the data measure values from multiple hexagons need to be aggregated or combined to arrive at a single value for each aoi in this work three types of aggregation were used 1 maximum 2 sum and 3 average table 2 after the hex data aggregation step we assigned each geospatial data measure a utility score based on user preference three types of utility thresholds are used in the cpt 1 linear higher the better lhb 2 linear lower the better llb and 3 piecewise linear higher the better lower the better phb plb fig 5 the utility thresholds enable the decision maker the flexibility to use the data measures as per their preference or need for example a user might consider the threat of urbanization a positive or negative measure for land conservation one user might prefer to conserve lands that are not threatened by urbanization while another user might prefer to conserve lands that are threatened by urbanization to enable both possibilities the cpt provides different utility thresholds for the decision makers to choose for some data measures such as threatened and endangered t e species number of species the indicators are highly non linear for most aois the value of this measure is zero and presence of just one t e species has a high value in this case a piecewise linear function is used for utility thresholding for each data measure utility thresholding will be applied after the hex data aggregation step the data values of measures across aois are then relatively scaled using equation 1 1 v m i p j s c a l e d v m i p j m a x i m u m v m i p 1 v m i p 2 v m i p n where v mipj is the ith data measure m i value of jth aoi p j and i 1 2 k and j 1 2 n the weighted data measure values are then combined into five scores corresponding to the five conservation goals by using equation 8 for user weighted analysis or stochastic weights for smaa mcda analysis 2 4 smaa mcda algorithm in the proposed framework prioritization can be performed in two ways 1 using smaa mcda and 2 with user provided weights on conservation goals and data measures with mcda weights for conservation goals are simulated randomly by using the stochastic algorithm in the user defined weights method users can select their priorities and weights for conservation goals and data measures individually described in detail in the next section in this framework smaa considers user preference as a weight space to rank proposed projects from most preferred to least preferred tervonen 2014 the smaa algorithms produce two indices rank acceptability ra and central weight vector cw that help the user to understand a problem in conjunction with the preference the ra index describes the combination of user preferences resulting in certain ranks for a project the cw describes the typical preferences that result in a project being favored in ranking the smaa algorithm incorporates priorities by assigning random weights that are uniformly distributed in the preference space over 100 000 iterations in the cpt the smaa algorithm assumes a discrete decision making problem where a set of n potential aoi footprints p p 1 p i p n are assessed based on a set of m criteria c c 1 c i c m the evaluation of an aoi p i on criterion c j is denoted by c j p i smaa then ranks n aois based on user preferences represented as m criteria by considering a weight vector w and a real valued utility function u p i w for i 1 n in smaa each aoi is represented by a set of measurements corresponding to a priority attribute and its corresponding preference by the user then the utility function equation 2 evaluates each project by a real number from 0 to 1 2 u p i w j 1 m u j c j p i w j user preference represented as weights is a m dimensional vector r from the space defined by weight space w equation 3 the weights are normalized and considered to be non negative 3 w w r m w j 0 a n d j 1 m w j 1 imprecise and uncertain criteria values are represented as stochastic variables ξ ij the users unknown preferences are represented by a weight distribution with a join density f w w in the feasible weight space w equation 4 using the weight space smaa derives ra and cw for this purpose a ranking function equation 4 and rank weights equations 5 and 6 are defined 4 f w w 1 v o l u m e w 5 r a n k i ξ w 1 k 1 n ρ u ξ k w u ξ i w ρ true 1 and ρ false 0 6 w i r w w r a n k i ξ w r the ra index describes the share of parameter values positioning an aoi p i with a rank of r equation 7 the most preferred aois are the ones that return the highest ranking most frequently 7 b i r ξ ε χ f χ ξ w w i 1 ξ f w w d w d ξ for a set of aois the ra will reflect the percentage of times each aoi got ranked as number 1 2 3 n this helps to identify the aois that are top ranked indicating their superiority with respect to the value the aoi provides in terms of ecological and socioeconomic benefits the cw is defined as the expected center of gravity of the favorable weight space equation 8 the cw describes the weights of a user supporting an aoi with the assumed preference model 8 w i k ξ ε χ f χ ξ w w i 1 ξ f w w w d w d ξ b i 1 for a set of aois the cw will reflect the favorable weight for each conservation goal and thus the strengths and weaknesses this helps to identify the strength of each aoi with respect to addressing each conservation goal the cw will help the user to determine which of the restore council goals are best represented within the aoi 2 5 prioritization using user defined weights the prioritization of aois via the user defined weighting approach is a way in which specific priorities and associated weights are directly applied by the cpt user in lieu of an iterative stochastic model this approach also assumes a discrete decision making problem where a set of n potential footprints or aois p p 1 p i p n are assessed based on the weight sets for five conservation goals and a set of q data measures d d 1 d q the evaluation of an aoi p i based on five conservation goals and q data measures d is termed as aoi score k equation 9 the prioritization using user defined weights and priorities then ranks n aois based on descending values of k with rank 1 being associated with the highest value of k 9 k n j 1 5 g n j w j where g nj is the measure value for nth aoi and jth conservation goal w j is weight or preference of jth conservation goal 2 6 web based online tool this framework is presently implemented as an online geospatial tool the cpt for the gcr that uses data measures that directly reflect ecological and socioeconomic priorities of conservation stakeholders in the region fig 6 demonstrates the workflow of the implemented cpt this tool can be currently accessed from the url https www quest fwrc msstate edu sca project php the cpt is implemented as a webtool and therefore it only requires a web browser and is useable in all major operating systems the source code for the tool is openly available in a repository at https github com scatools cpttool updates to the cpt are ongoing and efforts are underway to allow new developers to extend this work to other regions around the world the tool is a template for a model that can be adopted for other regions with little modification in addition to the measures available in the geospatial database the online geospatial cpt allows users flexibility in tool use aois can be drawn as polygons selected as 12 digit huc watersheds imported as shapefiles or assessed in combination e g drawn polygon vs imported shapefile aoi shapes can be edited within the tool and intersecting hexagons can be de selected to refine the project area for analysis users can also view and download summary reports of underlying data measures within each aoi which includes dynamic reporting elements that provide supporting summary information e g lists of threatened and endangered species total area land cover composition etc within an aoi single aoi reports can be used in project proposals for funding to further build rationale for the project area a user can also add values for new measures via the add an attribute function for inclusion into the in the mcda and user defined weighting analysis for example if a user is aware of acquisition costs for each aoi this value can be added in for comparison in the user defined weighting mode a user may alter utility function directionality for each data measure based on preference in addition to indicating high medium or low weighting on each measure further when a user runs an evaluation of multiple project areas a dynamic report is available for download that provides graphical summaries of both user defined and mcda assessments finally users can create a user account where weighting preferences and or reports can be stored from past assessments 2 7 example scenario assessment we developed three prioritization scenarios to demonstrate the use of the cpt in the first scenario we prioritized three aois from three states tx al fl one aoi per state in the second scenario we chose four aois from within the state of florida in the third scenario we chose three watersheds from within the state of louisiana for each scenario we demonstrated different ways to compare the aois using the cpt 1 using equal goal and measure weights all measures set to medium weight 2 using unequal weights selected by the user all measures set to medium weight and 3 using the smaa mcda model that randomly varies goal weights across 100 000 iterations the weighting schemes for the first two comparisons in each experiment are provided in table 3 for the purposes of maintaining anonymity the exact locations of the aois are not disclosed additionally the unequal weighting schemes assigned to the scenarios do not represent actual stakeholder preferences and were assigned solely to demonstrate tool functionality 3 results 3 1 scenario 1 separate aois within states the evaluation under equal and unequal user defined goal weights resulted in the florida aoi being the top ranked area compared to the texas aoi and alabama aoi fig 7 when unequal weights are applied across goals e g table 3 scenario 1 the total score decreased across all aoi s but the florida aoi remained the most competitive area relative to the other aoi s despite goal weights being skewed toward water quality quantity coastal resilience and gulf economy fig 7b when assessing scores within restore goals the habitat goal received the greatest score across all three aois under equal goal weights suggesting overall scores may be influenced more heavily by data within the habitat goal in those project areas particularly in the texas aoi fig 7a when applying variable goal weights we observed a shift in scores to reflect greater weights in water quality community resilience and gulf economy fig 7b however despite the shift in weight away from an equitable distribution of goal weights with scores influenced primarily by habitat measures the analysis still indicated that the florida aoi was the preferred project area in this case a user can evaluate a set of aois under preferred programmatic priorities for example if a funding agency wanted to support projects that targeted wildlife habitat goals vs goals important to sustainability of gulf communities e g water quality resilience economy the results of mcda comparison for scenario 1 fig 8 indicate that the florida aoi was ranked first with the greatest frequency 75 under 100 000 randomly weighted simulations followed by the texas aoi 21 conversely the alabama aoi was ranked last with the greatest frequency compared to other aois 52 3 2 scenario 2 aois within a single state when we assessed the four aois from within florida in scenario 2 under equal restore goal weights we found both aoi 2 and aoi 4 to be top ranked project areas fig 9 a however when goals were skewed toward a heavy weighting on the habitat goal 40 table 3 scenario 2 florida aoi 4 outcompeted the other aoi s fig 9b on a goal by goal basis under both equal and unequal weighting scenarios the habitat goal tends to dominate scoring relative to the other goals fig 9 however this effect was precipitated when unequal goal weights were applied as expected under 40 weight for the habitat goal this experiment indicates that increasing the weight on the goal that contributes the most value habitat in this case only further strengthens the relative value of the highest ranked aoi the results of mcda comparison for scenario 2 indicate that aoi 4 was ranked first with the greatest frequency 48 under 100 000 randomly weighted simulations followed closely by aoi 2 47 fig 10 this suggests that under many sets of random restore goal weights florida aoi s 4 and 2 remained comparable in terms of their land conservation potential conversely aoi 1 was ranked last more than any other area 47 across iterations 3 3 scenario 3 watersheds within a state in both the equal and unequal weight evaluations of aois from three huc 12 watersheds within louisiana the top ranked area was the tiger creek watershed fig 11 on a goal by goal basis the habitat goal received the greatest score across all three watersheds under equal goal weights suggesting overall scores may be influenced more heavily by data within the habitat goal in those project areas particularly in the wekiva river wacasassa river watershed fig 11a however when we applied variable goal weights e g table 3 scenario 3 we observed a marked shift in scores to increased influence of the water quality and community resilience goals across all watersheds fig 11b this was driven by the 40 and 30 weighting of the water quality and community resilience goals within the cpt analysis per scenario 3 this shift in goal weights increased the total score of the tiger creek watershed relative to the other watersheds in the analysis the results of mcda comparison for scenario 3 indicated that the wekiva river wacasassa river watershed was ranked first the most 45 under 100 000 randomly weighted simulations followed by the tiger creek watershed 30 fig 12 conversely the indian bayou canal watershed was ranked last more than any other 40 4 discussion the primary objective of the cpt is for the user to be able to explore a broad range of conservation values to enhance scientific justification for proposed areas for land conservation via acquisition and or management however with several commercial prioritization tools already in existence e g ball et al 2009 moilanen et al 2009 pressey et al 2009 sarkar et al 2009 it is important to highlight the distinguishing features that make the cpt a novel contribution to spatial conservation planning science first the cpt is available as an open source web tool that is readily accessible to decision makers and conservation planners data measures within the cpt are derived directly from stakeholder priorities for conservation under a co production science framework samiappan et al 2020 sesser et al in review goals and data measures combine both ecological and socioeconomic aspects of conservation into a unified framework which integrates a wider variety of stakeholder priorities and allows for flexible analysis that reflects the complexity of decisions in gulf land conservation the cpt also allows the user to evaluate potential co benefits of conservation proposals in addition to allowing the user to evaluate optimum areas for land conservation under a range of programmatic priorities for example a land conservation proposal emphasizing endangered species habitat when evaluated in the cpt may identify other ecosystem benefits such as water quality or community resilience thus decisions informed by the cpt can reflect the breadth of conservation values within the gulf conservation community second gis expertise is not a necessary pre requisite for tool users as curated data are embedded in the underlying hexagonal framework this results in spatial data being more accessible to users with limited gis skills third the flexible analytical framework via either iterative mcda or user defined weighting allows for a user to evaluate proposed conservation areas under a variety of priorities as demonstrated in the scenarios above reporting associated with each analysis provides transparency in selection of weighting on goals and measures and allows the user to assess the potential value of project areas under a wide range of scenarios for example one could explore the contrast in scoring when weighting more heavily on habitat goals and measures compared to evaluating those same areas under a weighting scenario that prioritizes the gulf economy goals and measures project areas that score high across user defined weighting scenarios would suggest that area is representative of numerous co benefits and may be a good candidate for conservation in cases where the user desires to assess potential project areas in the absence of potential bias the cpt provides the opportunity for analysis via the smaa mcda algorithm this mcda approach generates random iterative sets of goal weights to rank areas eliminating the element of human bias in the prioritization process this is particularly useful when conservation decisions are complex or involve multiple stakeholder groups and values and decision makers desire an unbiased assessment of potential project areas it is also useful to compare mcda results with those generated by equal weighting and or user defined weights additionally the rank acceptability output of mcda allows the users to assess the proportional ranking of project areas particularly providing value in assessing portfolios of potential projects e g selecting the top three ranking projects out of a set the versatility of the central weights analysis within smaa mcda allows users to identify the strengths and weaknesses of individual projects driven by underlying goals in comparison to other projects more specifically the central weights vectors can indicate under which goals a particular project is performing well or poorly in comparison to the other projects considered central weights vectors may not be used for the purposes of selecting a particular project but rather they provide a way for a user to understand underlying drivers of cpt rankings by understanding underlying drivers of prioritization the user can develop a more compelling proposal that speaks to the conservation potential of an area and can better target their proposal to a funding opportunity that aligns with the strengths of a project by incorporating the smaa mcda algorithm in concert with stakeholder informed data measures in an easily accessible geospatial web tool the cpt represents a significant advance in enhancing accessibility of mcda technologies spatial mcda has been used in several other studies to assess land suitability for production and conservation see table 4 and citations therein mcda algorithms were shown to be particularly useful in assessing numerous spatial criteria pertaining to soil degradation to identify areas for ecological restoration and in assessments of ecosystem services and green space policies favretto et al 2016 langemeyer et al 2016 aguirre salado et al 2017 mcda has been used numerous times in assessments of potential and existing protected areas zoning decisions within existing protected areas and follow up assessments of protected area networks geneletti and van duren 2008 kukkonen and ilpo 2019 rocchi et al 2020 spatial mcda has also been used previously to assess vulnerabilities of coastal areas to climate and land use change to help local governments direct decisions and policies pertaining to land use and socioeconomic organization ishtiaque et al 2019 however there are very few examples from past works where spatial mcda was incorporated into a regional open source web application program agrisuit is an online spatial mcda application on a web client and webahp front end integrated with google earth engine and qgis backend functionality that allows users to assess suitability of land for agricultural production across multiple spatial criteria yalew et al 2016 though this tool represents a significant advancement in land use planning there are few if any documented open source spatial mcda tools that aim to inform land conservation decisions programs like marxan and zonation are widely available optimization tools that allow users to supply geospatial data within planning units or zones to assess optimum areas for conservation or protection under user priorities ball et al 2009 moilanen et al 2009 they are robust well vetted decision support tools that are widely used globally in conservation assessments however they generally require user provided spatial data to complete optimization algorithms and can be computationally intensive when applied regionally in the cpt development process including design charrettes we worked directly with over 650 stakeholders to identify priorities and curate spatial data so that the complexities of spatial data analysis would not hinder tool use the online geospatial cpt can be accessed from the https www quest fwrc msstate edu sca project php the tool only requires a web browser and is compatible with all major operating systems this open source tool that was designed for the gcr can be modified to provide conservation prioritization for any other geographic region and incorporate any set of conservation priorities efforts are underway to enable new developers to extend this work for other regions around the world the source code is openly available as a github repository at https github com scatools cpttool although we use a 1 km2 hexagon other tessellated shapes and resolutions can be utilized to best fit other regions however the list of data measures that can be considered for land conservation decisions is highly region specific and a developer would likely need to curate a different suite of gis data when applying the tool framework in other regions we recommend to anyone wishing to develop a similar tool for other regions to first take inventory of conservation priorities found in community plans of the desired region as it will provide a baseline of what is important data to focus on including samiappan et al 2020 directly engaging with local stakeholders involved in conservation actions is also important as their inputs can help direct attention to the most relevant attributes of conservation as well as valuable sources of data that can be included shamaskin et al 2019 throughout development of any conservation tool maintaining transparency with stakeholders through regular communication will strengthen the visibility of the tool and give stakeholders opportunities to see their own feedback incorporated ultimately leading to more trust from the stakeholders within the targeted region an important caveat with the cpt is that the spatial mcda framework was built under a benefits targeting paradigm messer and allen 2018 and any optimization using constraints would need to be implemented through designating the directionality of utility functions or user added attributes assigned to project areas stakeholders identified early in the co production process that the tool should focus on bolstering scientific justification for proposed land conservation projects absent of geopolitical constraints e g cost willing sellers etc however the cpt development team is working toward allowing optional constraints for project optimization in future cpt versions it is also important to note that stakeholders who provided input into the cpt were representatives of organizations and agencies with interests in land conservation though these organizations often represented the public interests we did not seek out input from the public or other non conservation sectors in development of this tool as our primary audience was organizations and agencies that engaged in land conservation in the gcr we also were unable to address all important stakeholder priorities due to the multi level structure of the tool framework for example though it was widely documented that sea level rise is a critically important priority for land conservation decisions in the gcr we were challenged to assign a sea level rise data measure within a single goal sea level rise will affect each goal differently with impacts on habitat living resources water resilience and economies in the gcr our development team is considering how to incorporate measures that apply across goals in future cpt versions finally because this was a regional tool constructed for land conservation decision making in the entire gcr we incorporated regional data into the tool framework for consistency in analysis we recognize there will be better finer resolution data at local scales that may need to be considered separately when assessing potential project areas or making fine scale decisions the cpt has been used by numerous organizations and agencies to evaluate potential land conservation projects or aid in conservation planning as highlighted in project use case studies on the tool website the combination of user defined weighting and spatial mcda functions in the cpt have allowed for myriad applications users are importing ad evaluating multiple spatial aois to select potential acquisition projects to propose to funding programs they are using tool reporting features to build rationale for their proposals based on ecological and socioeconomic co benefits identified in the tool framework they are using tool data in concert with their own priorities to build regional conservation priority maps and to enhance their own decision support processes co producing this tool with stakeholders ensured its valued applicability functionality and potential longevity of use in gulf land conservation our intentional development of the cpt framework and associated procedures to be transferable and open source to other objectives for any desired spatial geography allowed us to contribute a tool that will have lasting value and impact in the conservation realm software and data availability the data that support the findings of this study are openly available at https doi org 10 3390 data5010003 the software program presented in this manuscript is available as a github repository at https github com scatools refactored cpt detailed documentation of the software can be found at https scatoolsuite gitbook io sca tool suite declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests kristine evans reports financial support was provided by us department of the interior acknowledgements the sca project team appreciates the support of anthony collini dr jaime lopez matt heinemann from for tool development discussions and outreach dr yvonne allen from u s fish and wildlife service carey shafer rachel kirpes stephanie sharuga dr ben wilson and dr david reeves from the national academy of sciences science policy fellowship program dr renee collini from mississippi state university and dr jessica henkel from the restore council for their continued support of the project we also would like to thank the hundreds of conservation stakeholders who contributed to the sca project during design charrettes and use case studies this project was funded with support through the u s fish and wildlife service gulf coast cooperative ecosystems studies unit cooperative agreement f17ac00267 with mississippi state university as part of the council selected restoration component 2015 funded priorities list of the gulf ecosystem restoration council the project was also supported by the forest and wildlife research center geosystems research institute northern gulf institute and department of agricultural and biological engineering at mississippi state university this project was also conducted with support from the u s department of agriculture national institutes of food and agriculture mcintire stennis project misz 083140 
25548,strategic land conservation investments that prioritize stakeholder priorities show promise for protection of ecological integrity and associated socioeconomic benefits of land conservation however despite many known benefits decisions on where and what to conserve are often made without effective ecological and socioeconomic considerations ideally multiple measurable attributes relevant to the ecological and socioeconomic priorities of stakeholders should be brought into an efficient data driven framework to evaluate areas of interest and help optimize decisions on conservation investments planners need to have access to a dynamic web based platform that assesses and compares conservation areas based on geospatial science based and stakeholder driven data in this work we provide a co produced framework for a multi criteria conservation prioritization tool cpt that is based on available geospatial data reflecting stakeholder priorities for land conservation the framework allows for flexible and hierarchical weighting of goals and data measures by the decision maker and allows for optimization of conservation decisions through a geospatial multi criteria decision analysis mcda geospatial mcda is a popular approach for evaluating decision alternatives in conservation problems but the scarcity of functional tools that are widely accessible still limits their breadth of use in this work we describe the structure and creation of the cpt and demonstrate its application in the united states gulf of mexico coastal region an area over 700 000 km2 in size we designed and implemented a dynamic cloud based software tool that both considers and ranks user priorities and utilizes geospatial mcda to evaluate areas of interest for land conservation this tool improves the effectiveness and efficiency of land conservation actions by reducing the time needed to gather ecological evidence increasing the transparency of decision processes and encouraging inter organizational partnerships the versatile and open access nature of the cpt broadens the availability of the geospatial mcda methodology for conservation planners across large regions we intentionally developed the cpt framework and procedures therein to be transferable and open source to other objectives for any desired spatial geography 1 introduction land conservation through acquisition easement and stewardship is a means by which natural resource managers may protect and restore the current and future integrity of natural systems however limited financial resources and a lack of strategic methods to select conservation areas that are efficient and effective in achieving conservation objectives is a pervasive problem messer and allen 2018 when deployed effectively strategic conservation approaches have been shown to provide triple the ecological gain while reducing costs of conservation by half strassburg et al 2019 prioritizing conservation projects by carefully evaluating their ecosystem benefits has frequently been shown as superior to approaches that simply maximize the size of land acquired within an available budget grand et al 2017 yet despite broad awareness of these issues decisions on where and what to conserve are frequently made without effective ecological and socioeconomic considerations land conservation prioritization is an evaluation process where potential areas of interest aoi are assessed classified or ranked for acquisition easement or stewardship moilanen et al 2011 prioritization is a crucial aspect for state and federal agencies non governmental organizations ngos and private landowners who may need to evaluate a portfolio of properties efficient data driven and science based methods developed from stakeholder priorities can help these organizations optimize decisions on land conservation investments the prioritization process should take into consideration the preferences of stakeholders and decision makers with respect to the goals of conservation and measurable attributes hereafter termed data measures representing the ecosystem socioeconomic benefits of potential land conservation projects moreover engaging conservation stakeholders from the very beginning in a co production process increases buy in and the chances of eventual tool and research product use especially for application to complex societal or conservation challenges beier et al 2016 given a set of goals preferences and data measures prioritizing a set of aois is an optimization problem in geospatial form conservation prioritization has frequently been performed using benefit targeting and cost effectiveness analysis duke et al 2013 messer and allen 2018 mathematical optimization has been applied to natural resource conservation problems billionnet 2013 including multi criteria decision analysis mcda adem esmail and geneletti 2018 langemeyer et al 2016 mcda is a decision analysis method that incorporates alternative solutions data measures conservation goals and user priorities huang et al 2011 mcda decomposes complex problems into a set of criteria reflective of conservation goals and systematically evaluates them against alternatives mendoza and martins 2006 mcda provides a formalization of the common sense way that decisions are usually made keeney 1996 mcda is particularly effective at analyzing alternatives across dissimilar criteria a key feature given the importance of including factors related to not only ecological benefits but also land costs and the likelihood for land use change in land conservation prioritization davies et al 2013 specific uses of mcda for natural resource conservation prioritization include agriculture and other land uses ecosystem or habitat conservation and watershed planning dynamic maps that reflect individual user priorities are emerging as the future of conservation planning thogmartin et al 2008 li et al 2020 while spatial mcda is a promising method for evaluating land conservation value existing applications are limited in scope and use limitations may be due to 1 lack of geospatially explicit data or a geospatially explicit analysis framework 2 lack of stakeholder input and or access to tools that incorporate mcda components and 3 static processes that leave no room for flexibility and the mutability of priorities land conservation is inherently a spatial problem thus a geospatially explicit mcda tool that evaluates areas for land conservation is preferential conducting a spatial mcda over a large geographic extent e g states regions watersheds is important because decision makers often allocate funding for individual land conservation projects across large spatial scales for example regional funds for land conservation may be distributed to projects across several states or watersheds at the same time the resolution of spatial data within these large geographic extents should be fine enough to adequately address ecological and socioeconomic priorities at an appropriate scale of application web based spatial mcda tools that allow stakeholder access to such data are especially challenging to develop because they require computationally intensive on the fly processing of user preferences often at fine spatial resolutions across large geographies the objective of this work was to develop a dynamic and flexible geospatial web based mcda tool applied to a large area to help inform robust land conservation decisions the conservation prioritization tool cpt was developed iteratively with over 650 stakeholders to allow for the evaluation of potential land conservation projects i e aois based on their ecological and socioeconomic merit within the us gulf of mexico coastal region sesser et al in review achieving this objective will meet a need in practical decision making applications by providing transparent scientific justification to conservation prioritization efforts we used the stochastic multicriteria acceptability analysis smaa algorithm a mcda method that is capable of handling problems with multiple constraints and insufficient missing data the smaa algorithm used in this work incorporates priorities of over 100 000 random iterations by assigning stochastic weights that are uniformly distributed in the preference space in addition to the mcda analysis users can define their own weights based on the conservation goals and priorities of their organization s this latter feature allows the evaluation to be customized and flexible to user needs the cpt provides a platform that requires minimal prior knowledge to operate is freely available online and is preloaded with data reflective of widely relevant concerns to stakeholders within the geographic region in this paper we describe a specific application of the cpt but also present the tool as a transferable framework that can be applied to any spatial geography the cpt is made available via an online graphical user interface and as an open source code base such that other researchers can easily modify the application to other geographical regions around the world unique contributions of this research 1 development of an online geospatial data driven cpt using mcda 2 adaptation of the mcda smaa algorithm for conservation prioritization with multiple goals and data measures over a large geographical region 3 regional level stakeholder engagement to identify data measures in the study region 2 materials and methods 2 1 study area we used the united states us gulf of mexico coast region gcr an area of approximately 700 000 km2 fig 1 to demonstrate the proposed conservation prioritization framework the geographic extent of the gcr was defined within a 40 km inland buffer of the coastal management zone for each us state bordering the gulf of mexico the gcr contains a vast and diverse natural landscape which includes coastal wetlands submerged vegetation bayous uplands and offshore marine areas this region is also rich in culture with deep socioeconomic ties to the abundant natural resources since natural and societal values depend on the ecological richness of the gcr conservation is a shared priority among many stakeholders characterizing and comparing heterogeneous data types on the fly across the gcr required subdividing the region into finer homogeneous units this process of subdividing is often referred to as zone mapping goldsmith n d zone mapping can be achieved by either using criteria such as natural delineations e g watershed land cover geopolitical delineations e g county city or by using a fixed grid system subdividing geospatial data with a fixed grid system has unique advantages over other methods especially when undertaking decision analysis as it coarsely represents the underlying data without the complexities of data size konstantinos n d in this work we partitioned the gcr into an equal area 1 km2 hexagonal grid fig 2 hexagonal grids are preferred over other geometrical shapes e g square or triangle because they are characterized by elements that do not have gaps or overlaps and the center to center distances between neighboring cells are equal also hexagonal cells have a topology that is symmetrical invariant and of equal area and can be recursively partitioned into smaller divisions of grids when required to represent finer resolution data types in total we included 413 992 one km2 hexagons representing complete or partial intersection with land area in the gcr we excluded hexagons falling completely within open water areas as our focus was exclusively on land conservation priorities 2 2 conservation prioritization tool architecture the proposed framework prioritizes n different aois based on 5 conservation goals and 26 data measures fig 3 the cpt allows the user to input aois that are either customized i e digitized polygons or sub basin watersheds a user can input one or more customized aoi by uploading a shapefile or by drawing the footprint directly on the interactive map aois can also be selected as sub basin watersheds specifically at the 12 digit hydrologic unit size huc12 approximately 40 160 km2 once aois are selected the hexagons that intersect with aois and their associated data measures are selected as the units of analysis table 1 the database of 26 measures developed for the cpt is published as an open source geospatial database table 3 updated from shamaskin et al 2019 the geodatabase was developed either directly from existing datasets or by building datasets from the analysis of existing spatial data all the data measures in the cpt were derived from conservation priorities i e priority attributes identified in eight stakeholder design charrettes held within each gcr state from december 2017 to may 2018 sesser et al in review a design charrette is a type of meeting where stakeholders and decision makers collaborate during a series of activities to identify solutions to problems stakeholders in the 2017 2018 round of charrettes n 176 represented various federal state and local agencies and ngos that regularly engage in land conservation through acquisition easement and stewardship the charrettes were conducted to 1 review and discuss priority attributes that land conservation strategies can address 2 develop a list of shared priority attributes 3 brainstorm a list of data measures for each of the priority attributes and 4 rank the conservation goals table 1 with respect to land conservation strategies a priority attribute is defined here as a broader characterization of an ecological or socioeconomic indicator that could be represented by one or more data measures a data measure is then defined as a specific indicator and its associated geospatial data that address a priority attribute in part or completely for a measure to be included in the database it required gulf wide data availability direct relevance to identified priority attributes and relevance to land conservation in total a list of 46 priority attributes and 260 tentative data measures were developed from stakeholder input we then used seven distinct methods to process the source data into measures depending on the data type i e raster or vector and the type of measure being created i e index binary percentage count length a more thorough description of the data processing can be found in shamaskin et al 2019 2 3 hexagonal data aggregation and scaling each of the 26 data measures were clipped to the gcr geography and data values were stored within the hexagonal grid the hexagonal grid has an attribute table with 703 261 rows representing each individual hexagon within the gcr and contains q number of columns representing each data measure associated with one of the five restore goals to prioritize multiple aois we extracted the data stored in the hexagonal grid using a process called hex data aggregation fig 4 in this process we overlaid the aois represented by a geospatial polygon on the underlying hex database of measures we then extracted the hexagons that intersected with the aois for aggregation aois can span multiple hexagons since the area of each hexagon is only 1 km2 so the data measure values from multiple hexagons need to be aggregated or combined to arrive at a single value for each aoi in this work three types of aggregation were used 1 maximum 2 sum and 3 average table 2 after the hex data aggregation step we assigned each geospatial data measure a utility score based on user preference three types of utility thresholds are used in the cpt 1 linear higher the better lhb 2 linear lower the better llb and 3 piecewise linear higher the better lower the better phb plb fig 5 the utility thresholds enable the decision maker the flexibility to use the data measures as per their preference or need for example a user might consider the threat of urbanization a positive or negative measure for land conservation one user might prefer to conserve lands that are not threatened by urbanization while another user might prefer to conserve lands that are threatened by urbanization to enable both possibilities the cpt provides different utility thresholds for the decision makers to choose for some data measures such as threatened and endangered t e species number of species the indicators are highly non linear for most aois the value of this measure is zero and presence of just one t e species has a high value in this case a piecewise linear function is used for utility thresholding for each data measure utility thresholding will be applied after the hex data aggregation step the data values of measures across aois are then relatively scaled using equation 1 1 v m i p j s c a l e d v m i p j m a x i m u m v m i p 1 v m i p 2 v m i p n where v mipj is the ith data measure m i value of jth aoi p j and i 1 2 k and j 1 2 n the weighted data measure values are then combined into five scores corresponding to the five conservation goals by using equation 8 for user weighted analysis or stochastic weights for smaa mcda analysis 2 4 smaa mcda algorithm in the proposed framework prioritization can be performed in two ways 1 using smaa mcda and 2 with user provided weights on conservation goals and data measures with mcda weights for conservation goals are simulated randomly by using the stochastic algorithm in the user defined weights method users can select their priorities and weights for conservation goals and data measures individually described in detail in the next section in this framework smaa considers user preference as a weight space to rank proposed projects from most preferred to least preferred tervonen 2014 the smaa algorithms produce two indices rank acceptability ra and central weight vector cw that help the user to understand a problem in conjunction with the preference the ra index describes the combination of user preferences resulting in certain ranks for a project the cw describes the typical preferences that result in a project being favored in ranking the smaa algorithm incorporates priorities by assigning random weights that are uniformly distributed in the preference space over 100 000 iterations in the cpt the smaa algorithm assumes a discrete decision making problem where a set of n potential aoi footprints p p 1 p i p n are assessed based on a set of m criteria c c 1 c i c m the evaluation of an aoi p i on criterion c j is denoted by c j p i smaa then ranks n aois based on user preferences represented as m criteria by considering a weight vector w and a real valued utility function u p i w for i 1 n in smaa each aoi is represented by a set of measurements corresponding to a priority attribute and its corresponding preference by the user then the utility function equation 2 evaluates each project by a real number from 0 to 1 2 u p i w j 1 m u j c j p i w j user preference represented as weights is a m dimensional vector r from the space defined by weight space w equation 3 the weights are normalized and considered to be non negative 3 w w r m w j 0 a n d j 1 m w j 1 imprecise and uncertain criteria values are represented as stochastic variables ξ ij the users unknown preferences are represented by a weight distribution with a join density f w w in the feasible weight space w equation 4 using the weight space smaa derives ra and cw for this purpose a ranking function equation 4 and rank weights equations 5 and 6 are defined 4 f w w 1 v o l u m e w 5 r a n k i ξ w 1 k 1 n ρ u ξ k w u ξ i w ρ true 1 and ρ false 0 6 w i r w w r a n k i ξ w r the ra index describes the share of parameter values positioning an aoi p i with a rank of r equation 7 the most preferred aois are the ones that return the highest ranking most frequently 7 b i r ξ ε χ f χ ξ w w i 1 ξ f w w d w d ξ for a set of aois the ra will reflect the percentage of times each aoi got ranked as number 1 2 3 n this helps to identify the aois that are top ranked indicating their superiority with respect to the value the aoi provides in terms of ecological and socioeconomic benefits the cw is defined as the expected center of gravity of the favorable weight space equation 8 the cw describes the weights of a user supporting an aoi with the assumed preference model 8 w i k ξ ε χ f χ ξ w w i 1 ξ f w w w d w d ξ b i 1 for a set of aois the cw will reflect the favorable weight for each conservation goal and thus the strengths and weaknesses this helps to identify the strength of each aoi with respect to addressing each conservation goal the cw will help the user to determine which of the restore council goals are best represented within the aoi 2 5 prioritization using user defined weights the prioritization of aois via the user defined weighting approach is a way in which specific priorities and associated weights are directly applied by the cpt user in lieu of an iterative stochastic model this approach also assumes a discrete decision making problem where a set of n potential footprints or aois p p 1 p i p n are assessed based on the weight sets for five conservation goals and a set of q data measures d d 1 d q the evaluation of an aoi p i based on five conservation goals and q data measures d is termed as aoi score k equation 9 the prioritization using user defined weights and priorities then ranks n aois based on descending values of k with rank 1 being associated with the highest value of k 9 k n j 1 5 g n j w j where g nj is the measure value for nth aoi and jth conservation goal w j is weight or preference of jth conservation goal 2 6 web based online tool this framework is presently implemented as an online geospatial tool the cpt for the gcr that uses data measures that directly reflect ecological and socioeconomic priorities of conservation stakeholders in the region fig 6 demonstrates the workflow of the implemented cpt this tool can be currently accessed from the url https www quest fwrc msstate edu sca project php the cpt is implemented as a webtool and therefore it only requires a web browser and is useable in all major operating systems the source code for the tool is openly available in a repository at https github com scatools cpttool updates to the cpt are ongoing and efforts are underway to allow new developers to extend this work to other regions around the world the tool is a template for a model that can be adopted for other regions with little modification in addition to the measures available in the geospatial database the online geospatial cpt allows users flexibility in tool use aois can be drawn as polygons selected as 12 digit huc watersheds imported as shapefiles or assessed in combination e g drawn polygon vs imported shapefile aoi shapes can be edited within the tool and intersecting hexagons can be de selected to refine the project area for analysis users can also view and download summary reports of underlying data measures within each aoi which includes dynamic reporting elements that provide supporting summary information e g lists of threatened and endangered species total area land cover composition etc within an aoi single aoi reports can be used in project proposals for funding to further build rationale for the project area a user can also add values for new measures via the add an attribute function for inclusion into the in the mcda and user defined weighting analysis for example if a user is aware of acquisition costs for each aoi this value can be added in for comparison in the user defined weighting mode a user may alter utility function directionality for each data measure based on preference in addition to indicating high medium or low weighting on each measure further when a user runs an evaluation of multiple project areas a dynamic report is available for download that provides graphical summaries of both user defined and mcda assessments finally users can create a user account where weighting preferences and or reports can be stored from past assessments 2 7 example scenario assessment we developed three prioritization scenarios to demonstrate the use of the cpt in the first scenario we prioritized three aois from three states tx al fl one aoi per state in the second scenario we chose four aois from within the state of florida in the third scenario we chose three watersheds from within the state of louisiana for each scenario we demonstrated different ways to compare the aois using the cpt 1 using equal goal and measure weights all measures set to medium weight 2 using unequal weights selected by the user all measures set to medium weight and 3 using the smaa mcda model that randomly varies goal weights across 100 000 iterations the weighting schemes for the first two comparisons in each experiment are provided in table 3 for the purposes of maintaining anonymity the exact locations of the aois are not disclosed additionally the unequal weighting schemes assigned to the scenarios do not represent actual stakeholder preferences and were assigned solely to demonstrate tool functionality 3 results 3 1 scenario 1 separate aois within states the evaluation under equal and unequal user defined goal weights resulted in the florida aoi being the top ranked area compared to the texas aoi and alabama aoi fig 7 when unequal weights are applied across goals e g table 3 scenario 1 the total score decreased across all aoi s but the florida aoi remained the most competitive area relative to the other aoi s despite goal weights being skewed toward water quality quantity coastal resilience and gulf economy fig 7b when assessing scores within restore goals the habitat goal received the greatest score across all three aois under equal goal weights suggesting overall scores may be influenced more heavily by data within the habitat goal in those project areas particularly in the texas aoi fig 7a when applying variable goal weights we observed a shift in scores to reflect greater weights in water quality community resilience and gulf economy fig 7b however despite the shift in weight away from an equitable distribution of goal weights with scores influenced primarily by habitat measures the analysis still indicated that the florida aoi was the preferred project area in this case a user can evaluate a set of aois under preferred programmatic priorities for example if a funding agency wanted to support projects that targeted wildlife habitat goals vs goals important to sustainability of gulf communities e g water quality resilience economy the results of mcda comparison for scenario 1 fig 8 indicate that the florida aoi was ranked first with the greatest frequency 75 under 100 000 randomly weighted simulations followed by the texas aoi 21 conversely the alabama aoi was ranked last with the greatest frequency compared to other aois 52 3 2 scenario 2 aois within a single state when we assessed the four aois from within florida in scenario 2 under equal restore goal weights we found both aoi 2 and aoi 4 to be top ranked project areas fig 9 a however when goals were skewed toward a heavy weighting on the habitat goal 40 table 3 scenario 2 florida aoi 4 outcompeted the other aoi s fig 9b on a goal by goal basis under both equal and unequal weighting scenarios the habitat goal tends to dominate scoring relative to the other goals fig 9 however this effect was precipitated when unequal goal weights were applied as expected under 40 weight for the habitat goal this experiment indicates that increasing the weight on the goal that contributes the most value habitat in this case only further strengthens the relative value of the highest ranked aoi the results of mcda comparison for scenario 2 indicate that aoi 4 was ranked first with the greatest frequency 48 under 100 000 randomly weighted simulations followed closely by aoi 2 47 fig 10 this suggests that under many sets of random restore goal weights florida aoi s 4 and 2 remained comparable in terms of their land conservation potential conversely aoi 1 was ranked last more than any other area 47 across iterations 3 3 scenario 3 watersheds within a state in both the equal and unequal weight evaluations of aois from three huc 12 watersheds within louisiana the top ranked area was the tiger creek watershed fig 11 on a goal by goal basis the habitat goal received the greatest score across all three watersheds under equal goal weights suggesting overall scores may be influenced more heavily by data within the habitat goal in those project areas particularly in the wekiva river wacasassa river watershed fig 11a however when we applied variable goal weights e g table 3 scenario 3 we observed a marked shift in scores to increased influence of the water quality and community resilience goals across all watersheds fig 11b this was driven by the 40 and 30 weighting of the water quality and community resilience goals within the cpt analysis per scenario 3 this shift in goal weights increased the total score of the tiger creek watershed relative to the other watersheds in the analysis the results of mcda comparison for scenario 3 indicated that the wekiva river wacasassa river watershed was ranked first the most 45 under 100 000 randomly weighted simulations followed by the tiger creek watershed 30 fig 12 conversely the indian bayou canal watershed was ranked last more than any other 40 4 discussion the primary objective of the cpt is for the user to be able to explore a broad range of conservation values to enhance scientific justification for proposed areas for land conservation via acquisition and or management however with several commercial prioritization tools already in existence e g ball et al 2009 moilanen et al 2009 pressey et al 2009 sarkar et al 2009 it is important to highlight the distinguishing features that make the cpt a novel contribution to spatial conservation planning science first the cpt is available as an open source web tool that is readily accessible to decision makers and conservation planners data measures within the cpt are derived directly from stakeholder priorities for conservation under a co production science framework samiappan et al 2020 sesser et al in review goals and data measures combine both ecological and socioeconomic aspects of conservation into a unified framework which integrates a wider variety of stakeholder priorities and allows for flexible analysis that reflects the complexity of decisions in gulf land conservation the cpt also allows the user to evaluate potential co benefits of conservation proposals in addition to allowing the user to evaluate optimum areas for land conservation under a range of programmatic priorities for example a land conservation proposal emphasizing endangered species habitat when evaluated in the cpt may identify other ecosystem benefits such as water quality or community resilience thus decisions informed by the cpt can reflect the breadth of conservation values within the gulf conservation community second gis expertise is not a necessary pre requisite for tool users as curated data are embedded in the underlying hexagonal framework this results in spatial data being more accessible to users with limited gis skills third the flexible analytical framework via either iterative mcda or user defined weighting allows for a user to evaluate proposed conservation areas under a variety of priorities as demonstrated in the scenarios above reporting associated with each analysis provides transparency in selection of weighting on goals and measures and allows the user to assess the potential value of project areas under a wide range of scenarios for example one could explore the contrast in scoring when weighting more heavily on habitat goals and measures compared to evaluating those same areas under a weighting scenario that prioritizes the gulf economy goals and measures project areas that score high across user defined weighting scenarios would suggest that area is representative of numerous co benefits and may be a good candidate for conservation in cases where the user desires to assess potential project areas in the absence of potential bias the cpt provides the opportunity for analysis via the smaa mcda algorithm this mcda approach generates random iterative sets of goal weights to rank areas eliminating the element of human bias in the prioritization process this is particularly useful when conservation decisions are complex or involve multiple stakeholder groups and values and decision makers desire an unbiased assessment of potential project areas it is also useful to compare mcda results with those generated by equal weighting and or user defined weights additionally the rank acceptability output of mcda allows the users to assess the proportional ranking of project areas particularly providing value in assessing portfolios of potential projects e g selecting the top three ranking projects out of a set the versatility of the central weights analysis within smaa mcda allows users to identify the strengths and weaknesses of individual projects driven by underlying goals in comparison to other projects more specifically the central weights vectors can indicate under which goals a particular project is performing well or poorly in comparison to the other projects considered central weights vectors may not be used for the purposes of selecting a particular project but rather they provide a way for a user to understand underlying drivers of cpt rankings by understanding underlying drivers of prioritization the user can develop a more compelling proposal that speaks to the conservation potential of an area and can better target their proposal to a funding opportunity that aligns with the strengths of a project by incorporating the smaa mcda algorithm in concert with stakeholder informed data measures in an easily accessible geospatial web tool the cpt represents a significant advance in enhancing accessibility of mcda technologies spatial mcda has been used in several other studies to assess land suitability for production and conservation see table 4 and citations therein mcda algorithms were shown to be particularly useful in assessing numerous spatial criteria pertaining to soil degradation to identify areas for ecological restoration and in assessments of ecosystem services and green space policies favretto et al 2016 langemeyer et al 2016 aguirre salado et al 2017 mcda has been used numerous times in assessments of potential and existing protected areas zoning decisions within existing protected areas and follow up assessments of protected area networks geneletti and van duren 2008 kukkonen and ilpo 2019 rocchi et al 2020 spatial mcda has also been used previously to assess vulnerabilities of coastal areas to climate and land use change to help local governments direct decisions and policies pertaining to land use and socioeconomic organization ishtiaque et al 2019 however there are very few examples from past works where spatial mcda was incorporated into a regional open source web application program agrisuit is an online spatial mcda application on a web client and webahp front end integrated with google earth engine and qgis backend functionality that allows users to assess suitability of land for agricultural production across multiple spatial criteria yalew et al 2016 though this tool represents a significant advancement in land use planning there are few if any documented open source spatial mcda tools that aim to inform land conservation decisions programs like marxan and zonation are widely available optimization tools that allow users to supply geospatial data within planning units or zones to assess optimum areas for conservation or protection under user priorities ball et al 2009 moilanen et al 2009 they are robust well vetted decision support tools that are widely used globally in conservation assessments however they generally require user provided spatial data to complete optimization algorithms and can be computationally intensive when applied regionally in the cpt development process including design charrettes we worked directly with over 650 stakeholders to identify priorities and curate spatial data so that the complexities of spatial data analysis would not hinder tool use the online geospatial cpt can be accessed from the https www quest fwrc msstate edu sca project php the tool only requires a web browser and is compatible with all major operating systems this open source tool that was designed for the gcr can be modified to provide conservation prioritization for any other geographic region and incorporate any set of conservation priorities efforts are underway to enable new developers to extend this work for other regions around the world the source code is openly available as a github repository at https github com scatools cpttool although we use a 1 km2 hexagon other tessellated shapes and resolutions can be utilized to best fit other regions however the list of data measures that can be considered for land conservation decisions is highly region specific and a developer would likely need to curate a different suite of gis data when applying the tool framework in other regions we recommend to anyone wishing to develop a similar tool for other regions to first take inventory of conservation priorities found in community plans of the desired region as it will provide a baseline of what is important data to focus on including samiappan et al 2020 directly engaging with local stakeholders involved in conservation actions is also important as their inputs can help direct attention to the most relevant attributes of conservation as well as valuable sources of data that can be included shamaskin et al 2019 throughout development of any conservation tool maintaining transparency with stakeholders through regular communication will strengthen the visibility of the tool and give stakeholders opportunities to see their own feedback incorporated ultimately leading to more trust from the stakeholders within the targeted region an important caveat with the cpt is that the spatial mcda framework was built under a benefits targeting paradigm messer and allen 2018 and any optimization using constraints would need to be implemented through designating the directionality of utility functions or user added attributes assigned to project areas stakeholders identified early in the co production process that the tool should focus on bolstering scientific justification for proposed land conservation projects absent of geopolitical constraints e g cost willing sellers etc however the cpt development team is working toward allowing optional constraints for project optimization in future cpt versions it is also important to note that stakeholders who provided input into the cpt were representatives of organizations and agencies with interests in land conservation though these organizations often represented the public interests we did not seek out input from the public or other non conservation sectors in development of this tool as our primary audience was organizations and agencies that engaged in land conservation in the gcr we also were unable to address all important stakeholder priorities due to the multi level structure of the tool framework for example though it was widely documented that sea level rise is a critically important priority for land conservation decisions in the gcr we were challenged to assign a sea level rise data measure within a single goal sea level rise will affect each goal differently with impacts on habitat living resources water resilience and economies in the gcr our development team is considering how to incorporate measures that apply across goals in future cpt versions finally because this was a regional tool constructed for land conservation decision making in the entire gcr we incorporated regional data into the tool framework for consistency in analysis we recognize there will be better finer resolution data at local scales that may need to be considered separately when assessing potential project areas or making fine scale decisions the cpt has been used by numerous organizations and agencies to evaluate potential land conservation projects or aid in conservation planning as highlighted in project use case studies on the tool website the combination of user defined weighting and spatial mcda functions in the cpt have allowed for myriad applications users are importing ad evaluating multiple spatial aois to select potential acquisition projects to propose to funding programs they are using tool reporting features to build rationale for their proposals based on ecological and socioeconomic co benefits identified in the tool framework they are using tool data in concert with their own priorities to build regional conservation priority maps and to enhance their own decision support processes co producing this tool with stakeholders ensured its valued applicability functionality and potential longevity of use in gulf land conservation our intentional development of the cpt framework and associated procedures to be transferable and open source to other objectives for any desired spatial geography allowed us to contribute a tool that will have lasting value and impact in the conservation realm software and data availability the data that support the findings of this study are openly available at https doi org 10 3390 data5010003 the software program presented in this manuscript is available as a github repository at https github com scatools refactored cpt detailed documentation of the software can be found at https scatoolsuite gitbook io sca tool suite declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests kristine evans reports financial support was provided by us department of the interior acknowledgements the sca project team appreciates the support of anthony collini dr jaime lopez matt heinemann from for tool development discussions and outreach dr yvonne allen from u s fish and wildlife service carey shafer rachel kirpes stephanie sharuga dr ben wilson and dr david reeves from the national academy of sciences science policy fellowship program dr renee collini from mississippi state university and dr jessica henkel from the restore council for their continued support of the project we also would like to thank the hundreds of conservation stakeholders who contributed to the sca project during design charrettes and use case studies this project was funded with support through the u s fish and wildlife service gulf coast cooperative ecosystems studies unit cooperative agreement f17ac00267 with mississippi state university as part of the council selected restoration component 2015 funded priorities list of the gulf ecosystem restoration council the project was also supported by the forest and wildlife research center geosystems research institute northern gulf institute and department of agricultural and biological engineering at mississippi state university this project was also conducted with support from the u s department of agriculture national institutes of food and agriculture mcintire stennis project misz 083140 
25549,uncertainty quantification between simulated and observed water quality simulations needs to be improved this study generated and evaluated probabilistic hydrologic and water quality predictions in 18 locations across the u s using residual based modeling a box cox transformation scheme group provided the best predictive uncertainties for all case studies the tradeoffs in the performance metrics for a single variable predictive uncertainty in a single study watershed were more obvious than those for all hydrologic or water quality cases compared to a single realization of simulations the ensemble average of hydrologic and water quality simulations better represented the predictive uncertainty especially for large watersheds this study recommends various opportunities via residual error scheme selection data monitoring improvement and hydrologic model enhancement to robust hydrologic and water quality predictive uncertainties the results could improve the quantification of the predictive uncertainty of hydrologic and water quality simulations and guide probabilistic prediction enhancement graphical abstract image 1 keywords residual error estimation hydrologic and water quality models water quality prediction uncertainty residual error model robustness data availability data will be made available on request 1 introduction hydrologic models have been applied to predict hydrology and water quality in various regions liu et al 2019 martin et al 2021 srivastava et al 2020 quantifying predictive uncertainty of hydrologic and water quality simulations allows for better understanding of potential risks and possible water pollution from current and future storm events mcinerney et al 2017 2018 determination of reliable precise and unbiased probabilistic predictions of hydrology and water quality outcomes help water resources practitioners better manage water resources and improve water quality mcinerney et al 2017 2018 quantification of predictive uncertainty in hydrologic and water quality modeling is challenging prediction uncertainty can be attributed to the following factors hydrology and water quality data monitoring processes e g approaches frequencies and locations hydrologic model inputs and structures e g resolutions of elevation soil and land use the understanding of characteristics of study watersheds and fields and hydrologic and residual error model calibration processes evenson et al 2021 martin et al 2021 wallace et al 2017 water quality predictions can be more uncertain than hydrologic predictions the frequency of monitored water quality data e g bi weekly weekly or monthly is usually less than that of hydrology data e g daily or sub daily which is also measured in more locations moreover there are more water quality variables sediment nitrogen n phosphorus p etc in various forms organic and inorganic baker et al 2014 johnson et al 2014 water quality simulations are more complex than hydrologic simulations for example nutrient transport involves biogeochemical processes and usually requires more detailed model inputs such as fertilizer and manure applications across fields and existing water quality control practices in the study area kujawa et al 2020 martin et al 2021 probabilistic prediction which is assigning a probability to a possible output has been used in the hydrologic research community to quantify predictive uncertainty in simulated hydrologic model outputs mcinerney et al 2017 2018 a residual error model that represents total effects of data and hydrologic model errors is the most common approach to describe predictive uncertainty aboelnour et al 2020 mcinerney et al 2017 probabilistic approaches such as maximum likelihood bayesian and method of moment techniques have been widely used for hydrologic model applications the specification of a likelihood function which is usually derived from a residual error model for hydrologic models is required by bayesian and maximum likelihood techniques mcinerney et al 2017 2018 it needs substantial effort and computational costs to derive an appropriate likelihood function and estimate residual error model parameters therefore a simplified approach least square method of methods without a likelihood function specification was developed and applied to estimate streamflow autocorrelation residual error model parameters and showed robust residual error model performance in 23 watersheds in the u s and australia mcinerney et al 2017 2018 the predictive performance metrics of the least square method of methods technique were comparable to those from bayesian and maximum likelihood techniques over most catchments but the least square method of methods might be difficult to be used for complicated non gaussian residual error models mcinerney et al 2018 however understanding the transferability of the residual error transformation parameters that were used to describe error heteroscedasticity different variabilities of residual errors across hydrologic and water quality data still needs to be improved additionally an ensemble of model outputs has been expected to improve the predictive performance of hydrologic models to that of a single realization of model simulations cherkauer et al 2021 guo et al 2018c however it is unclear under which conditions a model ensemble can lead to better predictive uncertainty than a single realization of model simulations the following research gaps were identified 1 limited studies predicted water quality residual errors from hydrologic models over various study areas with a variety of water quality concerns 2 limited research has been conducted comparing the effects of residual error transformation parameters on water quality probabilistic predictions and evaluating the tradeoffs of different residual error performance metrics 3 few studies have quantitatively compared the impacts of an ensemble of model water quality simulations on predictive uncertainty with those of a single realization and 4 there is limited research on the transferability of residual error transformation parameters from hydrologic simulations to water quality simulations from residual error calibration to validation from a study area to an adjacent area and from one realization of a simulation to other realizations thus this research is to 1 apply a simplified post processing approach to model monthly hydrology and water quality residual errors to improve predictive uncertainty for hydrologic and water quality simulations from two hydrologic models over a diverse range of watersheds and fields 2 assess and compare the residual error model performance in projecting probabilistic predictions with different residual error transformation parameters and discuss tradeoffs of reliability precision and volumetric bias 3 quantify the differences in predictive uncertainty performance between a single realization and an average ensemble of hydrologic and water quality simulations 4 evaluate the transferability of the best residual error transformation parameters and 5 recommend residual error transformation parameter selection and other approaches for improved probabilistic predictions and practical applications 2 methods 2 1 study watersheds and fields eighteen watersheds and fields located in various regions with different water quality concerns in the u s were selected in this study fig 1 the sites ranged in size from 0 59 to 281 014 ha table 1 fourteen out of the 18 watersheds and fields are dominated by agriculture while four watersheds are dominated by urban areas table 1 monthly monitoring hydrologic and water quality data were available for these watersheds and fields hydrologic data included streamflow surface runoff baseflow and subsurface drainage flow and water quality data included sediment yields total n total p dissolved reactive p nitrate plus nitrite n and nitrate n table 1 the case study watersheds and fields had different water quality concerns for instance the st joseph river sjr watershed and sub watersheds inside of it axl ccw f34 and alg are within the maumee river watershed from which p loads delivered to lake erie are primarily responsible for harmful algal bloom issues there cibin et al 2016 wallace et al 2018 the wildcat creek wc and r5 watersheds and fields b bs e and es in the little vermilion river watershed are extensively tile drained areas inside of the mississippi river basin where n losses in runoff cause and worsen hypoxia conditions in the gulf of mexico cibin et al 2016 guo et al 2018a moreover the upper jones falls ujf catchment is in the chesapeake bay watershed where excess soil losses and high levels of n and p exports contribute to excessive algae growth in the chesapeake bay klein 1979 lee et al 2020 watersheds wc1 wc2 and wc3 in mississippi have major soil erosion problems guo et al 2021a more details about the characteristics of the selected study areas can be found in these previous studies aboelnour et al 2019 2020 cibin et al 2016 guo et al 2018b liu et al 2017 wallace et al 2018 2 2 simplified approach for parameter estimation a pre developed simplified and robust approach for estimating hydrologic model and residual error model parameters was applied in this study in two steps mcinerney et al 2017 2018 the first step involves calibrating hydrologic models and estimating parameters using the nash sutcliffe model efficiency coefficient nse objective function which is equivalent to the least square objective function the nse values were maximized to identify the calibrated results that matched well with each of the aforementioned monthly observed hydrologic and water quality data and estimate hydrologic model parameters the second step is estimating residual error parameters to calibrate residual error based on the method of moments method data s1 mcinerney et al 2017 2018 the method of moments method is one of the simplest and oldest approaches to identifying estimators which consists of equating the first population moments to the corresponding sample moments and solving the resulting system of equations the method of moments method can obtain consistent and unbiased estimators with an asymptotic normal distribution akritas and politis 2003 the algorithms eqs s1 s7 and descriptions of the hydrologic and water quality residual errors can be found in data s1 2 2 1 hydrologic model calibration validation and performance evaluation the soil and water assessment tool swat model was calibrated and validated at fifteen of the 18 watersheds and fields and the water erosion prediction project wepp model was calibrated at the other three watersheds using monitored hydrologic and water quality data guo et al 2018b 2021a table 1 hydrologic and water quality model parameters were fixed after the previous hydrologic model calibration and validation processes the details about the first step hydrologic and water quality model calibration validation and performance evaluation are described in data s2 2 2 2 residual error model calibration and validation the hydrologic and water quality simulations from swat calibrations were used for residual error model calibration and those from swat validations were used for residual error model validation a residual error web tool with the least square method of moments approach was applied to estimate hydrologic and water quality residual error parameters evaluate residual error model performance and produce probabilistic predictions http www algorithmik org au apps probabilisticpredictions mcinerney et al 2017 2018 more details about the residual error model setup can be found in data s3 2 2 3 residual error performance evaluation three residual error performance metrics reliability precision and volumetric bias calculated via the residual error web tool were used to assess hydrologic and water quality residual error model performance eqs s8 s 9 and s10 in data s3 mcinerney et al 2018 reliability and volumetric bias represent the degree of statistical consistency and the average tendency of the deviation between the predictive distribution and observed data precision means predictive distribution spread mcinerney et al 2018 previous studies implemented these three performance metrics for streamflow discharge residual errors and did not consider water quality residual errors evin et al 2014 mcinerney et al 2017 there are few water quality residual error modeling studies which did not use reliability precision and volumetric bias metrics del giudice et al 2018 hantush and chaudhary 2014 yen et al 2014 as one of the first studies to use these metrics to evaluate water quality residual error model performance the metric ranges representing good fair and poor water quality predictive uncertainty were classified in this study water quality residual error precision and volumetric bias metrics were defined to have higher values than those for hydrologic residual errors as water quality monitoring and simulation processes are more complex and uncertain reliability values of 0 0 0 1 0 1 to 0 4 and greater than 0 4 were considered as good fair and poor performance respectively for both hydrologic and water quality residual error models evin et al 2014 for hydrologic residual error models precision values of 0 0 0 4 0 4 to 0 7 and greater than 0 7 can be considered as good fair and poor performance respectively volumetric bias values of 0 0 0 2 0 2 to 0 4 and greater than 0 4 can be considered as good fair and poor performance respectively for water quality residual error models precision values of 0 0 0 6 0 6 to 1 0 and greater than 1 0 were defined in this study as good fair and poor performance respectively volumetric bias values of 0 0 0 3 0 3 to 0 5 and greater than 0 5 were classified as good fair and poor performance respectively more details of residual error model performance evaluation definitions and algorithms are described in data s3 besides these three metrics plots such as quantile quantile plot probability density of standardized residuals vs assumed error model and residual error plot of the relationship between standardized residuals and the predicted water quality data were recommended to evaluate water quality residual error model performance fig s5 moreover there are potential opportunities to test the defined performance metric ranges to improve water quality residual error model performance evaluation in further research 2 3 probabilistic prediction evaluation 2 3 1 residual error transformation parameters the impacts of residual error transformation schemes on predictive uncertainty of hydrologic and water quality residual errors were evaluated and compared residual error transformation schemes represented error heteroscedasticity for example larger errors for larger hydrologic and water quality values this study considered nine residual error transformation schemes the combinations of the box cox transformation parameters λ bc as 0 0 2 and 0 5 and offset parameter a as 0 0 0001 and 0 1 which were recommended in previous residual error studies eq s4 box cox transformation parameters λ bc fixed at prespecified values e g 0 0 2 and 0 5 produced better statistical performance than inferred from the data or fixed at negative prespecified values in previous applications the offset parameter a of 0 is essential in the least square method of moments approach as it provides the closest correspondence to common objective functions the offset parameter a of 0 0001 and 0 1 were also considered to evaluate the impacts of the offset parameters on predictive uncertainty mcinerney et al 2017 2018 the bc0 scheme λ 0 is the same as the natural logarithm transformation log in eq s3 thus the nine residual error transformation schemes selected were named as log a0 log a0 0001 log a0 1 bc0 2 a0 bc0 2 a0 0001 bc0 2 a0 1 bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 reliability precision and volumetric bias were analyzed for each residual error transformation scheme across hydrologic and water quality cases 2 3 2 tradeoffs of reliability precision and volumetric bias of the generated probabilistic predictions the tradeoffs of median values of reliability precision and volumetric bias between three groups of residual error schemes log0 bc0 2 and bc0 5 and three bc0 5 schemes bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 were analyzed for all hydrologic cases and all water quality cases additionally the tradeoffs of reliability precision and volumetric bias between the three bc0 5 schemes bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 for predictive uncertainty for an individual simulation streamflow total n in a single watershed wc were also investigated 2 3 3 a single realization vs an ensemble of calibrated hydrologic and water quality results probabilistic prediction performance for six single realizations of the calibrated results and those for the ensemble average average of the six realizations of the calibrated results in the sjr wc r5 wc1 wc2 and wc3 watersheds were compared and analyzed these six watersheds were selected in this study as each has six realizations of the calibrated hydrologic and water quality results in contrast other watersheds only have one or two realizations of calibrated results table 1 the six realizations of the calibrated results for each of these watersheds were either by different modelers or by the same modeler using different model setups or parameters residual error performance metrics for the ensemble average of the six realizations were compared to the median values and each of those for the six realizations the benefits of using the ensemble average for hydrologic and water quality probabilistic predictions in large watersheds were compared to those in small watersheds moreover adopting the ensemble average for hydrologic prediction uncertainty was also compared to that for water quality predictive uncertainty 2 3 4 transferability of residual error transformation parameters the transferability of residual error transformation parameters was evaluated specifically the predictive uncertainty performance under the best residual error transformation schemes between calibration and validation between hydrologic simulation and water quality simulation between a realization of simulation and other realizations and between a study area and adjacent study areas were assessed and compared 3 results and discussion 3 1 residual error models performance in capturing predictive uncertainties during the calibration the hydrologic models performance during calibration and validation is discussed in data s4 and table s1 the predictive performance of the residual error models with all nine residual error transformation schemes after the calibration across the 18 study watersheds and fields are shown in fig 2 generally all nine residual error schemes captured the predictive reliability of both hydrologic 21 cases and water quality 30 cases residual errors well the median values from all nine schemes across all watersheds and fields were fair 0 12 0 17 for hydrology and 0 195 0 24 for water quality fig 2a and b the residual error schemes bc0 5 a0 0001 and log a0 1 provided the best median values 0 12 of predictive reliability for hydrologic residual errors fig 2 a while bc0 5 a0 0001 and bc0 2 a0 yielded the best median reliability metrics 0 195 for water quality residual errors fig 2 b there were no significant differences between the best median reliability values and others 0 14 0 17 for hydrology and 0 20 0 24 for water quality in terms of predictive precision seven out of nine residual error schemes led to fair median values 0 42 0 65 for hydrologic residual errors fig 2 c and four out of nine schemes produced fair median values 0 64 0 90 for water quality residual errors fig 2 d scheme bc0 5 a0 1 provided the best median values of predictive precision for hydrologic 0 42 and water quality 0 64 residual errors the second and third median values of predictive precision for hydrologic residual errors 0 43 and 0 44 were from schemes bc0 5 a0 and bc0 5 a0 0001 the second best median value of predictive precision for water quality residual errors 0 68 was from schemes bc0 5 a0 and bc0 5 a0 0001 for volumetric bias seven out of nine residual error schemes were with good median values 0 12 0 20 for hydrologic residual errors fig 2 e and five out of nine schemes resulted in good or fair median values 0 19 0 30 for water quality residual errors fig 2 f scheme bc0 5 a0 1 provided the best median value 0 12 of predictive volumetric bias for hydrologic residual errors the median values of predictive volumetric bias for hydrologic residual errors from schemes bc0 5 a0 and bc0 5 a0 0001 were 0 14 and 0 13 respectively moreover the three bc0 5 schemes bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 had the best median value 0 19 of predictive volumetric bias for water quality residual errors similar to the performance of hydrologic models in capturing characteristics of simulated results reliability was the easiest metric and precision was the most difficult one to be predicted for both hydrologic and water quality residual error models in general residual error schemes with bc0 5 showed advantages in capturing median values of reliability precision and volumetric bias metrics better than other schemes across all hydrologic and water quality studies for each of three residual error performance metrics the median values across all case studies from bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 were close to that from each other 3 2 tradeoffs of reliability precision and volumetric bias of the generated probabilistic predictions the differences of median values of reliability precision and volumetric bias between three groups of residual error schemes log0 bc0 2 and bc0 5 λ 0 0 2 0 5 in all case studies for hydrologic and water quality predictive uncertainty are shown in fig 3 a and b each of three groups of residual error schemes was with three offset values a of 0 0 0001 and 0 1 for example the log0 group of residual error schemes consists of log0 a0 log0 a0 0001 and log0 a0 1 the number of case studies for hydrologic and water quality predictive uncertainty were 21 and 30 respectively thus the number of each residual error performance metric reliability precision or volumetric bias for each residual error scheme group was 63 for hydrologic predictive uncertainty and 90 for water quality predictive uncertainty compared to the log0 brown lines and bc0 2 blue lines the bc0 5 yellow lines residual error schemes yielded better reliability precision and volumetric bias values for both hydrologic and water quality predictive uncertainties in all case studies for example the median precision value of hydrologic predictive uncertainties from the bc0 5 schemes for all case studies was 0 43 better than those from the bc0 2 schemes 0 63 and the log0 schemes 0 87 fig 3 a the median volumetric bias value of water quality predictive uncertainties from the bc0 5 schemes for all case studies was 0 09 that was better than those from the bc0 2 schemes 0 27 and log0 schemes 1 05 fig 3 b the tradeoffs relevant to choosing a single residual error scheme from the three bc0 5 schemes for hydrologic and water quality predictive uncertainties were analyzed the median performance metrics across all 18 study watersheds and fields for bc0 5 with λ of 0 0 0001 and 0 1 are shown in fig 3 c and d the differences between the performance metrics of the three bc0 5 residual error schemes were minimal across the 21 hydrologic case studies and 30 water quality case studies the predictive performance was impacted by the residual error transformation schemes and affected by the hydrologic models themselves for hydrologic predictive uncertainties the bc0 5 a0 0001 scheme had the best median reliability value 0 12 close to those for bc0 5 a0 0 16 and bc0 5 a0 1 0 14 the bc0 5 a0 1 scheme provided the best median precision 0 42 and volumetric bias 0 12 values like those with the bc0 5 a0 0 43 and 0 14 and bc0 5 a0 0001 0 44 and 0 13 schemes fig 3 c for water quality predictive uncertainties the performance metrics with the three bc 0 5 schemes were similar to each other fig 3 d wc was selected as a representative study watershed to assess the tradeoffs between the three bc0 5 schemes for predictive uncertainty for individual variables in a single study watershed as wc had several water quality variables sediment yield total nitrogen and total phosphorus the performance metric values in the wc watershed with the bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 residual error schemes for streamflow and total n predictive uncertainty are presented in fig 3 e and f the tradeoffs between the performance metric values for individual variables in a single watershed e g wc were different from the median values for all hydrologic or water quality variables over all case studies for instance for hydrologic predictive uncertainties the bc0 5 a0 1 scheme had the best reliability value 0 04 but had the worst volumetric bias value 0 14 fig 3 e for water quality predictive uncertainties the bc0 5 a0 scheme could provide the best volumetric bias value 0 00 while reliability 0 17 and precision 0 51 values were close to those of the other schemes fig 3 f one residual error scheme group bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 performed better across the three metrics reliability precision and volumetric bias than the other two residual error scheme groups for all case studies both the selection of transformation scheme parameters λ and a and the ranges of hydrologic and water quality data could impact residual error performance metrics for instance log schemes λ 0 tend to have poor precision for low hydrologic and water quality values which could be improved by using larger offset values e g a 0 1 the extremely high hydrologic and water quality data might negatively impact box cox transformation performance unlike the log scheme bc0 2 and bc0 5 schemes have a variance stabilizing function that could flatten the increased hydrologic and water quality data improving performance metrics mcinerney et al 2017 it is not clear why bc0 5 outperforms bc0 2 across the study locations further studies are needed to quantify the impacts of various ranges of hydrologic and water quality data on the performance of transformation schemes a single residual error scheme such as bc0 5 a0 1 was not able to yield the best performance across all three metrics for all case studies compared to all cases studies the tradeoffs in the three metrics of the three residual error schemes for a single variable predictive uncertainty in a single study watershed became more obvious the bc0 5 residual error scheme group is thus recommended for better hydrologic and water quality uncertainty prediction the selection of the most suitable residual error scheme should be based on the purpose of the uncertainty prediction suppose a specific hydrologic or water quality variable or a performance metric in a study area is prioritized in that case the residual error scheme that produces the best metric for that variable can be chosen for uncertainty prediction 3 3 comparison of predictive uncertainty of a single realization of the calibrated results and that of an ensemble of calibrated results residual error model performance for six single realizations of the calibrated results boxplots in figs 4 and 5 and s1 s4 and those for the average of the six realizations ensemble average of the calibrated results triangles in figs 4 and 5 and s1 s4 were compared and analyzed for the sjr wc r5 wc1 wc2 and wc3 watersheds generating predictive uncertainties based on the ensemble average of six realizations of calibrated results was a better choice than those using a single realization of calibrated results in general residual error performance metrics for the ensemble average of the six realizations were better than the median values of those for the six realizations using the ensemble average of hydrologic and water quality simulations from large watersheds showed more enhancements in predictive uncertainty performance than those from small ones predictive uncertainty performance for streamflow discharge simulations showed more improvements when using the ensemble average than those for water quality simulations compared to other residual error schemes the bc0 5 a0 1 scheme could provide better performance metrics for each realization and the ensemble average of all six realizations 3 3 1 ensemble average vs the median of all realizations in general residual error performance metrics for the ensemble average of the six realizations were better than the median values of those for the six realizations for example the predictive reliabilities of the ensemble average of the six realizations of streamflow discharge residual errors in the sjr watershed for the nine residual error schemes ranged from 0 11 to 0 15 better than those of the median values 0 28 0 31 fig 4 a moreover the predictive precisions of the ensemble average of sediment yield residual errors in the sjr watershed for the nine residual error schemes ranged from 0 47 to 0 87 better than those of the median values 0 51 0 99 fig 4 f the predictive precisions of the ensemble average of the total n residual errors in the sjr watershed for the nine residual error schemes ranged from 0 36 to 0 67 better than those of the median values 0 43 0 82 fig 4 g generally the predictive uncertainty performance for the ensemble average was better than the lowest values the best of all realizations figs 4 and 5 even though several lowest values of performance metrics for all realizations were better than those of the ensemble average the latter was still better in general as a realization that had the lowest value of a residual error performance was not usually with good fair performance for other performance metrics moreover a realization with the lowest value under a residual error scheme might not have the best values for other residual error schemes for instance the predictive volumetric bias ranges of the six realizations of total p residual errors in the wc watershed for the nine residual error schemes were 0 00 and 0 69 while those of the ensemble average were 0 08 and 0 45 fig 5 l the second realization could provide low volumetric bias 0 00 0 39 for total p residual errors but had high precision values 0 43 1 52 across the nine residual error schemes fig 5 l for most residual error transformation schemes the predictive uncertainty of the ensemble average outperformed those of each realization the average of all realizations of calibrated results might produce better residual error performance as it could reduce the extreme results from single realizations martin et al 2021 sun et al 2014 zhang et al 2009 using the ensemble average of multiple realizations of simulated results could avoid unreasonable margin simulations from climate and hydrologic models cherkauer et al 2021 sun et al 2014 zhang et al 2009 the extremely high values from a single realization might impact the probabilistic uncertainty of the ensemble average for example sediment yields in watershed r5 were underestimated for one realization which dominated the ensemble average and resulted in a worse performance of uncertainty prediction than that of the median values of all realizations for several transformation schemes figs s1 b and s1 e and s1 h 3 3 2 large vs small watersheds for large watersheds hydrologic models tend to generate high streamflow discharge and water pollutant loads compared to small watersheds with relatively low water discharge using the ensemble average of simulations from large watersheds showed more improvements to predictive uncertainty performance than using the ensemble average of simulations from small watersheds for example compared to the median values of all six realizations the volumetric bias of streamflow discharge and reliability of sediment yield predictive uncertainty improved from fair to good with ensemble average in the sjr watershed with an area of 281 014 ha fig 5 i and b on the contrary the levels of residual error performance metrics did not change when using the ensemble average of hydrologic and water quality simulations in the r5 wc1 wc2 and wc3 watersheds with areas of 6 900 1 57 0 59 and 0 65 ha respectively figs s1 s4 more discussion on the comparison of using the ensemble average of hydrologic simulations for predictive uncertainties and that of water quality simulations is provided in data s5 3 4 transferability of transformation parameters 3 4 1 calibration vs validation periods the residual error performance metrics from the best transformation schemes during the calibration period were compared with those during validation generally the best residual error schemes bc0 5 a 0 1 or bc0 5 a 0 had acceptable residual error performance metrics for hydrologic and water quality predictive uncertainties for individual watersheds during both calibration and validation table 2 the 115 out of 118 cases had either good or fair residual error performance metrics table 2 in general the residual error models performance was consistent during both calibration and validation as 35 out of 59 cases had the same level for residual error metrics table 2 similarly the hydrologic models performance was also consistent during the calibration and validation table s1 considering more residual error transformation schemes might improve the hydrologic models probabilistic predictions for the hydrologic and water quality time series not only transformation schemes but also calibrated hydrologic models performance can impact the residual error models capabilities for instance the predictive precision values of sediment yield residual errors in the r5 watershed during calibration and the ujw watershed during calibration and validation were poor even for the best residual error scheme table 2 poor residual error model performance in producing sediment residual error might be due to unsatisfactory simulated sediment yields in the r5 and ujw watersheds from the calibrated swat model simulations table s1 the probabilistic predictions of monthly total n prediction time series with 50 and 90 probability limits in the wc watershed under residual error scheme bc0 5 a 0 1 during calibration and validation periods are shown in fig 6 the probabilistic predictions of monthly total n captured the observed data well during both calibration and validation periods fig 6 which were consistent with acceptable good fair reliability precision and volumetric bias in table 2 specifically 45 out of 72 63 of the observed monthly total n values fell within the 50 predictive probability limit and 67 out of 72 93 of the observed values fell within the 90 predictive probability limit fig 6 indicating acceptable reliability during calibration 0 16 in table 2 and validation 0 18 in table 2 the probabilistic predictions of the monthly total n time series black line in figs 6 and 50 and 90 probability limits red and yellow bands in fig 6 followed ups and downs of the observed data circles in fig 6 that indicated good precision during calibration 0 47 in table 2 and validation 0 53 in table 2 moreover the predictive quantile quantile plot fig s5 a showed a statistically reliable probabilistic prediction of monthly total n prediction which slightly underestimated the observed data evin et al 2013 mcinerney et al 2018 the density plot of the standardized residuals of predicted monthly total n indicated that the probability distribution of the standardized residuals of predicted monthly total n was generally symmetric to that of the assumed residual error model however the density plot of the standardized residuals of predicted monthly total n was skewed left skewness 0 76 and more peaked and heavy tailed kurtosis 0 74 fig s5 b evin et al 2013 the residual error plot of the dependence of standardized residuals on the predicted monthly total n revealed that the residual error heteroscedasticity was well captured by the residual model under residual error scheme bc0 5 a 0 1 fig s5 c mcinerney et al 2018 morawietz et al 2011 the variance of standardized monthly total n residuals decreased with the increase of simulated monthly total n fig s5 c 3 4 2 hydrology calibration vs water quality calibration residual error model performance for a single realization of the calibrated streamflow squares in fig 7 and those for the calibrated sediment yields total n and total p circles triangles and pluses in fig 7 were compared and analyzed in the sjr watershed in general reliability precision and volumetric bias of predictive uncertainty for the calibrated streamflow discharge results were consistent with calibrated water quality results fig 7 moreover not all streamflow discharge predictive uncertainty performance metrics were better than the water quality predictive uncertainty for the nine residual error schemes in the sjr watershed total p predictive uncertainty was worse than streamflow discharge sediment yield and total n predictive uncertainties specifically streamflow discharge predictive uncertainty had the best precision 0 44 and volumetric bias 0 15 for the bc0 5 schemes under which sediment total n and total p had the best precision 0 53 0 58 and 0 82 respectively and volumetric bias values 0 04 0 11 and 0 37 respectively fig 7 b and c reliability of hydrologic and water quality predictive uncertainties under the bc0 5 residual error schemes were similar to those under the log and bc0 2 schemes fig 7 a for instance total n predictive uncertainty reliability ranged from 0 05 to 0 06 under the bc0 5 schemes while it ranged from 0 04 to 0 06 under the log and bc0 2 schemes fig 7 a streamflow discharge predictive uncertainty had better precision values 0 44 1 15 than water quality predictive uncertainties fig 7 b while sediment yield and total n predictive uncertainties had the best reliability values 0 04 0 08 fig 7 a for all residual error schemes volumetric bias values of sediment yield predictive uncertainty 0 44 0 15 were better than those of other variables under the bc0 2 and bc0 5 schemes fig 7 c monitored total p data availability and length of time and the complexities of p simulation processes in hydrologic models contributed to poor predictive uncertainties for total p loss predictions in the sjr figs 4 and 6 and wc fig 5 watersheds specifically around 49 of monitored monthly total p data at the wc were missing during 2013 2018 and the data filling processes might increase total p predictive uncertainties moreover compared to streamflow discharge sediment and n simulations p simulations in hydrologic models e g particulate p in subsurface drainage systems in swat are still in the early stage and need tremendous improvements to improve p predictive uncertainties the transferability of the best performing transformation scheme from a realization of calibrated results to those from other realizations is discussed in data s6 and table s2 and from a realization of calibrated results in a watershed field to those in the adjacent watersheds and fields is covered in data s7 and table s3 3 5 recommendations on improvements to probabilistic predictions an ensemble of model outputs from diverse modelers are recommended to support policy and decision making on environmental management when it is possible using the ensemble average of hydrologic and water quality simulations can improve hydrologic and water quality predictive uncertainty performance especially for large watersheds moreover the variances among predictions from different models in an ensemble can warrant consideration in environmental management decision making compared to a single realization of a model output an ensemble of model outputs has the potential to concurrently evaluate the effects of all sources of model uncertainty such as model inputs parameterization and model structures an ensemble of hydrologic model outputs is usually more computationally expensive than a single realization if multiple models are not viable for the study areas of interest performing uncertainty analysis to assess sources of model uncertainty can improve model calibration and predictive uncertainty and benefit model applications the simplified least square method of moments approach applied in this study is strongly recommended it considers the effects of all model prediction errors and an affordable computational expense more residual error transformation parameters could potentially be considered and modified automatically to improve probabilistic predictions complex uncertainty analysis in further research can provide the opportunity to evaluate each source of model uncertainty e g data monitoring model inputs and structures model calibration processes and identify the source with the greatest uncertainty there are potential opportunities to improve hydrology and water quality prediction uncertainty predictive uncertainty may be improved during the post processing of model outputs via selecting suitable residual error transformation schemes uncertainty may be reduced before post processing processes such as in the monitoring data collection and in hydrologic model improvements the lack of water quality monitoring data is one of the major sources of water quality modeling uncertainty and the major reason for the lack of water quality residual error modeling research monitoring water quality data more frequently daily instead of monthly in more locations might reduce predictive uncertainty and provide more opportunities to evaluate water quality predictive uncertainty guo et al 2020 for instance instead of collecting bi weekly or monthly water quality data at the outlet of a watershed monitoring daily water quality in streams and at fields inside of a watershed could reduce the uncertainty in the observed data used for model calibration improving model inputs that represent agricultural management operations e g fertilizer and manure application timing rates and approaches and temporal spatial dynamics of soil nutrient levels can reduce model uncertainty in predicting nutrient delivery guo et al 2020 martin et al 2019 structures and physical processes of nutrient transport in hydrologic models could be improved for instance in stream processes and the particulate and soluble nutrient estimation processes e g particulate p transport through subsurface drainage systems could be enhanced in swat to improve the probabilistic predictions in nutrient loss simulations evenson et al 2021 guo et al 2020 martin et al 2021 additionally temporally varying channel soil detachment parameters in wepp can better represent the predictive uncertainty of sediment yields at the watershed outlets guo et al 2021a 2021b 4 conclusions a simplified residual error approach was adopted to produce probabilistic hydrologic and water quality predictions and assess probabilistic predictions at 18 watershed and field locations in the u s reliability was the easiest metric and precision was the most difficult one to be captured for both the hydrologic and water quality residual error models residual error schemes that included bc0 5 better captured median values of reliability precision and volumetric bias metrics than other schemes across the hydrologic and water quality studies the differences between the performance metrics of the three bc0 5 residual error schemes were negligible across all hydrologic and water quality case studies the tradeoffs between the performance metric values for individual variables in a single watershed e g wc watershed were greater than those from the median values for all hydrologic or water quality variables over all case studies a single residual error scheme usually cannot produce the performance for all three predictive uncertainty performance metrics for all hydrologic and water quality uncertainty predictions identifying the most suitable residual error scheme should be based on the major pollutants of concern and the prioritized purposes of the uncertainty prediction at a specific study location adopting the ensemble average of hydrologic and water quality simulations can enhance predictive uncertainty assessments especially for large watersheds and extremely large discharge and or pollutant loss values however performing multiple realizations of hydrologic and water quality simulations is more expensive than conducting a single realization an ensemble of simulations for probabilistic predictions in small watersheds and fields with low magnitudes of discharge and or pollutant losses is unnecessary the best residual error transformation parameter scheme is transferable between the calibration period and validation period between hydrology calibration and water quality calibration between a realization of calibrated results and other realizations and between a study area and adjacent study areas future research opportunities to improve hydrologic and water quality probabilistic predictions via improved data monitoring and physical process enhancements in hydrologic models are also recommended those research results could improve the representation of the predictive uncertainty of water quantity and quality simulations from regions with various water quality concerns and enhance probabilistic predictions in research and operational practices credit authorship contribution statement tian guo conceptualization methodology formal analysis investigation data curation visualization writing original draft writing review editing yaoze liu methodology data curation formal analysis writing review editing gang shao methodology data curation formal analysis visualization writing review editing bernard a engel investigation data curation methodology supervision funding acquisition project administration writing review editing ashish sharma conceptualization methodology writing review editing lucy a marshall conceptualization methodology dennis c flanagan data curation funding acquisition writing review editing raj cibin data curation writing review editing carlington w wallace data curation writing review editing kaiguang zhao writing review editing dongyang ren data curation writing review editing johann vera mercado data curation writing review editing mohamed a aboelnour data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment funding supporting this research was provided by the usda natural resources conservation service ars nrcs interagency agreement 60 5020 8 003 through the usda agricultural research service and the purdue university department of agricultural biological engineering appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105499 
25549,uncertainty quantification between simulated and observed water quality simulations needs to be improved this study generated and evaluated probabilistic hydrologic and water quality predictions in 18 locations across the u s using residual based modeling a box cox transformation scheme group provided the best predictive uncertainties for all case studies the tradeoffs in the performance metrics for a single variable predictive uncertainty in a single study watershed were more obvious than those for all hydrologic or water quality cases compared to a single realization of simulations the ensemble average of hydrologic and water quality simulations better represented the predictive uncertainty especially for large watersheds this study recommends various opportunities via residual error scheme selection data monitoring improvement and hydrologic model enhancement to robust hydrologic and water quality predictive uncertainties the results could improve the quantification of the predictive uncertainty of hydrologic and water quality simulations and guide probabilistic prediction enhancement graphical abstract image 1 keywords residual error estimation hydrologic and water quality models water quality prediction uncertainty residual error model robustness data availability data will be made available on request 1 introduction hydrologic models have been applied to predict hydrology and water quality in various regions liu et al 2019 martin et al 2021 srivastava et al 2020 quantifying predictive uncertainty of hydrologic and water quality simulations allows for better understanding of potential risks and possible water pollution from current and future storm events mcinerney et al 2017 2018 determination of reliable precise and unbiased probabilistic predictions of hydrology and water quality outcomes help water resources practitioners better manage water resources and improve water quality mcinerney et al 2017 2018 quantification of predictive uncertainty in hydrologic and water quality modeling is challenging prediction uncertainty can be attributed to the following factors hydrology and water quality data monitoring processes e g approaches frequencies and locations hydrologic model inputs and structures e g resolutions of elevation soil and land use the understanding of characteristics of study watersheds and fields and hydrologic and residual error model calibration processes evenson et al 2021 martin et al 2021 wallace et al 2017 water quality predictions can be more uncertain than hydrologic predictions the frequency of monitored water quality data e g bi weekly weekly or monthly is usually less than that of hydrology data e g daily or sub daily which is also measured in more locations moreover there are more water quality variables sediment nitrogen n phosphorus p etc in various forms organic and inorganic baker et al 2014 johnson et al 2014 water quality simulations are more complex than hydrologic simulations for example nutrient transport involves biogeochemical processes and usually requires more detailed model inputs such as fertilizer and manure applications across fields and existing water quality control practices in the study area kujawa et al 2020 martin et al 2021 probabilistic prediction which is assigning a probability to a possible output has been used in the hydrologic research community to quantify predictive uncertainty in simulated hydrologic model outputs mcinerney et al 2017 2018 a residual error model that represents total effects of data and hydrologic model errors is the most common approach to describe predictive uncertainty aboelnour et al 2020 mcinerney et al 2017 probabilistic approaches such as maximum likelihood bayesian and method of moment techniques have been widely used for hydrologic model applications the specification of a likelihood function which is usually derived from a residual error model for hydrologic models is required by bayesian and maximum likelihood techniques mcinerney et al 2017 2018 it needs substantial effort and computational costs to derive an appropriate likelihood function and estimate residual error model parameters therefore a simplified approach least square method of methods without a likelihood function specification was developed and applied to estimate streamflow autocorrelation residual error model parameters and showed robust residual error model performance in 23 watersheds in the u s and australia mcinerney et al 2017 2018 the predictive performance metrics of the least square method of methods technique were comparable to those from bayesian and maximum likelihood techniques over most catchments but the least square method of methods might be difficult to be used for complicated non gaussian residual error models mcinerney et al 2018 however understanding the transferability of the residual error transformation parameters that were used to describe error heteroscedasticity different variabilities of residual errors across hydrologic and water quality data still needs to be improved additionally an ensemble of model outputs has been expected to improve the predictive performance of hydrologic models to that of a single realization of model simulations cherkauer et al 2021 guo et al 2018c however it is unclear under which conditions a model ensemble can lead to better predictive uncertainty than a single realization of model simulations the following research gaps were identified 1 limited studies predicted water quality residual errors from hydrologic models over various study areas with a variety of water quality concerns 2 limited research has been conducted comparing the effects of residual error transformation parameters on water quality probabilistic predictions and evaluating the tradeoffs of different residual error performance metrics 3 few studies have quantitatively compared the impacts of an ensemble of model water quality simulations on predictive uncertainty with those of a single realization and 4 there is limited research on the transferability of residual error transformation parameters from hydrologic simulations to water quality simulations from residual error calibration to validation from a study area to an adjacent area and from one realization of a simulation to other realizations thus this research is to 1 apply a simplified post processing approach to model monthly hydrology and water quality residual errors to improve predictive uncertainty for hydrologic and water quality simulations from two hydrologic models over a diverse range of watersheds and fields 2 assess and compare the residual error model performance in projecting probabilistic predictions with different residual error transformation parameters and discuss tradeoffs of reliability precision and volumetric bias 3 quantify the differences in predictive uncertainty performance between a single realization and an average ensemble of hydrologic and water quality simulations 4 evaluate the transferability of the best residual error transformation parameters and 5 recommend residual error transformation parameter selection and other approaches for improved probabilistic predictions and practical applications 2 methods 2 1 study watersheds and fields eighteen watersheds and fields located in various regions with different water quality concerns in the u s were selected in this study fig 1 the sites ranged in size from 0 59 to 281 014 ha table 1 fourteen out of the 18 watersheds and fields are dominated by agriculture while four watersheds are dominated by urban areas table 1 monthly monitoring hydrologic and water quality data were available for these watersheds and fields hydrologic data included streamflow surface runoff baseflow and subsurface drainage flow and water quality data included sediment yields total n total p dissolved reactive p nitrate plus nitrite n and nitrate n table 1 the case study watersheds and fields had different water quality concerns for instance the st joseph river sjr watershed and sub watersheds inside of it axl ccw f34 and alg are within the maumee river watershed from which p loads delivered to lake erie are primarily responsible for harmful algal bloom issues there cibin et al 2016 wallace et al 2018 the wildcat creek wc and r5 watersheds and fields b bs e and es in the little vermilion river watershed are extensively tile drained areas inside of the mississippi river basin where n losses in runoff cause and worsen hypoxia conditions in the gulf of mexico cibin et al 2016 guo et al 2018a moreover the upper jones falls ujf catchment is in the chesapeake bay watershed where excess soil losses and high levels of n and p exports contribute to excessive algae growth in the chesapeake bay klein 1979 lee et al 2020 watersheds wc1 wc2 and wc3 in mississippi have major soil erosion problems guo et al 2021a more details about the characteristics of the selected study areas can be found in these previous studies aboelnour et al 2019 2020 cibin et al 2016 guo et al 2018b liu et al 2017 wallace et al 2018 2 2 simplified approach for parameter estimation a pre developed simplified and robust approach for estimating hydrologic model and residual error model parameters was applied in this study in two steps mcinerney et al 2017 2018 the first step involves calibrating hydrologic models and estimating parameters using the nash sutcliffe model efficiency coefficient nse objective function which is equivalent to the least square objective function the nse values were maximized to identify the calibrated results that matched well with each of the aforementioned monthly observed hydrologic and water quality data and estimate hydrologic model parameters the second step is estimating residual error parameters to calibrate residual error based on the method of moments method data s1 mcinerney et al 2017 2018 the method of moments method is one of the simplest and oldest approaches to identifying estimators which consists of equating the first population moments to the corresponding sample moments and solving the resulting system of equations the method of moments method can obtain consistent and unbiased estimators with an asymptotic normal distribution akritas and politis 2003 the algorithms eqs s1 s7 and descriptions of the hydrologic and water quality residual errors can be found in data s1 2 2 1 hydrologic model calibration validation and performance evaluation the soil and water assessment tool swat model was calibrated and validated at fifteen of the 18 watersheds and fields and the water erosion prediction project wepp model was calibrated at the other three watersheds using monitored hydrologic and water quality data guo et al 2018b 2021a table 1 hydrologic and water quality model parameters were fixed after the previous hydrologic model calibration and validation processes the details about the first step hydrologic and water quality model calibration validation and performance evaluation are described in data s2 2 2 2 residual error model calibration and validation the hydrologic and water quality simulations from swat calibrations were used for residual error model calibration and those from swat validations were used for residual error model validation a residual error web tool with the least square method of moments approach was applied to estimate hydrologic and water quality residual error parameters evaluate residual error model performance and produce probabilistic predictions http www algorithmik org au apps probabilisticpredictions mcinerney et al 2017 2018 more details about the residual error model setup can be found in data s3 2 2 3 residual error performance evaluation three residual error performance metrics reliability precision and volumetric bias calculated via the residual error web tool were used to assess hydrologic and water quality residual error model performance eqs s8 s 9 and s10 in data s3 mcinerney et al 2018 reliability and volumetric bias represent the degree of statistical consistency and the average tendency of the deviation between the predictive distribution and observed data precision means predictive distribution spread mcinerney et al 2018 previous studies implemented these three performance metrics for streamflow discharge residual errors and did not consider water quality residual errors evin et al 2014 mcinerney et al 2017 there are few water quality residual error modeling studies which did not use reliability precision and volumetric bias metrics del giudice et al 2018 hantush and chaudhary 2014 yen et al 2014 as one of the first studies to use these metrics to evaluate water quality residual error model performance the metric ranges representing good fair and poor water quality predictive uncertainty were classified in this study water quality residual error precision and volumetric bias metrics were defined to have higher values than those for hydrologic residual errors as water quality monitoring and simulation processes are more complex and uncertain reliability values of 0 0 0 1 0 1 to 0 4 and greater than 0 4 were considered as good fair and poor performance respectively for both hydrologic and water quality residual error models evin et al 2014 for hydrologic residual error models precision values of 0 0 0 4 0 4 to 0 7 and greater than 0 7 can be considered as good fair and poor performance respectively volumetric bias values of 0 0 0 2 0 2 to 0 4 and greater than 0 4 can be considered as good fair and poor performance respectively for water quality residual error models precision values of 0 0 0 6 0 6 to 1 0 and greater than 1 0 were defined in this study as good fair and poor performance respectively volumetric bias values of 0 0 0 3 0 3 to 0 5 and greater than 0 5 were classified as good fair and poor performance respectively more details of residual error model performance evaluation definitions and algorithms are described in data s3 besides these three metrics plots such as quantile quantile plot probability density of standardized residuals vs assumed error model and residual error plot of the relationship between standardized residuals and the predicted water quality data were recommended to evaluate water quality residual error model performance fig s5 moreover there are potential opportunities to test the defined performance metric ranges to improve water quality residual error model performance evaluation in further research 2 3 probabilistic prediction evaluation 2 3 1 residual error transformation parameters the impacts of residual error transformation schemes on predictive uncertainty of hydrologic and water quality residual errors were evaluated and compared residual error transformation schemes represented error heteroscedasticity for example larger errors for larger hydrologic and water quality values this study considered nine residual error transformation schemes the combinations of the box cox transformation parameters λ bc as 0 0 2 and 0 5 and offset parameter a as 0 0 0001 and 0 1 which were recommended in previous residual error studies eq s4 box cox transformation parameters λ bc fixed at prespecified values e g 0 0 2 and 0 5 produced better statistical performance than inferred from the data or fixed at negative prespecified values in previous applications the offset parameter a of 0 is essential in the least square method of moments approach as it provides the closest correspondence to common objective functions the offset parameter a of 0 0001 and 0 1 were also considered to evaluate the impacts of the offset parameters on predictive uncertainty mcinerney et al 2017 2018 the bc0 scheme λ 0 is the same as the natural logarithm transformation log in eq s3 thus the nine residual error transformation schemes selected were named as log a0 log a0 0001 log a0 1 bc0 2 a0 bc0 2 a0 0001 bc0 2 a0 1 bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 reliability precision and volumetric bias were analyzed for each residual error transformation scheme across hydrologic and water quality cases 2 3 2 tradeoffs of reliability precision and volumetric bias of the generated probabilistic predictions the tradeoffs of median values of reliability precision and volumetric bias between three groups of residual error schemes log0 bc0 2 and bc0 5 and three bc0 5 schemes bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 were analyzed for all hydrologic cases and all water quality cases additionally the tradeoffs of reliability precision and volumetric bias between the three bc0 5 schemes bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 for predictive uncertainty for an individual simulation streamflow total n in a single watershed wc were also investigated 2 3 3 a single realization vs an ensemble of calibrated hydrologic and water quality results probabilistic prediction performance for six single realizations of the calibrated results and those for the ensemble average average of the six realizations of the calibrated results in the sjr wc r5 wc1 wc2 and wc3 watersheds were compared and analyzed these six watersheds were selected in this study as each has six realizations of the calibrated hydrologic and water quality results in contrast other watersheds only have one or two realizations of calibrated results table 1 the six realizations of the calibrated results for each of these watersheds were either by different modelers or by the same modeler using different model setups or parameters residual error performance metrics for the ensemble average of the six realizations were compared to the median values and each of those for the six realizations the benefits of using the ensemble average for hydrologic and water quality probabilistic predictions in large watersheds were compared to those in small watersheds moreover adopting the ensemble average for hydrologic prediction uncertainty was also compared to that for water quality predictive uncertainty 2 3 4 transferability of residual error transformation parameters the transferability of residual error transformation parameters was evaluated specifically the predictive uncertainty performance under the best residual error transformation schemes between calibration and validation between hydrologic simulation and water quality simulation between a realization of simulation and other realizations and between a study area and adjacent study areas were assessed and compared 3 results and discussion 3 1 residual error models performance in capturing predictive uncertainties during the calibration the hydrologic models performance during calibration and validation is discussed in data s4 and table s1 the predictive performance of the residual error models with all nine residual error transformation schemes after the calibration across the 18 study watersheds and fields are shown in fig 2 generally all nine residual error schemes captured the predictive reliability of both hydrologic 21 cases and water quality 30 cases residual errors well the median values from all nine schemes across all watersheds and fields were fair 0 12 0 17 for hydrology and 0 195 0 24 for water quality fig 2a and b the residual error schemes bc0 5 a0 0001 and log a0 1 provided the best median values 0 12 of predictive reliability for hydrologic residual errors fig 2 a while bc0 5 a0 0001 and bc0 2 a0 yielded the best median reliability metrics 0 195 for water quality residual errors fig 2 b there were no significant differences between the best median reliability values and others 0 14 0 17 for hydrology and 0 20 0 24 for water quality in terms of predictive precision seven out of nine residual error schemes led to fair median values 0 42 0 65 for hydrologic residual errors fig 2 c and four out of nine schemes produced fair median values 0 64 0 90 for water quality residual errors fig 2 d scheme bc0 5 a0 1 provided the best median values of predictive precision for hydrologic 0 42 and water quality 0 64 residual errors the second and third median values of predictive precision for hydrologic residual errors 0 43 and 0 44 were from schemes bc0 5 a0 and bc0 5 a0 0001 the second best median value of predictive precision for water quality residual errors 0 68 was from schemes bc0 5 a0 and bc0 5 a0 0001 for volumetric bias seven out of nine residual error schemes were with good median values 0 12 0 20 for hydrologic residual errors fig 2 e and five out of nine schemes resulted in good or fair median values 0 19 0 30 for water quality residual errors fig 2 f scheme bc0 5 a0 1 provided the best median value 0 12 of predictive volumetric bias for hydrologic residual errors the median values of predictive volumetric bias for hydrologic residual errors from schemes bc0 5 a0 and bc0 5 a0 0001 were 0 14 and 0 13 respectively moreover the three bc0 5 schemes bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 had the best median value 0 19 of predictive volumetric bias for water quality residual errors similar to the performance of hydrologic models in capturing characteristics of simulated results reliability was the easiest metric and precision was the most difficult one to be predicted for both hydrologic and water quality residual error models in general residual error schemes with bc0 5 showed advantages in capturing median values of reliability precision and volumetric bias metrics better than other schemes across all hydrologic and water quality studies for each of three residual error performance metrics the median values across all case studies from bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 were close to that from each other 3 2 tradeoffs of reliability precision and volumetric bias of the generated probabilistic predictions the differences of median values of reliability precision and volumetric bias between three groups of residual error schemes log0 bc0 2 and bc0 5 λ 0 0 2 0 5 in all case studies for hydrologic and water quality predictive uncertainty are shown in fig 3 a and b each of three groups of residual error schemes was with three offset values a of 0 0 0001 and 0 1 for example the log0 group of residual error schemes consists of log0 a0 log0 a0 0001 and log0 a0 1 the number of case studies for hydrologic and water quality predictive uncertainty were 21 and 30 respectively thus the number of each residual error performance metric reliability precision or volumetric bias for each residual error scheme group was 63 for hydrologic predictive uncertainty and 90 for water quality predictive uncertainty compared to the log0 brown lines and bc0 2 blue lines the bc0 5 yellow lines residual error schemes yielded better reliability precision and volumetric bias values for both hydrologic and water quality predictive uncertainties in all case studies for example the median precision value of hydrologic predictive uncertainties from the bc0 5 schemes for all case studies was 0 43 better than those from the bc0 2 schemes 0 63 and the log0 schemes 0 87 fig 3 a the median volumetric bias value of water quality predictive uncertainties from the bc0 5 schemes for all case studies was 0 09 that was better than those from the bc0 2 schemes 0 27 and log0 schemes 1 05 fig 3 b the tradeoffs relevant to choosing a single residual error scheme from the three bc0 5 schemes for hydrologic and water quality predictive uncertainties were analyzed the median performance metrics across all 18 study watersheds and fields for bc0 5 with λ of 0 0 0001 and 0 1 are shown in fig 3 c and d the differences between the performance metrics of the three bc0 5 residual error schemes were minimal across the 21 hydrologic case studies and 30 water quality case studies the predictive performance was impacted by the residual error transformation schemes and affected by the hydrologic models themselves for hydrologic predictive uncertainties the bc0 5 a0 0001 scheme had the best median reliability value 0 12 close to those for bc0 5 a0 0 16 and bc0 5 a0 1 0 14 the bc0 5 a0 1 scheme provided the best median precision 0 42 and volumetric bias 0 12 values like those with the bc0 5 a0 0 43 and 0 14 and bc0 5 a0 0001 0 44 and 0 13 schemes fig 3 c for water quality predictive uncertainties the performance metrics with the three bc 0 5 schemes were similar to each other fig 3 d wc was selected as a representative study watershed to assess the tradeoffs between the three bc0 5 schemes for predictive uncertainty for individual variables in a single study watershed as wc had several water quality variables sediment yield total nitrogen and total phosphorus the performance metric values in the wc watershed with the bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 residual error schemes for streamflow and total n predictive uncertainty are presented in fig 3 e and f the tradeoffs between the performance metric values for individual variables in a single watershed e g wc were different from the median values for all hydrologic or water quality variables over all case studies for instance for hydrologic predictive uncertainties the bc0 5 a0 1 scheme had the best reliability value 0 04 but had the worst volumetric bias value 0 14 fig 3 e for water quality predictive uncertainties the bc0 5 a0 scheme could provide the best volumetric bias value 0 00 while reliability 0 17 and precision 0 51 values were close to those of the other schemes fig 3 f one residual error scheme group bc0 5 a0 bc0 5 a0 0001 and bc0 5 a0 1 performed better across the three metrics reliability precision and volumetric bias than the other two residual error scheme groups for all case studies both the selection of transformation scheme parameters λ and a and the ranges of hydrologic and water quality data could impact residual error performance metrics for instance log schemes λ 0 tend to have poor precision for low hydrologic and water quality values which could be improved by using larger offset values e g a 0 1 the extremely high hydrologic and water quality data might negatively impact box cox transformation performance unlike the log scheme bc0 2 and bc0 5 schemes have a variance stabilizing function that could flatten the increased hydrologic and water quality data improving performance metrics mcinerney et al 2017 it is not clear why bc0 5 outperforms bc0 2 across the study locations further studies are needed to quantify the impacts of various ranges of hydrologic and water quality data on the performance of transformation schemes a single residual error scheme such as bc0 5 a0 1 was not able to yield the best performance across all three metrics for all case studies compared to all cases studies the tradeoffs in the three metrics of the three residual error schemes for a single variable predictive uncertainty in a single study watershed became more obvious the bc0 5 residual error scheme group is thus recommended for better hydrologic and water quality uncertainty prediction the selection of the most suitable residual error scheme should be based on the purpose of the uncertainty prediction suppose a specific hydrologic or water quality variable or a performance metric in a study area is prioritized in that case the residual error scheme that produces the best metric for that variable can be chosen for uncertainty prediction 3 3 comparison of predictive uncertainty of a single realization of the calibrated results and that of an ensemble of calibrated results residual error model performance for six single realizations of the calibrated results boxplots in figs 4 and 5 and s1 s4 and those for the average of the six realizations ensemble average of the calibrated results triangles in figs 4 and 5 and s1 s4 were compared and analyzed for the sjr wc r5 wc1 wc2 and wc3 watersheds generating predictive uncertainties based on the ensemble average of six realizations of calibrated results was a better choice than those using a single realization of calibrated results in general residual error performance metrics for the ensemble average of the six realizations were better than the median values of those for the six realizations using the ensemble average of hydrologic and water quality simulations from large watersheds showed more enhancements in predictive uncertainty performance than those from small ones predictive uncertainty performance for streamflow discharge simulations showed more improvements when using the ensemble average than those for water quality simulations compared to other residual error schemes the bc0 5 a0 1 scheme could provide better performance metrics for each realization and the ensemble average of all six realizations 3 3 1 ensemble average vs the median of all realizations in general residual error performance metrics for the ensemble average of the six realizations were better than the median values of those for the six realizations for example the predictive reliabilities of the ensemble average of the six realizations of streamflow discharge residual errors in the sjr watershed for the nine residual error schemes ranged from 0 11 to 0 15 better than those of the median values 0 28 0 31 fig 4 a moreover the predictive precisions of the ensemble average of sediment yield residual errors in the sjr watershed for the nine residual error schemes ranged from 0 47 to 0 87 better than those of the median values 0 51 0 99 fig 4 f the predictive precisions of the ensemble average of the total n residual errors in the sjr watershed for the nine residual error schemes ranged from 0 36 to 0 67 better than those of the median values 0 43 0 82 fig 4 g generally the predictive uncertainty performance for the ensemble average was better than the lowest values the best of all realizations figs 4 and 5 even though several lowest values of performance metrics for all realizations were better than those of the ensemble average the latter was still better in general as a realization that had the lowest value of a residual error performance was not usually with good fair performance for other performance metrics moreover a realization with the lowest value under a residual error scheme might not have the best values for other residual error schemes for instance the predictive volumetric bias ranges of the six realizations of total p residual errors in the wc watershed for the nine residual error schemes were 0 00 and 0 69 while those of the ensemble average were 0 08 and 0 45 fig 5 l the second realization could provide low volumetric bias 0 00 0 39 for total p residual errors but had high precision values 0 43 1 52 across the nine residual error schemes fig 5 l for most residual error transformation schemes the predictive uncertainty of the ensemble average outperformed those of each realization the average of all realizations of calibrated results might produce better residual error performance as it could reduce the extreme results from single realizations martin et al 2021 sun et al 2014 zhang et al 2009 using the ensemble average of multiple realizations of simulated results could avoid unreasonable margin simulations from climate and hydrologic models cherkauer et al 2021 sun et al 2014 zhang et al 2009 the extremely high values from a single realization might impact the probabilistic uncertainty of the ensemble average for example sediment yields in watershed r5 were underestimated for one realization which dominated the ensemble average and resulted in a worse performance of uncertainty prediction than that of the median values of all realizations for several transformation schemes figs s1 b and s1 e and s1 h 3 3 2 large vs small watersheds for large watersheds hydrologic models tend to generate high streamflow discharge and water pollutant loads compared to small watersheds with relatively low water discharge using the ensemble average of simulations from large watersheds showed more improvements to predictive uncertainty performance than using the ensemble average of simulations from small watersheds for example compared to the median values of all six realizations the volumetric bias of streamflow discharge and reliability of sediment yield predictive uncertainty improved from fair to good with ensemble average in the sjr watershed with an area of 281 014 ha fig 5 i and b on the contrary the levels of residual error performance metrics did not change when using the ensemble average of hydrologic and water quality simulations in the r5 wc1 wc2 and wc3 watersheds with areas of 6 900 1 57 0 59 and 0 65 ha respectively figs s1 s4 more discussion on the comparison of using the ensemble average of hydrologic simulations for predictive uncertainties and that of water quality simulations is provided in data s5 3 4 transferability of transformation parameters 3 4 1 calibration vs validation periods the residual error performance metrics from the best transformation schemes during the calibration period were compared with those during validation generally the best residual error schemes bc0 5 a 0 1 or bc0 5 a 0 had acceptable residual error performance metrics for hydrologic and water quality predictive uncertainties for individual watersheds during both calibration and validation table 2 the 115 out of 118 cases had either good or fair residual error performance metrics table 2 in general the residual error models performance was consistent during both calibration and validation as 35 out of 59 cases had the same level for residual error metrics table 2 similarly the hydrologic models performance was also consistent during the calibration and validation table s1 considering more residual error transformation schemes might improve the hydrologic models probabilistic predictions for the hydrologic and water quality time series not only transformation schemes but also calibrated hydrologic models performance can impact the residual error models capabilities for instance the predictive precision values of sediment yield residual errors in the r5 watershed during calibration and the ujw watershed during calibration and validation were poor even for the best residual error scheme table 2 poor residual error model performance in producing sediment residual error might be due to unsatisfactory simulated sediment yields in the r5 and ujw watersheds from the calibrated swat model simulations table s1 the probabilistic predictions of monthly total n prediction time series with 50 and 90 probability limits in the wc watershed under residual error scheme bc0 5 a 0 1 during calibration and validation periods are shown in fig 6 the probabilistic predictions of monthly total n captured the observed data well during both calibration and validation periods fig 6 which were consistent with acceptable good fair reliability precision and volumetric bias in table 2 specifically 45 out of 72 63 of the observed monthly total n values fell within the 50 predictive probability limit and 67 out of 72 93 of the observed values fell within the 90 predictive probability limit fig 6 indicating acceptable reliability during calibration 0 16 in table 2 and validation 0 18 in table 2 the probabilistic predictions of the monthly total n time series black line in figs 6 and 50 and 90 probability limits red and yellow bands in fig 6 followed ups and downs of the observed data circles in fig 6 that indicated good precision during calibration 0 47 in table 2 and validation 0 53 in table 2 moreover the predictive quantile quantile plot fig s5 a showed a statistically reliable probabilistic prediction of monthly total n prediction which slightly underestimated the observed data evin et al 2013 mcinerney et al 2018 the density plot of the standardized residuals of predicted monthly total n indicated that the probability distribution of the standardized residuals of predicted monthly total n was generally symmetric to that of the assumed residual error model however the density plot of the standardized residuals of predicted monthly total n was skewed left skewness 0 76 and more peaked and heavy tailed kurtosis 0 74 fig s5 b evin et al 2013 the residual error plot of the dependence of standardized residuals on the predicted monthly total n revealed that the residual error heteroscedasticity was well captured by the residual model under residual error scheme bc0 5 a 0 1 fig s5 c mcinerney et al 2018 morawietz et al 2011 the variance of standardized monthly total n residuals decreased with the increase of simulated monthly total n fig s5 c 3 4 2 hydrology calibration vs water quality calibration residual error model performance for a single realization of the calibrated streamflow squares in fig 7 and those for the calibrated sediment yields total n and total p circles triangles and pluses in fig 7 were compared and analyzed in the sjr watershed in general reliability precision and volumetric bias of predictive uncertainty for the calibrated streamflow discharge results were consistent with calibrated water quality results fig 7 moreover not all streamflow discharge predictive uncertainty performance metrics were better than the water quality predictive uncertainty for the nine residual error schemes in the sjr watershed total p predictive uncertainty was worse than streamflow discharge sediment yield and total n predictive uncertainties specifically streamflow discharge predictive uncertainty had the best precision 0 44 and volumetric bias 0 15 for the bc0 5 schemes under which sediment total n and total p had the best precision 0 53 0 58 and 0 82 respectively and volumetric bias values 0 04 0 11 and 0 37 respectively fig 7 b and c reliability of hydrologic and water quality predictive uncertainties under the bc0 5 residual error schemes were similar to those under the log and bc0 2 schemes fig 7 a for instance total n predictive uncertainty reliability ranged from 0 05 to 0 06 under the bc0 5 schemes while it ranged from 0 04 to 0 06 under the log and bc0 2 schemes fig 7 a streamflow discharge predictive uncertainty had better precision values 0 44 1 15 than water quality predictive uncertainties fig 7 b while sediment yield and total n predictive uncertainties had the best reliability values 0 04 0 08 fig 7 a for all residual error schemes volumetric bias values of sediment yield predictive uncertainty 0 44 0 15 were better than those of other variables under the bc0 2 and bc0 5 schemes fig 7 c monitored total p data availability and length of time and the complexities of p simulation processes in hydrologic models contributed to poor predictive uncertainties for total p loss predictions in the sjr figs 4 and 6 and wc fig 5 watersheds specifically around 49 of monitored monthly total p data at the wc were missing during 2013 2018 and the data filling processes might increase total p predictive uncertainties moreover compared to streamflow discharge sediment and n simulations p simulations in hydrologic models e g particulate p in subsurface drainage systems in swat are still in the early stage and need tremendous improvements to improve p predictive uncertainties the transferability of the best performing transformation scheme from a realization of calibrated results to those from other realizations is discussed in data s6 and table s2 and from a realization of calibrated results in a watershed field to those in the adjacent watersheds and fields is covered in data s7 and table s3 3 5 recommendations on improvements to probabilistic predictions an ensemble of model outputs from diverse modelers are recommended to support policy and decision making on environmental management when it is possible using the ensemble average of hydrologic and water quality simulations can improve hydrologic and water quality predictive uncertainty performance especially for large watersheds moreover the variances among predictions from different models in an ensemble can warrant consideration in environmental management decision making compared to a single realization of a model output an ensemble of model outputs has the potential to concurrently evaluate the effects of all sources of model uncertainty such as model inputs parameterization and model structures an ensemble of hydrologic model outputs is usually more computationally expensive than a single realization if multiple models are not viable for the study areas of interest performing uncertainty analysis to assess sources of model uncertainty can improve model calibration and predictive uncertainty and benefit model applications the simplified least square method of moments approach applied in this study is strongly recommended it considers the effects of all model prediction errors and an affordable computational expense more residual error transformation parameters could potentially be considered and modified automatically to improve probabilistic predictions complex uncertainty analysis in further research can provide the opportunity to evaluate each source of model uncertainty e g data monitoring model inputs and structures model calibration processes and identify the source with the greatest uncertainty there are potential opportunities to improve hydrology and water quality prediction uncertainty predictive uncertainty may be improved during the post processing of model outputs via selecting suitable residual error transformation schemes uncertainty may be reduced before post processing processes such as in the monitoring data collection and in hydrologic model improvements the lack of water quality monitoring data is one of the major sources of water quality modeling uncertainty and the major reason for the lack of water quality residual error modeling research monitoring water quality data more frequently daily instead of monthly in more locations might reduce predictive uncertainty and provide more opportunities to evaluate water quality predictive uncertainty guo et al 2020 for instance instead of collecting bi weekly or monthly water quality data at the outlet of a watershed monitoring daily water quality in streams and at fields inside of a watershed could reduce the uncertainty in the observed data used for model calibration improving model inputs that represent agricultural management operations e g fertilizer and manure application timing rates and approaches and temporal spatial dynamics of soil nutrient levels can reduce model uncertainty in predicting nutrient delivery guo et al 2020 martin et al 2019 structures and physical processes of nutrient transport in hydrologic models could be improved for instance in stream processes and the particulate and soluble nutrient estimation processes e g particulate p transport through subsurface drainage systems could be enhanced in swat to improve the probabilistic predictions in nutrient loss simulations evenson et al 2021 guo et al 2020 martin et al 2021 additionally temporally varying channel soil detachment parameters in wepp can better represent the predictive uncertainty of sediment yields at the watershed outlets guo et al 2021a 2021b 4 conclusions a simplified residual error approach was adopted to produce probabilistic hydrologic and water quality predictions and assess probabilistic predictions at 18 watershed and field locations in the u s reliability was the easiest metric and precision was the most difficult one to be captured for both the hydrologic and water quality residual error models residual error schemes that included bc0 5 better captured median values of reliability precision and volumetric bias metrics than other schemes across the hydrologic and water quality studies the differences between the performance metrics of the three bc0 5 residual error schemes were negligible across all hydrologic and water quality case studies the tradeoffs between the performance metric values for individual variables in a single watershed e g wc watershed were greater than those from the median values for all hydrologic or water quality variables over all case studies a single residual error scheme usually cannot produce the performance for all three predictive uncertainty performance metrics for all hydrologic and water quality uncertainty predictions identifying the most suitable residual error scheme should be based on the major pollutants of concern and the prioritized purposes of the uncertainty prediction at a specific study location adopting the ensemble average of hydrologic and water quality simulations can enhance predictive uncertainty assessments especially for large watersheds and extremely large discharge and or pollutant loss values however performing multiple realizations of hydrologic and water quality simulations is more expensive than conducting a single realization an ensemble of simulations for probabilistic predictions in small watersheds and fields with low magnitudes of discharge and or pollutant losses is unnecessary the best residual error transformation parameter scheme is transferable between the calibration period and validation period between hydrology calibration and water quality calibration between a realization of calibrated results and other realizations and between a study area and adjacent study areas future research opportunities to improve hydrologic and water quality probabilistic predictions via improved data monitoring and physical process enhancements in hydrologic models are also recommended those research results could improve the representation of the predictive uncertainty of water quantity and quality simulations from regions with various water quality concerns and enhance probabilistic predictions in research and operational practices credit authorship contribution statement tian guo conceptualization methodology formal analysis investigation data curation visualization writing original draft writing review editing yaoze liu methodology data curation formal analysis writing review editing gang shao methodology data curation formal analysis visualization writing review editing bernard a engel investigation data curation methodology supervision funding acquisition project administration writing review editing ashish sharma conceptualization methodology writing review editing lucy a marshall conceptualization methodology dennis c flanagan data curation funding acquisition writing review editing raj cibin data curation writing review editing carlington w wallace data curation writing review editing kaiguang zhao writing review editing dongyang ren data curation writing review editing johann vera mercado data curation writing review editing mohamed a aboelnour data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment funding supporting this research was provided by the usda natural resources conservation service ars nrcs interagency agreement 60 5020 8 003 through the usda agricultural research service and the purdue university department of agricultural biological engineering appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105499 
