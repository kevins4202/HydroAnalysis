index,text
40,tight carbonate possesses both fractures and multiscale pores flow through tight carbonate rocks involves several length scales and the complicated flow physics capturing and modeling the entire void space into a single pore network model for drainage is challenging here we present a novel method for modeling of a multiscale pore fracture hybrid pore network which enables various void spaces at multiple length scales and the flow characteristics in them to be included pores and fractures in a low resolution ct image are extracted by medial axis maximal ball algorithm and medial surface algorithm respectively to generate a pore fracture hybrid pore network then a statistics based small scale stochastic pore network is established in the ct image solid domains to represent the micropores unresolved by the image the two pore networks are organically integrated into a multiscale hybrid pore network by cross scale connections the statistics of small scale pore network are determined by experimental permeability we study the effects of the small scale pore network density on connectivity single and two phase flow properties of the model to obtain the robust parameter the influence of fractures on two phase flow properties is analyzed results show the significance of incorporating fractures and micropores in the model the model is validated via comparison between simulation result and experimental data this method can accurately efficiently conveniently construct multiscale pore fracture hybrid pore network of tight carbonate rock for evaluating the drainage characteristics keywords multiscale pores fractures multiscale hybrid pore network modeling two phase flow tight carbonate data availability data will be made available on request nomenclature nsp the number of pores in netsmall fs adjustable coefficient of netsmall vs volume of netsmall ρ sp density of the extracted small scale pore network icore low resolution 3d image of tight carbonate ss search sphere sse a set contains the voxels from the center to the farthest within the search radius n e t l arg e large scale pore network extracted from icore netsmall small scale stochastic pore network ρ lp pore density of n e t l arg e nlp the number of pores in n e t l arg e vl volume of n e t l arg e netmulti multiscale pore fracture hybrid pore network dt p 1 p 2 distance between pore p 1 and pore p 2 de p 1 p 2 euclidean distance between pore p 1 and pore p 2 r 1 radius of pore p 1 r 2 radius of pore p 2 d t maximum length of throats in netsmall p lpp i the i th large scale pore in n e t l arg e nlpp the number of large scale pores in n e t l arg e p sp ii the ii th pore in netsmall n sp i the number of pores in netsmall satisfying d t p l p p i p s p i i d t γ s parameter representing the density and connectivity of netsmall cs center of netsmall ξ the number of concentric spheres in netsmall n st k the number of throats penetrating the k th concentric sphere in netsmall rk radius of k th concentric sphere t st j the j th throat in netsmall nst the number of throats in netsmall p sp j1 pore connected to one end of throat t st j p sp j2 pore connected to the other end of throat t st j ak surface area of the k th concentric sphere r lpp i radius of p lpp i cn lpp i coordination number of p lpp i t lpt ij large scale throat connecting p lpp i and p lpp j in n e t l arg e r lpt ij radius of t lpt ij a lpt ij area of spherical crown occupied by t lpt ij sa lpp i remaining surface are of p lpp i scn lpp i the number of pores of netsmall that can be connected to p lpp i plfp fracture pore in n e t l arg e q f ij flow flux of phase f in throat ij p f i pressure of phase f in pore i p f j pressure of phase f in pore j g f ij hydraulic conductivity of phase f in throat ij aij cross sectional area of throat ij lij length of throat ij gij shape factor of cross section of throat ij μ f viscosity of phase f ldij dimensionless slip length of liquid flow in throat ij lsij physical slip length of liquid flow in throat ij t lft ij fracture throat connecting p lfp i and p lfp j w f ij width of t lft ij h f ij equivalent aperture of t lft ij l f ij length of t lft ij p in t inlet pressure of netmulti at the t th iteration step pout outlet pressure of netmulti q f in total flow flux of phase f at the inlet interface of netmulti q f k flow flux of phase f in the k th inlet pore q f out total flow flux of phase f at the outlet interface of netmulti qf total flow flux of phase f l vertical distance between the inlet interface and the outlet interface of netmulti a area of the inlet interface of netmulti kmf absolute permeability of phase f ksf absolute permeability of phase f under the single phase flow krf relative permeability pc capillary pressure 1 introduction tight carbonate rocks exhibit complex void structure with heterogeneities due to the presence of fractures and multiscale pores the multi stages and multi types flow channels have a significant influence on fluid flow such as the slip effect in nanometer pores and the interaction between the fractures and adjacent pores transport processes of fluid in tight carbonate rocks actually occur at the pore scale and the pore scale simulation helps to understand the flow behavior and obtain flow properties at large scales jiang et al 2013 pak et al 2014 rabbani et al 2020 the key is acquiring and modeling the entire representative void structures into a computationally tractable model with the rapid progress in imaging techniques such as micro computed tomography μct imaging and focused ion beam scanning electron microscopy fib sem imaging arns et al 2005 tomutsa et al 2007 müter et al 2012 2014 gooya et al 2016 the 3d representation of the void space can be implemented pore network model pnm extracted from the 3d image has been extensively applied to simulate single and two phase flow because it is computationally more efficient than direct models e g cfd dem model without sacrificing too much accuracy blunt et al 2013 li et al 2021 less computational demands also allow pnm to be competent for larger rock image to consider more heterogeneity of void structure however for heterogeneous tight carbonate rocks two vital problems remain for pnm first the multiscale pore size ranges from several nanometers to hundreds of microns tan et al 2020 resulting in the inability of a single image to cover all void spaces pnm extracted from a low resolution image has no global permeability due to the lacks of micropores unresolved by the image while pnm extracted from a small high resolution image might not be representative secondly fracture exhibits the complicated morphology and topology modeling and coupling the fracture into a pnm for calculating fluid exchange between the fracture network and adjacent pores are challenging the presence of multiscale pores and fractures the resolution size trade off and the pore space fracture interaction make it necessary to model a multiscale pore fracture hybrid pore network for drainage in the entire void space of tight carbonate rocks pnm is the foundation of this study pnm can be extracted from the binarized image of a pore space in which the irregular pore space is represented by a simple network of interconnected pores and throats there are some pnm extraction methods including medial axis ma method lindquist and lee 1996 jiang et al 2007 maximal ball mb method silin et al 2003 dong and blunt 2009 watershed segmentation ws method rabbani et al 2014 2019 pore throat morphology ptm method xu et al 2020 and medial axis maximal ball ab method yi et al 2017 jiang et al 2017a ab method combines the advantages of ma and mb to constrain the maximal balls on the centrally located medial axis which can preserve most of the morphological features of the pore space and has been successfully proven to be highly realistic and efficient in some studies yi et al 2017 jiang et al 2017b cao et al 2017 then for the binarized image containing both fractures and pore spaces there is a need to extract a pore fracture hybrid pore network from it to include the pore fracture interactions and achieve the globally single and two phase flow simulations the process involves two important questions how to identify and model the fractures to couple with the pore spaces and how to achieve simulations of fluid exchange between fractures and adjacent pores for the first question pruess and tsang 1990 and karpyn and piri 2007 used a dense network consisting of virtual pores and throats to represent a fracture and simulated single and two phase flow in the network regions with local maxima of the fracture aperture are defined as virtual pores which are connected by virtual throats defined by other fracture regions later hughes and blunt 2001 and erzeybek and akin 2008 plugged virtual networks of fractures into a regular pore network and used throats to connect the virtual networks with nearby pores recently jiang et al 2017a presented a generally applicable method to extract a pore fracture hybrid pore network from the actual fractured porous media image since the actual fracture possesses the complicated platy morphology the medial surface ms is the best representation of the fracture lee et al 1994 which is defined as a set of surface voxels that are essential for the topology and connectivity of fracture they used ma method to extract skeleton of pore system and used an extended shrinking algorithm to identify the fracture and extract the corresponding ms ms was subsequently converted into a dense network consisting of virtual medial axes the entire skeleton was transformed into a hybrid pore network by defining vertices and links as pores and throats for the second important question of how to simulate fluid exchange between fractures and adjacent pores the hybrid pore network has significant computational advantages all void components pore system and fractures in the hybrid pore network are represented by the same basic elements pores and throats which can be calculated by the same simulator further for some porous media with the multiscale pore spaces the multiscale pore network model has been proposed the fundamental idea of that is extracting a large scale pore network from a low resolution 3d image and integrating it with the micropore networks generated from other sources into a single multiscale pore network jiang et al 2013 presented a method for fusing pore networks extracted from μct images of different resolutions into a multiscale pore network via the cross scale connection structures since the domain of the extracted small scale pore network is smaller than that of the extracted large scale pore network the micropore network was randomly reestablished in a domain of the same size as the large scale pore network based on the statistical information of the extracted small scale pore network to control the density of micropore networks for efficient flow simulation a parameter 0 fs 1 was introduced to determine the number of micropores 1 n s p f s ρ s p v s where nsp is the number of micropores ρ sp is the density of the extracted small scale pore network vs is the volume of micropore network later the method was revised by considering the locations of micropore networks mehmani and prodanovic 2014 prodanovic et al 2014 tahmasebi and kamrava 2018 they proposed that micropores in rocks are generated due to the partial dissolution of some solid matrix particles and the filling of some macropores by clay particles the micropore networks were placed in some matrix regions grain filling and some macropores pore filling mehmani and prodanovic 2014 and prodanovic et al 2014 generated micropore networks by rescaling the extracted large scale pore network implying that some characteristics e g tortuosity coordination number distribution shape factor distribution of large scale pores were used to represent the micropores tahmasebi and kamrava 2018 extracted micropore networks from 3d digital cores reconstructed based on different regions of a sem image additionally some researchers bauer et al 2012 bultreys et al 2015 xu et al 2021 used the micro links to represent the micropores and connect macropore network clusters to generate the multiscale pore network however tight carbonate has both fractures and multiscale pore spaces which is quite complicated to the best of our knowledge there are few relevant studies on the multiscale hybrid pore network models for the entire void structures of tight carbonate rocks rabbani et al 2020 constructed a triple pore network containing micropores meso pores and fractures and simulated the gas transport in it here we present a novel method to construct a multiscale pore fracture hybrid pore network model for drainage in tight carbonate rocks 2 methods 2 1 multiscale pore fracture hybrid pore network construction 2 1 1 pore fracture hybrid pore network extraction we implement a combined algorithm of ab yi et al 2017 and ms jiang et al 2017a to extract the hybrid pore network consisting of pores and fractures from the low resolution 3d image icore of tight carbonate the fundamental principle of ab is constraining maximal balls on the centrally located medial axis which combines the advantages of ma lindquist et al 1996 jiang et al 2007 and mb silin et al 2003 dong and blunt 2009 and ensures that each throat is located at the hydraulic restriction the ms is the extracted skeleton of fracture which characterizes the topology and hydraulic property of fracture the combined algorithm involves the following steps 1 building the inscribed sphere for each void voxel in the 3d image via a layer by layer search algorithm developed previously yi et al 2017 a search sphere ss with a large search radius is established first in which each element is a vector coordinate relative to the center of ss see fig 1 d and e a simple ss and its norms in a 2d system assigning the ss to any void voxel k sse k ss can be acquired which contains the voxels from the voxel k to the farthest within the search radius all voxels in sse are checked one by one in the order of the distance to the voxel k from the small to large until a solid voxel or boundary voxel is found the inscribed sphere for each voxel is built and its radius is acquired 2 a shrinking algorithm developed by jiang et al 2017a is applied to identify both the ma of the pore spaces and the ms of the fractures starting from void voxels on the void space wall through searching and removing the void voxels that do not affect the euler number and local connectivity of the void space we find the ma of the pore spaces fig 1f and the ms of the fractures fig 1g especially the inscribed spheres are also utilized to make the ma and the ms more centered fig 1a and fig 1b highlight the scheme ma of the pore spaces and ms of the fracture fig 1b are effectively extracted from the entire void space consisting of the pore spaces and the fracture fig 1a 3 for the pore spaces with ma a identifying the inscribed spheres corresponding to the ma voxels and removing other inscribed spheres to constrain the maximal balls on the ma yi et al 2017 b affiliating these maximal balls into family trees to defined pores and throats according to the order of maximal ball radius from large to small all maximal balls are clustered based on their radii and locations to determine the hierarchical relationships among them from the hierarchical relationship the family trees of all maximal balls are generated fig 1h in which the center of parent ball is defined as pore location and the center of common child ball attaching to two parent balls is defined as throat location yi et al 2017 c segmenting pore blocks and throat blocks via a dual speed expansion algorithm developed previously yi et al 2017 all pore location voxels and throat location voxels are labeled with 0 starting from the pore location voxels and the throat location voxels pore blocks and throat blocks expand outward and the unmarked void voxels involved are labeled with the number of expansions pore blocks expand two layers outward each time fig 1i and throat blocks expand one layer outward each time fig 1j the entire pore space is divided into a series of pore blocks and throat blocks 4 for the fractures with ms converting the ms into a dense network consisting of virtual medial axes see fig 1k to generate a dense network consisting of virtual pores and throats jiang et al 2017a 5 the parameters e g shape factor coordination number etc of pores and throats that are associated with the pore spaces and the pore fracture connecting spaces are calculated as usual yi et al 2017 the parameters e g width equivalent aperture etc of virtual pores and throats of the dense network are determined based on the underlying fracture apertures jiang et al 2017a finally a hybrid pore network is generated to represent the entire void space as shown in fig 1c the entire extraction process is briefly introduced above in which ab is applied to treat the pore spaces and ms is used to process the fractures for more details about the hybrid pore network generation one can refer to the aforementioned publication note that the extracted hybrid pore network in general has no global connectivity due to the lacks of micropores unresolved by icore for the remainder of this work we refer to the hybrid pore network as large scale network n e t l arg e and refer to the pore and throat corresponding to pore spaces as large scale pore and large scale throat and the pore and throat corresponding to fractures as fracture pore and fracture throat 2 1 2 small scale stochastic pore network generation after the n e t l arg e has been extracted from the icore we establish the small scale stochastic pore network netsmall in the matrix domains of icore to represent the micropores unresolved by icore and supplement the n e t l arg e with the connectivity generated by the micropores the first step is determining the geometric and topological parameters of micropores as mentioned above mehmani and prodanovic 2014 and prodanovic et al 2014 generated the small scale pore network by rescaling the macropore network indicating that some characteristics of macropores were used to represent the small scale pores this is more economic and efficient compared with the scheme of extracting statistics of micropores from the high resolution μct image jiang et al 2013 and the scheme of reconstructing 3d image of micropores based on sem image tahmasebi and kamrava 2018 however the uncertainty of the micropores is significant moreover predictions of the multiscale model usually do not agree well with the experimental measurements due to the strong heterogeneity and the multiscale model generally needs to be constrained and optimized by a kind of experiment data pak et al 2016 following the two ideas of mehmani and prodanovic 2014 and pak et al 2016 we use some parameters tortuosity coordination number distribution shape factor distribution of large scale pores and throats of the n e t l arg e to represent the micropores then we set the pore radius distribution and the throat radius distribution of micropores as the appropriate distributions and determine them under the constraint of experimental permeability to reduce the above uncertainty the detail of the determination will be introduced in section 2 1 3 3 note that the maximum radius of the two distributions is given by the resolution of icore and not by the minimum throat radius of the n e t l arg e for the nsp of the netsmall we use eq 1 to determine it by replacing ρ sp with ρ lp based on the idea of mehmani and prodanovic 2014 ρ lp is pore density of n e t l arg e and can be written as 2 ρ l p n l p v l where nlp is the number of pores in the n e t l arg e and vl is the volume of the n e t l arg e next we extend the algorithm proposed by idowu and blunt 2010 to generate a netsmall based on the given parameters the major difference of our extended algorithm is that pores and throats are strictly confined in the irregular matrix domain the producer is shown below 1 morphological dilation operation with radius of 2 voxel is implemented on the entire void space of the icore xu et al 2020 to transform the matrix within the range of 2 voxels around the void space into voids the remaining matrix is the domain to establish the netsmall as shown in fig 2 a 2d slice of the pore fractured porous media in fig 1a since the maximum radius of small scale pores is the resolution of the icore even if the center of a small scale pore is located at the edge of the residual matrix domain it will not intersect with the pore spaces and fractures of the icore see fig 2 2 nsp pores are created by randomly assigning values of radius shape factor and coordination number to every pore based on the given distributions the centers of these pores are randomly placed in the remaining matrix domain and make sure that there is no overlap of them then the volume and weight are calculated for each pore idowu and blunt 2010 xu et al 2021 3 creating throats according to the coordination number of each pore to connect these pores idowu and blunt 2010 if the cylindrical throats intersect with the pore spaces and fractures of the icore we discard them and continue to find other connections for the corresponding pores see fig 2 therefore the actual connection number of some pores may be less than their assigned coordination number due to the domain constraint 4 calculating the weight for every throat based on the weights of two pores connected to it idowu and blunt 2010 xu et al 2021 according to the given distributions the smallest geometrical values radius shape factor are assigned to the throat with the smallest weight and the second smallest values are assigned to the throat with the second smallest weight and so on to ensure the correlation of the netsmall then the length of each throat is calculated based on the center position and radius of two pores connected to it and the volume is calculated for each throat idowu and blunt 2010 in the end the netsmall is generated as described the number of large scale pores and throats in the n e t l arg e should be enough to obtain the representative parameters tortuosity coordination number distribution shape factor distribution to generate the netsmall however if there are only a few pore spaces captured in the icore these parameters can also be obtained from other sources for example obtaining these parameters from the higher resolution image via the pore throats morphology ptm software we developed previously xu et al 2020 the novel way provided to obtain the small scale pore parameters is intended to be illustrative rather than the unique solution because the central contribution of the paper is the multiscale pore fracture hybrid pore network modeling and integration method 2 1 3 multiscale pore fracture hybrid pore network generation after obtaining the n e t l arg e and the netsmall the two pore networks are integrated into a multiscale pore fracture hybrid pore network netmulti the major idea of the process is connecting pores of n e t l arg e and their nearby pores of netsmall via the added small scale throats in order to ensure that the final netmulti is a correlated network in terms of geometry and topology both the geometric and topological properties of the n e t l arg e and the netsmall must be considered in the connecting process the detailed considerations are as follows connecting large scale pore with small scale pore first of all the added connecting throat is the small scale throat which should be correlated with the netsmall except for the throat length the geometric properties of the added small scale throat are determined based on the average values of throats in the netsmall the length of the added small scale throat is determined as follows for two pores p 1 and p 2 with inscribed radii r 1 and r 2 the distance dt p 1 p 2 is defined as 3 d t p 1 p 2 d e p 1 p 2 r 1 r 2 where de p 1 p 2 is the euclidean distance between the two pore centers if the two pores are connected by a throat dt p 1 p 2 is the length of this throat the length of the added small scale throat should be less than or equal to the maximum length d t of throats in the netsmall each large scale pore p lpp i i 1 2 nlpp of the n e t l arg e can only connect its nearby pore p sp ii ii 1 2 n sp i of the netsmall whose dt p lpp i p sp ii is less than or equal to the d t where nlpp is the number of large scale pores in the n e t l arg e and n sp i is the number of pores of the netsmall that meet this condition secondly the number of pores in the netsmall that can be connected to a large scale pore p lpp i of the n e t l arg e is also correlated to the density and connectivity of the netsmall the coordination number and radius of p lpp i in the n e t l arg e and the radii of throats connected to p lpp i in the n e t l arg e we use a parameter γ s proposed by jiang et al 2013 to represent the density and connectivity of the netsmall as follows taking the center cs of the netsmall as sphere center we insert ξ concentric spheres of radii 0 r 1 r 2 r ξ in the netsmall and ensure that the largest sphere is within the netsmall for the k th k 1 2 ξ concentric sphere the number n st k of throats that penetrate the sphere is calculated by 4 n s t k c a r d t s t j d e c s p s p j 1 r k d e c s p s p j 2 j 1 2 n s t where card is a mathematical symbol which is named cardinal number and indicates the number of elements in a set it is implemented by traversing every throat in the netsmall one by one and calculating the number of throats that satisfy the conditions in the eq 4 t st j is the j th throat in the netsmall and nst is the number of throats in the netsmall p sp j1 and p sp j2 are two pores connected by the throat t st j the parameter γ s is defined as 5 γ s 1 ξ k 1 ξ n s t k a k where ak is the surface area of the k th concentric sphere for more details refer to jiang et al 2013 the coordination number and radius of p lpp i in the n e t l arg e and the radii of throats connected to p lpp i in the n e t l arg e are represented as follows for a p lpp i of radius r lpp i and coordination number cn lpp i in the n e t l arg e the area a lpt ij of spherical crown occupied by the throat t lpt ij is calculated by 6 a l p t i j 2 π r l p p i r l p p i r l p p i 2 r l p t i j 2 where r lpt ij is the radius of the throat t lpt ij as shown in fig 3 the remaining surface area sa lpp i of p lpp i that are not occupied by throats is thus calculated by 7 s a l p p i 4 π r l p p i 2 j 1 c n l p p i a l p t i j finally the number scn lpp i of pores in the netsmall that can be connected to p lpp i of the n e t l arg e is calculated by 8 s c n l p p i s a l p p i γ s connecting fracture pore with small scale pore since the fracture network is extremely dense see fig 1c if the scheme described above is used directly to connect fracture pores with small scale pores a small pore will be connected with a large number of fracture pores around it in order to avoid this issue we search for all the small scale pores that can be connected to every fracture pore via using the eq 3 and the d t see the small scale pores within the red shadow in fig 4 each pore p sp i of these small scale pores is subsequently connected to one fracture pore plfp whose dt p sp i plfp is the smallest see fig 4 moreover the length and geometric properties of the added small scale throats are determined via the scheme described in section 2 1 3 1 generation the netmulti is generated by following the process shown below 1 for each large scale pore p lpp i of the n e t l arg e calculating the scn lpp i via using eqs 4 8 finding its nearby pores of the netsmall that are possible to be connected with it using the eq 3 and d t some obtained pores of the netsmall are connected to the pore p lpp i using the added throats according to the scn lpp i and the order of dt p lpp i p sp ii from small to large see fig 4 2 for all fracture pores of the n e t l arg e finding all the pores of the netsmall that can be connected to them by using the eq 3 and the d t every pore of the obtained small scale pores is connected to the nearest fracture pores using a added throat see fig 4 3 assigning the geometric properties to the added small scale throats 4 through connecting small scale pores with large scale pores and fracture pores the netsmall and the n e t l arg e are integrated into a global connected pore network we calculate the absolute permeability of the pore network and compare it to the experimental permeability the calculation will be introduced later if the match between them is poor we will change the pore radius distribution and the throat radius distribution of micropores via resetting the types mean values and standard deviations of the distributions then we regenerate the netsmall and reconstruct the global connected pore network to calculate its absolute permeability until the calculation result is close to the experimental permeability the relative error is less than 10 the work flow is shown in fig 5 finally the netmulti is generated note that since the netmulti is closely correlated with the n e t l arg e and netsmall in terms of both geometry and topology only three construction parameters are uncertain and need to be adjusted the pore radius distribution and the throat radius distribution of the netsmall as well as fs the first two construction parameters are determined under the constraint of experimental permeability the determination of fs will be discussed later therefore our method possesses significant conveniences 2 2 multiscale pore fracture hybrid pore network calculation the netmulti has significant advantages in flow calculation compared to the multiscale seepage model coupled with different methods all void components in netmulti are represented by the basic elements pores and throats which makes it possible to perform the global flow simulation via one solver we extend the network simulator developed by the professor martin blunt s group at imperial college to simulate drainage in the netmulti blunt et al 2002 valvatne and blunt 2004 each iteration step of the network simulator includes two sub steps the displacement process and the flow flux solving process the displacement process is based on the quasi static model that is the flow velocity is assumed to be small enough so that the viscous force is negligible and the capillary force is control force for more details of the displacement process one can refer to the work of valvatne and blunt 2004 after the displacement process all phase interfaces are updated at the boundaries between pores and throats therefore it is possible to easily count the respective volumes of oil and water in all of pores and throats the water saturation sw is calculated as the ratio of water volume to the total volume of the netmulti flow flux of a phase f can be solved by imposing the mass conservation equation at every pore which is described as 9 j 1 n q f i j 0 where n is the number of throats connected to the pore i q f ij is the flow flux of phase f in the throat ij connecting pore i and pore j q f ij can be written as 10 q f i j g f i j p f i p f j where p f i and p f j are the pressure of phase f in pore i and pore j respectively g f ij is the hydraulic conductivity of phase f in throat ij netmulti contains large scale pores and throats and small scale pores and throats as well as fracture pores and throats for the large scale pores and throats because its size is much larger than liquid slip length the knudsen number is small and the liquid slip effect can generally be ignored g f ij is written as valvatne and blunt 2004 11 g f i j 0 6 a i j 2 g i j μ f l i j 0 g i j 0 0481 0 5623 a i j 2 g i j μ f l i j 0 0481 g i j 0 0625 0 5 a i j 2 g i j μ f l i j 0 0625 g i j 0 0796 where aij and lij are the cross sectional area and length of throat ij respectively gij is the shape factor of cross section of throat ij 0 gij 0 0481 represents the cross section is triangular in shape 0 0481 gij 0 0625 represents the cross section is quadrilateral in shape 0 0625 gij 0 0796 represents the cross section is circular in shape μ f is the viscosity of phase f for the small scale pores and throats since the liquid slip length is comparable to its size the knudsen number is large and the liquid slip effect must be considered in g f ij as afsharpoor and javadpour 2016 ji et al 2021 12 g f i j 0 012 0 057 l d i j 2 g i j 0 0052 l d i j 2 38 g i j 2 3 2 l d i j g i j a i j 2 μ f l i j g i j 0 04 0 16 0 16 l d i j 6 4 g i j 0 0055 l d i j 2 50 g i j 2 1 7 l d i j g i j a i j 2 μ f l i j g i j 0 04 where ldij is the dimensionless slip length of liquid flow in throat ij calculated by l d i j l s i j a i j lsij is the physical slip length of liquid flow in throat ij for the fracture pores and throats g f ij is adjusted as pruess and tsang 1990 ebrahimi et al 2014 jiang et al 2017a 13 g f i j w f i j h f i j 3 12 μ f l f i j where w f ij h f ij and l f ij are the width equivalent aperture and length of fracture throat t lft ij connecting two fracture pores p lfp i and p lfp j respectively the linear equations of mass conservation of all the pores in the netmulti can be obtained by formulas 9 13 then the linear equation system is solved using gauss seidel method to obtain the convergent stable pressure field according to the pressure boundary conditions the inlet pressure p in t of netmulti and the outlet pressure pout of netmulti in the current iteration step of drainage calculation the subscript t of p in t represents the current iteration step is the t th iteration step in drainage computation the total flow flux q f in of phase f at the inlet interface of netmulti is obtained by calculating the flow flux of each inlet pore in netmulti 14 q f i n k 1 n i b q f k k 1 n i b j 1 m g f k j p f k p f j where nib is the number of inlet pores of netmulti q f k is the flow flux of phase f in the inlet pore k m is the number of throats connected to the inlet pore k p f k and p f j are the pressure of pore k and pore j in the stable pressure filed respectively similarly the total flow flux q f out of phase f at the outlet interface of netmulti can be calculated the absolute permeability kmf of phase fat the t th iteration step of drainage simulation can be calculated as 15 k m f μ f q f l a p i n t p o u t where q f q f i n q f o u t 2 l is the vertical distance between the inlet interface and the outlet interface of netmulti a is the area of the inlet interface of netmulti through the above computation process the absolute permeability ksf of phase f under the single phase flow can be calculated based on the same pressure boundary conditions the relative permeability krf of phase f at the t th iteration step of drainage simulation is calculated by 16 k r f k m f k s f in addition the capillary pressure pc at the t th iteration step of drainage simulation is calculated by 17 p c p i n t p o u t throughout the drainage simulation we slowly increase the inlet pressure and keep the outlet pressure constant each pressure point corresponds to an iteration step in which the displacement process and the flow flux solving process are performed finally the water saturation capillary pressure curve and water saturation relative permeability curve can be obtained 3 results and discussion to provide an insight into the multiscale pore fracture hybrid pore network model and assess the model quality two reservoir tight carbonate rocks from ordovician formation in china denoted as ordos tight carbonate and tarim tight carbonate are used to generate multiscale hybrid pore networks 3 1 ordos tight carbonate 3 1 1 pore fracture hybrid pore network the μct image of the ordos tight carbonate rock along with its extracted pore fracture hybrid pore network is shown in fig 6 the voxel numbers of the μct image are 1008 1008 1008 and the voxel size is 13 98 μm the white and gray are matrix which is mainly composed of quartz and clay minerals the black represents voids which comprise pore spaces and two fractures in the extracted pore fracture hybrid pore network two curved fractures red are clearly revealed the major properties including absolute permeability of the hybrid pore network are shown in table 1 we note that the numbers of fracture pores and fracture throats are greater than those of large scale pores and large scale throats because fractures are represented by the dense pore networks as the entire void space in μct image has no overall connectivity in x and y directions the extracted hybrid pore network is not percolating in these two directions the hybrid pore network has large permeability kzl of 752 57md in z direction due to the perforative fracture in this direction the left fracture in fig 6a and b in order to evaluate the hybrid pore network the z direction permeability kzlbm of the corresponding binary image is directly calculated using the two relaxation time lattice boltzmann model trt lbm pan et al 2006 as shown in table 1 the relative error between kzl and kzlbm is 8 68 which is reasonable the possible reason for this result is that the simplification of pore fracture connecting spaces which results in more flow probability the good agreement between kzl and kzlbm indicates that the pore fracture hybrid pore network extracted by the improved ab ms algorithm is equivalent to the actual pore fracture spaces this lays a good foundation for the multiscale hybrid pore network generation 3 1 2 multiscale pore fracture hybrid pore network the normalized coordination number distribution pore shape factor distribution and throat shape factor distribution of large scale pores and throats of the extracted hybrid pore network see blue in fig 6b is used for generating the small scale stochastic pore network as shown in fig 7 a and b it can be seen that the peak value and the average value of the coordination number distribution are 2 and 2 91 respectively the peak values of the pore shape factor distribution and the throat shape factor distribution are about 0 0301 and 0 0413 indicating that the cross sections of large scale pore spaces are mainly triangular in shape moreover the distributions of pore radius and throat radius of small scale stochastic pore network are assumed to be lognormal see fig 7c to study the effect of fs first the small scale mean pore radius and mean throat radius are assumed to be 1 μm and 0 5 μm respectively as mentioned in section 2 1 3 3 only three construction parameters in the netmulti are uncertain and need to be adjusted in which the first two construction parameters are determined under the constraint of experimental permeability here the effects of the third construction parameter fs on the netmulti and its single phase and two phase flow properties are investigated different fs s are considered and the corresponding multiscale hybrid pore networks are constructed some properties of these networks are summarized in table 2 as it can be seen multiscale hybrid pore networks have higher average coordination number due to the presence of small scale pores connected to adjacent large scale pores and fracture pores the average coordination numbers of the two multiscale hybrid pore networks with fs 0 4 and fs 0 6 are almost the same and did not increase with the increase of fs to clarify this situation fig 8 a shows the detailed average coordination number fs curve and fig 8b shows the coordination number distributions of three multiscale hybrid pore networks with fs 0 4 fs 0 5 and fs 0 6 it can be seen that the average coordination number tends to become almost constant with the increase of fs in this case about fs 0 3 the coordination number distributions of the three fs s agree well see fig 8b it indicates that the proposed method can ensure the constructed network is correlated in terms of geometry and topology and will not endlessly connect small scale pores to adjacent large scale pores and fracture pores two multiscale hybrid pore networks with different fs s are visualized in fig 9 the absolute permeabilities of multiscale hybrid pore networks with different fs s are calculated in the x y and z directions the results are shown in fig 10 as can be seen for the well connected z direction of the extracted pore fracture hybrid pore network the integrated small scale pore networks only enhance its permeability very little the perforative fracture is the main flow channels in z direction see fig 9 for the impermeable x and y directions of the extracted pore fracture hybrid pore network the integrated small scale pore networks significantly enhance permeability because small scale pores connect large scale pores and fracture pores to form the main flow paths in this scenario the permeability increases with the increase of fs but it becomes almost constant when fs 0 3 approximately this effect of fs on x and y permeability is virtually the same as its effect on the model connectivity the drainage capillary pressure saturation curves and relative permeabilities of multiscale hybrid pore networks with different fs s are also calculated in the x y and z directions fig 11 shows the capillary pressure saturation curves as can be seen the residual water saturation decreases as the fs increases which can be due to the fact that the connections of small scale pores with large scale pores and fracture pores provide more escape routes for the trapped phase inside large scale pore spaces another interesting observation is that the residual water saturation is almost constant for fs 0 3 this is consistent with the earlier observations that the connectivity and the absolute permeability of the multiscale hybrid pore network hardly increases once fs 0 3 the curves for different fs s show good agreement when the water saturation is relatively large the curves for x and z directions see fig 11a and c have two percolation plateaus although the right percolation plateau exhibits a tilt due to the slight increase of capillary pressure while the curves for y direction have only one percolation plateau see fig 11b to provide more insight into the displacement processes and clarify the differences three moments st1 st2 and st3 in the displacement processes are selected see fig 11 and the corresponding two phase distributions are visualized in the network with fs 0 4 as shown in fig 12 as can be seen from fig 12x st1 the non wetting phase oil invaded the right fracture and some pores adjacent to the fracture resulting in the right percolation plateau in fig 11a the non wetting phase subsequently flowed through some paths between the two fractures and invaded the left fracture see fig 12x st2 with the rapid increase in pressure the pressure jump between x st1 and x st2 in fig 11a corresponds to this process the left fracture and some pores around it are rapidly occupied by the non wetting phase see fig 12x st3 resulting in the left percolation plateau in fig 11a with the further increase in pressure the small scale pores not occupied by non wetting phase see fig 12x st3 are also invaded which corresponds to the pressure jump after x st3 in fig 11a the displacement in y direction is visualized in fig 12y st1 12y st2 and 12y st3 since the two fractures did not penetrate in y direction the non wetting phase first invaded some small scale pores and throats see fig 12y st1 with the rapid increase in pressure the pressure jump between y st1 and y st2 in fig 11b corresponds to this process then the two fractures were invaded by the non wetting phase almost at the same time see fig 12y st2 and y st3 hence the curves in fig 11b have only one larger percolation plateau fig 12z st1 12z st2 and 12z st3 show the displacement in z direction since the right fracture does not penetrate in this direction the curves see fig 11c also have two percolation plateaus it should be noted that the right fracture was invaded in two ways the nonwetting phase from the left fracture and the nonwetting phase from the inlet see fig 12z st2 fig 13 shows the relative permeability curves in x and y directions the effect of fs on the relative permeability is large as can be seen from the subgraph in fig 13a the relative permeability curves in x direction show large variability when fs is little 0 1 0 2 0 3 but they converge to an almost constant curve at fs 0 4 see fig 13a the relative permeability curves in y direction settle to a constant curve at fs 0 3 see fig 13b the small variability between convergent curves may be related to the fact that the flow paths become more tortuous with the increase of small scale pores fig 14 shows the relative permeability curves in z direction the effect of fs on the relative permeability is little because the perforative fracture in z direction provides the main flow path see fig 12z st1 although the processes of water saturation change in the x y and z directions are similar see fig 11 the water relative permeability in z direction rapidly decreases to the minimum and the oil relative permeability rapidly increases to the maximum due to the fluid channeling in the perforative fracture the isotonic point of relative permeability shifts to the higher saturations see fig 14 according to the results of absolute permeability fig 10 and relative permeability fig 13 and fig 14 in the three directions it can be seen that there is a significant difference between the flow along the perforative fracture direction and the flow along other directions which is one of the main feature of the heterogeneity of tight carbonate rocks the constructed multiscale hybrid pore network generally tends to have stable single phase and two phase flow results as well as robustness when fs 0 4 it means that these small scale pore networks are sufficient to represent the properties of micropores moreover a larger fs will introduce excessive elements and lead to expensive computational demands while a smaller fs will result in inaccurate results without representativeness therefore we set fs 0 4 to construct the netmulti for taking into account both the calculation accuracy and the calculation efficiency in the study note that fs 0 4 is only used for this study because the analysis of fs is intended to be illustrative and provide more insight of the method rather than concluding the unique solution of fs for various tight carbonates the experimental permeability of the ordos tight carbonate rock in the y direction is 298 18μd the distributions of pore radius and throat radius of small scale stochastic pore network are re determined under the constraint of experimental permeability as shown in fig 15 a the distributions are lognormal the small scale mean pore radius and mean throat radius are 2 μm and 1 μm which are larger than the earlier assumptions see fig 7c the calculated absolute permeability of multiscale hybrid pore network in y direction is 315 94μd and the relative error between this result and the experimental data is 5 39 small changes of the small scale radius distributions have a great influence on the permeability jumping from 112 87μd see fig 10 to 315 94μd this is related to the fact that the connections of small scale pores with large scale pores and fracture pores provide the main flow paths the calculated drainage capillary pressure saturation curve is shown in fig 15b the capillary pressure saturation curve of fs 0 4 in fig 11b is shown again in fig 15b for comparison as expected the pressure of percolation plateau of the constrained curve is lower fig 15c shows the calculated drainage relative permeability curve and the unconstrained relative permeability curve of fs 0 4 see fig 13b as can be seen the water relative permeability curve shifts down and the non wetting phase oil relative permeability curve shifts up as well as the isotonic point of relative permeability moves right to larger saturation indicating that the displacement is more favorable since there is only experimental permeability in y direction we only discuss them in y direction here it is not possible to implement a direct comparison between the experimental results and the two phase flow calculated results after constrained but the work is currently in progress the major contribution of this study is the multiscale pore fracture hybrid pore network modeling method moreover the drainage simulations in netmulti were performed on a personal computer and the computational time was 3minutes 29seconds which was quite short for this tight carbonate with 14 093 mm 3 sizes and multiscale pores fractures the presented model reduced the computational memory and improved the computational efficiency significantly and showed the potential for processing relatively large size tight carbonates on a personal computer 3 2 tarim tight carbonate for this reservoir tight carbonate rock from tarim basin we perform μct experiment to acquire the scanning image as shown in fig 16 a the resolution of the μct experiment is also 13 98 μm the voxel numbers of the μct image are 722 1168 1139 the extracted pore fracture hybrid pore network is shown in fig 16b as can be seen an irregular curved fracture red is clearly revealed the basic properties of the extracted pore fracture hybrid network are summarized in table 3 the hybrid pore network is not percolating in z direction because the entire void space in μct image has no global connected paths in this direction the normalized coordination number distribution pore shape factor distribution and throat shape factor distribution of large scale pores and throats of the extracted hybrid pore network see blue in fig 16b are obtained to generate small scale stochastic pore network as shown in fig 17 a and b as can be seen the pore shape factor and throat shape factor are mostly less than 0 0481 indicating that their cross sectional shape is mainly triangle the mean value of the coordination number distribution is 2 66 then the experimental permeability of the tarim tight carbonate rock in the z direction is 739 33μd the distributions of pore radius and throat radius of small scale stochastic pore network are set to lognormal and determined under the constraint of experimental permeability as shown in fig 17c the small scale mean pore radius and mean throat radius are 2 μm and 1 μm respectively the absolute permeability of multiscale hybrid pore network in z direction is calculated as 767 79μd and the relative error between this result and the experimental result is 3 71 the multiscale hybrid pore network is visualized in fig 16c and major properties of the network are shown in table 4 as can be seen the absolute permeability of the multiscale hybrid pore network in x and y directions is almost the same as that of the pore fracture hybrid pore network in the two directions see table 3 which is consistent with the earlier observation and jiang et al study that the integrated small scale pore network only leads to a very small increase in absolute permeability of the well connected direction of the extracted large scale network fig 18 shows the capillary pressure saturation curve result simulated in the multiscale hybrid pore network and the mercury injection capillary pressure micp experiment result of the tarim tight carbonate rock as can be seen the simulated capillary pressure saturation curve matches the experimental result well though some of the detailed capillary pressure behavior is not captured by the multiscale hybrid pore network the simulated curve is slightly higher than the experimental result when the air saturation is low the possible reason for this phenomenon is that the connectivity of small scale pores is poorer than that of the actual micropores due to the strict space constraints on the small scale throats which makes mercury more difficult to enter moreover the percolation plateau of the simulated curve exhibits a certain tilt because the fracture is small and does not dominate in the whole system 4 conclusions and outlook in this study a novel method is proposed to construct the multiscale pore fracture hybrid pore network model for drainage in tight carbonate rocks this model consists of nanometer pores micron pores and fractures and includes the flow characteristics in them firstly considering the different flow characteristics in pore spaces and fractures pores and fractures in a low resolution μct image are extracted by medial axis maximal ball algorithm and medial surface algorithm respectively to generate a pore fracture hybrid pore network subsequently a statistics based small scale stochastic pore network is established in the μct image solid domains to represent the micropores unresolved by the image then the two pore networks are organically integrated into a multiscale hybrid pore network by the added small scale throats under the constraint of experimental permeability we extract a pore fracture hybrid pore network from the μct image of an ordos tight carbonate rock and calculate the absolute permeability in the permeable z direction the result is compared with that calculated by lbm the relative error between them is 8 68 indicating that the pore fracture hybrid pore network extracted by the developed ab ms algorithm is physically realistic the effects of the only uncertain construction parameters fs on connectivity single phase and two phase flow properties are further investigated the multiscale hybrid pore network is robust and its coordination number distribution absolute permeability and relative permeability curve tend to be convergent when fs 0 4 these introduced small scale pore networks are sufficient to represent the properties of micropores our proposed method can ensure the multiscale hybrid pore network is geometrically and topologically relevant besides will not endlessly connect small scale pores to adjacent large scale pores and fracture pores the effects of fractures on two phase flow are also investigated incorporating fractures and micropores in the drainage model is important furthermore we construct a multiscale pore fracture hybrid pore network for a tarim tight carbonate rock and calculate the capillary pressure saturation curve the multiscale hybrid pore network model is validated by comparing the calculated result with the mercury injection capillary pressure experiment data the calculated capillary pressure saturation curve matches the experimental data well it can be concluded that the proposed method can accurately efficiently conveniently construct multiscale pore fracture hybrid pore network of tight carbonate rock for evaluating the drainage characteristics the presented method is compatible with various sources of micropore parameters we use some parameters tortuosity coordination number distribution shape factor distribution of large scale pores and throats to represent the micropores which is convenient and economic but may be somewhat sketchy for some applications in future studies researchers can adopt our method and combine various sources of micropore parameters to further extend it as needed eqs 2 9 17 credit authorship contribution statement zhipeng xu investigation conceptualization methodology validation writing original draft writing review editing mian lin investigation conceptualization writing original draft writing review editing funding acquisition lili ji conceptualization methodology writing original draft writing review editing funding acquisition wenbin jiang investigation validation writing original draft writing review editing gaohui cao validation writing original draft writing review editing leige xu writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china grant no 42030808 the national natural science foundation of china grant no 41690132 the strategic priority research program of the chinese academy of sciences grant no xda14010304 the major national science and technology special program of china grant no 2017zx05037 001 the national natural science foundation of china grant no 41574129 we thank dr g villarini and the anonymous reviewers for their constructive comments on this manuscript 
40,tight carbonate possesses both fractures and multiscale pores flow through tight carbonate rocks involves several length scales and the complicated flow physics capturing and modeling the entire void space into a single pore network model for drainage is challenging here we present a novel method for modeling of a multiscale pore fracture hybrid pore network which enables various void spaces at multiple length scales and the flow characteristics in them to be included pores and fractures in a low resolution ct image are extracted by medial axis maximal ball algorithm and medial surface algorithm respectively to generate a pore fracture hybrid pore network then a statistics based small scale stochastic pore network is established in the ct image solid domains to represent the micropores unresolved by the image the two pore networks are organically integrated into a multiscale hybrid pore network by cross scale connections the statistics of small scale pore network are determined by experimental permeability we study the effects of the small scale pore network density on connectivity single and two phase flow properties of the model to obtain the robust parameter the influence of fractures on two phase flow properties is analyzed results show the significance of incorporating fractures and micropores in the model the model is validated via comparison between simulation result and experimental data this method can accurately efficiently conveniently construct multiscale pore fracture hybrid pore network of tight carbonate rock for evaluating the drainage characteristics keywords multiscale pores fractures multiscale hybrid pore network modeling two phase flow tight carbonate data availability data will be made available on request nomenclature nsp the number of pores in netsmall fs adjustable coefficient of netsmall vs volume of netsmall ρ sp density of the extracted small scale pore network icore low resolution 3d image of tight carbonate ss search sphere sse a set contains the voxels from the center to the farthest within the search radius n e t l arg e large scale pore network extracted from icore netsmall small scale stochastic pore network ρ lp pore density of n e t l arg e nlp the number of pores in n e t l arg e vl volume of n e t l arg e netmulti multiscale pore fracture hybrid pore network dt p 1 p 2 distance between pore p 1 and pore p 2 de p 1 p 2 euclidean distance between pore p 1 and pore p 2 r 1 radius of pore p 1 r 2 radius of pore p 2 d t maximum length of throats in netsmall p lpp i the i th large scale pore in n e t l arg e nlpp the number of large scale pores in n e t l arg e p sp ii the ii th pore in netsmall n sp i the number of pores in netsmall satisfying d t p l p p i p s p i i d t γ s parameter representing the density and connectivity of netsmall cs center of netsmall ξ the number of concentric spheres in netsmall n st k the number of throats penetrating the k th concentric sphere in netsmall rk radius of k th concentric sphere t st j the j th throat in netsmall nst the number of throats in netsmall p sp j1 pore connected to one end of throat t st j p sp j2 pore connected to the other end of throat t st j ak surface area of the k th concentric sphere r lpp i radius of p lpp i cn lpp i coordination number of p lpp i t lpt ij large scale throat connecting p lpp i and p lpp j in n e t l arg e r lpt ij radius of t lpt ij a lpt ij area of spherical crown occupied by t lpt ij sa lpp i remaining surface are of p lpp i scn lpp i the number of pores of netsmall that can be connected to p lpp i plfp fracture pore in n e t l arg e q f ij flow flux of phase f in throat ij p f i pressure of phase f in pore i p f j pressure of phase f in pore j g f ij hydraulic conductivity of phase f in throat ij aij cross sectional area of throat ij lij length of throat ij gij shape factor of cross section of throat ij μ f viscosity of phase f ldij dimensionless slip length of liquid flow in throat ij lsij physical slip length of liquid flow in throat ij t lft ij fracture throat connecting p lfp i and p lfp j w f ij width of t lft ij h f ij equivalent aperture of t lft ij l f ij length of t lft ij p in t inlet pressure of netmulti at the t th iteration step pout outlet pressure of netmulti q f in total flow flux of phase f at the inlet interface of netmulti q f k flow flux of phase f in the k th inlet pore q f out total flow flux of phase f at the outlet interface of netmulti qf total flow flux of phase f l vertical distance between the inlet interface and the outlet interface of netmulti a area of the inlet interface of netmulti kmf absolute permeability of phase f ksf absolute permeability of phase f under the single phase flow krf relative permeability pc capillary pressure 1 introduction tight carbonate rocks exhibit complex void structure with heterogeneities due to the presence of fractures and multiscale pores the multi stages and multi types flow channels have a significant influence on fluid flow such as the slip effect in nanometer pores and the interaction between the fractures and adjacent pores transport processes of fluid in tight carbonate rocks actually occur at the pore scale and the pore scale simulation helps to understand the flow behavior and obtain flow properties at large scales jiang et al 2013 pak et al 2014 rabbani et al 2020 the key is acquiring and modeling the entire representative void structures into a computationally tractable model with the rapid progress in imaging techniques such as micro computed tomography μct imaging and focused ion beam scanning electron microscopy fib sem imaging arns et al 2005 tomutsa et al 2007 müter et al 2012 2014 gooya et al 2016 the 3d representation of the void space can be implemented pore network model pnm extracted from the 3d image has been extensively applied to simulate single and two phase flow because it is computationally more efficient than direct models e g cfd dem model without sacrificing too much accuracy blunt et al 2013 li et al 2021 less computational demands also allow pnm to be competent for larger rock image to consider more heterogeneity of void structure however for heterogeneous tight carbonate rocks two vital problems remain for pnm first the multiscale pore size ranges from several nanometers to hundreds of microns tan et al 2020 resulting in the inability of a single image to cover all void spaces pnm extracted from a low resolution image has no global permeability due to the lacks of micropores unresolved by the image while pnm extracted from a small high resolution image might not be representative secondly fracture exhibits the complicated morphology and topology modeling and coupling the fracture into a pnm for calculating fluid exchange between the fracture network and adjacent pores are challenging the presence of multiscale pores and fractures the resolution size trade off and the pore space fracture interaction make it necessary to model a multiscale pore fracture hybrid pore network for drainage in the entire void space of tight carbonate rocks pnm is the foundation of this study pnm can be extracted from the binarized image of a pore space in which the irregular pore space is represented by a simple network of interconnected pores and throats there are some pnm extraction methods including medial axis ma method lindquist and lee 1996 jiang et al 2007 maximal ball mb method silin et al 2003 dong and blunt 2009 watershed segmentation ws method rabbani et al 2014 2019 pore throat morphology ptm method xu et al 2020 and medial axis maximal ball ab method yi et al 2017 jiang et al 2017a ab method combines the advantages of ma and mb to constrain the maximal balls on the centrally located medial axis which can preserve most of the morphological features of the pore space and has been successfully proven to be highly realistic and efficient in some studies yi et al 2017 jiang et al 2017b cao et al 2017 then for the binarized image containing both fractures and pore spaces there is a need to extract a pore fracture hybrid pore network from it to include the pore fracture interactions and achieve the globally single and two phase flow simulations the process involves two important questions how to identify and model the fractures to couple with the pore spaces and how to achieve simulations of fluid exchange between fractures and adjacent pores for the first question pruess and tsang 1990 and karpyn and piri 2007 used a dense network consisting of virtual pores and throats to represent a fracture and simulated single and two phase flow in the network regions with local maxima of the fracture aperture are defined as virtual pores which are connected by virtual throats defined by other fracture regions later hughes and blunt 2001 and erzeybek and akin 2008 plugged virtual networks of fractures into a regular pore network and used throats to connect the virtual networks with nearby pores recently jiang et al 2017a presented a generally applicable method to extract a pore fracture hybrid pore network from the actual fractured porous media image since the actual fracture possesses the complicated platy morphology the medial surface ms is the best representation of the fracture lee et al 1994 which is defined as a set of surface voxels that are essential for the topology and connectivity of fracture they used ma method to extract skeleton of pore system and used an extended shrinking algorithm to identify the fracture and extract the corresponding ms ms was subsequently converted into a dense network consisting of virtual medial axes the entire skeleton was transformed into a hybrid pore network by defining vertices and links as pores and throats for the second important question of how to simulate fluid exchange between fractures and adjacent pores the hybrid pore network has significant computational advantages all void components pore system and fractures in the hybrid pore network are represented by the same basic elements pores and throats which can be calculated by the same simulator further for some porous media with the multiscale pore spaces the multiscale pore network model has been proposed the fundamental idea of that is extracting a large scale pore network from a low resolution 3d image and integrating it with the micropore networks generated from other sources into a single multiscale pore network jiang et al 2013 presented a method for fusing pore networks extracted from μct images of different resolutions into a multiscale pore network via the cross scale connection structures since the domain of the extracted small scale pore network is smaller than that of the extracted large scale pore network the micropore network was randomly reestablished in a domain of the same size as the large scale pore network based on the statistical information of the extracted small scale pore network to control the density of micropore networks for efficient flow simulation a parameter 0 fs 1 was introduced to determine the number of micropores 1 n s p f s ρ s p v s where nsp is the number of micropores ρ sp is the density of the extracted small scale pore network vs is the volume of micropore network later the method was revised by considering the locations of micropore networks mehmani and prodanovic 2014 prodanovic et al 2014 tahmasebi and kamrava 2018 they proposed that micropores in rocks are generated due to the partial dissolution of some solid matrix particles and the filling of some macropores by clay particles the micropore networks were placed in some matrix regions grain filling and some macropores pore filling mehmani and prodanovic 2014 and prodanovic et al 2014 generated micropore networks by rescaling the extracted large scale pore network implying that some characteristics e g tortuosity coordination number distribution shape factor distribution of large scale pores were used to represent the micropores tahmasebi and kamrava 2018 extracted micropore networks from 3d digital cores reconstructed based on different regions of a sem image additionally some researchers bauer et al 2012 bultreys et al 2015 xu et al 2021 used the micro links to represent the micropores and connect macropore network clusters to generate the multiscale pore network however tight carbonate has both fractures and multiscale pore spaces which is quite complicated to the best of our knowledge there are few relevant studies on the multiscale hybrid pore network models for the entire void structures of tight carbonate rocks rabbani et al 2020 constructed a triple pore network containing micropores meso pores and fractures and simulated the gas transport in it here we present a novel method to construct a multiscale pore fracture hybrid pore network model for drainage in tight carbonate rocks 2 methods 2 1 multiscale pore fracture hybrid pore network construction 2 1 1 pore fracture hybrid pore network extraction we implement a combined algorithm of ab yi et al 2017 and ms jiang et al 2017a to extract the hybrid pore network consisting of pores and fractures from the low resolution 3d image icore of tight carbonate the fundamental principle of ab is constraining maximal balls on the centrally located medial axis which combines the advantages of ma lindquist et al 1996 jiang et al 2007 and mb silin et al 2003 dong and blunt 2009 and ensures that each throat is located at the hydraulic restriction the ms is the extracted skeleton of fracture which characterizes the topology and hydraulic property of fracture the combined algorithm involves the following steps 1 building the inscribed sphere for each void voxel in the 3d image via a layer by layer search algorithm developed previously yi et al 2017 a search sphere ss with a large search radius is established first in which each element is a vector coordinate relative to the center of ss see fig 1 d and e a simple ss and its norms in a 2d system assigning the ss to any void voxel k sse k ss can be acquired which contains the voxels from the voxel k to the farthest within the search radius all voxels in sse are checked one by one in the order of the distance to the voxel k from the small to large until a solid voxel or boundary voxel is found the inscribed sphere for each voxel is built and its radius is acquired 2 a shrinking algorithm developed by jiang et al 2017a is applied to identify both the ma of the pore spaces and the ms of the fractures starting from void voxels on the void space wall through searching and removing the void voxels that do not affect the euler number and local connectivity of the void space we find the ma of the pore spaces fig 1f and the ms of the fractures fig 1g especially the inscribed spheres are also utilized to make the ma and the ms more centered fig 1a and fig 1b highlight the scheme ma of the pore spaces and ms of the fracture fig 1b are effectively extracted from the entire void space consisting of the pore spaces and the fracture fig 1a 3 for the pore spaces with ma a identifying the inscribed spheres corresponding to the ma voxels and removing other inscribed spheres to constrain the maximal balls on the ma yi et al 2017 b affiliating these maximal balls into family trees to defined pores and throats according to the order of maximal ball radius from large to small all maximal balls are clustered based on their radii and locations to determine the hierarchical relationships among them from the hierarchical relationship the family trees of all maximal balls are generated fig 1h in which the center of parent ball is defined as pore location and the center of common child ball attaching to two parent balls is defined as throat location yi et al 2017 c segmenting pore blocks and throat blocks via a dual speed expansion algorithm developed previously yi et al 2017 all pore location voxels and throat location voxels are labeled with 0 starting from the pore location voxels and the throat location voxels pore blocks and throat blocks expand outward and the unmarked void voxels involved are labeled with the number of expansions pore blocks expand two layers outward each time fig 1i and throat blocks expand one layer outward each time fig 1j the entire pore space is divided into a series of pore blocks and throat blocks 4 for the fractures with ms converting the ms into a dense network consisting of virtual medial axes see fig 1k to generate a dense network consisting of virtual pores and throats jiang et al 2017a 5 the parameters e g shape factor coordination number etc of pores and throats that are associated with the pore spaces and the pore fracture connecting spaces are calculated as usual yi et al 2017 the parameters e g width equivalent aperture etc of virtual pores and throats of the dense network are determined based on the underlying fracture apertures jiang et al 2017a finally a hybrid pore network is generated to represent the entire void space as shown in fig 1c the entire extraction process is briefly introduced above in which ab is applied to treat the pore spaces and ms is used to process the fractures for more details about the hybrid pore network generation one can refer to the aforementioned publication note that the extracted hybrid pore network in general has no global connectivity due to the lacks of micropores unresolved by icore for the remainder of this work we refer to the hybrid pore network as large scale network n e t l arg e and refer to the pore and throat corresponding to pore spaces as large scale pore and large scale throat and the pore and throat corresponding to fractures as fracture pore and fracture throat 2 1 2 small scale stochastic pore network generation after the n e t l arg e has been extracted from the icore we establish the small scale stochastic pore network netsmall in the matrix domains of icore to represent the micropores unresolved by icore and supplement the n e t l arg e with the connectivity generated by the micropores the first step is determining the geometric and topological parameters of micropores as mentioned above mehmani and prodanovic 2014 and prodanovic et al 2014 generated the small scale pore network by rescaling the macropore network indicating that some characteristics of macropores were used to represent the small scale pores this is more economic and efficient compared with the scheme of extracting statistics of micropores from the high resolution μct image jiang et al 2013 and the scheme of reconstructing 3d image of micropores based on sem image tahmasebi and kamrava 2018 however the uncertainty of the micropores is significant moreover predictions of the multiscale model usually do not agree well with the experimental measurements due to the strong heterogeneity and the multiscale model generally needs to be constrained and optimized by a kind of experiment data pak et al 2016 following the two ideas of mehmani and prodanovic 2014 and pak et al 2016 we use some parameters tortuosity coordination number distribution shape factor distribution of large scale pores and throats of the n e t l arg e to represent the micropores then we set the pore radius distribution and the throat radius distribution of micropores as the appropriate distributions and determine them under the constraint of experimental permeability to reduce the above uncertainty the detail of the determination will be introduced in section 2 1 3 3 note that the maximum radius of the two distributions is given by the resolution of icore and not by the minimum throat radius of the n e t l arg e for the nsp of the netsmall we use eq 1 to determine it by replacing ρ sp with ρ lp based on the idea of mehmani and prodanovic 2014 ρ lp is pore density of n e t l arg e and can be written as 2 ρ l p n l p v l where nlp is the number of pores in the n e t l arg e and vl is the volume of the n e t l arg e next we extend the algorithm proposed by idowu and blunt 2010 to generate a netsmall based on the given parameters the major difference of our extended algorithm is that pores and throats are strictly confined in the irregular matrix domain the producer is shown below 1 morphological dilation operation with radius of 2 voxel is implemented on the entire void space of the icore xu et al 2020 to transform the matrix within the range of 2 voxels around the void space into voids the remaining matrix is the domain to establish the netsmall as shown in fig 2 a 2d slice of the pore fractured porous media in fig 1a since the maximum radius of small scale pores is the resolution of the icore even if the center of a small scale pore is located at the edge of the residual matrix domain it will not intersect with the pore spaces and fractures of the icore see fig 2 2 nsp pores are created by randomly assigning values of radius shape factor and coordination number to every pore based on the given distributions the centers of these pores are randomly placed in the remaining matrix domain and make sure that there is no overlap of them then the volume and weight are calculated for each pore idowu and blunt 2010 xu et al 2021 3 creating throats according to the coordination number of each pore to connect these pores idowu and blunt 2010 if the cylindrical throats intersect with the pore spaces and fractures of the icore we discard them and continue to find other connections for the corresponding pores see fig 2 therefore the actual connection number of some pores may be less than their assigned coordination number due to the domain constraint 4 calculating the weight for every throat based on the weights of two pores connected to it idowu and blunt 2010 xu et al 2021 according to the given distributions the smallest geometrical values radius shape factor are assigned to the throat with the smallest weight and the second smallest values are assigned to the throat with the second smallest weight and so on to ensure the correlation of the netsmall then the length of each throat is calculated based on the center position and radius of two pores connected to it and the volume is calculated for each throat idowu and blunt 2010 in the end the netsmall is generated as described the number of large scale pores and throats in the n e t l arg e should be enough to obtain the representative parameters tortuosity coordination number distribution shape factor distribution to generate the netsmall however if there are only a few pore spaces captured in the icore these parameters can also be obtained from other sources for example obtaining these parameters from the higher resolution image via the pore throats morphology ptm software we developed previously xu et al 2020 the novel way provided to obtain the small scale pore parameters is intended to be illustrative rather than the unique solution because the central contribution of the paper is the multiscale pore fracture hybrid pore network modeling and integration method 2 1 3 multiscale pore fracture hybrid pore network generation after obtaining the n e t l arg e and the netsmall the two pore networks are integrated into a multiscale pore fracture hybrid pore network netmulti the major idea of the process is connecting pores of n e t l arg e and their nearby pores of netsmall via the added small scale throats in order to ensure that the final netmulti is a correlated network in terms of geometry and topology both the geometric and topological properties of the n e t l arg e and the netsmall must be considered in the connecting process the detailed considerations are as follows connecting large scale pore with small scale pore first of all the added connecting throat is the small scale throat which should be correlated with the netsmall except for the throat length the geometric properties of the added small scale throat are determined based on the average values of throats in the netsmall the length of the added small scale throat is determined as follows for two pores p 1 and p 2 with inscribed radii r 1 and r 2 the distance dt p 1 p 2 is defined as 3 d t p 1 p 2 d e p 1 p 2 r 1 r 2 where de p 1 p 2 is the euclidean distance between the two pore centers if the two pores are connected by a throat dt p 1 p 2 is the length of this throat the length of the added small scale throat should be less than or equal to the maximum length d t of throats in the netsmall each large scale pore p lpp i i 1 2 nlpp of the n e t l arg e can only connect its nearby pore p sp ii ii 1 2 n sp i of the netsmall whose dt p lpp i p sp ii is less than or equal to the d t where nlpp is the number of large scale pores in the n e t l arg e and n sp i is the number of pores of the netsmall that meet this condition secondly the number of pores in the netsmall that can be connected to a large scale pore p lpp i of the n e t l arg e is also correlated to the density and connectivity of the netsmall the coordination number and radius of p lpp i in the n e t l arg e and the radii of throats connected to p lpp i in the n e t l arg e we use a parameter γ s proposed by jiang et al 2013 to represent the density and connectivity of the netsmall as follows taking the center cs of the netsmall as sphere center we insert ξ concentric spheres of radii 0 r 1 r 2 r ξ in the netsmall and ensure that the largest sphere is within the netsmall for the k th k 1 2 ξ concentric sphere the number n st k of throats that penetrate the sphere is calculated by 4 n s t k c a r d t s t j d e c s p s p j 1 r k d e c s p s p j 2 j 1 2 n s t where card is a mathematical symbol which is named cardinal number and indicates the number of elements in a set it is implemented by traversing every throat in the netsmall one by one and calculating the number of throats that satisfy the conditions in the eq 4 t st j is the j th throat in the netsmall and nst is the number of throats in the netsmall p sp j1 and p sp j2 are two pores connected by the throat t st j the parameter γ s is defined as 5 γ s 1 ξ k 1 ξ n s t k a k where ak is the surface area of the k th concentric sphere for more details refer to jiang et al 2013 the coordination number and radius of p lpp i in the n e t l arg e and the radii of throats connected to p lpp i in the n e t l arg e are represented as follows for a p lpp i of radius r lpp i and coordination number cn lpp i in the n e t l arg e the area a lpt ij of spherical crown occupied by the throat t lpt ij is calculated by 6 a l p t i j 2 π r l p p i r l p p i r l p p i 2 r l p t i j 2 where r lpt ij is the radius of the throat t lpt ij as shown in fig 3 the remaining surface area sa lpp i of p lpp i that are not occupied by throats is thus calculated by 7 s a l p p i 4 π r l p p i 2 j 1 c n l p p i a l p t i j finally the number scn lpp i of pores in the netsmall that can be connected to p lpp i of the n e t l arg e is calculated by 8 s c n l p p i s a l p p i γ s connecting fracture pore with small scale pore since the fracture network is extremely dense see fig 1c if the scheme described above is used directly to connect fracture pores with small scale pores a small pore will be connected with a large number of fracture pores around it in order to avoid this issue we search for all the small scale pores that can be connected to every fracture pore via using the eq 3 and the d t see the small scale pores within the red shadow in fig 4 each pore p sp i of these small scale pores is subsequently connected to one fracture pore plfp whose dt p sp i plfp is the smallest see fig 4 moreover the length and geometric properties of the added small scale throats are determined via the scheme described in section 2 1 3 1 generation the netmulti is generated by following the process shown below 1 for each large scale pore p lpp i of the n e t l arg e calculating the scn lpp i via using eqs 4 8 finding its nearby pores of the netsmall that are possible to be connected with it using the eq 3 and d t some obtained pores of the netsmall are connected to the pore p lpp i using the added throats according to the scn lpp i and the order of dt p lpp i p sp ii from small to large see fig 4 2 for all fracture pores of the n e t l arg e finding all the pores of the netsmall that can be connected to them by using the eq 3 and the d t every pore of the obtained small scale pores is connected to the nearest fracture pores using a added throat see fig 4 3 assigning the geometric properties to the added small scale throats 4 through connecting small scale pores with large scale pores and fracture pores the netsmall and the n e t l arg e are integrated into a global connected pore network we calculate the absolute permeability of the pore network and compare it to the experimental permeability the calculation will be introduced later if the match between them is poor we will change the pore radius distribution and the throat radius distribution of micropores via resetting the types mean values and standard deviations of the distributions then we regenerate the netsmall and reconstruct the global connected pore network to calculate its absolute permeability until the calculation result is close to the experimental permeability the relative error is less than 10 the work flow is shown in fig 5 finally the netmulti is generated note that since the netmulti is closely correlated with the n e t l arg e and netsmall in terms of both geometry and topology only three construction parameters are uncertain and need to be adjusted the pore radius distribution and the throat radius distribution of the netsmall as well as fs the first two construction parameters are determined under the constraint of experimental permeability the determination of fs will be discussed later therefore our method possesses significant conveniences 2 2 multiscale pore fracture hybrid pore network calculation the netmulti has significant advantages in flow calculation compared to the multiscale seepage model coupled with different methods all void components in netmulti are represented by the basic elements pores and throats which makes it possible to perform the global flow simulation via one solver we extend the network simulator developed by the professor martin blunt s group at imperial college to simulate drainage in the netmulti blunt et al 2002 valvatne and blunt 2004 each iteration step of the network simulator includes two sub steps the displacement process and the flow flux solving process the displacement process is based on the quasi static model that is the flow velocity is assumed to be small enough so that the viscous force is negligible and the capillary force is control force for more details of the displacement process one can refer to the work of valvatne and blunt 2004 after the displacement process all phase interfaces are updated at the boundaries between pores and throats therefore it is possible to easily count the respective volumes of oil and water in all of pores and throats the water saturation sw is calculated as the ratio of water volume to the total volume of the netmulti flow flux of a phase f can be solved by imposing the mass conservation equation at every pore which is described as 9 j 1 n q f i j 0 where n is the number of throats connected to the pore i q f ij is the flow flux of phase f in the throat ij connecting pore i and pore j q f ij can be written as 10 q f i j g f i j p f i p f j where p f i and p f j are the pressure of phase f in pore i and pore j respectively g f ij is the hydraulic conductivity of phase f in throat ij netmulti contains large scale pores and throats and small scale pores and throats as well as fracture pores and throats for the large scale pores and throats because its size is much larger than liquid slip length the knudsen number is small and the liquid slip effect can generally be ignored g f ij is written as valvatne and blunt 2004 11 g f i j 0 6 a i j 2 g i j μ f l i j 0 g i j 0 0481 0 5623 a i j 2 g i j μ f l i j 0 0481 g i j 0 0625 0 5 a i j 2 g i j μ f l i j 0 0625 g i j 0 0796 where aij and lij are the cross sectional area and length of throat ij respectively gij is the shape factor of cross section of throat ij 0 gij 0 0481 represents the cross section is triangular in shape 0 0481 gij 0 0625 represents the cross section is quadrilateral in shape 0 0625 gij 0 0796 represents the cross section is circular in shape μ f is the viscosity of phase f for the small scale pores and throats since the liquid slip length is comparable to its size the knudsen number is large and the liquid slip effect must be considered in g f ij as afsharpoor and javadpour 2016 ji et al 2021 12 g f i j 0 012 0 057 l d i j 2 g i j 0 0052 l d i j 2 38 g i j 2 3 2 l d i j g i j a i j 2 μ f l i j g i j 0 04 0 16 0 16 l d i j 6 4 g i j 0 0055 l d i j 2 50 g i j 2 1 7 l d i j g i j a i j 2 μ f l i j g i j 0 04 where ldij is the dimensionless slip length of liquid flow in throat ij calculated by l d i j l s i j a i j lsij is the physical slip length of liquid flow in throat ij for the fracture pores and throats g f ij is adjusted as pruess and tsang 1990 ebrahimi et al 2014 jiang et al 2017a 13 g f i j w f i j h f i j 3 12 μ f l f i j where w f ij h f ij and l f ij are the width equivalent aperture and length of fracture throat t lft ij connecting two fracture pores p lfp i and p lfp j respectively the linear equations of mass conservation of all the pores in the netmulti can be obtained by formulas 9 13 then the linear equation system is solved using gauss seidel method to obtain the convergent stable pressure field according to the pressure boundary conditions the inlet pressure p in t of netmulti and the outlet pressure pout of netmulti in the current iteration step of drainage calculation the subscript t of p in t represents the current iteration step is the t th iteration step in drainage computation the total flow flux q f in of phase f at the inlet interface of netmulti is obtained by calculating the flow flux of each inlet pore in netmulti 14 q f i n k 1 n i b q f k k 1 n i b j 1 m g f k j p f k p f j where nib is the number of inlet pores of netmulti q f k is the flow flux of phase f in the inlet pore k m is the number of throats connected to the inlet pore k p f k and p f j are the pressure of pore k and pore j in the stable pressure filed respectively similarly the total flow flux q f out of phase f at the outlet interface of netmulti can be calculated the absolute permeability kmf of phase fat the t th iteration step of drainage simulation can be calculated as 15 k m f μ f q f l a p i n t p o u t where q f q f i n q f o u t 2 l is the vertical distance between the inlet interface and the outlet interface of netmulti a is the area of the inlet interface of netmulti through the above computation process the absolute permeability ksf of phase f under the single phase flow can be calculated based on the same pressure boundary conditions the relative permeability krf of phase f at the t th iteration step of drainage simulation is calculated by 16 k r f k m f k s f in addition the capillary pressure pc at the t th iteration step of drainage simulation is calculated by 17 p c p i n t p o u t throughout the drainage simulation we slowly increase the inlet pressure and keep the outlet pressure constant each pressure point corresponds to an iteration step in which the displacement process and the flow flux solving process are performed finally the water saturation capillary pressure curve and water saturation relative permeability curve can be obtained 3 results and discussion to provide an insight into the multiscale pore fracture hybrid pore network model and assess the model quality two reservoir tight carbonate rocks from ordovician formation in china denoted as ordos tight carbonate and tarim tight carbonate are used to generate multiscale hybrid pore networks 3 1 ordos tight carbonate 3 1 1 pore fracture hybrid pore network the μct image of the ordos tight carbonate rock along with its extracted pore fracture hybrid pore network is shown in fig 6 the voxel numbers of the μct image are 1008 1008 1008 and the voxel size is 13 98 μm the white and gray are matrix which is mainly composed of quartz and clay minerals the black represents voids which comprise pore spaces and two fractures in the extracted pore fracture hybrid pore network two curved fractures red are clearly revealed the major properties including absolute permeability of the hybrid pore network are shown in table 1 we note that the numbers of fracture pores and fracture throats are greater than those of large scale pores and large scale throats because fractures are represented by the dense pore networks as the entire void space in μct image has no overall connectivity in x and y directions the extracted hybrid pore network is not percolating in these two directions the hybrid pore network has large permeability kzl of 752 57md in z direction due to the perforative fracture in this direction the left fracture in fig 6a and b in order to evaluate the hybrid pore network the z direction permeability kzlbm of the corresponding binary image is directly calculated using the two relaxation time lattice boltzmann model trt lbm pan et al 2006 as shown in table 1 the relative error between kzl and kzlbm is 8 68 which is reasonable the possible reason for this result is that the simplification of pore fracture connecting spaces which results in more flow probability the good agreement between kzl and kzlbm indicates that the pore fracture hybrid pore network extracted by the improved ab ms algorithm is equivalent to the actual pore fracture spaces this lays a good foundation for the multiscale hybrid pore network generation 3 1 2 multiscale pore fracture hybrid pore network the normalized coordination number distribution pore shape factor distribution and throat shape factor distribution of large scale pores and throats of the extracted hybrid pore network see blue in fig 6b is used for generating the small scale stochastic pore network as shown in fig 7 a and b it can be seen that the peak value and the average value of the coordination number distribution are 2 and 2 91 respectively the peak values of the pore shape factor distribution and the throat shape factor distribution are about 0 0301 and 0 0413 indicating that the cross sections of large scale pore spaces are mainly triangular in shape moreover the distributions of pore radius and throat radius of small scale stochastic pore network are assumed to be lognormal see fig 7c to study the effect of fs first the small scale mean pore radius and mean throat radius are assumed to be 1 μm and 0 5 μm respectively as mentioned in section 2 1 3 3 only three construction parameters in the netmulti are uncertain and need to be adjusted in which the first two construction parameters are determined under the constraint of experimental permeability here the effects of the third construction parameter fs on the netmulti and its single phase and two phase flow properties are investigated different fs s are considered and the corresponding multiscale hybrid pore networks are constructed some properties of these networks are summarized in table 2 as it can be seen multiscale hybrid pore networks have higher average coordination number due to the presence of small scale pores connected to adjacent large scale pores and fracture pores the average coordination numbers of the two multiscale hybrid pore networks with fs 0 4 and fs 0 6 are almost the same and did not increase with the increase of fs to clarify this situation fig 8 a shows the detailed average coordination number fs curve and fig 8b shows the coordination number distributions of three multiscale hybrid pore networks with fs 0 4 fs 0 5 and fs 0 6 it can be seen that the average coordination number tends to become almost constant with the increase of fs in this case about fs 0 3 the coordination number distributions of the three fs s agree well see fig 8b it indicates that the proposed method can ensure the constructed network is correlated in terms of geometry and topology and will not endlessly connect small scale pores to adjacent large scale pores and fracture pores two multiscale hybrid pore networks with different fs s are visualized in fig 9 the absolute permeabilities of multiscale hybrid pore networks with different fs s are calculated in the x y and z directions the results are shown in fig 10 as can be seen for the well connected z direction of the extracted pore fracture hybrid pore network the integrated small scale pore networks only enhance its permeability very little the perforative fracture is the main flow channels in z direction see fig 9 for the impermeable x and y directions of the extracted pore fracture hybrid pore network the integrated small scale pore networks significantly enhance permeability because small scale pores connect large scale pores and fracture pores to form the main flow paths in this scenario the permeability increases with the increase of fs but it becomes almost constant when fs 0 3 approximately this effect of fs on x and y permeability is virtually the same as its effect on the model connectivity the drainage capillary pressure saturation curves and relative permeabilities of multiscale hybrid pore networks with different fs s are also calculated in the x y and z directions fig 11 shows the capillary pressure saturation curves as can be seen the residual water saturation decreases as the fs increases which can be due to the fact that the connections of small scale pores with large scale pores and fracture pores provide more escape routes for the trapped phase inside large scale pore spaces another interesting observation is that the residual water saturation is almost constant for fs 0 3 this is consistent with the earlier observations that the connectivity and the absolute permeability of the multiscale hybrid pore network hardly increases once fs 0 3 the curves for different fs s show good agreement when the water saturation is relatively large the curves for x and z directions see fig 11a and c have two percolation plateaus although the right percolation plateau exhibits a tilt due to the slight increase of capillary pressure while the curves for y direction have only one percolation plateau see fig 11b to provide more insight into the displacement processes and clarify the differences three moments st1 st2 and st3 in the displacement processes are selected see fig 11 and the corresponding two phase distributions are visualized in the network with fs 0 4 as shown in fig 12 as can be seen from fig 12x st1 the non wetting phase oil invaded the right fracture and some pores adjacent to the fracture resulting in the right percolation plateau in fig 11a the non wetting phase subsequently flowed through some paths between the two fractures and invaded the left fracture see fig 12x st2 with the rapid increase in pressure the pressure jump between x st1 and x st2 in fig 11a corresponds to this process the left fracture and some pores around it are rapidly occupied by the non wetting phase see fig 12x st3 resulting in the left percolation plateau in fig 11a with the further increase in pressure the small scale pores not occupied by non wetting phase see fig 12x st3 are also invaded which corresponds to the pressure jump after x st3 in fig 11a the displacement in y direction is visualized in fig 12y st1 12y st2 and 12y st3 since the two fractures did not penetrate in y direction the non wetting phase first invaded some small scale pores and throats see fig 12y st1 with the rapid increase in pressure the pressure jump between y st1 and y st2 in fig 11b corresponds to this process then the two fractures were invaded by the non wetting phase almost at the same time see fig 12y st2 and y st3 hence the curves in fig 11b have only one larger percolation plateau fig 12z st1 12z st2 and 12z st3 show the displacement in z direction since the right fracture does not penetrate in this direction the curves see fig 11c also have two percolation plateaus it should be noted that the right fracture was invaded in two ways the nonwetting phase from the left fracture and the nonwetting phase from the inlet see fig 12z st2 fig 13 shows the relative permeability curves in x and y directions the effect of fs on the relative permeability is large as can be seen from the subgraph in fig 13a the relative permeability curves in x direction show large variability when fs is little 0 1 0 2 0 3 but they converge to an almost constant curve at fs 0 4 see fig 13a the relative permeability curves in y direction settle to a constant curve at fs 0 3 see fig 13b the small variability between convergent curves may be related to the fact that the flow paths become more tortuous with the increase of small scale pores fig 14 shows the relative permeability curves in z direction the effect of fs on the relative permeability is little because the perforative fracture in z direction provides the main flow path see fig 12z st1 although the processes of water saturation change in the x y and z directions are similar see fig 11 the water relative permeability in z direction rapidly decreases to the minimum and the oil relative permeability rapidly increases to the maximum due to the fluid channeling in the perforative fracture the isotonic point of relative permeability shifts to the higher saturations see fig 14 according to the results of absolute permeability fig 10 and relative permeability fig 13 and fig 14 in the three directions it can be seen that there is a significant difference between the flow along the perforative fracture direction and the flow along other directions which is one of the main feature of the heterogeneity of tight carbonate rocks the constructed multiscale hybrid pore network generally tends to have stable single phase and two phase flow results as well as robustness when fs 0 4 it means that these small scale pore networks are sufficient to represent the properties of micropores moreover a larger fs will introduce excessive elements and lead to expensive computational demands while a smaller fs will result in inaccurate results without representativeness therefore we set fs 0 4 to construct the netmulti for taking into account both the calculation accuracy and the calculation efficiency in the study note that fs 0 4 is only used for this study because the analysis of fs is intended to be illustrative and provide more insight of the method rather than concluding the unique solution of fs for various tight carbonates the experimental permeability of the ordos tight carbonate rock in the y direction is 298 18μd the distributions of pore radius and throat radius of small scale stochastic pore network are re determined under the constraint of experimental permeability as shown in fig 15 a the distributions are lognormal the small scale mean pore radius and mean throat radius are 2 μm and 1 μm which are larger than the earlier assumptions see fig 7c the calculated absolute permeability of multiscale hybrid pore network in y direction is 315 94μd and the relative error between this result and the experimental data is 5 39 small changes of the small scale radius distributions have a great influence on the permeability jumping from 112 87μd see fig 10 to 315 94μd this is related to the fact that the connections of small scale pores with large scale pores and fracture pores provide the main flow paths the calculated drainage capillary pressure saturation curve is shown in fig 15b the capillary pressure saturation curve of fs 0 4 in fig 11b is shown again in fig 15b for comparison as expected the pressure of percolation plateau of the constrained curve is lower fig 15c shows the calculated drainage relative permeability curve and the unconstrained relative permeability curve of fs 0 4 see fig 13b as can be seen the water relative permeability curve shifts down and the non wetting phase oil relative permeability curve shifts up as well as the isotonic point of relative permeability moves right to larger saturation indicating that the displacement is more favorable since there is only experimental permeability in y direction we only discuss them in y direction here it is not possible to implement a direct comparison between the experimental results and the two phase flow calculated results after constrained but the work is currently in progress the major contribution of this study is the multiscale pore fracture hybrid pore network modeling method moreover the drainage simulations in netmulti were performed on a personal computer and the computational time was 3minutes 29seconds which was quite short for this tight carbonate with 14 093 mm 3 sizes and multiscale pores fractures the presented model reduced the computational memory and improved the computational efficiency significantly and showed the potential for processing relatively large size tight carbonates on a personal computer 3 2 tarim tight carbonate for this reservoir tight carbonate rock from tarim basin we perform μct experiment to acquire the scanning image as shown in fig 16 a the resolution of the μct experiment is also 13 98 μm the voxel numbers of the μct image are 722 1168 1139 the extracted pore fracture hybrid pore network is shown in fig 16b as can be seen an irregular curved fracture red is clearly revealed the basic properties of the extracted pore fracture hybrid network are summarized in table 3 the hybrid pore network is not percolating in z direction because the entire void space in μct image has no global connected paths in this direction the normalized coordination number distribution pore shape factor distribution and throat shape factor distribution of large scale pores and throats of the extracted hybrid pore network see blue in fig 16b are obtained to generate small scale stochastic pore network as shown in fig 17 a and b as can be seen the pore shape factor and throat shape factor are mostly less than 0 0481 indicating that their cross sectional shape is mainly triangle the mean value of the coordination number distribution is 2 66 then the experimental permeability of the tarim tight carbonate rock in the z direction is 739 33μd the distributions of pore radius and throat radius of small scale stochastic pore network are set to lognormal and determined under the constraint of experimental permeability as shown in fig 17c the small scale mean pore radius and mean throat radius are 2 μm and 1 μm respectively the absolute permeability of multiscale hybrid pore network in z direction is calculated as 767 79μd and the relative error between this result and the experimental result is 3 71 the multiscale hybrid pore network is visualized in fig 16c and major properties of the network are shown in table 4 as can be seen the absolute permeability of the multiscale hybrid pore network in x and y directions is almost the same as that of the pore fracture hybrid pore network in the two directions see table 3 which is consistent with the earlier observation and jiang et al study that the integrated small scale pore network only leads to a very small increase in absolute permeability of the well connected direction of the extracted large scale network fig 18 shows the capillary pressure saturation curve result simulated in the multiscale hybrid pore network and the mercury injection capillary pressure micp experiment result of the tarim tight carbonate rock as can be seen the simulated capillary pressure saturation curve matches the experimental result well though some of the detailed capillary pressure behavior is not captured by the multiscale hybrid pore network the simulated curve is slightly higher than the experimental result when the air saturation is low the possible reason for this phenomenon is that the connectivity of small scale pores is poorer than that of the actual micropores due to the strict space constraints on the small scale throats which makes mercury more difficult to enter moreover the percolation plateau of the simulated curve exhibits a certain tilt because the fracture is small and does not dominate in the whole system 4 conclusions and outlook in this study a novel method is proposed to construct the multiscale pore fracture hybrid pore network model for drainage in tight carbonate rocks this model consists of nanometer pores micron pores and fractures and includes the flow characteristics in them firstly considering the different flow characteristics in pore spaces and fractures pores and fractures in a low resolution μct image are extracted by medial axis maximal ball algorithm and medial surface algorithm respectively to generate a pore fracture hybrid pore network subsequently a statistics based small scale stochastic pore network is established in the μct image solid domains to represent the micropores unresolved by the image then the two pore networks are organically integrated into a multiscale hybrid pore network by the added small scale throats under the constraint of experimental permeability we extract a pore fracture hybrid pore network from the μct image of an ordos tight carbonate rock and calculate the absolute permeability in the permeable z direction the result is compared with that calculated by lbm the relative error between them is 8 68 indicating that the pore fracture hybrid pore network extracted by the developed ab ms algorithm is physically realistic the effects of the only uncertain construction parameters fs on connectivity single phase and two phase flow properties are further investigated the multiscale hybrid pore network is robust and its coordination number distribution absolute permeability and relative permeability curve tend to be convergent when fs 0 4 these introduced small scale pore networks are sufficient to represent the properties of micropores our proposed method can ensure the multiscale hybrid pore network is geometrically and topologically relevant besides will not endlessly connect small scale pores to adjacent large scale pores and fracture pores the effects of fractures on two phase flow are also investigated incorporating fractures and micropores in the drainage model is important furthermore we construct a multiscale pore fracture hybrid pore network for a tarim tight carbonate rock and calculate the capillary pressure saturation curve the multiscale hybrid pore network model is validated by comparing the calculated result with the mercury injection capillary pressure experiment data the calculated capillary pressure saturation curve matches the experimental data well it can be concluded that the proposed method can accurately efficiently conveniently construct multiscale pore fracture hybrid pore network of tight carbonate rock for evaluating the drainage characteristics the presented method is compatible with various sources of micropore parameters we use some parameters tortuosity coordination number distribution shape factor distribution of large scale pores and throats to represent the micropores which is convenient and economic but may be somewhat sketchy for some applications in future studies researchers can adopt our method and combine various sources of micropore parameters to further extend it as needed eqs 2 9 17 credit authorship contribution statement zhipeng xu investigation conceptualization methodology validation writing original draft writing review editing mian lin investigation conceptualization writing original draft writing review editing funding acquisition lili ji conceptualization methodology writing original draft writing review editing funding acquisition wenbin jiang investigation validation writing original draft writing review editing gaohui cao validation writing original draft writing review editing leige xu writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china grant no 42030808 the national natural science foundation of china grant no 41690132 the strategic priority research program of the chinese academy of sciences grant no xda14010304 the major national science and technology special program of china grant no 2017zx05037 001 the national natural science foundation of china grant no 41574129 we thank dr g villarini and the anonymous reviewers for their constructive comments on this manuscript 
41,recharge from ephemeral streams called masil in farsi and wadi in arabic is the main process of groundwater recharge in arid regions of the world where groundwater is the most important source of water supply despite advances in mathematical models of simulating infiltration from these streams there is no versatile analytical model to simulate the groundwater mound due to recharge from an ephemeral stream the goal of this paper is to present a semi analytical model of the groundwater mound due to recharge from an ephemeral stream of an arbitrary geometric shape in aerial view a three dimensional anisotropic unconfined aquifer is considered and a point recharge is imposed to the water table at first the point recharge solution is obtained via the laplace and fourier transforms the image well method is employed to incorporate the lateral no flow boundary that represents the margin of the unconfined aquifer the point recharge solution is then extended to simulate the groundwater mound due to recharge from the stream of an arbitrary shape by approximating the stream by multiple straight segments and integration of the point recharge solution along the desired directions of those segments and the principle of superposition a constant head variable discharge well is also placed near the stream to calculate the sustainable yield which is the average discharge of a constant head well as compared to an equivalent constant flux well the results of this work are presented in the form of groundwater mound time curve and groundwater mound spatial maps the scaled sensitivity of groundwater head to recharge from the stream time curves and depletion volume of the nearby well time curve are also obtained the influences of aquifer parameters on the groundwater mound and sustainable development of the aquifer near the ephemeral stream are analyzed this study shows that 1 groundwater mound follows the shape of the stream and spreads spatially from the stream over time and the groundwater mound is higher inside the convex part of the stream due to interference from the neighboring stream segments 2 the groundwater head collected from an observation well in a fine grain aquifer is more valuable to estimate the recharge from the ephemeral stream than a coarse grain aquifer 3 the sustainable yield of a production well in an alluvial aquifer is maximum near the stream in a coarse grain non layered aquifer than the coarse or fine grain layered aquifer the results of this work can be utilized as a valuable tool for managing the unconfined aquifers in the arid and semi arid regions when ephemeral streams are the primary sources of recharge keywords wadi semi analytical solution groundwater mound unconfined aquifer ephemeral streams data availability no data was used for the research described in the article nomenclature kh horizontal hydraulic conductivity lt 1 kz vertical hydraulic conductivity lt 1 ss specific storage l 1 h groundwater mound l x x coordinate of the observation point l y y coordinate of the observation point l z z coordinate of the observation point l x 0 x coordinate of the source sink point l y 0 y coordinate of the source sink point l xs x coordinate of the starting point of the stream segment l ys y coordinate of the starting point of the stream segment l sy specific yield spi scaled sensitivity of the groundwater head to parameter pi r t time varying volumetric recharge l3t 1 j 0 bessel function of first kind and zero order xd dimensionless x coordinate of the observation point yd dimensionless y coordinate of the observation point zd dimensionless z coordinate of the observation point x 0d dimensionless x coordinate of the source sink point y 0d dimensionless y coordinate of the source sink point xsd dimensionless x coordinate of the starting point of the stream segment ysd dimensionless y coordinate of the starting point of the stream segment σ dimensionless parameter h d dimensionless laplace domain groundwater mound due to point recharge h e d dimensionless laplace domain groundwater mound due to ephemeral stream r p dimensionless laplace domain recharge s d dimensionless laplace domain drawdown ld dimensionless length of stream h t heaviside unit step function r 0d constant recharge applied to the water table δ x dirac delta function l 1 ω1 fourier transform variable ω2 fourier transform variable 1 introduction groundwater recharge from ephemeral streams such as masil in farsi and wadi in arabic is the primary type of recharge in many arid and semi arid regions of the world dassi 2010 matter et al 2006 rizk et al 2007 subyani 2004 sultan et al 2000 villeneuve et al 2015 wang et al 2017 yangui et al 2011 these areas represent about 35 of the global landmass with about 2 billion people living there cuthbert et al 2016 hassan et al 2005 thus construction of recharge dams on ephemeral streams is quite common in arid regions to enhance groundwater recharge alataway and el alfy 2019 alderwish 2010 de laat and nonner 2012 missimer et al 2015 prathapar and bawain 2014 mathematical models considering the aquifer stream interaction may be used to simulate the groundwater head due to recharge from streams including ephemeral ones hobson 1887 mcmahon and nathan 2021 zlotnik et al 2017 generally streams that are connected to the aquifer are simulated as specified head boundaries barlow et al 2000 intaraprasong and zhan 2009 lin et al 2018 moench and barlow 2000 samani and sedghi 2015 sedghi and zhan 2016 2019 for a stream that is not connected to the aquifer there is an unsaturated zone separating the stream from the aquifer which is usually the case for ephemeral streams and this system may be simulated by using the specified flux boundaries abdulrazzak and morel seytoux 1983 cuthbert 2010 cuthbert et al 2016 dillon and liggett 1983 liu et al 2019 sorman et al 1997 or using more sophificated models specially designed for dealing with the disconnected rivers cheng et al 2021a 2021b abdulrazzak and morel seytoux 1983 presented an approximate analytical solution to predict the time varying recharge rate from an ephemeral stream their solution is applicable after the wetting front reaches the water table dillon and liggett 1983 presented a model to predict the recharge from an ephemeral stream with a clogged streambed for the case in which the stream is hydraulically connected disconnected or transitional between these two cases they utilized the green ampt equation for the disconnected state sorman et al 1997 used a numerical model to simulate the groundwater head rise due to recharge from an ephemeral stream in wadi tabalah saudi arabia cuthbert et al 2016 obtained a two dimensional 2 d analytical solution of the hydraulic head due to recharge from an ephemeral stream the lateral boundary was considered as no flow to simulate the alluvial plain margin and constant head to simulate the downstream wetlands the recharge from the ephemeral river was applied to the whole aquifer thickness one dimensional 1 d boussinesq equation was used by liu et al 2019 to simulate groundwater level fluctuation due to recharge from an ephemeral stream they showed that their model simulated the short time groundwater level fluctuation successfully utilizing groundwater level data near the ephemeral stream their model however could not simulate the multi year groundwater level fluctuations cheng et al 2021b investigated the evolution of the inverted saturated zone below an ephemeral stream the model presented by cheng et al 2021b can also be utilized to predict the head distribution below an ephemeral stream for steady and transient infiltration rates infiltration flux and head distribution below unclogged stream were analytically simulated by cheng et al 2021a they redefined the criteria for different state of hydraulic connection between the ephemeral stream and the underlying aquifer the previous studies of the groundwater mound due to the predefined constant recharge from the ephemeral stream considered a one liu et al 2019 cheng et al 2021a or two dimensional aquifer with a straight infinite length stream that fully penetrates the aquifer cuthbert et al 2016 these works cannot be utilized to predict the groundwater mound due to the recharge from an arbitrary shape ephemeral stream in aerial view furthermore they cannot be used to estimate groundwater recharge from an ephemeral stream utilizing the groundwater head monitoring data therefore the goal of this paper is to present a transient three dimensional 3 d semi analytical model of groundwater mound due to recharge from an ephemeral stream of arbitrary geometric shape in aerial view to obtain the semi analytical solution the 3 d groundwater flow governing equation with a point recharge at the water table is dealt with first using the fourier and laplace transforms the stream is approximated by several straight segments and the point recharge solution is integrated along these segments by replacing the parameteric counterpart of the x and y coordinates the groundwater mound due to the ephemeral stream is the superposition of groundwater mound due to each segment a uniform constant head variable discharge well is also considered near the ephemeral stream using the principle of superposition the depletion volume of this well due to the recharge from the ephemeral stream can be used to estimate the sustainable yield of a production well near the stream at the same location while the sustainable yield is defined as the average discharge of a constant head well as compared to an equivalent constant flux well baiocchi et al 2014 piscopo and summa 2007 we present the groundwater mound time curves the groundwater mound spatial map the scaled sensitivity time curve and the depletion volume time curve to illustrate their depenence on the controlling aquifer parameters the presented model can be used to evaluate the groundwater mound due to recharge from an stream of an arbitrary shape in aerial view to estimate the recharge to water table using the groundwater mound monitoring data to calculate the water budget in unconfined aquifers of arid regions to determine the sustainable yield of the pumping wells near ephemeral streams in arid regions among other applications 2 conceptual model 2 1 problem statement the conceptual model of an unconfined aquifer with an arbitrary shape stream in aerial view in a semi arid or arid region is shown in fig 1 the horizontal initial water table is considered the temporary recharge from the ephemeral stream however creates a groundwater mound in the aquifer the origin of the coordinate system is located at the base of the unconfined aquifer at its lateral boundary which separates the mountain bedrock from the unconfined aquifer and is approximated as a no flow boundary for groundwater flow the x axis is perpendicular to the mountain bedrock aquifer boundary and points away from the mountain the y axis is along the mountain bedrock aquifer boundary the z axis is positive upward the ephemeral stream starts at the mountain bedrock aquifer boundary and flows along a meandering channel away from the mountain the stream width is regarded as much smaller than the scale of concern here so the stream is approximated as a meandering linear curve in the mathematical model that will be represented later the meandering ephemeral stream channel is approximated with a series of connected straight linear segments the depth of the unconfined aquifer is d and it has infinite horizontal extent in this work first the groundwater mound due to a point recharge is obtained then the line recharge solution is obtained from the point recharge solution by integrating along the stream channel in the horizontal direction finally the solution for the stream is acquired utilizing the principle of superposition the following assumptions are considered in this work 1 the homogeneous anisotropic unconfined aquifer with uniform thickness and semi infinite extent is considred 2 the recharge from the stream is imposed on the water table and it is different from the infiltration rate from the stream 3 the zero width finite length stream is considered the spatial variations of recharge can be simulated by segmentation of the stream in which the recharge of each segment is different from the other segments the 3 d governing equation of flow in the homogeneous anisotropic unconfined aquifer is malama et al 2007 moench 1993 neuman 1974 zhan and zlotnik 2002 1 k h 2 h x 2 k h 2 h y 2 k z 2 h z 2 s s h t 0 where h is hydraulic head mound l x and y are the two horizontal coordinates and z is the vertical coordinate l t is time t kh and kz are the horizontal and vertical hydraulic conductivities lt 1 respectively and the same hydraulic conductivity kh is used for both the x and y directions to simulate a horizontally isotropic system ss is specific storage l 1 eq 1 is the mass balance statement of a representative element volume rev considering darcian groundwater flux and release of groundwater from storage due to elastic compressibilities of aquifer and water the release of water from the free surface water table drainage is treated as the upper boundary condition when discussing the 3 d flow in an unconfined aquifer as in presented work both the specific storage which is included in the governing equation and the specific yield which is included in the upper boundary condition affect the drawdown fetter 2000 kruseman et al 1994 malama 2011 moench 1993 1994 1995 moench 1996 neuman 1974 todd and mays 2005 zhan and zlotnik 2002 the 2 d bousinessq s equation is not used in this work thus common assumptions of a 2 d boussinesq equation and ignoring specific storage do not apply here in fact the influence of the specific storage of the body of an unconfined aquifer is not significant in case of a shallow source sink in a three dimensional 3d unconfined aquifer underneath an ephemeral stream as it will be overshadowed by the influence of the gravity drainage effect quickly after the start of pumping which is manifested by the specific yield that is usually much greater than the storage effect to estimate sustainable yield of a deep well in a thick unconfined aquifer sections 3 5 however the specific storage effect cannot be neglected because the supply of water into such a deep well during the initial stage of pumping primarily comes from the elastic release of water from the storage near the wellbore i e the effect of specific storage rather than from the gravity drainage at the water table i e the effect of the specific yield when time gets longer then the release of water from the gravity drainage at the water table may start to contribute more to the well yield and finally when time becomes sufficiently long or the so called quasi steady state pumping the gravity drainage at the water table may eventually over shallow the influence of specific storage and becomes the dominating mechanism of supplying water to the well yield as in our work we calculate both the groundwater mound and sustainable yield of the pumping well the specific storage of the aquifer cannot be neglected as the well that we are about to estimate its sustainable yield may be deep the initial condition is 2 h x y z 0 0 the zero head boundary conditions are considered for the far distances as 3 h x y z t x 0 h x y z t y 0 a point to note is that the no flow boundary at the mountain bedrock aquifer interface the y axis will be dealt with using the image well method so the aquifer concerned in eq 3 extends to infinity laterally the areal recharge is imposed at the water table thus the linearized free surface boundary condition is approximated as sedghi and zhan 2019 zlotnik and ledder 1993 dagan 1967 polubarinova kochina 1962 4 k z h z z d s y h t z d r t δ x x 0 δ y y 0 where sy is the specific yield r t is the time dependent volumetric recharge imposed on the water table l3t 1 at x 0 y 0 and is positive d is the aquifer initial thickness l δ is the dirac delta function l 1 it should be noted that the groundwater head variation is assumed to be much less that the aquifer thickness thus the upper boundary condition eq 4 is set at the initial aquifer thickness d the volumetric recharge can be estimated utilizing different hydrological methods for example it can be estimated by the stream reach water balance method if there are gaging stations in different parts of the ephemeral stream the difference of the volumetric stream flow of the ephemeral stream in two stations is the volumetric infiltration from the stream between them if evaporation from the stream is negligible during the time duration of concern the estimated volumetric infiltration is the upper bound of recharge to the water table and can be used to estimate the volumetric recharge if a relationship can be established between the infiltration rate below the streambed and the recharge rate at the water table such an infiltration recharge relationship is not always easy to be established because the dynamic unsaturated zone flow process between the streambed and the water table could be highly nonliear and complex one of the most important application of the presented work is to estimate the volumetric recharge from an ephemeral stream to an aquifer by using the groundwater mound data not based on the infiltration data the no flow boundary condition at the bottom of the aquifer is 5 h z z 0 0 the solution to the dimensionless counterpart of eq 1 with respect to the initial and boundary conditions of eqs 2 5 is obtained utilizing fourier and laplace transforms the detail of derivation is presented in appendix the groundwater mound due to the volumetric point recharge at the water table is 6 h d p r d p 2 π 0 cosh λ z d σ λ sinh λ p cosh λ ω j 0 ω r d d ω where the overbar means the term in laplace domain the subscript d denotes the dimensionless terms which are defined in table 1 p is the laplace transform parameter in respect to the dimensionless time td σ is a term related to the ratio of specific storage and specific yield defined in table 1 j 0 is the first kind zero order bessel function sinh and cosh are the hyperbolic functions and 7 λ p ω 2 8 r d x d x 0 d 2 y d y 0 d 2 where x0d and y0d are respectively the dimensionless x and y coordinates of the point source and ω is a dummy variable of integration to obtain the groundwater mound due to a linear recharge source at the water table along the desired direction one should define x 0d and y 0d as a function of ld as 9 x 0 d l d cos α 10 y 0 d l d sin α where α is the angle between the stream and positive x direction and ld is the dimensionless length along the stream it is noted that the width of stream is assumed to be much smaller than the aquifer thickness here so the stream is approximated as an arbitrary line source following the stream flow direction this assumption is acceptable for many ephemeral streams which are often very narrow with limited widths as compared to the scale of interest of the concerned problem cheng et al 2021a if the stream width is comparable with the aquifer thickness then the stream should be approximately as an areal source rather than the linear source the solution for an areal source can be obtained straightforwardly by double integrating the point source solution along the stream flow direction and the direction perpendicular to the stream flow over the entire width of stream nevertheless in this study we treat the narrow ephemeral stream as a linear source and the solution can be obtained by integrating the point source solution along the stream flow direction only eq 6 can be utilized to obtain the groundwater mound due to recharge from a linear stream as h e d p r d p 2 π 0 l d 0 cosh λ z d σ λ sinh λ p cosh λ 11 ω j 0 ω x d x s d l d cos α 2 y d y s d l d sin α 2 d ω d l d where xsd and ysd are the dimensionless x and y coordinates of the starting point of the stream and ld is the dimensionless total length of the stream considering the following no flow boundary along the y axis 12 h d p x d x d 0 0 the image well method can be utilized to modify eq 11 as h e d p r d p 2 π 0 l d 0 cosh λ z d σ λ sinh λ p cosh λ 13 ω j 0 ω x d x s d l d cos α 2 y d y s d l d sin α 2 j 0 ω x d x s d l d cos α 2 y d y s d l d sin α 2 d ω d l d considering the principle of superposition the groundwater mound due to stream recharge can be approximated by linear segments as 14 h e d p j 1 n r d j p 2 π 0 l d j 0 cosh λ z d σ λ sinh λ p cosh λ ω j 0 ω x d x s d l d cos α j 2 y d y s d l d sin α j 2 j 0 ω x d x s d l d cos α j 2 y d y s d l d sin α j 2 d ω d l d where the subscript j represent the jth stream segment and all parameters with subscript j are belonging to that segment it should be noted that the starting point of each segment e g xsd and ysd should be set to the ending point of its previous segment eq 14 can be extended to calculate groundwater mound due to multiple streams or multiple branches of stream of arbitrary shapes 3 results and discussion 3 1 verification with modflow to check the proposed solution with the finite difference numerical model of modflow a straight ephemeral stream of 1000 m length is considered to reduce the number of the numerical model cells and therefore computational time the stream starts from x 0 y 0 and ends at the point x 1000 m and y 0 an impermeable boundary is considered along the y axis at x 0 the 0 1 m wide cells are considered at the stream the cells with the width of 0 0005 m δy 0 0005 m are considered adjacent to the stream the cell size δy increases with an expansion factor of 1 2 away from the stream as suggested by barrash and dougherty 1997 the total model rows are 80 and total model columns are 25 the initial aquifer thickness is 10 m and is discretized uniformly to 10 layers the horizontal and vertical hydraulic conductivities are set to be 0 0001 ms 1 if needed a vertical anisotropy can be introduced to simulate a smaller vertical hydraulic conductivity in respect to the horizontal hydraulic conductivity the specific storage and the specific yield of the aquifer are set to 4 10 5 m 1 and 0 3 respectively two stress periods are considered stress period 1 is for the recharge period and stress period 2 is for the time after the recharge is ended the stress length of the stress period 1 is 30 days and it is discretized into 100 time steps with a temporal expansion factor of 1 2 the length of the stress period 2 is 370 days this stress period is also discretized into 100 time steps again with a temporal expansion factor of 1 2 as suggested by barrash and dougherty 1997 it should be noted that increasing the spatial resolution of the modflow model grid and increasing the time steps significantly increases the computational time without increasing the accuracy of the model results three observation wells are considered at the x 500 m and y 5 m y 50 m and y 100 m to show the influences of distance from the stream and to check the validity of the proposed solution at different distances from the stream the volumetric recharge at the rate of 0 006 m3s 1 is considered at the stream this amount of water is equivalent to discharge of a losing stream with the catchment area of 1 km 2 and a runoff elevation of 15 mm during a month the following function is considered to simulate the recharge to the water table 15 r t r 0 h t t 0 h t t 1 where r 0 is the constant recharge of 0 006 m3s 1 t 0 is the starting time of recharge 0 day and t 1 is ending time of recharge 30 days this corresponds to the recharge from a temporary stream in an arid region the dimensionless laplace domain counterpart of eq 15 is 16 r d p r 0 d p exp t d 0 p exp t d 1 p where t d0 t d1 are respectively the dimensionless counterparts of t 0 t 1that are defined in the same fashion as td in table 1 eq 16 is used as a recharge function in eq 14 it should be noted that the recharge is an arbitrary function of time here we use the heaviside step function to simulate recharge as an illustrative example for complex recharge variations piecewise linear functions may be utilized for laplace transforms of piece wise linear functions the reader may consult the following papers roumboutsos and stewart 1988 ahmadi et al 2017 default hydraulic parameters that are given in table 2 are used to calculate groundwater mound the results of modflow simulation are compared to that of the proposed semi analytical model fig 2 this figure shows acceptable agreement of numerical simulation to that of the proposed semi analytical model for the observation point at y 5 m however the proposed model with numerical inverse laplace algorithm of stehfest 1970 could not simulate the peak of groundwater mound accurately the de hoog et al 1982 algorithm however satisfactorily simulates this the stehfest 1970 algorithm is suggested for the observation points that are not close to the stream as it is computationally faster than the de hoog et al 1982 method the computational time becomes an important issue when the number of segments increases and or when the model is coupled to a parameter estimation code that needs many calls of forward model figure inspection also reveals that the groundwater mound is significantly attenuated about 100 m away from the stream that is why most production wells are constructed near ephemeral streams in arid regions fig 3 3 2 arbitrary recharge function utilizing the presented solution one can explore the influences of an arbitrary and time dependent recharge on the groundwater mound to illustrate this the following function is considered to simulate the recharge to the water table 17 r t r 0 h t t 0 h t t 1 r 1 h t t 2 h t t 3 where r 0 0 006 m3s 1 that is due to a runoff elevation of 0 01 m in 30 days in a catchment with an area of about 1 55 km2 t 0 is the starting time of recharge 0 day t 1 is the ending time of recharge 30 day r 1 0 009 m3s 1 that is due to a runoff elevation of 0 005 m in 10 days in a catchment with area of about 1 55 km2 with the starting time t 2 of 100 days and the ending time t 3 of 110 days the dimensionless laplace domain counterpart of eq 17 is 18 r d p r 0 d p exp t d 0 p exp t d 1 p r 1 d p exp t d 2 p exp t d 3 p where t d0 t d1 t d3 t d4 r 0d r 1d are respectively the dimensionless counterparts of t 0 t 1 t 3 t 4 r 0 r 1 that are defined in the same fashion as rd and td in table 1 eq 18 is used as a recharge function in eq 14 the influences of this recharge function on groundwater mound at three observation wells 50 100 and 150 m away from the stream are tested the other parameters are set to default values that are given in table 2 the results are illustrated in fig 7 attenuation of the groundwater mound due to recharge is evident in fig 7 3 3 spatial distribution of groundwater mound fig 4 illustrates the influences of recharge from the ephemeral stream of an arbitrary shape on the groundwater mound five stream segments of 1000 m length are considered the recharges from these segments are 0 006 m3s 1 0 005 m3s 1 0 004 m3s 1 0 003 m3s 1 0 002 m3s 1 respectively recharges start at the day 0 and end at the day 30 the spatial recharge distribution is calculated at the days 30 fig 4a and 60 fig 4b it is evident from these figures that the groundwater mound follows the shape of the stream and spreads spatially from the stream over time comparing fig 4a and 4b furthermore the groundwater mound is higher inside the convex part of the stream due to or positive feedback of neighboring parts of the stream the difference of the groundwater mounds between fig 4a and b is calculated and illustrated in fig 4c this figure shows that the groundwater mound decreases at the stream at the time of 60 days 30 days after the end of recharge due to cease of recharge the groundwater mound however increases at the certain distance from the stream as the groundwater mound of the recharge period spreads there it should be noted that the groundwater mound peak is always under the stream the figure also shows that the groundwater mound due to recharge is significantly attenuated away from the stream that is why most production wells are constructed near the ephemeral streams as discussed before 3 4 sensitivity analysis one of the most important applications of the presented solution is to calculate the groundwater recharge from an ephemeral stream using the groundwater head data to show the influences of aquifer parameters on the sensitivity of the groundwater head data to the recharge from the ephemeral stream scaled sensitivity time curves in this section are presented such curves are prepared using the following equation kabala 2001 huang and yeh 2007 19 s p i o p i p i o p i o p i δ p i δ p i p i where spi is the scaled sensitivity of the groundwater head to the recharge from the stream l o is the model output that is the groundwater mound in this work pi is the ith parameter that is the recharge in this work and δpi is the parameter increment that is 10 3 pi huang and yeh 2007 the effects of hydraulic parameters on the scaled sensitivity of the head to the recharge from the stream are explored in this section in fig 5 we demonstrate the effects of distance from the stream on the sensitivity of the groundwater head to the recharge from the stream this figure reveals that increasing the distance from the stream decreases the scaled sensitivity of the groundwater head to the recharge from the stream therefore for accurate estimate of recharge from the stream to the aquifer the observation well should be close to the stream fig 6 illustrates the influences of the horizontal hydraulic conductivity on the sensitivity of the groundwater head to the recharge from the stream this figure illustrates that the sensitivity of the dimensionless head to the recharge increases during the recharge period the sensitivity curve sees its maximum at the end of the recharge period this shows that the groundwater head data at the end of the recharge period are most valuable to estimate the recharge from the ephemeral stream the figure also reveals that increasing the horizontal hydraulic conductivity decreases the sensitivity of the groundwater head to the recharge thus the groundwater heads collected from an observation well in a fine grained aquifer are more valuable to estimate the recharge from the ephemeral stream vertical hydraulic conductivity does not significantly affect the sensitivity of the groundwater head to the recharge from the stream and the associated figure is not shown in the paper fig 7 tests the influences of the specific yield on the sensitivity of the groundwater head to the recharge from the stream the same temporal change of the sensitivity of the head to the recharge from the aquifer is seen increasing the specific yield of the aquifer decreases the sensitivity of head to the recharge in fact decreasing the specific yield increases the groundwater mound due to the recharge of specified volumetric rate from the stream this is because a lower specific yield means a smaller effective porosity in the aquifer therefore a lower volumetric recharge is needed to fill a unit volume of aquifer or putting it in another way for a specified volumetric recharge a larger volume of aquifer will be filled by water that in turn increases the groundwater mound to sum up the buffering effects of the specific yield attenuates the variation of head due to recharge as the specific yield decreases by decreasing the grain size of aquifers groundwater head data collected from a fine grain aquifer are more valuable to estimate the recharge from the ephemeral stream 3 5 sustainable yield one of the most important applications of the presented model is to calculate the sustainable yield of the single pumping well near an ephemeral stream as stated by baiocchi et al 2014 and piscopo and summa 2007 the sustainable yield of a single pumping well can be determined by setting a constant head pumping well and calculate its discharge variation due to the recharge the average discharge of a constant head well is defined as the sustainable yield of an equivalent constant flux well in this section the same idea is adopted to calculate the sustainable yield of a pumping well near an ephemeral stream that is crucial in arid regions the detailed derivation of the sustainable yield is presented in the appendix b to obtain the sustainable yield the following matrix should be solved 20 f w 1 1 f w 1 2 f w 1 n f w 2 1 f w 2 2 f w 2 n f w n 1 f w n 2 f w n n q w 1 d p q w 2 d p q w n d p s w c d p f r 1 s w c d p f r 2 s w c d p f r n where the f wk l term calculates the drawdown in well segment k created by flow into well segment l from the aquifer the f wk l term can be calculated as f w k l 1 2 π n 1 cos ω n z w k d z w k 1 d 2 0 25 0 5 sin 2 ω n ω n s i n z w l d s i n z w l 1 d ω n z w l 1 d z w l d 21 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 and frk is calculated as 22 f r k j 1 n r d j p 2 π 0 l d j 0 cosh λ z w k d z w k 1 d 2 σ λ sinh λ p cosh λ ω j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 d ω d l d one can calculate the total discharge of a constant head well due to the recharge from the ephemeral stream as the summation of the discharges of all segments 23 q w d p i 1 n q w i d p the following equation can be used to calculate the cumulative depletion volume of the constant head well due to recharge from the ephemeral stream as stated before baiocchi et al 2014 piscopo and summa 2007 this can be utilized to estimate the sustainable volume of the constant flux well in the location of the constant head well 24 v t d 0 t d q w d τ d τ where v is the cumulative well depletion volume l3 the laplace domain counterpart of eq 24 is 25 v p 1 p q w p k h d 2 p q w d p in this section the influences of the distance of the well from the stream and effects of the hydraulic parameters of the aquifer on the depletion volume of the constant head well that can be used to estimate the sustainable yield of the well are investigated default parameter values given in table 2 are used to calculate the depletion volume of the well the volumetric depletion volume of the constant head well dv hereafter due to the recharge from the stream is calculated using eq 25 and by eliminating s w c d p from eq 20 the depletion volume dv of the well should be divided by the pumping period to estimate the sustainable yield fig 8 shows the influences of the distance from the stream on dv this figure shows that increasing the distance from the stream decreases dv thus the production well near the ephemeral stream can extract more water from the aquifer without adverse effects on the aquifer it should be noted that the red arrows in the figure show the cumulative dv for a one year 365 days period fig 9 shows the effects of the horizontal hydraulic conductivity of the aquifer on dv the figure reveals that increasing the horizontal hydraulic conductivity will increase dv after long time from the recharge increasing the horizontal hydraulic conductivity by three orders of magnitude will increase dv five times therefore production wells in a coarse grain aquifer have a higher sustainable yield fig 10 illustrates the influences of the vertical hydraulic conductivity of the aquifer on dv the figure shows that increasing the vertical hydraulic conductivity increases dv increasing the vertical hydraulic conductivity by three orders of magnitude increases dv more than 100 times as layering of the aquifer decreases the equivalent vertical hydraulic conductivity the sustainable yield of the production well in a layered alluvial aquifer will be significantly suppressed fig 11 depicts the influences of the specific yield of the aquifer on dv as shown in the figure increasing the specific yield decreases dv this is due to the fact that with a lower specific yield the groundwater mound due to the recharge decreases and this reduces the discharge of the constant head well overall the sustainable yield of a production well in an alluvial aquifer near an ephemeral stream is maximum near the stream in a coarse grain non layered aquifer it should be noted that the sustainable yield can be calculated for multiple production wells utilizing the principle of superposition along with eqs 20 and 25 4 limitations of developed solutions the developed solutions have several limitations that should be noted in applications methods of relaxing these limitations are also briefly explained 1 the recharge is imposed on the water table this is different from the infiltration from the stream the functional relation between infiltration from the stream and recharge to the water table it is not presented in this paper may be employed to extend the presented solution to calculate the groundwater mound due to infiltration from the ephemeral stream 2 the presented model considers an arbitrarily prescribed recharge to simulate the groundwater mound the recharge rate from the stream may be dependent on the groundwater head when the depth of the groundwater is low for this case the proposed model can simulate the groundwater mound through an iterative procedure that is one assumes an initial recharge and then the proposed model simulates the groundwater head if the groundwater head is higher than the predefined threshold as described in cheng et al 2021a the recharge rate will be modified using appropriate models of cheng et al 2021a and cheng et al 2021b and the proposed model is employed to recalculate the groundwater mound using the modified recharge this iterative procedure can calculate both the groundwater mound and recharge from the ephemeral stream 3 the volumetric recharge is uniform in each stream segment to fine tune the spatial distribution of the volumetric recharge from the stream one should decrease the size of each stream segment with different recharge which in turn increase the computational time 4 the aquifer is considered to be semi infinite that is bounded by an impermeable boundary this boundary condition is simulated using the image well method before its integration the solution can be extended for the cases of strip shaped and rectangular aquifers using the image well method 5 the solution is presented in laplace space analytical inversion of the solution to time domain is possible using the residue theorem and convolutional integral the numerical laplace inversion however is computationally faster than the time domain solution in our case this is due to the slow convergence of the series arising from the residue theorem and numerical integration of the convolutional integral furthermore the laplace domain solution is more appropriate for the further development of this work 5 summary and conclusions the 3 d solution of groundwater mound in an unconfined anisotropic aquifer due to the recharge from the ephemeral stream of an arbitrary shape to the water table is presented the arbitrary spatiotemporal recharge of prescribed flux is considered the following results are drawn from this work 1 the groundwater mound due to the recharge from the stream is significantly attenuated away from the stream that is why most of the production wells are near the ephemeral streams wadis in arid and semi arid regions of the world the groundwater mound follows the shape of the stream and spreads spatially from the stream over time for the case of the stream with an arbitrary shape the groundwater mound is higher inside the convex part of the stream due to the positive feedback of the mound of the neighboring parts of stream 2 for accurate estimation of the recharge from stream to aquifer using the groundwater mound data the observation well should be close to the stream less than 100 m the groundwater head data at the end of the recharge period are most valuable to estimate the recharge from the ephemeral stream 3 as fine grain aquifer has a lower horizontal hydraulic conductivity and a smaller specific yield the groundwater head collected from an observation well in such an aquifer is more valuable to estimate the recharge from the ephemeral stream 4 the sustainable yield of a production well in an alluvial aquifer near an ephemeral stream is maximum near the stream in a coarse grain non layered aquifer this is due to the fact that such a type of aquifer usually has higher horizontal and vertical hydraulic conductivities than the layered aquifers made of coarse and fine materials credit authorship contribution statement mohammad m sedghi conceptualization methodology software writing original draft hongbin zhan supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment we would like to express our sincere thanks to dr anvar kacimov and an anonymous reviewer for their valuable comments and corrections the first author wishes to thank the payame noor university for financial support appendix a derivation of solutions in laplace domain the following laplace transform a1 f p f t e p t d t is used to obtain the dimensionless laplace space counterpart of eq 1 as a2 2 h d x d 2 2 h d y d 2 2 h d z d 2 p h d 0 where the overbar means the term in laplace domain the far distances boundary condition is a3 h d x d y d z d p x d 0 h d x d y d z d p y d 0 the boundary condition at the water table is a4 σ h d z d z d 1 p h d r d p δ x d x 0 d δ y d y 0 d the no flow boundary condition at the bottom of the aquifer is a5 h d z d z d 0 0 the following double fourier transformations with respect to x and y a6 f ω 1 ω 2 1 2 π f x y e i ω 1 x e i ω 2 y d x d y is imposed on eqs a2 a4 and a5 considering boundary conditions of eq a3 as a7 2 h d z d 2 p ω 1 2 ω 2 2 h d 0 a8 σ h d z d z d 1 p h d r d p 2 π exp i ω 1 x 0 d exp i ω 2 y 0 d a9 h d z d z d 0 0 where the double dots above the variable indicate a term in frequency domain after double fourier transforms ω1 and ω2 are frequencies related to fourier transforms in respect to the x and y coordinates respectively the solution to eq a7 with respect to boundary conditions of eqs a8 and a9 is a10 h d r d p 2 π cosh z d p ω 1 2 ω 2 2 exp i ω 1 x 0 d exp i ω 2 y 0 d σ p ω 1 2 ω 2 2 sinh z d p ω 1 2 ω 2 2 p cosh z d p ω 1 2 ω 2 2 taking the inverse double fourier transform of eqs a10 and 6 is obtained as a11 h d r d p 4 π 2 cosh z d p ω 1 2 ω 2 2 σ p ω 1 2 ω 2 2 sinh z d p ω 1 2 ω 2 2 p cosh z d p ω 1 2 ω 2 2 exp i ω 1 x d x 0 d exp i ω 2 y d y 0 d ω 1 ω 2 as the double fourier transform of a circular symmetric function is equivalent to hankel transform of zero order jeffrey and zwillinger 2007 lu et al 2018 as a12 1 2 π f ω 1 ω 2 exp i ω 1 x d x 0 d exp i ω 2 y d y 0 d ω 1 ω 2 0 f ω ω j 0 ω r d ω where a13 ω ω 1 2 ω 2 2 a14 r d x d x 0 d 2 y d y 0 d 2 therefore replacing ω 1 2 ω 2 2 by ω2 and using the identity of eq a10 one obtains the following equation from eq a9 a15 h d r d p 2 π 0 cosh z d p ω 2 σ p ω 2 sinh z d p ω 2 p cosh z d p ω 2 ω j 0 ω r d ω using the definition of λ that is p ω2 table 1 eq 6 is obtained from eq a153 appendix b calculation of sustainable yield to calculate the sustainable yield the following steps are adopted 1 adding a specified flux partially penetrating well near the ephemeral stream the specified flux point source solution in laplace domain in an unconfined aquifer is sedghi and zhan 2020 zhan and zlotnik 2002 b1 s w d q w d p 2 π n 1 cos ω n z d cos ω n z w d 0 25 0 5 sin 2 ω n ω n k 0 p ω n 2 x d x w d 2 y d y w d 2 where s w d is the drawdown in laplace domain at the point with dimensionless coordinates of xwd ywd zwd due to the pumping from the well with the dimensionless discharge of q w d p k0 is the modified bessel function the 2nd kind zero order wn is the solution to the following equation b2 ω n sin ω n p σ cos ω n 0 where σ is the parameter defined in table 1 integrating the point source solution with respect to zwd from z w1d to z w2d one obtains the averaged drawdown in laplace domain due to the partially penetrating specified flux well as s w l d 1 z w 2 d z w 1 d z w 1 d z w 2 d s w d d z w d q w d p 2 π z w 2 d z w 1 d n 1 cos ω n z d 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 2 d ω n b3 k 0 p ω n 2 x d x w d 2 y d y w d 2 it should be noted that this equivalent specified flux well is used to calculate the discharge variation of the constant head well through the following steps 1 calculate the sum of drawdown due to the specified flux well eq b3 and the groundwater drawdown negative mound of eq 14 as s d q w d p 2 π z w 2 d z w 1 d n 1 cos ω n z d 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x d x w d 2 y d y w d 2 b4 j 1 n r d j p 2 π 0 l d j 0 cosh λ z d σ λ sinh λ p cosh λ ω j 0 ω x d x s d l d cos α 2 y d y s d l d sin α 2 d ω d l d where s d is the laplace domain dimensionless drawdown due to the pumping from the specified flux well and recharge from the stream it should be noted that the minus sign before the recharge is due to the fact that the groundwater mound is negative drawdown 1 setting the constant drawdown condition on the screen of the pumping well to change it to an equivalent variable flux well s w c d p q w d p 2 π z w 2 d z w 1 d n 1 cos ω n z w 1 d z w 2 d 2 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x c d x w d 2 y c d y w d 2 b5 j 1 n r d j p 2 π 0 l d j 0 cosh λ z w 1 d z w 2 d 2 σ λ sinh λ p cosh λ ω j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 d ω d l d where s w c d is the constant drawdown at the variable discharge well x c d y c d z w 1 d z w 2 d 2 is the coordinate of the constant drawdown point on the well screen the image well method is employed to simulate an impermeable boundary along the y axis eq 5 as s w c d p q w d p 2 π z w 2 d z w 1 d n 1 cos ω n z w 1 d z w 2 d 2 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x c d x w d 2 y c d y w d 2 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 b6 j 1 n r d j p 2 π 0 l d j 0 cosh λ z w 1 d z w 2 d 2 σ λ sinh λ p cosh λ ω j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 d ω d l d since the discharge strength is nonuniform over the screen of the constant drawdown well the screen of the constant drawdown well is segmented into n parts where the number of n should be sufficiently large to make the final discharge distribution over the well screen independent of n or much less sensitive to n for the problem concerned here our computational exercises show that n 16 is sufficient eq b6 above is applied to each segment with the constant drawdown point at the center of each segment on the well screen and eventually the discharge rate over each well screen segment can be determined for instance consider segment 1 as the discharge of all segments affects the drawdown at the constant head point of segment 1 xd yd zd the following equation holds obtained from eq b6 b7 q w 1 d p f w x w d y w d z w 1 d z w 2 d x c d y c d z w 1 d z w 2 d 2 q w 2 d p f w x w d y w d z w 2 d z w 3 d x c d y c d z w 1 d z w 2 d 2 q w n d p f w x w d y w d z w n d z w n 1 d x c d y c d z w 1 d z w 2 d 2 s w c d p f r x c d y c d z w 1 d z w 2 d 2 where qw1d qw2d qwnd are the dimensionless discharges for the 1st 2nd and nth segments respectively and b8 f w x w d y w d z w 1 d z w 2 d x c d y c d z w 1 d z w 2 d 2 1 2 π z w 2 d z w 1 d n 1 cos ω n z w 1 d z w 2 d 2 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x c d x w d 2 y c d y w d 2 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 b9 f w x w d y w d z w 1 d z w 2 d x c d y c d z w 1 d z w 2 d 2 1 2 π z w 2 d z w 1 d n 1 cos ω n z w 1 d z w 2 d 2 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x c d x w d 2 y c d y w d 2 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 eq b7 must be written for all segments and solved for discharge of each segment simultaneously utilizing the matrix of eq 20 
41,recharge from ephemeral streams called masil in farsi and wadi in arabic is the main process of groundwater recharge in arid regions of the world where groundwater is the most important source of water supply despite advances in mathematical models of simulating infiltration from these streams there is no versatile analytical model to simulate the groundwater mound due to recharge from an ephemeral stream the goal of this paper is to present a semi analytical model of the groundwater mound due to recharge from an ephemeral stream of an arbitrary geometric shape in aerial view a three dimensional anisotropic unconfined aquifer is considered and a point recharge is imposed to the water table at first the point recharge solution is obtained via the laplace and fourier transforms the image well method is employed to incorporate the lateral no flow boundary that represents the margin of the unconfined aquifer the point recharge solution is then extended to simulate the groundwater mound due to recharge from the stream of an arbitrary shape by approximating the stream by multiple straight segments and integration of the point recharge solution along the desired directions of those segments and the principle of superposition a constant head variable discharge well is also placed near the stream to calculate the sustainable yield which is the average discharge of a constant head well as compared to an equivalent constant flux well the results of this work are presented in the form of groundwater mound time curve and groundwater mound spatial maps the scaled sensitivity of groundwater head to recharge from the stream time curves and depletion volume of the nearby well time curve are also obtained the influences of aquifer parameters on the groundwater mound and sustainable development of the aquifer near the ephemeral stream are analyzed this study shows that 1 groundwater mound follows the shape of the stream and spreads spatially from the stream over time and the groundwater mound is higher inside the convex part of the stream due to interference from the neighboring stream segments 2 the groundwater head collected from an observation well in a fine grain aquifer is more valuable to estimate the recharge from the ephemeral stream than a coarse grain aquifer 3 the sustainable yield of a production well in an alluvial aquifer is maximum near the stream in a coarse grain non layered aquifer than the coarse or fine grain layered aquifer the results of this work can be utilized as a valuable tool for managing the unconfined aquifers in the arid and semi arid regions when ephemeral streams are the primary sources of recharge keywords wadi semi analytical solution groundwater mound unconfined aquifer ephemeral streams data availability no data was used for the research described in the article nomenclature kh horizontal hydraulic conductivity lt 1 kz vertical hydraulic conductivity lt 1 ss specific storage l 1 h groundwater mound l x x coordinate of the observation point l y y coordinate of the observation point l z z coordinate of the observation point l x 0 x coordinate of the source sink point l y 0 y coordinate of the source sink point l xs x coordinate of the starting point of the stream segment l ys y coordinate of the starting point of the stream segment l sy specific yield spi scaled sensitivity of the groundwater head to parameter pi r t time varying volumetric recharge l3t 1 j 0 bessel function of first kind and zero order xd dimensionless x coordinate of the observation point yd dimensionless y coordinate of the observation point zd dimensionless z coordinate of the observation point x 0d dimensionless x coordinate of the source sink point y 0d dimensionless y coordinate of the source sink point xsd dimensionless x coordinate of the starting point of the stream segment ysd dimensionless y coordinate of the starting point of the stream segment σ dimensionless parameter h d dimensionless laplace domain groundwater mound due to point recharge h e d dimensionless laplace domain groundwater mound due to ephemeral stream r p dimensionless laplace domain recharge s d dimensionless laplace domain drawdown ld dimensionless length of stream h t heaviside unit step function r 0d constant recharge applied to the water table δ x dirac delta function l 1 ω1 fourier transform variable ω2 fourier transform variable 1 introduction groundwater recharge from ephemeral streams such as masil in farsi and wadi in arabic is the primary type of recharge in many arid and semi arid regions of the world dassi 2010 matter et al 2006 rizk et al 2007 subyani 2004 sultan et al 2000 villeneuve et al 2015 wang et al 2017 yangui et al 2011 these areas represent about 35 of the global landmass with about 2 billion people living there cuthbert et al 2016 hassan et al 2005 thus construction of recharge dams on ephemeral streams is quite common in arid regions to enhance groundwater recharge alataway and el alfy 2019 alderwish 2010 de laat and nonner 2012 missimer et al 2015 prathapar and bawain 2014 mathematical models considering the aquifer stream interaction may be used to simulate the groundwater head due to recharge from streams including ephemeral ones hobson 1887 mcmahon and nathan 2021 zlotnik et al 2017 generally streams that are connected to the aquifer are simulated as specified head boundaries barlow et al 2000 intaraprasong and zhan 2009 lin et al 2018 moench and barlow 2000 samani and sedghi 2015 sedghi and zhan 2016 2019 for a stream that is not connected to the aquifer there is an unsaturated zone separating the stream from the aquifer which is usually the case for ephemeral streams and this system may be simulated by using the specified flux boundaries abdulrazzak and morel seytoux 1983 cuthbert 2010 cuthbert et al 2016 dillon and liggett 1983 liu et al 2019 sorman et al 1997 or using more sophificated models specially designed for dealing with the disconnected rivers cheng et al 2021a 2021b abdulrazzak and morel seytoux 1983 presented an approximate analytical solution to predict the time varying recharge rate from an ephemeral stream their solution is applicable after the wetting front reaches the water table dillon and liggett 1983 presented a model to predict the recharge from an ephemeral stream with a clogged streambed for the case in which the stream is hydraulically connected disconnected or transitional between these two cases they utilized the green ampt equation for the disconnected state sorman et al 1997 used a numerical model to simulate the groundwater head rise due to recharge from an ephemeral stream in wadi tabalah saudi arabia cuthbert et al 2016 obtained a two dimensional 2 d analytical solution of the hydraulic head due to recharge from an ephemeral stream the lateral boundary was considered as no flow to simulate the alluvial plain margin and constant head to simulate the downstream wetlands the recharge from the ephemeral river was applied to the whole aquifer thickness one dimensional 1 d boussinesq equation was used by liu et al 2019 to simulate groundwater level fluctuation due to recharge from an ephemeral stream they showed that their model simulated the short time groundwater level fluctuation successfully utilizing groundwater level data near the ephemeral stream their model however could not simulate the multi year groundwater level fluctuations cheng et al 2021b investigated the evolution of the inverted saturated zone below an ephemeral stream the model presented by cheng et al 2021b can also be utilized to predict the head distribution below an ephemeral stream for steady and transient infiltration rates infiltration flux and head distribution below unclogged stream were analytically simulated by cheng et al 2021a they redefined the criteria for different state of hydraulic connection between the ephemeral stream and the underlying aquifer the previous studies of the groundwater mound due to the predefined constant recharge from the ephemeral stream considered a one liu et al 2019 cheng et al 2021a or two dimensional aquifer with a straight infinite length stream that fully penetrates the aquifer cuthbert et al 2016 these works cannot be utilized to predict the groundwater mound due to the recharge from an arbitrary shape ephemeral stream in aerial view furthermore they cannot be used to estimate groundwater recharge from an ephemeral stream utilizing the groundwater head monitoring data therefore the goal of this paper is to present a transient three dimensional 3 d semi analytical model of groundwater mound due to recharge from an ephemeral stream of arbitrary geometric shape in aerial view to obtain the semi analytical solution the 3 d groundwater flow governing equation with a point recharge at the water table is dealt with first using the fourier and laplace transforms the stream is approximated by several straight segments and the point recharge solution is integrated along these segments by replacing the parameteric counterpart of the x and y coordinates the groundwater mound due to the ephemeral stream is the superposition of groundwater mound due to each segment a uniform constant head variable discharge well is also considered near the ephemeral stream using the principle of superposition the depletion volume of this well due to the recharge from the ephemeral stream can be used to estimate the sustainable yield of a production well near the stream at the same location while the sustainable yield is defined as the average discharge of a constant head well as compared to an equivalent constant flux well baiocchi et al 2014 piscopo and summa 2007 we present the groundwater mound time curves the groundwater mound spatial map the scaled sensitivity time curve and the depletion volume time curve to illustrate their depenence on the controlling aquifer parameters the presented model can be used to evaluate the groundwater mound due to recharge from an stream of an arbitrary shape in aerial view to estimate the recharge to water table using the groundwater mound monitoring data to calculate the water budget in unconfined aquifers of arid regions to determine the sustainable yield of the pumping wells near ephemeral streams in arid regions among other applications 2 conceptual model 2 1 problem statement the conceptual model of an unconfined aquifer with an arbitrary shape stream in aerial view in a semi arid or arid region is shown in fig 1 the horizontal initial water table is considered the temporary recharge from the ephemeral stream however creates a groundwater mound in the aquifer the origin of the coordinate system is located at the base of the unconfined aquifer at its lateral boundary which separates the mountain bedrock from the unconfined aquifer and is approximated as a no flow boundary for groundwater flow the x axis is perpendicular to the mountain bedrock aquifer boundary and points away from the mountain the y axis is along the mountain bedrock aquifer boundary the z axis is positive upward the ephemeral stream starts at the mountain bedrock aquifer boundary and flows along a meandering channel away from the mountain the stream width is regarded as much smaller than the scale of concern here so the stream is approximated as a meandering linear curve in the mathematical model that will be represented later the meandering ephemeral stream channel is approximated with a series of connected straight linear segments the depth of the unconfined aquifer is d and it has infinite horizontal extent in this work first the groundwater mound due to a point recharge is obtained then the line recharge solution is obtained from the point recharge solution by integrating along the stream channel in the horizontal direction finally the solution for the stream is acquired utilizing the principle of superposition the following assumptions are considered in this work 1 the homogeneous anisotropic unconfined aquifer with uniform thickness and semi infinite extent is considred 2 the recharge from the stream is imposed on the water table and it is different from the infiltration rate from the stream 3 the zero width finite length stream is considered the spatial variations of recharge can be simulated by segmentation of the stream in which the recharge of each segment is different from the other segments the 3 d governing equation of flow in the homogeneous anisotropic unconfined aquifer is malama et al 2007 moench 1993 neuman 1974 zhan and zlotnik 2002 1 k h 2 h x 2 k h 2 h y 2 k z 2 h z 2 s s h t 0 where h is hydraulic head mound l x and y are the two horizontal coordinates and z is the vertical coordinate l t is time t kh and kz are the horizontal and vertical hydraulic conductivities lt 1 respectively and the same hydraulic conductivity kh is used for both the x and y directions to simulate a horizontally isotropic system ss is specific storage l 1 eq 1 is the mass balance statement of a representative element volume rev considering darcian groundwater flux and release of groundwater from storage due to elastic compressibilities of aquifer and water the release of water from the free surface water table drainage is treated as the upper boundary condition when discussing the 3 d flow in an unconfined aquifer as in presented work both the specific storage which is included in the governing equation and the specific yield which is included in the upper boundary condition affect the drawdown fetter 2000 kruseman et al 1994 malama 2011 moench 1993 1994 1995 moench 1996 neuman 1974 todd and mays 2005 zhan and zlotnik 2002 the 2 d bousinessq s equation is not used in this work thus common assumptions of a 2 d boussinesq equation and ignoring specific storage do not apply here in fact the influence of the specific storage of the body of an unconfined aquifer is not significant in case of a shallow source sink in a three dimensional 3d unconfined aquifer underneath an ephemeral stream as it will be overshadowed by the influence of the gravity drainage effect quickly after the start of pumping which is manifested by the specific yield that is usually much greater than the storage effect to estimate sustainable yield of a deep well in a thick unconfined aquifer sections 3 5 however the specific storage effect cannot be neglected because the supply of water into such a deep well during the initial stage of pumping primarily comes from the elastic release of water from the storage near the wellbore i e the effect of specific storage rather than from the gravity drainage at the water table i e the effect of the specific yield when time gets longer then the release of water from the gravity drainage at the water table may start to contribute more to the well yield and finally when time becomes sufficiently long or the so called quasi steady state pumping the gravity drainage at the water table may eventually over shallow the influence of specific storage and becomes the dominating mechanism of supplying water to the well yield as in our work we calculate both the groundwater mound and sustainable yield of the pumping well the specific storage of the aquifer cannot be neglected as the well that we are about to estimate its sustainable yield may be deep the initial condition is 2 h x y z 0 0 the zero head boundary conditions are considered for the far distances as 3 h x y z t x 0 h x y z t y 0 a point to note is that the no flow boundary at the mountain bedrock aquifer interface the y axis will be dealt with using the image well method so the aquifer concerned in eq 3 extends to infinity laterally the areal recharge is imposed at the water table thus the linearized free surface boundary condition is approximated as sedghi and zhan 2019 zlotnik and ledder 1993 dagan 1967 polubarinova kochina 1962 4 k z h z z d s y h t z d r t δ x x 0 δ y y 0 where sy is the specific yield r t is the time dependent volumetric recharge imposed on the water table l3t 1 at x 0 y 0 and is positive d is the aquifer initial thickness l δ is the dirac delta function l 1 it should be noted that the groundwater head variation is assumed to be much less that the aquifer thickness thus the upper boundary condition eq 4 is set at the initial aquifer thickness d the volumetric recharge can be estimated utilizing different hydrological methods for example it can be estimated by the stream reach water balance method if there are gaging stations in different parts of the ephemeral stream the difference of the volumetric stream flow of the ephemeral stream in two stations is the volumetric infiltration from the stream between them if evaporation from the stream is negligible during the time duration of concern the estimated volumetric infiltration is the upper bound of recharge to the water table and can be used to estimate the volumetric recharge if a relationship can be established between the infiltration rate below the streambed and the recharge rate at the water table such an infiltration recharge relationship is not always easy to be established because the dynamic unsaturated zone flow process between the streambed and the water table could be highly nonliear and complex one of the most important application of the presented work is to estimate the volumetric recharge from an ephemeral stream to an aquifer by using the groundwater mound data not based on the infiltration data the no flow boundary condition at the bottom of the aquifer is 5 h z z 0 0 the solution to the dimensionless counterpart of eq 1 with respect to the initial and boundary conditions of eqs 2 5 is obtained utilizing fourier and laplace transforms the detail of derivation is presented in appendix the groundwater mound due to the volumetric point recharge at the water table is 6 h d p r d p 2 π 0 cosh λ z d σ λ sinh λ p cosh λ ω j 0 ω r d d ω where the overbar means the term in laplace domain the subscript d denotes the dimensionless terms which are defined in table 1 p is the laplace transform parameter in respect to the dimensionless time td σ is a term related to the ratio of specific storage and specific yield defined in table 1 j 0 is the first kind zero order bessel function sinh and cosh are the hyperbolic functions and 7 λ p ω 2 8 r d x d x 0 d 2 y d y 0 d 2 where x0d and y0d are respectively the dimensionless x and y coordinates of the point source and ω is a dummy variable of integration to obtain the groundwater mound due to a linear recharge source at the water table along the desired direction one should define x 0d and y 0d as a function of ld as 9 x 0 d l d cos α 10 y 0 d l d sin α where α is the angle between the stream and positive x direction and ld is the dimensionless length along the stream it is noted that the width of stream is assumed to be much smaller than the aquifer thickness here so the stream is approximated as an arbitrary line source following the stream flow direction this assumption is acceptable for many ephemeral streams which are often very narrow with limited widths as compared to the scale of interest of the concerned problem cheng et al 2021a if the stream width is comparable with the aquifer thickness then the stream should be approximately as an areal source rather than the linear source the solution for an areal source can be obtained straightforwardly by double integrating the point source solution along the stream flow direction and the direction perpendicular to the stream flow over the entire width of stream nevertheless in this study we treat the narrow ephemeral stream as a linear source and the solution can be obtained by integrating the point source solution along the stream flow direction only eq 6 can be utilized to obtain the groundwater mound due to recharge from a linear stream as h e d p r d p 2 π 0 l d 0 cosh λ z d σ λ sinh λ p cosh λ 11 ω j 0 ω x d x s d l d cos α 2 y d y s d l d sin α 2 d ω d l d where xsd and ysd are the dimensionless x and y coordinates of the starting point of the stream and ld is the dimensionless total length of the stream considering the following no flow boundary along the y axis 12 h d p x d x d 0 0 the image well method can be utilized to modify eq 11 as h e d p r d p 2 π 0 l d 0 cosh λ z d σ λ sinh λ p cosh λ 13 ω j 0 ω x d x s d l d cos α 2 y d y s d l d sin α 2 j 0 ω x d x s d l d cos α 2 y d y s d l d sin α 2 d ω d l d considering the principle of superposition the groundwater mound due to stream recharge can be approximated by linear segments as 14 h e d p j 1 n r d j p 2 π 0 l d j 0 cosh λ z d σ λ sinh λ p cosh λ ω j 0 ω x d x s d l d cos α j 2 y d y s d l d sin α j 2 j 0 ω x d x s d l d cos α j 2 y d y s d l d sin α j 2 d ω d l d where the subscript j represent the jth stream segment and all parameters with subscript j are belonging to that segment it should be noted that the starting point of each segment e g xsd and ysd should be set to the ending point of its previous segment eq 14 can be extended to calculate groundwater mound due to multiple streams or multiple branches of stream of arbitrary shapes 3 results and discussion 3 1 verification with modflow to check the proposed solution with the finite difference numerical model of modflow a straight ephemeral stream of 1000 m length is considered to reduce the number of the numerical model cells and therefore computational time the stream starts from x 0 y 0 and ends at the point x 1000 m and y 0 an impermeable boundary is considered along the y axis at x 0 the 0 1 m wide cells are considered at the stream the cells with the width of 0 0005 m δy 0 0005 m are considered adjacent to the stream the cell size δy increases with an expansion factor of 1 2 away from the stream as suggested by barrash and dougherty 1997 the total model rows are 80 and total model columns are 25 the initial aquifer thickness is 10 m and is discretized uniformly to 10 layers the horizontal and vertical hydraulic conductivities are set to be 0 0001 ms 1 if needed a vertical anisotropy can be introduced to simulate a smaller vertical hydraulic conductivity in respect to the horizontal hydraulic conductivity the specific storage and the specific yield of the aquifer are set to 4 10 5 m 1 and 0 3 respectively two stress periods are considered stress period 1 is for the recharge period and stress period 2 is for the time after the recharge is ended the stress length of the stress period 1 is 30 days and it is discretized into 100 time steps with a temporal expansion factor of 1 2 the length of the stress period 2 is 370 days this stress period is also discretized into 100 time steps again with a temporal expansion factor of 1 2 as suggested by barrash and dougherty 1997 it should be noted that increasing the spatial resolution of the modflow model grid and increasing the time steps significantly increases the computational time without increasing the accuracy of the model results three observation wells are considered at the x 500 m and y 5 m y 50 m and y 100 m to show the influences of distance from the stream and to check the validity of the proposed solution at different distances from the stream the volumetric recharge at the rate of 0 006 m3s 1 is considered at the stream this amount of water is equivalent to discharge of a losing stream with the catchment area of 1 km 2 and a runoff elevation of 15 mm during a month the following function is considered to simulate the recharge to the water table 15 r t r 0 h t t 0 h t t 1 where r 0 is the constant recharge of 0 006 m3s 1 t 0 is the starting time of recharge 0 day and t 1 is ending time of recharge 30 days this corresponds to the recharge from a temporary stream in an arid region the dimensionless laplace domain counterpart of eq 15 is 16 r d p r 0 d p exp t d 0 p exp t d 1 p where t d0 t d1 are respectively the dimensionless counterparts of t 0 t 1that are defined in the same fashion as td in table 1 eq 16 is used as a recharge function in eq 14 it should be noted that the recharge is an arbitrary function of time here we use the heaviside step function to simulate recharge as an illustrative example for complex recharge variations piecewise linear functions may be utilized for laplace transforms of piece wise linear functions the reader may consult the following papers roumboutsos and stewart 1988 ahmadi et al 2017 default hydraulic parameters that are given in table 2 are used to calculate groundwater mound the results of modflow simulation are compared to that of the proposed semi analytical model fig 2 this figure shows acceptable agreement of numerical simulation to that of the proposed semi analytical model for the observation point at y 5 m however the proposed model with numerical inverse laplace algorithm of stehfest 1970 could not simulate the peak of groundwater mound accurately the de hoog et al 1982 algorithm however satisfactorily simulates this the stehfest 1970 algorithm is suggested for the observation points that are not close to the stream as it is computationally faster than the de hoog et al 1982 method the computational time becomes an important issue when the number of segments increases and or when the model is coupled to a parameter estimation code that needs many calls of forward model figure inspection also reveals that the groundwater mound is significantly attenuated about 100 m away from the stream that is why most production wells are constructed near ephemeral streams in arid regions fig 3 3 2 arbitrary recharge function utilizing the presented solution one can explore the influences of an arbitrary and time dependent recharge on the groundwater mound to illustrate this the following function is considered to simulate the recharge to the water table 17 r t r 0 h t t 0 h t t 1 r 1 h t t 2 h t t 3 where r 0 0 006 m3s 1 that is due to a runoff elevation of 0 01 m in 30 days in a catchment with an area of about 1 55 km2 t 0 is the starting time of recharge 0 day t 1 is the ending time of recharge 30 day r 1 0 009 m3s 1 that is due to a runoff elevation of 0 005 m in 10 days in a catchment with area of about 1 55 km2 with the starting time t 2 of 100 days and the ending time t 3 of 110 days the dimensionless laplace domain counterpart of eq 17 is 18 r d p r 0 d p exp t d 0 p exp t d 1 p r 1 d p exp t d 2 p exp t d 3 p where t d0 t d1 t d3 t d4 r 0d r 1d are respectively the dimensionless counterparts of t 0 t 1 t 3 t 4 r 0 r 1 that are defined in the same fashion as rd and td in table 1 eq 18 is used as a recharge function in eq 14 the influences of this recharge function on groundwater mound at three observation wells 50 100 and 150 m away from the stream are tested the other parameters are set to default values that are given in table 2 the results are illustrated in fig 7 attenuation of the groundwater mound due to recharge is evident in fig 7 3 3 spatial distribution of groundwater mound fig 4 illustrates the influences of recharge from the ephemeral stream of an arbitrary shape on the groundwater mound five stream segments of 1000 m length are considered the recharges from these segments are 0 006 m3s 1 0 005 m3s 1 0 004 m3s 1 0 003 m3s 1 0 002 m3s 1 respectively recharges start at the day 0 and end at the day 30 the spatial recharge distribution is calculated at the days 30 fig 4a and 60 fig 4b it is evident from these figures that the groundwater mound follows the shape of the stream and spreads spatially from the stream over time comparing fig 4a and 4b furthermore the groundwater mound is higher inside the convex part of the stream due to or positive feedback of neighboring parts of the stream the difference of the groundwater mounds between fig 4a and b is calculated and illustrated in fig 4c this figure shows that the groundwater mound decreases at the stream at the time of 60 days 30 days after the end of recharge due to cease of recharge the groundwater mound however increases at the certain distance from the stream as the groundwater mound of the recharge period spreads there it should be noted that the groundwater mound peak is always under the stream the figure also shows that the groundwater mound due to recharge is significantly attenuated away from the stream that is why most production wells are constructed near the ephemeral streams as discussed before 3 4 sensitivity analysis one of the most important applications of the presented solution is to calculate the groundwater recharge from an ephemeral stream using the groundwater head data to show the influences of aquifer parameters on the sensitivity of the groundwater head data to the recharge from the ephemeral stream scaled sensitivity time curves in this section are presented such curves are prepared using the following equation kabala 2001 huang and yeh 2007 19 s p i o p i p i o p i o p i δ p i δ p i p i where spi is the scaled sensitivity of the groundwater head to the recharge from the stream l o is the model output that is the groundwater mound in this work pi is the ith parameter that is the recharge in this work and δpi is the parameter increment that is 10 3 pi huang and yeh 2007 the effects of hydraulic parameters on the scaled sensitivity of the head to the recharge from the stream are explored in this section in fig 5 we demonstrate the effects of distance from the stream on the sensitivity of the groundwater head to the recharge from the stream this figure reveals that increasing the distance from the stream decreases the scaled sensitivity of the groundwater head to the recharge from the stream therefore for accurate estimate of recharge from the stream to the aquifer the observation well should be close to the stream fig 6 illustrates the influences of the horizontal hydraulic conductivity on the sensitivity of the groundwater head to the recharge from the stream this figure illustrates that the sensitivity of the dimensionless head to the recharge increases during the recharge period the sensitivity curve sees its maximum at the end of the recharge period this shows that the groundwater head data at the end of the recharge period are most valuable to estimate the recharge from the ephemeral stream the figure also reveals that increasing the horizontal hydraulic conductivity decreases the sensitivity of the groundwater head to the recharge thus the groundwater heads collected from an observation well in a fine grained aquifer are more valuable to estimate the recharge from the ephemeral stream vertical hydraulic conductivity does not significantly affect the sensitivity of the groundwater head to the recharge from the stream and the associated figure is not shown in the paper fig 7 tests the influences of the specific yield on the sensitivity of the groundwater head to the recharge from the stream the same temporal change of the sensitivity of the head to the recharge from the aquifer is seen increasing the specific yield of the aquifer decreases the sensitivity of head to the recharge in fact decreasing the specific yield increases the groundwater mound due to the recharge of specified volumetric rate from the stream this is because a lower specific yield means a smaller effective porosity in the aquifer therefore a lower volumetric recharge is needed to fill a unit volume of aquifer or putting it in another way for a specified volumetric recharge a larger volume of aquifer will be filled by water that in turn increases the groundwater mound to sum up the buffering effects of the specific yield attenuates the variation of head due to recharge as the specific yield decreases by decreasing the grain size of aquifers groundwater head data collected from a fine grain aquifer are more valuable to estimate the recharge from the ephemeral stream 3 5 sustainable yield one of the most important applications of the presented model is to calculate the sustainable yield of the single pumping well near an ephemeral stream as stated by baiocchi et al 2014 and piscopo and summa 2007 the sustainable yield of a single pumping well can be determined by setting a constant head pumping well and calculate its discharge variation due to the recharge the average discharge of a constant head well is defined as the sustainable yield of an equivalent constant flux well in this section the same idea is adopted to calculate the sustainable yield of a pumping well near an ephemeral stream that is crucial in arid regions the detailed derivation of the sustainable yield is presented in the appendix b to obtain the sustainable yield the following matrix should be solved 20 f w 1 1 f w 1 2 f w 1 n f w 2 1 f w 2 2 f w 2 n f w n 1 f w n 2 f w n n q w 1 d p q w 2 d p q w n d p s w c d p f r 1 s w c d p f r 2 s w c d p f r n where the f wk l term calculates the drawdown in well segment k created by flow into well segment l from the aquifer the f wk l term can be calculated as f w k l 1 2 π n 1 cos ω n z w k d z w k 1 d 2 0 25 0 5 sin 2 ω n ω n s i n z w l d s i n z w l 1 d ω n z w l 1 d z w l d 21 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 and frk is calculated as 22 f r k j 1 n r d j p 2 π 0 l d j 0 cosh λ z w k d z w k 1 d 2 σ λ sinh λ p cosh λ ω j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 d ω d l d one can calculate the total discharge of a constant head well due to the recharge from the ephemeral stream as the summation of the discharges of all segments 23 q w d p i 1 n q w i d p the following equation can be used to calculate the cumulative depletion volume of the constant head well due to recharge from the ephemeral stream as stated before baiocchi et al 2014 piscopo and summa 2007 this can be utilized to estimate the sustainable volume of the constant flux well in the location of the constant head well 24 v t d 0 t d q w d τ d τ where v is the cumulative well depletion volume l3 the laplace domain counterpart of eq 24 is 25 v p 1 p q w p k h d 2 p q w d p in this section the influences of the distance of the well from the stream and effects of the hydraulic parameters of the aquifer on the depletion volume of the constant head well that can be used to estimate the sustainable yield of the well are investigated default parameter values given in table 2 are used to calculate the depletion volume of the well the volumetric depletion volume of the constant head well dv hereafter due to the recharge from the stream is calculated using eq 25 and by eliminating s w c d p from eq 20 the depletion volume dv of the well should be divided by the pumping period to estimate the sustainable yield fig 8 shows the influences of the distance from the stream on dv this figure shows that increasing the distance from the stream decreases dv thus the production well near the ephemeral stream can extract more water from the aquifer without adverse effects on the aquifer it should be noted that the red arrows in the figure show the cumulative dv for a one year 365 days period fig 9 shows the effects of the horizontal hydraulic conductivity of the aquifer on dv the figure reveals that increasing the horizontal hydraulic conductivity will increase dv after long time from the recharge increasing the horizontal hydraulic conductivity by three orders of magnitude will increase dv five times therefore production wells in a coarse grain aquifer have a higher sustainable yield fig 10 illustrates the influences of the vertical hydraulic conductivity of the aquifer on dv the figure shows that increasing the vertical hydraulic conductivity increases dv increasing the vertical hydraulic conductivity by three orders of magnitude increases dv more than 100 times as layering of the aquifer decreases the equivalent vertical hydraulic conductivity the sustainable yield of the production well in a layered alluvial aquifer will be significantly suppressed fig 11 depicts the influences of the specific yield of the aquifer on dv as shown in the figure increasing the specific yield decreases dv this is due to the fact that with a lower specific yield the groundwater mound due to the recharge decreases and this reduces the discharge of the constant head well overall the sustainable yield of a production well in an alluvial aquifer near an ephemeral stream is maximum near the stream in a coarse grain non layered aquifer it should be noted that the sustainable yield can be calculated for multiple production wells utilizing the principle of superposition along with eqs 20 and 25 4 limitations of developed solutions the developed solutions have several limitations that should be noted in applications methods of relaxing these limitations are also briefly explained 1 the recharge is imposed on the water table this is different from the infiltration from the stream the functional relation between infiltration from the stream and recharge to the water table it is not presented in this paper may be employed to extend the presented solution to calculate the groundwater mound due to infiltration from the ephemeral stream 2 the presented model considers an arbitrarily prescribed recharge to simulate the groundwater mound the recharge rate from the stream may be dependent on the groundwater head when the depth of the groundwater is low for this case the proposed model can simulate the groundwater mound through an iterative procedure that is one assumes an initial recharge and then the proposed model simulates the groundwater head if the groundwater head is higher than the predefined threshold as described in cheng et al 2021a the recharge rate will be modified using appropriate models of cheng et al 2021a and cheng et al 2021b and the proposed model is employed to recalculate the groundwater mound using the modified recharge this iterative procedure can calculate both the groundwater mound and recharge from the ephemeral stream 3 the volumetric recharge is uniform in each stream segment to fine tune the spatial distribution of the volumetric recharge from the stream one should decrease the size of each stream segment with different recharge which in turn increase the computational time 4 the aquifer is considered to be semi infinite that is bounded by an impermeable boundary this boundary condition is simulated using the image well method before its integration the solution can be extended for the cases of strip shaped and rectangular aquifers using the image well method 5 the solution is presented in laplace space analytical inversion of the solution to time domain is possible using the residue theorem and convolutional integral the numerical laplace inversion however is computationally faster than the time domain solution in our case this is due to the slow convergence of the series arising from the residue theorem and numerical integration of the convolutional integral furthermore the laplace domain solution is more appropriate for the further development of this work 5 summary and conclusions the 3 d solution of groundwater mound in an unconfined anisotropic aquifer due to the recharge from the ephemeral stream of an arbitrary shape to the water table is presented the arbitrary spatiotemporal recharge of prescribed flux is considered the following results are drawn from this work 1 the groundwater mound due to the recharge from the stream is significantly attenuated away from the stream that is why most of the production wells are near the ephemeral streams wadis in arid and semi arid regions of the world the groundwater mound follows the shape of the stream and spreads spatially from the stream over time for the case of the stream with an arbitrary shape the groundwater mound is higher inside the convex part of the stream due to the positive feedback of the mound of the neighboring parts of stream 2 for accurate estimation of the recharge from stream to aquifer using the groundwater mound data the observation well should be close to the stream less than 100 m the groundwater head data at the end of the recharge period are most valuable to estimate the recharge from the ephemeral stream 3 as fine grain aquifer has a lower horizontal hydraulic conductivity and a smaller specific yield the groundwater head collected from an observation well in such an aquifer is more valuable to estimate the recharge from the ephemeral stream 4 the sustainable yield of a production well in an alluvial aquifer near an ephemeral stream is maximum near the stream in a coarse grain non layered aquifer this is due to the fact that such a type of aquifer usually has higher horizontal and vertical hydraulic conductivities than the layered aquifers made of coarse and fine materials credit authorship contribution statement mohammad m sedghi conceptualization methodology software writing original draft hongbin zhan supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment we would like to express our sincere thanks to dr anvar kacimov and an anonymous reviewer for their valuable comments and corrections the first author wishes to thank the payame noor university for financial support appendix a derivation of solutions in laplace domain the following laplace transform a1 f p f t e p t d t is used to obtain the dimensionless laplace space counterpart of eq 1 as a2 2 h d x d 2 2 h d y d 2 2 h d z d 2 p h d 0 where the overbar means the term in laplace domain the far distances boundary condition is a3 h d x d y d z d p x d 0 h d x d y d z d p y d 0 the boundary condition at the water table is a4 σ h d z d z d 1 p h d r d p δ x d x 0 d δ y d y 0 d the no flow boundary condition at the bottom of the aquifer is a5 h d z d z d 0 0 the following double fourier transformations with respect to x and y a6 f ω 1 ω 2 1 2 π f x y e i ω 1 x e i ω 2 y d x d y is imposed on eqs a2 a4 and a5 considering boundary conditions of eq a3 as a7 2 h d z d 2 p ω 1 2 ω 2 2 h d 0 a8 σ h d z d z d 1 p h d r d p 2 π exp i ω 1 x 0 d exp i ω 2 y 0 d a9 h d z d z d 0 0 where the double dots above the variable indicate a term in frequency domain after double fourier transforms ω1 and ω2 are frequencies related to fourier transforms in respect to the x and y coordinates respectively the solution to eq a7 with respect to boundary conditions of eqs a8 and a9 is a10 h d r d p 2 π cosh z d p ω 1 2 ω 2 2 exp i ω 1 x 0 d exp i ω 2 y 0 d σ p ω 1 2 ω 2 2 sinh z d p ω 1 2 ω 2 2 p cosh z d p ω 1 2 ω 2 2 taking the inverse double fourier transform of eqs a10 and 6 is obtained as a11 h d r d p 4 π 2 cosh z d p ω 1 2 ω 2 2 σ p ω 1 2 ω 2 2 sinh z d p ω 1 2 ω 2 2 p cosh z d p ω 1 2 ω 2 2 exp i ω 1 x d x 0 d exp i ω 2 y d y 0 d ω 1 ω 2 as the double fourier transform of a circular symmetric function is equivalent to hankel transform of zero order jeffrey and zwillinger 2007 lu et al 2018 as a12 1 2 π f ω 1 ω 2 exp i ω 1 x d x 0 d exp i ω 2 y d y 0 d ω 1 ω 2 0 f ω ω j 0 ω r d ω where a13 ω ω 1 2 ω 2 2 a14 r d x d x 0 d 2 y d y 0 d 2 therefore replacing ω 1 2 ω 2 2 by ω2 and using the identity of eq a10 one obtains the following equation from eq a9 a15 h d r d p 2 π 0 cosh z d p ω 2 σ p ω 2 sinh z d p ω 2 p cosh z d p ω 2 ω j 0 ω r d ω using the definition of λ that is p ω2 table 1 eq 6 is obtained from eq a153 appendix b calculation of sustainable yield to calculate the sustainable yield the following steps are adopted 1 adding a specified flux partially penetrating well near the ephemeral stream the specified flux point source solution in laplace domain in an unconfined aquifer is sedghi and zhan 2020 zhan and zlotnik 2002 b1 s w d q w d p 2 π n 1 cos ω n z d cos ω n z w d 0 25 0 5 sin 2 ω n ω n k 0 p ω n 2 x d x w d 2 y d y w d 2 where s w d is the drawdown in laplace domain at the point with dimensionless coordinates of xwd ywd zwd due to the pumping from the well with the dimensionless discharge of q w d p k0 is the modified bessel function the 2nd kind zero order wn is the solution to the following equation b2 ω n sin ω n p σ cos ω n 0 where σ is the parameter defined in table 1 integrating the point source solution with respect to zwd from z w1d to z w2d one obtains the averaged drawdown in laplace domain due to the partially penetrating specified flux well as s w l d 1 z w 2 d z w 1 d z w 1 d z w 2 d s w d d z w d q w d p 2 π z w 2 d z w 1 d n 1 cos ω n z d 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 2 d ω n b3 k 0 p ω n 2 x d x w d 2 y d y w d 2 it should be noted that this equivalent specified flux well is used to calculate the discharge variation of the constant head well through the following steps 1 calculate the sum of drawdown due to the specified flux well eq b3 and the groundwater drawdown negative mound of eq 14 as s d q w d p 2 π z w 2 d z w 1 d n 1 cos ω n z d 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x d x w d 2 y d y w d 2 b4 j 1 n r d j p 2 π 0 l d j 0 cosh λ z d σ λ sinh λ p cosh λ ω j 0 ω x d x s d l d cos α 2 y d y s d l d sin α 2 d ω d l d where s d is the laplace domain dimensionless drawdown due to the pumping from the specified flux well and recharge from the stream it should be noted that the minus sign before the recharge is due to the fact that the groundwater mound is negative drawdown 1 setting the constant drawdown condition on the screen of the pumping well to change it to an equivalent variable flux well s w c d p q w d p 2 π z w 2 d z w 1 d n 1 cos ω n z w 1 d z w 2 d 2 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x c d x w d 2 y c d y w d 2 b5 j 1 n r d j p 2 π 0 l d j 0 cosh λ z w 1 d z w 2 d 2 σ λ sinh λ p cosh λ ω j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 d ω d l d where s w c d is the constant drawdown at the variable discharge well x c d y c d z w 1 d z w 2 d 2 is the coordinate of the constant drawdown point on the well screen the image well method is employed to simulate an impermeable boundary along the y axis eq 5 as s w c d p q w d p 2 π z w 2 d z w 1 d n 1 cos ω n z w 1 d z w 2 d 2 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x c d x w d 2 y c d y w d 2 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 b6 j 1 n r d j p 2 π 0 l d j 0 cosh λ z w 1 d z w 2 d 2 σ λ sinh λ p cosh λ ω j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 j 0 ω x c d x s d l d cos α 2 y c d y s d l d sin α 2 d ω d l d since the discharge strength is nonuniform over the screen of the constant drawdown well the screen of the constant drawdown well is segmented into n parts where the number of n should be sufficiently large to make the final discharge distribution over the well screen independent of n or much less sensitive to n for the problem concerned here our computational exercises show that n 16 is sufficient eq b6 above is applied to each segment with the constant drawdown point at the center of each segment on the well screen and eventually the discharge rate over each well screen segment can be determined for instance consider segment 1 as the discharge of all segments affects the drawdown at the constant head point of segment 1 xd yd zd the following equation holds obtained from eq b6 b7 q w 1 d p f w x w d y w d z w 1 d z w 2 d x c d y c d z w 1 d z w 2 d 2 q w 2 d p f w x w d y w d z w 2 d z w 3 d x c d y c d z w 1 d z w 2 d 2 q w n d p f w x w d y w d z w n d z w n 1 d x c d y c d z w 1 d z w 2 d 2 s w c d p f r x c d y c d z w 1 d z w 2 d 2 where qw1d qw2d qwnd are the dimensionless discharges for the 1st 2nd and nth segments respectively and b8 f w x w d y w d z w 1 d z w 2 d x c d y c d z w 1 d z w 2 d 2 1 2 π z w 2 d z w 1 d n 1 cos ω n z w 1 d z w 2 d 2 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x c d x w d 2 y c d y w d 2 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 b9 f w x w d y w d z w 1 d z w 2 d x c d y c d z w 1 d z w 2 d 2 1 2 π z w 2 d z w 1 d n 1 cos ω n z w 1 d z w 2 d 2 0 25 0 5 sin 2 ω n ω n s i n z w 2 d s i n z w 1 d ω n k 0 p ω n 2 x c d x w d 2 y c d y w d 2 k 0 p ω n 2 x c d x w d 2 y c d y w d 2 eq b7 must be written for all segments and solved for discharge of each segment simultaneously utilizing the matrix of eq 20 
42,electrokinetic ek techniques can effectively mobilize amendments and contaminants in porous media and therefore have a great potential for in situ subsurface remediation of a wide variety of organic and inorganic contaminants however the fundamental mechanisms governing ek applications in porous media are complex and entail coupling between different flow transport electrostatic and geochemical processes in this study we investigate the interactions between density driven effects and electrokinetic transport in permeable porous media and we compare the observed dynamics with the outcomes of analogous scenarios in which advection and dispersion are the only transport mechanisms we perform a series of multidimensional experiments and we demonstrate the strong interplay between coulombic interactions among charged species in pore water and density driven effects during electrokinetics our study illuminates non trivial interactions between the pore water composition and the macroscopic behavior of variable density dye tracer plumes showing different sinking and floating patterns distinct plume shapes and spreading as well as different extent of mixing depending on the chemical composition of the pore water a numerical model based on the nernst planck poisson formulation and on the coupling with the geochemical code phreeqc was developed to simulate variable density flow and transport and to update the density of the aqueous solution resulting from mixing and electrostatic interactions between all chemical species in the injected plume and in the surrounding pore water electrolyte the model allowed us to interpret the experiments and to visualize the impact of small density gradients and coulombic effects on the macroscopic transport of the dye tracer the outcomes of this study highlight the importance of density driven flow also during ek transport where the electrostatic interactions not only influence the concentration of charged species but can also affect the density and result in complex flow patterns plume shapes and mixing behavior radically different from the ones generated during advective dispersive transport data availability data will be made available on request 1 introduction electrokinetics in porous media involves the application of an electric field to induce the transport of solutes the main transport processes include electromigration consisting in the movement of ions in the direction of opposite charge acar and alshawabkeh 1993 reddy and cameselle 2009 and electroosmosis which entails a net movement of water as a result of the excess of charge in the double layer godinez brizuela and niasar 2020 wen et al 2021 yustres et al 2020 in the context of remediation of contaminated sites electrokinetic techniques are typically considered for the enhancement of transport in low permeability porous media such as clayey and silty soils as both electromigration and electroosmosis can effectively displace solute species at significantly higher rates compared to what is possible to achieve with pressure gradients and or diffusive transport gill et al 2021 head et al 2020 inglis et al 2021 lima et al 2017 mao et al 2012 sprocati and rolle 2021 wu et al 2012 density driven flow in porous media occurs as a difference in concentration leading to a difference in density which generates a convective flow due to gravitational forces diersch and kolditz 2002 voss and souza 1987 such phenomena occur for a broad range of geophysical flows with impacts at different scales for instance in groundwater systems density driven flows play a key role in determining the hydrodynamic behavior and the water quality in coastal aquifers etsias et al 2021 geng et al 2020 hamzehloo et al 2022 robinson et al 2018 werner et al 2013 as well as in the transport of contaminants and amendments bakhtyar et al 2013 henderson et al 2009 pool and dentz 2018 post and prommer 2007 simmons et al 2001 most of the studies of density driven flow consider relatively high permeability porous media such as sandy soils where density effects have a stronger impact on downward velocities although density is not typically considered in combination with ek transport which normally targets low permeability formations ek techniques have a largely unexplored potential for the remediation of permeable formations and of heterogeneous systems with both high and low permeability materials brooks et al 2021 chowdhury et al 2017 gill et al 2015 muniruzzaman and rolle 2021 2019 reynolds et al 2008 sprocati and rolle 2022 in such conditions density driven effects can play a key role in the transport of solutes and in the targeted distribution of reactants therefore a detailed understanding of the phenomena and of the interplay between density driven flow and transport processes with electrokinetic mechanisms is necessary to guide the design and the implementation of field scale interventions the goal of this study is to explore the fundamental mechanisms of density effects during electrokinetic transport in permeable porous media laboratory experiments were performed to investigate the impact of variable density flow and transport in three ek transport scenarios characterized by different concentrations and density gradients between the injected dye tracer plume and the background electrolyte solution in the pore water analogous experiments were carried out in the same setup in absence of the imposed external electric field with an hydraulic gradient to drive the water flow and with advection and dispersion as the sole transport mechanisms to interpret the experimental results we developed a process based model which is instrumental to understand and visualize the main processes to quantify the impacts of the different transport mechanisms and to unveil the key role of microscopic coulombic interactions on the macroscopic observations we also present an analysis of plume displacement spreading skewness and mixing to quantitatively interpret the complex transport patterns in the scenarios investigated 2 materials and methods the experiments are conducted in a quasi two dimensional chamber consisting of two glass panels held together by an aluminum frame fig 1 the inner size of the chamber is 795 mm 182 mm 11 mm and the porous medium is present in the central part 300 mm 180 mm 11 mm and separated from the reservoirs by a hollow acrylic frame covered with a black fabric the porous medium used in this study consists of glass beads with a grain size in the range of 0 40 0 60 mm sigmund lindner germany with hydraulic conductivity kh 2 50 10 3 m s and electroosmotic coefficient keo 1 10 10 8 m2 v s sprocati and rolle 2022 the porous medium was filled in the tank using a wet packing procedure haberer et al 2015 in all experiments allura red sigma aldrich germany a divalent negatively charged dye was used as a visible tracer due to its red color the tracer solution 8 ml with a concentration of 10 mm was initially injected with a needle inside the porous medium a first set of experiments investigated advective dispersive transport of allura red in three different scenarios entailing different concentration and therefore density between the injected tracer solution and the resident pore water the scenarios had differed concentration of the bicarbonate buffer nahco3 na2co3 used in the pore water which was 4 times lower than the allura red solution scenario low of similar concentration as the allura red solution scenario similar and 4 times higher than the allura red solution scenario high respectively a summary of the solution concentrations in the different experiments is presented in table 1 the advective flow in the setup was established with a multichannel peristaltic pump shenchen china providing a seepage velocity inside the porous medium of 6 5 cm h the second set of experiments investigated the ek transport of allura red in the same hydrochemical scenarios considered for the advection dispersion experiments in these experiments an electric potential was applied in the system through a pair of graphite electrodes ø6 300 mm elektrokul denmark which were placed in the reservoirs adjacent to the porous medium and at a distance 0 40 m between each other the electrodes were connected to a power supply unit ea elektro automatik ea psi 5200 10a germany operated at constant voltage of 200 v the current in the system was measured with a multimeter peaktech 3315 germany connected in series to the circuit the electric potential in the porous medium was measured with a multimeter peaktech 3315 germany in which the circuit consisted of a pair of wires spaced 0 28 m and placed 1 cm below the water table two external reservoirs with a volume of 2 l each were filled with the same background electrolyte of the pore water and were connected to the internal reservoirs to provide additional volume in the system to minimize the influence of electrolysis reactions the recirculation between the external and internal reservoirs was performed with a multichannel peristaltic pump at a constant recirculation rate of 20 ml min during the experiments photographs were taken every 30 min with a reflex camera nikon d300 with lens af s nikkor 50 mm f 1 4 g in a dark room the setup was illuminated from the back with an electroluminescent panel 1000 mm 300 mm el technik germany and from the front with a light bulb 4000 k 806 lm 100 ma 9 5 w philips netherlands the density of the background electrolytes and of the allura red solution was experimentally measured with a pycnometer blaubrand density bottle gay lussac pattern 10 ml in order to ensure a constant temperature during the measurement of the density the flasks containing the solutions were kept in a water bath at room temperature and only extracted for the test for each tested sample three measurements were made and the measured values are summarized in table s1 supplementary material 3 theoretical background and numerical implementation the mass balance for the liquid is expressed as nick et al 2009 1 n ρ t ρ q 0 where n is the porosity ρ is the density of the solution and q is the total water flux which in the context of electrokinetic applications is the sum of the hydraulic q h and the electroosmotic q eo fluxes sprocati and rolle 2022 2 q q h q eo the hydraulic velocity for a fluid of variable density is 3 q h k h ρ g p ρ g where kh is the hydraulic conductivity g is the gravity constant p is the pressure gradient and g is the gravity vector the electroosmotic flux is jacobs and probstein 1996 4 q eo k eo φ in which keo is the electroosmotic coefficient and φ is the electric potential gradient in this work the density is calculated using the helgeson kirkham flowers modified redlich rosenfeld hkfmorr equation appelo 2015 appelo et al 2014 parkhurst and appelo 2013 which considers the contribution of each dissolved species in the aqueous solution such approach is necessary during multicomponent transport when species are transported at different velocities and in case of ek transport also in different directions using the hkfmorr equation the density of the solution is evaluated as 5 ρ ρ 0 1000 m i m w i 1000 ρ 0 m i v m i where mi is the molality of species i mwi its molar weight and ρ0 is the density of pure water i e 0 997770 kg l at 22 c the molar volume v m i is calculated as appelo et al 2014 6 v m i v m i 0 a v 0 5 z i 2 i 0 5 1 å i b γ i 0 5 b 1 i b 2 i t 228 b 3 i t 228 i b 4 i in which av is the debye hückel limiting slope b γ is the debye length parameter i is the ionic strength of the solution t is the temperature and v m i 0 is the molar volume at infinite dilution evaluated as 7 v m i 0 41 84 0 1 a 1 i 100 a 2 i 2600 p b a r a 3 i t 228 10 4 a 4 i 2600 p b a r t 228 w i ε r 1 p b a r where a 1 4 wi å and b 1 4 are fitting parameters pbar is the pressure of the solution in bar and ε r is the relative dielectric constant of pure water the transport of dissolved species is described by the nernst planck equations which consider the total flux j i tot to be the result of diffusive fluxes j i dif electromigration fluxes j i mig and advective fluxes j i adv alt epping et al 2015 newman and thomas alyea 2004 rasouli et al 2015 rolle et al 2022 8 j i tot n d i c i j i dif n d i z i f rt c i φ j i mig q c i j i adv in which ci is the concentration of the aqueous species zi is the charge f is the faraday constant r is the gas constant and t is the temperature in electrokinetic applications d i d i a q τ where τ is the tortuosity whereas in absence of an external electric field di is the tensor of hydrodynamic dispersion coefficient which in the longitudinal direction is parameterized as guedes de carvalho and delgado 2005 muniruzzaman and rolle 2017 9 d i l d i 0 5 ud where d i d i a q n is the pore diffusion coefficient with d i a q the aqueous diffusion coefficient u q n is the seepage velocity along the main flow direction and d is the average grain size diameter of the porous medium in the transverse direction the dispersion coefficient is expressed as rolle et al 2013 2012 10 d i t d i d i a q p e i 2 p e i 2 4 δ 2 β in which p e i u d d i a q is the grain péclet number δ is the ratio between the length of a pore channel and its hydraulic radius and β is an empirical exponent representing the effect of incomplete mixing in the pore channels for the porous medium used in this study values of δ 5 37 and β 0 5 have been used as determined in previous studies hochstetler et al 2013 ye et al 2015 the mass balance for the aqueous species is 11 n c i t j i tot r i the charge balance in the system is considered with the poisson equation newman and thomas alyea 2004 12 2 φ f ε i 1 n z i c i ρ e ε where ε is the dielectric constant of the porous medium ρ e is the charge density and n is the total number of charged species in case electric potentials are not applied at the boundaries the current density i in the system is zero however in case of ek transport i 0 and the current conservation is considered 13 i f i 1 n z i j i tot f i 1 n z i n d i c i f 2 i 1 n z i 2 n d i rt c i φ fn u i 1 n z i c i in this study an analysis of the spatial distribution of the tracer mass and of the plume behavior was performed considering different metrics to this end we computed the spatial moments of the tracer concentration distribution as freyberg 1986 liu et al 2004 14 m i m n t c i x y t x m y n d x d y where m i mn is the mnth order spatial moment of the species i in a two dimensional domain the zero order moment m i 00 indicates the total solute mass in the system whereas the first order moments normalized by the total mass provide the position of the center of mass of the plume x i c y i c 15 x i c m i 10 m i 00 x i c m i 01 m i 00 the second order moments provide an indication of the spreading of the plume through the spatial covariance σ i x x 2 σ i y y 2 in the longitudinal and transverse directions 16 σ i x x 2 m i 20 m i 00 x c 2 σ i y y 2 m i 02 m i 00 y c 2 the third order moments indicate the asymmetry of the plume through the skewness coefficients γ x γ y expressed as liu et al 2004 17 γ x m i 30 m i 00 3 m i 10 m i 20 m i 00 2 2 m i 10 m i 00 3 σ i x x 3 γ y m i 03 m i 00 3 m i 01 m i 02 m i 00 2 2 m i 01 m i 00 3 σ i y y 3 besides the spreading and shapes of solute plumes it is important to characterize their mixing with the surrounding pore water e g dentz et al 2011 rolle and le borgne 2019 in this work we used the dilution index to quantify mixing of the tracer plumes such mixing metric is defined as the exponent of the shannon entropy kitanidis 1994 18 e t exp ω p i x t l n p i x t d ω in which 19 p i x t c i x t ω c i x t d ω the dilution index quantifies dilution as the distribution of a solute mass over an increasing volume and physically represents a porous medium volume occupied by the plume kitanidis 1994 rolle and kitanidis 2014 process based modeling in this study was performed with a new version of the codes np phreeqc rolle et al 2018 and np phreeqc ek sprocati et al 2019 called np phreeqc ek density these codes combine comsol multiphysics to solve for the fluid flow and multicomponent transport equations with phreeqcrm parkhurst and wissmeier 2015 to compute kinetic and equilibrium bio geochemical reactions ahmadi et al 2022 sprocati et al 2020 the specific features of model development for this study include the consideration of variable density flow and the accurate computation of the solution density using the hkfmorr equation the model uses a sequential non iterative coupling approach ahmadi et al 2022 barry et al 1996 sprocati et al 2019 schematically illustrated in fig 2 in which the first step consists in the solution of the flow and multicomponent ionic transport in comsol multiphysics where the primary variables are the pressure the concentration of the transported species and the electric potential the system of equations is solved using the finite element method the subsequent reactive step consists in the calculation in phreeqcrm of the equilibrium reactions for aqueous speciation and the calculation of the fluid density according to the hkfmorr equation using the values of concentration pressure and temperature from comsol such values are then passed back to comsol as initial conditions for the next transport step the parameters for the calculation of the solution density have been taken from the phreeqc dat database with the exception of allura red which contribution was fitted calibrating phreeqc simulations with the experimental data the models considered the transport of 9 species with the respective aqueous diffusion coefficients listed in table s3 the geometry of the model is illustrated in figure s2 and consists of a two dimensional domain with size 29 cm 15 cm all models are built in comsol multiphysics using a triangular mesh with 10 020 elements and the system of equations for every mesh node is solved using the pardiso solver boundary conditions included values for the electric potential as obtained from the experiments table s2 as well as constant concentration boundaries the initial water pressure at the boundaries p b 0 was defined as 20 p b 0 ρ g h 0 d y in which h 0 is the water level and dy is the depth coordinate with the zero in correspondence to the water level the water levels in the reservoirs were connected to the flow in the porous medium 21 h t a f w s 1 q n h w where afws is the area of the free water surface of each reservoir q n is the normal component of the water flux h is the water level and w is the width of the setup 4 results and discussion prior to the transport experiments the density contribution of allura red was estimated to accurately describe the behavior of the injected dye tracer plumes to this end we measured the density of different solutions with variable background electrolyte concentration and allura red concentrations the comparison between the experimental observations and phreeqc simulations with the calibrated values for allura red a 1 60 cal mol according to eq 7 is shown in figure s1 in all the experiments the density increases with the concentration and phreeqc predictions are close to the measurements in the following we present the results of the advection dispersion and ek transport experiments first we consider the case of a solution of the background electrolyte with a concentration approximately 4 times lower than the concentration of the injected allura red plume scenario low fig 3 presents the experimental and simulation results for both advective and electrokinetic transport scenarios in the advection dispersion scenario the allura red plume has a concentration 10 mm higher than the background electrolyte 0 1 mm na2co3 1 8 mm nahco3 this entails a higher density of the injected solution 1000 25 kg m3 with respect to the background pore water 997 89 kg m3 resulting in a progressive sinking of the tracer plume the photographs show that the plume moves from left to right due to the imposed hydraulic flow but also migrates downwards and reaches the bottom of the setup after 90 min as a result of the density gradient the tracer plume has a sharper front at the bottom and a smoother front at the top the reason for such behavior is that the plume which initially was symmetric starts to sink with higher velocities where the concentration and thus the density is higher over time the portion of the plume with the highest concentration is transported downwards creating the sharp concentration profile at the bottom the variable density flow and advective dispersive simulations capture the observed plume displacement as well as the formation of asymmetric concentration fronts at the bottom and fringes of the tracer plume in the ek experiment the behavior is very different from the advection dispersion case and it is possible to identify two main transport mechanisms the first mechanism involves the movement of the tracer by electromigration towards the anode such displacement is strongly affected by the charge interactions due to which the tracer can only be transported in the domain at a concentration that is similar to the one of the background rolle et al 2022 sprocati et al 2021 as a result a portion of the plume of allura red with concentrations comparable with the charge content of the background pore water moves horizontally and spreads across a wide portion of the porous medium the second mechanism involves density effects which impact the initial injection of allura red during the experiment on the left side of the allura red plume there is an area with a concentration similar to the initial values 10 mm which is subjected to gravity forces and that sinks at a faster rate with respect to the rest of the plume indeed the transported front which moves horizontally in the domain as a result of electromigration being at a lower concentration and therefore with a concentration more similar to the background electrolyte does not appear to be affected by density effects the process based numerical model allows reproducing the complex behavior that originates from the coupling of flow transport and electrostatic processes and requires the precise computation of the spatio temporal evolution of the solution density as discussed above the latter task is performed by the coupling with phreeqcrm and the solution of the hkfmorr equation in the scenario in which the concentration of the background electrolyte 0 5 mm na2co3 9 mm nahco3 is similar to the concentration of the injection of the allura red plume 10 mm the experiments indicate that also in this case the advective dispersive transport is affected by downwards density effects fig 4 however in this scenario the allura red plume appears to sink with a lower velocity with respect to the scenario low as the density difference between the allura red solution 1000 25 kg m3 and the background electrolyte 998 38 kg m3 is reduced in the case of ek transport due to the higher concentration of the background electrolyte allura red can be transported with a higher concentration with respect to the scenario low here the plume appears to be larger than the initial injection as a result of charge interactions which still limit the concentration of allura red that can migrate in the domain note that such electrostatic phenomena occur due to the charge balance between ions in solution and that in the considered scenario allura red charge 2 reaches a concentration that is about half the one of the anion with the highest concentration in the background hco3 rolle et al 2022 considering the scenario high the concentration of the background electrolyte 2 5 mm na2co3 45 mm nahco3 is higher than the concentration of the allura red solution 10 mm the advection dispersion experiments show that the injected plume tends to move upwards with respect to its initial position fig 5 such behavior is the result of the higher density of the background 1000 81 kg m3 which creates a buoyancy effect for the injected allura red plume 1000 25 kg m3 in this case the behavior of the plume along the vertical direction is opposite with respect to the previous cases and the plume appears with a sharper front on top and a smoother front on the bottom in the ek transport scenario allura red moves as a result of electromigration and due to the higher concentration of the background electrolyte the plume shrinks in size as the concentration of allura red needs to increase to balance the charges in the domain as the increase in concentration also corresponds to an increase in density the plume of allura red quickly sinks indeed at the top of the plume the concentration remains lower and it is less affected by the gravity effects it is interesting to note that the shape of the plume in this case is remarkably different from the cases previously analyzed and appear to be elongated along the vertical direction due to the combination of charge interactions and density effects which respectively compress the plume and move the part with the highest concentration and density downwards the model outcomes capture such complex behavior and highlight that charge interactions not only have an effect on the concentration of the species that move with electromigration but due to density effects can also generate variable density flow and thus downward transport of the tracer plume to analyze more in detail the mechanisms at the basis of the experimental observations the process based simulations are used to visualize the spatial distribution of the density its temporal evolution as well as the variable density velocity fields fig 6 considering the cases of advective dispersive transport the density of allura red is higher than the density of the background electrolyte for the scenarios low and similar fig 6a and b respectively consequently there is a downward movement of the plume which is identified in fig 6g h by the highest velocity of the plume at the bottom right and top left corner of the tracer such transport direction is caused by the combination of the uniform advective velocity of the flow towards the right and the falling velocity of the plume caused by gravity for the advection dispersion scenario with high background fig 6c the density of the allura red solution is lower with respect to the surrounding pore water as a result the effect of gravity leads the allura red plume to be transported upwards and this can also be seen from the simulated velocity field in fig 6i for the scenario ek low the injection has a higher density with respect to the background fig 6d however as the plume moves its lower concentration resulting from the coulombic effects and the electroneutrality constraint is not sufficient to significantly impact the density indeed the higher concentration of the injection generates a flow downwards fig 6j which would not be present in the absence of density gradients for the ek transport scenario in which the concentration of the background is similar to the concentration of allura red the charged tracer affects the density of the background during transport fig 6e although such density change is lower with respect to the value of the injection the reason for such behavior is again due to charge interactions which allow allura red to only enter in the domain with a lower concentration than the background due to its double negative charge however in the original position of the injection the density is slightly higher than the background electrolyte this is the result of the coupled effects of electromigration and charge interactions as allura red is mobilized other anions compensate its role to maintain the electroneutrality of the solution indeed as other ions have different charges diffusion coefficients and contribution to the density the density in that position changes accordingly the downward velocity of the plume in this scenario is higher at the beginning as the density difference is larger fig 6k over time as allura red is transported by electromigration the density of the remaining core of the allura red plume decreases thus progressively reducing the impact of density driven effects on the overall transport for the scenario ek high fig 6f indicates that although the initial density of the allura red plume is lower than the background as allura red is transported in the domain by electromigration its increase in concentration due to the coulombic interactions and the electroneutrality constraint also results in an increase in density at the same time as observed in the scenario ek similar the location where allura red has been injected retains a lower density than the background electrolyte due to charge interactions in this case while the zone of higher density sinks the model shows that the zone of lower density where the injection took place moves upwards fig 6l from fig 6g i it can be concluded that in all the advection dispersion scenarios the effects of density are localized in proximity of the allura red plume which is where the highest differences of density occur however in the case of ek transport since electromigration causes the transport of ions in different directions and at different velocities density effects occur in different parts of the domain and also in areas in which allura red is no longer present due to the perturbation of the concentration of the other charged species in the pore water fig 6j l the non trivial interactions between ek transport mechanisms and the resulting flow field are visualized by the streamlines which indicate that also in simple homogeneous porous media such coupled phenomena result in complex flow fields characterized by the presence of secondary motions and convective rolls the process based models also allow a detailed analysis of the tracer plume behavior including its displacement spreading and symmetry fig 7a shows that for all the advection dispersion scenarios the displacement of the center of mass in the horizontal direction occurs at the same velocity in this case the main displacement mechanism is the horizontal flow induced by the pressure difference between the two reservoirs which results in a uniform seepage velocity in the homogeneous porous medium indeed for the ek scenarios the behavior is different with scenario ek high showing the fastest displacement of the plume center of mass and the scenario ek low showing the slowest displacement this is the consequence of the charge interactions in the pore water for which in the ek high case the plume concentrates and moves rapidly whereas with scenario ek low the plume is largely deformed and can only migrate in the domain at a low concentration in the vertical direction fig 7b shows that the advection dispersion scenario with the lowest background concentration exhibits the fastest sinking velocity in the order of 2 cm h similarly the scenario with similar concentrations indicates a sinking velocity of the center of mass of 1 5 cm h an opposite behavior is instead observed for the scenario with the higher background concentration in which the plume moves upwards due to the buoyancy effects and the first central moment in the vertical direction increases at a rate of 0 4 cm h for the case ek high the center of mass moves upwards for the first 10 min and at later times as allura red is concentrated in the domain as a result of charge interactions the density of the plume increases and this leads to the sinking of the plume the spatial covariance indicates the spreading of the mass of the allura red plume around the center of mass for the advective scenarios the spatial covariance along the longitudinal direction fig 7c are all similar and their value is lower than the ek scenarios as the allura red plumes tend to be less spread under advective transport indeed the ek scenarios are affected by electrostatic interactions and their spreading along the longitudinal direction are considerably higher than the advective scenarios for the cases of ek low and ek similar however for scenario ek higher the spreading is lower than the advective scenarios as the plume shrinks due to charge interactions considering the spreading along the transverse direction fig 7d the advective scenarios are affected by density effects with the case of low background concentration exhibiting the largest variation due to the largest density gradients for the electrokinetic scenario the behavior has a similar trend with respect to the longitudinal direction the major difference is for scenario ek high in which the spreading decreases for the first 40 min due to the charge interactions that shrink the plume but increase at later times due to density driven effects which deform the plume fig 7e shows the longitudinal skewness which is relatively low for the advective scenarios indicating a symmetric shape throughout the considered period however for the ek scenarios the longitudinal skewness is considerably larger for scenario ek low and ek similar in the first part of the experiments indicating that the peak of the plume is shifted on the left with a larger tail on the right the opposite is observed for ek high which presents a negative longitudinal skewness for the first part of the experiment the transverse skewness for the advective dispersive scenarios fig 7f is higher than the longitudinal skewness indicating that for the cases low and similar the peak of the plume is towards the bottom and the larger tail is at the top of the plume a similar behavior due to density effects can also be observed for scenarios ek low and ek similar conversely due to buoyancy effects the advective dispersive scenario with high background electrolyte concentrations presents a negative skewness which decreases over time indeed due to the induced density driven flows by charge interactions the respective scenario ek high does not present such behavior and its transverse skewness is positive and similar to the one of scenario ek low the dilution index computed for the allura red plumes in all scenarios over time is shown in fig 8 in the case of advective dispersive transport the dilution index increases over time with a quasi linear trend kitanidis 1994 fig 8 also indicates that there are small differences between the advective dispersive scenarios which are due to the density effects that impact the mass distribution and thus the effective volume occupied by the plume for the ek scenarios the change in the dilution index is considerably different in case the background has a lower concentration than the injected allura red the dilution index has the highest value of all cases as the tracer mass is distributed over a larger volume of the porous medium the ek scenario with similar background concentration results in a lower dilution index however the values obtained are larger than those computed in all advection dispersion cases finally the case of ek transport with high background electrolyte concentration shows a particularly interesting non monotonic trend the electrostatic interactions and the electroneutrality constraint cause a decrease of the plume entropy as a consequence of its shrinking and increase in concentration after this initial phase as the more concentrated and denser allura red plume moves downwards the dilution index increases again due to the effect of diffusive dispersive mass transfer as the plume is transported in the porous medium note that such effect cannot fully compensate the dilution decrease due to the coulombic interactions and the final value of the dilution index is smaller than the initial dilution of the injected allura red plume the understanding of the observed mixing patterns is especially important for field applications as ek remediation since this emerging in situ technology is based on electrokinetic delivery of reactants the latter include strong oxidants such as permanganate and persulfate for in situ chemical oxidation ek isco as well as substrates e g lactate to stimulate microbial activity ek bio in all cases mixing of the reactants with the target contaminants is of pivotal importance therefore the understanding of mixing behavior and the quantification of mixing metrics is useful to identify compare and design the best delivery strategies 5 conclusions this study provided experimental evidence on the important role of density driven effects during electrokinetic transport the outcomes of the investigation demonstrate that coulombic interactions driven by electromigration not only impact the concentration of charged species but also trigger density driven effects and therefore modify the flow field and cause advective displacement moreover such interactions also generate non trivial patterns which affect concentration gradients and strongly influence mixing and spreading of the plumes at different times note that this study focuses on homogeneous granular porous media however future experimental efforts should also consider other types of porous media and include heterogeneities field applications also entail more complex relations with the geochemistry and additional interactions with hydraulic and electroosmotic flow triggered by the heterogeneities such effects should be taken into account for proper understanding and optimal design of in situ interventions in this study numerical simulations were performed with the new code np phreeqc ek density taking into account variable density flow and including a precise computation and update of the aqueous solution density in the porous medium domain based on the properties of all species in the pore water the process based simulations allowed us to interpret the experimental results and to visualize the spatial distribution and temporal evolution of quantities which could not be directly observed in the experiments besides unveiling the coupling between coulombic interactions and density effects during electrokinetic transport and thus providing insights into the fundamental understanding of these complex mechanisms the outcomes of this study are of practical relevance for field applications the design of remediation interventions in heterogeneous domains with the presence of low and high conductivity porous media should consider the effects of density as it is possible that the injected amendments sink to the lower part of the aquifer in case of groundwater with low ionic strength or where buoyancy effects occur in formations with high content of total dissolved solids to this end the use of process based models is instrumental to assist in the design of practical interventions for instance to improve the dosing and duration of reactant delivery to target the distribution of amendments and to optimize degradation kinetics and contaminant removal credit authorship contribution statement riccardo sprocati conceptualization methodology formal analysis data curation software writing original draft andrea gallo methodology formal analysis data curation writing review editing marie boeskov caspersen methodology formal analysis data curation writing review editing massimo rolle conceptualization methodology supervision project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge the support of the villum fonden grant 40682 and the independent research fund denmark grant 1127 00013b supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2023 104422 appendix supplementary materials image application 1 
42,electrokinetic ek techniques can effectively mobilize amendments and contaminants in porous media and therefore have a great potential for in situ subsurface remediation of a wide variety of organic and inorganic contaminants however the fundamental mechanisms governing ek applications in porous media are complex and entail coupling between different flow transport electrostatic and geochemical processes in this study we investigate the interactions between density driven effects and electrokinetic transport in permeable porous media and we compare the observed dynamics with the outcomes of analogous scenarios in which advection and dispersion are the only transport mechanisms we perform a series of multidimensional experiments and we demonstrate the strong interplay between coulombic interactions among charged species in pore water and density driven effects during electrokinetics our study illuminates non trivial interactions between the pore water composition and the macroscopic behavior of variable density dye tracer plumes showing different sinking and floating patterns distinct plume shapes and spreading as well as different extent of mixing depending on the chemical composition of the pore water a numerical model based on the nernst planck poisson formulation and on the coupling with the geochemical code phreeqc was developed to simulate variable density flow and transport and to update the density of the aqueous solution resulting from mixing and electrostatic interactions between all chemical species in the injected plume and in the surrounding pore water electrolyte the model allowed us to interpret the experiments and to visualize the impact of small density gradients and coulombic effects on the macroscopic transport of the dye tracer the outcomes of this study highlight the importance of density driven flow also during ek transport where the electrostatic interactions not only influence the concentration of charged species but can also affect the density and result in complex flow patterns plume shapes and mixing behavior radically different from the ones generated during advective dispersive transport data availability data will be made available on request 1 introduction electrokinetics in porous media involves the application of an electric field to induce the transport of solutes the main transport processes include electromigration consisting in the movement of ions in the direction of opposite charge acar and alshawabkeh 1993 reddy and cameselle 2009 and electroosmosis which entails a net movement of water as a result of the excess of charge in the double layer godinez brizuela and niasar 2020 wen et al 2021 yustres et al 2020 in the context of remediation of contaminated sites electrokinetic techniques are typically considered for the enhancement of transport in low permeability porous media such as clayey and silty soils as both electromigration and electroosmosis can effectively displace solute species at significantly higher rates compared to what is possible to achieve with pressure gradients and or diffusive transport gill et al 2021 head et al 2020 inglis et al 2021 lima et al 2017 mao et al 2012 sprocati and rolle 2021 wu et al 2012 density driven flow in porous media occurs as a difference in concentration leading to a difference in density which generates a convective flow due to gravitational forces diersch and kolditz 2002 voss and souza 1987 such phenomena occur for a broad range of geophysical flows with impacts at different scales for instance in groundwater systems density driven flows play a key role in determining the hydrodynamic behavior and the water quality in coastal aquifers etsias et al 2021 geng et al 2020 hamzehloo et al 2022 robinson et al 2018 werner et al 2013 as well as in the transport of contaminants and amendments bakhtyar et al 2013 henderson et al 2009 pool and dentz 2018 post and prommer 2007 simmons et al 2001 most of the studies of density driven flow consider relatively high permeability porous media such as sandy soils where density effects have a stronger impact on downward velocities although density is not typically considered in combination with ek transport which normally targets low permeability formations ek techniques have a largely unexplored potential for the remediation of permeable formations and of heterogeneous systems with both high and low permeability materials brooks et al 2021 chowdhury et al 2017 gill et al 2015 muniruzzaman and rolle 2021 2019 reynolds et al 2008 sprocati and rolle 2022 in such conditions density driven effects can play a key role in the transport of solutes and in the targeted distribution of reactants therefore a detailed understanding of the phenomena and of the interplay between density driven flow and transport processes with electrokinetic mechanisms is necessary to guide the design and the implementation of field scale interventions the goal of this study is to explore the fundamental mechanisms of density effects during electrokinetic transport in permeable porous media laboratory experiments were performed to investigate the impact of variable density flow and transport in three ek transport scenarios characterized by different concentrations and density gradients between the injected dye tracer plume and the background electrolyte solution in the pore water analogous experiments were carried out in the same setup in absence of the imposed external electric field with an hydraulic gradient to drive the water flow and with advection and dispersion as the sole transport mechanisms to interpret the experimental results we developed a process based model which is instrumental to understand and visualize the main processes to quantify the impacts of the different transport mechanisms and to unveil the key role of microscopic coulombic interactions on the macroscopic observations we also present an analysis of plume displacement spreading skewness and mixing to quantitatively interpret the complex transport patterns in the scenarios investigated 2 materials and methods the experiments are conducted in a quasi two dimensional chamber consisting of two glass panels held together by an aluminum frame fig 1 the inner size of the chamber is 795 mm 182 mm 11 mm and the porous medium is present in the central part 300 mm 180 mm 11 mm and separated from the reservoirs by a hollow acrylic frame covered with a black fabric the porous medium used in this study consists of glass beads with a grain size in the range of 0 40 0 60 mm sigmund lindner germany with hydraulic conductivity kh 2 50 10 3 m s and electroosmotic coefficient keo 1 10 10 8 m2 v s sprocati and rolle 2022 the porous medium was filled in the tank using a wet packing procedure haberer et al 2015 in all experiments allura red sigma aldrich germany a divalent negatively charged dye was used as a visible tracer due to its red color the tracer solution 8 ml with a concentration of 10 mm was initially injected with a needle inside the porous medium a first set of experiments investigated advective dispersive transport of allura red in three different scenarios entailing different concentration and therefore density between the injected tracer solution and the resident pore water the scenarios had differed concentration of the bicarbonate buffer nahco3 na2co3 used in the pore water which was 4 times lower than the allura red solution scenario low of similar concentration as the allura red solution scenario similar and 4 times higher than the allura red solution scenario high respectively a summary of the solution concentrations in the different experiments is presented in table 1 the advective flow in the setup was established with a multichannel peristaltic pump shenchen china providing a seepage velocity inside the porous medium of 6 5 cm h the second set of experiments investigated the ek transport of allura red in the same hydrochemical scenarios considered for the advection dispersion experiments in these experiments an electric potential was applied in the system through a pair of graphite electrodes ø6 300 mm elektrokul denmark which were placed in the reservoirs adjacent to the porous medium and at a distance 0 40 m between each other the electrodes were connected to a power supply unit ea elektro automatik ea psi 5200 10a germany operated at constant voltage of 200 v the current in the system was measured with a multimeter peaktech 3315 germany connected in series to the circuit the electric potential in the porous medium was measured with a multimeter peaktech 3315 germany in which the circuit consisted of a pair of wires spaced 0 28 m and placed 1 cm below the water table two external reservoirs with a volume of 2 l each were filled with the same background electrolyte of the pore water and were connected to the internal reservoirs to provide additional volume in the system to minimize the influence of electrolysis reactions the recirculation between the external and internal reservoirs was performed with a multichannel peristaltic pump at a constant recirculation rate of 20 ml min during the experiments photographs were taken every 30 min with a reflex camera nikon d300 with lens af s nikkor 50 mm f 1 4 g in a dark room the setup was illuminated from the back with an electroluminescent panel 1000 mm 300 mm el technik germany and from the front with a light bulb 4000 k 806 lm 100 ma 9 5 w philips netherlands the density of the background electrolytes and of the allura red solution was experimentally measured with a pycnometer blaubrand density bottle gay lussac pattern 10 ml in order to ensure a constant temperature during the measurement of the density the flasks containing the solutions were kept in a water bath at room temperature and only extracted for the test for each tested sample three measurements were made and the measured values are summarized in table s1 supplementary material 3 theoretical background and numerical implementation the mass balance for the liquid is expressed as nick et al 2009 1 n ρ t ρ q 0 where n is the porosity ρ is the density of the solution and q is the total water flux which in the context of electrokinetic applications is the sum of the hydraulic q h and the electroosmotic q eo fluxes sprocati and rolle 2022 2 q q h q eo the hydraulic velocity for a fluid of variable density is 3 q h k h ρ g p ρ g where kh is the hydraulic conductivity g is the gravity constant p is the pressure gradient and g is the gravity vector the electroosmotic flux is jacobs and probstein 1996 4 q eo k eo φ in which keo is the electroosmotic coefficient and φ is the electric potential gradient in this work the density is calculated using the helgeson kirkham flowers modified redlich rosenfeld hkfmorr equation appelo 2015 appelo et al 2014 parkhurst and appelo 2013 which considers the contribution of each dissolved species in the aqueous solution such approach is necessary during multicomponent transport when species are transported at different velocities and in case of ek transport also in different directions using the hkfmorr equation the density of the solution is evaluated as 5 ρ ρ 0 1000 m i m w i 1000 ρ 0 m i v m i where mi is the molality of species i mwi its molar weight and ρ0 is the density of pure water i e 0 997770 kg l at 22 c the molar volume v m i is calculated as appelo et al 2014 6 v m i v m i 0 a v 0 5 z i 2 i 0 5 1 å i b γ i 0 5 b 1 i b 2 i t 228 b 3 i t 228 i b 4 i in which av is the debye hückel limiting slope b γ is the debye length parameter i is the ionic strength of the solution t is the temperature and v m i 0 is the molar volume at infinite dilution evaluated as 7 v m i 0 41 84 0 1 a 1 i 100 a 2 i 2600 p b a r a 3 i t 228 10 4 a 4 i 2600 p b a r t 228 w i ε r 1 p b a r where a 1 4 wi å and b 1 4 are fitting parameters pbar is the pressure of the solution in bar and ε r is the relative dielectric constant of pure water the transport of dissolved species is described by the nernst planck equations which consider the total flux j i tot to be the result of diffusive fluxes j i dif electromigration fluxes j i mig and advective fluxes j i adv alt epping et al 2015 newman and thomas alyea 2004 rasouli et al 2015 rolle et al 2022 8 j i tot n d i c i j i dif n d i z i f rt c i φ j i mig q c i j i adv in which ci is the concentration of the aqueous species zi is the charge f is the faraday constant r is the gas constant and t is the temperature in electrokinetic applications d i d i a q τ where τ is the tortuosity whereas in absence of an external electric field di is the tensor of hydrodynamic dispersion coefficient which in the longitudinal direction is parameterized as guedes de carvalho and delgado 2005 muniruzzaman and rolle 2017 9 d i l d i 0 5 ud where d i d i a q n is the pore diffusion coefficient with d i a q the aqueous diffusion coefficient u q n is the seepage velocity along the main flow direction and d is the average grain size diameter of the porous medium in the transverse direction the dispersion coefficient is expressed as rolle et al 2013 2012 10 d i t d i d i a q p e i 2 p e i 2 4 δ 2 β in which p e i u d d i a q is the grain péclet number δ is the ratio between the length of a pore channel and its hydraulic radius and β is an empirical exponent representing the effect of incomplete mixing in the pore channels for the porous medium used in this study values of δ 5 37 and β 0 5 have been used as determined in previous studies hochstetler et al 2013 ye et al 2015 the mass balance for the aqueous species is 11 n c i t j i tot r i the charge balance in the system is considered with the poisson equation newman and thomas alyea 2004 12 2 φ f ε i 1 n z i c i ρ e ε where ε is the dielectric constant of the porous medium ρ e is the charge density and n is the total number of charged species in case electric potentials are not applied at the boundaries the current density i in the system is zero however in case of ek transport i 0 and the current conservation is considered 13 i f i 1 n z i j i tot f i 1 n z i n d i c i f 2 i 1 n z i 2 n d i rt c i φ fn u i 1 n z i c i in this study an analysis of the spatial distribution of the tracer mass and of the plume behavior was performed considering different metrics to this end we computed the spatial moments of the tracer concentration distribution as freyberg 1986 liu et al 2004 14 m i m n t c i x y t x m y n d x d y where m i mn is the mnth order spatial moment of the species i in a two dimensional domain the zero order moment m i 00 indicates the total solute mass in the system whereas the first order moments normalized by the total mass provide the position of the center of mass of the plume x i c y i c 15 x i c m i 10 m i 00 x i c m i 01 m i 00 the second order moments provide an indication of the spreading of the plume through the spatial covariance σ i x x 2 σ i y y 2 in the longitudinal and transverse directions 16 σ i x x 2 m i 20 m i 00 x c 2 σ i y y 2 m i 02 m i 00 y c 2 the third order moments indicate the asymmetry of the plume through the skewness coefficients γ x γ y expressed as liu et al 2004 17 γ x m i 30 m i 00 3 m i 10 m i 20 m i 00 2 2 m i 10 m i 00 3 σ i x x 3 γ y m i 03 m i 00 3 m i 01 m i 02 m i 00 2 2 m i 01 m i 00 3 σ i y y 3 besides the spreading and shapes of solute plumes it is important to characterize their mixing with the surrounding pore water e g dentz et al 2011 rolle and le borgne 2019 in this work we used the dilution index to quantify mixing of the tracer plumes such mixing metric is defined as the exponent of the shannon entropy kitanidis 1994 18 e t exp ω p i x t l n p i x t d ω in which 19 p i x t c i x t ω c i x t d ω the dilution index quantifies dilution as the distribution of a solute mass over an increasing volume and physically represents a porous medium volume occupied by the plume kitanidis 1994 rolle and kitanidis 2014 process based modeling in this study was performed with a new version of the codes np phreeqc rolle et al 2018 and np phreeqc ek sprocati et al 2019 called np phreeqc ek density these codes combine comsol multiphysics to solve for the fluid flow and multicomponent transport equations with phreeqcrm parkhurst and wissmeier 2015 to compute kinetic and equilibrium bio geochemical reactions ahmadi et al 2022 sprocati et al 2020 the specific features of model development for this study include the consideration of variable density flow and the accurate computation of the solution density using the hkfmorr equation the model uses a sequential non iterative coupling approach ahmadi et al 2022 barry et al 1996 sprocati et al 2019 schematically illustrated in fig 2 in which the first step consists in the solution of the flow and multicomponent ionic transport in comsol multiphysics where the primary variables are the pressure the concentration of the transported species and the electric potential the system of equations is solved using the finite element method the subsequent reactive step consists in the calculation in phreeqcrm of the equilibrium reactions for aqueous speciation and the calculation of the fluid density according to the hkfmorr equation using the values of concentration pressure and temperature from comsol such values are then passed back to comsol as initial conditions for the next transport step the parameters for the calculation of the solution density have been taken from the phreeqc dat database with the exception of allura red which contribution was fitted calibrating phreeqc simulations with the experimental data the models considered the transport of 9 species with the respective aqueous diffusion coefficients listed in table s3 the geometry of the model is illustrated in figure s2 and consists of a two dimensional domain with size 29 cm 15 cm all models are built in comsol multiphysics using a triangular mesh with 10 020 elements and the system of equations for every mesh node is solved using the pardiso solver boundary conditions included values for the electric potential as obtained from the experiments table s2 as well as constant concentration boundaries the initial water pressure at the boundaries p b 0 was defined as 20 p b 0 ρ g h 0 d y in which h 0 is the water level and dy is the depth coordinate with the zero in correspondence to the water level the water levels in the reservoirs were connected to the flow in the porous medium 21 h t a f w s 1 q n h w where afws is the area of the free water surface of each reservoir q n is the normal component of the water flux h is the water level and w is the width of the setup 4 results and discussion prior to the transport experiments the density contribution of allura red was estimated to accurately describe the behavior of the injected dye tracer plumes to this end we measured the density of different solutions with variable background electrolyte concentration and allura red concentrations the comparison between the experimental observations and phreeqc simulations with the calibrated values for allura red a 1 60 cal mol according to eq 7 is shown in figure s1 in all the experiments the density increases with the concentration and phreeqc predictions are close to the measurements in the following we present the results of the advection dispersion and ek transport experiments first we consider the case of a solution of the background electrolyte with a concentration approximately 4 times lower than the concentration of the injected allura red plume scenario low fig 3 presents the experimental and simulation results for both advective and electrokinetic transport scenarios in the advection dispersion scenario the allura red plume has a concentration 10 mm higher than the background electrolyte 0 1 mm na2co3 1 8 mm nahco3 this entails a higher density of the injected solution 1000 25 kg m3 with respect to the background pore water 997 89 kg m3 resulting in a progressive sinking of the tracer plume the photographs show that the plume moves from left to right due to the imposed hydraulic flow but also migrates downwards and reaches the bottom of the setup after 90 min as a result of the density gradient the tracer plume has a sharper front at the bottom and a smoother front at the top the reason for such behavior is that the plume which initially was symmetric starts to sink with higher velocities where the concentration and thus the density is higher over time the portion of the plume with the highest concentration is transported downwards creating the sharp concentration profile at the bottom the variable density flow and advective dispersive simulations capture the observed plume displacement as well as the formation of asymmetric concentration fronts at the bottom and fringes of the tracer plume in the ek experiment the behavior is very different from the advection dispersion case and it is possible to identify two main transport mechanisms the first mechanism involves the movement of the tracer by electromigration towards the anode such displacement is strongly affected by the charge interactions due to which the tracer can only be transported in the domain at a concentration that is similar to the one of the background rolle et al 2022 sprocati et al 2021 as a result a portion of the plume of allura red with concentrations comparable with the charge content of the background pore water moves horizontally and spreads across a wide portion of the porous medium the second mechanism involves density effects which impact the initial injection of allura red during the experiment on the left side of the allura red plume there is an area with a concentration similar to the initial values 10 mm which is subjected to gravity forces and that sinks at a faster rate with respect to the rest of the plume indeed the transported front which moves horizontally in the domain as a result of electromigration being at a lower concentration and therefore with a concentration more similar to the background electrolyte does not appear to be affected by density effects the process based numerical model allows reproducing the complex behavior that originates from the coupling of flow transport and electrostatic processes and requires the precise computation of the spatio temporal evolution of the solution density as discussed above the latter task is performed by the coupling with phreeqcrm and the solution of the hkfmorr equation in the scenario in which the concentration of the background electrolyte 0 5 mm na2co3 9 mm nahco3 is similar to the concentration of the injection of the allura red plume 10 mm the experiments indicate that also in this case the advective dispersive transport is affected by downwards density effects fig 4 however in this scenario the allura red plume appears to sink with a lower velocity with respect to the scenario low as the density difference between the allura red solution 1000 25 kg m3 and the background electrolyte 998 38 kg m3 is reduced in the case of ek transport due to the higher concentration of the background electrolyte allura red can be transported with a higher concentration with respect to the scenario low here the plume appears to be larger than the initial injection as a result of charge interactions which still limit the concentration of allura red that can migrate in the domain note that such electrostatic phenomena occur due to the charge balance between ions in solution and that in the considered scenario allura red charge 2 reaches a concentration that is about half the one of the anion with the highest concentration in the background hco3 rolle et al 2022 considering the scenario high the concentration of the background electrolyte 2 5 mm na2co3 45 mm nahco3 is higher than the concentration of the allura red solution 10 mm the advection dispersion experiments show that the injected plume tends to move upwards with respect to its initial position fig 5 such behavior is the result of the higher density of the background 1000 81 kg m3 which creates a buoyancy effect for the injected allura red plume 1000 25 kg m3 in this case the behavior of the plume along the vertical direction is opposite with respect to the previous cases and the plume appears with a sharper front on top and a smoother front on the bottom in the ek transport scenario allura red moves as a result of electromigration and due to the higher concentration of the background electrolyte the plume shrinks in size as the concentration of allura red needs to increase to balance the charges in the domain as the increase in concentration also corresponds to an increase in density the plume of allura red quickly sinks indeed at the top of the plume the concentration remains lower and it is less affected by the gravity effects it is interesting to note that the shape of the plume in this case is remarkably different from the cases previously analyzed and appear to be elongated along the vertical direction due to the combination of charge interactions and density effects which respectively compress the plume and move the part with the highest concentration and density downwards the model outcomes capture such complex behavior and highlight that charge interactions not only have an effect on the concentration of the species that move with electromigration but due to density effects can also generate variable density flow and thus downward transport of the tracer plume to analyze more in detail the mechanisms at the basis of the experimental observations the process based simulations are used to visualize the spatial distribution of the density its temporal evolution as well as the variable density velocity fields fig 6 considering the cases of advective dispersive transport the density of allura red is higher than the density of the background electrolyte for the scenarios low and similar fig 6a and b respectively consequently there is a downward movement of the plume which is identified in fig 6g h by the highest velocity of the plume at the bottom right and top left corner of the tracer such transport direction is caused by the combination of the uniform advective velocity of the flow towards the right and the falling velocity of the plume caused by gravity for the advection dispersion scenario with high background fig 6c the density of the allura red solution is lower with respect to the surrounding pore water as a result the effect of gravity leads the allura red plume to be transported upwards and this can also be seen from the simulated velocity field in fig 6i for the scenario ek low the injection has a higher density with respect to the background fig 6d however as the plume moves its lower concentration resulting from the coulombic effects and the electroneutrality constraint is not sufficient to significantly impact the density indeed the higher concentration of the injection generates a flow downwards fig 6j which would not be present in the absence of density gradients for the ek transport scenario in which the concentration of the background is similar to the concentration of allura red the charged tracer affects the density of the background during transport fig 6e although such density change is lower with respect to the value of the injection the reason for such behavior is again due to charge interactions which allow allura red to only enter in the domain with a lower concentration than the background due to its double negative charge however in the original position of the injection the density is slightly higher than the background electrolyte this is the result of the coupled effects of electromigration and charge interactions as allura red is mobilized other anions compensate its role to maintain the electroneutrality of the solution indeed as other ions have different charges diffusion coefficients and contribution to the density the density in that position changes accordingly the downward velocity of the plume in this scenario is higher at the beginning as the density difference is larger fig 6k over time as allura red is transported by electromigration the density of the remaining core of the allura red plume decreases thus progressively reducing the impact of density driven effects on the overall transport for the scenario ek high fig 6f indicates that although the initial density of the allura red plume is lower than the background as allura red is transported in the domain by electromigration its increase in concentration due to the coulombic interactions and the electroneutrality constraint also results in an increase in density at the same time as observed in the scenario ek similar the location where allura red has been injected retains a lower density than the background electrolyte due to charge interactions in this case while the zone of higher density sinks the model shows that the zone of lower density where the injection took place moves upwards fig 6l from fig 6g i it can be concluded that in all the advection dispersion scenarios the effects of density are localized in proximity of the allura red plume which is where the highest differences of density occur however in the case of ek transport since electromigration causes the transport of ions in different directions and at different velocities density effects occur in different parts of the domain and also in areas in which allura red is no longer present due to the perturbation of the concentration of the other charged species in the pore water fig 6j l the non trivial interactions between ek transport mechanisms and the resulting flow field are visualized by the streamlines which indicate that also in simple homogeneous porous media such coupled phenomena result in complex flow fields characterized by the presence of secondary motions and convective rolls the process based models also allow a detailed analysis of the tracer plume behavior including its displacement spreading and symmetry fig 7a shows that for all the advection dispersion scenarios the displacement of the center of mass in the horizontal direction occurs at the same velocity in this case the main displacement mechanism is the horizontal flow induced by the pressure difference between the two reservoirs which results in a uniform seepage velocity in the homogeneous porous medium indeed for the ek scenarios the behavior is different with scenario ek high showing the fastest displacement of the plume center of mass and the scenario ek low showing the slowest displacement this is the consequence of the charge interactions in the pore water for which in the ek high case the plume concentrates and moves rapidly whereas with scenario ek low the plume is largely deformed and can only migrate in the domain at a low concentration in the vertical direction fig 7b shows that the advection dispersion scenario with the lowest background concentration exhibits the fastest sinking velocity in the order of 2 cm h similarly the scenario with similar concentrations indicates a sinking velocity of the center of mass of 1 5 cm h an opposite behavior is instead observed for the scenario with the higher background concentration in which the plume moves upwards due to the buoyancy effects and the first central moment in the vertical direction increases at a rate of 0 4 cm h for the case ek high the center of mass moves upwards for the first 10 min and at later times as allura red is concentrated in the domain as a result of charge interactions the density of the plume increases and this leads to the sinking of the plume the spatial covariance indicates the spreading of the mass of the allura red plume around the center of mass for the advective scenarios the spatial covariance along the longitudinal direction fig 7c are all similar and their value is lower than the ek scenarios as the allura red plumes tend to be less spread under advective transport indeed the ek scenarios are affected by electrostatic interactions and their spreading along the longitudinal direction are considerably higher than the advective scenarios for the cases of ek low and ek similar however for scenario ek higher the spreading is lower than the advective scenarios as the plume shrinks due to charge interactions considering the spreading along the transverse direction fig 7d the advective scenarios are affected by density effects with the case of low background concentration exhibiting the largest variation due to the largest density gradients for the electrokinetic scenario the behavior has a similar trend with respect to the longitudinal direction the major difference is for scenario ek high in which the spreading decreases for the first 40 min due to the charge interactions that shrink the plume but increase at later times due to density driven effects which deform the plume fig 7e shows the longitudinal skewness which is relatively low for the advective scenarios indicating a symmetric shape throughout the considered period however for the ek scenarios the longitudinal skewness is considerably larger for scenario ek low and ek similar in the first part of the experiments indicating that the peak of the plume is shifted on the left with a larger tail on the right the opposite is observed for ek high which presents a negative longitudinal skewness for the first part of the experiment the transverse skewness for the advective dispersive scenarios fig 7f is higher than the longitudinal skewness indicating that for the cases low and similar the peak of the plume is towards the bottom and the larger tail is at the top of the plume a similar behavior due to density effects can also be observed for scenarios ek low and ek similar conversely due to buoyancy effects the advective dispersive scenario with high background electrolyte concentrations presents a negative skewness which decreases over time indeed due to the induced density driven flows by charge interactions the respective scenario ek high does not present such behavior and its transverse skewness is positive and similar to the one of scenario ek low the dilution index computed for the allura red plumes in all scenarios over time is shown in fig 8 in the case of advective dispersive transport the dilution index increases over time with a quasi linear trend kitanidis 1994 fig 8 also indicates that there are small differences between the advective dispersive scenarios which are due to the density effects that impact the mass distribution and thus the effective volume occupied by the plume for the ek scenarios the change in the dilution index is considerably different in case the background has a lower concentration than the injected allura red the dilution index has the highest value of all cases as the tracer mass is distributed over a larger volume of the porous medium the ek scenario with similar background concentration results in a lower dilution index however the values obtained are larger than those computed in all advection dispersion cases finally the case of ek transport with high background electrolyte concentration shows a particularly interesting non monotonic trend the electrostatic interactions and the electroneutrality constraint cause a decrease of the plume entropy as a consequence of its shrinking and increase in concentration after this initial phase as the more concentrated and denser allura red plume moves downwards the dilution index increases again due to the effect of diffusive dispersive mass transfer as the plume is transported in the porous medium note that such effect cannot fully compensate the dilution decrease due to the coulombic interactions and the final value of the dilution index is smaller than the initial dilution of the injected allura red plume the understanding of the observed mixing patterns is especially important for field applications as ek remediation since this emerging in situ technology is based on electrokinetic delivery of reactants the latter include strong oxidants such as permanganate and persulfate for in situ chemical oxidation ek isco as well as substrates e g lactate to stimulate microbial activity ek bio in all cases mixing of the reactants with the target contaminants is of pivotal importance therefore the understanding of mixing behavior and the quantification of mixing metrics is useful to identify compare and design the best delivery strategies 5 conclusions this study provided experimental evidence on the important role of density driven effects during electrokinetic transport the outcomes of the investigation demonstrate that coulombic interactions driven by electromigration not only impact the concentration of charged species but also trigger density driven effects and therefore modify the flow field and cause advective displacement moreover such interactions also generate non trivial patterns which affect concentration gradients and strongly influence mixing and spreading of the plumes at different times note that this study focuses on homogeneous granular porous media however future experimental efforts should also consider other types of porous media and include heterogeneities field applications also entail more complex relations with the geochemistry and additional interactions with hydraulic and electroosmotic flow triggered by the heterogeneities such effects should be taken into account for proper understanding and optimal design of in situ interventions in this study numerical simulations were performed with the new code np phreeqc ek density taking into account variable density flow and including a precise computation and update of the aqueous solution density in the porous medium domain based on the properties of all species in the pore water the process based simulations allowed us to interpret the experimental results and to visualize the spatial distribution and temporal evolution of quantities which could not be directly observed in the experiments besides unveiling the coupling between coulombic interactions and density effects during electrokinetic transport and thus providing insights into the fundamental understanding of these complex mechanisms the outcomes of this study are of practical relevance for field applications the design of remediation interventions in heterogeneous domains with the presence of low and high conductivity porous media should consider the effects of density as it is possible that the injected amendments sink to the lower part of the aquifer in case of groundwater with low ionic strength or where buoyancy effects occur in formations with high content of total dissolved solids to this end the use of process based models is instrumental to assist in the design of practical interventions for instance to improve the dosing and duration of reactant delivery to target the distribution of amendments and to optimize degradation kinetics and contaminant removal credit authorship contribution statement riccardo sprocati conceptualization methodology formal analysis data curation software writing original draft andrea gallo methodology formal analysis data curation writing review editing marie boeskov caspersen methodology formal analysis data curation writing review editing massimo rolle conceptualization methodology supervision project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge the support of the villum fonden grant 40682 and the independent research fund denmark grant 1127 00013b supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2023 104422 appendix supplementary materials image application 1 
43,transport processes in the subsurface are coupled with the heterogeneity of the porous structure obtaining an accurate description of mass transport in such media at all time scales remains a crucial task as the subsurface is strongly impacted by human activity spreading of pollutants in the transient but also in the asymptotic regime as well as the time to reach a critical location e g aquifer well significantly depend on the underlying heterogeneity of the permeability field moreover in the case of solute retention transport is also characterized by local exchange kinetics that depend on the local aquifer properties consequently exchange retention times are expected to be spatially heterogeneous in this work we focus on the influence of spatially heterogeneous permeability and exchange times on the transient and asymptotic transport regimes and provide a parametric study to this goal we simulate in a first part the transport in a two dimensional heterogeneous medium under spatially varying permeability and mobile immobile mass transfer parameters equations are solved using a lattice boltzmann two relaxation time trt algorithm we assume the following relation between the local permeability k and the local exchange time τ k γ taking into account this relation we investigate the impact of the damköhler number d a ratio of the advection and exchange time scales the disorder of the permeability field and the value of the exponent of the coupling function γ on the spatial evolution of the concentration field and breakthrough curve we show that depending on the parameters d a γ etc we can observe transient non fickian dispersion which is characterized by non exponential tails of the solute breakthrough curves and a non linear evolution of the spatial variance of the solute distribution in a second part we present a new continuous time random walk ctrw model to upscale these transport behaviors the model is based on a spatial markov model for particle velocities that couples advective dispersive transport and heterogeneous mass transfer through a compound poisson process the upscaled model can be fully parameterized by the statistics of permeability and the hydraulic gradient with no fitting parameter that is in terms of medium and flow characteristics the results of the ctrw model fully capture the non fickian transient transport regimes both for the breakthrough curves and spatial concentration variance in the longtime limit as expected from the central limit theorem the ctrw model predicts normal fickian behavior finally we show that the time to reach the asymptotic regimes in heterogeneous media e g heterogeneous exchange times is parameter dependent and in average is two orders of magnitude larger than for the respective homogeneous case to summarize the coupling between the heterogeneous permeability field and the local mass transfer properties can strongly influence transient and asymptotic transport regimes and potentially explain experimentally observed non gaussian behaviors keywords dispersion mobile immobile model transient regimes lattice boltzmann ctrw heterogeneity data availability data will be made available on request 1 introduction pollutant transport in the subsurface is coupled to the water content and the heterogeneity of the porous medium as the subsurface is strongly influenced by human activity an accurate description of pollutant transport at all time scales still remains a crucial task indeed for example the knowledge of such transport is required for efficient water remediation and for providing access to safe drinking water for many pollutants nuclear waste pharmaceuticals etc contamination remains critical at very low concentrations and cannot be ignored for this type of pollutants long lasting low concentrations represent therefore a major issue in aquifer and soil remediation further comprehension on these transient long lasting regimes and their dependence on the porous structure is therefore crucial in the actual environmental context transport in porous media has been treated in the literature for a long time but still remains an actual topic while much research focused mainly on the asymptotic regimes further attention should be paid to the transient and often long lasting pre asymptotic regimes indeed experimental field and laboratory observations report that solute transport may not obey classical fickian dispersion non fickian transport can be attributed to the heterogeneity of the permeability field but also to sorption phenomena that may be space dependent a typical example is the reactive transport experiment performed at cape cod where reactive tracer exhibit non fickian transport behavior brusseau and srivastava 1999 despite the fact that the heterogeneity of the permeability field was rather small σ l o g κ 2 0 24 the velocity of the tracer front was decreasing over time and the variance of the plume spread more rapidly than linearly brusseau and srivastava investigated various mechanism to model this anomalous behavior they tried different model scenarios where permeability was considered to be either homogeneous or heterogeneous sorption could be linear or not with either instantaneous or rate limited kinetics results of the study show that the early time behavior of the experiment could be reasonably well fitted however in contrary the later times could be fitted only by significantly increasing the heterogeneity of the sorption kinetic coefficient in the second half of the domain the latter result points out the importance of the choice of the model parameters to describe the long time transport behaviors but also the need to carry out a parametric study dynamics of spreading and the spatio temporal extension of the pollutants in the transient but also in the asymptotic regime as well as the time to reach a critical location e g aquifer well housing strongly depend on the underlying heterogeneity of the porous medium this dependence has been pointed out by dai et al 2004 ren et al 2022 by performing transport simulations in porous media characterized by different criteria anisotropy correlation length scales however transport also depends on the spatial variability of exchange kinetics between mobile and immobile solute phases first order exchange kinetics have been used to quantify diffusive mass transfer between high and low velocity zones as well as linear kinetic sorption desorption reactions haggerty and gorelick 1995 as most pollutants are subject to sorption phenomena the impact of heterogeneity on large scale transport has been largely treated in the literature and quantified in the framework of stochastic modeling for the spatially fluctuating exchange parameters and permeability rubin 2003 numerical simulations selroos and cvetkovic 1992 tompson 1993 selroos and cvetkovic 1994 burr et al 1994 were used to determine the ensemble averaged center of mass velocity and dispersion coefficients or temporal moments analytical studies have used first order perturbation theory in the heterogeneity variance to investigate large scale transport under heterogeneous conductivity and homogeneous kinetic mass transfer quinodoz and valocchi 1993 dagan and cvetkovic 1993 massabó et al 2008 soltanian et al 2015 under heterogeneous conductivity and mass transfer properties cvetkovic and shapiro 1990 cvetkovic et al 1998 miralles wilhelm and gelhar 1996 rajaram 1997 dentz et al 2000 and under homogeneous conductivity and heterogeneous sorption properties metzger et al 1996 reichle et al 1998 attinger et al 1999 however it is important to stress that all these studies focus on the asymptotic stationary regime and aim at the quantification of effective upscaled transport parameters such as effective dispersion coefficients and effective retardation coefficients note that these transport parameters are only applicable when the average concentration follows a fickian equation which is theoretically expected at very long times however as we will see later before reaching this asymptotic limit transport may exhibit anomalous behavior in consequence it suggests that the behaviors observed even at the longest times in the cape cod experiment correspond to transient regimes this is particularly supported by the fact that the velocity of the tracer front decreases with time without reaching a constant value mobile immobile models coats and smith 1964 van genuchten and wierenga 1976 haggerty and gorelick 1995 have been used to describe the impact of kinetic mass transfer between mobile and immobile medium portions on the overall solute migration in saturated and partially saturated media moreover as pointed out by several researcher e g nkedi kizza et al 1984 valocchi 1990 haggerty and gorelick 1995 all first order kinetic mass transfer models can also be applied to linear sorption problems a large number of experiments have been performed to characterize exchange times for transport in porous media with different degrees of heterogeneity griffioen et al 1998 provided a review of exchange times of a large number of laboratory experiments performed in different column samples low exchange times 5 h and more have been observed by rao et al 1980 in samples consisting of porous spheres and glass beads in contrast smettem 1984 measured tracer transport in heterogeneous soil columns and determined an average exchange time up to 125 days exchange times were computed by fitting a mobile immobile model to the experimental data however a major difference between the laboratory and the field scale lies in the fact that the latter presents often spatial variations e g tompson 1993 burr et al 1994 brusseau 1994 consequently the permeability but also the exchange time might present large spatial heterogeneity here we consider both heterogeneity in permeability and mobile immobile mass transfer which manifest in spatial variability of the flow velocity v r and the local mass transfer times τ r where r is the position vector transport of the mobile and immobile concentrations c m and c i m can then be modeled as e g cvetkovic and shapiro 1990 burr et al 1994 haggerty and gorelick 1995 reichle et al 1998 1 θ m c m t u r c m d 0 2 c m 1 τ r c m c i m 2 θ i m c i m t 1 τ r c m c i m here θ m represents the constant mobile water content and θ i m the constant immobile water content for simplicity we assume that local scale dispersion is constant and isotropic as quantified by the dispersion coefficient d 0 note that we assume here for simplicity that the trapping and release rates are constant and equal to the inverse characteristic mass transfer time 1 τ r as in reichle et al 1998 experimental field and laboratory observations report that solute transport may not obey classical fickian dispersion brusseau and srivastava 1999 berkowitz et al 2006 and may be characterized by late time tailing of solute breakthrough curves and a non linear evolution of the spatial second centered moments of the solute distribution which can be quantified by stochastic perturbation theory for moderately heterogeneous media dagan 1989 such observations cannot be captured by fickian advection dispersion models that are based on constant asymptotic effective transport parameters the heterogeneity induced large scale transport dynamics are in general non fickian and converge to fickian behaviors only asymptotically dentz et al 2004 beaudoin and de dreuzy 2013 comolli et al 2019 such behaviors can often be traced back to a broad distribution of mass transfer time scales as a result of spatial heterogeneity in the physical and chemical medium properties berkowitz et al 2006 frippiat and holeyman 2008 neuman and tartakovsky 2008 dentz et al 2011 this phenomenological picture is reflected in the multirate mass transfer mrmt haggerty and gorelick 1995 carrera et al 1998 continuous time random walk ctrw berkowitz et al 2006 and time domain random walk tdrw painter and cvetkovic 2005 noetinger et al 2016 approaches these modeling approaches are typically characterized by a probability distribution function of mass transfer times which are encoded in the memory function mrmt and the transition time distribution ctrw and tdrw the mrmt approach models solute transport through advection and diffusion or dispersion in a connected mobile region and linear mass transfer between the mobile and immobile regions the mass transfer properties and distribution of residence times in the immobile regions are encoded in the memory function which relates the mobile and immobile solute concentrations the memory function of mrmt can in principle be related to the geometry and distribution of immobile regions and the underlying mass transfer processes haggerty and gorelick 1995 carrera et al 1998 zinn et al 2004 gouze et al 2008 zhang et al 2014 hidalgo et al 2020 or is fitted from observed breakthrough curves based on a parametric form for the memory function willmann et al 2008 similarly the transition time distribution in the ctrw approach is often fitted based on a suitable parametric equation dentz et al 2004 berkowitz et al 2006 the ctrw and tdrw frameworks allow to distinguish between local scale mass transfer mechanisms and to relate the transition probabilities to the heterogeneity distribution and local scale processes such as linear kinetic mass transfer margolin et al 2003 spatially variable retardation properties dentz and castro 2009 heterogeneous advection fiori et al 2007 cvetkovic et al 2014 comolli et al 2016 2019 matrix diffusion hyman and dentz 2021 and sorption and first order decay painter et al 2008 in this article we study transport in heterogeneous porous media that are characterized by spatially variable permeability and spatially variable kinetic mass transfer properties in the first part we solve numerically the direct flow and transport model described by eqs 1 2 we focus on the pre asymptotic regime where anomalous behaviors are observed and their dependence on the system parameters in the second part we use the ctrw framework to derive a new upscaled stochastic model that is able to predict non fickian pre asymptotic transport as well as the asymptotic behavior our ctrw approach uses a compound poisson process to model linear kinetic exchange under spatially heterogeneous mass transfer properties it is parameterized by the point distributions of hydraulic permeability the correlation length of log permeability local scale dispersion and advective tortuosity all of which are flow and medium properties which means that they are transport independent the model is predictive without any fitting parameter the article is structured as follows in section 2 we first detail the mobile immobile model mim for heterogeneous permeability and exchange time the generation of the permeability field and the flow equation then in section 3 we summarize the numerical simulation of the direct problem using the lattice boltzmann method and present a parametric study of the transient regimes section 4 presents a new upscaled transport model ctrw and its parameterization the ctrw model is then validated against the results of the direct simulations 2 the mobile immobile model for heterogeneous structures in this part we present in a first step the derivation of a generic scaling law to relate the exchange time τ and the permeability k then we introduce the non dimensional equations of the mobile immobile model and the dimensionless parameters for heterogeneous porous media afterwards we detail the generation of the porous medium and present the flow equation 2 1 generic scaling law to relate the exchange time τ and the permeability k the characteristic exchange time τ depends on the underlying physical or chemical process and the porous topology using a phenomenological argument one might for example expect that the characteristic diffusion time in the dead end pore scales as reichle et al 1998 τ a 2 d m with a being the typical pore size and d m the molecular diffusion coefficient assuming that k a 2 it follows that τ k the time spent in the dead end thus increases with the permeability because the pores are larger however this argument holds only if the permeability is modified by a homothetic transformation for more complex structures the residence time may be a non trivial function of the pore scale geometry for example percolation disorder is known to lead to anomalous scaling exponents koplik et al 1988 de gennes 1983 also based on field measurements burr et al 1994 proposed a power law between the permeability and the exchange time in order to be more general we thus correlate the exchange time to the permeability using a power law 3 τ a k γ where a is a scaling parameter and the exponent γ 1 1 we consider also negative γ which corresponds to an increase of residence time when the permeability decreases indeed if the lower permeability regions have dead ends with more complex shape one could expect that the residence times are indeed larger 2 2 non dimensional equations the number of variables of the mobile immobile model can be reduced by changing the time scale as t θ m t eqs 1 and 2 can then be written as 4 c m t ϕ d c i m t u c m d 0 2 c m c i m t 1 τ ϕ d c m c i m with ϕ d θ i m θ m being the ratio of the immobile volume over the mobile one dispersion is given by its coefficient d 0 d u d m where d is the dispersivity and d m the molecular diffusion note that in heterogeneous porous media the velocity u is also heterogeneous in order to investigate solely the influence of heterogeneous exchange time τ on the transport we simplified the problem and kept d 0 c o n s t as mentioned above τ is then assumed to follow eq 3 using the imposed mean flow rate u eqs 4 can be non dimensionalized by introducing a characteristic length scale λ and time scale λ u 5 c m t ϕ d c i m t u c m 1 p e 2 c m c i m t λ u ϕ d τ c m c i m two dimensionless numbers can be deduced from eqs 5 p e λ u d 0 the péclet number which characterizes the ratio of the diffusive time scale over the convective one d a λ u τ ϕ d the damköhler number corresponding to the ratio of the convection and exchange time scales here we introduce the average exchange time τ a k 0 γ where k 0 exp f 0 is the harmonic mean of the permeability field see eq 6 in the next section 2 3 porous media generation as it is often assumed to describe the permeability field gelhar and axness 1983 burr et al 1994 rubin 2003 k is generated using a correlated log normal probability distribution function pdf given by 6 pdf f ln k 1 2 π σ f e f f 0 2 2 σ f 2 where f 0 and σ f are the mean and standard deviation of ln k moreover the field f is spatially correlated according to a gaussian correlation function 7 f r 0 f r 0 r r 0 σ f 2 e x 2 y 2 λ 2 where r 0 represents the spatial average over the whole domain here we use the fixed parameters f 0 0 and λ 4 lbm lattice units the value σ f which quantifies the heterogeneity of the permeability field has been varied in the range σ f 2 0 1 5 which represents moderately heterogeneous permeability fields but includes most values reported in rubin 2003 since exchange time and permeability are related by eq 3 the distribution of the exchange times also follows a log normal distribution 8 pdf g ln τ 1 2 π σ g e g g 0 2 2 σ g 2 with g 0 γ f 0 ln a and σ g γ σ f the covariance function of g is thus given by 9 g r 0 g r 0 r r 0 γ 2 σ f 2 e x 2 y 2 λ 2 2 4 flow equation flow in heterogeneous porous media is obtained by solving the darcy brinkmann equation brinkman 1947 10 ρ ν k r u p ρ ν 2 u 0 where ν is the kinematic viscosity ρ the density of the fluid and p the pressure field the darcy brinkmann equation is generally used to solve flow in very heterogeneous porous media because it allows momentum diffusion between high and low velocity regions it also provides stability of the numerical scheme by preventing strong spatial variation of the velocity talon et al 2003 ginzburg et al 2015 to solve this equation we used a two relaxation time lattice boltzmann method trt lbm described in appendix a we also provided informations on the homogeneous case and the validation of the lbm code against the analytical solution 3 characterization of transient transport regimes by means of detailed lattice boltzmann simulations in this section we study transport in heterogeneous porous media under mobile immobile mass transfer the geological model is characterized by the permeability field parameters ϕ d f 0 σ f and λ and by the transport parameters a γ and d 0 however we focus here mainly on the influence of the variance of the heterogeneity σ f and the damköhler number d a using lattice boltzmann simulations 3 1 spatial moments and breakthrough curves transport is analyzed by means of the evolution of the longitudinal second centered spatial moment of the normalized mobile concentration 11 c m c m d r c m the second centered moment of c m is defined by 12 σ 2 t d r x 2 c m d r x c m 2 where x is the component of the position vector r in streamwise direction σ t measures the spatial extension of the mobile solute plume in longitudinal direction the rate of growth of σ 2 t is measured by the macroscopic longitudinal dispersion coefficient which is defined by 13 d l m t 1 2 d σ 2 t d t furthermore we consider the mean concentration that is the breakthrough curve slightly before the outlet boundary of the flow domain at x l 4 λ it is defined by 14 b c t 1 h y c m r d y where y is the component of the position vector perpendicular to the streamwise direction and h is the height of the flow domain 3 2 transport in heterogeneous porous media in this section we detail the results of the transport simulations in heterogeneous porous media fig 1 shows typical mobile and immobile concentration fields for two different values of the damköhler number d a 1 8 and d a 1 40 with σ f 1 the two mobile concentration fields are very similar whereas important differences in the immobile concentration fields can be observed in the case of low d a there is a larger number of depleted spots dark blue at the tracer front while other spots of higher concentration can still be observed far behind the front both effects result from the disorder in the exchange time τ where some spots are characterized by large values of τ these spots require more time for tracer trapping but also for its release fig 2 displays the normalized second moment of the average concentration profile left and the breakthrough curve right for the parameters d a 1 40 σ f 1 p e 6 4 and γ 1 for small times the normalized variance follows a power law of t with an exponent α e a r l y larger than 1 characteristic of anomalous transport for larger times the evolution of the variance changes into a different anomalous behavior characterized by another power law exponent α the breakthrough curve exhibits non exponential tailing which can also be characterized by a power law of the following type 15 b c t t β due to the fact that the second moment and the breakthrough curve do not always display a power law behavior a criterion needs to be defined to establish its existence in practice the fit is done by doing a linear regression of the logarithmic derivative d log f d log t over a decade of the abscissa the constant of this regression gives then the exponent based on the slope a criterion of relevance of the power law can then be defined we fixed the following criterion if the slope is greater than 0 2 the curve is not considered as a power law in other words if the exponent varies more than 0 2 over a decade it is not considered as constant in the following we investigate the effect of the damköhler number d a the disorder σ f of the permeability field and the exponent γ on the anomalous transport characterized by the power law exponents α e a r l y α and β effect of the damköhler number d a in this paragraph we investigate transport for different values of d a in a system characterized by the following parameters σ f 1 p e 6 4 and γ 1 fig 3 represents the evolution of the normalized second moment left the normalized dispersion coefficient middle and the breakthrough curve right for different d a values as can be seen both the power law of the breakthrough curve β and the second regime of the spatial moment α depend on d a this dependency is particularly obvious when plotting d l m t d 0 the evolution of the exponent α as a function of d a is given in fig 4 left for low and high values of d a α tends to one suggesting a mere dispersive behavior if the exchange time is either very low or very high for large values of d a the system is instantaneously at equilibrium e g c m c i m in contrast for small values of d a the exchange between the mobile and immobile regions becomes extremely slow and its influence on the overall transport becomes negligible this case corresponds to the passive transport case studied in the literature where the dispersion regime is initially anomalous α e a r l y 1 due to the permeability heterogeneity and becomes normal α 1 after a certain time period in the presence of exchanges between mobile and immobile regions the transition time between the two regimes power law independent of d a and power law controlled by d a given in fig 3 is roughly independent of d a it corresponds therefore to the end of the non reactive regime which dominates at early time above this transition the effect of the exchange between mobile and immobile zones on transport becomes predominant considering the breakthrough curves fig 3 right it can be seen that for d a 0 the curve takes a gaussian shape while breakthrough curves with finite values of d a exhibit significant tailing tailing is more pronounced for intermediate d a compared to large and small d a because in both cases the influence of the exchange on the transport is not significant for certain values of d a tails follow a power law given by b c t t β fitted exponents of the latter power law are reported in fig 4 right it can be seen that the exponent is increasing with d a corresponding to less significant tailing of the concentration field at high d a effect of disorder of the permeability field σ f we now investigate the influence of σ f on the transport in a system characterized by d a 1 8 p e 6 4 and γ 1 the evolution of the normalized variance of the concentration profile the normalized dispersion coefficient and the breakthrough curves are given in fig 5 in comparison with fig 3 we can state that the early time regime depends on σ f for low heterogeneity σ f 0 25 the early time behavior is diffusive as can be seen from the normalized dispersion coefficient in fig 5 middle the transport becomes anomalous for higher values of σ f when fitting the early time data we can state that the power law exponent increases with heterogeneity see fig 6 left as already reported in the latter section after the early time regime there is a transition towards the second regime at a time which is relatively independent of σ f above this transition the normalized dispersion coefficient follows different power laws with an exponent that also depends on σ f see fig 6 left for this particular small value of d a 1 8 the early time regime exponent α e a r l y is higher than the exponent α of the second regime the opposite is however possible for some lower values of d a as shown in fig 4 in conclusion α e a r l y increases with σ f but not with d a this stands for the fact that the early time regime is dominated by the heterogeneity of the permeability but not by the exchange time fig 5 right represents the corresponding breakthrough curves as a function of σ f for very small σ f the tail is similar to a gaussian distribution by increasing σ f a retardation tail appears which becomes a power law for high heterogeneity values σ f 1 fig 6 represents the exponent β of the power law fit with eq 15 of the tail of the breakthrough curve as function of σ f the exponent decreases with increasing heterogeneity and tailing becomes very significant effect of γ in this section we investigate the impact of γ characterizing the relationship between the permeability and the exchange time τ k γ fig 7 left represents the evolution of the normalized dispersion coefficient for γ 1 0 and 1 with σ f 1 d a 1 8 and p e 6 4 for better comparison we set the logarithmic average of the permeability field exp f 0 equal to one so that the average exchange time is independent of γ from fig 7 left it can be seen that in the late time regime dispersion is anomalous for γ 0 but is normal for γ 0 the latter is characterized by d l m t d 0 c o n s t and corresponds to case where the permeability is heterogeneous but the exchange time is homogeneous for the two cases γ 1 the evolution is characteristic of anomalous dispersion and the breakthrough curve fig 7 middle presents a power law tailing effect we note that both d l m t d 0 and the breakthrough curve are very similar for γ 1 fig 7 right displays the evolution of the anomalous exponent α as function of γ obtained from the second moment of this data set we observe that data points are relatively symmetric with respect to γ 0 and increase with γ due to the fact that the exchange time distribution is log normal exchange time distributions corresponding to γ and γ have the same standard deviation and are thus statistically equivalent for γ 0 high permeabilities correspond to high exchange times whereas in the case of γ 0 high permeabilities correspond to low exchange times the fact that the curves are very similar indicates therefore that the anomalous second regime originates from the presence of a broad range of characteristic exchange times however this does not depend on whether higher exchange times correspond to regions of higher or lower permeability this behavior will be discussed later by means of the ctrw model 4 stochastic transport model to better understand the physical mechanism at work in this problem we derive a stochastic transport model based on the continuous time random walk ctrw approach the novelty of our approach lies in the combined modeling of linear kinetic exchange processes under spatially heterogeneous mass transfer properties and heterogeneous hydraulic properties the derived model is fully predictive in the sense that the parameters are fully constrained in terms of the system properties that is there are no fitting parameters we focus on longitudinal solute transport that is in the direction of the mean pressure gradient the transport of solute particles in a heterogeneous porous medium is determined by the spatial variability of the medium and flow structure consequently particle velocities and thus particle transport evolve on a characteristic length scale this notion is naturally accounted for by the ctrw approach which models particle motion as a space time random walk in which the average spatial step is constant and the time increment varies according to the local flow velocity in the following we define the trapping rate ω 1 τ as the inverse trapping time thus the evolution of the particle position x i and time t i after i random walk steps can be written as 16 x i 1 x i δ ℓ χ 2 d 0 δ ℓ v i ξ i 17 t i 1 t i τ v i θ s τ v i ω i these equations read as follows eq 16 describes the particle position after i random walk steps the second term on the right side of eq 16 denotes an advective transition over the constant distance δ ℓ χ where δ ℓ is an increment along a streamline which is projected onto the streamwise direction by the advective tortuosity χ comolli et al 2019 the third term denotes the dispersive transition which is given by a unit gaussian random variable ξ and the amplitude 2 d 0 δ ℓ v i which is the typical dispersion length during the advection time δ ℓ v i with v i the particle speed at step i eq 17 describes the particle time after i steps the second term denotes the purely advective transition which is given by 18 τ v i δ ℓ v i the single point distribution of τ v is denoted by ψ v t it is defined below in terms of the distribution of flow speeds the third term θ s on the right side of eq 17 denotes the total trapping time where the particle can be immobilized many times with rate ω i during an advective step of duration τ v i the discretization length δ ℓ should be smaller than the characteristic length scales that is the correlation scales of the underlying disorder we note that θ s depends on τ v as the probability to trapped many times increases with the advective time in the following we first summarize the modeling of the velocity transitions for a physically heterogeneous medium then we derive the stochastic representation of spatially variable linear kinetic sorption 4 1 velocity process the velocity process defined as the series of particle speeds v i is modeled as a stationary markov process dentz et al 2016 morales et al 2017 comolli et al 2019 whose steady state distribution p s v is equal to the flux weighted eulerian flow speed v e distribution dentz et al 2016 19 p s v v p e v v e the distribution ψ v t of advective transition times is given in terms of p s v and p e v as 20 ψ v t δ ℓ t 2 p s δ ℓ t δ ℓ 2 t 3 v e p e δ ℓ t relation 19 can be understood as follows the eulerian speed distribution p e v is equal to the steady state distribution of isochronically sampled flow speed which is a direct consequence of the incompressibility of the flow the particle speeds in the ctrw on the other hand are sampled equidistantly along trajectories that is low velocities are sampled less often than for isochronic sampling which is the reason for the flux weighting in relation 19 this is discussed in detail by comolli et al 2019 the speed distribution p e v is approximately log normal 21 p e v exp ln v μ e 2 2 σ e 2 v 2 π σ e 2 and can be seen in fig 8 from relation 19 we find that p s v is also log normal with the log mean given by μ s μ e σ e 2 and the same log variance σ e 2 as p e v this implies that the distribution ψ v t is also a log normal particle transitions between successive particle speeds are characterized by the conditional probability p v δ ℓ v which depends on the space increment δ ℓ that is the particle speed v n 1 is drawn from p v δ ℓ v given the value v of the particle speed v n after n steps following morales et al 2017 we model p v δ ℓ v by the conditional log normal distribution 22 p v δ ℓ v exp ln v μ s ln v 1 exp δ ℓ ℓ c 2 2 σ e 2 1 exp 2 δ ℓ ℓ c v 2 π σ e 2 1 exp 2 δ ℓ ℓ c where ℓ c denotes the correlation length of flow speeds the distribution p 0 v of initial particle speeds v 0 depends on the boundary or initial condition here particles are injected uniformly over a line perpendicular to the mean flow velocity this implies that p 0 v p e v comolli et al 2019 4 2 linear kinetic exchange process under spatially heterogeneous mass transfer properties in a particle based framework linear kinetic mass exchange processes can be modeled as a compound poisson process feller 1968 several authors margolin et al 2003 benson and meerschaert 2009 comolli et al 2016 hyman and dentz 2021 have used this approach to model multirate mass transfer and matrix diffusion under spatially homogeneous linear mass transfer properties based on the compound poisson process we derive here a novel ctrw approach for heterogeneous mass transfer systems the trapping of particles during a random walk step occurs at rate ω 1 τ such that the average number of trapping events during the advection time τ v is given by ω τ v the number n of trapping events is then distributed according to the poisson distribution 23 p n τ v ω ω τ v n exp ω τ v n the total trapping time θ s τ v ω during a random walk step is given by 24 θ s τ v ω j 1 n ϑ j where ϑ j is the trapping time for the j th sorption event the ϑ j are independent exponentially distributed according to 25 ψ ϑ ω ϕ d exp ω ϕ d ϑ with ϕ d being the ratio of the immobile volume over the mobile one the total trapping time θ s describes a compound poisson distribution feller 1968 its distribution can be expressed in laplace space as see appendix d 26 ψ c s τ v ω exp ω τ v 1 ω ϕ d ω ϕ d s where s is the laplace parameter the laplace transform is defined in abramowitz and stegun 1972 the inverse laplace transform of expression 26 can be evaluated explicitly and is given by bateman 1954 p 244 27 ψ c t τ v ω exp ω τ v δ t exp ω τ v t ϕ d ω τ v ϕ d t i 1 2 ω ϕ d t ω τ v where i 1 t is the modified bessel function of the first kind the first term denotes the probability that no exchange event occurs in which case the trapping time is zero fig 9 shows the behavior of ψ c t τ v ω for ω 1 ϕ d 1 and different τ v from these expressions one can deduce several statistical properties from the moment generating function eq 26 one can infer the mean and variance of the total trapping time 28 θ s τ v ω τ v ϕ d 29 θ s θ s 2 τ v ω 2 τ v ω ϕ d 2 2 τ v τ ϕ d 2 the first relation shows that the average total trapping time θ s depends only on the advective time τ v and not on the exchange time τ this counter intuitive result can be understood from the fact that ω 1 τ controls both the number of trapping events during the advection time and the duration of each the two effects compensate each other since a higher τ means longer trapping times but also fewer trapping events the second relationship shows that the width of the distribution is impacted by both the advection time and the exchange time this can also be understood from the fact that the total exchange time during τ v is the sum of n trapping times the variance is thus proportional to n τ 2 with n τ v τ another important quantity is the total trapping time distribution tail in eq 27 the limit of t ω ϕ d 1 ψ c t τ v ω becomes also independent of ω and can be approximated by ψ c t τ v ω δ t τ v ϕ d which means that θ s τ v ω τ v ϕ d for large values the longest exchange times are therefore controlled by the advection time only furthermore we can infer that the tail of the distribution is a log normal 4 3 model parameterization here we discuss the parameterization of the upscaled model in terms of the statistical medium description which is essential as our ctrw approach is not based on a fitting procedure 4 3 1 linear kinetic mass exchange first we consider the exchange process the model assumes that the exchange rates ω i are independent identically distributed random variables their distribution p ω ω is given in terms of the distribution of permeability p k k through the relation ω 1 τ 1 a k γ 30 p ω ω γ a 1 γ ω 1 γ 1 p k 1 a ω 1 γ that is it is fully constrained here by the point distribution of permeability and the parameter of the direct model there is no fitting parameter 4 3 2 velocity process second we consider the process of particle speeds which is defined by the conditional log normal distribution eq 22 and the log normal distribution eq 21 of eulerian flow speeds thus the speed process is parameterized by the mean μ e and variance σ e 2 of the eulerian flow speed as well as the correlation length ℓ c these parameters can be constrained by perturbation theory in the fluctuations of ln k for low and moderate heterogeneity characterized by σ f 2 lower than or of the order of one for strong heterogeneity empirical relations for the eulerian speed distribution and correlation length need to be used gotovac et al 2009 hakoun et al 2019 comolli et al 2019 to determine the model parameters by perturbation theory we notice that μ e and σ e 2 for the log normal distribution are related to the mean v and variance σ v 2 of the eulerian flow speed by 31 μ e ln v 2 v 2 σ v 2 32 σ e 2 ln 1 σ v 2 v 2 the mean flow speed v and its variance σ v 2 can be expressed in terms of the mean f 0 and variance σ f 2 of f ln k by cvetkovic et al 1996 33 v exp f 0 p 34 σ v 2 3 8 σ f 2 v 2 where p is the mean hydraulic gradient thus expressions 31 34 constrain the speed distribution in terms of the k distribution similarly we can relate the speed correlation ℓ c to the correlation length of λ of f by ℓ c π 4 λ 3 where λ is the correlation length of permeability cvetkovic et al 1996 comolli et al 2019 see also appendix a the advective tortuosity χ is given by the ratio between the mean eulerian speed v e and the mean streamwise velocity u χ v e u thus all parameters of the upscaled model are constrained by flow and medium properties there are no fitting parameters note that the upscaled model does not represent the correlation between permeability and exchange rate expressed in the detailed model by eq 3 here particle velocity on one hand and exchange rate on the other are independent 4 4 transport predictions with the upscaled ctrw model in this section we compare the predictions of the upscaled ctrw to the detailed numerical simulations for three transport scenarios characterized by σ f 1 and d a 1 25 1 0 1 6 25 1 0 2 and 2 5 1 0 2 the coupling parameter γ between permeability and exchange time is set to γ 1 the correlation length of f ln k is λ 4 in arbitrary units the mean of ln k is f 0 0 and the mean pressure gradient is unity the upscaled ctrw model is parameterized based on these characteristics as outlined in section 4 3 the numerical implementation of the upscaled model described here is efficient and allows to achieve simulation times otherwise prohibitive for the direct numerical lb simulations spatial moments and breakthrough curve the position of a mobile particle in the ctrw framework is given by 35 x t x n t v n t t t n t where n t max n t n t a particle is considered mobile if t t n t ℓ v n t the second centered longitudinal moment is then defined by 36 σ 2 t x t 2 x t 2 where the angular brackets denote the average over all mobile particles at time t the breakthrough curve b c l t is defined in terms of the arrival times of a particle at distance l from the inlet the arrival τ l is given by 37 τ l min t x n t l the breakthrough curve is then given by the distribution of arrival times as 38 b c l t δ t τ l x 4 4 1 pre asymptotic regime fig 10 shows the spatial variance normalized by the square of the correlation length for different values of d a obtained from the lb simulations solid line and from the stochastic ctrw model symbols fig 11 displays the normalized dispersion coefficient and fig 12 the breakthrough curve it can bee seen that albeit a slight offset at the beginning all ctrw predictions agree very well with the direct numerical simulations from these agreements between the lbm and ctrw several conclusions can be drawn we recall that in the ctrw model the advection rate and exchange time are drawn independently which is a strong assumption in contrast to the direct simulations where permeability and exchange rate are related by eq 3 the distributions of k and τ of the ctrw model are however related through the exponent γ the good agreement between the two approaches indicates that the results are independent of the correlation between τ and k however the results are strongly influenced by the distribution shape of the two quantities especially their width related by γ the last two points explain the above mentioned lbm result that the transport was not affected by the sign of γ but only by its magnitude indeed distributions with opposite signs of γ have the same log normal shape but the k and τ fields are anti correlated as discussed in the introduction anomalous dispersion is generally related to a broad distribution of transition times used in the ctrw approach in our model there are two contributions to this transition time the first one is the advection time whose distribution width is directly related to the permeability heterogeneity σ f this contribution is responsible for the earlier anomalous behavior α e a r l y see fig 2 the second one is the waiting time due to sorption this waiting time distribution depends on both the velocity heterogeneity and the exchange time heterogeneity as described by eq 27 physically this means that in low velocity regions particles have more time to be trapped and untrapped both σ f and σ g then contribute to the second anomalous behavior which is also very well captured by the model another indication from these model results is more technical an important issue when doing direct stochastic numerical simulations is the size of the system which must be representative this problem does not exist for the ctrw as it is a 1d problem the good agreement of the results of the two approaches thus shows that the size used in the lbm simulations is sufficiently large for this type of heterogeneity 4 4 2 asymptotic regime the stochastic ctrw model is very efficient because it depends only on point distributions of the statistical medium properties once validated it allows predictions on very large time scales in particular it shows that at very large time the variance scales asymptotically linearly with time i e asymptotically dispersion is normal this is also reflected in the evolution of the normalized dispersion coefficient d l m t which converges towards a constant asymptotic value fig 11 consequently the power law behavior characterized by α identified in the previous section is rather a transient than a true power law regime in fact the distribution ψ v t of the advective transition times is log normal similarly large exchange times can be approximated by θ s τ v ω τ v ϕ d as outlined in section 4 2 that is the long time behavior of the exchange time distribution is also log normal this implies that transport is asymptotically normal berkowitz et al 2006 with possible power law cross over behaviors as shown in section 3 2 finally it can be noted that the dispersion coefficient given by d e f f lim t d l m t d 0 decreases with d a indeed as for the homogeneous case see appendix c lower values of d a lead to stronger spreading inducing higher values of d l m t d 0 in the asymptotic regime from fig 11 it can be seen that convergence times to reach the asymptotic gaussian regime are very long additionally this time depends moderately on the damköhler number d a in conclusion our ctrw model allows robust predictions for all cases we considered and provides an efficient approach for transport predictions under conditions that are prohibitive for direct numerical simulations 5 conclusion in this article we have studied transport in a heterogeneous porous medium with a spatially varying permeability field combined with the exchange between mobile and immobile regions to model the coupling between the exchange and the local structure we assumed the following relation between the local permeability k and the local exchange time τ k γ we performed lbm simulations in a large two dimensional system to study the heterogeneity induced large scale transport behavior the transport behavior is upscaled using a new ctrw approach the impact of spatial variations in flow velocity and exchange times are modeled in terms of a spatial markov process for the particle speeds and a compound poisson process for the mass exchange kinetics the upscaled model is fully determined by the statistics of permeability and exchange parameters it has no fitting parameter we investigated the influence of the damköhler number d a the variance σ f 2 of f ln k and the value of the coupling exponent γ on the temporal evolution of the solute distribution and the breakthrough curves in the short and intermediate time range we observed transient anomalous regimes which are characterized by power law tails of the solute breakthrough curves and a power law evolution of the spatial variance of the solute distribution whereas the short time power law regime α e a r l y is strongly dependent on the heterogeneity of the permeability field the intermediate regime α is mostly dependent on both the exchange time and permeability distribution the latter regime becomes more important for large distributions of τ in particular we observe an increase in the power law exponent α for a specific range of d a in the asymptotic limit the upscaled ctrw model predicts that the transport behavior becomes fickian the resulting dispersion coefficient d e f f decreases with increasing d a we find that the time to attain the asymptotic limit depends on d a we also observe that the time to reach the asymptotic regimes in heterogeneous porous media for σ f 1 is two orders of magnitude higher than the respective time in the homogeneous case see appendix c thus the difference in convergence time strongly depends on σ f indeed for a given average value of d a it is expected that the convergence time depends on the largest values of the exchange time distribution which increase with σ f the upscaled ctrw model provides robust predictions of the behavior observed in the direct numerical simulations it relates the observed transport behaviors to the distribution of permeability which controls the distributions of the advective times and the exchange times between mobile and immobile regions an important advantage of using the ctrw model lies in the fact that the asymptotic limit of the transport behavior can be reached in a very short computation time for instance the computation times for the ctrw models is on the order of minutes using one core on a 2 ghz quad core intel core i5 processor in comparison using a similar architecture the lbm code would require about 2 3 days to compute d l t and about 2 weeks to compute the b c curve the good agreement of the ctrw with the direct simulations reveals several aspects of the transport process first the non gaussian pre asymptotic regime is determined by a broad distribution of the total trapping times which results from the coupling between the heterogeneities of the velocity field and the exchange time this coupling is due to the fact that in low velocity zones the particles have a greater probability of being trapped many times an interesting result is that the correlation between the permeability field and the exchange time has no influence on the transport because the two quantities are drawn independently in the ctrw this is also confirmed by the similarity between the results of γ 1 and γ 1 also the ctrw predicts that transport is asymptotically fickian the evolution of the spatial variance is characterized by a broad pre asymptotic cross over behavior that may be characterized by a power law finally long lasting pre asymptotic regimes could potentially explain the experimentally observed non gaussian behavior indeed the experimental time is usually limited by the size of the sample we were able to show that even for weakly heterogeneous media the non gaussian pre asymptotic regime could have a significant duration because of the heterogeneity of the exchange time in future works a challenging task will be to simulate transport in more realistic structures indeed many geological structures are more complex and display a higher heterogeneity also investigating transport in anisotropic or stratified structure will provide crucial knowledge for a better comprehension of pollutant transport in more complex subsurfaces moreover in the present work we used a constant and isotropic dispersion tensor independent of the local velocity this can be considered as a strong assumption indeed if low velocity regions are also characterized by a low dispersion coefficient the residence time would increase in these regions this coupling would then also affect the global transport in a future work it could therefore be interesting to evaluate the influence of a heterogeneous and velocity dependent dispersion tensor declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests laurent talon reports financial support was provided by cnrs marco dentz reports financial support was provided by spanish ministry of science and innovation daniela bauer reports financial support was provided by ifp energies nouvelles acknowledgments m d acknowledges the support of the spanish research agency 10 13039 501100011033 and the spanish ministry of science and innovation through the grants cex2018 000794 s and pid2019 106887gb c31 hydropore appendix a correlation length of particle velocity the correlation length of particle velocity can be determined from perturbation theory following cvetkovic et al 1996 and dagan 1989 the longitudinal macrodispersion coefficient can be written as a 1 d l 0 d t c v t where c v t is the lagrangian velocity covariance this expression can also be written as a 2 d l σ v 2 τ c τ c 1 σ v 2 0 d t c v t where σ v 2 is the velocity variance the correlation time τ c ℓ c u where u is the mean flow velocity and ℓ c is the correlation length thus we obtain a 3 ℓ c d l u σ v 2 perturbation theory gives σ v 2 3 8 σ f 2 u 2 for the gaussian covariance function employed in this study the macrodispersion coefficient is a 4 d l π 2 λ u σ f 2 thus we obtain for the correlation length ℓ c a 5 ℓ c π 4 λ 3 appendix b numerical method two relaxation time lattice boltzmann method the darcy brinkmann equation as well as the equations of the mobile immobile model are solved using a two relaxation time trt lattice boltzmann scheme which is summarized in the following for more details we refer to ginzburg et al 2008 2015 considering the resolution of the velocity field and to ginzburg and d humi eres 2010 for the advection diffusion equation b 1 darcy brinkmann equation in a first step we provide the fundamentals of lb and the numerical scheme to solve the darcy brinkmann equation given by b 1 ρ ν k r u p ρ ν δ u 0 where ν is the kinematic viscosity ρ the density of the fluid and p the pressure field the principle of the lattice boltzmann method lbm lies in the particular discretization of the boltzmann equation both space 2d in the present work and particle velocities are discretized on a regular grid the nodes of the grid are related by the velocity vectors c q with q 0 q q 9 here and particles can only move with velocities c q the population f q r t is defined as the density of particles having the velocity c q at the position r lbm schemes are based on the decomposition of the temporal evolution of the particle density in two specific steps the first step is the collision where the density populations f q meeting at the same position are redistributed according to a relaxation equation f q r t f q r t s f q r t f q e q ρ u where f q denotes the post collision populations s is a relaxation parameter and f q e q designates an equilibrium state depending on the local macroscopic variables density velocity permeability etc the second step is the propagation in this step all populations are displaced on the grid according to their velocity f q r c q t 1 f q r t the principle of the trt scheme lies in the modification of the collision step by introducing two different relaxation parameters s and s for the odd and even components of the population densities the even and odd components are defined as f q f q f q 2 and f q f q f q 2 where q denotes the opposite velocity direction to q the collision becomes then b 2 f q r t f q s n q s n q with q 0 4 b 3 f q r t f q s n q s n q with q 0 4 with n q f q e q e q are the equilibrium functions which characterize the physical equations to be solved in the case of the darcy brinkmann equation the equilibrium functions depend on the following local macroscopic quantities pressure p c s 2 ρ c s 2 q 0 q f q where c s is the numerical sound speed c s 2 1 3 here local velocity u 1 ρ 0 2 j 2 ν k with j q 0 q f q c q the equilibrium functions are given by ginzburg et al 2015 b 4 e 0 ρ 2 q 1 4 e q b 5 e q t q p ρ b 6 e q ρ 0 t q u c q λ ν k c q u where t q are coefficients depending on the direction here we use t q 1 3 for the first neighbors and t q 1 12 for the second neighbors diagonal ρ 0 is a fixed averaged density ρ 0 1 here and λ a parameter depending on the odd relaxation time b 7 λ 1 s 1 2 the scheme requires the determination of the two relaxation parameters s and s for numerical reasons precision stability it is however more convenient to prescribe the viscosity ν and a numerical parameter λ λ λ the two relaxation parameters are then deduced using the relations s 2 6 ν 1 and s 2 2 λ 3 ν 1 λ essentially controls the numerical error of the scheme ginzburg et al 2008 2015 it is set to λ 0 25 in this work advection diffusion reaction equation adre a trt scheme is also used to solve the advection diffusion reaction equation b 8 c m t u c m d δ c m r where r 1 τ c m c i m is the source term the principle is identical to the trt scheme used for the resolution of the flow equation in this case g q r t represent the densities of particles having the velocity c q at the position r the collision step is also similar b 9 g q r t g q s g q e q s g q e q with q 0 4 b 10 g q r t g q s g q e q s g q e q with q 0 4 in presence of a source term the local concentration is given by b 11 c m q 0 q g q r 2 here also it is convenient to introduce λ 1 s 1 2 the main difference with the trt scheme used for the resolution of the velocity field lies in the equilibrium functions e q b 12 e q c e q t q c s 2 1 4 u x 2 u y 2 p q x x 1 4 u x u y p q x y 1 12 u x 2 u y 2 for q 1 q b 13 e q t q c e q u c for q 1 q b 14 e 0 c e q q 1 q e q where we defined c e q c m λ r p q x x c q x 2 c q y 2 p q x y c q x c q y the diffusion coefficient is then given by d c s 2 λ the coefficient c s 2 is a constant parameter and the directional coefficients t q are now equal to 1 4 for the first neighbors and 1 8 for the diagonal links the numerical scheme thus requires the definition of the parameters d c s 2 and λ λ λ in this study we used c s 2 0 2 and λ 0 2 real time and space data are related to non dimensional and lattice boltzmann variables as follows b 15 t a d i m u l b 2 d l b t l b b 16 t r e a l d r e e l u r e a l 2 t a d i m simulation details we used a porous medium of size 1024 512 flow in x direction is driven by a body force and periodic boundary conditions are applied in the x and y direction we supposed k 0 1 in the brinkmann equation the boundary condition for the tracer are c 0 at the inlet and c m x 0 at the outlet after reaching the steady state for the flow we impose a pulse of concentration at a position slightly after the inlet x 10 p x fig b 13 shows a zoom of the permeability field left and the velocity field right figures are given for the following parameters σ f 1 λ 4 k 0 1 appendix c homogeneous porous media in this section we present results of transport governed by the mobile immobile model in a homogeneous porous medium σ f 0 in this case analytical solutions of eqs 5 have been determined by goltz and roberts 1987 showing that transport becomes gaussian fickian for large time by comparison these results allow further comprehension of transport in heterogeneous porous media but also the validation of the lattice boltzmann algorithm for homogeneous porous media the governing equations can be non dimensionalized with x x u d 0 and t t u 2 d 0 it follows c 1 c m t ϕ d c i m t c m 2 c m c i m t d a p e c m c i m the equations are now governed by only two dimensionless parameters ϕ d and ψ p e d a u 2 τ ϕ d d 0 second spatial moment of the concentration profile and breakthrough curve fig c 14 shows the averaged concentration profiles of the mobile and the total concentration at different times the corresponding breakthrough curve is given in fig c 14 for short times the concentration profiles have a slightly asymmetrical bell shape which is due to the initial condition very sharp gaussian distribution but also to the fact that transport is dominated by molecular diffusion as the influence of trapping events on transport is negligible then for slightly larger time intervals the concentration profiles become asymmetric as the influence of trapping and advection on tracer transport becomes significant finally in the large time limit profiles become gaussian again as steady state is reached a slight shift can be seen between the mobile and the total concentration that vanishes for large times fig c 15 left shows the typical curves of the normalized dispersion coefficient d l m t d 0 as a function of the non dimensional time t u 2 d 0 for different values of the dimensionless system parameter ψ p e d a u 2 a k γ ϕ d d 0 u 2 τ ϕ d d 0 for all ψ after a characteristic time τ c o n v the normalized dispersion coefficient reaches a constant value corresponding to a gaussian asymptotic behavior here the asymptotic dispersion coefficient d e f f is defined by c 2 d e f f lim t d l m t the asymptotic longitudinal dispersion coefficient d e f f has been determined analytically by goltz and roberts 1987 as c 3 d e f f d 0 1 1 ϕ d ψ ϕ d 1 ϕ d 3 fig c 16 left shows the analytical and numerical values of d e f f d 0 very good accordance between analytical and numerical data was obtained fig c 16 right gives the dependency of the numerical error on ψ even for low values of ψ the error remains smaller than 2 considering the shape of d l m t d 0 fig c 15 left two different behaviors can be observed for small ψ e g low exchange time d l m t d 0 decreases to reach a value below one this can be explained by the fact that for small values of ψ the first term in eq c 3 dominates in this case the equilibrium is very rapidly reached due to the small exchange time this regime is the well known retardation effect based on the assumption that c m c i m in eqs 4 for larger values of ψ where either the exchange time or the velocity is significant τ u 2 d 0 ϕ d d l m t d 0 takes values close to one for small times due to the predominance of molecular diffusion as trapping events start to be effective d l m t d 0 increases significantly due to the competition between advection and retention to reach a plateau after a certain time τ c o n v once the system has reached a plateau transport is gaussian the limiting case ψ deserves to be discussed because it corresponds to τ and thus to the absence of any exchange in this case the observed effective dispersion is necessarily constant and equal to d 0 but the theoretical dispersion coefficient given by eq c 3 is infinite this inconsistency is due to the fact that the convergence time τ c o n v also diverges to infinity so that the system remains in the pre asymptotic regime fig c 15 right presents the normalized convergence time u 2 τ c o n v d 0 as a function of ψ for low values of ψ the convergence time is independent of ψ as the exchange time between mobile and immobile zones is very short and the equilibrium is reached quasi instantaneously for larger ψ the convergence time increases approximately according to a power law of ψ the power law exponent is larger than one but it is expected that for very large ψ the convergence time is proportional to the exchange time τ c o n v τ and therefore τ c o n v ψ the latter is due to the fact that kinetics solely depend on the first order rate term c i m t 1 ψ c m c i m appendix d compound poisson process we derive here the laplace space eq 26 for the distribution of the total trapping time in the compound poisson process to this end we write the definition of the distribution of θ s as d 1 p c t τ v ω δ t j 1 n ϑ j d 2 n 0 δ t j 1 n ϑ j p n τ v ω ψ ϑ 1 ψ ϑ n d ϑ 1 d ϑ n where n is poisson distributed and the ϑ j are exponential distributed and independent the laplace transform of eq d 1 is d 3 p c s τ v ω 0 p c t τ v ω exp s t d t d 4 n 0 p n τ v ω exp s j 1 n ϑ j ψ ϑ 1 ψ ϑ n d ϑ 1 d ϑ n d 5 n 0 p n τ v ω j 0 n exp s ϑ j ψ ϑ j d ϑ j d 6 n 0 p n τ v ω ψ ϑ exp s ϑ d ϑ n thus d 7 p c s τ v ω n 0 ω τ v n exp ω τ v n ψ s n exp ω τ v 1 ψ s where we used the exponential sum we note that the laplace transform or ψ t given by eq 25 is d 8 ψ s ω ϕ d ω ϕ d s inserting this expression into d 7 gives eq 26 
43,transport processes in the subsurface are coupled with the heterogeneity of the porous structure obtaining an accurate description of mass transport in such media at all time scales remains a crucial task as the subsurface is strongly impacted by human activity spreading of pollutants in the transient but also in the asymptotic regime as well as the time to reach a critical location e g aquifer well significantly depend on the underlying heterogeneity of the permeability field moreover in the case of solute retention transport is also characterized by local exchange kinetics that depend on the local aquifer properties consequently exchange retention times are expected to be spatially heterogeneous in this work we focus on the influence of spatially heterogeneous permeability and exchange times on the transient and asymptotic transport regimes and provide a parametric study to this goal we simulate in a first part the transport in a two dimensional heterogeneous medium under spatially varying permeability and mobile immobile mass transfer parameters equations are solved using a lattice boltzmann two relaxation time trt algorithm we assume the following relation between the local permeability k and the local exchange time τ k γ taking into account this relation we investigate the impact of the damköhler number d a ratio of the advection and exchange time scales the disorder of the permeability field and the value of the exponent of the coupling function γ on the spatial evolution of the concentration field and breakthrough curve we show that depending on the parameters d a γ etc we can observe transient non fickian dispersion which is characterized by non exponential tails of the solute breakthrough curves and a non linear evolution of the spatial variance of the solute distribution in a second part we present a new continuous time random walk ctrw model to upscale these transport behaviors the model is based on a spatial markov model for particle velocities that couples advective dispersive transport and heterogeneous mass transfer through a compound poisson process the upscaled model can be fully parameterized by the statistics of permeability and the hydraulic gradient with no fitting parameter that is in terms of medium and flow characteristics the results of the ctrw model fully capture the non fickian transient transport regimes both for the breakthrough curves and spatial concentration variance in the longtime limit as expected from the central limit theorem the ctrw model predicts normal fickian behavior finally we show that the time to reach the asymptotic regimes in heterogeneous media e g heterogeneous exchange times is parameter dependent and in average is two orders of magnitude larger than for the respective homogeneous case to summarize the coupling between the heterogeneous permeability field and the local mass transfer properties can strongly influence transient and asymptotic transport regimes and potentially explain experimentally observed non gaussian behaviors keywords dispersion mobile immobile model transient regimes lattice boltzmann ctrw heterogeneity data availability data will be made available on request 1 introduction pollutant transport in the subsurface is coupled to the water content and the heterogeneity of the porous medium as the subsurface is strongly influenced by human activity an accurate description of pollutant transport at all time scales still remains a crucial task indeed for example the knowledge of such transport is required for efficient water remediation and for providing access to safe drinking water for many pollutants nuclear waste pharmaceuticals etc contamination remains critical at very low concentrations and cannot be ignored for this type of pollutants long lasting low concentrations represent therefore a major issue in aquifer and soil remediation further comprehension on these transient long lasting regimes and their dependence on the porous structure is therefore crucial in the actual environmental context transport in porous media has been treated in the literature for a long time but still remains an actual topic while much research focused mainly on the asymptotic regimes further attention should be paid to the transient and often long lasting pre asymptotic regimes indeed experimental field and laboratory observations report that solute transport may not obey classical fickian dispersion non fickian transport can be attributed to the heterogeneity of the permeability field but also to sorption phenomena that may be space dependent a typical example is the reactive transport experiment performed at cape cod where reactive tracer exhibit non fickian transport behavior brusseau and srivastava 1999 despite the fact that the heterogeneity of the permeability field was rather small σ l o g κ 2 0 24 the velocity of the tracer front was decreasing over time and the variance of the plume spread more rapidly than linearly brusseau and srivastava investigated various mechanism to model this anomalous behavior they tried different model scenarios where permeability was considered to be either homogeneous or heterogeneous sorption could be linear or not with either instantaneous or rate limited kinetics results of the study show that the early time behavior of the experiment could be reasonably well fitted however in contrary the later times could be fitted only by significantly increasing the heterogeneity of the sorption kinetic coefficient in the second half of the domain the latter result points out the importance of the choice of the model parameters to describe the long time transport behaviors but also the need to carry out a parametric study dynamics of spreading and the spatio temporal extension of the pollutants in the transient but also in the asymptotic regime as well as the time to reach a critical location e g aquifer well housing strongly depend on the underlying heterogeneity of the porous medium this dependence has been pointed out by dai et al 2004 ren et al 2022 by performing transport simulations in porous media characterized by different criteria anisotropy correlation length scales however transport also depends on the spatial variability of exchange kinetics between mobile and immobile solute phases first order exchange kinetics have been used to quantify diffusive mass transfer between high and low velocity zones as well as linear kinetic sorption desorption reactions haggerty and gorelick 1995 as most pollutants are subject to sorption phenomena the impact of heterogeneity on large scale transport has been largely treated in the literature and quantified in the framework of stochastic modeling for the spatially fluctuating exchange parameters and permeability rubin 2003 numerical simulations selroos and cvetkovic 1992 tompson 1993 selroos and cvetkovic 1994 burr et al 1994 were used to determine the ensemble averaged center of mass velocity and dispersion coefficients or temporal moments analytical studies have used first order perturbation theory in the heterogeneity variance to investigate large scale transport under heterogeneous conductivity and homogeneous kinetic mass transfer quinodoz and valocchi 1993 dagan and cvetkovic 1993 massabó et al 2008 soltanian et al 2015 under heterogeneous conductivity and mass transfer properties cvetkovic and shapiro 1990 cvetkovic et al 1998 miralles wilhelm and gelhar 1996 rajaram 1997 dentz et al 2000 and under homogeneous conductivity and heterogeneous sorption properties metzger et al 1996 reichle et al 1998 attinger et al 1999 however it is important to stress that all these studies focus on the asymptotic stationary regime and aim at the quantification of effective upscaled transport parameters such as effective dispersion coefficients and effective retardation coefficients note that these transport parameters are only applicable when the average concentration follows a fickian equation which is theoretically expected at very long times however as we will see later before reaching this asymptotic limit transport may exhibit anomalous behavior in consequence it suggests that the behaviors observed even at the longest times in the cape cod experiment correspond to transient regimes this is particularly supported by the fact that the velocity of the tracer front decreases with time without reaching a constant value mobile immobile models coats and smith 1964 van genuchten and wierenga 1976 haggerty and gorelick 1995 have been used to describe the impact of kinetic mass transfer between mobile and immobile medium portions on the overall solute migration in saturated and partially saturated media moreover as pointed out by several researcher e g nkedi kizza et al 1984 valocchi 1990 haggerty and gorelick 1995 all first order kinetic mass transfer models can also be applied to linear sorption problems a large number of experiments have been performed to characterize exchange times for transport in porous media with different degrees of heterogeneity griffioen et al 1998 provided a review of exchange times of a large number of laboratory experiments performed in different column samples low exchange times 5 h and more have been observed by rao et al 1980 in samples consisting of porous spheres and glass beads in contrast smettem 1984 measured tracer transport in heterogeneous soil columns and determined an average exchange time up to 125 days exchange times were computed by fitting a mobile immobile model to the experimental data however a major difference between the laboratory and the field scale lies in the fact that the latter presents often spatial variations e g tompson 1993 burr et al 1994 brusseau 1994 consequently the permeability but also the exchange time might present large spatial heterogeneity here we consider both heterogeneity in permeability and mobile immobile mass transfer which manifest in spatial variability of the flow velocity v r and the local mass transfer times τ r where r is the position vector transport of the mobile and immobile concentrations c m and c i m can then be modeled as e g cvetkovic and shapiro 1990 burr et al 1994 haggerty and gorelick 1995 reichle et al 1998 1 θ m c m t u r c m d 0 2 c m 1 τ r c m c i m 2 θ i m c i m t 1 τ r c m c i m here θ m represents the constant mobile water content and θ i m the constant immobile water content for simplicity we assume that local scale dispersion is constant and isotropic as quantified by the dispersion coefficient d 0 note that we assume here for simplicity that the trapping and release rates are constant and equal to the inverse characteristic mass transfer time 1 τ r as in reichle et al 1998 experimental field and laboratory observations report that solute transport may not obey classical fickian dispersion brusseau and srivastava 1999 berkowitz et al 2006 and may be characterized by late time tailing of solute breakthrough curves and a non linear evolution of the spatial second centered moments of the solute distribution which can be quantified by stochastic perturbation theory for moderately heterogeneous media dagan 1989 such observations cannot be captured by fickian advection dispersion models that are based on constant asymptotic effective transport parameters the heterogeneity induced large scale transport dynamics are in general non fickian and converge to fickian behaviors only asymptotically dentz et al 2004 beaudoin and de dreuzy 2013 comolli et al 2019 such behaviors can often be traced back to a broad distribution of mass transfer time scales as a result of spatial heterogeneity in the physical and chemical medium properties berkowitz et al 2006 frippiat and holeyman 2008 neuman and tartakovsky 2008 dentz et al 2011 this phenomenological picture is reflected in the multirate mass transfer mrmt haggerty and gorelick 1995 carrera et al 1998 continuous time random walk ctrw berkowitz et al 2006 and time domain random walk tdrw painter and cvetkovic 2005 noetinger et al 2016 approaches these modeling approaches are typically characterized by a probability distribution function of mass transfer times which are encoded in the memory function mrmt and the transition time distribution ctrw and tdrw the mrmt approach models solute transport through advection and diffusion or dispersion in a connected mobile region and linear mass transfer between the mobile and immobile regions the mass transfer properties and distribution of residence times in the immobile regions are encoded in the memory function which relates the mobile and immobile solute concentrations the memory function of mrmt can in principle be related to the geometry and distribution of immobile regions and the underlying mass transfer processes haggerty and gorelick 1995 carrera et al 1998 zinn et al 2004 gouze et al 2008 zhang et al 2014 hidalgo et al 2020 or is fitted from observed breakthrough curves based on a parametric form for the memory function willmann et al 2008 similarly the transition time distribution in the ctrw approach is often fitted based on a suitable parametric equation dentz et al 2004 berkowitz et al 2006 the ctrw and tdrw frameworks allow to distinguish between local scale mass transfer mechanisms and to relate the transition probabilities to the heterogeneity distribution and local scale processes such as linear kinetic mass transfer margolin et al 2003 spatially variable retardation properties dentz and castro 2009 heterogeneous advection fiori et al 2007 cvetkovic et al 2014 comolli et al 2016 2019 matrix diffusion hyman and dentz 2021 and sorption and first order decay painter et al 2008 in this article we study transport in heterogeneous porous media that are characterized by spatially variable permeability and spatially variable kinetic mass transfer properties in the first part we solve numerically the direct flow and transport model described by eqs 1 2 we focus on the pre asymptotic regime where anomalous behaviors are observed and their dependence on the system parameters in the second part we use the ctrw framework to derive a new upscaled stochastic model that is able to predict non fickian pre asymptotic transport as well as the asymptotic behavior our ctrw approach uses a compound poisson process to model linear kinetic exchange under spatially heterogeneous mass transfer properties it is parameterized by the point distributions of hydraulic permeability the correlation length of log permeability local scale dispersion and advective tortuosity all of which are flow and medium properties which means that they are transport independent the model is predictive without any fitting parameter the article is structured as follows in section 2 we first detail the mobile immobile model mim for heterogeneous permeability and exchange time the generation of the permeability field and the flow equation then in section 3 we summarize the numerical simulation of the direct problem using the lattice boltzmann method and present a parametric study of the transient regimes section 4 presents a new upscaled transport model ctrw and its parameterization the ctrw model is then validated against the results of the direct simulations 2 the mobile immobile model for heterogeneous structures in this part we present in a first step the derivation of a generic scaling law to relate the exchange time τ and the permeability k then we introduce the non dimensional equations of the mobile immobile model and the dimensionless parameters for heterogeneous porous media afterwards we detail the generation of the porous medium and present the flow equation 2 1 generic scaling law to relate the exchange time τ and the permeability k the characteristic exchange time τ depends on the underlying physical or chemical process and the porous topology using a phenomenological argument one might for example expect that the characteristic diffusion time in the dead end pore scales as reichle et al 1998 τ a 2 d m with a being the typical pore size and d m the molecular diffusion coefficient assuming that k a 2 it follows that τ k the time spent in the dead end thus increases with the permeability because the pores are larger however this argument holds only if the permeability is modified by a homothetic transformation for more complex structures the residence time may be a non trivial function of the pore scale geometry for example percolation disorder is known to lead to anomalous scaling exponents koplik et al 1988 de gennes 1983 also based on field measurements burr et al 1994 proposed a power law between the permeability and the exchange time in order to be more general we thus correlate the exchange time to the permeability using a power law 3 τ a k γ where a is a scaling parameter and the exponent γ 1 1 we consider also negative γ which corresponds to an increase of residence time when the permeability decreases indeed if the lower permeability regions have dead ends with more complex shape one could expect that the residence times are indeed larger 2 2 non dimensional equations the number of variables of the mobile immobile model can be reduced by changing the time scale as t θ m t eqs 1 and 2 can then be written as 4 c m t ϕ d c i m t u c m d 0 2 c m c i m t 1 τ ϕ d c m c i m with ϕ d θ i m θ m being the ratio of the immobile volume over the mobile one dispersion is given by its coefficient d 0 d u d m where d is the dispersivity and d m the molecular diffusion note that in heterogeneous porous media the velocity u is also heterogeneous in order to investigate solely the influence of heterogeneous exchange time τ on the transport we simplified the problem and kept d 0 c o n s t as mentioned above τ is then assumed to follow eq 3 using the imposed mean flow rate u eqs 4 can be non dimensionalized by introducing a characteristic length scale λ and time scale λ u 5 c m t ϕ d c i m t u c m 1 p e 2 c m c i m t λ u ϕ d τ c m c i m two dimensionless numbers can be deduced from eqs 5 p e λ u d 0 the péclet number which characterizes the ratio of the diffusive time scale over the convective one d a λ u τ ϕ d the damköhler number corresponding to the ratio of the convection and exchange time scales here we introduce the average exchange time τ a k 0 γ where k 0 exp f 0 is the harmonic mean of the permeability field see eq 6 in the next section 2 3 porous media generation as it is often assumed to describe the permeability field gelhar and axness 1983 burr et al 1994 rubin 2003 k is generated using a correlated log normal probability distribution function pdf given by 6 pdf f ln k 1 2 π σ f e f f 0 2 2 σ f 2 where f 0 and σ f are the mean and standard deviation of ln k moreover the field f is spatially correlated according to a gaussian correlation function 7 f r 0 f r 0 r r 0 σ f 2 e x 2 y 2 λ 2 where r 0 represents the spatial average over the whole domain here we use the fixed parameters f 0 0 and λ 4 lbm lattice units the value σ f which quantifies the heterogeneity of the permeability field has been varied in the range σ f 2 0 1 5 which represents moderately heterogeneous permeability fields but includes most values reported in rubin 2003 since exchange time and permeability are related by eq 3 the distribution of the exchange times also follows a log normal distribution 8 pdf g ln τ 1 2 π σ g e g g 0 2 2 σ g 2 with g 0 γ f 0 ln a and σ g γ σ f the covariance function of g is thus given by 9 g r 0 g r 0 r r 0 γ 2 σ f 2 e x 2 y 2 λ 2 2 4 flow equation flow in heterogeneous porous media is obtained by solving the darcy brinkmann equation brinkman 1947 10 ρ ν k r u p ρ ν 2 u 0 where ν is the kinematic viscosity ρ the density of the fluid and p the pressure field the darcy brinkmann equation is generally used to solve flow in very heterogeneous porous media because it allows momentum diffusion between high and low velocity regions it also provides stability of the numerical scheme by preventing strong spatial variation of the velocity talon et al 2003 ginzburg et al 2015 to solve this equation we used a two relaxation time lattice boltzmann method trt lbm described in appendix a we also provided informations on the homogeneous case and the validation of the lbm code against the analytical solution 3 characterization of transient transport regimes by means of detailed lattice boltzmann simulations in this section we study transport in heterogeneous porous media under mobile immobile mass transfer the geological model is characterized by the permeability field parameters ϕ d f 0 σ f and λ and by the transport parameters a γ and d 0 however we focus here mainly on the influence of the variance of the heterogeneity σ f and the damköhler number d a using lattice boltzmann simulations 3 1 spatial moments and breakthrough curves transport is analyzed by means of the evolution of the longitudinal second centered spatial moment of the normalized mobile concentration 11 c m c m d r c m the second centered moment of c m is defined by 12 σ 2 t d r x 2 c m d r x c m 2 where x is the component of the position vector r in streamwise direction σ t measures the spatial extension of the mobile solute plume in longitudinal direction the rate of growth of σ 2 t is measured by the macroscopic longitudinal dispersion coefficient which is defined by 13 d l m t 1 2 d σ 2 t d t furthermore we consider the mean concentration that is the breakthrough curve slightly before the outlet boundary of the flow domain at x l 4 λ it is defined by 14 b c t 1 h y c m r d y where y is the component of the position vector perpendicular to the streamwise direction and h is the height of the flow domain 3 2 transport in heterogeneous porous media in this section we detail the results of the transport simulations in heterogeneous porous media fig 1 shows typical mobile and immobile concentration fields for two different values of the damköhler number d a 1 8 and d a 1 40 with σ f 1 the two mobile concentration fields are very similar whereas important differences in the immobile concentration fields can be observed in the case of low d a there is a larger number of depleted spots dark blue at the tracer front while other spots of higher concentration can still be observed far behind the front both effects result from the disorder in the exchange time τ where some spots are characterized by large values of τ these spots require more time for tracer trapping but also for its release fig 2 displays the normalized second moment of the average concentration profile left and the breakthrough curve right for the parameters d a 1 40 σ f 1 p e 6 4 and γ 1 for small times the normalized variance follows a power law of t with an exponent α e a r l y larger than 1 characteristic of anomalous transport for larger times the evolution of the variance changes into a different anomalous behavior characterized by another power law exponent α the breakthrough curve exhibits non exponential tailing which can also be characterized by a power law of the following type 15 b c t t β due to the fact that the second moment and the breakthrough curve do not always display a power law behavior a criterion needs to be defined to establish its existence in practice the fit is done by doing a linear regression of the logarithmic derivative d log f d log t over a decade of the abscissa the constant of this regression gives then the exponent based on the slope a criterion of relevance of the power law can then be defined we fixed the following criterion if the slope is greater than 0 2 the curve is not considered as a power law in other words if the exponent varies more than 0 2 over a decade it is not considered as constant in the following we investigate the effect of the damköhler number d a the disorder σ f of the permeability field and the exponent γ on the anomalous transport characterized by the power law exponents α e a r l y α and β effect of the damköhler number d a in this paragraph we investigate transport for different values of d a in a system characterized by the following parameters σ f 1 p e 6 4 and γ 1 fig 3 represents the evolution of the normalized second moment left the normalized dispersion coefficient middle and the breakthrough curve right for different d a values as can be seen both the power law of the breakthrough curve β and the second regime of the spatial moment α depend on d a this dependency is particularly obvious when plotting d l m t d 0 the evolution of the exponent α as a function of d a is given in fig 4 left for low and high values of d a α tends to one suggesting a mere dispersive behavior if the exchange time is either very low or very high for large values of d a the system is instantaneously at equilibrium e g c m c i m in contrast for small values of d a the exchange between the mobile and immobile regions becomes extremely slow and its influence on the overall transport becomes negligible this case corresponds to the passive transport case studied in the literature where the dispersion regime is initially anomalous α e a r l y 1 due to the permeability heterogeneity and becomes normal α 1 after a certain time period in the presence of exchanges between mobile and immobile regions the transition time between the two regimes power law independent of d a and power law controlled by d a given in fig 3 is roughly independent of d a it corresponds therefore to the end of the non reactive regime which dominates at early time above this transition the effect of the exchange between mobile and immobile zones on transport becomes predominant considering the breakthrough curves fig 3 right it can be seen that for d a 0 the curve takes a gaussian shape while breakthrough curves with finite values of d a exhibit significant tailing tailing is more pronounced for intermediate d a compared to large and small d a because in both cases the influence of the exchange on the transport is not significant for certain values of d a tails follow a power law given by b c t t β fitted exponents of the latter power law are reported in fig 4 right it can be seen that the exponent is increasing with d a corresponding to less significant tailing of the concentration field at high d a effect of disorder of the permeability field σ f we now investigate the influence of σ f on the transport in a system characterized by d a 1 8 p e 6 4 and γ 1 the evolution of the normalized variance of the concentration profile the normalized dispersion coefficient and the breakthrough curves are given in fig 5 in comparison with fig 3 we can state that the early time regime depends on σ f for low heterogeneity σ f 0 25 the early time behavior is diffusive as can be seen from the normalized dispersion coefficient in fig 5 middle the transport becomes anomalous for higher values of σ f when fitting the early time data we can state that the power law exponent increases with heterogeneity see fig 6 left as already reported in the latter section after the early time regime there is a transition towards the second regime at a time which is relatively independent of σ f above this transition the normalized dispersion coefficient follows different power laws with an exponent that also depends on σ f see fig 6 left for this particular small value of d a 1 8 the early time regime exponent α e a r l y is higher than the exponent α of the second regime the opposite is however possible for some lower values of d a as shown in fig 4 in conclusion α e a r l y increases with σ f but not with d a this stands for the fact that the early time regime is dominated by the heterogeneity of the permeability but not by the exchange time fig 5 right represents the corresponding breakthrough curves as a function of σ f for very small σ f the tail is similar to a gaussian distribution by increasing σ f a retardation tail appears which becomes a power law for high heterogeneity values σ f 1 fig 6 represents the exponent β of the power law fit with eq 15 of the tail of the breakthrough curve as function of σ f the exponent decreases with increasing heterogeneity and tailing becomes very significant effect of γ in this section we investigate the impact of γ characterizing the relationship between the permeability and the exchange time τ k γ fig 7 left represents the evolution of the normalized dispersion coefficient for γ 1 0 and 1 with σ f 1 d a 1 8 and p e 6 4 for better comparison we set the logarithmic average of the permeability field exp f 0 equal to one so that the average exchange time is independent of γ from fig 7 left it can be seen that in the late time regime dispersion is anomalous for γ 0 but is normal for γ 0 the latter is characterized by d l m t d 0 c o n s t and corresponds to case where the permeability is heterogeneous but the exchange time is homogeneous for the two cases γ 1 the evolution is characteristic of anomalous dispersion and the breakthrough curve fig 7 middle presents a power law tailing effect we note that both d l m t d 0 and the breakthrough curve are very similar for γ 1 fig 7 right displays the evolution of the anomalous exponent α as function of γ obtained from the second moment of this data set we observe that data points are relatively symmetric with respect to γ 0 and increase with γ due to the fact that the exchange time distribution is log normal exchange time distributions corresponding to γ and γ have the same standard deviation and are thus statistically equivalent for γ 0 high permeabilities correspond to high exchange times whereas in the case of γ 0 high permeabilities correspond to low exchange times the fact that the curves are very similar indicates therefore that the anomalous second regime originates from the presence of a broad range of characteristic exchange times however this does not depend on whether higher exchange times correspond to regions of higher or lower permeability this behavior will be discussed later by means of the ctrw model 4 stochastic transport model to better understand the physical mechanism at work in this problem we derive a stochastic transport model based on the continuous time random walk ctrw approach the novelty of our approach lies in the combined modeling of linear kinetic exchange processes under spatially heterogeneous mass transfer properties and heterogeneous hydraulic properties the derived model is fully predictive in the sense that the parameters are fully constrained in terms of the system properties that is there are no fitting parameters we focus on longitudinal solute transport that is in the direction of the mean pressure gradient the transport of solute particles in a heterogeneous porous medium is determined by the spatial variability of the medium and flow structure consequently particle velocities and thus particle transport evolve on a characteristic length scale this notion is naturally accounted for by the ctrw approach which models particle motion as a space time random walk in which the average spatial step is constant and the time increment varies according to the local flow velocity in the following we define the trapping rate ω 1 τ as the inverse trapping time thus the evolution of the particle position x i and time t i after i random walk steps can be written as 16 x i 1 x i δ ℓ χ 2 d 0 δ ℓ v i ξ i 17 t i 1 t i τ v i θ s τ v i ω i these equations read as follows eq 16 describes the particle position after i random walk steps the second term on the right side of eq 16 denotes an advective transition over the constant distance δ ℓ χ where δ ℓ is an increment along a streamline which is projected onto the streamwise direction by the advective tortuosity χ comolli et al 2019 the third term denotes the dispersive transition which is given by a unit gaussian random variable ξ and the amplitude 2 d 0 δ ℓ v i which is the typical dispersion length during the advection time δ ℓ v i with v i the particle speed at step i eq 17 describes the particle time after i steps the second term denotes the purely advective transition which is given by 18 τ v i δ ℓ v i the single point distribution of τ v is denoted by ψ v t it is defined below in terms of the distribution of flow speeds the third term θ s on the right side of eq 17 denotes the total trapping time where the particle can be immobilized many times with rate ω i during an advective step of duration τ v i the discretization length δ ℓ should be smaller than the characteristic length scales that is the correlation scales of the underlying disorder we note that θ s depends on τ v as the probability to trapped many times increases with the advective time in the following we first summarize the modeling of the velocity transitions for a physically heterogeneous medium then we derive the stochastic representation of spatially variable linear kinetic sorption 4 1 velocity process the velocity process defined as the series of particle speeds v i is modeled as a stationary markov process dentz et al 2016 morales et al 2017 comolli et al 2019 whose steady state distribution p s v is equal to the flux weighted eulerian flow speed v e distribution dentz et al 2016 19 p s v v p e v v e the distribution ψ v t of advective transition times is given in terms of p s v and p e v as 20 ψ v t δ ℓ t 2 p s δ ℓ t δ ℓ 2 t 3 v e p e δ ℓ t relation 19 can be understood as follows the eulerian speed distribution p e v is equal to the steady state distribution of isochronically sampled flow speed which is a direct consequence of the incompressibility of the flow the particle speeds in the ctrw on the other hand are sampled equidistantly along trajectories that is low velocities are sampled less often than for isochronic sampling which is the reason for the flux weighting in relation 19 this is discussed in detail by comolli et al 2019 the speed distribution p e v is approximately log normal 21 p e v exp ln v μ e 2 2 σ e 2 v 2 π σ e 2 and can be seen in fig 8 from relation 19 we find that p s v is also log normal with the log mean given by μ s μ e σ e 2 and the same log variance σ e 2 as p e v this implies that the distribution ψ v t is also a log normal particle transitions between successive particle speeds are characterized by the conditional probability p v δ ℓ v which depends on the space increment δ ℓ that is the particle speed v n 1 is drawn from p v δ ℓ v given the value v of the particle speed v n after n steps following morales et al 2017 we model p v δ ℓ v by the conditional log normal distribution 22 p v δ ℓ v exp ln v μ s ln v 1 exp δ ℓ ℓ c 2 2 σ e 2 1 exp 2 δ ℓ ℓ c v 2 π σ e 2 1 exp 2 δ ℓ ℓ c where ℓ c denotes the correlation length of flow speeds the distribution p 0 v of initial particle speeds v 0 depends on the boundary or initial condition here particles are injected uniformly over a line perpendicular to the mean flow velocity this implies that p 0 v p e v comolli et al 2019 4 2 linear kinetic exchange process under spatially heterogeneous mass transfer properties in a particle based framework linear kinetic mass exchange processes can be modeled as a compound poisson process feller 1968 several authors margolin et al 2003 benson and meerschaert 2009 comolli et al 2016 hyman and dentz 2021 have used this approach to model multirate mass transfer and matrix diffusion under spatially homogeneous linear mass transfer properties based on the compound poisson process we derive here a novel ctrw approach for heterogeneous mass transfer systems the trapping of particles during a random walk step occurs at rate ω 1 τ such that the average number of trapping events during the advection time τ v is given by ω τ v the number n of trapping events is then distributed according to the poisson distribution 23 p n τ v ω ω τ v n exp ω τ v n the total trapping time θ s τ v ω during a random walk step is given by 24 θ s τ v ω j 1 n ϑ j where ϑ j is the trapping time for the j th sorption event the ϑ j are independent exponentially distributed according to 25 ψ ϑ ω ϕ d exp ω ϕ d ϑ with ϕ d being the ratio of the immobile volume over the mobile one the total trapping time θ s describes a compound poisson distribution feller 1968 its distribution can be expressed in laplace space as see appendix d 26 ψ c s τ v ω exp ω τ v 1 ω ϕ d ω ϕ d s where s is the laplace parameter the laplace transform is defined in abramowitz and stegun 1972 the inverse laplace transform of expression 26 can be evaluated explicitly and is given by bateman 1954 p 244 27 ψ c t τ v ω exp ω τ v δ t exp ω τ v t ϕ d ω τ v ϕ d t i 1 2 ω ϕ d t ω τ v where i 1 t is the modified bessel function of the first kind the first term denotes the probability that no exchange event occurs in which case the trapping time is zero fig 9 shows the behavior of ψ c t τ v ω for ω 1 ϕ d 1 and different τ v from these expressions one can deduce several statistical properties from the moment generating function eq 26 one can infer the mean and variance of the total trapping time 28 θ s τ v ω τ v ϕ d 29 θ s θ s 2 τ v ω 2 τ v ω ϕ d 2 2 τ v τ ϕ d 2 the first relation shows that the average total trapping time θ s depends only on the advective time τ v and not on the exchange time τ this counter intuitive result can be understood from the fact that ω 1 τ controls both the number of trapping events during the advection time and the duration of each the two effects compensate each other since a higher τ means longer trapping times but also fewer trapping events the second relationship shows that the width of the distribution is impacted by both the advection time and the exchange time this can also be understood from the fact that the total exchange time during τ v is the sum of n trapping times the variance is thus proportional to n τ 2 with n τ v τ another important quantity is the total trapping time distribution tail in eq 27 the limit of t ω ϕ d 1 ψ c t τ v ω becomes also independent of ω and can be approximated by ψ c t τ v ω δ t τ v ϕ d which means that θ s τ v ω τ v ϕ d for large values the longest exchange times are therefore controlled by the advection time only furthermore we can infer that the tail of the distribution is a log normal 4 3 model parameterization here we discuss the parameterization of the upscaled model in terms of the statistical medium description which is essential as our ctrw approach is not based on a fitting procedure 4 3 1 linear kinetic mass exchange first we consider the exchange process the model assumes that the exchange rates ω i are independent identically distributed random variables their distribution p ω ω is given in terms of the distribution of permeability p k k through the relation ω 1 τ 1 a k γ 30 p ω ω γ a 1 γ ω 1 γ 1 p k 1 a ω 1 γ that is it is fully constrained here by the point distribution of permeability and the parameter of the direct model there is no fitting parameter 4 3 2 velocity process second we consider the process of particle speeds which is defined by the conditional log normal distribution eq 22 and the log normal distribution eq 21 of eulerian flow speeds thus the speed process is parameterized by the mean μ e and variance σ e 2 of the eulerian flow speed as well as the correlation length ℓ c these parameters can be constrained by perturbation theory in the fluctuations of ln k for low and moderate heterogeneity characterized by σ f 2 lower than or of the order of one for strong heterogeneity empirical relations for the eulerian speed distribution and correlation length need to be used gotovac et al 2009 hakoun et al 2019 comolli et al 2019 to determine the model parameters by perturbation theory we notice that μ e and σ e 2 for the log normal distribution are related to the mean v and variance σ v 2 of the eulerian flow speed by 31 μ e ln v 2 v 2 σ v 2 32 σ e 2 ln 1 σ v 2 v 2 the mean flow speed v and its variance σ v 2 can be expressed in terms of the mean f 0 and variance σ f 2 of f ln k by cvetkovic et al 1996 33 v exp f 0 p 34 σ v 2 3 8 σ f 2 v 2 where p is the mean hydraulic gradient thus expressions 31 34 constrain the speed distribution in terms of the k distribution similarly we can relate the speed correlation ℓ c to the correlation length of λ of f by ℓ c π 4 λ 3 where λ is the correlation length of permeability cvetkovic et al 1996 comolli et al 2019 see also appendix a the advective tortuosity χ is given by the ratio between the mean eulerian speed v e and the mean streamwise velocity u χ v e u thus all parameters of the upscaled model are constrained by flow and medium properties there are no fitting parameters note that the upscaled model does not represent the correlation between permeability and exchange rate expressed in the detailed model by eq 3 here particle velocity on one hand and exchange rate on the other are independent 4 4 transport predictions with the upscaled ctrw model in this section we compare the predictions of the upscaled ctrw to the detailed numerical simulations for three transport scenarios characterized by σ f 1 and d a 1 25 1 0 1 6 25 1 0 2 and 2 5 1 0 2 the coupling parameter γ between permeability and exchange time is set to γ 1 the correlation length of f ln k is λ 4 in arbitrary units the mean of ln k is f 0 0 and the mean pressure gradient is unity the upscaled ctrw model is parameterized based on these characteristics as outlined in section 4 3 the numerical implementation of the upscaled model described here is efficient and allows to achieve simulation times otherwise prohibitive for the direct numerical lb simulations spatial moments and breakthrough curve the position of a mobile particle in the ctrw framework is given by 35 x t x n t v n t t t n t where n t max n t n t a particle is considered mobile if t t n t ℓ v n t the second centered longitudinal moment is then defined by 36 σ 2 t x t 2 x t 2 where the angular brackets denote the average over all mobile particles at time t the breakthrough curve b c l t is defined in terms of the arrival times of a particle at distance l from the inlet the arrival τ l is given by 37 τ l min t x n t l the breakthrough curve is then given by the distribution of arrival times as 38 b c l t δ t τ l x 4 4 1 pre asymptotic regime fig 10 shows the spatial variance normalized by the square of the correlation length for different values of d a obtained from the lb simulations solid line and from the stochastic ctrw model symbols fig 11 displays the normalized dispersion coefficient and fig 12 the breakthrough curve it can bee seen that albeit a slight offset at the beginning all ctrw predictions agree very well with the direct numerical simulations from these agreements between the lbm and ctrw several conclusions can be drawn we recall that in the ctrw model the advection rate and exchange time are drawn independently which is a strong assumption in contrast to the direct simulations where permeability and exchange rate are related by eq 3 the distributions of k and τ of the ctrw model are however related through the exponent γ the good agreement between the two approaches indicates that the results are independent of the correlation between τ and k however the results are strongly influenced by the distribution shape of the two quantities especially their width related by γ the last two points explain the above mentioned lbm result that the transport was not affected by the sign of γ but only by its magnitude indeed distributions with opposite signs of γ have the same log normal shape but the k and τ fields are anti correlated as discussed in the introduction anomalous dispersion is generally related to a broad distribution of transition times used in the ctrw approach in our model there are two contributions to this transition time the first one is the advection time whose distribution width is directly related to the permeability heterogeneity σ f this contribution is responsible for the earlier anomalous behavior α e a r l y see fig 2 the second one is the waiting time due to sorption this waiting time distribution depends on both the velocity heterogeneity and the exchange time heterogeneity as described by eq 27 physically this means that in low velocity regions particles have more time to be trapped and untrapped both σ f and σ g then contribute to the second anomalous behavior which is also very well captured by the model another indication from these model results is more technical an important issue when doing direct stochastic numerical simulations is the size of the system which must be representative this problem does not exist for the ctrw as it is a 1d problem the good agreement of the results of the two approaches thus shows that the size used in the lbm simulations is sufficiently large for this type of heterogeneity 4 4 2 asymptotic regime the stochastic ctrw model is very efficient because it depends only on point distributions of the statistical medium properties once validated it allows predictions on very large time scales in particular it shows that at very large time the variance scales asymptotically linearly with time i e asymptotically dispersion is normal this is also reflected in the evolution of the normalized dispersion coefficient d l m t which converges towards a constant asymptotic value fig 11 consequently the power law behavior characterized by α identified in the previous section is rather a transient than a true power law regime in fact the distribution ψ v t of the advective transition times is log normal similarly large exchange times can be approximated by θ s τ v ω τ v ϕ d as outlined in section 4 2 that is the long time behavior of the exchange time distribution is also log normal this implies that transport is asymptotically normal berkowitz et al 2006 with possible power law cross over behaviors as shown in section 3 2 finally it can be noted that the dispersion coefficient given by d e f f lim t d l m t d 0 decreases with d a indeed as for the homogeneous case see appendix c lower values of d a lead to stronger spreading inducing higher values of d l m t d 0 in the asymptotic regime from fig 11 it can be seen that convergence times to reach the asymptotic gaussian regime are very long additionally this time depends moderately on the damköhler number d a in conclusion our ctrw model allows robust predictions for all cases we considered and provides an efficient approach for transport predictions under conditions that are prohibitive for direct numerical simulations 5 conclusion in this article we have studied transport in a heterogeneous porous medium with a spatially varying permeability field combined with the exchange between mobile and immobile regions to model the coupling between the exchange and the local structure we assumed the following relation between the local permeability k and the local exchange time τ k γ we performed lbm simulations in a large two dimensional system to study the heterogeneity induced large scale transport behavior the transport behavior is upscaled using a new ctrw approach the impact of spatial variations in flow velocity and exchange times are modeled in terms of a spatial markov process for the particle speeds and a compound poisson process for the mass exchange kinetics the upscaled model is fully determined by the statistics of permeability and exchange parameters it has no fitting parameter we investigated the influence of the damköhler number d a the variance σ f 2 of f ln k and the value of the coupling exponent γ on the temporal evolution of the solute distribution and the breakthrough curves in the short and intermediate time range we observed transient anomalous regimes which are characterized by power law tails of the solute breakthrough curves and a power law evolution of the spatial variance of the solute distribution whereas the short time power law regime α e a r l y is strongly dependent on the heterogeneity of the permeability field the intermediate regime α is mostly dependent on both the exchange time and permeability distribution the latter regime becomes more important for large distributions of τ in particular we observe an increase in the power law exponent α for a specific range of d a in the asymptotic limit the upscaled ctrw model predicts that the transport behavior becomes fickian the resulting dispersion coefficient d e f f decreases with increasing d a we find that the time to attain the asymptotic limit depends on d a we also observe that the time to reach the asymptotic regimes in heterogeneous porous media for σ f 1 is two orders of magnitude higher than the respective time in the homogeneous case see appendix c thus the difference in convergence time strongly depends on σ f indeed for a given average value of d a it is expected that the convergence time depends on the largest values of the exchange time distribution which increase with σ f the upscaled ctrw model provides robust predictions of the behavior observed in the direct numerical simulations it relates the observed transport behaviors to the distribution of permeability which controls the distributions of the advective times and the exchange times between mobile and immobile regions an important advantage of using the ctrw model lies in the fact that the asymptotic limit of the transport behavior can be reached in a very short computation time for instance the computation times for the ctrw models is on the order of minutes using one core on a 2 ghz quad core intel core i5 processor in comparison using a similar architecture the lbm code would require about 2 3 days to compute d l t and about 2 weeks to compute the b c curve the good agreement of the ctrw with the direct simulations reveals several aspects of the transport process first the non gaussian pre asymptotic regime is determined by a broad distribution of the total trapping times which results from the coupling between the heterogeneities of the velocity field and the exchange time this coupling is due to the fact that in low velocity zones the particles have a greater probability of being trapped many times an interesting result is that the correlation between the permeability field and the exchange time has no influence on the transport because the two quantities are drawn independently in the ctrw this is also confirmed by the similarity between the results of γ 1 and γ 1 also the ctrw predicts that transport is asymptotically fickian the evolution of the spatial variance is characterized by a broad pre asymptotic cross over behavior that may be characterized by a power law finally long lasting pre asymptotic regimes could potentially explain the experimentally observed non gaussian behavior indeed the experimental time is usually limited by the size of the sample we were able to show that even for weakly heterogeneous media the non gaussian pre asymptotic regime could have a significant duration because of the heterogeneity of the exchange time in future works a challenging task will be to simulate transport in more realistic structures indeed many geological structures are more complex and display a higher heterogeneity also investigating transport in anisotropic or stratified structure will provide crucial knowledge for a better comprehension of pollutant transport in more complex subsurfaces moreover in the present work we used a constant and isotropic dispersion tensor independent of the local velocity this can be considered as a strong assumption indeed if low velocity regions are also characterized by a low dispersion coefficient the residence time would increase in these regions this coupling would then also affect the global transport in a future work it could therefore be interesting to evaluate the influence of a heterogeneous and velocity dependent dispersion tensor declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests laurent talon reports financial support was provided by cnrs marco dentz reports financial support was provided by spanish ministry of science and innovation daniela bauer reports financial support was provided by ifp energies nouvelles acknowledgments m d acknowledges the support of the spanish research agency 10 13039 501100011033 and the spanish ministry of science and innovation through the grants cex2018 000794 s and pid2019 106887gb c31 hydropore appendix a correlation length of particle velocity the correlation length of particle velocity can be determined from perturbation theory following cvetkovic et al 1996 and dagan 1989 the longitudinal macrodispersion coefficient can be written as a 1 d l 0 d t c v t where c v t is the lagrangian velocity covariance this expression can also be written as a 2 d l σ v 2 τ c τ c 1 σ v 2 0 d t c v t where σ v 2 is the velocity variance the correlation time τ c ℓ c u where u is the mean flow velocity and ℓ c is the correlation length thus we obtain a 3 ℓ c d l u σ v 2 perturbation theory gives σ v 2 3 8 σ f 2 u 2 for the gaussian covariance function employed in this study the macrodispersion coefficient is a 4 d l π 2 λ u σ f 2 thus we obtain for the correlation length ℓ c a 5 ℓ c π 4 λ 3 appendix b numerical method two relaxation time lattice boltzmann method the darcy brinkmann equation as well as the equations of the mobile immobile model are solved using a two relaxation time trt lattice boltzmann scheme which is summarized in the following for more details we refer to ginzburg et al 2008 2015 considering the resolution of the velocity field and to ginzburg and d humi eres 2010 for the advection diffusion equation b 1 darcy brinkmann equation in a first step we provide the fundamentals of lb and the numerical scheme to solve the darcy brinkmann equation given by b 1 ρ ν k r u p ρ ν δ u 0 where ν is the kinematic viscosity ρ the density of the fluid and p the pressure field the principle of the lattice boltzmann method lbm lies in the particular discretization of the boltzmann equation both space 2d in the present work and particle velocities are discretized on a regular grid the nodes of the grid are related by the velocity vectors c q with q 0 q q 9 here and particles can only move with velocities c q the population f q r t is defined as the density of particles having the velocity c q at the position r lbm schemes are based on the decomposition of the temporal evolution of the particle density in two specific steps the first step is the collision where the density populations f q meeting at the same position are redistributed according to a relaxation equation f q r t f q r t s f q r t f q e q ρ u where f q denotes the post collision populations s is a relaxation parameter and f q e q designates an equilibrium state depending on the local macroscopic variables density velocity permeability etc the second step is the propagation in this step all populations are displaced on the grid according to their velocity f q r c q t 1 f q r t the principle of the trt scheme lies in the modification of the collision step by introducing two different relaxation parameters s and s for the odd and even components of the population densities the even and odd components are defined as f q f q f q 2 and f q f q f q 2 where q denotes the opposite velocity direction to q the collision becomes then b 2 f q r t f q s n q s n q with q 0 4 b 3 f q r t f q s n q s n q with q 0 4 with n q f q e q e q are the equilibrium functions which characterize the physical equations to be solved in the case of the darcy brinkmann equation the equilibrium functions depend on the following local macroscopic quantities pressure p c s 2 ρ c s 2 q 0 q f q where c s is the numerical sound speed c s 2 1 3 here local velocity u 1 ρ 0 2 j 2 ν k with j q 0 q f q c q the equilibrium functions are given by ginzburg et al 2015 b 4 e 0 ρ 2 q 1 4 e q b 5 e q t q p ρ b 6 e q ρ 0 t q u c q λ ν k c q u where t q are coefficients depending on the direction here we use t q 1 3 for the first neighbors and t q 1 12 for the second neighbors diagonal ρ 0 is a fixed averaged density ρ 0 1 here and λ a parameter depending on the odd relaxation time b 7 λ 1 s 1 2 the scheme requires the determination of the two relaxation parameters s and s for numerical reasons precision stability it is however more convenient to prescribe the viscosity ν and a numerical parameter λ λ λ the two relaxation parameters are then deduced using the relations s 2 6 ν 1 and s 2 2 λ 3 ν 1 λ essentially controls the numerical error of the scheme ginzburg et al 2008 2015 it is set to λ 0 25 in this work advection diffusion reaction equation adre a trt scheme is also used to solve the advection diffusion reaction equation b 8 c m t u c m d δ c m r where r 1 τ c m c i m is the source term the principle is identical to the trt scheme used for the resolution of the flow equation in this case g q r t represent the densities of particles having the velocity c q at the position r the collision step is also similar b 9 g q r t g q s g q e q s g q e q with q 0 4 b 10 g q r t g q s g q e q s g q e q with q 0 4 in presence of a source term the local concentration is given by b 11 c m q 0 q g q r 2 here also it is convenient to introduce λ 1 s 1 2 the main difference with the trt scheme used for the resolution of the velocity field lies in the equilibrium functions e q b 12 e q c e q t q c s 2 1 4 u x 2 u y 2 p q x x 1 4 u x u y p q x y 1 12 u x 2 u y 2 for q 1 q b 13 e q t q c e q u c for q 1 q b 14 e 0 c e q q 1 q e q where we defined c e q c m λ r p q x x c q x 2 c q y 2 p q x y c q x c q y the diffusion coefficient is then given by d c s 2 λ the coefficient c s 2 is a constant parameter and the directional coefficients t q are now equal to 1 4 for the first neighbors and 1 8 for the diagonal links the numerical scheme thus requires the definition of the parameters d c s 2 and λ λ λ in this study we used c s 2 0 2 and λ 0 2 real time and space data are related to non dimensional and lattice boltzmann variables as follows b 15 t a d i m u l b 2 d l b t l b b 16 t r e a l d r e e l u r e a l 2 t a d i m simulation details we used a porous medium of size 1024 512 flow in x direction is driven by a body force and periodic boundary conditions are applied in the x and y direction we supposed k 0 1 in the brinkmann equation the boundary condition for the tracer are c 0 at the inlet and c m x 0 at the outlet after reaching the steady state for the flow we impose a pulse of concentration at a position slightly after the inlet x 10 p x fig b 13 shows a zoom of the permeability field left and the velocity field right figures are given for the following parameters σ f 1 λ 4 k 0 1 appendix c homogeneous porous media in this section we present results of transport governed by the mobile immobile model in a homogeneous porous medium σ f 0 in this case analytical solutions of eqs 5 have been determined by goltz and roberts 1987 showing that transport becomes gaussian fickian for large time by comparison these results allow further comprehension of transport in heterogeneous porous media but also the validation of the lattice boltzmann algorithm for homogeneous porous media the governing equations can be non dimensionalized with x x u d 0 and t t u 2 d 0 it follows c 1 c m t ϕ d c i m t c m 2 c m c i m t d a p e c m c i m the equations are now governed by only two dimensionless parameters ϕ d and ψ p e d a u 2 τ ϕ d d 0 second spatial moment of the concentration profile and breakthrough curve fig c 14 shows the averaged concentration profiles of the mobile and the total concentration at different times the corresponding breakthrough curve is given in fig c 14 for short times the concentration profiles have a slightly asymmetrical bell shape which is due to the initial condition very sharp gaussian distribution but also to the fact that transport is dominated by molecular diffusion as the influence of trapping events on transport is negligible then for slightly larger time intervals the concentration profiles become asymmetric as the influence of trapping and advection on tracer transport becomes significant finally in the large time limit profiles become gaussian again as steady state is reached a slight shift can be seen between the mobile and the total concentration that vanishes for large times fig c 15 left shows the typical curves of the normalized dispersion coefficient d l m t d 0 as a function of the non dimensional time t u 2 d 0 for different values of the dimensionless system parameter ψ p e d a u 2 a k γ ϕ d d 0 u 2 τ ϕ d d 0 for all ψ after a characteristic time τ c o n v the normalized dispersion coefficient reaches a constant value corresponding to a gaussian asymptotic behavior here the asymptotic dispersion coefficient d e f f is defined by c 2 d e f f lim t d l m t the asymptotic longitudinal dispersion coefficient d e f f has been determined analytically by goltz and roberts 1987 as c 3 d e f f d 0 1 1 ϕ d ψ ϕ d 1 ϕ d 3 fig c 16 left shows the analytical and numerical values of d e f f d 0 very good accordance between analytical and numerical data was obtained fig c 16 right gives the dependency of the numerical error on ψ even for low values of ψ the error remains smaller than 2 considering the shape of d l m t d 0 fig c 15 left two different behaviors can be observed for small ψ e g low exchange time d l m t d 0 decreases to reach a value below one this can be explained by the fact that for small values of ψ the first term in eq c 3 dominates in this case the equilibrium is very rapidly reached due to the small exchange time this regime is the well known retardation effect based on the assumption that c m c i m in eqs 4 for larger values of ψ where either the exchange time or the velocity is significant τ u 2 d 0 ϕ d d l m t d 0 takes values close to one for small times due to the predominance of molecular diffusion as trapping events start to be effective d l m t d 0 increases significantly due to the competition between advection and retention to reach a plateau after a certain time τ c o n v once the system has reached a plateau transport is gaussian the limiting case ψ deserves to be discussed because it corresponds to τ and thus to the absence of any exchange in this case the observed effective dispersion is necessarily constant and equal to d 0 but the theoretical dispersion coefficient given by eq c 3 is infinite this inconsistency is due to the fact that the convergence time τ c o n v also diverges to infinity so that the system remains in the pre asymptotic regime fig c 15 right presents the normalized convergence time u 2 τ c o n v d 0 as a function of ψ for low values of ψ the convergence time is independent of ψ as the exchange time between mobile and immobile zones is very short and the equilibrium is reached quasi instantaneously for larger ψ the convergence time increases approximately according to a power law of ψ the power law exponent is larger than one but it is expected that for very large ψ the convergence time is proportional to the exchange time τ c o n v τ and therefore τ c o n v ψ the latter is due to the fact that kinetics solely depend on the first order rate term c i m t 1 ψ c m c i m appendix d compound poisson process we derive here the laplace space eq 26 for the distribution of the total trapping time in the compound poisson process to this end we write the definition of the distribution of θ s as d 1 p c t τ v ω δ t j 1 n ϑ j d 2 n 0 δ t j 1 n ϑ j p n τ v ω ψ ϑ 1 ψ ϑ n d ϑ 1 d ϑ n where n is poisson distributed and the ϑ j are exponential distributed and independent the laplace transform of eq d 1 is d 3 p c s τ v ω 0 p c t τ v ω exp s t d t d 4 n 0 p n τ v ω exp s j 1 n ϑ j ψ ϑ 1 ψ ϑ n d ϑ 1 d ϑ n d 5 n 0 p n τ v ω j 0 n exp s ϑ j ψ ϑ j d ϑ j d 6 n 0 p n τ v ω ψ ϑ exp s ϑ d ϑ n thus d 7 p c s τ v ω n 0 ω τ v n exp ω τ v n ψ s n exp ω τ v 1 ψ s where we used the exponential sum we note that the laplace transform or ψ t given by eq 25 is d 8 ψ s ω ϕ d ω ϕ d s inserting this expression into d 7 gives eq 26 
44,the exceedance probability of extreme daily precipitation is usually quantified assuming asymptotic behaviours non asymptotic statistics however would allow us to describe extremes with reduced uncertainty and to establish relations between physical processes and emerging extremes these approaches are still mistrusted by part of the community as they rely on assumptions on the tail behaviour of the daily precipitation distribution this paper addresses this gap we use global quality controlled long rain gauge records to show that daily precipitation annual maxima are samples likely emerging from weibull tails in most of the stations worldwide these non asymptotic tails can explain the statistics of observed extremes better than asymptotic approximations from extreme value theory we call for a renewed consideration of non asymptotic statistics for the description of extremes data availability codes used for the study are available in public repositories 10 5281 zenodo 3971558 marra 2020 10 5281 zenodo 7234708 marra 2022 1 introduction the statistical analysis of hydro meteorological extremes is of critical importance for risk assessment and management early warning systems insurance and reinsurance and climate change impact studies gumbel 1958 katz et al 2002 although issues with the asymptotic assumption of extreme value theory were pointed out e g makkonen 2008 papalexiou and koutsoyiannis 2013 serinaldi and kilsby 2014 de michele 2019 the statistics of hydro meteorological extremes have been mostly explored actively assuming asymptotic behaviours reality however is not asymptotic and to what extent it can be approximated by asymptotic theory remains rather unexplored according to the extreme value theorem evt fréchet 1927 fischer and tipett 1928 gnedenko 1943 the distribution of maxima from asymptotically large blocks i e block size tending to infinity of independent and identically distributed variables can only converge to three limiting types gumbel fréchet reversed weibull the same applies to the distribution of poissonian exceedances of asymptotically high thresholds i e thresholds that tend to the upper limit of the parent distribution domain usually infinity the practical advantage of evt is clear as it allows to describe extremes sampled from unknown parent distributions using known distributions indeed general distributions which include all the three limiting types are available that is the generalized extreme value gev distribution for block maxima and the generalized pareto gp distribution for threshold exceedances von mises 1954 jenkinson 1955 since decades evt represents a major theoretical background for the statistical analysis of hydro meteorological extremes gumbel 1958 katz et al 2002 determining the tail behaviour of a variable of interest that is the rate at which the probability of exceeding increasingly high values decreases is crucial because it drastically influences the design values used in applications two recent studies summarize the state of the art for what concerns daily precipitation papalexiou and koutsoyiannis 2013 examined more than 15 000 records of annual maxima globally with the aim of identifying which of the three limiting types could better describe reality and at what conditions the length of the available record strongly affects the estimation of the gev shape parameter which ultimately determines the limiting type this has important implications for the estimation of design values in regions where short data records are available such as many countries of the global south correcting for the effect of record length papalexiou and koutsoyiannis 2013 could narrow the range in which this parameter varies revealing that the fréchet law characterised by tails heavier than exponential i e the exceedance probability of extremely large values decreases more slowly than a negative exponential function is the most likely limiting type globally similarly serinaldi and kilsby 2014 examined approximately 1900 complete records of daily precipitation to investigate the case of threshold exceedances again the mean shape parameter tends to positive values i e pareto law unbounded power type tail and its estimation variance decreases with record length additionally they showed that when the threshold is decreased the evt asymptotic assumption becomes less realistic and the gp asymptote is replaced by a weibull penultimate asymptote when the tail of the parent distribution f x is known however the extreme value distribution ζ x of the maxima sampled from n sized blocks can be derived analytically e g see de michele 2019 1 ζ x f x n in real cases the block size n may vary across the blocks j 1 m and eq 1 can be replaced by the expression ζ x j 1 m f x n j where m is the number of blocks e g years marani and ignaccolo 2015 notably when estimating rare extremes this inter block variability can be neglected and eq 1 can still be adopted using for n the expected value of the block size n 1 m j 1 m n j marra et al 2019 see also serinaldi et al 2020 while these non asymptotic solutions require a confident a priori assumption about the tail behaviour of the parent distribution f x they allow us to use ordinary statistics to describe extremes this brings important advantages over evt 1 we could reduce estimation uncertainty because the parameters of f x can be inferred from many independent events while the parameters of the limiting distributions can only be inferred from extremes 2 we could establish direct relations between ordinary and extreme events that is between the physics of the processes and the statistics of the emerging extremes similarly to extreme value mixture models non asymptotic methods also allow to handle the statistics of extremes that emerge from multiple processes and thus violate the identical distribution assumption of traditional evt using ζ x i 1 s f i x n i where i 1 s represents a process of interest marra et al 2019 these advantages are very appealing for example if one wants to consider the diverse impact that climate change may have on different synoptic meteorological systems and precipitation processes this brings us to a natural question provided a robust hypothesis on the tail of f x is available why we do not routinely use these non asymptotic solutions indeed non asymptotic approaches are adopted and yield rather encouraging results e g zorzetto et al 2016 vidrio sahagún and he 2022 but are still mistrusted by part of the community a common objection paradoxically stems from a limitation of evt itself that is the stochastic uncertainty that characterizes the observed extremes e g serinaldi and kilsby 2015 fatichi et al 2016 tabari 2021 in fact goodness of fit tests based on the observed extremes will rarely prefer distributions derived from many ordinary events such as eq 1 over distributions directly derived from the observed extremes such as evt this spreads concern about the ability of non asymptotic methods to reproduce extremes but is a goodness of fit with respect to a largely uncertain sample a proper measure of the quality of a model a second common objection claims that extremes are different and we cannot infer their statistics from the ordinary events while apparently reasonable this objection contrasts evt in the same way it contrasts non asymptotic approaches in fact even neglecting identical distribution issues the asymptotic assumption of evt ultimately requires in each block an infinitely large sample of all the extremes we want to describe how is this possible if extremes are so different that we only have a few of them in our entire record if we want to say anything at all about the problem we need to accept evt and eq 1 to the same extent because they ultimately build on a common practical necessity the information we have about extremes is contained in our sample the alternative would be to wait a million years and derive our statistics empirically from a non asymptotic perspective the problem then becomes can we identify and recognize the tail of a parent distribution f x that contains at least the same information as the extremes used in evt in this study we make a significant step toward the use of non asymptotic approaches for the analysis of extreme daily precipitation a case for which a physics backed model for the tail of the parent distribution is available the weibull distribution we perform a global analysis on long rain gauge records to test whether the observed extremes are likely samples from weibull tails and to evaluate how well non asymptotic samples from weibull tails explain the statistics of observed extremes and the emerging asymptotic limiting types 2 methods 2 1 data we integrate 1 the global daily precipitation dataset created by papalexiou and montanari 2019 based on the global historical climatology network daily database menne et al 2012a with data covering 2 tropical sub saharan africa ghana amponsah et al 2022 and 2 mediterranean semiarid and arid regions in the levant israel marra et al 2021 although only accounting for a small fraction of the entire dataset these two additional sources represent the sub sampled climate of sub saharan africa typically characterized by fairly homogeneous climate stretching from the east coast of the atlantic ocean in west africa through east africa peel et al 2007 panthou et al 2012 and the sharp transition between mediterranean and arid climates of the southern mediterranean goldreich 2003 both the additional datasets were quality controlled by the ghana meteorological agency using the clidata software www clidata cz the israel meteorological service and by the authors of the studies for the dataset at 3 only data from israel for which the quality control history was known have been retained the global dataset at 1 was carefully screened by papalexiou and montanari 2019 to only retain stations with at least 50 years with less than 1 of the days assigned with quality flags similarly we screened the datasets at 2 and 3 to only retain stations with less than 1 of the days assigned with quality flags we further screen the data to remove possible duplicate stations and to extract long and complete records of daily precipitation only years with less than 10 missing data are considered complete and only stations with at least 50 complete calendar years are retained the final dataset consists of 8254 stations see fig s1 in the supporting information for the exact locations 2 2 non asymptotic approach 2 2 1 a parent distribution for heavy daily precipitation following theoretical reasoning e g wilson and toumi 2005 porporato et al 2006 and empirical results e g papalexiou and koutsoyiannis 2012 serinaldi and kilsby 2014 zorzetto et al 2016 we focus on parent distributions with weibull tails the weibull distribution should not be confused with the third limiting type of the evt which is the reversed weibull law and is upper bounded the weibull distribution belongs to the powered exponential family and its cumulative distribution function has a scale parameter λ and a shape parameter κ 2 f x 1 exp x λ κ although asymptotically converging to the gumbel law weibull tails are compatible with previous findings showing that extreme precipitation tends to follow the fréchet law as strange it may seem annual maxima extracted from a parent distribution that belongs to the domain of attraction of the gumbel law such as weibull are better described by the fréchet law this occurs for two reasons first the convergence rate to the gumbel law is extremely slow and second the shape parameter of the fréchet law enables the distribution to approximate quite well not only distributions with power type tails but also other heavy tailed distributions papalexiou and koutsoyiannis 2013 here we define as wet all the days in which at least 0 1 mm of precipitation is reported and we assume independence of the wet days note that daily precipitation typically has low lag 1 autocorrelation around 0 1 0 4 and even wet hours have moderate autocorrelation papalexiou 2022 monte carlo simulations show that our results would be essentially unaltered by the presence of such correlations the parameters of the weibull distribution are estimated by left censoring the ordinary events not exceeding a threshold of interest see below and using a least square linear regression in weibull transformed coordinates codes available in marra 2020 2 2 2 a test for the tail of the parent distribution saying that daily precipitation has a weibull tail means that there exists a threshold θ above which the parent distribution f x can be approximated using the two parameter weibull distribution in eq 2 to verify this assumption we use a monte carlo test based on the idea presented in marra et al 2020 and refined by marra et al 2022 the test starts from a null hypothesis about the tail behaviour of f x and evaluates whether the observed extremes are compatible with this model the added value of this approach over goodness of fit methods is twofold first we start from a physics backed hypothesis in our case the weibull model by wilson and toumi 2005 and test whether the statistics of the observed extremes are or are not likely samples from this tail model second we explicitly censor all the observed extremes from the tail testing and definition to do so we explicitly censor from the parameter estimation both the values below a given left censoring threshold and all the annual maxima this grants an independent evaluation of the ability of our tail model to represent the statistics of the observed extremes a feature not available using evt methods the test proceeds as follows 1 estimate the tail model parameters corresponding to a given left censoring threshold θ by explicitly censoring the observed block maxima i e censoring their magnitude but retaining their weight in probability in our case we estimate λ and κ of eq 2 but any tail model can be considered and tested 2 generate a large number of synthetic records according to this tail model and with the same sampling characteristics of observations number of blocks number of elements per block 3 test whether observed maxima are likely samples from these records a schematic of the test is provided in fig 1 and the codes are made available in marra 2022 the outcome of the test cannot guarantee a specific tail model is appropriate but serves as a filter to reject models which contradict observations additionally the sensitivity of the test and its specificity against alternative hypotheses can be evaluated in a controlled environment see fig s2 we generate 500 synthetic records for each case and reject the weibull model whenever more than p 10 of the observed maxima lie outside of the 1 p 90 sampling confidence interval of the synthetic records the choice of p should account for the length of the available record i e how many block maxima are observed since its outcomes ultimately depend on the observed maxima the test is subject to some level of stochasticity it is advised to run it over multiple records for which a homogeneous left censoring threshold is expected e g nearby independent stations to gather robust results analyses based on synthetic data show that the test is robust fig s2 the probability of type i errors wrong rejection of weibull tail is of the order of 5 10 the probability of type ii errors wrong not rejection of weibull tail depends on the alternative tail in presence of generalized pareto tails type ii errors are likely and their probability depends on the characteristics of the data and on the adopted left censoring thresholds in presence of power type tails a supported heavy tail alternative the probability of type ii errors is zero or close to zero running the test over different thresholds and selecting the smallest left censoring threshold θ for which the test is not rejected fig 1 allows us to identify the tail of the parent distribution for which we cannot reject the assumption that block maxima were sampled here we test thresholds between θ 0 i e all non zero daily precipitation amounts are in the tail to θ 0 95 i e the 95 th percentile with steps of 0 05 our definition of the left censoring thresholds implies that any threshold θ θ leads to the same tail model marra et al 2019 when our tail model is rejected also for θ 0 95 we consider the weibull tail as rejected but we retain results for θ 0 95 in the subsequent analyses 2 3 comparison between non asymptotic weibull tails and asymptotic tails thresholds exceedances to define generalized pareto gp tails as in evt are extracted using thresholds θ gp 0 95 this threshold should asymptotically tend to infinity and our choice comes as a compromise with sample size results derived from higher thresholds such as the 98 th percentile used by serinaldi and kilsby 2014 are qualitatively analogous but characterized by larger uncertainties parameters of the gp distribution describing the exceedances are estimated with the l moments method hosking 1990 we quantify the statistical properties of extremes using the third and fourth l moment ratios of the annual maxima l skewness and l kurtosis hosking 1990 these are linear combinations of order statistics of a distribution and are used to quantitatively describe its high moments shape characteristics they are independent of the statistical model used to describe extremes and are robust to stochastic sampling uncertainties we compute l moment ratios from observed annual maxima to serve as a quantification of the statistical properties of the observed extremes and from stochastic samples derived from weibull and gp tails each stochastic sample is composed of m blocks and n elements in each block with n rounded to the closest integer thus reflecting the non asymptotic characteristics of reality from each sample we extract the block maxima and estimate the corresponding l moment ratios weibull tails are generated as weibull distributed records with n elements in each block gp tails are generated as gp distributed threshold exceedances and are composed of 1 θ gp n elements the remaining n θ gp elements are infilled by randomly resampling the observations below threshold for each station and model we generate two distinct cases 1 synthetic samples with the same number of blocks as the observed records and optimal parameters i e the ones for θ θ and θ gp 0 95 these samples reproduce the characteristics of reality and are used to visually compare reality and models by means of l moment ratios diagrams 2 synthetic samples with m 103 and parameters derived using thresholds increasing from 0 to 0 95 with steps of 0 05 these samples represent ideal long record conditions for which sampling uncertainty is negligible they are used to quantify the deviations between the statistics of observed maxima and the statistics of maxima sampled from the different tail models here we examine a third tail model gp which consists of gp tails whose parameters are estimated from the synthetic weibull samples this third model represents a situation in which reality has weibull tails and gp tails are erroneously assumed sample variability related to finite length observations are quantified as the difference between theoretical l moments derived from weibull tails and empirical l moments computed from the m blocks samples from weibull tails where m is the number of available blocks for the station of interest to this end we generate 25 synthetic samples for each station and show the median value across these samples we derive analytically the shape parameter of a gev distribution fitting annual maxima from weibull tails with the same characteristics as the observed data to do so we compute the theoretical l skewness of annual maxima sampled from non asymptotic weibull tails by integrating numerically du 10 6 the relation provided in zaghloul et al 2020 τ 3 0 1 q u 1 κ n 6 u 2 6 u 1 d u 0 1 q u 1 κ n 2 u 1 d u where q u 1 κ n f 1 κ n is the quantile function of an exponentiated weibull and n is the average number of ordinary events per year rounded to the closest integer we then derive the shape parameter γ gev of the gev distribution corresponding to the computed l skewness by inverting the relation τ 3 2 1 3 γ gev 1 2 γ gev 3 hosking 1990 this parameter can be interpreted as the apparent limiting type for block maxima emerging from non asymptotic weibull tails 3 results the assumption of having the observed annual maximum daily precipitation emerging from non asymptotic weibull tails cannot be rejected in 89 of the stations globally fig 2 b most 74 of the regions for which sufficient data is available we report results for 5 5 boxes with at least 10 stations see fig 2a show rejection rates not exceeding 10 rejection rates never exceed 45 and exceed 30 in less than 5 of the examined regions most of the stations globally 55 need left censoring thresholds as low as θ 0 75 and 76 of the stations globally need left censoring thresholds θ 0 9 fig 2c given the sensitivity of our test and its specificity against alternative tails fig s2 these results imply that for a large majority of the examined areas non asymptotic weibull tails are to be preferred over heavier tailed options regions with higher rejection rates are clustered in three main areas central northern europe and the atlantic coasts of north and south america fig 2b here weibull tails could be either too light or too heavy to fully describe the observed annual maxima qualitative analyses not shown suggest that weibull tails could be too light in the two regions in the northern hemisphere and too heavy in the atlantic coast of south america it could be that the assumptions used by wilson and toumi 2005 to derive the weibull tail model are less verified in these regions for example temporal trends would lead to apparently heavier tails this is expected to be more likely in stations with longer records but we could not find any evidence of such a relation it should be however noticed that as shown by amponsah et al 2022 see the supporting information therein the trends typically reported are not large enough to impact the results of our test another possibility is that the assumption of independence of the wet days could be less verified in some areas additionally monte carlo simulations show that deviations from the assumption of independence of the wet days may cause the test to reject the weibull tail hypothesis more often for example this could be the case of northern europe where long lasting stratiform events are frequent future works should investigate more in detail the possible physical and or statistical reasons behind these behaviours l moment ratio diagrams such as the one in fig 3 are commonly used to assess the reliability of specific tail models fig 3a shows that gp tails blue are able to capture the general statistics of annual maxima black although an important tendency to over estimate tail heaviness is manifested l skewness values greater than the largest observed value globally are often reported even reaching values as high as 0 6 or 0 7 considering that gev distributions with shape parameter greater than 0 5 displayed in the secondary axis of the figure as γ gev have infinite variance these values are likely unrealistic these qualitative results support previous findings in which gp tails used to create synthetic data were shown to generate unrealistically high values and the creation of a powered exponential system of distributions introduced in papalexiou 2022 to support the stochastic modelling of precipitation at multiple scales the statistics emerging from non asymptotic weibull tails in red in fig 3b closely resemble the ones of observations black and the ones reported for the global dataset of daily annual maxima 15 000 stations by papalexiou and koutsoyiannis 2013 the apparent gev shape parameters emerging from non asymptotic weibull tails depend on the shape parameter of the underlying weibull distribution and on the average yearly number of wet days fig 4 a convergence to the limiting distribution gumbel law with γ gev 0 in the case of weibull tails is extremely slow and stations with over 250 wet days are still far from this limit note the logarithmic scale on the colour bar the apparent limiting type is coherent with the parameter range extrapolated by papalexiou and koutsoyiannis 2013 overall 98 of the stations worldwide appear to follow the fréchet law and only 0 2 the reversed weibull law fig 4b fig 5 a b shows the error in l skewness and l kurtosis of annual maxima emerging from non asymptotic tails with respect to the ones computed from the observed maxima we show the case of weibull tails red and gp tails blue estimated using different left censoring thresholds θ the figure highlights two important aspects first within the stochastic uncertainties related to the available records shaded in grey the 90 confidence interval of the median across stations the statistics of annual maxima are well reproduced by non asymptotic weibull tails even for relatively low thresholds conversely the errors for maxima sampled from gp tails strongly depend on the left censoring threshold and tend to be too heavy tailed for θ 0 90 the accuracy of gp tails in reproducing the statistics of observed maxima is comparable to the one of weibull tails only for thresholds θ 0 9 second gp tails estimated from synthetic weibull distributed data are virtually indistinguishable from the gp tails estimated from real observations dashed blue as predicted by evt gp tails tend to provide similar estimates upon asymptotic conditions here represented by θ gp 0 95 see also serinaldi and kilsby 2014 and the difference in l moment ratios between non asymptotic weibull tails and gp tails decreases with increasing threshold fig 5c crucially the difference between l moment ratios of annual maxima emerging from gp and gp tails dashed are virtually indistinguishable also for high thresholds such as θ 0 95 and smaller than the differences between l moment ratios of annual maxima emerging from gp and weibull tails fig 5c estimating gp tails from observations is equivalent to estimating gp tails from weibull data 4 conclusions a large dataset of long recording quality controlled rain gauges is used to explore the statistics of extreme daily precipitation from a non asymptotic perspective we start from a physics backed hypothesis and we consider the specificity of our test with respect to alternative hypotheses the null hypothesis of having daily precipitation annual maxima emerging from parent distributions with weibull tails cannot be rejected in 89 of the stations analysed all over the globe we identify specific regions where this assumption could be less robust and that require further investigations of the underlying physical reasons we show that daily precipitation with non asymptotic weibull tails can explain 1 the l moment ratios of observed annual maxima 2 the apparent asymptotic limiting behaviour of annual maxima and 3 the characteristics of asymptotic tails estimated from observations these results support the use of non asymptotic weibull tails to estimate the statistics of extreme daily precipitation in many regions of the earth similar analyses based on sub daily and multi day durations are solicited to extend our knowledge of heavy precipitation across scales reality is not asymptotic we call for a renewed consideration of non asymptotic statistics for the description of extremes credit authorship contribution statement francesco marra conceptualization data curation writing original draft writing review editing william amponsah data curation writing review editing simon michael papalexiou conceptualization data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements codes used for the study are available in public repositories 10 5281 zenodo 3971558 marra 2020 10 5281 zenodo 7234708 marra 2022 rain gauge data were obtained combining the dataset from papalexiou and montanari 2019 based on menne et al 2012b version 3 22 marra et al 2021 quality controlled stations only and amponsah et al 2022 we thank the ghana meteorological agency yoav levi from the israel meteorological service and efrat morin from the hebrew university of jerusalem for providing the data fm was supported by the cariparo foundation through the excellence grant 2021 to the resilience project and by internal projecs of cnr isac 
44,the exceedance probability of extreme daily precipitation is usually quantified assuming asymptotic behaviours non asymptotic statistics however would allow us to describe extremes with reduced uncertainty and to establish relations between physical processes and emerging extremes these approaches are still mistrusted by part of the community as they rely on assumptions on the tail behaviour of the daily precipitation distribution this paper addresses this gap we use global quality controlled long rain gauge records to show that daily precipitation annual maxima are samples likely emerging from weibull tails in most of the stations worldwide these non asymptotic tails can explain the statistics of observed extremes better than asymptotic approximations from extreme value theory we call for a renewed consideration of non asymptotic statistics for the description of extremes data availability codes used for the study are available in public repositories 10 5281 zenodo 3971558 marra 2020 10 5281 zenodo 7234708 marra 2022 1 introduction the statistical analysis of hydro meteorological extremes is of critical importance for risk assessment and management early warning systems insurance and reinsurance and climate change impact studies gumbel 1958 katz et al 2002 although issues with the asymptotic assumption of extreme value theory were pointed out e g makkonen 2008 papalexiou and koutsoyiannis 2013 serinaldi and kilsby 2014 de michele 2019 the statistics of hydro meteorological extremes have been mostly explored actively assuming asymptotic behaviours reality however is not asymptotic and to what extent it can be approximated by asymptotic theory remains rather unexplored according to the extreme value theorem evt fréchet 1927 fischer and tipett 1928 gnedenko 1943 the distribution of maxima from asymptotically large blocks i e block size tending to infinity of independent and identically distributed variables can only converge to three limiting types gumbel fréchet reversed weibull the same applies to the distribution of poissonian exceedances of asymptotically high thresholds i e thresholds that tend to the upper limit of the parent distribution domain usually infinity the practical advantage of evt is clear as it allows to describe extremes sampled from unknown parent distributions using known distributions indeed general distributions which include all the three limiting types are available that is the generalized extreme value gev distribution for block maxima and the generalized pareto gp distribution for threshold exceedances von mises 1954 jenkinson 1955 since decades evt represents a major theoretical background for the statistical analysis of hydro meteorological extremes gumbel 1958 katz et al 2002 determining the tail behaviour of a variable of interest that is the rate at which the probability of exceeding increasingly high values decreases is crucial because it drastically influences the design values used in applications two recent studies summarize the state of the art for what concerns daily precipitation papalexiou and koutsoyiannis 2013 examined more than 15 000 records of annual maxima globally with the aim of identifying which of the three limiting types could better describe reality and at what conditions the length of the available record strongly affects the estimation of the gev shape parameter which ultimately determines the limiting type this has important implications for the estimation of design values in regions where short data records are available such as many countries of the global south correcting for the effect of record length papalexiou and koutsoyiannis 2013 could narrow the range in which this parameter varies revealing that the fréchet law characterised by tails heavier than exponential i e the exceedance probability of extremely large values decreases more slowly than a negative exponential function is the most likely limiting type globally similarly serinaldi and kilsby 2014 examined approximately 1900 complete records of daily precipitation to investigate the case of threshold exceedances again the mean shape parameter tends to positive values i e pareto law unbounded power type tail and its estimation variance decreases with record length additionally they showed that when the threshold is decreased the evt asymptotic assumption becomes less realistic and the gp asymptote is replaced by a weibull penultimate asymptote when the tail of the parent distribution f x is known however the extreme value distribution ζ x of the maxima sampled from n sized blocks can be derived analytically e g see de michele 2019 1 ζ x f x n in real cases the block size n may vary across the blocks j 1 m and eq 1 can be replaced by the expression ζ x j 1 m f x n j where m is the number of blocks e g years marani and ignaccolo 2015 notably when estimating rare extremes this inter block variability can be neglected and eq 1 can still be adopted using for n the expected value of the block size n 1 m j 1 m n j marra et al 2019 see also serinaldi et al 2020 while these non asymptotic solutions require a confident a priori assumption about the tail behaviour of the parent distribution f x they allow us to use ordinary statistics to describe extremes this brings important advantages over evt 1 we could reduce estimation uncertainty because the parameters of f x can be inferred from many independent events while the parameters of the limiting distributions can only be inferred from extremes 2 we could establish direct relations between ordinary and extreme events that is between the physics of the processes and the statistics of the emerging extremes similarly to extreme value mixture models non asymptotic methods also allow to handle the statistics of extremes that emerge from multiple processes and thus violate the identical distribution assumption of traditional evt using ζ x i 1 s f i x n i where i 1 s represents a process of interest marra et al 2019 these advantages are very appealing for example if one wants to consider the diverse impact that climate change may have on different synoptic meteorological systems and precipitation processes this brings us to a natural question provided a robust hypothesis on the tail of f x is available why we do not routinely use these non asymptotic solutions indeed non asymptotic approaches are adopted and yield rather encouraging results e g zorzetto et al 2016 vidrio sahagún and he 2022 but are still mistrusted by part of the community a common objection paradoxically stems from a limitation of evt itself that is the stochastic uncertainty that characterizes the observed extremes e g serinaldi and kilsby 2015 fatichi et al 2016 tabari 2021 in fact goodness of fit tests based on the observed extremes will rarely prefer distributions derived from many ordinary events such as eq 1 over distributions directly derived from the observed extremes such as evt this spreads concern about the ability of non asymptotic methods to reproduce extremes but is a goodness of fit with respect to a largely uncertain sample a proper measure of the quality of a model a second common objection claims that extremes are different and we cannot infer their statistics from the ordinary events while apparently reasonable this objection contrasts evt in the same way it contrasts non asymptotic approaches in fact even neglecting identical distribution issues the asymptotic assumption of evt ultimately requires in each block an infinitely large sample of all the extremes we want to describe how is this possible if extremes are so different that we only have a few of them in our entire record if we want to say anything at all about the problem we need to accept evt and eq 1 to the same extent because they ultimately build on a common practical necessity the information we have about extremes is contained in our sample the alternative would be to wait a million years and derive our statistics empirically from a non asymptotic perspective the problem then becomes can we identify and recognize the tail of a parent distribution f x that contains at least the same information as the extremes used in evt in this study we make a significant step toward the use of non asymptotic approaches for the analysis of extreme daily precipitation a case for which a physics backed model for the tail of the parent distribution is available the weibull distribution we perform a global analysis on long rain gauge records to test whether the observed extremes are likely samples from weibull tails and to evaluate how well non asymptotic samples from weibull tails explain the statistics of observed extremes and the emerging asymptotic limiting types 2 methods 2 1 data we integrate 1 the global daily precipitation dataset created by papalexiou and montanari 2019 based on the global historical climatology network daily database menne et al 2012a with data covering 2 tropical sub saharan africa ghana amponsah et al 2022 and 2 mediterranean semiarid and arid regions in the levant israel marra et al 2021 although only accounting for a small fraction of the entire dataset these two additional sources represent the sub sampled climate of sub saharan africa typically characterized by fairly homogeneous climate stretching from the east coast of the atlantic ocean in west africa through east africa peel et al 2007 panthou et al 2012 and the sharp transition between mediterranean and arid climates of the southern mediterranean goldreich 2003 both the additional datasets were quality controlled by the ghana meteorological agency using the clidata software www clidata cz the israel meteorological service and by the authors of the studies for the dataset at 3 only data from israel for which the quality control history was known have been retained the global dataset at 1 was carefully screened by papalexiou and montanari 2019 to only retain stations with at least 50 years with less than 1 of the days assigned with quality flags similarly we screened the datasets at 2 and 3 to only retain stations with less than 1 of the days assigned with quality flags we further screen the data to remove possible duplicate stations and to extract long and complete records of daily precipitation only years with less than 10 missing data are considered complete and only stations with at least 50 complete calendar years are retained the final dataset consists of 8254 stations see fig s1 in the supporting information for the exact locations 2 2 non asymptotic approach 2 2 1 a parent distribution for heavy daily precipitation following theoretical reasoning e g wilson and toumi 2005 porporato et al 2006 and empirical results e g papalexiou and koutsoyiannis 2012 serinaldi and kilsby 2014 zorzetto et al 2016 we focus on parent distributions with weibull tails the weibull distribution should not be confused with the third limiting type of the evt which is the reversed weibull law and is upper bounded the weibull distribution belongs to the powered exponential family and its cumulative distribution function has a scale parameter λ and a shape parameter κ 2 f x 1 exp x λ κ although asymptotically converging to the gumbel law weibull tails are compatible with previous findings showing that extreme precipitation tends to follow the fréchet law as strange it may seem annual maxima extracted from a parent distribution that belongs to the domain of attraction of the gumbel law such as weibull are better described by the fréchet law this occurs for two reasons first the convergence rate to the gumbel law is extremely slow and second the shape parameter of the fréchet law enables the distribution to approximate quite well not only distributions with power type tails but also other heavy tailed distributions papalexiou and koutsoyiannis 2013 here we define as wet all the days in which at least 0 1 mm of precipitation is reported and we assume independence of the wet days note that daily precipitation typically has low lag 1 autocorrelation around 0 1 0 4 and even wet hours have moderate autocorrelation papalexiou 2022 monte carlo simulations show that our results would be essentially unaltered by the presence of such correlations the parameters of the weibull distribution are estimated by left censoring the ordinary events not exceeding a threshold of interest see below and using a least square linear regression in weibull transformed coordinates codes available in marra 2020 2 2 2 a test for the tail of the parent distribution saying that daily precipitation has a weibull tail means that there exists a threshold θ above which the parent distribution f x can be approximated using the two parameter weibull distribution in eq 2 to verify this assumption we use a monte carlo test based on the idea presented in marra et al 2020 and refined by marra et al 2022 the test starts from a null hypothesis about the tail behaviour of f x and evaluates whether the observed extremes are compatible with this model the added value of this approach over goodness of fit methods is twofold first we start from a physics backed hypothesis in our case the weibull model by wilson and toumi 2005 and test whether the statistics of the observed extremes are or are not likely samples from this tail model second we explicitly censor all the observed extremes from the tail testing and definition to do so we explicitly censor from the parameter estimation both the values below a given left censoring threshold and all the annual maxima this grants an independent evaluation of the ability of our tail model to represent the statistics of the observed extremes a feature not available using evt methods the test proceeds as follows 1 estimate the tail model parameters corresponding to a given left censoring threshold θ by explicitly censoring the observed block maxima i e censoring their magnitude but retaining their weight in probability in our case we estimate λ and κ of eq 2 but any tail model can be considered and tested 2 generate a large number of synthetic records according to this tail model and with the same sampling characteristics of observations number of blocks number of elements per block 3 test whether observed maxima are likely samples from these records a schematic of the test is provided in fig 1 and the codes are made available in marra 2022 the outcome of the test cannot guarantee a specific tail model is appropriate but serves as a filter to reject models which contradict observations additionally the sensitivity of the test and its specificity against alternative hypotheses can be evaluated in a controlled environment see fig s2 we generate 500 synthetic records for each case and reject the weibull model whenever more than p 10 of the observed maxima lie outside of the 1 p 90 sampling confidence interval of the synthetic records the choice of p should account for the length of the available record i e how many block maxima are observed since its outcomes ultimately depend on the observed maxima the test is subject to some level of stochasticity it is advised to run it over multiple records for which a homogeneous left censoring threshold is expected e g nearby independent stations to gather robust results analyses based on synthetic data show that the test is robust fig s2 the probability of type i errors wrong rejection of weibull tail is of the order of 5 10 the probability of type ii errors wrong not rejection of weibull tail depends on the alternative tail in presence of generalized pareto tails type ii errors are likely and their probability depends on the characteristics of the data and on the adopted left censoring thresholds in presence of power type tails a supported heavy tail alternative the probability of type ii errors is zero or close to zero running the test over different thresholds and selecting the smallest left censoring threshold θ for which the test is not rejected fig 1 allows us to identify the tail of the parent distribution for which we cannot reject the assumption that block maxima were sampled here we test thresholds between θ 0 i e all non zero daily precipitation amounts are in the tail to θ 0 95 i e the 95 th percentile with steps of 0 05 our definition of the left censoring thresholds implies that any threshold θ θ leads to the same tail model marra et al 2019 when our tail model is rejected also for θ 0 95 we consider the weibull tail as rejected but we retain results for θ 0 95 in the subsequent analyses 2 3 comparison between non asymptotic weibull tails and asymptotic tails thresholds exceedances to define generalized pareto gp tails as in evt are extracted using thresholds θ gp 0 95 this threshold should asymptotically tend to infinity and our choice comes as a compromise with sample size results derived from higher thresholds such as the 98 th percentile used by serinaldi and kilsby 2014 are qualitatively analogous but characterized by larger uncertainties parameters of the gp distribution describing the exceedances are estimated with the l moments method hosking 1990 we quantify the statistical properties of extremes using the third and fourth l moment ratios of the annual maxima l skewness and l kurtosis hosking 1990 these are linear combinations of order statistics of a distribution and are used to quantitatively describe its high moments shape characteristics they are independent of the statistical model used to describe extremes and are robust to stochastic sampling uncertainties we compute l moment ratios from observed annual maxima to serve as a quantification of the statistical properties of the observed extremes and from stochastic samples derived from weibull and gp tails each stochastic sample is composed of m blocks and n elements in each block with n rounded to the closest integer thus reflecting the non asymptotic characteristics of reality from each sample we extract the block maxima and estimate the corresponding l moment ratios weibull tails are generated as weibull distributed records with n elements in each block gp tails are generated as gp distributed threshold exceedances and are composed of 1 θ gp n elements the remaining n θ gp elements are infilled by randomly resampling the observations below threshold for each station and model we generate two distinct cases 1 synthetic samples with the same number of blocks as the observed records and optimal parameters i e the ones for θ θ and θ gp 0 95 these samples reproduce the characteristics of reality and are used to visually compare reality and models by means of l moment ratios diagrams 2 synthetic samples with m 103 and parameters derived using thresholds increasing from 0 to 0 95 with steps of 0 05 these samples represent ideal long record conditions for which sampling uncertainty is negligible they are used to quantify the deviations between the statistics of observed maxima and the statistics of maxima sampled from the different tail models here we examine a third tail model gp which consists of gp tails whose parameters are estimated from the synthetic weibull samples this third model represents a situation in which reality has weibull tails and gp tails are erroneously assumed sample variability related to finite length observations are quantified as the difference between theoretical l moments derived from weibull tails and empirical l moments computed from the m blocks samples from weibull tails where m is the number of available blocks for the station of interest to this end we generate 25 synthetic samples for each station and show the median value across these samples we derive analytically the shape parameter of a gev distribution fitting annual maxima from weibull tails with the same characteristics as the observed data to do so we compute the theoretical l skewness of annual maxima sampled from non asymptotic weibull tails by integrating numerically du 10 6 the relation provided in zaghloul et al 2020 τ 3 0 1 q u 1 κ n 6 u 2 6 u 1 d u 0 1 q u 1 κ n 2 u 1 d u where q u 1 κ n f 1 κ n is the quantile function of an exponentiated weibull and n is the average number of ordinary events per year rounded to the closest integer we then derive the shape parameter γ gev of the gev distribution corresponding to the computed l skewness by inverting the relation τ 3 2 1 3 γ gev 1 2 γ gev 3 hosking 1990 this parameter can be interpreted as the apparent limiting type for block maxima emerging from non asymptotic weibull tails 3 results the assumption of having the observed annual maximum daily precipitation emerging from non asymptotic weibull tails cannot be rejected in 89 of the stations globally fig 2 b most 74 of the regions for which sufficient data is available we report results for 5 5 boxes with at least 10 stations see fig 2a show rejection rates not exceeding 10 rejection rates never exceed 45 and exceed 30 in less than 5 of the examined regions most of the stations globally 55 need left censoring thresholds as low as θ 0 75 and 76 of the stations globally need left censoring thresholds θ 0 9 fig 2c given the sensitivity of our test and its specificity against alternative tails fig s2 these results imply that for a large majority of the examined areas non asymptotic weibull tails are to be preferred over heavier tailed options regions with higher rejection rates are clustered in three main areas central northern europe and the atlantic coasts of north and south america fig 2b here weibull tails could be either too light or too heavy to fully describe the observed annual maxima qualitative analyses not shown suggest that weibull tails could be too light in the two regions in the northern hemisphere and too heavy in the atlantic coast of south america it could be that the assumptions used by wilson and toumi 2005 to derive the weibull tail model are less verified in these regions for example temporal trends would lead to apparently heavier tails this is expected to be more likely in stations with longer records but we could not find any evidence of such a relation it should be however noticed that as shown by amponsah et al 2022 see the supporting information therein the trends typically reported are not large enough to impact the results of our test another possibility is that the assumption of independence of the wet days could be less verified in some areas additionally monte carlo simulations show that deviations from the assumption of independence of the wet days may cause the test to reject the weibull tail hypothesis more often for example this could be the case of northern europe where long lasting stratiform events are frequent future works should investigate more in detail the possible physical and or statistical reasons behind these behaviours l moment ratio diagrams such as the one in fig 3 are commonly used to assess the reliability of specific tail models fig 3a shows that gp tails blue are able to capture the general statistics of annual maxima black although an important tendency to over estimate tail heaviness is manifested l skewness values greater than the largest observed value globally are often reported even reaching values as high as 0 6 or 0 7 considering that gev distributions with shape parameter greater than 0 5 displayed in the secondary axis of the figure as γ gev have infinite variance these values are likely unrealistic these qualitative results support previous findings in which gp tails used to create synthetic data were shown to generate unrealistically high values and the creation of a powered exponential system of distributions introduced in papalexiou 2022 to support the stochastic modelling of precipitation at multiple scales the statistics emerging from non asymptotic weibull tails in red in fig 3b closely resemble the ones of observations black and the ones reported for the global dataset of daily annual maxima 15 000 stations by papalexiou and koutsoyiannis 2013 the apparent gev shape parameters emerging from non asymptotic weibull tails depend on the shape parameter of the underlying weibull distribution and on the average yearly number of wet days fig 4 a convergence to the limiting distribution gumbel law with γ gev 0 in the case of weibull tails is extremely slow and stations with over 250 wet days are still far from this limit note the logarithmic scale on the colour bar the apparent limiting type is coherent with the parameter range extrapolated by papalexiou and koutsoyiannis 2013 overall 98 of the stations worldwide appear to follow the fréchet law and only 0 2 the reversed weibull law fig 4b fig 5 a b shows the error in l skewness and l kurtosis of annual maxima emerging from non asymptotic tails with respect to the ones computed from the observed maxima we show the case of weibull tails red and gp tails blue estimated using different left censoring thresholds θ the figure highlights two important aspects first within the stochastic uncertainties related to the available records shaded in grey the 90 confidence interval of the median across stations the statistics of annual maxima are well reproduced by non asymptotic weibull tails even for relatively low thresholds conversely the errors for maxima sampled from gp tails strongly depend on the left censoring threshold and tend to be too heavy tailed for θ 0 90 the accuracy of gp tails in reproducing the statistics of observed maxima is comparable to the one of weibull tails only for thresholds θ 0 9 second gp tails estimated from synthetic weibull distributed data are virtually indistinguishable from the gp tails estimated from real observations dashed blue as predicted by evt gp tails tend to provide similar estimates upon asymptotic conditions here represented by θ gp 0 95 see also serinaldi and kilsby 2014 and the difference in l moment ratios between non asymptotic weibull tails and gp tails decreases with increasing threshold fig 5c crucially the difference between l moment ratios of annual maxima emerging from gp and gp tails dashed are virtually indistinguishable also for high thresholds such as θ 0 95 and smaller than the differences between l moment ratios of annual maxima emerging from gp and weibull tails fig 5c estimating gp tails from observations is equivalent to estimating gp tails from weibull data 4 conclusions a large dataset of long recording quality controlled rain gauges is used to explore the statistics of extreme daily precipitation from a non asymptotic perspective we start from a physics backed hypothesis and we consider the specificity of our test with respect to alternative hypotheses the null hypothesis of having daily precipitation annual maxima emerging from parent distributions with weibull tails cannot be rejected in 89 of the stations analysed all over the globe we identify specific regions where this assumption could be less robust and that require further investigations of the underlying physical reasons we show that daily precipitation with non asymptotic weibull tails can explain 1 the l moment ratios of observed annual maxima 2 the apparent asymptotic limiting behaviour of annual maxima and 3 the characteristics of asymptotic tails estimated from observations these results support the use of non asymptotic weibull tails to estimate the statistics of extreme daily precipitation in many regions of the earth similar analyses based on sub daily and multi day durations are solicited to extend our knowledge of heavy precipitation across scales reality is not asymptotic we call for a renewed consideration of non asymptotic statistics for the description of extremes credit authorship contribution statement francesco marra conceptualization data curation writing original draft writing review editing william amponsah data curation writing review editing simon michael papalexiou conceptualization data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements codes used for the study are available in public repositories 10 5281 zenodo 3971558 marra 2020 10 5281 zenodo 7234708 marra 2022 rain gauge data were obtained combining the dataset from papalexiou and montanari 2019 based on menne et al 2012b version 3 22 marra et al 2021 quality controlled stations only and amponsah et al 2022 we thank the ghana meteorological agency yoav levi from the israel meteorological service and efrat morin from the hebrew university of jerusalem for providing the data fm was supported by the cariparo foundation through the excellence grant 2021 to the resilience project and by internal projecs of cnr isac 
