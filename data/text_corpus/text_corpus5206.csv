index,text
26030,although the dublin principles of integrated water resource management iwrm are well established the third principle on gender is commonly missing in practice we use gender mainstreaming to identify examples where gender specific perspectives might influence water resource management modelling choices we show how gender considerations could lead to different choices in all modelling phases providing examples from three familiar components of modelling practice a problem framing and conceptualisation b model construction documentation and evaluation and c model interpretation and decision support we suggest a future approach for integrating gender perspectives in modelling including gender dimensions could strengthen modelling results by engaging with a range of stakeholders and highlighting questions knowledge values and choices that may otherwise be overlooked such an approach won t always result in a different model and results at the very least it s a mechanism to explore and reveal gendered assumptions knowingly or unknowingly embedded into the model keywords gender integrated water resource management iwrm water resource modelling sustainable development goals sdgs modelling forks equity 1 introduction the links between gender and water are well explored and articulated agarwal 1997 baker et al 2015 cap net and gwa 2014 fauconnier et al 2018 grant 2017a mandara and niehof 2017 prokopy 2004 ray 2007 vera delgado 2015 zwarteveen 2008 2011 1997 institutional frameworks such as the dublin principles of integrated water resource management iwrm and the sustainable development goals sdgs have linked gender and water agendas in an attempt to understand the synergies between them and create informed management solutions grant 2017a ray 2007 as a result it is now common for funding organisations to require gender awareness and objectives are included as a part of their project planning and implementation however there is a lack of guidance on what this means for modelling projects this paper discusses this guidance gap and begins to address it by exploring the ways in which a gender perspective may affect biophysical modelling choices we have chosen to focus on biophysical models in order to prompt a deeper appreciation of the relevance of gender considerations even if a model is restricted to representing biophysical processes only we assume it is obvious that gender considerations are relevant in integrated models of coupled social biophysical systems in doing so we show how gender analysis could help inform modelling choices so providing new ways for gender perspectives to be embedded in project design and implementation underlying this paper is a recognition that modelling involves subjective processes models used in iwrm are approximate representations of chosen aspects of the water resource system they are constructed for a range of different purposes including interpretation e g integrating different data sources to reveal system level insights exploration e g exploring system responses to different planning scenarios social learning with stakeholders as well as knowledge governance e g providing a transparent path from evidence base to decisions made modelling may be perceived as an objective technical process but it requires making assumptions and choices that are driven by human values korfmacher 2001 mayer et al 2017 in this way models are social constructions the values that underlie modelling choices differ depending on model purpose contextual settings and the individual s making the choices lahtinen et al 2017 refers to these choices as modelling forks where the modellers values help inform the path that the model can take the cumulative effect of these choices can lead to different results melsen et al 2019 these results can then be used to create policy and make choices which affect the lives of everyone it would be impossible to include everyone s perspectives while making modelling choices however there may be value in widening the perspectives used to make these choices through understanding some of the dominant social structures in the societies the models are being built for these social structures could be gender age race ability income etc and in an ideal world analysis would use theories of intersectionality to combine these structures for a richer exploration modellers like everyone have implicit and explicit biases and so have a responsibility to ensure that their knowledge production processes include steps to recognise and address these biases we focus on gender for several reasons first there is increased demand for gender focused outcomes from governments donors and aid organisations and gender equality is one of the un sustainable development goals second many environmental modellers think that gender and social equity issues should be included in their modelling research escobar et al 2017 third there is an opportunity to build on other work done in this space to our knowledge there have been three other published guidelines on how to mainstream gender in environmental models these are the escobar et al 2017 guidance on mainstreaming the stockholm environment institute s leap long range energy alternatives planning system and weap water evaluation and planning system models fontana 2015 guidance integrating gender into bioeconomic modelling and guidance notes on gender and geographical information systems gis by resurrección and johnson 2015 these guidelines do not provide details on how to integrate gender considerations in water management modeling to support iwrm finally gender intersects with most other social structures and so it is an inclusive entry point for social analysis we have looked for situations where modelling choices may differ if informed by gender analysis to do this best practice water modelling guides were used as a framework for assessing common choices or forks made by modellers in water projects we report our findings according to three modelling phases addressed in these guides problem framing and conceptualisation model construction documentation and evaluation and model interpretation for supporting decisions we drew on the gender water literature to link findings with these modelling choices so providing examples of where choices may be influenced by a gender lens we have not sought to quantify how modelling results would be affected by making different gender informed modelling choices given the widespread lack of guidance on how projects should include gender analysis however we hope that this paper can act as a starting point further work would include tools and approaches for more inclusive problem identification gender relevant data collection and analysis tailored to report gender specific implications this is discussed in the towards a practical approach section it is our judgment that there are many scenarios where gender analysis may be useful for informing modelling choices based on examples discussed in the following sections our work highlights the lack of guidance on what gender mainstreaming means in practice for modelling projects and demonstrates that further work needs to be conducted to ensure that modelling projects support more equitable outcomes 2 iwrm and gender the dublin statement institutionalised integrated water resource management iwrm in 1992 rahaman and varis 2005 the third principle reads women play a central part in the provision management and safeguarding of water acceptance and implementation of this principle requires positive policies to address women s specific needs and to equip and empower women to participate at all levels in water resource programmes including decision making and implementation united nations 1992 since the dublin principles were introduced iwrm has become a foundational concept in water resource management iwrm is fundamental in national water policies and over 80 of countries worldwide now have the iwrm principles in their water laws and two thirds have developed a national iwrm plan allouche 2016 despite the well established nature of iwrm the third dublin principle is often neglected ray 2007 according to a report from the international union for the conservation of nature iucn in 2013 only 15 of countries had a gender policy in their water ministry and only 35 of countries had included gender considerations in their water related policies and programmes fauconnier et al 2018 this gap is mirrored in environmental modelling escobar et al 2017 found that despite 88 of users of stockholm environment institute s weap water evaluation and planning system and leap long range energy alternatives planning system agreeing that gender and social equity issues should be included in their modelling research only 7 were currently doing so the badham et al 2019 guidelines for iwrm modelling practice argue that implementing iwrm requires guidance on how to address the integration of iwrm principles for different problems but did not explicitly deal with gender dimensions interviews done by the global water partnership gwp found that water managers are uncertain about how to engage on gender equality issues where to engage and with whom grant 2017b similarly they found that the interviewees said that there is a lack of real strategy on how the water sector should tackle gender discrimination and exclusion grant 2017b the iucn argues that addressing gaps in integrating gender in water governance requires applying tested tools and approaches fauconnier et al 2018 3 method and definition of terms applying a gender lens to modelling guidelines the guidance literature on best practice environmental modelling is substantial argent et al 2016 badham et al 2019 barthel et al 2008 beven and alcock 2011 black et al 2014 crout et al 2008 hamilton et al 2015 jakeman et al 2006 lahtinen et al 2017 refsgaard et al 2007 2005 scholten et al 2007 2000 best practice guides can be found in different levels of detail for different water management domains and for different users refsgaard et al 2005 throughout this literature however it is difficult to find guidance on if or how gender analysis should be integrated into water management models this is the case even where modelling guidelines specifically ascribe to iwrm badham et al 2019 black et al 2014 this paper begins to address that gap by exploring whether a gender perspective may affect choices made at the various points in the biophysical modelling process and especially if it leads to decision forks in that process that substantially propel a modelling project down alternative paths which lead to different outcomes lahtinen et al 2017 we review gender water relationships found in literature and assess their relevance to modelling as a preliminary foundation for developing and testing approaches useful for practitioners we anticipate that one possible approach for integrating gender concerns into iwrm modelling would be to use gender analysis of systems for informing subjective modelling decisions this would aid more inclusive and diverse decision making modelling choices could be analysed critically and documented so that the subjective process of modelling is made more explicit and systematic melsen et al 2018 badham et al 2019 echo this sentiment arguing that in best practice iwrm modelling not all steps may be relevant but it is valuable to consider the relevance of each step so that omission is an explicit decision and not simply an oversight such analysis may be challenging for modellers with no gender expertise this paper is designed to provide some insight into how knowledge about gender relations and gender mainstreaming can relate to technical and other modelling choices further it is important that interdisciplinary teams work together to support this analysis process and for modellers to take up the challenge of becoming familiar with concepts around gender 3 1 terms and methods gender refers to the characteristics and behaviours that different cultures attribute to the sexes this is in contrast with sex which refers to biological differences chromosomes hormonal profiles internal and external sex organs grant 2017a although there are other social lenses that are just as important gender is a good entry point for considering how alternative perspectives on water management and its modelling could change model results the richest social analysis would use an intersectional approach to the analysis of water use access and control intersectionality is both an analytical and theoretical lens used predominantly by feminist theorists to highlight how interactions between social divisions such as gender class and ethnicity affect individuals experiences including marginalisation crenshaw 1990 this comprehensive approach is however beyond the scope of this paper and the reader is referred to braun 2011 cole 2017 huynh and resurreccion 2014 and thompson 2016 for more complete understanding of intersectional analysis of water systems such analyses reveal greater heterogeneity of issues across men and women and how social differences shape access use and control of resources like water thereby requiring more specific and targeted policy responses to their specific needs in order to identify common modelling decisions or forks in water modelling projects we identified three broad modelling phases as described in a range of best practice water modelling guides a problem framing and conceptualisation b model construction documentation and evaluation c model interpretation for supporting decisions once these phases were identified we used a gender mainstreaming process to consider the relevance of gender considerations in each gender mainstreaming is the process of assessing the implications for women and men of any planned action including legislation policies or programmes in all areas and at all levels it is a strategy for making women s as well as men s concerns and experiences an integral dimension of the design implementation monitoring and evaluation of policies and programmes in all political economic and societal spheres so that women and men benefit equally and inequality is not perpetuated the ultimate goal is to achieve gender equality united nations 1992 there are many definitions and interpretations of gender mainstreaming but as applied in our paper it means we are deliberately seeking to assess the implications for women and men of any modelling choice essentially this means that for each modelling phase we sought examples and scenarios where gender relevant concerns would impact choices made in that phase we acknowledge that research activities are conducted within a societal and cultural context and that norms and values influence research designs and outcomes it is our hope that by questioning and integrating gender into water modelling the work of the water sector will better reflect gender concerns and thus better inform policy makers to make gender sensitive policies and processes we suggest gender mainstreaming can be applied to all modelling phases as illustrated in table 1 and therefore should be considered from the outset of a modelling exercise we have structured the results of our review according to these modelling phases in the sections below this paper does not attempt to explore all points in table 1 focusing only on specific examples that are relevant to each phase the call to integrate gender into modelling is sometimes interpreted as a request for modelling platforms that can include explicit representation of men and women s behaviour and decisions in modelling agent based models system dynamics models and bayesian networks are examples of integrated modelling platforms that accommodate these details see kelly letcher et al 2013 we limit our focus to biophysical modelling in this paper for several reasons first gender considerations are often assumed to be beyond scope in a biophysical modeling exercise and we wanted to test that assumption second it is more obvious that gender considerations are relevant when modelling social and economic aspects of a system and there is more guidance available on how to do it we are interested in identifying what gender mainstreaming processes may be useful for biophysical modellers in order to address the lack of guidance in this area the core ideas and some of the examples used in this paper have been drawn from packett et al 2018 which is a more wide ranging review that is not limited to biophysical models 4 insights gained from applying gender mainstreaming to modelling decisions 4 1 problem framing and conceptualisation problem framing and conceptualisation involves articulating the problem and specific questions to be addressed through the modelling exercise it is where judgments are made about what is in or out of scope for addressing the problem creating the potential for excluding considerations that are considered important by some but not by others there are strong arguments for integrating gender considerations right from the beginning of projects interviews with water professionals done by gwp found that one disincentive to including gender considerations is that gender issues are tacked on rather than considered upfront which makes them hard to integrate and act upon properly grant 2017b merritt et al 2017 found that one of four factors of success deemed always essential by technical experts in australian water resource projects was sufficient critical thought given to the problem framing and the role of modelling early in the project this is because questions at this stage create a path dependency that can determine the course of a modelling project lahtinen et al 2017 we explore the possibility that including gender as an analysis lens when framing the problem could alter how a model is constructed potentially leading to different insights and model informed decisions individuals have different preferences and values that inform how problems are framed and expressed in models lahtinen et al 2017 mayer et al 2017 values are beliefs that refer to personal goals they typically transcend specific actions and situations and they guide people s sense of right or wrong schwartz 2012 in investigating the values that drove their modelling choices mayer et al 2017 studied 11 scientists in the same climate modelling team and revealed that while some values were common across the scientists such as consistency in evaluating modelling results there was also considerable diversity only two mentioned basic rights protection as one of their modelling ethical values this is important because explicit and unconscious preferences can alter modelling choices and results lahtinen et al 2017 melsen et al 2019 a diverse set of perspectives is one way to reveal the different values prevalent within the decision making and stakeholder context and how these could change problem framing and subsequent modelling decisions mayer et al 2017 suggest that active efforts to make implicit values known facilitates better scrutiny within the team and external reviewers even within research groups members of a modelling team rarely have the same level of power and influence to exert their preferences on decisions reflecting on power imbalances will be fruitful and we refer readers to work on team decisions and participation intersectionality and institutional culture cech and pham 2017 cornwall 2008 grant 2017b holleran et al 2011 torino et al 2018 walby et al 2012 wu and jing 2011 the subjective choices in projects create multiple decision pathways along the way value or ethical judgments are made yet only the final product is visible at completion when informing decisions science produces information products that are often used elsewhere we contend that good practice behooves scientists to analyse and document these ethical choices so that they are replicable and can be used to inform how any final product is interpreted and used question framing can reveal or obscure certain issues so affecting the type and quality of data collected a study undertaken by the social observatory found that when village members designed their own questions to investigate their livelihoods there was only a 17 crossover in questions developed by the indian national sample survey which targeted the same issues rao 2017 questions to target gender equality could be framed as how much do you spend on the purchase of vegetables in a month world bank or does the person who eats last get enough to eat women from bihar india rao 2017 different values across researchers and stakeholders can inform the types of questions asked and associated data needs for example baker et al 2015 characterised gendered difference as well as differences between researchers and community members in mapping landscape features in a sub catchment in ethiopia when creating input layers for their soil and water assessment tool swat model researchers focused on land use and crop type to classify the landscape women tended to classify areas in terms of soil type which were proxies for productivity and land degradation and at a finer resolution than maps developed by the food and agriculture organization fao men on the other hand classified larger areas of land as grazing reflecting their role in stewarding livestock this means that in their maps land that would have been assigned crop or soil type was seen as grazing this study showed how differing perspectives can influence judgments of what data is relevant for understanding and addressing a problem similarly the value system of the researcher can influence final outcomes especially given it is often the researcher who selects the input data to be gender sensitive water modelling projects can include a range of perspectives through diverse framing of questions so that model conceptualisations are informed by that diversity and deliver insights that are robust to this range this could be done in a mix of ways tools and methods for eliciting knowledge directly from stakeholders have been reviewed by voinov and bousquet 2010 and voinov et al 2016 drawing on the literature in participatory modelling methods seeking specialist gender expertise is also valuable for bringing relevant theories and practices to problem framing and conceptualisation such efforts may pose problems and raise questions that cannot be addressed by biophysical models alone and if this is the case then it will be important to ensure the conceptualisation of any biophysical modelling is such that it can connect with and contribute meaningfully to the broader problem framing 4 2 model construction documentation and evaluation we refer to model construction in broad terms referring to decisions about modelling approach and design informed by problem conceptualisation building a working model and implementing it these steps are generally considered to be specialist modelling decisions separate from social analysis however even technical modelling choices can reflect values based assumptions in the next sections we give examples of how both the modelling approach and its implementation are affected by stakeholder and researcher values that are relevant to gender 4 2 1 choice of modelling approach several decisions are made when choosing elements of the modelling approach there are decisions about the nature of the model itself e g qualitative or quantitative analytical or numerical process based or observation driven deterministic or stochastic or a hybrid mix and there are also decisions about who is involved in model design building and testing will it involve specialist modellers only or does it include participatory co production with stakeholders kelly letcher et al 2013 describe a range of factors that affect choice of modelling approach model purpose data availability system conceptualisation treatment of uncertainty and appropriate mode of output generation e g scenario based analytical solution or optimisation we suggest there are gender relevant considerations in each of these for example the treatment of uncertainty is shaped by attitudes towards risk gender differences in risk and ambiguity preferences have been found regularly in laboratory and field behavioural studies although there are some exceptions croson and gneezy 2009 a study investigating flood risk attitudes in a large sample in serbia found that men perceived themselves to be more prepared for flooding events than women while women indicated high concerns about flood risks cvetković et al 2018 risk averse values could influence the type of modelling preferred and or the specification of modelling objectives risk reduction decisions could be better informed by modelling approaches explicitly characterise statistical distributions and probabilities alternatively plausible scenarios spanning extreme or undesirable outcomes could be modelled in cases where probabilistic approaches are not possible as can be the case for complex integrated water models we note also that risk awareness and attitudes change over time and so modellers may need to be responsive to changing appetite for more specific insights into risks these examples show that social preferences of individuals and groups can be reflected in the choice of modelling approach so that model is suitable for generating outputs that are directly relevant to stakeholder priorities in this way the choice of modelling approach can be assessed according to how well it represents the interests of diverse stakeholders it is common for modellers to come to a new problem having already chosen their modelling approach this reality presents practical challenges in bringing a genuinely open mind to questions of model choice and implementation even if a modeller has some flexibility in their choice of modelling approach their choices will be limited by their own experience and capability as well other factors that determine the accessibility of different modelling approaches including time funding and available modelling infrastructure at a minimum we recommend making a deliberate effort to consider a broader range of modelling approaches review their strengths and weaknesses in addressing the problem as framed and spell out explicitly the criteria being used to choose one modelling approach over another by ensuring that gender relevant criteria are part of this assessment it should be possible to document the model s fitness for purpose and outline supplementary measures that can be taken to account for anticipated shortcomings in the modelling approach 4 2 2 choices in model implementation once a modelling approach is chosen assumptions made when implementing the model are vital context for interpreting results and evaluating fitness for purpose melsen et al 2019 studied the effect of subjective modelling decisions on the results of flood and drought event simulations in the swiss thur basin they focused on four modelling decisions the spatial resolution the spatial representation of the forcing the calibration period and the performance metric of the model they found that these choices affected the modelling results significantly this demonstrates that embedded in the model are assumptions on what is important and what is not and decisions on temporal and spatial scale numerical methods dealing with data scarcity and uncertainties are not neutral they influence not only the model results but also what the model can do who can use the model and for what purposes melsen et al 2018 hydrological models are often calibrated by optimising an objective function and it is well recognised that different objective functions are appropriate for different modelling purposes e g see vaze et al 2011 for guidance on choice of objective function for eco hydrological applications for example it is important to ensure the model adequately characterises specific attributes of the flow regime e g low flows or cease to flow events bunn and arthington 2002 similarly the type or timing of flow that is most important may be different for different people in the chhattis mauja irrigation system in nepal zwarteveen 1997 found that even though men and women were working cooperatively as co farmers they tended to have different priorities about water flow conditions their work made them aware of the timing of delivery of water men tended to care about water arriving at the start of the irrigation season because they were responsible for land preparation women agreed but also stressed the importance of ongoing access to water throughout the irrigation season because reduced rice paddy pond depth encourages weed growth and they are responsible for weed management in modelling this system there are different gendered perspectives on which flow attributes are most important for farming this example illustrates that gender may affect datasets methods chosen for model calibration and evaluation as well as which metrics to report gender is not the only social lens that could inform modelling choices and sometimes it won t be the most important for example choosing temporal scales is an important step in a modelling process hydrological models used for multi decadal projections are likely to be less complex and include fewer processes for computational efficiency consequently model results will be appropriate for assessing long term impacts but may not provide the level of detail needed for current day to day operations or management mayer et al 2017 choices such as model complexity and time step involve value judgments reporting time scales of model output will need to reflect those most relevant to stakeholders in a large scale statistical analysis across 53 countries of time preferences such as discounting and uncertainty avoidance wang et al 2016 found that gender was not a significant predictor of time preferences however different cultural practices tended to change time preferences other work has shown that participants ages can impact time preferences green et al 1994 this implies that perceptions of time might impact the preference for information produced by modelling to aid water management decisions there are practical challenges in applying gender mainstreaming to the day to day details of building calibrating and testing a model to do so most effectively requires involving stakeholders at all stages in model development which entails iterative processes that are time and resource intensive the available methods and recommendations for navigating associated challenges are reviewed in the participatory modelling literature e g etienne 2012 voinov et al 2016 voinov and bousquet 2010 4 3 model interpretation for supporting decisions choices in how to interpret and communicate results are critical in shaping how modelling supports the decision making process the following sections use examples relating to multi criteria optimisation aggregate indicators and handling of uncertainty to give options for including gender considerations when interpreting and using model results 4 3 1 performance and optimisation criteria are explicit value statements if a hydrological or integrated water resource model is used within a decision support context which includes weighting or optimising across different criteria or making management recommendations then this process involves a series of implicit value judgements choice of optimisation method and objectives the criteria against which success is measured and the relative weightings across different criteria all have an impact on how the model is interpreted and so influence management decisions it is useful to reflect on who is involved in these decisions whose voices are excluded and how inclusion exclusion supports or impedes model legitimacy this raises questions of power in decision making in developing fisheries rights joubert et al 2008 undertook a study which revealed that the proposed criteria for their multiple criteria decision analysis process were different between the fisheries agency staff and relevant community stakeholders in south africa and that these groups valued various criteria differently this suggests that the criteria for weighing options in resource management and their relative importance can change depending on who has access to or control of the decision making process this is pertinent for the water sector because sometimes the right to participate in these water management conversations can be a privilege afforded largely to men for example in south asia government irrigation agencies remain male dominated with women constituting only 2 4 of the engineering staff zwarteveen 2011 this is often true of community level water users organisations too agarwal 1997 meinzen dick and zwarteveen 1998 ray 2007 samee et al 2015 zwarteveen 1997 however it is government staff that often have control of information production and dissemination thus giving them power to shift values beliefs and norms srinivasan et al 2017 4 3 2 aggregate indicators mask implicit value judgments and distributional consequences aggregate indicators can fail to convey severe impacts for some people and conceal whether or not effects are distributed equitably adams 2000 amoretti and vassallo 2016 a review by the world commission on dams wcd judged that aggregate costs and benefits of large scale dam projects are not comprehensive enough for approving infrastructure programmes because distributional effects are masked and equitability cannot be assessed adams 2000 reporting of distributional effects are important for ensuring that more marginalised and vulnerable minorities benefit from projects and do not bear disproportionate unwanted impacts they emphasise that excluding gender from social impact analysis is particularly misleading and risky because hard numbers however crudely generated command attention from planners once created such numbers become divorced from warnings about their reliability and are used in decision making by donor and government decision makers if such numbers are wrong or omit vital areas they can be dangerously misleading things that can be quantified tend to dominate decisions at the expense of things that cannot be quantified adams 2000 this can be particularly true for indicators that focus on economic analysis for example the us 8 billion transnational lesotho highlands water project lhwp is a programme that constructed five dams and cross national tunnels in lesotho in order to generate national income from selling water to south africa braun 2011 feasibility and initial objectives suggested that lesotho would benefit from the project by broadening the economic base and development of remote mountain regions yu 2008 in practice despite economic growth poverty did not improve economic inequality remained high and lesotho experienced social and environmental costs yu 2008 the filling of the dams led to a serious decline in resources for affected households with the burden falling disproportionately on women braun 2011 mwangi 2007 the project increased the reliance of households on wages and formal markets due to the patriarchal system in lesotho this reliance increased gender inequalities by giving men greater control over household resources braun 2011 such diverse impacts are difficult to anticipate and make visible in aggregate estimates of economic costs and benefits effects such as these prompted the wcd to call for gender sensitive social analysis of dam projects aggregation is often necessary in practice but when doing so it is useful to pay attention to what is excluded in aggregation retain and report distributional properties where possible and provide supplementary interpretation to compensate for omissions resulting from aggregation 4 3 3 uncertainty and gender considerations gender impact assessments gias can help to reveal access and control of water based resources and potential impacts of projects simon 2013 however gender analysis is often limited by lack of data adams 2000 escobar et al 2017 ray 2007 even with more resources dedicated to the collection of data and assessment of potential gender impacts the ability to anticipate and usefully characterise impacts in complex social systems is limited even if it is not possible to resolve issues of data scarcity and poor predictability better acknowledging these realities is an important first step towards including them in impact analyses and assessment in particular it opens options for including these unknowns in more suitably encompassing uncertainty analyses smithson 1989 offered a taxonomy of unknowns in which an important distinction is made between ignorance that is treated as irrelevant i e ignored from the analysis versus ignorance that is recognised as errors errors can be explored characterised and included in the analysis and interpretation even if these errors cannot be reduced for example if data are reported at household level only and there is no gender disaggregated data it is still possible to test the sensitivity of the analysis to plausible data ranges that are representative of these unknowns a subsequent step is to assess whether any sensitivities could have a bearing on final decisions informed by the analysis there are more options for handling uncertainty than simply trying to reduce it and there is a growing range of methods for water management planning under deep uncertainty herman et al 2014 used a multi stakeholder multi objective robust decision making framework to better understand robustness tradeoffs between different water supply options in the face of deep uncertainties related to climate change financial risks and population pressures uncertainty risk and or vulnerability analysis can help us acknowledge our ignorance and explore its possible consequences 5 discussion 5 1 towards a practical approach we have used examples to show that including gender perspectives stands to make a material difference to choices made in problem framing model conceptualisation modelling approach implementation and interpretation these examples demonstrate the potential for a modelling approach that seeks to incorporate gender perspectives integrating gender analysis and including a range of diverse perspectives in model development decisions could be one approach for modelling projects to engage with gender relevant objectives choices could be assessed and documented for the major modelling phases to state explicitly who was involved and what values or criteria informed subjective decisions particularly where this may have led to significant decision forks this would be equivalent to gender mainstreaming the modelling process applying this approach to a project would involve contextual gender analysis to provide the input data for assessing decisions made during model development and use gender analysis can be aided through a range of toolkits such as the harvard analytical toolkit global water partnership s gender equality and inclusion in water resources management action piece or world water assessment programme s toolkit on sex disaggregated water data fletcher and schonewille 2015 grant 2017c south east asia and the pacific multidisciplinary advisory team 1998 we are not aware of this approach being used systematically in any water modelling projects there is an opportunity to apply and test this method to explore how much of an impact conducting this process would make as mentioned earlier an intersectional approach i e one that takes account of stakeholders social identities such as culture class gender would yield richer data and ways in which decisions and values are prioritised time and resource limitations are common barriers to an intersectional approach with its requirements for multidimensional analyses of the social confluences of gender class ethnicity and race gender intersects with most other social structures and so it is an inclusive entry point for social analysis a gender sensitive contextual analysis i e literature review stakeholder consultation with key community leaders and civil society organisations can reveal key intersectionalities to be prioritised in further intersectional analysis further analysis could include using naila kabeer s social relations framework kabeer and subrahmanian 1996 to provide an institutional analysis of how inequalities are produced within and across the different scales of family kinship communities market and the state in the context of water resource management this might mean exploring how women and marginalised groups are denied water access and consumption at the household or community level to how market pricing of water limits the poor from accessing drinking water to how state policies around water overlook the contribution of women s role in water resource management we recognise that applying gender mainstreaming won t always make a difference to modelling choices rather if gender outcomes are a specified goal of a project modified modelling practice could ensure that if gender is judged to be unrelated to a modelling decision this view is an informed conscious choice supported by documentation in this way a gender mainstreaming approach might provide a simple transparent structure for assessing and reporting on modelling decisions in a gender relevant way this process may be used to substantiate claims that modelling results are robust to differences in gendered dynamics for example in the swat and gender case study by baker et al 2015 cited earlier despite the differences in conceptualising the landscape between researchers and between male and female stakeholders the final modelling from all these perspectives yielded similar results this is because during their mapping exercise the three groups assigned similar areas to agriculture which was the parameter that the rainfall runoff and curve number was most sensitive to through documenting this process the team now has evidence that their results are gender informed and thus valid diekmann and zwart 2014 additionally where gender may not overtly be part of the goals and outcomes of a modelling project including gender and social dimensions has the potential to strengthen modelling results by engaging with a wider range of stakeholders and highlighting possible questions knowledge values and choices that may otherwise be overlooked it may also lead to informed insights in future modelling and iwrm studies conducted elsewhere this reflects the diekmann and zwart 2014 argument that fairness can be used as a test for quality in similar ways to other validation and verification tests they conceptualise fairness as the maxim of giving due and equal attention to the interests of all stakeholders independent of their social power or status they argue that using fairness as a test of whether a model is fit for purpose will guarantee that a model provides what is practically required and theoretically desirable mutual confidence in construction usage and choice of embedded and implied values among all stakeholders we contend this is a relevant test for iwrm modelling efforts and hope to have made a contribution towards this aim 5 2 relevance of gender in modelling decisions our aim has been to ask whether modelling could unfold differently if gender or other equity perspectives and intersectional considerations were to be mainstreamed into each stage of the modelling process and would these differences matter our exploration has been a conjectural one at this point we have not applied the approach suggested in the previous section to a specific model or case study the approach will need to be tested rigorously and evaluated against suitable criteria in addition to the motivations for gender integration laid out earlier the potential approach is also relevant to projects funded by institutions with gender goals consider for example the australian government department of foreign affairs and trade dfat where improved outcomes for women and girls are a high priority against which projects and their activities are evaluated for these dfat funded projects that include hydrological modelling there is little guidance on how to link gender to the detailed mechanics of hydrological modelling it is not immediately clear that taking a gender perspective would see any change made to the development of a rainfall runoff model for a catchment a technical task for which there are well established model development steps a modeller might reasonably ask for example i work on developing rainfall surfaces as inputs to hydrological models why do i need to think about gender as demonstrated by examples described in this paper metrics used by modellers for selecting model inputs or calibrating models against observations could have real world gender specific relevance the development of rainfall surfaces requires judgments about what attributes of the rainfall are most important to represent if the intended beneficiaries of the modelling are women located on a floodplain is it more appropriate to use rainfall inputs that are consistent with total annual rainfall or is it more relevant to use inputs that capture the timing and magnitude of extremes our intention is to prompt questions of this type and increase awareness of where a gender lens may reveal different answers by suggesting that modelling teams better recognise the subjective nature of their modelling choices and subsequent decision forks it provides a natural entry point for bringing others perspectives into the modelling process earlier our work provides another argument for the benefits of participatory practices that foster genuine engagement with stakeholders and their priorities even if the model represents only biophysical and not social processes furthermore documentation of such practices provides transparency and a useful form of accountability to stakeholders and funders and for modelling teams to monitor and learn from their experience according to their own quality assurance requirements some may interpret our recommendations to mean involve both men and women in any modelling exercise the process of gender mainstreaming is not that simplistic it is about asking whose interests and perspectives are represented and whose are excluded and recognising that modellers of any gender will not necessarily have that insight and awareness when going about their model development a team of all female modellers would not necessarily have any more informed insights into women s perspectives in a water system in a different country with a very different culture to their own similarly an all male modelling team could well make good progress working with a gender specialist who could be any gender who facilitates participatory processes for eliciting gender relevant insights across a diverse range of stakeholders we have explored these ideas with biophysical modellers working in australian and international contexts and in many of these conversations initial doubts about the relevance of gender have been shifted but it has taken curiosity open mindedness and the discovery of tangible plausible examples in the course of these discussions to enable such shifts the modelling guidelines such as black et al 2014 have been a useful entry point to those discussions and allowed us to discover relevant examples that resonate with modellers by providing tangible examples in this review we hope to prompt similar discussions in other modelling groups and enable further explorations of the practical value of applying gender mainstreaming in model development practices 6 conclusions ensuring that water management decisions lead to equitable outcomes is increasingly a priority of water management decision makers given the complex task of water management models and or modelling frameworks are often used as a tool to support decision making thus it is useful for modellers and model users to have methods to assess and report how questions of equity and inclusivity have informed their modelling choices and practices although this is inherently difficult to do systematically evaluating modelling choices especially those that may create substantial modelling forks from different perspectives can prompt creative thinking about alternatives decisions from the beginning to the end of projects are influenced by values given this making a more deliberate attempt to identify and then include others perspectives including across gender can reveal situations where different conceptual framing data choices objective functions or priorities might impact a model s development and outcomes this paper provides examples within three key iwrm best practice themes where gender considerations might impact a modelling choice problem framing and conceptualisation model construction documentation and evaluation and model interpretation for supporting decisions areas of model development that could be affected include the initial choice of modelling approach parameterisation and calibration furthermore the interpretation handling of uncertainty and choice of aggregated reporting indicators can all be reviewed in light of gender specific objectives at the very least gender mainstreaming provides a process for exploring and then making explicit the range of gendered assumptions knowingly or unknowingly embedded into the model all modelling projects are likely to have resource constraints and it can be difficult to assess what analysis needs to be integrated and what can be excluded gender analysis will be important for teams that have equitable water management as a goal and where gender analysis is excluded this should be acknowledged as a project limitation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the funding sources are commonwealth of australia represented by the department of foreign affairs and trade grant number 72861 commonwealth scientific and industrial research organisation 
26030,although the dublin principles of integrated water resource management iwrm are well established the third principle on gender is commonly missing in practice we use gender mainstreaming to identify examples where gender specific perspectives might influence water resource management modelling choices we show how gender considerations could lead to different choices in all modelling phases providing examples from three familiar components of modelling practice a problem framing and conceptualisation b model construction documentation and evaluation and c model interpretation and decision support we suggest a future approach for integrating gender perspectives in modelling including gender dimensions could strengthen modelling results by engaging with a range of stakeholders and highlighting questions knowledge values and choices that may otherwise be overlooked such an approach won t always result in a different model and results at the very least it s a mechanism to explore and reveal gendered assumptions knowingly or unknowingly embedded into the model keywords gender integrated water resource management iwrm water resource modelling sustainable development goals sdgs modelling forks equity 1 introduction the links between gender and water are well explored and articulated agarwal 1997 baker et al 2015 cap net and gwa 2014 fauconnier et al 2018 grant 2017a mandara and niehof 2017 prokopy 2004 ray 2007 vera delgado 2015 zwarteveen 2008 2011 1997 institutional frameworks such as the dublin principles of integrated water resource management iwrm and the sustainable development goals sdgs have linked gender and water agendas in an attempt to understand the synergies between them and create informed management solutions grant 2017a ray 2007 as a result it is now common for funding organisations to require gender awareness and objectives are included as a part of their project planning and implementation however there is a lack of guidance on what this means for modelling projects this paper discusses this guidance gap and begins to address it by exploring the ways in which a gender perspective may affect biophysical modelling choices we have chosen to focus on biophysical models in order to prompt a deeper appreciation of the relevance of gender considerations even if a model is restricted to representing biophysical processes only we assume it is obvious that gender considerations are relevant in integrated models of coupled social biophysical systems in doing so we show how gender analysis could help inform modelling choices so providing new ways for gender perspectives to be embedded in project design and implementation underlying this paper is a recognition that modelling involves subjective processes models used in iwrm are approximate representations of chosen aspects of the water resource system they are constructed for a range of different purposes including interpretation e g integrating different data sources to reveal system level insights exploration e g exploring system responses to different planning scenarios social learning with stakeholders as well as knowledge governance e g providing a transparent path from evidence base to decisions made modelling may be perceived as an objective technical process but it requires making assumptions and choices that are driven by human values korfmacher 2001 mayer et al 2017 in this way models are social constructions the values that underlie modelling choices differ depending on model purpose contextual settings and the individual s making the choices lahtinen et al 2017 refers to these choices as modelling forks where the modellers values help inform the path that the model can take the cumulative effect of these choices can lead to different results melsen et al 2019 these results can then be used to create policy and make choices which affect the lives of everyone it would be impossible to include everyone s perspectives while making modelling choices however there may be value in widening the perspectives used to make these choices through understanding some of the dominant social structures in the societies the models are being built for these social structures could be gender age race ability income etc and in an ideal world analysis would use theories of intersectionality to combine these structures for a richer exploration modellers like everyone have implicit and explicit biases and so have a responsibility to ensure that their knowledge production processes include steps to recognise and address these biases we focus on gender for several reasons first there is increased demand for gender focused outcomes from governments donors and aid organisations and gender equality is one of the un sustainable development goals second many environmental modellers think that gender and social equity issues should be included in their modelling research escobar et al 2017 third there is an opportunity to build on other work done in this space to our knowledge there have been three other published guidelines on how to mainstream gender in environmental models these are the escobar et al 2017 guidance on mainstreaming the stockholm environment institute s leap long range energy alternatives planning system and weap water evaluation and planning system models fontana 2015 guidance integrating gender into bioeconomic modelling and guidance notes on gender and geographical information systems gis by resurrección and johnson 2015 these guidelines do not provide details on how to integrate gender considerations in water management modeling to support iwrm finally gender intersects with most other social structures and so it is an inclusive entry point for social analysis we have looked for situations where modelling choices may differ if informed by gender analysis to do this best practice water modelling guides were used as a framework for assessing common choices or forks made by modellers in water projects we report our findings according to three modelling phases addressed in these guides problem framing and conceptualisation model construction documentation and evaluation and model interpretation for supporting decisions we drew on the gender water literature to link findings with these modelling choices so providing examples of where choices may be influenced by a gender lens we have not sought to quantify how modelling results would be affected by making different gender informed modelling choices given the widespread lack of guidance on how projects should include gender analysis however we hope that this paper can act as a starting point further work would include tools and approaches for more inclusive problem identification gender relevant data collection and analysis tailored to report gender specific implications this is discussed in the towards a practical approach section it is our judgment that there are many scenarios where gender analysis may be useful for informing modelling choices based on examples discussed in the following sections our work highlights the lack of guidance on what gender mainstreaming means in practice for modelling projects and demonstrates that further work needs to be conducted to ensure that modelling projects support more equitable outcomes 2 iwrm and gender the dublin statement institutionalised integrated water resource management iwrm in 1992 rahaman and varis 2005 the third principle reads women play a central part in the provision management and safeguarding of water acceptance and implementation of this principle requires positive policies to address women s specific needs and to equip and empower women to participate at all levels in water resource programmes including decision making and implementation united nations 1992 since the dublin principles were introduced iwrm has become a foundational concept in water resource management iwrm is fundamental in national water policies and over 80 of countries worldwide now have the iwrm principles in their water laws and two thirds have developed a national iwrm plan allouche 2016 despite the well established nature of iwrm the third dublin principle is often neglected ray 2007 according to a report from the international union for the conservation of nature iucn in 2013 only 15 of countries had a gender policy in their water ministry and only 35 of countries had included gender considerations in their water related policies and programmes fauconnier et al 2018 this gap is mirrored in environmental modelling escobar et al 2017 found that despite 88 of users of stockholm environment institute s weap water evaluation and planning system and leap long range energy alternatives planning system agreeing that gender and social equity issues should be included in their modelling research only 7 were currently doing so the badham et al 2019 guidelines for iwrm modelling practice argue that implementing iwrm requires guidance on how to address the integration of iwrm principles for different problems but did not explicitly deal with gender dimensions interviews done by the global water partnership gwp found that water managers are uncertain about how to engage on gender equality issues where to engage and with whom grant 2017b similarly they found that the interviewees said that there is a lack of real strategy on how the water sector should tackle gender discrimination and exclusion grant 2017b the iucn argues that addressing gaps in integrating gender in water governance requires applying tested tools and approaches fauconnier et al 2018 3 method and definition of terms applying a gender lens to modelling guidelines the guidance literature on best practice environmental modelling is substantial argent et al 2016 badham et al 2019 barthel et al 2008 beven and alcock 2011 black et al 2014 crout et al 2008 hamilton et al 2015 jakeman et al 2006 lahtinen et al 2017 refsgaard et al 2007 2005 scholten et al 2007 2000 best practice guides can be found in different levels of detail for different water management domains and for different users refsgaard et al 2005 throughout this literature however it is difficult to find guidance on if or how gender analysis should be integrated into water management models this is the case even where modelling guidelines specifically ascribe to iwrm badham et al 2019 black et al 2014 this paper begins to address that gap by exploring whether a gender perspective may affect choices made at the various points in the biophysical modelling process and especially if it leads to decision forks in that process that substantially propel a modelling project down alternative paths which lead to different outcomes lahtinen et al 2017 we review gender water relationships found in literature and assess their relevance to modelling as a preliminary foundation for developing and testing approaches useful for practitioners we anticipate that one possible approach for integrating gender concerns into iwrm modelling would be to use gender analysis of systems for informing subjective modelling decisions this would aid more inclusive and diverse decision making modelling choices could be analysed critically and documented so that the subjective process of modelling is made more explicit and systematic melsen et al 2018 badham et al 2019 echo this sentiment arguing that in best practice iwrm modelling not all steps may be relevant but it is valuable to consider the relevance of each step so that omission is an explicit decision and not simply an oversight such analysis may be challenging for modellers with no gender expertise this paper is designed to provide some insight into how knowledge about gender relations and gender mainstreaming can relate to technical and other modelling choices further it is important that interdisciplinary teams work together to support this analysis process and for modellers to take up the challenge of becoming familiar with concepts around gender 3 1 terms and methods gender refers to the characteristics and behaviours that different cultures attribute to the sexes this is in contrast with sex which refers to biological differences chromosomes hormonal profiles internal and external sex organs grant 2017a although there are other social lenses that are just as important gender is a good entry point for considering how alternative perspectives on water management and its modelling could change model results the richest social analysis would use an intersectional approach to the analysis of water use access and control intersectionality is both an analytical and theoretical lens used predominantly by feminist theorists to highlight how interactions between social divisions such as gender class and ethnicity affect individuals experiences including marginalisation crenshaw 1990 this comprehensive approach is however beyond the scope of this paper and the reader is referred to braun 2011 cole 2017 huynh and resurreccion 2014 and thompson 2016 for more complete understanding of intersectional analysis of water systems such analyses reveal greater heterogeneity of issues across men and women and how social differences shape access use and control of resources like water thereby requiring more specific and targeted policy responses to their specific needs in order to identify common modelling decisions or forks in water modelling projects we identified three broad modelling phases as described in a range of best practice water modelling guides a problem framing and conceptualisation b model construction documentation and evaluation c model interpretation for supporting decisions once these phases were identified we used a gender mainstreaming process to consider the relevance of gender considerations in each gender mainstreaming is the process of assessing the implications for women and men of any planned action including legislation policies or programmes in all areas and at all levels it is a strategy for making women s as well as men s concerns and experiences an integral dimension of the design implementation monitoring and evaluation of policies and programmes in all political economic and societal spheres so that women and men benefit equally and inequality is not perpetuated the ultimate goal is to achieve gender equality united nations 1992 there are many definitions and interpretations of gender mainstreaming but as applied in our paper it means we are deliberately seeking to assess the implications for women and men of any modelling choice essentially this means that for each modelling phase we sought examples and scenarios where gender relevant concerns would impact choices made in that phase we acknowledge that research activities are conducted within a societal and cultural context and that norms and values influence research designs and outcomes it is our hope that by questioning and integrating gender into water modelling the work of the water sector will better reflect gender concerns and thus better inform policy makers to make gender sensitive policies and processes we suggest gender mainstreaming can be applied to all modelling phases as illustrated in table 1 and therefore should be considered from the outset of a modelling exercise we have structured the results of our review according to these modelling phases in the sections below this paper does not attempt to explore all points in table 1 focusing only on specific examples that are relevant to each phase the call to integrate gender into modelling is sometimes interpreted as a request for modelling platforms that can include explicit representation of men and women s behaviour and decisions in modelling agent based models system dynamics models and bayesian networks are examples of integrated modelling platforms that accommodate these details see kelly letcher et al 2013 we limit our focus to biophysical modelling in this paper for several reasons first gender considerations are often assumed to be beyond scope in a biophysical modeling exercise and we wanted to test that assumption second it is more obvious that gender considerations are relevant when modelling social and economic aspects of a system and there is more guidance available on how to do it we are interested in identifying what gender mainstreaming processes may be useful for biophysical modellers in order to address the lack of guidance in this area the core ideas and some of the examples used in this paper have been drawn from packett et al 2018 which is a more wide ranging review that is not limited to biophysical models 4 insights gained from applying gender mainstreaming to modelling decisions 4 1 problem framing and conceptualisation problem framing and conceptualisation involves articulating the problem and specific questions to be addressed through the modelling exercise it is where judgments are made about what is in or out of scope for addressing the problem creating the potential for excluding considerations that are considered important by some but not by others there are strong arguments for integrating gender considerations right from the beginning of projects interviews with water professionals done by gwp found that one disincentive to including gender considerations is that gender issues are tacked on rather than considered upfront which makes them hard to integrate and act upon properly grant 2017b merritt et al 2017 found that one of four factors of success deemed always essential by technical experts in australian water resource projects was sufficient critical thought given to the problem framing and the role of modelling early in the project this is because questions at this stage create a path dependency that can determine the course of a modelling project lahtinen et al 2017 we explore the possibility that including gender as an analysis lens when framing the problem could alter how a model is constructed potentially leading to different insights and model informed decisions individuals have different preferences and values that inform how problems are framed and expressed in models lahtinen et al 2017 mayer et al 2017 values are beliefs that refer to personal goals they typically transcend specific actions and situations and they guide people s sense of right or wrong schwartz 2012 in investigating the values that drove their modelling choices mayer et al 2017 studied 11 scientists in the same climate modelling team and revealed that while some values were common across the scientists such as consistency in evaluating modelling results there was also considerable diversity only two mentioned basic rights protection as one of their modelling ethical values this is important because explicit and unconscious preferences can alter modelling choices and results lahtinen et al 2017 melsen et al 2019 a diverse set of perspectives is one way to reveal the different values prevalent within the decision making and stakeholder context and how these could change problem framing and subsequent modelling decisions mayer et al 2017 suggest that active efforts to make implicit values known facilitates better scrutiny within the team and external reviewers even within research groups members of a modelling team rarely have the same level of power and influence to exert their preferences on decisions reflecting on power imbalances will be fruitful and we refer readers to work on team decisions and participation intersectionality and institutional culture cech and pham 2017 cornwall 2008 grant 2017b holleran et al 2011 torino et al 2018 walby et al 2012 wu and jing 2011 the subjective choices in projects create multiple decision pathways along the way value or ethical judgments are made yet only the final product is visible at completion when informing decisions science produces information products that are often used elsewhere we contend that good practice behooves scientists to analyse and document these ethical choices so that they are replicable and can be used to inform how any final product is interpreted and used question framing can reveal or obscure certain issues so affecting the type and quality of data collected a study undertaken by the social observatory found that when village members designed their own questions to investigate their livelihoods there was only a 17 crossover in questions developed by the indian national sample survey which targeted the same issues rao 2017 questions to target gender equality could be framed as how much do you spend on the purchase of vegetables in a month world bank or does the person who eats last get enough to eat women from bihar india rao 2017 different values across researchers and stakeholders can inform the types of questions asked and associated data needs for example baker et al 2015 characterised gendered difference as well as differences between researchers and community members in mapping landscape features in a sub catchment in ethiopia when creating input layers for their soil and water assessment tool swat model researchers focused on land use and crop type to classify the landscape women tended to classify areas in terms of soil type which were proxies for productivity and land degradation and at a finer resolution than maps developed by the food and agriculture organization fao men on the other hand classified larger areas of land as grazing reflecting their role in stewarding livestock this means that in their maps land that would have been assigned crop or soil type was seen as grazing this study showed how differing perspectives can influence judgments of what data is relevant for understanding and addressing a problem similarly the value system of the researcher can influence final outcomes especially given it is often the researcher who selects the input data to be gender sensitive water modelling projects can include a range of perspectives through diverse framing of questions so that model conceptualisations are informed by that diversity and deliver insights that are robust to this range this could be done in a mix of ways tools and methods for eliciting knowledge directly from stakeholders have been reviewed by voinov and bousquet 2010 and voinov et al 2016 drawing on the literature in participatory modelling methods seeking specialist gender expertise is also valuable for bringing relevant theories and practices to problem framing and conceptualisation such efforts may pose problems and raise questions that cannot be addressed by biophysical models alone and if this is the case then it will be important to ensure the conceptualisation of any biophysical modelling is such that it can connect with and contribute meaningfully to the broader problem framing 4 2 model construction documentation and evaluation we refer to model construction in broad terms referring to decisions about modelling approach and design informed by problem conceptualisation building a working model and implementing it these steps are generally considered to be specialist modelling decisions separate from social analysis however even technical modelling choices can reflect values based assumptions in the next sections we give examples of how both the modelling approach and its implementation are affected by stakeholder and researcher values that are relevant to gender 4 2 1 choice of modelling approach several decisions are made when choosing elements of the modelling approach there are decisions about the nature of the model itself e g qualitative or quantitative analytical or numerical process based or observation driven deterministic or stochastic or a hybrid mix and there are also decisions about who is involved in model design building and testing will it involve specialist modellers only or does it include participatory co production with stakeholders kelly letcher et al 2013 describe a range of factors that affect choice of modelling approach model purpose data availability system conceptualisation treatment of uncertainty and appropriate mode of output generation e g scenario based analytical solution or optimisation we suggest there are gender relevant considerations in each of these for example the treatment of uncertainty is shaped by attitudes towards risk gender differences in risk and ambiguity preferences have been found regularly in laboratory and field behavioural studies although there are some exceptions croson and gneezy 2009 a study investigating flood risk attitudes in a large sample in serbia found that men perceived themselves to be more prepared for flooding events than women while women indicated high concerns about flood risks cvetković et al 2018 risk averse values could influence the type of modelling preferred and or the specification of modelling objectives risk reduction decisions could be better informed by modelling approaches explicitly characterise statistical distributions and probabilities alternatively plausible scenarios spanning extreme or undesirable outcomes could be modelled in cases where probabilistic approaches are not possible as can be the case for complex integrated water models we note also that risk awareness and attitudes change over time and so modellers may need to be responsive to changing appetite for more specific insights into risks these examples show that social preferences of individuals and groups can be reflected in the choice of modelling approach so that model is suitable for generating outputs that are directly relevant to stakeholder priorities in this way the choice of modelling approach can be assessed according to how well it represents the interests of diverse stakeholders it is common for modellers to come to a new problem having already chosen their modelling approach this reality presents practical challenges in bringing a genuinely open mind to questions of model choice and implementation even if a modeller has some flexibility in their choice of modelling approach their choices will be limited by their own experience and capability as well other factors that determine the accessibility of different modelling approaches including time funding and available modelling infrastructure at a minimum we recommend making a deliberate effort to consider a broader range of modelling approaches review their strengths and weaknesses in addressing the problem as framed and spell out explicitly the criteria being used to choose one modelling approach over another by ensuring that gender relevant criteria are part of this assessment it should be possible to document the model s fitness for purpose and outline supplementary measures that can be taken to account for anticipated shortcomings in the modelling approach 4 2 2 choices in model implementation once a modelling approach is chosen assumptions made when implementing the model are vital context for interpreting results and evaluating fitness for purpose melsen et al 2019 studied the effect of subjective modelling decisions on the results of flood and drought event simulations in the swiss thur basin they focused on four modelling decisions the spatial resolution the spatial representation of the forcing the calibration period and the performance metric of the model they found that these choices affected the modelling results significantly this demonstrates that embedded in the model are assumptions on what is important and what is not and decisions on temporal and spatial scale numerical methods dealing with data scarcity and uncertainties are not neutral they influence not only the model results but also what the model can do who can use the model and for what purposes melsen et al 2018 hydrological models are often calibrated by optimising an objective function and it is well recognised that different objective functions are appropriate for different modelling purposes e g see vaze et al 2011 for guidance on choice of objective function for eco hydrological applications for example it is important to ensure the model adequately characterises specific attributes of the flow regime e g low flows or cease to flow events bunn and arthington 2002 similarly the type or timing of flow that is most important may be different for different people in the chhattis mauja irrigation system in nepal zwarteveen 1997 found that even though men and women were working cooperatively as co farmers they tended to have different priorities about water flow conditions their work made them aware of the timing of delivery of water men tended to care about water arriving at the start of the irrigation season because they were responsible for land preparation women agreed but also stressed the importance of ongoing access to water throughout the irrigation season because reduced rice paddy pond depth encourages weed growth and they are responsible for weed management in modelling this system there are different gendered perspectives on which flow attributes are most important for farming this example illustrates that gender may affect datasets methods chosen for model calibration and evaluation as well as which metrics to report gender is not the only social lens that could inform modelling choices and sometimes it won t be the most important for example choosing temporal scales is an important step in a modelling process hydrological models used for multi decadal projections are likely to be less complex and include fewer processes for computational efficiency consequently model results will be appropriate for assessing long term impacts but may not provide the level of detail needed for current day to day operations or management mayer et al 2017 choices such as model complexity and time step involve value judgments reporting time scales of model output will need to reflect those most relevant to stakeholders in a large scale statistical analysis across 53 countries of time preferences such as discounting and uncertainty avoidance wang et al 2016 found that gender was not a significant predictor of time preferences however different cultural practices tended to change time preferences other work has shown that participants ages can impact time preferences green et al 1994 this implies that perceptions of time might impact the preference for information produced by modelling to aid water management decisions there are practical challenges in applying gender mainstreaming to the day to day details of building calibrating and testing a model to do so most effectively requires involving stakeholders at all stages in model development which entails iterative processes that are time and resource intensive the available methods and recommendations for navigating associated challenges are reviewed in the participatory modelling literature e g etienne 2012 voinov et al 2016 voinov and bousquet 2010 4 3 model interpretation for supporting decisions choices in how to interpret and communicate results are critical in shaping how modelling supports the decision making process the following sections use examples relating to multi criteria optimisation aggregate indicators and handling of uncertainty to give options for including gender considerations when interpreting and using model results 4 3 1 performance and optimisation criteria are explicit value statements if a hydrological or integrated water resource model is used within a decision support context which includes weighting or optimising across different criteria or making management recommendations then this process involves a series of implicit value judgements choice of optimisation method and objectives the criteria against which success is measured and the relative weightings across different criteria all have an impact on how the model is interpreted and so influence management decisions it is useful to reflect on who is involved in these decisions whose voices are excluded and how inclusion exclusion supports or impedes model legitimacy this raises questions of power in decision making in developing fisheries rights joubert et al 2008 undertook a study which revealed that the proposed criteria for their multiple criteria decision analysis process were different between the fisheries agency staff and relevant community stakeholders in south africa and that these groups valued various criteria differently this suggests that the criteria for weighing options in resource management and their relative importance can change depending on who has access to or control of the decision making process this is pertinent for the water sector because sometimes the right to participate in these water management conversations can be a privilege afforded largely to men for example in south asia government irrigation agencies remain male dominated with women constituting only 2 4 of the engineering staff zwarteveen 2011 this is often true of community level water users organisations too agarwal 1997 meinzen dick and zwarteveen 1998 ray 2007 samee et al 2015 zwarteveen 1997 however it is government staff that often have control of information production and dissemination thus giving them power to shift values beliefs and norms srinivasan et al 2017 4 3 2 aggregate indicators mask implicit value judgments and distributional consequences aggregate indicators can fail to convey severe impacts for some people and conceal whether or not effects are distributed equitably adams 2000 amoretti and vassallo 2016 a review by the world commission on dams wcd judged that aggregate costs and benefits of large scale dam projects are not comprehensive enough for approving infrastructure programmes because distributional effects are masked and equitability cannot be assessed adams 2000 reporting of distributional effects are important for ensuring that more marginalised and vulnerable minorities benefit from projects and do not bear disproportionate unwanted impacts they emphasise that excluding gender from social impact analysis is particularly misleading and risky because hard numbers however crudely generated command attention from planners once created such numbers become divorced from warnings about their reliability and are used in decision making by donor and government decision makers if such numbers are wrong or omit vital areas they can be dangerously misleading things that can be quantified tend to dominate decisions at the expense of things that cannot be quantified adams 2000 this can be particularly true for indicators that focus on economic analysis for example the us 8 billion transnational lesotho highlands water project lhwp is a programme that constructed five dams and cross national tunnels in lesotho in order to generate national income from selling water to south africa braun 2011 feasibility and initial objectives suggested that lesotho would benefit from the project by broadening the economic base and development of remote mountain regions yu 2008 in practice despite economic growth poverty did not improve economic inequality remained high and lesotho experienced social and environmental costs yu 2008 the filling of the dams led to a serious decline in resources for affected households with the burden falling disproportionately on women braun 2011 mwangi 2007 the project increased the reliance of households on wages and formal markets due to the patriarchal system in lesotho this reliance increased gender inequalities by giving men greater control over household resources braun 2011 such diverse impacts are difficult to anticipate and make visible in aggregate estimates of economic costs and benefits effects such as these prompted the wcd to call for gender sensitive social analysis of dam projects aggregation is often necessary in practice but when doing so it is useful to pay attention to what is excluded in aggregation retain and report distributional properties where possible and provide supplementary interpretation to compensate for omissions resulting from aggregation 4 3 3 uncertainty and gender considerations gender impact assessments gias can help to reveal access and control of water based resources and potential impacts of projects simon 2013 however gender analysis is often limited by lack of data adams 2000 escobar et al 2017 ray 2007 even with more resources dedicated to the collection of data and assessment of potential gender impacts the ability to anticipate and usefully characterise impacts in complex social systems is limited even if it is not possible to resolve issues of data scarcity and poor predictability better acknowledging these realities is an important first step towards including them in impact analyses and assessment in particular it opens options for including these unknowns in more suitably encompassing uncertainty analyses smithson 1989 offered a taxonomy of unknowns in which an important distinction is made between ignorance that is treated as irrelevant i e ignored from the analysis versus ignorance that is recognised as errors errors can be explored characterised and included in the analysis and interpretation even if these errors cannot be reduced for example if data are reported at household level only and there is no gender disaggregated data it is still possible to test the sensitivity of the analysis to plausible data ranges that are representative of these unknowns a subsequent step is to assess whether any sensitivities could have a bearing on final decisions informed by the analysis there are more options for handling uncertainty than simply trying to reduce it and there is a growing range of methods for water management planning under deep uncertainty herman et al 2014 used a multi stakeholder multi objective robust decision making framework to better understand robustness tradeoffs between different water supply options in the face of deep uncertainties related to climate change financial risks and population pressures uncertainty risk and or vulnerability analysis can help us acknowledge our ignorance and explore its possible consequences 5 discussion 5 1 towards a practical approach we have used examples to show that including gender perspectives stands to make a material difference to choices made in problem framing model conceptualisation modelling approach implementation and interpretation these examples demonstrate the potential for a modelling approach that seeks to incorporate gender perspectives integrating gender analysis and including a range of diverse perspectives in model development decisions could be one approach for modelling projects to engage with gender relevant objectives choices could be assessed and documented for the major modelling phases to state explicitly who was involved and what values or criteria informed subjective decisions particularly where this may have led to significant decision forks this would be equivalent to gender mainstreaming the modelling process applying this approach to a project would involve contextual gender analysis to provide the input data for assessing decisions made during model development and use gender analysis can be aided through a range of toolkits such as the harvard analytical toolkit global water partnership s gender equality and inclusion in water resources management action piece or world water assessment programme s toolkit on sex disaggregated water data fletcher and schonewille 2015 grant 2017c south east asia and the pacific multidisciplinary advisory team 1998 we are not aware of this approach being used systematically in any water modelling projects there is an opportunity to apply and test this method to explore how much of an impact conducting this process would make as mentioned earlier an intersectional approach i e one that takes account of stakeholders social identities such as culture class gender would yield richer data and ways in which decisions and values are prioritised time and resource limitations are common barriers to an intersectional approach with its requirements for multidimensional analyses of the social confluences of gender class ethnicity and race gender intersects with most other social structures and so it is an inclusive entry point for social analysis a gender sensitive contextual analysis i e literature review stakeholder consultation with key community leaders and civil society organisations can reveal key intersectionalities to be prioritised in further intersectional analysis further analysis could include using naila kabeer s social relations framework kabeer and subrahmanian 1996 to provide an institutional analysis of how inequalities are produced within and across the different scales of family kinship communities market and the state in the context of water resource management this might mean exploring how women and marginalised groups are denied water access and consumption at the household or community level to how market pricing of water limits the poor from accessing drinking water to how state policies around water overlook the contribution of women s role in water resource management we recognise that applying gender mainstreaming won t always make a difference to modelling choices rather if gender outcomes are a specified goal of a project modified modelling practice could ensure that if gender is judged to be unrelated to a modelling decision this view is an informed conscious choice supported by documentation in this way a gender mainstreaming approach might provide a simple transparent structure for assessing and reporting on modelling decisions in a gender relevant way this process may be used to substantiate claims that modelling results are robust to differences in gendered dynamics for example in the swat and gender case study by baker et al 2015 cited earlier despite the differences in conceptualising the landscape between researchers and between male and female stakeholders the final modelling from all these perspectives yielded similar results this is because during their mapping exercise the three groups assigned similar areas to agriculture which was the parameter that the rainfall runoff and curve number was most sensitive to through documenting this process the team now has evidence that their results are gender informed and thus valid diekmann and zwart 2014 additionally where gender may not overtly be part of the goals and outcomes of a modelling project including gender and social dimensions has the potential to strengthen modelling results by engaging with a wider range of stakeholders and highlighting possible questions knowledge values and choices that may otherwise be overlooked it may also lead to informed insights in future modelling and iwrm studies conducted elsewhere this reflects the diekmann and zwart 2014 argument that fairness can be used as a test for quality in similar ways to other validation and verification tests they conceptualise fairness as the maxim of giving due and equal attention to the interests of all stakeholders independent of their social power or status they argue that using fairness as a test of whether a model is fit for purpose will guarantee that a model provides what is practically required and theoretically desirable mutual confidence in construction usage and choice of embedded and implied values among all stakeholders we contend this is a relevant test for iwrm modelling efforts and hope to have made a contribution towards this aim 5 2 relevance of gender in modelling decisions our aim has been to ask whether modelling could unfold differently if gender or other equity perspectives and intersectional considerations were to be mainstreamed into each stage of the modelling process and would these differences matter our exploration has been a conjectural one at this point we have not applied the approach suggested in the previous section to a specific model or case study the approach will need to be tested rigorously and evaluated against suitable criteria in addition to the motivations for gender integration laid out earlier the potential approach is also relevant to projects funded by institutions with gender goals consider for example the australian government department of foreign affairs and trade dfat where improved outcomes for women and girls are a high priority against which projects and their activities are evaluated for these dfat funded projects that include hydrological modelling there is little guidance on how to link gender to the detailed mechanics of hydrological modelling it is not immediately clear that taking a gender perspective would see any change made to the development of a rainfall runoff model for a catchment a technical task for which there are well established model development steps a modeller might reasonably ask for example i work on developing rainfall surfaces as inputs to hydrological models why do i need to think about gender as demonstrated by examples described in this paper metrics used by modellers for selecting model inputs or calibrating models against observations could have real world gender specific relevance the development of rainfall surfaces requires judgments about what attributes of the rainfall are most important to represent if the intended beneficiaries of the modelling are women located on a floodplain is it more appropriate to use rainfall inputs that are consistent with total annual rainfall or is it more relevant to use inputs that capture the timing and magnitude of extremes our intention is to prompt questions of this type and increase awareness of where a gender lens may reveal different answers by suggesting that modelling teams better recognise the subjective nature of their modelling choices and subsequent decision forks it provides a natural entry point for bringing others perspectives into the modelling process earlier our work provides another argument for the benefits of participatory practices that foster genuine engagement with stakeholders and their priorities even if the model represents only biophysical and not social processes furthermore documentation of such practices provides transparency and a useful form of accountability to stakeholders and funders and for modelling teams to monitor and learn from their experience according to their own quality assurance requirements some may interpret our recommendations to mean involve both men and women in any modelling exercise the process of gender mainstreaming is not that simplistic it is about asking whose interests and perspectives are represented and whose are excluded and recognising that modellers of any gender will not necessarily have that insight and awareness when going about their model development a team of all female modellers would not necessarily have any more informed insights into women s perspectives in a water system in a different country with a very different culture to their own similarly an all male modelling team could well make good progress working with a gender specialist who could be any gender who facilitates participatory processes for eliciting gender relevant insights across a diverse range of stakeholders we have explored these ideas with biophysical modellers working in australian and international contexts and in many of these conversations initial doubts about the relevance of gender have been shifted but it has taken curiosity open mindedness and the discovery of tangible plausible examples in the course of these discussions to enable such shifts the modelling guidelines such as black et al 2014 have been a useful entry point to those discussions and allowed us to discover relevant examples that resonate with modellers by providing tangible examples in this review we hope to prompt similar discussions in other modelling groups and enable further explorations of the practical value of applying gender mainstreaming in model development practices 6 conclusions ensuring that water management decisions lead to equitable outcomes is increasingly a priority of water management decision makers given the complex task of water management models and or modelling frameworks are often used as a tool to support decision making thus it is useful for modellers and model users to have methods to assess and report how questions of equity and inclusivity have informed their modelling choices and practices although this is inherently difficult to do systematically evaluating modelling choices especially those that may create substantial modelling forks from different perspectives can prompt creative thinking about alternatives decisions from the beginning to the end of projects are influenced by values given this making a more deliberate attempt to identify and then include others perspectives including across gender can reveal situations where different conceptual framing data choices objective functions or priorities might impact a model s development and outcomes this paper provides examples within three key iwrm best practice themes where gender considerations might impact a modelling choice problem framing and conceptualisation model construction documentation and evaluation and model interpretation for supporting decisions areas of model development that could be affected include the initial choice of modelling approach parameterisation and calibration furthermore the interpretation handling of uncertainty and choice of aggregated reporting indicators can all be reviewed in light of gender specific objectives at the very least gender mainstreaming provides a process for exploring and then making explicit the range of gendered assumptions knowingly or unknowingly embedded into the model all modelling projects are likely to have resource constraints and it can be difficult to assess what analysis needs to be integrated and what can be excluded gender analysis will be important for teams that have equitable water management as a goal and where gender analysis is excluded this should be acknowledged as a project limitation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the funding sources are commonwealth of australia represented by the department of foreign affairs and trade grant number 72861 commonwealth scientific and industrial research organisation 
26031,environmental models have a key role to play in understanding complex environmental phenomena in space and time although their inherent uncertainty and non identifiability are being increasingly recognized with the development and application of various methods a more holistic analysis of all sources of model uncertainty is warranted this paper addresses sources of uncertainty from various types of input datasets and model parameters including those related to model structure assumptions using a soil and water assessment tool swat application for the minjiang river watershed china the holistic uncertainty sources in the swat application are summarized and a sensitivity analysis sa is applied to examine the relative importance of the uncertainty sources influencing average streamflow and the load of nitrate the analysis reveals that uncertainties related to the stream network precision and certain swat parameters are the most critical factors furthermore building upon our sa framework to consider uncertainty sources more holistically would provide a good starting point for subsequent sa of spatially distributed environmental models in general keywords uncertainty sensitivity analysis water quality swat watershed delineation hydrological response unit identifiability 1 introduction deterministic environmental models offer useful methods for exploring problems providing predictions and supporting decisions that involve complex environmental phenomena evolving in space and time it has become increasingly recognized however that these models are almost always non identifiable guillaume et al 2019 in the sense that the quantity and quality of data are insufficient to parameterize the models uniquely and that the associated modelling must address a wide range of uncertainties especially those related to predicting the impact of possible management actions accordingly uusitalo et al 2015 review various methods that can be applied to evaluate uncertainty of deterministic model outputs they cover expert assessment model emulation sensitivity analysis sa and use of multiple models arguing that the best method for uncertainty evaluation is determined by the definition of a model and the amount of available information sa is an established approach to model assessment by quantitatively evaluating the change in model output s with respect to changes in model factors usually parameters forcing and other input data a deterministic environmental model can be easily coupled with sa based on monte carlo type simulation farmer and vogel 2016 sa offers a quantitative evaluation for uncertainty in a model rather than a qualitative evaluation which for example expert assessment does uusitalo et al 2015 although qualitative evaluation could provide additional evidence to further support decision making and might be more efficient when a modeler is well informed in this paper we employ a global method of sa saltelli et al 2008 as opposed to a local method a global method allows one to compute the contribution to output sensitivity over a plausible range of factor values global sa is undertaken here as a useful first step in addressing and understanding the criticality of uncertainty sources see norton 2015 for an overview of methods and crosetto and tarantola 2001 gan et al 2014 tong 2015 by assessing those factors and their plausible range of values that dominate changes in model outputs understanding the criticalities can then be valuable for undertaking an uncertainty analysis in the traditional probabilistic sense for example where one assumes prior distributions of parameters and finds posterior distributions based on some measure of likelihood as indicated in the literature review of section 2 previous approaches to sa tend to address only a modest set of the sources of uncertainty for spatially distributed environmental models the aim of this article is to illustrate how a more holistic sa approach to spatially distributed environmental models can be used to identify their critical sources of uncertainty which would subsequently allow focus on them for more specific uncertainty analysis and even its reduction the soil and water assessment tool swat neitsch et al 2011 is used as an archetypal example as it is the most frequently used water quantity quality model fu et al 2019 ray 2018 it is also a typical example of the type of uncertainties that need to be considered in a spatially distributed environmental model the global sa approach undertaken is more complete than previous sa studies on spatially distributed environmental models in the sense that it attempts to address model structure uncertainty in combination with the usual model parameter and data uncertainties and examines impact on average streamflow as well as water quality outputs thus this article addresses the uncertainty of model structure input parameters related to the submodels of a swat application i e watershed delineation and hydrological response unit hru characteristics it also explores the measurement uncertainty of the digital elevation model dem i e its vertical accuracy and the uncertainty of boundaries of classes in land use land cover lulc and soil datasets crosetto and tarantola 2001 goodchild and guoqing 1992 because they have a profound effect on watershed delineation oksanen and sarjakoski 2005 wu et al 2008 and hru creation respectively another aspect investigated is the impact of measurement errors in meteorological information on model outputs finally the sa is also applied to the model parameters investigated as has been the primary focus in the past e g setegn et al 2010 wu and liu 2012 yang et al 2018 zhao et al 2018 some of which relate to model structure assumptions clearly while it is not possible to investigate all model structure assumptions as these can be innumerable in an environmental modelling exercise it is acknowledged that expert assessment is a key complementary and qualitative method that can be used to justify other model structure assumptions in relation to uncertainty o hagan 2012 uusitalo et al 2015 our sa approach could therefore be followed up with a formal uncertainty analysis to help in setting the range of prior distributions and fixing unimportant factors which is especially important when sampling needs to be limited because of high computational demands of the environmental model the remainder of this article is organized as follows section 2 contains a literature review and key qualitative findings of previous sa studies on the swat model section 3 briefly explains swat and the extended fourier amplitude sensitivity test fast method which is the global sa method undertaken here then in section 4 the detailed holistic sa process is reported with our swat application to the minjiang river watershed in sichuan china this analysis follows a general process of sa cheng et al 2014 gan et al 2014 identifying uncertainty sources associated with submodels in swat and propagating the uncertainty from the identified source results of analyzing the uncertainty sources using sa appear in section 5 specifically this article identifies uncertainty sources related to model structure input parameters and datasets as well as general model parameters then uncertainty propagation methods are utilized with respect to the corresponding uncertainty sources for spatial input datasets the measurement uncertainty of a dem is propagated using a sequential gaussian simulation to represent spatially autocorrelated uncertainty goovaerts 1997 pebesma 2004 and the boundary uncertainties of lulc and soil datasets are simulated by adopting the epsilon band approach crosetto and tarantola 2001 shi 1998 the sa evaluates the relative importance of the uncertainty sources in the average streamflow flow and loads of nitrate no3 this article concludes in section 6 with a discussion on future work that could profitably be conducted in relation to our analysis 2 previous sa studies on swat there has been too little attention given to sensitivity analysis of spatially distributed models that focuses on a wide range of uncertainties especially the influence of model structure assumptions in illustration this section explores limitations of previous sa studies for the water quantity quality model known as swat partly because it provides a typical example of the limitations of previous sensitivity studies with respect to a spatially distributed environmental model swat requires various model input datasets and parameters some of these factors are related to model structure uncertainty as in its sequential submodels for these prerequisite processes including spatial input datasets e g dem lulc and soil datasets for watershed delineation and hru creation although the submodels for these prerequisite processes can be considered as important sources of uncertainty that have interactions with the uncertainty of other submodels as well as impacts on swat outputs sa related studies remain incomplete in terms of addressing all sources of uncertainty especially those related to spatial input datasets and parameters for the submodels thus in swat applications sa has primarily been conducted with respect to swat parameters e g setegn et al 2010 yang et al 2018 in general they have found that only a few parameters have been identified in applications to be the major sources of uncertainty with other parameters having minor influence kumar and merwade 2009 li et al 2010 shen et al 2008 however model input parameters related to other submodels e g watershed delineation and hru creation have received relatively less sensitivity and uncertainty attention although the potential impacts of the parameters of these submodels have been recognized fitzhugh and mackay 2000 rouhani et al 2009 fitzhugh and mackay 2000 for example with an application in the pheasant branch watershed in dane county wisconsin reported that the size of a watershed has no critical impact on streamflow and outlet sediment estimation conversely another study rouhani et al 2009 involving a swat application in the grote nete river watershed in belgium revealed that streamflow estimation is more accurate with respect to its observed value when a larger watershed size is employed these uncertainties of the parameters can be partially related to the model structure uncertainty matott et al 2009 which is caused by the inability of the model structure to represent watersheds and hrus in particular investigating the uncertainty of the parameters related to subwatershed sizes helps to address a scale issue in the model which is one major aspect of the model structure uncertainty butts et al 2004 by exploring the different levels of abstracting and generalizing of process levels uncertainty related to meteorological input datasets has been considered an important uncertainty source in swat modelling e g aouissi et al 2013 strauch et al 2012 tasdighi et al 2018 with respect to both sampling villarini et al 2008 and measurement errors ciach 2002 among the uncertainties related to meteorological information the impact of the density of meteorological monitoring stations on swat predictions has received some attention which is related to sampling uncertainty the uncertainty of swat predictions has been shown to substantially increase with an excessive reduction in the number of meteorological monitoring stations until a certain threshold value bárdossy and das 2008 chaplot et al 2005 correspondingly cho et al 2009 reported an exponential increase in the uncertainty of swat predictions with a decreasing number of meteorological monitoring stations in addition swat allocates meteorological information from the nearest station to the center of subwatersheds aouissi et al 2013 masih et al 2011 scherer et al 2015 which can be also considered a source of uncertainty in swat output estimation thus advanced interpolation methods for meteorological information allocation have been developed to increase the accuracy of swat estimations masih et al 2011 strauch et al 2012 however the impact of measurement uncertainty in meteorological information on swat output estimation is rarely investigated although measurement uncertainty has also been recognized as a source of uncertainty shen et al 2015a spatial input datasets e g dem lulc and soil datasets which tend to be static over time should also be investigated for their effects on uncertainty although these spatial input datasets are the most important inputs to delineate watersheds and are critical in describing underlying watershed characteristics ray 2018 shen et al 2015a their uncertainty has been only partially examined the resolutions of spatial input datasets have been the main focus of previous studies e g chaubey et al 2005 dixon and earls 2009 lin et al 2013 shen et al 2013 specifically dixon and earls 2009 showed that the resolution of a dem has a significant impact on streamflow volume estimation and watershed delineation e g size and number of subwatersheds and average slopes with three different dem resolutions i e 30 90 and 300 m similarly chaubey et al 2005 found that a coarser dem resolution in a comparison of seven different dem resolutions yields decreased streamflow and nitrate load estimations due to a decrease in subwatershed sizes and slopes lin et al 2013 also reported decreasing total phosphorus and nitrogen load accuracy with coarser dem resolutions in addition the resolutions of lulc and soil datasets affect hru creation in swat which can yield uncertainty in watershed attribute properties and streamflow estimation kumar and merwade 2009 shen et al 2013 demonstrated the existence of a threshold resolution of spatial input datasets i e dem and lulc where a finer resolution did not benefit the accuracy of swat predictions furthermore the resolutions of the spatial input datasets can balance each other for example when the dem in a finer resolution than a threshold value is provided in swat the resolution of lulc becomes less important shen et al 2015a we contend that previous sa approaches have tended to evaluate only a modest set of the uncertainty sources in spatially distributed environmental models especially in hydrology as illustrated above for the widely used swat model a more holistic sa approach for swat would therefore be conducted with a focus on the following aspects firstly although the uncertainty of model input parameters related to the submodels of a swat application e g watershed delineation and hru creation have been partially addressed their impacts on swat predictions are rarely examined secondly the impact of measurement errors in meteorological information e g precipitation wind speed solar radiation relative humidity and temperature has been poorly evaluated in swat estimations even though meteorological information is considered as a critical source of uncertainty finally the uncertainty of spatial input datasets has several strands that warrant investigation in sa exercises one is the uncertainty of spatial data due to lineage positional accuracy attribute accuracy logical consistency and completeness ansi 1998 koo et al 2017 only the impact of spatial dataset resolution has been examined in swat applications other main sources of uncertainty in spatial datasets due to positional e g boundary uncertainty and attribute e g measurement uncertainty accuracy should also be considered in swat estimations 3 methods 3 1 swat swat is a watershed model that was developed by the agricultural research service of the u s department of agriculture usda neitsch et al 2011 swat has been extensively applied in various sectors including water management hydrology climate change land use impact and pollution to predict the environmental impacts e g land use and climate change on water quantity and quality to implement sa for swat applications bastin et al 2013 this paper uses a tool for automated swat preparation zhang et al 2019 which is based on an open source geographic information system gis interface for swat mwswat george and leon 2008 and implements the sa based on the sensitivity analysis package in r pujol et al 2018 3 2 the extended fast method sa methods are broadly classified as screening local and global methods saltelli et al 2004 our analysis applies the extended fast method saltelli et al 1999 to evaluate the uncertainties associated with model parameters and input datasets i e factors and their interactions because the factors are not independent and typically interact with one another the extended fast is one of the sa variance decomposition methods the variance decomposition method evaluates the sensitivity of the model output using sensitivity indices sobol 2001 which compute the fractional contributions of input uncertainty x i to the variance in the model output y this variance is defined as 1 v i 1 v i i j v i j v 1 2 d where v i v e y x i v i j v e y x i x j v i v j e y x i denotes the conditional expected value of y on x i and v represents a conditional variance the main effect index s i and the first order interaction effect s i j can be represented as follows 2 s i v i v 3 s i j v i j v the main effect index quantifies the effect of only x i over the averaged variations in other factors and is scaled by the total variance to represent the fractional contribution the total effect index s t i can be defined as 4 s t j 1 v e y x i v where x i is the subset of all elements x except x i the main and the total effect indices are generally used to determine critical factors and to screen out uncritical factors respectively yang et al 2018 this study explores the uncertainty caused by each factor i e model input datasets and parameters as shown in table 1 on swat estimations and their interactions to understand the uncertainty effects across its submodels however an alternative solution is necessary to quantify interaction effects because a vast number of indices which is 2 n 1 with n factors needs to be estimated to represent all interaction effects among factors the extended fast can be an alternative saltelli et al 1999 because it furnishes only the estimates of both the main and total effects because the total effect indices include a main effect and all higher order interaction effects related to specific factors an interaction effect can be distinguished by subtracting the main effect index from the total effect index additionally the extended fast is known to show better efficiency than the sobol method which is another extensively employed sensitivity method gómez delgado and tarantola 2006 the sampling technique for the extended fast method is fixed which converts a multi dimensional integral to a one dimension integral gan et al 2014 after the number of factors is determined the minimum sample size n s for the extended fast is not changeable gan et al 2014 and is calculated by the following saltelli et al 1999 5 n s n r 2 m ω i 1 where m denotes the interference factor set to 4 in this analysis ω i represents the frequency assigned to the factor of interest and n r is the number of resamplings for 15 factors the ω i and n r are set to 143 and 3 in order to keep the ratio ω i n r within 16 and 64 which is an optimal region for convergence of sa indices saltelli et al 1999 following this recommendation the sample size in this analysis is determined as 3 435 4 application 4 1 study area and datasets this study illustrates a more holistic sa approach to spatially distributed environmental models with a swat example in a subset of the minjiang river watershed the minjiang river watershed is located in the upper part of the yangtze river basin and the subset of the watershed in this analysis covers approximately 12 893 km2 fig 1 the minjiang river is the largest tributary of the upper yangtze river and supplies water to downstream regions for agriculture e g chengdu and its neighbors this watershed is highly vulnerable to climate change due to its high elevation which ranges from 1 627 to 5 419 m thus the minjiang river watershed has been a high priority for developing and conserving the yangtze river regions cui et al 2012 as previously indicated swat requires spatial input datasets e g dem lulc and a soil dataset and meteorological input datasets e g precipitation wind speed relative humidity and solar radiance for its execution this study has conducted analyses using commonly available spatial input datasets and meteorological input datasets george and leon 2008 to ensure that its findings are readily applicable to other studies the dem was obtained from the nasa srtm version 4 1 which was published by the consultative group on international agriculture research consortium for spatial information cgiar csi with a spatial resolution of 3 arc second approximately 90 m jarvis et al 2008 the source of the lulc is based on the global land cover characterization glcc database loveland et al 2000 and the soil dataset was obtained from the food and agriculture organization of the united nations fao unesco 2003 both the lulc dataset and the soil dataset are published in waterbase george and leon 2008 with spatial resolutions of 500 m and 600 m respectively the meteorological dataset was obtained using the national center for environmental prediction ncep climate forecast system reanalysis cfsr fuka et al 2014 in 2013 this study utilizes meteorological information from only one monitoring station to focus on the measurement uncertainty of meteorological information and avoid uncertainty produced by the numbers and locations of monitoring stations strauch et al 2012 4 2 identifying sources of uncertainty a swat application consists of three sequential submodels watershed delineation hru creation and swat execution each model requires separate model input datasets and parameters which can be considered sources of uncertainty table 1 first in the watershed delineation a minimum threshold value is necessary for this analysis to designate drainage to a stream network minstream although a predefined stream network dataset can be superimposed on a dem for accurate stream network delineation e g setegn et al 2010 the predefined dataset should have a different precision depending on its target scale and or scale of its source map thus this analysis directly generates a stream network from the dem to consider the uncertainty of the stream network precision this stream network precision is directly related to the overall sizes of subwatersheds which can partially address a scale issue in spatial datasets chrisman 1991 second the dem is required to delineate watersheds as a model input dataset previous studies have primarily addressed the impact of dem resolution on swat estimations e g chaubey et al 2005 dixon and earls 2009 shen et al 2013 a dem also contains systematic and random errors due to an inherent elevation measurement error whose impact on watershed delineation has been investigated hengl et al 2010 oksanen and sarjakoski 2005 wu et al 2008 thus the measurement error of dem udem can have an influence on swat estimations second the hru creation model requires additional model input datasets i e lulc and soil datasets because hrus are generally formed as a combination of lulc soil and slope ranges these datasets can be considered sources of uncertainty in this submodel swat classifies slope range on an ordinal scale for simplification of this analysis the slope range is divided into two groups based on the intermediate value of slope as a percentage then the intermediate value of the two groups intslope is used as a model input parameter which can be a source of uncertainty however a slope dataset itself is not considered a source of uncertainty in this analysis because a slope dataset is directly generated from the uncertainty propagated dem additionally input parameters of three models are required to define multiple hrus in a watershed the model parameters are used to eliminate small hrus by considering minimum percentages for the categories of lulc minlu soil minsoil and slope minslope lastly the meteorological input dataset and swat parameters can be sources of uncertainty the meteorological input dataset includes precipitation temperature wind speed and solar radiation as well as information about meteorological monitoring station locations for simplicity this analysis considers only uncertainty in precipitation uprec because the uncertainty of precipitation is known to generally have a greater influence on swat estimations than any other meteorological input datasets chaplot et al 2005 strauch et al 2012 specifically a measurement error in precipitation is the main interest in this analysis and the positional uncertainty of monitoring stations for precipitation measurement is not evaluated because previous studies have adequately addressed this aspect e g bárdossy and das 2008 chaplot et al 2005 fu et al 2011 with regard to swat parameter uncertainty only a few significant parameters see the appendix are selected and applied here in the sa to reduce the computational cost and to concentrate on other factors e g minstream and uprec although swat applications typically consist of hundreds of model parameters neitsch et al 2011 pp 567 595 4 3 propagating the identified uncertainty sources obtaining a proper uncertainty propagation model especially with plausible range and distributional assumptions is a crucial process in sa the propagation model primarily reflects the degree of uncertainty in model inputs and determines the impact on the uncertainty of model output generally a scalar random variable e g model input parameters can be simply represented using a probability density function however complex types of model inputs e g spatial input datasets require a more complex uncertainty propagation model by simultaneously considering various components of uncertainty crosetto and tarantola 2001 this study introduces various propagation models for the corresponding uncertainty sources with their justification for watershed delineation two sources of uncertainty were identified in the previous section udem and minstream generating the uncertainty propagation model for udem is a challenge due to the complexity of the dem and the existence of spatial autocorrelation in the dem measurement errors temme et al 2009 thus a limited number of relevant studies have been conducted e g fisher 1998 hengl et al 2010 holmes et al 2000 to describe the spatially correlated structure of udem this study constructs its uncertainty propagation model based on a sequential gaussian simulation goovaerts 1997 pebesma 2004 then the propagated values of udem are scaled based on a normal distribution to reflect the realistic range of measurement uncertainty in udem the value of the scale parameter which indicates the accuracy i e difference to the true value at a 95 confidence level determines the level of uncertainty in udem the scale parameters are uniformly distributed in the range between 0 and 16 because the total vertical accuracy in an srtm v4 1 dataset with a 3 arc second resolution is 16 m at a 95 confidence level mukul et al 2017 lastly the generated values of udem are added to the original dem fig 2 shows examples of the uncertainty propagation model of udem with the scale parameter values of 4 8 and 16 another source of uncertainty in watershed delineation is minstream which is a critical parameter for determining the precision of a stream network minstream is simply modelled here based on a uniform distribution because it is represented as a scalar random variable because minstream parameter uncertainties have not been fully considered in previous sa studies and is the critical parameter to determine spatial scales of a subwatershed this parameter is examined with two different ranges the uncertainty associated with minstream is modelled by changing its uniformly distributed values in the range between 5 000 and 15 000 and 10 000 15 000 by considering widely available spatial datasets for stream networks specifically the generated stream network from the minstream value of 15 000 approximately corresponds to the stream network in the 1 1 000 000 vector map i e vmap0 and that from the value of 5 000 shows slightly coarser stream network than the 1 250 000 topographic map i e joint operations graphic jog fig 3 illustrates examples of the stream network generation with minstream values of 5 000 10 000 and 15 000 in fig 3 the precision of the generated stream network tends to decrease when minstream is increased for instance by increasing minstream an exponential decrease in the line feature counts of the generated stream networks fig 3 which are 189 89 51 features for minstream values of 5 000 10 000 and 15 000 respectively is observed minstream also relates strongly to overall size and number of subwatersheds an increase in minstream would lead to an increase in the number of subwatersheds and a decrease in the overall size in the hru creation submodel uncertainty propagation models were generated for the following uncertainty sources which have associated model input datasets i e lulu ulucl and soil datasets usoil and model input parameters i e minlu minsoil minslope and intslope ululc and usoil require an uncertainty propagation model that differs from the previous uncertainty propagation model for udem it is noted however that lulc soil datasets and dem are the same as raster datasets because they are represented on a different measurement scale i e lulc and soil datasets are categorical raster datasets but the dem is a quantitative raster dataset heuvelink 1998 this study constructs the uncertainty propagation models for ulucl and usoil by adopting the concept of the epsilon band which was originally developed for vector data to represent boundary uncertainty crosetto and tarantola 2001 shi 1998 ulucl is modelled using a uniformly distributed band within 2 000 m on both sides because lulc is generated based on a 1 km monthly advanced very high resolution radiometer avhrr satellite image similarly usoil is modelled within 2 500 m on both sides by adopting the rule of thumb for the positional uncertainty from maps longley et al 2011 which represents the maximum uncertainty of 0 5 mm at the sources of the soil dataset i e soil map of the world at 1 5 million because the uncertainty propagation models of minlu minsoil minslope and intslope have not been fully investigated in previous research all possible ranges of the parameters are examined here by assuming a uniform distribution minlu minsoil minslope and intslope were given the ranges of 5 42 5 50 5 50 and 0 05 0 8 respectively table 2 we now address the uncertainty propagation models used for uprec and the swat parameters for swat execution firstly the uncertainty propagation model for uprec is constructed based on a uniform distribution in the range 15 2 15 2 with a relative change to its observed precipitation this range reflects the maximum measurement error of precipitation in china which varies from 4 34 to 15 2 with a mean of 6 52 in china according to the state meteorological administration ren et al 2003 shen et al 2015b for the swat parameters we chose the more sensitive swat parameters using the morris screening method morris 1991 among the candidate swat parameters acquired from the swat model calibration literature e g abbaspour 2015 abbaspour et al 2007 yang et al 2018 appendix also the ranges of the swat parameters table a 1 follow standard levels in swat model calibrations and sa studies in the absence of better information the selected parameters in accordance with their swat parameter names are the following alpha bf gw delay cn2 esco rcn and nperco briefly alpha bf and gw delay are used to describe the properties of groundwater and cn2 is the type of hru management option which includes land and water management practices esco is related to the hru general input file and describes diverse features within hrus rcn and nperco are utilized to define general watershed attributes which are expected to be sensitive factors for nitrate outputs no3 finally table 2 describes all selected parameters and their uncertainty propagation models that are used in the following sensitivity analyses refer table a 1 for further detail of swat parameters 5 results of analyzing the uncertainty sources through sa this analysis evaluates the impacts of the fifteen factors on variations in the two swat output estimates considered i e flow and no3 at the outlet of the minjiang river watershed refer to fig 1 firstly the impacts of the fifteen factors on flow are evaluated in terms of the main and total effect indices using the extended fast fig 4 as we discussed in section 4 3 two different ranges of minstream i e the wide range w sa between 5 000 and 15 000 and the narrow range n sa between 10 000 and 15 000 are applied in the sa for further exploration of this factor for both sa results the main effect shows that five factors have a larger influence than others on the variation in flow minstream cn2 uprec gw delay and esco although in comparing n sa fig 4 b to w sa fig 4 a the main effect of minstream decreases i e minstream 65 8 54 7 and those of other four factors increase i e cn2 6 2 12 5 uprec 5 0 9 4 gw delay 3 3 6 6 and esco 1 8 2 7 the order of their main effects are still consistent the range of generated stream feature counts in n sa is much narrower than those in w sa i e 51 89 and 51 189 respectively see fig 3 but minstream still has the largest influence on flow the main effects of other factors are less than 1 in the total effects for both sa results minstream 77 3 and 64 8 the three swat parameters i e cn2 18 9 and 25 3 gw delay 8 2 and 10 4 esco 9 1 and 10 2 and uprec 12 4 and 14 5 have the greatest influence on flow the difference between the total and main effect indices provides the interaction effect between a factor and other factors comparing n sa fig 4 b to w sa fig 4 a the overall interaction effects especially of the factors related to the hru creation submodel decreases which could suggest that minstream highly interacts with the factors the sa results for no3 show a slightly different relative importance among the fifteen factors compared with the previous results for flow fig 4 with main effect indices minstream 22 0 is still the most critical factor in the w sa result fig 5 a but in the n sa result fig 5 b the swat parameters i e rcn 20 5 nperco 16 7 cn2 14 8 have a larger influence on the no3 variation than minstream 14 7 uprec shows a relatively high value for the main effect index 0 9 and 1 5 in w sa and n sa results respectively whilst the main effects of other factors have still much smaller impacts less than 1 with the interaction effect the no3 results show a similar trend with the previous flow results which is an overall decrease in the interaction effects compared to n sa fig 5 b with w sa fig 5 a in the n sa result the interaction effects for all factors except for the five critical factors are less than 1 we suspect that a decrease in the impact of minstream leads to this decrease in the interaction effects these sa results suggest the following findings firstly the precision of a stream network minstream in the watershed delineation submodel generally has the largest impact on variations in flow and no3 fig 6 shows the relationships among minstream subwatershed count and the estimations of flow and no3 over the wide range of minstream w sa in this analysis minstream shows a significantly negative relationship with the number of generated subwatersheds with a correlation coefficient of 0 975 p value 0 001 fig 6 a which indicates that the number of subwatersheds and the watershed delineation model can substantially affect swat estimations this result is consistent with a previous study chaubey et al 2005 in which as the number of watersheds increases i e the subwatershed size decreases the average streamflow and nitrate load decreases fig 6 b and c also by comparing sa in its narrow range with its wide range w sa minstream could contribute to increases in the overall total effects due to its high interaction with other factors secondly the uncertainties of input datasets and parameters for the hru creation i e ulucl usoil minsoil minslope minslope and intslope have small impacts on the swat estimations with the ranges of the factors selected thus this application shows that uncertainty in the hru creation has a lesser effect on variations in the swat outputs than any other submodels thirdly the total effects results show that uprec addresses 12 4 and 14 5 of the flow and 5 1 and 3 2 of the no3 variations in the case of the w sa and n sa results respectively which could require stronger consideration of measurement uncertainty of precipitation in swat applications finally this analysis reconfirms that certain swat parameters are the other important uncertainty sources in swat outputs according to high values in their main and total effects indices as known in previous studies e g abbaspour et al 2007 cn2 scs runoff curve number for moisture condition has an influence on both flow and no3 and rcn and nperco have impacts on no3 only however the hru management option for example fertilizer management including types and amount of fertilizers may have considerable impacts on no3 output but this analysis did not specify the related management options 6 conclusion a wide range of sources of uncertainty and their relative importance were examined in the context of an integrated spatially distributed environmental model based on a swat application in the minjiang river watershed in sichuan china this paper identified the strength of uncertainty sources with respect to watershed delineation hru creation and swat execution thereby addressing the uncertainty of model structure through uncertainties of the input parameters and datasets in these submodels with the ranges of the factors explored results of our analysis show that the uncertainty of the stream network precision minstream and certain swat parameters e g cn2 scs runoff curve number for moisture condition gw delay ground water delay time and esco soil evaporation compensation factor for the flow output and rcn nitrogen in rain nperco nitrate percolation coefficient and cn2 for no3 as well as the measurement uncertainty of precipitation are the most critical factors for the swat predictions importantly among various uncertainty sources related to the submodels the stream network precision has a strong influence on both the variations of water quantity and quality estimations because it has a profound effect on watershed delineation and specifically determines the overall sizes of subwatersheds in addition the stream network precision propagates influences on factors in subsequent submodels thus this analysis shows that selecting an appropriate spatial scale to describe underlying subwatersheds can be a fundamentally important step for swat modelling furthermore this study illustrates the inherent spatial scale of a spatial input dataset in spatially distributed environmental models needs to be considered as a source of uncertainty i e a factor of in the sa analysis this article aims to contribute to sa practice considerations more widely beyond swat to the implications for spatially distributed environmental models specifically the framework of sa examined in this paper provides a solid starting point for subsequent analyses of various spatially distributed integrated watershed models although this analysis was conducted specifically using a swat application other environmental models e g storm water management model swmm rossman 2010 may contain similar kinds of uncertainty sources for example model input datasets and parameters in particular the uncertainty propagation methods used in this analysis for example a propagation model for measurement uncertainty considering its reported accuracy e g srtm and precipitation and for positional uncertainty incorporating the rule of thumb for the positional uncertainty from maps longley et al 2011 would be easily applicable to other spatially distributed environmental models this study has illustrated a more holistic sa process applied to a single geographic region therefore the specific results may not be applicable to other geographical regions that is the uncertainty sources may show different relative importance in other study areas also similar to other sa studies sa results should be carefully interpreted with only selected ranges of prior distributions for corresponding factors the criticality of a factor is determined with the selected ranges of all related factors which should be explained in regard to only the selected ranges however the sa process in this paper is expected to offer guidance for more general swat applications and other spatially distributed environmental model applications another proposed extension relates to achieving more realistic and credible uncertainty propagation models for model input parameters although an uncertainty propagation model has a significant effect on the results of sa the models of the input parameters in the hru creation submodel i e minlu minsoil minslope and intslope might not be realistic the complete possible ranges under a uniform distribution were evaluated here due to the lack of findings from previous studies although they have a small impact on the swat estimations in this application within the complete available ranges an additional evaluation of the impact of the different ranges and or probability distributions on the uncertainty analysis results may be profitable one approach is to apply model emulation to swat which would yield sensitivities to factors throughout their entire range as undertaken in yang et al 2018 this analysis has used a traditional global sa based on spatio temporally aggregated measures e g yearly average streamflow and no3 loads which neglects spatio temporally dynamical behaviors of environmental models gupta and razavi 2018 specifically spatio temporal variations of sa for stream flow can vary under different conditions such as higher precipitation in summer in the study area and thus the use of aggregated measures can provide a limited perspective for sa incorporating spatio temporally varying sa e g generalized global sensitivity matrix approach razavi and gupta 2019 into our sa approach would be helpful to support a better understanding of the dynamic behavior some relatively well known uncertainty sources e g spatial distribution and the number of meteorological monitoring stations resolutions of input spatial datasets were not addressed here although their main effects on swat estimations are relatively well explained the interaction effects of the missing sources with the identified uncertainty sources in this analysis should be investigated finally reliability and convergence tests might be necessary for sa results conducting analysis with different sa methods e g mckay main and two way interaction effect analysis mckay 1995 applied to the current holistic set of factors might be helpful in enhancing the reliability of the results multiple methods help to provide a more complete and robust understanding of critical sources because different sa methods might yield somewhat different results as to the relative importance of factors pappenberger et al 2008 teng et al 2017 due to the fact they either measure different effects or evaluate them in different ways additionally although the extended fast provides guidance on the minimum sample size for its convergence saltelli et al 1999 it would be worth conducting a convergence analysis to enhance the credibility of the sa results e g vanrolleghem et al 2015 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we thank the opengms team from nanjing normal university for their assistance with an automated swat preparation tool this research was supported by the nsf for excellent young scholars of china grant 41622108 the national basic research program of china grant 2015cb954103 and the priority academic program development of jiangsu higher education institutions grant 164320h116 appendix the morris screening method morris 1991 was applied to swat parameters to select critical uncertainty sources on streamflow designated as flow and nitrate no3 based on the morris screening results i e the absolute mean and standard deviation of their elementary effects these following six swat parameters were chosen for the subsequent extended fast analyses v alpha bf gw v gw delay gw r cn2 mgt v esco hru v rcn bsn and v nperco bsn fig a 1 table a 1 lists the candidate swat parameters and their ranges the candidate parameters are relative well known to be sensitive to streamflow and nitrate loads abbaspour et al 2007 and their ranges follow standard levels of swat model parameterization abbaspour 2015 yang et al 2018 the notation v or r in the factor names denotes a replacement or a relative change respectively to their initial values all parameters are globally applied into replacement and change into the entire study area yang et al 2007 refer to the swat documentation for additional descriptions of the swat parameters neitsch et al 2011 fig a 1 the morris screening results a flow and b no3 fig a 1 table a 1 candidate swat parameters and their ranges table a 1 no factor range swat parameter 1 v alpha bf gw 0 1 alpha bf baseflow alpha factor 2 v canmx hru 0 1 1 canmx maximum canopy storage mm h2o 3 v ch k2 rte 0 500 ch k 2 effective hydraulic conductivity in the main channel alluvium mm hr 4 v ch n2 rte 0 0 3 ch n 2 manning s n value for the main channel 5 r cn2 mgt 0 15 0 15 cn2 scs runoff curve number for moisture condition 6 v erorgn hru 0 5 erorgn organic n enrichment for sediment 7 v esco hru 0 1 esco soil evaporation compensation factor 8 v gw delay gw 0 500 gw delay ground water delay time day 9 v gwqmn gw 0 1000 gwqmn threshold water level in shallow aquifer for baseflow mm 10 v nperco bsn 0 01 1 nperco nitrate percolation coefficient 11 v rcn bsn 0 2 5 rcn nitrogen in rain mg n l 12 v revapmn gw 0 500 revapmn threshold depth of water in shallow aquifier for revap mm 13 v sftmp bsn 1 1 sftmp snowfall temperature c 14 v smtmp bsn 1 1 smtmp snow melt base temperature c 15 r sol awc sol 0 25 0 25 sol awc soil available water storage capacity mm h2o mm soil 16 v surlag bsn 0 24 surlag surface runoff lag time day 
26031,environmental models have a key role to play in understanding complex environmental phenomena in space and time although their inherent uncertainty and non identifiability are being increasingly recognized with the development and application of various methods a more holistic analysis of all sources of model uncertainty is warranted this paper addresses sources of uncertainty from various types of input datasets and model parameters including those related to model structure assumptions using a soil and water assessment tool swat application for the minjiang river watershed china the holistic uncertainty sources in the swat application are summarized and a sensitivity analysis sa is applied to examine the relative importance of the uncertainty sources influencing average streamflow and the load of nitrate the analysis reveals that uncertainties related to the stream network precision and certain swat parameters are the most critical factors furthermore building upon our sa framework to consider uncertainty sources more holistically would provide a good starting point for subsequent sa of spatially distributed environmental models in general keywords uncertainty sensitivity analysis water quality swat watershed delineation hydrological response unit identifiability 1 introduction deterministic environmental models offer useful methods for exploring problems providing predictions and supporting decisions that involve complex environmental phenomena evolving in space and time it has become increasingly recognized however that these models are almost always non identifiable guillaume et al 2019 in the sense that the quantity and quality of data are insufficient to parameterize the models uniquely and that the associated modelling must address a wide range of uncertainties especially those related to predicting the impact of possible management actions accordingly uusitalo et al 2015 review various methods that can be applied to evaluate uncertainty of deterministic model outputs they cover expert assessment model emulation sensitivity analysis sa and use of multiple models arguing that the best method for uncertainty evaluation is determined by the definition of a model and the amount of available information sa is an established approach to model assessment by quantitatively evaluating the change in model output s with respect to changes in model factors usually parameters forcing and other input data a deterministic environmental model can be easily coupled with sa based on monte carlo type simulation farmer and vogel 2016 sa offers a quantitative evaluation for uncertainty in a model rather than a qualitative evaluation which for example expert assessment does uusitalo et al 2015 although qualitative evaluation could provide additional evidence to further support decision making and might be more efficient when a modeler is well informed in this paper we employ a global method of sa saltelli et al 2008 as opposed to a local method a global method allows one to compute the contribution to output sensitivity over a plausible range of factor values global sa is undertaken here as a useful first step in addressing and understanding the criticality of uncertainty sources see norton 2015 for an overview of methods and crosetto and tarantola 2001 gan et al 2014 tong 2015 by assessing those factors and their plausible range of values that dominate changes in model outputs understanding the criticalities can then be valuable for undertaking an uncertainty analysis in the traditional probabilistic sense for example where one assumes prior distributions of parameters and finds posterior distributions based on some measure of likelihood as indicated in the literature review of section 2 previous approaches to sa tend to address only a modest set of the sources of uncertainty for spatially distributed environmental models the aim of this article is to illustrate how a more holistic sa approach to spatially distributed environmental models can be used to identify their critical sources of uncertainty which would subsequently allow focus on them for more specific uncertainty analysis and even its reduction the soil and water assessment tool swat neitsch et al 2011 is used as an archetypal example as it is the most frequently used water quantity quality model fu et al 2019 ray 2018 it is also a typical example of the type of uncertainties that need to be considered in a spatially distributed environmental model the global sa approach undertaken is more complete than previous sa studies on spatially distributed environmental models in the sense that it attempts to address model structure uncertainty in combination with the usual model parameter and data uncertainties and examines impact on average streamflow as well as water quality outputs thus this article addresses the uncertainty of model structure input parameters related to the submodels of a swat application i e watershed delineation and hydrological response unit hru characteristics it also explores the measurement uncertainty of the digital elevation model dem i e its vertical accuracy and the uncertainty of boundaries of classes in land use land cover lulc and soil datasets crosetto and tarantola 2001 goodchild and guoqing 1992 because they have a profound effect on watershed delineation oksanen and sarjakoski 2005 wu et al 2008 and hru creation respectively another aspect investigated is the impact of measurement errors in meteorological information on model outputs finally the sa is also applied to the model parameters investigated as has been the primary focus in the past e g setegn et al 2010 wu and liu 2012 yang et al 2018 zhao et al 2018 some of which relate to model structure assumptions clearly while it is not possible to investigate all model structure assumptions as these can be innumerable in an environmental modelling exercise it is acknowledged that expert assessment is a key complementary and qualitative method that can be used to justify other model structure assumptions in relation to uncertainty o hagan 2012 uusitalo et al 2015 our sa approach could therefore be followed up with a formal uncertainty analysis to help in setting the range of prior distributions and fixing unimportant factors which is especially important when sampling needs to be limited because of high computational demands of the environmental model the remainder of this article is organized as follows section 2 contains a literature review and key qualitative findings of previous sa studies on the swat model section 3 briefly explains swat and the extended fourier amplitude sensitivity test fast method which is the global sa method undertaken here then in section 4 the detailed holistic sa process is reported with our swat application to the minjiang river watershed in sichuan china this analysis follows a general process of sa cheng et al 2014 gan et al 2014 identifying uncertainty sources associated with submodels in swat and propagating the uncertainty from the identified source results of analyzing the uncertainty sources using sa appear in section 5 specifically this article identifies uncertainty sources related to model structure input parameters and datasets as well as general model parameters then uncertainty propagation methods are utilized with respect to the corresponding uncertainty sources for spatial input datasets the measurement uncertainty of a dem is propagated using a sequential gaussian simulation to represent spatially autocorrelated uncertainty goovaerts 1997 pebesma 2004 and the boundary uncertainties of lulc and soil datasets are simulated by adopting the epsilon band approach crosetto and tarantola 2001 shi 1998 the sa evaluates the relative importance of the uncertainty sources in the average streamflow flow and loads of nitrate no3 this article concludes in section 6 with a discussion on future work that could profitably be conducted in relation to our analysis 2 previous sa studies on swat there has been too little attention given to sensitivity analysis of spatially distributed models that focuses on a wide range of uncertainties especially the influence of model structure assumptions in illustration this section explores limitations of previous sa studies for the water quantity quality model known as swat partly because it provides a typical example of the limitations of previous sensitivity studies with respect to a spatially distributed environmental model swat requires various model input datasets and parameters some of these factors are related to model structure uncertainty as in its sequential submodels for these prerequisite processes including spatial input datasets e g dem lulc and soil datasets for watershed delineation and hru creation although the submodels for these prerequisite processes can be considered as important sources of uncertainty that have interactions with the uncertainty of other submodels as well as impacts on swat outputs sa related studies remain incomplete in terms of addressing all sources of uncertainty especially those related to spatial input datasets and parameters for the submodels thus in swat applications sa has primarily been conducted with respect to swat parameters e g setegn et al 2010 yang et al 2018 in general they have found that only a few parameters have been identified in applications to be the major sources of uncertainty with other parameters having minor influence kumar and merwade 2009 li et al 2010 shen et al 2008 however model input parameters related to other submodels e g watershed delineation and hru creation have received relatively less sensitivity and uncertainty attention although the potential impacts of the parameters of these submodels have been recognized fitzhugh and mackay 2000 rouhani et al 2009 fitzhugh and mackay 2000 for example with an application in the pheasant branch watershed in dane county wisconsin reported that the size of a watershed has no critical impact on streamflow and outlet sediment estimation conversely another study rouhani et al 2009 involving a swat application in the grote nete river watershed in belgium revealed that streamflow estimation is more accurate with respect to its observed value when a larger watershed size is employed these uncertainties of the parameters can be partially related to the model structure uncertainty matott et al 2009 which is caused by the inability of the model structure to represent watersheds and hrus in particular investigating the uncertainty of the parameters related to subwatershed sizes helps to address a scale issue in the model which is one major aspect of the model structure uncertainty butts et al 2004 by exploring the different levels of abstracting and generalizing of process levels uncertainty related to meteorological input datasets has been considered an important uncertainty source in swat modelling e g aouissi et al 2013 strauch et al 2012 tasdighi et al 2018 with respect to both sampling villarini et al 2008 and measurement errors ciach 2002 among the uncertainties related to meteorological information the impact of the density of meteorological monitoring stations on swat predictions has received some attention which is related to sampling uncertainty the uncertainty of swat predictions has been shown to substantially increase with an excessive reduction in the number of meteorological monitoring stations until a certain threshold value bárdossy and das 2008 chaplot et al 2005 correspondingly cho et al 2009 reported an exponential increase in the uncertainty of swat predictions with a decreasing number of meteorological monitoring stations in addition swat allocates meteorological information from the nearest station to the center of subwatersheds aouissi et al 2013 masih et al 2011 scherer et al 2015 which can be also considered a source of uncertainty in swat output estimation thus advanced interpolation methods for meteorological information allocation have been developed to increase the accuracy of swat estimations masih et al 2011 strauch et al 2012 however the impact of measurement uncertainty in meteorological information on swat output estimation is rarely investigated although measurement uncertainty has also been recognized as a source of uncertainty shen et al 2015a spatial input datasets e g dem lulc and soil datasets which tend to be static over time should also be investigated for their effects on uncertainty although these spatial input datasets are the most important inputs to delineate watersheds and are critical in describing underlying watershed characteristics ray 2018 shen et al 2015a their uncertainty has been only partially examined the resolutions of spatial input datasets have been the main focus of previous studies e g chaubey et al 2005 dixon and earls 2009 lin et al 2013 shen et al 2013 specifically dixon and earls 2009 showed that the resolution of a dem has a significant impact on streamflow volume estimation and watershed delineation e g size and number of subwatersheds and average slopes with three different dem resolutions i e 30 90 and 300 m similarly chaubey et al 2005 found that a coarser dem resolution in a comparison of seven different dem resolutions yields decreased streamflow and nitrate load estimations due to a decrease in subwatershed sizes and slopes lin et al 2013 also reported decreasing total phosphorus and nitrogen load accuracy with coarser dem resolutions in addition the resolutions of lulc and soil datasets affect hru creation in swat which can yield uncertainty in watershed attribute properties and streamflow estimation kumar and merwade 2009 shen et al 2013 demonstrated the existence of a threshold resolution of spatial input datasets i e dem and lulc where a finer resolution did not benefit the accuracy of swat predictions furthermore the resolutions of the spatial input datasets can balance each other for example when the dem in a finer resolution than a threshold value is provided in swat the resolution of lulc becomes less important shen et al 2015a we contend that previous sa approaches have tended to evaluate only a modest set of the uncertainty sources in spatially distributed environmental models especially in hydrology as illustrated above for the widely used swat model a more holistic sa approach for swat would therefore be conducted with a focus on the following aspects firstly although the uncertainty of model input parameters related to the submodels of a swat application e g watershed delineation and hru creation have been partially addressed their impacts on swat predictions are rarely examined secondly the impact of measurement errors in meteorological information e g precipitation wind speed solar radiation relative humidity and temperature has been poorly evaluated in swat estimations even though meteorological information is considered as a critical source of uncertainty finally the uncertainty of spatial input datasets has several strands that warrant investigation in sa exercises one is the uncertainty of spatial data due to lineage positional accuracy attribute accuracy logical consistency and completeness ansi 1998 koo et al 2017 only the impact of spatial dataset resolution has been examined in swat applications other main sources of uncertainty in spatial datasets due to positional e g boundary uncertainty and attribute e g measurement uncertainty accuracy should also be considered in swat estimations 3 methods 3 1 swat swat is a watershed model that was developed by the agricultural research service of the u s department of agriculture usda neitsch et al 2011 swat has been extensively applied in various sectors including water management hydrology climate change land use impact and pollution to predict the environmental impacts e g land use and climate change on water quantity and quality to implement sa for swat applications bastin et al 2013 this paper uses a tool for automated swat preparation zhang et al 2019 which is based on an open source geographic information system gis interface for swat mwswat george and leon 2008 and implements the sa based on the sensitivity analysis package in r pujol et al 2018 3 2 the extended fast method sa methods are broadly classified as screening local and global methods saltelli et al 2004 our analysis applies the extended fast method saltelli et al 1999 to evaluate the uncertainties associated with model parameters and input datasets i e factors and their interactions because the factors are not independent and typically interact with one another the extended fast is one of the sa variance decomposition methods the variance decomposition method evaluates the sensitivity of the model output using sensitivity indices sobol 2001 which compute the fractional contributions of input uncertainty x i to the variance in the model output y this variance is defined as 1 v i 1 v i i j v i j v 1 2 d where v i v e y x i v i j v e y x i x j v i v j e y x i denotes the conditional expected value of y on x i and v represents a conditional variance the main effect index s i and the first order interaction effect s i j can be represented as follows 2 s i v i v 3 s i j v i j v the main effect index quantifies the effect of only x i over the averaged variations in other factors and is scaled by the total variance to represent the fractional contribution the total effect index s t i can be defined as 4 s t j 1 v e y x i v where x i is the subset of all elements x except x i the main and the total effect indices are generally used to determine critical factors and to screen out uncritical factors respectively yang et al 2018 this study explores the uncertainty caused by each factor i e model input datasets and parameters as shown in table 1 on swat estimations and their interactions to understand the uncertainty effects across its submodels however an alternative solution is necessary to quantify interaction effects because a vast number of indices which is 2 n 1 with n factors needs to be estimated to represent all interaction effects among factors the extended fast can be an alternative saltelli et al 1999 because it furnishes only the estimates of both the main and total effects because the total effect indices include a main effect and all higher order interaction effects related to specific factors an interaction effect can be distinguished by subtracting the main effect index from the total effect index additionally the extended fast is known to show better efficiency than the sobol method which is another extensively employed sensitivity method gómez delgado and tarantola 2006 the sampling technique for the extended fast method is fixed which converts a multi dimensional integral to a one dimension integral gan et al 2014 after the number of factors is determined the minimum sample size n s for the extended fast is not changeable gan et al 2014 and is calculated by the following saltelli et al 1999 5 n s n r 2 m ω i 1 where m denotes the interference factor set to 4 in this analysis ω i represents the frequency assigned to the factor of interest and n r is the number of resamplings for 15 factors the ω i and n r are set to 143 and 3 in order to keep the ratio ω i n r within 16 and 64 which is an optimal region for convergence of sa indices saltelli et al 1999 following this recommendation the sample size in this analysis is determined as 3 435 4 application 4 1 study area and datasets this study illustrates a more holistic sa approach to spatially distributed environmental models with a swat example in a subset of the minjiang river watershed the minjiang river watershed is located in the upper part of the yangtze river basin and the subset of the watershed in this analysis covers approximately 12 893 km2 fig 1 the minjiang river is the largest tributary of the upper yangtze river and supplies water to downstream regions for agriculture e g chengdu and its neighbors this watershed is highly vulnerable to climate change due to its high elevation which ranges from 1 627 to 5 419 m thus the minjiang river watershed has been a high priority for developing and conserving the yangtze river regions cui et al 2012 as previously indicated swat requires spatial input datasets e g dem lulc and a soil dataset and meteorological input datasets e g precipitation wind speed relative humidity and solar radiance for its execution this study has conducted analyses using commonly available spatial input datasets and meteorological input datasets george and leon 2008 to ensure that its findings are readily applicable to other studies the dem was obtained from the nasa srtm version 4 1 which was published by the consultative group on international agriculture research consortium for spatial information cgiar csi with a spatial resolution of 3 arc second approximately 90 m jarvis et al 2008 the source of the lulc is based on the global land cover characterization glcc database loveland et al 2000 and the soil dataset was obtained from the food and agriculture organization of the united nations fao unesco 2003 both the lulc dataset and the soil dataset are published in waterbase george and leon 2008 with spatial resolutions of 500 m and 600 m respectively the meteorological dataset was obtained using the national center for environmental prediction ncep climate forecast system reanalysis cfsr fuka et al 2014 in 2013 this study utilizes meteorological information from only one monitoring station to focus on the measurement uncertainty of meteorological information and avoid uncertainty produced by the numbers and locations of monitoring stations strauch et al 2012 4 2 identifying sources of uncertainty a swat application consists of three sequential submodels watershed delineation hru creation and swat execution each model requires separate model input datasets and parameters which can be considered sources of uncertainty table 1 first in the watershed delineation a minimum threshold value is necessary for this analysis to designate drainage to a stream network minstream although a predefined stream network dataset can be superimposed on a dem for accurate stream network delineation e g setegn et al 2010 the predefined dataset should have a different precision depending on its target scale and or scale of its source map thus this analysis directly generates a stream network from the dem to consider the uncertainty of the stream network precision this stream network precision is directly related to the overall sizes of subwatersheds which can partially address a scale issue in spatial datasets chrisman 1991 second the dem is required to delineate watersheds as a model input dataset previous studies have primarily addressed the impact of dem resolution on swat estimations e g chaubey et al 2005 dixon and earls 2009 shen et al 2013 a dem also contains systematic and random errors due to an inherent elevation measurement error whose impact on watershed delineation has been investigated hengl et al 2010 oksanen and sarjakoski 2005 wu et al 2008 thus the measurement error of dem udem can have an influence on swat estimations second the hru creation model requires additional model input datasets i e lulc and soil datasets because hrus are generally formed as a combination of lulc soil and slope ranges these datasets can be considered sources of uncertainty in this submodel swat classifies slope range on an ordinal scale for simplification of this analysis the slope range is divided into two groups based on the intermediate value of slope as a percentage then the intermediate value of the two groups intslope is used as a model input parameter which can be a source of uncertainty however a slope dataset itself is not considered a source of uncertainty in this analysis because a slope dataset is directly generated from the uncertainty propagated dem additionally input parameters of three models are required to define multiple hrus in a watershed the model parameters are used to eliminate small hrus by considering minimum percentages for the categories of lulc minlu soil minsoil and slope minslope lastly the meteorological input dataset and swat parameters can be sources of uncertainty the meteorological input dataset includes precipitation temperature wind speed and solar radiation as well as information about meteorological monitoring station locations for simplicity this analysis considers only uncertainty in precipitation uprec because the uncertainty of precipitation is known to generally have a greater influence on swat estimations than any other meteorological input datasets chaplot et al 2005 strauch et al 2012 specifically a measurement error in precipitation is the main interest in this analysis and the positional uncertainty of monitoring stations for precipitation measurement is not evaluated because previous studies have adequately addressed this aspect e g bárdossy and das 2008 chaplot et al 2005 fu et al 2011 with regard to swat parameter uncertainty only a few significant parameters see the appendix are selected and applied here in the sa to reduce the computational cost and to concentrate on other factors e g minstream and uprec although swat applications typically consist of hundreds of model parameters neitsch et al 2011 pp 567 595 4 3 propagating the identified uncertainty sources obtaining a proper uncertainty propagation model especially with plausible range and distributional assumptions is a crucial process in sa the propagation model primarily reflects the degree of uncertainty in model inputs and determines the impact on the uncertainty of model output generally a scalar random variable e g model input parameters can be simply represented using a probability density function however complex types of model inputs e g spatial input datasets require a more complex uncertainty propagation model by simultaneously considering various components of uncertainty crosetto and tarantola 2001 this study introduces various propagation models for the corresponding uncertainty sources with their justification for watershed delineation two sources of uncertainty were identified in the previous section udem and minstream generating the uncertainty propagation model for udem is a challenge due to the complexity of the dem and the existence of spatial autocorrelation in the dem measurement errors temme et al 2009 thus a limited number of relevant studies have been conducted e g fisher 1998 hengl et al 2010 holmes et al 2000 to describe the spatially correlated structure of udem this study constructs its uncertainty propagation model based on a sequential gaussian simulation goovaerts 1997 pebesma 2004 then the propagated values of udem are scaled based on a normal distribution to reflect the realistic range of measurement uncertainty in udem the value of the scale parameter which indicates the accuracy i e difference to the true value at a 95 confidence level determines the level of uncertainty in udem the scale parameters are uniformly distributed in the range between 0 and 16 because the total vertical accuracy in an srtm v4 1 dataset with a 3 arc second resolution is 16 m at a 95 confidence level mukul et al 2017 lastly the generated values of udem are added to the original dem fig 2 shows examples of the uncertainty propagation model of udem with the scale parameter values of 4 8 and 16 another source of uncertainty in watershed delineation is minstream which is a critical parameter for determining the precision of a stream network minstream is simply modelled here based on a uniform distribution because it is represented as a scalar random variable because minstream parameter uncertainties have not been fully considered in previous sa studies and is the critical parameter to determine spatial scales of a subwatershed this parameter is examined with two different ranges the uncertainty associated with minstream is modelled by changing its uniformly distributed values in the range between 5 000 and 15 000 and 10 000 15 000 by considering widely available spatial datasets for stream networks specifically the generated stream network from the minstream value of 15 000 approximately corresponds to the stream network in the 1 1 000 000 vector map i e vmap0 and that from the value of 5 000 shows slightly coarser stream network than the 1 250 000 topographic map i e joint operations graphic jog fig 3 illustrates examples of the stream network generation with minstream values of 5 000 10 000 and 15 000 in fig 3 the precision of the generated stream network tends to decrease when minstream is increased for instance by increasing minstream an exponential decrease in the line feature counts of the generated stream networks fig 3 which are 189 89 51 features for minstream values of 5 000 10 000 and 15 000 respectively is observed minstream also relates strongly to overall size and number of subwatersheds an increase in minstream would lead to an increase in the number of subwatersheds and a decrease in the overall size in the hru creation submodel uncertainty propagation models were generated for the following uncertainty sources which have associated model input datasets i e lulu ulucl and soil datasets usoil and model input parameters i e minlu minsoil minslope and intslope ululc and usoil require an uncertainty propagation model that differs from the previous uncertainty propagation model for udem it is noted however that lulc soil datasets and dem are the same as raster datasets because they are represented on a different measurement scale i e lulc and soil datasets are categorical raster datasets but the dem is a quantitative raster dataset heuvelink 1998 this study constructs the uncertainty propagation models for ulucl and usoil by adopting the concept of the epsilon band which was originally developed for vector data to represent boundary uncertainty crosetto and tarantola 2001 shi 1998 ulucl is modelled using a uniformly distributed band within 2 000 m on both sides because lulc is generated based on a 1 km monthly advanced very high resolution radiometer avhrr satellite image similarly usoil is modelled within 2 500 m on both sides by adopting the rule of thumb for the positional uncertainty from maps longley et al 2011 which represents the maximum uncertainty of 0 5 mm at the sources of the soil dataset i e soil map of the world at 1 5 million because the uncertainty propagation models of minlu minsoil minslope and intslope have not been fully investigated in previous research all possible ranges of the parameters are examined here by assuming a uniform distribution minlu minsoil minslope and intslope were given the ranges of 5 42 5 50 5 50 and 0 05 0 8 respectively table 2 we now address the uncertainty propagation models used for uprec and the swat parameters for swat execution firstly the uncertainty propagation model for uprec is constructed based on a uniform distribution in the range 15 2 15 2 with a relative change to its observed precipitation this range reflects the maximum measurement error of precipitation in china which varies from 4 34 to 15 2 with a mean of 6 52 in china according to the state meteorological administration ren et al 2003 shen et al 2015b for the swat parameters we chose the more sensitive swat parameters using the morris screening method morris 1991 among the candidate swat parameters acquired from the swat model calibration literature e g abbaspour 2015 abbaspour et al 2007 yang et al 2018 appendix also the ranges of the swat parameters table a 1 follow standard levels in swat model calibrations and sa studies in the absence of better information the selected parameters in accordance with their swat parameter names are the following alpha bf gw delay cn2 esco rcn and nperco briefly alpha bf and gw delay are used to describe the properties of groundwater and cn2 is the type of hru management option which includes land and water management practices esco is related to the hru general input file and describes diverse features within hrus rcn and nperco are utilized to define general watershed attributes which are expected to be sensitive factors for nitrate outputs no3 finally table 2 describes all selected parameters and their uncertainty propagation models that are used in the following sensitivity analyses refer table a 1 for further detail of swat parameters 5 results of analyzing the uncertainty sources through sa this analysis evaluates the impacts of the fifteen factors on variations in the two swat output estimates considered i e flow and no3 at the outlet of the minjiang river watershed refer to fig 1 firstly the impacts of the fifteen factors on flow are evaluated in terms of the main and total effect indices using the extended fast fig 4 as we discussed in section 4 3 two different ranges of minstream i e the wide range w sa between 5 000 and 15 000 and the narrow range n sa between 10 000 and 15 000 are applied in the sa for further exploration of this factor for both sa results the main effect shows that five factors have a larger influence than others on the variation in flow minstream cn2 uprec gw delay and esco although in comparing n sa fig 4 b to w sa fig 4 a the main effect of minstream decreases i e minstream 65 8 54 7 and those of other four factors increase i e cn2 6 2 12 5 uprec 5 0 9 4 gw delay 3 3 6 6 and esco 1 8 2 7 the order of their main effects are still consistent the range of generated stream feature counts in n sa is much narrower than those in w sa i e 51 89 and 51 189 respectively see fig 3 but minstream still has the largest influence on flow the main effects of other factors are less than 1 in the total effects for both sa results minstream 77 3 and 64 8 the three swat parameters i e cn2 18 9 and 25 3 gw delay 8 2 and 10 4 esco 9 1 and 10 2 and uprec 12 4 and 14 5 have the greatest influence on flow the difference between the total and main effect indices provides the interaction effect between a factor and other factors comparing n sa fig 4 b to w sa fig 4 a the overall interaction effects especially of the factors related to the hru creation submodel decreases which could suggest that minstream highly interacts with the factors the sa results for no3 show a slightly different relative importance among the fifteen factors compared with the previous results for flow fig 4 with main effect indices minstream 22 0 is still the most critical factor in the w sa result fig 5 a but in the n sa result fig 5 b the swat parameters i e rcn 20 5 nperco 16 7 cn2 14 8 have a larger influence on the no3 variation than minstream 14 7 uprec shows a relatively high value for the main effect index 0 9 and 1 5 in w sa and n sa results respectively whilst the main effects of other factors have still much smaller impacts less than 1 with the interaction effect the no3 results show a similar trend with the previous flow results which is an overall decrease in the interaction effects compared to n sa fig 5 b with w sa fig 5 a in the n sa result the interaction effects for all factors except for the five critical factors are less than 1 we suspect that a decrease in the impact of minstream leads to this decrease in the interaction effects these sa results suggest the following findings firstly the precision of a stream network minstream in the watershed delineation submodel generally has the largest impact on variations in flow and no3 fig 6 shows the relationships among minstream subwatershed count and the estimations of flow and no3 over the wide range of minstream w sa in this analysis minstream shows a significantly negative relationship with the number of generated subwatersheds with a correlation coefficient of 0 975 p value 0 001 fig 6 a which indicates that the number of subwatersheds and the watershed delineation model can substantially affect swat estimations this result is consistent with a previous study chaubey et al 2005 in which as the number of watersheds increases i e the subwatershed size decreases the average streamflow and nitrate load decreases fig 6 b and c also by comparing sa in its narrow range with its wide range w sa minstream could contribute to increases in the overall total effects due to its high interaction with other factors secondly the uncertainties of input datasets and parameters for the hru creation i e ulucl usoil minsoil minslope minslope and intslope have small impacts on the swat estimations with the ranges of the factors selected thus this application shows that uncertainty in the hru creation has a lesser effect on variations in the swat outputs than any other submodels thirdly the total effects results show that uprec addresses 12 4 and 14 5 of the flow and 5 1 and 3 2 of the no3 variations in the case of the w sa and n sa results respectively which could require stronger consideration of measurement uncertainty of precipitation in swat applications finally this analysis reconfirms that certain swat parameters are the other important uncertainty sources in swat outputs according to high values in their main and total effects indices as known in previous studies e g abbaspour et al 2007 cn2 scs runoff curve number for moisture condition has an influence on both flow and no3 and rcn and nperco have impacts on no3 only however the hru management option for example fertilizer management including types and amount of fertilizers may have considerable impacts on no3 output but this analysis did not specify the related management options 6 conclusion a wide range of sources of uncertainty and their relative importance were examined in the context of an integrated spatially distributed environmental model based on a swat application in the minjiang river watershed in sichuan china this paper identified the strength of uncertainty sources with respect to watershed delineation hru creation and swat execution thereby addressing the uncertainty of model structure through uncertainties of the input parameters and datasets in these submodels with the ranges of the factors explored results of our analysis show that the uncertainty of the stream network precision minstream and certain swat parameters e g cn2 scs runoff curve number for moisture condition gw delay ground water delay time and esco soil evaporation compensation factor for the flow output and rcn nitrogen in rain nperco nitrate percolation coefficient and cn2 for no3 as well as the measurement uncertainty of precipitation are the most critical factors for the swat predictions importantly among various uncertainty sources related to the submodels the stream network precision has a strong influence on both the variations of water quantity and quality estimations because it has a profound effect on watershed delineation and specifically determines the overall sizes of subwatersheds in addition the stream network precision propagates influences on factors in subsequent submodels thus this analysis shows that selecting an appropriate spatial scale to describe underlying subwatersheds can be a fundamentally important step for swat modelling furthermore this study illustrates the inherent spatial scale of a spatial input dataset in spatially distributed environmental models needs to be considered as a source of uncertainty i e a factor of in the sa analysis this article aims to contribute to sa practice considerations more widely beyond swat to the implications for spatially distributed environmental models specifically the framework of sa examined in this paper provides a solid starting point for subsequent analyses of various spatially distributed integrated watershed models although this analysis was conducted specifically using a swat application other environmental models e g storm water management model swmm rossman 2010 may contain similar kinds of uncertainty sources for example model input datasets and parameters in particular the uncertainty propagation methods used in this analysis for example a propagation model for measurement uncertainty considering its reported accuracy e g srtm and precipitation and for positional uncertainty incorporating the rule of thumb for the positional uncertainty from maps longley et al 2011 would be easily applicable to other spatially distributed environmental models this study has illustrated a more holistic sa process applied to a single geographic region therefore the specific results may not be applicable to other geographical regions that is the uncertainty sources may show different relative importance in other study areas also similar to other sa studies sa results should be carefully interpreted with only selected ranges of prior distributions for corresponding factors the criticality of a factor is determined with the selected ranges of all related factors which should be explained in regard to only the selected ranges however the sa process in this paper is expected to offer guidance for more general swat applications and other spatially distributed environmental model applications another proposed extension relates to achieving more realistic and credible uncertainty propagation models for model input parameters although an uncertainty propagation model has a significant effect on the results of sa the models of the input parameters in the hru creation submodel i e minlu minsoil minslope and intslope might not be realistic the complete possible ranges under a uniform distribution were evaluated here due to the lack of findings from previous studies although they have a small impact on the swat estimations in this application within the complete available ranges an additional evaluation of the impact of the different ranges and or probability distributions on the uncertainty analysis results may be profitable one approach is to apply model emulation to swat which would yield sensitivities to factors throughout their entire range as undertaken in yang et al 2018 this analysis has used a traditional global sa based on spatio temporally aggregated measures e g yearly average streamflow and no3 loads which neglects spatio temporally dynamical behaviors of environmental models gupta and razavi 2018 specifically spatio temporal variations of sa for stream flow can vary under different conditions such as higher precipitation in summer in the study area and thus the use of aggregated measures can provide a limited perspective for sa incorporating spatio temporally varying sa e g generalized global sensitivity matrix approach razavi and gupta 2019 into our sa approach would be helpful to support a better understanding of the dynamic behavior some relatively well known uncertainty sources e g spatial distribution and the number of meteorological monitoring stations resolutions of input spatial datasets were not addressed here although their main effects on swat estimations are relatively well explained the interaction effects of the missing sources with the identified uncertainty sources in this analysis should be investigated finally reliability and convergence tests might be necessary for sa results conducting analysis with different sa methods e g mckay main and two way interaction effect analysis mckay 1995 applied to the current holistic set of factors might be helpful in enhancing the reliability of the results multiple methods help to provide a more complete and robust understanding of critical sources because different sa methods might yield somewhat different results as to the relative importance of factors pappenberger et al 2008 teng et al 2017 due to the fact they either measure different effects or evaluate them in different ways additionally although the extended fast provides guidance on the minimum sample size for its convergence saltelli et al 1999 it would be worth conducting a convergence analysis to enhance the credibility of the sa results e g vanrolleghem et al 2015 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we thank the opengms team from nanjing normal university for their assistance with an automated swat preparation tool this research was supported by the nsf for excellent young scholars of china grant 41622108 the national basic research program of china grant 2015cb954103 and the priority academic program development of jiangsu higher education institutions grant 164320h116 appendix the morris screening method morris 1991 was applied to swat parameters to select critical uncertainty sources on streamflow designated as flow and nitrate no3 based on the morris screening results i e the absolute mean and standard deviation of their elementary effects these following six swat parameters were chosen for the subsequent extended fast analyses v alpha bf gw v gw delay gw r cn2 mgt v esco hru v rcn bsn and v nperco bsn fig a 1 table a 1 lists the candidate swat parameters and their ranges the candidate parameters are relative well known to be sensitive to streamflow and nitrate loads abbaspour et al 2007 and their ranges follow standard levels of swat model parameterization abbaspour 2015 yang et al 2018 the notation v or r in the factor names denotes a replacement or a relative change respectively to their initial values all parameters are globally applied into replacement and change into the entire study area yang et al 2007 refer to the swat documentation for additional descriptions of the swat parameters neitsch et al 2011 fig a 1 the morris screening results a flow and b no3 fig a 1 table a 1 candidate swat parameters and their ranges table a 1 no factor range swat parameter 1 v alpha bf gw 0 1 alpha bf baseflow alpha factor 2 v canmx hru 0 1 1 canmx maximum canopy storage mm h2o 3 v ch k2 rte 0 500 ch k 2 effective hydraulic conductivity in the main channel alluvium mm hr 4 v ch n2 rte 0 0 3 ch n 2 manning s n value for the main channel 5 r cn2 mgt 0 15 0 15 cn2 scs runoff curve number for moisture condition 6 v erorgn hru 0 5 erorgn organic n enrichment for sediment 7 v esco hru 0 1 esco soil evaporation compensation factor 8 v gw delay gw 0 500 gw delay ground water delay time day 9 v gwqmn gw 0 1000 gwqmn threshold water level in shallow aquifer for baseflow mm 10 v nperco bsn 0 01 1 nperco nitrate percolation coefficient 11 v rcn bsn 0 2 5 rcn nitrogen in rain mg n l 12 v revapmn gw 0 500 revapmn threshold depth of water in shallow aquifier for revap mm 13 v sftmp bsn 1 1 sftmp snowfall temperature c 14 v smtmp bsn 1 1 smtmp snow melt base temperature c 15 r sol awc sol 0 25 0 25 sol awc soil available water storage capacity mm h2o mm soil 16 v surlag bsn 0 24 surlag surface runoff lag time day 
26032,this work presents a software platform to compute depth integrated non hydrostatic coastal and open channel flows the software is based on the vertically averaged and moment vam equations model the vam model uses the weighted residual method to account for the non hydrostaticity and non uniformity of flow after presenting the governing equations numerical scheme and structure of the graphical user interface the software is applied to solve coastal and open channel flow tests with significant non hydrostaticity and non uniformity of flow the results are compared with hydrostatic model computations and laboratory measurements where a hydrostatic based simulation poorly reproduces experimental observations the higher order model equations by this software platform generate excellent predictions these findings highlight the potential of this user friendly software platform for modeling open channel river and nearshore flows and processes where non hydrostatic pressure and non uniform velocity shall be accounted for which entails a meaningful advance for the hydraulic community keywords non hydrostatic flows depth integrated model software platform coastal applications open channel tests 1 introduction most of the user friendly models used for the simulation of open channel flows are based on the solution of the saint venant equations where it is assumed that the distribution of fluid pressure is hydrostatic and the vertical distribution of the velocity component in the direction of motion is uniform u s corps of engineers 2002 bladé et al 2014 teng et al 2017 in free surface flows with a vertical length scale negligible as compared to the horizontal one the saint venant based models provide accurate approximations however in open channel transitions near hydraulic structures in dam break waves over movable beds in eroded granular dikes by overtopping or in river flows with a significant variation of bottom topography among others the variation of the vertical velocity is non negligible and the vertical acceleration is therefore non zero thus the pressure distribution is non hydrostatic with non negligible dispersive effects in the equations of motion castro orgaz and hager 2017 the inclusion of such dispersive effects in a vertically averaged framework allows to accurately solve a large portfolio of river and coastal flow processes kim and lynett 2011 castro orgaz and hager 2017 cantero chinchilla et al 2018a 2018b coastal flows are typically simulated by using boussinesq type solvers such as the short waves module in mike21 warren and bach 1992 or the celeris model tavakkol and lynett 2017 the dam break flood waves in rivers and the flow in the surf zone and the swash region are important examples of non hydrostatic flows where boussinesq equations have been extensively applied brocchini and peregrine 1996 yamazaki et al 2009 cantero chinchilla et al 2016 the use of non hydrostatic models is required to provide realistic predictions in these flows wei and jia 2014a 2014b albeit with a significant penalty in the numerical treatment of dispersive terms due to the presence of higher order derivatives of the depth averaged velocity field castro orgaz and hager 2017 however given the still high computational cost of three dimensional non hydrostatic models for large scale simulations e g in a river basin the development and use of depth integrated simulation models where the vertical coordinate is removed from the governing equations is a common practice for non hydrostatic modelling zijlema and stelling 2005 2008 yamazaki et al 2009 bai and cheung 2013 wei and jia 2013 aissiouene et al 2015 escalante et al 2018 among others essentially three families of vertically averaged models have been developed so far to simulate non hydrostatic flows the most widely used family is known as boussinesq type equations this family considers the non hydrostaticity through the inclusion of additional dispersive terms in the governing equations demanding the numerical discretization of high order velocity derivatives madsen et al 1991 madsen and sørensen 1992 peregrine 1966 brocchini 2013 castro orgaz and hager 2017 the issue of increasing the order of spatial derivatives in a model appears subtle but getting a robust solver when discretizing spatial derivatives of higher order than two is a formidable task when dealing with dam break like numerical simulations another different although related family is the non hydrostatic extension of the shallow water equations which is based on a multilayer discretization of layer averaged reynolds averaged navier stokes rans equations stansby and zhou 1998 casulli 1999 zijlema and stelling 2005 fernandez nieto et al 2018 escalante et al 2019 although both boussinesq equations and multilayer models are very useful tools each one has its own disadvantages the presence of high order derivatives in the boussinesq equations and the increased computational cost by increasing the number of layers to simulate a flow in the multilayer models finally there is a third family of vertically averaged models for the prediction of non hydrostatic flows steffler and jin 1993 khan and steffler 1996a 1996b which is based on the use of the weighted residual method to derive the vertically averaged and moment equations from the rans equations the modelling system of equations is known as vertically averaged and moment vam equations model cantero chinchilla et al 2018a the weighting function φ 2 z z h is used in the vam model to derive the moment equations while applying the weighted residual method where z is the elevation of the centroid of a section z z b h 2 the vam model is a physical system of equations that is still unfamiliar to the scientific community to some extent it was developed by steffler and jin 1993 and then solved by khan and steffler 1996a 1996b for flows in weirs and spillways producing extremely accurate results for non hydrostatic flows apparently publication of these results in hydraulics journals discouraged the use of vam models by numerical modellers who in this branch of science routinely apply saint venant equations the increased numbers of equations to solve in the vam equations and the apparent complexities in their structure when compared to saint venant equations unfairly relegated the use of vam equations to a few isolated works conducted by their development team however complexities of a model are not in the number of equations to solve but rather on the mathematical structure of the terms to discretize in this regard the highest order derivative in the vam equations is of order one which defines a system of first order partial differential equations this feature is attractive from the view point of numerical discretization since higher order derivatives are absent discretization of dispersive terms is implicit for stability of the elliptic step of the solver while the hyperbolic step is explicit and subject to the courant friedrich lewy condition cfl 1 despite the vam model was recently demonstrated to be extremely accurate predicting a number of river and coastal flows cantero chinchilla et al 2018a we acknowledge that the apparent complexities of the vam model are a penalty in terms of its diffusion and use by peers since the development and application of the vam equations and numerical schemes are time consuming and not immediate tasks therefore the motivation of this paper is to present a user friendly software platform that easily allows the application of the vam model to simulate non hydrostatic flows in a number of coastal and open channel flow cases first the governing equations and numerical scheme of the vam model are shown in section 2 then the structure of the graphical user interface gui and the tests included in the software platform are described in section 3 section 4 shows several applications of the software platform finally the conclusions of the work are summarized in section 5 the vam model software platform is freely available on github https github com frncch vam model software and the matlab scripts of the vam model are provided as supplementary material to this paper 2 theoretical and numerical basis of the vam model 2 1 governing equations the governing equations of the one dimensional 1d vam model are derived from the vertically averaged rans continuity equation x and z momentum equations and moment of x and z momentum equations steffler and jin 1993 khan and steffler 1996a 1996b they can be expressed in conservative form as follows cantero chinchilla et al 2018a see hydraulic reference manual of the vam model in the supplementary material for a complete derivation of the model equations 1 u t f x s o s τ 2 u u 1 u 2 u 3 u 4 u 5 h q u 1 h w h 2 w 12 f q q 2 h g h 2 2 q u 1 h q w h q w 12 u 2 u 2 2 u 1 g u 1 2 2 u 2 u 3 u 1 u 2 u 4 u 1 u 2 u 5 u 1 3 s o 0 x u 1 2 h 3 h p 1 2 ρ 2 h p 2 3 ρ g h z b x p 1 ρ z b x 1 2 ρ p 1 x p 1 h h x 4 p 2 h ρ z x 1 6 h u 1 w x p 1 ρ h w 2 q x q w h u 1 w 6 z x x h 2 u 1 10 w w b 3 w s 3 h w 2 2 h p 2 3 ρ s τ 0 τ b ρ 0 τ b ρ z b x 1 2 ρ h τ b x h τ b 2 ρ z x z b x where u f and s are respectively the vector of unknowns fluxes and source terms u 1 u 5 are the conservative flow variables related to the conservation laws as follows u 1 continuity equation u 2 x momentum equation u 3 moment of x momentum equation u 4 z momentum equation and u 5 moment of z momentum equation subscripts o and τ refer to the inviscid and the turbulent stress source terms respectively x is the longitudinal coordinate t is the time ρ is the fluid density g is the gravitational acceleration q is the discharge per unit width h is the flow depth u 1 is the x velocity at the free surface in excess of the mean q h z b is the river bed elevation w is the depth averaged z velocity w w s w b 2 2w 2 3 with z as the cartesian vertical coordinate w s is the z velocity at the free surface w b is the z velocity at the bed w 2 is the mid depth z velocity in excess of the average between vertical velocities at the bed and free surface w is the vertical velocity difference between bed and free surface w w b w s p 1 is the bed pressure in excess of the hydrostatic p 2 is the mid depth deviation from the linear non hydrostatic law τ b is the bed shear stress and w 2 w 2 w b 2 12 w s 2 12 w b w s 6 1 20 2 w w b w s 2 equations 1 3 are derived from the general vertically integrated mass momentum and moment of momentum equations modelling the x z velocity components and fluid pressure with distributions containing perturbation parameters u 1 x t w 2 x t p 1 x t and p 2 x t to deviate the flow from hydrostatic conditions with horizontal and depth independent velocity the particular choice used in eqs 1 3 is steffler and jin 1993 khan and steffler 1996a 1996b see hydraulic reference manual of the vam model in the supplementary material for a complete derivation of the model equations 4 u x z t u 0 u 1 2 z z b h 1 5 w x z t w b w 2 4 z z b h 1 z z b h w s z z b h 6 p x z t ρ g h p 1 p 2 4 z z b h 1 z z b h note that the perturbation parameters are functions of x and t but not of the vertical coordinate z to mathematically close the model additional physical statements are required the kinematic boundary conditions at the bed and free surface levels are respectively 7 w b u b z b x q h u 1 z b x 8 w s h t u s z s x q x q h u 1 z b h x where u b and u s are the u velocity components at the bed and free surface respectively two reactive equations i e where temporal derivates of conserved variable are absent are prescribed to provide closure to the system of eqs 1 3 the first is obtained combining eqs 7 8 resulting 9 h 2 w 12 h 2 12 q h u 1 z b x h 2 12 q x h 2 12 q h u 1 z b h x the second is the moment of continuity equation which reads see hydraulic reference manual of the vam model in the supplementary material 10 h w h 2 q x q z x 1 6 h 2 u 1 x the vam model system eqs 1 3 and eqs 9 10 is based on a simple turbulence closure where the normal stresses are neglected and the shear stress is considered to vary linearly between τ b at bed and zero at the surface the latter is modelled using the manning s equation parametrized with the near bed non hydrostatic velocity field cantero chinchilla et al 2018a see also hydraulic reference manual of the vam model in the supplementary material if u 1 w 2 p 1 p 2 0 the vam eqs 1 3 reduce to the saint venant equations in this case the moment equations and the vertical momentum equation are not needed given the lack of perturbation parameters e g only h and q are computed a significant feature of the vam equations as compared to boussinesq equations is that a wave breaking criteria is not needed given that the vertical profile of horizontal velocity u is modelled thereby introducing dissipation into the solution the vam model was demonstrated to produce the transition from solitary wave to broken waves during run up on a beach without any empirical formulation for wave breaking cantero chinchilla et al 2018a if u 1 w 2 p 2 0 the only perturbation parameter retained is p 1 and the vam eqs 1 3 reduce to the vertically averaged equations va by removing the moment equations khan and steffler 1996 the va system of equations is basically equivalent to a boussinesq type system albeit with a different factor affecting the dispersive term cantero chinchilla et al 2016 the vam equations can model with great accuracy dispersive effects up to kh 8 where k is the wave number and h is the still water depth however the accuracy of the va model is acceptable only up to kh 2 steffler and jin 1993 see hydraulic reference manual of the vam model in the supplementary material for a detailed comparison of vam and va models therefore the advantage of the vam model over other types of models such as those based on boussinesq equations is that dispersive effects are modelled with great accuracy up to large kh values and that wave breaking is automatically accounted for by the model equations this comparison is not aimed at discouraging the use of boussinesq type equations which are valuable numerical models by improving their linear dispersion relation and implementing a wave breaking criterion the comparison focuses on presenting the vam equations as a viable alternative to model the same flows showing some of its important features 2 2 numerical scheme the system of eqs 1 7 is solved using a semi implicit hybrid finite volume finite difference numerical scheme cantero chinchilla et al 2018a see supplementary material where the matlab scripts are freely available fundamentals of the numerical method implemented are explained in detail the hydraulic reference manual accompanying the vam code the solution strategy uses a splitting approach the homogeneous part of eq 1 i e with no source terms is solved first in an advection step using a godunov type finite volume scheme the fourth order total variation diminishing monotone upstream centred scheme for conservation laws muscl tvd 4th and the minmod limiter are used to reconstruct the flow variables at the cell interfaces yamamoto and daiguji 1993 kim et al 2009 kim and lynett 2011 cantero chinchilla et al 2016 the weighted surface depth gradient method wsdgm aureli et al 2008 and a discretization of the gravity term in the x momentum equation to grant the c property of the numerical scheme are implemented the numerical flux at the cell interface is determined using the hllc approximate riemann solver toro 2001 2009 in this step the computed flow depth is the final value for the actual time the homogeneous solution is then updated by including the effects of the inviscid terms using a centred implicit finite difference scheme resulting from the application of the backward euler formula the system of algebraic equations is iteratively solved using the newton raphson method the equations resulting from this step are non linear and implicit and for this reason an iterative solver is needed the discretized system of equations and jacobian matrix implemented are described in the hydraulic reference manual accompanying the vam matlab scripts as supplementary material note that in this step the two reactive equations eqs 9 and 10 are used for model closure in a final step the inviscid non hydrostatic solution is updated by including the effect of the turbulent source terms using a centred finite difference scheme and the forward euler formula the time step is subjected to the cfl condition to ensure numerical stability which was found by numerical experimentation to be restricted to cfl 0 5 a detailed description of the numerical scheme is available in cantero chinchilla et al 2018a and the matlab scripts can be downloaded as supplementary material 3 description and structure of the software platform the initial window of the software platform is shown in fig 1 it allows selecting coastal or open channel flow applications within the first option two kinds of problems can be modelled i solitary wave propagation and ii solitary wave propagation and run up on inclined planes fig 2 on the other hand the open channel flow applications consist of i favre waves and ii flow over gaussian obstacles fig 3 a flow chat with the inputs and outputs of each application of the software platform is shown in fig 4 these applications are further detailed in sections 3 1 and 3 2 3 1 coastal flows 3 1 1 solitary wave propagation the generation and propagation of a solitary wave is a challenging test for numerical models since a balance is required between non linearity and dispersion to produce a wave propagating with a permanent form since there is not known analytical solution for the solitary wave solutions embedded into the vam model it is determined numerically as follows the analytical solution of the serre green naghdi equations castro orgaz and hager 2017 is considered as initial condition for the application of the vam model when the model is run with this initial condition an unsteady motion involving a re shaping of the wave profile occurs over a few time steps after routing a few seconds a wave of stable form results which is the solitary wave solution of the vam model cantero chinchilla et al 2018a the sketch of the problem is shown in fig 5 the following input variables are required water depth h wave amplitude a length of the simulation reach l courant friedrich lewy number cfl cell width δx and simulation time t max the user can select the second variable to monitor q u 0 u 1 p 1 p 2 or w 2 and the y limits of the graphs as well as plot the initial conditions stop the simulation and save the solitary wave solution to a file fig 5 3 1 2 solitary wave propagation and run up on a plane beach the second application of the software platform is the solitary wave propagation and run up on a constant slope beach this case is relevant since wave breaking and run up flows are responsible of coastal erosion and flooding issues the vam model reproduces the wave breaking without using any empirical breaking criteria to switch off dispersive terms as typically done in boussinesq type models brocchini 2013 castro orgaz and hager 2017 the wave breaking mimicking ability of the vam model is due to the modelled velocity profile which introduces differential advection of momentum 1 3 u 1 2 h x and can thus counterbalance the effects of the dynamic component of fluid pressure accounted for in the vam model by the perturbation parameters p 1 and p 2 the geometrical configuration of the problem is shown in the lower left part of fig 6 the initial conditions for this test can be imported from the solution of the solitary wave propagation problem detailed in section 3 1 1 alternatively the analytical solution of the serre green naghdi equations can be considered as initial condition through the definition of water depth h wave amplitude a and wave position x c as can be observed in fig 6 apart from these inputs the following variables should be specified in the interface length of the horizontal stretch of the profile l h length of the sloped stretch l s manning roughness coefficient n beach slope s 0 courant friedrich lewy number cfl cell width δx simulation time t max and positions of the three gauges indicated in the definition sketch lg 1 lg 2 and lg 3 the user can also plot the initial conditions start and finish the simulation plot the evolution of the free surface and the second variable previously selected and save the results fig 6 3 2 open channel flows 3 2 1 favre waves favre waves are dispersive trains of free surface undulations generated at the head of a bore or after a rapid opening closing of a gate favre 1935 soares frazao and zech 2002 soares frazão and guinot 2008 hydrostatic models are dispersionless and thus unable to predict favre waves therefore favre waves can only be modelled in a depth integrated framework by shallow water models accounting for non hydrostatic pressures and thus dispersive effects soares frazao and zech 2002 the first open channel flow application of the software platform allows simulating favre waves generated by the opening of a sluice gate as can be observed in fig 7 the input variables required to run this application are the distance from the bed to the gate h g downstream water depth h 0 bed slope s 0 length of the canal l manning roughness coefficient n courant friedrich lewy number cfl cell width δx maximum time of the simulation t max and positions of the gauges lg 1 lg 2 and lg 3 the definition sketch of the lower left part in fig 7 indicates the geometrical configuration of the test including some of the aforementioned variables the interface allows plotting the initial conditions as well as the evolution of the free surface elevation and the second variable selected by the user during the simulation period the simulation is run by the user though the compute button and can be ended at any time by pressing the end button the free surface temporal series at the gauge positions as well as the spatial distribution of the free surface and the second selected variable can be saved through the selection of the corresponding items and the specification of the path to save the result files fig 7 3 2 2 flow over a gaussian obstacle the last application allows reproducing the water waves evolving over a gaussian obstacle the initial conditions are of dam break type with a significant variation in the river depth downstream as shown in the definition sketch of fig 8 this test aims at mimicking the wave propagation over an obstacle like those occurring over a river bed mound when an undular bore propagates in a river this type of water wave problem was previously used by nadiga et al 1996 to test boussinesq type models given that it is challenging the particular case of flow over obstacle with an initially uniform distribution of water depths can be also simulated with the software platform for that the two initial values of water depth specified by the user denoted by h u and h d see fig 8 should be equal apart from these two values the following input variables should be specified constants for the mathematical definition of the gaussian bed profile a b and x c manning roughness coefficient n length of the canal l river flow per unit width q courant friedrich lewy number cfl cell width δx simulation time t max and gauge positions lg 1 lg 2 and lg 3 as in the rest of applications the user can also depict the initial conditions through the plot initial conditions button start the simulation by means of the compute button and end the computation by pressing the end button at any time the evolution of the free surface elevation and the second variable selected by the user are depicted in the right part of the window and the results can be also stored through the selection of the items and the specification of the path fig 8 the computational time of the software platform depends on the computational conditions specified for each case that is on the courant friedrich lewy number cfl the number of cells used and the maximum simulation time t max the computational time is also dependent on the characteristics of the computer employed for the simulations 4 application examples of the software platform 4 1 solitary wave propagation this section reports an application of the solitary wave propagation module and compares the results with the hydrostatic version of the vam model the initial conditions settled in the software platform window fig 5 were h 2 5 m a 1 14 m l 80 m n 0 sm 1 3 cfl 0 1 and t max 10 s fig 9 shows the initial wave and the solitary wave solutions with the hydrostatic and non hydrostatic versions of the vam model it is observed that after 25 s the wave propagated over the horizontal fixed bed is transformed into a shock by the hydrostatic computation whereas the non hydrostatic wave propagation solution obtained with the vam software platform produces a solitary wave the train of small ripples generated at the tail of the solitary wave is produced during the transformation of the initial solitary wave analytical solution of the serre green naghdi equations into the solitary wave solution of the vam equations if a large computational time is prescribed the ripples are split from the solitary wave tail and the solitary wave continues its propagation isolated this non hydrostatic solution obtained by using the solitary wave propagation module can be imported to the solitary wave with run up module as it is detailed in section 4 2 4 2 solitary wave run up on plane beach this section deals with the application of the present software platform to address solitary wave run up on a plane beach the experimental data of solitary wave run up by synolakis 1986 are selected to evaluate the accuracy of the corresponding module of the software platform the experiments were conducted in a wave tank of the w m keck laboratories at the california institute of technology the dimensions of the wave tank were 37 73 m length x 0 61 m height x 0 39 m width at a distance of 14 68 m from the wave generator an inclined plane beach of slope 1 19 85 was installed see fig 10 from the experimental dataset collected by synolakis 1986 a solitary wave of a h 0 3 with h 1 m was selected here this wave amplitude will introduce significant non linear effects on the solitary wave propagation first the solitary wave is propagated over a horizontal frictionless bed using the solitary wave propagation module of the software platform this module uses a moving grid subroutine that allows the propagation of the solitary wave in a short length which is usually defined to produce an unaltered non hydrostatic variable p 1 at the moving boundaries as the solitary wave amplitude is continuously monitored in the screen the program can be stopped when the user identifies the desired amplitude and then the output result file is automatically generated later the output of the solitary wave propagation module is used as initial condition in the solitary wave propagation with run up module this module was run six times to compare the results with the data by synolakis 1986 setting the maximum computational time at t 4 7891 s fig 10a t 6 3855 s fig 10b t 7 9819 s fig 10c t 15 963 s fig 10d t 17 561 s fig 10e and t 19 156 s fig 10f as observed by synolakis 1986 during the propagation of the solitary wave along the plane beach the wave deformed and the skewness increased leading to an instability that induced the wave breaking the software results are in good agreement with laboratory measurements resulting however a minor phase shift at the hydraulic jump position formed during the drawdown phase at t 17 561 s fig 10e note that when a hydraulic jump is formed the turbulence is significant and thus the simple turbulence module implemented in the vam model may not be accurate enough further the present vertically averaged computational results cannot reproduce the inherent three dimensional flow effects in hydraulics jumps therefore despite the limitations the computational results obtained with the vam model are considered satisfactory in a depth integrated sense as in the case of the solitary wave propagation section 4 1 the agreements between the software platform results and the experimental data are significantly more satisfactory than those obtained with the hydrostatic version of the vam model especially before the inception of wave breaking fig 10 4 3 favre waves in this section the software platform is tested to estimate three different data sets of favre waves generated by using different froude numbers for the inlet conditions f 1 081 fig 11 a f 1 104 fig 11b and f 1 192 fig 11c once the flow depth at rest in the channel is set h 0 the inlet tailgate depth h g is calculated using the expression by soares frazao and zech 2002 i e f h g h g h 0 2h 0 2 1 2 the input variables for the software platform in the favre waves module to generate fig 11 are shown in table 1 the non hydrostatic free surface predictions of the vam model obtained with the software platform are compared with the experimental data by soares frazao and zech 2002 these data were collected in an experimental flume of the laboratory of the civil engineering department at the university of louvain a gate located at a 10 m distance from the beginning of the flume separates two regions the upstream reservoir and the channel of length 26 15 m the gate was suddenly opened and the free surface measured at different downstream locations measurements at distances from the gate of 13 15 m 15 65 m and 13 5 m were used for the tests with f 1 081 f 1 104 and f 1 192 respectively table 1 to extend the comparison the hydrostatic computation accomplished using the main code of the vam model i e neglecting p 1 p 2 u 1 and w 2 and thus equivalent to solving saint venant equations is also depicted in fig 11 in addition the results obtained by applying the widely used hydrostatic iber model software for river flows bladé et al 2014 cea and bladé 2015 cea et al 2016 are included to allow the readers to compare the results between both hydraulics software platforms the results by iber were generated using the input parameters indicated in table 1 the 2d geometry in the iber model was set to keep invariant the transverse direction i e resembling 1d conditions the comparisons between the time series of the free surface obtained for the three froude numbers are shown in fig 11 in fig 11 it is observed that the results of the vam model software platform produce excellent approximations to the laboratory measurements by soares frazao and zech 2002 in the three cases for the whole time series on the contrary the agreements between experimental data and results obtained with both the hydrostatic version of the vam model and the iber model are significantly worse due to the lack of non hydrostatic modelling thus favre waves are not captured by hydrostatic simulations this remarks the importance and necessity of using non hydrostatic models as the vam model software platform presented in this work to predict favre waves during gate manoeuvres in open channel flows 4 4 flows over a gaussian obstacle this section addresses the flow over a gaussian obstacle for three different values of the discharge per unit width q 0 0561 m2 s q 0 07703 m2 s and q 0 10144 m2 s experimentally tested by sivakumaran 1981 the experiments were conducted in a laboratory flume with dimensions of 9 15 m length x 0 75 m height x 0 44 m width a curved bed with a maximum height of 0 2 m was built in the flume several values of unit discharge were tested and the free surface position and bed pressure head were measured for each run at different positions along the flume the input variables for the software platform in the flow over gaussian obstacle module are shown in table 2 fig 12 depicts the comparison between the experimental data of the free surface and bed pressure measured by sivakumaran 1981 and the results obtained with the three models mentioned in the previous section the non hydrostatic version of the vam model obtained with the gui the hydrostatic version of the vam model and the iber model as depicted in fig 12 the non hydrostatic results obtained with the vam model software platform are in excellent agreement with the experimental free surface and bed pressure distributions since the vam model accounts for vertical flow effects the improvements with respect to the simulations carried out with the hydrostatic vam and iber models are more evident on inspecting the bed pressure profiles results which are markedly non hydrostatic the hydrostatic based models consider that the bed pressure equals the water depth and thus are unable to reproduce the bed pressure profiles over the obstacle further the higher free surface levels upstream of the obstacle obtained with the hydrostatic models result in an unrealistic prediction of the discharge coefficient of the structure castro orgaz and hager 2017 curved shaped obstacles are instream structures used worldwide for water discharge measurement in open channels and rivers the measurement of the discharge is conducted reading the upstream depth and applying a weir flow equation with an accurate estimation of the discharge coefficient of the structure castro orgaz and hager 2017 it is clearly depicted in fig 12 that the vam model produces such an accurate estimation of the discharge capacity of the obstacle these results confirm the usefulness of the developed software platform to reproduce non hydrostatic conditions in open channel applications 5 conclusions in this study a user friendly software platform is presented to model depth integrated non hydrostatic flows through the vertically averaged and moment vam equations model the platform comprises four applications solitary wave propagation solitary wave propagation with run up favre waves and flow over gaussian obstacles after the description of the governing equations numerical scheme and structure of the software platform it is applied to solve several coastal and open channel flow problems first the platform is used to reproduce solitary wave propagation over horizontal fixed bed with a h 0 456 and h 2 5 m as well as to model the propagation and run up of a solitary wave with a h 0 3 and h 1 m over a plane beach the results are compared with the hydrostatic version of the vam model thereby resulting that the non hydrostatic solutions obtained with the software platform are significantly more realistic in both cases in the case of solitary wave propagation and run up the software platform results are also compared to laboratory data collected by synolakis 1986 the software outputs reproduce the experimental cross shore distributions of the free surface at different times including the solitary wave deformation before breaking wave breaking and run up then the software is used to model favre waves for three different froude numbers f 1 081 f 1 104 and f 1 192 and the results are compared to the hydrostatic version of the vam model the user friendly hydrostatic model iber and experimental data collected by soares frazao and zech 2002 the agreements between free surface time series obtained with the developed software and measured free surface values are excellent whereas the results obtained with the hydrostatic version of the vam model and the iber model are significantly worse finally the flow over a gaussian obstacle is simulated with the three aforementioned models for three unit discharge runs q 0 0561 m2 s q 0 07703 m2 s and q 0 10144 m2 s the computational results are compared with free surface and bed pressure distributions measured in a laboratory facility by sivakumaran 1981 again the fits to the experimental measurements provided by the developed vam model software platform are better than those obtained with hydrostatic modelling approaches the implementation of a numerical solver for the vam equations is time consuming and not evident and made most of the scientific community working in vertically integrated non hydrostatic flows to tend away from solving them however when the vam model was properly structured and discretized a useful matlab application was produced it permits the vam platform user to solve this complex system of equations as compared to saint venant equations in an easy and accurate way thereby producing computational results which may be used to test other models like those based on boussinesq equations the results of this work remark the importance of the vam model not only for modelling non hydrostatic flows in open channel tests but also for reproducing nearshore flows and coastal processes this model can be used for a wide range of applications such as the prediction of free surface profiles at the vicinity of bed forms and obstacles the water discharge measurement in open channels and rivers the estimation of wave run up in coastal areas which is the key variable to delimit the public domain or the design of laboratory experiments in wave and hydraulic flumes among others the gui presented in this paper can be helpful for students professors and water managers whereas the matlab routines of the vam model provided as supplementary material are intended for engineers and scientists doing research in this area acknowledgements this work was supported by the research project ctm2017 85171 c2 1 r secretaría de estado de i d i spain and the research group agr 127 junta de andalucía rb and fncc were partly funded by the spanish ministry of science innovation and universities through programa juan de la cierva 2017 fjci 2017 31781 and programa juan de la cierva 2016 fjci 2016 28009 respectively we thank four anonymous reviewers for their improvements to this work appendix a supplementary data the following are the supplementary data to this article supplementary data rar supplementary data rar appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2020 104674 software availability name of software vam model software contact emails ag2caoro uco es fncantero ias csic es rafael bergillos uco es ag2gaojp uco es requirements matlab runtime availability the software platform is freely available at https github com frncch vam model software 
26032,this work presents a software platform to compute depth integrated non hydrostatic coastal and open channel flows the software is based on the vertically averaged and moment vam equations model the vam model uses the weighted residual method to account for the non hydrostaticity and non uniformity of flow after presenting the governing equations numerical scheme and structure of the graphical user interface the software is applied to solve coastal and open channel flow tests with significant non hydrostaticity and non uniformity of flow the results are compared with hydrostatic model computations and laboratory measurements where a hydrostatic based simulation poorly reproduces experimental observations the higher order model equations by this software platform generate excellent predictions these findings highlight the potential of this user friendly software platform for modeling open channel river and nearshore flows and processes where non hydrostatic pressure and non uniform velocity shall be accounted for which entails a meaningful advance for the hydraulic community keywords non hydrostatic flows depth integrated model software platform coastal applications open channel tests 1 introduction most of the user friendly models used for the simulation of open channel flows are based on the solution of the saint venant equations where it is assumed that the distribution of fluid pressure is hydrostatic and the vertical distribution of the velocity component in the direction of motion is uniform u s corps of engineers 2002 bladé et al 2014 teng et al 2017 in free surface flows with a vertical length scale negligible as compared to the horizontal one the saint venant based models provide accurate approximations however in open channel transitions near hydraulic structures in dam break waves over movable beds in eroded granular dikes by overtopping or in river flows with a significant variation of bottom topography among others the variation of the vertical velocity is non negligible and the vertical acceleration is therefore non zero thus the pressure distribution is non hydrostatic with non negligible dispersive effects in the equations of motion castro orgaz and hager 2017 the inclusion of such dispersive effects in a vertically averaged framework allows to accurately solve a large portfolio of river and coastal flow processes kim and lynett 2011 castro orgaz and hager 2017 cantero chinchilla et al 2018a 2018b coastal flows are typically simulated by using boussinesq type solvers such as the short waves module in mike21 warren and bach 1992 or the celeris model tavakkol and lynett 2017 the dam break flood waves in rivers and the flow in the surf zone and the swash region are important examples of non hydrostatic flows where boussinesq equations have been extensively applied brocchini and peregrine 1996 yamazaki et al 2009 cantero chinchilla et al 2016 the use of non hydrostatic models is required to provide realistic predictions in these flows wei and jia 2014a 2014b albeit with a significant penalty in the numerical treatment of dispersive terms due to the presence of higher order derivatives of the depth averaged velocity field castro orgaz and hager 2017 however given the still high computational cost of three dimensional non hydrostatic models for large scale simulations e g in a river basin the development and use of depth integrated simulation models where the vertical coordinate is removed from the governing equations is a common practice for non hydrostatic modelling zijlema and stelling 2005 2008 yamazaki et al 2009 bai and cheung 2013 wei and jia 2013 aissiouene et al 2015 escalante et al 2018 among others essentially three families of vertically averaged models have been developed so far to simulate non hydrostatic flows the most widely used family is known as boussinesq type equations this family considers the non hydrostaticity through the inclusion of additional dispersive terms in the governing equations demanding the numerical discretization of high order velocity derivatives madsen et al 1991 madsen and sørensen 1992 peregrine 1966 brocchini 2013 castro orgaz and hager 2017 the issue of increasing the order of spatial derivatives in a model appears subtle but getting a robust solver when discretizing spatial derivatives of higher order than two is a formidable task when dealing with dam break like numerical simulations another different although related family is the non hydrostatic extension of the shallow water equations which is based on a multilayer discretization of layer averaged reynolds averaged navier stokes rans equations stansby and zhou 1998 casulli 1999 zijlema and stelling 2005 fernandez nieto et al 2018 escalante et al 2019 although both boussinesq equations and multilayer models are very useful tools each one has its own disadvantages the presence of high order derivatives in the boussinesq equations and the increased computational cost by increasing the number of layers to simulate a flow in the multilayer models finally there is a third family of vertically averaged models for the prediction of non hydrostatic flows steffler and jin 1993 khan and steffler 1996a 1996b which is based on the use of the weighted residual method to derive the vertically averaged and moment equations from the rans equations the modelling system of equations is known as vertically averaged and moment vam equations model cantero chinchilla et al 2018a the weighting function φ 2 z z h is used in the vam model to derive the moment equations while applying the weighted residual method where z is the elevation of the centroid of a section z z b h 2 the vam model is a physical system of equations that is still unfamiliar to the scientific community to some extent it was developed by steffler and jin 1993 and then solved by khan and steffler 1996a 1996b for flows in weirs and spillways producing extremely accurate results for non hydrostatic flows apparently publication of these results in hydraulics journals discouraged the use of vam models by numerical modellers who in this branch of science routinely apply saint venant equations the increased numbers of equations to solve in the vam equations and the apparent complexities in their structure when compared to saint venant equations unfairly relegated the use of vam equations to a few isolated works conducted by their development team however complexities of a model are not in the number of equations to solve but rather on the mathematical structure of the terms to discretize in this regard the highest order derivative in the vam equations is of order one which defines a system of first order partial differential equations this feature is attractive from the view point of numerical discretization since higher order derivatives are absent discretization of dispersive terms is implicit for stability of the elliptic step of the solver while the hyperbolic step is explicit and subject to the courant friedrich lewy condition cfl 1 despite the vam model was recently demonstrated to be extremely accurate predicting a number of river and coastal flows cantero chinchilla et al 2018a we acknowledge that the apparent complexities of the vam model are a penalty in terms of its diffusion and use by peers since the development and application of the vam equations and numerical schemes are time consuming and not immediate tasks therefore the motivation of this paper is to present a user friendly software platform that easily allows the application of the vam model to simulate non hydrostatic flows in a number of coastal and open channel flow cases first the governing equations and numerical scheme of the vam model are shown in section 2 then the structure of the graphical user interface gui and the tests included in the software platform are described in section 3 section 4 shows several applications of the software platform finally the conclusions of the work are summarized in section 5 the vam model software platform is freely available on github https github com frncch vam model software and the matlab scripts of the vam model are provided as supplementary material to this paper 2 theoretical and numerical basis of the vam model 2 1 governing equations the governing equations of the one dimensional 1d vam model are derived from the vertically averaged rans continuity equation x and z momentum equations and moment of x and z momentum equations steffler and jin 1993 khan and steffler 1996a 1996b they can be expressed in conservative form as follows cantero chinchilla et al 2018a see hydraulic reference manual of the vam model in the supplementary material for a complete derivation of the model equations 1 u t f x s o s τ 2 u u 1 u 2 u 3 u 4 u 5 h q u 1 h w h 2 w 12 f q q 2 h g h 2 2 q u 1 h q w h q w 12 u 2 u 2 2 u 1 g u 1 2 2 u 2 u 3 u 1 u 2 u 4 u 1 u 2 u 5 u 1 3 s o 0 x u 1 2 h 3 h p 1 2 ρ 2 h p 2 3 ρ g h z b x p 1 ρ z b x 1 2 ρ p 1 x p 1 h h x 4 p 2 h ρ z x 1 6 h u 1 w x p 1 ρ h w 2 q x q w h u 1 w 6 z x x h 2 u 1 10 w w b 3 w s 3 h w 2 2 h p 2 3 ρ s τ 0 τ b ρ 0 τ b ρ z b x 1 2 ρ h τ b x h τ b 2 ρ z x z b x where u f and s are respectively the vector of unknowns fluxes and source terms u 1 u 5 are the conservative flow variables related to the conservation laws as follows u 1 continuity equation u 2 x momentum equation u 3 moment of x momentum equation u 4 z momentum equation and u 5 moment of z momentum equation subscripts o and τ refer to the inviscid and the turbulent stress source terms respectively x is the longitudinal coordinate t is the time ρ is the fluid density g is the gravitational acceleration q is the discharge per unit width h is the flow depth u 1 is the x velocity at the free surface in excess of the mean q h z b is the river bed elevation w is the depth averaged z velocity w w s w b 2 2w 2 3 with z as the cartesian vertical coordinate w s is the z velocity at the free surface w b is the z velocity at the bed w 2 is the mid depth z velocity in excess of the average between vertical velocities at the bed and free surface w is the vertical velocity difference between bed and free surface w w b w s p 1 is the bed pressure in excess of the hydrostatic p 2 is the mid depth deviation from the linear non hydrostatic law τ b is the bed shear stress and w 2 w 2 w b 2 12 w s 2 12 w b w s 6 1 20 2 w w b w s 2 equations 1 3 are derived from the general vertically integrated mass momentum and moment of momentum equations modelling the x z velocity components and fluid pressure with distributions containing perturbation parameters u 1 x t w 2 x t p 1 x t and p 2 x t to deviate the flow from hydrostatic conditions with horizontal and depth independent velocity the particular choice used in eqs 1 3 is steffler and jin 1993 khan and steffler 1996a 1996b see hydraulic reference manual of the vam model in the supplementary material for a complete derivation of the model equations 4 u x z t u 0 u 1 2 z z b h 1 5 w x z t w b w 2 4 z z b h 1 z z b h w s z z b h 6 p x z t ρ g h p 1 p 2 4 z z b h 1 z z b h note that the perturbation parameters are functions of x and t but not of the vertical coordinate z to mathematically close the model additional physical statements are required the kinematic boundary conditions at the bed and free surface levels are respectively 7 w b u b z b x q h u 1 z b x 8 w s h t u s z s x q x q h u 1 z b h x where u b and u s are the u velocity components at the bed and free surface respectively two reactive equations i e where temporal derivates of conserved variable are absent are prescribed to provide closure to the system of eqs 1 3 the first is obtained combining eqs 7 8 resulting 9 h 2 w 12 h 2 12 q h u 1 z b x h 2 12 q x h 2 12 q h u 1 z b h x the second is the moment of continuity equation which reads see hydraulic reference manual of the vam model in the supplementary material 10 h w h 2 q x q z x 1 6 h 2 u 1 x the vam model system eqs 1 3 and eqs 9 10 is based on a simple turbulence closure where the normal stresses are neglected and the shear stress is considered to vary linearly between τ b at bed and zero at the surface the latter is modelled using the manning s equation parametrized with the near bed non hydrostatic velocity field cantero chinchilla et al 2018a see also hydraulic reference manual of the vam model in the supplementary material if u 1 w 2 p 1 p 2 0 the vam eqs 1 3 reduce to the saint venant equations in this case the moment equations and the vertical momentum equation are not needed given the lack of perturbation parameters e g only h and q are computed a significant feature of the vam equations as compared to boussinesq equations is that a wave breaking criteria is not needed given that the vertical profile of horizontal velocity u is modelled thereby introducing dissipation into the solution the vam model was demonstrated to produce the transition from solitary wave to broken waves during run up on a beach without any empirical formulation for wave breaking cantero chinchilla et al 2018a if u 1 w 2 p 2 0 the only perturbation parameter retained is p 1 and the vam eqs 1 3 reduce to the vertically averaged equations va by removing the moment equations khan and steffler 1996 the va system of equations is basically equivalent to a boussinesq type system albeit with a different factor affecting the dispersive term cantero chinchilla et al 2016 the vam equations can model with great accuracy dispersive effects up to kh 8 where k is the wave number and h is the still water depth however the accuracy of the va model is acceptable only up to kh 2 steffler and jin 1993 see hydraulic reference manual of the vam model in the supplementary material for a detailed comparison of vam and va models therefore the advantage of the vam model over other types of models such as those based on boussinesq equations is that dispersive effects are modelled with great accuracy up to large kh values and that wave breaking is automatically accounted for by the model equations this comparison is not aimed at discouraging the use of boussinesq type equations which are valuable numerical models by improving their linear dispersion relation and implementing a wave breaking criterion the comparison focuses on presenting the vam equations as a viable alternative to model the same flows showing some of its important features 2 2 numerical scheme the system of eqs 1 7 is solved using a semi implicit hybrid finite volume finite difference numerical scheme cantero chinchilla et al 2018a see supplementary material where the matlab scripts are freely available fundamentals of the numerical method implemented are explained in detail the hydraulic reference manual accompanying the vam code the solution strategy uses a splitting approach the homogeneous part of eq 1 i e with no source terms is solved first in an advection step using a godunov type finite volume scheme the fourth order total variation diminishing monotone upstream centred scheme for conservation laws muscl tvd 4th and the minmod limiter are used to reconstruct the flow variables at the cell interfaces yamamoto and daiguji 1993 kim et al 2009 kim and lynett 2011 cantero chinchilla et al 2016 the weighted surface depth gradient method wsdgm aureli et al 2008 and a discretization of the gravity term in the x momentum equation to grant the c property of the numerical scheme are implemented the numerical flux at the cell interface is determined using the hllc approximate riemann solver toro 2001 2009 in this step the computed flow depth is the final value for the actual time the homogeneous solution is then updated by including the effects of the inviscid terms using a centred implicit finite difference scheme resulting from the application of the backward euler formula the system of algebraic equations is iteratively solved using the newton raphson method the equations resulting from this step are non linear and implicit and for this reason an iterative solver is needed the discretized system of equations and jacobian matrix implemented are described in the hydraulic reference manual accompanying the vam matlab scripts as supplementary material note that in this step the two reactive equations eqs 9 and 10 are used for model closure in a final step the inviscid non hydrostatic solution is updated by including the effect of the turbulent source terms using a centred finite difference scheme and the forward euler formula the time step is subjected to the cfl condition to ensure numerical stability which was found by numerical experimentation to be restricted to cfl 0 5 a detailed description of the numerical scheme is available in cantero chinchilla et al 2018a and the matlab scripts can be downloaded as supplementary material 3 description and structure of the software platform the initial window of the software platform is shown in fig 1 it allows selecting coastal or open channel flow applications within the first option two kinds of problems can be modelled i solitary wave propagation and ii solitary wave propagation and run up on inclined planes fig 2 on the other hand the open channel flow applications consist of i favre waves and ii flow over gaussian obstacles fig 3 a flow chat with the inputs and outputs of each application of the software platform is shown in fig 4 these applications are further detailed in sections 3 1 and 3 2 3 1 coastal flows 3 1 1 solitary wave propagation the generation and propagation of a solitary wave is a challenging test for numerical models since a balance is required between non linearity and dispersion to produce a wave propagating with a permanent form since there is not known analytical solution for the solitary wave solutions embedded into the vam model it is determined numerically as follows the analytical solution of the serre green naghdi equations castro orgaz and hager 2017 is considered as initial condition for the application of the vam model when the model is run with this initial condition an unsteady motion involving a re shaping of the wave profile occurs over a few time steps after routing a few seconds a wave of stable form results which is the solitary wave solution of the vam model cantero chinchilla et al 2018a the sketch of the problem is shown in fig 5 the following input variables are required water depth h wave amplitude a length of the simulation reach l courant friedrich lewy number cfl cell width δx and simulation time t max the user can select the second variable to monitor q u 0 u 1 p 1 p 2 or w 2 and the y limits of the graphs as well as plot the initial conditions stop the simulation and save the solitary wave solution to a file fig 5 3 1 2 solitary wave propagation and run up on a plane beach the second application of the software platform is the solitary wave propagation and run up on a constant slope beach this case is relevant since wave breaking and run up flows are responsible of coastal erosion and flooding issues the vam model reproduces the wave breaking without using any empirical breaking criteria to switch off dispersive terms as typically done in boussinesq type models brocchini 2013 castro orgaz and hager 2017 the wave breaking mimicking ability of the vam model is due to the modelled velocity profile which introduces differential advection of momentum 1 3 u 1 2 h x and can thus counterbalance the effects of the dynamic component of fluid pressure accounted for in the vam model by the perturbation parameters p 1 and p 2 the geometrical configuration of the problem is shown in the lower left part of fig 6 the initial conditions for this test can be imported from the solution of the solitary wave propagation problem detailed in section 3 1 1 alternatively the analytical solution of the serre green naghdi equations can be considered as initial condition through the definition of water depth h wave amplitude a and wave position x c as can be observed in fig 6 apart from these inputs the following variables should be specified in the interface length of the horizontal stretch of the profile l h length of the sloped stretch l s manning roughness coefficient n beach slope s 0 courant friedrich lewy number cfl cell width δx simulation time t max and positions of the three gauges indicated in the definition sketch lg 1 lg 2 and lg 3 the user can also plot the initial conditions start and finish the simulation plot the evolution of the free surface and the second variable previously selected and save the results fig 6 3 2 open channel flows 3 2 1 favre waves favre waves are dispersive trains of free surface undulations generated at the head of a bore or after a rapid opening closing of a gate favre 1935 soares frazao and zech 2002 soares frazão and guinot 2008 hydrostatic models are dispersionless and thus unable to predict favre waves therefore favre waves can only be modelled in a depth integrated framework by shallow water models accounting for non hydrostatic pressures and thus dispersive effects soares frazao and zech 2002 the first open channel flow application of the software platform allows simulating favre waves generated by the opening of a sluice gate as can be observed in fig 7 the input variables required to run this application are the distance from the bed to the gate h g downstream water depth h 0 bed slope s 0 length of the canal l manning roughness coefficient n courant friedrich lewy number cfl cell width δx maximum time of the simulation t max and positions of the gauges lg 1 lg 2 and lg 3 the definition sketch of the lower left part in fig 7 indicates the geometrical configuration of the test including some of the aforementioned variables the interface allows plotting the initial conditions as well as the evolution of the free surface elevation and the second variable selected by the user during the simulation period the simulation is run by the user though the compute button and can be ended at any time by pressing the end button the free surface temporal series at the gauge positions as well as the spatial distribution of the free surface and the second selected variable can be saved through the selection of the corresponding items and the specification of the path to save the result files fig 7 3 2 2 flow over a gaussian obstacle the last application allows reproducing the water waves evolving over a gaussian obstacle the initial conditions are of dam break type with a significant variation in the river depth downstream as shown in the definition sketch of fig 8 this test aims at mimicking the wave propagation over an obstacle like those occurring over a river bed mound when an undular bore propagates in a river this type of water wave problem was previously used by nadiga et al 1996 to test boussinesq type models given that it is challenging the particular case of flow over obstacle with an initially uniform distribution of water depths can be also simulated with the software platform for that the two initial values of water depth specified by the user denoted by h u and h d see fig 8 should be equal apart from these two values the following input variables should be specified constants for the mathematical definition of the gaussian bed profile a b and x c manning roughness coefficient n length of the canal l river flow per unit width q courant friedrich lewy number cfl cell width δx simulation time t max and gauge positions lg 1 lg 2 and lg 3 as in the rest of applications the user can also depict the initial conditions through the plot initial conditions button start the simulation by means of the compute button and end the computation by pressing the end button at any time the evolution of the free surface elevation and the second variable selected by the user are depicted in the right part of the window and the results can be also stored through the selection of the items and the specification of the path fig 8 the computational time of the software platform depends on the computational conditions specified for each case that is on the courant friedrich lewy number cfl the number of cells used and the maximum simulation time t max the computational time is also dependent on the characteristics of the computer employed for the simulations 4 application examples of the software platform 4 1 solitary wave propagation this section reports an application of the solitary wave propagation module and compares the results with the hydrostatic version of the vam model the initial conditions settled in the software platform window fig 5 were h 2 5 m a 1 14 m l 80 m n 0 sm 1 3 cfl 0 1 and t max 10 s fig 9 shows the initial wave and the solitary wave solutions with the hydrostatic and non hydrostatic versions of the vam model it is observed that after 25 s the wave propagated over the horizontal fixed bed is transformed into a shock by the hydrostatic computation whereas the non hydrostatic wave propagation solution obtained with the vam software platform produces a solitary wave the train of small ripples generated at the tail of the solitary wave is produced during the transformation of the initial solitary wave analytical solution of the serre green naghdi equations into the solitary wave solution of the vam equations if a large computational time is prescribed the ripples are split from the solitary wave tail and the solitary wave continues its propagation isolated this non hydrostatic solution obtained by using the solitary wave propagation module can be imported to the solitary wave with run up module as it is detailed in section 4 2 4 2 solitary wave run up on plane beach this section deals with the application of the present software platform to address solitary wave run up on a plane beach the experimental data of solitary wave run up by synolakis 1986 are selected to evaluate the accuracy of the corresponding module of the software platform the experiments were conducted in a wave tank of the w m keck laboratories at the california institute of technology the dimensions of the wave tank were 37 73 m length x 0 61 m height x 0 39 m width at a distance of 14 68 m from the wave generator an inclined plane beach of slope 1 19 85 was installed see fig 10 from the experimental dataset collected by synolakis 1986 a solitary wave of a h 0 3 with h 1 m was selected here this wave amplitude will introduce significant non linear effects on the solitary wave propagation first the solitary wave is propagated over a horizontal frictionless bed using the solitary wave propagation module of the software platform this module uses a moving grid subroutine that allows the propagation of the solitary wave in a short length which is usually defined to produce an unaltered non hydrostatic variable p 1 at the moving boundaries as the solitary wave amplitude is continuously monitored in the screen the program can be stopped when the user identifies the desired amplitude and then the output result file is automatically generated later the output of the solitary wave propagation module is used as initial condition in the solitary wave propagation with run up module this module was run six times to compare the results with the data by synolakis 1986 setting the maximum computational time at t 4 7891 s fig 10a t 6 3855 s fig 10b t 7 9819 s fig 10c t 15 963 s fig 10d t 17 561 s fig 10e and t 19 156 s fig 10f as observed by synolakis 1986 during the propagation of the solitary wave along the plane beach the wave deformed and the skewness increased leading to an instability that induced the wave breaking the software results are in good agreement with laboratory measurements resulting however a minor phase shift at the hydraulic jump position formed during the drawdown phase at t 17 561 s fig 10e note that when a hydraulic jump is formed the turbulence is significant and thus the simple turbulence module implemented in the vam model may not be accurate enough further the present vertically averaged computational results cannot reproduce the inherent three dimensional flow effects in hydraulics jumps therefore despite the limitations the computational results obtained with the vam model are considered satisfactory in a depth integrated sense as in the case of the solitary wave propagation section 4 1 the agreements between the software platform results and the experimental data are significantly more satisfactory than those obtained with the hydrostatic version of the vam model especially before the inception of wave breaking fig 10 4 3 favre waves in this section the software platform is tested to estimate three different data sets of favre waves generated by using different froude numbers for the inlet conditions f 1 081 fig 11 a f 1 104 fig 11b and f 1 192 fig 11c once the flow depth at rest in the channel is set h 0 the inlet tailgate depth h g is calculated using the expression by soares frazao and zech 2002 i e f h g h g h 0 2h 0 2 1 2 the input variables for the software platform in the favre waves module to generate fig 11 are shown in table 1 the non hydrostatic free surface predictions of the vam model obtained with the software platform are compared with the experimental data by soares frazao and zech 2002 these data were collected in an experimental flume of the laboratory of the civil engineering department at the university of louvain a gate located at a 10 m distance from the beginning of the flume separates two regions the upstream reservoir and the channel of length 26 15 m the gate was suddenly opened and the free surface measured at different downstream locations measurements at distances from the gate of 13 15 m 15 65 m and 13 5 m were used for the tests with f 1 081 f 1 104 and f 1 192 respectively table 1 to extend the comparison the hydrostatic computation accomplished using the main code of the vam model i e neglecting p 1 p 2 u 1 and w 2 and thus equivalent to solving saint venant equations is also depicted in fig 11 in addition the results obtained by applying the widely used hydrostatic iber model software for river flows bladé et al 2014 cea and bladé 2015 cea et al 2016 are included to allow the readers to compare the results between both hydraulics software platforms the results by iber were generated using the input parameters indicated in table 1 the 2d geometry in the iber model was set to keep invariant the transverse direction i e resembling 1d conditions the comparisons between the time series of the free surface obtained for the three froude numbers are shown in fig 11 in fig 11 it is observed that the results of the vam model software platform produce excellent approximations to the laboratory measurements by soares frazao and zech 2002 in the three cases for the whole time series on the contrary the agreements between experimental data and results obtained with both the hydrostatic version of the vam model and the iber model are significantly worse due to the lack of non hydrostatic modelling thus favre waves are not captured by hydrostatic simulations this remarks the importance and necessity of using non hydrostatic models as the vam model software platform presented in this work to predict favre waves during gate manoeuvres in open channel flows 4 4 flows over a gaussian obstacle this section addresses the flow over a gaussian obstacle for three different values of the discharge per unit width q 0 0561 m2 s q 0 07703 m2 s and q 0 10144 m2 s experimentally tested by sivakumaran 1981 the experiments were conducted in a laboratory flume with dimensions of 9 15 m length x 0 75 m height x 0 44 m width a curved bed with a maximum height of 0 2 m was built in the flume several values of unit discharge were tested and the free surface position and bed pressure head were measured for each run at different positions along the flume the input variables for the software platform in the flow over gaussian obstacle module are shown in table 2 fig 12 depicts the comparison between the experimental data of the free surface and bed pressure measured by sivakumaran 1981 and the results obtained with the three models mentioned in the previous section the non hydrostatic version of the vam model obtained with the gui the hydrostatic version of the vam model and the iber model as depicted in fig 12 the non hydrostatic results obtained with the vam model software platform are in excellent agreement with the experimental free surface and bed pressure distributions since the vam model accounts for vertical flow effects the improvements with respect to the simulations carried out with the hydrostatic vam and iber models are more evident on inspecting the bed pressure profiles results which are markedly non hydrostatic the hydrostatic based models consider that the bed pressure equals the water depth and thus are unable to reproduce the bed pressure profiles over the obstacle further the higher free surface levels upstream of the obstacle obtained with the hydrostatic models result in an unrealistic prediction of the discharge coefficient of the structure castro orgaz and hager 2017 curved shaped obstacles are instream structures used worldwide for water discharge measurement in open channels and rivers the measurement of the discharge is conducted reading the upstream depth and applying a weir flow equation with an accurate estimation of the discharge coefficient of the structure castro orgaz and hager 2017 it is clearly depicted in fig 12 that the vam model produces such an accurate estimation of the discharge capacity of the obstacle these results confirm the usefulness of the developed software platform to reproduce non hydrostatic conditions in open channel applications 5 conclusions in this study a user friendly software platform is presented to model depth integrated non hydrostatic flows through the vertically averaged and moment vam equations model the platform comprises four applications solitary wave propagation solitary wave propagation with run up favre waves and flow over gaussian obstacles after the description of the governing equations numerical scheme and structure of the software platform it is applied to solve several coastal and open channel flow problems first the platform is used to reproduce solitary wave propagation over horizontal fixed bed with a h 0 456 and h 2 5 m as well as to model the propagation and run up of a solitary wave with a h 0 3 and h 1 m over a plane beach the results are compared with the hydrostatic version of the vam model thereby resulting that the non hydrostatic solutions obtained with the software platform are significantly more realistic in both cases in the case of solitary wave propagation and run up the software platform results are also compared to laboratory data collected by synolakis 1986 the software outputs reproduce the experimental cross shore distributions of the free surface at different times including the solitary wave deformation before breaking wave breaking and run up then the software is used to model favre waves for three different froude numbers f 1 081 f 1 104 and f 1 192 and the results are compared to the hydrostatic version of the vam model the user friendly hydrostatic model iber and experimental data collected by soares frazao and zech 2002 the agreements between free surface time series obtained with the developed software and measured free surface values are excellent whereas the results obtained with the hydrostatic version of the vam model and the iber model are significantly worse finally the flow over a gaussian obstacle is simulated with the three aforementioned models for three unit discharge runs q 0 0561 m2 s q 0 07703 m2 s and q 0 10144 m2 s the computational results are compared with free surface and bed pressure distributions measured in a laboratory facility by sivakumaran 1981 again the fits to the experimental measurements provided by the developed vam model software platform are better than those obtained with hydrostatic modelling approaches the implementation of a numerical solver for the vam equations is time consuming and not evident and made most of the scientific community working in vertically integrated non hydrostatic flows to tend away from solving them however when the vam model was properly structured and discretized a useful matlab application was produced it permits the vam platform user to solve this complex system of equations as compared to saint venant equations in an easy and accurate way thereby producing computational results which may be used to test other models like those based on boussinesq equations the results of this work remark the importance of the vam model not only for modelling non hydrostatic flows in open channel tests but also for reproducing nearshore flows and coastal processes this model can be used for a wide range of applications such as the prediction of free surface profiles at the vicinity of bed forms and obstacles the water discharge measurement in open channels and rivers the estimation of wave run up in coastal areas which is the key variable to delimit the public domain or the design of laboratory experiments in wave and hydraulic flumes among others the gui presented in this paper can be helpful for students professors and water managers whereas the matlab routines of the vam model provided as supplementary material are intended for engineers and scientists doing research in this area acknowledgements this work was supported by the research project ctm2017 85171 c2 1 r secretaría de estado de i d i spain and the research group agr 127 junta de andalucía rb and fncc were partly funded by the spanish ministry of science innovation and universities through programa juan de la cierva 2017 fjci 2017 31781 and programa juan de la cierva 2016 fjci 2016 28009 respectively we thank four anonymous reviewers for their improvements to this work appendix a supplementary data the following are the supplementary data to this article supplementary data rar supplementary data rar appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2020 104674 software availability name of software vam model software contact emails ag2caoro uco es fncantero ias csic es rafael bergillos uco es ag2gaojp uco es requirements matlab runtime availability the software platform is freely available at https github com frncch vam model software 
26033,the pawn index is gaining traction among the modelling community as a sensitivity measure however the robustness to its design parameters has not yet been scrutinized the size n and sampling ε of the model output the number of conditioning intervals n or the summary statistic θ here we fill this gap by running a sensitivity analysis of a pawn based sensitivity analysis we compare the results with the design uncertainties of the sobol total order index s t i unlike in s t i the design uncertainties in pawn create non negligible chances of producing biased results when ranking or screening inputs the dependence of pawn upon n n ε θ is difficult to tame as these parameters interact with one another even in an ideal setting in which the optimum choice for n n ε θ is known in advance pawn might not allow to distinguish an influential non additive model input from a truly non influential model input keywords uncertainty environmental modelling statistics risk 1 introduction pianosi and wagener 2015 2018 have recently published in environmental modelling software a new measure for sensitivity analysis the pawn index like other moment independent approaches i e entropy based liu et al 2006 density based borgonovo et al 2014 borgonovo 2007 pawn does not resort to statistical second order moments such as variance to apportion output uncertainty to the model parameters instead it relies on cumulative distribution functions cdfs to characterize the maximum distance between the unconditional output distribution y u i e obtained by moving all parameters simultaneously and the conditional output distribution y c i j i e obtained by fixing the i th parameter to j 1 2 n values or intervals within its uncertainty range the difference between y u and y c i j is assessed via the kolmogorov smirnov test although other distance based tests such as the anderson darling s may also be used khorashadi zadeh et al 2017 the final pawn index for a given parameter is obtained by calculating the mean the median the maximum or any other summary statistic over all the ks values computed between y u and y c i j the most up to date approximation to the pawn index named the generic approach pianosi and wagener 2018 is as follows let there be an a matrix with v 1 2 n rows and i 1 2 k parameters after computing the model output y the range of variation of the i th parameter is split into j 1 2 n intervals of size n c where n c n n the model output linked to the j th interval is used as the conditional model output y c i j the unconditional model output y u can concur with the whole model output or can be a random sub sample of the same size as n c with this approach the total number of model runs to compute pawn is fully determined by n pianosi and wagener 2018 based on trials with the liu et al 2006 function the ishigami and homma 1990 function the swat model khorashadi zadeh et al 2017 or a wind energy converter model holl et al 2016 it has been observed that pawn might reach convergence much faster than sobol indices a key question however is to know how the selection of n n the sampling of y u or the summary statistic affects the accuracy of pawn this is timely given the widespread adoption of the index since its inception in 2015 pawn has been cited 94 times with the number of citations stably increasing from 5 in 2015 to 31 in 2019 most of the works quoting pawn are from the environmental sciences 53 followed by engineering 24 and computer science 23 scopus search on september 25 2019 gaining a systematic insight into the internal functioning of pawn shall thus allow the modelling community to better appraise its robustness thus increasing its transparency as well as our awareness of its advantages and limitations here we assess the sensitivity of pawn to the main structural uncertainties involving its calculation an exercise that might be termed a sensitivity analysis of a sensitivity analysis sa of sa this expression was used by paleari and confalonieri 2016 to study how sensitivity indices are affected by uncertainties in the probability distributions used to describe the model inputs a work that actually falls into the tradition of probability of probability or probability of frequency described in kaplan and garrick 1981 see also aven 2020 a similar analysis of the sensitivity of results to changes in the range of input factors can be found in shin et al 2013 other approaches include exploring several sensitivity measures 19 23 27 more recently noacco et al 2019 included considerations of form of the output sample size choice of method measuring interactions range of distributions inclusion or exclusion of non behavioural runs simulations and use of dummy variables our experiment departs from these studies in that it assesses the uncertainties embedded in the structural design of sensitivity indices pawn in that case we thus explore the implications of the last ring in the chain of uncertainties characterizing any sensitivity analysis the last stretches of the garden of forking paths that need to be crossed to arrive at a result in any modelling exercise borges 1941 gelman and loken 2013 exploring all sources of uncertainty is indeed an important pursuit including the notions of context purpose and motivations as suggested in sensitivity auditing saltelli et al 2013 however we believe that the papers just reviewed paleari and confalonieri 2016 pappenberger et al 2008 shin et al 2013 noacco et al 2019 are not a sa of a sa but more general instances of uncertainty exploration we take the meaning of sa literally i e the analysis of the sensitivity of a sensitivity analysis to its own design parameters and thus exclude in this paper the exploration of sensitivities to changing methods assumptions or model designs however worthy these analyses might be 2 materials and methods in order to cross check our approach we match the design uncertainties of pawn against the design uncertainties of the sobol total order index s t i a well established measure to determine how much a given model parameter interacts with the rest 1 1 the asterisk in s t i is used to differentiate between sobol total order index s t i i e the index against which pawn is matched and the index used to assess the extent to which s t i interacts with its design parameters n θ s t i although different in scope and nature the fact that unconditional cdfs are also affected by interactions paves the way for the uncertainties in pawn and s t i to be explored in parallel for pawn we focused on four uncertain parameters the total number of model runs n the number of conditioning intervals n the randomness derived from the sampling of the unconditional model output y u ε and the summary statistic θ for s t i we focused on two n and θ the latter reflecting the different estimators existing to compute the total order effect jansen 1999 homma and saltelli 1996 sobol 2007 table 1 we assessed how different combinations of values for these uncertain parameters condition the pawn s t i index using four different test functions that yield a skewed model output fig 1 the liu et al 2006 s which reads as 1 y x 1 x 2 where x 1 χ 2 10 and x 2 χ 2 13 978 the ishigami and homma 1990 s which reads as 2 y sin x 1 a sin x 2 2 b x 3 4 sin x 1 where a 2 b 1 and x 1 x 2 x 3 u π π the sobol 1998 s which reads as 3 y i 1 k 4 x i 2 a i 1 a i where k 8 x i u 0 1 and a 0 1 4 5 9 99 99 99 99 and the morris 1991 function which reads as 4 y β 0 i 1 20 β i w i i j 20 β i j w i w j i j l 20 β i j l w i w j w l i j l s 20 β i j l s w i w j w l w s where w i 2 x i 0 5 for all i except for i 4 5 7 where w i 2 1 1 x i x i 0 1 0 5 x i u 0 1 and β i 20 i 1 2 10 β i j 15 i 1 2 6 β i j l 10 i 1 2 5 β i j l s 5 i 1 2 4 campolongo et al 2011 we chose these four skewed benchmark functions in order to provide pawn with a favourable test ground density based measures might better characterize the uncertainty in skewed model outputs than variance based measures as the former do not rely on any statistical moment borgonovo et al 2011 we selected the distributions of n n ε θ based on previous work on pawn and the s t i index pianosi and wagener 2015 2018 saltelli et al 2010 and some preliminary tests firstly we observed that n 2000 was sufficient for the pawn index of many model inputs to be very close to convergence sobol s t i on the other hand required a larger number of runs fig s1 this corroborated previous observations on the faster convergence rate of pawn compared to sobol indices pianosi and wagener 2015 khorashadi zadeh et al 2017 by defining n u 200 2000 we set our study in a scenario where the uncertainty with regards to the required sample size needed to compute robust pawn indices is moderate indeed this is usually the case the analyst might have a cap on the total number of model runs available with the computing resources at hand but no prior information on the minimum sample size required to ensure stable sensitivity indices for all model inputs we defined the distribution of n based on pianosi and wagener 2018 who suggested to start with n 10 and vary n some units up and down to check its effect provided that n 5 for ε we set 1 0 3 different starting points seeds for the pseudo random number sequence used to generate the indices from 1 to n to sample y u this ensured 1 negligible chances of the same seed overlapping with the same value for n thus introducing determinism into a process that should be mainly stochastic and 2 that the randomness in the sampling of y u is assessed in terms of its relative influence in the computation of pawn with regards to θ for pawn we used the mean the median and the maximum as a summary statistic for the ks values when θ 1 θ 2 and θ 3 for s t i we used the estimators by jansen 1999 homma and saltelli 1996 and sobol 2007 when θ 1 θ 2 and θ 3 respectively in order to estimate the uncertainty propagated by n n ε θ resp n θ to pawn resp s t i we created a 2 13 2 k sample matrix for each function using sobol quasi random number sequences where k 4 resp k 2 and transformed the columns into their appropriate distributions table 1 the first k matrix was labelled a and the second k matrix b our model ran row wise in both the a and b matrices as follows based on the information contained in the v th row it created a sobol matrix of size n v for pawn of size i n t n v k 1 for s t i and computed either the liu et al 2006 the ishigami and homma 1990 the sobol 1998 or the morris 1991 function then for each model input i it either calculated the pawn v index following the conditions set by n v ε v and θ v or the s t i v index according to θ v we estimated how sensitive pawn s t i indices are to uncertainty in n n ε θ resp n θ by means of sobol indices sobol 1993 for a model of the form y f x 1 x 2 x k where y is a scalar and x 1 x 2 x k are independent parameters described by known probability distributions we can measure how sensible y is to a given parameter x i with 5 v i v x i e x i y x i where e x i y x i is the expected value of y calculated over all possible values of all parameters except the i th which is kept fixed by dividing eq 5 by the unconditional model output variance we obtain the first order sensitivity index for x i which describes the proportion of variance in the model output caused by x i 6 s i v i v y we can then decompose the unconditional model output variance y as the sum of conditional variances up to the k th order 7 v y i 1 k v i i i j v i j v 1 2 k where 8 v i j v x i x j e x i j y x i x j v x i e x i y x i v x j e x j y x j from this we can derive the second order index s i j which explains the proportion of variance due to the interaction between x i and x j 9 s i j v i j v y and so on until order k however estimating all terms in eq 7 is impractical when k is large as they result in 2 k 1 in this case we can compute the total order index or s t i which measures the proportion of variance due to the first order effect of x i jointly with its interactions with the other parameters homma and saltelli 1996 10 s t i e x i v x i y x i v y for pawn since k 4 we computed first s i second s i j third s i j k and total order s t i sobol indices of n n ε θ for s t i since k 2 we just computed s i and s t i in both settings we used the saltelli et al 2010 and the jansen 1999 estimators to compute s i and s t i respectively as per the established best practices all the workflow is summarized in fig s2 and the r code to replicate our results is available in github 3 results 3 1 uncertainty analysis fig 2 presents the uncertainty distribution of pawn and s t i for each model input and function the results can be matched against fig s3 where we display how pawn and sobol indices look like once their design parameters are fixed and the total number of model runs is set at n 4000 for pawn we ran three simulations fig 2a 1 with θ including the mean the median and the maximum as possible summary statistics m a x θ setting 2 with θ including the mean and the median only m a x θ setting this aimed at isolating the effect that extreme ks values which might be obtained for specific conditioning intervals have in the final pawn index 3 with n u 2500 4000 n u 15 20 and m a x θ optimum setting this latter run reflects an ideal scenario one in which the number of model runs needed to achieve convergence is known in advance and the uncertainty in n and θ is reduced to the minimum expression for s t i we run one simulation to assess its sensitivity to the uncertainty in the total number of model runs and the estimator n θ with n 200 2000 fig 2b sobol indices might eventually take on values outside the range 0 1 due to numerical artefacts created during the computation this is widely known among sensitivity analysts and managed by considering s t i 0 0 and s t i 1 1 fig 2b only presents s t i 0 1 to allow for a better comparison with the values produced by the pawn index a plot showing the distribution of values with s t i 0 1 is presented in fig s4 3 1 1 factor prioritization fig 2 shows that in a factor prioritization context i e when the aim is to sort the parameters according to their contribution to the model output variance saltelli et al 2007 the uncertainty in the value of the design parameters might cause model inputs to overlap thus raising the likelihood of producing a biased ranking in order to get precise figures for this overlap we computed the coefficient of overlapping i e the area lying under the density curves of two different model inputs following pastore 2018 see fig s5 for a presentation of fig 2 with density curves instead in the case of the ishigami and homma 1990 function the overlap between x 2 and x 3 is of 10 if pawn is used under m a x θ 4 under m a x θ despite x 2 being non influential the overlap with s t i is 0 with the sobol 1998 g function pawn mistakes x 1 for x 2 and x 2 for x 3 11 and 20 of the time respectively if m a x θ 4 and 10 if m a x θ and might even bias the ranking of x 2 and x 4 14 and 9 overlap in m a x θ and m a x θ respectively on the contrary if s t i is used the overlap between x 1 x 2 x 2 x 3 and x 2 x 4 is 0 2 and 1 respectively the case of the liu et al 2006 function deserves a specific comment fig 2 shows that 29 of x 1 and x 2 values overlap if using pawn under m a x θ 13 if m a x θ whereas for s t i the degree of overlap is 55 liu et al 2006 however stated that x 1 was more influential than x 2 based on relative entropy sensitivity methods pianosi and wagener 2015 used the liu et al 2006 function to back up their claim of pawn outperforming sobol indices due to the former being able to discriminate the higher influence of x 1 much better than s t i however the analytical values of s t i in the liu et al 2006 function are identical at x 1 x 2 0 546 see table 2 in liu et al 2006 this means that the overlap between x 1 and x 2 shown in fig 2b is to be expected and does not result from the sensitivity of s t i to the uncertainties in its own structural design 3 1 2 factor screening in a factor screening context i e when the aim is to distinguish influential from non influential parameters saltelli et al 2007 the uncertainty in the pawn design parameters might also lead to erroneous results regardless of whether m a x θ or m a x θ in the case of the sobol 1998 g function 10 14 7 8 of the probability density of x 2 which has a non nihil effect overlaps with x 4 x 8 which have no effect at all the overlap between influential and non influential model inputs if s t i is used on the other side ranges between 0 and 2 the poor screening power of pawn stands out in the case of the morris 1991 function 18 25 1 8 in m a x θ of the probability density of x 8 x 10 which have a moderate first order effect overlap with that of x 11 x 20 which are non influential fig s2a in the case of s t i the overlap ranges in 0 5 the chances of pawn mistaking relevant for non relevant parameters is even higher in the case of parameters whose influence in the model output is through interactions only this is the case of x 1 x 6 in the morris 1991 function whose degree of overlap with x 11 x 20 which are non influential range between 75 95 figs 2 s3 in all these cases the uncertainty in the design parameters of s t i leads to a 0 4 overlap between influential and non influential parameters fig 2 shows that in the optimum setting the overlap between the model inputs is considerably reduced for pawn in the case of the liu et al 2006 and the ishigami and homma 1990 functions the percentage of overlap goes down to zero however the chances of wrongly ranking screening the model inputs remain non negligible for both the sobol 1998 g and the morris 1991 functions in the former there is 17 28 overlap between the slightly influential model input x 3 and x 4 x 8 whose effect cannot be differentiated from the approximation error with regards to the morris 1991 function the chances of characterizing as non influential parameters that have a significant non additive effect in the model output remain very high the overlap of x 1 x 6 with x 11 x 20 for instance range between 35 90 fig 2 as shown in fig s3 the volatility in the computation of pawn does not allow to distinguish x 11 x 20 from a dummy non influential model input 3 2 sensitivity analysis fig 3 presents the sobol first s i and total s t i indices for each of the settings of our analysis after pooling the values from all functions and parameters the sobol indices for each function and design parameter are shown in figs s6 s7 pawn and figs s8 s9 s t i fig 3 thus informs on how much uncertainty each design parameter contributes to each sensitivity index in fig s10 of the supplementary information file we prove that the results displayed in fig 3 are robust without having to correct the stronger weight that the morris function might have in defining the trends due to its much larger number of model inputs as shown in fig 3a the first order effect of θ and n is much more variable in the m a x θ setting suggesting that their degree of contribution to the pawn index uncertainty might considerably be function dependent this variability is highly reduced in the m a x θ setting which provides a more robust account of the extent to which each design parameter contributes to define the pawn index in this setting the selection of the total number of model runs n and the number of conditioning intervals n convey up to c 60 and c 20 of the pawn index uncertainty respectively the stochasticity in the sampling of y u ε is mostly influential through interactions in both settings whereas the selection of the summary statistic θ has a nearly nihil effect in the m a x θ setting remarkably interactions are also significant in the optimum setting especially those involving ε n and n to gain further insights into the structure of the non additivities in pawn we computed second and third order effects shown in fig 4 the second and third order sobol indices for each function and parameter are shown in figs s11 s14 in the max θ setting the interactions that have a significant effect on the model output involve the initial sample size n with the number of conditioning intervals n or the stochasticity in the sampling of y u ε such second order effects might contribute up to 15 of the pawn index uncertainty this also applies to the optimum setting where the interaction between n and ε or n and ε has an even higher effect up to 25 uncertainty these three design parameters have significant third order interactions in all three settings fig 4b regarding s t i fig 3b both n and θ have a non negligible first order effect on the index the wide boxplots suggest that both the extent of their influence and the degree of non additivities in defining the final s t i index depends on the model under scrutiny figs s8 s9 4 discussion and conclusions sensitivity analysis is an important tool to check the robustness of a model in the context of its validation however also the measurement of the sensitivity of the output variables to input parameters rests on modelling hypotheses i e sensitivity analysis is a modelling process per se based on the use of an algorithm like the models being investigated here we tested the robustness of this aspect of the modelling process by assessing the dependency of the pawn index to its design parameters and matched the results against the sobol total order index s t i our work thus sheds some light on the uncertainties concealed in the last stage of any sensitivity analysis the implementation of the sensitivity algorithm this practice could help ensuring the adequacy and the range of applicability of the tools which modellers deploy to improve the quality of their modelling exercises two elements emerge from our work the pawn index is more sensitive to the design parameters than s t i and this sensitivity has a complex pattern which makes the use of pawn or better the tuning of the pawn design parameters a delicate task the chances of incurring in false positives mistaking a non influential parameter for influential with a waste of computational resources and or false negatives mistaking an influential parameter for non influential with a loss of useful information are significant even when the design parameter space does not include the maximum as a possible summary statistic but only measures of central tendency even in an ideal setting where the uncertainty in n and θ is highly reduced and n ensures convergence the pawn index might be incapable to differentiate between non influential model inputs and influential model inputs whose effect in the model output is fully through interactions mora et al 2019 also observed that the high level of noise in pawn might produce biased rankings when the model inputs have different orders of magnitude in their contribution to the response pawn especially underperformed when used in the sobol 1998 k 8 and the morris 1991 function k 20 this raises a red flag for analysts when using pawn in high dimensional models such as those commonly being employed in the earth and environmental sciences domain which might easily include tens of parameters sheikholeslami et al 2019 in these contexts the use of pawn might indeed allow to significantly reduce the number of model runs required to conduct a sensitivity analysis but at the expense of significant risks of obtaining a biased result due to its structural design the fact that the sensitivity of pawn to its design parameters is complex including important interactions up to the third order effect implies that finding the perfect range of design parameters to use pawn safely and efficiently is not easy the significant non additivity of pawn only unfolds once the values of its main design parameters are moved simultaneously within reasonable uncertainty ranges this is when all the forking paths and divergences leading towards its computation are assessed at once instead in the paper where the generic approach is presented pianosi and wagener 2018 analysed the influence of n n θ on pawn by combining different discrete point estimates for n and n see their fig 3 or by changing the value for either n or n while keeping the other design parameters fixed see their figs 6 and 7 this approach is very similar to a one at a time oat sensitivity analysis a method that may fail to detect interactions between model parameters due to its incomplete examination of the uncertainty space saltelli and annoni 2010 our work shows that even by increasing n ensuring a high n n ratio or fixing θ at a central tendency measure significant interactions between n and n n and ε or between n n and ε make pawn considerably difficult to tame in our study we also observed the existence of potential interactions between the total number of model runs n and the estimator θ for s t i however the variance in s t i deriving from the uncertainty in its design parameters is comparatively much smaller thus reducing the chances of obtaining a biased ranking or producing a wrong screening it should be stated that our research design for s t i included the use of different estimators out of our willingness to fully explore its potential uncertainty space however there is actually no uncertainty in θ when computing sobol total order indices saltelli et al 2010 showed that the best estimate of the degree to which a given model input interacts with the rest is obtained with the jansen 1999 estimator which should be the default choice this means that the uncertainty in the design parameters of s t i actually narrows down to the total number of model runs n only it is thus to be expected that given two algorithms the one depending on a higher number of design parameters will be the more delicate to use a similar discussion led campolongo et al 2011 to conclude that the screening method of morris could be effectively substituted by s t i we would like to stress that there are many other uncertainties beyond those embedded in sensitivity indices that have the potential to condition the results of a given sensitivity analysis these do not only involve quantifiable elements such as the selection of the distributions sample size or the model output form kaplan and garrick 1981 aven 2020 noacco et al 2019 but also uncertainties in the entire knowledge and model generating processes saltelli et al 2013 algorithmic uncertainties ingrained in the design parameters of sensitivity indices however are especially important for they condition the computational path towards the final sensitivity value although several alternative routes might be available these multiple options are eliminated once the computation is triggered yielding the illusion of a deterministic process we believe that a good way to know whether a sensitivity index is robust is to check how volatile it is when all paths involved in its effective computation are walked at once the present findings do not suggest discarding pawn as a sensitivity measure moment independent measures have a role to play in sensitivity analysis of output with long tailed distributions additionally they may find an ideal use in settings where the output of interest is itself in the form of a difference between two cumulative distributions the present analysis aims at encouraging developers of sensitivity indices to fully explore the structural uncertainty of their algorithms in order to deliver transparent and robust sensitivity tools declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we thank francesca pianosi razi sheikholeslami thorsten wagener and two anonymous reviewers for their constructive comments on previous versions of this manuscript this project has received funding from the european union s horizon 2020 research and innovation programme under the marie skłodowska curie grant agreement no 792178 a p appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j envsoft 2020 104679 appendix a supplementary data the following is the supplementary material related to this article mmc s1 
26033,the pawn index is gaining traction among the modelling community as a sensitivity measure however the robustness to its design parameters has not yet been scrutinized the size n and sampling ε of the model output the number of conditioning intervals n or the summary statistic θ here we fill this gap by running a sensitivity analysis of a pawn based sensitivity analysis we compare the results with the design uncertainties of the sobol total order index s t i unlike in s t i the design uncertainties in pawn create non negligible chances of producing biased results when ranking or screening inputs the dependence of pawn upon n n ε θ is difficult to tame as these parameters interact with one another even in an ideal setting in which the optimum choice for n n ε θ is known in advance pawn might not allow to distinguish an influential non additive model input from a truly non influential model input keywords uncertainty environmental modelling statistics risk 1 introduction pianosi and wagener 2015 2018 have recently published in environmental modelling software a new measure for sensitivity analysis the pawn index like other moment independent approaches i e entropy based liu et al 2006 density based borgonovo et al 2014 borgonovo 2007 pawn does not resort to statistical second order moments such as variance to apportion output uncertainty to the model parameters instead it relies on cumulative distribution functions cdfs to characterize the maximum distance between the unconditional output distribution y u i e obtained by moving all parameters simultaneously and the conditional output distribution y c i j i e obtained by fixing the i th parameter to j 1 2 n values or intervals within its uncertainty range the difference between y u and y c i j is assessed via the kolmogorov smirnov test although other distance based tests such as the anderson darling s may also be used khorashadi zadeh et al 2017 the final pawn index for a given parameter is obtained by calculating the mean the median the maximum or any other summary statistic over all the ks values computed between y u and y c i j the most up to date approximation to the pawn index named the generic approach pianosi and wagener 2018 is as follows let there be an a matrix with v 1 2 n rows and i 1 2 k parameters after computing the model output y the range of variation of the i th parameter is split into j 1 2 n intervals of size n c where n c n n the model output linked to the j th interval is used as the conditional model output y c i j the unconditional model output y u can concur with the whole model output or can be a random sub sample of the same size as n c with this approach the total number of model runs to compute pawn is fully determined by n pianosi and wagener 2018 based on trials with the liu et al 2006 function the ishigami and homma 1990 function the swat model khorashadi zadeh et al 2017 or a wind energy converter model holl et al 2016 it has been observed that pawn might reach convergence much faster than sobol indices a key question however is to know how the selection of n n the sampling of y u or the summary statistic affects the accuracy of pawn this is timely given the widespread adoption of the index since its inception in 2015 pawn has been cited 94 times with the number of citations stably increasing from 5 in 2015 to 31 in 2019 most of the works quoting pawn are from the environmental sciences 53 followed by engineering 24 and computer science 23 scopus search on september 25 2019 gaining a systematic insight into the internal functioning of pawn shall thus allow the modelling community to better appraise its robustness thus increasing its transparency as well as our awareness of its advantages and limitations here we assess the sensitivity of pawn to the main structural uncertainties involving its calculation an exercise that might be termed a sensitivity analysis of a sensitivity analysis sa of sa this expression was used by paleari and confalonieri 2016 to study how sensitivity indices are affected by uncertainties in the probability distributions used to describe the model inputs a work that actually falls into the tradition of probability of probability or probability of frequency described in kaplan and garrick 1981 see also aven 2020 a similar analysis of the sensitivity of results to changes in the range of input factors can be found in shin et al 2013 other approaches include exploring several sensitivity measures 19 23 27 more recently noacco et al 2019 included considerations of form of the output sample size choice of method measuring interactions range of distributions inclusion or exclusion of non behavioural runs simulations and use of dummy variables our experiment departs from these studies in that it assesses the uncertainties embedded in the structural design of sensitivity indices pawn in that case we thus explore the implications of the last ring in the chain of uncertainties characterizing any sensitivity analysis the last stretches of the garden of forking paths that need to be crossed to arrive at a result in any modelling exercise borges 1941 gelman and loken 2013 exploring all sources of uncertainty is indeed an important pursuit including the notions of context purpose and motivations as suggested in sensitivity auditing saltelli et al 2013 however we believe that the papers just reviewed paleari and confalonieri 2016 pappenberger et al 2008 shin et al 2013 noacco et al 2019 are not a sa of a sa but more general instances of uncertainty exploration we take the meaning of sa literally i e the analysis of the sensitivity of a sensitivity analysis to its own design parameters and thus exclude in this paper the exploration of sensitivities to changing methods assumptions or model designs however worthy these analyses might be 2 materials and methods in order to cross check our approach we match the design uncertainties of pawn against the design uncertainties of the sobol total order index s t i a well established measure to determine how much a given model parameter interacts with the rest 1 1 the asterisk in s t i is used to differentiate between sobol total order index s t i i e the index against which pawn is matched and the index used to assess the extent to which s t i interacts with its design parameters n θ s t i although different in scope and nature the fact that unconditional cdfs are also affected by interactions paves the way for the uncertainties in pawn and s t i to be explored in parallel for pawn we focused on four uncertain parameters the total number of model runs n the number of conditioning intervals n the randomness derived from the sampling of the unconditional model output y u ε and the summary statistic θ for s t i we focused on two n and θ the latter reflecting the different estimators existing to compute the total order effect jansen 1999 homma and saltelli 1996 sobol 2007 table 1 we assessed how different combinations of values for these uncertain parameters condition the pawn s t i index using four different test functions that yield a skewed model output fig 1 the liu et al 2006 s which reads as 1 y x 1 x 2 where x 1 χ 2 10 and x 2 χ 2 13 978 the ishigami and homma 1990 s which reads as 2 y sin x 1 a sin x 2 2 b x 3 4 sin x 1 where a 2 b 1 and x 1 x 2 x 3 u π π the sobol 1998 s which reads as 3 y i 1 k 4 x i 2 a i 1 a i where k 8 x i u 0 1 and a 0 1 4 5 9 99 99 99 99 and the morris 1991 function which reads as 4 y β 0 i 1 20 β i w i i j 20 β i j w i w j i j l 20 β i j l w i w j w l i j l s 20 β i j l s w i w j w l w s where w i 2 x i 0 5 for all i except for i 4 5 7 where w i 2 1 1 x i x i 0 1 0 5 x i u 0 1 and β i 20 i 1 2 10 β i j 15 i 1 2 6 β i j l 10 i 1 2 5 β i j l s 5 i 1 2 4 campolongo et al 2011 we chose these four skewed benchmark functions in order to provide pawn with a favourable test ground density based measures might better characterize the uncertainty in skewed model outputs than variance based measures as the former do not rely on any statistical moment borgonovo et al 2011 we selected the distributions of n n ε θ based on previous work on pawn and the s t i index pianosi and wagener 2015 2018 saltelli et al 2010 and some preliminary tests firstly we observed that n 2000 was sufficient for the pawn index of many model inputs to be very close to convergence sobol s t i on the other hand required a larger number of runs fig s1 this corroborated previous observations on the faster convergence rate of pawn compared to sobol indices pianosi and wagener 2015 khorashadi zadeh et al 2017 by defining n u 200 2000 we set our study in a scenario where the uncertainty with regards to the required sample size needed to compute robust pawn indices is moderate indeed this is usually the case the analyst might have a cap on the total number of model runs available with the computing resources at hand but no prior information on the minimum sample size required to ensure stable sensitivity indices for all model inputs we defined the distribution of n based on pianosi and wagener 2018 who suggested to start with n 10 and vary n some units up and down to check its effect provided that n 5 for ε we set 1 0 3 different starting points seeds for the pseudo random number sequence used to generate the indices from 1 to n to sample y u this ensured 1 negligible chances of the same seed overlapping with the same value for n thus introducing determinism into a process that should be mainly stochastic and 2 that the randomness in the sampling of y u is assessed in terms of its relative influence in the computation of pawn with regards to θ for pawn we used the mean the median and the maximum as a summary statistic for the ks values when θ 1 θ 2 and θ 3 for s t i we used the estimators by jansen 1999 homma and saltelli 1996 and sobol 2007 when θ 1 θ 2 and θ 3 respectively in order to estimate the uncertainty propagated by n n ε θ resp n θ to pawn resp s t i we created a 2 13 2 k sample matrix for each function using sobol quasi random number sequences where k 4 resp k 2 and transformed the columns into their appropriate distributions table 1 the first k matrix was labelled a and the second k matrix b our model ran row wise in both the a and b matrices as follows based on the information contained in the v th row it created a sobol matrix of size n v for pawn of size i n t n v k 1 for s t i and computed either the liu et al 2006 the ishigami and homma 1990 the sobol 1998 or the morris 1991 function then for each model input i it either calculated the pawn v index following the conditions set by n v ε v and θ v or the s t i v index according to θ v we estimated how sensitive pawn s t i indices are to uncertainty in n n ε θ resp n θ by means of sobol indices sobol 1993 for a model of the form y f x 1 x 2 x k where y is a scalar and x 1 x 2 x k are independent parameters described by known probability distributions we can measure how sensible y is to a given parameter x i with 5 v i v x i e x i y x i where e x i y x i is the expected value of y calculated over all possible values of all parameters except the i th which is kept fixed by dividing eq 5 by the unconditional model output variance we obtain the first order sensitivity index for x i which describes the proportion of variance in the model output caused by x i 6 s i v i v y we can then decompose the unconditional model output variance y as the sum of conditional variances up to the k th order 7 v y i 1 k v i i i j v i j v 1 2 k where 8 v i j v x i x j e x i j y x i x j v x i e x i y x i v x j e x j y x j from this we can derive the second order index s i j which explains the proportion of variance due to the interaction between x i and x j 9 s i j v i j v y and so on until order k however estimating all terms in eq 7 is impractical when k is large as they result in 2 k 1 in this case we can compute the total order index or s t i which measures the proportion of variance due to the first order effect of x i jointly with its interactions with the other parameters homma and saltelli 1996 10 s t i e x i v x i y x i v y for pawn since k 4 we computed first s i second s i j third s i j k and total order s t i sobol indices of n n ε θ for s t i since k 2 we just computed s i and s t i in both settings we used the saltelli et al 2010 and the jansen 1999 estimators to compute s i and s t i respectively as per the established best practices all the workflow is summarized in fig s2 and the r code to replicate our results is available in github 3 results 3 1 uncertainty analysis fig 2 presents the uncertainty distribution of pawn and s t i for each model input and function the results can be matched against fig s3 where we display how pawn and sobol indices look like once their design parameters are fixed and the total number of model runs is set at n 4000 for pawn we ran three simulations fig 2a 1 with θ including the mean the median and the maximum as possible summary statistics m a x θ setting 2 with θ including the mean and the median only m a x θ setting this aimed at isolating the effect that extreme ks values which might be obtained for specific conditioning intervals have in the final pawn index 3 with n u 2500 4000 n u 15 20 and m a x θ optimum setting this latter run reflects an ideal scenario one in which the number of model runs needed to achieve convergence is known in advance and the uncertainty in n and θ is reduced to the minimum expression for s t i we run one simulation to assess its sensitivity to the uncertainty in the total number of model runs and the estimator n θ with n 200 2000 fig 2b sobol indices might eventually take on values outside the range 0 1 due to numerical artefacts created during the computation this is widely known among sensitivity analysts and managed by considering s t i 0 0 and s t i 1 1 fig 2b only presents s t i 0 1 to allow for a better comparison with the values produced by the pawn index a plot showing the distribution of values with s t i 0 1 is presented in fig s4 3 1 1 factor prioritization fig 2 shows that in a factor prioritization context i e when the aim is to sort the parameters according to their contribution to the model output variance saltelli et al 2007 the uncertainty in the value of the design parameters might cause model inputs to overlap thus raising the likelihood of producing a biased ranking in order to get precise figures for this overlap we computed the coefficient of overlapping i e the area lying under the density curves of two different model inputs following pastore 2018 see fig s5 for a presentation of fig 2 with density curves instead in the case of the ishigami and homma 1990 function the overlap between x 2 and x 3 is of 10 if pawn is used under m a x θ 4 under m a x θ despite x 2 being non influential the overlap with s t i is 0 with the sobol 1998 g function pawn mistakes x 1 for x 2 and x 2 for x 3 11 and 20 of the time respectively if m a x θ 4 and 10 if m a x θ and might even bias the ranking of x 2 and x 4 14 and 9 overlap in m a x θ and m a x θ respectively on the contrary if s t i is used the overlap between x 1 x 2 x 2 x 3 and x 2 x 4 is 0 2 and 1 respectively the case of the liu et al 2006 function deserves a specific comment fig 2 shows that 29 of x 1 and x 2 values overlap if using pawn under m a x θ 13 if m a x θ whereas for s t i the degree of overlap is 55 liu et al 2006 however stated that x 1 was more influential than x 2 based on relative entropy sensitivity methods pianosi and wagener 2015 used the liu et al 2006 function to back up their claim of pawn outperforming sobol indices due to the former being able to discriminate the higher influence of x 1 much better than s t i however the analytical values of s t i in the liu et al 2006 function are identical at x 1 x 2 0 546 see table 2 in liu et al 2006 this means that the overlap between x 1 and x 2 shown in fig 2b is to be expected and does not result from the sensitivity of s t i to the uncertainties in its own structural design 3 1 2 factor screening in a factor screening context i e when the aim is to distinguish influential from non influential parameters saltelli et al 2007 the uncertainty in the pawn design parameters might also lead to erroneous results regardless of whether m a x θ or m a x θ in the case of the sobol 1998 g function 10 14 7 8 of the probability density of x 2 which has a non nihil effect overlaps with x 4 x 8 which have no effect at all the overlap between influential and non influential model inputs if s t i is used on the other side ranges between 0 and 2 the poor screening power of pawn stands out in the case of the morris 1991 function 18 25 1 8 in m a x θ of the probability density of x 8 x 10 which have a moderate first order effect overlap with that of x 11 x 20 which are non influential fig s2a in the case of s t i the overlap ranges in 0 5 the chances of pawn mistaking relevant for non relevant parameters is even higher in the case of parameters whose influence in the model output is through interactions only this is the case of x 1 x 6 in the morris 1991 function whose degree of overlap with x 11 x 20 which are non influential range between 75 95 figs 2 s3 in all these cases the uncertainty in the design parameters of s t i leads to a 0 4 overlap between influential and non influential parameters fig 2 shows that in the optimum setting the overlap between the model inputs is considerably reduced for pawn in the case of the liu et al 2006 and the ishigami and homma 1990 functions the percentage of overlap goes down to zero however the chances of wrongly ranking screening the model inputs remain non negligible for both the sobol 1998 g and the morris 1991 functions in the former there is 17 28 overlap between the slightly influential model input x 3 and x 4 x 8 whose effect cannot be differentiated from the approximation error with regards to the morris 1991 function the chances of characterizing as non influential parameters that have a significant non additive effect in the model output remain very high the overlap of x 1 x 6 with x 11 x 20 for instance range between 35 90 fig 2 as shown in fig s3 the volatility in the computation of pawn does not allow to distinguish x 11 x 20 from a dummy non influential model input 3 2 sensitivity analysis fig 3 presents the sobol first s i and total s t i indices for each of the settings of our analysis after pooling the values from all functions and parameters the sobol indices for each function and design parameter are shown in figs s6 s7 pawn and figs s8 s9 s t i fig 3 thus informs on how much uncertainty each design parameter contributes to each sensitivity index in fig s10 of the supplementary information file we prove that the results displayed in fig 3 are robust without having to correct the stronger weight that the morris function might have in defining the trends due to its much larger number of model inputs as shown in fig 3a the first order effect of θ and n is much more variable in the m a x θ setting suggesting that their degree of contribution to the pawn index uncertainty might considerably be function dependent this variability is highly reduced in the m a x θ setting which provides a more robust account of the extent to which each design parameter contributes to define the pawn index in this setting the selection of the total number of model runs n and the number of conditioning intervals n convey up to c 60 and c 20 of the pawn index uncertainty respectively the stochasticity in the sampling of y u ε is mostly influential through interactions in both settings whereas the selection of the summary statistic θ has a nearly nihil effect in the m a x θ setting remarkably interactions are also significant in the optimum setting especially those involving ε n and n to gain further insights into the structure of the non additivities in pawn we computed second and third order effects shown in fig 4 the second and third order sobol indices for each function and parameter are shown in figs s11 s14 in the max θ setting the interactions that have a significant effect on the model output involve the initial sample size n with the number of conditioning intervals n or the stochasticity in the sampling of y u ε such second order effects might contribute up to 15 of the pawn index uncertainty this also applies to the optimum setting where the interaction between n and ε or n and ε has an even higher effect up to 25 uncertainty these three design parameters have significant third order interactions in all three settings fig 4b regarding s t i fig 3b both n and θ have a non negligible first order effect on the index the wide boxplots suggest that both the extent of their influence and the degree of non additivities in defining the final s t i index depends on the model under scrutiny figs s8 s9 4 discussion and conclusions sensitivity analysis is an important tool to check the robustness of a model in the context of its validation however also the measurement of the sensitivity of the output variables to input parameters rests on modelling hypotheses i e sensitivity analysis is a modelling process per se based on the use of an algorithm like the models being investigated here we tested the robustness of this aspect of the modelling process by assessing the dependency of the pawn index to its design parameters and matched the results against the sobol total order index s t i our work thus sheds some light on the uncertainties concealed in the last stage of any sensitivity analysis the implementation of the sensitivity algorithm this practice could help ensuring the adequacy and the range of applicability of the tools which modellers deploy to improve the quality of their modelling exercises two elements emerge from our work the pawn index is more sensitive to the design parameters than s t i and this sensitivity has a complex pattern which makes the use of pawn or better the tuning of the pawn design parameters a delicate task the chances of incurring in false positives mistaking a non influential parameter for influential with a waste of computational resources and or false negatives mistaking an influential parameter for non influential with a loss of useful information are significant even when the design parameter space does not include the maximum as a possible summary statistic but only measures of central tendency even in an ideal setting where the uncertainty in n and θ is highly reduced and n ensures convergence the pawn index might be incapable to differentiate between non influential model inputs and influential model inputs whose effect in the model output is fully through interactions mora et al 2019 also observed that the high level of noise in pawn might produce biased rankings when the model inputs have different orders of magnitude in their contribution to the response pawn especially underperformed when used in the sobol 1998 k 8 and the morris 1991 function k 20 this raises a red flag for analysts when using pawn in high dimensional models such as those commonly being employed in the earth and environmental sciences domain which might easily include tens of parameters sheikholeslami et al 2019 in these contexts the use of pawn might indeed allow to significantly reduce the number of model runs required to conduct a sensitivity analysis but at the expense of significant risks of obtaining a biased result due to its structural design the fact that the sensitivity of pawn to its design parameters is complex including important interactions up to the third order effect implies that finding the perfect range of design parameters to use pawn safely and efficiently is not easy the significant non additivity of pawn only unfolds once the values of its main design parameters are moved simultaneously within reasonable uncertainty ranges this is when all the forking paths and divergences leading towards its computation are assessed at once instead in the paper where the generic approach is presented pianosi and wagener 2018 analysed the influence of n n θ on pawn by combining different discrete point estimates for n and n see their fig 3 or by changing the value for either n or n while keeping the other design parameters fixed see their figs 6 and 7 this approach is very similar to a one at a time oat sensitivity analysis a method that may fail to detect interactions between model parameters due to its incomplete examination of the uncertainty space saltelli and annoni 2010 our work shows that even by increasing n ensuring a high n n ratio or fixing θ at a central tendency measure significant interactions between n and n n and ε or between n n and ε make pawn considerably difficult to tame in our study we also observed the existence of potential interactions between the total number of model runs n and the estimator θ for s t i however the variance in s t i deriving from the uncertainty in its design parameters is comparatively much smaller thus reducing the chances of obtaining a biased ranking or producing a wrong screening it should be stated that our research design for s t i included the use of different estimators out of our willingness to fully explore its potential uncertainty space however there is actually no uncertainty in θ when computing sobol total order indices saltelli et al 2010 showed that the best estimate of the degree to which a given model input interacts with the rest is obtained with the jansen 1999 estimator which should be the default choice this means that the uncertainty in the design parameters of s t i actually narrows down to the total number of model runs n only it is thus to be expected that given two algorithms the one depending on a higher number of design parameters will be the more delicate to use a similar discussion led campolongo et al 2011 to conclude that the screening method of morris could be effectively substituted by s t i we would like to stress that there are many other uncertainties beyond those embedded in sensitivity indices that have the potential to condition the results of a given sensitivity analysis these do not only involve quantifiable elements such as the selection of the distributions sample size or the model output form kaplan and garrick 1981 aven 2020 noacco et al 2019 but also uncertainties in the entire knowledge and model generating processes saltelli et al 2013 algorithmic uncertainties ingrained in the design parameters of sensitivity indices however are especially important for they condition the computational path towards the final sensitivity value although several alternative routes might be available these multiple options are eliminated once the computation is triggered yielding the illusion of a deterministic process we believe that a good way to know whether a sensitivity index is robust is to check how volatile it is when all paths involved in its effective computation are walked at once the present findings do not suggest discarding pawn as a sensitivity measure moment independent measures have a role to play in sensitivity analysis of output with long tailed distributions additionally they may find an ideal use in settings where the output of interest is itself in the form of a difference between two cumulative distributions the present analysis aims at encouraging developers of sensitivity indices to fully explore the structural uncertainty of their algorithms in order to deliver transparent and robust sensitivity tools declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we thank francesca pianosi razi sheikholeslami thorsten wagener and two anonymous reviewers for their constructive comments on previous versions of this manuscript this project has received funding from the european union s horizon 2020 research and innovation programme under the marie skłodowska curie grant agreement no 792178 a p appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j envsoft 2020 104679 appendix a supplementary data the following is the supplementary material related to this article mmc s1 
26034,forest inventory and analysis database hunter stanke a andrew o finley a b aaron s weed c brian f walters d grant m domke d a department of forestry michigan state university east lansing mi usa department of forestry michigan state university east lansing mi usa department of forestry michigan state university east lansing mi usa b department of geography environment and spatial sciences michigan state university east lansing mi usa department of geography environment and spatial sciences michigan state university east lansing mi usa department of geography michigan state university east lansing mi usa c northeast temperate inventory and monitoring network national park service woodstock vt usa northeast temperate inventory and monitoring network national park service woodstock vt usa northeast temperate inventory and monitoring network national park service woodstock vt usa d forest service northern research station us department of agriculture 1992 folwell avenue st paul mn 55108 usa forest service northern research station us department of agriculture 1992 folwell avenue st paul mn 55108 usa forest service northern research station us department of agriculture 1992 folwell avenue st paul mn 55108 us corresponding author forest inventory and analysis fia is a us department of agriculture forest service program that aims to monitor changes in forests across the us fia hosts one of the largest ecological datasets in the world though its complexity limits access for many potential users rfia is an r package designed to simplify the estimation of forest attributes using data collected by the fia program specifically rfia improves access to the spatio temporal estimation capacity of the fia database via space time indexed summaries of forest variables within user defined population boundaries e g geographic temporal biophysical the package implements multiple design based estimators and has been validated against official estimates and sampling errors produced by the fia program we demonstrate the utility of rfia by assessing changes in abundance and mortality rates of ash fraxinus spp populations in the lower peninsula of michigan following the establishment of emerald ash borer agrilus planipennis keywords forest inventory and analysis r package rfia software availability name of software rfia type of software add on package for r first available 2019 program languages r license gpl 3 code repository https cran r project org web packages rfia index html installation in r install packages rfia developers hunter stanke andrew o finley contact address department of forestry michigan state university east lansing mi usa 1 introduction forest inventory and analysis fia is a united states department of agriculture forest service program with the goal of monitoring and projecting changes in forests across the united states us usda forest service 2019b the program collects publishes and analyzes data describing the extent condition volume growth and use of trees from all land ownerships in the nation with some records dating back to the early 1930s tinkham et al 2018 smith 2002 in 1999 the fia program established a systematic grid of permanent ground plots that are evenly divided into panels measured in a continuous cycle allowing spatially unbiased estimates of forest attributes to be computed on an annual basis gillespie 1999 smith 2002 the flexibility inherent to the fia inventory system creates unprecedented opportunities to assess forest change across space through time and within unique populations of interest tinkham et al 2018 gray et al 2012 the research significance of the fia program has increased in recent decades with primary applications in carbon cycling forest growth forest health and remote sensing tinkham et al 2018 the fia program hosts one of the largest ecological datasets in the world by spatial and temporal extent tinkham et al 2018 including records from over 5 8 million trees measured at least twice and encompassing a range of ecological diversity unmatched by any other large scale national forest inventory system tomppo et al 2010 the breadth of attributes currently measured by the fia program ranging from forest composition and structure to soil chemistry and invasive species abundance makes it a vast and powerful resource for monitoring the status and trends in forest attributes from the scale of individual trees to subcontinents tinkham et al 2018 the primary limitation for individuals using fia data in their own analyses is the complex sample design database structure and structured query language used by the fia program tinkham et al 2018 kromroy et al 2008 fia data are publicly available in several formats e g fia datamart and estimation is facilitated through online tools e g evalidator usda forest service 2019a pugh et al 2018 and a non public r package fiesta frescino et al 2015 that said fia data are difficult for many non fia users to interpret and understand tinkham et al 2018 and there is potential to increase the use of these incredibly rich data among industry professionals academic scientists and the general public to promote use of this valuable public resource and extend the reach of the fia program and the publicly available data there is a need for a flexible user friendly tool that simplifies the process of working with fia data for experts and novices alike to this end we developed rfia an add on package for r r core team 2018a rfia implements fia s design based estimation procedures bechtold et al 2005 for over 50 forest attributes using a simple yet powerful design rfia greatly improves access to the spatio temporal estimation capacity inherent to the fia program by allowing space time indexed summaries of forest attributes to be produced within user defined population boundaries e g geographic temporal biophysical the package enhances the value of fia for temporal change detection and forest health monitoring by implementing five design based estimators that offer flexibility in a balance between precision and temporal smoothing our intention in developing rfia is to provide a versatile user friendly software that allows all r users to unlock the value of the fia program 2 methods 2 1 software design we designed rfia to be intuitive to use and support common data representations by directly integrating other popular r packages into our development we achieve efficient joins queries and data summaries with the dplyr package wickham et al 2015 specifically we leverage dplyr for joining and filtering fia tables facilitating hierarchical grouping of summary attributes and implementing non standard evaluation in rfia core functions we achieve efficient space time query and summary within user defined population boundaries i e spatial polygons with the sf package pebesma 2018 parallel processing is implemented with the parallel package r core team 2018a parallel implementation is achieved using a snow type cluster tierney et al 2018 on any windows os and with multi core forking r core team 2018a on any unix or mac os 2 2 sampling and estimation procedures the design based estimation procedures used by the fia program and implemented by rfia have been widely described in the literature bechtold et al 2005 mcroberts et al 2005a hoffman et al 2014 and hence will only be briefly described here all estimators for population totals ratios and associated variances are derived from the horvitz thompson estimator and hence incorporate design information via inverse probability weighting horvitz and thompson 1952 bechtold et al 2005 describes in detail the theoretical basis for estimators used by the fia program and implemented by rfia the fia program conducts forest inventories using a multi phased sampling procedure designed to reduce variance through stratification bechtold et al 2005 mcroberts et al 2005a in the pre field phase remotely sensed imagery are used to stratify land area by determining dominant land use in each pixel within the population of interest in the core phase permanent ground plots are systematically distributed across the us at a rate of approximately 1 plot per 6000 acres using a hexagonal sampling frame bechtold et al 2005 mcroberts et al 2005a each plot is assigned to a single stratum based on the pre field stratification of the plot center if any portion of a plot is determined to contain a forest land use from pre field stratification a field crew will visit the site and measure core fia variables bechtold et al 2005 in the intensive phase additional forest and ecosystem health variables are measured on 5 15 of established core plots approximately 1 plot per 96 000 acres fia permanent ground plots consist of clusters of four subplots fig 1 where tree attributes are measured for all stems 5 0 in diameter at breast height dbh and larger within each subplot a microplot is established where tree attributes are measured for saplings 1 0 4 9 in dbh each subplot is surrounded by a macroplot on which rare events such as large trees are optionally measured in addition to tree attributes data are collected that describe the area where trees are located on each subplot and macroplot if area attributes e g ownership group forest type stocking vary substantially across a plot the land area within the plot is divided into distinct domains referred to as condition classes so that tree data can be properly associated with area classifications fig 1 plot level estimates of forest attributes e g tree biomass forested area are obtained by summing observations or estimates of the attribute which are within the population of interest e g live trees private land across the plot observations are multiplied by 1 if the attribute is within the population of interest and 0 otherwise thus if all observations on a plot fall outside the population of interest observations will sum to 0 for the plot for ratio estimates e g tree biomass per unit area it is possible to specify different populations of interest for the numerator and denominator attributes the fia program uses an annual panel system to estimate both current inventory and change individual panels are represented by a subset of ground plots that are measured in the same year and represent complete spatial coverage across the population of interest mcroberts and miles 2016 in the eastern us inventory cycles consist of 5 or 7 annual panels with 20 or 15 percent of ground plots measured in each year respectively in the western us inventory cycles include 10 annual panels and thus 10 percent of ground plots are measured each year bechtold et al 2005 variance reduction can often be achieved by combining current panels with data from previous panels although fia does not prescribe a core procedure for panel combination because a single approach is unlikely to be suitable for all estimation objectives or across a wide variety of spatial temporal and population conditions bechtold et al 2005 in rfia users may choose from one of four unique estimators that combine data from multiple panels or choose to return estimates from individual annual panels annual thereby forgoing panel combination entirely the temporally indifferent ti estimator is used by default essentially pooling all panels within an inventory cycle into a large periodic inventory the ti estimator is commonly used by other fia estimation tools like evalidator usda forest service 2019a pugh et al 2018 alternatively individual panels may be weighted by employing a moving average estimator including the simple moving average sma linear moving average lma or exponential moving average ema the sma applies equal weight to all annual panels eq 1 while the lma and ema apply weights that decay linearly or exponentially as a function of time since measurement respectively eqs 2 3 in each case of the moving average panel weights sum to one across an inventory cycle panel weights are computed as follows 1 w p s m a 1 n 2 w p l m a p i 1 n p i 3 w p e m a λ 1 λ 1 p i 1 n λ 1 λ 1 p i where w p is the constant positive weight for annual panel p described as the sequential index of the panel within an inventory cycle i e p 1 2 n n is the total number of annual panels in the inventory cycle and λ is a decay parameter ranging between zero and one that controls the behavior of the exponential weighting function eq 3 as λ approaches 1 panel weights become nearly evenly distributed across the inventory cycle and estimates produced by the ema will approach those of the sma as λ approaches 0 weights are skewed towards the most recent panel and estimates of the ema will approach those of individual annual panels the inclusion of λ makes the ema the most versatile estimator offered in rfia in general sample variance is minimized when panel weights are evenly distributed across the inventory cycle e g sma with the trade off of introducing temporal lag bias by weighting recent measurements the same as older measurements hence equal weighting schemes could be undesirable in settings where variable values change over time alternatively applying lower weights to less recent panels reduces the effective sample size of the inventory effectively increasing variance but reducing temporal smoothing by favoring more recent measurements we advise users of rfia to be aware of this trade off between precision and temporal smoothing when considering various estimators offered in the package 2 3 software testing we have conducted extensive validation for all estimated attributes for small and large areas against evalidator usda forest service 2019a here we present an abbreviated version of a validation for the state of connecticut in the year 2018 using the temporally indifferent estimator table 1 current status estimates were produced for live trees with dbh 1 0 inch and annual change estimates were produced for all stems with dbh 5 0 in down woody material estimates were produced for the 1000 h fuel class coarse woody debris total forest area estimates were produced using plots containing a forested condition all estimates and associated sampling errors produced by rfia match those produced by evalidator a detailed description of the validation described in table 1 including code used to produce estimates using rfia can be found in appendix a 3 rfia package features rfia is capable of estimating more forest attributes from fia data than any other publicly available tool and offers unmatched flexibility in defining unique populations of interest and producing space time indexed summaries of forest attributes users can install the released version of rfia from cran v0 1 0 28 october 2019 or alternatively install the development version from github https github com hunter stanke rfia using devtools wickham et al 2019 table 2 depicts a list of core functions available in rfia a schematic diagram for using rfia to produce population estimates of forest attributes can be found in fig 2 3 1 loading fia data users can automatically download state subsets of the fia database usda forest service 2019a load these data into r and optionally save to disk using getfia simply specify the state abbreviation code for the state s of interest as a character vector in the states argument of getfia e g states ct for connecticut alternatively getfia can be used to download load and optionally save select table s contained in the fia database by specifying the names of the tables of interest in the tables argument e g tables c tree plot for the tree and plot tables all fia data are downloaded from the fia datamart usda forest service 2019a and saved as comma delimited text files in a local directory if fia data are already saved on disk as comma delimited text files readfia can be used to load these data into r readfia requires that fia data files maintain original fia naming conventions as downloaded from the fia datamart for referential integrity all fia data files should be stored in a single directory with no sub directories for proper loading with readfia we recommend using getfia to download and save new fia data and readfia to reload these data in future r sessions all data loaded with getfia or readfia are stored as a modified list object called a fia database all common list operations are valid for the fia database object class and individual fia tables can be accessed using the operator 3 2 spatial and temporal subsets spatial and or temporal subsets of a fia database may be implemented with clipfia if users are interested in producing estimates for select areal regions and or time periods contained within the spatial temporal extent of the fia database such subsets are not required to use rfia estimator functions listed in table 3 to produce estimates of forest attributes however limiting the spatial and temporal extent of the query region will conserve memory and decrease processing time users may subset a fia database to the boundaries of a spatial polygon object by specifying the name of the spatial object in the mask argument of clipfia all spatial polygon classes from the sp and sf packages are supported to obtain the most recent subset of a fia database by reporting year specify mostrecent true in clipfia true by default if a fia database contains multiple states with different reporting schedules setting mostrecent true will return the data necessary to produce estimates for the most recent reporting year in each state alternatively users may specify matcheval true to obtain a subset of data associated with reporting years which are common among all states in the fia database 3 3 estimating forest attributes rfia includes a range of estimator functions designed to produce population and plot level estimates directly from fia database objects all estimator functions share a similar design although minor nuances exist between functions due to variation in the forms of estimates they invoke table 3 we will demonstrate the functionality of rfia estimator functions using biomass a function designed to estimate volume biomass and carbon of standing trees to produce population estimates for the region contained within the spatial extent of a fia database specify the name of the fia database as the db argument of any rfia estimator function all rfia estimator functions return population estimates and associated sampling errors for each reporting year in the fia database by default to return estimates at the plot level specify byplot true in this case estimates will be returned for each occasion that an individual plot was measured 3 3 1 grouped estimates often it is useful to produce estimates grouped by discrete categories such as species forest type ownership group or diameter class rfia estimator functions can produce estimates grouped by fields contained in the plot cond and tree tables of a fia database to produce grouped estimates specify the name s of fields representing the grouping variable s as the grpby argument of any estimator function if more than one grouping variable is provided to grpby grouping will occur hierarchically based on the order variable names are listed in addition to grpby some rfia estimator functions include byspecies and bysizeclass arguments for convenience set either of these arguments as true to produced estimates grouped by species and or 2 0 inch dbh classes respectively alternatively users may specify grpby spcd to group estimates by species and use the makeclasses function to define their own diameter classes more information on variable definitions in the fia database can be found in the fia database description and user guide for phase 2 burrill et al 2018 3 3 2 unique populations of interest in many cases the population of interest is a subset of that represented by the full fia database for example we may be interested in producing estimates for live stems greater than 12 0 in dbh on state owned land within biomass and most other estimator functions we can use the treedomain and areadomain arguments to describe our population of interest in terms of variables contained in the plot cond and tree tables of a fia database here treedomain describes the population of interest for the numerator tree biomass and areadomain the population of interest for the denominator state owned forest land area in each case the argument takes the form of a logical predicate that is defined in terms of the variables in plot tree and or cond tables of the fia database multiple conditions can be combined within either argument using or symbols and or respectively 3 3 3 grouping by user defined areal units to produce estimates grouped by unique areal units specify the name of a spatial polygon object class sp or sf defining the areal units of interest as the polys argument of any rfia estimator function all fia data are automatically re projected to match the projection of the input spatial polygon object prior to initiating estimation procedures all fields originally contained in the input spatial polygon object will be preserved in the estimates output by the estimator function to return estimates as an sf spatial polygon object specify returnspatial true 3 3 4 alternative estimators all rfia estimator functions use the temporally indifferent estimator by default method ti for consistency with other fia estimation tools like evalidator usda forest service 2019a pugh et al 2018 as an alternative users may set the method argument to sma lma ema or annual to use the simple moving average linear moving average exponential moving average or annual estimator respectively if using the exponential moving average users may also modify the exponential decay parameter λ eq 1 with the lambda argument by default lambda is set to 0 5 although can be set to any value on the interval 0 1 if multiple values are specified as the lambda argument one unique set of estimates will be returned for each unique value of lambda for example lambda seq from 0 1 to 0 9 by 0 1 will produce nine unique sets of estimates grouped by lambda 3 3 5 parallelization parallel processing is available in all rfia estimator functions using the ncores argument ncores indicates the number of physical cores to be used and may be set to any positive integer up to the number of physical cores available on a given machine serial processing is implemented by default ncores 1 parallelization may substantially reduce memory during processing thus users should consider implementing serial processing if computational resources are limited if implementing parallel processing we recommend users set ncores to one less than the number of physical cores available on their machine to ensure computational resources are available for other processes e g os browsers 4 case study michigan ash decline we demonstrate the utility of rfia for forest resource monitoring by assessing the decline of ash fraxinus spp populations across the lower peninsula of michigan following the establishment of emerald ash borer agrilus planipennis fairmaire emerald ash borer is an invasive forest insect that was first discovered in southeastern michigan in 2002 the insect spread quickly across the state and is considered one of the most destructive and costly forest insects to invade the united states poland and mccullough 2006 aukema et al 2011 using the temporally indifferent estimator in rfia we estimated annual changes in live ash trees per acre tpa and tree mortality rates mortality tpa per year by county during the interval 2006 2018 to highlight differences among alternative design based estimators implemented in rfia we use each estimator to assess changes in ash sawlog stocks board feet per acre across the entire lower peninsula from 2000 to 2018 and compare their relative performance lambda 0 5 used for ema estimator all estimates were produced for white ash fraxinus americana l green ash fraxinus pennsylvanica marshall and black ash fraxinus nigra marshall trees 5 in dbh a rapid decline of ash populations across michigan counties is evident from our analysis live ash tpa decreased by 61 and annual mortality increased by 583 across the study region from 2006 to 2018 temporally indifferent estimator elevated mortality rates and population decline are apparent in the southeastern portion of the state soon after the establishment of emerald ash borer in the region fig 3 2006 and 2010 in years following ash population decline and elevated mortality became evident across the lower peninsula likely associated with the rapid expansion of emerald ash borer across the state fig 3 2014 and 2018 sampling error is directly related to the number of non zero observations i e fia ground plots used to compute estimates of each variable and cannot be determined if less than two non zero observations are available decreasing precision i e increased sampling errors associated with live tpa fig 3 bottom left and sawlog volume fig 4 bottom estimates indicates that the number of live ash trees located on fia ground plots decreased over time ash mortality appeared to be a relatively rare event prior to the expansion of emerald ash borer across michigan as many counties recorded fewer than two observations of ash mortality per sampling period gray shaded counties in bottom right of fig 3 the increased frequency of ash mortality observations across michigan counties and associated reduction in sampling error provides support for the trend of increased mortality rates that is evident following the establishment of emerald ash borer across the state a trade off between temporal smoothing and precision is evident in comparing the behavior of design based estimators implemented in rfia fig 4 for example the annual estimator annual appears to indicate a sharper and earlier decline lower temporal smoothing in the ash sawlog resource than the temporally indifferent ti and simple moving average sma estimators though the annual estimator consistently produces higher sampling errors lower precision fig 4 estimators that give more weight to recent observations like the annual 100 of weight on most recent observation linear moving average lma and exponential moving average ema tend to exhibit lower temporal lag bias but at the cost of higher variance in contrast estimators that distribute weight more evenly across observations with respect to time like the temporally indifferent no annual weighting treated as periodic inventory and simple moving average tend to exhibit higher temporal smoothing but lower variance in practice we recommend users carefully consider this trade off and choose an estimator that achieves both their desired precision standards and an acceptably low level of temporal lag bias 5 extensions limitations in the future we hope to expand rfia to include model based and model assisted techniques allowing users to leverage various forms of auxiliary data to improve estimation of forest attributes specifically we hope to improve estimation within small domains e g spatial temporal extents rare forest attributes by implementing a number of indirect and composite small area estimators further we hope to improve the value of the fia database for detection and analysis of rapid changes in forest health through the implementation of kalman filters as time series estimators program r is an in memory application by design and rfia requires all input data to be held in ram hence users may experience memory management challenges when computational resources are limited memory constraints may inhibit some users from loading or processing large subsets of fia data relative to available computational resources and high memory usage may result in decreased computational efficiency future development seeks to leverage dplyr wickham et al 2015 back ends for external database engines such as sqlite and apache spark thus reducing memory limitations and potentially offering substantial improvements in computational efficiency for large data exact coordinates of fia ground plots are not available in the public version of the fia database to protect privacy rights of private land owners and preserve the ecological integrity of ground plots tinkham et al 2018 mcroberts et al 2005a plot locations are randomly displaced up to 1 km from their true locations i e fuzzed and the coordinates of up to 20 of plots on private land in each county are exchanged i e swapped bechtold et al 2005 tinkham et al 2018 the effects of using fuzzed and swapped plot coordinates are thought to be negligible for design based estimation across large regions 800 000 acres and larger mcroberts et al 2005b however uncertainty in true plot locations may produce results within unknown amounts of error when used in conjunction with other spatially explicit data layers for model based estimation sabor et al 2007 hence we encourage rfia users to consider this uncertainty when using design based estimation for small populations and when producing plot level estimates to be used with spatially explicit auxiliary data in a model based or model assisted estimation framework 6 conclusion the fia database is among the most valuable ecological datasets in the world though its complexity limits access for many potential users we developed rfia to simplify the estimation of forest attributes using fia data intending to provide a flexible yet powerful toolset which is accessible to all r users ultimately we hope that rfia will improve the accessibility and relevance of the fia database and promote use of fia data among a larger more diverse audience we encourage users to apply rfia widely and report any issues and or desired extensions on our active issues page https github com hunter stanke rfia issues declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national science foundation grants dms 1916395 ef 1241874 ef 1253225 national aeronautics and space administration carbon monitoring system program and united states national park service and forest service appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j envsoft 2020 104664 appendix a supplementary data the following is the supplementary material related to this article mmc s1 appendix a software testing 
26034,forest inventory and analysis database hunter stanke a andrew o finley a b aaron s weed c brian f walters d grant m domke d a department of forestry michigan state university east lansing mi usa department of forestry michigan state university east lansing mi usa department of forestry michigan state university east lansing mi usa b department of geography environment and spatial sciences michigan state university east lansing mi usa department of geography environment and spatial sciences michigan state university east lansing mi usa department of geography michigan state university east lansing mi usa c northeast temperate inventory and monitoring network national park service woodstock vt usa northeast temperate inventory and monitoring network national park service woodstock vt usa northeast temperate inventory and monitoring network national park service woodstock vt usa d forest service northern research station us department of agriculture 1992 folwell avenue st paul mn 55108 usa forest service northern research station us department of agriculture 1992 folwell avenue st paul mn 55108 usa forest service northern research station us department of agriculture 1992 folwell avenue st paul mn 55108 us corresponding author forest inventory and analysis fia is a us department of agriculture forest service program that aims to monitor changes in forests across the us fia hosts one of the largest ecological datasets in the world though its complexity limits access for many potential users rfia is an r package designed to simplify the estimation of forest attributes using data collected by the fia program specifically rfia improves access to the spatio temporal estimation capacity of the fia database via space time indexed summaries of forest variables within user defined population boundaries e g geographic temporal biophysical the package implements multiple design based estimators and has been validated against official estimates and sampling errors produced by the fia program we demonstrate the utility of rfia by assessing changes in abundance and mortality rates of ash fraxinus spp populations in the lower peninsula of michigan following the establishment of emerald ash borer agrilus planipennis keywords forest inventory and analysis r package rfia software availability name of software rfia type of software add on package for r first available 2019 program languages r license gpl 3 code repository https cran r project org web packages rfia index html installation in r install packages rfia developers hunter stanke andrew o finley contact address department of forestry michigan state university east lansing mi usa 1 introduction forest inventory and analysis fia is a united states department of agriculture forest service program with the goal of monitoring and projecting changes in forests across the united states us usda forest service 2019b the program collects publishes and analyzes data describing the extent condition volume growth and use of trees from all land ownerships in the nation with some records dating back to the early 1930s tinkham et al 2018 smith 2002 in 1999 the fia program established a systematic grid of permanent ground plots that are evenly divided into panels measured in a continuous cycle allowing spatially unbiased estimates of forest attributes to be computed on an annual basis gillespie 1999 smith 2002 the flexibility inherent to the fia inventory system creates unprecedented opportunities to assess forest change across space through time and within unique populations of interest tinkham et al 2018 gray et al 2012 the research significance of the fia program has increased in recent decades with primary applications in carbon cycling forest growth forest health and remote sensing tinkham et al 2018 the fia program hosts one of the largest ecological datasets in the world by spatial and temporal extent tinkham et al 2018 including records from over 5 8 million trees measured at least twice and encompassing a range of ecological diversity unmatched by any other large scale national forest inventory system tomppo et al 2010 the breadth of attributes currently measured by the fia program ranging from forest composition and structure to soil chemistry and invasive species abundance makes it a vast and powerful resource for monitoring the status and trends in forest attributes from the scale of individual trees to subcontinents tinkham et al 2018 the primary limitation for individuals using fia data in their own analyses is the complex sample design database structure and structured query language used by the fia program tinkham et al 2018 kromroy et al 2008 fia data are publicly available in several formats e g fia datamart and estimation is facilitated through online tools e g evalidator usda forest service 2019a pugh et al 2018 and a non public r package fiesta frescino et al 2015 that said fia data are difficult for many non fia users to interpret and understand tinkham et al 2018 and there is potential to increase the use of these incredibly rich data among industry professionals academic scientists and the general public to promote use of this valuable public resource and extend the reach of the fia program and the publicly available data there is a need for a flexible user friendly tool that simplifies the process of working with fia data for experts and novices alike to this end we developed rfia an add on package for r r core team 2018a rfia implements fia s design based estimation procedures bechtold et al 2005 for over 50 forest attributes using a simple yet powerful design rfia greatly improves access to the spatio temporal estimation capacity inherent to the fia program by allowing space time indexed summaries of forest attributes to be produced within user defined population boundaries e g geographic temporal biophysical the package enhances the value of fia for temporal change detection and forest health monitoring by implementing five design based estimators that offer flexibility in a balance between precision and temporal smoothing our intention in developing rfia is to provide a versatile user friendly software that allows all r users to unlock the value of the fia program 2 methods 2 1 software design we designed rfia to be intuitive to use and support common data representations by directly integrating other popular r packages into our development we achieve efficient joins queries and data summaries with the dplyr package wickham et al 2015 specifically we leverage dplyr for joining and filtering fia tables facilitating hierarchical grouping of summary attributes and implementing non standard evaluation in rfia core functions we achieve efficient space time query and summary within user defined population boundaries i e spatial polygons with the sf package pebesma 2018 parallel processing is implemented with the parallel package r core team 2018a parallel implementation is achieved using a snow type cluster tierney et al 2018 on any windows os and with multi core forking r core team 2018a on any unix or mac os 2 2 sampling and estimation procedures the design based estimation procedures used by the fia program and implemented by rfia have been widely described in the literature bechtold et al 2005 mcroberts et al 2005a hoffman et al 2014 and hence will only be briefly described here all estimators for population totals ratios and associated variances are derived from the horvitz thompson estimator and hence incorporate design information via inverse probability weighting horvitz and thompson 1952 bechtold et al 2005 describes in detail the theoretical basis for estimators used by the fia program and implemented by rfia the fia program conducts forest inventories using a multi phased sampling procedure designed to reduce variance through stratification bechtold et al 2005 mcroberts et al 2005a in the pre field phase remotely sensed imagery are used to stratify land area by determining dominant land use in each pixel within the population of interest in the core phase permanent ground plots are systematically distributed across the us at a rate of approximately 1 plot per 6000 acres using a hexagonal sampling frame bechtold et al 2005 mcroberts et al 2005a each plot is assigned to a single stratum based on the pre field stratification of the plot center if any portion of a plot is determined to contain a forest land use from pre field stratification a field crew will visit the site and measure core fia variables bechtold et al 2005 in the intensive phase additional forest and ecosystem health variables are measured on 5 15 of established core plots approximately 1 plot per 96 000 acres fia permanent ground plots consist of clusters of four subplots fig 1 where tree attributes are measured for all stems 5 0 in diameter at breast height dbh and larger within each subplot a microplot is established where tree attributes are measured for saplings 1 0 4 9 in dbh each subplot is surrounded by a macroplot on which rare events such as large trees are optionally measured in addition to tree attributes data are collected that describe the area where trees are located on each subplot and macroplot if area attributes e g ownership group forest type stocking vary substantially across a plot the land area within the plot is divided into distinct domains referred to as condition classes so that tree data can be properly associated with area classifications fig 1 plot level estimates of forest attributes e g tree biomass forested area are obtained by summing observations or estimates of the attribute which are within the population of interest e g live trees private land across the plot observations are multiplied by 1 if the attribute is within the population of interest and 0 otherwise thus if all observations on a plot fall outside the population of interest observations will sum to 0 for the plot for ratio estimates e g tree biomass per unit area it is possible to specify different populations of interest for the numerator and denominator attributes the fia program uses an annual panel system to estimate both current inventory and change individual panels are represented by a subset of ground plots that are measured in the same year and represent complete spatial coverage across the population of interest mcroberts and miles 2016 in the eastern us inventory cycles consist of 5 or 7 annual panels with 20 or 15 percent of ground plots measured in each year respectively in the western us inventory cycles include 10 annual panels and thus 10 percent of ground plots are measured each year bechtold et al 2005 variance reduction can often be achieved by combining current panels with data from previous panels although fia does not prescribe a core procedure for panel combination because a single approach is unlikely to be suitable for all estimation objectives or across a wide variety of spatial temporal and population conditions bechtold et al 2005 in rfia users may choose from one of four unique estimators that combine data from multiple panels or choose to return estimates from individual annual panels annual thereby forgoing panel combination entirely the temporally indifferent ti estimator is used by default essentially pooling all panels within an inventory cycle into a large periodic inventory the ti estimator is commonly used by other fia estimation tools like evalidator usda forest service 2019a pugh et al 2018 alternatively individual panels may be weighted by employing a moving average estimator including the simple moving average sma linear moving average lma or exponential moving average ema the sma applies equal weight to all annual panels eq 1 while the lma and ema apply weights that decay linearly or exponentially as a function of time since measurement respectively eqs 2 3 in each case of the moving average panel weights sum to one across an inventory cycle panel weights are computed as follows 1 w p s m a 1 n 2 w p l m a p i 1 n p i 3 w p e m a λ 1 λ 1 p i 1 n λ 1 λ 1 p i where w p is the constant positive weight for annual panel p described as the sequential index of the panel within an inventory cycle i e p 1 2 n n is the total number of annual panels in the inventory cycle and λ is a decay parameter ranging between zero and one that controls the behavior of the exponential weighting function eq 3 as λ approaches 1 panel weights become nearly evenly distributed across the inventory cycle and estimates produced by the ema will approach those of the sma as λ approaches 0 weights are skewed towards the most recent panel and estimates of the ema will approach those of individual annual panels the inclusion of λ makes the ema the most versatile estimator offered in rfia in general sample variance is minimized when panel weights are evenly distributed across the inventory cycle e g sma with the trade off of introducing temporal lag bias by weighting recent measurements the same as older measurements hence equal weighting schemes could be undesirable in settings where variable values change over time alternatively applying lower weights to less recent panels reduces the effective sample size of the inventory effectively increasing variance but reducing temporal smoothing by favoring more recent measurements we advise users of rfia to be aware of this trade off between precision and temporal smoothing when considering various estimators offered in the package 2 3 software testing we have conducted extensive validation for all estimated attributes for small and large areas against evalidator usda forest service 2019a here we present an abbreviated version of a validation for the state of connecticut in the year 2018 using the temporally indifferent estimator table 1 current status estimates were produced for live trees with dbh 1 0 inch and annual change estimates were produced for all stems with dbh 5 0 in down woody material estimates were produced for the 1000 h fuel class coarse woody debris total forest area estimates were produced using plots containing a forested condition all estimates and associated sampling errors produced by rfia match those produced by evalidator a detailed description of the validation described in table 1 including code used to produce estimates using rfia can be found in appendix a 3 rfia package features rfia is capable of estimating more forest attributes from fia data than any other publicly available tool and offers unmatched flexibility in defining unique populations of interest and producing space time indexed summaries of forest attributes users can install the released version of rfia from cran v0 1 0 28 october 2019 or alternatively install the development version from github https github com hunter stanke rfia using devtools wickham et al 2019 table 2 depicts a list of core functions available in rfia a schematic diagram for using rfia to produce population estimates of forest attributes can be found in fig 2 3 1 loading fia data users can automatically download state subsets of the fia database usda forest service 2019a load these data into r and optionally save to disk using getfia simply specify the state abbreviation code for the state s of interest as a character vector in the states argument of getfia e g states ct for connecticut alternatively getfia can be used to download load and optionally save select table s contained in the fia database by specifying the names of the tables of interest in the tables argument e g tables c tree plot for the tree and plot tables all fia data are downloaded from the fia datamart usda forest service 2019a and saved as comma delimited text files in a local directory if fia data are already saved on disk as comma delimited text files readfia can be used to load these data into r readfia requires that fia data files maintain original fia naming conventions as downloaded from the fia datamart for referential integrity all fia data files should be stored in a single directory with no sub directories for proper loading with readfia we recommend using getfia to download and save new fia data and readfia to reload these data in future r sessions all data loaded with getfia or readfia are stored as a modified list object called a fia database all common list operations are valid for the fia database object class and individual fia tables can be accessed using the operator 3 2 spatial and temporal subsets spatial and or temporal subsets of a fia database may be implemented with clipfia if users are interested in producing estimates for select areal regions and or time periods contained within the spatial temporal extent of the fia database such subsets are not required to use rfia estimator functions listed in table 3 to produce estimates of forest attributes however limiting the spatial and temporal extent of the query region will conserve memory and decrease processing time users may subset a fia database to the boundaries of a spatial polygon object by specifying the name of the spatial object in the mask argument of clipfia all spatial polygon classes from the sp and sf packages are supported to obtain the most recent subset of a fia database by reporting year specify mostrecent true in clipfia true by default if a fia database contains multiple states with different reporting schedules setting mostrecent true will return the data necessary to produce estimates for the most recent reporting year in each state alternatively users may specify matcheval true to obtain a subset of data associated with reporting years which are common among all states in the fia database 3 3 estimating forest attributes rfia includes a range of estimator functions designed to produce population and plot level estimates directly from fia database objects all estimator functions share a similar design although minor nuances exist between functions due to variation in the forms of estimates they invoke table 3 we will demonstrate the functionality of rfia estimator functions using biomass a function designed to estimate volume biomass and carbon of standing trees to produce population estimates for the region contained within the spatial extent of a fia database specify the name of the fia database as the db argument of any rfia estimator function all rfia estimator functions return population estimates and associated sampling errors for each reporting year in the fia database by default to return estimates at the plot level specify byplot true in this case estimates will be returned for each occasion that an individual plot was measured 3 3 1 grouped estimates often it is useful to produce estimates grouped by discrete categories such as species forest type ownership group or diameter class rfia estimator functions can produce estimates grouped by fields contained in the plot cond and tree tables of a fia database to produce grouped estimates specify the name s of fields representing the grouping variable s as the grpby argument of any estimator function if more than one grouping variable is provided to grpby grouping will occur hierarchically based on the order variable names are listed in addition to grpby some rfia estimator functions include byspecies and bysizeclass arguments for convenience set either of these arguments as true to produced estimates grouped by species and or 2 0 inch dbh classes respectively alternatively users may specify grpby spcd to group estimates by species and use the makeclasses function to define their own diameter classes more information on variable definitions in the fia database can be found in the fia database description and user guide for phase 2 burrill et al 2018 3 3 2 unique populations of interest in many cases the population of interest is a subset of that represented by the full fia database for example we may be interested in producing estimates for live stems greater than 12 0 in dbh on state owned land within biomass and most other estimator functions we can use the treedomain and areadomain arguments to describe our population of interest in terms of variables contained in the plot cond and tree tables of a fia database here treedomain describes the population of interest for the numerator tree biomass and areadomain the population of interest for the denominator state owned forest land area in each case the argument takes the form of a logical predicate that is defined in terms of the variables in plot tree and or cond tables of the fia database multiple conditions can be combined within either argument using or symbols and or respectively 3 3 3 grouping by user defined areal units to produce estimates grouped by unique areal units specify the name of a spatial polygon object class sp or sf defining the areal units of interest as the polys argument of any rfia estimator function all fia data are automatically re projected to match the projection of the input spatial polygon object prior to initiating estimation procedures all fields originally contained in the input spatial polygon object will be preserved in the estimates output by the estimator function to return estimates as an sf spatial polygon object specify returnspatial true 3 3 4 alternative estimators all rfia estimator functions use the temporally indifferent estimator by default method ti for consistency with other fia estimation tools like evalidator usda forest service 2019a pugh et al 2018 as an alternative users may set the method argument to sma lma ema or annual to use the simple moving average linear moving average exponential moving average or annual estimator respectively if using the exponential moving average users may also modify the exponential decay parameter λ eq 1 with the lambda argument by default lambda is set to 0 5 although can be set to any value on the interval 0 1 if multiple values are specified as the lambda argument one unique set of estimates will be returned for each unique value of lambda for example lambda seq from 0 1 to 0 9 by 0 1 will produce nine unique sets of estimates grouped by lambda 3 3 5 parallelization parallel processing is available in all rfia estimator functions using the ncores argument ncores indicates the number of physical cores to be used and may be set to any positive integer up to the number of physical cores available on a given machine serial processing is implemented by default ncores 1 parallelization may substantially reduce memory during processing thus users should consider implementing serial processing if computational resources are limited if implementing parallel processing we recommend users set ncores to one less than the number of physical cores available on their machine to ensure computational resources are available for other processes e g os browsers 4 case study michigan ash decline we demonstrate the utility of rfia for forest resource monitoring by assessing the decline of ash fraxinus spp populations across the lower peninsula of michigan following the establishment of emerald ash borer agrilus planipennis fairmaire emerald ash borer is an invasive forest insect that was first discovered in southeastern michigan in 2002 the insect spread quickly across the state and is considered one of the most destructive and costly forest insects to invade the united states poland and mccullough 2006 aukema et al 2011 using the temporally indifferent estimator in rfia we estimated annual changes in live ash trees per acre tpa and tree mortality rates mortality tpa per year by county during the interval 2006 2018 to highlight differences among alternative design based estimators implemented in rfia we use each estimator to assess changes in ash sawlog stocks board feet per acre across the entire lower peninsula from 2000 to 2018 and compare their relative performance lambda 0 5 used for ema estimator all estimates were produced for white ash fraxinus americana l green ash fraxinus pennsylvanica marshall and black ash fraxinus nigra marshall trees 5 in dbh a rapid decline of ash populations across michigan counties is evident from our analysis live ash tpa decreased by 61 and annual mortality increased by 583 across the study region from 2006 to 2018 temporally indifferent estimator elevated mortality rates and population decline are apparent in the southeastern portion of the state soon after the establishment of emerald ash borer in the region fig 3 2006 and 2010 in years following ash population decline and elevated mortality became evident across the lower peninsula likely associated with the rapid expansion of emerald ash borer across the state fig 3 2014 and 2018 sampling error is directly related to the number of non zero observations i e fia ground plots used to compute estimates of each variable and cannot be determined if less than two non zero observations are available decreasing precision i e increased sampling errors associated with live tpa fig 3 bottom left and sawlog volume fig 4 bottom estimates indicates that the number of live ash trees located on fia ground plots decreased over time ash mortality appeared to be a relatively rare event prior to the expansion of emerald ash borer across michigan as many counties recorded fewer than two observations of ash mortality per sampling period gray shaded counties in bottom right of fig 3 the increased frequency of ash mortality observations across michigan counties and associated reduction in sampling error provides support for the trend of increased mortality rates that is evident following the establishment of emerald ash borer across the state a trade off between temporal smoothing and precision is evident in comparing the behavior of design based estimators implemented in rfia fig 4 for example the annual estimator annual appears to indicate a sharper and earlier decline lower temporal smoothing in the ash sawlog resource than the temporally indifferent ti and simple moving average sma estimators though the annual estimator consistently produces higher sampling errors lower precision fig 4 estimators that give more weight to recent observations like the annual 100 of weight on most recent observation linear moving average lma and exponential moving average ema tend to exhibit lower temporal lag bias but at the cost of higher variance in contrast estimators that distribute weight more evenly across observations with respect to time like the temporally indifferent no annual weighting treated as periodic inventory and simple moving average tend to exhibit higher temporal smoothing but lower variance in practice we recommend users carefully consider this trade off and choose an estimator that achieves both their desired precision standards and an acceptably low level of temporal lag bias 5 extensions limitations in the future we hope to expand rfia to include model based and model assisted techniques allowing users to leverage various forms of auxiliary data to improve estimation of forest attributes specifically we hope to improve estimation within small domains e g spatial temporal extents rare forest attributes by implementing a number of indirect and composite small area estimators further we hope to improve the value of the fia database for detection and analysis of rapid changes in forest health through the implementation of kalman filters as time series estimators program r is an in memory application by design and rfia requires all input data to be held in ram hence users may experience memory management challenges when computational resources are limited memory constraints may inhibit some users from loading or processing large subsets of fia data relative to available computational resources and high memory usage may result in decreased computational efficiency future development seeks to leverage dplyr wickham et al 2015 back ends for external database engines such as sqlite and apache spark thus reducing memory limitations and potentially offering substantial improvements in computational efficiency for large data exact coordinates of fia ground plots are not available in the public version of the fia database to protect privacy rights of private land owners and preserve the ecological integrity of ground plots tinkham et al 2018 mcroberts et al 2005a plot locations are randomly displaced up to 1 km from their true locations i e fuzzed and the coordinates of up to 20 of plots on private land in each county are exchanged i e swapped bechtold et al 2005 tinkham et al 2018 the effects of using fuzzed and swapped plot coordinates are thought to be negligible for design based estimation across large regions 800 000 acres and larger mcroberts et al 2005b however uncertainty in true plot locations may produce results within unknown amounts of error when used in conjunction with other spatially explicit data layers for model based estimation sabor et al 2007 hence we encourage rfia users to consider this uncertainty when using design based estimation for small populations and when producing plot level estimates to be used with spatially explicit auxiliary data in a model based or model assisted estimation framework 6 conclusion the fia database is among the most valuable ecological datasets in the world though its complexity limits access for many potential users we developed rfia to simplify the estimation of forest attributes using fia data intending to provide a flexible yet powerful toolset which is accessible to all r users ultimately we hope that rfia will improve the accessibility and relevance of the fia database and promote use of fia data among a larger more diverse audience we encourage users to apply rfia widely and report any issues and or desired extensions on our active issues page https github com hunter stanke rfia issues declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national science foundation grants dms 1916395 ef 1241874 ef 1253225 national aeronautics and space administration carbon monitoring system program and united states national park service and forest service appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j envsoft 2020 104664 appendix a supplementary data the following is the supplementary material related to this article mmc s1 appendix a software testing 
