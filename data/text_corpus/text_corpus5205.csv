index,text
26025,a method for producing dense air pollution maps based on any given air pollution dispersion model is presented the scheme consists of two phases at the first stage sources locations and emission rates i e source term estimation as a function of the model s parameter space are sought backward computation then the source term is used to generate the dense maps utilizing the same dispersion model forward computation the algorithm is model invariant to the dispersion model and thus is suitable for a wide range of applications according to the required accuracy and available resources a simulation of an industrial area demonstrated that this method produced more accurate maps than current state of the art techniques the resulting dense air pollution map is thus a valuable tool for air pollution mitigation regulation and research graphical abstract image 1 keywords air quality modeling source detection gaussian model interpolation spatial maps software availability name of software multiple sources detection algorithm developer a nebenzal dept of applied math technion israel institute of technology email asaf n technion ac il year first available 2019 software required matlab 2016 and up program language matlab scripting language program size 100 kbytes availability source code available at https fishbain net technion ac il home page projects software 1 introduction air pollution is a major public health concern and negatively impacts the environment who 2019 today air pollution is considered one of the worst environmental health risks therefore there is a great need to detect and monitor the various air pollution sources and their effect on the environment typically air pollution studies are based on data collected from standard air quality monitoring stations aqms aqms supply accurate and continuous measurements are operated by professional personnel and the data undergoes a process of quality control broday and yuval 2010 this has made aqms the gold standard for air pollution data measurements cdc 2018 however their construction and maintenance costs are high they are bulky and the equipment is usually immobile castell et al 2017 thus although aqms networks are very reliable they are spread thinly in space kumar et al 2015 to illustrate in the greater chicago metropolitan area there are only three epa aqms that monitor no2 levels epa 2019 to evaluate the spatial variability of a concentration field aqms measurements do not provide sufficient coverage thus any study that aims at analyzing the spatial distribution of air pollution such as exposure assessments and epidemiological studies needs to implement a variety of techniques to overcome measurement sparsity the most common methods are land use regression lur atmospheric dispersion models and spatial interpolation schemes lur techniques aim at inferring pollution levels in all non monitored locations in the catchment region from a set of predictors such as land use physical geography and transportation variables morley and gulliver 2018 spatial interpolation is the process of finding a continuous function that best describes the whole study area it can be classified as deterministic or geostatistical the best known deterministic schemes are the inverse distance weighted idw and nearest neighbor nn algorithms the geostatistical schemes include various types of kriging li and heap 2014 using these methods sacks et al 2018 developed a software which was based on the idw algorithm for estimating how changes in air quality affected economic and health factors beauchamp et al 2017 used a kriging domain estimation to investigate the representativeness of an aqms and the exceedance area of a pollutant which does not always overlap a study analyzing exposure to air pollution in toronto canada implemented idw interpolation and used the aqms as a reference buteau et al 2017 using both kriging and lur hybrid schemes wu et al 2018 established a coupled kriging and lur model to estimate pm2 5 over taiwan measured from 71 aqms between 2006 and 2011 using the hybrid method the correlation between the actual and computed concentration was higher compared to the lur method the amount of improvement depended on the nature of the problem for example at time resolution of one month the r 2 using the conventional lur method was 0 70 compared to 0 88 using the hybrid method regardless of the interpolation method mathematically all interpolated values over the domain are a weighted average of the measurements both interpolation and lur techniques disregard the physicochemical characteristics of pollutants the physics governing the dispersion of the polluting materials and meteorology thus an alternative approach that uses aqms data incorporated with a dispersion model and meteorological data may provide much more accurate sensitive readouts than the classic interpolation techniques dispersion modeling is a mathematical description of how pollutants disperse in the atmosphere using source and meteorological parameters over a defined period of time masey et al 2018 these models make use of source parameters such as emission rate source locations and stack height together with meteorological conditions such as humidity atmospheric stability as well as wind speed and direction these models range from relatively simple ones such as the gaussian air pollution dispersion model gapdm ermak 1977 to complex models such as aermod cimorelli et al 2005 and calpuff scire et al 2000 cambridge environmental research consultants cerc atmospheric dispersion modeling system ver 5 adms 5 is a popular variant of the gapdm the adms 5 can handle several kinds of terrains including urban coastal or mountain areas adms has been used for environmental studies including densely populated areas carruthers et al 1994 choosing the dispersion model requires a balance between several factors 1 the nature of the problem i e climatic condition terrain size and topography 2 the required precision and 3 available resources to perform the computations leelőssy et al 2014 while these models facilitate in many cases a reliable and accurate representation of the dense pollution filed they require a comprehensive knowledge on the sources and on the problem s physicochemical attributes these data are often not available thus the need for mechanisms that provide accurate pollution estimations with limited datasets here we present an interpolation scheme that generates dense spatial pollution maps by integrating dispersion models into the process this allows for more accurate dense pollution maps than the state of the art interpolation schemes as physicochemical model is integrated in the process while alleviating the requirement for exact knowledge about the problem s characteristics this is achieved by utilizing the model for source term estimation backward computation then the source term is used for calculating the pollution dense maps forward computation this concept was presented for the theoretical case of a single source by nebenzal and fishbain 2017 here this methodology is extended to a source term with multiple sources having different attributes there are no constraints on the type of the dispersion model such that any dispersion model regardless of complexity can be used i e this methodology is model invariant 2 methodology 2 1 notation the following notation is used for formal description of the problem and is briefly defined here let ω be the research area let s be a set of sources in ω where each s s is located in ω s ω and its emission rate is q s the number of sources is s let r be the set of receptors sensors located in ω where each r r is located at ω r ω and the pollution level measured by r is denoted by c r the number of sensors is r let m r s be the pollution transfer function of the dispersion model which associates sensor r s readings with the emissions of source s 1 c r m rs q s for a multiple sources scenario each sensor s reading consists of the contribution of all sources i e 2 c r s s m rs q s for the set r the sources contribution can be formulated as a matrix formulation 3 c m q t where c is the row measurement vector m is the transfer matrix consisting of m r s and q t is the emission column vector the values of m r s for each source sensor combination are determined by the dispersion model note that in order to obtain accurate estimation one must include in ω all sources that might affect c r let e be the inverse operation of m i e the inverse dispersion transfer function backward computation for each c r e provides the corresponding emission rate of q s for source s for a single source case 4 q s e sr c r and for multiple sources case the matrix formulation of eq 4 is 5 q e c t finding e is an ill posed problem kabanikhin 2008 since the number of variables is significantly larger than the available measurements regardless if q is obtained then one can apply a forward computation of the dispersion model and determine the ambient pollution level c ω for all ω ω 6 c ω s s m ω s q s using the above notation the interpolation scheme is detailed below section 2 2 presents the theoretical case of a single source detection as in nebenzal and fishbain 2017 section 2 3 describes the extension of this algorithm to a more realistic scenario with multiple sources 2 2 single source interpolation the algorithm consists of two phases in the first stage using the sensor measurements c and the inverse dispersion transfer function e the source s location and emission rate are obtained for a simple case with a single source this is done by computing the estimated emission rate q ω as described in eq 4 for all possible source locations ω s ω this procedure is carried out separately for each sensor r r resulting in r estimated emission values for all locations ω ω assuming the dense pollution maps are a collection of isolines the estimated emission rate values based on all sensor s readings should agree in one grid location ballard 1991 for a single source scenario the location ω ω with the highest agreement among all the sensors is said to be the source s location agreement here means that all sensors assess the emission rate q ω of the source at location ω as having roughly the same value using the standard deviation std of the estimates as an agreement measure the location with the lowest standard deviation is the approximate location of the source 7 ω min ω ω std q ω r 1 q ω 2 q ω r once ω is found the emission rate is evaluated by the average estimates 8 q ˆ ω 1 r r 1 r q ω r r r fig 1 illustrates this process where for simplicity s sake ω is divided into a 2 d regular grid under the assumption that each grid cell is small enough so the pollution level all over the cell is uniform for the illustrations in figs 1 and 2 the grid size is 20 20m an important step in future implementation of this method is to assess the grid size according to the problem specific conditions and requirements in this example ω contains a single source s 1 and three sensors r r 1 r 2 r 3 as depicted in fig 1a r 1 indicates a pollution level of 33 μ g m 3 i e c 1 33 and is located at grid cell 1 3 r 2 is located at 2 2 measures 29 μ g m 3 and r 3 at 3 3 measures a level of 30 μ g m 3 next we plug in eq 4 to estimate the source s emission rate over ω given only r 1 backward computation since each grid cell presents a uniform pollution level the estimated emission value q ω is the same for the entire cell fig 1b illustrates the process for a simple exponential decay dispersion model a source in cell 2 4 would have yielded an estimated emission rate q 2 4 based on sensor r 1 s measurement of 38 if the source had been located at 4 5 then q 4 5 based on sensor 1 would have been 47 3 μ g m 3 fig 1c and 1d are the estimation grids generated in the same way as fig 1b for sensor r 2 and sensor r 3 respectively to evaluate the agreement between sensors for each grid cell we compute the standard deviation of the estimates of the three sensors the lower the std the higher the agreement as described by eq 7 this is illustrated in fig 1e the smallest std is for location 1 5 where in this example the source is located once ω is obtained we can evaluate q ˆ ω by plugging in eq 8 which is 39 9 now having the estimated source s location ω and its corresponding emission rate q ω we can estimate the dense pollution map over all ω forward computation using the dispersion transfer function in eq 6 2 3 multiple source interpolation given the single source formulation we next present the extension of the methodology to a scenario with multiple sources where the number of sources s as well as sources emission rates q s for all s s are unknown in this formulation the problem is ill posed kabanikhin 2008 one approach to cope with this challenge is to solve it by the enumeration of the solution space i e by placing the sources in all possible locations with all possible emission rates then for each of the configurations eq 3 is computed to get the model s estimation of the sensors readings i e c r for all r r at the sensors locations ω r ω these are then compared against the actual readings the configuration with the minimum discrepancy is the one selected this process however results in ω ω s q s different source configurations for a small ω and small s the entire solution space can be enumerated but as ω and s increase the enumeration of all possible configurations becomes infeasible using the single source interpolation scheme above and by limiting the upper and lower bounds of the possible emission rate for each source the solution space can be significantly reduced further decrease in computation time can be made if some of the sources parameters are known in advance and only few of them are unknown such an approach is very effective for regulators who may possess some knowledge regarding the interrogated area to do so the estimated pollution rate of s 1 sources is derived from a pollutant release and transfer registers prtrs regulatory reporting system kerret and gray 2007 sullivan and gouldson 2007 ayalon et al 2015 if no prtr records are available in the target region one can still derive the upper and lower bounds on the emission rates of each source based on the sensors measurements and the dispersion model in use this can be done through nested enumeration in other words by making an initial run to estimate the source set and then performing a fine tuning phase to obtain more accurate sets regardless of the emission rate estimates the source locations ω s ω are unknown let the set s be a set of s 1 sources out of the s sources in ω as mentioned above the emission rate of these sources is estimated using prtr or by an enumeration process for s the contribution of the last source s s s to sensor r is given by 9 c r residual c r s s m rs q s the residual is computed for all possible source locations in ω after having found the residual the location and emission of s s can be computed as described above in section 2 2 this process is illustrated by the simple configuration in fig 2a with two sources and two sensors the source s 1 is located at 1 5 and s 2 at 3 3 the emission rates of q 1 and q 2 are 720 kg h and 1260 kg h respectively assuming a simple decay dispersion model r 1 located at 1 3 measures 55 μ g m 3 and r 2 at 3 2 records 81 μ g m 3 now because both ω s and q s are unknown for all s prtr or the enumeration process must be used to evaluate the contribution of s to c r r r in this illustration we assume two sources by the prtr enumeration process s 1 with a known emission rate of 720 kg h and s 2 with an unknown emission data both sources locations are unknown in this example fig 2b depicts the contribution of s 1 to r 1 if it had been located in each of the grid cells for example if s 1 had been located in 1 5 its contribution to r 1 would have been 20 μ g m 3 had it been located at 2 5 its contribution would have been 17 9 and so on for the case where s 1 is located at 1 5 and its contribution to r 1 is 20 μ g m 3 the residual c r 1 r e s i d u a l is 35 once 35 μ g m 3 has been deduced the single source methodology namely computing the estimated source s emission rate for all ω s ω applying eq 4 backward computation is executed this is shown in fig 2c and d for s 1 located in 1 5 and 2 5 respectively the same process is repeated for all r r in this example the process is repeated for r 2 and is described in fig 2e through g which corresponds to fig 2b through d like the single source estimation procedure the standard deviation of the source estimations considering all sensor and source locations are computed this is presented in fig 2h and i where the standard deviation for the source estimation was found for s 1 located at 1 5 and at 2 5 respectively the lowest standard deviation was found for location 3 3 in fig 2h which corresponds to the case of s 1 situated at 1 5 thus given only the estimated emission rate of s 1 the algorithm can successfully identify the locations of both s 1 and s 2 once the source locations have been determined the estimated emission rate of s 2 can be deduced from eq 8 forward computation in this example q 2 349 7 where the true value is 350 μ g m 3 this process is also described in the pseudo code provided in alg 1 alg 1 a pseudo code depicting the major process involved in this search procedure main process are in bold font image 1 2 4 simulation study the simulated region of interest roi ω was a 12 km2 area with 4 sources and nine sensors as depicted in fig 3 similarly to the analysis of nebenzal and fishbain 2017 the ambient pollution level c r in a cartesian coordinate system r x y generated by a source s s over ω was simulated by the gapdm ermak 1977 10 c r x y z q s 2 π σ y σ z u exp y 2 2 σ y 2 exp z h 2 2 σ z 2 exp z h 2 2 σ z 2 in this formula x is coaligned with the wind direction and y is the crosswind direction z is the vertical distance from the source u is the time averaged wind speed at the height of release h and σ y and σ z represent the standard deviations of the crosswind and the vertical gaussian distribution of the pollutant concentration respectively the model also assumes full reflection from the ground the ambient data measured by the sensors were captured by a single measurement acquired at a given point in time the values are derived from the gapdm model and are summarized in table 1 in this example emission rate of sources number 1 3 are known 25 2 28 8 and 18 kg h but their locations are unknown the fourth source location and emission rate 21 6 kg h are unknown the results show exact estimation of all four sources locations the computed emission rate of the fourth source is underestimated by less than 5 from the set value the suggested method can handle in principle any number of sources by setting a source in every grid cell with a lower bound for possible emission of 0 kg h since run time scales as s 2 s s being the number of sources the problem becomes intractable quickly as the number of sources increases this can be handled by parallel computing or the use of heuristics which are the common practice is such situations lee and el sharkawi 2007 altinel et al 2008 burke et al 2013 fishbain et al 2013 shanmugasundaram et al 2014 such modification is beyond the scope of this work which focusses on the proof of concept 3 results and discussion after setting up the problem and the search method the accuracy of the pollution dense map computed in this method is compared to the classical methods simply by using the data collected from the sensors a concentration field over ω was generated using four methods idw ordinary kriging nn and the proposed source detection methodology the results are displayed in fig 4 one can easily observe that idw fig 4 a ordinary kriging b generate spatial maps whose maximum is obtained near sensors 2 and 5 the two highest measuring points nearest neighbor nn c while is commonly used li and heap 2014 wiemann et al 2016 is completely off furthermore all three methods represent an isotropic dispersion radial like formation near each sensor although this is not likely to have been the case given the wind and the decay of pollution according to these maps pollution is assumed to be located upwind from the sources which is clearly not possible this is expected since they do not consider the atmospheric conditions or physicochemical features of the area nebenzal and fishbain 2017 fig 4 d depicts the pollution field derived from the sensor readings using the new method presented here clearly it detects the source locations emission rates and reconstructs the pollution field over ω accurately the results presented in fig 4 d show that the suggested method is accurate computed sources locations match the actual locations and the computed emissions rates are accurate under estimation less than 5 this results in a highly accurate prediction of the sensors readings and the pollution dense map such accuracy is certainly superior compared to lur and interpolation method as also presented in fig 4 however we note that real life scenarios are considerably more complicated for example sources characteristic dispersion models and sensors attributes will be a significant factor in the capability to provide such an accurate estimation of the sources locations and emission rates we anticipate that uncertainties regarding the dispersion phenomena including sources properties such as deposition and chemical reactions the effect of the terrain topography will reduce the estimation accuracy additionally sensors attributes such as the minimum detectable level will have to be considered this real life complexity is a part of our ongoing study in which the suggested method is adapted to account for these important issues 4 conclusion this paper introduces a methodology for estimating a complex source term with different attributes to generate accurate dense pollution maps from sparse sensing unlike popular interpolation schemes such as lur idw or ordinary kriging that do not consider dispersion phenomena explicitly the method presented here incorporates a dispersion model into the process which results in a more accurate and exploitable dense pollution field from sparse sensor networks the method described in this manuscript needs an input regarding pollution concentrations in various locations at all times this is achieved by using a dispersion model that calculates this input using climatic conditions and emission rates the dispersion model gapdm applied here serves as a proof of concept the gapdm is simple and requires minimal computational resources which makes it attractive for real time risk assessment having said that it is important to note that the suggested methodology allows for the use of any dispersion model future work will incorporate more advanced models e g agirre basurko et al 2006 sousa et al 2007 hill et al 2011 li and heap 2014 reis et al 2015 lauret et al 2016 into the scheme such sophisticated dispersion models take fine details regarding the source term into account such as exhaust velocity temperature deposition rate and terrain effect on the flow field the incorporation of these considerations into our computational scheme should generate accurate results even for a complex terrain this method is also applicable for leak detection in this case the known sources are all accounted for and the marginal contributions are then used for allocating unknown sources i e the leaks declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was partially supported by the israeli ministry of science and technology research program 
26025,a method for producing dense air pollution maps based on any given air pollution dispersion model is presented the scheme consists of two phases at the first stage sources locations and emission rates i e source term estimation as a function of the model s parameter space are sought backward computation then the source term is used to generate the dense maps utilizing the same dispersion model forward computation the algorithm is model invariant to the dispersion model and thus is suitable for a wide range of applications according to the required accuracy and available resources a simulation of an industrial area demonstrated that this method produced more accurate maps than current state of the art techniques the resulting dense air pollution map is thus a valuable tool for air pollution mitigation regulation and research graphical abstract image 1 keywords air quality modeling source detection gaussian model interpolation spatial maps software availability name of software multiple sources detection algorithm developer a nebenzal dept of applied math technion israel institute of technology email asaf n technion ac il year first available 2019 software required matlab 2016 and up program language matlab scripting language program size 100 kbytes availability source code available at https fishbain net technion ac il home page projects software 1 introduction air pollution is a major public health concern and negatively impacts the environment who 2019 today air pollution is considered one of the worst environmental health risks therefore there is a great need to detect and monitor the various air pollution sources and their effect on the environment typically air pollution studies are based on data collected from standard air quality monitoring stations aqms aqms supply accurate and continuous measurements are operated by professional personnel and the data undergoes a process of quality control broday and yuval 2010 this has made aqms the gold standard for air pollution data measurements cdc 2018 however their construction and maintenance costs are high they are bulky and the equipment is usually immobile castell et al 2017 thus although aqms networks are very reliable they are spread thinly in space kumar et al 2015 to illustrate in the greater chicago metropolitan area there are only three epa aqms that monitor no2 levels epa 2019 to evaluate the spatial variability of a concentration field aqms measurements do not provide sufficient coverage thus any study that aims at analyzing the spatial distribution of air pollution such as exposure assessments and epidemiological studies needs to implement a variety of techniques to overcome measurement sparsity the most common methods are land use regression lur atmospheric dispersion models and spatial interpolation schemes lur techniques aim at inferring pollution levels in all non monitored locations in the catchment region from a set of predictors such as land use physical geography and transportation variables morley and gulliver 2018 spatial interpolation is the process of finding a continuous function that best describes the whole study area it can be classified as deterministic or geostatistical the best known deterministic schemes are the inverse distance weighted idw and nearest neighbor nn algorithms the geostatistical schemes include various types of kriging li and heap 2014 using these methods sacks et al 2018 developed a software which was based on the idw algorithm for estimating how changes in air quality affected economic and health factors beauchamp et al 2017 used a kriging domain estimation to investigate the representativeness of an aqms and the exceedance area of a pollutant which does not always overlap a study analyzing exposure to air pollution in toronto canada implemented idw interpolation and used the aqms as a reference buteau et al 2017 using both kriging and lur hybrid schemes wu et al 2018 established a coupled kriging and lur model to estimate pm2 5 over taiwan measured from 71 aqms between 2006 and 2011 using the hybrid method the correlation between the actual and computed concentration was higher compared to the lur method the amount of improvement depended on the nature of the problem for example at time resolution of one month the r 2 using the conventional lur method was 0 70 compared to 0 88 using the hybrid method regardless of the interpolation method mathematically all interpolated values over the domain are a weighted average of the measurements both interpolation and lur techniques disregard the physicochemical characteristics of pollutants the physics governing the dispersion of the polluting materials and meteorology thus an alternative approach that uses aqms data incorporated with a dispersion model and meteorological data may provide much more accurate sensitive readouts than the classic interpolation techniques dispersion modeling is a mathematical description of how pollutants disperse in the atmosphere using source and meteorological parameters over a defined period of time masey et al 2018 these models make use of source parameters such as emission rate source locations and stack height together with meteorological conditions such as humidity atmospheric stability as well as wind speed and direction these models range from relatively simple ones such as the gaussian air pollution dispersion model gapdm ermak 1977 to complex models such as aermod cimorelli et al 2005 and calpuff scire et al 2000 cambridge environmental research consultants cerc atmospheric dispersion modeling system ver 5 adms 5 is a popular variant of the gapdm the adms 5 can handle several kinds of terrains including urban coastal or mountain areas adms has been used for environmental studies including densely populated areas carruthers et al 1994 choosing the dispersion model requires a balance between several factors 1 the nature of the problem i e climatic condition terrain size and topography 2 the required precision and 3 available resources to perform the computations leelőssy et al 2014 while these models facilitate in many cases a reliable and accurate representation of the dense pollution filed they require a comprehensive knowledge on the sources and on the problem s physicochemical attributes these data are often not available thus the need for mechanisms that provide accurate pollution estimations with limited datasets here we present an interpolation scheme that generates dense spatial pollution maps by integrating dispersion models into the process this allows for more accurate dense pollution maps than the state of the art interpolation schemes as physicochemical model is integrated in the process while alleviating the requirement for exact knowledge about the problem s characteristics this is achieved by utilizing the model for source term estimation backward computation then the source term is used for calculating the pollution dense maps forward computation this concept was presented for the theoretical case of a single source by nebenzal and fishbain 2017 here this methodology is extended to a source term with multiple sources having different attributes there are no constraints on the type of the dispersion model such that any dispersion model regardless of complexity can be used i e this methodology is model invariant 2 methodology 2 1 notation the following notation is used for formal description of the problem and is briefly defined here let ω be the research area let s be a set of sources in ω where each s s is located in ω s ω and its emission rate is q s the number of sources is s let r be the set of receptors sensors located in ω where each r r is located at ω r ω and the pollution level measured by r is denoted by c r the number of sensors is r let m r s be the pollution transfer function of the dispersion model which associates sensor r s readings with the emissions of source s 1 c r m rs q s for a multiple sources scenario each sensor s reading consists of the contribution of all sources i e 2 c r s s m rs q s for the set r the sources contribution can be formulated as a matrix formulation 3 c m q t where c is the row measurement vector m is the transfer matrix consisting of m r s and q t is the emission column vector the values of m r s for each source sensor combination are determined by the dispersion model note that in order to obtain accurate estimation one must include in ω all sources that might affect c r let e be the inverse operation of m i e the inverse dispersion transfer function backward computation for each c r e provides the corresponding emission rate of q s for source s for a single source case 4 q s e sr c r and for multiple sources case the matrix formulation of eq 4 is 5 q e c t finding e is an ill posed problem kabanikhin 2008 since the number of variables is significantly larger than the available measurements regardless if q is obtained then one can apply a forward computation of the dispersion model and determine the ambient pollution level c ω for all ω ω 6 c ω s s m ω s q s using the above notation the interpolation scheme is detailed below section 2 2 presents the theoretical case of a single source detection as in nebenzal and fishbain 2017 section 2 3 describes the extension of this algorithm to a more realistic scenario with multiple sources 2 2 single source interpolation the algorithm consists of two phases in the first stage using the sensor measurements c and the inverse dispersion transfer function e the source s location and emission rate are obtained for a simple case with a single source this is done by computing the estimated emission rate q ω as described in eq 4 for all possible source locations ω s ω this procedure is carried out separately for each sensor r r resulting in r estimated emission values for all locations ω ω assuming the dense pollution maps are a collection of isolines the estimated emission rate values based on all sensor s readings should agree in one grid location ballard 1991 for a single source scenario the location ω ω with the highest agreement among all the sensors is said to be the source s location agreement here means that all sensors assess the emission rate q ω of the source at location ω as having roughly the same value using the standard deviation std of the estimates as an agreement measure the location with the lowest standard deviation is the approximate location of the source 7 ω min ω ω std q ω r 1 q ω 2 q ω r once ω is found the emission rate is evaluated by the average estimates 8 q ˆ ω 1 r r 1 r q ω r r r fig 1 illustrates this process where for simplicity s sake ω is divided into a 2 d regular grid under the assumption that each grid cell is small enough so the pollution level all over the cell is uniform for the illustrations in figs 1 and 2 the grid size is 20 20m an important step in future implementation of this method is to assess the grid size according to the problem specific conditions and requirements in this example ω contains a single source s 1 and three sensors r r 1 r 2 r 3 as depicted in fig 1a r 1 indicates a pollution level of 33 μ g m 3 i e c 1 33 and is located at grid cell 1 3 r 2 is located at 2 2 measures 29 μ g m 3 and r 3 at 3 3 measures a level of 30 μ g m 3 next we plug in eq 4 to estimate the source s emission rate over ω given only r 1 backward computation since each grid cell presents a uniform pollution level the estimated emission value q ω is the same for the entire cell fig 1b illustrates the process for a simple exponential decay dispersion model a source in cell 2 4 would have yielded an estimated emission rate q 2 4 based on sensor r 1 s measurement of 38 if the source had been located at 4 5 then q 4 5 based on sensor 1 would have been 47 3 μ g m 3 fig 1c and 1d are the estimation grids generated in the same way as fig 1b for sensor r 2 and sensor r 3 respectively to evaluate the agreement between sensors for each grid cell we compute the standard deviation of the estimates of the three sensors the lower the std the higher the agreement as described by eq 7 this is illustrated in fig 1e the smallest std is for location 1 5 where in this example the source is located once ω is obtained we can evaluate q ˆ ω by plugging in eq 8 which is 39 9 now having the estimated source s location ω and its corresponding emission rate q ω we can estimate the dense pollution map over all ω forward computation using the dispersion transfer function in eq 6 2 3 multiple source interpolation given the single source formulation we next present the extension of the methodology to a scenario with multiple sources where the number of sources s as well as sources emission rates q s for all s s are unknown in this formulation the problem is ill posed kabanikhin 2008 one approach to cope with this challenge is to solve it by the enumeration of the solution space i e by placing the sources in all possible locations with all possible emission rates then for each of the configurations eq 3 is computed to get the model s estimation of the sensors readings i e c r for all r r at the sensors locations ω r ω these are then compared against the actual readings the configuration with the minimum discrepancy is the one selected this process however results in ω ω s q s different source configurations for a small ω and small s the entire solution space can be enumerated but as ω and s increase the enumeration of all possible configurations becomes infeasible using the single source interpolation scheme above and by limiting the upper and lower bounds of the possible emission rate for each source the solution space can be significantly reduced further decrease in computation time can be made if some of the sources parameters are known in advance and only few of them are unknown such an approach is very effective for regulators who may possess some knowledge regarding the interrogated area to do so the estimated pollution rate of s 1 sources is derived from a pollutant release and transfer registers prtrs regulatory reporting system kerret and gray 2007 sullivan and gouldson 2007 ayalon et al 2015 if no prtr records are available in the target region one can still derive the upper and lower bounds on the emission rates of each source based on the sensors measurements and the dispersion model in use this can be done through nested enumeration in other words by making an initial run to estimate the source set and then performing a fine tuning phase to obtain more accurate sets regardless of the emission rate estimates the source locations ω s ω are unknown let the set s be a set of s 1 sources out of the s sources in ω as mentioned above the emission rate of these sources is estimated using prtr or by an enumeration process for s the contribution of the last source s s s to sensor r is given by 9 c r residual c r s s m rs q s the residual is computed for all possible source locations in ω after having found the residual the location and emission of s s can be computed as described above in section 2 2 this process is illustrated by the simple configuration in fig 2a with two sources and two sensors the source s 1 is located at 1 5 and s 2 at 3 3 the emission rates of q 1 and q 2 are 720 kg h and 1260 kg h respectively assuming a simple decay dispersion model r 1 located at 1 3 measures 55 μ g m 3 and r 2 at 3 2 records 81 μ g m 3 now because both ω s and q s are unknown for all s prtr or the enumeration process must be used to evaluate the contribution of s to c r r r in this illustration we assume two sources by the prtr enumeration process s 1 with a known emission rate of 720 kg h and s 2 with an unknown emission data both sources locations are unknown in this example fig 2b depicts the contribution of s 1 to r 1 if it had been located in each of the grid cells for example if s 1 had been located in 1 5 its contribution to r 1 would have been 20 μ g m 3 had it been located at 2 5 its contribution would have been 17 9 and so on for the case where s 1 is located at 1 5 and its contribution to r 1 is 20 μ g m 3 the residual c r 1 r e s i d u a l is 35 once 35 μ g m 3 has been deduced the single source methodology namely computing the estimated source s emission rate for all ω s ω applying eq 4 backward computation is executed this is shown in fig 2c and d for s 1 located in 1 5 and 2 5 respectively the same process is repeated for all r r in this example the process is repeated for r 2 and is described in fig 2e through g which corresponds to fig 2b through d like the single source estimation procedure the standard deviation of the source estimations considering all sensor and source locations are computed this is presented in fig 2h and i where the standard deviation for the source estimation was found for s 1 located at 1 5 and at 2 5 respectively the lowest standard deviation was found for location 3 3 in fig 2h which corresponds to the case of s 1 situated at 1 5 thus given only the estimated emission rate of s 1 the algorithm can successfully identify the locations of both s 1 and s 2 once the source locations have been determined the estimated emission rate of s 2 can be deduced from eq 8 forward computation in this example q 2 349 7 where the true value is 350 μ g m 3 this process is also described in the pseudo code provided in alg 1 alg 1 a pseudo code depicting the major process involved in this search procedure main process are in bold font image 1 2 4 simulation study the simulated region of interest roi ω was a 12 km2 area with 4 sources and nine sensors as depicted in fig 3 similarly to the analysis of nebenzal and fishbain 2017 the ambient pollution level c r in a cartesian coordinate system r x y generated by a source s s over ω was simulated by the gapdm ermak 1977 10 c r x y z q s 2 π σ y σ z u exp y 2 2 σ y 2 exp z h 2 2 σ z 2 exp z h 2 2 σ z 2 in this formula x is coaligned with the wind direction and y is the crosswind direction z is the vertical distance from the source u is the time averaged wind speed at the height of release h and σ y and σ z represent the standard deviations of the crosswind and the vertical gaussian distribution of the pollutant concentration respectively the model also assumes full reflection from the ground the ambient data measured by the sensors were captured by a single measurement acquired at a given point in time the values are derived from the gapdm model and are summarized in table 1 in this example emission rate of sources number 1 3 are known 25 2 28 8 and 18 kg h but their locations are unknown the fourth source location and emission rate 21 6 kg h are unknown the results show exact estimation of all four sources locations the computed emission rate of the fourth source is underestimated by less than 5 from the set value the suggested method can handle in principle any number of sources by setting a source in every grid cell with a lower bound for possible emission of 0 kg h since run time scales as s 2 s s being the number of sources the problem becomes intractable quickly as the number of sources increases this can be handled by parallel computing or the use of heuristics which are the common practice is such situations lee and el sharkawi 2007 altinel et al 2008 burke et al 2013 fishbain et al 2013 shanmugasundaram et al 2014 such modification is beyond the scope of this work which focusses on the proof of concept 3 results and discussion after setting up the problem and the search method the accuracy of the pollution dense map computed in this method is compared to the classical methods simply by using the data collected from the sensors a concentration field over ω was generated using four methods idw ordinary kriging nn and the proposed source detection methodology the results are displayed in fig 4 one can easily observe that idw fig 4 a ordinary kriging b generate spatial maps whose maximum is obtained near sensors 2 and 5 the two highest measuring points nearest neighbor nn c while is commonly used li and heap 2014 wiemann et al 2016 is completely off furthermore all three methods represent an isotropic dispersion radial like formation near each sensor although this is not likely to have been the case given the wind and the decay of pollution according to these maps pollution is assumed to be located upwind from the sources which is clearly not possible this is expected since they do not consider the atmospheric conditions or physicochemical features of the area nebenzal and fishbain 2017 fig 4 d depicts the pollution field derived from the sensor readings using the new method presented here clearly it detects the source locations emission rates and reconstructs the pollution field over ω accurately the results presented in fig 4 d show that the suggested method is accurate computed sources locations match the actual locations and the computed emissions rates are accurate under estimation less than 5 this results in a highly accurate prediction of the sensors readings and the pollution dense map such accuracy is certainly superior compared to lur and interpolation method as also presented in fig 4 however we note that real life scenarios are considerably more complicated for example sources characteristic dispersion models and sensors attributes will be a significant factor in the capability to provide such an accurate estimation of the sources locations and emission rates we anticipate that uncertainties regarding the dispersion phenomena including sources properties such as deposition and chemical reactions the effect of the terrain topography will reduce the estimation accuracy additionally sensors attributes such as the minimum detectable level will have to be considered this real life complexity is a part of our ongoing study in which the suggested method is adapted to account for these important issues 4 conclusion this paper introduces a methodology for estimating a complex source term with different attributes to generate accurate dense pollution maps from sparse sensing unlike popular interpolation schemes such as lur idw or ordinary kriging that do not consider dispersion phenomena explicitly the method presented here incorporates a dispersion model into the process which results in a more accurate and exploitable dense pollution field from sparse sensor networks the method described in this manuscript needs an input regarding pollution concentrations in various locations at all times this is achieved by using a dispersion model that calculates this input using climatic conditions and emission rates the dispersion model gapdm applied here serves as a proof of concept the gapdm is simple and requires minimal computational resources which makes it attractive for real time risk assessment having said that it is important to note that the suggested methodology allows for the use of any dispersion model future work will incorporate more advanced models e g agirre basurko et al 2006 sousa et al 2007 hill et al 2011 li and heap 2014 reis et al 2015 lauret et al 2016 into the scheme such sophisticated dispersion models take fine details regarding the source term into account such as exhaust velocity temperature deposition rate and terrain effect on the flow field the incorporation of these considerations into our computational scheme should generate accurate results even for a complex terrain this method is also applicable for leak detection in this case the known sources are all accounted for and the marginal contributions are then used for allocating unknown sources i e the leaks declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was partially supported by the israeli ministry of science and technology research program 
26026,in this paper we introduce the csps framework for the hierarchical assessment of aquatic ecosystem models built on a range of metrics and characteristic signatures relevant to aquatic ecosystem condition the framework is comprised of four levels 0 conceptual validation 1 comparison of simulated state variables with observations state validation 2 comparison of fluxes with measured process rates process validation and 3 assessment of system level emergent properties patterns and relationships system validation of these only levels 0 and 1 are routinely undertaken at present to highlight a diverse range of contexts relevant to the aquatic ecosystem modelling community we present several case studies of improved validation approaches using the level 0 3 assessment hierarchy we envision that the community driven adoption of these metrics will lead to more rigorously assessed models ultimately accelerating advances in model structure and function and improved confidence in model predictions graphical abstract image 1 keywords aem csps ecological modelling uncertainty water quality freshwater marine 1 introduction models of catchments lakes wetlands rivers estuaries and marine systems are now in widespread use to simulate water quality responses to anthropogenic change and to unravel nutrient and pollutant pathways hipsey et al 2015 janssen et al 2015 perhaps more than any other field of environmental modelling aquatic ecosystem modelling spans a large diversity of environments scales and disciplines ranging from small wetlands and lakes to the global ocean numerous authors have conducted reviews of the diversity of modelling approaches used to simulate lakes mooij et al 2010 janssen et al 2015 wetlands coletti et al 2017 rivers rode et al 2010 and marine systems e g gentleman 2002 glibert et al 2010 rose et al 2010 anderson et al 2010 steele et al 2013 robson 2014b looking across the geographic diversity of process based aquatic ecosystem models aems it is notable that whether the focus is freshwater or marine applications two main thematic areas of commonly used model approaches have dominated the literature i coupled physical biogeochemical models with high spatial resolution and a focus on the biophysical environment and lower trophic levels typically nutrients phytoplankton and zooplankton and ii models that are lumped in space and focus on resolving high trophic complexity see mooij et al 2010 for fresh water systems fulton 2010 for marine systems fig 1 this distinction reflects the different backgrounds and research questions being asked by aquatic ecosystem modellers and also the trade offs between conceptual complexity spatial resolution data requirements and computational demands but how good are these models over the past decade or so there has been a significant expansion in the scope and capability however several authors have argued that aems have failed to keep up with advances in scientific understanding flynn 2005 anderson and mitra 2010 oliver et al 2012 hellweger 2017 are not interdisciplinary mooij et al 2010 ward et al 2019 fail to assess or reign in uncertainty arhonditsis et al 2006 2008a dietzal and reichert 2012 and fail to fail when they should fail if they were true tests of conceptual understanding franks 2009 despite continuing advances in process understanding of aquatic biogeochemistry and ecology and the emergence of a plethora of model approaches and platforms in the literature it could be argued that the level of predictability in many practical applications of aems has not significantly improved over the past two decades arhonditsis et al 2014 these challenges motivate us to find new ways to assess our models so that we can transparently compare different models and model approaches whether they are simple or complex and understand the level of predictability they provide oreskes et al 1994 argued the use of models is heuristic which is consistent with a common view that decisions about defining when a model is validated are largely ad hoc the chosen level of validation often depends on available pre existing data sets the background and experience of the individual modeller and a general desire to report favourably on the performance of the model a common framework and established standards for model assessment and documentation would create opportunities for synthesis between diverse model studies and transferability of knowledge between applications this would facilitate us to benchmark aems that is to compare which models are better under which circumstances and what level of complexity tends to achieve a given level of accuracy and performance for a given application context here we review current approaches that can be used to assess the performance of aems and formalize a general strategy to improve confidence in model predictions the shortcomings of current model assessment and the need for a systematic approach are detailed further in section 2 a framework is outlined in section 3 for the hierarchical assessment of models to encourage modellers to assess not only state variable predictions but also process behaviour and system scale dynamics a range of metrics and characteristic signatures relevant to aquatic ecosystem condition are exemplified for a range of physical chemical and ecological contexts in section 4 spanning the diversity of aquatic system models from ponds and lakes to the global ocean our goal is to demonstrate the utility of hierarchical assessment to more comprehensively assess when a model is fit for purpose in doing so our aim is to create standards a common vocabulary and encourage a more rigorous multi level approach to model assessment that will facilitate comparisons among different aems their applications and thereby increase their predictive value and usefulness 2 approaches to model assessment and need for a standard framework in a review of model assessment frameworks pohjola et al 2013 highlighted four kinds of model assessment i quality assurance best practise procedures ii uncertainty analysis iii technical assessment and iv assessment of effectiveness in achieving social environmental or policy outcomes in this paper we focus on the technical assessment of model performance we note here the extensive history of literature describing appropriate measures of fit for objectively evaluating model performance mayer and butler 1993 power 1993 alewell and manderscheid 1998 stow et al 2003 2009 bennett et al 2013 de mora et al 2013 kubicek et al 2015 providing guidance on specific mathematical measures of model accuracy in general these include varied methods for error calculation correlation and model efficiency measures table 1 we do not focus this analysis on the specific suitability of these measures but rather on providing a framework within which they can be used for a review of the strengths and weaknesses of different measures of model data comparison see the summary by bennett et al 2013 and previous discussions by others elliott et al 2000 allen et al 2007 to date no well established guidelines have been developed on how to approach aquatic ecosystem simulation and how to decide when models are fit for purpose the reason can be found in the large diversity of model approaches which is compounded by the fact that aems have been applied over wide environmental lake river ocean and application contexts e g forecasting system understanding scenario comparison etc janssen et al 2015 for any given application context typical approaches in the literature adopt a wide range of variables spatial dimensionalities spatial scales and simulation time frames whilst the diversity of these applications is a good thing overall the consequence has been that it is difficult to compare model performance between studies and approaches in a way that allows a clear definition of the limits of their predictions in the past decades there has been limited true improvement in the level of model predictability given the rapid uptake of aems e g trolle et al 2012 janssen et al 2015 it would be expected that over time higher quality datasets more refined model process descriptions and increasing computer power would lead to improved predictions this is of course true in some cases however there is evidence that in general terms model approaches and their ability to accurately capture trends in observed data have not considerably improved compared to some of the pioneering studies e g thomann and fitzpatrick 1982 this trend was first noted by arhonditsis and brett 2004 and subsequent analyses have pointed to a similar conclusion e g arhonditsis et al 2006 robson 2014b paraska et al 2014 arhonditsis et al 2014 during routine applications of models we anecdotally hear that use of r 2 is a waste of time for coupled hydrodynamic biogeochemical model variables and that modellers often resort to chi by eye that is the modeller analyses the model output in the context of the quality and noise in the data and uses a subjective visual comparison as the ultimate determinant of suitability kubicek et al 2015 found that 92 of studies reported in the journal ecological modelling reported visual inspections as the only or main method of model evaluation this approach is not always due to the lack of willingness by the modeller to validate more deeply but rather due to confusion as to what features need to be tested within the specific application the question therefore remains are there ways in which we can further refine our efforts so that they may lead to more robust model predictions a large challenge remains to improve parameterisation of aems for most applications information exists about the values and variability of the state variables but little is known about the values of the model parameters modellers then adjust parameters to find the best agreement between modelled and observed data either by adjusting the model parameter vector by trial and error manual calibration or through optimisation algorithms the advantage of optimisation methods is that they are objective and repeatable methodologies that are more likely to result in an optimal parameter set any significant lack of fit is then due to the inadequacy of the model structure and not due to poor parameter choice chapra and canale 2010 the conventional practice of seeking a single optimal parameter set reflects two major assumptions i that there exists a single calibration vector for faithfully reproducing a wide range of ecosystem dynamics and ii that our empirical knowledge monitoring data experimental work adequately depicts the patterns of the real world and thus offers an objective standard for testing our models the credibility of both statements has been extensively debated in the literature and there are sound arguments to cast doubt on the legitimacy of such a deterministic approach to mathematical modelling a recent attempt to address knowledge gaps and improve practice in setting parameter values has been made by robson et al 2018 who provide a tool to facilitate modellers exploration of evidence for process rates and traits relevant to biogeochemical model parameters nonetheless model practitioners often encounter the problem that several distinct choices of model inputs result in equivalent model outputs i e many sets of parameters fit the data equally well the non uniqueness of the model solutions known as equifinality arhonditsis et al 2008a is a consequence of insufficient data or in the case when internal process pathways are of substantially higher order than what can be externally observed beck 1987 as a result our ability to set quantitative or even qualitative constraints on model ecological structure is significantly reduced and thus we are often faced with a situation whereby our models give good results for the wrong reasons arhonditsis et al 2007 aside from parameter uncertainty models contain errors that arise from its structure or its inputs omlin and reichert 1999 model structural error is associated with i errors in the selection of appropriate state variables or processes to reproduce ecosystem behaviour ii errors and necessary simplifications in selection of mathematical formulations for describing the processes and iii the fact that our models are based on equations derived from controlled laboratory environments that may not yield an accurate picture of the real world variability in biological systems and complicated interactions between forcing factors hellweger 2017 essentially models are simplifications of reality and all parameters are effectively applied as spatially and temporally averaged values that in reality are unlikely to be represented by fixed constants in addition it should be recognised that observational data are also uncertain approximations and are in fact also models of reality an important and increasing area of model application is to capture shifts in system function shifts occur in response to a varied range of external drivers such as climate change the cumulative loading of nutrients and pollutants and or management measures e g trolle et al 2008 skerratt et al 2013 in this case modelled ecosystems are non stationary they are being pushed out of their typical state space range upon which they were trained and predictability in the past is no guarantee a model can capture future trajectories from the broader ecological literature we know that ecosystems are vulnerable to deterioration when key system functions are pushed over thresholds resulting in the loss of resilience and the emergence of a regime shift scheffer et al 2009 often these dynamics are at the core of what we need models to help us understand yet we have limited confidence that the models are capturing these shifts and non linear ecosystem dynamics hipsey et al 2015 the lack of universally accepted performance criteria impedes our capacity to impartially determine what an acceptable model is thus an emerging imperative in the field of aquatic systems modelling is the development of a predetermined standard considering model complexity the spatiotemporal domain or even the question being asked given the complexities highlighted above and the diversity of simulation contexts this is unlikely to take the form of a simple cut off value for an acceptable goodness of fit metric in some cases it is sufficient to be able to confidently predict that one management option will have a better outcome than another e g shorter algal bloom duration while in other cases the decision will hinge on being able to predict how much better a certain scenario may be hence we need to be able to evaluate not only how uncertain our prediction may be but also what our models can confidently predict e g that a bloom will occur despite prediction uncertainty in light of these conceptual and technical challenges there are several areas where the aem community would benefit from improved tests and reporting of model performance these include greater emphasis in model publications to highlight the assessment approach and the variables validated or tested in sensitivity analysis adoption of assessment standards to facilitate inter comparison of diverse model approaches improved assessment of process pathways in models as a means to help resolve concerns around equifinality including assessment of spatio temporal variability in process rates exploration of the degree to which different scales of variability are captured by models considering not just state variables but also flux pathways assessment of model performance in reproducing theoretically relevant system scale responses that is even if models capture trends at a sampling point they must also demonstrate ability to capture emergent behaviours and employing a wider range of validation approaches able to accommodate new monitoring technologies and high frequency data streams to support model data fusion efforts addressing the criteria above will improve credibility and transparency in aquatic ecosystem modelling for example capturing emergent properties is particularly relevant when models are used to explore non stationarity systems undergoing change where a model may be out of its calibrated range or if the goal is to explore uncertain future conditions like climate change we used the list to formulate the core principles of a comprehensive model assessment framework that can be used to understand discuss and evaluate underlying principles in aems and to broaden their applicability and transferability 3 overview of the multi level assessment framework the csps framework introduces a hierarchical assessment of a range of metrics and theoretically relevant signatures relevant to aquatic ecosystem structure and function depicted schematically in fig 2 the approach includes four levels of assessment with an a priori or pre application assessment of the model indicated as level 0 while the other three levels are post simulation assessments of the model the four levels are summarised as 0 c oncept conceptual validation to ensure that sub models are consistent with ecological theory and valid over the range of conditions for which the model will be applied 1 s tate comparison of simulated state variables with observed properties 2 p rocess comparison of simulated energy and mass fluxes with measured process rates and 3 s ystem comparison of system scale emergent properties patterns and relationships with observed and theorised phenomena these levels are further described generically below given our desire for consistency across both inland and marine waters specific examples for different application contexts and specialisations relevant to the modelling community are expanded upon in section 4 3 1 level zero conceptual validation a process for model assessment that includes conceptual validation of model structure and sub model algorithms is a precursor to empirical validation of the model as a whole bert et al 2014 at this level we ask does the conceptual basis of the model accord with current scientific understanding of how the system functions this level of evaluation is usually undertaken explicitly when developing a new model but is often overlooked when applying an existing model in a new context or when it is adapted to include additional functionality questions to consider include does the model structure adequately reflect our conceptual understanding of the system and its key drivers having regard for processes that may change within the range of scenarios being considered an example of a situation in which a previously successful model may fail this conceptual validation is when a model developed for a deep sea application is to be applied to a coastal ecosystem where a more detailed representation of benthic processes is needed another example is where a model previously applied within a narrow range of temperature conditions is to be applied to climate change scenarios and the conceptual basis of temperature response functions may need to be reconsidered does the mathematical representation of ecosystem processes produce realistic system dynamics for example the widely used michaelis menten kinetics are best suited to steady state conditions and may be considered dysfunctional in dynamic simulations where nutrient concentrations vary considerably flynn 2005 frassl et al 2014 hellweger 2017 does the model structure reflect recent advances in ecosystem understanding that may be important in this application for example many ecosystem models in common use have not been updated to include anammox or dissimilatory nitrate reduction to ammonium robson 2014a b does the model reflect the system understanding of relevant local disciplinary experts and stakeholders if not this may be a hurdle to acceptance of decisions based on model results as well as not making good use of local knowledge is the model mathematically valid and dimensionally consistent is their evidence that the implementation of the model as software correctly reflects its conceptual and mathematical basis for example does it maintain conservation of mass where two or more possible model structures have been identified what process has been followed to compare the options in some cases it may be appropriate to develop an ensemble of models to test the range of possible results and the trade offs in speed and accuracy this conceptual validation phase should be revisited after state process and system validation to consider whether the results suggest the need for re evaluation of the model structure or implementation 3 2 level one state validation the comparison of time series of physical chemical and biological state variables is the main form of model validation however it is not the only means by which the accuracy of model state can be assessed and when used in isolation may not give a complete picture of model performance in most cases the frequency of observations is significantly less than the time step of aquatic models particularly in the case of coupled hydrodynamic biogeochemical models for variables that exhibit rapid changes in time such as algal biomass during a bloom standard metrics such as mean absolute error mae and root mean square error rmse can be fundamentally weak elliott et al 2000 similarly in terms of a spatial distribution an in situ observation is usually the mean of a small sample volume being compared to model output that may represent the mean value of a much larger quantity of water various alternatives for assessing state can be considered including assessment of scales of variability and derived metrics whereby observations and simulated data are subject to some form of transformation 3 2 1 1a direct comparison classically model simulation results are compared with measured data at specific points in time and space where the measurement was taken this type of assessment is undisputedly where most effort in model validation has been concentrated and will no doubt remain the focus of most model assessments the variables selected for assessment are inherently linked to the nature of the investigation and associated choice of model approach and structural complexity nonetheless there has been a tendency for modellers to validate against an arguably small subset of simulated water chemistry variables a product of both a desire to emphasise aspects of model output relevant to the application but also commonly due to lack of observations for remaining state variables measures of model fit as in table 1 can be computed for one or more sampling stations and are generally based on calculation of residuals i e the difference between model outputs and the corresponding observations a potentially useful exercise that adds to the common error calculation is to calculate skewness or kurtosis in predictions spatial assessments of multi dimensional models against data from remote sensing platforms are increasingly being introduced other methods do not necessarily involve error calculation but rather assess patterns in data series for example spearman rank correlation sr may be more useful to identify the degree to which the order of predictions and observations from small to large magnitude are captured for example where assessment of the ability of a model to reproduce seasonal and inter annual variability is required without focusing on exact values the use of a cross correlation function ccf can allow a modeller to look for correlations in how the simulated and observed data vary with a delay across time and may be used for looking at lags in time series or alternatively may be useful in spatially resolved models to determine measures such as patch length 3 2 2 1b derived metrics describing model state this category refers to metrics that do not involve a direct assessment of state variable time series or spatial data but are derived from the simulated variables the focus of this class of metrics is to test the model against theoretically relevant indicators of ecosystem state such as relationships between variables they can provide additional evidence for demonstrating that a model is fit for purpose even if direct value comparisons e g r2 are not possible due to data limitations or if direct validation indicated a weak level of predictability examples of derived metrics could include simple stoichiometric indicators e g tn tp or other ratios of simulated variables e g doc toc chl a tss other derived quantities include assessment of relevant dimensionless numbers for example the richardson number as a measure of stratification intensity or in the case of algal bloom dynamics metrics derived from analysis of the raw state variable time series such as the average duration of a bloom or time of bloom onset 3 2 3 1c metrics describing multi scale variability in model state metrics at this level describe how well various scales of temporal or spatial variability are reproduced in our models depending on the model structure its spatial dimension and time step any given simulation will have limits on the scales that it can predict the inherent difficulty in defining what model approaches are most appropriate for a given scale e g at what temporal scale would a 1d and 3d model converge remains a large challenge in the aem community simulations may be assessed from a probabilistic point of view for example through comparison of exceedance probabilities cdfs in order to ascertain whether a model is able to capture the proportion of time or spatial domain over which a certain concentration is experienced however assessment of probability distributions alone may not be suited under non stationary conditions and they do not inform us if expected modes of variability are adequately represented for example a coupled hydrodynamic biogeochemical model might be designed to reproduce phytoplankton biomass in response to diurnal changes in productivity but also over intermediate scales due to dynamic hydrological and meteorological conditions over seasonal scales due to changes in temperature and nutrients and potentially up to decadal scales if the fundamental drivers of phytoplankton biomass are shifting approaches to assess the performance of models over these scales are described in bennett et al 2013 as data transformation methods and relevant techniques include fourier transformation fft or wavelet transforms wt to date there has been limited application of these methods for assessing aems partly due to the fact that there are few cases of modelled applications that have observational data that span such a large range of time scales reviewed by kara et al 2012 the routine application of real time sensors in aquatic systems over the past decade however is providing diverse datasets that span from time scales of minutes to decades and offer new opportunities to assess models through this approach e g hamilton et al 2015 where spatially rich observational data are available these approaches can also be used to examine model performance across multiple spatial scales spatial maps can be quantitatively compared with observational maps particularly from remote sensing observations using a variety of methods stow et al 2009 3 3 level two process validation process validation refers to assessment of model performance against the underlying rates of transformation that drive changes in model state variables i e the arrows connecting stocks or pools process validation is therefore specific to process based models indeed the most commonly cited advantage of process models is their ability to resolve the interaction of the different mechanisms that shape ecosystem state yet rarely do we rigorously assess whether they are correctly captured this is particularly relevant if we consider that most model applications adopt process parameterisations reported broadly in the literature potentially from sites that may be inherently different or from laboratory or mesocosm studies conducted under controlled conditions similarly the associated parameter estimates for these algorithms may also be chosen from within large ranges reported from diverse model applications or from laboratory assessments such as phytoplankton or sediment incubations therefore it is not obvious that models with complex interactions accurately represent spatial and temporal variability in process pathways correctly even if several model state variables are seemingly reproduced well at level 1 consequently validating models with regard to the individual flux pathways that connect individual state variables is a way of reducing equifinality helping modellers to get good results for the right reasons comparing modelled with measured flux rates also provides a way to pinpoint sources of structural and conceptual error in the model in practice this approach remains rare in aquatic ecosystem modelling as measuring variability in process rates through time and or space is resource intensive and difficult and in some cases may not yet be directly possible in situ however given that it has the potential to greatly improve confidence in the underlying function of models we believe it should be actively promoted and several examples are outlined in the following sections that may be more routinely adopted these are classified next as either being from direct measurements or indirect rate estimates 3 3 1 2a comparison with raw process measurements when developing a model it is necessary for us to distinguish between process measurements that are required to assist model parameterisation and parameter assignment and process measurements that can be used for validation a range of in situ process measurements are relevant to assess physical chemical and biological model attributes and their temporal and spatial variation these include rates of mixing fluxes across the air water or sediment water interfaces and kinetic transformations e g nutrient uptake rates of primary production or grazing specific examples highlighted in section 4 relevant to a range of different model applications are reviewed 3 3 2 2b process metrics interpreted from raw data process information can also be extracted from raw data series either derived from changes in the observed data record via inverse modelling or potentially through more sophisticated data driven models designed to estimate bulk process rates as a simple example the trend of oxygen depletion in the hypolimnion of a lake may be used to estimate the net sediment oxygen demand if other sinks are minor the use of environmental tracers and isotopic data also has potential to support validation of the flow of oxygen carbon or nitrogen for example if assumptions are made about the relative fractionation and transformation rates that occur for individual process pathways these approaches are not reported widely in the literature and usually depend on the validity of several simplifying assumptions that are made when interpreting the data however it is highlighted here as an area of increasing interest for the growing area of model data fusion as a means to compare modelled process rates against those estimated from empirical means robson 2014a hipsey et al 2015 3 4 level three system validation the complex non linear interactions and feedbacks that govern the response of aquatic systems to changes in internal or external conditions can lead to ecosystem scale emergent patterns relationships and dynamics these emergent properties are not necessarily predictable directly from the underlying model formulation and are outcomes from the model that are not a direct extrapolation of the choices made in model design allen 2010 a classic example of an emergent property is the behaviour of a flock of birds in flight which emerges in a way that is not obvious from the behaviours of individual birds although not widespread there are several examples where aquatic models have been assessed in terms of their ability to produce emergent dynamics though generally not with the direct purpose to refine model accuracy or to justify whether it is fit for purpose these provide valuable insights to ecosystem behaviour and we advocate for more effort to be placed in assessing if our models are able to capture higher order behaviour or patterns as highlighted by anderson et al 2010 a different choice of model structure may lead to different emergent dynamics where two models perform equally well at level 1 but predict different emergent system dynamics these can be treated as competing hypotheses regarding system dynamics and measurement programmes can be devised to invalidate one or both hypotheses examples of system properties that might be captured by models can include simple metrics such as scaling relationships e g nutrient loading vs chlorophyll a response or more complex spatial or temporal patterns in nutrient cycles and community dynamics in many applications these patterns may be expected based on empirical experience such as the succession of different plankton functional groups or spatial niches in a habitat multivariate comparison methods are available to explore performance of models in capturing inter relationships between variables e g a taylor diagram td and these may be particularly useful for identifying cases where models resolve emergent dynamics that are not known a priori self organising mapping som is one example among others of a machine learning method that may be suited to identification of emergent patterns in both model output and observational data that are rich in two or more dimensions e g williams et al 2014 where observational data are both spatially and temporally rich empirical orthogonal function eof decomposition can be used to analyse major modes of variance and patterns of variation which can be compared with the results of the same analysis applied to model output e g rocha et al 2019 another area being explored is the response of ecosystem state space to perturbations considering threshold effects hysteresis and alternative stable states this level of validation is especially important if the model s purpose is to define the stability or resilience of key ecosystem attributes to climate change fishing and or eutrophication at this stage only a qualitative or semi quantitative comparison may be possible 4 what metrics should i use when examples for different application contexts in this section we consider the literature through the lens of the framework outlined in section 3 by combining the framework proposed with specific assessment techniques summarised in table 1 given the predominance of level 1 validation in the literature we did not target a comprehensive identification of all published model studies that consider validation rather we aimed to collate a range of examples that have been applied across a broad range of application contexts through this review we also aimed to identify gaps and potential areas for further development of new level 2 and 3 validation approaches 4 1 hydrodynamic applications for ecosystem assessment relative to water quality and ecosystem modelling applications approaches for characterizing the performance of physical models of aquatic environments are well established most notably from the engineering and geophysical sciences literature they share some common metrics across lacustrine riverine and oceanographic model applications depending on the underlying hydrology model dimension and time frame of the simulation a range of general metrics have been categorised related to prediction of a the water balance waves and water circulation b the heat and salt balance c stratification and d bottom morphometry and sediment transport table 2 in general the validation of hydrodynamic models is achieved by conducting multiple levels of assessment first researchers can conduct time series assessment of water level temperature and salinity at fixed points and or horizontal or vertical variation derived from profile cross sections level 1 simulation of surface ice dynamics can also be undertaken by time series assessments of ice thickness complemented with derived metrics such as ice on and ice off dates level 1 e g yao et al 2014 for models that simulate surface or internal waves spectral plots are commonly reported to demonstrate power across waves of different frequency derived indices such as the richardson number as a measure of stratification intensity or schmidt stability e g bruce et al 2018 are also useful as level 1 metrics considering mixed layer depth acreman and jeffery 2007 bayer et al 2013 or thermocline pycnocline thickness and changes to surface layer thickness as a function of various driving factors can prove useful in diagnosing problems with model parameterisation for cases where periodicity varies over time wavelet plots can highlight how power is localised in frequency space over different seasons or time frames isotherm isopycnal displacement power spectra are a useful metric to demonstrate the time scale over which models are able to reproduce the internal wave field e g hodges et al 2000 level 2 validation of hydrodynamic models can include assessment of evaporative mass fluxes estimation of albedo measurement of velocities at a fixed location or from drifter tracks e g dissanayake et al 2019 and shear stresses for example at the sediment water interface or within macrophyte beds the use of direct measurements or observation based estimates of turbulent mixing could also be considered and a range of novel tracers have been adopted for dilution experiments to characterise contaminant dispersion e g caffeine and pharmaceuticals in waters impacted by wastewater effluent cantwell et al 2016 level 3 assessments in hydrodynamic models consider the formation of residual currents and eddy structures for example different but otherwise similar models reveal the emergence of different eddy structures in the north atlantic ocean holt et al 2014 hetland and dimarco 2012 undertook an assessment of a 3d hydrodynamic model of the texas louisiana continental shelf using data from moorings by presenting maps of model skill in this example surface and bottom variance ellipses are used to demonstrate the model captures the point scale and residual field in lakes and coastal environments currents created by differential heating and cooling may be assessed by indirectly comparing against profile cross sections woodward et al 2017 spatial variability in water currents creates patterns of water age distributions that emerge as a system scale property but which are not easily able to be validated the potential for using methods such as assessing against empirical estimates from conservative tracers for example from radium isotope measurements tomasky holmes et al 2013 may be able to be applied in the future the increasing applications of models for complex aquatic domains e g estuaries inter tidal wetlands river floodplains reef structures or island archipelagos requires efforts to validate the relative pattern of connectivity across modelled sub domains at smaller spatial scales level 3 assessment of other patterns that may emerge in physical models can be conducted examples include travelling waves in spatial patterns of plant wrack in intertidal zones sun et al 2010 wave attenuation in seagrass beds chen et al 2007 and the canopy structure such as the dynamics of canopy deflection properties dijkstra and uittenbogaard 2010 models with morphodynamic ability can also be assessed by examining spatial patterns in temporal changes in bottom morphometry to highlight active areas of erosion and deposition 4 2 water quality and biogeochemistry a common goal for aems is to understand the controls and dynamics of chemical and biological variables relevant to water quality what constitutes a water quality variable can vary depending on the application and context however for the purpose of this analysis the literature is categorised according to several areas of focus pertaining to prediction of a oxygen and the extent of hypoxia anoxia b the cycling of inorganic nutrients and organic matter c geochemistry d water colour and clarity e chlorophyll a and f other chemical and biological contaminant dynamics table 3 across these categories most variables being assessed are dissolved or particulate concentrations that are routinely sampled via traditional monitoring programs and subsequent time series assessments level 1 though a more detailed exploration reveals a broader range of examples that can support a diversity of potential approaches for capturing water column and sediment biogeochemistry oxygen has often been a focus of water quality models as it plays a pivotal role in nutrient cycling and sediment processes given the increasing availability of sensor data for measuring oxygen concentrations it also provides an interesting case study for how a system of metrics can assist in model assessment for this context a range of more rigorous level 1 metrics has emerged such as wavelet analysis of high frequency in situ data series from a stratified lake kara et al 2012 longitudinal analysis of surface and bottom oxygen in estuaries where strong lateral gradients exist xu and hood 2006 and the spatiotemporal extent of anoxia in a riverine estuary bruce et al 2014 and lake erie bocaniov et al 2016 direct in situ level 2 sediment flux measurements from benthic chambers or eddy correlation instruments have provided useful validation of sediment oxygen demand e g sohma et al 2008 in another example hetland and dimarco 2008 adopted apparent oxygen utilisation aou the difference between the oxygen concentration and the saturation value as an indirect process validation metric to demonstrate the model was capturing the combination of oxygen consumption mechanisms of increasing interest in lacustrine and marine environments is the application of high frequency oxygen sensors to estimate free water metabolism hanson et al 2008 where an inverse modelling technique is used to extract hourly to daily estimates of primary productivity community respiration and atmospheric exchange from diel changes in oxygen concentration e g lovato et al 2013 webster et al 2005 wikner et al 2013 winslow et al 2016 while this method provides relatively coarse estimates due to confounding factors of advection and mixing villamizar et al 2014 repeated estimates over a range of environmental conditions provide an in situ view of water column net productivity and respiration that can be used to assess model equivalents a similar approach for estimating basin scale average sediment oxygen demand has been shown to be useful in stratified lakes allowing quantification of the rates of hypolimnetic oxygen drawdown where other consumption mechanisms may be assumed to be relatively minor snortheim et al 2017 following these examples fig 3 illustrates the utility of combining relevant metrics across the assessment levels for an estuary experiencing frequent hypoxia many aquatic modelling studies have had their roots in predicting the impacts of eutrophication and have demonstrated the level 1 performance of their models against data on dissolved and total nutrients with a focus on p in freshwaters and n in marine waters an increasing trend towards simulating the complete n p si and c cycles has provided opportunity to validate models using other level 1 indicators that capture more nuanced aspects of nutrient cycling such as partitioning between organic and inorganic phases and stoichiometric variability li et al 2013 other potential level 1 metrics relate to organic matter composition such as poc doc oc on or potentially the labile refractory ratio of the simulated organic pool to date this has rarely been the subject of model assessment but it may be possible by comparing with increasingly reported data from excitation emission mass spectroscopy eems studies relevant level 2 process validation efforts can be applied in the form of comparison against in situ estimates of nitrification denitrification organic matter mineralisation and community respiration or bod data in estuarine environments dilution curves have been applied to estimate sources and sinks of materials by comparing concentrations relative to salinity for example a sink of no3 along the length of a system can be used as an indirect measure of denitrification intensity e g eyre and balls 1999 fig 4 demonstrates this approach for an estuarine carbon cycle investigation showing validation of the along stream predictions of doc dic and 13c dic and 13c doc relative to a conservative tracer in this case the use of isotopes in the calibration helped to reduce equifinality since models able to correctly capture patterns in stable isotope cycling are more likely to be resolving flux pathways that are imprinting distinct signatures during isotope fractionation processes sugimoto et al 2010 van engeland et al 2012 adiyanti et al 2016 where sediment water interaction is an important driver of nutrient cycling the flux of dissolved constituents as estimated from in situ benthic chambers or from eddy correlation can be used as a powerful level 2 approach to reduce uncertainty two examples comparing modelled against measured nh4 release are applications in chesapeake bay brady et al 2013 and tokyo bay sohma et al 2008 the net rates of carbon and or organic matter sedimentation are important drivers of water and sediment condition and are important fluxes to test models against since they can vary substantially through time and between sites in oceanic systems the rate of organic carbon export shows a logarithmic decline with depth and can be plotted as a martin curve martin et al 1987 which was tested as a validation metric of the european regional seas ecosystem model ersem butenschön et al 2012 studies employing depth resolved sediment models themselves require a significant validation effort e g paraska et al 2014 depending on availability of pore water and solid phase concentrations and can benefit from level 2 validation metrics such as denitrification efficiency oxygen penetration depth and oxygen exposure time which are known to be important determinants of carbon cycling and burial capturing vertical gradients in oxygen and other constituents in sediment for example using in situ microprofile data may mean models implicitly capture these variables but further assessment against in situ flux rate determinations e g denitrification can help test sediment model function the significance of bioturbation was indirectly validated as an important process by zhu et al 2016 by ensuring the do vs po4 flux rate matched in situ observations additional level 2 metrics for assessing sediment biogeochemical predictions may include summaries of the o2 co2 sediment water flux ratio reflecting the models ability to correctly capture the balance of aerobic and anaerobic respiration that is occurring particularly for spatially resolved models ensuring models capture empirically established scaling relationships between oxygen exposure time and carbon burial efficiency or organic matter reactivity and age as depicted by the middleburg curve may prove to be a particularly useful test however to date this has yet to be reported paraska et al 2014 simulating other aspects of aquatic geochemistry is increasingly being undertaken to capture acidity and risks associated with heavy metals examples include model applications in an acidic environment such as mining impacted landscapes salmon et al 2017 or coastal sites impacted by acid sulfate soils hipsey et al 2014 other applications include reservoir management whereby seasonal anoxia and the accumulation of metals in the hypolimnion requires models to capture the redox sensitivity of mn and fe despite its importance in driving productivity and shaping biogeochemistry the light climate has not always featured during model validation light profile data and light quality specific bandwidth attenuation including the relative shift in extinction coefficient in response to suspended sediment concentrations can be a useful exercise when included with chl a model predictions it is useful to show that predictions of chl a on average scale correctly with the suspended solids concentration chao et al 2007 2010 which may be considered a system level property the light climate is also influenced by dissolved substances though even where dissolved organic matter dom is simulated few models separate coloured dissolved organic matter cdom from other dom or specifically validate the contribution of cdom contribution to light attenuation validation of wavelength specific light attenuation profiles concurrently with cdom and suspended sediment concentrations offers the potential for us to better resolve the light climate this is likely to become more important as models aim to resolve ultra violet uv photosynthetically active par and near infra red nir due to their different effects on water thermal structure and also organism growth and mortality recently the validation of a coastal ocean model against true colour from satellite imagery also demonstrated the utility of capturing the specific contributors of light reflectance at multiple wavelengths to capture the overall light climate baird et al 2016a total chlorophyll a chl a is the most common biological variable simulated in aquatic models ranging from small ponds to the global ocean elliott et al 2000 identified the relative merits of a range of error calculation methods for algae time series many of these metrics suffered when the magnitude of the data values is large and they are unforgiving of temporal misalignments between modelled and observed data for example if a simulated bloom is of the correct magnitude but one week earlier later than the observed bloom is the model still fit for purpose further level 1 comparisons such as bloom magnitude e g for the spring and or summer may be compared separately from the bloom s timing allowing discrepancy in the latter to be isolated thus if capturing bloom size over several years was of more value than predicting its exact timing a typical error metric for assessing bloom size alone would be of greater use to the study when assessing modelled chl a time series data traditional level 1 assessment metrics can be supplemented by derived metrics such as bloom peak magnitude duration and time of onset another example is the application of wavelet analysis of a high frequency chl a time series kara et al 2012 to test model performance at predicting scales of variability from days to seasons fig 5 this approach can give an improved view over simple time series comparisons about the scales of variability that a model can capably reproduce spatial comparisons of chl a from remote sensing are becoming more common particularly in coastal and marine models and wavelet based comparison may be an effective way to evaluate model chl a against satellite data saux picart et al 2012 at level 2 rates of algal productivity i e carbon fixation determined directly from in situ experiments using isotopically labelled carbon or estimates from instruments measuring photosynthetic activity based on fluorescence can provide an indication of gross primary production gpp that can be compared with modelled rates of photosynthesis though we found this was surprisingly absent from the reviewed literature for level 3 deep chl a maxima dcms are an emergent feature of complex model dynamics that manifest in response to physical chemical and biological interactions within stratified systems and can focus model validation e g carraro et al 2012 ayata et al 2013 where model application spans a wide range of trophic conditions general scaling relationships relating system average chl a concentration to the degree of external loading may be useful for example relatively simple assessments of models of coastal domains can compare performance against the monbet relationship or in the case of freshwater lakes against the vollenweider model vollenweider and kerekes 1982 reckhow and chapra 1983 these comparisons may not be relevant for short term simulations e g of an individual phytoplankton bloom but may be useful to ensure that complex water quality models are able to meet expectations of cross system empirical data see also chang et al 2019 the simulation of biological and chemical contaminants has also been identified as an important area of aquatic ecosystem simulation for inland and coastal waters particularly for the purposes of informing public health risk assessments models of microbial pollutants have been coupled with hydrodynamic models to simulate pathogens and faecal indicator organisms and assess risk in waters used for drinking and recreation e g hipsey et al 2008 sokolova et al 2013 these studies have tended to validate models by assessing organism counts from available monitoring data hipsey et al 2004 sokolova et al 2013 however this approach is complicated since viable but non culturable cells vbnc make determining viable and inactivated fractions of organism populations uncertain the increasing adoption of molecular approaches for organism enumeration in conjunction with adaptive agent based models has been applied to resolve strains of different pathogenicity bucci et al 2012 prioritisation of validation at key exposure points e g drinking water offtakes or beaches using exceedance probability plots can also be used to demonstrate a model is suited to risk assessments simulating organic chemical contamination is still scarce likely because of the limited data available for model validation and process identification a recent study used data derived from sediment cores to validate a 60 year model simulation of polycyclic aromatic hydrocarbons pahs in a large shallow lake kong et al 2017 though further work in this area is warranted 4 3 community dynamics and ecosystem function aquatic ecologists have a long history of developing metrics to describe the structure and function of aquatic populations and communities models that aim to resolve these more complex ecological dynamics build on those listed in the previous sub section but increasingly are including a wider range of theoretically relevant indicators of ecosystem interactions and function for these studies we broadly categorised the focus of various aem applications and identified 6 broad areas of a microbial lower trophic level communities b benthic populations and habitats c pelagic populations and habitats d community structure e community function and e ecosystem response to disturbance table 4 within each category we initially considered level 1 metrics describing temporal variability of species and their interactions and the development of spatial niches we then focused more specifically on literature where models have considered measures of trophic structure and complexity inter relationships between simulated ecological groups and system level responses to ecosystem perturbation within this context the diversity of metrics did appear to be less consistent and differ more notably across the freshwater and marine community in modelling the phytoplankton zooplankton and bacterial dynamics the challenges of capturing changes at the level of species or even genus are considerable e g see lignell et al 2013 li et al 2014 andersen et al 2015 of the published aems that simulate chl a only a few aim to simulate succession at the species or genus level e g elliott et al 2006 mieleitner and reichert 2008 gal et al 2009 with most designed to simulate at the level of taxonomical e g elliott et al 2005 trolle et al 2011 chan et al 2002 or functional groups pft s e g elliott et al 2000 segura et al 2012 quere et al 2005 baird et al 2016a for these applications specific use of even level 1 validation metrics relevant to species genus group partitioning and their spatiotemporal dynamics has been limited with a reliance on validation against chl a observations discussed above a reason for this discrepancy is thought to be simply a lack of corresponding observational data where phytoplankton taxonomic data are available at all they are usually at a much lower frequency and or spatial resolution than total chlorophyll estimates and or difficulty in converting species counts into the unit used by the model e g biovolume intracellular carbon nitrogen or chl a concentrations if the observed species data can be converted into comparable units the metrics used for total chlorophyll validation can also suffice at the phytoplankton community level e g elliott et al 2000 planktonic community structure which may be a level 1 or level 3 metric depending on the model structure can also be examined in terms of relative contributions of various species to the total community biomass gal et al 2009 for example validated the relative contribution of cyanobacterial species to the total phytoplankton biomass as a function of nutrient loading into the lake this comparison provided a multi tier assessment of the model as a good fit that indicated not only successful simulation of phytoplankton biomass and the relative contribution and hence succession of the various species but also an accurate reproduction of the interactions between forcing conditions nutrient loading and the food web the latter metric ensures not only the accurate simulation of phytoplankton in the model but also the assembly of dynamics and processes occurring in the ecosystem at larger oceanic scales holt et al 2014 similarly used the emergence of correct biomass partitioning between functional groups to support validation by plotting diatoms as a fraction of total chl a and comparing with the observed scaling between the diatom fraction and total chl a as estimated from satellite observations the model data were also shown as a two dimensional density histogram as a running average and least squares regression fit to the continuum function used in brewin et al 2012 at the global scale de mora et al 2016 used the known scaling relationships between abundance of phytoplankton functional types and total chlorophyll concentrations to demonstrate the community structure was correctly reproduced fig 6 they further supported model validation with tests of n p si and fe stoichiometric ratios and carbon chl a partitioning to demonstrate the correct emergence of expected patterns from the simulated nutrient flux pathways further assessment can be undertaken to characterise model performance capturing ecological species succession level 3 true ecological succession whereby the presence of one functional group creates the conditions required for the emergence of the next group e g hearn and robson 2000 should not be confused in this context with the pattern of replacement of one functional group by another due to unrelated changes in environmental conditions sometimes also referred to as succession e g chan et al 2002 the former can be considered a genuine emergent property of the system while the latter allows only a more detailed state validation of different simulated size or functional groups graphical examination of simulated phytoplankton succession based on visual comparison of a time series has been used in a number of studies see rigosi et al 2010 for a partial list the use of quantitative metrics however has been limited and when applied it typically focuses on goodness of fit and correlation metrics successful modelling of phytoplankton succession requires accurate simulation of numerous processes and food web interactions which even a tool like a taylor diagram may not be able to confidently describe the use of tracers to evaluate food web dynamics is another efficient level 3 option for assessing a model s ability to capture the food web dynamics and in particular the trophic interactions the use of stable isotopes has become increasingly popular in empirical food web studies but also more recently as a means for assessing models the signature of stable isotopes in organisms integrates over time and provides validation of the mapping of the predator prey interactions resulting from prey preference and availability in the system thus the successful match between observed stable isotopes and model trophic levels improves confidence in the strength of the simulated trophic pathways occurring within the food web e g nilsen et al 2008 dame and christian 2008 adopting a similar approach carrer et al 2000 used bioaccumulation of dioxins in the food web to evaluate model performance of trophic linkages a further high level series of indicators is based on food quality both in terms of stoichiometry and fatty acid concentrations the use of dynamic intracellular stoichiometric ratios in a model allows the user to evaluate model performance not only in the form of changes in the stoichiometric ratio of a certain species over time but also the change in the ratios of organisms of higher trophic levels affected by the lower level organisms gaedke et al 2002 for example examined c p ratios in egested vs ingested food in the model as part of mass balance models of the food web li et al 2013 compared a probability density function of five phytoplankton group internal n p ratios with sporadic observations of minimum maximum and mean internal nutrient concentrations thingstad et al 2007 used model validation and the mismatch between simulated and observed bacterial production in a mesocosm to identify the weakness in model simulation of varying stoichiometric ratios mitra and flynn 2006 incorporated stoichiometry into a multi species predator prey model with varying elemental composition and selectivity their model successfully simulated the switch in predator diet from predation on the prey to cannibalism when the prey suffered from nutrient limitation and decreased in food quality mulder and bowden 2007 examined whether zooplankton can alter their internal stoichiometry under nutrient poor conditions and whether production efficiency of limiting nutrients increases when food quality is poor to validate their models they compared growth rates under varying nutrient use efficiency across reported food quantity quality gradients simulating growth rates with varying production efficiency under varying food quantity and quality is only possible when correct simulation of the various processes that link food quantity quality and growth rates is achieved additional unique markers such as fatty acid concentrations have been used for high level model assessment perhar et al 2012 used biochemical control on zooplankton growth by n p and highly unsaturated fatty acids hufa as a means for testing accuracy of model output as with stable isotopes and stoichiometry correct simulation of hufa concentrations require accurate model description of multiple processes within the food web as model structures and the number of species interactions becomes more complex the validation challenge becomes considerably more difficult sauterey et al 2015 simulated planktonic diversity as indicated by the shannon index which is a measure of the distribution of biomass among species and evolving cell sizes of dominant plankton species in a global ocean model they used the canberra distance to compare the distance between cell volume distributions of different model outcomes although sauterey et al did not directly compare their model results with real world shannon and canberra indices their work outlined the possibility for how the emergent feature of planktonic community diversity could be used as an additional performance metric for ecological models goebel et al 2010 were able to demonstrate how the expected patterns of plankton distribution in a coastal environment emerged in the model from the interaction of a highly diverse population much of the above discussion about pelagic plankton communities similarly applies to benthic communities bearing in mind that generally their position is fixed for most of their life history for individual macrophyte macroalgal or invertebrate species simulations biomass or organism density in coastal and lake models can be assessed across space and time to ensure habitats are accurately represented savina and ménesguen 2008 in situ rates of detritus production assessed by traps in flowing environments and rates of decay of benthic plant detritus assessed with incubation chambers can be used as a level 2 metric benthic plant productivity can be assessed by measuring changes in plant biomass when grazers are experimentally excluded and grazing rates can be assessed through food web studies supported by stable isotope measurements similarly filtration and clearance rates of filter feeders can be used for species such as mussels the 3d model study by bocaniov et al 2014 simulated zebra and quagga mussels and whilst there was limited in situ data for direct mussel filtration rate validation the effect of the mussels on improving the chl a prediction in the overlying water column was used as a proxy indicator to help justify the filtration rate predictions in a study by renton et al 2011 the development of a restored seagrass bed was simulated using a functional structural plant model results were assessed against total rhizome length length of the longest rhizome axis and total number of live buds apices axes and internodes based on a snapshot of data taken two years after the restoration began at the community level benthic plant succession can be assessed often it is the variability in benthic communities and biomass along a gradient of light depth and their relationship with patterns of benthic substrates that is important li et al 2010 tested a multi agent systems model of two macrophyte species in lake veluwe and illustrated performance using a map of occurrence indicating regions of model over and under prediction evaluating model simulations of populations of fish and higher biotic populations is somewhat more complex than variables described above due to lower sampling resolution species mobility and different indices used to characterise fish populations unless regular stock assessment data for fisheries e g savina et al 2013 or other organism counts are available it is difficult to assess model performance using traditional level 1 indicators lehuta et al 2013 and population models should be assessed using an array of alternative measures models of populations often adopt individual based approaches and the spatial context of predictions needs to be considered in light of the sampling regime used to collect observations for fish observed data are often based on catch data metrics such as catch per unit effort must therefore be translated to match simulation variables or used to qualitatively assess model spatio temporal patterns of fish abundance e g holt et al 2014 savina et al 2013 higher level indicators often used to characterise fish populations include length weight l w relationships length weight at age and size distribution histograms makler pick et al 2011 megrey et al 2007 rose et al 2007 all three indicators emerge dependent on a large number of individual and population specific interactions with environmental conditions thus accurate predictions serve as an indication of model robustness however the predictions usually also integrate over large spatial and or temporal scales and thus are not truly assessing population response at finer scales breckling et al 2005 and hölker and breckling 2005 discuss level 3 emergent properties relevant to fish population modelling self sorting age groups trophic bottlenecks size dependent winter mortality spatial organisation measures and the influence of lake morphology on phenotype assessing changing population size distributions in response to fishing pressure e g makler pick et al 2011 can also be a means to qualitatively assess ecosystem response to external forcing assessment of food webs with a high degree of variable interaction may take the form of a multivariate assessment tool e g td or more ad hoc tests of theoretically relevant patterns trends and relationships an example of the latter is the approach by fulton et al 2004 where a range of semi quantitative tests and qualitative comparisons of population and ecosystem level metrics for coastal embayment models were used predictions of the trophic structure were put in context of the sheldon spectra to demonstrate mass partitioning between trophic levels was appropriate sailley et al 2013 also compared trophic efficiency metrics that could be used to assess how complex food webs emerge including comparison of bulk community heterotroph to autotroph ratios and variation of zooplankton predator micozooplankton and predator prey scaling relationships these metrics were used in the context of comparing model structures however they may also serve as a way for modellers to compare food web predictions with data dynamic relationships that emerge within food webs such as intraguild predation and competition between species may also be used to assess models however specific level 3 metrics quantifying these measures of system organisation are difficult to define reynolds and elliott 2012 explore the predictability of several emergent properties of freshwater ecosystems including carrying capacity exergy accumulation carbon processing capacity and habitat templates i e functional zones they conclude that while species composition may remain quite unpredictable except on the basis of probabilities and hindsight the characteristic traits of the successful contestants can be anticipated with considerable certainty p 87 for more complex food web analyses deehr et al 2014 demonstrated a novel approach to validation of a complex ecopath food web through integration with n isotope data they demonstrate the strong relationship between effective trophic level etl from the model and the δ15n signature from observed organism data in the context of a marine ecosystem subject to trawling pressures ultimately a large number of modellers are seeking to elucidate fundamental ecological relationships and forecast potentially complex response pathways of ecosystems to changes in external and internal drivers metrics described in the above sections specifically support assessing sub model components e g hydrodynamics nutrients phytoplankton etc but there are range of more specific metrics that can be used to holistically assess model predictions an area of increasing interest is demonstrating models are able to capture system scale level 3 metrics such as resilience to perturbation thresholds and stable state transitions and hysteresis effects hipsey et al 2015 müller et al 2016 as yet there remain limited examples where models have been confronted with empirical data that display these trends challenges exist in terms of computing compound indices that can be used as indicators of ecosystem state though indices of water quality or ecosystem diversity are increasingly being used in a shallow lake example janse et al 2008 2010 were able to demonstrate the ability of their model to capture the threshold shift from macrophyte to algal dominance validated by an assessment across multiple lakes in doing so they were able to identify the threshold p loading level required for turbidification and subsequent restoration including demonstration of hysteresis effects which agreed well with empirical work fig 7 in a stability analysis based on the same model kuiper et al 2015 showed that the food web and system stability gradually decreases with the distance from the critical loading in the bistability range for both directions thereby highlighting the potential for correctly formulated models to inform users on phenomena such as critical slowing down ecosystem flickering and system resilience these studies hold great promise for informing assessment of the next generation of aems that can be more confidently applied to predict ecosystem collapse recovery and restoration strategies 5 discussion the four levels of model validation may be challenging bearing in mind in the past often inadequate data have been limiting the extent to which assessment could be advanced however we are seeing an ever increasing range of data streams from new monitoring technologies such as optical nutrient loggers rode et al 2016 claustre et al 2019 improved processing of existing sources such as satellite observations jouini et al 2013 citizen science initiatives dickinson et al 2010 open access and long term monitoring initiatives and real time data portals reed et al 2010 all these data hold the potential to improve the way we run and assess environmental models indeed aquatic ecosystems modellers are beginning to take up these data streams li et al 2010 johnson and needoba 2008 turuncoglu et al 2013 and it is timely to reconsider the ways we can use this data to improve our model formulations and to describe model uncertainty 5 1 improving models through improved assessment several recent commentaries have discussed the challenges and issues in application of complex environmental models in general nordstrom 2012 and aems in particular robson 2014a trolle et al 2012 arhonditsis et al 2014 frassl et al 2019 the emergence of community models and flexible modelling frameworks to reduce duplication of effort e g bruggeman and bolding 2014 mooij et al 2014 hipsey et al 2019 and the application of advanced techniques for assessment of model error and sensitivity go some way towards addressing these challenges the csps framework and examples we provide is an attempt to help modellers move from relying on level 1 metrics to more robust and insightful level 2 and 3 metrics in order to more thoroughly challenge our models and assess their capabilities and limitations as these metrics become more widely used and reported they will facilitate an increased depth of analysis in comparative studies e g salihoglu et al 2013 kim et al 2014 kwiatkowski et al 2014 tittensor et al 2018 and help us to assess how different model structures parameterisations and algorithms perform across a diverse range of applications and simulation contexts for the foreseeable future there may be insufficient data to complete assessment at all four levels in every case nonetheless being aware of the diversity and suitability of metrics at multiple levels and being explicit about the level 0 3 at which assessment has been conducted will help modellers to communicate the type of assessment that is being performed and the implications for model uncertainty this awareness may also facilitate prioritisation of observational studies and monitoring programs that consider not only state variables but also fluxes and emergent properties in other words ecological states rates and traits undertaking assessment using this structured approach can help modellers to further pinpoint where models are fundamentally weak and communicate to stakeholders where further investment in data collection and monitoring will support prediction conversely modelling that leads to discovery of new or interesting phenomena can motivate new experiments or monitoring to support post hoc validation efforts 5 2 model purpose and selection of appropriate metrics technical assessment of models is varied and requires the development of workflows that bring together several methods tailored to the specific application bennett et al 2013 and taking into account the intended purpose of the model e g harmel et al 2014 the examples in tables 2 4 are intended to provide an expandable library that can serve as the basis of a common reference for assessment of aquatic system models some examples may serve to cross fertilise ideas across sub disciplinary divides for example target or taylor diagrams are widely used in oceanography but not routinely used for freshwater models note that not all are relevant in any given case for example a specific relationship may be used to parameterise the model directly in which case it is less suitable as a validation tool others may only be applicable to specific spatial or temporal model resolutions for example a metric quantifying stratification and mixing requires a minimal vertical disaggregation of the water column the selected metrics will also depend on the model purpose models used for operational forecasting may prefer different assessment metrics than those designed to explore algal seasonal dynamics or long term nutrient load assessments in either case a combination of level 1 metrics may demonstrate the model s potential and support with level 2 metrics would help to ensure the model was not over fitted and introduce a higher level of credibility into the assessment however if the intention is to then apply the model outside the bounds of historical conditions to explore the impact of major system changes on ecosystem dynamics then including level 3 validation becomes an important step well validated modelling studies in different disciplinary areas e g ponds lakes rivers and marine systems demonstrating use of metrics across multiple levels are encouraged to serve as benchmarks that can guide practitioners 5 3 using multiple metrics to enrich the calibration and uncertainty assessment process calibration of aems has historically been a relatively manual trial and error process though formal calibration methods are beginning to be used in both marine e g parslow et al 2013 and freshwater ecosystem modelling e g ramin and arhonditsis 2013 dietzal and reichert 2012 the adoption of calibration validation pairing e g trolle et al 2008 where validation relies on a data set independent from that used in calibration remains the exception rather than the rule in aquatic ecosystem modelling though it is common in other fields and widely considered best practise robson 2014b adopting a calibration and validation period can avoid overfitting model parameters and identify the predictive capability of a model particularly where patterns during the validation period differ from those in the calibration period widening the range of metrics models are assessed against may assist in achieving a broader application of calibration validation pairing in recognition of model uncertainty and equifinality problems there has been a shift in some areas of the aem community to change model calibration practice from seeking a single optimal value for each model parameter to seeking a range of parameter sets that all meet a pre specified standard of agreement with the data aldenberg et al 1995 stow et al 2007 arhonditsis et al 2007 chiu and gould 2010 janse et al 2010 running an ensemble of simulations using values from amongst these acceptable parameter sets provides a basis for estimating the uncertainty associated with model predictions this practice termed physical statistical modelling kuhnert 2014 relies on bayesian probability to combine existing prior information with observations to project the posterior likelihood of ecosystem response the effective characterisation of model uncertainty using bayesian approaches depends upon two critical steps i selection of a sampling scheme to generate input vectors e g latin hypercube markov chain monte carlo etc and ii selection of a likelihood measure to quantify model misfit in complex models the choice of likelihood measures for assessment leads to conceptual dilemmas for modellers such as the selection of likelihood functions that can meaningfully change the inference drawn beven and freer 2001 hong et al 2005 arhonditsis et al 2008b by further tailoring the adopted likelihood measures to consider the assessment ideas introduced in this paper the model calibration and uncertainty process can be enriched to focus on more diagnostically powerful likelihood measures finally recognising that there is no true model of an ecological system but rather several adequate descriptions of different conceptual basis and structure ensemble modelling is a means to obtain better predictions and a better understanding of uncertainty by combining the results of competing models trolle et al 2014 several methods exist to synthesise predictions across ensembles including sequential data assimilation approaches such as the ensemble kalman filter and ensemble particle filters moradkhani et al 2006 vrugt and robinson 2007 and post hoc ensemble integration strategies such as the bayesian model averaging bma ramin et al 2012 including models of differing complexity and with varied structures in the ensemble allows structural uncertainty to be addressed alongside uncertainty from input data and parameter selection when combined with the use of more specific and nuanced assessment metrics modellers can better decide which model structures perform best without an overt reliance on diagnostically weak level 1 error metrics thus motivating reconsideration of their level 0 validation 6 conclusions in evaluating the performance of a model we want to know the answers to several questions is the model capable of reproducing observations if so is it getting it right for the right reasons or conversely is it over fitted or does it have one error cancelling another can we trust the model to make predictions if so in what range of circumstances can we trust it to answer these questions in the case of mechanistic aems we need to go beyond simply comparing simulated and observed concentrations of state variables here we present a way forward the hierarchical csps framework to encourage evaluation of models at four levels conceptual accuracy level 0 state accuracy level 1 process accuracy level 2 and accuracy in capturing system behaviour level 3 assessment at level 2 can improve confidence in the biogeochemical basis of model formulations while assessment at level 3 allows modellers to critically assess model predictions against spatial and temporal scales of change stoichiometric indices and a range of trophic relationships all of which are based on theoretically informed indicators of ecosystem function arguably only applications that perform well at highest level of assessment justify the implementation of complex process based models short to mid term forecasting predictions after all can often be less expensively and more accurately produced through simpler approaches such as regression modelling robson and dourdet 2015 or evolutionary algorithms recknagel et al 2014 while if the aim is to shed light on system function a model that fails to perform at level 3 may be producing the right answer for the wrong reason though it may not always be possible to rigorously assess a model at all levels modellers should strive to ensure the level of assessment is suited to the purpose of the model and the severity of consequences of an incorrect prediction a model that is successfully validated for a specific system at all four levels is one that can be applied with confidence to forecast future trajectories of the system a model that has been successfully validated across several systems at all four levels is one that can more generally be applied with confidence over time it is envisioned that the community driven adoption of these metrics will accelerate advances in model structure and function and provide an improved foundation for model assessment on which developments in model data fusion can be built software and data availability the system of metrics reported in the present analysis is an evolving collection and can be accessed online at https aquaticecodynamics github io aem metrics author contributions mrh gg and bjr designed the framework outline and prepared the main manuscript body with ga all authors contributed to metric identification literature review preparation of the tables and figures and manuscript development and revision funding mrh received support from the australian research council dp130104078 dp170104832 lp130100756 lp150100451 ccc received support from the national science foundation nsf1753639 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge discussions with members of the aquatic ecosystem modelling network aemon including louise bruce karsten rinke paul hanson david hamilton and wolf mooij and the suggestions and improvements made by two anonymous reviewers 
26026,in this paper we introduce the csps framework for the hierarchical assessment of aquatic ecosystem models built on a range of metrics and characteristic signatures relevant to aquatic ecosystem condition the framework is comprised of four levels 0 conceptual validation 1 comparison of simulated state variables with observations state validation 2 comparison of fluxes with measured process rates process validation and 3 assessment of system level emergent properties patterns and relationships system validation of these only levels 0 and 1 are routinely undertaken at present to highlight a diverse range of contexts relevant to the aquatic ecosystem modelling community we present several case studies of improved validation approaches using the level 0 3 assessment hierarchy we envision that the community driven adoption of these metrics will lead to more rigorously assessed models ultimately accelerating advances in model structure and function and improved confidence in model predictions graphical abstract image 1 keywords aem csps ecological modelling uncertainty water quality freshwater marine 1 introduction models of catchments lakes wetlands rivers estuaries and marine systems are now in widespread use to simulate water quality responses to anthropogenic change and to unravel nutrient and pollutant pathways hipsey et al 2015 janssen et al 2015 perhaps more than any other field of environmental modelling aquatic ecosystem modelling spans a large diversity of environments scales and disciplines ranging from small wetlands and lakes to the global ocean numerous authors have conducted reviews of the diversity of modelling approaches used to simulate lakes mooij et al 2010 janssen et al 2015 wetlands coletti et al 2017 rivers rode et al 2010 and marine systems e g gentleman 2002 glibert et al 2010 rose et al 2010 anderson et al 2010 steele et al 2013 robson 2014b looking across the geographic diversity of process based aquatic ecosystem models aems it is notable that whether the focus is freshwater or marine applications two main thematic areas of commonly used model approaches have dominated the literature i coupled physical biogeochemical models with high spatial resolution and a focus on the biophysical environment and lower trophic levels typically nutrients phytoplankton and zooplankton and ii models that are lumped in space and focus on resolving high trophic complexity see mooij et al 2010 for fresh water systems fulton 2010 for marine systems fig 1 this distinction reflects the different backgrounds and research questions being asked by aquatic ecosystem modellers and also the trade offs between conceptual complexity spatial resolution data requirements and computational demands but how good are these models over the past decade or so there has been a significant expansion in the scope and capability however several authors have argued that aems have failed to keep up with advances in scientific understanding flynn 2005 anderson and mitra 2010 oliver et al 2012 hellweger 2017 are not interdisciplinary mooij et al 2010 ward et al 2019 fail to assess or reign in uncertainty arhonditsis et al 2006 2008a dietzal and reichert 2012 and fail to fail when they should fail if they were true tests of conceptual understanding franks 2009 despite continuing advances in process understanding of aquatic biogeochemistry and ecology and the emergence of a plethora of model approaches and platforms in the literature it could be argued that the level of predictability in many practical applications of aems has not significantly improved over the past two decades arhonditsis et al 2014 these challenges motivate us to find new ways to assess our models so that we can transparently compare different models and model approaches whether they are simple or complex and understand the level of predictability they provide oreskes et al 1994 argued the use of models is heuristic which is consistent with a common view that decisions about defining when a model is validated are largely ad hoc the chosen level of validation often depends on available pre existing data sets the background and experience of the individual modeller and a general desire to report favourably on the performance of the model a common framework and established standards for model assessment and documentation would create opportunities for synthesis between diverse model studies and transferability of knowledge between applications this would facilitate us to benchmark aems that is to compare which models are better under which circumstances and what level of complexity tends to achieve a given level of accuracy and performance for a given application context here we review current approaches that can be used to assess the performance of aems and formalize a general strategy to improve confidence in model predictions the shortcomings of current model assessment and the need for a systematic approach are detailed further in section 2 a framework is outlined in section 3 for the hierarchical assessment of models to encourage modellers to assess not only state variable predictions but also process behaviour and system scale dynamics a range of metrics and characteristic signatures relevant to aquatic ecosystem condition are exemplified for a range of physical chemical and ecological contexts in section 4 spanning the diversity of aquatic system models from ponds and lakes to the global ocean our goal is to demonstrate the utility of hierarchical assessment to more comprehensively assess when a model is fit for purpose in doing so our aim is to create standards a common vocabulary and encourage a more rigorous multi level approach to model assessment that will facilitate comparisons among different aems their applications and thereby increase their predictive value and usefulness 2 approaches to model assessment and need for a standard framework in a review of model assessment frameworks pohjola et al 2013 highlighted four kinds of model assessment i quality assurance best practise procedures ii uncertainty analysis iii technical assessment and iv assessment of effectiveness in achieving social environmental or policy outcomes in this paper we focus on the technical assessment of model performance we note here the extensive history of literature describing appropriate measures of fit for objectively evaluating model performance mayer and butler 1993 power 1993 alewell and manderscheid 1998 stow et al 2003 2009 bennett et al 2013 de mora et al 2013 kubicek et al 2015 providing guidance on specific mathematical measures of model accuracy in general these include varied methods for error calculation correlation and model efficiency measures table 1 we do not focus this analysis on the specific suitability of these measures but rather on providing a framework within which they can be used for a review of the strengths and weaknesses of different measures of model data comparison see the summary by bennett et al 2013 and previous discussions by others elliott et al 2000 allen et al 2007 to date no well established guidelines have been developed on how to approach aquatic ecosystem simulation and how to decide when models are fit for purpose the reason can be found in the large diversity of model approaches which is compounded by the fact that aems have been applied over wide environmental lake river ocean and application contexts e g forecasting system understanding scenario comparison etc janssen et al 2015 for any given application context typical approaches in the literature adopt a wide range of variables spatial dimensionalities spatial scales and simulation time frames whilst the diversity of these applications is a good thing overall the consequence has been that it is difficult to compare model performance between studies and approaches in a way that allows a clear definition of the limits of their predictions in the past decades there has been limited true improvement in the level of model predictability given the rapid uptake of aems e g trolle et al 2012 janssen et al 2015 it would be expected that over time higher quality datasets more refined model process descriptions and increasing computer power would lead to improved predictions this is of course true in some cases however there is evidence that in general terms model approaches and their ability to accurately capture trends in observed data have not considerably improved compared to some of the pioneering studies e g thomann and fitzpatrick 1982 this trend was first noted by arhonditsis and brett 2004 and subsequent analyses have pointed to a similar conclusion e g arhonditsis et al 2006 robson 2014b paraska et al 2014 arhonditsis et al 2014 during routine applications of models we anecdotally hear that use of r 2 is a waste of time for coupled hydrodynamic biogeochemical model variables and that modellers often resort to chi by eye that is the modeller analyses the model output in the context of the quality and noise in the data and uses a subjective visual comparison as the ultimate determinant of suitability kubicek et al 2015 found that 92 of studies reported in the journal ecological modelling reported visual inspections as the only or main method of model evaluation this approach is not always due to the lack of willingness by the modeller to validate more deeply but rather due to confusion as to what features need to be tested within the specific application the question therefore remains are there ways in which we can further refine our efforts so that they may lead to more robust model predictions a large challenge remains to improve parameterisation of aems for most applications information exists about the values and variability of the state variables but little is known about the values of the model parameters modellers then adjust parameters to find the best agreement between modelled and observed data either by adjusting the model parameter vector by trial and error manual calibration or through optimisation algorithms the advantage of optimisation methods is that they are objective and repeatable methodologies that are more likely to result in an optimal parameter set any significant lack of fit is then due to the inadequacy of the model structure and not due to poor parameter choice chapra and canale 2010 the conventional practice of seeking a single optimal parameter set reflects two major assumptions i that there exists a single calibration vector for faithfully reproducing a wide range of ecosystem dynamics and ii that our empirical knowledge monitoring data experimental work adequately depicts the patterns of the real world and thus offers an objective standard for testing our models the credibility of both statements has been extensively debated in the literature and there are sound arguments to cast doubt on the legitimacy of such a deterministic approach to mathematical modelling a recent attempt to address knowledge gaps and improve practice in setting parameter values has been made by robson et al 2018 who provide a tool to facilitate modellers exploration of evidence for process rates and traits relevant to biogeochemical model parameters nonetheless model practitioners often encounter the problem that several distinct choices of model inputs result in equivalent model outputs i e many sets of parameters fit the data equally well the non uniqueness of the model solutions known as equifinality arhonditsis et al 2008a is a consequence of insufficient data or in the case when internal process pathways are of substantially higher order than what can be externally observed beck 1987 as a result our ability to set quantitative or even qualitative constraints on model ecological structure is significantly reduced and thus we are often faced with a situation whereby our models give good results for the wrong reasons arhonditsis et al 2007 aside from parameter uncertainty models contain errors that arise from its structure or its inputs omlin and reichert 1999 model structural error is associated with i errors in the selection of appropriate state variables or processes to reproduce ecosystem behaviour ii errors and necessary simplifications in selection of mathematical formulations for describing the processes and iii the fact that our models are based on equations derived from controlled laboratory environments that may not yield an accurate picture of the real world variability in biological systems and complicated interactions between forcing factors hellweger 2017 essentially models are simplifications of reality and all parameters are effectively applied as spatially and temporally averaged values that in reality are unlikely to be represented by fixed constants in addition it should be recognised that observational data are also uncertain approximations and are in fact also models of reality an important and increasing area of model application is to capture shifts in system function shifts occur in response to a varied range of external drivers such as climate change the cumulative loading of nutrients and pollutants and or management measures e g trolle et al 2008 skerratt et al 2013 in this case modelled ecosystems are non stationary they are being pushed out of their typical state space range upon which they were trained and predictability in the past is no guarantee a model can capture future trajectories from the broader ecological literature we know that ecosystems are vulnerable to deterioration when key system functions are pushed over thresholds resulting in the loss of resilience and the emergence of a regime shift scheffer et al 2009 often these dynamics are at the core of what we need models to help us understand yet we have limited confidence that the models are capturing these shifts and non linear ecosystem dynamics hipsey et al 2015 the lack of universally accepted performance criteria impedes our capacity to impartially determine what an acceptable model is thus an emerging imperative in the field of aquatic systems modelling is the development of a predetermined standard considering model complexity the spatiotemporal domain or even the question being asked given the complexities highlighted above and the diversity of simulation contexts this is unlikely to take the form of a simple cut off value for an acceptable goodness of fit metric in some cases it is sufficient to be able to confidently predict that one management option will have a better outcome than another e g shorter algal bloom duration while in other cases the decision will hinge on being able to predict how much better a certain scenario may be hence we need to be able to evaluate not only how uncertain our prediction may be but also what our models can confidently predict e g that a bloom will occur despite prediction uncertainty in light of these conceptual and technical challenges there are several areas where the aem community would benefit from improved tests and reporting of model performance these include greater emphasis in model publications to highlight the assessment approach and the variables validated or tested in sensitivity analysis adoption of assessment standards to facilitate inter comparison of diverse model approaches improved assessment of process pathways in models as a means to help resolve concerns around equifinality including assessment of spatio temporal variability in process rates exploration of the degree to which different scales of variability are captured by models considering not just state variables but also flux pathways assessment of model performance in reproducing theoretically relevant system scale responses that is even if models capture trends at a sampling point they must also demonstrate ability to capture emergent behaviours and employing a wider range of validation approaches able to accommodate new monitoring technologies and high frequency data streams to support model data fusion efforts addressing the criteria above will improve credibility and transparency in aquatic ecosystem modelling for example capturing emergent properties is particularly relevant when models are used to explore non stationarity systems undergoing change where a model may be out of its calibrated range or if the goal is to explore uncertain future conditions like climate change we used the list to formulate the core principles of a comprehensive model assessment framework that can be used to understand discuss and evaluate underlying principles in aems and to broaden their applicability and transferability 3 overview of the multi level assessment framework the csps framework introduces a hierarchical assessment of a range of metrics and theoretically relevant signatures relevant to aquatic ecosystem structure and function depicted schematically in fig 2 the approach includes four levels of assessment with an a priori or pre application assessment of the model indicated as level 0 while the other three levels are post simulation assessments of the model the four levels are summarised as 0 c oncept conceptual validation to ensure that sub models are consistent with ecological theory and valid over the range of conditions for which the model will be applied 1 s tate comparison of simulated state variables with observed properties 2 p rocess comparison of simulated energy and mass fluxes with measured process rates and 3 s ystem comparison of system scale emergent properties patterns and relationships with observed and theorised phenomena these levels are further described generically below given our desire for consistency across both inland and marine waters specific examples for different application contexts and specialisations relevant to the modelling community are expanded upon in section 4 3 1 level zero conceptual validation a process for model assessment that includes conceptual validation of model structure and sub model algorithms is a precursor to empirical validation of the model as a whole bert et al 2014 at this level we ask does the conceptual basis of the model accord with current scientific understanding of how the system functions this level of evaluation is usually undertaken explicitly when developing a new model but is often overlooked when applying an existing model in a new context or when it is adapted to include additional functionality questions to consider include does the model structure adequately reflect our conceptual understanding of the system and its key drivers having regard for processes that may change within the range of scenarios being considered an example of a situation in which a previously successful model may fail this conceptual validation is when a model developed for a deep sea application is to be applied to a coastal ecosystem where a more detailed representation of benthic processes is needed another example is where a model previously applied within a narrow range of temperature conditions is to be applied to climate change scenarios and the conceptual basis of temperature response functions may need to be reconsidered does the mathematical representation of ecosystem processes produce realistic system dynamics for example the widely used michaelis menten kinetics are best suited to steady state conditions and may be considered dysfunctional in dynamic simulations where nutrient concentrations vary considerably flynn 2005 frassl et al 2014 hellweger 2017 does the model structure reflect recent advances in ecosystem understanding that may be important in this application for example many ecosystem models in common use have not been updated to include anammox or dissimilatory nitrate reduction to ammonium robson 2014a b does the model reflect the system understanding of relevant local disciplinary experts and stakeholders if not this may be a hurdle to acceptance of decisions based on model results as well as not making good use of local knowledge is the model mathematically valid and dimensionally consistent is their evidence that the implementation of the model as software correctly reflects its conceptual and mathematical basis for example does it maintain conservation of mass where two or more possible model structures have been identified what process has been followed to compare the options in some cases it may be appropriate to develop an ensemble of models to test the range of possible results and the trade offs in speed and accuracy this conceptual validation phase should be revisited after state process and system validation to consider whether the results suggest the need for re evaluation of the model structure or implementation 3 2 level one state validation the comparison of time series of physical chemical and biological state variables is the main form of model validation however it is not the only means by which the accuracy of model state can be assessed and when used in isolation may not give a complete picture of model performance in most cases the frequency of observations is significantly less than the time step of aquatic models particularly in the case of coupled hydrodynamic biogeochemical models for variables that exhibit rapid changes in time such as algal biomass during a bloom standard metrics such as mean absolute error mae and root mean square error rmse can be fundamentally weak elliott et al 2000 similarly in terms of a spatial distribution an in situ observation is usually the mean of a small sample volume being compared to model output that may represent the mean value of a much larger quantity of water various alternatives for assessing state can be considered including assessment of scales of variability and derived metrics whereby observations and simulated data are subject to some form of transformation 3 2 1 1a direct comparison classically model simulation results are compared with measured data at specific points in time and space where the measurement was taken this type of assessment is undisputedly where most effort in model validation has been concentrated and will no doubt remain the focus of most model assessments the variables selected for assessment are inherently linked to the nature of the investigation and associated choice of model approach and structural complexity nonetheless there has been a tendency for modellers to validate against an arguably small subset of simulated water chemistry variables a product of both a desire to emphasise aspects of model output relevant to the application but also commonly due to lack of observations for remaining state variables measures of model fit as in table 1 can be computed for one or more sampling stations and are generally based on calculation of residuals i e the difference between model outputs and the corresponding observations a potentially useful exercise that adds to the common error calculation is to calculate skewness or kurtosis in predictions spatial assessments of multi dimensional models against data from remote sensing platforms are increasingly being introduced other methods do not necessarily involve error calculation but rather assess patterns in data series for example spearman rank correlation sr may be more useful to identify the degree to which the order of predictions and observations from small to large magnitude are captured for example where assessment of the ability of a model to reproduce seasonal and inter annual variability is required without focusing on exact values the use of a cross correlation function ccf can allow a modeller to look for correlations in how the simulated and observed data vary with a delay across time and may be used for looking at lags in time series or alternatively may be useful in spatially resolved models to determine measures such as patch length 3 2 2 1b derived metrics describing model state this category refers to metrics that do not involve a direct assessment of state variable time series or spatial data but are derived from the simulated variables the focus of this class of metrics is to test the model against theoretically relevant indicators of ecosystem state such as relationships between variables they can provide additional evidence for demonstrating that a model is fit for purpose even if direct value comparisons e g r2 are not possible due to data limitations or if direct validation indicated a weak level of predictability examples of derived metrics could include simple stoichiometric indicators e g tn tp or other ratios of simulated variables e g doc toc chl a tss other derived quantities include assessment of relevant dimensionless numbers for example the richardson number as a measure of stratification intensity or in the case of algal bloom dynamics metrics derived from analysis of the raw state variable time series such as the average duration of a bloom or time of bloom onset 3 2 3 1c metrics describing multi scale variability in model state metrics at this level describe how well various scales of temporal or spatial variability are reproduced in our models depending on the model structure its spatial dimension and time step any given simulation will have limits on the scales that it can predict the inherent difficulty in defining what model approaches are most appropriate for a given scale e g at what temporal scale would a 1d and 3d model converge remains a large challenge in the aem community simulations may be assessed from a probabilistic point of view for example through comparison of exceedance probabilities cdfs in order to ascertain whether a model is able to capture the proportion of time or spatial domain over which a certain concentration is experienced however assessment of probability distributions alone may not be suited under non stationary conditions and they do not inform us if expected modes of variability are adequately represented for example a coupled hydrodynamic biogeochemical model might be designed to reproduce phytoplankton biomass in response to diurnal changes in productivity but also over intermediate scales due to dynamic hydrological and meteorological conditions over seasonal scales due to changes in temperature and nutrients and potentially up to decadal scales if the fundamental drivers of phytoplankton biomass are shifting approaches to assess the performance of models over these scales are described in bennett et al 2013 as data transformation methods and relevant techniques include fourier transformation fft or wavelet transforms wt to date there has been limited application of these methods for assessing aems partly due to the fact that there are few cases of modelled applications that have observational data that span such a large range of time scales reviewed by kara et al 2012 the routine application of real time sensors in aquatic systems over the past decade however is providing diverse datasets that span from time scales of minutes to decades and offer new opportunities to assess models through this approach e g hamilton et al 2015 where spatially rich observational data are available these approaches can also be used to examine model performance across multiple spatial scales spatial maps can be quantitatively compared with observational maps particularly from remote sensing observations using a variety of methods stow et al 2009 3 3 level two process validation process validation refers to assessment of model performance against the underlying rates of transformation that drive changes in model state variables i e the arrows connecting stocks or pools process validation is therefore specific to process based models indeed the most commonly cited advantage of process models is their ability to resolve the interaction of the different mechanisms that shape ecosystem state yet rarely do we rigorously assess whether they are correctly captured this is particularly relevant if we consider that most model applications adopt process parameterisations reported broadly in the literature potentially from sites that may be inherently different or from laboratory or mesocosm studies conducted under controlled conditions similarly the associated parameter estimates for these algorithms may also be chosen from within large ranges reported from diverse model applications or from laboratory assessments such as phytoplankton or sediment incubations therefore it is not obvious that models with complex interactions accurately represent spatial and temporal variability in process pathways correctly even if several model state variables are seemingly reproduced well at level 1 consequently validating models with regard to the individual flux pathways that connect individual state variables is a way of reducing equifinality helping modellers to get good results for the right reasons comparing modelled with measured flux rates also provides a way to pinpoint sources of structural and conceptual error in the model in practice this approach remains rare in aquatic ecosystem modelling as measuring variability in process rates through time and or space is resource intensive and difficult and in some cases may not yet be directly possible in situ however given that it has the potential to greatly improve confidence in the underlying function of models we believe it should be actively promoted and several examples are outlined in the following sections that may be more routinely adopted these are classified next as either being from direct measurements or indirect rate estimates 3 3 1 2a comparison with raw process measurements when developing a model it is necessary for us to distinguish between process measurements that are required to assist model parameterisation and parameter assignment and process measurements that can be used for validation a range of in situ process measurements are relevant to assess physical chemical and biological model attributes and their temporal and spatial variation these include rates of mixing fluxes across the air water or sediment water interfaces and kinetic transformations e g nutrient uptake rates of primary production or grazing specific examples highlighted in section 4 relevant to a range of different model applications are reviewed 3 3 2 2b process metrics interpreted from raw data process information can also be extracted from raw data series either derived from changes in the observed data record via inverse modelling or potentially through more sophisticated data driven models designed to estimate bulk process rates as a simple example the trend of oxygen depletion in the hypolimnion of a lake may be used to estimate the net sediment oxygen demand if other sinks are minor the use of environmental tracers and isotopic data also has potential to support validation of the flow of oxygen carbon or nitrogen for example if assumptions are made about the relative fractionation and transformation rates that occur for individual process pathways these approaches are not reported widely in the literature and usually depend on the validity of several simplifying assumptions that are made when interpreting the data however it is highlighted here as an area of increasing interest for the growing area of model data fusion as a means to compare modelled process rates against those estimated from empirical means robson 2014a hipsey et al 2015 3 4 level three system validation the complex non linear interactions and feedbacks that govern the response of aquatic systems to changes in internal or external conditions can lead to ecosystem scale emergent patterns relationships and dynamics these emergent properties are not necessarily predictable directly from the underlying model formulation and are outcomes from the model that are not a direct extrapolation of the choices made in model design allen 2010 a classic example of an emergent property is the behaviour of a flock of birds in flight which emerges in a way that is not obvious from the behaviours of individual birds although not widespread there are several examples where aquatic models have been assessed in terms of their ability to produce emergent dynamics though generally not with the direct purpose to refine model accuracy or to justify whether it is fit for purpose these provide valuable insights to ecosystem behaviour and we advocate for more effort to be placed in assessing if our models are able to capture higher order behaviour or patterns as highlighted by anderson et al 2010 a different choice of model structure may lead to different emergent dynamics where two models perform equally well at level 1 but predict different emergent system dynamics these can be treated as competing hypotheses regarding system dynamics and measurement programmes can be devised to invalidate one or both hypotheses examples of system properties that might be captured by models can include simple metrics such as scaling relationships e g nutrient loading vs chlorophyll a response or more complex spatial or temporal patterns in nutrient cycles and community dynamics in many applications these patterns may be expected based on empirical experience such as the succession of different plankton functional groups or spatial niches in a habitat multivariate comparison methods are available to explore performance of models in capturing inter relationships between variables e g a taylor diagram td and these may be particularly useful for identifying cases where models resolve emergent dynamics that are not known a priori self organising mapping som is one example among others of a machine learning method that may be suited to identification of emergent patterns in both model output and observational data that are rich in two or more dimensions e g williams et al 2014 where observational data are both spatially and temporally rich empirical orthogonal function eof decomposition can be used to analyse major modes of variance and patterns of variation which can be compared with the results of the same analysis applied to model output e g rocha et al 2019 another area being explored is the response of ecosystem state space to perturbations considering threshold effects hysteresis and alternative stable states this level of validation is especially important if the model s purpose is to define the stability or resilience of key ecosystem attributes to climate change fishing and or eutrophication at this stage only a qualitative or semi quantitative comparison may be possible 4 what metrics should i use when examples for different application contexts in this section we consider the literature through the lens of the framework outlined in section 3 by combining the framework proposed with specific assessment techniques summarised in table 1 given the predominance of level 1 validation in the literature we did not target a comprehensive identification of all published model studies that consider validation rather we aimed to collate a range of examples that have been applied across a broad range of application contexts through this review we also aimed to identify gaps and potential areas for further development of new level 2 and 3 validation approaches 4 1 hydrodynamic applications for ecosystem assessment relative to water quality and ecosystem modelling applications approaches for characterizing the performance of physical models of aquatic environments are well established most notably from the engineering and geophysical sciences literature they share some common metrics across lacustrine riverine and oceanographic model applications depending on the underlying hydrology model dimension and time frame of the simulation a range of general metrics have been categorised related to prediction of a the water balance waves and water circulation b the heat and salt balance c stratification and d bottom morphometry and sediment transport table 2 in general the validation of hydrodynamic models is achieved by conducting multiple levels of assessment first researchers can conduct time series assessment of water level temperature and salinity at fixed points and or horizontal or vertical variation derived from profile cross sections level 1 simulation of surface ice dynamics can also be undertaken by time series assessments of ice thickness complemented with derived metrics such as ice on and ice off dates level 1 e g yao et al 2014 for models that simulate surface or internal waves spectral plots are commonly reported to demonstrate power across waves of different frequency derived indices such as the richardson number as a measure of stratification intensity or schmidt stability e g bruce et al 2018 are also useful as level 1 metrics considering mixed layer depth acreman and jeffery 2007 bayer et al 2013 or thermocline pycnocline thickness and changes to surface layer thickness as a function of various driving factors can prove useful in diagnosing problems with model parameterisation for cases where periodicity varies over time wavelet plots can highlight how power is localised in frequency space over different seasons or time frames isotherm isopycnal displacement power spectra are a useful metric to demonstrate the time scale over which models are able to reproduce the internal wave field e g hodges et al 2000 level 2 validation of hydrodynamic models can include assessment of evaporative mass fluxes estimation of albedo measurement of velocities at a fixed location or from drifter tracks e g dissanayake et al 2019 and shear stresses for example at the sediment water interface or within macrophyte beds the use of direct measurements or observation based estimates of turbulent mixing could also be considered and a range of novel tracers have been adopted for dilution experiments to characterise contaminant dispersion e g caffeine and pharmaceuticals in waters impacted by wastewater effluent cantwell et al 2016 level 3 assessments in hydrodynamic models consider the formation of residual currents and eddy structures for example different but otherwise similar models reveal the emergence of different eddy structures in the north atlantic ocean holt et al 2014 hetland and dimarco 2012 undertook an assessment of a 3d hydrodynamic model of the texas louisiana continental shelf using data from moorings by presenting maps of model skill in this example surface and bottom variance ellipses are used to demonstrate the model captures the point scale and residual field in lakes and coastal environments currents created by differential heating and cooling may be assessed by indirectly comparing against profile cross sections woodward et al 2017 spatial variability in water currents creates patterns of water age distributions that emerge as a system scale property but which are not easily able to be validated the potential for using methods such as assessing against empirical estimates from conservative tracers for example from radium isotope measurements tomasky holmes et al 2013 may be able to be applied in the future the increasing applications of models for complex aquatic domains e g estuaries inter tidal wetlands river floodplains reef structures or island archipelagos requires efforts to validate the relative pattern of connectivity across modelled sub domains at smaller spatial scales level 3 assessment of other patterns that may emerge in physical models can be conducted examples include travelling waves in spatial patterns of plant wrack in intertidal zones sun et al 2010 wave attenuation in seagrass beds chen et al 2007 and the canopy structure such as the dynamics of canopy deflection properties dijkstra and uittenbogaard 2010 models with morphodynamic ability can also be assessed by examining spatial patterns in temporal changes in bottom morphometry to highlight active areas of erosion and deposition 4 2 water quality and biogeochemistry a common goal for aems is to understand the controls and dynamics of chemical and biological variables relevant to water quality what constitutes a water quality variable can vary depending on the application and context however for the purpose of this analysis the literature is categorised according to several areas of focus pertaining to prediction of a oxygen and the extent of hypoxia anoxia b the cycling of inorganic nutrients and organic matter c geochemistry d water colour and clarity e chlorophyll a and f other chemical and biological contaminant dynamics table 3 across these categories most variables being assessed are dissolved or particulate concentrations that are routinely sampled via traditional monitoring programs and subsequent time series assessments level 1 though a more detailed exploration reveals a broader range of examples that can support a diversity of potential approaches for capturing water column and sediment biogeochemistry oxygen has often been a focus of water quality models as it plays a pivotal role in nutrient cycling and sediment processes given the increasing availability of sensor data for measuring oxygen concentrations it also provides an interesting case study for how a system of metrics can assist in model assessment for this context a range of more rigorous level 1 metrics has emerged such as wavelet analysis of high frequency in situ data series from a stratified lake kara et al 2012 longitudinal analysis of surface and bottom oxygen in estuaries where strong lateral gradients exist xu and hood 2006 and the spatiotemporal extent of anoxia in a riverine estuary bruce et al 2014 and lake erie bocaniov et al 2016 direct in situ level 2 sediment flux measurements from benthic chambers or eddy correlation instruments have provided useful validation of sediment oxygen demand e g sohma et al 2008 in another example hetland and dimarco 2008 adopted apparent oxygen utilisation aou the difference between the oxygen concentration and the saturation value as an indirect process validation metric to demonstrate the model was capturing the combination of oxygen consumption mechanisms of increasing interest in lacustrine and marine environments is the application of high frequency oxygen sensors to estimate free water metabolism hanson et al 2008 where an inverse modelling technique is used to extract hourly to daily estimates of primary productivity community respiration and atmospheric exchange from diel changes in oxygen concentration e g lovato et al 2013 webster et al 2005 wikner et al 2013 winslow et al 2016 while this method provides relatively coarse estimates due to confounding factors of advection and mixing villamizar et al 2014 repeated estimates over a range of environmental conditions provide an in situ view of water column net productivity and respiration that can be used to assess model equivalents a similar approach for estimating basin scale average sediment oxygen demand has been shown to be useful in stratified lakes allowing quantification of the rates of hypolimnetic oxygen drawdown where other consumption mechanisms may be assumed to be relatively minor snortheim et al 2017 following these examples fig 3 illustrates the utility of combining relevant metrics across the assessment levels for an estuary experiencing frequent hypoxia many aquatic modelling studies have had their roots in predicting the impacts of eutrophication and have demonstrated the level 1 performance of their models against data on dissolved and total nutrients with a focus on p in freshwaters and n in marine waters an increasing trend towards simulating the complete n p si and c cycles has provided opportunity to validate models using other level 1 indicators that capture more nuanced aspects of nutrient cycling such as partitioning between organic and inorganic phases and stoichiometric variability li et al 2013 other potential level 1 metrics relate to organic matter composition such as poc doc oc on or potentially the labile refractory ratio of the simulated organic pool to date this has rarely been the subject of model assessment but it may be possible by comparing with increasingly reported data from excitation emission mass spectroscopy eems studies relevant level 2 process validation efforts can be applied in the form of comparison against in situ estimates of nitrification denitrification organic matter mineralisation and community respiration or bod data in estuarine environments dilution curves have been applied to estimate sources and sinks of materials by comparing concentrations relative to salinity for example a sink of no3 along the length of a system can be used as an indirect measure of denitrification intensity e g eyre and balls 1999 fig 4 demonstrates this approach for an estuarine carbon cycle investigation showing validation of the along stream predictions of doc dic and 13c dic and 13c doc relative to a conservative tracer in this case the use of isotopes in the calibration helped to reduce equifinality since models able to correctly capture patterns in stable isotope cycling are more likely to be resolving flux pathways that are imprinting distinct signatures during isotope fractionation processes sugimoto et al 2010 van engeland et al 2012 adiyanti et al 2016 where sediment water interaction is an important driver of nutrient cycling the flux of dissolved constituents as estimated from in situ benthic chambers or from eddy correlation can be used as a powerful level 2 approach to reduce uncertainty two examples comparing modelled against measured nh4 release are applications in chesapeake bay brady et al 2013 and tokyo bay sohma et al 2008 the net rates of carbon and or organic matter sedimentation are important drivers of water and sediment condition and are important fluxes to test models against since they can vary substantially through time and between sites in oceanic systems the rate of organic carbon export shows a logarithmic decline with depth and can be plotted as a martin curve martin et al 1987 which was tested as a validation metric of the european regional seas ecosystem model ersem butenschön et al 2012 studies employing depth resolved sediment models themselves require a significant validation effort e g paraska et al 2014 depending on availability of pore water and solid phase concentrations and can benefit from level 2 validation metrics such as denitrification efficiency oxygen penetration depth and oxygen exposure time which are known to be important determinants of carbon cycling and burial capturing vertical gradients in oxygen and other constituents in sediment for example using in situ microprofile data may mean models implicitly capture these variables but further assessment against in situ flux rate determinations e g denitrification can help test sediment model function the significance of bioturbation was indirectly validated as an important process by zhu et al 2016 by ensuring the do vs po4 flux rate matched in situ observations additional level 2 metrics for assessing sediment biogeochemical predictions may include summaries of the o2 co2 sediment water flux ratio reflecting the models ability to correctly capture the balance of aerobic and anaerobic respiration that is occurring particularly for spatially resolved models ensuring models capture empirically established scaling relationships between oxygen exposure time and carbon burial efficiency or organic matter reactivity and age as depicted by the middleburg curve may prove to be a particularly useful test however to date this has yet to be reported paraska et al 2014 simulating other aspects of aquatic geochemistry is increasingly being undertaken to capture acidity and risks associated with heavy metals examples include model applications in an acidic environment such as mining impacted landscapes salmon et al 2017 or coastal sites impacted by acid sulfate soils hipsey et al 2014 other applications include reservoir management whereby seasonal anoxia and the accumulation of metals in the hypolimnion requires models to capture the redox sensitivity of mn and fe despite its importance in driving productivity and shaping biogeochemistry the light climate has not always featured during model validation light profile data and light quality specific bandwidth attenuation including the relative shift in extinction coefficient in response to suspended sediment concentrations can be a useful exercise when included with chl a model predictions it is useful to show that predictions of chl a on average scale correctly with the suspended solids concentration chao et al 2007 2010 which may be considered a system level property the light climate is also influenced by dissolved substances though even where dissolved organic matter dom is simulated few models separate coloured dissolved organic matter cdom from other dom or specifically validate the contribution of cdom contribution to light attenuation validation of wavelength specific light attenuation profiles concurrently with cdom and suspended sediment concentrations offers the potential for us to better resolve the light climate this is likely to become more important as models aim to resolve ultra violet uv photosynthetically active par and near infra red nir due to their different effects on water thermal structure and also organism growth and mortality recently the validation of a coastal ocean model against true colour from satellite imagery also demonstrated the utility of capturing the specific contributors of light reflectance at multiple wavelengths to capture the overall light climate baird et al 2016a total chlorophyll a chl a is the most common biological variable simulated in aquatic models ranging from small ponds to the global ocean elliott et al 2000 identified the relative merits of a range of error calculation methods for algae time series many of these metrics suffered when the magnitude of the data values is large and they are unforgiving of temporal misalignments between modelled and observed data for example if a simulated bloom is of the correct magnitude but one week earlier later than the observed bloom is the model still fit for purpose further level 1 comparisons such as bloom magnitude e g for the spring and or summer may be compared separately from the bloom s timing allowing discrepancy in the latter to be isolated thus if capturing bloom size over several years was of more value than predicting its exact timing a typical error metric for assessing bloom size alone would be of greater use to the study when assessing modelled chl a time series data traditional level 1 assessment metrics can be supplemented by derived metrics such as bloom peak magnitude duration and time of onset another example is the application of wavelet analysis of a high frequency chl a time series kara et al 2012 to test model performance at predicting scales of variability from days to seasons fig 5 this approach can give an improved view over simple time series comparisons about the scales of variability that a model can capably reproduce spatial comparisons of chl a from remote sensing are becoming more common particularly in coastal and marine models and wavelet based comparison may be an effective way to evaluate model chl a against satellite data saux picart et al 2012 at level 2 rates of algal productivity i e carbon fixation determined directly from in situ experiments using isotopically labelled carbon or estimates from instruments measuring photosynthetic activity based on fluorescence can provide an indication of gross primary production gpp that can be compared with modelled rates of photosynthesis though we found this was surprisingly absent from the reviewed literature for level 3 deep chl a maxima dcms are an emergent feature of complex model dynamics that manifest in response to physical chemical and biological interactions within stratified systems and can focus model validation e g carraro et al 2012 ayata et al 2013 where model application spans a wide range of trophic conditions general scaling relationships relating system average chl a concentration to the degree of external loading may be useful for example relatively simple assessments of models of coastal domains can compare performance against the monbet relationship or in the case of freshwater lakes against the vollenweider model vollenweider and kerekes 1982 reckhow and chapra 1983 these comparisons may not be relevant for short term simulations e g of an individual phytoplankton bloom but may be useful to ensure that complex water quality models are able to meet expectations of cross system empirical data see also chang et al 2019 the simulation of biological and chemical contaminants has also been identified as an important area of aquatic ecosystem simulation for inland and coastal waters particularly for the purposes of informing public health risk assessments models of microbial pollutants have been coupled with hydrodynamic models to simulate pathogens and faecal indicator organisms and assess risk in waters used for drinking and recreation e g hipsey et al 2008 sokolova et al 2013 these studies have tended to validate models by assessing organism counts from available monitoring data hipsey et al 2004 sokolova et al 2013 however this approach is complicated since viable but non culturable cells vbnc make determining viable and inactivated fractions of organism populations uncertain the increasing adoption of molecular approaches for organism enumeration in conjunction with adaptive agent based models has been applied to resolve strains of different pathogenicity bucci et al 2012 prioritisation of validation at key exposure points e g drinking water offtakes or beaches using exceedance probability plots can also be used to demonstrate a model is suited to risk assessments simulating organic chemical contamination is still scarce likely because of the limited data available for model validation and process identification a recent study used data derived from sediment cores to validate a 60 year model simulation of polycyclic aromatic hydrocarbons pahs in a large shallow lake kong et al 2017 though further work in this area is warranted 4 3 community dynamics and ecosystem function aquatic ecologists have a long history of developing metrics to describe the structure and function of aquatic populations and communities models that aim to resolve these more complex ecological dynamics build on those listed in the previous sub section but increasingly are including a wider range of theoretically relevant indicators of ecosystem interactions and function for these studies we broadly categorised the focus of various aem applications and identified 6 broad areas of a microbial lower trophic level communities b benthic populations and habitats c pelagic populations and habitats d community structure e community function and e ecosystem response to disturbance table 4 within each category we initially considered level 1 metrics describing temporal variability of species and their interactions and the development of spatial niches we then focused more specifically on literature where models have considered measures of trophic structure and complexity inter relationships between simulated ecological groups and system level responses to ecosystem perturbation within this context the diversity of metrics did appear to be less consistent and differ more notably across the freshwater and marine community in modelling the phytoplankton zooplankton and bacterial dynamics the challenges of capturing changes at the level of species or even genus are considerable e g see lignell et al 2013 li et al 2014 andersen et al 2015 of the published aems that simulate chl a only a few aim to simulate succession at the species or genus level e g elliott et al 2006 mieleitner and reichert 2008 gal et al 2009 with most designed to simulate at the level of taxonomical e g elliott et al 2005 trolle et al 2011 chan et al 2002 or functional groups pft s e g elliott et al 2000 segura et al 2012 quere et al 2005 baird et al 2016a for these applications specific use of even level 1 validation metrics relevant to species genus group partitioning and their spatiotemporal dynamics has been limited with a reliance on validation against chl a observations discussed above a reason for this discrepancy is thought to be simply a lack of corresponding observational data where phytoplankton taxonomic data are available at all they are usually at a much lower frequency and or spatial resolution than total chlorophyll estimates and or difficulty in converting species counts into the unit used by the model e g biovolume intracellular carbon nitrogen or chl a concentrations if the observed species data can be converted into comparable units the metrics used for total chlorophyll validation can also suffice at the phytoplankton community level e g elliott et al 2000 planktonic community structure which may be a level 1 or level 3 metric depending on the model structure can also be examined in terms of relative contributions of various species to the total community biomass gal et al 2009 for example validated the relative contribution of cyanobacterial species to the total phytoplankton biomass as a function of nutrient loading into the lake this comparison provided a multi tier assessment of the model as a good fit that indicated not only successful simulation of phytoplankton biomass and the relative contribution and hence succession of the various species but also an accurate reproduction of the interactions between forcing conditions nutrient loading and the food web the latter metric ensures not only the accurate simulation of phytoplankton in the model but also the assembly of dynamics and processes occurring in the ecosystem at larger oceanic scales holt et al 2014 similarly used the emergence of correct biomass partitioning between functional groups to support validation by plotting diatoms as a fraction of total chl a and comparing with the observed scaling between the diatom fraction and total chl a as estimated from satellite observations the model data were also shown as a two dimensional density histogram as a running average and least squares regression fit to the continuum function used in brewin et al 2012 at the global scale de mora et al 2016 used the known scaling relationships between abundance of phytoplankton functional types and total chlorophyll concentrations to demonstrate the community structure was correctly reproduced fig 6 they further supported model validation with tests of n p si and fe stoichiometric ratios and carbon chl a partitioning to demonstrate the correct emergence of expected patterns from the simulated nutrient flux pathways further assessment can be undertaken to characterise model performance capturing ecological species succession level 3 true ecological succession whereby the presence of one functional group creates the conditions required for the emergence of the next group e g hearn and robson 2000 should not be confused in this context with the pattern of replacement of one functional group by another due to unrelated changes in environmental conditions sometimes also referred to as succession e g chan et al 2002 the former can be considered a genuine emergent property of the system while the latter allows only a more detailed state validation of different simulated size or functional groups graphical examination of simulated phytoplankton succession based on visual comparison of a time series has been used in a number of studies see rigosi et al 2010 for a partial list the use of quantitative metrics however has been limited and when applied it typically focuses on goodness of fit and correlation metrics successful modelling of phytoplankton succession requires accurate simulation of numerous processes and food web interactions which even a tool like a taylor diagram may not be able to confidently describe the use of tracers to evaluate food web dynamics is another efficient level 3 option for assessing a model s ability to capture the food web dynamics and in particular the trophic interactions the use of stable isotopes has become increasingly popular in empirical food web studies but also more recently as a means for assessing models the signature of stable isotopes in organisms integrates over time and provides validation of the mapping of the predator prey interactions resulting from prey preference and availability in the system thus the successful match between observed stable isotopes and model trophic levels improves confidence in the strength of the simulated trophic pathways occurring within the food web e g nilsen et al 2008 dame and christian 2008 adopting a similar approach carrer et al 2000 used bioaccumulation of dioxins in the food web to evaluate model performance of trophic linkages a further high level series of indicators is based on food quality both in terms of stoichiometry and fatty acid concentrations the use of dynamic intracellular stoichiometric ratios in a model allows the user to evaluate model performance not only in the form of changes in the stoichiometric ratio of a certain species over time but also the change in the ratios of organisms of higher trophic levels affected by the lower level organisms gaedke et al 2002 for example examined c p ratios in egested vs ingested food in the model as part of mass balance models of the food web li et al 2013 compared a probability density function of five phytoplankton group internal n p ratios with sporadic observations of minimum maximum and mean internal nutrient concentrations thingstad et al 2007 used model validation and the mismatch between simulated and observed bacterial production in a mesocosm to identify the weakness in model simulation of varying stoichiometric ratios mitra and flynn 2006 incorporated stoichiometry into a multi species predator prey model with varying elemental composition and selectivity their model successfully simulated the switch in predator diet from predation on the prey to cannibalism when the prey suffered from nutrient limitation and decreased in food quality mulder and bowden 2007 examined whether zooplankton can alter their internal stoichiometry under nutrient poor conditions and whether production efficiency of limiting nutrients increases when food quality is poor to validate their models they compared growth rates under varying nutrient use efficiency across reported food quantity quality gradients simulating growth rates with varying production efficiency under varying food quantity and quality is only possible when correct simulation of the various processes that link food quantity quality and growth rates is achieved additional unique markers such as fatty acid concentrations have been used for high level model assessment perhar et al 2012 used biochemical control on zooplankton growth by n p and highly unsaturated fatty acids hufa as a means for testing accuracy of model output as with stable isotopes and stoichiometry correct simulation of hufa concentrations require accurate model description of multiple processes within the food web as model structures and the number of species interactions becomes more complex the validation challenge becomes considerably more difficult sauterey et al 2015 simulated planktonic diversity as indicated by the shannon index which is a measure of the distribution of biomass among species and evolving cell sizes of dominant plankton species in a global ocean model they used the canberra distance to compare the distance between cell volume distributions of different model outcomes although sauterey et al did not directly compare their model results with real world shannon and canberra indices their work outlined the possibility for how the emergent feature of planktonic community diversity could be used as an additional performance metric for ecological models goebel et al 2010 were able to demonstrate how the expected patterns of plankton distribution in a coastal environment emerged in the model from the interaction of a highly diverse population much of the above discussion about pelagic plankton communities similarly applies to benthic communities bearing in mind that generally their position is fixed for most of their life history for individual macrophyte macroalgal or invertebrate species simulations biomass or organism density in coastal and lake models can be assessed across space and time to ensure habitats are accurately represented savina and ménesguen 2008 in situ rates of detritus production assessed by traps in flowing environments and rates of decay of benthic plant detritus assessed with incubation chambers can be used as a level 2 metric benthic plant productivity can be assessed by measuring changes in plant biomass when grazers are experimentally excluded and grazing rates can be assessed through food web studies supported by stable isotope measurements similarly filtration and clearance rates of filter feeders can be used for species such as mussels the 3d model study by bocaniov et al 2014 simulated zebra and quagga mussels and whilst there was limited in situ data for direct mussel filtration rate validation the effect of the mussels on improving the chl a prediction in the overlying water column was used as a proxy indicator to help justify the filtration rate predictions in a study by renton et al 2011 the development of a restored seagrass bed was simulated using a functional structural plant model results were assessed against total rhizome length length of the longest rhizome axis and total number of live buds apices axes and internodes based on a snapshot of data taken two years after the restoration began at the community level benthic plant succession can be assessed often it is the variability in benthic communities and biomass along a gradient of light depth and their relationship with patterns of benthic substrates that is important li et al 2010 tested a multi agent systems model of two macrophyte species in lake veluwe and illustrated performance using a map of occurrence indicating regions of model over and under prediction evaluating model simulations of populations of fish and higher biotic populations is somewhat more complex than variables described above due to lower sampling resolution species mobility and different indices used to characterise fish populations unless regular stock assessment data for fisheries e g savina et al 2013 or other organism counts are available it is difficult to assess model performance using traditional level 1 indicators lehuta et al 2013 and population models should be assessed using an array of alternative measures models of populations often adopt individual based approaches and the spatial context of predictions needs to be considered in light of the sampling regime used to collect observations for fish observed data are often based on catch data metrics such as catch per unit effort must therefore be translated to match simulation variables or used to qualitatively assess model spatio temporal patterns of fish abundance e g holt et al 2014 savina et al 2013 higher level indicators often used to characterise fish populations include length weight l w relationships length weight at age and size distribution histograms makler pick et al 2011 megrey et al 2007 rose et al 2007 all three indicators emerge dependent on a large number of individual and population specific interactions with environmental conditions thus accurate predictions serve as an indication of model robustness however the predictions usually also integrate over large spatial and or temporal scales and thus are not truly assessing population response at finer scales breckling et al 2005 and hölker and breckling 2005 discuss level 3 emergent properties relevant to fish population modelling self sorting age groups trophic bottlenecks size dependent winter mortality spatial organisation measures and the influence of lake morphology on phenotype assessing changing population size distributions in response to fishing pressure e g makler pick et al 2011 can also be a means to qualitatively assess ecosystem response to external forcing assessment of food webs with a high degree of variable interaction may take the form of a multivariate assessment tool e g td or more ad hoc tests of theoretically relevant patterns trends and relationships an example of the latter is the approach by fulton et al 2004 where a range of semi quantitative tests and qualitative comparisons of population and ecosystem level metrics for coastal embayment models were used predictions of the trophic structure were put in context of the sheldon spectra to demonstrate mass partitioning between trophic levels was appropriate sailley et al 2013 also compared trophic efficiency metrics that could be used to assess how complex food webs emerge including comparison of bulk community heterotroph to autotroph ratios and variation of zooplankton predator micozooplankton and predator prey scaling relationships these metrics were used in the context of comparing model structures however they may also serve as a way for modellers to compare food web predictions with data dynamic relationships that emerge within food webs such as intraguild predation and competition between species may also be used to assess models however specific level 3 metrics quantifying these measures of system organisation are difficult to define reynolds and elliott 2012 explore the predictability of several emergent properties of freshwater ecosystems including carrying capacity exergy accumulation carbon processing capacity and habitat templates i e functional zones they conclude that while species composition may remain quite unpredictable except on the basis of probabilities and hindsight the characteristic traits of the successful contestants can be anticipated with considerable certainty p 87 for more complex food web analyses deehr et al 2014 demonstrated a novel approach to validation of a complex ecopath food web through integration with n isotope data they demonstrate the strong relationship between effective trophic level etl from the model and the δ15n signature from observed organism data in the context of a marine ecosystem subject to trawling pressures ultimately a large number of modellers are seeking to elucidate fundamental ecological relationships and forecast potentially complex response pathways of ecosystems to changes in external and internal drivers metrics described in the above sections specifically support assessing sub model components e g hydrodynamics nutrients phytoplankton etc but there are range of more specific metrics that can be used to holistically assess model predictions an area of increasing interest is demonstrating models are able to capture system scale level 3 metrics such as resilience to perturbation thresholds and stable state transitions and hysteresis effects hipsey et al 2015 müller et al 2016 as yet there remain limited examples where models have been confronted with empirical data that display these trends challenges exist in terms of computing compound indices that can be used as indicators of ecosystem state though indices of water quality or ecosystem diversity are increasingly being used in a shallow lake example janse et al 2008 2010 were able to demonstrate the ability of their model to capture the threshold shift from macrophyte to algal dominance validated by an assessment across multiple lakes in doing so they were able to identify the threshold p loading level required for turbidification and subsequent restoration including demonstration of hysteresis effects which agreed well with empirical work fig 7 in a stability analysis based on the same model kuiper et al 2015 showed that the food web and system stability gradually decreases with the distance from the critical loading in the bistability range for both directions thereby highlighting the potential for correctly formulated models to inform users on phenomena such as critical slowing down ecosystem flickering and system resilience these studies hold great promise for informing assessment of the next generation of aems that can be more confidently applied to predict ecosystem collapse recovery and restoration strategies 5 discussion the four levels of model validation may be challenging bearing in mind in the past often inadequate data have been limiting the extent to which assessment could be advanced however we are seeing an ever increasing range of data streams from new monitoring technologies such as optical nutrient loggers rode et al 2016 claustre et al 2019 improved processing of existing sources such as satellite observations jouini et al 2013 citizen science initiatives dickinson et al 2010 open access and long term monitoring initiatives and real time data portals reed et al 2010 all these data hold the potential to improve the way we run and assess environmental models indeed aquatic ecosystems modellers are beginning to take up these data streams li et al 2010 johnson and needoba 2008 turuncoglu et al 2013 and it is timely to reconsider the ways we can use this data to improve our model formulations and to describe model uncertainty 5 1 improving models through improved assessment several recent commentaries have discussed the challenges and issues in application of complex environmental models in general nordstrom 2012 and aems in particular robson 2014a trolle et al 2012 arhonditsis et al 2014 frassl et al 2019 the emergence of community models and flexible modelling frameworks to reduce duplication of effort e g bruggeman and bolding 2014 mooij et al 2014 hipsey et al 2019 and the application of advanced techniques for assessment of model error and sensitivity go some way towards addressing these challenges the csps framework and examples we provide is an attempt to help modellers move from relying on level 1 metrics to more robust and insightful level 2 and 3 metrics in order to more thoroughly challenge our models and assess their capabilities and limitations as these metrics become more widely used and reported they will facilitate an increased depth of analysis in comparative studies e g salihoglu et al 2013 kim et al 2014 kwiatkowski et al 2014 tittensor et al 2018 and help us to assess how different model structures parameterisations and algorithms perform across a diverse range of applications and simulation contexts for the foreseeable future there may be insufficient data to complete assessment at all four levels in every case nonetheless being aware of the diversity and suitability of metrics at multiple levels and being explicit about the level 0 3 at which assessment has been conducted will help modellers to communicate the type of assessment that is being performed and the implications for model uncertainty this awareness may also facilitate prioritisation of observational studies and monitoring programs that consider not only state variables but also fluxes and emergent properties in other words ecological states rates and traits undertaking assessment using this structured approach can help modellers to further pinpoint where models are fundamentally weak and communicate to stakeholders where further investment in data collection and monitoring will support prediction conversely modelling that leads to discovery of new or interesting phenomena can motivate new experiments or monitoring to support post hoc validation efforts 5 2 model purpose and selection of appropriate metrics technical assessment of models is varied and requires the development of workflows that bring together several methods tailored to the specific application bennett et al 2013 and taking into account the intended purpose of the model e g harmel et al 2014 the examples in tables 2 4 are intended to provide an expandable library that can serve as the basis of a common reference for assessment of aquatic system models some examples may serve to cross fertilise ideas across sub disciplinary divides for example target or taylor diagrams are widely used in oceanography but not routinely used for freshwater models note that not all are relevant in any given case for example a specific relationship may be used to parameterise the model directly in which case it is less suitable as a validation tool others may only be applicable to specific spatial or temporal model resolutions for example a metric quantifying stratification and mixing requires a minimal vertical disaggregation of the water column the selected metrics will also depend on the model purpose models used for operational forecasting may prefer different assessment metrics than those designed to explore algal seasonal dynamics or long term nutrient load assessments in either case a combination of level 1 metrics may demonstrate the model s potential and support with level 2 metrics would help to ensure the model was not over fitted and introduce a higher level of credibility into the assessment however if the intention is to then apply the model outside the bounds of historical conditions to explore the impact of major system changes on ecosystem dynamics then including level 3 validation becomes an important step well validated modelling studies in different disciplinary areas e g ponds lakes rivers and marine systems demonstrating use of metrics across multiple levels are encouraged to serve as benchmarks that can guide practitioners 5 3 using multiple metrics to enrich the calibration and uncertainty assessment process calibration of aems has historically been a relatively manual trial and error process though formal calibration methods are beginning to be used in both marine e g parslow et al 2013 and freshwater ecosystem modelling e g ramin and arhonditsis 2013 dietzal and reichert 2012 the adoption of calibration validation pairing e g trolle et al 2008 where validation relies on a data set independent from that used in calibration remains the exception rather than the rule in aquatic ecosystem modelling though it is common in other fields and widely considered best practise robson 2014b adopting a calibration and validation period can avoid overfitting model parameters and identify the predictive capability of a model particularly where patterns during the validation period differ from those in the calibration period widening the range of metrics models are assessed against may assist in achieving a broader application of calibration validation pairing in recognition of model uncertainty and equifinality problems there has been a shift in some areas of the aem community to change model calibration practice from seeking a single optimal value for each model parameter to seeking a range of parameter sets that all meet a pre specified standard of agreement with the data aldenberg et al 1995 stow et al 2007 arhonditsis et al 2007 chiu and gould 2010 janse et al 2010 running an ensemble of simulations using values from amongst these acceptable parameter sets provides a basis for estimating the uncertainty associated with model predictions this practice termed physical statistical modelling kuhnert 2014 relies on bayesian probability to combine existing prior information with observations to project the posterior likelihood of ecosystem response the effective characterisation of model uncertainty using bayesian approaches depends upon two critical steps i selection of a sampling scheme to generate input vectors e g latin hypercube markov chain monte carlo etc and ii selection of a likelihood measure to quantify model misfit in complex models the choice of likelihood measures for assessment leads to conceptual dilemmas for modellers such as the selection of likelihood functions that can meaningfully change the inference drawn beven and freer 2001 hong et al 2005 arhonditsis et al 2008b by further tailoring the adopted likelihood measures to consider the assessment ideas introduced in this paper the model calibration and uncertainty process can be enriched to focus on more diagnostically powerful likelihood measures finally recognising that there is no true model of an ecological system but rather several adequate descriptions of different conceptual basis and structure ensemble modelling is a means to obtain better predictions and a better understanding of uncertainty by combining the results of competing models trolle et al 2014 several methods exist to synthesise predictions across ensembles including sequential data assimilation approaches such as the ensemble kalman filter and ensemble particle filters moradkhani et al 2006 vrugt and robinson 2007 and post hoc ensemble integration strategies such as the bayesian model averaging bma ramin et al 2012 including models of differing complexity and with varied structures in the ensemble allows structural uncertainty to be addressed alongside uncertainty from input data and parameter selection when combined with the use of more specific and nuanced assessment metrics modellers can better decide which model structures perform best without an overt reliance on diagnostically weak level 1 error metrics thus motivating reconsideration of their level 0 validation 6 conclusions in evaluating the performance of a model we want to know the answers to several questions is the model capable of reproducing observations if so is it getting it right for the right reasons or conversely is it over fitted or does it have one error cancelling another can we trust the model to make predictions if so in what range of circumstances can we trust it to answer these questions in the case of mechanistic aems we need to go beyond simply comparing simulated and observed concentrations of state variables here we present a way forward the hierarchical csps framework to encourage evaluation of models at four levels conceptual accuracy level 0 state accuracy level 1 process accuracy level 2 and accuracy in capturing system behaviour level 3 assessment at level 2 can improve confidence in the biogeochemical basis of model formulations while assessment at level 3 allows modellers to critically assess model predictions against spatial and temporal scales of change stoichiometric indices and a range of trophic relationships all of which are based on theoretically informed indicators of ecosystem function arguably only applications that perform well at highest level of assessment justify the implementation of complex process based models short to mid term forecasting predictions after all can often be less expensively and more accurately produced through simpler approaches such as regression modelling robson and dourdet 2015 or evolutionary algorithms recknagel et al 2014 while if the aim is to shed light on system function a model that fails to perform at level 3 may be producing the right answer for the wrong reason though it may not always be possible to rigorously assess a model at all levels modellers should strive to ensure the level of assessment is suited to the purpose of the model and the severity of consequences of an incorrect prediction a model that is successfully validated for a specific system at all four levels is one that can be applied with confidence to forecast future trajectories of the system a model that has been successfully validated across several systems at all four levels is one that can more generally be applied with confidence over time it is envisioned that the community driven adoption of these metrics will accelerate advances in model structure and function and provide an improved foundation for model assessment on which developments in model data fusion can be built software and data availability the system of metrics reported in the present analysis is an evolving collection and can be accessed online at https aquaticecodynamics github io aem metrics author contributions mrh gg and bjr designed the framework outline and prepared the main manuscript body with ga all authors contributed to metric identification literature review preparation of the tables and figures and manuscript development and revision funding mrh received support from the australian research council dp130104078 dp170104832 lp130100756 lp150100451 ccc received support from the national science foundation nsf1753639 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge discussions with members of the aquatic ecosystem modelling network aemon including louise bruce karsten rinke paul hanson david hamilton and wolf mooij and the suggestions and improvements made by two anonymous reviewers 
26027,lake erie has experienced a resurgence of cyanobacterial harmful algal blooms chabs since the early 2000 s dominated by microcystis aeruginosa which produce toxins known as microcystins we develop an approach to predict the spatially and temporally resolved probability of exceeding a public health advisory pha level 6 μg l of microcystins in the western basin of lake erie that would be suitable for use in a forecast system consisting of 1 an existing hab chlorophyll forecast system 2 a toxin chlorophyll a relationship that is updated weekly from observations and 3 a statistical model relating observed relative frequency of exceeding the pha to model predictions over a hindcast period we evaluate the system s performance and the system s useful level of skill this novel approach to a chab toxin forecast system could provide a decision support tool to lake erie stakeholders and the approach may be adapted to other systems keywords lake erie cyanobacterial harmful algal bloom microcystin short term forecast probabilistic forecast 1 introduction harmful algal blooms habs occur when phytoplankton grow rapidly and produce toxins that can have adverse effects on people and aquatic ecosystems lake erie the most productive warm and shallow of the laurentian great lakes of north america fig 1 a has experienced a re emergence of cyanobacterial harmful algal blooms chabs since the early 2000 s chabs are linked to excess nutrient input from agricultural land and urbanized areas and may intensify with climate change due to their competitive ability to grow at warm temperatures o neil et al 2012 the most severe blooms in lake erie originate in the shallow western basin fig 2 which receives runoff from a large agricultural watershed through the maumee river kane et al 2014 in 2014 the city of toledo issued a do not use order for their drinking water system due to contamination with microcystins that affected 0 5 million people for 2 5 days brittain et al 2000 michalak et al 2013 wynne and stumpf 2015 levy 2017 steffen et al 2017 furthermore in 2015 lake erie experienced the most extensive algal bloom on record stumpf et al 2016a these events motivate continued research into strategies for reducing the extent and toxicity of chabs and the development of decision support systems that can help mitigate their negative impacts chabs in lake erie are dominated by microcystis aeruginosa which produces microcystins a class of cyclic peptides rinta kanto et al 2009 microcystins are hepatotoxins and can cause liver and kidney disease in humans who have been exposed through drinking water or involuntarily ingesting the toxins when swimming in contaminated water to protect public health ohio epa established microcystin drinking water threshold concentrations for children under 6 years of age and sensitive population as 0 3 μg l and 1 6 μg l for children 6 and older including adults ohio also implemented guidelines for recreational contact a public health advisory pha microcystin lr concentration of 6 μg l was established above which swimming and wading are not recommended and water should not be swallowed and surface scum should be avoided a no contact advisory nca microcystin lr concentration of 20 μg l was established above which the public should avoid all contact with the water based on peer reviewed and published science in may 2019 usepa also recommended new microcystin public health threshold concentrations as 8 μg l u s epa 2019 therefore predictions of when and where the microcystin concentration will exceed advisory concentrations are potentially useful to support decision making by stakeholders including public drinking water systems and recreational users affected by chabs even though cyanobacteria are the source of microcystins the association between cyanobacteria densities and microcystins is not consistent stumpf et al 2016b toxic and non toxic strains of microcystis exist within the same chab and toxin production varies over time hollister and kreakie 2016 davis et al 2009 in addition other non toxic forms of phytoplankton exist in lake erie thus chlorophyll a may be present in the absence of either cyanobacteria or associated microcystin toxin however the highest toxin concentrations in lake erie occur in association with increased microcystis biomass in blooms and in surface scums conditions also associated with high concentrations of chlorophyll a rinta kanto et al 2005 2009 therefore when toxin concentration is high the majority of the phytoplankton biomass is due to cyanobacteria with detailed analysis shown in section 3 2 and we can potentially use chlorophyll a concentration to predict the probability of microcystin concentration exceeding advisory levels under these conditions hollister and kreakie 2016 stumpf et al 2016b previous forecast research has focused on chab abundance and spatial distributions and did not attempt to predict toxin concentrations wynne et al 2013 developed a short term forecast of hab location and transport that combined satellite remote sensing data with a hydrodynamic model stumpf et al 2016a developed a seasonal forecast of maximum hab extent based on statistical association between spring phosphorus loads from the maumee river and maximum hab extent rowe et al 2016 developed a short term 5 day hab forecast model known as the lake erie hab tracker which included the vertical distribution of buoyant microcystis colonies in the water column the hab location in the short term forecast is initiated from satellite derived cyanobacterial index data wynne et al 2008 and movement is predicted using modeled currents from the noaa lake erie operational forecast system leofs kelley et al 2018 an application of the finite volume community ocean model fvcom chen et al 2003 and a lagrangian particle tracking model churchill et al 2011 huret et al 2007 the experimental lake erie hab tracker model has provided daily nowcast and forecast information in july october of 2016 2019 www glerl noaa gov res habs and hypoxia habtracker html we present and assess an approach to forecast the spatial and temporal probability of microcystins exceeding various advisory guidelines in lake erie the toxicity probability forecast was achieved through a combination of a 1 hab tracker model rowe et al 2016 2 linear regression model to correlate extracted chlorophyll a and microcystin concentrations derived from weekly sampling in western lake erie section 2 and 3 a functional relationship giving the probability of in situ microcystin measurements exceeding advisory levels conditional upon model predicted microcystin levels based on data compiled over a hindcast period section 3 because in lake erie the microcystin chlorophyll a ratio varies temporally over the bloom season july to october more so than spatially on a given day the forecast system assumes that the relationship between microcystins and chlorophyll a is spatially uniform but varies over time according to the most recent weekly sampling data we trained the model over 2014 to 2016 and assessed the model in 2017 a year that was outside the calibration period 2 materials and methods 2 1 in situ observations starting in 2008 water samples were collected between weekly to bi weekly at eight stations by the cooperative institute of great lakes research ciglr and the national oceanic and atmospheric administration noaa great lakes environmental research laboratory glerl in western lake erie fig 1 https accession nodc noaa gov 0187718 many of the stations were sampled consistently from 2008 to 2017 sampling usually occurred from june to september covering the peak growing season for cyanobacteria for this study we used paired chlorophyll a and microcystin data from a given sample to obtain a representative sample in the presence of surface scums a niskin bottle was inserted vertically into the water until it was submerged to avoid surface scum accumulations the top of the niskin bottle was submerged about 0 5 m below the surface and collected an integrated surface sample between 0 5 and 1 25 m in depth samples were kept cool and transported to noaa glerl for analysis of including chlorophyll a particulate intracellular and dissolved extracellular microcystins the weekly samples were collected on monday with results for chlorophyll a and microcystins typically available on wednesday particulate microcystins were measured by filtering water samples onto a 3 μm polycarbonate membrane which were stored at 20 c until analysis samples were lysed using three freeze thaw cycles followed by addition of the quiklyse reagents abraxis llc warminster pa the concentration of microcystins were measured using a microcystin enzyme linked immunosorbent assay elisa abraxis llc and reported as microcystin lr equivalents the detailed method for microcystins was described by steffen et al 2017 in addition we used western lake erie toxin data from multiple organizations to assess the toxin forecast system hindcast which we refer to as the toxin database the toxin database included all glerl ciglr weekly sampling red stars in fig 1b ohio epa data blue squares including ohio epa lake erie ambient stations and lake erie public water system intakes data http wwwapp epa ohio gov gis mapportal hab monitoring html ohio state university stone lab sampling black squares and charter boat captains sampling data https ohioseagrant osu edu research live water green circles and usgs data at maumee bay state park cove 3 in ohio yellow star the charter boat captains data were sampled using a 2 m long tube lowered from the surface which is referred to as an integrated sample model results were compared with observations over a comparable depth for surface or integrated samples 2 2 satellite remote sensing data we used a series of images of cyanobacterial blooms in lake erie from july to october 2014 2017 obtained from the moderate resolution imaging spectrometer modis with 1 km spatial resolution wynne and stumpf 2015 the cyanobacterial index ci was obtained using a spectral shape algorithm based around 680 nm wynne et al 2008 tomlinson et al 2016 the ci varies linearly with biomass with a value of 10 3 sr 1 corresponding to approximately 105 cells ml 1 stumpf et al 2012 modis provides two overpasses daily aqua and terra which result in 60 70 cloud free images per year during the summer when habs occur vander woude et al 2019 in this study we used images with greater than 50 cloud free coverage in western lake erie for initialization of the hab tracker model the cloud covered areas of satellite images were filled in using model data from the previous day s run rowe et al 2016 2 3 predictive model hindcast simulation a conceptual diagram depicts the data flow through our forecast system fig 3 the system builds on the output of the hab tracker model process m1 described by rowe et al 2016 to predict the spatially resolved chab chlorophyll a concentration and movement 5 day forecast using a lagrangian particle tracking model initialized from satellite derived chab concentration and forced by currents and turbulent diffusivity from a numerical hydrodynamic model leofs the hab tracker model produces concentration output with a vertical resolution of 1 m with the number of layers depending on the water depth the modeled chab chlorophyll a concentration data d1 is transformed to toxin concentration data d2 using a linear regression model of chlorophyll a concentration versus microcystin concentration process m2 1 c t p r e d β 0 β 1 c c h l ε where c t p r e d is a predicted microcystin toxin concentration and c c h l is the chlorophyll a concentration from the hab tracker model the parameters β 0 and β 1 are estimated by linear regression and ε is uncertainty component reflecting the difference between observations and the fitted linear relationship the observations used to estimate the parameters in eq 1 were from glerl ciglr in situ grab samples in which toxin and chlorophyll a were measured in the same samples at a time before and closest to the model initiation time the average time gap between in situ observations and model initialization from 2014 to 2017 is 1 2 days the parameters in eq 1 were re calculated for every forecast using observations from the most recent weekly sampling date on sample dates when fewer than three observations were available we also included observations from the preceding sample date finally after matching predicted toxin concentration c t p r e d to in situ observations c t o b s we transformed the predicted toxin concentration into a probability of exceeding specified toxin concentration thresholds c t i t h r e s h using a statistical model process m3 2 p c t o b s c t i t h r e s h f c t p r e d where p c t o b s c t i t h r e s h represents the probability of in situ observed microcystin concentration exceeding the threshold value which was estimated by binning c t o b s into intervals of c t p r e d over the hindcast period and calculating the fraction of c t o b s c t i t h r e s h for each interval of c t p r e d the function f c t p r e d was then fit to the calculated values of p c t o b s c t i t h r e s h by nonlinear least squares regression through the use of a probabilistic forecast the level of uncertainty in the forecast system can be properly conveyed jolliffe and stephenson 2003 including uncertainties in satellite derived estimates of chab abundance in situ toxin measurements a transport model and the regression model eq 1 the transition from microcystin concentration to the probability of exceeding a threshold is achieved by a statistical model eq 2 equation 2 gives the probability of observations exceeding the health advisory concentrations given that the model predicted microcystins are within a range based on observed and modeled microcystin concentration matchups over the 2014 to 2016 hindcast 2 4 model assessment we used skill metrics for binary event forecasts to assess the forecast system hogan and mason 2012 rowe et al 2016 anderson et al 2016 including the probability of detection pod the probability of false detection pofd frequency bias b and the pierce skill score pss the skill scores were defined as 3 p o d a a c 4 p o f d b b d 5 b a b a c 6 p s s p o d p o f d a d b c b d a c where a represents the number of correctly predicted events hits b incorrectly predicted events false alarms c false negatives misses and d correct nonevents with an event defined as microcystin concentration exceeding a specific health advisory level p o d is a positively oriented score higher values represent better performance with values in the range 0 1 p o f d is a negatively oriented score higher values represent worse performance in the range of 0 1 p s s is a positively oriented score in the range of 1 1 with positive values indicating larger p o d than p o f d b is the ratio of predicted events to observed events in the range of 0 and equals 1 for an unbiased forecast numerous studies describe methods to assess probabilistic forecasts in meteorology e g bettge and baumhefner 1981 doswell and flueck 1989 wilks 1995 we applied two methods the reliability diagram and the receiver operating characteristic roc curve to evaluate the probabilistic forecast reliability represents the degree of agreement between forecast frequency or probability and observed frequency a reliability diagram hartmann et al 2002 with the observed frequency of an event plotted against the forecast probability of an event can effectively tell the user how closely the forecast probability corresponds to the actual chance of observing the event in the case of perfect reliability the forecast probability and the observed frequency should be equal and the plotted points should be on the diagonal the roc curve is based on signal detection theory and attempts to measure the relative signal and noise ratios contained in forecast information in the form of pod to pofd ratios egan 1975 mason 1982 in a roc curve the forecast probability is converted into a continuous set of yes no binary events based on the given probability thresholds and pod and pofd are compared within the probability thresholds swets 1973 egan 1975 mason 1982 mason and graham 1999 when the roc curve lies above and to the left of the 0 0 to 1 1 diagonal the model has good prediction skill when the curve lies below and to the right of the diagonal the model lacks skill the roc score auc is defined as the area under the roc curve correspondingly when auc is larger than 0 5 the model performs better than random chance and worse than by chance when auc is smaller than 0 5 3 results 3 1 association between chlorophyll a and microcystin concentrations chlorophyll a may be a useful indicator of microcystin concentration if microcystins are mainly contained within cyanobacterial cells in our data extracellular microcystins were a relatively small fraction of total microcystins fig 4 when total microcystin concentrations particulate plus dissolved were greater than 1 6 μg l adult drinking water advisory level given that microcystins were primarily intracellular particulate when advisory levels were exceeded it may be anticipated that microcystins are unlikely to exceed advisory levels in the absence of high chlorophyll concentrations to investigate this concept we calculated the proportion of microcystin concentrations exceeding threshold values within intervals of chlorophyll concentration and calculated a 95 confidence interval on the proportion the probability of exceeding microcystin advisory levels increased monotonically with increasing chlorophyll a concentration fig 5 which supports the concept of using cyanobacterial chlorophyll a concentrations as a means to predict the probability of exceeding microcystin advisory levels these exceedance probabilities only apply to western lake erie and may change over time with changes in the phytoplankton community such exceedance probability analysis can be used to predict toxin concentration in the absence of microcystin measurements hollister and kreakie 2016 we investigated temporal variation in the microcystin chlorophyll a ratio q m c y s t m c c h l over the bloom season july to october and across years here q m c y s t is taken to be a surrogate for the toxin to biomass ratio of the phytoplankton community if we assume that q m c y s t varies depending on environmental and ecological conditions and that the transport time of water masses among the limited spatial domain of our sampling program is shorter than the time scale over which the drivers of q m c y s t vary we may expect the microcystin chlorophyll a ratio q m c y s t m c c h l to vary temporally more so than spatially on a given day values of q m c y s t show strong seasonal variability fig 6 which usually peaks in july or august inter annual variability is also strong with a much greater maximum value of q m c y s t in 2009 and 2014 than in other years in contrast the range of q m c y s t on a given date representing spatial and sampling uncertainty combined is smaller than the range of q m c y s t values in the whole data set since 2008 or in one year values of q m c y s t also exhibit temporal autocorrelation with low values typically occurring early in the season high values mid season and low values again late in the bloom season based on the above analysis we assumed that toxin concentration was proportional to cyanobacterial biomass as represented by chlorophyll a concentration we further assumed that q m c y s t was spatially uniform but varied by sampling week thus we used linear regression to determine parameters in eq 1 for each sampling date uncertainties introduced by these assumptions will ultimately be conveyed by a probabilistic forecast fig 3 m3 fig 7 shows all the linear regressions for the hindcast simulations in 2014 with data collection time and model initialization time on each plot most of which are significantly different from the climatological regression based on all ciglr glerl samplings from 2008 to 2017 green lines in fig 7 the chow test chow 1960 demonstrated that the coefficients of the regression models change with time the r2 values for the hindcast simulations from 2014 to 2017 generally increased with the increase of averaged microcystin concentration on a single sampling day fig 8 when the averaged microcystin concentration is larger than 1 6 μg l most of r2 values are larger than 0 39 when the averaged microcystin concentration is larger than 6 μ g l pha threshold r2 is larger than 0 9 when average microcystin concentration is low a situation when the microcystins producing cyanobacteria are not dominant the r2 for linear regression between chlorophyll a and microcystins can be small as shown in fig 8 under this condition the model predicts low microcystin concentration resulting from a low microcystin chlorophyll ratio for example the point on the lower left corner of fig 8 with r2 of 0 03 and average microcystin of 1 23 μ g l 1 from august 25 2015 fig 9 represents the lowest r2 of our hindcast period using the linear regression model based on this day s sampling the model appropriately predicts low microcystin concentration fig 9 and a low probability 12 of exceeding the public health advisory level fig 11 3 2 spatial and temporal prediction of microcystin concentration we predicted microcystin concentration during the five day forecast period by combining eq 1 with chlorophyll a predicted by the hab tracker model fig 3 d2 we then compared the modeled microcystin concentrations with the toxin database using matchup criteria described in section 2 1 for example snapshots of modeled surface toxin concentrations in 2014 are shown in fig 10 with the corresponding surface and integrated observations plotted using symbols on the same color scale we assessed model skill in predicting exceedance of advisory levels by comparison with in situ observations over 2014 to 2016 with comparable bias for different advisory levels the model performed best at mid range concentrations associated with the pha and ohio epa adult drinking thresholds having pss values of 0 41 and 0 37 respectively table 1 because pss is largest for the pha threshold we focused on prediction of exceeding the pha threshold as a goal for the forecast system 3 3 probability of exceeding toxin threshold using the model and in situ microcystins matchups between 2014 and 2016 we calculated the probability of exceeding a health advisory level given that the model predicted microcystins were within a specified range fig 11 for example when the modeled microcystin concentration is larger than 10 μg l the probability of in situ observations exceeding the pha level is 50 the relationship between modeled microcystin concentration c t p r e d and exceedance probability f c t p r e d as in equation 2 was fit through nonlinear least squares estimates of a nonlinear model fig 11 7 f c t p r e d 1 p 0 exp c t p r e d γ ε where γ is an unknown parameter and 1 p 0 is the vertical intercept approximated as the probability calculated by model in situ matchups when c t p r e d is 0 ε is uncertainty component reflecting the difference between calculated probability gray dots in fig 11 and the fitted nonlinear relationship for the modeled microcystin concentration larger than 65 μg l the probability of event occurrence was 90 in process m3 fig 3 eq 7 was used to convert modeled microcystin concentrations to a probability of exceeding the pha level fig 12 3 4 skill assessment of the probabilistic forecast the reliability diagram compares the observed relative frequency to the forecast probability microcystin concentrations in the toxin database were used to assess the toxin forecast from 2014 to 2017 with 2017 representing an independent time period not used in calibration of eq 7 fig 13 a shows the reliability diagram for the probabilistic forecast of microcystin concentration exceeding pha advisory concentration 6 μg l based on 85 forecast runs for years 2014 2016 and fig 13b based on 56 forecast runs for year 2017 the 1 1 line represents the situation with perfect reliability where the predicted probability exactly matches the observed fig 13a shows that from 2014 to 2016 the confidence interval of the model reliability curve overlaps the 1 1 line although the model tended to over predict the frequency of exceedance on average in 2014 2016 the area under the roc curve auc in years 2014 2016 is 0 71 and 0 87 for year 2017 which means the forecast is better than by chance auc of 0 5 4 discussion drawing on a large data set of microcystins and chlorophyll a observations in western lake erie we found that microcystin pha concentrations were unlikely to be exceeded when chlorophyll a concentrations were low fig 5 and that chlorophyll a was a useful predictor of microcystin concentrations when the mean microcystin concentration was near pha levels fig 8 at pha levels microcystins are primarily intracellular fig 4 and thus it is reasonable to assume that microcystins scale with algal biomass however these conditions do not always prevail and at times non toxic phytoplankton are dominant in which case chlorophyll a is a weak predictor of microcystins but regression of microcystins on chlorophyll a appropriately predicts toxin concentrations near the mean at all chlorophyll levels fig 7a this approach could fail if chlorophyll a concentrations at the monitoring stations do not cover the range of values over the full prediction spatial domain requiring extrapolation of a poorly predictive relationship our monitoring stations are located in the area most affected by habs wynne and stumpf 2015 and are likely to capture the highest chlorophyll a concentrations but extrapolation should be avoided given that predictive models relating microcystin toxin production to environmental drivers are lacking bullerjahn et al 2016 we resorted to an approach driven by weekly updated observations the microcystin chlorophyll a ratio q m c y s t varied in a seasonal pattern and changed over time with changes in the phytoplankton community reaching maximum values in july or august with the maximum value varying by year the variance in q m c y s t ratio on a given date represents a combination of sampling uncertainty and any spatial pattern that may exist our sampling program lacked the level of replication and spatial extent that would be required to distinguish a spatial pattern from sampling uncertainty thus we resorted to the assumption of spatially uniform q m c y s t determined by linear regression we anticipate that over a sufficiently broad spatial extent the assumption of spatial uniformity of q m c y s t would fail for example toxic habs rarely occur in the central basin of lake erie ohio epa data however the database of microcystin observations that we used for model assessment fully covered the southern half of the western basin fig 1b where habs occur and covered a broader spatial extent than the monitoring stations that we used to determine q m c y s t fig 1a thus our skill assessment is largely representative of the region over which the forecast would be applied however it may be appropriate to limit model predictions to the region over which the model has been assessed if improved predictive models of q m c y s t as a function of environmental drivers become available the spatially uniform linear regression model used here could be replaced within the forecast system framework we describe the spatial distribution of cyanobacterial biomass and associated toxin concentration is quite variable at small spatial scales fig 2 which introduces challenges in obtaining in situ observations that are representative over spatial scales of satellite or model data km our predictions of microcystin concentrations showed some skill but large mis matches also occurred fig 10 therefore it is most appropriate to represent our toxin predictions in terms of probability our forecast system was most skillful at predicting exceedance of toxin thresholds at intermediate toxin concentrations table 1 at the lowest threshold level 0 3 μg l dissolved microcystins may be equal or greater than particulate microcystins conditions under which chlorophyll a algal biomass was not predictive of total microcystins at the highest threshold level 20 μg l relatively few observations existed for calibration of the conditional probability function eq 7 the conditional probability function can be refined as additional observations accumulate over years both measures of performance of the probabilistic forecast indicated a potentially useful level of skill we characterized the performance of the probabilistic forecast of exceeding the microcystin pha level over the 2014 to 2016 hindcast period and for 2017 a year that was not included in calibration of the model using the reliability diagram and the roc curve in the reliability diagram the forecast probability was within uncertainty bounds of observed relative frequency given limited observations the roc curve provides an analysis of the forecast performance from the perspective of a decision maker fig 13c and d a user whose decision is sensitive to the pofd of the forecast system may use this plot to identify a forecast probability threshold that maximizes pod while keeping an acceptable pofd for example such a user would be able to achieve a 70 pod while maintaining a 6 pofd using a probability threshold of 20 for year 2017 using the conditional probability function fig 7 obtained from comparison of model predictions to observations over the hindcast period ensures that the various sources of uncertainty are reflected in the predicted probabilities even though multiple sources of uncertainty in our complex forecast system contribute to limited skill the final product reasonably discriminated between high and low probabilities of exceeding the pha sources of uncertainty in the probabilistic forecast point to opportunities to improve the forecast system uncertainty arises from satellite derived initial conditions for bloom location and biomass the hydrodynamic forecast and the lagrangian particle transport model improved accuracy in each of these components will improve skill of the forecast system as additional toxin observations accumulate the conditional probability function can be refined because the linear regression model ignores spatial variability of the association between chlorophyll a and microcystins and the temporal variability is updated weekly at the most frequent uncaptured variability in the microcystin chlorophyll a relationship contribute to model error increased frequency or spatial extent of microcystin and chlorophyll a paired observations would likely improve forecast skill if predictive models of the microcystin chlorophyll a as a function of environmental variables become available they may be substituted for the simple linear regression in the forecast system this effort provides a path toward an operational short term forecast system for the probability of exceeding hab toxin advisory levels in lake erie provides a benchmark against which to assess future efforts and provides an approach that may be applied to other systems affected by toxic cyanobacterial blooms declaration of competing interests the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements funding was awarded to cooperative institute for great lakes research ciglr through the noaa cooperative agreement with the university of michigan na17oar4320152 this is ciglr publication 1157 and glerl publication 1943 the project was supported by the u s epa great lakes restoration initiative lake erie algal toxin and water quality data used in this analysis were compiled by limnotech from public sources including noaa https data nodc noaa gov cgi bin iso id gov noaa nodc 0187718 ohio epa https epa ohio gov ddagw hab and the ohio state university https ohioseagrant osu edu research live water the lake erie hab tracker model rowe et al 2016 was developed using the finite volume community ocean model fvcom and associated lagrangian particle tracking model available through university of massachusetts dartmouth http fvcom smast umassd edu 
26027,lake erie has experienced a resurgence of cyanobacterial harmful algal blooms chabs since the early 2000 s dominated by microcystis aeruginosa which produce toxins known as microcystins we develop an approach to predict the spatially and temporally resolved probability of exceeding a public health advisory pha level 6 μg l of microcystins in the western basin of lake erie that would be suitable for use in a forecast system consisting of 1 an existing hab chlorophyll forecast system 2 a toxin chlorophyll a relationship that is updated weekly from observations and 3 a statistical model relating observed relative frequency of exceeding the pha to model predictions over a hindcast period we evaluate the system s performance and the system s useful level of skill this novel approach to a chab toxin forecast system could provide a decision support tool to lake erie stakeholders and the approach may be adapted to other systems keywords lake erie cyanobacterial harmful algal bloom microcystin short term forecast probabilistic forecast 1 introduction harmful algal blooms habs occur when phytoplankton grow rapidly and produce toxins that can have adverse effects on people and aquatic ecosystems lake erie the most productive warm and shallow of the laurentian great lakes of north america fig 1 a has experienced a re emergence of cyanobacterial harmful algal blooms chabs since the early 2000 s chabs are linked to excess nutrient input from agricultural land and urbanized areas and may intensify with climate change due to their competitive ability to grow at warm temperatures o neil et al 2012 the most severe blooms in lake erie originate in the shallow western basin fig 2 which receives runoff from a large agricultural watershed through the maumee river kane et al 2014 in 2014 the city of toledo issued a do not use order for their drinking water system due to contamination with microcystins that affected 0 5 million people for 2 5 days brittain et al 2000 michalak et al 2013 wynne and stumpf 2015 levy 2017 steffen et al 2017 furthermore in 2015 lake erie experienced the most extensive algal bloom on record stumpf et al 2016a these events motivate continued research into strategies for reducing the extent and toxicity of chabs and the development of decision support systems that can help mitigate their negative impacts chabs in lake erie are dominated by microcystis aeruginosa which produces microcystins a class of cyclic peptides rinta kanto et al 2009 microcystins are hepatotoxins and can cause liver and kidney disease in humans who have been exposed through drinking water or involuntarily ingesting the toxins when swimming in contaminated water to protect public health ohio epa established microcystin drinking water threshold concentrations for children under 6 years of age and sensitive population as 0 3 μg l and 1 6 μg l for children 6 and older including adults ohio also implemented guidelines for recreational contact a public health advisory pha microcystin lr concentration of 6 μg l was established above which swimming and wading are not recommended and water should not be swallowed and surface scum should be avoided a no contact advisory nca microcystin lr concentration of 20 μg l was established above which the public should avoid all contact with the water based on peer reviewed and published science in may 2019 usepa also recommended new microcystin public health threshold concentrations as 8 μg l u s epa 2019 therefore predictions of when and where the microcystin concentration will exceed advisory concentrations are potentially useful to support decision making by stakeholders including public drinking water systems and recreational users affected by chabs even though cyanobacteria are the source of microcystins the association between cyanobacteria densities and microcystins is not consistent stumpf et al 2016b toxic and non toxic strains of microcystis exist within the same chab and toxin production varies over time hollister and kreakie 2016 davis et al 2009 in addition other non toxic forms of phytoplankton exist in lake erie thus chlorophyll a may be present in the absence of either cyanobacteria or associated microcystin toxin however the highest toxin concentrations in lake erie occur in association with increased microcystis biomass in blooms and in surface scums conditions also associated with high concentrations of chlorophyll a rinta kanto et al 2005 2009 therefore when toxin concentration is high the majority of the phytoplankton biomass is due to cyanobacteria with detailed analysis shown in section 3 2 and we can potentially use chlorophyll a concentration to predict the probability of microcystin concentration exceeding advisory levels under these conditions hollister and kreakie 2016 stumpf et al 2016b previous forecast research has focused on chab abundance and spatial distributions and did not attempt to predict toxin concentrations wynne et al 2013 developed a short term forecast of hab location and transport that combined satellite remote sensing data with a hydrodynamic model stumpf et al 2016a developed a seasonal forecast of maximum hab extent based on statistical association between spring phosphorus loads from the maumee river and maximum hab extent rowe et al 2016 developed a short term 5 day hab forecast model known as the lake erie hab tracker which included the vertical distribution of buoyant microcystis colonies in the water column the hab location in the short term forecast is initiated from satellite derived cyanobacterial index data wynne et al 2008 and movement is predicted using modeled currents from the noaa lake erie operational forecast system leofs kelley et al 2018 an application of the finite volume community ocean model fvcom chen et al 2003 and a lagrangian particle tracking model churchill et al 2011 huret et al 2007 the experimental lake erie hab tracker model has provided daily nowcast and forecast information in july october of 2016 2019 www glerl noaa gov res habs and hypoxia habtracker html we present and assess an approach to forecast the spatial and temporal probability of microcystins exceeding various advisory guidelines in lake erie the toxicity probability forecast was achieved through a combination of a 1 hab tracker model rowe et al 2016 2 linear regression model to correlate extracted chlorophyll a and microcystin concentrations derived from weekly sampling in western lake erie section 2 and 3 a functional relationship giving the probability of in situ microcystin measurements exceeding advisory levels conditional upon model predicted microcystin levels based on data compiled over a hindcast period section 3 because in lake erie the microcystin chlorophyll a ratio varies temporally over the bloom season july to october more so than spatially on a given day the forecast system assumes that the relationship between microcystins and chlorophyll a is spatially uniform but varies over time according to the most recent weekly sampling data we trained the model over 2014 to 2016 and assessed the model in 2017 a year that was outside the calibration period 2 materials and methods 2 1 in situ observations starting in 2008 water samples were collected between weekly to bi weekly at eight stations by the cooperative institute of great lakes research ciglr and the national oceanic and atmospheric administration noaa great lakes environmental research laboratory glerl in western lake erie fig 1 https accession nodc noaa gov 0187718 many of the stations were sampled consistently from 2008 to 2017 sampling usually occurred from june to september covering the peak growing season for cyanobacteria for this study we used paired chlorophyll a and microcystin data from a given sample to obtain a representative sample in the presence of surface scums a niskin bottle was inserted vertically into the water until it was submerged to avoid surface scum accumulations the top of the niskin bottle was submerged about 0 5 m below the surface and collected an integrated surface sample between 0 5 and 1 25 m in depth samples were kept cool and transported to noaa glerl for analysis of including chlorophyll a particulate intracellular and dissolved extracellular microcystins the weekly samples were collected on monday with results for chlorophyll a and microcystins typically available on wednesday particulate microcystins were measured by filtering water samples onto a 3 μm polycarbonate membrane which were stored at 20 c until analysis samples were lysed using three freeze thaw cycles followed by addition of the quiklyse reagents abraxis llc warminster pa the concentration of microcystins were measured using a microcystin enzyme linked immunosorbent assay elisa abraxis llc and reported as microcystin lr equivalents the detailed method for microcystins was described by steffen et al 2017 in addition we used western lake erie toxin data from multiple organizations to assess the toxin forecast system hindcast which we refer to as the toxin database the toxin database included all glerl ciglr weekly sampling red stars in fig 1b ohio epa data blue squares including ohio epa lake erie ambient stations and lake erie public water system intakes data http wwwapp epa ohio gov gis mapportal hab monitoring html ohio state university stone lab sampling black squares and charter boat captains sampling data https ohioseagrant osu edu research live water green circles and usgs data at maumee bay state park cove 3 in ohio yellow star the charter boat captains data were sampled using a 2 m long tube lowered from the surface which is referred to as an integrated sample model results were compared with observations over a comparable depth for surface or integrated samples 2 2 satellite remote sensing data we used a series of images of cyanobacterial blooms in lake erie from july to october 2014 2017 obtained from the moderate resolution imaging spectrometer modis with 1 km spatial resolution wynne and stumpf 2015 the cyanobacterial index ci was obtained using a spectral shape algorithm based around 680 nm wynne et al 2008 tomlinson et al 2016 the ci varies linearly with biomass with a value of 10 3 sr 1 corresponding to approximately 105 cells ml 1 stumpf et al 2012 modis provides two overpasses daily aqua and terra which result in 60 70 cloud free images per year during the summer when habs occur vander woude et al 2019 in this study we used images with greater than 50 cloud free coverage in western lake erie for initialization of the hab tracker model the cloud covered areas of satellite images were filled in using model data from the previous day s run rowe et al 2016 2 3 predictive model hindcast simulation a conceptual diagram depicts the data flow through our forecast system fig 3 the system builds on the output of the hab tracker model process m1 described by rowe et al 2016 to predict the spatially resolved chab chlorophyll a concentration and movement 5 day forecast using a lagrangian particle tracking model initialized from satellite derived chab concentration and forced by currents and turbulent diffusivity from a numerical hydrodynamic model leofs the hab tracker model produces concentration output with a vertical resolution of 1 m with the number of layers depending on the water depth the modeled chab chlorophyll a concentration data d1 is transformed to toxin concentration data d2 using a linear regression model of chlorophyll a concentration versus microcystin concentration process m2 1 c t p r e d β 0 β 1 c c h l ε where c t p r e d is a predicted microcystin toxin concentration and c c h l is the chlorophyll a concentration from the hab tracker model the parameters β 0 and β 1 are estimated by linear regression and ε is uncertainty component reflecting the difference between observations and the fitted linear relationship the observations used to estimate the parameters in eq 1 were from glerl ciglr in situ grab samples in which toxin and chlorophyll a were measured in the same samples at a time before and closest to the model initiation time the average time gap between in situ observations and model initialization from 2014 to 2017 is 1 2 days the parameters in eq 1 were re calculated for every forecast using observations from the most recent weekly sampling date on sample dates when fewer than three observations were available we also included observations from the preceding sample date finally after matching predicted toxin concentration c t p r e d to in situ observations c t o b s we transformed the predicted toxin concentration into a probability of exceeding specified toxin concentration thresholds c t i t h r e s h using a statistical model process m3 2 p c t o b s c t i t h r e s h f c t p r e d where p c t o b s c t i t h r e s h represents the probability of in situ observed microcystin concentration exceeding the threshold value which was estimated by binning c t o b s into intervals of c t p r e d over the hindcast period and calculating the fraction of c t o b s c t i t h r e s h for each interval of c t p r e d the function f c t p r e d was then fit to the calculated values of p c t o b s c t i t h r e s h by nonlinear least squares regression through the use of a probabilistic forecast the level of uncertainty in the forecast system can be properly conveyed jolliffe and stephenson 2003 including uncertainties in satellite derived estimates of chab abundance in situ toxin measurements a transport model and the regression model eq 1 the transition from microcystin concentration to the probability of exceeding a threshold is achieved by a statistical model eq 2 equation 2 gives the probability of observations exceeding the health advisory concentrations given that the model predicted microcystins are within a range based on observed and modeled microcystin concentration matchups over the 2014 to 2016 hindcast 2 4 model assessment we used skill metrics for binary event forecasts to assess the forecast system hogan and mason 2012 rowe et al 2016 anderson et al 2016 including the probability of detection pod the probability of false detection pofd frequency bias b and the pierce skill score pss the skill scores were defined as 3 p o d a a c 4 p o f d b b d 5 b a b a c 6 p s s p o d p o f d a d b c b d a c where a represents the number of correctly predicted events hits b incorrectly predicted events false alarms c false negatives misses and d correct nonevents with an event defined as microcystin concentration exceeding a specific health advisory level p o d is a positively oriented score higher values represent better performance with values in the range 0 1 p o f d is a negatively oriented score higher values represent worse performance in the range of 0 1 p s s is a positively oriented score in the range of 1 1 with positive values indicating larger p o d than p o f d b is the ratio of predicted events to observed events in the range of 0 and equals 1 for an unbiased forecast numerous studies describe methods to assess probabilistic forecasts in meteorology e g bettge and baumhefner 1981 doswell and flueck 1989 wilks 1995 we applied two methods the reliability diagram and the receiver operating characteristic roc curve to evaluate the probabilistic forecast reliability represents the degree of agreement between forecast frequency or probability and observed frequency a reliability diagram hartmann et al 2002 with the observed frequency of an event plotted against the forecast probability of an event can effectively tell the user how closely the forecast probability corresponds to the actual chance of observing the event in the case of perfect reliability the forecast probability and the observed frequency should be equal and the plotted points should be on the diagonal the roc curve is based on signal detection theory and attempts to measure the relative signal and noise ratios contained in forecast information in the form of pod to pofd ratios egan 1975 mason 1982 in a roc curve the forecast probability is converted into a continuous set of yes no binary events based on the given probability thresholds and pod and pofd are compared within the probability thresholds swets 1973 egan 1975 mason 1982 mason and graham 1999 when the roc curve lies above and to the left of the 0 0 to 1 1 diagonal the model has good prediction skill when the curve lies below and to the right of the diagonal the model lacks skill the roc score auc is defined as the area under the roc curve correspondingly when auc is larger than 0 5 the model performs better than random chance and worse than by chance when auc is smaller than 0 5 3 results 3 1 association between chlorophyll a and microcystin concentrations chlorophyll a may be a useful indicator of microcystin concentration if microcystins are mainly contained within cyanobacterial cells in our data extracellular microcystins were a relatively small fraction of total microcystins fig 4 when total microcystin concentrations particulate plus dissolved were greater than 1 6 μg l adult drinking water advisory level given that microcystins were primarily intracellular particulate when advisory levels were exceeded it may be anticipated that microcystins are unlikely to exceed advisory levels in the absence of high chlorophyll concentrations to investigate this concept we calculated the proportion of microcystin concentrations exceeding threshold values within intervals of chlorophyll concentration and calculated a 95 confidence interval on the proportion the probability of exceeding microcystin advisory levels increased monotonically with increasing chlorophyll a concentration fig 5 which supports the concept of using cyanobacterial chlorophyll a concentrations as a means to predict the probability of exceeding microcystin advisory levels these exceedance probabilities only apply to western lake erie and may change over time with changes in the phytoplankton community such exceedance probability analysis can be used to predict toxin concentration in the absence of microcystin measurements hollister and kreakie 2016 we investigated temporal variation in the microcystin chlorophyll a ratio q m c y s t m c c h l over the bloom season july to october and across years here q m c y s t is taken to be a surrogate for the toxin to biomass ratio of the phytoplankton community if we assume that q m c y s t varies depending on environmental and ecological conditions and that the transport time of water masses among the limited spatial domain of our sampling program is shorter than the time scale over which the drivers of q m c y s t vary we may expect the microcystin chlorophyll a ratio q m c y s t m c c h l to vary temporally more so than spatially on a given day values of q m c y s t show strong seasonal variability fig 6 which usually peaks in july or august inter annual variability is also strong with a much greater maximum value of q m c y s t in 2009 and 2014 than in other years in contrast the range of q m c y s t on a given date representing spatial and sampling uncertainty combined is smaller than the range of q m c y s t values in the whole data set since 2008 or in one year values of q m c y s t also exhibit temporal autocorrelation with low values typically occurring early in the season high values mid season and low values again late in the bloom season based on the above analysis we assumed that toxin concentration was proportional to cyanobacterial biomass as represented by chlorophyll a concentration we further assumed that q m c y s t was spatially uniform but varied by sampling week thus we used linear regression to determine parameters in eq 1 for each sampling date uncertainties introduced by these assumptions will ultimately be conveyed by a probabilistic forecast fig 3 m3 fig 7 shows all the linear regressions for the hindcast simulations in 2014 with data collection time and model initialization time on each plot most of which are significantly different from the climatological regression based on all ciglr glerl samplings from 2008 to 2017 green lines in fig 7 the chow test chow 1960 demonstrated that the coefficients of the regression models change with time the r2 values for the hindcast simulations from 2014 to 2017 generally increased with the increase of averaged microcystin concentration on a single sampling day fig 8 when the averaged microcystin concentration is larger than 1 6 μg l most of r2 values are larger than 0 39 when the averaged microcystin concentration is larger than 6 μ g l pha threshold r2 is larger than 0 9 when average microcystin concentration is low a situation when the microcystins producing cyanobacteria are not dominant the r2 for linear regression between chlorophyll a and microcystins can be small as shown in fig 8 under this condition the model predicts low microcystin concentration resulting from a low microcystin chlorophyll ratio for example the point on the lower left corner of fig 8 with r2 of 0 03 and average microcystin of 1 23 μ g l 1 from august 25 2015 fig 9 represents the lowest r2 of our hindcast period using the linear regression model based on this day s sampling the model appropriately predicts low microcystin concentration fig 9 and a low probability 12 of exceeding the public health advisory level fig 11 3 2 spatial and temporal prediction of microcystin concentration we predicted microcystin concentration during the five day forecast period by combining eq 1 with chlorophyll a predicted by the hab tracker model fig 3 d2 we then compared the modeled microcystin concentrations with the toxin database using matchup criteria described in section 2 1 for example snapshots of modeled surface toxin concentrations in 2014 are shown in fig 10 with the corresponding surface and integrated observations plotted using symbols on the same color scale we assessed model skill in predicting exceedance of advisory levels by comparison with in situ observations over 2014 to 2016 with comparable bias for different advisory levels the model performed best at mid range concentrations associated with the pha and ohio epa adult drinking thresholds having pss values of 0 41 and 0 37 respectively table 1 because pss is largest for the pha threshold we focused on prediction of exceeding the pha threshold as a goal for the forecast system 3 3 probability of exceeding toxin threshold using the model and in situ microcystins matchups between 2014 and 2016 we calculated the probability of exceeding a health advisory level given that the model predicted microcystins were within a specified range fig 11 for example when the modeled microcystin concentration is larger than 10 μg l the probability of in situ observations exceeding the pha level is 50 the relationship between modeled microcystin concentration c t p r e d and exceedance probability f c t p r e d as in equation 2 was fit through nonlinear least squares estimates of a nonlinear model fig 11 7 f c t p r e d 1 p 0 exp c t p r e d γ ε where γ is an unknown parameter and 1 p 0 is the vertical intercept approximated as the probability calculated by model in situ matchups when c t p r e d is 0 ε is uncertainty component reflecting the difference between calculated probability gray dots in fig 11 and the fitted nonlinear relationship for the modeled microcystin concentration larger than 65 μg l the probability of event occurrence was 90 in process m3 fig 3 eq 7 was used to convert modeled microcystin concentrations to a probability of exceeding the pha level fig 12 3 4 skill assessment of the probabilistic forecast the reliability diagram compares the observed relative frequency to the forecast probability microcystin concentrations in the toxin database were used to assess the toxin forecast from 2014 to 2017 with 2017 representing an independent time period not used in calibration of eq 7 fig 13 a shows the reliability diagram for the probabilistic forecast of microcystin concentration exceeding pha advisory concentration 6 μg l based on 85 forecast runs for years 2014 2016 and fig 13b based on 56 forecast runs for year 2017 the 1 1 line represents the situation with perfect reliability where the predicted probability exactly matches the observed fig 13a shows that from 2014 to 2016 the confidence interval of the model reliability curve overlaps the 1 1 line although the model tended to over predict the frequency of exceedance on average in 2014 2016 the area under the roc curve auc in years 2014 2016 is 0 71 and 0 87 for year 2017 which means the forecast is better than by chance auc of 0 5 4 discussion drawing on a large data set of microcystins and chlorophyll a observations in western lake erie we found that microcystin pha concentrations were unlikely to be exceeded when chlorophyll a concentrations were low fig 5 and that chlorophyll a was a useful predictor of microcystin concentrations when the mean microcystin concentration was near pha levels fig 8 at pha levels microcystins are primarily intracellular fig 4 and thus it is reasonable to assume that microcystins scale with algal biomass however these conditions do not always prevail and at times non toxic phytoplankton are dominant in which case chlorophyll a is a weak predictor of microcystins but regression of microcystins on chlorophyll a appropriately predicts toxin concentrations near the mean at all chlorophyll levels fig 7a this approach could fail if chlorophyll a concentrations at the monitoring stations do not cover the range of values over the full prediction spatial domain requiring extrapolation of a poorly predictive relationship our monitoring stations are located in the area most affected by habs wynne and stumpf 2015 and are likely to capture the highest chlorophyll a concentrations but extrapolation should be avoided given that predictive models relating microcystin toxin production to environmental drivers are lacking bullerjahn et al 2016 we resorted to an approach driven by weekly updated observations the microcystin chlorophyll a ratio q m c y s t varied in a seasonal pattern and changed over time with changes in the phytoplankton community reaching maximum values in july or august with the maximum value varying by year the variance in q m c y s t ratio on a given date represents a combination of sampling uncertainty and any spatial pattern that may exist our sampling program lacked the level of replication and spatial extent that would be required to distinguish a spatial pattern from sampling uncertainty thus we resorted to the assumption of spatially uniform q m c y s t determined by linear regression we anticipate that over a sufficiently broad spatial extent the assumption of spatial uniformity of q m c y s t would fail for example toxic habs rarely occur in the central basin of lake erie ohio epa data however the database of microcystin observations that we used for model assessment fully covered the southern half of the western basin fig 1b where habs occur and covered a broader spatial extent than the monitoring stations that we used to determine q m c y s t fig 1a thus our skill assessment is largely representative of the region over which the forecast would be applied however it may be appropriate to limit model predictions to the region over which the model has been assessed if improved predictive models of q m c y s t as a function of environmental drivers become available the spatially uniform linear regression model used here could be replaced within the forecast system framework we describe the spatial distribution of cyanobacterial biomass and associated toxin concentration is quite variable at small spatial scales fig 2 which introduces challenges in obtaining in situ observations that are representative over spatial scales of satellite or model data km our predictions of microcystin concentrations showed some skill but large mis matches also occurred fig 10 therefore it is most appropriate to represent our toxin predictions in terms of probability our forecast system was most skillful at predicting exceedance of toxin thresholds at intermediate toxin concentrations table 1 at the lowest threshold level 0 3 μg l dissolved microcystins may be equal or greater than particulate microcystins conditions under which chlorophyll a algal biomass was not predictive of total microcystins at the highest threshold level 20 μg l relatively few observations existed for calibration of the conditional probability function eq 7 the conditional probability function can be refined as additional observations accumulate over years both measures of performance of the probabilistic forecast indicated a potentially useful level of skill we characterized the performance of the probabilistic forecast of exceeding the microcystin pha level over the 2014 to 2016 hindcast period and for 2017 a year that was not included in calibration of the model using the reliability diagram and the roc curve in the reliability diagram the forecast probability was within uncertainty bounds of observed relative frequency given limited observations the roc curve provides an analysis of the forecast performance from the perspective of a decision maker fig 13c and d a user whose decision is sensitive to the pofd of the forecast system may use this plot to identify a forecast probability threshold that maximizes pod while keeping an acceptable pofd for example such a user would be able to achieve a 70 pod while maintaining a 6 pofd using a probability threshold of 20 for year 2017 using the conditional probability function fig 7 obtained from comparison of model predictions to observations over the hindcast period ensures that the various sources of uncertainty are reflected in the predicted probabilities even though multiple sources of uncertainty in our complex forecast system contribute to limited skill the final product reasonably discriminated between high and low probabilities of exceeding the pha sources of uncertainty in the probabilistic forecast point to opportunities to improve the forecast system uncertainty arises from satellite derived initial conditions for bloom location and biomass the hydrodynamic forecast and the lagrangian particle transport model improved accuracy in each of these components will improve skill of the forecast system as additional toxin observations accumulate the conditional probability function can be refined because the linear regression model ignores spatial variability of the association between chlorophyll a and microcystins and the temporal variability is updated weekly at the most frequent uncaptured variability in the microcystin chlorophyll a relationship contribute to model error increased frequency or spatial extent of microcystin and chlorophyll a paired observations would likely improve forecast skill if predictive models of the microcystin chlorophyll a as a function of environmental variables become available they may be substituted for the simple linear regression in the forecast system this effort provides a path toward an operational short term forecast system for the probability of exceeding hab toxin advisory levels in lake erie provides a benchmark against which to assess future efforts and provides an approach that may be applied to other systems affected by toxic cyanobacterial blooms declaration of competing interests the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements funding was awarded to cooperative institute for great lakes research ciglr through the noaa cooperative agreement with the university of michigan na17oar4320152 this is ciglr publication 1157 and glerl publication 1943 the project was supported by the u s epa great lakes restoration initiative lake erie algal toxin and water quality data used in this analysis were compiled by limnotech from public sources including noaa https data nodc noaa gov cgi bin iso id gov noaa nodc 0187718 ohio epa https epa ohio gov ddagw hab and the ohio state university https ohioseagrant osu edu research live water the lake erie hab tracker model rowe et al 2016 was developed using the finite volume community ocean model fvcom and associated lagrangian particle tracking model available through university of massachusetts dartmouth http fvcom smast umassd edu 
26028,this study proposes to jointly use six budyko framework based methods hydrological simulation sensitivity indicator method and empirical statistics to build a comprehensive assessment framework for quantifying climatic and anthropogenic contributions to streamflow changes to evaluate its effectiveness we conducted a case study in a typical northern semi arid basin named guanting in china on average human activities and climate change account for 80 22 81 51 and 18 49 19 78 of the streamflow decline in the two subbasins i e shixiali and xiangshuipu of the study basin during the 1984 1999 and 2000 2015 periods respectively precipitation change outweighs potential evapotranspiration change as a primary climatic contributor of streamflow reduction in the two subbasins in xiangshuipu the average precipitation elasticity of streamflow ε p is 2 48 0 23 and 2 56 0 28 for the 1984 1999 and 2000 2015 periods respectively while ε p in shixiali has an average ε p value of 2 49 0 31 and 2 66 0 32 during the two periods difference between the ten attribution methods varies between 5 and 12 highlighting importance of applying this developed multi method framework to avoid overestimation underestimation and quantify uncertainty this proposed comprehensive change attribution method is valuable for quantitatively distinguishing the relative contributions of external factors on hydrological regime changes keywords climate change anthropogenic activities budyko framework streamflow regime change attribution guanting river basin 1 introduction climate change and anthropogenic activities are considered two main drivers of basin level streamflow change lin et al 2007 luo et al 2018 lyu et al 2019 piao et al 2007 zhang et al 2015a changes in precipitation and potential evaporation two important climatic variables together affect streamflow regime budyko 1974 zhang et al 2015b it has been recognized that anthropogenic activities such as land use and land cover changes irrigation afforestation water consumption and dam construction have resulted in significant hydrological changes in many areas cheng et al 2018 mohmmed et al 2018 wei and zhang 2010 xia et al 2014 water quality and quantity have become serious issues for water managers in many regions khaing et al 2019 lakshmi et al 2011 tomer and schilling 2009 zhang et al 2019 moreover assessing future changes in water resources requires a comprehensive understanding of changes in the two driving factors i e climate change and anthropogenic impact fatichi et al 2015 shrestha et al 2017 zhang et al 2007 which affect hydrological processes chang and franczyk 2008 li et al 2015 praskievicz and chang 2011 across various spatial and temporal scales to cope with challenges induced by hydrological changes it is necessary to examine how and to what extent hydrological systems respond to these changes so that policy makers can make better adaptation strategies for optimal water resources management in recent years various techniques aiming to quantitatively estimate the effects of climate change and anthropogenic activities on streamflow changes have been developed these methods can be roughly classified into three categories hydrological modeling sensitivity and elasticity based methods and empirical statistical analysis hydrological simulation method is based on hydrologic models such as hydrologiska byråns vattenbalansavdelning hbv model li et al 2016b soil water assessment tool swat model li et al 2016a variable infiltration capacity vic model bao et al 2012 simple hydrological model simhyd model zeng et al 2015 and geomorphology based hydrological model gbhm model xu et al 2013 although this method can provide more details of the hydrological cycle with respect to diverse spatial patterns uncertainty in the model simulations may lead to inaccurate results these uncertainties are due to uncertainties in model calibration forcing data model structures and model parameter estimations liang et al 2015 an alternative method to estimate the impacts of climate change and human activities on streamflow is the sensitivity and elasticity method the climate elasticity approach is based on the budyko framework budyko 1974 dooge 1992 sankarasubramanian et al 2001 this approach used estimated precipitation and potential evapotranspiration elasticity of streamflow to evaluate the effects of climate change though the method requires fewer hydroclimatic datasets it is based on annual means and hence provide generalized relationships without considering the underlying surface condition of a basin li et al 2012 the method has been widely used around the world xu et al 2014 used the budyko chounhury yang equation to analyze the causes of runoff decline in 33 selected mountainous catchments of the haihe river basin they estimated that the impacts of climate variation and land use cover change were accountable for the runoff decrease by 26 9 and 73 1 on average respectively the elasticity method based on the budyko framework was also used by gao et al 2016 to detect the responses of streamflow to climate change and human activities in the jing river basin during the period 1961 2009 they showed that climate change is the primary influencing factor of streamflow decrease accounting for about 63 9 of the reduction sensitivity analysis of streamflow to change in some driving variables such as precipitation potential evapotranspiration and temperature is another common method to detect responses of streamflow to climate changes the streamflow elasticity to precipitation change εp is defined as the ratio of the proportional change in mean annual streamflow to proportional change in mean annual precipitation chiew 2006 schaake 1990 owing to low data requirement usually requiring only streamflow precipitation and temperature data to estimate the streamflow sensitivity this method has been widely implemented and achieved reliable results in many case studies chiew 2006 dooge et al 1999 harman et al 2011 vogel et al 2004 yang and yang 2011 additionally this approach is straightforward simple and reliable for estimating streamflow sensitivity to climatic variables using a sensitivity indicator with fewer input data hasan et al 2018 however the impacts of extreme hydroclimatic variability and human activities cannot be directly quantified by this method making its value limited empirical statistical analyses including regression analysis zhao et al 2014 and double mass curve analysis gao et al 2011 are also often used these approaches quantify the relationship between runoff and a climatic variable therefore they usually require long term historical hydrometeorological data dooge et al 1999 jones et al 2006 milly 1994 wang 2014 although simple this method may not capture the exact non linear nature of the studied hydrologic system ahn and merwade 2014 knowing that each approach has its own limitations it may not be efficient to obtain the results from one single method therefore a comprehensive assessment using all of these common methods and intercomparison between different methods are valuable to understand and differentiate the relative impacts of climatic and anthropogenic changes on streamflow change therefore this study proposes a comprehensive assessment framework based on six budyko framework based methods hydrological modeling sensitivity indicator method and empirical statistics accordingly the objectives of this study were to 1 analyze the sensitivity and elasticity of streamflow to precipitation and potential evapotranspiration changes 2 investigate the relative contributions of climate change and anthropogenic activities to streamflow change and 3 discuss the uncertainties associated to the results obtained by various methods and the corresponding quantitative attributions 2 material and methods 2 1 methods in this study we proposed a comprehensive assessment framework for quantifying climatic and anthropogenic contributions to streamflow changes fig 1 which is mainly composed of three procedures first the observed meteorological time series are used to estimate potential evapotranspiration e 0 by the penman monteith equation recommended by fao food and agriculture organization second the mann kendall kendall 1948 mann 1945 method is used to detect the long term trend in the yearly streamflow q precipitation p and e 0 series the pettitt s test pettitt 1979 is applied to detect the change points in the yearly q series and determine the baseline period i e the natural period and comparative period i e the period with climatic and anthropogenic impacts fig 1 third five types of methods are applied to quantify the relative contributions of climatic and anthropogenic changes on streamflow changes the five methods are simple linear regression double mass curve analysis hydrological simulations budyko framework based elasticity analysis and sensitivity indicator method fig 1 generally changes in observed streamflow during the comparative period are caused by the combined impacts of climatic change and human activities the total streamflow change δ q t o t can be estimated by the average annual streamflow during the comparative period q c minus the average annual streamflow during the baseline period q b 1 δ q t o t q c q b we assume that δ q t o t can be divided into a change caused by climate change δ q c and a change resulted from human activities δ q h we can express this relationship as follows 2 δ q t o t δ q c δ q h 3 η h δ q h δ q t o t 100 and 4 η c δ q c δ q t o t 100 where η c and η h are the percentages of climate induced and human induced changes in mean annual streamflow respectively it is necessary to emphasize here that we assume that the mean annual streamflow is mainly controlled by annual precipitation and evapotranspiration in the watershed based on the budyko hypothesis budyko 1974 therefore the change in streamflow due to climate change is regarded as a function of precipitation and evapotranspiration milly and dunne 2002 five sets of methods are then applied to quantify δ q c and δ q h 1 simple linear regression slr method the slr method is used to determine the relationship between precipitation and streamflow wu et al 2017b the regression equation for observed annual streamflow q b and annual precipitation p b during the baseline period can be expressed as follows 5 q b a p b b where a is the rate of change in streamflow with a unit change in precipitation and b denotes the intercept value by using the coefficients a and b derived from equation 5 one can reconstruct annual natural streamflow in the comparative period q r 6 q r a p c b where p c represents the annual precipitation series in the comparative period therefore the contribution of human activities δ q h and climate change δ q c to total streamflow change can be expressed as follows 7 δ q h q c q r and δ q c δ q t o t δ q h where q c and q r represent the average values of the observed and reconstructed streamflow series during the comparative period respectively 2 double mass curve dmc method the dmc method is based on the fact that a plot of two cumulative quantities during the same period displays a straight line as long as the proportionality between the two variables remains the same the slope of the line represents the proportionality gao et al 2011 in this study the dmc method was used to determine the relationship between precipitation and streamflow it is a simple practical and widely used method to analyze consistency and trends in long term hydro meteorological data wu et al 2017b the cumulative streamflow and cumulative precipitation in the baseline period are expressed as 8 i 1 t q b i c i 1 t p b i d t 1 2 3 n where c denotes the degree of change in accumulated streamflow in response to accumulated precipitation d is the intercept and n is the length of annual time series therefore the above regression equation can be used to simulate natural streamflow in the comparative period calculated as follows 9 i 1 t q r i c i 1 t p c i d t 1 2 3 n annual streamflow excluding direct human impacts can be reconstructed once the cumulative streamflow is calculated thus the effects of climate change and human activities can be calculated from equation 7 3 hydrological simulations hs both linear regression and double mass curve methods are efficient and appropriate if climate variables and streamflow have a linear relationship however the relationships between climate variables and streamflow are usually non linear a more appropriate way to describe the non linear relationship between climate variable and streamflow is a process based simulation model in this study we applied the swat model to separate the effects of climate change and anthropogenic activities on streamflow the arcgis 10 2 and arcswat 2012 were used in this study the calibration and uncertainty analyses were done using the uncertainty in sequential uncertainty fitting 2 sufi 2 algorithm implemented in the swat cup 2012 the nash sutcliffe model efficiency nse nash and sutcliffe 1970 the coefficient of determination r2 and percentage of bias were used to evaluate the results the impacts of climate change and anthropogenic activities on streamflow were efficiently computed based on comparison of streamflow data between a natural period baseline and a comparative period li et al 2016a the sufi 2 algorithm implemented in the swat cup 2012 was used to calibrate the model using the observed data in the baseline period calibrated parameters were then used to generate simulated streamflow values for the comparative period difference in the simulated streamflow during the comparative q c s i m and baseline periods q b s i m were attributed solely to climate change induced change δ q c since anthropogenic impacts are excluded in the simulations 10 δ q c q c s i m q b s i m δ q t o t can be calculated using equation 1 and δ q h can be calculated as 11 δ q h δ q t o t δ q c 4 budyko framework based elasticity analysis bea method hydrological sensitivity can be defined as the percentage change in average annual streamflow in response to a change in average annual precipitation and potential evapotranspiration zhang et al 2011 for a catchment the water balance can be written as 12 p e q δ s where e is actual evapotranspiration and δ s is change in catchment water storage over a long period i e 5 10 years it is reasonable to assume δ s is zero assuming that annual precipitation and annual potential evapotranspiration are the main drivers of climatic changes that controlled the annual streamflow in a basin based on the budyko hypothesis budyko 1974 then any change in streamflow attributed to climate change can be obtained through the following equations 13 δ q c f p δ p f e 0 δ e 0 where δ p and δ e 0 are the changes in precipitation and potential evapotranspiration based on the definition of climate elasticity of streamflow i e ε q q x x equation 13 can be rewritten 14 δ q c q ε p δ p p ε e 0 δ e 0 e 0 where ε p is the streamflow elasticity to precipitation and ε e 0 is the streamflow elasticity to potential evapotranspiration which can be calculated as 15 ε p 1 ϕ f ϕ 1 f ϕ and ε p ε e 0 1 therefore the streamflow changes caused by climate change can be expressed as follows 16 δ q c ε p δ p p ε e 0 δ e 0 e 0 q where p e 0 and q are long term annual mean precipitation potential evapotranspiration and streamflow respectively ϕ e o p is the aridity index f ϕ is equal to e p f ϕ represents the derived function of f ϕ six commonly used forms of the f ϕ function are used in this study and summarized in table 1 with the assumption that climate change impact is induced by precipitation and potential evapotranspiration respectively we can estimate the relative contribution of each climatic factor to streamflow change from equation 16 the following equations give streamflow induced by changes of precipitation and potential evaporation respectively 17 δ q p ε p δ p p q 18 δ q e 0 ε e 0 δ e 0 e 0 q therefore the relative contribution to streamflow change by each climatic factor is calculated as 19 η p δ q p δ q t o t 100 and η e 0 δ q e 0 δ q t o t 100 where η p and η e 0 are the contributions of changes in precipitation and potential evapotranspiration respectively finally the contribution of anthropogenic changes to streamflow change can be calculated by equation 2 5 sensitivity indicator si method in 2002 a new method to analyze the impact of long term changes in precipitation and potential evaporation on changes in streamflow was developed by arora 2002 the multi year average potential evapotranspiration e 0 and the multi year mean precipitation p can be combined to form the multi year average aridity index the aridity index ϕ has been used to describe the partition between actual evaporation and streamflow of catchments in a wide range of climatic regimes grijsen et al 2013 if ϕ 1 the watershed is arid and the energy supply impedes evaporation if ϕ 1 the water supply impedes evaporation and the watershed is humid when e 0 is larger than p i e e 0 p 1 0 the energy available for evapotranspiration exceeds available precipitation water becomes a limiting factor and the basin produces no streamflow hasan et al 2018 the climate elasticity method was introduced by schaake 1990 to estimate the impact of climate change on streamflow as a physically realistic approach to compute the watershed water and energy balance it has been widely applied in different regions around the world jiang et al 2015 li et al 2018 liu et al 2017 wu et al 2017a xia et al 2014 xu et al 2014 arora 2002 expressed the percent streamflow change δ q q as a function of percent precipitation change δ p p and percent potential evapotranspiration change δ e 0 e 0 20 δ q q δ p p 1 β δ e 0 e 0 β where β is the sensitivity index which is proportional to the aridity index streamflow coefficient r c is computed from the evaporative ratio 21 r c q p 1 e p β can be calculated by following grijsen et al 2013 22 β 2 3 r c r c 2 when β reaches the maximum any slight change in precipitation or evapotranspiration results in a drastic change in streamflow furthermore β becomes larger when r c is smaller by re arranging equation 20 streamflow elasticity to precipitation ε p can be written as 23 ε p δ q q δ p p 1 β similarly the streamflow elasticity ε e 0 to e 0 can be expressed as follows 24 ε e 0 δ q q δ e 0 e 0 β using equation 16 one can calculate δ q c while one can determine δ q p and δ q e 0 using equations 17 and 18 finally the contributions of anthropogenic changes to streamflow change δ q h can be calculated by equation 2 2 2 data and study area in study we chose the guanting river basin as the case study area the guanting basin is to the northwest of beijing and a tributary of haihe river with a drainage area of 43 600 km2 between 39 n and 42 n and 112 e to 117 e fig 2 this study will focus on the upper and lower part of this basin i e the xiangshuipu catchment and shixiali catchment fig 2 it has a semi arid climate with monthly average temperature ranging from 11 c in january to 22 c in july and mean annual precipitation of 425 mm approximately 70 of the precipitation occurs during the monsoon season may to september the principal tributaries of the basin are sang river and yang river according to the census data from 2000 63 of all employees worked in agriculture 16 in the industrial sector and 21 in the service sector otto et al 2016 the agriculture sector primarily depends on surface water with a supplement of groundwater and consumed 71 6 of the total water consumption domestic use and industrial sector mainly rely on groundwater and consumed 18 6 and 9 8 of total water consumption respectively the basin is extensively affected by anthropogenic activities with an imbalance between supply and demand since china s economic reform and opening up policy in 1979 rapid growth of economy urbanization and population has been observed water consumptions by agriculture industry and domestic use have significantly increased these activities along with corresponding changes in land use and land cover have affected streamflow generation and concentration in this area daily meteorological data from forty five stations across the basin fig 2 from 1960 to 2015 were collected from the national climate center of china meteorological administration cma the observation data consist of daily maximum minimum average temperature and precipitation annual streamflow data 1960 2015 from xiangshuipu and shixiali stations were acquired from the china annual hydrological reports we considered the location lengths and completeness of records when selecting the weather stations such that the entire guanting river basin could be covered as the input to swat model a digital elevation map dem was derived from the shuttle radar topography mission srtm with a resolution of 30 m land cover maps of 1980 1990 and 2000 were obtained from the resources and environmental science data center chinese academy of sciences http www resdc cn soil map was obtained from fao global soil data 1 50000 http www fao org 3 results 3 1 long term trend and change in streamflow the pettit test shows that the turning points of the observed annual streamflow series in both of stations occurred in 1983 at the 5 significance level table 2 this result indicates that he streamflow series can be divided into two periods the natural period 1960 1983 in which the impacts of human activities on streamflow are insignificant and the comparative period 1984 2015 in which there are substantial human impacts for both xiangshuipu and shixiali stations to assess the decadal impact of climate change and human activities the comparative period can be divided into two sub periods 1984 1999 and 2000 2015 representing the 1990s and the 2000s respectively overall annual streamflow series in both catchments show significant decreasing trends which passed the mann kendall trend test at the significance level of 0 05 table 2 additionally a significantly decreasing trend at a 5 significance level was also observed in the runoff coefficient and evaporation table 2 3 2 changes in the aridity and precipitation evapotranspiration relation fig 3 presents the aridity indices for the baseline period and the two comparative periods i e the 1990s and 2000s in the xiangshuipu and shixiali catchments it can be clearly observed that the aridity index increases over the past five decades in both of the catchments from 1 38 to 1 52 in xiangshuipu and 1 41 to 1 57 in shixiali fig 3 this result implies that the climatic conditions became drier from the baseline period 1960 1983 to the 2000s 2000 2015 in both xiangshuipu and shixiali the budyko curve for the whole guanting basin based on the data record from 1960 to 2015 clearly demonstrate that all but one data points are located in the water limited zone i e e 0 p 1 fig 4 indicates that this area is an apparent water limited region in a couple of years the e p values are even close to the upper limit this could be due to both limited water input low precipitation and high temperatures which increase evapotranspiration and thus foster water losses to the atmosphere these results not only corroborate the previous reports by xing et al 2018 but also agree with the physical and climatological conditions in the guanting river basin 3 3 sensitivity and elasticity of streamflow it is clear that sensitivity index β in the guanting river basin is inversely proportional to the streamflow coefficient fig 5 moreover one can observe that the guanting river basin is characterized by a high sensitivity of streamflow to changes in precipitation and evaporative capacity β 1 and a low streamflow coefficient r c 0 35 fig 6 these results are consistent with the natural climatic conditions in the semi arid basin by dividing the guanting basin into two sub basins the time courses of annual sensitivity indices of the two catchments xiangshuipu and shixiali show similar interannual variability and long term trend fig 6 overall most of the data points are located in the zone with high sensitivity values in both of the catchments the peaks of β are observed around 1965 fig 6 another peak of β for the shixiali catchment is observed in 2014 low β values are sporadically observed from 1962 to 1995 in the two catchments denoting a low sensitivity during this period when β is large high sensitivity a given change in precipitation and potential evapotranspiration produces disproportionate changes in streamflow from these results it can be concluded that the streamflow in xiangshuipu and shixiali is generally sensitive to precipitation and potential evapotranspiration in addition the β values in both of the catchments show clear upward trends fig 6 indicating that streamflow in the two catchments is becoming more sensitive to climatic changes over the past five decades fig 7 shows the precipitation and potential evapotranspiration elasticity of streamflow ε p and ε e 0 which were computed using the elasticity method and sensitivity index method the results based on the elasticity method have six sets of results because six budyko framework based actual evapotranspiration to precipitation ratio estimation equations were applied to derive the elasticity the impacts of climate change on streamflow were estimated using multi year precipitation and potential evapotranspiration data and separated into two distinct periods namely the 1984 1999 and 2000 2015 periods fig 7 a and b show that the potential evapotranspiration elasticity values of streamflow ε e 0 are negative in the two catchments quantified by all seven methods during both the 1984 1999 and 2000 2015 periods the means value of ε e 0 in the xiangshuipu catchment are 1 48 0 23 and 1 56 0 28 during the 1984 1999 and 2000 2015 periods respectively fig 7a this result implies that on average a 10 increase in potential evapotranspiration would decrease streamflow by 14 8 and 15 6 during the two periods respectively change in potential evapotranspiration causes more streamflow reduction during the 1984 1999 period than during the 2000 2015 period the ε e 0 values in the shixiali catchment display a similar pattern as in the xiangshuipu catchment fig 7a b on average 10 increase in potential evapotranspiration results in 14 2 16 0 reduction of streamflow in the 1984 1999 and 2000 2015 periods respectively fig 7b it is clear that the potential evapotranspiration changes have caused streamflow changes in the two catchments to the similar degree fig 7 contrary to the ε e 0 results the ε p values in both xiangshuipu and shixiali catchments are all positive in both of the 1984 1999 and 2000 2015 periods fig 7 this is because streamflow has a positive correlation with p and a negative correlation with e 0 in xiangshuipu as an illustration the average values of ε p are 2 48 0 23 and 2 56 0 28 for the 1984 1999 and 2000 2015 periods respectively fig 7a similarly the shixiali catchment has an average ε p value of 2 49 0 31 and 2 66 0 32 during the 1984 1999 and 2000 2015 periods respectively fig 7b the above results indicate that the shixiali catchment has slightly higher streamflow sensitivity to changes in precipitation and potential evapotranspiration than the xiangshuipu catchment moreover streamflow is more sensitive to change in precipitation than change in potential evapotranspiration in the two catchments this results is consistent with the conclusions by xu et al 2014 and xing et al 2018 similarly according to the study by cong et al 2014 changes in precipitation contribute to streamflow change in five significant basins near the study region 13 on average with a range of 5 25 as a whole these studies indicate that rainfall changes have become a dominant climatic factor that influences the streamflow regime in our study area and its adjacent region 3 4 relative contributions of climatic and anthropogenic changes on streamflow fig 8 shows the relative contribution of climatic and anthropogenic changes to changes in streamflow during the 1984 1999 and 2000 2015 periods relative to the 1960 1983 period ten attribution methods were applied including six budyko framework based methods sensitivity indicator method hydrological simulations double mass curve analysis and simple linear regression even though the results of the different methods are slightly different with each other all results reach consensus on the relative importance of climatic and anthropogenic causes to streamflow changes and relative difference of climatic and anthropogenic contributions between different time periods overall anthropogenic activities contribute much more than climatic change to the reduction in streamflow for both catchments fig 8 in xiangshuipu the ensemble average relative contributions of anthropogenic changes are 80 54 3 55 and 86 91 1 71 during the 1984 1999 and 2000 2015 periods respectively fig 8a while the ensemble average relative contributions of climatic changes are only 19 46 3 55 and 13 09 1 71 during the 1984 1999 and 2000 2015 periods respectively fig 8a similarly the ensemble average relative contributions of anthropogenic changes in shixiali are 81 99 3 61 and 83 47 3 76 during the 1984 1999 and 2000 2015 periods respectively fig 9 b which are more significant than those of climatic change 18 01 16 53 during the same periods moreover we can notice that the impacts of anthropogenic activities increase gradually from the 1984 1999 period to the 2000 2015 period in both of the catchments implying that human activities are imposing gradually more influence on streamflow this might be due to the various land use changes in the basin the construction of reservoirs across the sang river and yang river over the years industrial development and the artificial water withdrawal from the river channel for agricultural purposes in terms of variability between attribution methods dmc and slr have very similar results in both catchments this might be due to the similarity in their overall concept and the similar climatic conditions in the catchment the results from the parametric beafu beazhang and non parametric beaol dekop beashreiber beatur c pike beabudyko budyko framework based methods were consistent for all catchments with notable differences in their corresponding calculated contribution rates these results indicate that there is non negligible uncertainty in the actual evapotranspiration estimation between the six budyko type equations summarized in table 1 overall all methods unanimously reach the same conclusion namely anthropogenic activities playing a dominant role in streamflow decline in the guanting river basin during the last five decades while climatic changes are also occurring in this region with the assumption that climate change impact is typically a direct product of precipitation and potential evapotranspiration we estimated the relative contribution of each climatic contributing factor to streamflow change from the results displayed in table 3 it has been seen that precipitation had more effect on streamflow an average of 15 06 than potential evapotranspiration an average of 6 24 in the 1984 1999 period in the xiangshuipu catchment however during the 2000 2015 period the contribution rates of precipitation and potential evapotranspiration to streamflow decline are nearly the same i e 6 14 and 6 97 respectively in the xiangshuipu catchment table 3 unlike the results in xiangshuipu changes in precipitation remains a more significant contributor to climate change induce streamflow reduction than changes in potential evapotranspiration in shixiali table 4 the contribution of precipitation changes to streamflow changes are on average 17 19 and 16 86 during the 1984 1999 and 2000 2015 periods table 4 this finding also agrees with the findings by xia et al 2014 which showed that streamflow is more sensitive to variation in precipitation than variation in potential evapotranspiration in the same basin six budyko framework based equations were used to precisely quantify the impact of climate change and anthropogenic activities in the basin the results are consistent throughout the basin figs 9 and 10 however there are nevertheless slight differences between the approaches due to the different formulas that empirically describe the hydrological processes altogether it can be observed that a non parametric method budyko provides the highest estimation of climate change impact in the whole basin whereas a parametric method zhang has the lowest estimation during both of the 1984 1999 and 2000 2015 periods contrarily the parametric zhang method shows the highest human impact contribution to streamflow decrease while the non parametric method budyko shows the least human impact rate on streamflow in both of the two catchments during both of the periods these notable differences are possibly due to the geographic setting soil properties and vegetation it is noted that human impact rate increases moderately from the 1984 1999 period to the 2000 2015 period across the basin figs 9 and 10 no matter which of the methods is used this observed rise is due to the extension of agricultural land intensive irrigation practices and rise of the industrial and human water consumption in guanting river basin this finding also accords with earlier observations in haihe river basin by lu et al 2015 4 discussion overall the results of the quantifying environmental change impacts in this study indicate that anthropogenic activities played a dominant role in streamflow changes in the guanting river basin during 1960 2015 though the contribution from climate change was not negligible our findings are consistent with those from previous studies for example xia et al 2014 employed a budyko hypothesis based method with the penman monteith equation to separate the effects of climate change and human activities the methods indicate that 87 4 89 5 of the total streamflow decrease was due to human activities with the remaining decline due to climate change another study conducted by xu et al 2014 in northern china using a choudhury yang equation based on budyko hypothesis shows that the impacts of climate variation and land use cover human activities change were accountable for the streamflow decrease by 26 9 and 73 1 on average respectively despite the consistency of these results the methods used present some uncertainties in the estimate for example attribution of the contributions of climate change and human activities to variations in streamflow is based on the assumption that the two factors are independent however they are inter related and the underlying mechanism may be more complicated due to the interactions amongst hydrological processes and climate zeng et al 2015 furthermore the elasticity based methods attempt to capture the long term effects of anthropogenic activities and climate change on the water balance but they do not take into account the changes in extremes events seasonality and snowiness gao et al 2016 moreover it has been proven that seasonality can change the e p ratio a climate with more variable seasonality tends to shift this ratio downward for a given e 0 feng et al 2012 additionally uncertainties in model structure model parameters and meteorological data may hinder the quantification results obtained through hydrological modeling wu et al 2017a it is worth mentioning that only two climate variables precipitation and potential evapotranspiration were selected for climate sensitivity to streamflow this leaves room for uncertainty the number of climatic components to include when assessing the effect of climate on streamflow is yet determined neither is the sensitive nor dominant variables the hydro meteorological data applied the fundamental assumptions expressed to measure the impact of climate change and anthropogenic activities and the approaches employed to evaluate the influences all carry a certain weight of biases as expressed by liang et al 2015 this needs to be adequately taken into account when carefully analyzing the results for better decision making and policymaking for sustainable development of water resources in guanting all these uncertainties might influence the estimated results to some extent since it has been observed in this study that anthropogenic activities represent the dominant drivers of streamflow decline in guanting river basin it is meaningful to comprehend why anthropogenic activities exert so much effect on streamflow decrease the decline in streamflow might be due to an increase in agricultural and industrial water demand in the basin the construction of reservoirs borehole and dams water diversion from large reservoirs guanting and cetian these results corroborate the findings of previous works in this basin bao et al 2012 jia et al 2012 lu et al 2015 wang et al 2013 xia et al 2014 xu et al 2014 moreover abrupt change of streamflow in the 1980s indicated by pettit test in this study corresponded to the beginning of china s land reformation which allows farmers to assert more control on land management and irrigation practices were highly encouraged furthermore industries productivity economic growth along with the population increased significantly therefore a greater need for water consumption was observed wang et al 2013 these factors might explain the shift of streamflow around that period similar findings have been reported in other studies li et al 2018 liu et al 2017 wang et al 2016 the budyko framework based methods could be separated into two categories non parametric beaol dekop beaschreiber beatur c pike and beabudyko and parametric beafu beazhang methods it can be observed in figs 9 and 10 that the non parametric method beabudyko measures the highest contributions of climate change impact to streamflow decrease during the 1984 1999 and 2000 2015 periods for both of the subbasins i e 25 18 and 16 90 for xiangshuipu and 24 4 and 22 73 for shixiali for the two comparative periods respectively in contrast the parametric method beazhang quantifies the lowest climatic contributions about 5 7 lower than the values quantified by beabudyko correspondingly the beazhang method measures the highest anthropogenic contributions for both of the subbasins during the two comparative periods among the budyko framework based methods while the beabudyko method quantifies the lowest anthropogenic contributions fig 10 in summary the uncertainty between the budyko framework based methods is about 5 7 these notable differences are clearly due to difference in calculating the ratio of actual evapotranspiration to precipitation table 1 therefore it is not surprising that the results with the nonparametric methods are slightly different from the results with the parametric methods in addition one can tell that the results of slr dmc and hs are very similar to each other figs 9 and 10 while the si results are similar to the results of most of the budyko framework based methods the difference between the non bea methods varies between 2 and 6 while the difference between bea methods and non bea method is between 5 and 12 these results suggest that one specific method may not be totally reliable at least it may overestimate or underestimate the contributions of climate change and anthropogenic activities to streamflow change despite the different results obtained via various methods one may argue that the methods are not convincing nevertheless one fact remains consistent all methods have quantitatively shown that anthropogenic activities contributed more than climate change to streamflow decline in guanting river basin therefore an integrated methodology including a variety of quantitative methods based on different structures and bases should be more efficient 5 conclusions this study aims to answer the question of how much climate change and anthropogenic activities contribute to streamflow variation by using guanting river basin as a case study we proposed a comprehensive assessment framework for quantifying climatic and anthropogenic contributions to streamflow changes by combing a variety of attribution methods including six budyko framework based methods hydrological simulations using the swat model simple linear regression double mass curve analysis and sensitivity indicator method the mann kendall trend analysis and pettit test results showed abrupt change occurred in 1983 in both of the subbasins of the guanting river basin subsequently the aridity was estimated to represent the basin climate character it was observed that the aridity index increased from decade to decade therefore indicating the climatic conditions became drier from 1960 to 2015 in the basin to estimate runoff response to potential evapotranspiration ε e 0 and precipitation ε p six budyko hypothesis elasticity based methods were further applied the results indicate that change in streamflow was more sensitive to variations in precipitation than variation in potential evapotranspiration furthermore the estimation of climatic and anthropogenic impacts on streamflow show that human activities are principally responsible for streamflow reduction in the guanting river basin the findings of this research support the hypothesis that humans played a substantial role in changes in streamflow in guanting river basin however more research on this topic needs to be undertaken to clearly understand the complex interaction between climate change and anthropogenic activities and their contribution rates besides further study with a focus on the effect of future climate variables and human activities on hydrological processes is therefore suggested author contributions kz contributed to conceptualization data curation funding acquisition investigation methodology supervision project administration and writing original draft and review editing gbr conducted formal analysis investigation validation visualization and writing original draft and review editing zl contributed to data curation and writing review editing zy jx and zd contributed to writing review editing acknowledgments this study is supported by the national key research and development program of china 2016yfc0402701 national natural science foundation of china 51879067 natural science foundation of jiangsu province bk20180022 six talent peaks project in jiangsu province ny 004 and fundamental research funds for the central universities of china 2018b42914 and 2018b04714 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2020 104704 
26028,this study proposes to jointly use six budyko framework based methods hydrological simulation sensitivity indicator method and empirical statistics to build a comprehensive assessment framework for quantifying climatic and anthropogenic contributions to streamflow changes to evaluate its effectiveness we conducted a case study in a typical northern semi arid basin named guanting in china on average human activities and climate change account for 80 22 81 51 and 18 49 19 78 of the streamflow decline in the two subbasins i e shixiali and xiangshuipu of the study basin during the 1984 1999 and 2000 2015 periods respectively precipitation change outweighs potential evapotranspiration change as a primary climatic contributor of streamflow reduction in the two subbasins in xiangshuipu the average precipitation elasticity of streamflow ε p is 2 48 0 23 and 2 56 0 28 for the 1984 1999 and 2000 2015 periods respectively while ε p in shixiali has an average ε p value of 2 49 0 31 and 2 66 0 32 during the two periods difference between the ten attribution methods varies between 5 and 12 highlighting importance of applying this developed multi method framework to avoid overestimation underestimation and quantify uncertainty this proposed comprehensive change attribution method is valuable for quantitatively distinguishing the relative contributions of external factors on hydrological regime changes keywords climate change anthropogenic activities budyko framework streamflow regime change attribution guanting river basin 1 introduction climate change and anthropogenic activities are considered two main drivers of basin level streamflow change lin et al 2007 luo et al 2018 lyu et al 2019 piao et al 2007 zhang et al 2015a changes in precipitation and potential evaporation two important climatic variables together affect streamflow regime budyko 1974 zhang et al 2015b it has been recognized that anthropogenic activities such as land use and land cover changes irrigation afforestation water consumption and dam construction have resulted in significant hydrological changes in many areas cheng et al 2018 mohmmed et al 2018 wei and zhang 2010 xia et al 2014 water quality and quantity have become serious issues for water managers in many regions khaing et al 2019 lakshmi et al 2011 tomer and schilling 2009 zhang et al 2019 moreover assessing future changes in water resources requires a comprehensive understanding of changes in the two driving factors i e climate change and anthropogenic impact fatichi et al 2015 shrestha et al 2017 zhang et al 2007 which affect hydrological processes chang and franczyk 2008 li et al 2015 praskievicz and chang 2011 across various spatial and temporal scales to cope with challenges induced by hydrological changes it is necessary to examine how and to what extent hydrological systems respond to these changes so that policy makers can make better adaptation strategies for optimal water resources management in recent years various techniques aiming to quantitatively estimate the effects of climate change and anthropogenic activities on streamflow changes have been developed these methods can be roughly classified into three categories hydrological modeling sensitivity and elasticity based methods and empirical statistical analysis hydrological simulation method is based on hydrologic models such as hydrologiska byråns vattenbalansavdelning hbv model li et al 2016b soil water assessment tool swat model li et al 2016a variable infiltration capacity vic model bao et al 2012 simple hydrological model simhyd model zeng et al 2015 and geomorphology based hydrological model gbhm model xu et al 2013 although this method can provide more details of the hydrological cycle with respect to diverse spatial patterns uncertainty in the model simulations may lead to inaccurate results these uncertainties are due to uncertainties in model calibration forcing data model structures and model parameter estimations liang et al 2015 an alternative method to estimate the impacts of climate change and human activities on streamflow is the sensitivity and elasticity method the climate elasticity approach is based on the budyko framework budyko 1974 dooge 1992 sankarasubramanian et al 2001 this approach used estimated precipitation and potential evapotranspiration elasticity of streamflow to evaluate the effects of climate change though the method requires fewer hydroclimatic datasets it is based on annual means and hence provide generalized relationships without considering the underlying surface condition of a basin li et al 2012 the method has been widely used around the world xu et al 2014 used the budyko chounhury yang equation to analyze the causes of runoff decline in 33 selected mountainous catchments of the haihe river basin they estimated that the impacts of climate variation and land use cover change were accountable for the runoff decrease by 26 9 and 73 1 on average respectively the elasticity method based on the budyko framework was also used by gao et al 2016 to detect the responses of streamflow to climate change and human activities in the jing river basin during the period 1961 2009 they showed that climate change is the primary influencing factor of streamflow decrease accounting for about 63 9 of the reduction sensitivity analysis of streamflow to change in some driving variables such as precipitation potential evapotranspiration and temperature is another common method to detect responses of streamflow to climate changes the streamflow elasticity to precipitation change εp is defined as the ratio of the proportional change in mean annual streamflow to proportional change in mean annual precipitation chiew 2006 schaake 1990 owing to low data requirement usually requiring only streamflow precipitation and temperature data to estimate the streamflow sensitivity this method has been widely implemented and achieved reliable results in many case studies chiew 2006 dooge et al 1999 harman et al 2011 vogel et al 2004 yang and yang 2011 additionally this approach is straightforward simple and reliable for estimating streamflow sensitivity to climatic variables using a sensitivity indicator with fewer input data hasan et al 2018 however the impacts of extreme hydroclimatic variability and human activities cannot be directly quantified by this method making its value limited empirical statistical analyses including regression analysis zhao et al 2014 and double mass curve analysis gao et al 2011 are also often used these approaches quantify the relationship between runoff and a climatic variable therefore they usually require long term historical hydrometeorological data dooge et al 1999 jones et al 2006 milly 1994 wang 2014 although simple this method may not capture the exact non linear nature of the studied hydrologic system ahn and merwade 2014 knowing that each approach has its own limitations it may not be efficient to obtain the results from one single method therefore a comprehensive assessment using all of these common methods and intercomparison between different methods are valuable to understand and differentiate the relative impacts of climatic and anthropogenic changes on streamflow change therefore this study proposes a comprehensive assessment framework based on six budyko framework based methods hydrological modeling sensitivity indicator method and empirical statistics accordingly the objectives of this study were to 1 analyze the sensitivity and elasticity of streamflow to precipitation and potential evapotranspiration changes 2 investigate the relative contributions of climate change and anthropogenic activities to streamflow change and 3 discuss the uncertainties associated to the results obtained by various methods and the corresponding quantitative attributions 2 material and methods 2 1 methods in this study we proposed a comprehensive assessment framework for quantifying climatic and anthropogenic contributions to streamflow changes fig 1 which is mainly composed of three procedures first the observed meteorological time series are used to estimate potential evapotranspiration e 0 by the penman monteith equation recommended by fao food and agriculture organization second the mann kendall kendall 1948 mann 1945 method is used to detect the long term trend in the yearly streamflow q precipitation p and e 0 series the pettitt s test pettitt 1979 is applied to detect the change points in the yearly q series and determine the baseline period i e the natural period and comparative period i e the period with climatic and anthropogenic impacts fig 1 third five types of methods are applied to quantify the relative contributions of climatic and anthropogenic changes on streamflow changes the five methods are simple linear regression double mass curve analysis hydrological simulations budyko framework based elasticity analysis and sensitivity indicator method fig 1 generally changes in observed streamflow during the comparative period are caused by the combined impacts of climatic change and human activities the total streamflow change δ q t o t can be estimated by the average annual streamflow during the comparative period q c minus the average annual streamflow during the baseline period q b 1 δ q t o t q c q b we assume that δ q t o t can be divided into a change caused by climate change δ q c and a change resulted from human activities δ q h we can express this relationship as follows 2 δ q t o t δ q c δ q h 3 η h δ q h δ q t o t 100 and 4 η c δ q c δ q t o t 100 where η c and η h are the percentages of climate induced and human induced changes in mean annual streamflow respectively it is necessary to emphasize here that we assume that the mean annual streamflow is mainly controlled by annual precipitation and evapotranspiration in the watershed based on the budyko hypothesis budyko 1974 therefore the change in streamflow due to climate change is regarded as a function of precipitation and evapotranspiration milly and dunne 2002 five sets of methods are then applied to quantify δ q c and δ q h 1 simple linear regression slr method the slr method is used to determine the relationship between precipitation and streamflow wu et al 2017b the regression equation for observed annual streamflow q b and annual precipitation p b during the baseline period can be expressed as follows 5 q b a p b b where a is the rate of change in streamflow with a unit change in precipitation and b denotes the intercept value by using the coefficients a and b derived from equation 5 one can reconstruct annual natural streamflow in the comparative period q r 6 q r a p c b where p c represents the annual precipitation series in the comparative period therefore the contribution of human activities δ q h and climate change δ q c to total streamflow change can be expressed as follows 7 δ q h q c q r and δ q c δ q t o t δ q h where q c and q r represent the average values of the observed and reconstructed streamflow series during the comparative period respectively 2 double mass curve dmc method the dmc method is based on the fact that a plot of two cumulative quantities during the same period displays a straight line as long as the proportionality between the two variables remains the same the slope of the line represents the proportionality gao et al 2011 in this study the dmc method was used to determine the relationship between precipitation and streamflow it is a simple practical and widely used method to analyze consistency and trends in long term hydro meteorological data wu et al 2017b the cumulative streamflow and cumulative precipitation in the baseline period are expressed as 8 i 1 t q b i c i 1 t p b i d t 1 2 3 n where c denotes the degree of change in accumulated streamflow in response to accumulated precipitation d is the intercept and n is the length of annual time series therefore the above regression equation can be used to simulate natural streamflow in the comparative period calculated as follows 9 i 1 t q r i c i 1 t p c i d t 1 2 3 n annual streamflow excluding direct human impacts can be reconstructed once the cumulative streamflow is calculated thus the effects of climate change and human activities can be calculated from equation 7 3 hydrological simulations hs both linear regression and double mass curve methods are efficient and appropriate if climate variables and streamflow have a linear relationship however the relationships between climate variables and streamflow are usually non linear a more appropriate way to describe the non linear relationship between climate variable and streamflow is a process based simulation model in this study we applied the swat model to separate the effects of climate change and anthropogenic activities on streamflow the arcgis 10 2 and arcswat 2012 were used in this study the calibration and uncertainty analyses were done using the uncertainty in sequential uncertainty fitting 2 sufi 2 algorithm implemented in the swat cup 2012 the nash sutcliffe model efficiency nse nash and sutcliffe 1970 the coefficient of determination r2 and percentage of bias were used to evaluate the results the impacts of climate change and anthropogenic activities on streamflow were efficiently computed based on comparison of streamflow data between a natural period baseline and a comparative period li et al 2016a the sufi 2 algorithm implemented in the swat cup 2012 was used to calibrate the model using the observed data in the baseline period calibrated parameters were then used to generate simulated streamflow values for the comparative period difference in the simulated streamflow during the comparative q c s i m and baseline periods q b s i m were attributed solely to climate change induced change δ q c since anthropogenic impacts are excluded in the simulations 10 δ q c q c s i m q b s i m δ q t o t can be calculated using equation 1 and δ q h can be calculated as 11 δ q h δ q t o t δ q c 4 budyko framework based elasticity analysis bea method hydrological sensitivity can be defined as the percentage change in average annual streamflow in response to a change in average annual precipitation and potential evapotranspiration zhang et al 2011 for a catchment the water balance can be written as 12 p e q δ s where e is actual evapotranspiration and δ s is change in catchment water storage over a long period i e 5 10 years it is reasonable to assume δ s is zero assuming that annual precipitation and annual potential evapotranspiration are the main drivers of climatic changes that controlled the annual streamflow in a basin based on the budyko hypothesis budyko 1974 then any change in streamflow attributed to climate change can be obtained through the following equations 13 δ q c f p δ p f e 0 δ e 0 where δ p and δ e 0 are the changes in precipitation and potential evapotranspiration based on the definition of climate elasticity of streamflow i e ε q q x x equation 13 can be rewritten 14 δ q c q ε p δ p p ε e 0 δ e 0 e 0 where ε p is the streamflow elasticity to precipitation and ε e 0 is the streamflow elasticity to potential evapotranspiration which can be calculated as 15 ε p 1 ϕ f ϕ 1 f ϕ and ε p ε e 0 1 therefore the streamflow changes caused by climate change can be expressed as follows 16 δ q c ε p δ p p ε e 0 δ e 0 e 0 q where p e 0 and q are long term annual mean precipitation potential evapotranspiration and streamflow respectively ϕ e o p is the aridity index f ϕ is equal to e p f ϕ represents the derived function of f ϕ six commonly used forms of the f ϕ function are used in this study and summarized in table 1 with the assumption that climate change impact is induced by precipitation and potential evapotranspiration respectively we can estimate the relative contribution of each climatic factor to streamflow change from equation 16 the following equations give streamflow induced by changes of precipitation and potential evaporation respectively 17 δ q p ε p δ p p q 18 δ q e 0 ε e 0 δ e 0 e 0 q therefore the relative contribution to streamflow change by each climatic factor is calculated as 19 η p δ q p δ q t o t 100 and η e 0 δ q e 0 δ q t o t 100 where η p and η e 0 are the contributions of changes in precipitation and potential evapotranspiration respectively finally the contribution of anthropogenic changes to streamflow change can be calculated by equation 2 5 sensitivity indicator si method in 2002 a new method to analyze the impact of long term changes in precipitation and potential evaporation on changes in streamflow was developed by arora 2002 the multi year average potential evapotranspiration e 0 and the multi year mean precipitation p can be combined to form the multi year average aridity index the aridity index ϕ has been used to describe the partition between actual evaporation and streamflow of catchments in a wide range of climatic regimes grijsen et al 2013 if ϕ 1 the watershed is arid and the energy supply impedes evaporation if ϕ 1 the water supply impedes evaporation and the watershed is humid when e 0 is larger than p i e e 0 p 1 0 the energy available for evapotranspiration exceeds available precipitation water becomes a limiting factor and the basin produces no streamflow hasan et al 2018 the climate elasticity method was introduced by schaake 1990 to estimate the impact of climate change on streamflow as a physically realistic approach to compute the watershed water and energy balance it has been widely applied in different regions around the world jiang et al 2015 li et al 2018 liu et al 2017 wu et al 2017a xia et al 2014 xu et al 2014 arora 2002 expressed the percent streamflow change δ q q as a function of percent precipitation change δ p p and percent potential evapotranspiration change δ e 0 e 0 20 δ q q δ p p 1 β δ e 0 e 0 β where β is the sensitivity index which is proportional to the aridity index streamflow coefficient r c is computed from the evaporative ratio 21 r c q p 1 e p β can be calculated by following grijsen et al 2013 22 β 2 3 r c r c 2 when β reaches the maximum any slight change in precipitation or evapotranspiration results in a drastic change in streamflow furthermore β becomes larger when r c is smaller by re arranging equation 20 streamflow elasticity to precipitation ε p can be written as 23 ε p δ q q δ p p 1 β similarly the streamflow elasticity ε e 0 to e 0 can be expressed as follows 24 ε e 0 δ q q δ e 0 e 0 β using equation 16 one can calculate δ q c while one can determine δ q p and δ q e 0 using equations 17 and 18 finally the contributions of anthropogenic changes to streamflow change δ q h can be calculated by equation 2 2 2 data and study area in study we chose the guanting river basin as the case study area the guanting basin is to the northwest of beijing and a tributary of haihe river with a drainage area of 43 600 km2 between 39 n and 42 n and 112 e to 117 e fig 2 this study will focus on the upper and lower part of this basin i e the xiangshuipu catchment and shixiali catchment fig 2 it has a semi arid climate with monthly average temperature ranging from 11 c in january to 22 c in july and mean annual precipitation of 425 mm approximately 70 of the precipitation occurs during the monsoon season may to september the principal tributaries of the basin are sang river and yang river according to the census data from 2000 63 of all employees worked in agriculture 16 in the industrial sector and 21 in the service sector otto et al 2016 the agriculture sector primarily depends on surface water with a supplement of groundwater and consumed 71 6 of the total water consumption domestic use and industrial sector mainly rely on groundwater and consumed 18 6 and 9 8 of total water consumption respectively the basin is extensively affected by anthropogenic activities with an imbalance between supply and demand since china s economic reform and opening up policy in 1979 rapid growth of economy urbanization and population has been observed water consumptions by agriculture industry and domestic use have significantly increased these activities along with corresponding changes in land use and land cover have affected streamflow generation and concentration in this area daily meteorological data from forty five stations across the basin fig 2 from 1960 to 2015 were collected from the national climate center of china meteorological administration cma the observation data consist of daily maximum minimum average temperature and precipitation annual streamflow data 1960 2015 from xiangshuipu and shixiali stations were acquired from the china annual hydrological reports we considered the location lengths and completeness of records when selecting the weather stations such that the entire guanting river basin could be covered as the input to swat model a digital elevation map dem was derived from the shuttle radar topography mission srtm with a resolution of 30 m land cover maps of 1980 1990 and 2000 were obtained from the resources and environmental science data center chinese academy of sciences http www resdc cn soil map was obtained from fao global soil data 1 50000 http www fao org 3 results 3 1 long term trend and change in streamflow the pettit test shows that the turning points of the observed annual streamflow series in both of stations occurred in 1983 at the 5 significance level table 2 this result indicates that he streamflow series can be divided into two periods the natural period 1960 1983 in which the impacts of human activities on streamflow are insignificant and the comparative period 1984 2015 in which there are substantial human impacts for both xiangshuipu and shixiali stations to assess the decadal impact of climate change and human activities the comparative period can be divided into two sub periods 1984 1999 and 2000 2015 representing the 1990s and the 2000s respectively overall annual streamflow series in both catchments show significant decreasing trends which passed the mann kendall trend test at the significance level of 0 05 table 2 additionally a significantly decreasing trend at a 5 significance level was also observed in the runoff coefficient and evaporation table 2 3 2 changes in the aridity and precipitation evapotranspiration relation fig 3 presents the aridity indices for the baseline period and the two comparative periods i e the 1990s and 2000s in the xiangshuipu and shixiali catchments it can be clearly observed that the aridity index increases over the past five decades in both of the catchments from 1 38 to 1 52 in xiangshuipu and 1 41 to 1 57 in shixiali fig 3 this result implies that the climatic conditions became drier from the baseline period 1960 1983 to the 2000s 2000 2015 in both xiangshuipu and shixiali the budyko curve for the whole guanting basin based on the data record from 1960 to 2015 clearly demonstrate that all but one data points are located in the water limited zone i e e 0 p 1 fig 4 indicates that this area is an apparent water limited region in a couple of years the e p values are even close to the upper limit this could be due to both limited water input low precipitation and high temperatures which increase evapotranspiration and thus foster water losses to the atmosphere these results not only corroborate the previous reports by xing et al 2018 but also agree with the physical and climatological conditions in the guanting river basin 3 3 sensitivity and elasticity of streamflow it is clear that sensitivity index β in the guanting river basin is inversely proportional to the streamflow coefficient fig 5 moreover one can observe that the guanting river basin is characterized by a high sensitivity of streamflow to changes in precipitation and evaporative capacity β 1 and a low streamflow coefficient r c 0 35 fig 6 these results are consistent with the natural climatic conditions in the semi arid basin by dividing the guanting basin into two sub basins the time courses of annual sensitivity indices of the two catchments xiangshuipu and shixiali show similar interannual variability and long term trend fig 6 overall most of the data points are located in the zone with high sensitivity values in both of the catchments the peaks of β are observed around 1965 fig 6 another peak of β for the shixiali catchment is observed in 2014 low β values are sporadically observed from 1962 to 1995 in the two catchments denoting a low sensitivity during this period when β is large high sensitivity a given change in precipitation and potential evapotranspiration produces disproportionate changes in streamflow from these results it can be concluded that the streamflow in xiangshuipu and shixiali is generally sensitive to precipitation and potential evapotranspiration in addition the β values in both of the catchments show clear upward trends fig 6 indicating that streamflow in the two catchments is becoming more sensitive to climatic changes over the past five decades fig 7 shows the precipitation and potential evapotranspiration elasticity of streamflow ε p and ε e 0 which were computed using the elasticity method and sensitivity index method the results based on the elasticity method have six sets of results because six budyko framework based actual evapotranspiration to precipitation ratio estimation equations were applied to derive the elasticity the impacts of climate change on streamflow were estimated using multi year precipitation and potential evapotranspiration data and separated into two distinct periods namely the 1984 1999 and 2000 2015 periods fig 7 a and b show that the potential evapotranspiration elasticity values of streamflow ε e 0 are negative in the two catchments quantified by all seven methods during both the 1984 1999 and 2000 2015 periods the means value of ε e 0 in the xiangshuipu catchment are 1 48 0 23 and 1 56 0 28 during the 1984 1999 and 2000 2015 periods respectively fig 7a this result implies that on average a 10 increase in potential evapotranspiration would decrease streamflow by 14 8 and 15 6 during the two periods respectively change in potential evapotranspiration causes more streamflow reduction during the 1984 1999 period than during the 2000 2015 period the ε e 0 values in the shixiali catchment display a similar pattern as in the xiangshuipu catchment fig 7a b on average 10 increase in potential evapotranspiration results in 14 2 16 0 reduction of streamflow in the 1984 1999 and 2000 2015 periods respectively fig 7b it is clear that the potential evapotranspiration changes have caused streamflow changes in the two catchments to the similar degree fig 7 contrary to the ε e 0 results the ε p values in both xiangshuipu and shixiali catchments are all positive in both of the 1984 1999 and 2000 2015 periods fig 7 this is because streamflow has a positive correlation with p and a negative correlation with e 0 in xiangshuipu as an illustration the average values of ε p are 2 48 0 23 and 2 56 0 28 for the 1984 1999 and 2000 2015 periods respectively fig 7a similarly the shixiali catchment has an average ε p value of 2 49 0 31 and 2 66 0 32 during the 1984 1999 and 2000 2015 periods respectively fig 7b the above results indicate that the shixiali catchment has slightly higher streamflow sensitivity to changes in precipitation and potential evapotranspiration than the xiangshuipu catchment moreover streamflow is more sensitive to change in precipitation than change in potential evapotranspiration in the two catchments this results is consistent with the conclusions by xu et al 2014 and xing et al 2018 similarly according to the study by cong et al 2014 changes in precipitation contribute to streamflow change in five significant basins near the study region 13 on average with a range of 5 25 as a whole these studies indicate that rainfall changes have become a dominant climatic factor that influences the streamflow regime in our study area and its adjacent region 3 4 relative contributions of climatic and anthropogenic changes on streamflow fig 8 shows the relative contribution of climatic and anthropogenic changes to changes in streamflow during the 1984 1999 and 2000 2015 periods relative to the 1960 1983 period ten attribution methods were applied including six budyko framework based methods sensitivity indicator method hydrological simulations double mass curve analysis and simple linear regression even though the results of the different methods are slightly different with each other all results reach consensus on the relative importance of climatic and anthropogenic causes to streamflow changes and relative difference of climatic and anthropogenic contributions between different time periods overall anthropogenic activities contribute much more than climatic change to the reduction in streamflow for both catchments fig 8 in xiangshuipu the ensemble average relative contributions of anthropogenic changes are 80 54 3 55 and 86 91 1 71 during the 1984 1999 and 2000 2015 periods respectively fig 8a while the ensemble average relative contributions of climatic changes are only 19 46 3 55 and 13 09 1 71 during the 1984 1999 and 2000 2015 periods respectively fig 8a similarly the ensemble average relative contributions of anthropogenic changes in shixiali are 81 99 3 61 and 83 47 3 76 during the 1984 1999 and 2000 2015 periods respectively fig 9 b which are more significant than those of climatic change 18 01 16 53 during the same periods moreover we can notice that the impacts of anthropogenic activities increase gradually from the 1984 1999 period to the 2000 2015 period in both of the catchments implying that human activities are imposing gradually more influence on streamflow this might be due to the various land use changes in the basin the construction of reservoirs across the sang river and yang river over the years industrial development and the artificial water withdrawal from the river channel for agricultural purposes in terms of variability between attribution methods dmc and slr have very similar results in both catchments this might be due to the similarity in their overall concept and the similar climatic conditions in the catchment the results from the parametric beafu beazhang and non parametric beaol dekop beashreiber beatur c pike beabudyko budyko framework based methods were consistent for all catchments with notable differences in their corresponding calculated contribution rates these results indicate that there is non negligible uncertainty in the actual evapotranspiration estimation between the six budyko type equations summarized in table 1 overall all methods unanimously reach the same conclusion namely anthropogenic activities playing a dominant role in streamflow decline in the guanting river basin during the last five decades while climatic changes are also occurring in this region with the assumption that climate change impact is typically a direct product of precipitation and potential evapotranspiration we estimated the relative contribution of each climatic contributing factor to streamflow change from the results displayed in table 3 it has been seen that precipitation had more effect on streamflow an average of 15 06 than potential evapotranspiration an average of 6 24 in the 1984 1999 period in the xiangshuipu catchment however during the 2000 2015 period the contribution rates of precipitation and potential evapotranspiration to streamflow decline are nearly the same i e 6 14 and 6 97 respectively in the xiangshuipu catchment table 3 unlike the results in xiangshuipu changes in precipitation remains a more significant contributor to climate change induce streamflow reduction than changes in potential evapotranspiration in shixiali table 4 the contribution of precipitation changes to streamflow changes are on average 17 19 and 16 86 during the 1984 1999 and 2000 2015 periods table 4 this finding also agrees with the findings by xia et al 2014 which showed that streamflow is more sensitive to variation in precipitation than variation in potential evapotranspiration in the same basin six budyko framework based equations were used to precisely quantify the impact of climate change and anthropogenic activities in the basin the results are consistent throughout the basin figs 9 and 10 however there are nevertheless slight differences between the approaches due to the different formulas that empirically describe the hydrological processes altogether it can be observed that a non parametric method budyko provides the highest estimation of climate change impact in the whole basin whereas a parametric method zhang has the lowest estimation during both of the 1984 1999 and 2000 2015 periods contrarily the parametric zhang method shows the highest human impact contribution to streamflow decrease while the non parametric method budyko shows the least human impact rate on streamflow in both of the two catchments during both of the periods these notable differences are possibly due to the geographic setting soil properties and vegetation it is noted that human impact rate increases moderately from the 1984 1999 period to the 2000 2015 period across the basin figs 9 and 10 no matter which of the methods is used this observed rise is due to the extension of agricultural land intensive irrigation practices and rise of the industrial and human water consumption in guanting river basin this finding also accords with earlier observations in haihe river basin by lu et al 2015 4 discussion overall the results of the quantifying environmental change impacts in this study indicate that anthropogenic activities played a dominant role in streamflow changes in the guanting river basin during 1960 2015 though the contribution from climate change was not negligible our findings are consistent with those from previous studies for example xia et al 2014 employed a budyko hypothesis based method with the penman monteith equation to separate the effects of climate change and human activities the methods indicate that 87 4 89 5 of the total streamflow decrease was due to human activities with the remaining decline due to climate change another study conducted by xu et al 2014 in northern china using a choudhury yang equation based on budyko hypothesis shows that the impacts of climate variation and land use cover human activities change were accountable for the streamflow decrease by 26 9 and 73 1 on average respectively despite the consistency of these results the methods used present some uncertainties in the estimate for example attribution of the contributions of climate change and human activities to variations in streamflow is based on the assumption that the two factors are independent however they are inter related and the underlying mechanism may be more complicated due to the interactions amongst hydrological processes and climate zeng et al 2015 furthermore the elasticity based methods attempt to capture the long term effects of anthropogenic activities and climate change on the water balance but they do not take into account the changes in extremes events seasonality and snowiness gao et al 2016 moreover it has been proven that seasonality can change the e p ratio a climate with more variable seasonality tends to shift this ratio downward for a given e 0 feng et al 2012 additionally uncertainties in model structure model parameters and meteorological data may hinder the quantification results obtained through hydrological modeling wu et al 2017a it is worth mentioning that only two climate variables precipitation and potential evapotranspiration were selected for climate sensitivity to streamflow this leaves room for uncertainty the number of climatic components to include when assessing the effect of climate on streamflow is yet determined neither is the sensitive nor dominant variables the hydro meteorological data applied the fundamental assumptions expressed to measure the impact of climate change and anthropogenic activities and the approaches employed to evaluate the influences all carry a certain weight of biases as expressed by liang et al 2015 this needs to be adequately taken into account when carefully analyzing the results for better decision making and policymaking for sustainable development of water resources in guanting all these uncertainties might influence the estimated results to some extent since it has been observed in this study that anthropogenic activities represent the dominant drivers of streamflow decline in guanting river basin it is meaningful to comprehend why anthropogenic activities exert so much effect on streamflow decrease the decline in streamflow might be due to an increase in agricultural and industrial water demand in the basin the construction of reservoirs borehole and dams water diversion from large reservoirs guanting and cetian these results corroborate the findings of previous works in this basin bao et al 2012 jia et al 2012 lu et al 2015 wang et al 2013 xia et al 2014 xu et al 2014 moreover abrupt change of streamflow in the 1980s indicated by pettit test in this study corresponded to the beginning of china s land reformation which allows farmers to assert more control on land management and irrigation practices were highly encouraged furthermore industries productivity economic growth along with the population increased significantly therefore a greater need for water consumption was observed wang et al 2013 these factors might explain the shift of streamflow around that period similar findings have been reported in other studies li et al 2018 liu et al 2017 wang et al 2016 the budyko framework based methods could be separated into two categories non parametric beaol dekop beaschreiber beatur c pike and beabudyko and parametric beafu beazhang methods it can be observed in figs 9 and 10 that the non parametric method beabudyko measures the highest contributions of climate change impact to streamflow decrease during the 1984 1999 and 2000 2015 periods for both of the subbasins i e 25 18 and 16 90 for xiangshuipu and 24 4 and 22 73 for shixiali for the two comparative periods respectively in contrast the parametric method beazhang quantifies the lowest climatic contributions about 5 7 lower than the values quantified by beabudyko correspondingly the beazhang method measures the highest anthropogenic contributions for both of the subbasins during the two comparative periods among the budyko framework based methods while the beabudyko method quantifies the lowest anthropogenic contributions fig 10 in summary the uncertainty between the budyko framework based methods is about 5 7 these notable differences are clearly due to difference in calculating the ratio of actual evapotranspiration to precipitation table 1 therefore it is not surprising that the results with the nonparametric methods are slightly different from the results with the parametric methods in addition one can tell that the results of slr dmc and hs are very similar to each other figs 9 and 10 while the si results are similar to the results of most of the budyko framework based methods the difference between the non bea methods varies between 2 and 6 while the difference between bea methods and non bea method is between 5 and 12 these results suggest that one specific method may not be totally reliable at least it may overestimate or underestimate the contributions of climate change and anthropogenic activities to streamflow change despite the different results obtained via various methods one may argue that the methods are not convincing nevertheless one fact remains consistent all methods have quantitatively shown that anthropogenic activities contributed more than climate change to streamflow decline in guanting river basin therefore an integrated methodology including a variety of quantitative methods based on different structures and bases should be more efficient 5 conclusions this study aims to answer the question of how much climate change and anthropogenic activities contribute to streamflow variation by using guanting river basin as a case study we proposed a comprehensive assessment framework for quantifying climatic and anthropogenic contributions to streamflow changes by combing a variety of attribution methods including six budyko framework based methods hydrological simulations using the swat model simple linear regression double mass curve analysis and sensitivity indicator method the mann kendall trend analysis and pettit test results showed abrupt change occurred in 1983 in both of the subbasins of the guanting river basin subsequently the aridity was estimated to represent the basin climate character it was observed that the aridity index increased from decade to decade therefore indicating the climatic conditions became drier from 1960 to 2015 in the basin to estimate runoff response to potential evapotranspiration ε e 0 and precipitation ε p six budyko hypothesis elasticity based methods were further applied the results indicate that change in streamflow was more sensitive to variations in precipitation than variation in potential evapotranspiration furthermore the estimation of climatic and anthropogenic impacts on streamflow show that human activities are principally responsible for streamflow reduction in the guanting river basin the findings of this research support the hypothesis that humans played a substantial role in changes in streamflow in guanting river basin however more research on this topic needs to be undertaken to clearly understand the complex interaction between climate change and anthropogenic activities and their contribution rates besides further study with a focus on the effect of future climate variables and human activities on hydrological processes is therefore suggested author contributions kz contributed to conceptualization data curation funding acquisition investigation methodology supervision project administration and writing original draft and review editing gbr conducted formal analysis investigation validation visualization and writing original draft and review editing zl contributed to data curation and writing review editing zy jx and zd contributed to writing review editing acknowledgments this study is supported by the national key research and development program of china 2016yfc0402701 national natural science foundation of china 51879067 natural science foundation of jiangsu province bk20180022 six talent peaks project in jiangsu province ny 004 and fundamental research funds for the central universities of china 2018b42914 and 2018b04714 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2020 104704 
26029,modeling coupled social and biophysical dynamics of water resources systems is increasingly important due to population growth and changes in the water cycle driven by climate change models that explicitly represent these coupled dynamics are challenging to design and implement particularly given the complicated and cross scale nature of water governance agent based models abms can capture human decision making and nested social hierarchies however transferability is made difficult by location specific details a consistent description of water resources decision makers individuals groups agencies would advance the rate of model development and increase synthesis across systems reviewing water resources abms we propose eight agent types and associated operational roles that modify the storage redistribution and water use in a system application of the proposed typologies and use of best practices in model documentation will support systematic design and development of transferable scalable water resources abms and facilitate the dynamic coupling of social and biophysical process modeling keywords agent based modeling water resources social ecological systems data availability the dataset generated for this study can be found in hydroshare kaiser k e a flores v hillis 2018 literature review of water resources agent based models hydroshare 1 introduction the capability to simulate the dynamic coupling between human activities and the water resource systems on which they depend is critically important in the context of long term stressors such as climate change land use intensification population growth and urbanization in particular humans impact and are impacted by the availability and quality of water resources from local to global scales the feedbacks involved in this reciprocal relationship create a multiscale dynamically coupled natural human cnh system globally water withdrawals are increasing 2500 to 4000 km3 yr 1 from 1971 2010 but sectoral trends in water withdrawals vary across regions for a variety of reasons including increasing water use efficiency population growth and urbanization huang et al 2018 meanwhile the availability of water impacts a range of societal decisions such as where to build and how to insure structures in floodplains the type of crops to plant water use restrictions in urban areas trans boundary water transfers and infrastructure development dubbelboer et al 2017 ahmad and prashar 2010 sehlke and jacobson 2005 jeuland et al 2014 anthropogenic climate change and the associated intensification of the global hydrologic cycle huntington et al 2018 are hypothesized to lead to increasing global average precipitation with large variability in regional trends bates et al 2008 determining how climate change will affect this multiscale cnh system will be critical to assess potential adaptation strategies agent based models abms are particularly useful for coupling models of human systems and the hydrological systems with which they are integrated using abms to model cnh systems has become popular in part because of their flexibility in how they represent interactions among human actors and between humans and natural systems in the realm of water resources humans have modified hydrologic systems to meet demands for irrigation industrial use and domestic drinking water these modifications directly impact hydrologic states and fluxes like river discharge groundwater table elevation and soil moisture in addition to the complexity of natural hydrologic systems humans have developed complicated socioeconomic political physical and cyber infrastructure to coordinate decision making and management of these water resources despite the flexibility of abms for capturing complex interactions between humans and hydrologic systems it appears that abms have not been adapted for water resource system analysis with the same frequency as they have in modeling land use and land cover change e g see extensive reviews matthews et al 2007 d aquino et al 2002 groeneveld et al 2017 potential barriers to adoption of abms in water resources might include a the highly complex and heterogeneous spatio temporal processes associated with water resource systems across locations b significant prior work using alternative classes of models that integrate human behavior and decision making with biophysical models of the environment e g hydroeconomic socio hydrology systems dynamics c the often simplistic way human influences on water systems have typically been represented in models of hydrologic systems and d the lack of consistency in documentation description implementation availability and transferability of code groeneveld et al 2017 the development of agent functional types afts has emerged in the land use change modeling community as a vehicle to address issues of actor heterogeneity while increasing the transparency of agent representations and simplifying model development arneth et al 2014 analogous to plant functional types afts characterize heterogeneity through common agent attributes e g socio demographic or economic attributes spatial data such as irrigated acres and crop type and common preferences associated with their objectives which guide their decision making e g preferred management practices blanco et al 2015 developing afts for water resource systems could help address the barriers to application of abms identified above potentially leading to new insights about the emergent properties of inextricably coupled human hydrologic systems one challenge to identifying water resource afts however is the hierarchical and cross scale nature of water resources management developing afts for water resource systems requires a broader framework for capturing the diversity of water management actors a water resource agent typology would represent the operational roles of individuals or organizations and specifically identify how an agent influences water quantity or quality by altering the redistribution of water in the landscape either directly or through interactions with other actors although the individuals and structure of between actor relationships will change across systems the roles and observational information used by water managers or individual users will be relatively consistent e g snow water equivalent forecasted precipitation groundwater levels etc here we propose a typology for water resource management actors that can facilitate more transparent transferable and comparable abms of water management systems our agent typology is based upon a review of 54 published studies that apply abms to water resource systems from these prior studies we identify common water resources agent types across systems define their roles associated input output variables and potential social interconnections the typology is useful because the agent types allow expedited identification of agents to include in coupled water resources models aid in the representation of nested social and institutional structures simplify coupling with models of the biophysical system increase the transferability and synthesis of models across systems and potentially enable development of regional scale cnh models of water resources this agent typology would lay the foundation for more specific functional types to be developed within each type of agent e g farmer and forest afts valbuena et al 2008 blanco et al 2015 in addition to developing a classification of agent types that emerges from the literature we also investigated specific practices employed by model authors that allow for enhanced model reuse transferability and extensibility we explore some potential practices that if broadly adopted would make abms of water resource systems 1 more portable and reusable 2 more rapidly configurable for specific locations and 3 facilitate improved comparison and synthesis across sites and studies 2 analysis of water resources agent based models we conducted a literature review of water resources abm papers allowing us to systematically identify common water resources agents we used the web of science to find water resources abms by using the following search terms water manage typ abm water grimm et al 2010 and grimm et al 2006 with water agent we also identified additional papers from citations of those initial papers and associated software platforms studies that did not have sufficient model description to characterize agents and associated roles or those that were theoretical modeling experiments e g not location or implementation based were excluded the limited number of abms that remained after these exclusion criteria compelled us to find additional papers through the initial papers citation lists software platforms and the follow up papers to grimm et al 2010 and grimm et al 2006 we did not exclude abms from non peer reviewed reports or theses as these abms were often well documented implementation based abms the final literature to be reviewed included 54 papers covering locations across the globe spanning europe 16 asia 11 north america 10 africa 7 south america 5 the middle east 2 and oceania 3 the exclusion criteria inevitably reduced the review to a small fraction of the total abm water resources literature the most common reason for excluding a paper was due to it being based on a hypothetical location population papers were also excluded if they were variants on hydroeconomic models that did not include explicit agents with attributes and functions or if they described the process of developing an abm but not the model itself in a few instances a paper would present an abm but the documentation of the agents was so poor that we were unable to determine the specific function of agents in the model it is plausible that this subset biases the estimate of the fraction of each agent type that exists in the literature overall or the percent of models that use various documentation techniques aside from this potential bias our reviewed literature does capture a range of abms based on real locations across 33 journals and reports 2 1 documenting common practices we gathered basic information about each publication including the journal year of publication and department of first author environmental modeling and software was the most common venue for publication of water abms with a total of 10 papers another 6 journals had published between 2 4 papers and 26 other journals or non peer reviewed venues published a single water resources abm we also grouped the department or administrative home of each first author into 9 categories as a mechanism of assessing the disciplinary cross section of authors contributing to the water abm literature the disciplinary nature of contributions to the literature is diverse although engineering and environmental sciences departments were the most common 43 and 22 respectively in reviewing each paper we also documented the use of a number of tools and frameworks meant to make abms specifically and computational models generically more transparent transferable and reusable of particular interest was the use of class diagrams for illustrating agent characteristics and interrelationships fowler and scott 1993 making model code open source and the use of the overview design concepts and details odd protocol grimm et al 2006 2010 for documenting abms the odd protocol was created as a common structure for describing abms which stresses the importance of standardized descriptions to assure models are described completely and consistently although 9 of the papers were published prior to the odd protocol the majority of papers reviewed did not use the odd protocol class diagrams or make their source code open fig 1 of the 12 papers that did apply odd the relevant information for characterizing the model was not always presented for example only 3 papers that used odd identified both spatial and temporal extent and resolution of the study area and the total number of agents modeled the most recent year in the analysis 2017 was the year associated with the largest number of water abms published which suggests that abms are an increasingly common tool being used in water science 2 2 classification of water agent types we documented the agents reported in each manuscript and grouped them by the characterization scheme provided by akhbari and grigg 2015 these agent types included urban domestic industrial agricultural regulator environmental hydropower and recreation after reviewing the roles of each agent type we modified the akhbari and grigg 2015 classification scheme first rather than having a functional type that specifically represents hydropower generation we broadened the scope to include all dam managers this enables representation of individual dam operation objectives through attributes of a given dam manager secondly we grouped recreation agents into a broader interest group agent to reflect that recreation agents are one type of interest group that communicates a range of desires from constituents to regulatory agents finally we retained the environmental agent for coding agents in the reviewed literature that represent environmental stores and fluxes but do not include them in our final agent typology because they do not represent individuals that make decisions about water resources in addition to modifying agents we also added two new agent types that were represented in numerous abms utilities 7 and economic agents 11 our final agent types include agriculture regulatory domestic industrial commercial utilities interest groups reservoir managers and economic agents the most common agent types found in the literature were agricultural regulatory and domestic users fig 2 within each agent type we documented associated roles used in each model table 1 fig 3 these operational roles encapsulate the mechanisms by which each agent type influences water quality or quantity in the system in the following sections we define the role of each agent type each agent s typical attributes and potential connections with other agents fig 4 2 2 1 water users water user agents are most commonly represented as individuals with multiple instances of their agent type being represented within a given model 2 2 2 agriculture the role of the agricultural agent is to withdraw water from the system distribute and apply it to the landscape through irrigation these agents main role is to withdraw water from the system either from surface or groundwater for irrigation purposes table 1 they can also create and maintain structures that transport water to agricultural areas e g canals add new groundwater wells and irrigation systems becu et al 2003 buy and import water barthel et al 2008 and adopt innovations such as irrigation or pumping technology that directly impact their consumption of water holtz and pahl wostl 2012 the agricultural domain is one of the most commonly used functional types in water resources abms fig 2 a wide variety of attributes are typical of agricultural agents which were commonly represented by multiple instances within one model where multiple types of agricultural agents were used to capture a range of attributes in line with the aft concept individual agents commonly have attributes that specify their geographic location and farm size cai and xiong 2017 yuan et al 2017 and socioeconomic or demographic attributes such as income gender farming experience or membership in conservation organization giuliani and castelletti 2013 while aggregate agents might represent organizations such as irrigation districts various attributes define the agricultural enterprise such as on farm non agricultural activities number of wells barthel et al 2008 crop choice and planting date labor force allocation farm business structure holtz and pahl wostl 2005 entrepreneurship and dependence on irrigation resource cai and xiong 2017 source of water kock 2008 van oel et al 2010 2012 or type of farming bah et al 2006 souza filho et al 2008 farolfi et al 2010 espinasse and franchesquin 2005 agricultural agents have attributes that specify how they make decisions potentially including heuristics for accessing processing and sharing information and memory of their previous actions and those of agents within their social network they may also have attributes explicitly defining how they are connected with other agents via for example communication networks 2 2 3 domestic domestic agents consume water for indoor and outdoor residential uses the main role of domestic water users is to consume water for indoor and outdoor residential uses table 1 they are often modeled at the individual or household level which enables their use in modeling population growth and location preferences zellner 2007 berglund 2012 nikolic and simonovic 2015 they can also implement various water saving strategies which occur at the household level such as installation of water saving appliances or adoption of water reuse programs elhay et al 2016 soboll et al 2011 attributes of domestic agents can reflect socioeconomic factors akhbari and grigg 2015 including household and lot size tidwell et al 2012 they also can be characterized by their communication networks which can have important impacts on their knowledge and decision making they can share important information about the state of the hydrological system with their networks as well as receive information from news and media sources e g elhay et al 2016 barthel et al 2008 domestic agents decisions are a function of various attributes including how they learn memory of previous hydrologic conditions or the criteria they use to minimize or optimize use table 2 2 2 4 industrial commercial industrial agents use water for processes such as fabricating cooling washing processing diluting or transporting a product dieter et al 2018 the role of industrial agents is to extract and discharge water treat discharge and trade water quality permits table 1 berglund 2012 zellner 2007 these agents operate at the organizational scale and decisions are often based on allocated permits nikolic and simonovic 2015 akhbari and grigg 2015 the key attributes of these agents relate to the characteristics of the industrial process they are performing and their associated water rights or pollution permits they have important knowledge about their operations including the quantity and quality of water entering and leaving past allocation rules water rights and assimilative capacity of the system akhbari and grigg 2015 various spatial attributes determine their interactions with the hydrological subsystem including their geographic location the source of their water and the location of their discharge they can have important communication networks in particular in the realm of communicating with other agents about water quality standards being surpassed or to buy water quality permits various attributes determine how they make decisions typically focused on minimizing costs which are a function of regulatory restrictions and fees in addition to demand for their good service itself a function of local and global markets table 2 2 2 5 water providers water providers make decisions about timing and magnitude of water distribution in a given system they are commonly represented as a single agent type but could include multiple instances of a given agent in a large enough modeling domain e g multiple municipalities 2 2 6 regulator regulators are agents that create or enforce local state or federal policies these agents encompass both policy makers who create rules and regulations and the administrators that enforce them regulators allocate water and permits record violations enforce associated penalties and can develop large scale infrastructure table 1 noël and cai 2017 tidwell et al 2012 bakarji et al 2017 berglund 2012 kock 2008 berger et al 2007 they exist at different scales federal state council of governments county municipality and can potentially affect all actors within their regulatory boundaries while their actions generally occur at the institutional level their decisions can be influenced by the individual biases that are attributes of the individuals occupying the roles regulatory agents like agricultural agents also operate across a particular geographic jurisdiction an important set of attributes relates to their knowledge of the system and their ability to monitor it they may have knowledge pertaining to water rights past allocation rules memory of historic hydrologic conditions water quality data and important environmental data such as snow water equivalent in the snowpack or forecasted streamflow because of their foundational presence in the system regulatory agents have communication networks and these networks impact their relationships with almost all other agents in the region they also have attributes that govern how they make decisions including heuristics based on established regulations public opinion profit and perception of environmental conditions table 2 public opinion could be a component of their decision making through the influence of interest groups and profit would capture the influence of fees fines and financial resources their perception of environmental conditions could be based on data they obtain from the system or indirect information that they receive through other individuals akhbari and grigg 2015 types of regulation can be represented as command and control e g zoning and strategic planning or incentive based the rules and regulations could be parameterized based on constrained optimization problems bakarji et al 2017 or actual regulations obtained from local state or federal agencies 2 2 7 water utilities water utilities are public or privately owned organizations that obtain treat and deliver water to service connections in order to provide uninterrupted supply of safe pressurized drinking water utilities control large distribution systems construct and maintain infrastructure identify new water resources and set water prices idwr 2018 these agents generally function at the organizational level the most common way water utilities have been included in water resources abms is in implementing and enforcing water use restrictions table 1 attributes of water utilities include information on their customer base number of people they serve and the timing of that service characteristics of the water source supply area withdraw limits attributes of the organization itself such as ownership and management baietti et al 2006 and affiliated water supply companies and transboundary transfers barthel et al 2010 water utility agents also have important knowledge of the hydrological system including current and projected future water needs this knowledge informs their decision making about the development of new infrastructure and implementation of water use restrictions their decision making is typically based on profit maximization projection of future development regulations operational targets and technological advances table 2 they also have communication networks that shape how they transmit information about conservation goals and water use restrictions to users as well as to relay warnings or use restrictions barthel et al 2010 they can also serve as communication intermediaries between regulatory agents and users 2 2 8 reservoir management reservoir management agents represent reservoir operations which control the timing and amount of reservoir outflow rather than using hydropower as an independent agent which was common in the literature review akhbari and grigg 2015 kock 2008 giuliani and castelletti 2013 we posit that a reservoir manager has a unique role in water management which could represent the interest and knowledge of agents from private federal or state owned reservoirs table 1 the fundamental attributes of a reservoir agent include both the characteristics of the reservoir and characteristics of the manager themselves reservoir attributes include the type of dam e g run of river total capacity live dead storage number of turbines energy demand and pricing akhbari and grigg 2015 and potential exposure to litigation kock 2008 while attributes of the manager might include things such as risk aversion and memory of historic hydrologic conditions and associated management these attributes impact decision making which are often represented as operational targets from the regulatory agent and maximization of hydropower generation their decisions will also be based on historical operations of the dam and profit margins table 2 reservoir managers have specific objectives that they may be optimizing for such as flood control late season irrigation releases or consistency in hydropower production bpa et al 2001 this requires coordination among government agencies regulatory agents private dam owners water utilities economic agents agricultural agents or interest groups and the reservoir manager 2 2 9 other water actors these other water actors are examples of groups that may have significant influence over the use and management of water in a given system they can increase communication between agents or provide financial support 2 2 10 interest groups the interest group agent includes individuals or organizations that use various mechanisms to impart behavioral change in the system the role of interest group agents is to impart influence in the system via education and outreach to influence public opinion or through advocating for government and industry to change regulations and policies table 1 they can represent environmental ngos tribal communities recreational users the agricultural sector or taxpayers in general e g thoyer et al 2001 as such they might operate at the organizational scale but they can influence individuals within other agent types or at the institutional organizational level in regard to policies and regulation as dictated by the regulatory agent they can serve as a watchdog by monitoring compliance with regulation as an enabler by providing resources crosman 2013 serve as experts by using science to inform decisions or via mediation islami 2017 act as managers in specific projects or disseminate information specific attributes of an interest group agent will depend on the role that the interest group plays in the system interest groups make decisions based on the state of the environment and the satisfaction levels of other agents as such they monitor both the state of the environmental system but also the state of the social one they can share information with their stakeholders and can also report information about other users to regulatory agents 2 2 11 economic institutions economic agents manage capital invested in the water sector to either reduce water related risks or increase capital gains from water related investments the role of economic agents is to manage capital invested in the water sector and provide information to other agents about the economic state of the system table 1 economic agents can also create private and public water markets sell insurance e g flood or oversee water banking ghosh et al 2014 taxes subsidies infrastructure investments dadson et al 2017 fines transaction costs and conservation rate structures michelsen et al 1999 mulligan et al 2014 the most important attributes of economic agents relate to their ability to manage capital and interact with other agents in ways that impact water flows as such their international network is one of their most important attributes this network can be diverse and far reaching including both direct e g providing flood insurance dubbelboer et al 2017 and indirect characterizing the economic state of the system or household water costs rehan et al 2013 2 2 12 relationships and feedbacks a critical aspect of complex systems is the existence of feedbacks among actors and the environment which can create emergent properties or characteristics of the system that are difficult to predict from a consideration of the parts in isolation feedbacks occur when an initial change to one part of the system has an impact elsewhere and that impact creates a new consequence for the agent that imposed that initial perturbation an agent typology potentially aids in understanding feedback mechanisms and the components of the coupled human environmental system through which they connect we provide one example that illustrates how agent typologies might be used to identify potential feedbacks for more targeted study in this example fig 5 reservoir managers make decisions that impact streamflow through release of water which reduces storage of surface water for irrigation later in the season the decisions made by the reservoir agent balance the competing demands for minimum streamflow set by the regulator and for water storage deeded through water rights to agricultural agents agricultural agents make irrigation decisions that influence decisions made by reservoir manager and both streamflow and groundwater levels the regulator monitors environmental conditions and water users and may have to enforce regulations through this feedback mechanism the agricultural agents in this system are influencing the behaviors and decisions of the reservoir manager and the regulator through their individual and collective action as communicated by streamflows and groundwater levels 3 discussion insights from review of agent types the agent typology that emerges from our review of the literature is a framework that can support more rapid development of water abms greater ability to compare water abm studies and enhanced capability to integrate abms and hydrologic models while there are clear commonalities with previously developed agent typologies we found additional agent types in the literature that may play significant roles in the management of water resources below we elaborate on why those agent types may be significant to include in a typology and articulate how some community tools and resources may serve to combat these limitations 3 1 commonalities and distinctions from previous typologies although our literature review found a number of agent types in common with the classification scheme previously developed by akhbari and grigg 2015 such as agricultural and domestic water users it also revealed additional agent types that may play important roles within specific water resources systems and in synthesizing modeling results across systems in particular the additional agent types that emerged from our literature review were classified as reservoir managers interest groups and economic institutions although regulatory agents are represented in almost a quarter of the reviewed abms there were limited examples of how various governance structures or regulatory mechanisms affected the hydrologic state of the system but see rathwell and peterson 2012 governance is more complex than one set of static rules and key management decisions can irrevocably alter future system configuration e g systems are path dependent representation of actual network structure could be important for evaluating adaptation coordination and conflict resolution chaffin et al 2016 newig et al 2010 rathwell and peterson 2012 but was not present in the reviewed literature even though more realistic governance structures can be represented by hierarchical multi level networks kenbeek et al 2016 representing various policy scenarios may be sufficient for some modeling purposes but further examination into how social networks and policy cycles impact the regulatory aspect of water management would certainly create more robust models of how these agents influence the hydrologic cycle ellison 1998 koontz and newig 2014 representing individual decision making in reservoir operations is an important source of variability in these systems because operational targets only serve as a guide and are not codified law us army corps of engineers 1985 reservoirs represent large pools and fluxes of water and thermoelectric power generation in the u s accounts for 41 of freshwater withdraws dieter et al 2018 yet reservoir managers and economic agents are not commonly incorporated into current water resources abms this is likely due to the tendency to model these influences using hydro economic models see harou et al 2009 for a review or system dynamics models to optimize reservoir operations ahmad and simonovic 2004 2000 king et al 2017 or other operational models for reservoir system management riverware zagona et al 2001 wrap wurbs 2005 which are grounded in optimization methods that do not generally include variable information availability or non rational decision making reservoir managers do have to follow predetermined guidelines and rule curves but they are influenced by their understanding of the system individual biases and state of the system patterson and doyle 2018 factors unexplored by the reviewed papers for example van oel et al 2012 use an empirical data set on reservoir releases instead of implementing autonomous decision making in the u s patterson and doyle 2018 determined the occurrence and magnitude of departures from operational targets by comparing the rule curves from water control manuals to actual reservoir outflow this type of dataset could be particularly valuable for validating abms that aim to capture this variability interest groups and water utilities represent a heterogeneous set of organizations and representing them using functional types would help more clearly define how their different objectives integrate with other actors in a water resources system the original aft concept as defined by rounsevell et al 2012 and arneth et al 2014 uses attributes to classify and combine types of individuals and their respective influence on the system agricultural agents were the agent type most commonly represented by multiple instances within one model e g farming practices have been aggregated as profit oriented multi functionalist traditional hobbyist or part time and business oriented holtz and pahl wostl 2012 karali et al 2013 similarly we identified that the main mechanism that interest groups affect water resources is through communication with their associated constituents and regulatory agents e g advocacy coalition framework ellison 1998 they could therefore be classified using functional types that represent their economic orientation e g economic non economic profit nonprofit or that represent their domain of interest e g business labor agriculture or environment or other aspects of their operation such as size of membership or amount of funding all of which would make the scale and mechanism of their impact clearer water utilities also have a diverse set of attributes which could be used to designate functional types for example public water systems are designated based on population served and duration of service while other ownership types include municipal investor owned conservancy district cooperative not for profit and regional water districts the variability in utilities could impact operating procedures growth and water pricing these examples highlight the utility of creating functional types for each agent type as they can capture and synthesize agent variability in a way that makes model building more tractable as described briefly in the methods we explicitly omitted agent types representing stores and fluxes of water cai et al 2011 bithell and brasington 2009 our rationale for this omission is that these are not agents in the canonical sense but instead correspond to the encoding of one or more physical processes that govern the redistribution of water in the hydrologic system as an agent this may be convenient within particular abm software and for some research questions because it presents a relatively straightforward way to capture some nonlinear attributes of hydrologic systems however it potentially masks the complexities of the natural systems to which human systems are coupled and may impede model transferability by obscuring the pathways through which a more sophisticated hydrologic process model might be substitute for a natural system agent 3 2 typologies can clarify agent roles while maintaining flexibility in agent behavior modeling cnh systems requires careful consideration of how to best operationalize individual and collective decision making one unrealized merit of agent typologies is that they help partition the role of an agent in the water resources system from the various theoretical assumptions about human behavior used to model how they enact their role thereby allowing for analyses of these different theoretical approaches specifically an advantage of abms is their ability to flexibly incorporate heterogeneity in behavior and decision making however this flexibility has resulted in a lack of consistency in how decision making is captured in different models and inadequate grounding in established theory groeneveld et al 2017 furthermore until recently theoretical motivation of model development too often relied exclusively on the rational actor model schlüter et al 2017 in constructing our agent typology we chose not to specify particular theoretical approaches but rather to identify a number of important influences on behavior that apply to all agent types and should likely be considered in model building including learning from previous experience information transmission and learning from others environmental interactions and economic factors one synthetic yet relatively under appreciated approach to conceptualizing behavior in coupled models is the cultural evolutionary perspective cultural evolution is the process by which certain ideas and beliefs spread at the expense of others via learning and imitation boyd and richerson 1985 a broad body of theoretical work in the field of cultural evolution has identified the learning strategies e g imitate the most successful imitate the majority that are likely to evolve under environmental uncertainty and their population level outcomes mesoudi 2011 this perspective thus specifies the social processes that are needed to explicitly model the co evolutionary dynamics of cnh systems e g adaptation under environmental uncertainty and therefore could be useful in the field of socio hydrology which seeks to specifically understand these co evolutionary processes sivapalan et al 2012 models operationalizing behavior using a cultural evolutionary perspective have had productive impact in the contexts of sustainability waring et al 2015 land use change ellis et al 2018 environmental management baggio and hillis 2018 but only recently have scholars explicitly applied cultural evolutionary ideas to a water resources management model yu et al 3 3 limitations of the typology approach and paths forward in water resources entities and or individuals may have more than one functional role in the system which means they would belong to more than one of our agent types for example water districts in idaho represent interests of irrigators to state and federal management agencies i e interest group agent determine the flows of water through the canals in their district i e agricultural agent and are governance units as designated by the state idaho department of water resources i e regulatory agent simplifying this type of real world complexity while capturing the essential components of the process of interest is a common difficulty in the realm of cnh modeling it is necessary therefore to determine which of the potential roles is most important for the particular question being developed and or explicitly state how the agent is affecting pools and fluxes through the specific roles associated with their agent type e g they could enforce regulations via their control over the delivery of water the illustrates the reality that any typological classification will suffer from overlapping boundaries between classes and imperfect discrimination of the population into distinct groups future work would benefit from empirical studies characterizing individuals within each agent type much like the afts created for land owners in blanco et al 2015 these types of empirical studies could elucidate whether and how the functional roles of agents within the same type change from one location to another further work should strive to identify the frequency and form of information that impact decisions which would improve our understanding of what information is needed as input into abms several practices employed by some of the reviewed papers could serve to address key weaknesses of a typological approach for agent specification basic documentation for example of abms is imperative for reproducibility and transferability of cnh models citepschultze2017 description of key attributes such as geographic extent and resolution of both social and biophysical components provide first order information about the nature of the science questions and model itself this basic information was rarely included in the reviewed manuscripts and often challenging to find when it was included the agent aggregation scale captures the degree to which an agent represents an individual an organization or a collection of like organizations documenting this aggregation scale can assist in understanding whether the simulated agent behavior parameterizes for instance just the preferences of an individual actor or potentially a complex set of policy decisions made by a large bureaucratic entity adoption of documentation protocols specifically tailored to abms would further assist in documenting agent roles and behaviors and presumably aid in model reproducibility and transferability one challenge with evaluating abms or system models in general is the inherent complexity of modeling both social and environmental systems the need for documenting additional details about human decision making was highlighted and appended to the odd by müller et al 2013 to include more details about the empirical or theoretical reasoning behind the choice of decision making models odd d because the model development process is iterative grimm et al 2014 proposed a standard format and terminology for documenting models and improving their transparency much like a lab or field notebook trace transparent and comprehensive ecological modeling documentation adoption of these protocols could further the culture of good modeling practice such as in the community surface dynamics modeling system hutton et al 2014 peckham et al 2013 the utility of these protocols had already been demonstrated by the comses network openabm computational model library which supports the reproducibility and reuse of over 500 abms comses net in addition to abm specific protocols unified modeling language class diagrams are a tool that can help modelers more clearly document the agents being simulated and their specific roles in the system class diagrams require model developers to explicitly and visually document what attributes agents possess how those agents interact with other agents and the specific functions they can perform fowler and scott 1993 the types of agents used in each model were most clearly diagnosed in the papers that used class diagrams e g barnaud et al 2008 becu et al 2003 the abm community has continued to highlight the need and desire to document share and increase reusability of model components yet a panacea remains ellusive and will likely require continued community development and dialog toward adoption of standardized terminologies in deploying water resources abms bell et al 2015 janssen 2017 schulze et al 2017 although imperfect we contend that water agent typologies when coupled with key practices for documenting agent and model descriptions should aid in determining which agents are the most essential to represent for a particular water quality quantity problem more systematic efforts to document water abms can for instance aid in understanding how and why specification of agent behavior differs between two studies that involve the same agent type it can also provide guidance for model developers as where their treatment of specific agent types departs from similar studies either because of location science question or scale credit authorship contribution statement kendra e kaiser conceptualization data curation formal analysis methodology visualization writing original draft writing review editing alejandro n flores conceptualization funding acquisition investigation writing original draft writing review editing vicken hillis data curation investigation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments funding for this work was supported by idaho epscor iia 1301792 and alejandro flores nsf career award ear 1352631 we also thank the reviewers for their insightful comments and feedback on the manuscript this work was also supported by u s department of energy office of science as a part of research in multisector dynamics earth and environmental system modeling program 
26029,modeling coupled social and biophysical dynamics of water resources systems is increasingly important due to population growth and changes in the water cycle driven by climate change models that explicitly represent these coupled dynamics are challenging to design and implement particularly given the complicated and cross scale nature of water governance agent based models abms can capture human decision making and nested social hierarchies however transferability is made difficult by location specific details a consistent description of water resources decision makers individuals groups agencies would advance the rate of model development and increase synthesis across systems reviewing water resources abms we propose eight agent types and associated operational roles that modify the storage redistribution and water use in a system application of the proposed typologies and use of best practices in model documentation will support systematic design and development of transferable scalable water resources abms and facilitate the dynamic coupling of social and biophysical process modeling keywords agent based modeling water resources social ecological systems data availability the dataset generated for this study can be found in hydroshare kaiser k e a flores v hillis 2018 literature review of water resources agent based models hydroshare 1 introduction the capability to simulate the dynamic coupling between human activities and the water resource systems on which they depend is critically important in the context of long term stressors such as climate change land use intensification population growth and urbanization in particular humans impact and are impacted by the availability and quality of water resources from local to global scales the feedbacks involved in this reciprocal relationship create a multiscale dynamically coupled natural human cnh system globally water withdrawals are increasing 2500 to 4000 km3 yr 1 from 1971 2010 but sectoral trends in water withdrawals vary across regions for a variety of reasons including increasing water use efficiency population growth and urbanization huang et al 2018 meanwhile the availability of water impacts a range of societal decisions such as where to build and how to insure structures in floodplains the type of crops to plant water use restrictions in urban areas trans boundary water transfers and infrastructure development dubbelboer et al 2017 ahmad and prashar 2010 sehlke and jacobson 2005 jeuland et al 2014 anthropogenic climate change and the associated intensification of the global hydrologic cycle huntington et al 2018 are hypothesized to lead to increasing global average precipitation with large variability in regional trends bates et al 2008 determining how climate change will affect this multiscale cnh system will be critical to assess potential adaptation strategies agent based models abms are particularly useful for coupling models of human systems and the hydrological systems with which they are integrated using abms to model cnh systems has become popular in part because of their flexibility in how they represent interactions among human actors and between humans and natural systems in the realm of water resources humans have modified hydrologic systems to meet demands for irrigation industrial use and domestic drinking water these modifications directly impact hydrologic states and fluxes like river discharge groundwater table elevation and soil moisture in addition to the complexity of natural hydrologic systems humans have developed complicated socioeconomic political physical and cyber infrastructure to coordinate decision making and management of these water resources despite the flexibility of abms for capturing complex interactions between humans and hydrologic systems it appears that abms have not been adapted for water resource system analysis with the same frequency as they have in modeling land use and land cover change e g see extensive reviews matthews et al 2007 d aquino et al 2002 groeneveld et al 2017 potential barriers to adoption of abms in water resources might include a the highly complex and heterogeneous spatio temporal processes associated with water resource systems across locations b significant prior work using alternative classes of models that integrate human behavior and decision making with biophysical models of the environment e g hydroeconomic socio hydrology systems dynamics c the often simplistic way human influences on water systems have typically been represented in models of hydrologic systems and d the lack of consistency in documentation description implementation availability and transferability of code groeneveld et al 2017 the development of agent functional types afts has emerged in the land use change modeling community as a vehicle to address issues of actor heterogeneity while increasing the transparency of agent representations and simplifying model development arneth et al 2014 analogous to plant functional types afts characterize heterogeneity through common agent attributes e g socio demographic or economic attributes spatial data such as irrigated acres and crop type and common preferences associated with their objectives which guide their decision making e g preferred management practices blanco et al 2015 developing afts for water resource systems could help address the barriers to application of abms identified above potentially leading to new insights about the emergent properties of inextricably coupled human hydrologic systems one challenge to identifying water resource afts however is the hierarchical and cross scale nature of water resources management developing afts for water resource systems requires a broader framework for capturing the diversity of water management actors a water resource agent typology would represent the operational roles of individuals or organizations and specifically identify how an agent influences water quantity or quality by altering the redistribution of water in the landscape either directly or through interactions with other actors although the individuals and structure of between actor relationships will change across systems the roles and observational information used by water managers or individual users will be relatively consistent e g snow water equivalent forecasted precipitation groundwater levels etc here we propose a typology for water resource management actors that can facilitate more transparent transferable and comparable abms of water management systems our agent typology is based upon a review of 54 published studies that apply abms to water resource systems from these prior studies we identify common water resources agent types across systems define their roles associated input output variables and potential social interconnections the typology is useful because the agent types allow expedited identification of agents to include in coupled water resources models aid in the representation of nested social and institutional structures simplify coupling with models of the biophysical system increase the transferability and synthesis of models across systems and potentially enable development of regional scale cnh models of water resources this agent typology would lay the foundation for more specific functional types to be developed within each type of agent e g farmer and forest afts valbuena et al 2008 blanco et al 2015 in addition to developing a classification of agent types that emerges from the literature we also investigated specific practices employed by model authors that allow for enhanced model reuse transferability and extensibility we explore some potential practices that if broadly adopted would make abms of water resource systems 1 more portable and reusable 2 more rapidly configurable for specific locations and 3 facilitate improved comparison and synthesis across sites and studies 2 analysis of water resources agent based models we conducted a literature review of water resources abm papers allowing us to systematically identify common water resources agents we used the web of science to find water resources abms by using the following search terms water manage typ abm water grimm et al 2010 and grimm et al 2006 with water agent we also identified additional papers from citations of those initial papers and associated software platforms studies that did not have sufficient model description to characterize agents and associated roles or those that were theoretical modeling experiments e g not location or implementation based were excluded the limited number of abms that remained after these exclusion criteria compelled us to find additional papers through the initial papers citation lists software platforms and the follow up papers to grimm et al 2010 and grimm et al 2006 we did not exclude abms from non peer reviewed reports or theses as these abms were often well documented implementation based abms the final literature to be reviewed included 54 papers covering locations across the globe spanning europe 16 asia 11 north america 10 africa 7 south america 5 the middle east 2 and oceania 3 the exclusion criteria inevitably reduced the review to a small fraction of the total abm water resources literature the most common reason for excluding a paper was due to it being based on a hypothetical location population papers were also excluded if they were variants on hydroeconomic models that did not include explicit agents with attributes and functions or if they described the process of developing an abm but not the model itself in a few instances a paper would present an abm but the documentation of the agents was so poor that we were unable to determine the specific function of agents in the model it is plausible that this subset biases the estimate of the fraction of each agent type that exists in the literature overall or the percent of models that use various documentation techniques aside from this potential bias our reviewed literature does capture a range of abms based on real locations across 33 journals and reports 2 1 documenting common practices we gathered basic information about each publication including the journal year of publication and department of first author environmental modeling and software was the most common venue for publication of water abms with a total of 10 papers another 6 journals had published between 2 4 papers and 26 other journals or non peer reviewed venues published a single water resources abm we also grouped the department or administrative home of each first author into 9 categories as a mechanism of assessing the disciplinary cross section of authors contributing to the water abm literature the disciplinary nature of contributions to the literature is diverse although engineering and environmental sciences departments were the most common 43 and 22 respectively in reviewing each paper we also documented the use of a number of tools and frameworks meant to make abms specifically and computational models generically more transparent transferable and reusable of particular interest was the use of class diagrams for illustrating agent characteristics and interrelationships fowler and scott 1993 making model code open source and the use of the overview design concepts and details odd protocol grimm et al 2006 2010 for documenting abms the odd protocol was created as a common structure for describing abms which stresses the importance of standardized descriptions to assure models are described completely and consistently although 9 of the papers were published prior to the odd protocol the majority of papers reviewed did not use the odd protocol class diagrams or make their source code open fig 1 of the 12 papers that did apply odd the relevant information for characterizing the model was not always presented for example only 3 papers that used odd identified both spatial and temporal extent and resolution of the study area and the total number of agents modeled the most recent year in the analysis 2017 was the year associated with the largest number of water abms published which suggests that abms are an increasingly common tool being used in water science 2 2 classification of water agent types we documented the agents reported in each manuscript and grouped them by the characterization scheme provided by akhbari and grigg 2015 these agent types included urban domestic industrial agricultural regulator environmental hydropower and recreation after reviewing the roles of each agent type we modified the akhbari and grigg 2015 classification scheme first rather than having a functional type that specifically represents hydropower generation we broadened the scope to include all dam managers this enables representation of individual dam operation objectives through attributes of a given dam manager secondly we grouped recreation agents into a broader interest group agent to reflect that recreation agents are one type of interest group that communicates a range of desires from constituents to regulatory agents finally we retained the environmental agent for coding agents in the reviewed literature that represent environmental stores and fluxes but do not include them in our final agent typology because they do not represent individuals that make decisions about water resources in addition to modifying agents we also added two new agent types that were represented in numerous abms utilities 7 and economic agents 11 our final agent types include agriculture regulatory domestic industrial commercial utilities interest groups reservoir managers and economic agents the most common agent types found in the literature were agricultural regulatory and domestic users fig 2 within each agent type we documented associated roles used in each model table 1 fig 3 these operational roles encapsulate the mechanisms by which each agent type influences water quality or quantity in the system in the following sections we define the role of each agent type each agent s typical attributes and potential connections with other agents fig 4 2 2 1 water users water user agents are most commonly represented as individuals with multiple instances of their agent type being represented within a given model 2 2 2 agriculture the role of the agricultural agent is to withdraw water from the system distribute and apply it to the landscape through irrigation these agents main role is to withdraw water from the system either from surface or groundwater for irrigation purposes table 1 they can also create and maintain structures that transport water to agricultural areas e g canals add new groundwater wells and irrigation systems becu et al 2003 buy and import water barthel et al 2008 and adopt innovations such as irrigation or pumping technology that directly impact their consumption of water holtz and pahl wostl 2012 the agricultural domain is one of the most commonly used functional types in water resources abms fig 2 a wide variety of attributes are typical of agricultural agents which were commonly represented by multiple instances within one model where multiple types of agricultural agents were used to capture a range of attributes in line with the aft concept individual agents commonly have attributes that specify their geographic location and farm size cai and xiong 2017 yuan et al 2017 and socioeconomic or demographic attributes such as income gender farming experience or membership in conservation organization giuliani and castelletti 2013 while aggregate agents might represent organizations such as irrigation districts various attributes define the agricultural enterprise such as on farm non agricultural activities number of wells barthel et al 2008 crop choice and planting date labor force allocation farm business structure holtz and pahl wostl 2005 entrepreneurship and dependence on irrigation resource cai and xiong 2017 source of water kock 2008 van oel et al 2010 2012 or type of farming bah et al 2006 souza filho et al 2008 farolfi et al 2010 espinasse and franchesquin 2005 agricultural agents have attributes that specify how they make decisions potentially including heuristics for accessing processing and sharing information and memory of their previous actions and those of agents within their social network they may also have attributes explicitly defining how they are connected with other agents via for example communication networks 2 2 3 domestic domestic agents consume water for indoor and outdoor residential uses the main role of domestic water users is to consume water for indoor and outdoor residential uses table 1 they are often modeled at the individual or household level which enables their use in modeling population growth and location preferences zellner 2007 berglund 2012 nikolic and simonovic 2015 they can also implement various water saving strategies which occur at the household level such as installation of water saving appliances or adoption of water reuse programs elhay et al 2016 soboll et al 2011 attributes of domestic agents can reflect socioeconomic factors akhbari and grigg 2015 including household and lot size tidwell et al 2012 they also can be characterized by their communication networks which can have important impacts on their knowledge and decision making they can share important information about the state of the hydrological system with their networks as well as receive information from news and media sources e g elhay et al 2016 barthel et al 2008 domestic agents decisions are a function of various attributes including how they learn memory of previous hydrologic conditions or the criteria they use to minimize or optimize use table 2 2 2 4 industrial commercial industrial agents use water for processes such as fabricating cooling washing processing diluting or transporting a product dieter et al 2018 the role of industrial agents is to extract and discharge water treat discharge and trade water quality permits table 1 berglund 2012 zellner 2007 these agents operate at the organizational scale and decisions are often based on allocated permits nikolic and simonovic 2015 akhbari and grigg 2015 the key attributes of these agents relate to the characteristics of the industrial process they are performing and their associated water rights or pollution permits they have important knowledge about their operations including the quantity and quality of water entering and leaving past allocation rules water rights and assimilative capacity of the system akhbari and grigg 2015 various spatial attributes determine their interactions with the hydrological subsystem including their geographic location the source of their water and the location of their discharge they can have important communication networks in particular in the realm of communicating with other agents about water quality standards being surpassed or to buy water quality permits various attributes determine how they make decisions typically focused on minimizing costs which are a function of regulatory restrictions and fees in addition to demand for their good service itself a function of local and global markets table 2 2 2 5 water providers water providers make decisions about timing and magnitude of water distribution in a given system they are commonly represented as a single agent type but could include multiple instances of a given agent in a large enough modeling domain e g multiple municipalities 2 2 6 regulator regulators are agents that create or enforce local state or federal policies these agents encompass both policy makers who create rules and regulations and the administrators that enforce them regulators allocate water and permits record violations enforce associated penalties and can develop large scale infrastructure table 1 noël and cai 2017 tidwell et al 2012 bakarji et al 2017 berglund 2012 kock 2008 berger et al 2007 they exist at different scales federal state council of governments county municipality and can potentially affect all actors within their regulatory boundaries while their actions generally occur at the institutional level their decisions can be influenced by the individual biases that are attributes of the individuals occupying the roles regulatory agents like agricultural agents also operate across a particular geographic jurisdiction an important set of attributes relates to their knowledge of the system and their ability to monitor it they may have knowledge pertaining to water rights past allocation rules memory of historic hydrologic conditions water quality data and important environmental data such as snow water equivalent in the snowpack or forecasted streamflow because of their foundational presence in the system regulatory agents have communication networks and these networks impact their relationships with almost all other agents in the region they also have attributes that govern how they make decisions including heuristics based on established regulations public opinion profit and perception of environmental conditions table 2 public opinion could be a component of their decision making through the influence of interest groups and profit would capture the influence of fees fines and financial resources their perception of environmental conditions could be based on data they obtain from the system or indirect information that they receive through other individuals akhbari and grigg 2015 types of regulation can be represented as command and control e g zoning and strategic planning or incentive based the rules and regulations could be parameterized based on constrained optimization problems bakarji et al 2017 or actual regulations obtained from local state or federal agencies 2 2 7 water utilities water utilities are public or privately owned organizations that obtain treat and deliver water to service connections in order to provide uninterrupted supply of safe pressurized drinking water utilities control large distribution systems construct and maintain infrastructure identify new water resources and set water prices idwr 2018 these agents generally function at the organizational level the most common way water utilities have been included in water resources abms is in implementing and enforcing water use restrictions table 1 attributes of water utilities include information on their customer base number of people they serve and the timing of that service characteristics of the water source supply area withdraw limits attributes of the organization itself such as ownership and management baietti et al 2006 and affiliated water supply companies and transboundary transfers barthel et al 2010 water utility agents also have important knowledge of the hydrological system including current and projected future water needs this knowledge informs their decision making about the development of new infrastructure and implementation of water use restrictions their decision making is typically based on profit maximization projection of future development regulations operational targets and technological advances table 2 they also have communication networks that shape how they transmit information about conservation goals and water use restrictions to users as well as to relay warnings or use restrictions barthel et al 2010 they can also serve as communication intermediaries between regulatory agents and users 2 2 8 reservoir management reservoir management agents represent reservoir operations which control the timing and amount of reservoir outflow rather than using hydropower as an independent agent which was common in the literature review akhbari and grigg 2015 kock 2008 giuliani and castelletti 2013 we posit that a reservoir manager has a unique role in water management which could represent the interest and knowledge of agents from private federal or state owned reservoirs table 1 the fundamental attributes of a reservoir agent include both the characteristics of the reservoir and characteristics of the manager themselves reservoir attributes include the type of dam e g run of river total capacity live dead storage number of turbines energy demand and pricing akhbari and grigg 2015 and potential exposure to litigation kock 2008 while attributes of the manager might include things such as risk aversion and memory of historic hydrologic conditions and associated management these attributes impact decision making which are often represented as operational targets from the regulatory agent and maximization of hydropower generation their decisions will also be based on historical operations of the dam and profit margins table 2 reservoir managers have specific objectives that they may be optimizing for such as flood control late season irrigation releases or consistency in hydropower production bpa et al 2001 this requires coordination among government agencies regulatory agents private dam owners water utilities economic agents agricultural agents or interest groups and the reservoir manager 2 2 9 other water actors these other water actors are examples of groups that may have significant influence over the use and management of water in a given system they can increase communication between agents or provide financial support 2 2 10 interest groups the interest group agent includes individuals or organizations that use various mechanisms to impart behavioral change in the system the role of interest group agents is to impart influence in the system via education and outreach to influence public opinion or through advocating for government and industry to change regulations and policies table 1 they can represent environmental ngos tribal communities recreational users the agricultural sector or taxpayers in general e g thoyer et al 2001 as such they might operate at the organizational scale but they can influence individuals within other agent types or at the institutional organizational level in regard to policies and regulation as dictated by the regulatory agent they can serve as a watchdog by monitoring compliance with regulation as an enabler by providing resources crosman 2013 serve as experts by using science to inform decisions or via mediation islami 2017 act as managers in specific projects or disseminate information specific attributes of an interest group agent will depend on the role that the interest group plays in the system interest groups make decisions based on the state of the environment and the satisfaction levels of other agents as such they monitor both the state of the environmental system but also the state of the social one they can share information with their stakeholders and can also report information about other users to regulatory agents 2 2 11 economic institutions economic agents manage capital invested in the water sector to either reduce water related risks or increase capital gains from water related investments the role of economic agents is to manage capital invested in the water sector and provide information to other agents about the economic state of the system table 1 economic agents can also create private and public water markets sell insurance e g flood or oversee water banking ghosh et al 2014 taxes subsidies infrastructure investments dadson et al 2017 fines transaction costs and conservation rate structures michelsen et al 1999 mulligan et al 2014 the most important attributes of economic agents relate to their ability to manage capital and interact with other agents in ways that impact water flows as such their international network is one of their most important attributes this network can be diverse and far reaching including both direct e g providing flood insurance dubbelboer et al 2017 and indirect characterizing the economic state of the system or household water costs rehan et al 2013 2 2 12 relationships and feedbacks a critical aspect of complex systems is the existence of feedbacks among actors and the environment which can create emergent properties or characteristics of the system that are difficult to predict from a consideration of the parts in isolation feedbacks occur when an initial change to one part of the system has an impact elsewhere and that impact creates a new consequence for the agent that imposed that initial perturbation an agent typology potentially aids in understanding feedback mechanisms and the components of the coupled human environmental system through which they connect we provide one example that illustrates how agent typologies might be used to identify potential feedbacks for more targeted study in this example fig 5 reservoir managers make decisions that impact streamflow through release of water which reduces storage of surface water for irrigation later in the season the decisions made by the reservoir agent balance the competing demands for minimum streamflow set by the regulator and for water storage deeded through water rights to agricultural agents agricultural agents make irrigation decisions that influence decisions made by reservoir manager and both streamflow and groundwater levels the regulator monitors environmental conditions and water users and may have to enforce regulations through this feedback mechanism the agricultural agents in this system are influencing the behaviors and decisions of the reservoir manager and the regulator through their individual and collective action as communicated by streamflows and groundwater levels 3 discussion insights from review of agent types the agent typology that emerges from our review of the literature is a framework that can support more rapid development of water abms greater ability to compare water abm studies and enhanced capability to integrate abms and hydrologic models while there are clear commonalities with previously developed agent typologies we found additional agent types in the literature that may play significant roles in the management of water resources below we elaborate on why those agent types may be significant to include in a typology and articulate how some community tools and resources may serve to combat these limitations 3 1 commonalities and distinctions from previous typologies although our literature review found a number of agent types in common with the classification scheme previously developed by akhbari and grigg 2015 such as agricultural and domestic water users it also revealed additional agent types that may play important roles within specific water resources systems and in synthesizing modeling results across systems in particular the additional agent types that emerged from our literature review were classified as reservoir managers interest groups and economic institutions although regulatory agents are represented in almost a quarter of the reviewed abms there were limited examples of how various governance structures or regulatory mechanisms affected the hydrologic state of the system but see rathwell and peterson 2012 governance is more complex than one set of static rules and key management decisions can irrevocably alter future system configuration e g systems are path dependent representation of actual network structure could be important for evaluating adaptation coordination and conflict resolution chaffin et al 2016 newig et al 2010 rathwell and peterson 2012 but was not present in the reviewed literature even though more realistic governance structures can be represented by hierarchical multi level networks kenbeek et al 2016 representing various policy scenarios may be sufficient for some modeling purposes but further examination into how social networks and policy cycles impact the regulatory aspect of water management would certainly create more robust models of how these agents influence the hydrologic cycle ellison 1998 koontz and newig 2014 representing individual decision making in reservoir operations is an important source of variability in these systems because operational targets only serve as a guide and are not codified law us army corps of engineers 1985 reservoirs represent large pools and fluxes of water and thermoelectric power generation in the u s accounts for 41 of freshwater withdraws dieter et al 2018 yet reservoir managers and economic agents are not commonly incorporated into current water resources abms this is likely due to the tendency to model these influences using hydro economic models see harou et al 2009 for a review or system dynamics models to optimize reservoir operations ahmad and simonovic 2004 2000 king et al 2017 or other operational models for reservoir system management riverware zagona et al 2001 wrap wurbs 2005 which are grounded in optimization methods that do not generally include variable information availability or non rational decision making reservoir managers do have to follow predetermined guidelines and rule curves but they are influenced by their understanding of the system individual biases and state of the system patterson and doyle 2018 factors unexplored by the reviewed papers for example van oel et al 2012 use an empirical data set on reservoir releases instead of implementing autonomous decision making in the u s patterson and doyle 2018 determined the occurrence and magnitude of departures from operational targets by comparing the rule curves from water control manuals to actual reservoir outflow this type of dataset could be particularly valuable for validating abms that aim to capture this variability interest groups and water utilities represent a heterogeneous set of organizations and representing them using functional types would help more clearly define how their different objectives integrate with other actors in a water resources system the original aft concept as defined by rounsevell et al 2012 and arneth et al 2014 uses attributes to classify and combine types of individuals and their respective influence on the system agricultural agents were the agent type most commonly represented by multiple instances within one model e g farming practices have been aggregated as profit oriented multi functionalist traditional hobbyist or part time and business oriented holtz and pahl wostl 2012 karali et al 2013 similarly we identified that the main mechanism that interest groups affect water resources is through communication with their associated constituents and regulatory agents e g advocacy coalition framework ellison 1998 they could therefore be classified using functional types that represent their economic orientation e g economic non economic profit nonprofit or that represent their domain of interest e g business labor agriculture or environment or other aspects of their operation such as size of membership or amount of funding all of which would make the scale and mechanism of their impact clearer water utilities also have a diverse set of attributes which could be used to designate functional types for example public water systems are designated based on population served and duration of service while other ownership types include municipal investor owned conservancy district cooperative not for profit and regional water districts the variability in utilities could impact operating procedures growth and water pricing these examples highlight the utility of creating functional types for each agent type as they can capture and synthesize agent variability in a way that makes model building more tractable as described briefly in the methods we explicitly omitted agent types representing stores and fluxes of water cai et al 2011 bithell and brasington 2009 our rationale for this omission is that these are not agents in the canonical sense but instead correspond to the encoding of one or more physical processes that govern the redistribution of water in the hydrologic system as an agent this may be convenient within particular abm software and for some research questions because it presents a relatively straightforward way to capture some nonlinear attributes of hydrologic systems however it potentially masks the complexities of the natural systems to which human systems are coupled and may impede model transferability by obscuring the pathways through which a more sophisticated hydrologic process model might be substitute for a natural system agent 3 2 typologies can clarify agent roles while maintaining flexibility in agent behavior modeling cnh systems requires careful consideration of how to best operationalize individual and collective decision making one unrealized merit of agent typologies is that they help partition the role of an agent in the water resources system from the various theoretical assumptions about human behavior used to model how they enact their role thereby allowing for analyses of these different theoretical approaches specifically an advantage of abms is their ability to flexibly incorporate heterogeneity in behavior and decision making however this flexibility has resulted in a lack of consistency in how decision making is captured in different models and inadequate grounding in established theory groeneveld et al 2017 furthermore until recently theoretical motivation of model development too often relied exclusively on the rational actor model schlüter et al 2017 in constructing our agent typology we chose not to specify particular theoretical approaches but rather to identify a number of important influences on behavior that apply to all agent types and should likely be considered in model building including learning from previous experience information transmission and learning from others environmental interactions and economic factors one synthetic yet relatively under appreciated approach to conceptualizing behavior in coupled models is the cultural evolutionary perspective cultural evolution is the process by which certain ideas and beliefs spread at the expense of others via learning and imitation boyd and richerson 1985 a broad body of theoretical work in the field of cultural evolution has identified the learning strategies e g imitate the most successful imitate the majority that are likely to evolve under environmental uncertainty and their population level outcomes mesoudi 2011 this perspective thus specifies the social processes that are needed to explicitly model the co evolutionary dynamics of cnh systems e g adaptation under environmental uncertainty and therefore could be useful in the field of socio hydrology which seeks to specifically understand these co evolutionary processes sivapalan et al 2012 models operationalizing behavior using a cultural evolutionary perspective have had productive impact in the contexts of sustainability waring et al 2015 land use change ellis et al 2018 environmental management baggio and hillis 2018 but only recently have scholars explicitly applied cultural evolutionary ideas to a water resources management model yu et al 3 3 limitations of the typology approach and paths forward in water resources entities and or individuals may have more than one functional role in the system which means they would belong to more than one of our agent types for example water districts in idaho represent interests of irrigators to state and federal management agencies i e interest group agent determine the flows of water through the canals in their district i e agricultural agent and are governance units as designated by the state idaho department of water resources i e regulatory agent simplifying this type of real world complexity while capturing the essential components of the process of interest is a common difficulty in the realm of cnh modeling it is necessary therefore to determine which of the potential roles is most important for the particular question being developed and or explicitly state how the agent is affecting pools and fluxes through the specific roles associated with their agent type e g they could enforce regulations via their control over the delivery of water the illustrates the reality that any typological classification will suffer from overlapping boundaries between classes and imperfect discrimination of the population into distinct groups future work would benefit from empirical studies characterizing individuals within each agent type much like the afts created for land owners in blanco et al 2015 these types of empirical studies could elucidate whether and how the functional roles of agents within the same type change from one location to another further work should strive to identify the frequency and form of information that impact decisions which would improve our understanding of what information is needed as input into abms several practices employed by some of the reviewed papers could serve to address key weaknesses of a typological approach for agent specification basic documentation for example of abms is imperative for reproducibility and transferability of cnh models citepschultze2017 description of key attributes such as geographic extent and resolution of both social and biophysical components provide first order information about the nature of the science questions and model itself this basic information was rarely included in the reviewed manuscripts and often challenging to find when it was included the agent aggregation scale captures the degree to which an agent represents an individual an organization or a collection of like organizations documenting this aggregation scale can assist in understanding whether the simulated agent behavior parameterizes for instance just the preferences of an individual actor or potentially a complex set of policy decisions made by a large bureaucratic entity adoption of documentation protocols specifically tailored to abms would further assist in documenting agent roles and behaviors and presumably aid in model reproducibility and transferability one challenge with evaluating abms or system models in general is the inherent complexity of modeling both social and environmental systems the need for documenting additional details about human decision making was highlighted and appended to the odd by müller et al 2013 to include more details about the empirical or theoretical reasoning behind the choice of decision making models odd d because the model development process is iterative grimm et al 2014 proposed a standard format and terminology for documenting models and improving their transparency much like a lab or field notebook trace transparent and comprehensive ecological modeling documentation adoption of these protocols could further the culture of good modeling practice such as in the community surface dynamics modeling system hutton et al 2014 peckham et al 2013 the utility of these protocols had already been demonstrated by the comses network openabm computational model library which supports the reproducibility and reuse of over 500 abms comses net in addition to abm specific protocols unified modeling language class diagrams are a tool that can help modelers more clearly document the agents being simulated and their specific roles in the system class diagrams require model developers to explicitly and visually document what attributes agents possess how those agents interact with other agents and the specific functions they can perform fowler and scott 1993 the types of agents used in each model were most clearly diagnosed in the papers that used class diagrams e g barnaud et al 2008 becu et al 2003 the abm community has continued to highlight the need and desire to document share and increase reusability of model components yet a panacea remains ellusive and will likely require continued community development and dialog toward adoption of standardized terminologies in deploying water resources abms bell et al 2015 janssen 2017 schulze et al 2017 although imperfect we contend that water agent typologies when coupled with key practices for documenting agent and model descriptions should aid in determining which agents are the most essential to represent for a particular water quality quantity problem more systematic efforts to document water abms can for instance aid in understanding how and why specification of agent behavior differs between two studies that involve the same agent type it can also provide guidance for model developers as where their treatment of specific agent types departs from similar studies either because of location science question or scale credit authorship contribution statement kendra e kaiser conceptualization data curation formal analysis methodology visualization writing original draft writing review editing alejandro n flores conceptualization funding acquisition investigation writing original draft writing review editing vicken hillis data curation investigation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments funding for this work was supported by idaho epscor iia 1301792 and alejandro flores nsf career award ear 1352631 we also thank the reviewers for their insightful comments and feedback on the manuscript this work was also supported by u s department of energy office of science as a part of research in multisector dynamics earth and environmental system modeling program 
