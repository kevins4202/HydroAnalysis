index,text
6190,following the scheme of the groundwater soil plant atmosphere continuum gspac a simple process based model sith simple terrestrial hydrosphere was developed to estimate the dynamics of terrestrial evapotranspiration et at the daily step the input data include net radiation air temperature precipitation leaf area index vegetation type and soil data most of which are readily available locally the model performed well in simulating the dynamics of et and soil moisture over selected fluxnet sites globally the daily 0 25 et and groundwater table depth estimations in year 2005 were determined using available gridded datasets the spatial pattern was reasonable and the range of values corresponded well with other global et and groundwater table depth products in future studies we will produce a long term daily 0 25 global et and groundwater table depth products that spans from 1984 to present by using different input datasets keywords evapotranspiration transpiration soil evaporation soil water hydrologial model priestly taylor 1 introduction evapotranspiration et the sum of evaporation from bare soil canopy interception stores water body sublimation from snow and canopy transpiration through stomata is an important land surface process in climatology and a nexus for terrestrial water energy and carbon cycles fisher et al 2008 jung et al 2010 katul et al 2012 maxwell and condon 2016 about 60 of annual land precipitation is returned to the atmosphere through the et process trenberth et al 2007 and the associated latent heat of vaporization consumes more than 50 of the absorbed net solar radiation trenberth and smith 2009 which affects regional climate seneviratne et al 2006 therefore accurate measurements and estimates of et are crucial to a wide range of problems in hydrology xu and singh 1998 zhu et al 2013 2014 geographical ecology fisher et al 2011 climate change reynolds et al 2000 and practical applications over the past decades a large number of models including simple or empirically derived formulations satellite based algorithms and land surface models see e g wang and dickinson 2012 and clark et al 2015 for comprehensive reviews have been developed to estimate et at different spatio temporal scales and are becoming more and more popular due to their advantages in addressing ecosystem processes over a spectrum of timescales shugart 2000 zhu et al 2013 despite the aforementioned advancement there are still some insufficiencies in parameterizing the basic hydrological processes in these models which in turn limit our capability in accurately simulating the regional global et dynamics clark et al 2015 maxwell and condon 2016 first there is increasing evidence that groundwater table dynamics have important impacts on root zone soil moisture surface runoff generation land atmosphere fluxes and regional climate clark et al 2015 and different methods have been proposed to represent the groundwater table dynamics in land surface models e g york et al 2002 liang et al 2003 maxwell and miller 2005 yeh and eltahir 2005a b niu et al 2007 miguez macho et al 2008 lo and famiglietti 2011 miguez macho and fan 2012a b fan et al 2013 maxwell and condon 2016 however most of these methods are limited to regional scale applications due to large computational and data requirements of their complex representations of groundwater dynamics maxwell and miller 2005 lo and famiglietti 2011 maxwell and condon 2016 thus there is a need to represent the groundwater table dynamics in a parsimonious and computationally efficient way clark et al 2015 other methods often assume that the moisture flux exchange between unsaturated soil column and groundwater occurs at a fixed depth york et al 2002 niu et al 2007 lo and famiglietti 2011 fan et al 2013 which may result in some significant biases in et estimates koirala et al 2014 also groundwater can act as the primary water source for et when groundwater table is shallow york et al 2002 thus it is needed for models to properly quantify the proportion of et from the different water sources e g surface soil layer deep soil layer and groundwater second the plant root depth is not well parameterized by current et models generally most models assumed root depth of only 1 3 2 0 m in forests and 0 6 1 0 m in short vegetation choudhury et al 1998 gerten et al 2004 miralles et al 2011 in fact previous observations revealed widely varying rooting depths and broad associations with biome types i e roots are shallow in boreal biomes and annual crops deep roots are found in arid semiarid and season arid climates jackson et al 1996 canadell et al 1996 schenk and jackson 2002a b thus current models with unrealistically shallow root depths tend to underestimate the capability of the vegetation to resist drought and obtain a spuriously strong impact water stress on plant transpiration nepstad et al 1994 nobuhiro et al 2007 giambelluca et al 2016 giardina et al 2018 also the root distribution has significant influences on the vertical profile of soil water content and groundwater table dynamics jackson et al 1996 the improper representation of root distribution may result in significant biases in simulated soil moisture and groundwater table dynamics thus to accurately estimate et and its different components it is needed to properly depict the basic hydrological processes and the interactions between hydrological processes and vegetation along the groundwater soil plant atmosphere continuum gspac scanlon and kustas 2012 this paper presents a new model sith simple terrestrial hydrosphere that was developed by coupling parsimonious and robust models of gspac to estimate dynamics of terrestrial et and its different components soil evaporation loss of intercepted water and plant transpiration the aims for the model were to a properly represent the groundwater table dynamics and its interaction with soil moisture surface runoff and plant transpiration b reduce the number of parameters and inputs as far as possible and facilitate its application to regional global scale c run on a daily frequency that could capture temporal variation in groundwater table dynamics and soil moisture as well as their constraints on soil evaporation and plant transpiration and d derive a global daily 0 25 et including its different components and groundwater table depth dataset that can be used for studies of the global hydrological cycle to examine the performances of our model we validate model estimates with ground data from 85 fluxnet sites representing a wide range of biomes and climate conditions we also compared the distributions of global et and groundwater table depth estimated by our model with other published studies 2 model description the model known as sith simple terrestrial hydrosphere is designed to estimate terrestrial et by incorporating the well established models of each of the individual hydrological process over land fig 1 the model is run on daily basis and contains six modules in the first module the canopy interception and evaporation loss of incident rainfall are calculated the second module describes the snow accumulation and snowmelt dynamics in the third module the supply of water i e throughfall stemflow and snowmelt is partitioned at land surface between surface runoff and infiltration the fourth module is a two layer soil water balance model that describes the vertical water movement in the unsaturated zone the upper layer z 1 has a depth of 0 0 40 m and the lower layer z 2 extends from z1 to the average root depths of different biomes jackson et al 1996 canadell et al 1996 schenk and jackson 2002a b table 1 supplement 1 it is assumed that soil evaporation is restricted to the upper layer while plant transpiration can extract water from both layers the fifth module is a simple groundwater model that describe the temporal variation of the groundwater table z gw in the unconfined aquifer in this study the groundwater table is defined as the depth at which the soil becomes saturated with water fig 1 finally the potential evapotranspiration pet calculated using the priestley and taylor pt 1972 equation due to its minimal requirements for parameters and input variables is downscaled to actual evapotranspiration based on ecophysiological constraints and water availability the framework of the model separated into input main module and output domains are given in fig 2 a detail description of entire hydrological flux computations is given in the following sections 2 1 rainfall interception loss in sith precipitation p r mm day 1 is divided into rainfall r a fall mm day 1 and snowfall s n fall mm day 1 depending on whether daily mean air temperature is above or below 0 c all precipitation on days with negative daily mean temperature adds to snowpack snowfall interception is omitted due to the lack of proper candidate models miralles et al 2010 rainfalls intercepted by the canopy are evaporated at the potential rate the capacity of canopy to store water s c mm day 1 is defined as a function of biome incoming rainfall r a fall mm day 1 and leaf area index lai kergoat 1998 s c β r a fall lai where β us a dimensionless biome dependent coefficient for the rainfall regime table 1 the fraction of day time consumed by wet canopy evaporation fwet is calculated as kergoat 1998 f wet min χ s c t p 1 where tp mm day 1 is the potential transpiration rate of canopy see below χ is fractional interception occurring during day time which is primarily governed by diurnal variation of precipitation for 50 90 of rainfall occurring during day time the range of χ could be 0 5 0 9 due to diurnal variation of precipitation oki and musiake 1994 here the value of χ is set to be 0 7 daily interception loss ei mm day 1 is then given by e i f wet t p the remaining day time canopy available energy 1 f wet is used for plant transpiration see below 2 2 snowpack water balance for high latitudes and mountainous regions the water balance is largely controlled by snow processes in sith the snow water balance equation is simply expressed as d s w dt s n fall s m e s where sw is snowpack water content mm s n fall is daily snow fall mm day 1 sm is daily snowmelt mm day 1 es is net snow evaporation mm day 1 and t is time index with an interval length of 1 day snowmelt is calculated using the degree day method choudhury et al 1998 s m 1 5 0 0 0 7 s n fall t a where t a is air temperature above 0 c research on snow evaporation and condensation are rather limited gray and prowse 1993 following choudhury and digirolamo 1998 a constant es of 0 15 mm day 1 is used for the duration of snow cover 2 3 surface runoff surface runoff rs mm day 1 is estimated using the soil conservation service scs curve number technique scs 1985 1986 6 r s p net 0 2 v max 2 p net 0 8 v max p net 0 2 v max 0 p net 0 2 v max where p net mm day 1 is the daily flux of water incident on soil surface i e p net p r ei sm and v max mm is the overall soil water retention capacity which can be estimated as choudhury and digirolamo 1998 7 v max i 1 2 θ s i θ a i d i where θ s i m3 m 3 and θ a i m3 m 3 is the saturated and antecedent previous day soil water content for the ith soil layer i 1 and 2 respectively di is the thickness of the unsaturated soil in the ith layer mm in sith the depth of root zone remains constant for each biome but the thickness of unsaturated soil in each layer is variable with time as the groundwater table depth dynamically changes fig 1 thus the thickness of the unsaturated soil in the ith layer di i 1 2 is calculated as 8 d i 0 z gw z m i 1 z gw z m i 1 z m i 1 z gw z m i z i z gw z m i where z i is the depth of the ith soil layer mm zm i is the bottom depth of the ith layer note that for the first layer i 1 the value of zm i 1 is equal to zero and z gw is the groundwater table depth from the surface mm fig 1 as an example when the groundwater table reaches the surface zgw 0 meaning that the whole soil profile is saturated both d 1 and d 2 will be equal to zero and the entire volume of net precipitation p net becomes surface runoff eq 6 the amount of water infiltrating into the soil in mm day 1 is expressed as the minimum of two factors as follows 9 i n min k s 1 p net r s where ks 1 is the saturated hydraulic conductivity of the first soil layer mm day 1 table 2 2 4 soil water balance the vertical movement of soil moisture in unsaturated layers is simulated using a two layer model the infiltration water in mm day 1 was first stored in the top unsaturated layer which subsequently drained to field capacity into the next soil layer allen et al 1998 miralles et al 2011 and the same procedure was used to calculate the vertical flow from the remaining layers until it finally recharges to the underlying groundwater fig 1 here this empirical drainage algorithm is preferred over well known alternatives such as the richards equation richards 1931 due to its simplicity and relatively high computational efficiency for the global scale simulations at every daily time step the soil water content in each unsaturated layer is modelled as 10 d 1 d θ 1 t dt i n t e s t t s 1 t f 1 t d 2 d θ 2 t dt f 1 t t s 2 t f 2 t where θ i m3 m 3 is water content of unsaturated soil in the ith layer i 1 and 2 di mm is the thickness of the unsaturated soil in the ith layer in mm day 1 is the entire volume of infiltration water es mm day 1 is daily actual soil evaporation see below ts i mm day 1 is daily plant transpiration from the unsaturated soil in the ith layer see below and fi mm day 1 denotes the drainage of water out of the ith layer which is estimated as 11 f i t max 0 d i θ i t θ fc i where θ fc i m3 m 3 is the field capacity of the ith soil layer in sith the groundwater table depth determines the number of unsaturated layers in root zone and the thickness of the unsaturated soil in each layer di i 1 2 as well as the position of the interface between the soil and the groundwater fig 1 this is more realistic than assumption of a fixed depth for flux exchange between the unsaturated soil column and the aquifer that adopted by most land surface models clark et al 2015 in addition the water drainage out of the unsaturated zone to groundwater may be available for plant transpiration in sith if the groundwater table extents to the root zone and therefore affects the modelled et 2 5 groundwater mass balance the temporal variation of water storaged in the saturated zone w a mm is expressed as 12 d w a dt f i t r g r sb where i is the index of soil layer that directly drains water to the underlying groundwater fig 1 fi mm day 1 is the flux draining from the ith soil layer to recharge the groundwater eq 11 tr g is plant transpiration from the groundwater when the water table resides in the root zone see below and r sb mm day 1 is the groundwater discharge which is parameterized as niu et al 2007 13 r sb r sb max e f z gw where rsb max mm day 1 is the maximum groundwater discharge when the groundwater table depth is zero and f mm 1 is the e fold depth following niu et al 2007 the values of rsb max and f are set to be 39 mm day 1 and 1 25 10 3 mm 1 respectively then the change in water tabel depth z gw mm is calculated from 14 d z gw dt 1 θ s i θ i d w a dt z m i 1 z gw z m i 1 s y d w a dt z gw z m 2 where i is the index of soil layer where the groundwater table resides θs i and θi is the saturated and current soil water content of the ith soil layer respectively and sy is the specific yield of the unconfined aquifer which is set to be 0 2 in the global simulations due to the dearth of specific yield data for global aquifers niu et al 2007 2 6 potential evapotranspiration the priestley taylor pt priestley and taylor 1972 equation which is a function of available energy and a dimensionless coefficient works well as a potential evapotranspiration pet model for each component flux gerten et al 2004 fisher et al 2008 miralles et al 2011 assuming a homogeneous canopy the potential canopy transpiration tp mm day 1 and soil evaporation ep mm day 1 can be calculated as fisher et al 2008 15 t p α δ δ γ r nc λ 16 e p α δ δ γ r ns g λ where λ is the latent heat of vaporization mj kg 1 δ is the slope of the saturation vapor pressure versus temperature curve kpa k 1 γ is the psychrometric constant kpa k 1 g is the soil heat flux mj day 1 rnc mj day 1 is the net radiation to the canopy and is given by rnc rn rns where rn mj day 1 is the net radiation and rns mj day 1 is the net radiation to the soil rns is calculated according to the beer s law 17 r ns r n exp k r n l a i where k r n is the extinction coefficient which is set to be 0 6 impens and lemur 1969 in sith a constant of value of α 1 26 used so that the pt equation as a pet equation remains intact as originally designed and confirmed fisher et al 2008 when soil heat flux measurements are not available it is calculated as choudhury et al 1987 18 g 0 4 r n exp 0 5 lai the maximum transpiration rate of each soil layer tp i i 1 and 2 depends on the root fraction and soil moisture condition within the layer which is calculated as tiktak and bouten 1992 19 t p i r i θ i θ s i b i 1 2 r i θ i θ s i b t p where b dimensionless is a soil parameter which depends on soil physical properties table 2 θs i is the saturated water content in the ith soil layer ri dimensionless represents the vertical root density at the ith soil layer and θ i is the layer mean water content which is calculated as 20 θ i θ s i z gw z m i 1 θ i z gw z m i 1 θ s i z m i z gw z i z m i 1 z gw z m i θ i z gw z m i where θi i 1 2 is the unsaturated soil water content in the ith soil layer zm i 1 and zm i is the bottom depth of the i 1 th and ith layer respectively z i is the depth of the ith soil layer and z gw is the groundwater table depth fig 1 in sith the vertical root density ri is described by the linear dose response ldr model schenk and jackson 2002a 21 r i 1 1 z m i d 50 c 1 1 z m i 1 d 50 c where d 50 is the depth above which 50 of the root mas is located c is a shape parameter and zm i is the bottom depth of the ith layer fig 1 the values of d 50 and c for different plant function types pfts are presented in table 1 in sith plant can extract water from either the soil or groundwater or both of a specific layer depending on the position of groundwater table fig 1 to conserve the mass balance the total potential transpiration partitioned in the ith layer tp i is further separated into the soil and groundwater components based on the thickness weighted water content the potential transpiration from soil water of the ith layer tp s i mm day 1 i 1 2 is calculated as 22 t p s i 0 z gw z m i 1 z gw z m i 1 θ i z gw z m i 1 θ i z m i z gw θ s i t p i z m i 1 z gw z m i t p i z gw z m i the potential transpiration from groundwater in the ith layer tp g i mm day 1 i 1 2 is calculated as 23 t p g i t p i z gw z m i 1 z m i z gw θ s i z gw z m i 1 θ i z m i z gw θ s i t p i z m i 1 z gw z m i 0 z gw z m i for example when groundwater table is blow the root zone zgw zm 2 the values of tp g i 0 and tp s i tp i i 1 2 and plant transpiration only consumes soil water in root zone and has no effects on the modelled groundwater table when groundwater is within root zone plant transpiration will reduce both the water content of unsaturated soil and the water table depth 2 7 actual evapotranspiration as a result of suboptimal environmental conditions the actual fluxes of plant transpiration and soil evaporation are generally lower than their potential values in sith three reduction factors were used to downscale the potential transpiration tp to the actual value i soil moisture stress f sm ii plant temperature constraint ft and iii the time lost to transpiration due to the wet canopy fraction fwet which is given in eq 2 thus the actual transpiration from the unsaturated soil at the ith layer ts i was obtained as t s i 1 f wet f sm i f t t p s i where f sm i and f t are calculated as june et al 2004 fisher et al 2008 miralles et al 2011 25 f sm i 0 θ i θ wp i 1 θ c i θ i θ c i θ wp i 2 θ wp i θ i θ c i 1 θ i θ c i 26 f t exp t a t opt t opt 2 where θ i m3 m 3 is the soil moisture of ith layer θ c i m3 m 3 is the soil moisture below which plants start to endure water stress for soil layer i laio et al 2001 θ wp i m3 m 3 is soil moisture at permanent wilting point t a c is the daily mean air temperature and topt c is the optimum temperature for canopy transpiration which is defined as the daily air temperature when leaf area net radiation and temperature are high potter et al 1993 for transpiration from groundwater only the constraints of temperature ft and wet canopy fraction f wet are considered the total of volume transpiration from groundwater that caused groundwater table to decline is then calculated as 27 t r g 1 f wet f t i 1 n t p g i where n is the number of layers that contain both plant root and groundwater i e n 1 if z gw z m 1 and n 0 if z gw z m 2 soil evaporation declines as the soil gets dry and is assumed to be affected only by the unsaturated soil water content in the upper layer i 1 thus the actual soil evaporation e s is calculated as 28 e s f sm e p where f sm is given as miralles et al 2011 29 f sm 0 θ 1 θ wp 1 1 θ c 1 θ 1 θ c 1 θ wp 1 1 2 θ wp 1 θ 1 θ c 1 1 θ 1 θ c 1 where θ1 is the unsaturated soil moisture in the upper layer m3 m 3 the values of θ wp and θ c for each layer were calculated using the soil water retention function with the soil water potentials of ψ wp 150 m and ψ c 3 m respectively and data for 11 different soil types are given in table 2 based on the works of clapp and hornberger 1978 and cosby et al 1984 a detail description about soil water stress functions for different soil types was given in supplement 1 3 data and methods 3 1 eddy covariance flux data for model validation the recently released fluxnet2015 dataset http fluxnet fluxdata org data fluxnet2015 dataset pastorello et al 2017 provides an invaluable wealth of flux data complemented by meteorological variables and soil moisture for validation purpose the sites in the fluxnet2015 dataset were selected in such a way that they cover a wide range of vegetation types and climates in addition to this the data needed to span at least one year after a station by station quality check which is defined as following i when the measured energy imbalance net radiation minus latent sensible and ground heat flux exceeds 250 w m 2 the half hourly hourly flux data were treated as missing ii when the data gaps were less than 6 h in a day the missing data was interpolated using linear regression method iii any day that did not have necessary measurements to complete a diurnal cycle was not used in the analysis of model evaluations and iv rainy intervals were masked from the in situ flux datasets as the eddy covariance measurements are less reliable during precipitation events this yielded a total of 84 reliable eddy covariance sites which are located across several continents and cover a large variety of ecosystems table s1 in supplement 2 the energy balance closure across the selected sites ranges from 70 to 99 with a mean of 80 2 and the intercept values range 22 4 to 26 1 w m 2 with a mean of 1 24 10 5 w m 2 table s2 in supplement 2 therefore the processed flux data was qualified and suitable for the purposes of model validations to account for the biased low in situ et measurements due to the energy imbalance at the selected sites 1 30 the directly measured et data were corrected by using the residual energy balance method twine et al 2000 among the selected sites in fluxnet dataset 38 sites also provide in situ soil moisture measurements approximately over the top 30 cm of the soil novick et al 2016 the sites reporting both soil moisture and et measurements were labeled as focus sites table s1 in supplement 1 and used to test model accuracy in simultaneously simulating et and soil water content due to limited observational soil moisture data for deep soil layers we only compared the modeled soil moisture of the first layer θ1 0 20 cm with in situ measurements at the top soil swc1 in the fluxnet2015 dataset for validation purposes in situ measured meteorological variables from the flux towers which include surface net radiation rn w m 2 soil heat flux g w m 2 air temperature ta c and precipitation pr mm day 1 were used to drive the model to simulate et and soil water contents the leaf area index lai required by the model were extracted from moderate resolution imaging spectroradiometer modis product mod15a2h https lpdaac usgs gov myneni et al 2015 at 500 m spatial and 8 day temporal resolution an average of nine surrounding pixels around the fluxnet2015 sites was used to calculate the required lai values data were cleaned by eliminating contamination associated with clouds shadows and snow ice and were interpolated to daily values using the linear interpolation approach zhang et al 2010 the performance of sith model in simulating et and soil water content was evaluated by using the coefficient of determination r 2 slope b 0 and intercept b 1 of the regression line y b 0 x b 1 between the measured x and estimated y values model data mismatch was also quantified using root mean squared error rmse mean bias error mbe and the nash sutcliffe efficiency coefficient nse these were calculated as 30 rmse 1 n t 1 n o t m t 2 31 mbe t 1 n o t m t n 32 nse 1 t 1 n o t m t 2 t 1 n o t o 2 where n is the total number of observations o t is the observed values at time t o is the mean of the observed data and m t is the model predictions at time t the coefficient of determination r 2 describes the degree of co linearity between observed and simulated values and ranges between 0 and 1 with higher values indicating less error variance generally an r 2 0 5 is considered as acceptable performance moriasi et al 2007 for mbe a positive mbe indicates an overall overestimation while a negative mbe indicates an overall underestimation the closer the mbe to zero the better is the model s performance the nse value can range between and 1 0 with a nse 1 being the optimal value moriasi et al 2007 zhu et al 2016 3 2 gridded datasets for global implementation and evaluation for global estimates of et the forcing datasets used to run sith model included precipitation air temperature air pressure albedo incoming shortwave radiation leaf area index land cover and soil type they were derived from various sources and comprised well validated products for precipitation forcing the multi source weighted ensemble precipitation mswep dataset was selected http www gloh2o org beck et al 2017 the mswep dataset is based on a merger of selected satellite reanalysis and gauge based products and is available from 1979 until 2015 at a daily 0 25 spatial resolution the surface meteorological forcing datasets including air temperature pressure and incoming shortwave radiation were derived from the global modeling and assimilation office gmao global modeling and assimilation office 2004 meteorological data at hourly 1 00 1 25 resolution the gmao datasets were also used in the calculation of modis npp gpp and et running et al 2004 mu et al 2007 2011 satellite based inputs including leaf area index albedo and land cover for leaf area index and albedo we used the 8 day 0 05 global land surface satellite glass products http glassproduct bnu edu cn zhao et al 2013 this glass albedo was used to calculate reflected solar radiation and hence the net incoming solar radiation see details in cleugh et al 2007 land cover were derived from yearly 0 05 modis products mcd12c1 https modis ornl gov cgi bin modis global subset pl friedl et al 2002 the land cover data was reclassified into the respective 12 pfts of sith model based on international geosphere biosphere programme igbp classification scheme belward 1996 in addition the required static soil texture dataset was derived from the well regarded fao harmonized world soil database hwsd http www fao org at 0 1 spatial resolution based on the classification of united states department of agriculture natural resources conservation service usda usda nrcs 2004 the soil texture was further divided into 11 different types defined by sith model all the data sets presenting a different spatial resolution are re gridded to a common 0 25 0 25 spatial resolution by means of inverse distance weighted interpolation shepard 1968 the daily series of leaf area and albedo were derived from the 8 day glass products using daily linear interpolation approach zhang et al 2010 the hourly gmao meteorological data were averaged to daily means according to the method proposed by allen et al 1998 to make sure that water cycle variables i e soil moisture and groundwater table depth can reach equilibrium a 100 year spin up was performed by repeating the forcing of the period 2000 2010 10 times starting from the end of the spin up the model was run to generate the global scale soil moisture groundwater table and et products to compare the global et estimated by sith with related et products five additional datasets were incorporated into the evaluation one is the era interim reanalysis product which is produced by the european centre for medium range weather forecasts ecmwf and covers the period from 1979 to present with a horizontal resolution of approximately 0 7 and 62 vertical levels dee et al 2011 the other four are derived from satellite based et products 1 the mod16 et product which is produced based on the most widely used satellite based et model proposed by mu et al 2007 2011 the mod16 et product has a spatial resolution of 1 km and is available with 8 day monthly and annual intervals ftp ftp ntsg umt edu pub modis mirror mod16 the mod16 et is estimated as the sum of evaporation from water intercepted by the canopy transpiration from the dry canopy surface and evaporation from the moisture soil surface and saturated soil surface 2 the gleam global land evaporation amsterdam model product which uses a modified pt equation in combination with an analytical rainfall interception model gash 1979 a soil water module and a stress module to derive actual et based on a wide range of remote sensing observations miralles et al 2011 data have daily 0 25 spatial resolution and span the 2000 2015 period https www gleam eu 3 the pt jpl priestly taylor jet propulsion laboratory product which applies a series of ecophysiological stress factors based on atmospheric moisture and vegetation indices into the pt equation to compute canopy transpiration wet canopy evaporation and soil evaporation fisher et al 2008 the dataset have monthly 1 spatial resolution and span from 1984 to 2006 http landflux org data php 4 the pml penman monteith leuning product which uses the penman monteith pm equation monteith 1965 with a simple biophysical canopy conductance model to calculate transpiration and includes a simple term for soil evaporation while interception loss is estimated separately using gash rainfall interception model leuning et al 2008 zhang et al 2008 this dataset has monthly 0 5 spatial resolution and span from 1981 to 2012 https doi org 10 4225 08 5719a5c48db85 4 results 4 1 validation of in situ et estimates the statistical results for modelled versus measured daily et at all 84 fluxnet sites were presented in table 3 as expected the model performance varies from site to site the slopes b 0 of the linear regression between modelled and measured daily et ranged from 0 50 at ru tks to 1 35 at dk eng with an average of 0 83 while the intercepts b 1 ranged from 0 47 mm day 1 at au das to 1 09 mm day 1 at br sa1 with an average of 0 23 mm day 1 the sith model had an average rmse of 0 74 mm day 1 ranging from 0 29 mm day 1 at ru che to 1 42 mm day 1 at zm mon an average bias of 0 02 mm day 1 was obtained for all sites ranging from 0 61 mm day 1 at cz bk1 to 0 68 mm day 1 at au tum the values of nse ranged from 1 07 at zm mon to 0 80 at cn ham with an average of 0 41 relatively high nse 0 35 were found at 54 sites and low nes 0 were found on at only 5 sites on average the model explained 65 of the variance in measured et across all sites ranging from a low of 23 at zm mon to 88 at ca ns6 further details of model performances in capturing the temporal variations of observed et at different sites were provided in supplement 3 overall the model results generally agreed well with tower observations and captured observed et seasonality and inter annual variability over different sites the scatterplot in fig 3 showed modelled versus observed daily et for all data from all 85 sites and a high correspondence of sith estimates with fluxnet observations were obtained in term of relative high r 2 0 58 low rmse 0 78 mm day 1 low mbe 0 01 mm day 1 high nse 0 54 and regression slope close to one 0 73 thus the proposed model has the skill to capture the daily et over a wide range of plant types and climate conditions noticeably the model displays low values of both r 2 0 50 and nse 0 at some sites of dbf e g zm mon enf ca tp1 and nl loo ebf br sa1 and cn din biomes by examining the model performance at these sites the causes that induced the disagreements between modelled and observed et values were identified and illustrated by the selected sites which were typical in representing each of the different causes first data errors may still exist in the latent heat flux records at some fluxnet sites though great efforts have been made in improving the quality of fluxnet2015 dataset pastorello et al 2017 fig 4 represents an example of the daily time series of sith estimates and fluxnet observations at site ca tp1 which is located on the northern shore of lake erie in southern ontario canada chan et al 2018 during the period from 2002 to 2014 noisy and biased flux observations occasionally occurred and decreased the agreements between the modelled and observed et values similarly noisy and biased latent heat flux observations seemed to be occurred at other sites i e nl loo fr pue see details supplement 3 zhang et al 2010 also reported that an artifact of measurement errors may exist in latent heat fluxes at some fluxnet sites second soil water availabilityfor surface evaporation and plant transpiration in sith model is mainly controlled by the inputs ofprecipitation however significant errors of the in situ precipitation measurements may occur at some sites due to the occasionalmalfunction of precipitationgages dorigo et al 2013 as an example fig 5 illustrated that the soil moisture time series exhibited a typical wetting and consecutive drying of the soil in 2005 at zm mon while no precipitation events were recorded during the corresponding period the errors in precipitation measurements in turn resulted in significant underestimates of et in 2005 at zm mon fig 5 table 3 third irrigation is widely used in arid semiarid cropland ecosystems to reduce plant drought stress by compensating for low precipitation allen et al 1998 siebert et al 2015 because the irrigation data the timing and amount of water applied to crops are typically not available in the fluxnet datasets the soil water inputs from irrigation were not considered here this in turn resulted in some underestimates of et over some cropland ecosystems with irrigations during the dry periods i e at site it bci fig 6 4 2 validation of in situ soil moisture estimates it should be first mentioned that most fluxnet sites relay on time domain reflectometry tdr or capacitance probes for soil moisture measurements novick et al 2016 which generally need a site specific calibration however details of these site specific calibration are not generally available in the fluxnet2015 dataset thus comparisons of modelled and observed soil moisture content should be approached with caution in addition there is always a discrepancy between measured and modelled soil moisture in vertical scale as the model estimates are the average of soil moisture for the surface soil layer 0 0 2 m whereas the measurements are taken at a specific depth of the soil representing the volumetric soil water content at that level table 4 represents the statistical results for modelled versus observed surface soil moisture over the 38 selected fluxnet sites noticeably no local adjustment of soil hydraulic properties was made for model simulations on average the model explains 42 of the variance in measured surface soil water content across all sites ranging from a low of 10 at ru ha1 to 77 at it cpz the value of rmse varies from 0 01 m3 m 3 at au cpr to 0 11 m3 m 3 at de tha with a mean of 0 05 m3 m 3 the average values of nse 0 21 are relatively high indicating that the patterns of temporal changes in soil moisture are well represented over a wide range of land covers and climate conditions the details for the daily time series of surface soil moisture estimated from sith model versus measured data are presented in supplement 3 in most cases the model responds properly to the precipitation events and follows closely the observations during the subsequent dry down phase indicating the proposed soil water draining scheme including both fast and slow draining fluxes between layers is reasonable analogously the causes for the differences between modelled and observed time series of surface soil moisture at some sites were identified as the following first sits with low winter temperature 0 c have temporary conditions of thenear surface soil freeze thaw cycles i e ca qfo ca sf3 fi sod us wcr however our model assumes a uniform soil temperature profile throughout the soil layers that can impose inaccurate representation of the soil freeze thaw cycles thus the predicted soil moisture tended to be unrealistic during the soil freeze thaw cycles in addition the accuracy of instruments to measure soil moisture in frozen soil is much lower than in unfrozen soil mittelbach et al 2012 taking both limitations into account the difference between modelled and observed soil moisture values are expected to be high during the freezing winter and thawing early spring periods at these sites on the contrary the soil moisture is generally simulated with relatively high accuracy in the rest of the year see details in supplement 3 for sites ca qfo ca sf3 fi sod us wcr second natural soil properties are highly variable and heterogeneous in both vertical and all spatial directions within a textural layer elkateb et al 2003 which result in a wide variation in soil hydraulic parameters however we assigned homogeneous soil properties over a specific layer with a set of constant hydraulic parameters in sith model the biases in hydraulic parameters may also affect the simulation results in soil moistures fig 7 illustrates that the temporal pattern of surface soil moisture was adequately captured by the model at site cn du2 however the model tends to overestimate soil moisture during dry season observed soil moisture reached a minimum of 0 046 m3 m 3 while the simulated minimum wilting point was set as 0 139 m3 m 3 for loam soil table 2 third similarly to flux observations in situ soil moisture measurements may also contain errors due to the instrument drifts reduced power supplies and sensor dropouts see details in dorigo et al 2013 for examples a sudden jump in the measured soil moisture were observed at site be vie and it is difficult for us to establish which of the periods i e before or after the jump represents the situation closest to the truth fig 8 at site dk sor see details in supplement 3 the measured soil moisture values hold constant over two long periods which is a typical error in soil moisture observations mittelbach et al 2011 fourth errors in soil water inputs i e precipitation and irrigation also caused the simulated soil moisture to be different from the observed values figs 5 and 6 for zm mon and it bci respectively 4 3 global application the spatial distribution and latitudinal profile of et for 2005 modelled by sith was presented in fig 9 as well as providing five additional global et products into evaluation the spatial pattern was reasonable and the range of values corresponded well with other global et products fig 9 for example the total annual et in 2005 estimated by sith model was 70 8 103 km3 which fell with the range 60 6 103 83 2 103 km3 of the five global et products among them our estimates were very close to the results from gleam 67 4 103 km3 and pt jpl 73 5 103 km3 products but was smaller than that estimated by era interim 83 3 103 km3 and larger than that from mod16 60 6 103 km3 and pml 63 6 103 km3 in addition dirmeyer et al 2006 reported that the mean annual global land et ranged from 58 103 km3 to 85 103 km3 estimated by 15 land surface models participating in the global soil wetness project 2 gswp 2 jung et al 2010 used a data driven model tree ensemble mte algorithm and derived a mean global et of 65 3 103 km3 over the period of 1982 2008 without considering poles and desert regions the latitudinal profiles of annual land et indicated that the equatorial zones had a high et of 1200 mm yr 1 while mid and high latitude zones often had annual et less than 450 mm yr 1 fig 9g also a major distinguishing feature of the model is the detailed estimation of et from different water sources our simulations suggest that et was mostly derived from the surface soil layer fig 10 a the proportion of et from surface soil layer varied between 40 and 90 fig 10b with a global mean of 73 this is mainly due to the fact that at least half of root biomass is found in the upper 30 cm of soil for all vegetations globally schenk and jackson 2002a b the et values from the deep soil layer were relatively high over the tropic subtropical and boreal forests fig 10c the proportion of et from this layer varied mostly between 10 and 30 fig 10d with a mean of 14 groundwater was mainly used by dry tropical savannas temperate savannas and mediterranean shrublands fig 10e and 10f and the mean proportion of et from groundwater was about 5 globally the seasonal variation in et was also well captured by sith model fig 11 the tropical rain forest regions show year round high et values while tropical dry forest and savanna regions show alternate wet march to may mam and december to february djf and dry june to august jja and september to november son seasons the temperate and boreal arctic regions have much higher seasonal variability than the tropics in the northern hemisphere spring mam fig 11a and b is the onset of the growing season et increased and reached a peak in summer jja fig 11c and d in autumn son fig 11e and f et began to drop and reached the minimum values in winter djf fig 11g and h in the southern hemisphere it is the reverse also we examined the accuracy of sith model in estimating the different components of et over different biomes and climate conditions the spatial distribution for the different components was shown in fig 12 as well as providing the ratios of different components to total et transpiration was the dominant component of et and accounted for 76 of annual land et it was the largest in tropic and subtropical forests in south american africa asia island east usa and east china due to the sufficient availability of soil moisture during the plant growing seasons but lowest in steppes of qinghai tibet plateau and major deserts of north africa middle east and middle asia fig 12a and b for other components soil evaporation accounted for 16 of land et and was important in major desert regions where most precipitation was used for e s fig 12c and d the contribution of interception loss accounted to only 8 of land et and it mainly came from tropic subtropical and boreal forests fig 12e and f the global distribution of simulated groundwater water depth was presented in fig 13 the spatial patterns of groundwater table depth simulated by sith corresponded well with previous studies niu et al 2007 fan et al 2013 koirala et al 2014 in general the groundwater table was deeper in arid regions 10 m whereas it was shallower in humid and high latitude regions 5 m in future works a detailed study of the long term trend of global land et and groundwater table dynamics simulated by sith model will be analyzed and we will present related results in the coming papers 5 discussion et remains one of the biggest unknowns within the global water balance miralles et al 2011 improved representation of its dynamics is important to facilitate our understanding of global hydrological cycles carbon cycles and climate change this paper presents a new model sith simple terrestrial hydrosphere that coupled parsimonious and robust models of the gspac to estimate the terrestrial et and its different components the major distinguishing features of the methodology included that 1 the groundwater table dynamic and its influence on soil moisture plant transpiration and surface runoff was explicitly represented in the model based on the framework of the gspac and the proportion of et from the different water sources e g surface soil layer deep soil layer and groundwater can also be quantified 2 the model was built with a full modular structure and new concepts can easily be incorporated in 3 the vertical root distributions and rooting depths of different biomes were quantified based on observation datasets table 1 and the effects of soil water stress on plant transpiration and soil evaporation were properly described by taking into account the influence of soil texture table 2 4 the hydrological processes were represented using parsimonious and robust models the required meteorological forcing data i e air temperature net radiation soil heat flux and precipitation is minimal and the static variables i e soil type and pfts can be easily specified from in situ measurements or existing global datasets this simple strategy allows the application of the methodology not only at a local scale using in situ observations but also at a global regional scale through the utilization of high resolution input data i e satellite retrieved lai land cover etc the two main intermediate products of sith total et and surface soil moisture were compared with in situ measurements and a high correspondence of sith estimations with measurements was obtained over a wide variety of climate and vegetation types it should be noticed that measurement errors in latent heat flux soil moisture and precipitation at some sites may also degrade the statistics of validation in both et and soil moisture estimates fortunately such measurement errors only occurred occasionally and do not significantly affect our modeling results and main conclusions drawn from daily evaluation the estimated daily et against eddy covariance measurements from 85 fluxnet sites had a mean r 2 0 65 rmse 0 74 mm day 1 bias 0 02 mm day 1 and nse 0 41 the statistical results found here were comparable to that of the validations of other et models for example mu et al 2011 reported the daily et estimates had an average r 2 0 60 and rmse 0 90 mm day 1 over 46 fluxnet sites in north america miralles et al 2011 reported an average r 2 0 69 and rmsd 0 30 mm day 1 for daily et estimates based on a sample of 43 flux sites yan et al 2012 reported that daily estimated et had a mean r 2 0 69 rmse 0 77 mm day 1 and bias 0 14 mm day 1 over 19 flux sites the model proposed by fisher et al 2010 have been extensively validated against tower measurements and has proved to estimate realistic daily and monthly et estimates ershadi et al 2014 michel et al 2016 zhu et al 2016 zhang et al 2017 as an example zhang et al 2017 reported an average r 2 of 0 53 and nse of 0 31 for daily et estimates against observations over 44 flux towers the estimated surface soil moisture values were also evaluated at 35 fluxnet sites the results indicated that the temporal variations of the modelled and observed surface soil moisture are in good agreement with a mean r 2 0 42 rmse 0 05 m3 m 3 bias 0 001 m3 m 3 and nse 0 21 across all sites miralles et al 2011 used the soil moisture data from 30 stations of the soil climate analysis network scan schaefer et al 2007 to validate the daily soil moisture estimates and reported a mean r 2 of 0 36 for the surface soil moisture estimates alavi et al 2016 reported that daily surface soil moisture estimates of the soil vegetation and snow svs scheme had an average r 2 0 31 and bias 0 033 m3 m 3 over 130 scan sites overall the proposed model performed relatively satisfactory in both et and soil moisture simulations and no systematic bias for specific biomes or climate conditions has been found globally daily 0 25 sith et simulations in 2005 which were forced using the mswep precipitation data gmao meteorological data and glass land cover leaf area index albedo datasets predicted an annual land et of 70 8 103 km3 which fell with the range 60 6 103 83 2 103 km3 of the five global et products as well as the model range 58 103 km3 to 85 103 of gswp 2 dirmeyer et al 2006 the ratio of transpiration soil evaporation and interception to total et estimated by sith was 76 16 and 8 respectively which is nearly within the scope of previous studies for example jasechko et al 2013 reported that transpiration could account for nearly 80 90 of the total et from continents by using the isotope mass balance method this finding was criticized for overestimating the contribution of plant transpiration and underestimating data uncertainties after counting the input data uncertainties coenders gerrits et al 2014 argued the transpiration portion of et to be lower at 35 80 maxwell and condon 2016 found transpiration accounts for 62 12 of et by considering the influence of lateral ground water flow on et partitioning previous studies reported that soil evaporation accounts for 20 40 of et for croplands and 5 38 of total et for natural vegetation kool et al 2014 the ratio of global soil evaporation to total et estimated by sith is comparable to that 14 reported by miralles et al 2016 based on gleam product until now direct observations on the contributions of canopy loss to total et across different biomes are still relative sparse miralles et al 2010 and estimations were mainly derived from model simulations with a range of 10 24 miralles et al 2016 in addition the spatial patterns of groundwater table depth appeared reasonable and corresponded well with previous studies niu et al 2007 fan et al 2013 koirala et al 2014 note that our current global land et simulations were conducted using a fixed sets of forcing datasets and the errors induced by the choices of different inputs were not explored in future studies we will focus on analyzing the spatial and temporal variation of the global estimates of land et and groundwater table depth over a long time period spanning from 1984 to present based on different sets of forcing inputs also a detailed investigation on the proportion of et from different water sources e g surface soil layer deep soil layer and shallow groundwater will be conducted a main drawback of this study however was that the model assumes a uniform soil temperature profile throughout the soil layers which can impose inaccurate representation of the soil freeze thaw process and adversely impact the predicted soil moisture in winter implementation of a soil heat diffusion scheme is currently in progress to circumvent this potential problem in addition the parameter values can significantly affect the simulations of soil moisture and hydrologic fluxes and may vary with the environmental conditions pfts and other factors zhang et al 2017 at present a set of constant parameters based on previous studies were used in sith without any calibrations to improve model performances there is a need to optimize the model parameters using the multiple observations i e fluxnet data groundwater table depth etc over a wide range of global bioclimatic conditions in future studies zhu et al 2014 zhang et al 2017 6 conclusions in this study a relatively simple model sith simple terrestrial hydrosphere that coupled the parsimonious and robust models of the gspac to estimate the terrestrial et soil moisture and groundwater table depth at the daily time scale has been developed and evaluated it showed good agreement with in situ observed et and surface soil moisture at the fluxnet sites no systematic bias for specific vegetation types and climate conditions has been detected as a physically based hydrological model sith has the potential for implementation at global scales the required input data including net radiation air temperature precipitation leaf area index vegetation type and soil data are readily available the estimated et and groundwater table depth in 2005 by sith captured spatial and seasonal variations at the global scale and favorably compared with other estimations in an ongoing study we will analyze the long term spatial and temporal variation of the global et and groundwater table depth using different forcing input datasets in addition special attentions will be given to properly describe soil freeze thaw processes in future studies declaration of competing interest we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled acknowledgements this work used eddy covariance data acquired and shared by the fluxnet community including these networks ameriflux afriflux asiaflux carboafrica carboeuropeip carboitaly carbomont chinaflux fluxnet canada greengrass icos koflux lba necc ozflux tern tcos siberia and usccc the era interim reanalysis data are provided by ecmwf and processed by lsce the fluxnet eddy covariance data processing and harmonization was carried out by the european fluxes database cluster ameriflux management project and fluxdata project of fluxnet with the support of cdiac and icos ecosystem thematic center and the ozflux chinaflux and asiaflux offices modis lai satellite products were obtained online https lpdaac usgs gov this research was supported by the national key research and development program of china 2018yfc0406602 and national natural science foundation of china grants 41871078 and 41571016 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 123928 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 
6190,following the scheme of the groundwater soil plant atmosphere continuum gspac a simple process based model sith simple terrestrial hydrosphere was developed to estimate the dynamics of terrestrial evapotranspiration et at the daily step the input data include net radiation air temperature precipitation leaf area index vegetation type and soil data most of which are readily available locally the model performed well in simulating the dynamics of et and soil moisture over selected fluxnet sites globally the daily 0 25 et and groundwater table depth estimations in year 2005 were determined using available gridded datasets the spatial pattern was reasonable and the range of values corresponded well with other global et and groundwater table depth products in future studies we will produce a long term daily 0 25 global et and groundwater table depth products that spans from 1984 to present by using different input datasets keywords evapotranspiration transpiration soil evaporation soil water hydrologial model priestly taylor 1 introduction evapotranspiration et the sum of evaporation from bare soil canopy interception stores water body sublimation from snow and canopy transpiration through stomata is an important land surface process in climatology and a nexus for terrestrial water energy and carbon cycles fisher et al 2008 jung et al 2010 katul et al 2012 maxwell and condon 2016 about 60 of annual land precipitation is returned to the atmosphere through the et process trenberth et al 2007 and the associated latent heat of vaporization consumes more than 50 of the absorbed net solar radiation trenberth and smith 2009 which affects regional climate seneviratne et al 2006 therefore accurate measurements and estimates of et are crucial to a wide range of problems in hydrology xu and singh 1998 zhu et al 2013 2014 geographical ecology fisher et al 2011 climate change reynolds et al 2000 and practical applications over the past decades a large number of models including simple or empirically derived formulations satellite based algorithms and land surface models see e g wang and dickinson 2012 and clark et al 2015 for comprehensive reviews have been developed to estimate et at different spatio temporal scales and are becoming more and more popular due to their advantages in addressing ecosystem processes over a spectrum of timescales shugart 2000 zhu et al 2013 despite the aforementioned advancement there are still some insufficiencies in parameterizing the basic hydrological processes in these models which in turn limit our capability in accurately simulating the regional global et dynamics clark et al 2015 maxwell and condon 2016 first there is increasing evidence that groundwater table dynamics have important impacts on root zone soil moisture surface runoff generation land atmosphere fluxes and regional climate clark et al 2015 and different methods have been proposed to represent the groundwater table dynamics in land surface models e g york et al 2002 liang et al 2003 maxwell and miller 2005 yeh and eltahir 2005a b niu et al 2007 miguez macho et al 2008 lo and famiglietti 2011 miguez macho and fan 2012a b fan et al 2013 maxwell and condon 2016 however most of these methods are limited to regional scale applications due to large computational and data requirements of their complex representations of groundwater dynamics maxwell and miller 2005 lo and famiglietti 2011 maxwell and condon 2016 thus there is a need to represent the groundwater table dynamics in a parsimonious and computationally efficient way clark et al 2015 other methods often assume that the moisture flux exchange between unsaturated soil column and groundwater occurs at a fixed depth york et al 2002 niu et al 2007 lo and famiglietti 2011 fan et al 2013 which may result in some significant biases in et estimates koirala et al 2014 also groundwater can act as the primary water source for et when groundwater table is shallow york et al 2002 thus it is needed for models to properly quantify the proportion of et from the different water sources e g surface soil layer deep soil layer and groundwater second the plant root depth is not well parameterized by current et models generally most models assumed root depth of only 1 3 2 0 m in forests and 0 6 1 0 m in short vegetation choudhury et al 1998 gerten et al 2004 miralles et al 2011 in fact previous observations revealed widely varying rooting depths and broad associations with biome types i e roots are shallow in boreal biomes and annual crops deep roots are found in arid semiarid and season arid climates jackson et al 1996 canadell et al 1996 schenk and jackson 2002a b thus current models with unrealistically shallow root depths tend to underestimate the capability of the vegetation to resist drought and obtain a spuriously strong impact water stress on plant transpiration nepstad et al 1994 nobuhiro et al 2007 giambelluca et al 2016 giardina et al 2018 also the root distribution has significant influences on the vertical profile of soil water content and groundwater table dynamics jackson et al 1996 the improper representation of root distribution may result in significant biases in simulated soil moisture and groundwater table dynamics thus to accurately estimate et and its different components it is needed to properly depict the basic hydrological processes and the interactions between hydrological processes and vegetation along the groundwater soil plant atmosphere continuum gspac scanlon and kustas 2012 this paper presents a new model sith simple terrestrial hydrosphere that was developed by coupling parsimonious and robust models of gspac to estimate dynamics of terrestrial et and its different components soil evaporation loss of intercepted water and plant transpiration the aims for the model were to a properly represent the groundwater table dynamics and its interaction with soil moisture surface runoff and plant transpiration b reduce the number of parameters and inputs as far as possible and facilitate its application to regional global scale c run on a daily frequency that could capture temporal variation in groundwater table dynamics and soil moisture as well as their constraints on soil evaporation and plant transpiration and d derive a global daily 0 25 et including its different components and groundwater table depth dataset that can be used for studies of the global hydrological cycle to examine the performances of our model we validate model estimates with ground data from 85 fluxnet sites representing a wide range of biomes and climate conditions we also compared the distributions of global et and groundwater table depth estimated by our model with other published studies 2 model description the model known as sith simple terrestrial hydrosphere is designed to estimate terrestrial et by incorporating the well established models of each of the individual hydrological process over land fig 1 the model is run on daily basis and contains six modules in the first module the canopy interception and evaporation loss of incident rainfall are calculated the second module describes the snow accumulation and snowmelt dynamics in the third module the supply of water i e throughfall stemflow and snowmelt is partitioned at land surface between surface runoff and infiltration the fourth module is a two layer soil water balance model that describes the vertical water movement in the unsaturated zone the upper layer z 1 has a depth of 0 0 40 m and the lower layer z 2 extends from z1 to the average root depths of different biomes jackson et al 1996 canadell et al 1996 schenk and jackson 2002a b table 1 supplement 1 it is assumed that soil evaporation is restricted to the upper layer while plant transpiration can extract water from both layers the fifth module is a simple groundwater model that describe the temporal variation of the groundwater table z gw in the unconfined aquifer in this study the groundwater table is defined as the depth at which the soil becomes saturated with water fig 1 finally the potential evapotranspiration pet calculated using the priestley and taylor pt 1972 equation due to its minimal requirements for parameters and input variables is downscaled to actual evapotranspiration based on ecophysiological constraints and water availability the framework of the model separated into input main module and output domains are given in fig 2 a detail description of entire hydrological flux computations is given in the following sections 2 1 rainfall interception loss in sith precipitation p r mm day 1 is divided into rainfall r a fall mm day 1 and snowfall s n fall mm day 1 depending on whether daily mean air temperature is above or below 0 c all precipitation on days with negative daily mean temperature adds to snowpack snowfall interception is omitted due to the lack of proper candidate models miralles et al 2010 rainfalls intercepted by the canopy are evaporated at the potential rate the capacity of canopy to store water s c mm day 1 is defined as a function of biome incoming rainfall r a fall mm day 1 and leaf area index lai kergoat 1998 s c β r a fall lai where β us a dimensionless biome dependent coefficient for the rainfall regime table 1 the fraction of day time consumed by wet canopy evaporation fwet is calculated as kergoat 1998 f wet min χ s c t p 1 where tp mm day 1 is the potential transpiration rate of canopy see below χ is fractional interception occurring during day time which is primarily governed by diurnal variation of precipitation for 50 90 of rainfall occurring during day time the range of χ could be 0 5 0 9 due to diurnal variation of precipitation oki and musiake 1994 here the value of χ is set to be 0 7 daily interception loss ei mm day 1 is then given by e i f wet t p the remaining day time canopy available energy 1 f wet is used for plant transpiration see below 2 2 snowpack water balance for high latitudes and mountainous regions the water balance is largely controlled by snow processes in sith the snow water balance equation is simply expressed as d s w dt s n fall s m e s where sw is snowpack water content mm s n fall is daily snow fall mm day 1 sm is daily snowmelt mm day 1 es is net snow evaporation mm day 1 and t is time index with an interval length of 1 day snowmelt is calculated using the degree day method choudhury et al 1998 s m 1 5 0 0 0 7 s n fall t a where t a is air temperature above 0 c research on snow evaporation and condensation are rather limited gray and prowse 1993 following choudhury and digirolamo 1998 a constant es of 0 15 mm day 1 is used for the duration of snow cover 2 3 surface runoff surface runoff rs mm day 1 is estimated using the soil conservation service scs curve number technique scs 1985 1986 6 r s p net 0 2 v max 2 p net 0 8 v max p net 0 2 v max 0 p net 0 2 v max where p net mm day 1 is the daily flux of water incident on soil surface i e p net p r ei sm and v max mm is the overall soil water retention capacity which can be estimated as choudhury and digirolamo 1998 7 v max i 1 2 θ s i θ a i d i where θ s i m3 m 3 and θ a i m3 m 3 is the saturated and antecedent previous day soil water content for the ith soil layer i 1 and 2 respectively di is the thickness of the unsaturated soil in the ith layer mm in sith the depth of root zone remains constant for each biome but the thickness of unsaturated soil in each layer is variable with time as the groundwater table depth dynamically changes fig 1 thus the thickness of the unsaturated soil in the ith layer di i 1 2 is calculated as 8 d i 0 z gw z m i 1 z gw z m i 1 z m i 1 z gw z m i z i z gw z m i where z i is the depth of the ith soil layer mm zm i is the bottom depth of the ith layer note that for the first layer i 1 the value of zm i 1 is equal to zero and z gw is the groundwater table depth from the surface mm fig 1 as an example when the groundwater table reaches the surface zgw 0 meaning that the whole soil profile is saturated both d 1 and d 2 will be equal to zero and the entire volume of net precipitation p net becomes surface runoff eq 6 the amount of water infiltrating into the soil in mm day 1 is expressed as the minimum of two factors as follows 9 i n min k s 1 p net r s where ks 1 is the saturated hydraulic conductivity of the first soil layer mm day 1 table 2 2 4 soil water balance the vertical movement of soil moisture in unsaturated layers is simulated using a two layer model the infiltration water in mm day 1 was first stored in the top unsaturated layer which subsequently drained to field capacity into the next soil layer allen et al 1998 miralles et al 2011 and the same procedure was used to calculate the vertical flow from the remaining layers until it finally recharges to the underlying groundwater fig 1 here this empirical drainage algorithm is preferred over well known alternatives such as the richards equation richards 1931 due to its simplicity and relatively high computational efficiency for the global scale simulations at every daily time step the soil water content in each unsaturated layer is modelled as 10 d 1 d θ 1 t dt i n t e s t t s 1 t f 1 t d 2 d θ 2 t dt f 1 t t s 2 t f 2 t where θ i m3 m 3 is water content of unsaturated soil in the ith layer i 1 and 2 di mm is the thickness of the unsaturated soil in the ith layer in mm day 1 is the entire volume of infiltration water es mm day 1 is daily actual soil evaporation see below ts i mm day 1 is daily plant transpiration from the unsaturated soil in the ith layer see below and fi mm day 1 denotes the drainage of water out of the ith layer which is estimated as 11 f i t max 0 d i θ i t θ fc i where θ fc i m3 m 3 is the field capacity of the ith soil layer in sith the groundwater table depth determines the number of unsaturated layers in root zone and the thickness of the unsaturated soil in each layer di i 1 2 as well as the position of the interface between the soil and the groundwater fig 1 this is more realistic than assumption of a fixed depth for flux exchange between the unsaturated soil column and the aquifer that adopted by most land surface models clark et al 2015 in addition the water drainage out of the unsaturated zone to groundwater may be available for plant transpiration in sith if the groundwater table extents to the root zone and therefore affects the modelled et 2 5 groundwater mass balance the temporal variation of water storaged in the saturated zone w a mm is expressed as 12 d w a dt f i t r g r sb where i is the index of soil layer that directly drains water to the underlying groundwater fig 1 fi mm day 1 is the flux draining from the ith soil layer to recharge the groundwater eq 11 tr g is plant transpiration from the groundwater when the water table resides in the root zone see below and r sb mm day 1 is the groundwater discharge which is parameterized as niu et al 2007 13 r sb r sb max e f z gw where rsb max mm day 1 is the maximum groundwater discharge when the groundwater table depth is zero and f mm 1 is the e fold depth following niu et al 2007 the values of rsb max and f are set to be 39 mm day 1 and 1 25 10 3 mm 1 respectively then the change in water tabel depth z gw mm is calculated from 14 d z gw dt 1 θ s i θ i d w a dt z m i 1 z gw z m i 1 s y d w a dt z gw z m 2 where i is the index of soil layer where the groundwater table resides θs i and θi is the saturated and current soil water content of the ith soil layer respectively and sy is the specific yield of the unconfined aquifer which is set to be 0 2 in the global simulations due to the dearth of specific yield data for global aquifers niu et al 2007 2 6 potential evapotranspiration the priestley taylor pt priestley and taylor 1972 equation which is a function of available energy and a dimensionless coefficient works well as a potential evapotranspiration pet model for each component flux gerten et al 2004 fisher et al 2008 miralles et al 2011 assuming a homogeneous canopy the potential canopy transpiration tp mm day 1 and soil evaporation ep mm day 1 can be calculated as fisher et al 2008 15 t p α δ δ γ r nc λ 16 e p α δ δ γ r ns g λ where λ is the latent heat of vaporization mj kg 1 δ is the slope of the saturation vapor pressure versus temperature curve kpa k 1 γ is the psychrometric constant kpa k 1 g is the soil heat flux mj day 1 rnc mj day 1 is the net radiation to the canopy and is given by rnc rn rns where rn mj day 1 is the net radiation and rns mj day 1 is the net radiation to the soil rns is calculated according to the beer s law 17 r ns r n exp k r n l a i where k r n is the extinction coefficient which is set to be 0 6 impens and lemur 1969 in sith a constant of value of α 1 26 used so that the pt equation as a pet equation remains intact as originally designed and confirmed fisher et al 2008 when soil heat flux measurements are not available it is calculated as choudhury et al 1987 18 g 0 4 r n exp 0 5 lai the maximum transpiration rate of each soil layer tp i i 1 and 2 depends on the root fraction and soil moisture condition within the layer which is calculated as tiktak and bouten 1992 19 t p i r i θ i θ s i b i 1 2 r i θ i θ s i b t p where b dimensionless is a soil parameter which depends on soil physical properties table 2 θs i is the saturated water content in the ith soil layer ri dimensionless represents the vertical root density at the ith soil layer and θ i is the layer mean water content which is calculated as 20 θ i θ s i z gw z m i 1 θ i z gw z m i 1 θ s i z m i z gw z i z m i 1 z gw z m i θ i z gw z m i where θi i 1 2 is the unsaturated soil water content in the ith soil layer zm i 1 and zm i is the bottom depth of the i 1 th and ith layer respectively z i is the depth of the ith soil layer and z gw is the groundwater table depth fig 1 in sith the vertical root density ri is described by the linear dose response ldr model schenk and jackson 2002a 21 r i 1 1 z m i d 50 c 1 1 z m i 1 d 50 c where d 50 is the depth above which 50 of the root mas is located c is a shape parameter and zm i is the bottom depth of the ith layer fig 1 the values of d 50 and c for different plant function types pfts are presented in table 1 in sith plant can extract water from either the soil or groundwater or both of a specific layer depending on the position of groundwater table fig 1 to conserve the mass balance the total potential transpiration partitioned in the ith layer tp i is further separated into the soil and groundwater components based on the thickness weighted water content the potential transpiration from soil water of the ith layer tp s i mm day 1 i 1 2 is calculated as 22 t p s i 0 z gw z m i 1 z gw z m i 1 θ i z gw z m i 1 θ i z m i z gw θ s i t p i z m i 1 z gw z m i t p i z gw z m i the potential transpiration from groundwater in the ith layer tp g i mm day 1 i 1 2 is calculated as 23 t p g i t p i z gw z m i 1 z m i z gw θ s i z gw z m i 1 θ i z m i z gw θ s i t p i z m i 1 z gw z m i 0 z gw z m i for example when groundwater table is blow the root zone zgw zm 2 the values of tp g i 0 and tp s i tp i i 1 2 and plant transpiration only consumes soil water in root zone and has no effects on the modelled groundwater table when groundwater is within root zone plant transpiration will reduce both the water content of unsaturated soil and the water table depth 2 7 actual evapotranspiration as a result of suboptimal environmental conditions the actual fluxes of plant transpiration and soil evaporation are generally lower than their potential values in sith three reduction factors were used to downscale the potential transpiration tp to the actual value i soil moisture stress f sm ii plant temperature constraint ft and iii the time lost to transpiration due to the wet canopy fraction fwet which is given in eq 2 thus the actual transpiration from the unsaturated soil at the ith layer ts i was obtained as t s i 1 f wet f sm i f t t p s i where f sm i and f t are calculated as june et al 2004 fisher et al 2008 miralles et al 2011 25 f sm i 0 θ i θ wp i 1 θ c i θ i θ c i θ wp i 2 θ wp i θ i θ c i 1 θ i θ c i 26 f t exp t a t opt t opt 2 where θ i m3 m 3 is the soil moisture of ith layer θ c i m3 m 3 is the soil moisture below which plants start to endure water stress for soil layer i laio et al 2001 θ wp i m3 m 3 is soil moisture at permanent wilting point t a c is the daily mean air temperature and topt c is the optimum temperature for canopy transpiration which is defined as the daily air temperature when leaf area net radiation and temperature are high potter et al 1993 for transpiration from groundwater only the constraints of temperature ft and wet canopy fraction f wet are considered the total of volume transpiration from groundwater that caused groundwater table to decline is then calculated as 27 t r g 1 f wet f t i 1 n t p g i where n is the number of layers that contain both plant root and groundwater i e n 1 if z gw z m 1 and n 0 if z gw z m 2 soil evaporation declines as the soil gets dry and is assumed to be affected only by the unsaturated soil water content in the upper layer i 1 thus the actual soil evaporation e s is calculated as 28 e s f sm e p where f sm is given as miralles et al 2011 29 f sm 0 θ 1 θ wp 1 1 θ c 1 θ 1 θ c 1 θ wp 1 1 2 θ wp 1 θ 1 θ c 1 1 θ 1 θ c 1 where θ1 is the unsaturated soil moisture in the upper layer m3 m 3 the values of θ wp and θ c for each layer were calculated using the soil water retention function with the soil water potentials of ψ wp 150 m and ψ c 3 m respectively and data for 11 different soil types are given in table 2 based on the works of clapp and hornberger 1978 and cosby et al 1984 a detail description about soil water stress functions for different soil types was given in supplement 1 3 data and methods 3 1 eddy covariance flux data for model validation the recently released fluxnet2015 dataset http fluxnet fluxdata org data fluxnet2015 dataset pastorello et al 2017 provides an invaluable wealth of flux data complemented by meteorological variables and soil moisture for validation purpose the sites in the fluxnet2015 dataset were selected in such a way that they cover a wide range of vegetation types and climates in addition to this the data needed to span at least one year after a station by station quality check which is defined as following i when the measured energy imbalance net radiation minus latent sensible and ground heat flux exceeds 250 w m 2 the half hourly hourly flux data were treated as missing ii when the data gaps were less than 6 h in a day the missing data was interpolated using linear regression method iii any day that did not have necessary measurements to complete a diurnal cycle was not used in the analysis of model evaluations and iv rainy intervals were masked from the in situ flux datasets as the eddy covariance measurements are less reliable during precipitation events this yielded a total of 84 reliable eddy covariance sites which are located across several continents and cover a large variety of ecosystems table s1 in supplement 2 the energy balance closure across the selected sites ranges from 70 to 99 with a mean of 80 2 and the intercept values range 22 4 to 26 1 w m 2 with a mean of 1 24 10 5 w m 2 table s2 in supplement 2 therefore the processed flux data was qualified and suitable for the purposes of model validations to account for the biased low in situ et measurements due to the energy imbalance at the selected sites 1 30 the directly measured et data were corrected by using the residual energy balance method twine et al 2000 among the selected sites in fluxnet dataset 38 sites also provide in situ soil moisture measurements approximately over the top 30 cm of the soil novick et al 2016 the sites reporting both soil moisture and et measurements were labeled as focus sites table s1 in supplement 1 and used to test model accuracy in simultaneously simulating et and soil water content due to limited observational soil moisture data for deep soil layers we only compared the modeled soil moisture of the first layer θ1 0 20 cm with in situ measurements at the top soil swc1 in the fluxnet2015 dataset for validation purposes in situ measured meteorological variables from the flux towers which include surface net radiation rn w m 2 soil heat flux g w m 2 air temperature ta c and precipitation pr mm day 1 were used to drive the model to simulate et and soil water contents the leaf area index lai required by the model were extracted from moderate resolution imaging spectroradiometer modis product mod15a2h https lpdaac usgs gov myneni et al 2015 at 500 m spatial and 8 day temporal resolution an average of nine surrounding pixels around the fluxnet2015 sites was used to calculate the required lai values data were cleaned by eliminating contamination associated with clouds shadows and snow ice and were interpolated to daily values using the linear interpolation approach zhang et al 2010 the performance of sith model in simulating et and soil water content was evaluated by using the coefficient of determination r 2 slope b 0 and intercept b 1 of the regression line y b 0 x b 1 between the measured x and estimated y values model data mismatch was also quantified using root mean squared error rmse mean bias error mbe and the nash sutcliffe efficiency coefficient nse these were calculated as 30 rmse 1 n t 1 n o t m t 2 31 mbe t 1 n o t m t n 32 nse 1 t 1 n o t m t 2 t 1 n o t o 2 where n is the total number of observations o t is the observed values at time t o is the mean of the observed data and m t is the model predictions at time t the coefficient of determination r 2 describes the degree of co linearity between observed and simulated values and ranges between 0 and 1 with higher values indicating less error variance generally an r 2 0 5 is considered as acceptable performance moriasi et al 2007 for mbe a positive mbe indicates an overall overestimation while a negative mbe indicates an overall underestimation the closer the mbe to zero the better is the model s performance the nse value can range between and 1 0 with a nse 1 being the optimal value moriasi et al 2007 zhu et al 2016 3 2 gridded datasets for global implementation and evaluation for global estimates of et the forcing datasets used to run sith model included precipitation air temperature air pressure albedo incoming shortwave radiation leaf area index land cover and soil type they were derived from various sources and comprised well validated products for precipitation forcing the multi source weighted ensemble precipitation mswep dataset was selected http www gloh2o org beck et al 2017 the mswep dataset is based on a merger of selected satellite reanalysis and gauge based products and is available from 1979 until 2015 at a daily 0 25 spatial resolution the surface meteorological forcing datasets including air temperature pressure and incoming shortwave radiation were derived from the global modeling and assimilation office gmao global modeling and assimilation office 2004 meteorological data at hourly 1 00 1 25 resolution the gmao datasets were also used in the calculation of modis npp gpp and et running et al 2004 mu et al 2007 2011 satellite based inputs including leaf area index albedo and land cover for leaf area index and albedo we used the 8 day 0 05 global land surface satellite glass products http glassproduct bnu edu cn zhao et al 2013 this glass albedo was used to calculate reflected solar radiation and hence the net incoming solar radiation see details in cleugh et al 2007 land cover were derived from yearly 0 05 modis products mcd12c1 https modis ornl gov cgi bin modis global subset pl friedl et al 2002 the land cover data was reclassified into the respective 12 pfts of sith model based on international geosphere biosphere programme igbp classification scheme belward 1996 in addition the required static soil texture dataset was derived from the well regarded fao harmonized world soil database hwsd http www fao org at 0 1 spatial resolution based on the classification of united states department of agriculture natural resources conservation service usda usda nrcs 2004 the soil texture was further divided into 11 different types defined by sith model all the data sets presenting a different spatial resolution are re gridded to a common 0 25 0 25 spatial resolution by means of inverse distance weighted interpolation shepard 1968 the daily series of leaf area and albedo were derived from the 8 day glass products using daily linear interpolation approach zhang et al 2010 the hourly gmao meteorological data were averaged to daily means according to the method proposed by allen et al 1998 to make sure that water cycle variables i e soil moisture and groundwater table depth can reach equilibrium a 100 year spin up was performed by repeating the forcing of the period 2000 2010 10 times starting from the end of the spin up the model was run to generate the global scale soil moisture groundwater table and et products to compare the global et estimated by sith with related et products five additional datasets were incorporated into the evaluation one is the era interim reanalysis product which is produced by the european centre for medium range weather forecasts ecmwf and covers the period from 1979 to present with a horizontal resolution of approximately 0 7 and 62 vertical levels dee et al 2011 the other four are derived from satellite based et products 1 the mod16 et product which is produced based on the most widely used satellite based et model proposed by mu et al 2007 2011 the mod16 et product has a spatial resolution of 1 km and is available with 8 day monthly and annual intervals ftp ftp ntsg umt edu pub modis mirror mod16 the mod16 et is estimated as the sum of evaporation from water intercepted by the canopy transpiration from the dry canopy surface and evaporation from the moisture soil surface and saturated soil surface 2 the gleam global land evaporation amsterdam model product which uses a modified pt equation in combination with an analytical rainfall interception model gash 1979 a soil water module and a stress module to derive actual et based on a wide range of remote sensing observations miralles et al 2011 data have daily 0 25 spatial resolution and span the 2000 2015 period https www gleam eu 3 the pt jpl priestly taylor jet propulsion laboratory product which applies a series of ecophysiological stress factors based on atmospheric moisture and vegetation indices into the pt equation to compute canopy transpiration wet canopy evaporation and soil evaporation fisher et al 2008 the dataset have monthly 1 spatial resolution and span from 1984 to 2006 http landflux org data php 4 the pml penman monteith leuning product which uses the penman monteith pm equation monteith 1965 with a simple biophysical canopy conductance model to calculate transpiration and includes a simple term for soil evaporation while interception loss is estimated separately using gash rainfall interception model leuning et al 2008 zhang et al 2008 this dataset has monthly 0 5 spatial resolution and span from 1981 to 2012 https doi org 10 4225 08 5719a5c48db85 4 results 4 1 validation of in situ et estimates the statistical results for modelled versus measured daily et at all 84 fluxnet sites were presented in table 3 as expected the model performance varies from site to site the slopes b 0 of the linear regression between modelled and measured daily et ranged from 0 50 at ru tks to 1 35 at dk eng with an average of 0 83 while the intercepts b 1 ranged from 0 47 mm day 1 at au das to 1 09 mm day 1 at br sa1 with an average of 0 23 mm day 1 the sith model had an average rmse of 0 74 mm day 1 ranging from 0 29 mm day 1 at ru che to 1 42 mm day 1 at zm mon an average bias of 0 02 mm day 1 was obtained for all sites ranging from 0 61 mm day 1 at cz bk1 to 0 68 mm day 1 at au tum the values of nse ranged from 1 07 at zm mon to 0 80 at cn ham with an average of 0 41 relatively high nse 0 35 were found at 54 sites and low nes 0 were found on at only 5 sites on average the model explained 65 of the variance in measured et across all sites ranging from a low of 23 at zm mon to 88 at ca ns6 further details of model performances in capturing the temporal variations of observed et at different sites were provided in supplement 3 overall the model results generally agreed well with tower observations and captured observed et seasonality and inter annual variability over different sites the scatterplot in fig 3 showed modelled versus observed daily et for all data from all 85 sites and a high correspondence of sith estimates with fluxnet observations were obtained in term of relative high r 2 0 58 low rmse 0 78 mm day 1 low mbe 0 01 mm day 1 high nse 0 54 and regression slope close to one 0 73 thus the proposed model has the skill to capture the daily et over a wide range of plant types and climate conditions noticeably the model displays low values of both r 2 0 50 and nse 0 at some sites of dbf e g zm mon enf ca tp1 and nl loo ebf br sa1 and cn din biomes by examining the model performance at these sites the causes that induced the disagreements between modelled and observed et values were identified and illustrated by the selected sites which were typical in representing each of the different causes first data errors may still exist in the latent heat flux records at some fluxnet sites though great efforts have been made in improving the quality of fluxnet2015 dataset pastorello et al 2017 fig 4 represents an example of the daily time series of sith estimates and fluxnet observations at site ca tp1 which is located on the northern shore of lake erie in southern ontario canada chan et al 2018 during the period from 2002 to 2014 noisy and biased flux observations occasionally occurred and decreased the agreements between the modelled and observed et values similarly noisy and biased latent heat flux observations seemed to be occurred at other sites i e nl loo fr pue see details supplement 3 zhang et al 2010 also reported that an artifact of measurement errors may exist in latent heat fluxes at some fluxnet sites second soil water availabilityfor surface evaporation and plant transpiration in sith model is mainly controlled by the inputs ofprecipitation however significant errors of the in situ precipitation measurements may occur at some sites due to the occasionalmalfunction of precipitationgages dorigo et al 2013 as an example fig 5 illustrated that the soil moisture time series exhibited a typical wetting and consecutive drying of the soil in 2005 at zm mon while no precipitation events were recorded during the corresponding period the errors in precipitation measurements in turn resulted in significant underestimates of et in 2005 at zm mon fig 5 table 3 third irrigation is widely used in arid semiarid cropland ecosystems to reduce plant drought stress by compensating for low precipitation allen et al 1998 siebert et al 2015 because the irrigation data the timing and amount of water applied to crops are typically not available in the fluxnet datasets the soil water inputs from irrigation were not considered here this in turn resulted in some underestimates of et over some cropland ecosystems with irrigations during the dry periods i e at site it bci fig 6 4 2 validation of in situ soil moisture estimates it should be first mentioned that most fluxnet sites relay on time domain reflectometry tdr or capacitance probes for soil moisture measurements novick et al 2016 which generally need a site specific calibration however details of these site specific calibration are not generally available in the fluxnet2015 dataset thus comparisons of modelled and observed soil moisture content should be approached with caution in addition there is always a discrepancy between measured and modelled soil moisture in vertical scale as the model estimates are the average of soil moisture for the surface soil layer 0 0 2 m whereas the measurements are taken at a specific depth of the soil representing the volumetric soil water content at that level table 4 represents the statistical results for modelled versus observed surface soil moisture over the 38 selected fluxnet sites noticeably no local adjustment of soil hydraulic properties was made for model simulations on average the model explains 42 of the variance in measured surface soil water content across all sites ranging from a low of 10 at ru ha1 to 77 at it cpz the value of rmse varies from 0 01 m3 m 3 at au cpr to 0 11 m3 m 3 at de tha with a mean of 0 05 m3 m 3 the average values of nse 0 21 are relatively high indicating that the patterns of temporal changes in soil moisture are well represented over a wide range of land covers and climate conditions the details for the daily time series of surface soil moisture estimated from sith model versus measured data are presented in supplement 3 in most cases the model responds properly to the precipitation events and follows closely the observations during the subsequent dry down phase indicating the proposed soil water draining scheme including both fast and slow draining fluxes between layers is reasonable analogously the causes for the differences between modelled and observed time series of surface soil moisture at some sites were identified as the following first sits with low winter temperature 0 c have temporary conditions of thenear surface soil freeze thaw cycles i e ca qfo ca sf3 fi sod us wcr however our model assumes a uniform soil temperature profile throughout the soil layers that can impose inaccurate representation of the soil freeze thaw cycles thus the predicted soil moisture tended to be unrealistic during the soil freeze thaw cycles in addition the accuracy of instruments to measure soil moisture in frozen soil is much lower than in unfrozen soil mittelbach et al 2012 taking both limitations into account the difference between modelled and observed soil moisture values are expected to be high during the freezing winter and thawing early spring periods at these sites on the contrary the soil moisture is generally simulated with relatively high accuracy in the rest of the year see details in supplement 3 for sites ca qfo ca sf3 fi sod us wcr second natural soil properties are highly variable and heterogeneous in both vertical and all spatial directions within a textural layer elkateb et al 2003 which result in a wide variation in soil hydraulic parameters however we assigned homogeneous soil properties over a specific layer with a set of constant hydraulic parameters in sith model the biases in hydraulic parameters may also affect the simulation results in soil moistures fig 7 illustrates that the temporal pattern of surface soil moisture was adequately captured by the model at site cn du2 however the model tends to overestimate soil moisture during dry season observed soil moisture reached a minimum of 0 046 m3 m 3 while the simulated minimum wilting point was set as 0 139 m3 m 3 for loam soil table 2 third similarly to flux observations in situ soil moisture measurements may also contain errors due to the instrument drifts reduced power supplies and sensor dropouts see details in dorigo et al 2013 for examples a sudden jump in the measured soil moisture were observed at site be vie and it is difficult for us to establish which of the periods i e before or after the jump represents the situation closest to the truth fig 8 at site dk sor see details in supplement 3 the measured soil moisture values hold constant over two long periods which is a typical error in soil moisture observations mittelbach et al 2011 fourth errors in soil water inputs i e precipitation and irrigation also caused the simulated soil moisture to be different from the observed values figs 5 and 6 for zm mon and it bci respectively 4 3 global application the spatial distribution and latitudinal profile of et for 2005 modelled by sith was presented in fig 9 as well as providing five additional global et products into evaluation the spatial pattern was reasonable and the range of values corresponded well with other global et products fig 9 for example the total annual et in 2005 estimated by sith model was 70 8 103 km3 which fell with the range 60 6 103 83 2 103 km3 of the five global et products among them our estimates were very close to the results from gleam 67 4 103 km3 and pt jpl 73 5 103 km3 products but was smaller than that estimated by era interim 83 3 103 km3 and larger than that from mod16 60 6 103 km3 and pml 63 6 103 km3 in addition dirmeyer et al 2006 reported that the mean annual global land et ranged from 58 103 km3 to 85 103 km3 estimated by 15 land surface models participating in the global soil wetness project 2 gswp 2 jung et al 2010 used a data driven model tree ensemble mte algorithm and derived a mean global et of 65 3 103 km3 over the period of 1982 2008 without considering poles and desert regions the latitudinal profiles of annual land et indicated that the equatorial zones had a high et of 1200 mm yr 1 while mid and high latitude zones often had annual et less than 450 mm yr 1 fig 9g also a major distinguishing feature of the model is the detailed estimation of et from different water sources our simulations suggest that et was mostly derived from the surface soil layer fig 10 a the proportion of et from surface soil layer varied between 40 and 90 fig 10b with a global mean of 73 this is mainly due to the fact that at least half of root biomass is found in the upper 30 cm of soil for all vegetations globally schenk and jackson 2002a b the et values from the deep soil layer were relatively high over the tropic subtropical and boreal forests fig 10c the proportion of et from this layer varied mostly between 10 and 30 fig 10d with a mean of 14 groundwater was mainly used by dry tropical savannas temperate savannas and mediterranean shrublands fig 10e and 10f and the mean proportion of et from groundwater was about 5 globally the seasonal variation in et was also well captured by sith model fig 11 the tropical rain forest regions show year round high et values while tropical dry forest and savanna regions show alternate wet march to may mam and december to february djf and dry june to august jja and september to november son seasons the temperate and boreal arctic regions have much higher seasonal variability than the tropics in the northern hemisphere spring mam fig 11a and b is the onset of the growing season et increased and reached a peak in summer jja fig 11c and d in autumn son fig 11e and f et began to drop and reached the minimum values in winter djf fig 11g and h in the southern hemisphere it is the reverse also we examined the accuracy of sith model in estimating the different components of et over different biomes and climate conditions the spatial distribution for the different components was shown in fig 12 as well as providing the ratios of different components to total et transpiration was the dominant component of et and accounted for 76 of annual land et it was the largest in tropic and subtropical forests in south american africa asia island east usa and east china due to the sufficient availability of soil moisture during the plant growing seasons but lowest in steppes of qinghai tibet plateau and major deserts of north africa middle east and middle asia fig 12a and b for other components soil evaporation accounted for 16 of land et and was important in major desert regions where most precipitation was used for e s fig 12c and d the contribution of interception loss accounted to only 8 of land et and it mainly came from tropic subtropical and boreal forests fig 12e and f the global distribution of simulated groundwater water depth was presented in fig 13 the spatial patterns of groundwater table depth simulated by sith corresponded well with previous studies niu et al 2007 fan et al 2013 koirala et al 2014 in general the groundwater table was deeper in arid regions 10 m whereas it was shallower in humid and high latitude regions 5 m in future works a detailed study of the long term trend of global land et and groundwater table dynamics simulated by sith model will be analyzed and we will present related results in the coming papers 5 discussion et remains one of the biggest unknowns within the global water balance miralles et al 2011 improved representation of its dynamics is important to facilitate our understanding of global hydrological cycles carbon cycles and climate change this paper presents a new model sith simple terrestrial hydrosphere that coupled parsimonious and robust models of the gspac to estimate the terrestrial et and its different components the major distinguishing features of the methodology included that 1 the groundwater table dynamic and its influence on soil moisture plant transpiration and surface runoff was explicitly represented in the model based on the framework of the gspac and the proportion of et from the different water sources e g surface soil layer deep soil layer and groundwater can also be quantified 2 the model was built with a full modular structure and new concepts can easily be incorporated in 3 the vertical root distributions and rooting depths of different biomes were quantified based on observation datasets table 1 and the effects of soil water stress on plant transpiration and soil evaporation were properly described by taking into account the influence of soil texture table 2 4 the hydrological processes were represented using parsimonious and robust models the required meteorological forcing data i e air temperature net radiation soil heat flux and precipitation is minimal and the static variables i e soil type and pfts can be easily specified from in situ measurements or existing global datasets this simple strategy allows the application of the methodology not only at a local scale using in situ observations but also at a global regional scale through the utilization of high resolution input data i e satellite retrieved lai land cover etc the two main intermediate products of sith total et and surface soil moisture were compared with in situ measurements and a high correspondence of sith estimations with measurements was obtained over a wide variety of climate and vegetation types it should be noticed that measurement errors in latent heat flux soil moisture and precipitation at some sites may also degrade the statistics of validation in both et and soil moisture estimates fortunately such measurement errors only occurred occasionally and do not significantly affect our modeling results and main conclusions drawn from daily evaluation the estimated daily et against eddy covariance measurements from 85 fluxnet sites had a mean r 2 0 65 rmse 0 74 mm day 1 bias 0 02 mm day 1 and nse 0 41 the statistical results found here were comparable to that of the validations of other et models for example mu et al 2011 reported the daily et estimates had an average r 2 0 60 and rmse 0 90 mm day 1 over 46 fluxnet sites in north america miralles et al 2011 reported an average r 2 0 69 and rmsd 0 30 mm day 1 for daily et estimates based on a sample of 43 flux sites yan et al 2012 reported that daily estimated et had a mean r 2 0 69 rmse 0 77 mm day 1 and bias 0 14 mm day 1 over 19 flux sites the model proposed by fisher et al 2010 have been extensively validated against tower measurements and has proved to estimate realistic daily and monthly et estimates ershadi et al 2014 michel et al 2016 zhu et al 2016 zhang et al 2017 as an example zhang et al 2017 reported an average r 2 of 0 53 and nse of 0 31 for daily et estimates against observations over 44 flux towers the estimated surface soil moisture values were also evaluated at 35 fluxnet sites the results indicated that the temporal variations of the modelled and observed surface soil moisture are in good agreement with a mean r 2 0 42 rmse 0 05 m3 m 3 bias 0 001 m3 m 3 and nse 0 21 across all sites miralles et al 2011 used the soil moisture data from 30 stations of the soil climate analysis network scan schaefer et al 2007 to validate the daily soil moisture estimates and reported a mean r 2 of 0 36 for the surface soil moisture estimates alavi et al 2016 reported that daily surface soil moisture estimates of the soil vegetation and snow svs scheme had an average r 2 0 31 and bias 0 033 m3 m 3 over 130 scan sites overall the proposed model performed relatively satisfactory in both et and soil moisture simulations and no systematic bias for specific biomes or climate conditions has been found globally daily 0 25 sith et simulations in 2005 which were forced using the mswep precipitation data gmao meteorological data and glass land cover leaf area index albedo datasets predicted an annual land et of 70 8 103 km3 which fell with the range 60 6 103 83 2 103 km3 of the five global et products as well as the model range 58 103 km3 to 85 103 of gswp 2 dirmeyer et al 2006 the ratio of transpiration soil evaporation and interception to total et estimated by sith was 76 16 and 8 respectively which is nearly within the scope of previous studies for example jasechko et al 2013 reported that transpiration could account for nearly 80 90 of the total et from continents by using the isotope mass balance method this finding was criticized for overestimating the contribution of plant transpiration and underestimating data uncertainties after counting the input data uncertainties coenders gerrits et al 2014 argued the transpiration portion of et to be lower at 35 80 maxwell and condon 2016 found transpiration accounts for 62 12 of et by considering the influence of lateral ground water flow on et partitioning previous studies reported that soil evaporation accounts for 20 40 of et for croplands and 5 38 of total et for natural vegetation kool et al 2014 the ratio of global soil evaporation to total et estimated by sith is comparable to that 14 reported by miralles et al 2016 based on gleam product until now direct observations on the contributions of canopy loss to total et across different biomes are still relative sparse miralles et al 2010 and estimations were mainly derived from model simulations with a range of 10 24 miralles et al 2016 in addition the spatial patterns of groundwater table depth appeared reasonable and corresponded well with previous studies niu et al 2007 fan et al 2013 koirala et al 2014 note that our current global land et simulations were conducted using a fixed sets of forcing datasets and the errors induced by the choices of different inputs were not explored in future studies we will focus on analyzing the spatial and temporal variation of the global estimates of land et and groundwater table depth over a long time period spanning from 1984 to present based on different sets of forcing inputs also a detailed investigation on the proportion of et from different water sources e g surface soil layer deep soil layer and shallow groundwater will be conducted a main drawback of this study however was that the model assumes a uniform soil temperature profile throughout the soil layers which can impose inaccurate representation of the soil freeze thaw process and adversely impact the predicted soil moisture in winter implementation of a soil heat diffusion scheme is currently in progress to circumvent this potential problem in addition the parameter values can significantly affect the simulations of soil moisture and hydrologic fluxes and may vary with the environmental conditions pfts and other factors zhang et al 2017 at present a set of constant parameters based on previous studies were used in sith without any calibrations to improve model performances there is a need to optimize the model parameters using the multiple observations i e fluxnet data groundwater table depth etc over a wide range of global bioclimatic conditions in future studies zhu et al 2014 zhang et al 2017 6 conclusions in this study a relatively simple model sith simple terrestrial hydrosphere that coupled the parsimonious and robust models of the gspac to estimate the terrestrial et soil moisture and groundwater table depth at the daily time scale has been developed and evaluated it showed good agreement with in situ observed et and surface soil moisture at the fluxnet sites no systematic bias for specific vegetation types and climate conditions has been detected as a physically based hydrological model sith has the potential for implementation at global scales the required input data including net radiation air temperature precipitation leaf area index vegetation type and soil data are readily available the estimated et and groundwater table depth in 2005 by sith captured spatial and seasonal variations at the global scale and favorably compared with other estimations in an ongoing study we will analyze the long term spatial and temporal variation of the global et and groundwater table depth using different forcing input datasets in addition special attentions will be given to properly describe soil freeze thaw processes in future studies declaration of competing interest we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled acknowledgements this work used eddy covariance data acquired and shared by the fluxnet community including these networks ameriflux afriflux asiaflux carboafrica carboeuropeip carboitaly carbomont chinaflux fluxnet canada greengrass icos koflux lba necc ozflux tern tcos siberia and usccc the era interim reanalysis data are provided by ecmwf and processed by lsce the fluxnet eddy covariance data processing and harmonization was carried out by the european fluxes database cluster ameriflux management project and fluxdata project of fluxnet with the support of cdiac and icos ecosystem thematic center and the ozflux chinaflux and asiaflux offices modis lai satellite products were obtained online https lpdaac usgs gov this research was supported by the national key research and development program of china 2018yfc0406602 and national natural science foundation of china grants 41871078 and 41571016 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 123928 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 supplementary data 3 
6191,hydrological processes became non stationary under the influences of climate change and human activities this non stationarity highlights the need to adopt time varying parameters in hydrological models the majority of existing literature quantifies time varying parameters by incorporating real observations of single basin into a hydrological model they are limited in their information on catchment characteristics and climatic factors to constrain time varying parameters thus models are difficult to apply for hydrological predictions outside the calibration periods this paper formulated the time varying parameters for a lumped hydrological model as explicit functions of physically based covariates that captured the catchment characteristics then it used a hierarchical bayesian framework to incorporate the similarity of adjacent basins to reduce the uncertainty of the assumed functions for time varying parameters four modeling scenarios were developed to explore the spatial coherence between different characteristics of adjacent basins five criteria were adopted to evaluate the performance of assumed functional forms four spatially adjacent catchments in the central united states were selected as case studies to examine the validity of the proposed method results showed that 1 the proposed method succeeded in reducing the uncertainty of time varying parameters and 2 the seasonality of the catchment storage was more coherent between adjacent basins indicated by the largest increase in model prediction performance i e 9 this study improved the understanding of the spatial coherence of time varying parameters which helps improve hydrological predictions in the future keywords uncertainty hierarchical bayesian temporal variation spatial coherence nonstationary condition gr4j hydrological model 1 introduction study of hydrological processes is of vital importance for understanding of hydrological cycle and for improving prediction ability of hydrological models conventionally hydrological processes are assumed to be stationary so that hydrological model parameters calibrated with historical data can be applied to predict catchment behavior in the near future broderick et al 2016 coron et al 2012 fowler et al 2016 patil and stieglitz 2015 renard et al 2011 westra et al 2014 fowler et al 2016 patil and stieglitz 2015 renard et al 2011 westra et al 2014 this implies that both catchment characteristics e g vegetation coverage and catchment topography and climate conditions e g annual mean rainfall and evapotranspiration remain unchanged between the historical periods and future periods however many researchers have identified the non stationarity of hydrological processes because of the influence of climate change and anthropogenic activity broderick et al 2016 chiew et al 2009 ciais et al 2005 deng et al 2016 liu et al 2015 milly et al 2008 2015 patil and stieglitz 2015 sun et al 2014 wang and fu 2018 for example a warming climate increases the capacity of the atmosphere to hold and transport atmospheric water which directly affects the partition of precipitation between evapotranspiration and runoff brigode et al 2013 guo et al 2017b milly et al 2008 2015 pathiraja et al 2016 yin et al 2018 furthermore the construction of dams and afforestation can lead to an increase in the production store capacity of catchments while deforestation can result in a decrease in the production store capacity feng et al 2017 liu et al 2011 ming et al 2017 2018 pan et al 2018 tian et al 2019 thus it is not appropriate to treat model parameters as time invariant in hydrological prediction extensive research has illustrated that parameters in hydrological models do vary in time brigode et al 2013 broderick et al 2016 deng et al 2016 2018 guo et al 2018 merz et al 2011 milly et al 2008 2015 montanari et al 2013 moradkhani et al 2012 2018 2005b pathiraja et al 2018a 2016 2018b westra et al 2014 for example merz et al 2011 found that the calibrated parameters representing snow and soil moisture processes showed significant trends during historical periods in the study area deng et al 2016 indicated that the model parameters denoting the water storage capacity of catchments had an apparent increasing trend during the historical periods in the study area however it is still a challenge to quantify the uncertainty within the estimated time varying parameters and achieve an accurate hydrological prediction with such parameters ajami et al 2007a bracken et al 2018 brigode et al 2013 broderick et al 2016 pathiraja et al 2016 patil and stieglitz 2015 renard et al 2011 smith et al 2014 westra et al 2014 the bayesian inference is one of the most widely used approaches in coping with the uncertainty of parameter estimation abbaszadeh et al 2018 2019 dechant and moradkhani 2012 deng et al 2016 liu et al 2014 marshall et al 2005 moradkhani et al 2005a b 2012 pathiraja et al 2016 2018 renard et al 2011 westra et al 2014 one of the most popular methods that based on the bayesian inference is the sequential bayesian estimation method deng et al 2016 moradkhani et al 2012 moradkhani et al 2005a b pathiraja et al 2016 2018b yan and moradkhani 2015 yan and moradkhani 2016 it identifies the potential temporal variations of model parameters by updating them in real time when observations are available generally the sequential bayesian method is useful in the identification of time varying parameters during the historical periods but is difficult to be applied for long term hydrological prediction since observation in the near future is not available the hierarchical bayesian hb framework is another promising method based on bayesian inference which reduces uncertainty in parameter estimation by considering multiple levels usually two levels of information to constrain the time varying parameters ahn et al 2017 cha et al 2016 chen et al 2014 ganguli and coulibaly 2017 kwon et al 2008 lima and lall 2009 sun and lall 2015 sun et al 2015 it has been successfully applied in extreme event analysis e g extreme rainfall and extreme flow to include the coherence between characteristics in different stations and or climatic variables such as connections among exogenous climate variables and extreme rainfall ahn et al 2017 chen et al 2014 lima and lall 2009 exogenous climate variables and extreme flow gaume et al 2010 coherence of extreme flow at different stations cha et al 2016 lima et al 2016 sun and lall 2015 and variation of extreme rainfall at different stations sun et al 2015 in principle the spatial coherence between characteristics of adjacent stations is much more significant than that between stations and exogenous climate variables e g el niño and arctic oscillation because the exogenous climate variables lend themselves to contain larger uncertainties in their acquisition processes rasanen et al 2016 schliep et al 2010 in the field of hydrological modeling the conventional use of coherence between different catchments is known as parameter regionalization a method scheme of transferring parameters calibrated in one basin to another basin based on spatial proximity and physical similarity lebecherel et al 2016 merz and bloschl 2004 oudin et al 2008 parajka et al 2005 sellami et al 2014 singh et al 2012 steinschneider et al 2015 it means that parameters that are calibrated in one basin are used directly in the modeling of its neighboring or similar basins lebecherel et al 2016 sellami et al 2014 singh et al 2012 steinschneider et al 2015 it is acceptable for the hydrological modeling in ungauged basins that lack hydrological records however it is questionable for quantifying the functions of time varying parameters which focused more on a predictive result of changed conditions thus this study attempted to discover whether the hb method could be adapted to include the spatial coherence of adjacent basins in hydrological modeling with time varying parameters the primary objectives of this study were to answer three research questions 1 whether the similarity between adjacent catchments can be used to reduce parameter uncertainty and improve the performance of hydrological modeling 2 how the similarity of adjacent catchments can be incorporated into the time varying parameters within the hb framework and 3 which catchment characteristic has the most significant influence on reducing uncertainties of time varying parameters and consequently improving model performance the rest of this paper is organized as follows in section 2 a method that embeds in the hb framework is proposed to utilize the catchment similarity to reduce the uncertainty of time varying parameters in section 3 a case study is selected to validate the effectiveness of the proposed method in section 4 the main conclusions are provided 2 methodology in this section a hb framework with the consideration of similarity in the characteristics of adjacent basins is proposed to constrain uncertainty associated with an estimated time varying parameter of a lumped hydrological model assessing such uncertainty requires both a hydrological model and a pooling estimation method therefore a daily lumped hydrological model is selected as outlined in section 2 1 the pooling estimation method is presented in section 2 2 providing the foundation for the hb framework meanwhile the two level hb framework is described in section 2 3 its first level the process layer models the temporal variation of model parameters using a regression function section 2 3 1 while its second level the prior layer models the spatial coherence of the regression parameters section 2 3 2 the likelihood function and parameter estimation methods are outlined in section 2 4 finally the criteria used to evaluate the model performance for various model scenarios are outlined in section 2 5 2 1 the hydrological model the hydrological model used in this study is the gr4j modèle du génie rural à 4 paramètres journalier which is a lumped conceptual rainfall runoff model perrin et al 2003 the original version of the gr4j model perrin et al 2003 comprised four parameters production store capacity θ 1 unit of mm groundwater exchange coefficient θ 2 unit of mm 1 day ahead maximum capacity of the routing store θ 3 unit of mm and the time base of the unit hydrograph θ 4 unit of day all four parameters are real numbers θ 1 θ 3 and θ 4 are positive while θ 2 can be either positive zero or negative in the gr4j model precipitation is initially intercepted by the vegetation canopy and then is divided into surface runoff and a soil water storage where θ 1 is the maximum capacity of the production store of the soil the total runoff including the underground flow and the surface runoff is then empirically divided into fast and slow routing processes ninety percent of the runoff is propagated through slow routing with a unit hydrograph uh1 while the other 10 of the total runoff is propagated through fast routing with another single unit hydrograph uh2 both unit hydrographs depend on the same time parameter θ 4 expressed in days additionally a groundwater exchange that acts on both flow components is calculated with parameters θ 2 and θ 3 more details on the gr4j model can be found in perrin et al 2003 the gr4j model is selected because of its high performance in simulating both high and low flows and the model has been applied successfully across a wide range of hydro climatic conditions brigode et al 2013 demirel et al 2013 khan et al 2018 le moine et al 2008 oudin et al 2008 perrin et al 2003 saft et al 2016 westra et al 2014 this makes the gr4j model particularly suitable as a starting point for implementing modifications to improve its estimation accuracy in this study various versions based on this model are constructed for the purposes of reducing estimation uncertainty of model parameters and interpreting the possible relationship between adjacent basins considering temporal variation and multiple spatial coherence schemes of the model parameter θ 1 2 2 pooling estimation when conditions are steady parameters in a hydrological model should be time invariant however under nonstationary conditions these parameters will vary with time and space 1 q h θ b t ξ e where q represents observations of streamflow h represents the hydrological model θ b t θ m m 1 m are model parameters where m is the number of model parameters b is the index of basins and t is the time step ξ represents the time series of hydrological input including precipitation p and potential evapotranspiration pet e represents the residual error in the simulated streamflow with zero expectation and constant variance σ 2 each model parameter can potentially be written as a function of covariates e g having both a time and climate index for example a component of θ b t can be modeled as θ m b t α 1 b α 2 t where θ m is the selected time varying model parameter α 1 b is a local basin specific regression parameter α 2 is a regional regression parameter which is common to all basins more generally this regression function can be written as 2 θ m b t r γ m f b t where r is a general regression function γ m is the collection of regression parameters in the function and f b t represents a set of covariates defined with respect to basin b and time step t the parameter collection γ m can be stratified into two parts γ m loc and γ m reg where γ m loc is the collection of local basin specific parameters and γ m reg is the collection of regional parameters in a hb framework there are three options for pooling information about regression parameters across basins the first option has no pooling i e involving only γ m loc which means that all regression parameters of different basins are estimated as independent variables the second option has full pooling i e involving only γ m reg which means that regression parameters are assumed to be common for all basins meanwhile the third option involves partial pooling i e both γ m loc and γ m reg are used which means that some regression model parameters are assumed to be drawn from a common hyper distribution d m across all basins while others are assumed to be basin specific estimates the same regression parameters for different basins are recognized as independent variables the no pooling and the full pooling options represent two endpoints of the partial pooling model typically the partial pooling estimate shrinks the local parameter toward the common regional mean and includes an estimation of its variance or covariance across the basins a schematic of the partial pooling model is presented in fig 1 in the hb framework the process layer represents the temporal variation regression function of the model parameters and the prior layer represents the spatial coherence of the regression parameters in particular γ m reg is assumed to follow a hyper distribution in the prior layer 3 γ m reg d m μ m where μ m represents the collection of hyper parameters 2 3 the hb framework for the time varying model parameter 2 3 1 temporal variation of the model parameter in the gr4j model parameter θ 1 is allowed to vary in time to represent several potential time scales of variation m 1 the reason for choosing θ 1 as a time varying parameter is that it represents the primary storage of water in the catchment previous studies have reported that θ 1 is the most sensitive parameter within the gr4j model and stochastic variations of θ 1 have the largest impact on model predictions guo et al 2017a oudin et al 2018 perrin et al 2003 renard et al 2011 westra et al 2014 wright et al 2015 zhang et al 2018 the temporal variation of the catchment storage capacity is also physically interpretable seasonal variation in the production store capacity θ 1 may be induced by seasonal vegetation growth and senescence long term change may be induced by wildfire and deforestation which can result in a decrease in θ 1 meanwhile human interferences such as the building of dams can lead to an increase in θ 1 in this study θ 1 is constructed to account for both seasonal scale and long term variations as described in westra et al 2014 1 seasonal scale variation in catchment storage capacity θ 1 is described by a sine function using amplitude and phase 2 long term change in response to catchment storage capacity is represented by a linear trend in θ 1 for any basin b the full temporal variation model regression function for θ 1 is 4 process layer θ 1 b α 1 b α 2 t α 3 sin 2 π α 4 b t 365 where α 1 α 2 α 3 and α 4 are four regression parameters γ 1 α 1 α 2 α 3 α 4 parameter α 1 signifies the intercept α 2 represents the slope of the t θ 1 relationship α 2 and α 3 represent the amplitude and remainder of the sine function respectively if model parameter θ 1 is assumed to be stationary then α 2 0 and α 3 0 suffice in eq 4 and the resulting model simplifies to the stationary hydrological model the use of a time dependency for the model parameter θ 1 is convenient and somewhat simplistic but has several physical implications first as mentioned the temporal variation of the catchment storage capacity is physically interpretable for instance seasonal vegetation growth and senescence in relation to the seasonal scale variation of catchment storage and human interferences and natural wildfire for its long term changes second the more advanced t θ 1 relationships with covariates other than time are not always available particularly on a daily scale third previous research has illustrated the validity of the time dependency of model parameters such as westra et al 2014 2 3 2 spatial coherence of regression parameters in a heterogeneous region that is distinctly non uniform in climatic and geological conditions different basins within the region typically have different catchment storage capacities and different values of production store capacity θ 1 for a homogeneous region prescribed by similar climatic geological conditions in each part the production store capacity in eq 4 is expected to be the same among different catchments in the region meanwhile the basic unit of human activities is assumed as the homogeneous region rather than the basin thus the production store capacity should have similar variation trends among different catchments within the homogeneous region uncertainties in estimated time varying parameters can be reduced by considering regional information i e the spatial coherence of parameters across adjacent catchments to improve the effectiveness and suitability of the model recently many researchers used spatial coherence to obtain more precise estimations within a homogenous region chen et al 2014 lima et al 2016 merz and bloschl 2004 oudin et al 2008 patil and stieglitz 2015 renard et al 2011 sun et al 2014 in this study the spatial coherence of regression parameters eq 5 is implemented into the hb framework as the prior layer in order to improve model performance independent gaussian prior distributions are used for regression parameters α 2 and α 3 as follows 5 prior layer α 2 n μ 2 σ 2 2 α 3 n μ 3 σ 3 2 where μ 2 μ 3 σ 2 and σ 3 are the hyper parameters μ 1 μ 2 σ 2 μ 3 σ 3 and n represents the hyper distribution i e a gaussian distribution the prior layer of the hb framework aims to describe the variation of α 2 and α 3 in space by means of a gaussian spatial process in which the mean value depends on covariates describing regional characteristics the prior layer is assumed only for regression parameters α 2 and α 3 rather than α 1 and α 4 because of practical considerations firstly the intercept α 1 has an equal impact on θ 1 across the time series and thus can not reflect the temporal variation of θ 1 secondly we have derived that the results when the spatial coherence of remainder α 4 is included have lower prediction performance than scenario 4 no parameter is spatially coherent and the other three scenarios with the median nse values less than 0 4 these results did not present in the manuscript thirdly both α 2 and α 3 are more related to the variation magnitude of θ 1 and thus have the most important impacts on the variation range of θ 1 and may reflect the most significant spatial coherence for adjacent basins within a homogenous region a similar assumption was made in sun and lall 2015 and sun et al 2015 four modeling scenarios table 1 are carried out to assess the effect of spatial coherence on the time varying parameter θ 1 different levels of spatial coherence of α 2 and α 3 are assumed in the first three scenarios while no spatial coherence is assumed in the fourth scenario in addition the regression parameters α 1 and α 4 and model parameters θ 2 θ 3 and θ 4 are assumed to be basin specific for all scenarios the aim is to reduce parameter uncertainty in the time varying parameter θ 1 therefore a steady θ 1 is not considered herein but is described in westra et al 2014 in addition it should be mentioned that the proposed hb framework is just one implementable way to model the spatial coherence there are more techniques in the literature in modeling the spatial correlation such as variogram model mohebzadeh 2018 and conditional autoregressive model wang et al 2005 2 4 estimation and prediction the likelihood function and parameter inference method are used to derive the posterior distribution of all parameters including model parameters θ regression parameters γ 1 and hyper parameters μ 1 as outlined below 2 4 1 posterior distribution using the basic property of conditional probability the joint likelihood function of all unknown quantities ω θ γ 1 μ 1 is determined by combining the sampling model l q ω ξ with their prior distributions p ω under the bayesian rule 6 p ω q ξ l q ξ ω p ω p ω l q ξ ω d ω l q ξ ω p ω where the term p ω l q ξ ω d ω represents the marginal likelihood of observations and acts as a normalization constant to ensure that p ω q ξ has an integral equals to 1 in addition the uniform distribution is used as the prior distribution for all unknown quantities based on the bayesian recursive estimation algorithm proposed by thiemann et al 2001 the likelihood function with model parameters and their prior distributions p θ under stationary conditions is written as 7 p b θ b ξ b q b τ ω τ σ t exp c τ t 1 t e t θ b σ 2 1 τ p θ b where 8 ω τ γ 3 1 τ 2 1 2 1 τ γ 1 τ 2 3 2 c τ γ 3 1 τ 2 γ 1 τ 2 1 1 τ where γ refers to the gamma function t represents the number of time steps t e t represents the residual error in time step t parameter τ represents the residual error model type kavetski et al 2006 mackay 1992 perrin et al 2003 and ω and c are constants when the residual error model type is confirmed if τ 1 then the residual error model is a uniform distribution if τ 0 then the residual error model is a gaussian distribution while if τ 1 then the residual error model is a double exponential distribution in this paper τ 0 is adopted thus ω τ 0 and c τ 0 are determined as ω τ 0 γ 3 2 1 2 γ 1 2 3 2 0 3969 c τ 0 γ 3 2 γ 1 2 0 5 respectively however for any single basin b the likelihood function with unknown quantities would change when model parameter θ 1 is time varying it is the product of eq 7 but with temporal covariate the conditional probability of time varying parameters p θ 1 b t γ 1 b and the prior distribution of unknown quantities p γ 1 b the expression form can be written as 9 p b θ b t γ 1 b ξ b t q b t τ ω τ σ t exp c τ t 1 t e t θ b t γ 1 b σ 2 1 τ p θ 1 b t γ 1 b p γ 1 b p θ rem b θ rem b θ 2 b θ 3 b θ 4 b for the whole region encompassing many basins the likelihood function with unknown quantities within the hb framework is the multiplication of the right part of eq 9 the conditional probability of spatial coherence of regression parameters n i i f n γ 1 b μ n σ n and the prior distribution of hyper parameters n i i p μ n σ n the expression form can be written as 10 λ b 1 b p b θ b t γ 1 b μ 1 ξ b b t q b b t τ b 1 b ω τ σ t exp c τ t 1 t e t θ b t γ 1 b σ 2 1 τ p θ 1 b t γ 1 b n i i f n γ 1 b μ n σ n p μ n σ n p θ rem b where the number of basins in the region is represented by b i represents the subscript of regression parameters and i denotes the number of the spatially coherent regression parameters in different scenarios the values of i and i are different because different spatial coherence is included in scenario 1 i 2 and i 2 i 3 and i 3 in scenario 2 in scenario 3 i 2 and i 3 2 4 2 inference application of the hb framework described in section 2 4 1 requires estimation of the following unknown quantities 11 ω θ 2 b θ 3 b θ 4 b α 1 b μ 2 σ 2 μ 3 σ 3 α 4 b b 1 2 b the likelihood functions defined in eqs 9 and 10 pose a computational challenge because their dimensionality grows primarily related to the number of basin specific parameters with the number of basins included these unknown parameters are estimated using the shuffled complex evolution metropolis scem ua sampling method ajami et al 2007b vrugt et al 2003 2009 a widely used markov chain monte carlo algorithm for simulating the posterior probability distribution of the parameters that are conditional on the current choice of parameters and data the scem ua algorithm more efficiently reduces the number of model simulations needed to infer the posterior distribution of parameters compared with traditional metropolis hasting samplers ajami et al 2007b duan et al 2007 liu and gupta 2007 vrugt et al 2003 we checked the model convergence using the gelman rubin convergence value by evolving four parallel chains and confirmed that the convergence value was smaller than the threshold 1 2 gelman et al 2013 2 5 model performance criteria model performance is evaluated using five criteria the containing ratio cr the average relative bandwidth rb the average relative deviation amplitude rd the nash sutcliffe model efficiency coefficient nse moriasi et al 2007 nash and sutcliffe 1970 and the deviance information criterion dic spiegelhalter et al 2002 in the following discussion q sim t and q obs t represent the simulated and observed daily streamflow values for the t th day respectively q low t and q up t represent the lower and upper prediction bounds for the t th day respectively q med t represents the median streamflow of the prediction bounds for the t th day and q obs is the mean of the observed daily streamflow for the calculation interval 1 cr the containing ratio is defined as the percentage of streamflow observations that fall within the prediction interval this index is widely used for measuring the suitability of the prediction bounds xiong et al 2009 12 p q obs t q low t q up t for facilitating the comparison of results from multiple scenarios the significance level was set to 10 in this study 2 rb to eliminate the impact of streamflow magnitude on the band width of the prediction bounds a dimensionless index known as the average relative bandwidth is used to assess the prediction bounds xiong et al 2009 rb is defined as 13 rb 1 t t 1 t q up t q low t q obs t scenarios with smaller rbs are preferred since they have less uncertainty 3 rd to eliminate the impact of streamflow magnitude on the average deviation amplitude of the prediction bounds a dimensionless index known as the average relative deviation amplitude is used to assess the prediction bounds xiong et al 2009 rd is defined as 14 rd 1 t t 1 t 1 2 q up t q low t q obs t q obs t similar to the rb rd should be as small as possible to reduce estimation uncertainty 4 nse the nse is widely used in hydrological literature to evaluate the performance of the simulated streamflow it is defined as 15 nse 1 t 1 t q obs t q sim t 2 t 1 t q obs t q obs 2 the nse ranges from to 1 a nse value of 1 indicates a perfect match of the simulated streamflows with observations a negative nse value indicates that the mean observed streamflow outperforms the model simulations while a nse value of 0 indicates that the simulations predict the mean value of the streamflow observations 5 dic the dic defined by spiegelhalter et al 2002 is a measure specifically designed for bayesian model selection and can be thought as a bayesian alternative to the standard akaike information criterion the dic value for a bayesian scenario is obtained as 16 dic 2 log p q θ bayes ξ 2 p dic where p dic is the effective number of parameters and is defined as 17 p dic 2 log p q θ bayes ξ 1 s s 1 s log p q θ s ξ where the posterior mean θ bayes expect θ q ξ and s 1 s means the sequence number of the simulated parameter set θ s by the scem ua algorithm according to spiegelhalter et al 2002 bayesian scenarios with a smaller dic would be preferred to scenarios with a larger dic 3 study area and data 3 1 study area four spatially adjacent catchments in the central united states were selected as case studies to examine the validity of the proposed method locations of these four basins within the central united states are shown in fig 2 catchment ids of the selected basins in the model parameter estimation experiment mopex dataset are 7068000 6933500 7019000 and 7052500 duan et al 2006 the four basins are not majorly affected by snow accumulation or extreme weather they are adjacent to satisfy the homogeneity assumption fig 2 precipitation of the studied basins changes seasonally may is the wettest month monthly total of 124 mm and january is the driest month monthly total of 53 mm in contrast monthly pet varies from 10 mm in january to 130 mm in july furthermore the groundwater exchange coefficient parameter θ 2 in the gr4j model was assumed to be the same among basins to reduce computing time for the first three scenarios considering spatial coherence however this value was estimated individually for each basin in scenario 4 which does not consider spatial coherence i e it has no pooling verification of this assumption is given in section 3 2 2 table 2 summarizes the basic information for the four basins including the catchment area mean annual rainfall mean annual runoff coefficient and mean annual aridity index the four basins differ markedly in the catchment area the smallest is 2568 0 km2 basin 7052500 while the largest is 9805 9 km2 basin 6933500 the similar values of the last two indexes i e runoff coefficient and climate aridity index for these basins indicate a certain degree of similarity in terms of catchment rainfall runoff and pet the pearson correlation coefficients pcc sedgwick 2012 of the catchment rainfall and streamflow observations among different basins indicate a strong correlation between adjacent basins with a pcc of daily rainfall of up to 0 88 average of 0 81 and daily streamflow of up to 0 82 average of 0 70 this suggests there is a high degree of spatial similarity in their settings 3 2 data this study uses time series of daily p mm day pet mm day and streamflow mm day for four basins from the mopex dataset covering 1983 2003 a temporal parameter transfer scheme was implemented using a split sample test procedure in which the available data are divided into three periods the first period covers the first 24 months from 1 january 1983 to 31 december 1984 this period was used for model warm up to reduce the impact of the initial soil moisture conditions the second period covers from 1 january 1985 to 31 december 1995 it was used for model calibration i e parameter estimation the third period covers from 1 january 1996 to 31 december 2003 it was used for model validation in theory the pooling effect would be seen better if a much larger set of basins was included however this would violate the assumption of regional homogeneity that is different catchments in a region have similar climatic and geological conditions such as mean annual rainfall runoff coefficient and climate aridity index furthermore the objective of this study was to demonstrate the validity of the proposed framework so a case study with four catchments was considered sufficient for the purpose 4 results and discussion 4 1 model performance for four scenarios performance of the gr4j model in four modeling scenarios was assessed using the five criteria outlined in section 2 5 for both calibration and validation periods during the calibration period all scenarios exhibited good performance based on their cr values with cr values of around 90 0 for all basins table 3 the model performance within the calibration period was best for scenario 4 table 3a with a mean cr value of 92 0 cr aver 92 0 as well as the smallest average rb rb aver 2 07 and rd rd aver 0 45 values it was followed by performances for scenario 2 cr aver 94 0 rb aver 2 53 rd aver 1 42 scenario 1 cr aver 91 0 rb aver 2 74 rd aver 0 73 and scenario 3 cr aver 90 0 rb aver 3 77 rd aver 1 29 during the validation period the cr rb and rd results were quite different table 3b the model performance was best for scenario 2 cr aver 91 4 rb aver 3 25 rd aver 0 97 followed by scenario 1 cr aver 92 5 rb aver 3 34 rd aver 1 11 in this case scenario 4 exhibited the worst performance with a cr value of 82 1 indicating that a good performance based on the first three criteria during the calibration period does not ensure a similar performance during the validation period values of the nse criterion for four scenarios during the calibration and validation periods are shown in fig 3 a and b respectively during the calibration period its rank order was similar for all basins for basin 7068000 the highest performance was obtained by scenario 2 median nse 0 74 followed by scenario 3 median nse 0 63 scenario 1 median nse 0 625 and scenario 4 median nse 0 60 in fact scenario 2 exhibited the highest median nse value for three of the basins followed by scenario 1 which exhibited the highest median nse value in the remaining basin basin 6933500 in contrast scenario 4 exhibited the lowest median nse performance for all basins and had the largest nse range compared with nse values from the other three scenarios the nse rank order was similar during the validation period to which in the calibration period fig 3b scenario 2 exhibited the highest median nse for all basins followed by scenarios 1 3 and 4 sequentially compared with scenario 4 scenarios 1 2 and 3 showed an average of 5 9 and 0 3 improvement in the median nse value respectively these results indicate that scenario 4 had the best model performance in terms of the cr rb and rd criteria during the calibration period but the worst performance over the validation period table 3 in contrast scenario 2 had the best model performance based on the nse in both calibration and validation periods fig 3 it also showed the best model performance during the validation period based on cr rb and rd criteria to explore whether a specific season biased the model performance over the whole year figs 4 and 5 compare simulated streamflow in basin 6933500 for each season of an average year for scenarios 2 and 4 over both calibration and validation periods respectively the nse results of median simulated streamflow red and yellow lines in figs 4 and 5 respectively are presented in table 4 results show that scenario 2 exhibited the better performance over all seasons during the calibration period and over three seasons except for july september during the validation period it indicates that there was no significant bias related to seasonal variation on model performance over the whole year thus a different ranking order of scenarios was obtained using the nse results compared with the cr rb and rd criteria possibly the nse is more affected by occasional high flow days renard et al 2011 westra et al 2014 while the cr rb and rd criteria weigh high flow days and low flow days more equally however the ranking orders of different scenarios based on nse criterion are much more consistent during the calibration and validation periods than that based on the cr rb rd criteria indicating nse is a more reliable measure for evaluating model performance scenario 2 had the best model performance based on the first four criteria during the validation period a similar finding for the scenario was obtained using the dic measure too as illustrated in table 5 scenario 2 had the lowest dic and it was therefore selected as the best bayesian scenario for considering the spatial input among all settings this suggests it is the most reasonable one for determining spatial coherence for the parameter α 3 the amplitude of the sine term however this conclusion may be influenced by the fact that all basins are spatially adjacent and have similar climatic and geologic settings resulting in similar seasonality in their catchment water storage 4 2 parameter uncertainty analysis the purposes of this section are to verify the assumption of a consistent value among basins for model parameter θ 2 the groundwater exchange coefficient and to analyze uncertainty related to partial pooling of regression parameters α 2 and α 3 in each scenario in fig 6 four posterior distributions of θ 2 plotted using local parameters for each basin with no pooling are compared the parameter θ 2 can be positive in the case of net water import negative for net water export or zero when there is no net water exchange clearly more than 70 of the values in each posterior distribution are within the interval from 10 to 0 fig 6 while the medians of the posterior distributions are about 5 it indicates that the posterior distributions derived independently based on the observations of four basins are quite similar thus the assumption of regional consistency of θ 2 appears to be acceptable in this case as mentioned in section 2 3 2 regression parameters α 2 and α 3 are assumed to have different levels of spatial coherence in each modeling scenario table 1 these levels are compared in figs 7 and 8 respectively scenarios 1 3 had a smaller median α 2 value than that in scenario 4 for all basins fig 7 in three basins the interval range was largest for scenario 4 for all basins scenario 3 both regression parameters α 2 and α 3 are spatially coherent had the lowest median α 2 value and the narrowest interquartile range followed sequentially by scenario 1 only regression parameter α 2 is spatially coherent scenario 2 only regression parameter α 3 is spatially coherent and scenario 4 no regression parameter is spatially coherent the narrower uncertainties were achieved by scenarios 1 and 3 that are both related to a spatially coherent parameter α 2 it indicates that assuming spatial coherence for parameter α 2 helps reduce its estimation uncertainty similarly for parameter α 3 fig 8 scenario 3 had the lowest median α 3 value and the narrowest interval for all basins followed sequentially by scenario 2 scenario 1 and scenario 4 the narrower uncertainties were achieved by scenarios 2 and 3 which are both related to a spatially coherent parameter α 3 it indicates that the spatial coherence of parameter α 3 reduces its estimation uncertainty thus these results demonstrate that assuming spatial coherence for parameter α 2 and or α 3 between adjacent basins within the hb framework can reduce its parameter uncertainty when compared with results of an estimation method with no pooling scenario 4 in fact assuming that all parameters α 2 and α 3 are spatially coherent scenario 3 yielded the narrowest estimation intervals the primary contributions to the narrowest estimation intervals of α 2 and α 3 in scenario 3 are related to the narrowest intervals of hyper parameters μ 2 and μ 3 that describe the average of the posterior distributions of α 2 and α 3 respectively fig 9 shows the posterior distributions of hyper parameters μ 2 μ 3 σ 2 and σ 3 clearly the intervals of σ 2 and σ 3 in scenario 3 are similar to those in scenarios 1 and 2 but the intervals of μ 2 and μ 3 are much narrower than those in scenarios 1 and 2 this confirms that the reduced intervals in μ 2 and μ 3 support the narrower estimation intervals of α 2 and α 3 in scenario 3 comparison of the optimal scenarios from parameter uncertainty analysis and that from model performance evaluation demonstrates that scenarios 1 only regression parameter α 2 is spatially coherent and 2 only regression parameter α 3 is spatially coherent are both successful in reducing parameter uncertainty and improving model prediction performance while scenario 3 all regression parameters are spatially coherent appears to overparameterize the model scenario 3 that includes both spatial coherence α 2 and α 3 of different basins does not improve model prediction performance when it was compared with scenarios in which only one of these regression parameters is assumed as spatially coherent i e scenarios 1 and 2 all in all scenario 2 is successful in reducing parameter uncertainty and has the best overall model prediction performance based on all evaluation criteria during the validation period thus it is considered as the optimal scenario for basin research this suggests that the seasonal coherence parameter α 3 is the paramount factor in constraining the time varying parameter and improving the model prediction accuracy in the studied basins it in turn verifies that the spatially adjacent basins have similar seasonality in catchment water storage clearly the use of this characteristic in models helps improve their performance and reduce prediction uncertainty under nonstationary conditions 5 conclusions in this paper spatial coherence is used to reduce uncertainty in the main time varying parameter of a lumped hydrological model gr4j using a two level hb framework the proposed method was applied to four spatially adjacent catchments within the central united states within the proposed hb framework the most sensitive parameter in the gr4j model i e the production store capacity θ 1 was allowed to vary with time to represent potential temporal variation in this parameter over the two different time scales i e the seasonal scale variation and long term changes the seasonal scale variation in catchment storage capacity was represented by a sine function for θ 1 parameterized by amplitude and remainder long term change to catchment storage capacity was represented by a linear function of θ 1 in the prior layer of assessment four modeling scenarios were used to quantify the influence of different magnitudes of spatial coherence in regression parameters α 2 and α 3 on the time varying formulation of θ 1 results show that 1 the proposed method succeeded in reducing the uncertainty of the time varying parameter θ 1 and improving the model prediction performance over the validation period and 2 the assumption of spatial coherence in α 3 between different basins improved model prediction performance by an average of 9 reflecting similar patterns of seasonality in spatially adjacent basins this study improved our understanding of the connection between time varying parameters and spatial coherence which helps improve hydrological prediction in future periods however because this study was confined to four basins further research is needed to understand relationships between spatial coherence and temporal variation of model time varying parameters at more regions in addition this study assumes that streamflow error is homeostatic i e constant over time for convenient bayesian inference nevertheless the real streamflow error is heterostatic because a large error is usually associated with a large flood thus further study is needed to evaluate the performance of the proposed method when the heterogeneity of streamflow error is included acknowledgements this study was supported by the national key research and development program 2016yfc0400907 the national natural science foundation of china 51579180 51861125102 and the research council of norway frinatek project 274310 the authors would like to thank the editor and anonymous reviewers for their comments that helped improve the quality of the paper 
6191,hydrological processes became non stationary under the influences of climate change and human activities this non stationarity highlights the need to adopt time varying parameters in hydrological models the majority of existing literature quantifies time varying parameters by incorporating real observations of single basin into a hydrological model they are limited in their information on catchment characteristics and climatic factors to constrain time varying parameters thus models are difficult to apply for hydrological predictions outside the calibration periods this paper formulated the time varying parameters for a lumped hydrological model as explicit functions of physically based covariates that captured the catchment characteristics then it used a hierarchical bayesian framework to incorporate the similarity of adjacent basins to reduce the uncertainty of the assumed functions for time varying parameters four modeling scenarios were developed to explore the spatial coherence between different characteristics of adjacent basins five criteria were adopted to evaluate the performance of assumed functional forms four spatially adjacent catchments in the central united states were selected as case studies to examine the validity of the proposed method results showed that 1 the proposed method succeeded in reducing the uncertainty of time varying parameters and 2 the seasonality of the catchment storage was more coherent between adjacent basins indicated by the largest increase in model prediction performance i e 9 this study improved the understanding of the spatial coherence of time varying parameters which helps improve hydrological predictions in the future keywords uncertainty hierarchical bayesian temporal variation spatial coherence nonstationary condition gr4j hydrological model 1 introduction study of hydrological processes is of vital importance for understanding of hydrological cycle and for improving prediction ability of hydrological models conventionally hydrological processes are assumed to be stationary so that hydrological model parameters calibrated with historical data can be applied to predict catchment behavior in the near future broderick et al 2016 coron et al 2012 fowler et al 2016 patil and stieglitz 2015 renard et al 2011 westra et al 2014 fowler et al 2016 patil and stieglitz 2015 renard et al 2011 westra et al 2014 this implies that both catchment characteristics e g vegetation coverage and catchment topography and climate conditions e g annual mean rainfall and evapotranspiration remain unchanged between the historical periods and future periods however many researchers have identified the non stationarity of hydrological processes because of the influence of climate change and anthropogenic activity broderick et al 2016 chiew et al 2009 ciais et al 2005 deng et al 2016 liu et al 2015 milly et al 2008 2015 patil and stieglitz 2015 sun et al 2014 wang and fu 2018 for example a warming climate increases the capacity of the atmosphere to hold and transport atmospheric water which directly affects the partition of precipitation between evapotranspiration and runoff brigode et al 2013 guo et al 2017b milly et al 2008 2015 pathiraja et al 2016 yin et al 2018 furthermore the construction of dams and afforestation can lead to an increase in the production store capacity of catchments while deforestation can result in a decrease in the production store capacity feng et al 2017 liu et al 2011 ming et al 2017 2018 pan et al 2018 tian et al 2019 thus it is not appropriate to treat model parameters as time invariant in hydrological prediction extensive research has illustrated that parameters in hydrological models do vary in time brigode et al 2013 broderick et al 2016 deng et al 2016 2018 guo et al 2018 merz et al 2011 milly et al 2008 2015 montanari et al 2013 moradkhani et al 2012 2018 2005b pathiraja et al 2018a 2016 2018b westra et al 2014 for example merz et al 2011 found that the calibrated parameters representing snow and soil moisture processes showed significant trends during historical periods in the study area deng et al 2016 indicated that the model parameters denoting the water storage capacity of catchments had an apparent increasing trend during the historical periods in the study area however it is still a challenge to quantify the uncertainty within the estimated time varying parameters and achieve an accurate hydrological prediction with such parameters ajami et al 2007a bracken et al 2018 brigode et al 2013 broderick et al 2016 pathiraja et al 2016 patil and stieglitz 2015 renard et al 2011 smith et al 2014 westra et al 2014 the bayesian inference is one of the most widely used approaches in coping with the uncertainty of parameter estimation abbaszadeh et al 2018 2019 dechant and moradkhani 2012 deng et al 2016 liu et al 2014 marshall et al 2005 moradkhani et al 2005a b 2012 pathiraja et al 2016 2018 renard et al 2011 westra et al 2014 one of the most popular methods that based on the bayesian inference is the sequential bayesian estimation method deng et al 2016 moradkhani et al 2012 moradkhani et al 2005a b pathiraja et al 2016 2018b yan and moradkhani 2015 yan and moradkhani 2016 it identifies the potential temporal variations of model parameters by updating them in real time when observations are available generally the sequential bayesian method is useful in the identification of time varying parameters during the historical periods but is difficult to be applied for long term hydrological prediction since observation in the near future is not available the hierarchical bayesian hb framework is another promising method based on bayesian inference which reduces uncertainty in parameter estimation by considering multiple levels usually two levels of information to constrain the time varying parameters ahn et al 2017 cha et al 2016 chen et al 2014 ganguli and coulibaly 2017 kwon et al 2008 lima and lall 2009 sun and lall 2015 sun et al 2015 it has been successfully applied in extreme event analysis e g extreme rainfall and extreme flow to include the coherence between characteristics in different stations and or climatic variables such as connections among exogenous climate variables and extreme rainfall ahn et al 2017 chen et al 2014 lima and lall 2009 exogenous climate variables and extreme flow gaume et al 2010 coherence of extreme flow at different stations cha et al 2016 lima et al 2016 sun and lall 2015 and variation of extreme rainfall at different stations sun et al 2015 in principle the spatial coherence between characteristics of adjacent stations is much more significant than that between stations and exogenous climate variables e g el niño and arctic oscillation because the exogenous climate variables lend themselves to contain larger uncertainties in their acquisition processes rasanen et al 2016 schliep et al 2010 in the field of hydrological modeling the conventional use of coherence between different catchments is known as parameter regionalization a method scheme of transferring parameters calibrated in one basin to another basin based on spatial proximity and physical similarity lebecherel et al 2016 merz and bloschl 2004 oudin et al 2008 parajka et al 2005 sellami et al 2014 singh et al 2012 steinschneider et al 2015 it means that parameters that are calibrated in one basin are used directly in the modeling of its neighboring or similar basins lebecherel et al 2016 sellami et al 2014 singh et al 2012 steinschneider et al 2015 it is acceptable for the hydrological modeling in ungauged basins that lack hydrological records however it is questionable for quantifying the functions of time varying parameters which focused more on a predictive result of changed conditions thus this study attempted to discover whether the hb method could be adapted to include the spatial coherence of adjacent basins in hydrological modeling with time varying parameters the primary objectives of this study were to answer three research questions 1 whether the similarity between adjacent catchments can be used to reduce parameter uncertainty and improve the performance of hydrological modeling 2 how the similarity of adjacent catchments can be incorporated into the time varying parameters within the hb framework and 3 which catchment characteristic has the most significant influence on reducing uncertainties of time varying parameters and consequently improving model performance the rest of this paper is organized as follows in section 2 a method that embeds in the hb framework is proposed to utilize the catchment similarity to reduce the uncertainty of time varying parameters in section 3 a case study is selected to validate the effectiveness of the proposed method in section 4 the main conclusions are provided 2 methodology in this section a hb framework with the consideration of similarity in the characteristics of adjacent basins is proposed to constrain uncertainty associated with an estimated time varying parameter of a lumped hydrological model assessing such uncertainty requires both a hydrological model and a pooling estimation method therefore a daily lumped hydrological model is selected as outlined in section 2 1 the pooling estimation method is presented in section 2 2 providing the foundation for the hb framework meanwhile the two level hb framework is described in section 2 3 its first level the process layer models the temporal variation of model parameters using a regression function section 2 3 1 while its second level the prior layer models the spatial coherence of the regression parameters section 2 3 2 the likelihood function and parameter estimation methods are outlined in section 2 4 finally the criteria used to evaluate the model performance for various model scenarios are outlined in section 2 5 2 1 the hydrological model the hydrological model used in this study is the gr4j modèle du génie rural à 4 paramètres journalier which is a lumped conceptual rainfall runoff model perrin et al 2003 the original version of the gr4j model perrin et al 2003 comprised four parameters production store capacity θ 1 unit of mm groundwater exchange coefficient θ 2 unit of mm 1 day ahead maximum capacity of the routing store θ 3 unit of mm and the time base of the unit hydrograph θ 4 unit of day all four parameters are real numbers θ 1 θ 3 and θ 4 are positive while θ 2 can be either positive zero or negative in the gr4j model precipitation is initially intercepted by the vegetation canopy and then is divided into surface runoff and a soil water storage where θ 1 is the maximum capacity of the production store of the soil the total runoff including the underground flow and the surface runoff is then empirically divided into fast and slow routing processes ninety percent of the runoff is propagated through slow routing with a unit hydrograph uh1 while the other 10 of the total runoff is propagated through fast routing with another single unit hydrograph uh2 both unit hydrographs depend on the same time parameter θ 4 expressed in days additionally a groundwater exchange that acts on both flow components is calculated with parameters θ 2 and θ 3 more details on the gr4j model can be found in perrin et al 2003 the gr4j model is selected because of its high performance in simulating both high and low flows and the model has been applied successfully across a wide range of hydro climatic conditions brigode et al 2013 demirel et al 2013 khan et al 2018 le moine et al 2008 oudin et al 2008 perrin et al 2003 saft et al 2016 westra et al 2014 this makes the gr4j model particularly suitable as a starting point for implementing modifications to improve its estimation accuracy in this study various versions based on this model are constructed for the purposes of reducing estimation uncertainty of model parameters and interpreting the possible relationship between adjacent basins considering temporal variation and multiple spatial coherence schemes of the model parameter θ 1 2 2 pooling estimation when conditions are steady parameters in a hydrological model should be time invariant however under nonstationary conditions these parameters will vary with time and space 1 q h θ b t ξ e where q represents observations of streamflow h represents the hydrological model θ b t θ m m 1 m are model parameters where m is the number of model parameters b is the index of basins and t is the time step ξ represents the time series of hydrological input including precipitation p and potential evapotranspiration pet e represents the residual error in the simulated streamflow with zero expectation and constant variance σ 2 each model parameter can potentially be written as a function of covariates e g having both a time and climate index for example a component of θ b t can be modeled as θ m b t α 1 b α 2 t where θ m is the selected time varying model parameter α 1 b is a local basin specific regression parameter α 2 is a regional regression parameter which is common to all basins more generally this regression function can be written as 2 θ m b t r γ m f b t where r is a general regression function γ m is the collection of regression parameters in the function and f b t represents a set of covariates defined with respect to basin b and time step t the parameter collection γ m can be stratified into two parts γ m loc and γ m reg where γ m loc is the collection of local basin specific parameters and γ m reg is the collection of regional parameters in a hb framework there are three options for pooling information about regression parameters across basins the first option has no pooling i e involving only γ m loc which means that all regression parameters of different basins are estimated as independent variables the second option has full pooling i e involving only γ m reg which means that regression parameters are assumed to be common for all basins meanwhile the third option involves partial pooling i e both γ m loc and γ m reg are used which means that some regression model parameters are assumed to be drawn from a common hyper distribution d m across all basins while others are assumed to be basin specific estimates the same regression parameters for different basins are recognized as independent variables the no pooling and the full pooling options represent two endpoints of the partial pooling model typically the partial pooling estimate shrinks the local parameter toward the common regional mean and includes an estimation of its variance or covariance across the basins a schematic of the partial pooling model is presented in fig 1 in the hb framework the process layer represents the temporal variation regression function of the model parameters and the prior layer represents the spatial coherence of the regression parameters in particular γ m reg is assumed to follow a hyper distribution in the prior layer 3 γ m reg d m μ m where μ m represents the collection of hyper parameters 2 3 the hb framework for the time varying model parameter 2 3 1 temporal variation of the model parameter in the gr4j model parameter θ 1 is allowed to vary in time to represent several potential time scales of variation m 1 the reason for choosing θ 1 as a time varying parameter is that it represents the primary storage of water in the catchment previous studies have reported that θ 1 is the most sensitive parameter within the gr4j model and stochastic variations of θ 1 have the largest impact on model predictions guo et al 2017a oudin et al 2018 perrin et al 2003 renard et al 2011 westra et al 2014 wright et al 2015 zhang et al 2018 the temporal variation of the catchment storage capacity is also physically interpretable seasonal variation in the production store capacity θ 1 may be induced by seasonal vegetation growth and senescence long term change may be induced by wildfire and deforestation which can result in a decrease in θ 1 meanwhile human interferences such as the building of dams can lead to an increase in θ 1 in this study θ 1 is constructed to account for both seasonal scale and long term variations as described in westra et al 2014 1 seasonal scale variation in catchment storage capacity θ 1 is described by a sine function using amplitude and phase 2 long term change in response to catchment storage capacity is represented by a linear trend in θ 1 for any basin b the full temporal variation model regression function for θ 1 is 4 process layer θ 1 b α 1 b α 2 t α 3 sin 2 π α 4 b t 365 where α 1 α 2 α 3 and α 4 are four regression parameters γ 1 α 1 α 2 α 3 α 4 parameter α 1 signifies the intercept α 2 represents the slope of the t θ 1 relationship α 2 and α 3 represent the amplitude and remainder of the sine function respectively if model parameter θ 1 is assumed to be stationary then α 2 0 and α 3 0 suffice in eq 4 and the resulting model simplifies to the stationary hydrological model the use of a time dependency for the model parameter θ 1 is convenient and somewhat simplistic but has several physical implications first as mentioned the temporal variation of the catchment storage capacity is physically interpretable for instance seasonal vegetation growth and senescence in relation to the seasonal scale variation of catchment storage and human interferences and natural wildfire for its long term changes second the more advanced t θ 1 relationships with covariates other than time are not always available particularly on a daily scale third previous research has illustrated the validity of the time dependency of model parameters such as westra et al 2014 2 3 2 spatial coherence of regression parameters in a heterogeneous region that is distinctly non uniform in climatic and geological conditions different basins within the region typically have different catchment storage capacities and different values of production store capacity θ 1 for a homogeneous region prescribed by similar climatic geological conditions in each part the production store capacity in eq 4 is expected to be the same among different catchments in the region meanwhile the basic unit of human activities is assumed as the homogeneous region rather than the basin thus the production store capacity should have similar variation trends among different catchments within the homogeneous region uncertainties in estimated time varying parameters can be reduced by considering regional information i e the spatial coherence of parameters across adjacent catchments to improve the effectiveness and suitability of the model recently many researchers used spatial coherence to obtain more precise estimations within a homogenous region chen et al 2014 lima et al 2016 merz and bloschl 2004 oudin et al 2008 patil and stieglitz 2015 renard et al 2011 sun et al 2014 in this study the spatial coherence of regression parameters eq 5 is implemented into the hb framework as the prior layer in order to improve model performance independent gaussian prior distributions are used for regression parameters α 2 and α 3 as follows 5 prior layer α 2 n μ 2 σ 2 2 α 3 n μ 3 σ 3 2 where μ 2 μ 3 σ 2 and σ 3 are the hyper parameters μ 1 μ 2 σ 2 μ 3 σ 3 and n represents the hyper distribution i e a gaussian distribution the prior layer of the hb framework aims to describe the variation of α 2 and α 3 in space by means of a gaussian spatial process in which the mean value depends on covariates describing regional characteristics the prior layer is assumed only for regression parameters α 2 and α 3 rather than α 1 and α 4 because of practical considerations firstly the intercept α 1 has an equal impact on θ 1 across the time series and thus can not reflect the temporal variation of θ 1 secondly we have derived that the results when the spatial coherence of remainder α 4 is included have lower prediction performance than scenario 4 no parameter is spatially coherent and the other three scenarios with the median nse values less than 0 4 these results did not present in the manuscript thirdly both α 2 and α 3 are more related to the variation magnitude of θ 1 and thus have the most important impacts on the variation range of θ 1 and may reflect the most significant spatial coherence for adjacent basins within a homogenous region a similar assumption was made in sun and lall 2015 and sun et al 2015 four modeling scenarios table 1 are carried out to assess the effect of spatial coherence on the time varying parameter θ 1 different levels of spatial coherence of α 2 and α 3 are assumed in the first three scenarios while no spatial coherence is assumed in the fourth scenario in addition the regression parameters α 1 and α 4 and model parameters θ 2 θ 3 and θ 4 are assumed to be basin specific for all scenarios the aim is to reduce parameter uncertainty in the time varying parameter θ 1 therefore a steady θ 1 is not considered herein but is described in westra et al 2014 in addition it should be mentioned that the proposed hb framework is just one implementable way to model the spatial coherence there are more techniques in the literature in modeling the spatial correlation such as variogram model mohebzadeh 2018 and conditional autoregressive model wang et al 2005 2 4 estimation and prediction the likelihood function and parameter inference method are used to derive the posterior distribution of all parameters including model parameters θ regression parameters γ 1 and hyper parameters μ 1 as outlined below 2 4 1 posterior distribution using the basic property of conditional probability the joint likelihood function of all unknown quantities ω θ γ 1 μ 1 is determined by combining the sampling model l q ω ξ with their prior distributions p ω under the bayesian rule 6 p ω q ξ l q ξ ω p ω p ω l q ξ ω d ω l q ξ ω p ω where the term p ω l q ξ ω d ω represents the marginal likelihood of observations and acts as a normalization constant to ensure that p ω q ξ has an integral equals to 1 in addition the uniform distribution is used as the prior distribution for all unknown quantities based on the bayesian recursive estimation algorithm proposed by thiemann et al 2001 the likelihood function with model parameters and their prior distributions p θ under stationary conditions is written as 7 p b θ b ξ b q b τ ω τ σ t exp c τ t 1 t e t θ b σ 2 1 τ p θ b where 8 ω τ γ 3 1 τ 2 1 2 1 τ γ 1 τ 2 3 2 c τ γ 3 1 τ 2 γ 1 τ 2 1 1 τ where γ refers to the gamma function t represents the number of time steps t e t represents the residual error in time step t parameter τ represents the residual error model type kavetski et al 2006 mackay 1992 perrin et al 2003 and ω and c are constants when the residual error model type is confirmed if τ 1 then the residual error model is a uniform distribution if τ 0 then the residual error model is a gaussian distribution while if τ 1 then the residual error model is a double exponential distribution in this paper τ 0 is adopted thus ω τ 0 and c τ 0 are determined as ω τ 0 γ 3 2 1 2 γ 1 2 3 2 0 3969 c τ 0 γ 3 2 γ 1 2 0 5 respectively however for any single basin b the likelihood function with unknown quantities would change when model parameter θ 1 is time varying it is the product of eq 7 but with temporal covariate the conditional probability of time varying parameters p θ 1 b t γ 1 b and the prior distribution of unknown quantities p γ 1 b the expression form can be written as 9 p b θ b t γ 1 b ξ b t q b t τ ω τ σ t exp c τ t 1 t e t θ b t γ 1 b σ 2 1 τ p θ 1 b t γ 1 b p γ 1 b p θ rem b θ rem b θ 2 b θ 3 b θ 4 b for the whole region encompassing many basins the likelihood function with unknown quantities within the hb framework is the multiplication of the right part of eq 9 the conditional probability of spatial coherence of regression parameters n i i f n γ 1 b μ n σ n and the prior distribution of hyper parameters n i i p μ n σ n the expression form can be written as 10 λ b 1 b p b θ b t γ 1 b μ 1 ξ b b t q b b t τ b 1 b ω τ σ t exp c τ t 1 t e t θ b t γ 1 b σ 2 1 τ p θ 1 b t γ 1 b n i i f n γ 1 b μ n σ n p μ n σ n p θ rem b where the number of basins in the region is represented by b i represents the subscript of regression parameters and i denotes the number of the spatially coherent regression parameters in different scenarios the values of i and i are different because different spatial coherence is included in scenario 1 i 2 and i 2 i 3 and i 3 in scenario 2 in scenario 3 i 2 and i 3 2 4 2 inference application of the hb framework described in section 2 4 1 requires estimation of the following unknown quantities 11 ω θ 2 b θ 3 b θ 4 b α 1 b μ 2 σ 2 μ 3 σ 3 α 4 b b 1 2 b the likelihood functions defined in eqs 9 and 10 pose a computational challenge because their dimensionality grows primarily related to the number of basin specific parameters with the number of basins included these unknown parameters are estimated using the shuffled complex evolution metropolis scem ua sampling method ajami et al 2007b vrugt et al 2003 2009 a widely used markov chain monte carlo algorithm for simulating the posterior probability distribution of the parameters that are conditional on the current choice of parameters and data the scem ua algorithm more efficiently reduces the number of model simulations needed to infer the posterior distribution of parameters compared with traditional metropolis hasting samplers ajami et al 2007b duan et al 2007 liu and gupta 2007 vrugt et al 2003 we checked the model convergence using the gelman rubin convergence value by evolving four parallel chains and confirmed that the convergence value was smaller than the threshold 1 2 gelman et al 2013 2 5 model performance criteria model performance is evaluated using five criteria the containing ratio cr the average relative bandwidth rb the average relative deviation amplitude rd the nash sutcliffe model efficiency coefficient nse moriasi et al 2007 nash and sutcliffe 1970 and the deviance information criterion dic spiegelhalter et al 2002 in the following discussion q sim t and q obs t represent the simulated and observed daily streamflow values for the t th day respectively q low t and q up t represent the lower and upper prediction bounds for the t th day respectively q med t represents the median streamflow of the prediction bounds for the t th day and q obs is the mean of the observed daily streamflow for the calculation interval 1 cr the containing ratio is defined as the percentage of streamflow observations that fall within the prediction interval this index is widely used for measuring the suitability of the prediction bounds xiong et al 2009 12 p q obs t q low t q up t for facilitating the comparison of results from multiple scenarios the significance level was set to 10 in this study 2 rb to eliminate the impact of streamflow magnitude on the band width of the prediction bounds a dimensionless index known as the average relative bandwidth is used to assess the prediction bounds xiong et al 2009 rb is defined as 13 rb 1 t t 1 t q up t q low t q obs t scenarios with smaller rbs are preferred since they have less uncertainty 3 rd to eliminate the impact of streamflow magnitude on the average deviation amplitude of the prediction bounds a dimensionless index known as the average relative deviation amplitude is used to assess the prediction bounds xiong et al 2009 rd is defined as 14 rd 1 t t 1 t 1 2 q up t q low t q obs t q obs t similar to the rb rd should be as small as possible to reduce estimation uncertainty 4 nse the nse is widely used in hydrological literature to evaluate the performance of the simulated streamflow it is defined as 15 nse 1 t 1 t q obs t q sim t 2 t 1 t q obs t q obs 2 the nse ranges from to 1 a nse value of 1 indicates a perfect match of the simulated streamflows with observations a negative nse value indicates that the mean observed streamflow outperforms the model simulations while a nse value of 0 indicates that the simulations predict the mean value of the streamflow observations 5 dic the dic defined by spiegelhalter et al 2002 is a measure specifically designed for bayesian model selection and can be thought as a bayesian alternative to the standard akaike information criterion the dic value for a bayesian scenario is obtained as 16 dic 2 log p q θ bayes ξ 2 p dic where p dic is the effective number of parameters and is defined as 17 p dic 2 log p q θ bayes ξ 1 s s 1 s log p q θ s ξ where the posterior mean θ bayes expect θ q ξ and s 1 s means the sequence number of the simulated parameter set θ s by the scem ua algorithm according to spiegelhalter et al 2002 bayesian scenarios with a smaller dic would be preferred to scenarios with a larger dic 3 study area and data 3 1 study area four spatially adjacent catchments in the central united states were selected as case studies to examine the validity of the proposed method locations of these four basins within the central united states are shown in fig 2 catchment ids of the selected basins in the model parameter estimation experiment mopex dataset are 7068000 6933500 7019000 and 7052500 duan et al 2006 the four basins are not majorly affected by snow accumulation or extreme weather they are adjacent to satisfy the homogeneity assumption fig 2 precipitation of the studied basins changes seasonally may is the wettest month monthly total of 124 mm and january is the driest month monthly total of 53 mm in contrast monthly pet varies from 10 mm in january to 130 mm in july furthermore the groundwater exchange coefficient parameter θ 2 in the gr4j model was assumed to be the same among basins to reduce computing time for the first three scenarios considering spatial coherence however this value was estimated individually for each basin in scenario 4 which does not consider spatial coherence i e it has no pooling verification of this assumption is given in section 3 2 2 table 2 summarizes the basic information for the four basins including the catchment area mean annual rainfall mean annual runoff coefficient and mean annual aridity index the four basins differ markedly in the catchment area the smallest is 2568 0 km2 basin 7052500 while the largest is 9805 9 km2 basin 6933500 the similar values of the last two indexes i e runoff coefficient and climate aridity index for these basins indicate a certain degree of similarity in terms of catchment rainfall runoff and pet the pearson correlation coefficients pcc sedgwick 2012 of the catchment rainfall and streamflow observations among different basins indicate a strong correlation between adjacent basins with a pcc of daily rainfall of up to 0 88 average of 0 81 and daily streamflow of up to 0 82 average of 0 70 this suggests there is a high degree of spatial similarity in their settings 3 2 data this study uses time series of daily p mm day pet mm day and streamflow mm day for four basins from the mopex dataset covering 1983 2003 a temporal parameter transfer scheme was implemented using a split sample test procedure in which the available data are divided into three periods the first period covers the first 24 months from 1 january 1983 to 31 december 1984 this period was used for model warm up to reduce the impact of the initial soil moisture conditions the second period covers from 1 january 1985 to 31 december 1995 it was used for model calibration i e parameter estimation the third period covers from 1 january 1996 to 31 december 2003 it was used for model validation in theory the pooling effect would be seen better if a much larger set of basins was included however this would violate the assumption of regional homogeneity that is different catchments in a region have similar climatic and geological conditions such as mean annual rainfall runoff coefficient and climate aridity index furthermore the objective of this study was to demonstrate the validity of the proposed framework so a case study with four catchments was considered sufficient for the purpose 4 results and discussion 4 1 model performance for four scenarios performance of the gr4j model in four modeling scenarios was assessed using the five criteria outlined in section 2 5 for both calibration and validation periods during the calibration period all scenarios exhibited good performance based on their cr values with cr values of around 90 0 for all basins table 3 the model performance within the calibration period was best for scenario 4 table 3a with a mean cr value of 92 0 cr aver 92 0 as well as the smallest average rb rb aver 2 07 and rd rd aver 0 45 values it was followed by performances for scenario 2 cr aver 94 0 rb aver 2 53 rd aver 1 42 scenario 1 cr aver 91 0 rb aver 2 74 rd aver 0 73 and scenario 3 cr aver 90 0 rb aver 3 77 rd aver 1 29 during the validation period the cr rb and rd results were quite different table 3b the model performance was best for scenario 2 cr aver 91 4 rb aver 3 25 rd aver 0 97 followed by scenario 1 cr aver 92 5 rb aver 3 34 rd aver 1 11 in this case scenario 4 exhibited the worst performance with a cr value of 82 1 indicating that a good performance based on the first three criteria during the calibration period does not ensure a similar performance during the validation period values of the nse criterion for four scenarios during the calibration and validation periods are shown in fig 3 a and b respectively during the calibration period its rank order was similar for all basins for basin 7068000 the highest performance was obtained by scenario 2 median nse 0 74 followed by scenario 3 median nse 0 63 scenario 1 median nse 0 625 and scenario 4 median nse 0 60 in fact scenario 2 exhibited the highest median nse value for three of the basins followed by scenario 1 which exhibited the highest median nse value in the remaining basin basin 6933500 in contrast scenario 4 exhibited the lowest median nse performance for all basins and had the largest nse range compared with nse values from the other three scenarios the nse rank order was similar during the validation period to which in the calibration period fig 3b scenario 2 exhibited the highest median nse for all basins followed by scenarios 1 3 and 4 sequentially compared with scenario 4 scenarios 1 2 and 3 showed an average of 5 9 and 0 3 improvement in the median nse value respectively these results indicate that scenario 4 had the best model performance in terms of the cr rb and rd criteria during the calibration period but the worst performance over the validation period table 3 in contrast scenario 2 had the best model performance based on the nse in both calibration and validation periods fig 3 it also showed the best model performance during the validation period based on cr rb and rd criteria to explore whether a specific season biased the model performance over the whole year figs 4 and 5 compare simulated streamflow in basin 6933500 for each season of an average year for scenarios 2 and 4 over both calibration and validation periods respectively the nse results of median simulated streamflow red and yellow lines in figs 4 and 5 respectively are presented in table 4 results show that scenario 2 exhibited the better performance over all seasons during the calibration period and over three seasons except for july september during the validation period it indicates that there was no significant bias related to seasonal variation on model performance over the whole year thus a different ranking order of scenarios was obtained using the nse results compared with the cr rb and rd criteria possibly the nse is more affected by occasional high flow days renard et al 2011 westra et al 2014 while the cr rb and rd criteria weigh high flow days and low flow days more equally however the ranking orders of different scenarios based on nse criterion are much more consistent during the calibration and validation periods than that based on the cr rb rd criteria indicating nse is a more reliable measure for evaluating model performance scenario 2 had the best model performance based on the first four criteria during the validation period a similar finding for the scenario was obtained using the dic measure too as illustrated in table 5 scenario 2 had the lowest dic and it was therefore selected as the best bayesian scenario for considering the spatial input among all settings this suggests it is the most reasonable one for determining spatial coherence for the parameter α 3 the amplitude of the sine term however this conclusion may be influenced by the fact that all basins are spatially adjacent and have similar climatic and geologic settings resulting in similar seasonality in their catchment water storage 4 2 parameter uncertainty analysis the purposes of this section are to verify the assumption of a consistent value among basins for model parameter θ 2 the groundwater exchange coefficient and to analyze uncertainty related to partial pooling of regression parameters α 2 and α 3 in each scenario in fig 6 four posterior distributions of θ 2 plotted using local parameters for each basin with no pooling are compared the parameter θ 2 can be positive in the case of net water import negative for net water export or zero when there is no net water exchange clearly more than 70 of the values in each posterior distribution are within the interval from 10 to 0 fig 6 while the medians of the posterior distributions are about 5 it indicates that the posterior distributions derived independently based on the observations of four basins are quite similar thus the assumption of regional consistency of θ 2 appears to be acceptable in this case as mentioned in section 2 3 2 regression parameters α 2 and α 3 are assumed to have different levels of spatial coherence in each modeling scenario table 1 these levels are compared in figs 7 and 8 respectively scenarios 1 3 had a smaller median α 2 value than that in scenario 4 for all basins fig 7 in three basins the interval range was largest for scenario 4 for all basins scenario 3 both regression parameters α 2 and α 3 are spatially coherent had the lowest median α 2 value and the narrowest interquartile range followed sequentially by scenario 1 only regression parameter α 2 is spatially coherent scenario 2 only regression parameter α 3 is spatially coherent and scenario 4 no regression parameter is spatially coherent the narrower uncertainties were achieved by scenarios 1 and 3 that are both related to a spatially coherent parameter α 2 it indicates that assuming spatial coherence for parameter α 2 helps reduce its estimation uncertainty similarly for parameter α 3 fig 8 scenario 3 had the lowest median α 3 value and the narrowest interval for all basins followed sequentially by scenario 2 scenario 1 and scenario 4 the narrower uncertainties were achieved by scenarios 2 and 3 which are both related to a spatially coherent parameter α 3 it indicates that the spatial coherence of parameter α 3 reduces its estimation uncertainty thus these results demonstrate that assuming spatial coherence for parameter α 2 and or α 3 between adjacent basins within the hb framework can reduce its parameter uncertainty when compared with results of an estimation method with no pooling scenario 4 in fact assuming that all parameters α 2 and α 3 are spatially coherent scenario 3 yielded the narrowest estimation intervals the primary contributions to the narrowest estimation intervals of α 2 and α 3 in scenario 3 are related to the narrowest intervals of hyper parameters μ 2 and μ 3 that describe the average of the posterior distributions of α 2 and α 3 respectively fig 9 shows the posterior distributions of hyper parameters μ 2 μ 3 σ 2 and σ 3 clearly the intervals of σ 2 and σ 3 in scenario 3 are similar to those in scenarios 1 and 2 but the intervals of μ 2 and μ 3 are much narrower than those in scenarios 1 and 2 this confirms that the reduced intervals in μ 2 and μ 3 support the narrower estimation intervals of α 2 and α 3 in scenario 3 comparison of the optimal scenarios from parameter uncertainty analysis and that from model performance evaluation demonstrates that scenarios 1 only regression parameter α 2 is spatially coherent and 2 only regression parameter α 3 is spatially coherent are both successful in reducing parameter uncertainty and improving model prediction performance while scenario 3 all regression parameters are spatially coherent appears to overparameterize the model scenario 3 that includes both spatial coherence α 2 and α 3 of different basins does not improve model prediction performance when it was compared with scenarios in which only one of these regression parameters is assumed as spatially coherent i e scenarios 1 and 2 all in all scenario 2 is successful in reducing parameter uncertainty and has the best overall model prediction performance based on all evaluation criteria during the validation period thus it is considered as the optimal scenario for basin research this suggests that the seasonal coherence parameter α 3 is the paramount factor in constraining the time varying parameter and improving the model prediction accuracy in the studied basins it in turn verifies that the spatially adjacent basins have similar seasonality in catchment water storage clearly the use of this characteristic in models helps improve their performance and reduce prediction uncertainty under nonstationary conditions 5 conclusions in this paper spatial coherence is used to reduce uncertainty in the main time varying parameter of a lumped hydrological model gr4j using a two level hb framework the proposed method was applied to four spatially adjacent catchments within the central united states within the proposed hb framework the most sensitive parameter in the gr4j model i e the production store capacity θ 1 was allowed to vary with time to represent potential temporal variation in this parameter over the two different time scales i e the seasonal scale variation and long term changes the seasonal scale variation in catchment storage capacity was represented by a sine function for θ 1 parameterized by amplitude and remainder long term change to catchment storage capacity was represented by a linear function of θ 1 in the prior layer of assessment four modeling scenarios were used to quantify the influence of different magnitudes of spatial coherence in regression parameters α 2 and α 3 on the time varying formulation of θ 1 results show that 1 the proposed method succeeded in reducing the uncertainty of the time varying parameter θ 1 and improving the model prediction performance over the validation period and 2 the assumption of spatial coherence in α 3 between different basins improved model prediction performance by an average of 9 reflecting similar patterns of seasonality in spatially adjacent basins this study improved our understanding of the connection between time varying parameters and spatial coherence which helps improve hydrological prediction in future periods however because this study was confined to four basins further research is needed to understand relationships between spatial coherence and temporal variation of model time varying parameters at more regions in addition this study assumes that streamflow error is homeostatic i e constant over time for convenient bayesian inference nevertheless the real streamflow error is heterostatic because a large error is usually associated with a large flood thus further study is needed to evaluate the performance of the proposed method when the heterogeneity of streamflow error is included acknowledgements this study was supported by the national key research and development program 2016yfc0400907 the national natural science foundation of china 51579180 51861125102 and the research council of norway frinatek project 274310 the authors would like to thank the editor and anonymous reviewers for their comments that helped improve the quality of the paper 
6192,urban areas are often covered by materials with smooth ground surface and poor water permeability which may cause problems such as increasing flow velocity and discharge this study employed the diffusion wave equation to investigate the variation of overland flow and analytical solutions were obtained by the generalized integral transformation technique examining previous research we found when the coefficients in the diffusion wave equation were treated as constants the simulated results would be mass non conservative this study corrected the coefficients which makes the flow meet the mass conservation law to improve the simulation results an alternative solution to the overland flow considering time varying rainfall and infiltration were proposed and the results were well compared with previous numerical solutions and experimental data keywords diffusion wave equation overland flow law of mass conservation time varying rainfall 1 introduction recently the sloping land in densely populated areas has been developed rapidly and large amounts of materials such as cement and asphalt have been used to cover the original surface this phenomenon causes not only a decrease of ground friction and permeability but also an increase of the surface runoff and flow velocity indicating that the originally planned drainage facilities may not be able to cope with such a great change and thus probably cause flooding in the lowlands therefore predicting changes of surface water flow caused by rainfall has become an important issue the saint venant equation often employed to describe the surface water flow or open channel flow is a highly nonlinear partial differential equation based on continuity equations and dynamic wave theory so it is difficult to directly obtain an analytical solution to this equation as such most of the previous studies have solved the equation by numerical methods otherwise some researchers simplify the fully equation to a kinematic wave equation or a diffusion wave equation to explain the overland flow however the values of the diffusion wave celerity and diffusion coefficient in the diffusion wave equation are variable in the process of motion depending on the flow velocity and water depth kazezyılmaz alhan 2012 henderson 1966 classified the process of flood wave translation as a transient flow problem and delineated the derivation process of the linear diffusion wave equation by combining the continuity equation and the momentum equation ponce 1989 explained that because the diffusion coefficient is inversely proportional to the slope of the bed when the slope decreases to a certain extent the diffusion term becomes more significant when the diffusion wave theory is applied to a bed slope from 0 001 to 0 0001 the influence of the diffusion term becomes quite obvious the slower the slope the greater influence of the diffusion term on the hydraulic phenomenon yen and tsai 2001 integrated the factors and expressions of the kinematic diffusion and dynamic wave modes employed in previous research they said that a few studies based on the diffusion wave theory considered some of the inertial force terms in the momentum equation therefore they defined non inertial waves as waves ignoring all the inertial terms to clearly express its physical meaning kazezyılmaz alhan 2012 improved the solution to the diffusion wave equation proposed by kazezyılmaz alhan and medina 2007 in the paper he employed the de hoog algorithm for laplace inversion to deal with the diffusion wave equation with variable hydraulic diffusivity and wave celerity under rainfall events with both constant and variable rainfall intensity nevertheless there is an amount of discrepancy between their improved analytical solutions and the numerical solutions based on the theory of diffusion wave jain and singh 2005 combined with the digital elevation model to obtain more accurate local geology and hydrological conditions the simulated areas were distinguished into land use patterns and soil textures and hydraulic analysis was performed for individual area thereby they enhanced the authenticity and applicability of the results however such a huge model needs much more parameters including hydrological and geological parameters recently avazzadeh et al 2014 obtained a numerical solution of a fractional diffusion wave equation by using the radial basis function method and hosseini et al 2001 successfully usedlocal radial point interpolation method to solve the fractional diffusion wave equation both studies solved the variable coefficients diffusion wave equation and developed numerical models they provided a good technique in computational physics yang et al 2015 used the linear diffusion wave equation to analyze the difference of flood peak flow rate and time to peak between rural and urban areas they also explained the estimation method of the parameters used in rural areas and then roughly evaluated the parameters of urban areas based on the shift of pavement roughness between nazari 2017 also employed diffusion wave theory to analyze the river flows using the laplace transform method and the finite difference method to solve the equation because the parameters of the diffusion wave equation will change with hydrological and geographical conditions it is quite difficult to solve such problems by analytical approaches therefore the spatiotemporal variability of the parameters was mostly considered by numerical methods based on the above statements traditional analytical solutions are usually obtained by the laplace transform method but the inverse laplace transform is always difficult to be found and the results do not meet the mass balance the numerical models give the approximate solutions for the nodes in the mesh and needs to interpolate the solutions between nodes therefore this study employed the generalized integral transformation technique to analytically solve the one dimensional linear diffusion wave equation and the linearized parameters was corrected by an iterative technique according to the law of mass conservation for better estimating the overland flow the inverse transform in the generalized integral transformation technique is easily obtained by taking an integration of a kernel function and the transform variable moreover the presented analytical solutions can afford the water depth and flow discharge at any point and at any time within the study area for any given time varying rainfall data 2 mathematical formulation the overland flow on a slope with an inclination angle θ is shown in fig 1 in general the rainfall covering a region of x 0 to l is variable in time and space the study presumes that the rainfall is evenly distributed within the region and perpendicular to the homogeneous slope and the infiltration rate is uniform over the pavement the continuity equation of overland flow is 1 y t q x r x t f t where y is the water depth l q is the flow discharge per unit width l 2 t r is the rainfall intensity l t f is the infiltration rate l t x is the distance l and t is the time t also the friction slope of diffusion wave and manning formula can be expressed as follows respectively 2 s f s 0 y x 3 q 1 n y 5 3 s f where s f is the friction slope and s 0 is the slope of the ground substituting 2 and 3 into 1 yields 4 y t c y x k 1 2 y x 2 r f where c is the diffusion wave celerity l t and k 1 is the diffusion coefficient l 2 t 5 c 5 3 v v 1 n y 2 3 s f 6 k 1 q 2 s f hayami 1951 linearized 4 by assuming that c and k 1 were constant values this presumption could quickly obtain an analytical solution for water depth referring to chow 1959 henderson 1966 and kazezyılmaz alhan and medina 2007 bajracharya and barry 1997 showed that such treatment of linearization had constrained the prediction of flood transmission but still could reflect the trend of flood transmission assuming that there is no surface water flow before raining the initial and boundary conditions are as follows kazezyılmaz alhan and medina 2007 7 i c y x t 0 0 0 x 8 b c y x 0 t 0 t 0 9 y x t 0 t 0 this study solved the linear diffusion wave eq 4 by the generalized integral transformation technique which özisik 1968 presented to deal with heat conduction problems in order to comply with using the above integral transform we initially needed to eliminate the first order spatial derivative term in 4 by means of the following technique of change of variable see wu and hsieh 2019 10 y x t e c 2 k 1 x c 2 t y v x t substituting 10 into 4 7 8 and 9 yields 11 2 y v x 2 1 k 1 y v t e c 2 k 1 x c 2 t 1 k 1 r f 12 i c y v 0 x t 0 0 13 b c y v x 0 t 0 t 0 14 y v x t 0 t 0 after using the change of variable technique 11 now complies with the form of heat conduction equation that can be solved by the generalized integral transform method referring to özisik 1968 we employed the integral transform as follows integral transform formula 15 y f λ t x 0 k λ x y v x t d x and integral inverse transform formula 16 y v x t λ 0 k λ x y f λ t d λ in which k λ x is the transform kernel function according to 15 taking the integral transform to 11 results in 17a x 0 k λ x 2 y v x 2 d x 1 k 1 d y f dt φ r λ t where 17b φ r λ t x 0 k λ x 1 k 1 e c 2 k 1 x c 2 t r f d x 17c k λ x 2 π sin λ x after completing the integral in 17a by integration by parts twice associated with boundary conditions 13 and 14 17a becomes 18 dy f dt k 1 λ 2 y f k 1 φ r the solution to the 1st order ordinary differential equation 18 is easily to be found as 19 y f λ t e k 1 λ 2 t γ 0 t e k 1 λ 2 γ x 0 k λ x e c 2 k 1 x c 2 γ r f d x d γ if there is a rainfall event uniformly happening in the space interval 0 x l r x t can be reduced to r t consequently the analytical solution of water depth y can be found by taking the inverse transform formula 16 and 10 y γ 0 t r f 2 e r f c 2 t γ k 1 1 k 1 t γ x l 2 e r f c 2 t γ k 1 1 k 1 t γ x 2 20 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x l 2 d γ in which erf is the error function 20 is an explicit solution of surface water depth considering permeable ground under any temporally varied rainfall events taking a partial derivative to 20 with respect to results in 21 y x γ 0 t r f 2 1 π t γ e c 2 t γ k 1 1 k 1 t γ x l 2 2 e c 2 t γ k 1 1 k 1 t γ x 2 2 c k 1 e cx k 1 erf c 2 t γ k 1 1 k 1 t γ x 2 c k 1 e cx k 1 erf c 2 t γ k 1 1 k 1 t γ x l 2 e cx k 1 π t γ e c 2 t γ k 1 1 k 1 t γ x 2 2 e c 2 t γ k 1 1 k 1 t γ x l 2 2 d γ inasmuch as the water depth is solved the frictional slope and the unit flow rate can be obtained by substituting 20 and 21 into 2 and 3 2 1 rainfall on an impervious pavement in the real world the mathematical expression of a hyetograph is 22 r x t r 1 0 t t 1 r 2 t 1 t t 2 r n t n 1 t t n t r 0 0 x l l x where t r is the duration of rainfall by referring to kazezyılmaz alhan 2012 22 can be expressed by 23 r x t i 1 n r i u t t i 1 u t t i 0 x l 0 l x in which u is the unit step function substituting 23 into 20 and neglecting the infiltration term for impervious ground we obtained the following analytical solution for the regional water depth of overland flow with temporally varied rainfall instead of 20 24 y i 1 n t i 1 t i r i 2 e r f c 2 t γ k 1 1 k 1 t γ x l 2 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x l 2 d γ 24 indicates that the presented solution for surface water depth can handle any rainfall data without considering infiltration in hydrologic engineering 2 2 rainfall on a pervious ground when rainfall drops on a pervious ground the infiltration rate must be considered if the horton infiltration formula is adopted the analytical solution to the water depth will become more complete and applicable the horton infiltration formula is 25 f t f c f 0 f c e α t where f 0 is the initial infiltration rate l t f c is the final infiltration rate l t and α is a decaying constant 1 t in this study the infiltration rate within each single time interval δ t was averaged namely 26 f t f t f t δ t 2 then the analytical solution of water depth considering the infiltration rate under time varying rainfall come to 27 y i 1 n t i 1 t i r i f i 2 e r f c 2 t γ k 1 1 k 1 t γ x l 2 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x l 2 d γ as such the present solution can address the overland flow with consideration of any type of rainfall as well as infiltration in hydrologic engineering 3 results and discussion to validate the present solution the comparison between the present study and the result of kazezyılmaz alhan and medina 2007 is shown in fig 2 kazezyılmaz alhan and medina 2007 solved the diffusion wave equation by the finite difference method with the maccormack scheme and simulated the transient overland flow under a uniform rainfall event the parameters used are as follows s 0 0 0016 n 0 025 r 50 8 mm hr t r 0 5 hr l 182 88 m c 0 11 m s and k 1 0 93 m2 s from the figure the peak flow obtained by the generalized integral transformation technique is slightly lower than that presented by kazezyılmaz alhan and medina 2007 and the trend of the retreating limb is quite consistent hence the validation of the present solution is satisfactory 3 1 sensitivity analysis of parameters in kazezyılmaz alhan and medina 2007 their parameters c and k 1 are both fixed values such condition is fine for uniform rainfall events whereas it is not adequate for time varying rainfall events during the research processes the detection of mass conservation is always playing an important role to check the correctness of simulated results cappelaere 1997 also indicated that c and k 1 are the most important parameters for controlling the simulated results from a linear diffusion wave model to meet the mass conservation therefore choosing appropriate values of c and k 1 can make the simulated results more feasible and accurate yang et al 2015 mentioned that the value of c in rural areas is 0 00017 0 25 m s while the range of k 1 is 0 00002 0 25 m2 s it should be noted from 5 and 6 that c is proportional to the frictional slope of the ground but k 1 is inversely proportional to the slope both parameters are inversely related to the surface roughness of the ground as shown in fig 3 for constant k 1 the peak flow and the outflow volume in the case of increasing c by 10 compared to the benchmark case solid line decrease by 11 8 and 10 7 respectively and in the case of decreasing c by 10 they separately increase by 13 1 and 12 6 while compared to the benchmark case fig 3a also for constant c the peak flow and the outflow volume in the case of increasing k 1 by 10 compared to the benchmark case decrease by 2 5 and 2 6 respectively and in the case of reducing k 1 by 10 they separately increase by 2 4 and 2 6 while compared to the benchmark case fig 3b this implies that the flow condition is more sensitive to the parameter c than the parameter k 1 on the other hand it can be seen from fig 4 that the spatial distribution of the flow discharge fluctuates more severely with variable c than with variable k 1 therefore the influence of the diffusion wave celerity c on the discharge of overland flow is greater than the diffusion coefficient k 1 once again the flow discharge is more sensitive to c than k 1 moreover the discharge increases when these two parameters decrease based on the above argument this study performed the adjustment of c to an optimal value such that the flow is mass conservative by giving k 1 an appropriate value according to previous research results the other parameters are chosen as s 0 0 001 n 0 015 r 50 mm hr t r 0 5 hr and l 100 m for the simulations in figs 3 and 4 based on the above sensitivity analysis of parameters c 0 1 m s and k 1 1 m2 s were determined to proceed the simulation in fig 5 for observing the propagation of overland flow fig 5 shows the spatial variation of flow depth at certain times it implies that the wave of overland flow quickly propagates downstream as t t r 1 h r whereas the wave gradually propagates downstream as t t r which agrees with the arguments of bajracharya and barry 1997 3 2 examination of mass conservation although the present result and the result of kazezyılmaz alhan and medina 2007 are close both results have a mass conservative problem because of using constant parameters of c and k 1 to fix the problem an iterative technique was used to make the volume amount meet the mass balance between the outflow volume and the accumulative rainfall volume the technique fixed the diffusion coefficient k 1 and then adjusted the wave celerity c continuously until the mass balance was reached the detailed procedure of the iterative technique is given below step 1 assume feasible values of c and k 1 by referring to previous studies step 2 substitute c and k 1 into the analytical solution say 24 or 27 step 3 check the mass balance i e the volume of outflow is very close to that of inflow rainfall within an acceptable percentage of relative error say less than 1 in this study step 4 if the check is okay the values of c k 1 and y are obtained if not fix k 1 and adjust c by a small constant increment or decrement and then repeat steps 1 to 3 until the mass balance is reached an example is shown in fig 6 with r 50 8 mm h l 182 88 m t r 30 min k 1 0 93 m2 s and initial c 0 11 m s kazezyılmaz alhan and medina 2007 the improved solution meeting the mass balance of flow was plotted as solid line in fig 6 before correcting c re 20 4 of the previous solution but after the correction c 0 0906 m s re 0 98 of the improved solution this validates the presented improved solution furthermore the numerical solution proposed by kazezyılmaz alhan 2012 was also illustrated in fig 6 to show the necessary correction of the previous analytical solution the relative error re is defined as 28 re v in v out v in 100 where v in accumulative rainfall amount v out volume under the curve in the discharge hydrograph cappelaere 1997 used the method of characteristics to develop a numerical model and then took a test for a hypothetical regular channel afterwards the model was applied to an existing natural river reach with recorded hydrographs but unknown geometry the wye river between erwood and belmont u k he remarked that the ratio of the wave celerity to the diffusion coefficient in the diffusion wave model needs to be fixed in the simulation process to make the results satisfy the mass conservation nevertheless the present study presents different arguments we conjecture that the contradiction might arise from the distinct characteristics between the overland flow and channel flow fig 7 shows the relationship between c and k 1 under different rainfall events the curves were found by giving a fixed k 1 and then a c was obtained according to the mass conservation while k 1 increases from 0 1 to 1 m2 s c is reduced about 21 13 9 and 6 for r 25 50 100 and 200 mm hr respectively the ratio between them is not fixed in addition the wave celerity doesn t remain constant under different rainfall events but increases with the rainfall intensity 3 3 verification of improved solutions to validate the presented improved solutions we compared the solutions with the experimental results of previous studies fig 8 a shows the comparison with bell et al 1989 for overland flow on an impervious pavement the selected parameters are s 0 0 005 n 0 0104 r 300 mm hr t r 75 sec l 9 925 m c 0 1016 m s and k 1 0 2 m2 s moreover as the infiltration rate was considered the solution 27 was employed and the results were compared with the experimental results of shen and shen 1990 for overland flow on a loess slope in fig 8b s 0 0 01 n 0 035 r 102 mm hr t r 20 min l 20 m c 0 0852 m s and k 1 0 1 m2 s were used since shen and shen 1990 did not apparently describe the infiltration rate for the loess we calibrated the approximate parameters obtained from the data regression of the horton infiltration model for loess with shrub under similar rainfall intensity proposed by zhao et al 2009 the infiltration parameters are f 0 60 mm hr f c 9 24 mm hr and α 10 74 1 hr as a result the presented results with infiltration and without infiltration in fig 8 agree to the experimental data very well 3 4 simulation of overland flow under time varying rainfall events the present study provides analytical solutions that can consider time varying rainfall events given that s 0 0 005 k 1 1 m2 s and the rainfall data total accumulative rainfall 378 mm hr within 36 h obtained from wudu monitoring stations in keelung city taiwan on june 2 2017 the simulation was carried out straightforwardly according to 24 and 27 because surface cover has a great influence on the water depth and flow discharge we discussed three different pavements concrete ground n 0 015 short grassland n 0 05 and weed land n 0 1 at three locations x 0 5l x l and x 1 5 l the infiltration parameters are f 0 4 2 mm hr f c 1 77 mm hr and α 5 28 1 hr for short grassland and f 0 4 95 mm hr f c 1 2 mm hr and α 3 18 1 hr for weed land by referring to lin et al 2007 fig 9 shows the results of the overland flow on aforementioned pavements under a rainfall event of total accumulative rainfall 378 mm within 36 h even if the infiltration is considered and thus the water depth is reduced the peak water depth on the weed ground is the largest see fig 9a c and e but the flow discharge is the smallest because of high roughness and permeability see fig 9b d and f on the contrary the water depth on the concrete ground is the smallest but the flow discharge on the concrete ground is the largest due to low roughness and impermeability the accumulative infiltration capacity is 31 33 mm for the short grassland and 16 27 mm for the weed land within 36 h it could be remarked that proper surface coverage can slow down the surface runoff 4 conclusions in this study an alternative analytical solution to the diffusion wave equation was proposed by the generalized integral transformation method which can deal with the problems of overland flow on pervious and impervious pavements under uniform and time varying rainfall events the variable coefficients i e the diffusion coefficient and the diffusion wave celerity in the diffusion wave equation were adjusted to meet the mass conservation of flow and the simulation results agree very well with previous experimental results therefore the present model might be helpful to address overland flow due to any collected rainfall data in hydrologic engineering to sum up the innovative performance is summarized as follows 1 this study presents an analytical solution instead of a numerical solution to give the flow field characteristics of a slope flow under rainfall and infiltration 2 the slope flow solution considering time varying rainfall and infiltration is proposed which is consistent with numerical simulation and experimental results 3 the correction coefficients are used to achieve mass conservation of flow and improve the simulation results by the way the generalized integral transformation method is constricted to deal with a heat conduction equation so one should note the limitation for applying the technique in similar cases furthermore if the present solution is extended to larger areas the whole area can be divided into several sub areas and the unit step functions of 23 must be appended by the variable of space declaration of competing interest none acknowledgements this study was financially supported by the ministry of science and technology of taiwan under grant no most 106 2313 b 005 007 my2 
6192,urban areas are often covered by materials with smooth ground surface and poor water permeability which may cause problems such as increasing flow velocity and discharge this study employed the diffusion wave equation to investigate the variation of overland flow and analytical solutions were obtained by the generalized integral transformation technique examining previous research we found when the coefficients in the diffusion wave equation were treated as constants the simulated results would be mass non conservative this study corrected the coefficients which makes the flow meet the mass conservation law to improve the simulation results an alternative solution to the overland flow considering time varying rainfall and infiltration were proposed and the results were well compared with previous numerical solutions and experimental data keywords diffusion wave equation overland flow law of mass conservation time varying rainfall 1 introduction recently the sloping land in densely populated areas has been developed rapidly and large amounts of materials such as cement and asphalt have been used to cover the original surface this phenomenon causes not only a decrease of ground friction and permeability but also an increase of the surface runoff and flow velocity indicating that the originally planned drainage facilities may not be able to cope with such a great change and thus probably cause flooding in the lowlands therefore predicting changes of surface water flow caused by rainfall has become an important issue the saint venant equation often employed to describe the surface water flow or open channel flow is a highly nonlinear partial differential equation based on continuity equations and dynamic wave theory so it is difficult to directly obtain an analytical solution to this equation as such most of the previous studies have solved the equation by numerical methods otherwise some researchers simplify the fully equation to a kinematic wave equation or a diffusion wave equation to explain the overland flow however the values of the diffusion wave celerity and diffusion coefficient in the diffusion wave equation are variable in the process of motion depending on the flow velocity and water depth kazezyılmaz alhan 2012 henderson 1966 classified the process of flood wave translation as a transient flow problem and delineated the derivation process of the linear diffusion wave equation by combining the continuity equation and the momentum equation ponce 1989 explained that because the diffusion coefficient is inversely proportional to the slope of the bed when the slope decreases to a certain extent the diffusion term becomes more significant when the diffusion wave theory is applied to a bed slope from 0 001 to 0 0001 the influence of the diffusion term becomes quite obvious the slower the slope the greater influence of the diffusion term on the hydraulic phenomenon yen and tsai 2001 integrated the factors and expressions of the kinematic diffusion and dynamic wave modes employed in previous research they said that a few studies based on the diffusion wave theory considered some of the inertial force terms in the momentum equation therefore they defined non inertial waves as waves ignoring all the inertial terms to clearly express its physical meaning kazezyılmaz alhan 2012 improved the solution to the diffusion wave equation proposed by kazezyılmaz alhan and medina 2007 in the paper he employed the de hoog algorithm for laplace inversion to deal with the diffusion wave equation with variable hydraulic diffusivity and wave celerity under rainfall events with both constant and variable rainfall intensity nevertheless there is an amount of discrepancy between their improved analytical solutions and the numerical solutions based on the theory of diffusion wave jain and singh 2005 combined with the digital elevation model to obtain more accurate local geology and hydrological conditions the simulated areas were distinguished into land use patterns and soil textures and hydraulic analysis was performed for individual area thereby they enhanced the authenticity and applicability of the results however such a huge model needs much more parameters including hydrological and geological parameters recently avazzadeh et al 2014 obtained a numerical solution of a fractional diffusion wave equation by using the radial basis function method and hosseini et al 2001 successfully usedlocal radial point interpolation method to solve the fractional diffusion wave equation both studies solved the variable coefficients diffusion wave equation and developed numerical models they provided a good technique in computational physics yang et al 2015 used the linear diffusion wave equation to analyze the difference of flood peak flow rate and time to peak between rural and urban areas they also explained the estimation method of the parameters used in rural areas and then roughly evaluated the parameters of urban areas based on the shift of pavement roughness between nazari 2017 also employed diffusion wave theory to analyze the river flows using the laplace transform method and the finite difference method to solve the equation because the parameters of the diffusion wave equation will change with hydrological and geographical conditions it is quite difficult to solve such problems by analytical approaches therefore the spatiotemporal variability of the parameters was mostly considered by numerical methods based on the above statements traditional analytical solutions are usually obtained by the laplace transform method but the inverse laplace transform is always difficult to be found and the results do not meet the mass balance the numerical models give the approximate solutions for the nodes in the mesh and needs to interpolate the solutions between nodes therefore this study employed the generalized integral transformation technique to analytically solve the one dimensional linear diffusion wave equation and the linearized parameters was corrected by an iterative technique according to the law of mass conservation for better estimating the overland flow the inverse transform in the generalized integral transformation technique is easily obtained by taking an integration of a kernel function and the transform variable moreover the presented analytical solutions can afford the water depth and flow discharge at any point and at any time within the study area for any given time varying rainfall data 2 mathematical formulation the overland flow on a slope with an inclination angle θ is shown in fig 1 in general the rainfall covering a region of x 0 to l is variable in time and space the study presumes that the rainfall is evenly distributed within the region and perpendicular to the homogeneous slope and the infiltration rate is uniform over the pavement the continuity equation of overland flow is 1 y t q x r x t f t where y is the water depth l q is the flow discharge per unit width l 2 t r is the rainfall intensity l t f is the infiltration rate l t x is the distance l and t is the time t also the friction slope of diffusion wave and manning formula can be expressed as follows respectively 2 s f s 0 y x 3 q 1 n y 5 3 s f where s f is the friction slope and s 0 is the slope of the ground substituting 2 and 3 into 1 yields 4 y t c y x k 1 2 y x 2 r f where c is the diffusion wave celerity l t and k 1 is the diffusion coefficient l 2 t 5 c 5 3 v v 1 n y 2 3 s f 6 k 1 q 2 s f hayami 1951 linearized 4 by assuming that c and k 1 were constant values this presumption could quickly obtain an analytical solution for water depth referring to chow 1959 henderson 1966 and kazezyılmaz alhan and medina 2007 bajracharya and barry 1997 showed that such treatment of linearization had constrained the prediction of flood transmission but still could reflect the trend of flood transmission assuming that there is no surface water flow before raining the initial and boundary conditions are as follows kazezyılmaz alhan and medina 2007 7 i c y x t 0 0 0 x 8 b c y x 0 t 0 t 0 9 y x t 0 t 0 this study solved the linear diffusion wave eq 4 by the generalized integral transformation technique which özisik 1968 presented to deal with heat conduction problems in order to comply with using the above integral transform we initially needed to eliminate the first order spatial derivative term in 4 by means of the following technique of change of variable see wu and hsieh 2019 10 y x t e c 2 k 1 x c 2 t y v x t substituting 10 into 4 7 8 and 9 yields 11 2 y v x 2 1 k 1 y v t e c 2 k 1 x c 2 t 1 k 1 r f 12 i c y v 0 x t 0 0 13 b c y v x 0 t 0 t 0 14 y v x t 0 t 0 after using the change of variable technique 11 now complies with the form of heat conduction equation that can be solved by the generalized integral transform method referring to özisik 1968 we employed the integral transform as follows integral transform formula 15 y f λ t x 0 k λ x y v x t d x and integral inverse transform formula 16 y v x t λ 0 k λ x y f λ t d λ in which k λ x is the transform kernel function according to 15 taking the integral transform to 11 results in 17a x 0 k λ x 2 y v x 2 d x 1 k 1 d y f dt φ r λ t where 17b φ r λ t x 0 k λ x 1 k 1 e c 2 k 1 x c 2 t r f d x 17c k λ x 2 π sin λ x after completing the integral in 17a by integration by parts twice associated with boundary conditions 13 and 14 17a becomes 18 dy f dt k 1 λ 2 y f k 1 φ r the solution to the 1st order ordinary differential equation 18 is easily to be found as 19 y f λ t e k 1 λ 2 t γ 0 t e k 1 λ 2 γ x 0 k λ x e c 2 k 1 x c 2 γ r f d x d γ if there is a rainfall event uniformly happening in the space interval 0 x l r x t can be reduced to r t consequently the analytical solution of water depth y can be found by taking the inverse transform formula 16 and 10 y γ 0 t r f 2 e r f c 2 t γ k 1 1 k 1 t γ x l 2 e r f c 2 t γ k 1 1 k 1 t γ x 2 20 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x l 2 d γ in which erf is the error function 20 is an explicit solution of surface water depth considering permeable ground under any temporally varied rainfall events taking a partial derivative to 20 with respect to results in 21 y x γ 0 t r f 2 1 π t γ e c 2 t γ k 1 1 k 1 t γ x l 2 2 e c 2 t γ k 1 1 k 1 t γ x 2 2 c k 1 e cx k 1 erf c 2 t γ k 1 1 k 1 t γ x 2 c k 1 e cx k 1 erf c 2 t γ k 1 1 k 1 t γ x l 2 e cx k 1 π t γ e c 2 t γ k 1 1 k 1 t γ x 2 2 e c 2 t γ k 1 1 k 1 t γ x l 2 2 d γ inasmuch as the water depth is solved the frictional slope and the unit flow rate can be obtained by substituting 20 and 21 into 2 and 3 2 1 rainfall on an impervious pavement in the real world the mathematical expression of a hyetograph is 22 r x t r 1 0 t t 1 r 2 t 1 t t 2 r n t n 1 t t n t r 0 0 x l l x where t r is the duration of rainfall by referring to kazezyılmaz alhan 2012 22 can be expressed by 23 r x t i 1 n r i u t t i 1 u t t i 0 x l 0 l x in which u is the unit step function substituting 23 into 20 and neglecting the infiltration term for impervious ground we obtained the following analytical solution for the regional water depth of overland flow with temporally varied rainfall instead of 20 24 y i 1 n t i 1 t i r i 2 e r f c 2 t γ k 1 1 k 1 t γ x l 2 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x l 2 d γ 24 indicates that the presented solution for surface water depth can handle any rainfall data without considering infiltration in hydrologic engineering 2 2 rainfall on a pervious ground when rainfall drops on a pervious ground the infiltration rate must be considered if the horton infiltration formula is adopted the analytical solution to the water depth will become more complete and applicable the horton infiltration formula is 25 f t f c f 0 f c e α t where f 0 is the initial infiltration rate l t f c is the final infiltration rate l t and α is a decaying constant 1 t in this study the infiltration rate within each single time interval δ t was averaged namely 26 f t f t f t δ t 2 then the analytical solution of water depth considering the infiltration rate under time varying rainfall come to 27 y i 1 n t i 1 t i r i f i 2 e r f c 2 t γ k 1 1 k 1 t γ x l 2 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x 2 e cx k 1 e r f c 2 t γ k 1 1 k 1 t γ x l 2 d γ as such the present solution can address the overland flow with consideration of any type of rainfall as well as infiltration in hydrologic engineering 3 results and discussion to validate the present solution the comparison between the present study and the result of kazezyılmaz alhan and medina 2007 is shown in fig 2 kazezyılmaz alhan and medina 2007 solved the diffusion wave equation by the finite difference method with the maccormack scheme and simulated the transient overland flow under a uniform rainfall event the parameters used are as follows s 0 0 0016 n 0 025 r 50 8 mm hr t r 0 5 hr l 182 88 m c 0 11 m s and k 1 0 93 m2 s from the figure the peak flow obtained by the generalized integral transformation technique is slightly lower than that presented by kazezyılmaz alhan and medina 2007 and the trend of the retreating limb is quite consistent hence the validation of the present solution is satisfactory 3 1 sensitivity analysis of parameters in kazezyılmaz alhan and medina 2007 their parameters c and k 1 are both fixed values such condition is fine for uniform rainfall events whereas it is not adequate for time varying rainfall events during the research processes the detection of mass conservation is always playing an important role to check the correctness of simulated results cappelaere 1997 also indicated that c and k 1 are the most important parameters for controlling the simulated results from a linear diffusion wave model to meet the mass conservation therefore choosing appropriate values of c and k 1 can make the simulated results more feasible and accurate yang et al 2015 mentioned that the value of c in rural areas is 0 00017 0 25 m s while the range of k 1 is 0 00002 0 25 m2 s it should be noted from 5 and 6 that c is proportional to the frictional slope of the ground but k 1 is inversely proportional to the slope both parameters are inversely related to the surface roughness of the ground as shown in fig 3 for constant k 1 the peak flow and the outflow volume in the case of increasing c by 10 compared to the benchmark case solid line decrease by 11 8 and 10 7 respectively and in the case of decreasing c by 10 they separately increase by 13 1 and 12 6 while compared to the benchmark case fig 3a also for constant c the peak flow and the outflow volume in the case of increasing k 1 by 10 compared to the benchmark case decrease by 2 5 and 2 6 respectively and in the case of reducing k 1 by 10 they separately increase by 2 4 and 2 6 while compared to the benchmark case fig 3b this implies that the flow condition is more sensitive to the parameter c than the parameter k 1 on the other hand it can be seen from fig 4 that the spatial distribution of the flow discharge fluctuates more severely with variable c than with variable k 1 therefore the influence of the diffusion wave celerity c on the discharge of overland flow is greater than the diffusion coefficient k 1 once again the flow discharge is more sensitive to c than k 1 moreover the discharge increases when these two parameters decrease based on the above argument this study performed the adjustment of c to an optimal value such that the flow is mass conservative by giving k 1 an appropriate value according to previous research results the other parameters are chosen as s 0 0 001 n 0 015 r 50 mm hr t r 0 5 hr and l 100 m for the simulations in figs 3 and 4 based on the above sensitivity analysis of parameters c 0 1 m s and k 1 1 m2 s were determined to proceed the simulation in fig 5 for observing the propagation of overland flow fig 5 shows the spatial variation of flow depth at certain times it implies that the wave of overland flow quickly propagates downstream as t t r 1 h r whereas the wave gradually propagates downstream as t t r which agrees with the arguments of bajracharya and barry 1997 3 2 examination of mass conservation although the present result and the result of kazezyılmaz alhan and medina 2007 are close both results have a mass conservative problem because of using constant parameters of c and k 1 to fix the problem an iterative technique was used to make the volume amount meet the mass balance between the outflow volume and the accumulative rainfall volume the technique fixed the diffusion coefficient k 1 and then adjusted the wave celerity c continuously until the mass balance was reached the detailed procedure of the iterative technique is given below step 1 assume feasible values of c and k 1 by referring to previous studies step 2 substitute c and k 1 into the analytical solution say 24 or 27 step 3 check the mass balance i e the volume of outflow is very close to that of inflow rainfall within an acceptable percentage of relative error say less than 1 in this study step 4 if the check is okay the values of c k 1 and y are obtained if not fix k 1 and adjust c by a small constant increment or decrement and then repeat steps 1 to 3 until the mass balance is reached an example is shown in fig 6 with r 50 8 mm h l 182 88 m t r 30 min k 1 0 93 m2 s and initial c 0 11 m s kazezyılmaz alhan and medina 2007 the improved solution meeting the mass balance of flow was plotted as solid line in fig 6 before correcting c re 20 4 of the previous solution but after the correction c 0 0906 m s re 0 98 of the improved solution this validates the presented improved solution furthermore the numerical solution proposed by kazezyılmaz alhan 2012 was also illustrated in fig 6 to show the necessary correction of the previous analytical solution the relative error re is defined as 28 re v in v out v in 100 where v in accumulative rainfall amount v out volume under the curve in the discharge hydrograph cappelaere 1997 used the method of characteristics to develop a numerical model and then took a test for a hypothetical regular channel afterwards the model was applied to an existing natural river reach with recorded hydrographs but unknown geometry the wye river between erwood and belmont u k he remarked that the ratio of the wave celerity to the diffusion coefficient in the diffusion wave model needs to be fixed in the simulation process to make the results satisfy the mass conservation nevertheless the present study presents different arguments we conjecture that the contradiction might arise from the distinct characteristics between the overland flow and channel flow fig 7 shows the relationship between c and k 1 under different rainfall events the curves were found by giving a fixed k 1 and then a c was obtained according to the mass conservation while k 1 increases from 0 1 to 1 m2 s c is reduced about 21 13 9 and 6 for r 25 50 100 and 200 mm hr respectively the ratio between them is not fixed in addition the wave celerity doesn t remain constant under different rainfall events but increases with the rainfall intensity 3 3 verification of improved solutions to validate the presented improved solutions we compared the solutions with the experimental results of previous studies fig 8 a shows the comparison with bell et al 1989 for overland flow on an impervious pavement the selected parameters are s 0 0 005 n 0 0104 r 300 mm hr t r 75 sec l 9 925 m c 0 1016 m s and k 1 0 2 m2 s moreover as the infiltration rate was considered the solution 27 was employed and the results were compared with the experimental results of shen and shen 1990 for overland flow on a loess slope in fig 8b s 0 0 01 n 0 035 r 102 mm hr t r 20 min l 20 m c 0 0852 m s and k 1 0 1 m2 s were used since shen and shen 1990 did not apparently describe the infiltration rate for the loess we calibrated the approximate parameters obtained from the data regression of the horton infiltration model for loess with shrub under similar rainfall intensity proposed by zhao et al 2009 the infiltration parameters are f 0 60 mm hr f c 9 24 mm hr and α 10 74 1 hr as a result the presented results with infiltration and without infiltration in fig 8 agree to the experimental data very well 3 4 simulation of overland flow under time varying rainfall events the present study provides analytical solutions that can consider time varying rainfall events given that s 0 0 005 k 1 1 m2 s and the rainfall data total accumulative rainfall 378 mm hr within 36 h obtained from wudu monitoring stations in keelung city taiwan on june 2 2017 the simulation was carried out straightforwardly according to 24 and 27 because surface cover has a great influence on the water depth and flow discharge we discussed three different pavements concrete ground n 0 015 short grassland n 0 05 and weed land n 0 1 at three locations x 0 5l x l and x 1 5 l the infiltration parameters are f 0 4 2 mm hr f c 1 77 mm hr and α 5 28 1 hr for short grassland and f 0 4 95 mm hr f c 1 2 mm hr and α 3 18 1 hr for weed land by referring to lin et al 2007 fig 9 shows the results of the overland flow on aforementioned pavements under a rainfall event of total accumulative rainfall 378 mm within 36 h even if the infiltration is considered and thus the water depth is reduced the peak water depth on the weed ground is the largest see fig 9a c and e but the flow discharge is the smallest because of high roughness and permeability see fig 9b d and f on the contrary the water depth on the concrete ground is the smallest but the flow discharge on the concrete ground is the largest due to low roughness and impermeability the accumulative infiltration capacity is 31 33 mm for the short grassland and 16 27 mm for the weed land within 36 h it could be remarked that proper surface coverage can slow down the surface runoff 4 conclusions in this study an alternative analytical solution to the diffusion wave equation was proposed by the generalized integral transformation method which can deal with the problems of overland flow on pervious and impervious pavements under uniform and time varying rainfall events the variable coefficients i e the diffusion coefficient and the diffusion wave celerity in the diffusion wave equation were adjusted to meet the mass conservation of flow and the simulation results agree very well with previous experimental results therefore the present model might be helpful to address overland flow due to any collected rainfall data in hydrologic engineering to sum up the innovative performance is summarized as follows 1 this study presents an analytical solution instead of a numerical solution to give the flow field characteristics of a slope flow under rainfall and infiltration 2 the slope flow solution considering time varying rainfall and infiltration is proposed which is consistent with numerical simulation and experimental results 3 the correction coefficients are used to achieve mass conservation of flow and improve the simulation results by the way the generalized integral transformation method is constricted to deal with a heat conduction equation so one should note the limitation for applying the technique in similar cases furthermore if the present solution is extended to larger areas the whole area can be divided into several sub areas and the unit step functions of 23 must be appended by the variable of space declaration of competing interest none acknowledgements this study was financially supported by the ministry of science and technology of taiwan under grant no most 106 2313 b 005 007 my2 
6193,interaction between meteorological and hydrologic processes is challenging to model owing to their high spatio temporal variability the understanding of their associations can help to ensure future fresh water security with changing climate in this study due to continuously evolving nature of these interactions the hydrological and meteorological variables are studied on wavelet component level multi resolution stationary wavelet transformation mrswt is used to transform the independent climatic variable and dependent hydrological variable time series into their components the components of the dependent time series are modeled using a kernel based auto regressive ar model for separating their memory part the residuals are hypothesized to be the effect of interaction of predictor variables and thus are modeled using the mrswt components of meteorological variables in an auto regressive model with exogenous inputs arx finally the predicted residuals effect of climatic variables are added to the component estimated by kernel based ar estimator memory of dependent series components to obtain the predicted components of the dependent hydrologic variable which are then inverse transformed to obtain the predicted dependent hydrologic variable the developed hybrid wavelet arx is found to capture the information about relationship between synthetically generated data better than a simple arx model the model is then applied to predict total monthly rainfall over upper mahanadi basin and is found to effectively extract the information from the poorly associated hydro meteorological variables while the potential of wavelet arx is found to be impressive for hydro meteorological applications additionally discarding some climatic inputs on the basis of their relative importance may lead to better prediction by the developed model the developed model is suitable for extracting climatic forcings and is desirable in a changing climate keywords hydroclimatic association rainfall prediction simulation climate change hybrid wavelet arx model relative importance analysis 1 introduction meteorological and hydrological processes mutually affect each other at global and local scales the linkage between meteorological variables with hydrological variables at a local scale hereafter hydro meteorological association is expected to vary both with time and space due to its continuously evolving characteristics such interactions or associations are difficult to model khaliq et al 2006 maity and nagesh kumar 2008 ishak et al 2012 shih et al 2014 in this study a generalized hybrid model based on wavelet transformation and auto regressive model with exogenous input arx for capturing these hydro meteorological associations is developed and its potential is investigated the developed model is also used to figure out the climatic variables that are more important in terms of hydro meteorological association as far as rainfall is concerned in the basin it is hypothesized that the inter relationship between meteorological predictor variables and the hydrologic variable predictand is continuously evolving over time different predictor variables may have different extent of influence on the predictand variables that may not be visible in amplitude time domain of signal these inter relationships between predictor and predictand variables may have more prominent existence at some if not all frequency bands of predictand as compared to the original time series of the predictand variable hence the inter relationships are better captured at its constituent wave levels the wavelet transformation wt is one of the potential choices to separate or decompose the constituent wavelets from dependent and independent time series the components of the decomposed dependent time series are the manifestation of some innate memory autoregressive or memory part and the effect of exogenous factors forcing hence for better modeling of inter relation of dependent variable with other affecting climatic variables the innate memory of the dependent series component is required to be separated to separate the memory from the dependent components any autoregressive model can be used in this study kernel estimator is used for taking out the memory from the dependent series components the residuals after extracting the memory are hypothesized to be the effect of other exogenous factors and hence can be modeled using exogenous input in this study arx model is used for modeling the relationship between residual and components of affecting climatic inputs the wt is a signal analysis tool for transforming signals into scaled and shifted version of a zero mean finite duration disturbances function the zero mean finite duration disturbance functions are referred as mother wavelet functions many popular mother wavelet functions exist like daubechies wavelet orthogonal wavelet bi orthogonal wavelet etc burrus et al 1998 wt transforms the domain of signal from the amplitude time domain to the frequency time domain this transformation sometimes helps in obtaining further information from the signal that is not readily available in the amplitude time domain since its introduction wt has found wide application in diverse fields of sciences such as seismic signal detection image processing optics turbulence quantum mechanics medical science etc devore et al 1992 farge 1992 rockinger 1997 zhong and weng 2005 cannata et al 2013 martis et al 2013 farge and schneider 2015 rasti et al 2016 wt is well suited for the study of multi scale non stationary processes occurring over finite spatial and temporal domains burrus et al 1998 daubechies 1992 recently wavelet was used for analysis of rainfall variability westra and sharma 2006 improving rainfall prediction quiroz et al 2011 hydrologic regionalization of catchments agarwal et al 2016 forecasting drought with long lead özger et al 2012 predicting the long term groundwater levels maheswaran and khosa 2013a modeling rainfall runoff streamflow relationship kamruzzaman et al 2014 shoaib et al 2014 predicting daily streamflow maheswaran and khosa 2013b studying temporal consequences of drought maity et al 2016 and analysis of precipitation extremes tan et al 2016 these studies utilize the ability of wavelet transformation to transform the signal into the frequency time domain and extract information like dominant mode of hydrological variable e g westra and sharma 2006 or use the transformed domain for working out relation between two hydrological variables as in case of rainfall runoff modeling by kamruzzaman et al 2014 and drought precedence by maity et al 2016 comparative study of different wavelet functions along with their suitability on case to case basis in hydrologic forecasting is also studied maheswaran and khosa 2012 the major advantage of using wt is that it works like a pair of high pass and low pass filter and hence transforms the time series into two constituent component time series one called detailed component and other called approximate component the approximate component usually shows trend of the signal and the detailed component usually shows local disturbances in the signal moreover the wt can again be applied on the approximate component to produce components at even lower levels or frequency bands burrus et al 1998 the detailed components usually have higher dynamics compared to approximate component hence errors in the prediction of detailed components are expected to be higher than that in the prediction of approximate components effectively the wt changes the problem of estimation of parent time series into the estimation of its components some of the components are expected to have comparatively lesser error during prediction so the accuracy of overall prediction increases any of the sophisticated estimation techniques like genetic programming kisi and shiri 2011 support vector machine tezel and buyukyildiz 2016 artificial neural network soltani 2002 ozger et al 2011 shoaib et al 2014 sang et al 2016 etc can be applied on the wavelet components for prediction however in this study a kernel based model and an arx model are used in conjunction to predict wt components which can be further reconstructed into the amplitude time domain in brief the objective of this study is to propose a methodological approach for capturing information about hydro meteorological association for hydrologic prediction simulation using the combined potential of wavelet transformation kernel based ar approach for modelling memory and arx modelling of inter relation between variables this approach first separates memory from dependent time series at the component level and then model the inter relation of residual with affecting climate variable components the potential of the proposed model is checked through a set of synthetic data underlying relationship known and an observed data set from a river basin additionally a relative importance analysis of variables is carried out after the development of the proposed model for discarding some less important climatic inputs the model is then run using the new set of variables to check if there is any deterioration similar even improvement in model performance 2 methodology overall the methodology is broadly divided into five modules i multi resolution wavelet decomposition of both independent meteorological variables and dependent hydrological variable time series ii application of kernel based auto regressive model ar to dependent target time series components iii application of arx model for modeling residuals in predicted component values of dependent time series predicted from the ar model iv wavelet reconstruction of dependent time series using predicted components obtained by adding results of last two modules and assessment of model performance and lastly v relative importance analysis of the inputs or independent time series to identify the sub set of hydro meteorological variables with stronger association than others if necessary the model is rerun using this subset of important inputs only to check if there is an improvement in prediction results here it may be noted that step ii takes out the memory component out of dependent component series and step iii models the inter relation between rainfall component residual and the components of other affecting time series the proposed modeling framework is shown in fig 1 details of the mathematical steps in each of the modules of the methodology are discussed in the following subsections 2 1 multi resolution wavelet decomposition of time series usually the time series are represented in the amplitude time domain this representation or domain of time series can be transformed into other domains like the frequency time domain which can help in extracting the important information about the frequency of which original signal is composed of there are many mathematical tools to transform the domain of the time series one of them that is used in this study is wavelet transformation wt the wt transforms the signal in the frequency time domain and reveals the fast moving or higher dynamic component and slow moving or lesser dynamic component of time series separately when wt is again applied on slow moving component of time series then the transformation is called multi resolution wavelet transform mrwt mrwt helps in segregating the components at even lower levels 2 1 1 wavelet transformation wt under wavelet transformation shifted and scaled version of a finite domain zero mean amplitude function is used to transform the signal the finite domain zero mean amplitude function is called mother wavelet as stated earlier many popular mother wavelet functions exist like daubechies wavelet orthogonal wavelet bi orthogonal wavelet etc burrus et al 1998 the wavelet function used in this study is haar which is also regarded as daubechies1 or db1 first member of daubechies class of wavelet this wavelet function has better time localization capability so it is useful for low lead time prediction maheswaran and khosa 2012 haar wavelet is defined as 1 h t 1 0 t 0 5 1 0 5 t 1 0 otherwise due to the finite domain of wavelet functions it is possible to scale and shift these functions these operations further help in catching intermittent disturbances of different durations in the signal the scaled and shifted version of the mother wavelet ψ t is given by 2 ψ a b t 1 a ψ t k a where a and k are scale and shift parameters respectively if both of these parameters are discrete then wt is called discrete wavelet transform dwt if the discrete wavelet were sampled over a dyadic space time grid then they are called dyadic discrete wavelets cao et al 1995 computationally the dwt can be done using a pair of low pass and high pass filter low pass filter is formulated from the mother wavelet function and high pass filter is formulated using corresponding scaling function scaling function acts as a threshold to avoid the condition of infinite application of mother wavelet function for example the scaling function for haar wavelet function is given by 3a ϕ t 1 0 t 1 0 otherwise 3b ϕ 0 k t ϕ t k where k is the shift parameter and φ t is the scaling function during the decomposition of the signal the pair of filters is convolved with the signal followed by subband down sampling to give two components the subband coding is done as per the nyquist shannon sampling theorem shannon 1949 to reduce redundancy in components by removing every second component values the component from low pass filter is called the approximation coefficient and another component is called the detailed component the approximated component shows the trend of signal and has low dynamics the detailed component shows the local details of the signal and has higher dynamics dwt is very efficient in separating the signal into fast and slow dynamics however due to subband coding it has inherent disadvantage of transition invariance in components bradley 2003 a little change even single addition or elimination of data member in the original signal can lead to completely different sets of components moreover due to subband coding the components have half the length compared to signal which causes difficulty in the signal analysis to avoid these problems stationary wavelet transform swt is used in this study the swt nason and silverman 1995 murtagh et al 2004 renaud et al 2005 is specially designed to avoid the transition invariance of dwt it achieves transition variance by avoiding down sampling of components as per nyquist shannon sampling theorem and up sampling the filter coefficient by a factor of 2 j 1 in the j th level of the algorithm hence the swt unlike dwt does not change the time resolution at any stage however the lack of subband coding give rise to redundancies in components as components now have twice the number of elements needed as per nyquist shannon sampling theorem shannon 1949 swt reduces the complexity of signal analysis as both the input signal and its components have equal length in this study the swt is used as preferred wt for decomposing different meteorological and hydrological time series but the model developed can be used with dwt also 2 1 2 multi resolution wavelet transform mrwt as stated earlier mrwt is a procedure in which wt is applied repeatedly over the approximate component which results in more components at an even lower level the new components obtained encompasses half of the bandwidth that the parent component had after mrwt the signal can be expressed as 4 f t k a n k ϕ n k t j 1 n k d j k ψ j k t where a n k is called the coarse or approximate coefficients and d j k is called the detailed wavelet coefficients or simply detailed components at level j n is the maximum level of decomposition of mrwt k denotes the shift parameter of wavelet functions mrwt is classified on the basis of wt involved in the process hence if swt is used as preferred wt then the multi resolution analysis is called mrswt in this study haar mrswt is applied up to level 2 is used to decompose the dependent and independent time series 2 2 application of auto regressive model to predict dependent time series components after mrswt the dependent or hydrological variable time series y t can be expressed in the form of components as shown in eq 4 so to estimate the future value of the target dependent variables i e y m w where w is lead time we need to predict the expected value of its corresponding components i e a n m w and d j m w where a n and d j are the set of all approximate and detailed components at different scales if the components are having innate memory then these components can be mathematically estimated as 5a a n m w f 0 a n m w a n m w 1 a n m a n m r 0 5b d j m w f j d j m w d j m w 1 d j m d j m r 0 j 1 2 3 n where f 0 and f j are appropriate auto regressive estimation functions m r 0 is the last time step being utilized for the estimation in this study the estimation of components is done by using kernel estimator functions the kernel estimator function if w is taken as 1 can be written as mabrouk et al 2008 6 a n m 1 t 1 m a n t k t m 1 h t 1 m k t m 1 h 7 d j m 1 t 1 m d j t k t m 1 h t 1 m k t m 1 h where k represents kernel function and parameter h is the window of the kernel function the kernel function used in this study is naïve kernel function maity and nagesh kumar 2008 bosq 2012 and it is given by 8 k u 1 0 5 u 0 5 the kernel estimator expression in eqs 6 and 7 can be proved to be an ar model mabrouk et al 2008 moreover it should be noted that kernel based ar can be used with data of any distribution as kernel estimator function is non parametric unlike conventional ar with distributional requirements for the variables it should also be noted that different types of kernel function like naïve gaussian etc exist which makes kernel estimator a versatile tool for modeling the memory in the components of dependent variable series however kernel estimator cannot model the inter relation across different meteorological and hydrological time series components hence the residual after prediction from kernel estimator is hypothesized to be partly the contribution of these interactions and it is modeled using components from other independent variable using arx 2 3 application of arx to model the residuals in general the arx models utilize the previous information from the same time series and the time series of causal independent variable s for future prediction karamouz et al 2012 jayawardena 2014 maity 2018 this is to note here that proposed method needs the future values of the causal independent variables that may be obtained from climate model simulation it is well known that the skill of climate models in predicting the meteorological variables is much better than hydrologic variables like rainfall two different arx models were framed for modeling the residuals the models follow common methodology but mainly differ in the selection of components of independent time series c as input in model 1 all the components of independent time series are used to predict the residual of each component of the dependent time series on the other hand in model 2 only the corresponding components of independent time series are used to predict a particular component of the dependent time series in general both model structures are given by 9 a c y t k 1 p s k a c y t p l 1 c j 0 q t l j c x l t j e where the number of auto regressive terms and exogenous inputs are represented by p and q respectively a c y t is tth member of residual in any one component out of a2 d2 or d1 for level 2 of dependent variable y cx represent set of selected individual components of the independent variable set x and c represent the number of element or cardinal number of cx cx l represents an individual member of cx in the case of model 1 all components of all independent variables are selected and in case of model 2 only the corresponding components as of the dependent time series are selected for example in model 2 the d2 component of the dependent time series is predicted using only the d2 components of all the independent time series s and t represent the regression parameters set estimated during model calibration period at first models are trained with calibration period values of components residuals to estimate the model coefficients involved and then it applied on the testing period data set 2 4 reconstruction of dependent time series finally the component values predicted from kernel estimator and corresponding residual modeled by the arx model over testing period are added to get final predicted values for each of the components of dependent or hydrological time series the dependent time series is reconstructed from these components using inverse wavelet transform the reconstructed and observed dependent time series are analyzed to establish potency of the developed model using performance indices like coefficient of determination unbiased root mean square error etc for assessing model performance 2 5 model performance assessment for the assessment of model performance various statistical measures like coefficient of determination r2 unbiased root mean square error urmse nash sutcliffe model efficiency coefficient nse and degree of agreement dr are used the expression for r2 nse and dr can be found in other literature krause et al 2005 willmott et al 2012 maity et al 2016 the urmse is root mean square error rmse calculated between deviations from the mean of observed and estimated time series 2 6 relative importance analysis of inputs relative importance analysis of inputs helps in separating variables having stronger hydro meteorological associations from others some of the inputs may actually increase the noise uncertainty as they may have negligible information for the predictant at the component level this aspect is investigated by the relative importance analysis of inputs the methodology of dominance analysis and birnbaum importance measure are used for studying the relative importance of the inputs birnbaum 1968 budescu 1993 maity and kashid 2011 tonidandel and lebreton 2011 in dominance analysis the average change in the coefficient of determination r2 by adding a particular input variable to all possible subsets or combination of other input variables is considered a measure of relative importance higher the change more important the input is for calculating the importance measure at first one input is separated from all the inputs r2 is calculated by running models for all possible combinations of other inputs next the separated input is included in all other combinations and r2 is calculated by running models on them the change in r2 shows the effect of inclusion of previously separated input in every case the average of all the change of r2 is considered relative importance measure for dominance of the input variable this procedure is repeated for all input variables one by one to get relative importance measure rim for dominance of all inputs the higher the value of this measure the more important the input variable is compared to other variables hence by dominance analysis relative importance measure for ith input darimi is given by 10 dari m i j 1 2 n 1 1 r m p o j i i 2 r m p o j 2 2 n 1 1 where i is the set of all inputs individual input is designated by ii n is the total number of inputs m designates the application of model function and po p i i i φ or po is power set of all inputs except ith input excluding null set r2 as stated earlier is the coefficient of determination hence the cardinality or total number of members of po is 2 n 1 1 poj denotes the jth member of po it can be observed from the equation that the model need to be executed for n 2n 2 times for calculating darim for all the input variables hence the application of dominance analysis is time taking and computationally intensive procedure for calculating the relative importance of inputs using birnbaum importance measure bim the model is assumed as a parallel system each of the inputs is assumed to be connected parallel to predictand through the model in such a parallel configuration failure non consideration of a single component or input does not result in failure of whole system or model elsayed 2012 for a set of parallel components or inputs i i1 i2 i3 in and p ii be the contribution of ii th component the unreliability of ii th component is given by p i i u i 1 p i i the reliability r of the whole system can be expressed as 11 r 1 u 1 u 2 u 3 u n the bim is defined as probability that a particular component is critical to the proper functioning of the system elsayed 2012 for our case the maximum possible reduction in prediction error is considered as the proper functioning of the system additionally under the assumption that reduction in the prediction error by one variable is independent of the same by other variable bim for ith variable is expressed as maity and kashid 2011 12 bi m i u 1 u 2 u 3 u i 1 u i 1 u n in our case the model is run for all possible combinations of the inputs the best 30 combinations having the least urmse are selected a particular input is termed in the working state when it is a part of the selected combination if an input ii is working in r number of total selected q models then p ii is defined as r q in this way the unreliability of each input or component and their bim is calculated the higher the bim value the more important a particular input is after relative importance analysis the model is run with a subset of inputs with higher importance significant inputs to study the change in performance if any the results of the application of the above stated methodology are discussed in the subsequent section 3 study area and data used the proposed model is tested with two data sets i synthetic data set and ii observed climatic data set from a basin the synthetic data set is created to test the model performance for known but mathematically complex relationship between predictors and predictant this leads to varying and not so strong association between predictors and predictant to mimics the natural hydro meteorological linkage since the underlying relationships between predictors and predictands are known in case of synthetic datasets the application of the proposed model to the synthetic data is expected to reveal its potential while the linear association is varying the synthetic data set is generated using five independent variables namely x 1 x 2 x 3 x 4 and x 5 with three possible dependent variables namely t 1 t 2 and t 3 in such a way that there mutual linear association measured in terms of correlation coefficient vary from high to low as shown in table 1 the time series of the dependent variables are expressed by 13 t 1 t x 2 t x 1 t 1 x 1 t 2 log x 3 t x 4 t x 5 t 10 x 4 t 14 t 2 t log x 5 t x 2 t x 3 t x 4 t tan x 1 t x 2 t x 3 t x 4 t x 5 t x 3 t x 2 t x 2 t x 1 t 15 t 3 t log log x 1 t x 2 t x 3 t x 4 t x 5 t x 2 t x 1 t tan x 2 t x 3 t x 4 t x 5 t x 1 t x 2 t x 3 t x 4 t sinh x 1 t x 2 t x 3 t x 4 t x 1 t x 3 t x 2 t x 5 t for the second application of the proposed model upper mahanadi basin umb is selected as study basin umb is a medium size watershed in the mahanadi river basin located in chhattisgarh state of india as shown in fig 2 the approximate location of the study area is 20 n to 23 n latitude and 80 5 e to 82 5 e longitude the selection of independent variables affecting rainfall is made as per previous studies anandhi et al 2008 dhanya and nagesh kumar 2011 according to these studies 16 variables are important for predicting rainfall in malaprabha basin in south india the details of variables used for rainfall prediction in umb are tabulated in table 3 the independent variables for this study are obtained from noaa reanalysis project kalnay et al 1996 the daily rainfall data for the basin is obtained from india meteorological department imd rajeevan and bhate 2008 at a spatial resolution of 0 5 latitude 0 5 longitude 4 results and discussions 4 1 application on synthetic data set the proposed model is applied three times for three different sets of predictor predictand dataset with varying degree of linear relationship eqs 13 15 as the first step of analysis mrswt decomposition up to level 2 is done for all of the five independent variables and one of the dependent variable resulting in three components for each of the variables the components of the dependent variable are found to show higher autocorrelation at lower lag than parent dependent variable series naïve kernel estimator with a window size of 5 and 20 lagged inputs from the component series is applied for prediction of components based on its memory the residuals in predicted values are then calculated residual time series for different components of dependent variable t 1 is shown in fig 3 it should be noted that kernel estimator being an autoregressive model needs lagged values form the series to model the memory in this study the 20 lagged inputs are used so with respect to original component series length the first residual is obtained for 21st component value fig 3 the figure shows that components having higher dynamics detailed components have high dynamics in residuals also it is further hypothesized that the departure in values predicted from the auto regressive model residual is partially due to the effect of other associated independent variables over the dependent time series hence either of two arx models is used for modeling the residuals by taking the first 40 residuals for model calibration it should be noted that with respect to original residual series length arx is developed using 21st 60th residuals the predicted component residuals from model 2 with p 2 and q 1 along with the original are shown in fig 3 for t 1 the dependent time series is then reconstructed by inverse wavelet transform of the sum of component predicted from kernel estimator and residual predicted from one of two models of arx the scattergrams for the predicted value of t 1 using wavelet arx model 2 as compared to original t 1 data set for different values of p and q are plotted in fig 4 the model performance of different wavelet arx models are tabulated with different numbers of auto regressive terms and exogenous inputs considered p and q in table 2 for comparison purpose the conventional arx model performance between independent and dependent time series in amplitude time domain is also provided in the table for a dependent variable having a high correlation with independent variables t 1 almost all models perform very well in some cases for t 1 well established simple arx model outperform the hybrid wavelet arx model proposed in this study for a dependent variable having a moderate correlation with independent variables t 2 hybrid wavelet arx model 1 and model 2 outperform the arx models moreover between models 1 and 2 model 2 performs better with exogenous inputs q 0 in the case of t 3 model 1 and 2 outperform arx method as evident by higher values of r2 nse and lesser values for urmse so the hybrid wavelet arx model proposed in this study enhances the prediction of dependent variables which are either moderately or poorly correlated with affecting independent variables the application of wavelet arx model on the synthetic data set bolster the fact the model is primarily a mathematical construction and its application is not limited to meteorological or hydrological domains only but may be extended to other sets of dependent and corresponding independent variable data set from different fields 4 2 prediction of total monthly rainfall over upper mahanadi basin umb the model is then used for predicting monthly rainfall in upper mahanadi basin umb the rainfall data is spatially averaged and temporally summed to get the total monthly rainfall series for the study basin as stated earlier the study period is selected to be 1971 to 2005 the causal meteorological variables obtained from noaa are spatially averaged for the grid point encompassing the study area fig 2 the coefficients of determination of different independent variables with total monthly rainfall are tabulated in table 3 the data set is then transformed into their components by using mrswt with a level of 2 the mrswt components for the dependent variable i e monthly rainfall series in umb are shown in fig 5 the autocorrelation shown by the components of the dependent time series monthly rainfall in umb is significant with small lag hence naïve kernel prediction function with a window of 5 and lagged inputs of 20 are used to predict the components of monthly rainfall if the modelled memory is inverse wavelet transformed then the correlation coefficient with the total monthly rainfall series is found to 0 472 which suggests that just by using the memory of component series some part of variability of parent time series can be explained as stated earlier the residual in the previous modeling step remaining part of component values except memory is considered to be the effect of meteorological variables affecting the rainfall the residuals are modeled using either of two arx models with first 200 data points from residual of rainfall components and components of other meteorological time series as model calibration period the residuals modeled using model 2 for p 3 and q 2 are shown in fig 6 as shown in the figure arx is quite effective in modeling residuals in the components additionally it is observed that residuals in the approximate component are modeled better than that of residuals in the detailed components as they have comparatively lesser dynamics at last the component values predicted by kernel function and residuals modeled by either of two arx models are added to get final values of the components of total monthly rainfall time series these components are transformed back to the total monthly rainfall time series using inverse wavelet transform the performance of different models in testing period is tabulated in table 4 and scatter plot for different prediction cases pairs of p and q from model 2 are plotted in fig 7 according to table 4 with non zero lag in exogenous time series input model 2 outperforms model 1 for example for model 1 p 3 and q 1 r2 dr nse and urmse are 0 877 0 848 0 872 50 533 respectively and corresponding values for model 2 are 0 905 0 864 0 898 and 45 188 respectively the better performance of model 2 suggests that there is higher association or relation between respective components or components of the same frequency band for instance residual in d1 component of total monthly rainfall is more closely related to all other d1 components from other independent time series moreover it may be noted that the proposed model is working better than conventional arx model in this case the observation strengthens the hypothesis that using prediction function at wavelet component level as in the proposed model results in better prediction performance than using the parent series directly as in conventional arx model for a variable having medium or low linear association with the predictors owing to various reasons including the presence of noise finally the model 2 with p 3 and q 2 is found to be the best performing case among all possible combinations the prediction results with this best performing model are shown in fig 8 the relative importance analysis for the inputs involved is carried out using the best performing model i e wavelet arx model 2 with p 3 and q 2 the results for dominance analysis and birnbaum importance measure analysis are tabulated in table 5 it should be noted that the independent variable having high coefficient of determination with total rainfall may not have high relative significance under the context of proposed model the coefficient of determination between two variables measures the mutual linear association in the absence of all other independent variables but the same degree of association may not be expected to be followed in a non linear model like the proposed wavelet arx model moreover the information present in one variable component can be present in other variable components also so in a multi variable prediction scenario using the wavelet arx model some independent variables may not improve prediction performance for example some of the variables like average air temperature at 200 mb and 500 mb precipitable water content and specific humidity at 850 mb have very less relative importance though they have high values of coefficient of determination tables 3 and 5 the best performing wavelet arx model 2 p 2 q 3 is run using the five most significant inputs in each of the relative importance measure indices and the performance of the model is tabulated in table 6 in the case of dominance analysis the input variables chosen are surface pressure average geo potential height at 925mb average air temperature at 925 mb average geo potential height at 500mb and average surface air temperature in the case of bim the input variables chosen are surface pressure average air temperature at 925 mb average surface air temperature average geo potential height at 925 mb and average u wind at 925 mb it can be concluded by comparing the performance measures in table 6 from that of table 4 that most of the information required to predict the total monthly rainfall over umb is concentrated in the selected five input variables it should be noted that for a component residual series the number of parameters required for training the best performing model model 2 p 3 and q 2 with 5 inputs is 18 parameters for all three residual series 54 parameters are required only compared to 51 parameters with 16 inputs 153 parameters required for all three residual series hence relative importance analysis though being itself a computationally intensive process helps in discarding less important inputs which reduces input variable dimensionality and computational requirement of the prediction model 4 3 comparison with vector auto regressive model with exogenous inputs varx the varx approach is applied to stationary wavelet coefficient or nondecimated discrete wavelet coefficients bogner and pappenberger 2011 of variables to compare the performance with the proposed model in varx monthly rainfall is considered as the dependent variable and other significant variables selected on the basis of either of darim or bim are considered exogenous inputs independent variables the varx model is given by bogner and pappenberger 2011 zivot and wang 2006 16a x t j 1 q φ x t j w t 16b y t i 1 p ϕ y t i τ x t v t where x t is a column matrix of all significant independent variables at time t n by 1 if the number of independent series is n similarly y t represents is a column matrix of monthly rainfall at time t m by 1 if the number of independent series is m p and q represents the number of auto regressive terms and exogenous inputs respectively τ and φ are n by n matrix of coefficients ϕ is m by m matrix of coefficients w t and v t are white noise all the coefficient matrix τ φ and ϕ are estimated during model calibration the performance of the varx model average of 10 realizations consisting of 1000 monte carlo simulations each is tabulated in table 6 the proposed wavelet arx model 2 is found to be performing better than the varx model despite having less parameter requirement for instance varx with p 3 and q 2 need 234 parameters for fitting relationship between discrete wavelet components of five independent and one dependent variable compared to 54 parameters required by wavelet arx model 2 p 3 and q 2 the poor performance of varx model as compared to wavelet arx may result primarily from two reasons i the provision of kernel based model in wavelet arx that model a major part of variability as memory ii the varx model is applied on swt components not the mrswt component applying varx model to mrswt component is feasible but will increase the number of parameters even further 5 summary and conclusions this study proposes a hybrid wavelet arx based approach to model the hydro meteorological associations for hydrologic prediction the basic idea is association if any present between the variables should be more prominently revealed at the constituent wave level as they are continuously evolving so the variables are converted to their wavelet components and all other analysis i e application of kernel estimator on the component of dependent time series and arx model for modeling the residual of the previous step is done at the component level the first step i e application of kernel estimator models memory part of dependent time series components and later step i e arx model models the inter relation between the residual of dependent series component and other exogenous input components the dependent variable is regenerated using inverse wavelet transform two different models are formulated based on the different selection criteria for input variable components being utilized in arx model prediction it is found that model 2 which is formulated on the basis of an assumption that components in the same frequency range affect each other more strongly is working better than other models it should be noted that mrswt at an even higher level can help in revealing component at smaller frequency bands so it should enhance the model performance however increasing mrswt level will increase the number of parameters to be estimated in model calibration so the best mrswt level can be worked out by a tradeoff between the performance gain and increase in model complexity this aspect of the model is not checked in the present study the proposed model is also found to produce a better result than the already established arx model when the correlation between the variable involved is moderate or low it is also revealed that proper importance analysis though a time taking and computationally intensive procedure of input variables in a multi input prediction problem can help in separating insignificant inputs and hence can enhance the prediction performance additionally the application of the proposed model on the synthetic data set strengthens the statement that model can be applied to study the relationship of any pair of predict and predictors from different fields too however whenever the set of changes the model need to recalibrated to estimate the parameters involved the proposed approach is desirable in a changing climate for extracting the hydro meteorological forcings to capture the relationship between other predictor predictant variables declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study is partially supported by the ministry of earth sciences moes government of india sanction order moes pamc h c 30 2013 pc ii and the department of science and technology ministry of science and technology climate change programme splice government of india ref no dst ccp coe 79 2017 g through the sponsored projects appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 123918 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6193,interaction between meteorological and hydrologic processes is challenging to model owing to their high spatio temporal variability the understanding of their associations can help to ensure future fresh water security with changing climate in this study due to continuously evolving nature of these interactions the hydrological and meteorological variables are studied on wavelet component level multi resolution stationary wavelet transformation mrswt is used to transform the independent climatic variable and dependent hydrological variable time series into their components the components of the dependent time series are modeled using a kernel based auto regressive ar model for separating their memory part the residuals are hypothesized to be the effect of interaction of predictor variables and thus are modeled using the mrswt components of meteorological variables in an auto regressive model with exogenous inputs arx finally the predicted residuals effect of climatic variables are added to the component estimated by kernel based ar estimator memory of dependent series components to obtain the predicted components of the dependent hydrologic variable which are then inverse transformed to obtain the predicted dependent hydrologic variable the developed hybrid wavelet arx is found to capture the information about relationship between synthetically generated data better than a simple arx model the model is then applied to predict total monthly rainfall over upper mahanadi basin and is found to effectively extract the information from the poorly associated hydro meteorological variables while the potential of wavelet arx is found to be impressive for hydro meteorological applications additionally discarding some climatic inputs on the basis of their relative importance may lead to better prediction by the developed model the developed model is suitable for extracting climatic forcings and is desirable in a changing climate keywords hydroclimatic association rainfall prediction simulation climate change hybrid wavelet arx model relative importance analysis 1 introduction meteorological and hydrological processes mutually affect each other at global and local scales the linkage between meteorological variables with hydrological variables at a local scale hereafter hydro meteorological association is expected to vary both with time and space due to its continuously evolving characteristics such interactions or associations are difficult to model khaliq et al 2006 maity and nagesh kumar 2008 ishak et al 2012 shih et al 2014 in this study a generalized hybrid model based on wavelet transformation and auto regressive model with exogenous input arx for capturing these hydro meteorological associations is developed and its potential is investigated the developed model is also used to figure out the climatic variables that are more important in terms of hydro meteorological association as far as rainfall is concerned in the basin it is hypothesized that the inter relationship between meteorological predictor variables and the hydrologic variable predictand is continuously evolving over time different predictor variables may have different extent of influence on the predictand variables that may not be visible in amplitude time domain of signal these inter relationships between predictor and predictand variables may have more prominent existence at some if not all frequency bands of predictand as compared to the original time series of the predictand variable hence the inter relationships are better captured at its constituent wave levels the wavelet transformation wt is one of the potential choices to separate or decompose the constituent wavelets from dependent and independent time series the components of the decomposed dependent time series are the manifestation of some innate memory autoregressive or memory part and the effect of exogenous factors forcing hence for better modeling of inter relation of dependent variable with other affecting climatic variables the innate memory of the dependent series component is required to be separated to separate the memory from the dependent components any autoregressive model can be used in this study kernel estimator is used for taking out the memory from the dependent series components the residuals after extracting the memory are hypothesized to be the effect of other exogenous factors and hence can be modeled using exogenous input in this study arx model is used for modeling the relationship between residual and components of affecting climatic inputs the wt is a signal analysis tool for transforming signals into scaled and shifted version of a zero mean finite duration disturbances function the zero mean finite duration disturbance functions are referred as mother wavelet functions many popular mother wavelet functions exist like daubechies wavelet orthogonal wavelet bi orthogonal wavelet etc burrus et al 1998 wt transforms the domain of signal from the amplitude time domain to the frequency time domain this transformation sometimes helps in obtaining further information from the signal that is not readily available in the amplitude time domain since its introduction wt has found wide application in diverse fields of sciences such as seismic signal detection image processing optics turbulence quantum mechanics medical science etc devore et al 1992 farge 1992 rockinger 1997 zhong and weng 2005 cannata et al 2013 martis et al 2013 farge and schneider 2015 rasti et al 2016 wt is well suited for the study of multi scale non stationary processes occurring over finite spatial and temporal domains burrus et al 1998 daubechies 1992 recently wavelet was used for analysis of rainfall variability westra and sharma 2006 improving rainfall prediction quiroz et al 2011 hydrologic regionalization of catchments agarwal et al 2016 forecasting drought with long lead özger et al 2012 predicting the long term groundwater levels maheswaran and khosa 2013a modeling rainfall runoff streamflow relationship kamruzzaman et al 2014 shoaib et al 2014 predicting daily streamflow maheswaran and khosa 2013b studying temporal consequences of drought maity et al 2016 and analysis of precipitation extremes tan et al 2016 these studies utilize the ability of wavelet transformation to transform the signal into the frequency time domain and extract information like dominant mode of hydrological variable e g westra and sharma 2006 or use the transformed domain for working out relation between two hydrological variables as in case of rainfall runoff modeling by kamruzzaman et al 2014 and drought precedence by maity et al 2016 comparative study of different wavelet functions along with their suitability on case to case basis in hydrologic forecasting is also studied maheswaran and khosa 2012 the major advantage of using wt is that it works like a pair of high pass and low pass filter and hence transforms the time series into two constituent component time series one called detailed component and other called approximate component the approximate component usually shows trend of the signal and the detailed component usually shows local disturbances in the signal moreover the wt can again be applied on the approximate component to produce components at even lower levels or frequency bands burrus et al 1998 the detailed components usually have higher dynamics compared to approximate component hence errors in the prediction of detailed components are expected to be higher than that in the prediction of approximate components effectively the wt changes the problem of estimation of parent time series into the estimation of its components some of the components are expected to have comparatively lesser error during prediction so the accuracy of overall prediction increases any of the sophisticated estimation techniques like genetic programming kisi and shiri 2011 support vector machine tezel and buyukyildiz 2016 artificial neural network soltani 2002 ozger et al 2011 shoaib et al 2014 sang et al 2016 etc can be applied on the wavelet components for prediction however in this study a kernel based model and an arx model are used in conjunction to predict wt components which can be further reconstructed into the amplitude time domain in brief the objective of this study is to propose a methodological approach for capturing information about hydro meteorological association for hydrologic prediction simulation using the combined potential of wavelet transformation kernel based ar approach for modelling memory and arx modelling of inter relation between variables this approach first separates memory from dependent time series at the component level and then model the inter relation of residual with affecting climate variable components the potential of the proposed model is checked through a set of synthetic data underlying relationship known and an observed data set from a river basin additionally a relative importance analysis of variables is carried out after the development of the proposed model for discarding some less important climatic inputs the model is then run using the new set of variables to check if there is any deterioration similar even improvement in model performance 2 methodology overall the methodology is broadly divided into five modules i multi resolution wavelet decomposition of both independent meteorological variables and dependent hydrological variable time series ii application of kernel based auto regressive model ar to dependent target time series components iii application of arx model for modeling residuals in predicted component values of dependent time series predicted from the ar model iv wavelet reconstruction of dependent time series using predicted components obtained by adding results of last two modules and assessment of model performance and lastly v relative importance analysis of the inputs or independent time series to identify the sub set of hydro meteorological variables with stronger association than others if necessary the model is rerun using this subset of important inputs only to check if there is an improvement in prediction results here it may be noted that step ii takes out the memory component out of dependent component series and step iii models the inter relation between rainfall component residual and the components of other affecting time series the proposed modeling framework is shown in fig 1 details of the mathematical steps in each of the modules of the methodology are discussed in the following subsections 2 1 multi resolution wavelet decomposition of time series usually the time series are represented in the amplitude time domain this representation or domain of time series can be transformed into other domains like the frequency time domain which can help in extracting the important information about the frequency of which original signal is composed of there are many mathematical tools to transform the domain of the time series one of them that is used in this study is wavelet transformation wt the wt transforms the signal in the frequency time domain and reveals the fast moving or higher dynamic component and slow moving or lesser dynamic component of time series separately when wt is again applied on slow moving component of time series then the transformation is called multi resolution wavelet transform mrwt mrwt helps in segregating the components at even lower levels 2 1 1 wavelet transformation wt under wavelet transformation shifted and scaled version of a finite domain zero mean amplitude function is used to transform the signal the finite domain zero mean amplitude function is called mother wavelet as stated earlier many popular mother wavelet functions exist like daubechies wavelet orthogonal wavelet bi orthogonal wavelet etc burrus et al 1998 the wavelet function used in this study is haar which is also regarded as daubechies1 or db1 first member of daubechies class of wavelet this wavelet function has better time localization capability so it is useful for low lead time prediction maheswaran and khosa 2012 haar wavelet is defined as 1 h t 1 0 t 0 5 1 0 5 t 1 0 otherwise due to the finite domain of wavelet functions it is possible to scale and shift these functions these operations further help in catching intermittent disturbances of different durations in the signal the scaled and shifted version of the mother wavelet ψ t is given by 2 ψ a b t 1 a ψ t k a where a and k are scale and shift parameters respectively if both of these parameters are discrete then wt is called discrete wavelet transform dwt if the discrete wavelet were sampled over a dyadic space time grid then they are called dyadic discrete wavelets cao et al 1995 computationally the dwt can be done using a pair of low pass and high pass filter low pass filter is formulated from the mother wavelet function and high pass filter is formulated using corresponding scaling function scaling function acts as a threshold to avoid the condition of infinite application of mother wavelet function for example the scaling function for haar wavelet function is given by 3a ϕ t 1 0 t 1 0 otherwise 3b ϕ 0 k t ϕ t k where k is the shift parameter and φ t is the scaling function during the decomposition of the signal the pair of filters is convolved with the signal followed by subband down sampling to give two components the subband coding is done as per the nyquist shannon sampling theorem shannon 1949 to reduce redundancy in components by removing every second component values the component from low pass filter is called the approximation coefficient and another component is called the detailed component the approximated component shows the trend of signal and has low dynamics the detailed component shows the local details of the signal and has higher dynamics dwt is very efficient in separating the signal into fast and slow dynamics however due to subband coding it has inherent disadvantage of transition invariance in components bradley 2003 a little change even single addition or elimination of data member in the original signal can lead to completely different sets of components moreover due to subband coding the components have half the length compared to signal which causes difficulty in the signal analysis to avoid these problems stationary wavelet transform swt is used in this study the swt nason and silverman 1995 murtagh et al 2004 renaud et al 2005 is specially designed to avoid the transition invariance of dwt it achieves transition variance by avoiding down sampling of components as per nyquist shannon sampling theorem and up sampling the filter coefficient by a factor of 2 j 1 in the j th level of the algorithm hence the swt unlike dwt does not change the time resolution at any stage however the lack of subband coding give rise to redundancies in components as components now have twice the number of elements needed as per nyquist shannon sampling theorem shannon 1949 swt reduces the complexity of signal analysis as both the input signal and its components have equal length in this study the swt is used as preferred wt for decomposing different meteorological and hydrological time series but the model developed can be used with dwt also 2 1 2 multi resolution wavelet transform mrwt as stated earlier mrwt is a procedure in which wt is applied repeatedly over the approximate component which results in more components at an even lower level the new components obtained encompasses half of the bandwidth that the parent component had after mrwt the signal can be expressed as 4 f t k a n k ϕ n k t j 1 n k d j k ψ j k t where a n k is called the coarse or approximate coefficients and d j k is called the detailed wavelet coefficients or simply detailed components at level j n is the maximum level of decomposition of mrwt k denotes the shift parameter of wavelet functions mrwt is classified on the basis of wt involved in the process hence if swt is used as preferred wt then the multi resolution analysis is called mrswt in this study haar mrswt is applied up to level 2 is used to decompose the dependent and independent time series 2 2 application of auto regressive model to predict dependent time series components after mrswt the dependent or hydrological variable time series y t can be expressed in the form of components as shown in eq 4 so to estimate the future value of the target dependent variables i e y m w where w is lead time we need to predict the expected value of its corresponding components i e a n m w and d j m w where a n and d j are the set of all approximate and detailed components at different scales if the components are having innate memory then these components can be mathematically estimated as 5a a n m w f 0 a n m w a n m w 1 a n m a n m r 0 5b d j m w f j d j m w d j m w 1 d j m d j m r 0 j 1 2 3 n where f 0 and f j are appropriate auto regressive estimation functions m r 0 is the last time step being utilized for the estimation in this study the estimation of components is done by using kernel estimator functions the kernel estimator function if w is taken as 1 can be written as mabrouk et al 2008 6 a n m 1 t 1 m a n t k t m 1 h t 1 m k t m 1 h 7 d j m 1 t 1 m d j t k t m 1 h t 1 m k t m 1 h where k represents kernel function and parameter h is the window of the kernel function the kernel function used in this study is naïve kernel function maity and nagesh kumar 2008 bosq 2012 and it is given by 8 k u 1 0 5 u 0 5 the kernel estimator expression in eqs 6 and 7 can be proved to be an ar model mabrouk et al 2008 moreover it should be noted that kernel based ar can be used with data of any distribution as kernel estimator function is non parametric unlike conventional ar with distributional requirements for the variables it should also be noted that different types of kernel function like naïve gaussian etc exist which makes kernel estimator a versatile tool for modeling the memory in the components of dependent variable series however kernel estimator cannot model the inter relation across different meteorological and hydrological time series components hence the residual after prediction from kernel estimator is hypothesized to be partly the contribution of these interactions and it is modeled using components from other independent variable using arx 2 3 application of arx to model the residuals in general the arx models utilize the previous information from the same time series and the time series of causal independent variable s for future prediction karamouz et al 2012 jayawardena 2014 maity 2018 this is to note here that proposed method needs the future values of the causal independent variables that may be obtained from climate model simulation it is well known that the skill of climate models in predicting the meteorological variables is much better than hydrologic variables like rainfall two different arx models were framed for modeling the residuals the models follow common methodology but mainly differ in the selection of components of independent time series c as input in model 1 all the components of independent time series are used to predict the residual of each component of the dependent time series on the other hand in model 2 only the corresponding components of independent time series are used to predict a particular component of the dependent time series in general both model structures are given by 9 a c y t k 1 p s k a c y t p l 1 c j 0 q t l j c x l t j e where the number of auto regressive terms and exogenous inputs are represented by p and q respectively a c y t is tth member of residual in any one component out of a2 d2 or d1 for level 2 of dependent variable y cx represent set of selected individual components of the independent variable set x and c represent the number of element or cardinal number of cx cx l represents an individual member of cx in the case of model 1 all components of all independent variables are selected and in case of model 2 only the corresponding components as of the dependent time series are selected for example in model 2 the d2 component of the dependent time series is predicted using only the d2 components of all the independent time series s and t represent the regression parameters set estimated during model calibration period at first models are trained with calibration period values of components residuals to estimate the model coefficients involved and then it applied on the testing period data set 2 4 reconstruction of dependent time series finally the component values predicted from kernel estimator and corresponding residual modeled by the arx model over testing period are added to get final predicted values for each of the components of dependent or hydrological time series the dependent time series is reconstructed from these components using inverse wavelet transform the reconstructed and observed dependent time series are analyzed to establish potency of the developed model using performance indices like coefficient of determination unbiased root mean square error etc for assessing model performance 2 5 model performance assessment for the assessment of model performance various statistical measures like coefficient of determination r2 unbiased root mean square error urmse nash sutcliffe model efficiency coefficient nse and degree of agreement dr are used the expression for r2 nse and dr can be found in other literature krause et al 2005 willmott et al 2012 maity et al 2016 the urmse is root mean square error rmse calculated between deviations from the mean of observed and estimated time series 2 6 relative importance analysis of inputs relative importance analysis of inputs helps in separating variables having stronger hydro meteorological associations from others some of the inputs may actually increase the noise uncertainty as they may have negligible information for the predictant at the component level this aspect is investigated by the relative importance analysis of inputs the methodology of dominance analysis and birnbaum importance measure are used for studying the relative importance of the inputs birnbaum 1968 budescu 1993 maity and kashid 2011 tonidandel and lebreton 2011 in dominance analysis the average change in the coefficient of determination r2 by adding a particular input variable to all possible subsets or combination of other input variables is considered a measure of relative importance higher the change more important the input is for calculating the importance measure at first one input is separated from all the inputs r2 is calculated by running models for all possible combinations of other inputs next the separated input is included in all other combinations and r2 is calculated by running models on them the change in r2 shows the effect of inclusion of previously separated input in every case the average of all the change of r2 is considered relative importance measure for dominance of the input variable this procedure is repeated for all input variables one by one to get relative importance measure rim for dominance of all inputs the higher the value of this measure the more important the input variable is compared to other variables hence by dominance analysis relative importance measure for ith input darimi is given by 10 dari m i j 1 2 n 1 1 r m p o j i i 2 r m p o j 2 2 n 1 1 where i is the set of all inputs individual input is designated by ii n is the total number of inputs m designates the application of model function and po p i i i φ or po is power set of all inputs except ith input excluding null set r2 as stated earlier is the coefficient of determination hence the cardinality or total number of members of po is 2 n 1 1 poj denotes the jth member of po it can be observed from the equation that the model need to be executed for n 2n 2 times for calculating darim for all the input variables hence the application of dominance analysis is time taking and computationally intensive procedure for calculating the relative importance of inputs using birnbaum importance measure bim the model is assumed as a parallel system each of the inputs is assumed to be connected parallel to predictand through the model in such a parallel configuration failure non consideration of a single component or input does not result in failure of whole system or model elsayed 2012 for a set of parallel components or inputs i i1 i2 i3 in and p ii be the contribution of ii th component the unreliability of ii th component is given by p i i u i 1 p i i the reliability r of the whole system can be expressed as 11 r 1 u 1 u 2 u 3 u n the bim is defined as probability that a particular component is critical to the proper functioning of the system elsayed 2012 for our case the maximum possible reduction in prediction error is considered as the proper functioning of the system additionally under the assumption that reduction in the prediction error by one variable is independent of the same by other variable bim for ith variable is expressed as maity and kashid 2011 12 bi m i u 1 u 2 u 3 u i 1 u i 1 u n in our case the model is run for all possible combinations of the inputs the best 30 combinations having the least urmse are selected a particular input is termed in the working state when it is a part of the selected combination if an input ii is working in r number of total selected q models then p ii is defined as r q in this way the unreliability of each input or component and their bim is calculated the higher the bim value the more important a particular input is after relative importance analysis the model is run with a subset of inputs with higher importance significant inputs to study the change in performance if any the results of the application of the above stated methodology are discussed in the subsequent section 3 study area and data used the proposed model is tested with two data sets i synthetic data set and ii observed climatic data set from a basin the synthetic data set is created to test the model performance for known but mathematically complex relationship between predictors and predictant this leads to varying and not so strong association between predictors and predictant to mimics the natural hydro meteorological linkage since the underlying relationships between predictors and predictands are known in case of synthetic datasets the application of the proposed model to the synthetic data is expected to reveal its potential while the linear association is varying the synthetic data set is generated using five independent variables namely x 1 x 2 x 3 x 4 and x 5 with three possible dependent variables namely t 1 t 2 and t 3 in such a way that there mutual linear association measured in terms of correlation coefficient vary from high to low as shown in table 1 the time series of the dependent variables are expressed by 13 t 1 t x 2 t x 1 t 1 x 1 t 2 log x 3 t x 4 t x 5 t 10 x 4 t 14 t 2 t log x 5 t x 2 t x 3 t x 4 t tan x 1 t x 2 t x 3 t x 4 t x 5 t x 3 t x 2 t x 2 t x 1 t 15 t 3 t log log x 1 t x 2 t x 3 t x 4 t x 5 t x 2 t x 1 t tan x 2 t x 3 t x 4 t x 5 t x 1 t x 2 t x 3 t x 4 t sinh x 1 t x 2 t x 3 t x 4 t x 1 t x 3 t x 2 t x 5 t for the second application of the proposed model upper mahanadi basin umb is selected as study basin umb is a medium size watershed in the mahanadi river basin located in chhattisgarh state of india as shown in fig 2 the approximate location of the study area is 20 n to 23 n latitude and 80 5 e to 82 5 e longitude the selection of independent variables affecting rainfall is made as per previous studies anandhi et al 2008 dhanya and nagesh kumar 2011 according to these studies 16 variables are important for predicting rainfall in malaprabha basin in south india the details of variables used for rainfall prediction in umb are tabulated in table 3 the independent variables for this study are obtained from noaa reanalysis project kalnay et al 1996 the daily rainfall data for the basin is obtained from india meteorological department imd rajeevan and bhate 2008 at a spatial resolution of 0 5 latitude 0 5 longitude 4 results and discussions 4 1 application on synthetic data set the proposed model is applied three times for three different sets of predictor predictand dataset with varying degree of linear relationship eqs 13 15 as the first step of analysis mrswt decomposition up to level 2 is done for all of the five independent variables and one of the dependent variable resulting in three components for each of the variables the components of the dependent variable are found to show higher autocorrelation at lower lag than parent dependent variable series naïve kernel estimator with a window size of 5 and 20 lagged inputs from the component series is applied for prediction of components based on its memory the residuals in predicted values are then calculated residual time series for different components of dependent variable t 1 is shown in fig 3 it should be noted that kernel estimator being an autoregressive model needs lagged values form the series to model the memory in this study the 20 lagged inputs are used so with respect to original component series length the first residual is obtained for 21st component value fig 3 the figure shows that components having higher dynamics detailed components have high dynamics in residuals also it is further hypothesized that the departure in values predicted from the auto regressive model residual is partially due to the effect of other associated independent variables over the dependent time series hence either of two arx models is used for modeling the residuals by taking the first 40 residuals for model calibration it should be noted that with respect to original residual series length arx is developed using 21st 60th residuals the predicted component residuals from model 2 with p 2 and q 1 along with the original are shown in fig 3 for t 1 the dependent time series is then reconstructed by inverse wavelet transform of the sum of component predicted from kernel estimator and residual predicted from one of two models of arx the scattergrams for the predicted value of t 1 using wavelet arx model 2 as compared to original t 1 data set for different values of p and q are plotted in fig 4 the model performance of different wavelet arx models are tabulated with different numbers of auto regressive terms and exogenous inputs considered p and q in table 2 for comparison purpose the conventional arx model performance between independent and dependent time series in amplitude time domain is also provided in the table for a dependent variable having a high correlation with independent variables t 1 almost all models perform very well in some cases for t 1 well established simple arx model outperform the hybrid wavelet arx model proposed in this study for a dependent variable having a moderate correlation with independent variables t 2 hybrid wavelet arx model 1 and model 2 outperform the arx models moreover between models 1 and 2 model 2 performs better with exogenous inputs q 0 in the case of t 3 model 1 and 2 outperform arx method as evident by higher values of r2 nse and lesser values for urmse so the hybrid wavelet arx model proposed in this study enhances the prediction of dependent variables which are either moderately or poorly correlated with affecting independent variables the application of wavelet arx model on the synthetic data set bolster the fact the model is primarily a mathematical construction and its application is not limited to meteorological or hydrological domains only but may be extended to other sets of dependent and corresponding independent variable data set from different fields 4 2 prediction of total monthly rainfall over upper mahanadi basin umb the model is then used for predicting monthly rainfall in upper mahanadi basin umb the rainfall data is spatially averaged and temporally summed to get the total monthly rainfall series for the study basin as stated earlier the study period is selected to be 1971 to 2005 the causal meteorological variables obtained from noaa are spatially averaged for the grid point encompassing the study area fig 2 the coefficients of determination of different independent variables with total monthly rainfall are tabulated in table 3 the data set is then transformed into their components by using mrswt with a level of 2 the mrswt components for the dependent variable i e monthly rainfall series in umb are shown in fig 5 the autocorrelation shown by the components of the dependent time series monthly rainfall in umb is significant with small lag hence naïve kernel prediction function with a window of 5 and lagged inputs of 20 are used to predict the components of monthly rainfall if the modelled memory is inverse wavelet transformed then the correlation coefficient with the total monthly rainfall series is found to 0 472 which suggests that just by using the memory of component series some part of variability of parent time series can be explained as stated earlier the residual in the previous modeling step remaining part of component values except memory is considered to be the effect of meteorological variables affecting the rainfall the residuals are modeled using either of two arx models with first 200 data points from residual of rainfall components and components of other meteorological time series as model calibration period the residuals modeled using model 2 for p 3 and q 2 are shown in fig 6 as shown in the figure arx is quite effective in modeling residuals in the components additionally it is observed that residuals in the approximate component are modeled better than that of residuals in the detailed components as they have comparatively lesser dynamics at last the component values predicted by kernel function and residuals modeled by either of two arx models are added to get final values of the components of total monthly rainfall time series these components are transformed back to the total monthly rainfall time series using inverse wavelet transform the performance of different models in testing period is tabulated in table 4 and scatter plot for different prediction cases pairs of p and q from model 2 are plotted in fig 7 according to table 4 with non zero lag in exogenous time series input model 2 outperforms model 1 for example for model 1 p 3 and q 1 r2 dr nse and urmse are 0 877 0 848 0 872 50 533 respectively and corresponding values for model 2 are 0 905 0 864 0 898 and 45 188 respectively the better performance of model 2 suggests that there is higher association or relation between respective components or components of the same frequency band for instance residual in d1 component of total monthly rainfall is more closely related to all other d1 components from other independent time series moreover it may be noted that the proposed model is working better than conventional arx model in this case the observation strengthens the hypothesis that using prediction function at wavelet component level as in the proposed model results in better prediction performance than using the parent series directly as in conventional arx model for a variable having medium or low linear association with the predictors owing to various reasons including the presence of noise finally the model 2 with p 3 and q 2 is found to be the best performing case among all possible combinations the prediction results with this best performing model are shown in fig 8 the relative importance analysis for the inputs involved is carried out using the best performing model i e wavelet arx model 2 with p 3 and q 2 the results for dominance analysis and birnbaum importance measure analysis are tabulated in table 5 it should be noted that the independent variable having high coefficient of determination with total rainfall may not have high relative significance under the context of proposed model the coefficient of determination between two variables measures the mutual linear association in the absence of all other independent variables but the same degree of association may not be expected to be followed in a non linear model like the proposed wavelet arx model moreover the information present in one variable component can be present in other variable components also so in a multi variable prediction scenario using the wavelet arx model some independent variables may not improve prediction performance for example some of the variables like average air temperature at 200 mb and 500 mb precipitable water content and specific humidity at 850 mb have very less relative importance though they have high values of coefficient of determination tables 3 and 5 the best performing wavelet arx model 2 p 2 q 3 is run using the five most significant inputs in each of the relative importance measure indices and the performance of the model is tabulated in table 6 in the case of dominance analysis the input variables chosen are surface pressure average geo potential height at 925mb average air temperature at 925 mb average geo potential height at 500mb and average surface air temperature in the case of bim the input variables chosen are surface pressure average air temperature at 925 mb average surface air temperature average geo potential height at 925 mb and average u wind at 925 mb it can be concluded by comparing the performance measures in table 6 from that of table 4 that most of the information required to predict the total monthly rainfall over umb is concentrated in the selected five input variables it should be noted that for a component residual series the number of parameters required for training the best performing model model 2 p 3 and q 2 with 5 inputs is 18 parameters for all three residual series 54 parameters are required only compared to 51 parameters with 16 inputs 153 parameters required for all three residual series hence relative importance analysis though being itself a computationally intensive process helps in discarding less important inputs which reduces input variable dimensionality and computational requirement of the prediction model 4 3 comparison with vector auto regressive model with exogenous inputs varx the varx approach is applied to stationary wavelet coefficient or nondecimated discrete wavelet coefficients bogner and pappenberger 2011 of variables to compare the performance with the proposed model in varx monthly rainfall is considered as the dependent variable and other significant variables selected on the basis of either of darim or bim are considered exogenous inputs independent variables the varx model is given by bogner and pappenberger 2011 zivot and wang 2006 16a x t j 1 q φ x t j w t 16b y t i 1 p ϕ y t i τ x t v t where x t is a column matrix of all significant independent variables at time t n by 1 if the number of independent series is n similarly y t represents is a column matrix of monthly rainfall at time t m by 1 if the number of independent series is m p and q represents the number of auto regressive terms and exogenous inputs respectively τ and φ are n by n matrix of coefficients ϕ is m by m matrix of coefficients w t and v t are white noise all the coefficient matrix τ φ and ϕ are estimated during model calibration the performance of the varx model average of 10 realizations consisting of 1000 monte carlo simulations each is tabulated in table 6 the proposed wavelet arx model 2 is found to be performing better than the varx model despite having less parameter requirement for instance varx with p 3 and q 2 need 234 parameters for fitting relationship between discrete wavelet components of five independent and one dependent variable compared to 54 parameters required by wavelet arx model 2 p 3 and q 2 the poor performance of varx model as compared to wavelet arx may result primarily from two reasons i the provision of kernel based model in wavelet arx that model a major part of variability as memory ii the varx model is applied on swt components not the mrswt component applying varx model to mrswt component is feasible but will increase the number of parameters even further 5 summary and conclusions this study proposes a hybrid wavelet arx based approach to model the hydro meteorological associations for hydrologic prediction the basic idea is association if any present between the variables should be more prominently revealed at the constituent wave level as they are continuously evolving so the variables are converted to their wavelet components and all other analysis i e application of kernel estimator on the component of dependent time series and arx model for modeling the residual of the previous step is done at the component level the first step i e application of kernel estimator models memory part of dependent time series components and later step i e arx model models the inter relation between the residual of dependent series component and other exogenous input components the dependent variable is regenerated using inverse wavelet transform two different models are formulated based on the different selection criteria for input variable components being utilized in arx model prediction it is found that model 2 which is formulated on the basis of an assumption that components in the same frequency range affect each other more strongly is working better than other models it should be noted that mrswt at an even higher level can help in revealing component at smaller frequency bands so it should enhance the model performance however increasing mrswt level will increase the number of parameters to be estimated in model calibration so the best mrswt level can be worked out by a tradeoff between the performance gain and increase in model complexity this aspect of the model is not checked in the present study the proposed model is also found to produce a better result than the already established arx model when the correlation between the variable involved is moderate or low it is also revealed that proper importance analysis though a time taking and computationally intensive procedure of input variables in a multi input prediction problem can help in separating insignificant inputs and hence can enhance the prediction performance additionally the application of the proposed model on the synthetic data set strengthens the statement that model can be applied to study the relationship of any pair of predict and predictors from different fields too however whenever the set of changes the model need to recalibrated to estimate the parameters involved the proposed approach is desirable in a changing climate for extracting the hydro meteorological forcings to capture the relationship between other predictor predictant variables declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study is partially supported by the ministry of earth sciences moes government of india sanction order moes pamc h c 30 2013 pc ii and the department of science and technology ministry of science and technology climate change programme splice government of india ref no dst ccp coe 79 2017 g through the sponsored projects appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 123918 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6194,this study explores the utility of observations of deuterium excess dx of water vapor for attribution of vapor to remote source regions and local influences a lagrangian back trajectory model was combined with various parameterizations of the dx of ocean evaporation and land evapotranspiration to simulate daily vapor dx at a continental site a marine site and a coastal site the model reproduced reasonably well the observed variabilities in the vapor dx at the coastal and the marine site when water vapor at these sites were primarily influenced by large scale advection from ocean sources the simple parameterization relating dx of the ocean evaporation to relative humidity is a robust representation of the ocean isotopic evaporation on the other hand the model did poorly for the continental site and during the land evapotranspiration dominated months at the coastal and the marine site confirming the published findings that the water vapor dx near the earth s surface can be significantly altered by land evapotranspiration and therefore is not a conserved tracer of humidity from the marine moisture source region several parameterizations for the dx of land evapotranspiration suggested by previous studies were tested with the trajectory model but none brought improvement to the simulation of the dx at the continental site our study emphasizes that a fundamental challenge in isotopy hydrology is the lack of understanding of the different fractionation processes of 18o and d associated with land evapotranspiration keywords deuterium excess moisture source back trajectory kinetic fractionation 1 introduction water vapor isotopes hdd and h2 18o in the atmospheric boundary layer have been widely used in tracing physical processes in hydrological and climatic studies aemisegger and sjolte 2018 galewsky et al 2016 gat 1996 good et al 2015 jasechko et al 2013 wright et al 2017 variations in the abundance of these isotopes expressed in delta notation as δd or δ18o result from equilibrium and kinetic fractionation associated with phase changes of water during land surface evapotranspiration sub cloud raindrop evaporation and in cloud condensation and from mixing during atmospheric convection boundary layer entrainment and airmass advection in these processes the vapor δd or δ18o is not conserved for example in the process of large scale airmass advection as the air mass dries out due to precipitation the remaining vapor becomes progressively depleted in d and 18o the rayleigh distillation model gat 2000 predicts a reduction of 100 for δd at a dryout ratio of 0 3 and a condensation temperature of 10 c according to the pseudo adiabatic rayleigh model noone 2012 smith 1992 δd will decrease by about 120 if 70 of the moisture rains out of the air parcel in its vertical accent during moist convection as a measure of the abundance of the d isotope relative to the 18o isotope deuterium excess of water vapor dx is formally defined as dx δd 8 δ18o here the factor 8 effectively removes the difference in equilibrium fractionation between d and 18o so dx is essentially controlled by kinetic fractionation merlivat and jouzel 1979 equilibrium fractionation results from the lower saturation vapor pressures of hdo and h2 18o than that of h2o and kinetic fractionation from the fact that hdo and h2 18o have lower diffusion efficiencies in unsaturated air than h2o unlike δd or δ18o whose time variations are overwhelmed by rayleigh distillation or rainout history of airmass advection dx of atmospheric vapor is nearly constant during the transport of an airmass the dx observed in the atmospheric boundary layer abl is sensitive to kinetic fractionation and can change if the water source region changes that is if the air is advected from a different region changes to dx at a fixed location can also occur if the air comes from the same source but the relative humidity rh and surface temperature at the source region changes simonin et al 2014 aemisegger et al 2014 since the dx is also slightly controlled by equilibrium fractionation temperature dependence the relative humidity is usually normalized by the saturation vapor pressure at the sea surface temperature for example a 20 reduction in rhsst at the ocean source increases the vapor dx by about 10 these changes are large but predictable pfahl and wernli 2008 uemura et al 2012 a reproducible relationship between the dx and relative humidity near the ocean surface has been observed across a wide range of locations aemisegger et al 2014 pfahl and sodemann 2014 pfahl and wernli 2008 steen larsen et al 2015 uemura et al 2008 although the impact of wind speed on the dx variation requires further clarification benetti et al 2014 lewis et al 2013 uemura et al 2012 given this relationship dx is considered a good tracer of sea surface evaporative conditions and has been widely used to document oceanic sources of moisture delattre et al 2015 jouzel et al 2013 lewis et al 2013 masson delmotte et al 2005 merlivat and jouzel 1979 yamanaka and shimizu 2007 however several studies have questioned whether the dx observed on land can be used as a conserved tracer of oceanic moisture sources aemisegger et al 2014 lai and ehleringer 2011 parkes et al 2017 simonin et al 2014 welp et al 2012 zhao et al 2014 a diurnal cycle of the dx near the land surface has been reported for a range of land surface types implying a role of land evapotranspiration in modifying dx at the sub day time scale berkelhammer et al 2013 simonin et al 2014 welp et al 2012 using dx measurements from six mid latitude sites welp et al 2012 showed that the dx near the ground surface can be significantly altered by local environmental conditions including abl height and local rh aemisegger et al 2014 found that the dx value is inversely related to the rh at the land vapor source currently isotope enabled global circulation models gcms can simulate dx over ocean surfaces reasonably well uemura et al 2008 but generally have difficulty reproducing the dx observed on land even for coastal and marine sites e g steen larsen et al 2017 wei et al 2016 one possible reason for the poor model performance is that these models do not account for the role of land surface evapotranspiration in controlling dx moreover dx of the near surface vapor may be influenced by raindrop evaporation and by abl entrainment the kinetic effect of raindrop evaporation which causes the vapor dx to increase is mostly limited to the free atmosphere entrainment itself does not alter the total number of vapor isotopic molecules in the air column but can change the near surface dx if the free atmospheric dx is different from the abl dx although the community traditionally assumes that dx is the same between these two air layers gat 2000 several observational studies indicate that dx in the free atmosphere is greater than that in the abl bailey et al 2013 galewsky and samuels crow 2014 he and smith 1999 in summary temporal variations in the abl dx observed at a fixed location on land represent a composite signal of multiple influences by remote moisture sources as well as processes in the local domain an outstanding challenge is how to best isolate the role of non local vapor sources and other local effects using the observed dx time series to elucidate the mechanisms underlying the observed dx patterns here we developed a process based lagrangian model for simulating dx at the hourly time resolution this model was then used 1 to quantify how much information on initial conditions of remote oceanic moisture sources can be inferred from the dx observed at land sites 2 to investigate the extent to which land evapotranspiration modifies the abl dx and 3 to determine if a suitable dx parameterization exists that can be used for land surface evapotranspiration 2 methods 2 1 study sites the dx data were obtained from three mid latitude sites including luancheng in northeast china mase in central japan and new haven in northeast us table 1 although vapor isotope data are available for more than 30 sites wei et al 2019 these three sites were selected for their special climatic conditions continental marine and coastal luanchang is located in a landscape dominated by dryland crops mainly wheat and corn and at a distance of 270 km from the yellow sea the mase site is located on tsukuba japan at a distance of 30 km from north pacific ocean new haven is an urban site situated at a distance of 2 6 km from the atlantic ocean detailed information on the local climates instrumentation and calibration protocols can be found in wen et al 2012 and xiao et al 2012 for luancheng wei et al 2016 for mase and welp et al 2012 for new haven the original data were reported at hourly intervals here we used daytime 8 00 18 00 mean dx a time period when the atmospheric boundary layer was well mixed 2 2 lagrangian vapor deuterium excess model the backbone of our lagrangian dx model is the trajectory model hysplit http ready arl noaa gov hysplit php version 4 0 adler et al 2003 draxler and hess 1997 stein et al 2015 and the backward trajectory diagnostic algorithm proposed by sodemann et al 2008 unlike sodemann et al 2008 and pfahl and wernli 2009 we do not use the diagnosed source regions to initialize an isotope model or to estimate dx from theoretical equations but instead determine dx of the moisture source from a simple linear function of relative humidity rh at the source with minor temperature and wind speed effects being ignored in our model dx is conserved during airmass advection except when new vapor is added to the airmass by surface evaporation removal of moisture by precipitation does not change the dx the effect of raindrop evaporation is also ignored each backward trajectory was calculated for up to 10 days the default forcing data was the gdas global data assimilation system data with 1 1 spatial resolution and 3 h time resolution we also forced the model with ncep reanalysis 2 with 1 75 1 75 spatial resolution and 6 h time resolution the trajectory release height was 500 m above the ground altogether about 6560 trajectories were calculated for 820 measurement days with a total measurement duration of about 20 000 hr specific humidity temperature and relative humidity of the air parcel at each trajectory time step were used to calculate the dx as explained below the change in the specific humidity q between the two successive time steps along the backward trajectory was computed as fig 1 crawford et al 2017 2013 pfahl and wernli 2008 sodemann et al 2008 wei et al 2018a 1 δ q t q x t q x t δ t where x t denotes the position of the air mass at time t and δ t is either 3 h gdas or 6 h ncep if δ q t g k g 1 is positive moisture is taken up by the air parcel as a result of surface evaporation if q is lower than 0 05 g k g 1 the trajectory is terminated the dx of the air parcel is updated if δ q is positive to account for the influence of surface evaporation using one of the seven parameterizations for the deuterium excess of evaporated vapor table 2 parameterizations 1 to 3 consider only the influence of oceanic evaporation and omit the influence of land evapotranspiration and parameterizations 4 to 6 include both effects in parameterizations 1 to 3 ocean evaporation is the only source of moisture for the air parcel and precipitation is the only sink and precipitation does not change dx along the trajectory fig 1 the change in dx between two successive trajectory time steps is given by 2 k t x k t 1 q t q t 1 x 1 k t 1 δ q t dx sst t 3 d x t k t q t where k g kg 1 is an intermediate variable x is a flag variable and dx sst is dx value of oceanic evaporation here x is equal to 1 for a grid marked as land surface meaning that the dx of the air parcel remains unchanged and is equal to 0 for a grid marked as ocean surface and δ q t 0 meaning that oceanic evaporation contributes to a change in dx eq 3 ensures isotopic mass balance by weighting specific humidity in each time step in parameterizations 4 to 6 eq 2 is modified to 4 k t x k t δ t q t q t δ t 1 x k t δ t δ q t dx sst t 1 l s f t δ q t dx ls t l s f t where x is equal to 1 for δ q t 0 g kg 1 and 0 for δ q t 0 g kg 1 the grid flag lsf determines whether the change in q is caused by oceanic evaporation or land evapotranspiration if lsf at time t is 0 eq 4 is reduced to eq 2 if δ q t 0 g k g 1 or the grid over which the parcel resides at time t is land eq 4 becomes k t k t δ t δ q t dx ls t where dxls is the dx value of land surface evapotranspiration experimental studies show that the relative humidity rhsst above the ocean surface in reference to the sea surface temperature sst c is highly anti correlated with the dx of atmospheric water vapor over wide ranges of geographic and evaporation conditions angert et al 2008 pfahl and wernli 2008 steen larsen et al 2015 2014 uemura et al 2008 a meta analysis of these studies yields a mean relationship between dx of oceanic evaporation and rhsst 5 dx sst 54 0 rh sst 48 2 pfahl and sodemann 2014 in this study eq 5 is the default parameterization of the dx of the vapor evaporated from a marine source parameterization 1 table 2 the slope of the dx sst versus rh sst relationship may depend on season measurement location and moisture transport path showing a variation in the range of 43 to 58 for the purpose of sensitivity analysis we have tested two more parameterizations for d x sst one with the most negative slope value dx sst 54 0 rh sst 51 0 provided by uemura et al 2008 parameterization 2 and the other with the least negative slope dx sst 42 6 rh sst 43 5 provided by steen larsen et al 2014 parameterization 3 table 2 in parameterizations 4 and 5 the dx of land evapotranspiration is calculated with regression equations deduced from the site measurements with local rh as the input variable section 3 4 parameterizations 6 are based on the study by aemisegger et al 2014 6 dx ls t e t e t t r h t 100 e t e t t where dx ls has the unit of e w m 2 is soil evaporation and et w m 2 is total evapotranspiration this equation is deduced from aemisegger et al 2014 s fig 12 the ratio e et is obtained from the gldas noah land surface model v2 noah lsm for parameterizations 6 with using rh from the gads reanalysis more detailed information can be found in section 4 2 2 3 isogsm simulation we also compared the observed dx and the dx results from our trajectory model with those produced by the isotope enabled global spectral model isogsm yoshimura et al 2008 isogsm simulates the water vapor dx with a horizontal resolution of 1 75 degrees in six hourly intervals the data at the lowest grid height 2 m above the ground surface are used for comparison by using a spectral nudging technique isogsm can reproduce reasonably well synoptic scale variabilities of δd and δ18o of the near surface water vapor in coastal areas wei et al 2016 a detailed description of the model configuration can be found in yoshimura et al 2008 2014 the grid cells used here are centered at 138 75 e and 35 283 n 114 375 e and 37 142 n and 73 125 e and 40 952 n corresponding to mase luancheng and new haven respectively 3 results 3 1 spatial and temporal variabilities of water vapor dx fig 2 is an example showing evolutions of q δq and dx during a trajectory segment with the end time of 12 00 jst on september 20 2013 and the end destination at mase for parameterizations 1 and 4 the specific humidity had a very low value at the start of the airmass transport about 1 5 g k g 1 from 96 hr to 78 hr from a land surface fig 2a black line it became higher when the airmass passed over the ocean surface 78 hr to 18 hr and then was slightly depleted after the airmass had reached the land of japan 18 hr to 0 hr the positive δq was found mainly over the ocean grid points suggesting that the moisture source was dominated by ocean evaporation fig 2a yellow line since there was no ocean source before 75 hr parameterizations 1 black line in fig 2b started at 75 hr while for parameterizations 4 it started at 96 hr compare to parameterization 1 parameterization 4 produced more variable dx because land surface evapotranspiration produced different dx from that of the ocean source fig 3 shows the variations in specific humidity left panels and dx right panels along back trajectories generated with parameterization 1 for the three sites in august 2013 mase august 2008 luancheng and august 2007 new haven the monthly contribution from land or ocean was calculated by the sum of moisture coming from that region and was weighted by the specific humidity at destination for each trajectory for all the sites the specific humidity was initially low at the start of the airmass transport and became higher if the airmass passed over the ocean area for most trajectories for the mase site 88 of the moisture came from the pacific ocean with a secondary contribution 10 from land in north china and mongolia fig 3a in contrast for the luancheng site fig 3c the dominant moisture came from interiors of north china 98 with only a minor contribution from the pacific ocean 2 for the new haven site the contribution of land sources was 67 and that of ocean sources was 33 the simulation results show that changes in moisture source region were a driver of the dx variability at mase water vapor originated from high latitude ocean surfaces generally had a lower dx 6 to 14 than that from low latitude ocean surfaces 12 to 22 fig 3b at new haven dx varied from 12 to 18 and 6 to 12 along the trajectories that originated from the north atlantic ocean and the arctic ocean respectively fig 3f at luancheng the modeled dx was slightly higher than at new haven ranging from 8 to 20 fig 3d our trajectory results show that temporal variations in dx at mase were closely related to changes in moisture source the observed dx displayed a clear seasonal cycle with the highest daytime mean in january 31 9 and the lowest daytime mean in july 1 7 table 1 fig 4 the back trajectory analysis shows that the winter high dx was associated with high contributions to the local moisture from the japan sea where low rh caused strong kinetic effects and high evaporation rates in contrast the warm season low dx was associated with moisture originated from the low latitude pacific ocean under conditions of high rh this dichotomy of source region and dx between seasons suggests that the dx measured in marine climate may be a good tracer of moisture source the dx measured in new haven had a similar seasonal pattern as mase showing lower values in the warm season than in the cold season the highest daytime mean value of 43 6 occurred in november and the lowest value of 5 7 occurred in may the moisture source in the winter season was dominated by high latitude oceans with low rh thus leading to high dx whereas the major moisture contribution for the summer season was the atlantic ocean in comparison the highest daytime mean value of the vapor dx at the luancheng site occurred in may 28 4 and the lowest value occurred in july 1 6 during the observation period april to august in situ observations at beijing at a distance of 270 km from luancheng indicate high dx values in the winter months wen et al 2008 so it is possible that wintertime dx at luancheng was also very high but no direct observations existed in the winter to verify this seasonal pattern 3 2 comparison with observations parameterization 1 reproduced the observed water vapor dx well for the mase site with a high correlation of r2 0 65 over the 12 months period the performance was especially good for the warm seasons the monsoon season fig 4 which implies that our trajectory model captured reasonably well the influence of large scale moisture advection on the water vapor dx variations in contrast to the mase site the model was less successful for luancheng the model prediction shows a weak correlation with the observations at the new haven site r2 0 17 although the simulated dx displays a clear seasonal cycle which is consistent with the observations for all sites the dx was underestimated with a mean bias index bi of 4 47 1 30 and 2 15 for mase luancheng and new haven respectively table 2 parameterization 1 it is noted that due to lack of contribution from oceanic sources only a few daytime values 21 days from the model with parameterization 1 are available for comparison with observations at the luancheng site the isogsm simulation failed to capture the dx variability at the inland site and was also systematically biased low for the marine and the coastal site the r2 values are 0 38 0 17 and 0 01 for mase luancheng and new haven respectively and are lower than those for our trajectory model fig 4 the bi rmsd values are 4 1 6 5 2 6 3 3 and 4 1 7 2 for mase luancheng and new haven respectively bias errors are common in modeling studies on vapor isotopic compositions so far no atmospheric models are able to reproduce the water vapor dx temporal variabilities at hourly to daily time scales over the land surface 3 3 sensitivity to oceanic evaporation parameterization as table 2 and fig 5 shows the r2 value does not vary by much between parameterization 1 and 2 for mase r2 0 65 while parameterization 3 gave less reliable results r2 0 33 of the three parameterizations parameterization 3 was least sensitive to rhsst it gave slightly higher rmsds 8 99 and 8 56 for mase and new haven respectively than the other two having the highest rh sensitivity parameterization 1 produced smaller rmsds 7 42 and 8 20 for mase and new haven respectively than the other two parameterization 3 improved bi for mase and luancheng in the warm season may to september compared to parameterization 1 but performed less well for the other season for new haven parameterization 3 had a positive bi we conclude that the uncertainties associated with ocean evaporation dx estimation can bias the simulation results but likely play only a minor role in the overall model performance 3 4 sensitivity to land evapotranspiration parameterization according to the experimental data the daytime dx was correlated with local rh at new haven slope 48 0 per r2 0 58 p 0 001 and mase slope 23 5 per r2 0 22 p 0 001 fig 6 a suggesting that land et contributions to the local atmospheric moisture were relatively high and that land surface et should be considered in the dx simulation the intercept and slope of the dx versus rh regression for new haven and mase seemed reasonable when rh approaches 1 the regression predicts a dx of 11 7 and 8 9 for mase and new haven respectively which are close to the dx of local precipitation implying that the vapor from et was constrained the equilibrium fractionation these slope values were lower than those reported for ocean evaporation consistent with previous studies showing that water vapor originated from land has higher dx values than that from the oceans angert et al 2008 delattre et al 2015 gat and matsui 1991 lai and ehleringer 2011 welp et al 2012 as a sensitivity analysis we parameterized the dx of land surface et using these two regressions as represented by parameterizations 4 and 5 in table 2 these two parameterizations did not improve the overall r2 and bias errors at mase and new haven while they seemed to have improved the rmsd table 2 previous studies have shown that dx may be enhanced by land surface evapotranspiration angert et al 2008 delattre et al 2015 gat and matsui 1991 lai and ehleringer 2011 welp et al 2012 consistent with this viewpoint our land surface et parameterization in parameterizations 4 and 5 resulted in higher dx than that of ocean evaporation in parameterizations 1 which may have contributed to the improved rmsd as an example fig 7 compared the r2 and rmsd values between parameterizations 1 and parameterizations 4 at the monthly time scale it is clear that for most of days parameterizations 4 improved the rmsd but worsened the r2 also see table 2 a further investigation of the correlation pattern obtained with parameterization 4 is given in fig 8 the strong negative relationship between r2 and land surface fractional contribution to the atmospheric moisture indicates that land surface contribution should be the first order factor affecting water vapor dx simulation in coastal and inland areas it also suggests that the simple rh dx relationship is not able to reproduce day to day variability of dx parameterization 6 which considers the et partitioning in land surface source dx estimation eq 6 it did not bring improvement over parameterizations 4 and 5 table 2 complete omission of land surface evapotranspiration as in parameterizations 1 3 however would make it almost impossible to predict dx at inland locations such as the luancheng site where ocean sources are only minor contributors to the local atmospheric moisture nevertheless the poor performance of parameterizations 1 6 for luancheng implies that additional processes must considered in the land surface evapotranspiration dx parameterization 4 discussion 4 1 uncertainties in ocean evaporation dx estimation in this study the major environmental control of the dx of ocean evaporation is the sst normalized relative humidity rhsst some observational and modeling studies have shown evidence that wind speed can influence the rhsst dx relationship the measurement over the subtropical eastern north atlantic ocean showed that dx over the ocean surface depends on both relative humidity and surface wind speed benetti et al 2014 by applying the closure assumption of merlivat and jouzel 1979 aemisegger and sjolte 2018 found very large spatial variations in the rhsst dx slope due to spatial variations in wind speed they showed that this slope becomes flat slope value varies between 0 1 and 0 3 1 for high wind speed areas although our results at least for the mase site are insensitive to the slope it is possible that water vapor originating from extremely high wind ocean regions may have distinctive dx signatures this conclusion is consistent with that from a new continuously measurement of both near surface vapour and ocean surface water from the north pole to antarctica during a period of two years bonne et al 2019 who suggested dx is controlled by rhsst only in addition sea ice may influence the rhsst dx slope at the neem site in greenland high dx is associated with air masses that originate near the sea ice margin steen larsen et al 2013 an isotope enabled model simulation shows that the dx of water vapor is strongly affected by the sea ice extent in antarctica area noone and simmonds 2004 when the humidity depleted cold polar air masses cross the sea ice margin the open water bodies the strong evaporation results in large kinetic effects leading to high observed d excess of water vapor steen larsen et al 2013 the sea ice impacts are negligible in the present study because few air mass trajectories passed the ice cover oceans but should be addressed in future studies if the study site is at more northern latitudes and closer to ice covered oceans 4 2 uncertainties in the parameterization of dx of land evapotranspiration despite inclusion of the land et effect on the vapor dx parameterizations 4 and 5 were not able to improve the simulations table 2 and fig 5 one potential reason is that the relationship between rh and the dx of land et used by these parameterizations were valid in the local domain of the observational site but were not valid elsewhere along the airmass trajectory a more general parameterization should express this relationship as a function of the trajectory timestep as 7 dx t a r h t dx s t a where a 0 is an empirical parameter which describes the maximum kinetic effect associated with evaporation and dxs is the dx of soil moisture parameterizations 1 3 imply that a is between 43 and 51 eq 7 satisfies two desired endmember properties first as rh approaches unity the kinetic effect vanishes and the dx of land et approaches dxs second as rh goes to zero eq 7 predicts that dx becomes to dxs a in regions where the spatial variability of dxs is negligible the relationship between dx and rh established from local measurements can be used to calculate the dx of land evapotranspiration generally speaking however a single dx rh relationship may not hold at all time steps of the trajectory calculation due to variable dxs in the case of luancheng the dx of soil moisture was highly variable in the source region where soil water in cropland in the summer growing season was a mixture of groundwater via irrigation and rainwater but soil water in the natural landscape comes only from rainwater in this region the groundwater has lower dx values mean 5 1 than precipitation mean 8 7 wei et al 2018b the high spatial variability in dx may explain the poor correlation between the observed vapor dx and rh at luancheng fig 6 an assumption implicit in eq 7 is that the land et is dominated by soil evaporation a further improvement to eq 7 inspired by eq 6 is to express the dx of land et as a composite signal of transpiration and evaporation as 8 d x t dx root t t t a r h t dx s t a e t et t where dx root is dx of soil moisture at the rooting depth since soil evaporation may play more important role than assumed by aemisegger et al 2014 it is essential to consider et partitioning et t e in the dx estimation an isotopic large eddy simulation study showed that even a small evaporation contribution to et can result in a large change of dx of the evapotranspiration isotopic composition wei et al 2018c a very high value of dx in the soil evaporation flux 75 was indeed used in computing the global e et based on catchment isotopic information jasechko et al 2013 in eq 8 the dx value of transpiration is the same as that of soil moisture in the root zone eq 8 was tested for mase where high frequency isotopic measurements of both water vapor and surface water were available we assumed that dx root and dxs are equal to the dx of the surface water the slope parameter a was 54 and the evaporation ratio was calculated with a modified two source shuttleworth and wallace et model wei et al 2018b the time period was between mary 20 and june 20 2014 during this period none of the parameterizations table 2 was able to reproduce the observed vapor dx variability fig 4 the variabilities of t et and rh on the daily time scale are shown in fig 9 water vapor dx generally depended on relative humidity source water dx and t et if by ignoring the contribution from ocean sources parameterization eq 8 significantly improved the dx simulated with the trajectory model the model now explains 71 of observed variations in the vapor dx r2 0 71 which is much better that the r2 of 0 22 using parameterization 4 fig 10 the success of this new parameterization eq 8 at mase has to do with the fact that the landscape upwind of the site was dominated by rice paddies and as such the dxs value could be taken as a constant more generally the application of eq 8 requires detailed characterization of dxs and e et fraction along the airmass trajectory such characterizations are not feasible from an observational point of view but may be viable through a combination of isotope enabled land surface modeling and atmospheric data assimilation 4 3 uncertainties from other sources parameterization 6 takes into account the different roles of transpiration and evaporation while parameterizations 4 and 5 do not however in addition to the drawbacks noted in the previous section parameterization 6 may be influenced by uncertainties in the e et estimation in the present study the e et data came from the noah land surface model imbedded in the global land data assimilation system version 2 according to noah on average 50 of land et is attributed to soil evaporation which is higher than the estimate 42 based on a recent study that combines data from multiple independent sources including satellite based estimations reanalysis land surface models and isotopic measurements wei et al 2017 one source of uncertainties in our calculation is lagrangian model itself our lagrangian scheme assumes that the atmospheric residence time of moisture or the mean residence time of moisture in the troposphere of 10 days trenberth 1998 van der ent and tuinenburg 2017 yoshimura et al 2004 although an airmass may travel longer than 10 days over a continental region before arriving at the measurement site such as luancheng we were not able to extend the trajectory time period due to the substantial uncertainties in identifying source region for longer range trajectories kahl 1996 rößler et al 2017 in our study the threshold value 0 05 g kg 1 of specific humidity was applied in the trajectory length calculation wang et al 2017 suggested a different threshold value 0 1 g kg 1 for trajectory modeling their threshold value was also tested for the mase site using parameterization 1 the results show that the simulated dx is not sensitive to the selection of the threshold value of specific humidity which is consistent with wang et al 2017 the model performance is almost the same using these two thresholds r2 0 64 0 65 and rmsd 7 64 7 42 with 0 1 0 05 g kg 1 specific humidity threshold sodemann et al 2008 assumed that the trajectory was terminated if the air parcel has moved out of the planetary boundary layer above the height of 850 hpa or 1500 m implementation of the boundary layer threshold did not improve model performance with a slightly lower r2 0 62 and almost same rmsd 7 45 compared to the original calculation without a boundary layer threshold by investigating individual events aemisegger et al 2014 suggested that air parcels above the boundary layer can actually obtain moisture directly from surface evaporation in our case the humidity and boundary layer thresholds had limited effect on the dx simulation a second source of uncertainty of the lagrangian model is that some physical processes may not be fully captured by the trajectory calculation such as vertical convection and turbulent diffusion the moisture content of an air parcel along a trajectory in the model world is also additionally altered by nonphysical factors such as numerical diffusion however these effects do not affect the source diagnostic strong enough to prevent the detection of physically reasonable correlations between the simulated and the measured isotopic compositions of water vapor pfahl and wernli 2008 that our trajectory model was able to reproduce the observed variability in specific humidity e g r2 0 93 for mase site wei et al 2016 implies that calculation of non isotopic processes is not a prominent source of uncertainty for the isotopic simulation a similar situation exists in the simulation with an isotope enabled global circulation model where the simulation shows very good agreement with observations for the specific humidity but not for dx of water vapor steen larsen et al 2017 wei et al 2016 to assess the potential errors caused by relative humidity we repeated the model calculation by replacing the rh from the gdas dataset with the rh from ncep reanalysis 2 parameterization 7 table 2 compared to parameterization 1 a slight improvement of bi was obtained while r2 for mase site and new haven site remained unchanged table 2 the improvement to bi was likely a result of lower rh in the ncep reanalysis 1 8 1 8 resolution with 6 hour interval than that in the gdas reanalysis 1 1 resolution with 3 hour interval a lower rh produces a higher dx of ocean evaporation thus increasing the simulated dx of evaporated water vapor a final note of caution is that our trajectory model omits raindrop re evaporation it is known that the dx of water vapor is not conserved in an air parcel undergoing raindrop re evaporation because the kinetic fractionation does not follow the 1 8 ratio for d and 18o in the extreme case where raindrops fall into completely dry air laboratory experiments suggest that the evaporated vapor should have a dx value of 50 to 130 higher than that of the raindrop in its initial state stewart 1975 in the real atmosphere the dx enhancement depends on the fraction of raindrop evaporation and the rh below the cloud layer lee et al 2009 here we hypothesize that the direct effect of raindrop evaporation on the vapor dx is restricted to the free atmosphere where rh is much lower than in the abl its effect on the abl dx is probably indirect occurring through the process of entrainment it remains poorly understood as to how entrainment mixes the vapor isotopes between the abl and the free atmosphere primarily because the dx of the free atmospheric vapor is not known empirical evidence strongly suggests that water vapor in the free atmosphere should have higher dx than water vapor in the land abl bailey et al 2013 galewsky and samuels crow 2014 he and smith 1999 most likely due to a larger role of raindrop evaporation in the free atmosphere on the other hand an evaporative model with a closure assumption and profiles of vapor dx observed over the subtropical eastern north atlantic ocean benetti et al 2014 and over corsica during the hymex sop1 campaign sodemann et al 2017 suggest that the vertical profile of water vapor dx is more homogeneous than previously observed 5 conclusions the trajectory model with parameterization 1 reproduced reasonably well the daily vapor dx observed at the marine site mase especially during ocean source dominated months the results support use of a simple linear relationship with relative humidity as a parameterization of the dx of water vapor evaporated from the ocean surface in contrast the model performed poorly at the continental site luancheng r2 0 2 the model prediction shows a weak correlation with the observations at the coastal site new haven site r2 0 17 although the modeled seasonal pattern was consistent with that of the observation on the monthly time scale the model performance became worse as the fraction of land contribution to the atmospheric water vapor increased the isogsm simulation failed to capture the dx variability at the continental site and was also systematically biased low for the marine and the coastal site incorporation of parameterizations for the dx of land evapotranspiration suggested by previous studies did not bring obvious improvement to the simulation of the water vapor dx for these sites the lack of improvement for luancheng is particularly noteworthy because over 90 the atmospheric moisture at this site came from interiors of north china we suggest that future improvement to the model requires us to overcome a fundamental challenge in isotopy hydrology that is the lack of understanding of the different fractionation processes of 18o and d associated with land evapotranspiration declaration of competing interest the authors declare no competing interests acknowledgements this work was supported by the u s national science foundation grant ags 1520684 all the data used in this study are available on request from the corresponding author the authors gratefully acknowledge the noaa air resources laboratory arl for the provision of the hysplit transport and dispersion model and or ready website http www arl noaa gov ready php used in this publication the water vapor deuterium excess data is available at http vapor isotope yale edu the code used in this paper is available at https github com zhongwangwei iso hysplit sst data is available at https www esrl noaa gov gldas noah land surface model l4 3 hourly 1 0 1 0 degree is available at https disc gsfc nasa gov datasets gldas noah10subp 3h v001 summary keywords gldas 
6194,this study explores the utility of observations of deuterium excess dx of water vapor for attribution of vapor to remote source regions and local influences a lagrangian back trajectory model was combined with various parameterizations of the dx of ocean evaporation and land evapotranspiration to simulate daily vapor dx at a continental site a marine site and a coastal site the model reproduced reasonably well the observed variabilities in the vapor dx at the coastal and the marine site when water vapor at these sites were primarily influenced by large scale advection from ocean sources the simple parameterization relating dx of the ocean evaporation to relative humidity is a robust representation of the ocean isotopic evaporation on the other hand the model did poorly for the continental site and during the land evapotranspiration dominated months at the coastal and the marine site confirming the published findings that the water vapor dx near the earth s surface can be significantly altered by land evapotranspiration and therefore is not a conserved tracer of humidity from the marine moisture source region several parameterizations for the dx of land evapotranspiration suggested by previous studies were tested with the trajectory model but none brought improvement to the simulation of the dx at the continental site our study emphasizes that a fundamental challenge in isotopy hydrology is the lack of understanding of the different fractionation processes of 18o and d associated with land evapotranspiration keywords deuterium excess moisture source back trajectory kinetic fractionation 1 introduction water vapor isotopes hdd and h2 18o in the atmospheric boundary layer have been widely used in tracing physical processes in hydrological and climatic studies aemisegger and sjolte 2018 galewsky et al 2016 gat 1996 good et al 2015 jasechko et al 2013 wright et al 2017 variations in the abundance of these isotopes expressed in delta notation as δd or δ18o result from equilibrium and kinetic fractionation associated with phase changes of water during land surface evapotranspiration sub cloud raindrop evaporation and in cloud condensation and from mixing during atmospheric convection boundary layer entrainment and airmass advection in these processes the vapor δd or δ18o is not conserved for example in the process of large scale airmass advection as the air mass dries out due to precipitation the remaining vapor becomes progressively depleted in d and 18o the rayleigh distillation model gat 2000 predicts a reduction of 100 for δd at a dryout ratio of 0 3 and a condensation temperature of 10 c according to the pseudo adiabatic rayleigh model noone 2012 smith 1992 δd will decrease by about 120 if 70 of the moisture rains out of the air parcel in its vertical accent during moist convection as a measure of the abundance of the d isotope relative to the 18o isotope deuterium excess of water vapor dx is formally defined as dx δd 8 δ18o here the factor 8 effectively removes the difference in equilibrium fractionation between d and 18o so dx is essentially controlled by kinetic fractionation merlivat and jouzel 1979 equilibrium fractionation results from the lower saturation vapor pressures of hdo and h2 18o than that of h2o and kinetic fractionation from the fact that hdo and h2 18o have lower diffusion efficiencies in unsaturated air than h2o unlike δd or δ18o whose time variations are overwhelmed by rayleigh distillation or rainout history of airmass advection dx of atmospheric vapor is nearly constant during the transport of an airmass the dx observed in the atmospheric boundary layer abl is sensitive to kinetic fractionation and can change if the water source region changes that is if the air is advected from a different region changes to dx at a fixed location can also occur if the air comes from the same source but the relative humidity rh and surface temperature at the source region changes simonin et al 2014 aemisegger et al 2014 since the dx is also slightly controlled by equilibrium fractionation temperature dependence the relative humidity is usually normalized by the saturation vapor pressure at the sea surface temperature for example a 20 reduction in rhsst at the ocean source increases the vapor dx by about 10 these changes are large but predictable pfahl and wernli 2008 uemura et al 2012 a reproducible relationship between the dx and relative humidity near the ocean surface has been observed across a wide range of locations aemisegger et al 2014 pfahl and sodemann 2014 pfahl and wernli 2008 steen larsen et al 2015 uemura et al 2008 although the impact of wind speed on the dx variation requires further clarification benetti et al 2014 lewis et al 2013 uemura et al 2012 given this relationship dx is considered a good tracer of sea surface evaporative conditions and has been widely used to document oceanic sources of moisture delattre et al 2015 jouzel et al 2013 lewis et al 2013 masson delmotte et al 2005 merlivat and jouzel 1979 yamanaka and shimizu 2007 however several studies have questioned whether the dx observed on land can be used as a conserved tracer of oceanic moisture sources aemisegger et al 2014 lai and ehleringer 2011 parkes et al 2017 simonin et al 2014 welp et al 2012 zhao et al 2014 a diurnal cycle of the dx near the land surface has been reported for a range of land surface types implying a role of land evapotranspiration in modifying dx at the sub day time scale berkelhammer et al 2013 simonin et al 2014 welp et al 2012 using dx measurements from six mid latitude sites welp et al 2012 showed that the dx near the ground surface can be significantly altered by local environmental conditions including abl height and local rh aemisegger et al 2014 found that the dx value is inversely related to the rh at the land vapor source currently isotope enabled global circulation models gcms can simulate dx over ocean surfaces reasonably well uemura et al 2008 but generally have difficulty reproducing the dx observed on land even for coastal and marine sites e g steen larsen et al 2017 wei et al 2016 one possible reason for the poor model performance is that these models do not account for the role of land surface evapotranspiration in controlling dx moreover dx of the near surface vapor may be influenced by raindrop evaporation and by abl entrainment the kinetic effect of raindrop evaporation which causes the vapor dx to increase is mostly limited to the free atmosphere entrainment itself does not alter the total number of vapor isotopic molecules in the air column but can change the near surface dx if the free atmospheric dx is different from the abl dx although the community traditionally assumes that dx is the same between these two air layers gat 2000 several observational studies indicate that dx in the free atmosphere is greater than that in the abl bailey et al 2013 galewsky and samuels crow 2014 he and smith 1999 in summary temporal variations in the abl dx observed at a fixed location on land represent a composite signal of multiple influences by remote moisture sources as well as processes in the local domain an outstanding challenge is how to best isolate the role of non local vapor sources and other local effects using the observed dx time series to elucidate the mechanisms underlying the observed dx patterns here we developed a process based lagrangian model for simulating dx at the hourly time resolution this model was then used 1 to quantify how much information on initial conditions of remote oceanic moisture sources can be inferred from the dx observed at land sites 2 to investigate the extent to which land evapotranspiration modifies the abl dx and 3 to determine if a suitable dx parameterization exists that can be used for land surface evapotranspiration 2 methods 2 1 study sites the dx data were obtained from three mid latitude sites including luancheng in northeast china mase in central japan and new haven in northeast us table 1 although vapor isotope data are available for more than 30 sites wei et al 2019 these three sites were selected for their special climatic conditions continental marine and coastal luanchang is located in a landscape dominated by dryland crops mainly wheat and corn and at a distance of 270 km from the yellow sea the mase site is located on tsukuba japan at a distance of 30 km from north pacific ocean new haven is an urban site situated at a distance of 2 6 km from the atlantic ocean detailed information on the local climates instrumentation and calibration protocols can be found in wen et al 2012 and xiao et al 2012 for luancheng wei et al 2016 for mase and welp et al 2012 for new haven the original data were reported at hourly intervals here we used daytime 8 00 18 00 mean dx a time period when the atmospheric boundary layer was well mixed 2 2 lagrangian vapor deuterium excess model the backbone of our lagrangian dx model is the trajectory model hysplit http ready arl noaa gov hysplit php version 4 0 adler et al 2003 draxler and hess 1997 stein et al 2015 and the backward trajectory diagnostic algorithm proposed by sodemann et al 2008 unlike sodemann et al 2008 and pfahl and wernli 2009 we do not use the diagnosed source regions to initialize an isotope model or to estimate dx from theoretical equations but instead determine dx of the moisture source from a simple linear function of relative humidity rh at the source with minor temperature and wind speed effects being ignored in our model dx is conserved during airmass advection except when new vapor is added to the airmass by surface evaporation removal of moisture by precipitation does not change the dx the effect of raindrop evaporation is also ignored each backward trajectory was calculated for up to 10 days the default forcing data was the gdas global data assimilation system data with 1 1 spatial resolution and 3 h time resolution we also forced the model with ncep reanalysis 2 with 1 75 1 75 spatial resolution and 6 h time resolution the trajectory release height was 500 m above the ground altogether about 6560 trajectories were calculated for 820 measurement days with a total measurement duration of about 20 000 hr specific humidity temperature and relative humidity of the air parcel at each trajectory time step were used to calculate the dx as explained below the change in the specific humidity q between the two successive time steps along the backward trajectory was computed as fig 1 crawford et al 2017 2013 pfahl and wernli 2008 sodemann et al 2008 wei et al 2018a 1 δ q t q x t q x t δ t where x t denotes the position of the air mass at time t and δ t is either 3 h gdas or 6 h ncep if δ q t g k g 1 is positive moisture is taken up by the air parcel as a result of surface evaporation if q is lower than 0 05 g k g 1 the trajectory is terminated the dx of the air parcel is updated if δ q is positive to account for the influence of surface evaporation using one of the seven parameterizations for the deuterium excess of evaporated vapor table 2 parameterizations 1 to 3 consider only the influence of oceanic evaporation and omit the influence of land evapotranspiration and parameterizations 4 to 6 include both effects in parameterizations 1 to 3 ocean evaporation is the only source of moisture for the air parcel and precipitation is the only sink and precipitation does not change dx along the trajectory fig 1 the change in dx between two successive trajectory time steps is given by 2 k t x k t 1 q t q t 1 x 1 k t 1 δ q t dx sst t 3 d x t k t q t where k g kg 1 is an intermediate variable x is a flag variable and dx sst is dx value of oceanic evaporation here x is equal to 1 for a grid marked as land surface meaning that the dx of the air parcel remains unchanged and is equal to 0 for a grid marked as ocean surface and δ q t 0 meaning that oceanic evaporation contributes to a change in dx eq 3 ensures isotopic mass balance by weighting specific humidity in each time step in parameterizations 4 to 6 eq 2 is modified to 4 k t x k t δ t q t q t δ t 1 x k t δ t δ q t dx sst t 1 l s f t δ q t dx ls t l s f t where x is equal to 1 for δ q t 0 g kg 1 and 0 for δ q t 0 g kg 1 the grid flag lsf determines whether the change in q is caused by oceanic evaporation or land evapotranspiration if lsf at time t is 0 eq 4 is reduced to eq 2 if δ q t 0 g k g 1 or the grid over which the parcel resides at time t is land eq 4 becomes k t k t δ t δ q t dx ls t where dxls is the dx value of land surface evapotranspiration experimental studies show that the relative humidity rhsst above the ocean surface in reference to the sea surface temperature sst c is highly anti correlated with the dx of atmospheric water vapor over wide ranges of geographic and evaporation conditions angert et al 2008 pfahl and wernli 2008 steen larsen et al 2015 2014 uemura et al 2008 a meta analysis of these studies yields a mean relationship between dx of oceanic evaporation and rhsst 5 dx sst 54 0 rh sst 48 2 pfahl and sodemann 2014 in this study eq 5 is the default parameterization of the dx of the vapor evaporated from a marine source parameterization 1 table 2 the slope of the dx sst versus rh sst relationship may depend on season measurement location and moisture transport path showing a variation in the range of 43 to 58 for the purpose of sensitivity analysis we have tested two more parameterizations for d x sst one with the most negative slope value dx sst 54 0 rh sst 51 0 provided by uemura et al 2008 parameterization 2 and the other with the least negative slope dx sst 42 6 rh sst 43 5 provided by steen larsen et al 2014 parameterization 3 table 2 in parameterizations 4 and 5 the dx of land evapotranspiration is calculated with regression equations deduced from the site measurements with local rh as the input variable section 3 4 parameterizations 6 are based on the study by aemisegger et al 2014 6 dx ls t e t e t t r h t 100 e t e t t where dx ls has the unit of e w m 2 is soil evaporation and et w m 2 is total evapotranspiration this equation is deduced from aemisegger et al 2014 s fig 12 the ratio e et is obtained from the gldas noah land surface model v2 noah lsm for parameterizations 6 with using rh from the gads reanalysis more detailed information can be found in section 4 2 2 3 isogsm simulation we also compared the observed dx and the dx results from our trajectory model with those produced by the isotope enabled global spectral model isogsm yoshimura et al 2008 isogsm simulates the water vapor dx with a horizontal resolution of 1 75 degrees in six hourly intervals the data at the lowest grid height 2 m above the ground surface are used for comparison by using a spectral nudging technique isogsm can reproduce reasonably well synoptic scale variabilities of δd and δ18o of the near surface water vapor in coastal areas wei et al 2016 a detailed description of the model configuration can be found in yoshimura et al 2008 2014 the grid cells used here are centered at 138 75 e and 35 283 n 114 375 e and 37 142 n and 73 125 e and 40 952 n corresponding to mase luancheng and new haven respectively 3 results 3 1 spatial and temporal variabilities of water vapor dx fig 2 is an example showing evolutions of q δq and dx during a trajectory segment with the end time of 12 00 jst on september 20 2013 and the end destination at mase for parameterizations 1 and 4 the specific humidity had a very low value at the start of the airmass transport about 1 5 g k g 1 from 96 hr to 78 hr from a land surface fig 2a black line it became higher when the airmass passed over the ocean surface 78 hr to 18 hr and then was slightly depleted after the airmass had reached the land of japan 18 hr to 0 hr the positive δq was found mainly over the ocean grid points suggesting that the moisture source was dominated by ocean evaporation fig 2a yellow line since there was no ocean source before 75 hr parameterizations 1 black line in fig 2b started at 75 hr while for parameterizations 4 it started at 96 hr compare to parameterization 1 parameterization 4 produced more variable dx because land surface evapotranspiration produced different dx from that of the ocean source fig 3 shows the variations in specific humidity left panels and dx right panels along back trajectories generated with parameterization 1 for the three sites in august 2013 mase august 2008 luancheng and august 2007 new haven the monthly contribution from land or ocean was calculated by the sum of moisture coming from that region and was weighted by the specific humidity at destination for each trajectory for all the sites the specific humidity was initially low at the start of the airmass transport and became higher if the airmass passed over the ocean area for most trajectories for the mase site 88 of the moisture came from the pacific ocean with a secondary contribution 10 from land in north china and mongolia fig 3a in contrast for the luancheng site fig 3c the dominant moisture came from interiors of north china 98 with only a minor contribution from the pacific ocean 2 for the new haven site the contribution of land sources was 67 and that of ocean sources was 33 the simulation results show that changes in moisture source region were a driver of the dx variability at mase water vapor originated from high latitude ocean surfaces generally had a lower dx 6 to 14 than that from low latitude ocean surfaces 12 to 22 fig 3b at new haven dx varied from 12 to 18 and 6 to 12 along the trajectories that originated from the north atlantic ocean and the arctic ocean respectively fig 3f at luancheng the modeled dx was slightly higher than at new haven ranging from 8 to 20 fig 3d our trajectory results show that temporal variations in dx at mase were closely related to changes in moisture source the observed dx displayed a clear seasonal cycle with the highest daytime mean in january 31 9 and the lowest daytime mean in july 1 7 table 1 fig 4 the back trajectory analysis shows that the winter high dx was associated with high contributions to the local moisture from the japan sea where low rh caused strong kinetic effects and high evaporation rates in contrast the warm season low dx was associated with moisture originated from the low latitude pacific ocean under conditions of high rh this dichotomy of source region and dx between seasons suggests that the dx measured in marine climate may be a good tracer of moisture source the dx measured in new haven had a similar seasonal pattern as mase showing lower values in the warm season than in the cold season the highest daytime mean value of 43 6 occurred in november and the lowest value of 5 7 occurred in may the moisture source in the winter season was dominated by high latitude oceans with low rh thus leading to high dx whereas the major moisture contribution for the summer season was the atlantic ocean in comparison the highest daytime mean value of the vapor dx at the luancheng site occurred in may 28 4 and the lowest value occurred in july 1 6 during the observation period april to august in situ observations at beijing at a distance of 270 km from luancheng indicate high dx values in the winter months wen et al 2008 so it is possible that wintertime dx at luancheng was also very high but no direct observations existed in the winter to verify this seasonal pattern 3 2 comparison with observations parameterization 1 reproduced the observed water vapor dx well for the mase site with a high correlation of r2 0 65 over the 12 months period the performance was especially good for the warm seasons the monsoon season fig 4 which implies that our trajectory model captured reasonably well the influence of large scale moisture advection on the water vapor dx variations in contrast to the mase site the model was less successful for luancheng the model prediction shows a weak correlation with the observations at the new haven site r2 0 17 although the simulated dx displays a clear seasonal cycle which is consistent with the observations for all sites the dx was underestimated with a mean bias index bi of 4 47 1 30 and 2 15 for mase luancheng and new haven respectively table 2 parameterization 1 it is noted that due to lack of contribution from oceanic sources only a few daytime values 21 days from the model with parameterization 1 are available for comparison with observations at the luancheng site the isogsm simulation failed to capture the dx variability at the inland site and was also systematically biased low for the marine and the coastal site the r2 values are 0 38 0 17 and 0 01 for mase luancheng and new haven respectively and are lower than those for our trajectory model fig 4 the bi rmsd values are 4 1 6 5 2 6 3 3 and 4 1 7 2 for mase luancheng and new haven respectively bias errors are common in modeling studies on vapor isotopic compositions so far no atmospheric models are able to reproduce the water vapor dx temporal variabilities at hourly to daily time scales over the land surface 3 3 sensitivity to oceanic evaporation parameterization as table 2 and fig 5 shows the r2 value does not vary by much between parameterization 1 and 2 for mase r2 0 65 while parameterization 3 gave less reliable results r2 0 33 of the three parameterizations parameterization 3 was least sensitive to rhsst it gave slightly higher rmsds 8 99 and 8 56 for mase and new haven respectively than the other two having the highest rh sensitivity parameterization 1 produced smaller rmsds 7 42 and 8 20 for mase and new haven respectively than the other two parameterization 3 improved bi for mase and luancheng in the warm season may to september compared to parameterization 1 but performed less well for the other season for new haven parameterization 3 had a positive bi we conclude that the uncertainties associated with ocean evaporation dx estimation can bias the simulation results but likely play only a minor role in the overall model performance 3 4 sensitivity to land evapotranspiration parameterization according to the experimental data the daytime dx was correlated with local rh at new haven slope 48 0 per r2 0 58 p 0 001 and mase slope 23 5 per r2 0 22 p 0 001 fig 6 a suggesting that land et contributions to the local atmospheric moisture were relatively high and that land surface et should be considered in the dx simulation the intercept and slope of the dx versus rh regression for new haven and mase seemed reasonable when rh approaches 1 the regression predicts a dx of 11 7 and 8 9 for mase and new haven respectively which are close to the dx of local precipitation implying that the vapor from et was constrained the equilibrium fractionation these slope values were lower than those reported for ocean evaporation consistent with previous studies showing that water vapor originated from land has higher dx values than that from the oceans angert et al 2008 delattre et al 2015 gat and matsui 1991 lai and ehleringer 2011 welp et al 2012 as a sensitivity analysis we parameterized the dx of land surface et using these two regressions as represented by parameterizations 4 and 5 in table 2 these two parameterizations did not improve the overall r2 and bias errors at mase and new haven while they seemed to have improved the rmsd table 2 previous studies have shown that dx may be enhanced by land surface evapotranspiration angert et al 2008 delattre et al 2015 gat and matsui 1991 lai and ehleringer 2011 welp et al 2012 consistent with this viewpoint our land surface et parameterization in parameterizations 4 and 5 resulted in higher dx than that of ocean evaporation in parameterizations 1 which may have contributed to the improved rmsd as an example fig 7 compared the r2 and rmsd values between parameterizations 1 and parameterizations 4 at the monthly time scale it is clear that for most of days parameterizations 4 improved the rmsd but worsened the r2 also see table 2 a further investigation of the correlation pattern obtained with parameterization 4 is given in fig 8 the strong negative relationship between r2 and land surface fractional contribution to the atmospheric moisture indicates that land surface contribution should be the first order factor affecting water vapor dx simulation in coastal and inland areas it also suggests that the simple rh dx relationship is not able to reproduce day to day variability of dx parameterization 6 which considers the et partitioning in land surface source dx estimation eq 6 it did not bring improvement over parameterizations 4 and 5 table 2 complete omission of land surface evapotranspiration as in parameterizations 1 3 however would make it almost impossible to predict dx at inland locations such as the luancheng site where ocean sources are only minor contributors to the local atmospheric moisture nevertheless the poor performance of parameterizations 1 6 for luancheng implies that additional processes must considered in the land surface evapotranspiration dx parameterization 4 discussion 4 1 uncertainties in ocean evaporation dx estimation in this study the major environmental control of the dx of ocean evaporation is the sst normalized relative humidity rhsst some observational and modeling studies have shown evidence that wind speed can influence the rhsst dx relationship the measurement over the subtropical eastern north atlantic ocean showed that dx over the ocean surface depends on both relative humidity and surface wind speed benetti et al 2014 by applying the closure assumption of merlivat and jouzel 1979 aemisegger and sjolte 2018 found very large spatial variations in the rhsst dx slope due to spatial variations in wind speed they showed that this slope becomes flat slope value varies between 0 1 and 0 3 1 for high wind speed areas although our results at least for the mase site are insensitive to the slope it is possible that water vapor originating from extremely high wind ocean regions may have distinctive dx signatures this conclusion is consistent with that from a new continuously measurement of both near surface vapour and ocean surface water from the north pole to antarctica during a period of two years bonne et al 2019 who suggested dx is controlled by rhsst only in addition sea ice may influence the rhsst dx slope at the neem site in greenland high dx is associated with air masses that originate near the sea ice margin steen larsen et al 2013 an isotope enabled model simulation shows that the dx of water vapor is strongly affected by the sea ice extent in antarctica area noone and simmonds 2004 when the humidity depleted cold polar air masses cross the sea ice margin the open water bodies the strong evaporation results in large kinetic effects leading to high observed d excess of water vapor steen larsen et al 2013 the sea ice impacts are negligible in the present study because few air mass trajectories passed the ice cover oceans but should be addressed in future studies if the study site is at more northern latitudes and closer to ice covered oceans 4 2 uncertainties in the parameterization of dx of land evapotranspiration despite inclusion of the land et effect on the vapor dx parameterizations 4 and 5 were not able to improve the simulations table 2 and fig 5 one potential reason is that the relationship between rh and the dx of land et used by these parameterizations were valid in the local domain of the observational site but were not valid elsewhere along the airmass trajectory a more general parameterization should express this relationship as a function of the trajectory timestep as 7 dx t a r h t dx s t a where a 0 is an empirical parameter which describes the maximum kinetic effect associated with evaporation and dxs is the dx of soil moisture parameterizations 1 3 imply that a is between 43 and 51 eq 7 satisfies two desired endmember properties first as rh approaches unity the kinetic effect vanishes and the dx of land et approaches dxs second as rh goes to zero eq 7 predicts that dx becomes to dxs a in regions where the spatial variability of dxs is negligible the relationship between dx and rh established from local measurements can be used to calculate the dx of land evapotranspiration generally speaking however a single dx rh relationship may not hold at all time steps of the trajectory calculation due to variable dxs in the case of luancheng the dx of soil moisture was highly variable in the source region where soil water in cropland in the summer growing season was a mixture of groundwater via irrigation and rainwater but soil water in the natural landscape comes only from rainwater in this region the groundwater has lower dx values mean 5 1 than precipitation mean 8 7 wei et al 2018b the high spatial variability in dx may explain the poor correlation between the observed vapor dx and rh at luancheng fig 6 an assumption implicit in eq 7 is that the land et is dominated by soil evaporation a further improvement to eq 7 inspired by eq 6 is to express the dx of land et as a composite signal of transpiration and evaporation as 8 d x t dx root t t t a r h t dx s t a e t et t where dx root is dx of soil moisture at the rooting depth since soil evaporation may play more important role than assumed by aemisegger et al 2014 it is essential to consider et partitioning et t e in the dx estimation an isotopic large eddy simulation study showed that even a small evaporation contribution to et can result in a large change of dx of the evapotranspiration isotopic composition wei et al 2018c a very high value of dx in the soil evaporation flux 75 was indeed used in computing the global e et based on catchment isotopic information jasechko et al 2013 in eq 8 the dx value of transpiration is the same as that of soil moisture in the root zone eq 8 was tested for mase where high frequency isotopic measurements of both water vapor and surface water were available we assumed that dx root and dxs are equal to the dx of the surface water the slope parameter a was 54 and the evaporation ratio was calculated with a modified two source shuttleworth and wallace et model wei et al 2018b the time period was between mary 20 and june 20 2014 during this period none of the parameterizations table 2 was able to reproduce the observed vapor dx variability fig 4 the variabilities of t et and rh on the daily time scale are shown in fig 9 water vapor dx generally depended on relative humidity source water dx and t et if by ignoring the contribution from ocean sources parameterization eq 8 significantly improved the dx simulated with the trajectory model the model now explains 71 of observed variations in the vapor dx r2 0 71 which is much better that the r2 of 0 22 using parameterization 4 fig 10 the success of this new parameterization eq 8 at mase has to do with the fact that the landscape upwind of the site was dominated by rice paddies and as such the dxs value could be taken as a constant more generally the application of eq 8 requires detailed characterization of dxs and e et fraction along the airmass trajectory such characterizations are not feasible from an observational point of view but may be viable through a combination of isotope enabled land surface modeling and atmospheric data assimilation 4 3 uncertainties from other sources parameterization 6 takes into account the different roles of transpiration and evaporation while parameterizations 4 and 5 do not however in addition to the drawbacks noted in the previous section parameterization 6 may be influenced by uncertainties in the e et estimation in the present study the e et data came from the noah land surface model imbedded in the global land data assimilation system version 2 according to noah on average 50 of land et is attributed to soil evaporation which is higher than the estimate 42 based on a recent study that combines data from multiple independent sources including satellite based estimations reanalysis land surface models and isotopic measurements wei et al 2017 one source of uncertainties in our calculation is lagrangian model itself our lagrangian scheme assumes that the atmospheric residence time of moisture or the mean residence time of moisture in the troposphere of 10 days trenberth 1998 van der ent and tuinenburg 2017 yoshimura et al 2004 although an airmass may travel longer than 10 days over a continental region before arriving at the measurement site such as luancheng we were not able to extend the trajectory time period due to the substantial uncertainties in identifying source region for longer range trajectories kahl 1996 rößler et al 2017 in our study the threshold value 0 05 g kg 1 of specific humidity was applied in the trajectory length calculation wang et al 2017 suggested a different threshold value 0 1 g kg 1 for trajectory modeling their threshold value was also tested for the mase site using parameterization 1 the results show that the simulated dx is not sensitive to the selection of the threshold value of specific humidity which is consistent with wang et al 2017 the model performance is almost the same using these two thresholds r2 0 64 0 65 and rmsd 7 64 7 42 with 0 1 0 05 g kg 1 specific humidity threshold sodemann et al 2008 assumed that the trajectory was terminated if the air parcel has moved out of the planetary boundary layer above the height of 850 hpa or 1500 m implementation of the boundary layer threshold did not improve model performance with a slightly lower r2 0 62 and almost same rmsd 7 45 compared to the original calculation without a boundary layer threshold by investigating individual events aemisegger et al 2014 suggested that air parcels above the boundary layer can actually obtain moisture directly from surface evaporation in our case the humidity and boundary layer thresholds had limited effect on the dx simulation a second source of uncertainty of the lagrangian model is that some physical processes may not be fully captured by the trajectory calculation such as vertical convection and turbulent diffusion the moisture content of an air parcel along a trajectory in the model world is also additionally altered by nonphysical factors such as numerical diffusion however these effects do not affect the source diagnostic strong enough to prevent the detection of physically reasonable correlations between the simulated and the measured isotopic compositions of water vapor pfahl and wernli 2008 that our trajectory model was able to reproduce the observed variability in specific humidity e g r2 0 93 for mase site wei et al 2016 implies that calculation of non isotopic processes is not a prominent source of uncertainty for the isotopic simulation a similar situation exists in the simulation with an isotope enabled global circulation model where the simulation shows very good agreement with observations for the specific humidity but not for dx of water vapor steen larsen et al 2017 wei et al 2016 to assess the potential errors caused by relative humidity we repeated the model calculation by replacing the rh from the gdas dataset with the rh from ncep reanalysis 2 parameterization 7 table 2 compared to parameterization 1 a slight improvement of bi was obtained while r2 for mase site and new haven site remained unchanged table 2 the improvement to bi was likely a result of lower rh in the ncep reanalysis 1 8 1 8 resolution with 6 hour interval than that in the gdas reanalysis 1 1 resolution with 3 hour interval a lower rh produces a higher dx of ocean evaporation thus increasing the simulated dx of evaporated water vapor a final note of caution is that our trajectory model omits raindrop re evaporation it is known that the dx of water vapor is not conserved in an air parcel undergoing raindrop re evaporation because the kinetic fractionation does not follow the 1 8 ratio for d and 18o in the extreme case where raindrops fall into completely dry air laboratory experiments suggest that the evaporated vapor should have a dx value of 50 to 130 higher than that of the raindrop in its initial state stewart 1975 in the real atmosphere the dx enhancement depends on the fraction of raindrop evaporation and the rh below the cloud layer lee et al 2009 here we hypothesize that the direct effect of raindrop evaporation on the vapor dx is restricted to the free atmosphere where rh is much lower than in the abl its effect on the abl dx is probably indirect occurring through the process of entrainment it remains poorly understood as to how entrainment mixes the vapor isotopes between the abl and the free atmosphere primarily because the dx of the free atmospheric vapor is not known empirical evidence strongly suggests that water vapor in the free atmosphere should have higher dx than water vapor in the land abl bailey et al 2013 galewsky and samuels crow 2014 he and smith 1999 most likely due to a larger role of raindrop evaporation in the free atmosphere on the other hand an evaporative model with a closure assumption and profiles of vapor dx observed over the subtropical eastern north atlantic ocean benetti et al 2014 and over corsica during the hymex sop1 campaign sodemann et al 2017 suggest that the vertical profile of water vapor dx is more homogeneous than previously observed 5 conclusions the trajectory model with parameterization 1 reproduced reasonably well the daily vapor dx observed at the marine site mase especially during ocean source dominated months the results support use of a simple linear relationship with relative humidity as a parameterization of the dx of water vapor evaporated from the ocean surface in contrast the model performed poorly at the continental site luancheng r2 0 2 the model prediction shows a weak correlation with the observations at the coastal site new haven site r2 0 17 although the modeled seasonal pattern was consistent with that of the observation on the monthly time scale the model performance became worse as the fraction of land contribution to the atmospheric water vapor increased the isogsm simulation failed to capture the dx variability at the continental site and was also systematically biased low for the marine and the coastal site incorporation of parameterizations for the dx of land evapotranspiration suggested by previous studies did not bring obvious improvement to the simulation of the water vapor dx for these sites the lack of improvement for luancheng is particularly noteworthy because over 90 the atmospheric moisture at this site came from interiors of north china we suggest that future improvement to the model requires us to overcome a fundamental challenge in isotopy hydrology that is the lack of understanding of the different fractionation processes of 18o and d associated with land evapotranspiration declaration of competing interest the authors declare no competing interests acknowledgements this work was supported by the u s national science foundation grant ags 1520684 all the data used in this study are available on request from the corresponding author the authors gratefully acknowledge the noaa air resources laboratory arl for the provision of the hysplit transport and dispersion model and or ready website http www arl noaa gov ready php used in this publication the water vapor deuterium excess data is available at http vapor isotope yale edu the code used in this paper is available at https github com zhongwangwei iso hysplit sst data is available at https www esrl noaa gov gldas noah land surface model l4 3 hourly 1 0 1 0 degree is available at https disc gsfc nasa gov datasets gldas noah10subp 3h v001 summary keywords gldas 
