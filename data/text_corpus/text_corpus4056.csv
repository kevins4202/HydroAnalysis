index,text
20280,an efficient unsteady turbulent wind model is developed to simulate the wind field of tropical cyclones for wind turbines the method first establishes frequency domain wind fields which are then changed to time domain wind fields using the inverse fast fourier transfer finally interpolation is used to determine the full field unsteady turbulent wind speed the openmp scheme for parallel computing and the skyline method for efficient matrix decomposition sped up 34 times faster than that without these schemes using an eight core computer then offshore wind turbine owt support structure analyses and designs under international electrotechnical commission iec 61400 3 and realistic tropical cyclone loads were performed for three cases the results indicate that iec 61400 3 design load cases dlcs 2 2 6 1 and 7 1 control the steel design for the case without tropical cyclone loads but with such loads iec 61400 3 dlc i 2 dominates almost all the steel designs which was attributed to yaw misalignment however actual tropical cyclones may cause worse conditions especially for the yaw always on the x axis nevertheless this actual tropical cyclone condition does not excessively increase the weight of the steel design so iec 61400 3 dlcs i 1 and i 2 are sufficient to ensure the safety of the owt steel design keywords offshore wind turbine tropical cyclones yaw operative condition finite element analysis openmp parallel computation soil structure interaction significant wave height turbulence 1 introduction wind power is one of the best renewable energy sources while in some pacific and atlantic regions tropical cyclones are a great threat to wind turbine structures therefore a suitable simulation model of tropical cyclones for wind turbines is highly necessary but is rare in both the literature and practical world to design offshore wind turbine owt systems time history finite element analyses under combinations of wind and wave loads are necessary usually a full field numerical turbulent wind profile such as that generated by turbsim 2014 is necessary to determine the wind loads applied to turbines and support structures while a full field turbulent wind profile is often generated from the frequency domain veers 1988 however for the wind loads from tropical cyclones the average wind speed and direction are changed such as design load case dlc 11 2 mentioned in the germanischer lloyd tropical cyclone technical note gl tctn gl 2013 so a wind profile generated from the frequency domain should be modified there are a lot of models that can be used to create tropical cyclone average wind fields such as the models generated by jelesnianski 1996 holland 1980 mann 1998 willoughby at al 2005 li et al 2013 and pandey and rao 2018 but not many studies directly produce a turbulence model for the purpose of owt analyses liu et al 2011 analyzed the characteristics of the extreme wind load parameters for owts under typhoon conditions and they gave four suggestions for the iec code zhang 2014 simulated a typhoon wind field based on the classical autoregressive model and a regional power spectrum density model and indicated that tower buckling is the major structural failure mode due to typhoons yang et al 2014 discussed the characteristics of aerodynamic loads acting on a wind turbine due to gusts during a typhoon and the unsteady wind conditions during a typhoon were modeled by the gust model han et al 2014 presents the external wind conditions for the design and assessment of wind turbine loading in tropical cyclone regions including physical constants wind speed wind shear turbulence intensity turbulence length scale and turbulence spectral models kim and manuel 2016 developed a hurricane intensity evolution model based on thermodynamic and atmospheric environmental variables where a turbulent wind field can be simulated at a location of interest along the hurricane track worsnop at al 2017 used large eddy simulations to produce wind profiles of an idealized hurricane and they found that a simple model such as the kaimal spectrum for turbulence deviators and the power low for the vertical wind speed distribution can accurately simulate the properties of hurricane isabel in 2003 wei et al 2017 established holland s model for hurricane induced wind speed and combined with hurricane induced wave height and direction to simulate a 5 mw owt supported structure amirinia and jung 2017 investigated the effects of hurricane turbulence models on owts by considering unsteady aerodynamic forces on the tower and wind wave soil structure interaction where a formulation for addressing unsteady wind forces on the tower was introduced liu et al 2018 used a series of simulations to provide the artificial typhoon wind fields for the evaluation of iec code recommendations based on the simulated typhoon wind fields an empirical correction ratio and a scale factor were developed to adjust the classical power law model han et al 2019 investigated a scheme for computing wind turbine responses under typhoon where the inverse fourier transform was used to build the turbulent wind field of typhoons fu et al 2020 proposed a multi spring beam column model for monopile analyses with consideration of several typical soil conditions under harsh environmental loading compared with the current design practice i e the american petroleum institute api p y curves the model represents a significant improvement for the monopile design a number of researches performed the structural analysis of owt support structures under tropical cyclones wang et al 2015 developed a method based on artificial intelligence optimization algorithms to analyze samples of extreme wind speeds and mentioned that when the typhoon hits it often leads to wind direction mutation strong turbulence thunderstorms and storm surges which pose a great threat to owts lian et al 2016 studied the owt wind load characteristics under typhoons using the computational fluid dynamics where two factors of wind turbines were investigated including different wind rotor parking positions and wind direction variation tsai et al 2016 observed the wind speed and turbulence intensity profile by doppler lidar for typhoon matmo it was found that types of wind speed profiles were in agreement with the log profile for the full range of the observation dai et al 2017 performed nonlinear time history analyses to study the wind induced failure of a 1 5 mw wind turbine under the cyclone boundary layer flow and they indicated that the plastic hinge locations of the failure tower are consistent with those reported from field investigations yin et al 2017 studied the effects of blade pitch and rotor yaw and wind wave misalignment in a 100 year return hurricane on a 13 2 mw owt the results showed that effects of blade pitch and rotor yaw on turbine structural dynamics are significant whereas the effect of wind wave misalignment is small ma et al 2017 studied the typhoon effect on the aerodynamic performance of the 5 mw floating owt they found that the typhoon event can result in large extreme responses of the rotor thrust and the generated power due to a possible blade pitch angle error phenomenon ju et al 2019b used ultimate load analyses to perform the optimum design for jacket type owt support structures and the steel design was always controlled under the condition of the yaw misalignment according to gl tctn gl 2013 liu et al 2019 introduced a set of modeling methods to predict the failure probability of owts in the china coastal waters the results indicated that the loads and the failure probability do not occur in a simple linear relationship with extreme wind speeds and waves chen et al 2015 conducted a fault investigation on a wind farm located on the southeast coast of mainland china a procedure was proposed to study structural failure by calculating extreme wind loads and reconstructing the structural model of composite blades and steel towers it was found that both extreme winds and the stop positions of wind turbines were critical to turbine failure due to the change of wind direction during typhoon impact hand et al 2021 investigated the structural analysis of the vertical axis wind turbine blade structure subject to extreme wind load cases using the analytical and finite element models the results show that the composite material blade can resist the induced flap wise load and the material strain is contained within its allowable range in order to analyze and design an owt support structure under tropical cyclone conditions time history finite element analyses should be carried out for a long period of time such as over 3 h but this type of analysis is rare in the literature the main difficulty is that the generation of an unsteady turbulent wind field requires a lot of computer time and memory thus in this study an efficient unsteady turbulent model for tropical cyclones is developed and used to perform the analysis and design of the proposed owt support structure 2 numerical procedures used to obtain a turbulent wind field for tropical cyclones 2 1 turbulent wind fields in the time domain for a turbulent wind field with a constant average wind speed the frequency domain wind field can be first established and the inverse fast fourier transfer fft can then be used to obtain the time domain wind field veers 1988 if the average wind speed of tropical cyclones is not constant one can use an interpolation scheme to overcome this difficulty herein the accuracy and efficiency of this proposed method will be discussed the procedures to generate a turbulent wind field are presented as follows 1 first the time points t i i 1 n are selected where t 1 0 and t n the total required time the average wind speeds v ave of these time points will be used to obtain the wind field for the interpolation of other time steps the computer time and the interpolation accuracy are dependent on the number of used time points n and we will be discussed 2 the frequency increment δf and the number of frequencies n f required in the fft are determined using the total time t n and the time step length δt where n f must be 2 m in which m is a positive integer so that 2n f δt is just larger than or equal to t n and 1 δf 1 2n f δt 3 the locations inside a rectangular plane that covers the wind turbine system are defined to find the wind field where the hub vertical coordinate z axis from the sea surface z hub and the rotor diameter are used to set the rectangular plane and n y and n z are the number of calculated wind speed locations in the y and z axes thus there are n y n z space locations for wind speed fields 4 the standard deviation of the wind speed at the hub height should be defined this is not mentioned in iec 61400 1 2019a or 3 1 2019 so we used the definition in the gl tctn gl 2013 the turbulence intensity i z at the hub height was calculated according to world meteorological organization wmo 2010 2 i z hub 1 ln z hub z 0 where z 0 is the surface roughness the standard deviation at the hub height is calculated using the following equation 3 σ1 i z hub vref z hub where v ref z hub is the reference wind speed at the hub height of the current location 5 the basic parameters of the spectrum and coherence equations are set to obtain the symmetric power spectral density psd matrix s j k f m 4 s j k f m δ f 2 c o h j k f m δ r j k u j k s j j f m s k k f m where j and k are the index of wind speed locations so there are n y n z space locations for indexes j and k s j j f m is a n y n z by n y n z spectrum matrix such as the iec kaimal model iec 61400 1 2019a f m mδf m 2 to n f is the current frequency δ r j k refers to the distance between location points j and k u j k refers to a velocity relationship between the two points and c o h j k f m δ r j k u j k is the coherence function between the two points it should be noted that s j k f 1 0 for the fft procedure to obtain the real value time domain wind field 6 find the lower and upper triangular matrix h f m for s j k f m 5 s j k f m h f m h f m t where h f m is the lower triangular matrix and cholesky s method can be used to solve equation 3 this step will use the most computer time since it must be calculated at each frequency f m m 2 to n f in this study we use a skyline solution method ju 2014 to increase the computational efficiency 7 the turbulent wind speed field v j f m m 2 n f of the frequency domain is obtained as below 6 v j f m k 1 j h j k f m x k k f m k 1 j h j k f m e i θ k m where θ k m is a random angle between 0 to 2πfor each direction location point and frequency so the number of these different random angles is 3n y n z n f it should be noted that v j f m is complex due to the complex value of i 1 8 use the inverse fft to obtain the time domain turbulent wind field when v j f m m 2 n f of all the frequencies are determined and an symmetric procedure is required to obtain the time domain real value turbulent wind field as follows 7 let v j f 1 v j f n f 1 0 and v j f 2 n f 2 m v j f m for m 2 to n f the inverse fft used to equation 4 then obtains the time domain turbulent wind field at point j 8 v j t f f t 1 v j f v j f e i 2 π f t d f where t from 0 to 2n f δ t contains 2n f steps 10 the linear interpolation is used to find the turbulent wind speed field between time t i and t i 1 add the average wind speed field and rotate them to the global directions since the average wind speed at each selected time t i i 1 n is used to determine the field of the turbulent wind speed we employed the linear interpolation to find that between the selected time points as follows 9 v j t t i 1 t t i 1 t i v j t v a v e a t t i t t i t i 1 t i v j t v a v e a t t i 1 v j a v e t where v j t is between t i and t i 1 in the local directions and v j a v e t is the average wind speed at location j and time t which will be discussed in the next section the coordinate transfer scheme is used to find the global wind speed field where only the wind speed fields in the local y and z directions are required to be rotated to the global y and z directions and the local and global z directions coincide 2 2 parallel and efficient computation equation 3 produces an n y n z by n y n z full matrix for each frequency f m if s j j f m or c o h j k are dependent on the space since the kaimal spectrum does not vary with space if this type of spectrum is used the matrix shape is only relative to coh jk although one may set the coh jk in the y and z directions independent of the space such as that used by turbsim the coh jk in the x direction varying with space is still a full matrix which will result in the need for extensive computer time to establish and decompose it for each f m where m ranges from 1 to n f to overcome this numerical difficulty we set the off diagonal terms of matrix s j k to be zero using the following equation 10 i f s j k f m s 11 f 2 e p s s e t s j k f m 0 where s 11 f 2 is the second diagonal terms at the second frequency we use it as a reference value for other off diagonal terms s j k f m and eps is an accuracy tolerance usually ranging between 1e 1 to 1e 4 thus matrix s j k f m is a variable band or skyline shape ju 2014 which can be established and decomposed much faster than a full matrix the accuracy and efficiency of this proposed scheme will be discussed in the example section openmp containing many parallel computation directives is an application program interface for adopting shared memory parallelism in c c or fortran in this paper we simply use the most effective one omp do which causes the do loop that follows it to execute in parallel equations 1 3 can be fully parallel for each frequency f m and the inverse fft procedure can be fully parallel for each location n y n z locations thus the parallel is easily performed using the efficient omp do directive since the frequency and location loops are at the most outer loops the parallel efficiency should be high table 1 shows the programming using fortran with openmp for the above parallel procedures where only the commands with the italic type need to be added 3 numerical model of the average wind speed field for tropical cyclones from equations 1 7 the turbulent wind speed field of a tropical cyclone requires a model that includes the average wind speed and direction as a function of time it is difficult to obtain accurate models for long term predictions and further a numerical simulation over a considerably long time is not necessary because the wind speed is not significant and will not cause a critical condition when the owt is far from the tropical cyclone thus we only focus on the numerical model of the tropical cyclone close to the owt and the following assumptions are made in the proposed model 1 the tropical cyclone is a symmetric circular shape 2 the eye wall average wind speed and radius are not changed during the analysis and 3 the path of the tropical cyclone is a straight line when it passes the owt these three assumptions are acceptable for studying owt behavior when tropical cyclones approach it fig 1 shows the proposed tropical cyclone model where the owt is at the origin and its orientation can be set appropriately the tropical cyclone with an eye wall radius of r t is initially located at coordinates x 0 and y 0 with a speed of v t moving along the negative y axis while the maximum average wind speed located at the eye wall is v max during the passage of a tropical cyclone the owt can be either inside or outside the eye wall where whether the tropical cyclone is clockwise or counterclockwise depends on the input the wind velocity is a function of the atmospheric pressure haltiner and martin 1957 a number of studies pandey and rao 2018 jelesnianski 1965 ueno 1981 used or modified the following wind profile for a symmetric tropical cyclone 11 v v m a x 2 r t r r t 2 r 2 where r is the distance between the tropical cyclone eye and the owt as shown in fig 1 pandey and rao 2018 fitted the above equation for various tropical cyclones and modified it as the following equations 12 v v m a x 2 r t r r t 2 r 2 f o r r r t a n d v v m a x 2 r t r r t 2 r 2 0 7 f o r r r t for the flexible use of the above equation we modify equation 9 as follows 13 v r v m a x 2 r t r r t 2 r 2 β f o r r r t a n d v r v m a x 2 r t r r t 2 r 2 γ f o r r r t where β and γ are constants from input and equation 13 is the same as equation 12 for β 1 and γ 0 7 and the same as equation 11 for β γ 1 this study used equation 13 in the analysis due to its uncomplicated characteristics and it was within acceptable levels of accuracy other models such as those of holland 1980 or willoughby at al 2005 can directly take place of equation 13 for the vertical distribution of the average wind speed for tropical cyclones since the maximum vertical distance is not more than 250 m used in owt problems the following power law is still accurate enough 14 v r z v r z h u b z z h u b α where z and z hub are the vertical distances from the sea surface for the calculated location and the hub respectively while v m a x is now defined as the wind speed at the hub height z hub and α is a constant of the power law from input while α is 0 14 for the owt problems in iec 61400 3 from equations 13 and 14 we obtain the final model of the average wind speed for a tropical cyclone as follows 15 v r z v m a x 2 r t r r t 2 r 2 β z z h u b α f o r r r t a n d v r v m a x 2 r t r r t 2 r 2 γ z z h u b α f o r r r t where v max is the eye wall wind speed at the hub height averaged using 10 min one can also use the holland 1980 model as follows 16 v r z v m a x r t r exp 1 r t r b z z h u b α where b 0 886 0 0177v max 0 0094φ and φ is the latitude thus one can determine the average wind speed and orientation at the owt as follows 17 θ π 2 t a n 1 y 0 v t t x 0 18 v x r z t v r z cosθ 19 v y r z t v r z sinθ v t 20 v r z t v x r z t 2 v y r z t 2 21 θ r z t t a n 1 v y r z v x r z where θ is shown in fig 1 v x r z t and v y r z t are the average wind speeds in global x and y directions v r z t v j a v e t in equation 7 is the total average wind speed including the moving speed of the tropical cyclone and θ r z t is the orientation of v r z t equations 20 and 21 are the final average wind equations for the proposed tropical cyclone model and they should be modified for x 0 0 or v x r z t 0 in programming one can set x 0 to a very small positive value to avoid the singular problem when x 0 equals zero in addition a function in fortran atan2 v y r z t v x r z t can be used to avoid the problem of v x r z t 0 4 numerical studies 4 1 validation with the ntm etm and ewm turbulent wind fields the results of the turbsim program jonkman 2014 are used to compare with those from the proposed method while the wind types include the normal turbulence model ntm the extreme turbulence model etm and the extreme wind speed model ewm according to iec 61400 1 2019a the input parameters for these wind types are shown in fig 1 where we set the time step length equal to 0 05 s and a total of 16 200 time steps are simulated since the random angles in equation 4 are different from the two programs the results cannot be exactly the same in addition only the turbulence wind speed fields with a constant average wind speed are compared because the turbsim program does not have a function for variable average wind speeds fig 2 shows the comparisons in the time domain indicating that the two results are acceptably similar 4 2 errors from the interpolation scheme and efficiency of the parallel scheme in equation 7 a linear interpolation is used to find a turbulent wind speed field between time intervals where using more time points to perform the interpolation will produce more accurate results but more computer time will be used this section thus studies the errors acquired from this interpolation scheme we perform two analyses in which the first one is the eye wall of the tropical cyclone just passing the owt case 1 and the second is the eye wall passing through the owt case 2 as shown in fig 1 the input parameters of the two cases are listed in table 2 the 180 m by 180 m area in the y and z plane is divided into 31 by 31 location points the time step length is set to 0 05 s and a total of 240 000 time steps n t are simulated total time 12 000 s the proposed program will automatically find the time points for the maximum average wind velocity and the intersections with the eye wall and will add these time points to the necessary time points t i mentioned in section 2 1 1 thus the minimum time points for cases 1 and 2 are 3 and 5 respectively fig 3 shows the changes in the errors with the number of time points n where the error err is defined as follows 22 e r r 2 1 c o r r e l a t i o n 1 i 1 n t x i x y i y i 1 n t x i x 2 y i y 2 where x i and x are the wind speed at time step i and the mean wind speed of n t time steps for using a certain number of time points and y i and y are those for using 50 time points this figure indicates that the minimum required time points 3 time points for case 1 and 5 time points for case 2 are enough to produce a significantly accurate turbulent wind field for tropical cyclones fig 4 shows the speedup ratio of the computer time changing with the number of cpu cores used for the calculation of the wind speed field theoretically the proposed method as shown in table 1 is fully parallel the speedup ratio is about 4 8 using a 7 core intel i9 9900k cpu this is because the cache and the data bus between the cpu and memory are shared by cpu cores in a non parallel form so full parallelization is difficult for a program accessing a large amount of memory nevertheless the speedup ratio in fig 3 is within an acceptable efficiency threshold using a personal computer 4 3 efficiency and errors from the skyline solution scheme we proposed a skyline scheme to establish and decompose matrix s jk in equation 4 using the criterion from equation 10 thus this section studies the errors and efficiency of the proposed scheme case 1 in section 4 2 is used again to perform this parametric study where only the total simulation time changes to 6500 s fig 5 shows the changes in the errors with the tolerance of eps in equation 10 for the skyline solution method and fig 6 shows the changes in the required computer times with the tolerance of eps in equation 10 the two figures indicate that the proposed skyline method is quite accurate even when setting eps to a large value such as 0 1 while using 0 01 is good enough not only in terms of accuracy but also in terms of the required cpu time it should be noted that the program can be seven times faster than that using a full matrix 5 study of the steel design of owt support structures under tropical cyclone loads this section discusses the finite element analysis and steel design of a dtu 10 mw owt bak et al 2013 support structure under tropical cyclone loading according to iec 61400 3 2019 and appendix i where the finite element analysis and steel design procedures can be found in ju 2019 ju and huang 2019 ju et al 2019 fig 7 shows the finite element mesh and designed member sizes for the actual owt structure made of steel with the yield stress of 345 mpa where the sea average depth is 50 m and the soil is moderate hard sandy soil with a submerged internal frictional angle of 30 the jacket type foundation is suitable for the sea average depth near 50 m wu et al 2019 so we used this foundation type to perform the parametric study table 3 shows the design loading cases dlc where dlcs i 1 and i 2 are those for tropical cyclone affected regions suggested by iec 61400 3 1 2019b which are similar to dlc 11 3 of gl tctn 2013 dlc i 2 considers the loss of the electrical network and we select a return period of 500 years for extreme environmental conditions while the misalignment of the yaw system with the wind direction is set to range from 0 to 180 with an increment of 30 for seven cases in addition the wind and wave directions are also set to these seven misalignment cases so there are 73 343 cases the wind field of dlcs i 1 and i 2 is the standard ewm where the h s h s500 at the hub height is set to 72 m s which is equivalent to tropical cyclone class three noaa 2013 in this case the time step length is set to 0 05 s and 16 000 time steps are simulated for boundary conditions p y t z and q z nonlinear springs were used to model the soil structure interaction ju 2019 ju and huang 2019 where one ends of those spring are connected to the pile nodes and the others are fixed the above dlcs are still a standard form with a constant average wind speed and direction for variable wind speeds and directions gl tctn dlc 11 2 mentions that the wind speed increases from small to the largest with wind direction changes of 180 within 30 min in iec there is no standard procedure although it mentions that additional design considerations may be needed to maintain the same safety level as for owts in areas affected by tropical cyclones thus in this study we used the proposed model to obtain the wind field of tropical cyclones and perform fast jonkman and buhl 2005 using the turbulent wind filed to obtain the time history three direction forces and three direction moments at the top of the tower ju et al 2019 finite element analyses were then performed to obtain the member forces and moments of the support structure and finally the results of total required steel weight using the api steel design api 2019 were compared to those from the dlcs of iec 61400 3 1 2019 including dlcs i 1 and i 2 for the analyzed tropical cyclone the parameters y 0 v max r t β γ α and z 0 in table 2 are used while x 0 is set at 3000 and 9000 m v t is set at 4 and 6 m s the angle between the wave and the wind is set at 0 30 60 90 120 150 and 180 the misalignment of the yaw to the wind direction is set at 0 30 and 30 defined as dlc d 1 and another case is where the yaw is always in the x axis defined as dlc d 2 it was noted that the wind direction changes with time so we modified the dll file discon dll of fast jonkman and buhl 2005 to fix the direction between the wind and nacelle directions misalignment of the yaw thus there were 112 cases where 84 cases were dlc d 1 and 28 cases were dlc d 2 those cases were combined with the dlcs of iec 61400 3 1 2019b in table 3 including dlcs i 1 and i 2 to attain structural analysis and steel design where the time step length was set to 0 05 s and 240 000 time steps were simulated total time 12000 s fig 8 shows the changes in the wind speeds at the hub with time for x 0 3000 m and v t 6 m s where the change in the magnitude and direction of the wind can be clearly seen based on the above discussion there were three cases analyzed and designed in this section where case 1 only comprises iec 61400 3 loads without tropical cyclone loads case 2 comprises iec 61400 3 and dlcs i 1 and i 2 for tropical cyclone loads and case 3 comprises the case 2 loads as well as 112 loads from the dlcs d 1 and d 2 defined in this paper the details of the controlled dlcs for the three cases are shown in tables 3 5 which indicate the following features 1 the optimal steel design weights of the owt support structure are 2168 2582 and 2642 ton for cases 1 to 3 respectively which means that case 2 increases the steel design weight by 19 1 and case 3 increases it by 21 9 therefore the increase in the steel design weight of nearly 20 cannot be ignored due to the effect of the class 3 tropical cyclone although the class i owt with the tropical cyclone effect was included v ref 57 m s however the increase in the steel weight due to the dlcs d 1 and d 2 compared to case 2 was 2 3 which means that dlcs i 1 and i 2 of iec 61400 3 are approximately adequate to simulate the effect of tropical cyclones 2 without tropical cyclone loads as shown in table 4 dlc 2 2 can control the steel design because the blades are uncontrolled at a small turbulent wind speed where the blades are at a small pitch angle to acquire the energy from wind loads and later the greater turbulent wind exerts a lot of forces on the three blades in addition to dlc 2 2 the parked conditions with huge waves and high wind speeds under dlc 6 1 and dlc 7 1 will control the steel section design of the support structure 3 table 5 indicates that class 3 tropical cyclone loads dlc i 2 dominate almost all of the steel designs which was attributed to yaw misalignment ju at al 2019 drew a similar conclusion according to gl tctn 2013 table 6 further indicates that actual tropical cyclones may worsen the conditions especially in cases where the yaw is always in the x axis dlc d 2 nevertheless the actual tropical cyclone condition discussed in case 3 does not increase the weight of the steel design excessively so we suggest that iec 61400 3 dlcs i 1 and i 2 are sufficient to ensure the safety of the owt steel design 6 conclusion in this study an efficient unsteady turbulent wind model is developed to simulate a tropical cyclone wind field the proposed method first establishes the frequency domain wind fields under a number of required average wind speeds and the inverse fft is then used to obtain the time domain wind fields interpolation is then used to determine the full field turbulent wind speed of tropical cyclones with the average wind speed and wind direction changing with time the openmp scheme for shared memory computers is used in the proposed method for the purpose of parallel computing and a skyline method is adopted to increase the efficiency of the matrix decomposition in the wind field calculation with the help of the two proposed schemes the speedup using an eight core computer was found to be up to 35 times faster than that without these schemes based on the above procedures a fortran computer program turbulence f90 was developed including the functions necessary to generate the various iec or dnv gl turbulent wind fields as well as the tropical cyclone wind field while the source codes executable programs manuals and examples can be obtained from the web site from http bit ly 3jthmb3 select 16 wind turbine structure design the fortran program turbulence f90 is in windturb exe after decompressing the downloaded file windturb rar these generated wind fields can be directly used in the fast program jonkman and buhl 2005 three cases owt support structure analyses and designs cases were considered where case 1 only comprised iec 61400 3 loads case 2 comprised iec 61400 3 and dlcs i 1 and i 2 for tropical cyclone loads and case 3 comprised the case 2 and 112 loads for realistic tropical cyclones the results indicated that the increase in the steel design weight of nearly 20 due to the class 3 tropical cyclone cannot be ignored although case 1 considered the class i owt with the tropical cyclone wind effect without tropical cyclone loads dlc 2 2 can control the steel design in addition to this situation dlcs 6 1 and 7 1 the parked condition will control the steel design of the support structure for case 2 class 3 tropical cyclone loads dlc i 2 dominate almost all of the steel designs which was mainly attributed to yaw misalignment however case 3 indicates that the actual tropical cyclones may make the condition even worse especially for the condition in which the yaw is always in the x axis nevertheless the actual case 3 tropical cyclone condition did not excessively increase the weight of the steel design so iec 61400 3 dlcs i 1 and i 2 are sufficient to ensure the safety of the owt steel design credit authorship contribution statement shen haw ju conceptualization methodology software writing review editing hsin hsiang hsu data curation validation ting yu hsiao writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20280,an efficient unsteady turbulent wind model is developed to simulate the wind field of tropical cyclones for wind turbines the method first establishes frequency domain wind fields which are then changed to time domain wind fields using the inverse fast fourier transfer finally interpolation is used to determine the full field unsteady turbulent wind speed the openmp scheme for parallel computing and the skyline method for efficient matrix decomposition sped up 34 times faster than that without these schemes using an eight core computer then offshore wind turbine owt support structure analyses and designs under international electrotechnical commission iec 61400 3 and realistic tropical cyclone loads were performed for three cases the results indicate that iec 61400 3 design load cases dlcs 2 2 6 1 and 7 1 control the steel design for the case without tropical cyclone loads but with such loads iec 61400 3 dlc i 2 dominates almost all the steel designs which was attributed to yaw misalignment however actual tropical cyclones may cause worse conditions especially for the yaw always on the x axis nevertheless this actual tropical cyclone condition does not excessively increase the weight of the steel design so iec 61400 3 dlcs i 1 and i 2 are sufficient to ensure the safety of the owt steel design keywords offshore wind turbine tropical cyclones yaw operative condition finite element analysis openmp parallel computation soil structure interaction significant wave height turbulence 1 introduction wind power is one of the best renewable energy sources while in some pacific and atlantic regions tropical cyclones are a great threat to wind turbine structures therefore a suitable simulation model of tropical cyclones for wind turbines is highly necessary but is rare in both the literature and practical world to design offshore wind turbine owt systems time history finite element analyses under combinations of wind and wave loads are necessary usually a full field numerical turbulent wind profile such as that generated by turbsim 2014 is necessary to determine the wind loads applied to turbines and support structures while a full field turbulent wind profile is often generated from the frequency domain veers 1988 however for the wind loads from tropical cyclones the average wind speed and direction are changed such as design load case dlc 11 2 mentioned in the germanischer lloyd tropical cyclone technical note gl tctn gl 2013 so a wind profile generated from the frequency domain should be modified there are a lot of models that can be used to create tropical cyclone average wind fields such as the models generated by jelesnianski 1996 holland 1980 mann 1998 willoughby at al 2005 li et al 2013 and pandey and rao 2018 but not many studies directly produce a turbulence model for the purpose of owt analyses liu et al 2011 analyzed the characteristics of the extreme wind load parameters for owts under typhoon conditions and they gave four suggestions for the iec code zhang 2014 simulated a typhoon wind field based on the classical autoregressive model and a regional power spectrum density model and indicated that tower buckling is the major structural failure mode due to typhoons yang et al 2014 discussed the characteristics of aerodynamic loads acting on a wind turbine due to gusts during a typhoon and the unsteady wind conditions during a typhoon were modeled by the gust model han et al 2014 presents the external wind conditions for the design and assessment of wind turbine loading in tropical cyclone regions including physical constants wind speed wind shear turbulence intensity turbulence length scale and turbulence spectral models kim and manuel 2016 developed a hurricane intensity evolution model based on thermodynamic and atmospheric environmental variables where a turbulent wind field can be simulated at a location of interest along the hurricane track worsnop at al 2017 used large eddy simulations to produce wind profiles of an idealized hurricane and they found that a simple model such as the kaimal spectrum for turbulence deviators and the power low for the vertical wind speed distribution can accurately simulate the properties of hurricane isabel in 2003 wei et al 2017 established holland s model for hurricane induced wind speed and combined with hurricane induced wave height and direction to simulate a 5 mw owt supported structure amirinia and jung 2017 investigated the effects of hurricane turbulence models on owts by considering unsteady aerodynamic forces on the tower and wind wave soil structure interaction where a formulation for addressing unsteady wind forces on the tower was introduced liu et al 2018 used a series of simulations to provide the artificial typhoon wind fields for the evaluation of iec code recommendations based on the simulated typhoon wind fields an empirical correction ratio and a scale factor were developed to adjust the classical power law model han et al 2019 investigated a scheme for computing wind turbine responses under typhoon where the inverse fourier transform was used to build the turbulent wind field of typhoons fu et al 2020 proposed a multi spring beam column model for monopile analyses with consideration of several typical soil conditions under harsh environmental loading compared with the current design practice i e the american petroleum institute api p y curves the model represents a significant improvement for the monopile design a number of researches performed the structural analysis of owt support structures under tropical cyclones wang et al 2015 developed a method based on artificial intelligence optimization algorithms to analyze samples of extreme wind speeds and mentioned that when the typhoon hits it often leads to wind direction mutation strong turbulence thunderstorms and storm surges which pose a great threat to owts lian et al 2016 studied the owt wind load characteristics under typhoons using the computational fluid dynamics where two factors of wind turbines were investigated including different wind rotor parking positions and wind direction variation tsai et al 2016 observed the wind speed and turbulence intensity profile by doppler lidar for typhoon matmo it was found that types of wind speed profiles were in agreement with the log profile for the full range of the observation dai et al 2017 performed nonlinear time history analyses to study the wind induced failure of a 1 5 mw wind turbine under the cyclone boundary layer flow and they indicated that the plastic hinge locations of the failure tower are consistent with those reported from field investigations yin et al 2017 studied the effects of blade pitch and rotor yaw and wind wave misalignment in a 100 year return hurricane on a 13 2 mw owt the results showed that effects of blade pitch and rotor yaw on turbine structural dynamics are significant whereas the effect of wind wave misalignment is small ma et al 2017 studied the typhoon effect on the aerodynamic performance of the 5 mw floating owt they found that the typhoon event can result in large extreme responses of the rotor thrust and the generated power due to a possible blade pitch angle error phenomenon ju et al 2019b used ultimate load analyses to perform the optimum design for jacket type owt support structures and the steel design was always controlled under the condition of the yaw misalignment according to gl tctn gl 2013 liu et al 2019 introduced a set of modeling methods to predict the failure probability of owts in the china coastal waters the results indicated that the loads and the failure probability do not occur in a simple linear relationship with extreme wind speeds and waves chen et al 2015 conducted a fault investigation on a wind farm located on the southeast coast of mainland china a procedure was proposed to study structural failure by calculating extreme wind loads and reconstructing the structural model of composite blades and steel towers it was found that both extreme winds and the stop positions of wind turbines were critical to turbine failure due to the change of wind direction during typhoon impact hand et al 2021 investigated the structural analysis of the vertical axis wind turbine blade structure subject to extreme wind load cases using the analytical and finite element models the results show that the composite material blade can resist the induced flap wise load and the material strain is contained within its allowable range in order to analyze and design an owt support structure under tropical cyclone conditions time history finite element analyses should be carried out for a long period of time such as over 3 h but this type of analysis is rare in the literature the main difficulty is that the generation of an unsteady turbulent wind field requires a lot of computer time and memory thus in this study an efficient unsteady turbulent model for tropical cyclones is developed and used to perform the analysis and design of the proposed owt support structure 2 numerical procedures used to obtain a turbulent wind field for tropical cyclones 2 1 turbulent wind fields in the time domain for a turbulent wind field with a constant average wind speed the frequency domain wind field can be first established and the inverse fast fourier transfer fft can then be used to obtain the time domain wind field veers 1988 if the average wind speed of tropical cyclones is not constant one can use an interpolation scheme to overcome this difficulty herein the accuracy and efficiency of this proposed method will be discussed the procedures to generate a turbulent wind field are presented as follows 1 first the time points t i i 1 n are selected where t 1 0 and t n the total required time the average wind speeds v ave of these time points will be used to obtain the wind field for the interpolation of other time steps the computer time and the interpolation accuracy are dependent on the number of used time points n and we will be discussed 2 the frequency increment δf and the number of frequencies n f required in the fft are determined using the total time t n and the time step length δt where n f must be 2 m in which m is a positive integer so that 2n f δt is just larger than or equal to t n and 1 δf 1 2n f δt 3 the locations inside a rectangular plane that covers the wind turbine system are defined to find the wind field where the hub vertical coordinate z axis from the sea surface z hub and the rotor diameter are used to set the rectangular plane and n y and n z are the number of calculated wind speed locations in the y and z axes thus there are n y n z space locations for wind speed fields 4 the standard deviation of the wind speed at the hub height should be defined this is not mentioned in iec 61400 1 2019a or 3 1 2019 so we used the definition in the gl tctn gl 2013 the turbulence intensity i z at the hub height was calculated according to world meteorological organization wmo 2010 2 i z hub 1 ln z hub z 0 where z 0 is the surface roughness the standard deviation at the hub height is calculated using the following equation 3 σ1 i z hub vref z hub where v ref z hub is the reference wind speed at the hub height of the current location 5 the basic parameters of the spectrum and coherence equations are set to obtain the symmetric power spectral density psd matrix s j k f m 4 s j k f m δ f 2 c o h j k f m δ r j k u j k s j j f m s k k f m where j and k are the index of wind speed locations so there are n y n z space locations for indexes j and k s j j f m is a n y n z by n y n z spectrum matrix such as the iec kaimal model iec 61400 1 2019a f m mδf m 2 to n f is the current frequency δ r j k refers to the distance between location points j and k u j k refers to a velocity relationship between the two points and c o h j k f m δ r j k u j k is the coherence function between the two points it should be noted that s j k f 1 0 for the fft procedure to obtain the real value time domain wind field 6 find the lower and upper triangular matrix h f m for s j k f m 5 s j k f m h f m h f m t where h f m is the lower triangular matrix and cholesky s method can be used to solve equation 3 this step will use the most computer time since it must be calculated at each frequency f m m 2 to n f in this study we use a skyline solution method ju 2014 to increase the computational efficiency 7 the turbulent wind speed field v j f m m 2 n f of the frequency domain is obtained as below 6 v j f m k 1 j h j k f m x k k f m k 1 j h j k f m e i θ k m where θ k m is a random angle between 0 to 2πfor each direction location point and frequency so the number of these different random angles is 3n y n z n f it should be noted that v j f m is complex due to the complex value of i 1 8 use the inverse fft to obtain the time domain turbulent wind field when v j f m m 2 n f of all the frequencies are determined and an symmetric procedure is required to obtain the time domain real value turbulent wind field as follows 7 let v j f 1 v j f n f 1 0 and v j f 2 n f 2 m v j f m for m 2 to n f the inverse fft used to equation 4 then obtains the time domain turbulent wind field at point j 8 v j t f f t 1 v j f v j f e i 2 π f t d f where t from 0 to 2n f δ t contains 2n f steps 10 the linear interpolation is used to find the turbulent wind speed field between time t i and t i 1 add the average wind speed field and rotate them to the global directions since the average wind speed at each selected time t i i 1 n is used to determine the field of the turbulent wind speed we employed the linear interpolation to find that between the selected time points as follows 9 v j t t i 1 t t i 1 t i v j t v a v e a t t i t t i t i 1 t i v j t v a v e a t t i 1 v j a v e t where v j t is between t i and t i 1 in the local directions and v j a v e t is the average wind speed at location j and time t which will be discussed in the next section the coordinate transfer scheme is used to find the global wind speed field where only the wind speed fields in the local y and z directions are required to be rotated to the global y and z directions and the local and global z directions coincide 2 2 parallel and efficient computation equation 3 produces an n y n z by n y n z full matrix for each frequency f m if s j j f m or c o h j k are dependent on the space since the kaimal spectrum does not vary with space if this type of spectrum is used the matrix shape is only relative to coh jk although one may set the coh jk in the y and z directions independent of the space such as that used by turbsim the coh jk in the x direction varying with space is still a full matrix which will result in the need for extensive computer time to establish and decompose it for each f m where m ranges from 1 to n f to overcome this numerical difficulty we set the off diagonal terms of matrix s j k to be zero using the following equation 10 i f s j k f m s 11 f 2 e p s s e t s j k f m 0 where s 11 f 2 is the second diagonal terms at the second frequency we use it as a reference value for other off diagonal terms s j k f m and eps is an accuracy tolerance usually ranging between 1e 1 to 1e 4 thus matrix s j k f m is a variable band or skyline shape ju 2014 which can be established and decomposed much faster than a full matrix the accuracy and efficiency of this proposed scheme will be discussed in the example section openmp containing many parallel computation directives is an application program interface for adopting shared memory parallelism in c c or fortran in this paper we simply use the most effective one omp do which causes the do loop that follows it to execute in parallel equations 1 3 can be fully parallel for each frequency f m and the inverse fft procedure can be fully parallel for each location n y n z locations thus the parallel is easily performed using the efficient omp do directive since the frequency and location loops are at the most outer loops the parallel efficiency should be high table 1 shows the programming using fortran with openmp for the above parallel procedures where only the commands with the italic type need to be added 3 numerical model of the average wind speed field for tropical cyclones from equations 1 7 the turbulent wind speed field of a tropical cyclone requires a model that includes the average wind speed and direction as a function of time it is difficult to obtain accurate models for long term predictions and further a numerical simulation over a considerably long time is not necessary because the wind speed is not significant and will not cause a critical condition when the owt is far from the tropical cyclone thus we only focus on the numerical model of the tropical cyclone close to the owt and the following assumptions are made in the proposed model 1 the tropical cyclone is a symmetric circular shape 2 the eye wall average wind speed and radius are not changed during the analysis and 3 the path of the tropical cyclone is a straight line when it passes the owt these three assumptions are acceptable for studying owt behavior when tropical cyclones approach it fig 1 shows the proposed tropical cyclone model where the owt is at the origin and its orientation can be set appropriately the tropical cyclone with an eye wall radius of r t is initially located at coordinates x 0 and y 0 with a speed of v t moving along the negative y axis while the maximum average wind speed located at the eye wall is v max during the passage of a tropical cyclone the owt can be either inside or outside the eye wall where whether the tropical cyclone is clockwise or counterclockwise depends on the input the wind velocity is a function of the atmospheric pressure haltiner and martin 1957 a number of studies pandey and rao 2018 jelesnianski 1965 ueno 1981 used or modified the following wind profile for a symmetric tropical cyclone 11 v v m a x 2 r t r r t 2 r 2 where r is the distance between the tropical cyclone eye and the owt as shown in fig 1 pandey and rao 2018 fitted the above equation for various tropical cyclones and modified it as the following equations 12 v v m a x 2 r t r r t 2 r 2 f o r r r t a n d v v m a x 2 r t r r t 2 r 2 0 7 f o r r r t for the flexible use of the above equation we modify equation 9 as follows 13 v r v m a x 2 r t r r t 2 r 2 β f o r r r t a n d v r v m a x 2 r t r r t 2 r 2 γ f o r r r t where β and γ are constants from input and equation 13 is the same as equation 12 for β 1 and γ 0 7 and the same as equation 11 for β γ 1 this study used equation 13 in the analysis due to its uncomplicated characteristics and it was within acceptable levels of accuracy other models such as those of holland 1980 or willoughby at al 2005 can directly take place of equation 13 for the vertical distribution of the average wind speed for tropical cyclones since the maximum vertical distance is not more than 250 m used in owt problems the following power law is still accurate enough 14 v r z v r z h u b z z h u b α where z and z hub are the vertical distances from the sea surface for the calculated location and the hub respectively while v m a x is now defined as the wind speed at the hub height z hub and α is a constant of the power law from input while α is 0 14 for the owt problems in iec 61400 3 from equations 13 and 14 we obtain the final model of the average wind speed for a tropical cyclone as follows 15 v r z v m a x 2 r t r r t 2 r 2 β z z h u b α f o r r r t a n d v r v m a x 2 r t r r t 2 r 2 γ z z h u b α f o r r r t where v max is the eye wall wind speed at the hub height averaged using 10 min one can also use the holland 1980 model as follows 16 v r z v m a x r t r exp 1 r t r b z z h u b α where b 0 886 0 0177v max 0 0094φ and φ is the latitude thus one can determine the average wind speed and orientation at the owt as follows 17 θ π 2 t a n 1 y 0 v t t x 0 18 v x r z t v r z cosθ 19 v y r z t v r z sinθ v t 20 v r z t v x r z t 2 v y r z t 2 21 θ r z t t a n 1 v y r z v x r z where θ is shown in fig 1 v x r z t and v y r z t are the average wind speeds in global x and y directions v r z t v j a v e t in equation 7 is the total average wind speed including the moving speed of the tropical cyclone and θ r z t is the orientation of v r z t equations 20 and 21 are the final average wind equations for the proposed tropical cyclone model and they should be modified for x 0 0 or v x r z t 0 in programming one can set x 0 to a very small positive value to avoid the singular problem when x 0 equals zero in addition a function in fortran atan2 v y r z t v x r z t can be used to avoid the problem of v x r z t 0 4 numerical studies 4 1 validation with the ntm etm and ewm turbulent wind fields the results of the turbsim program jonkman 2014 are used to compare with those from the proposed method while the wind types include the normal turbulence model ntm the extreme turbulence model etm and the extreme wind speed model ewm according to iec 61400 1 2019a the input parameters for these wind types are shown in fig 1 where we set the time step length equal to 0 05 s and a total of 16 200 time steps are simulated since the random angles in equation 4 are different from the two programs the results cannot be exactly the same in addition only the turbulence wind speed fields with a constant average wind speed are compared because the turbsim program does not have a function for variable average wind speeds fig 2 shows the comparisons in the time domain indicating that the two results are acceptably similar 4 2 errors from the interpolation scheme and efficiency of the parallel scheme in equation 7 a linear interpolation is used to find a turbulent wind speed field between time intervals where using more time points to perform the interpolation will produce more accurate results but more computer time will be used this section thus studies the errors acquired from this interpolation scheme we perform two analyses in which the first one is the eye wall of the tropical cyclone just passing the owt case 1 and the second is the eye wall passing through the owt case 2 as shown in fig 1 the input parameters of the two cases are listed in table 2 the 180 m by 180 m area in the y and z plane is divided into 31 by 31 location points the time step length is set to 0 05 s and a total of 240 000 time steps n t are simulated total time 12 000 s the proposed program will automatically find the time points for the maximum average wind velocity and the intersections with the eye wall and will add these time points to the necessary time points t i mentioned in section 2 1 1 thus the minimum time points for cases 1 and 2 are 3 and 5 respectively fig 3 shows the changes in the errors with the number of time points n where the error err is defined as follows 22 e r r 2 1 c o r r e l a t i o n 1 i 1 n t x i x y i y i 1 n t x i x 2 y i y 2 where x i and x are the wind speed at time step i and the mean wind speed of n t time steps for using a certain number of time points and y i and y are those for using 50 time points this figure indicates that the minimum required time points 3 time points for case 1 and 5 time points for case 2 are enough to produce a significantly accurate turbulent wind field for tropical cyclones fig 4 shows the speedup ratio of the computer time changing with the number of cpu cores used for the calculation of the wind speed field theoretically the proposed method as shown in table 1 is fully parallel the speedup ratio is about 4 8 using a 7 core intel i9 9900k cpu this is because the cache and the data bus between the cpu and memory are shared by cpu cores in a non parallel form so full parallelization is difficult for a program accessing a large amount of memory nevertheless the speedup ratio in fig 3 is within an acceptable efficiency threshold using a personal computer 4 3 efficiency and errors from the skyline solution scheme we proposed a skyline scheme to establish and decompose matrix s jk in equation 4 using the criterion from equation 10 thus this section studies the errors and efficiency of the proposed scheme case 1 in section 4 2 is used again to perform this parametric study where only the total simulation time changes to 6500 s fig 5 shows the changes in the errors with the tolerance of eps in equation 10 for the skyline solution method and fig 6 shows the changes in the required computer times with the tolerance of eps in equation 10 the two figures indicate that the proposed skyline method is quite accurate even when setting eps to a large value such as 0 1 while using 0 01 is good enough not only in terms of accuracy but also in terms of the required cpu time it should be noted that the program can be seven times faster than that using a full matrix 5 study of the steel design of owt support structures under tropical cyclone loads this section discusses the finite element analysis and steel design of a dtu 10 mw owt bak et al 2013 support structure under tropical cyclone loading according to iec 61400 3 2019 and appendix i where the finite element analysis and steel design procedures can be found in ju 2019 ju and huang 2019 ju et al 2019 fig 7 shows the finite element mesh and designed member sizes for the actual owt structure made of steel with the yield stress of 345 mpa where the sea average depth is 50 m and the soil is moderate hard sandy soil with a submerged internal frictional angle of 30 the jacket type foundation is suitable for the sea average depth near 50 m wu et al 2019 so we used this foundation type to perform the parametric study table 3 shows the design loading cases dlc where dlcs i 1 and i 2 are those for tropical cyclone affected regions suggested by iec 61400 3 1 2019b which are similar to dlc 11 3 of gl tctn 2013 dlc i 2 considers the loss of the electrical network and we select a return period of 500 years for extreme environmental conditions while the misalignment of the yaw system with the wind direction is set to range from 0 to 180 with an increment of 30 for seven cases in addition the wind and wave directions are also set to these seven misalignment cases so there are 73 343 cases the wind field of dlcs i 1 and i 2 is the standard ewm where the h s h s500 at the hub height is set to 72 m s which is equivalent to tropical cyclone class three noaa 2013 in this case the time step length is set to 0 05 s and 16 000 time steps are simulated for boundary conditions p y t z and q z nonlinear springs were used to model the soil structure interaction ju 2019 ju and huang 2019 where one ends of those spring are connected to the pile nodes and the others are fixed the above dlcs are still a standard form with a constant average wind speed and direction for variable wind speeds and directions gl tctn dlc 11 2 mentions that the wind speed increases from small to the largest with wind direction changes of 180 within 30 min in iec there is no standard procedure although it mentions that additional design considerations may be needed to maintain the same safety level as for owts in areas affected by tropical cyclones thus in this study we used the proposed model to obtain the wind field of tropical cyclones and perform fast jonkman and buhl 2005 using the turbulent wind filed to obtain the time history three direction forces and three direction moments at the top of the tower ju et al 2019 finite element analyses were then performed to obtain the member forces and moments of the support structure and finally the results of total required steel weight using the api steel design api 2019 were compared to those from the dlcs of iec 61400 3 1 2019 including dlcs i 1 and i 2 for the analyzed tropical cyclone the parameters y 0 v max r t β γ α and z 0 in table 2 are used while x 0 is set at 3000 and 9000 m v t is set at 4 and 6 m s the angle between the wave and the wind is set at 0 30 60 90 120 150 and 180 the misalignment of the yaw to the wind direction is set at 0 30 and 30 defined as dlc d 1 and another case is where the yaw is always in the x axis defined as dlc d 2 it was noted that the wind direction changes with time so we modified the dll file discon dll of fast jonkman and buhl 2005 to fix the direction between the wind and nacelle directions misalignment of the yaw thus there were 112 cases where 84 cases were dlc d 1 and 28 cases were dlc d 2 those cases were combined with the dlcs of iec 61400 3 1 2019b in table 3 including dlcs i 1 and i 2 to attain structural analysis and steel design where the time step length was set to 0 05 s and 240 000 time steps were simulated total time 12000 s fig 8 shows the changes in the wind speeds at the hub with time for x 0 3000 m and v t 6 m s where the change in the magnitude and direction of the wind can be clearly seen based on the above discussion there were three cases analyzed and designed in this section where case 1 only comprises iec 61400 3 loads without tropical cyclone loads case 2 comprises iec 61400 3 and dlcs i 1 and i 2 for tropical cyclone loads and case 3 comprises the case 2 loads as well as 112 loads from the dlcs d 1 and d 2 defined in this paper the details of the controlled dlcs for the three cases are shown in tables 3 5 which indicate the following features 1 the optimal steel design weights of the owt support structure are 2168 2582 and 2642 ton for cases 1 to 3 respectively which means that case 2 increases the steel design weight by 19 1 and case 3 increases it by 21 9 therefore the increase in the steel design weight of nearly 20 cannot be ignored due to the effect of the class 3 tropical cyclone although the class i owt with the tropical cyclone effect was included v ref 57 m s however the increase in the steel weight due to the dlcs d 1 and d 2 compared to case 2 was 2 3 which means that dlcs i 1 and i 2 of iec 61400 3 are approximately adequate to simulate the effect of tropical cyclones 2 without tropical cyclone loads as shown in table 4 dlc 2 2 can control the steel design because the blades are uncontrolled at a small turbulent wind speed where the blades are at a small pitch angle to acquire the energy from wind loads and later the greater turbulent wind exerts a lot of forces on the three blades in addition to dlc 2 2 the parked conditions with huge waves and high wind speeds under dlc 6 1 and dlc 7 1 will control the steel section design of the support structure 3 table 5 indicates that class 3 tropical cyclone loads dlc i 2 dominate almost all of the steel designs which was attributed to yaw misalignment ju at al 2019 drew a similar conclusion according to gl tctn 2013 table 6 further indicates that actual tropical cyclones may worsen the conditions especially in cases where the yaw is always in the x axis dlc d 2 nevertheless the actual tropical cyclone condition discussed in case 3 does not increase the weight of the steel design excessively so we suggest that iec 61400 3 dlcs i 1 and i 2 are sufficient to ensure the safety of the owt steel design 6 conclusion in this study an efficient unsteady turbulent wind model is developed to simulate a tropical cyclone wind field the proposed method first establishes the frequency domain wind fields under a number of required average wind speeds and the inverse fft is then used to obtain the time domain wind fields interpolation is then used to determine the full field turbulent wind speed of tropical cyclones with the average wind speed and wind direction changing with time the openmp scheme for shared memory computers is used in the proposed method for the purpose of parallel computing and a skyline method is adopted to increase the efficiency of the matrix decomposition in the wind field calculation with the help of the two proposed schemes the speedup using an eight core computer was found to be up to 35 times faster than that without these schemes based on the above procedures a fortran computer program turbulence f90 was developed including the functions necessary to generate the various iec or dnv gl turbulent wind fields as well as the tropical cyclone wind field while the source codes executable programs manuals and examples can be obtained from the web site from http bit ly 3jthmb3 select 16 wind turbine structure design the fortran program turbulence f90 is in windturb exe after decompressing the downloaded file windturb rar these generated wind fields can be directly used in the fast program jonkman and buhl 2005 three cases owt support structure analyses and designs cases were considered where case 1 only comprised iec 61400 3 loads case 2 comprised iec 61400 3 and dlcs i 1 and i 2 for tropical cyclone loads and case 3 comprised the case 2 and 112 loads for realistic tropical cyclones the results indicated that the increase in the steel design weight of nearly 20 due to the class 3 tropical cyclone cannot be ignored although case 1 considered the class i owt with the tropical cyclone wind effect without tropical cyclone loads dlc 2 2 can control the steel design in addition to this situation dlcs 6 1 and 7 1 the parked condition will control the steel design of the support structure for case 2 class 3 tropical cyclone loads dlc i 2 dominate almost all of the steel designs which was mainly attributed to yaw misalignment however case 3 indicates that the actual tropical cyclones may make the condition even worse especially for the condition in which the yaw is always in the x axis nevertheless the actual case 3 tropical cyclone condition did not excessively increase the weight of the steel design so iec 61400 3 dlcs i 1 and i 2 are sufficient to ensure the safety of the owt steel design credit authorship contribution statement shen haw ju conceptualization methodology software writing review editing hsin hsiang hsu data curation validation ting yu hsiao writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20281,this paper focus on the comparison of traditional vertical axis turbines and a newly proposed horizontal wave flow turbine firstly the major design parameters of this new concept are presented then a series of experimental tests of a prototype in the towing tank have been performed to investigate its hydrodynamic performance it is found that the highest energy conversion rate is about 24 83 and the average impeller rotation power also reaches its maximum value of 352 w among all the six design cases in addition the computational fluid dynamics cfd simulations have been performed to investigate its hydrodynamic characteristics and energy harvesting efficiency under the combined action of waves and currents the results also show that the amplitude of the turbine s thrust and torque moment fluctuations increase with increasing motion amplitude furthermore the wave dynamics cause instantaneous fluctuations in the flow field distribution for both types and the horizontal wave flow turbine has a more stable flow field the comparison of both types of turbine based on the cfd simulations show that the torque moment thrust force and lateral force coefficients of the horizontal wave flow turbine are approximately 1 2 1 5 greater than those of the vertical axis turbine therefore the horizontal wave flow turbine shows better energy harvesting efficiency if compared with the traditional vertical one keywords horizontal wave flow turbine experimental tests hydrodynamic performance cfd energy harvesting efficiency 1 introduction the ocean covers approximately 71 of earth s surface and contains a large amount of renewable energy it is estimated that the world s total ocean energy reserves are approximately 76 6 billion kw and the useable reserves are approximately 6 4 billion kw ren21 2019 ocean energy mainly includes wave energy tidal energy temperature difference energy and etc from feasibility analysis of energy density and technology realization wave energy and tidal current energy are the most promising sources a combination of social environmental and economic interests is driving research into offshore renewable energy the production of which is a central facet of sustainable human development currently various offshore power generation devices have been put into commercial trial operation bao et al 2015 tiago et al 2016 power based on waves and currents has become attractive because of its high energy density high predictability and low environmental impact additionally energy utilization technology has matured and the energy output efficiency of marine tidal power generation devices has reached nearly 40 nguyen et al 2020 however only a few have been constructed or are near commercial feasibility axial flow water turbines afwt and crossflow water turbines cfwt are among the devices being developed to transform the ocean s kinetic energy contained within tides and currents into useable energy kirke 2011 brown et al 2020 wave current energy converter is one of the research hotspots in the field of marine energy utilization song et al 2020a proposed a multilayer composite blade design scheme for ocean current energy applications and established a fsi model for an ocean current turbine blade prove a way to enhance the performance of ocean current turbines especially to corrosion resistance and mechanical fatigue resistance frid et al 2012 conducted a detailed analysis of the energy dynamics mechanism of waves and tidal currents and tatum et al 2016 used three dimensional fluid dynamics calculations to study the effects of surface gravity waves and laminar flow on the energy harvesting characteristics of horizontal axis turbine type tidal energy power generation devices it was found that the wave period and wave direction have a significant impact on the output power fluctuation range of the turbine to further understand this phenomenon scarlett et al 2019 conducted a numerical analysis on the unsteady hydrodynamic performance of a full scale horizontal axis tidal energy turbine under large waves in the field of power generation device design and experimental research in the joint use of waves and tidal currents song et al 2020b presented a performance comparison and discuss between a bare turbine and a diffuser augmented turbine as well as turbine arrays in shear flow they obtained the differences in shear flow between a bare turbine system and a diffuser augmented turbine system and the interaction between each turbine in array and how this interaction affects the hydrodynamic behavior and energy extracting performance of the turbine array system negro et al 2012 proposed the typical wave and tidal power generation equipment which could be used at sea concerning the preliminary idea of tidal current combined power generation the research on the influence of surface gravity waves on the performance of tidal current power generation turbines and tested the resistance torque and rotary speed is developed lust et al 2013 the results from this research showed that the thrust and power change periodically when there is a wave and the change frequency is consistent with the wave frequency under different speed and wave combinations the power fluctuates up to 39 and the resistance fluctuates up to 79 draycott et al 2019 carried out a horizontal axis tidal energy turbine nonlinear wave load test a 1 15 scale pool model was used to study the influence of waves on tidal current turbines in a summary researchers have conducted many studies on the hydrodynamic performance of water turbines under the tidal currents but the investigations on the hydrodynamic performance of rotary turbine under the joint wave and currents are limited inspired by the vertically turbine which can generate power as water flows as shown in fig 1 a a new concept of horizontal wave flow turbine has been proposed firstly in this paper further it protype will be tested in the towing tank at east china sea standard measurement center several critical parameters including the average impeller rotation power energy harvesting efficiency the maximum torque and the input kinematic power are used to characterize its hydrodynamic performance the experimental results can be used to validate the results from the computational fluid dynamics cfd simulations after the validation the cfd method will be further performed to investigate its hydrodynamic characteristics and energy harvesting efficiency under the joint of waves and currents the results of the horizontal wave flow turbine will be compared with those of traditional vertical one overall the newly proposed horizontal wave flow turbine shows better energy harvesting efficiency than the traditional vertical turbine 2 concept design and theoretical formulas for performance evaluation the basic principle of this new type of horizontal wave flow turbine is to make use of tidal force and part of wave force acting on the blade to drive the mechanism to rotate and capture the energy this innovative idea originates from the traditional vertical axis power turbine by flipping the blades 90 fig 2 shows its general arrangement and it mainly consists of a generator a crossflow water turbine and two pontoons at both sides the arrangement of horizontal wave flow turbine could harness the energy of wave and current energy simultaneously in other words the steering rack and the support rod could rotate relative to each other and this new design makes the buoys will follow the wave direction and the turbine generator will follow the current direction and ensure to harvest the wave and current energy as much as possible in addition the stern rudder could help to stabilize the system under currents both pontoons at both sides are connected by the support rod and they provide the restoring buoyance force in calm water they ensure the generator to harvest the energy under joint waves and currents and further to stabilize the whole generator with mooring system in the harsh sea conditions zhao et al 2019 overall the new horizontal wave flow turbine has good low speed starting performance high efficiency and good general characteristics it could realize high power ocean energy generation through array combination single machine mode 2 1 major design parameters of turbine blade the specific parameters are given in table 1 2 2 theoretical formulas for performance evaluation for the power research of the flow turbine the power characteristic here refers to the ability of the flow turbine to convert the kinetic energy contained in the marine energy into the kinetic energy of its own impeller rotation and the energy harvesting efficiency is given as 1 c p p 0 5 ρ u 3 a q ω 0 5 ρ u 3 a where p is the impeller rotation power q is torque on the impeller ω is the impeller angular velocity ρ is the water flow density u is the flow rate a is the fluid passing area the speed ratio is defined as the tangential speed ratio of the blade tip to the incoming flow speed expressed by λ which represents the speed of movement between the turbine blades and the incoming flow expressed as 2 λ r ω u to describe the motion conditions of the floating horizontal axis turbine under the action of waves dimensionless parameters are defined as follows ma et al 2018 yang et al 2019 turbine thrust coefficient 3 c f x f x 0 5 ρ u 2 d h turbine lateral force coefficient 4 c f y f y 0 5 ρ u 2 d h moment factor 5 c m m 0 5 ρ u 2 a r dimensionless roll angular velocity 6 ω u l u l a ω cos ω t u dimensionless roll angular acceleration 7 α u l u a ω 2 l 2 sin ω t u 2 where d l h and u are the turbine diameter blade chord length extension length and rolling speed respectively m a u r are the output torque of rotor sweep area of rotor flow rate and radius of the blade f x and f y are the thrust and lateral force by the turbine in equations 3 and 4 the hydrodynamic coefficients c f x and c f y could be separated into three terms 8 c f x c x n x ω m x α c f y c y n y ω m y α c x is the lift force coefficient and c y is the pressure difference drag coefficient where n x n y and m x m y use the trigonometric series to get the expanded form 9 n x δ c f x δ ω n x 0 k 1 n x k sin k z θ t ψ ω x k n y δ c f y δ ω n y 0 k 1 n y k sin k z θ t ψ w y k m x δ c f x δ α m x 0 k 1 m x k sin k z θ t ψ α x k m y δ c f y δ α m y 0 k 1 m y k sin k z θ t ψ α y k the final thrust coefficient can be written as the following series 10 c f x c x n x ω m x α c x 0 k 1 c x 0 sin k z θ t ψ x k n x 0 k 1 n x k sin k z θ t ψ ω x k ω m x 0 k 1 m x k sin k z θ t ψ α x k α the lateral force coefficient can be written as the following series 11 c f y c y n y w m y a c y 0 k 1 c y 0 sin k z θ t ψ y k n y 0 k 1 n y k sin k z θ t ψ ω y k ω m y 0 k 1 m y k sin k z θ t ψ α y k α the sum of c f x and c f y also could be calculated by cfd method and the terms in the formulae could be obtained by fitting the same least square method if the influence of the supporting structure on the turbine is not considered in the numerical simulation the motions of the generator under the action of the wave are simple harmonic motions assume that the translation motion z s and rotate motions θ y are as follows 12 z s ζ s sin ω s t 13 θ y a y sin ω y t where ζ s is translation amplitude ω s is translation frequency a y is rotate amplitude and ω y is rotate frequency 3 performance tests in the towing tank 3 1 test facilities and test cases the performance tests in the towing tank have been performed to verify the effectiveness of the horizontal wave flow turbine the power generation turbine device experiment was carried out in the towing tank which is located at east china sea standard measurement center as shown in fig 3 the towing tank is about 200 m 6 m 5 m length width height and the generated wave height is from 0 1 m to 1 0 m fig 4 shows that a prototype of wave flow turbine has been installed on the carriage and fig 5 shows the general arrangement of the measurement system five cases have been scheduled with different combinations of wave and currents as shown in table 2 3 2 experimental results the energy harvesting coefficient c p in equation 1 and the tip speed ratio λ in equation 2 are used as the performance parameters to evaluate the turbine efficiency li et al 2020 the key parameters to be measured in the experiments include the average impeller rotation power p the energy harvesting efficiency c p maximum torque q and input kinematic power guo et al 2020 table 3 summarizes the performance parameters for all the five cases firstly based on the measured data when the flow velocity was 1 5 m s and the wave height was 0 3 m the highest energy conversion rate 24 83 has been achieved for case 3 and the average impeller rotation power also reaches its maximum value of 352 w secondly the maximum input kinematic power is about 1733 7 w for case 5 which correspond to maximum wave height and maximum current velocity however its resultant average impeller rotation power is about 208 w lower than 352 w for case 3 in addition it is found that the performance parameters of case 3 including the average impeller rotation power energy harvesting efficiency and maximum torque are better than those of case 2 mainly due to a higher current velocity defined in case 3 similarly case 5 behaves better than case 4 for the same reason overall as the value of flow velocity and wave height continue to increase the average impeller rotation power energy harvesting efficiency and maximum torque of the turbine are decreased for this kind of power generation operation there is a peak point of optimal power generation performance 3 3 comparison of experimental and cfd results in the other hand cfd method can be applied to simulate the energy harvesting process for this new type of wave turbine the detailed discussions about the cfd model will be discussed in section 4 however the calculated average impeller rotation power and the energy harvesting efficiency from cfd can be compared and further validated by the experimental results as indicated by fig 6 and fig 7 respectively fig 6 shows that the average impeller rotation power from cfd method is very close to the experimental result and the maximum power correspond to case 3 too fig 7 is shown the relationship of tip speed ratio λ and the energy harvesting coefficient c p between experiment and cfd it can be seen from the figure that the calculated value and the experimental value are in good agreement and the optimal speed ratio is reached approximately 2 8 it is seen that there is not much difference of energy harvesting process between the experimental and the cfd simulation which further verifies the effectiveness of 3d numerical simulation 4 performance comparison of two types of turbine waves and currents are factors that must be considered when measuring the efficiency of such wave power generation devices usually the energy can be easily collected when the turbine works on the surface of the sea with the relatively high velocity currents meanwhile the wave induced motions of turbine will also affect its energy harvesting efficiency in this section the cfd simulations will be performed to investigate the hydrodynamic characteristics and energy harvesting efficiency of the horizontal wave flow turbine and the motions of turbine are assumed as simple harmonic motions under the combined action of waves and currents 4 1 cfd model and boundary condition similar to the cfd work implemented by sheng et al 2016 we used the commercial computational fluid dynamics software ansys fluent and used the secondary development udf function of the software for simulation performed 12 core parallel computing on a single server in this paper the problem of investigating the wave effects on the horizontal turbine has been transformed to defining the pre described wave induced roll and pitch motion separately we apply the sliding and dynamic mesh technique to conduct the hydrodynamic analysis of this new type of turbine in the unbounded uniform flow the coupled motions including the rotary motion of blades and the heave and roll motion of turbine system will be considered simultaneously fig 8 shows a diagram of calculation model to tackle roll and heave motion in a separate way accordingly fig 9 shows three domains to simulate the blades rotation translation heave motion the roll motion and the whole flow domain the flow domain is a rectangle with a length of 12d and a width and height of 6d the heave motion is simulated in the cylindrical domain shown in fig 9 a and the roll motion is considered in the spherical domain shown in fig 9 b these three domains are connected by overlapping grids to determine the specific grid size the grid independence test has been implemented in a similar way used by wang et al 2017 four grid sizes such as 0 3 m 0 1 m 0 05 m and 0 02 m are selected in the numerical simulations as clearly shown in table 4 the maximum difference percentage is 10 8 if the grid size of benchmark case is 0 05 m eventually the dominant grid size 0 05 m is selected and a finer mesh size 0 02 m is selected for some local areas after balancing the accuracy of calculation and the cost of calculation time 14 y 0 172 δ y d r e 0 9 where δ y is the grid thickness near the wall d is the diameter of the impeller and δ y is taken as 0 001 d this parameter is widely used in cfd simulations to characterize the size of mesh in a particular flow it should be noted that r e is chosen as 100 to ensure y 1 in this paper additionally it costs about 42 h to run each case with the time step 0 005s and totally 200000 steps in the cfd simulations atmospheric pressure is taken as the reference pressure the inlet boundary is set as the velocity inlet with uniform incoming flow velocity and turbulence parameters the turbine surface is set as a nonslip wall left end of the sea water region is set as the velocity inlet the right end is set as a pressure outlet the top is set as a free sliding wall and finally the rest of the wall conditions are set as reflecting walls the sliding grid is used to set the interface between the rolling zone rotating and heaving zone as the interface surface and the dynamic grid is used in the parameter setting to set the rolling zone to the reciprocating roll motion of a given frequency the overlapping grid condition is set with the rotating and heaving zone the cylinder domain is given to reciprocate the heave motion relative to the roll domain and the grid position is given in the form of subdomains relative to the heave motion the blade rotation domain heave motion domain and roll motion domain pass through the overlapping grid boundary connection the use of overlapping grid technology can improve the convergence of the simulation the turbulence model is based on the menter s shear stress transport turbulence model sst model and a transient solver is used wang et al 2016 4 2 hydrodynamic performance of turbines under the pre described heave and roll motion usually the heave and roll motions have significant influence on the turbine s energy harvesting efficiently based on the experience from naval architecture and the published paper shahsavarifard and bibeau 2020 therefore three different combinations of both motions are considered as three significant conditions sc as shown in table 5 to compare the hydrodynamic performance of both new horizontal turbine and traditional vertical turbine the same type of blades shown in table 1 will be adopted in the cfd model in addition the current velocity in the simulations is assumed to be 1 5 m s in heading direction the angular velocity for roll motion is set as 5 0 rad s and the tip speed ratio is assumed to be 2 8 figs 10 12 show the simulated time series of moment coefficient turbine thrust coefficient and lateral force coefficient for this new type of horizontal axis turbine respectively firstly figs 10 12 clearly show that there are periodic fluctuations under the pre described motions and the fluctuation frequency is basically the same as the frequency of the pre described motions overall the turbine moment coefficient c m and thrust force coefficients c f x and c f y are relatively stable for sc 1 without pre described motion and this is more like a calm water case however for the other two significant conditions with reasonable motions the addition of pre described motion can greatly cause the increase of the amplitude for these coefficients specifically the moment coefficient c m turbine thrust coefficient c f x and lateral force coefficient c f y of sc 3 are approximately 13 times 2 times and 4 times of those coefficients of sc 1 respectively figs 13 15 show the simulated time series of moment coefficient turbine thrust coefficient and lateral force coefficient for the traditional vertical axis turbine respectively it could be clearly seen that there are periodic fluctuations in the time history curve and the fluctuation frequency is greater than the horizontal wave flow turbine for sc1 which represents no pre described motion case the turbine moment and lateral force coefficient fluctuate in a much smaller amplitude if compared with sc2 and sc3 thus relatively stable after post processing the time histories shown in figs 10 15 some results can be summarized in table 6 the results show that the oscillation period of the horizontal wave flow turbine is greater than the traditional vertical turbines this indicates that the former may fluctuate with pre described motion in a slower mode therefore the horizontal wave flow turbine may work in more stable work condition and its instantaneous moment coefficient is significantly higher than that of the traditional vertical turbine in addition we could conclude that as the motion level increases the fluctuation period of c f x c f y and c m of the horizontal wave flow turbine increases significantly however the period fluctuation of the traditional vertical turbines changes slightly overall the horizontal wave flow turbine is superior to the traditional vertical turbine in the energy harvesting performance for the same size for example in the calm water case sc1 the c f x c f y c m and c p of the horizontal wave flow turbine are approximately 1 20 1 35 times that of the traditional vertical turbine in addition as the pre described motion increases the c f x c f y and c m are gradually increasing and turn to approximately 1 5 times of traditional vertical turbine under the sc 3 condition and the c p is get the maximum value under the sc 2 condition 4 3 visualization of flow field the cloud maps for flow field velocity of the horizontal wave flow turbine and the traditional vertical turbine under sc 1 sc 2 sc 3 are given in fig 16 corresponding to the peak of motion cycle it can be seen from fig 16 that with the increase of the pre described motion which means from sc1 to sc2 and sc3 the flow velocity gradually increases for both types and the horizontal wave flow turbine works in a more stable flow field this is because that the increase of the motion amplitude causes the increase of the combined speed at the turbine which causes the vortex amplitude to increase and it leads to the increase of the vorticity in the turbine wake and the velocity of the vortex core there are obvious symmetrical wake vortices at the tip and root of the blade forming multiple vortex tubes of the horizontal wave flow turbine when the turbine moves the vortex tubes expand and increase contraction each period of oscillation produces a bulging vortex tube that propagates downstream in this way the turbine generator which has a periodic effect on the turbine causes periodic fluctuations in the joint waves and currents and the wake flow velocity of horizontal wave flow turbine is higher than the traditional vertical turbine furthermore we can obtain more could maps for both turbines for some further observation for example fig 17 a1 and fig 17 a2 show these maps for the horizontal turbine corresponding to the mean surface and trough of motion cycle under sc 3 fig 17 b1 and fig 17 b2 show these maps for the vertical turbine corresponding to the mean surface and trough of motion cycle under sc 3 by combing fig 16 a3 and fig 16 b3 together we can find that the horizontal wave flow turbine has a relatively bigger flow velocity gradient and have a more stable wake flow field as represented by the green cloud in fig 16 a3 fig 17 a1 and fig 17 a2 and yellow cloud in fig 16 b3 fig 17 b1 and fig 17 b2 in addition as shown in both types of turbines the blade tips and roots of horizontal wave flow impeller caused obvious symmetrical wake vortices and formed more vortex tubes finally the comparison of those maps also indicates that the number of wake vortices near the impeller caused at the mean surface of the motion cycle is significantly greatest which will cause the more turbulence than others 5 conclusions in this paper a new type of horizontal wave flow turbine which mainly consists of a generator a crossflow water turbine and two pontoons at both sides has been proposed and successfully tested in the towing tank furthermore its hydrodynamic performance is compared with the traditional vertical axis wave turbine some conclusions are given as follows 1 compared with the traditional vertical type of turbine the energy harvesting efficiency of the horizontal wave flow turbine has been improved within a certain range based on the results from experimental tests which have been implemented in the towing tank it has been proved that the newly proposed horizontal wave flow turbine has an acceptable energy harvesting efficiency 2 there is a significant effect of motions on the performance of suspended turbine under the combined waves and currents according to this study specifically the rotary motion of blades and the heave and roll motion of turbine system have been simulated by cfd method to compare the hydrodynamic coefficients between two types of turbine it is found that the torque moment thrust and lateral force coefficient of the horizontal wave flow turbine are approximately 1 2 1 5 greater than those of the vertical axis turbine in addition the waves cause instantaneous fluctuations in the flow field distribution for both types of turbine but the horizontal type may produce a more stable flow field according to the performance evaluation the new type of horizontal wave flow turbine has better energy harvesting efficiency 3 in the cfd simulations the complex modelling of this new type of turbine in waves is simplified as linearly superimposed heave and roll motion with the currents considered simultaneously credit author statement yu cao first author conceptualization methodology writing draft project administration funding acquisition andong liu software formal analysis writing draft xiaochuanyu corresponding author conceptualization methodology writingreview and responsible for ensuring that the descriptions are accurate and agreed by all authors ziyan liu software investigation xiaobo tang software investigation shiming wang software investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors express their gratitude to the national natural science foundation of china grant no 41976194 and shanghai engineering research center of marine renewable energy grant no 19dz2254800 in china for the financial support to this study 
20281,this paper focus on the comparison of traditional vertical axis turbines and a newly proposed horizontal wave flow turbine firstly the major design parameters of this new concept are presented then a series of experimental tests of a prototype in the towing tank have been performed to investigate its hydrodynamic performance it is found that the highest energy conversion rate is about 24 83 and the average impeller rotation power also reaches its maximum value of 352 w among all the six design cases in addition the computational fluid dynamics cfd simulations have been performed to investigate its hydrodynamic characteristics and energy harvesting efficiency under the combined action of waves and currents the results also show that the amplitude of the turbine s thrust and torque moment fluctuations increase with increasing motion amplitude furthermore the wave dynamics cause instantaneous fluctuations in the flow field distribution for both types and the horizontal wave flow turbine has a more stable flow field the comparison of both types of turbine based on the cfd simulations show that the torque moment thrust force and lateral force coefficients of the horizontal wave flow turbine are approximately 1 2 1 5 greater than those of the vertical axis turbine therefore the horizontal wave flow turbine shows better energy harvesting efficiency if compared with the traditional vertical one keywords horizontal wave flow turbine experimental tests hydrodynamic performance cfd energy harvesting efficiency 1 introduction the ocean covers approximately 71 of earth s surface and contains a large amount of renewable energy it is estimated that the world s total ocean energy reserves are approximately 76 6 billion kw and the useable reserves are approximately 6 4 billion kw ren21 2019 ocean energy mainly includes wave energy tidal energy temperature difference energy and etc from feasibility analysis of energy density and technology realization wave energy and tidal current energy are the most promising sources a combination of social environmental and economic interests is driving research into offshore renewable energy the production of which is a central facet of sustainable human development currently various offshore power generation devices have been put into commercial trial operation bao et al 2015 tiago et al 2016 power based on waves and currents has become attractive because of its high energy density high predictability and low environmental impact additionally energy utilization technology has matured and the energy output efficiency of marine tidal power generation devices has reached nearly 40 nguyen et al 2020 however only a few have been constructed or are near commercial feasibility axial flow water turbines afwt and crossflow water turbines cfwt are among the devices being developed to transform the ocean s kinetic energy contained within tides and currents into useable energy kirke 2011 brown et al 2020 wave current energy converter is one of the research hotspots in the field of marine energy utilization song et al 2020a proposed a multilayer composite blade design scheme for ocean current energy applications and established a fsi model for an ocean current turbine blade prove a way to enhance the performance of ocean current turbines especially to corrosion resistance and mechanical fatigue resistance frid et al 2012 conducted a detailed analysis of the energy dynamics mechanism of waves and tidal currents and tatum et al 2016 used three dimensional fluid dynamics calculations to study the effects of surface gravity waves and laminar flow on the energy harvesting characteristics of horizontal axis turbine type tidal energy power generation devices it was found that the wave period and wave direction have a significant impact on the output power fluctuation range of the turbine to further understand this phenomenon scarlett et al 2019 conducted a numerical analysis on the unsteady hydrodynamic performance of a full scale horizontal axis tidal energy turbine under large waves in the field of power generation device design and experimental research in the joint use of waves and tidal currents song et al 2020b presented a performance comparison and discuss between a bare turbine and a diffuser augmented turbine as well as turbine arrays in shear flow they obtained the differences in shear flow between a bare turbine system and a diffuser augmented turbine system and the interaction between each turbine in array and how this interaction affects the hydrodynamic behavior and energy extracting performance of the turbine array system negro et al 2012 proposed the typical wave and tidal power generation equipment which could be used at sea concerning the preliminary idea of tidal current combined power generation the research on the influence of surface gravity waves on the performance of tidal current power generation turbines and tested the resistance torque and rotary speed is developed lust et al 2013 the results from this research showed that the thrust and power change periodically when there is a wave and the change frequency is consistent with the wave frequency under different speed and wave combinations the power fluctuates up to 39 and the resistance fluctuates up to 79 draycott et al 2019 carried out a horizontal axis tidal energy turbine nonlinear wave load test a 1 15 scale pool model was used to study the influence of waves on tidal current turbines in a summary researchers have conducted many studies on the hydrodynamic performance of water turbines under the tidal currents but the investigations on the hydrodynamic performance of rotary turbine under the joint wave and currents are limited inspired by the vertically turbine which can generate power as water flows as shown in fig 1 a a new concept of horizontal wave flow turbine has been proposed firstly in this paper further it protype will be tested in the towing tank at east china sea standard measurement center several critical parameters including the average impeller rotation power energy harvesting efficiency the maximum torque and the input kinematic power are used to characterize its hydrodynamic performance the experimental results can be used to validate the results from the computational fluid dynamics cfd simulations after the validation the cfd method will be further performed to investigate its hydrodynamic characteristics and energy harvesting efficiency under the joint of waves and currents the results of the horizontal wave flow turbine will be compared with those of traditional vertical one overall the newly proposed horizontal wave flow turbine shows better energy harvesting efficiency than the traditional vertical turbine 2 concept design and theoretical formulas for performance evaluation the basic principle of this new type of horizontal wave flow turbine is to make use of tidal force and part of wave force acting on the blade to drive the mechanism to rotate and capture the energy this innovative idea originates from the traditional vertical axis power turbine by flipping the blades 90 fig 2 shows its general arrangement and it mainly consists of a generator a crossflow water turbine and two pontoons at both sides the arrangement of horizontal wave flow turbine could harness the energy of wave and current energy simultaneously in other words the steering rack and the support rod could rotate relative to each other and this new design makes the buoys will follow the wave direction and the turbine generator will follow the current direction and ensure to harvest the wave and current energy as much as possible in addition the stern rudder could help to stabilize the system under currents both pontoons at both sides are connected by the support rod and they provide the restoring buoyance force in calm water they ensure the generator to harvest the energy under joint waves and currents and further to stabilize the whole generator with mooring system in the harsh sea conditions zhao et al 2019 overall the new horizontal wave flow turbine has good low speed starting performance high efficiency and good general characteristics it could realize high power ocean energy generation through array combination single machine mode 2 1 major design parameters of turbine blade the specific parameters are given in table 1 2 2 theoretical formulas for performance evaluation for the power research of the flow turbine the power characteristic here refers to the ability of the flow turbine to convert the kinetic energy contained in the marine energy into the kinetic energy of its own impeller rotation and the energy harvesting efficiency is given as 1 c p p 0 5 ρ u 3 a q ω 0 5 ρ u 3 a where p is the impeller rotation power q is torque on the impeller ω is the impeller angular velocity ρ is the water flow density u is the flow rate a is the fluid passing area the speed ratio is defined as the tangential speed ratio of the blade tip to the incoming flow speed expressed by λ which represents the speed of movement between the turbine blades and the incoming flow expressed as 2 λ r ω u to describe the motion conditions of the floating horizontal axis turbine under the action of waves dimensionless parameters are defined as follows ma et al 2018 yang et al 2019 turbine thrust coefficient 3 c f x f x 0 5 ρ u 2 d h turbine lateral force coefficient 4 c f y f y 0 5 ρ u 2 d h moment factor 5 c m m 0 5 ρ u 2 a r dimensionless roll angular velocity 6 ω u l u l a ω cos ω t u dimensionless roll angular acceleration 7 α u l u a ω 2 l 2 sin ω t u 2 where d l h and u are the turbine diameter blade chord length extension length and rolling speed respectively m a u r are the output torque of rotor sweep area of rotor flow rate and radius of the blade f x and f y are the thrust and lateral force by the turbine in equations 3 and 4 the hydrodynamic coefficients c f x and c f y could be separated into three terms 8 c f x c x n x ω m x α c f y c y n y ω m y α c x is the lift force coefficient and c y is the pressure difference drag coefficient where n x n y and m x m y use the trigonometric series to get the expanded form 9 n x δ c f x δ ω n x 0 k 1 n x k sin k z θ t ψ ω x k n y δ c f y δ ω n y 0 k 1 n y k sin k z θ t ψ w y k m x δ c f x δ α m x 0 k 1 m x k sin k z θ t ψ α x k m y δ c f y δ α m y 0 k 1 m y k sin k z θ t ψ α y k the final thrust coefficient can be written as the following series 10 c f x c x n x ω m x α c x 0 k 1 c x 0 sin k z θ t ψ x k n x 0 k 1 n x k sin k z θ t ψ ω x k ω m x 0 k 1 m x k sin k z θ t ψ α x k α the lateral force coefficient can be written as the following series 11 c f y c y n y w m y a c y 0 k 1 c y 0 sin k z θ t ψ y k n y 0 k 1 n y k sin k z θ t ψ ω y k ω m y 0 k 1 m y k sin k z θ t ψ α y k α the sum of c f x and c f y also could be calculated by cfd method and the terms in the formulae could be obtained by fitting the same least square method if the influence of the supporting structure on the turbine is not considered in the numerical simulation the motions of the generator under the action of the wave are simple harmonic motions assume that the translation motion z s and rotate motions θ y are as follows 12 z s ζ s sin ω s t 13 θ y a y sin ω y t where ζ s is translation amplitude ω s is translation frequency a y is rotate amplitude and ω y is rotate frequency 3 performance tests in the towing tank 3 1 test facilities and test cases the performance tests in the towing tank have been performed to verify the effectiveness of the horizontal wave flow turbine the power generation turbine device experiment was carried out in the towing tank which is located at east china sea standard measurement center as shown in fig 3 the towing tank is about 200 m 6 m 5 m length width height and the generated wave height is from 0 1 m to 1 0 m fig 4 shows that a prototype of wave flow turbine has been installed on the carriage and fig 5 shows the general arrangement of the measurement system five cases have been scheduled with different combinations of wave and currents as shown in table 2 3 2 experimental results the energy harvesting coefficient c p in equation 1 and the tip speed ratio λ in equation 2 are used as the performance parameters to evaluate the turbine efficiency li et al 2020 the key parameters to be measured in the experiments include the average impeller rotation power p the energy harvesting efficiency c p maximum torque q and input kinematic power guo et al 2020 table 3 summarizes the performance parameters for all the five cases firstly based on the measured data when the flow velocity was 1 5 m s and the wave height was 0 3 m the highest energy conversion rate 24 83 has been achieved for case 3 and the average impeller rotation power also reaches its maximum value of 352 w secondly the maximum input kinematic power is about 1733 7 w for case 5 which correspond to maximum wave height and maximum current velocity however its resultant average impeller rotation power is about 208 w lower than 352 w for case 3 in addition it is found that the performance parameters of case 3 including the average impeller rotation power energy harvesting efficiency and maximum torque are better than those of case 2 mainly due to a higher current velocity defined in case 3 similarly case 5 behaves better than case 4 for the same reason overall as the value of flow velocity and wave height continue to increase the average impeller rotation power energy harvesting efficiency and maximum torque of the turbine are decreased for this kind of power generation operation there is a peak point of optimal power generation performance 3 3 comparison of experimental and cfd results in the other hand cfd method can be applied to simulate the energy harvesting process for this new type of wave turbine the detailed discussions about the cfd model will be discussed in section 4 however the calculated average impeller rotation power and the energy harvesting efficiency from cfd can be compared and further validated by the experimental results as indicated by fig 6 and fig 7 respectively fig 6 shows that the average impeller rotation power from cfd method is very close to the experimental result and the maximum power correspond to case 3 too fig 7 is shown the relationship of tip speed ratio λ and the energy harvesting coefficient c p between experiment and cfd it can be seen from the figure that the calculated value and the experimental value are in good agreement and the optimal speed ratio is reached approximately 2 8 it is seen that there is not much difference of energy harvesting process between the experimental and the cfd simulation which further verifies the effectiveness of 3d numerical simulation 4 performance comparison of two types of turbine waves and currents are factors that must be considered when measuring the efficiency of such wave power generation devices usually the energy can be easily collected when the turbine works on the surface of the sea with the relatively high velocity currents meanwhile the wave induced motions of turbine will also affect its energy harvesting efficiency in this section the cfd simulations will be performed to investigate the hydrodynamic characteristics and energy harvesting efficiency of the horizontal wave flow turbine and the motions of turbine are assumed as simple harmonic motions under the combined action of waves and currents 4 1 cfd model and boundary condition similar to the cfd work implemented by sheng et al 2016 we used the commercial computational fluid dynamics software ansys fluent and used the secondary development udf function of the software for simulation performed 12 core parallel computing on a single server in this paper the problem of investigating the wave effects on the horizontal turbine has been transformed to defining the pre described wave induced roll and pitch motion separately we apply the sliding and dynamic mesh technique to conduct the hydrodynamic analysis of this new type of turbine in the unbounded uniform flow the coupled motions including the rotary motion of blades and the heave and roll motion of turbine system will be considered simultaneously fig 8 shows a diagram of calculation model to tackle roll and heave motion in a separate way accordingly fig 9 shows three domains to simulate the blades rotation translation heave motion the roll motion and the whole flow domain the flow domain is a rectangle with a length of 12d and a width and height of 6d the heave motion is simulated in the cylindrical domain shown in fig 9 a and the roll motion is considered in the spherical domain shown in fig 9 b these three domains are connected by overlapping grids to determine the specific grid size the grid independence test has been implemented in a similar way used by wang et al 2017 four grid sizes such as 0 3 m 0 1 m 0 05 m and 0 02 m are selected in the numerical simulations as clearly shown in table 4 the maximum difference percentage is 10 8 if the grid size of benchmark case is 0 05 m eventually the dominant grid size 0 05 m is selected and a finer mesh size 0 02 m is selected for some local areas after balancing the accuracy of calculation and the cost of calculation time 14 y 0 172 δ y d r e 0 9 where δ y is the grid thickness near the wall d is the diameter of the impeller and δ y is taken as 0 001 d this parameter is widely used in cfd simulations to characterize the size of mesh in a particular flow it should be noted that r e is chosen as 100 to ensure y 1 in this paper additionally it costs about 42 h to run each case with the time step 0 005s and totally 200000 steps in the cfd simulations atmospheric pressure is taken as the reference pressure the inlet boundary is set as the velocity inlet with uniform incoming flow velocity and turbulence parameters the turbine surface is set as a nonslip wall left end of the sea water region is set as the velocity inlet the right end is set as a pressure outlet the top is set as a free sliding wall and finally the rest of the wall conditions are set as reflecting walls the sliding grid is used to set the interface between the rolling zone rotating and heaving zone as the interface surface and the dynamic grid is used in the parameter setting to set the rolling zone to the reciprocating roll motion of a given frequency the overlapping grid condition is set with the rotating and heaving zone the cylinder domain is given to reciprocate the heave motion relative to the roll domain and the grid position is given in the form of subdomains relative to the heave motion the blade rotation domain heave motion domain and roll motion domain pass through the overlapping grid boundary connection the use of overlapping grid technology can improve the convergence of the simulation the turbulence model is based on the menter s shear stress transport turbulence model sst model and a transient solver is used wang et al 2016 4 2 hydrodynamic performance of turbines under the pre described heave and roll motion usually the heave and roll motions have significant influence on the turbine s energy harvesting efficiently based on the experience from naval architecture and the published paper shahsavarifard and bibeau 2020 therefore three different combinations of both motions are considered as three significant conditions sc as shown in table 5 to compare the hydrodynamic performance of both new horizontal turbine and traditional vertical turbine the same type of blades shown in table 1 will be adopted in the cfd model in addition the current velocity in the simulations is assumed to be 1 5 m s in heading direction the angular velocity for roll motion is set as 5 0 rad s and the tip speed ratio is assumed to be 2 8 figs 10 12 show the simulated time series of moment coefficient turbine thrust coefficient and lateral force coefficient for this new type of horizontal axis turbine respectively firstly figs 10 12 clearly show that there are periodic fluctuations under the pre described motions and the fluctuation frequency is basically the same as the frequency of the pre described motions overall the turbine moment coefficient c m and thrust force coefficients c f x and c f y are relatively stable for sc 1 without pre described motion and this is more like a calm water case however for the other two significant conditions with reasonable motions the addition of pre described motion can greatly cause the increase of the amplitude for these coefficients specifically the moment coefficient c m turbine thrust coefficient c f x and lateral force coefficient c f y of sc 3 are approximately 13 times 2 times and 4 times of those coefficients of sc 1 respectively figs 13 15 show the simulated time series of moment coefficient turbine thrust coefficient and lateral force coefficient for the traditional vertical axis turbine respectively it could be clearly seen that there are periodic fluctuations in the time history curve and the fluctuation frequency is greater than the horizontal wave flow turbine for sc1 which represents no pre described motion case the turbine moment and lateral force coefficient fluctuate in a much smaller amplitude if compared with sc2 and sc3 thus relatively stable after post processing the time histories shown in figs 10 15 some results can be summarized in table 6 the results show that the oscillation period of the horizontal wave flow turbine is greater than the traditional vertical turbines this indicates that the former may fluctuate with pre described motion in a slower mode therefore the horizontal wave flow turbine may work in more stable work condition and its instantaneous moment coefficient is significantly higher than that of the traditional vertical turbine in addition we could conclude that as the motion level increases the fluctuation period of c f x c f y and c m of the horizontal wave flow turbine increases significantly however the period fluctuation of the traditional vertical turbines changes slightly overall the horizontal wave flow turbine is superior to the traditional vertical turbine in the energy harvesting performance for the same size for example in the calm water case sc1 the c f x c f y c m and c p of the horizontal wave flow turbine are approximately 1 20 1 35 times that of the traditional vertical turbine in addition as the pre described motion increases the c f x c f y and c m are gradually increasing and turn to approximately 1 5 times of traditional vertical turbine under the sc 3 condition and the c p is get the maximum value under the sc 2 condition 4 3 visualization of flow field the cloud maps for flow field velocity of the horizontal wave flow turbine and the traditional vertical turbine under sc 1 sc 2 sc 3 are given in fig 16 corresponding to the peak of motion cycle it can be seen from fig 16 that with the increase of the pre described motion which means from sc1 to sc2 and sc3 the flow velocity gradually increases for both types and the horizontal wave flow turbine works in a more stable flow field this is because that the increase of the motion amplitude causes the increase of the combined speed at the turbine which causes the vortex amplitude to increase and it leads to the increase of the vorticity in the turbine wake and the velocity of the vortex core there are obvious symmetrical wake vortices at the tip and root of the blade forming multiple vortex tubes of the horizontal wave flow turbine when the turbine moves the vortex tubes expand and increase contraction each period of oscillation produces a bulging vortex tube that propagates downstream in this way the turbine generator which has a periodic effect on the turbine causes periodic fluctuations in the joint waves and currents and the wake flow velocity of horizontal wave flow turbine is higher than the traditional vertical turbine furthermore we can obtain more could maps for both turbines for some further observation for example fig 17 a1 and fig 17 a2 show these maps for the horizontal turbine corresponding to the mean surface and trough of motion cycle under sc 3 fig 17 b1 and fig 17 b2 show these maps for the vertical turbine corresponding to the mean surface and trough of motion cycle under sc 3 by combing fig 16 a3 and fig 16 b3 together we can find that the horizontal wave flow turbine has a relatively bigger flow velocity gradient and have a more stable wake flow field as represented by the green cloud in fig 16 a3 fig 17 a1 and fig 17 a2 and yellow cloud in fig 16 b3 fig 17 b1 and fig 17 b2 in addition as shown in both types of turbines the blade tips and roots of horizontal wave flow impeller caused obvious symmetrical wake vortices and formed more vortex tubes finally the comparison of those maps also indicates that the number of wake vortices near the impeller caused at the mean surface of the motion cycle is significantly greatest which will cause the more turbulence than others 5 conclusions in this paper a new type of horizontal wave flow turbine which mainly consists of a generator a crossflow water turbine and two pontoons at both sides has been proposed and successfully tested in the towing tank furthermore its hydrodynamic performance is compared with the traditional vertical axis wave turbine some conclusions are given as follows 1 compared with the traditional vertical type of turbine the energy harvesting efficiency of the horizontal wave flow turbine has been improved within a certain range based on the results from experimental tests which have been implemented in the towing tank it has been proved that the newly proposed horizontal wave flow turbine has an acceptable energy harvesting efficiency 2 there is a significant effect of motions on the performance of suspended turbine under the combined waves and currents according to this study specifically the rotary motion of blades and the heave and roll motion of turbine system have been simulated by cfd method to compare the hydrodynamic coefficients between two types of turbine it is found that the torque moment thrust and lateral force coefficient of the horizontal wave flow turbine are approximately 1 2 1 5 greater than those of the vertical axis turbine in addition the waves cause instantaneous fluctuations in the flow field distribution for both types of turbine but the horizontal type may produce a more stable flow field according to the performance evaluation the new type of horizontal wave flow turbine has better energy harvesting efficiency 3 in the cfd simulations the complex modelling of this new type of turbine in waves is simplified as linearly superimposed heave and roll motion with the currents considered simultaneously credit author statement yu cao first author conceptualization methodology writing draft project administration funding acquisition andong liu software formal analysis writing draft xiaochuanyu corresponding author conceptualization methodology writingreview and responsible for ensuring that the descriptions are accurate and agreed by all authors ziyan liu software investigation xiaobo tang software investigation shiming wang software investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors express their gratitude to the national natural science foundation of china grant no 41976194 and shanghai engineering research center of marine renewable energy grant no 19dz2254800 in china for the financial support to this study 
20282,this paper investigates a decentralized adaptive flocking control for crowded unmanned underwater vehicle uuv swarm in the presence of uncertainties and input saturation consider a realistic model of small size and low cost uuv with limited communication it is assumed that only one uuv can access global information desired path and each uuv only communicates with its neighbors to keep all uuvs connected in a crowded swarm the center of flocking cof of each uuv is identified using bio inspired consensus thereby a leader follower flocking controller is proposed to guarantee the collision avoidance and connectivity preservation with bounded fuzzy potential fields at the kinematic level an adaptive neural networks nns controller is further developed to track the desired path where an additional control term is incorporated to handle input saturation at the kinetic level stability analysis demonstrated that all closed loop signals are uniformly ultimately bounded the main contributions of this paper are three folded i a decentralized algorithm without a prior connectivity assumption on a directed spanning tree is proposed ii collision avoidance and connectivity preservation can be achieved simultaneously iii an adaptive controller which is robust against model uncertainties and disturbances is developed simulation results illustrate the effectiveness of the proposed approach keywords unmanned underwater vehicle decentralized flocking control bio inspired consensus fuzzy potential function neural network 1 introduction unmanned underwater vehicle uuv has played an important role in monitoring exploration surveillance exploitation and military applications over the past decades sahoo et al 2019 yao et al 2020 saback et al 2020 it can hardly be to accomplish some specific activities with one single uuv and therefore a flocking operation on a large scale group of small size and low cost uuvs becomes a promising solution sahu et al 2018 liu et al 2019 however due to the constraints imposed by size and cost communicating capability on these uuvs is generally limited liang et al 2021a to deal with this issue a flocking control of crowded uuv swarm has aroused compelling interest in the last few years sahu et al 2018 liu et al 2019 liang et al 2020b 2021a 2021b peng et al 2019a b decentralized flocking control is a self organized pattern of a group swarm by local interactions with each agent s neighbors and environment which is inspired from the fascinating behaviors in natural phenomena i e aggregation rendezvous tracking and cohesion boyd et al 2006 reza 2006 ohshirazi et al 2017 liang and qiang 2020b liang et al 2021a numerous studies have been developed to address the decentralized flocking control problem generally these can be divided into three categories leader following pattern yuan et al 2019 cui et al 2010 li et al 2021 liang et al 2021b virtual structure makavita et al 2019 and behavior based approach lyons et al 2015 cifuentes et al 2015 among them the leader following pattern where all followers can reach a consensus on the desired or actual leader s position cheng et al 2010 has attracted considerable attention due to its simplicity and practicality many representative breakthroughs about leader following for uuvs have been reported for instance a leader follower formation control of multiple underwater vehicles method was reported cui et al 2010 in which each follower tracked its reference trajectory based on leader position for a formation along the straight line path a leader follower tracking scheme was designed and an incorporated controller was given with the aim of separating tasks into position tracking and orientation parts loria et al 2016 additionally the case of multi leaders was also investigated dong and hu 2017 existing works mainly focused on the fixed formation or fixed number of neighbors jing and wang 2020 in which all followers were assumed to know the full global information and all the rest neighbors however due to the limited communication bandwidth and range each uuv can only obtain partial information i e only one informed uuv can access global information and each uuv can only communicate with its neighbors to this end several formation controllers based on velocity estimation were designed gustavi and hu 2008 for example a formation controller without measurement of the leader s velocity was designed such that communication between vehicles was not required liang et al 2020a b nevertheless these works maintain a fixed configuration where the self organized ability is not fully considered it is obvious that some works concerning the flocking control is based on the assumption that communication links are a directed topology in the practical environment the topology related to crowded uuv swarm should be an undirected graph that is established randomly due to its limited communication and external disturbance in boyd et al 2006 a flocking algorithm was reported that can be robust against changes in gossip communication in which neighbors were randomly chosen in silvestre et al 2019 a distributed algorithm was devised for a bidirectional communication graph in which the rate of convergence can be achieved to an average consensus based on this several works related to undirected graph and topology i e asymmetric communication ribeiro et al 2021 and decentralized structure ribeiro et al 2020 have been reported although the above mentioned works can achieve consensus with respect to an average mechanism in flocking more consensus inspired by the non average mechanism can be utilized to guide flocking effectively with reducing the computation burden and increasing the rate of convergence liang et al 2021a from a more practical point of view collision avoidance is a particularly challenging topic peng et al 2021 ribeiro et al 2020 existing techniques for collision avoidance can be roughly divided into two methodologies i e desired formation switching and potential field strategy park and yoo 2019 due to easily triggered oscillatory behaviors information switching more attention has been paid to collision avoidance using potential field strategy where each agent follows a gradient direction of the potential field generated by the sum of all virtual attractive and repulsive forces as a landmark work olfati saber and murray 2004 a distributed flocking algorithm based on the smooth potential field was proposed where rigorous stability was firstly provided based on this several mathematics based liang and qiang 2020b yuan et al 2019 and fuzzy based gu and wang 2019 chen et al 2015 works have been provided to address collision avoidance in flocking control more recently the fuzzy basis function for potential fields is a well studied topic sahu and subudhi 2018 wang et al 2020 qiu et al 2020 however some mentioned works suffered from two major limitations as follows i existing potential field functions are unbounded which generate infinite forces liang et al 2021a and ii connectivity property is not fully considered shi et al 2019 clearly it is challenging to satisfy collision avoidance and connectivity preservation simultaneously for a uuv swarm in a distance dependent communicating network liang et al 2021a jing and wang 2020 shi et al 2019 it is of great interest to note that uuvs in some works are assumed to have deterministic dynamics sahu et al 2018 liang et al 2021a liang and qiang 2020b makavita et al 2019 luo et al 2010 gu and wang et al 2019 however in practical applications uncertainties are inevitable due to high nonlinearity peng et al 2021 imprecise measurements chen et al 2020 and external disturbances li et al 2019 which severely deteriorate control performance this adverse effect has further exacerbated for small size and low cost uuvs makavita et al 2019 chen et al 2020 for example a low cost uuv generally has little or no access to hydrodynamic testing facilities makavita et al 2019 and a smaller mass of uuv makes it more susceptible to external disturbances chen et al 2020 besides most uuvs are underactuated which means that the number of actuators is less than the freedom degrees of movement such that the input saturation problem is easily triggered due to this nonlinear dynamics yao et al 2020 peng et al 2021 bechlioulis et al 2017 consequently it is challenging to address uncertainties and input saturation for the uuv swarm to guarantee stabilization and robustness under uncertainties several methods are available with varying degrees of effectiveness such as backstepping control cui et al 2010 yan et al 2019 sliding mode control liu et al 2019 xu et al 2015 model predictive control mpc yao et al 2020 li et al 2017 neural network control hou et al 2009 liu et al 2019 shi et al 2019 liang et al 2020c 2021b ma et al 2021 extended state observer peng et al 2019a b and fuzzy control wang et al 2020 qiu et al 2020 liang et al 2019 xiang et al 2017 liang et al 2018 among these techniques adaptive nn control is one of the most promising tools to improve performance under uncertainties and disturbances aryankia and selmic 2021 zhu et al 2021a 2021b 2021b park et al 2017 nevertheless some works fail to deal with input saturation shi et al 2019 li et al 2017 liang et al 2020a b peng et al 2019a b liang et al 2019 due to limited physical structure thrusters and rudders may exceed constraints of the maximum forces and moment which degrades control performance and even triggers instability consequently it is of critical importance to address this input saturation problem existing approaches include mpc li et al 2017 barrier lyapunov functions blf gavilan et al 2014 and auxiliary compensator cheng et al 2019 zhou and wen 2006 nie and lin 2020 looking at the above literature mpc requires an accurate dynamic model and blf only considers the upper bound of constraints both of which are quite difficult in practice therefore the auxiliary compensator is the most promising direction an auxiliary system was first proposed for uncertain nonlinear systems zhou and wen 2006 in addition an auxiliary compensator to address input saturation was proposed for the marine surface vessel nie and lin 2020 nevertheless it is noteworthy that few works on the input saturation problem in uuv swarm using auxiliary compensator have been considered motivated by the above observations this paper investigates the decentralized flocking control problem for crowded uuv swarm with uncertainties and input saturation it is considered that only one uuv can access global information and each uuv only communicates with its neighbors the center of flocking cof for each uuv is identified using bio inspired consensus to keep uuvs connected in a crowded flock with the aid of cof a leader following flocking controller is proposed employing bounded fuzzy potential fields to avoid collision and preserve connectivity at the kinetic level moreover an adaptive path following tracking controller is developed to track the desired surge velocity and heading angle in which nns are devised to approximate uncertainties and an additional control term is designed to deal with input saturation finally all error signals can be reduced as small as desired by selecting appropriate parameters according to theoretical analysis the main contributions of this paper are summarized as follows 1 different from the existing leader following works involved with a directed spanning tree cui et al 2010 this paper introduces a decentralized leader following flocking control under undirected topology for crowded uuv swarm where each uuv obtains global information from its neighbors thereby providing more flexibility and expandability 2 to keep uuvs connected in a crowded swarm the cof information is estimated via a novel bio inspired consensus with the minimum number of neighbors and their optimal spatial distribution rather than a fixed number of neighbors or distance liang et al 2021a a bounded fuzzy potential field strategy is subsequently developed to keep the flocking without any potential splits and collisions 3 an adaptive nn controller is devised for uuv subject to uncertainties and disturbances in which a saturation compensator is designed to handle the input saturation problem furthermore it is proved that all closed loop signals are uniformly ultimately bounded with a great convergence in comparison to the existing works the rest of this paper is organized as follows section 2 introduces preliminary knowledge and problem formulation section 3 provides the decentralized leader follower flocking controller section 4 presents the adaptive tracking controller section 5 gives the stability analysis section 6 illustrates simulation results finally section 7 concludes this paper and discusses the future work it is noted that every notation used to indicate parameter throughout this paper is listed in appendix a 2 preliminary knowledge and problem formulation 2 1 uuv model the kinematics and dynamics of an undersaturated uuv are formulated in two coordinate frames namely earth fixed frame e and body fixed frame b as illustrated in fig 1 consider a crowded uuv swarm composed of n agents in the horizontal plane the model of the i th uuv can be described as fossen 2011 1 η i j ψ i v i m i v i c i v i v i d i v i v i τ i w i where η i x i y i ψ i t ℝ 3 is a vector of position and yaw angle in earth fixed frame respectively v i u i v i r i t ℝ 3 is a velocity vector in surge u i sway v i and yaw r i in body fixed frame m i ℝ 3 3 c i ℝ 3 3 and d i ℝ 3 3 are the inertia matrix coriolis matrix and damping matrix respectively w i w i u w i v w i r t ℝ 3 denotes the external disturbance τ i τ u i 0 τ r i t ℝ 3 is a control input vector consisting of surge force sway force which is zero due to the undersaturation and yaw moment in real applications the control force or moment is subject to physical magnitude thrusters therefore a real input vector can be determined by a saturated function with an input δ j as follows 2 τ i sat δ j τ j max i f δ j τ j max δ j i f τ j min δ j τ j max τ j min i f δ j τ j min j u r where τ j max and τ j min are derived from magnitude constraints of the rotational speed of propeller and the deflection angle of rudder respectively both of which are known in addition j ψ i is a transformation matrix given by 3 j ψ i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 suffering from uncertainties i e unmodelled dynamics and parametric perturbations a precise model is difficult to be obtained such that each matrix can be divided into the nominal part and shift part i e m i m i δ m i c i c i δ c i and d i d i δ d i where i represents the nominal parameter and δ i denotes a shifted difference between the real and nominal parameters therefore considering model uncertainties and external disturbance the dynamics 1 can be formatted as 4 m i v i c i v i v i d i v i v i τ i d i where d i δ m i v i δ c i v i v i δ d i v i v i w i then the i th uuv s model can be modified as 5 x i x i cos ψ i v i sin ψ i y i x i sin ψ i v i cos ψ i ψ i r i 6 u i 1 m 11 m 22 v i r i d u d u u u i u i τ u i d u i v i 1 m 22 m 11 v i r i d v d v v v i v i τ v i d v i r i 1 m 33 m 11 m 22 v i r i d r d r r r i r i τ r i d r i assumption 1 the external disturbance w i w u i w v i w r i t and its derivative are bounded 7 w i t w i where w i is a positive constant assumption 2 the velocities of surge and yaw angle are bounded while the velocity of sway is passive bounded in sense that wang et al 2019 8 sup t 0 v i v i m where v i m is a positive constant remark 1 it is clearly noted that the lumped unknown d i is essentially a sum of all uncertainties with unmodelled dynamics parametric perturbations and the external disturbances 2 2 bio inspired consensus approach it has been reported that center of flocking cof information is useful for keeping the flock connected where each agent with this information can guarantee connections with others by moving toward cof sahu and subudhi 2018 therefore a consensus was proposed in gu and wang 2009 liang et al 2020a b to estimate the cof position of the i th agent as follows 9 ζ i c j n i ζ i c ζ j c ζ i c ζ i where ζ i c denotes the estimated cof position of the i th agent ζ i is the position of the i th agent and n i is the neighbors of the i th agent in addition an average position attached to coordinates of the entire system ζ c is defined as 10 ζ c 1 n i 0 n ζ i where n is the number of agents in a flocking by virtue of 9 and 10 agents with different initial positions and velocities can asymptotically converge to the desired trajectory then existing ζ i c ζ c however this consensus holds a prior neighbor assumption on fixed distance rule fdr in fact the neighbor number of each agent is large in a crowded swarm thereby the computation and communication may result in explosion if it is directly employed liang et al 2021a which leads to adverse effects on flocking control consequently inspired by visual attention mechanism a bio inspired interaction strategy based on nearest neighbor rule nnr was firstly designed in our previous works liang et al 2021a liang and qiang 2020 the essence of this strategy is to optimize neighbors for each agent with the minimum number and optimal distribution specifically its model for a crowded uuv swarm is exhibited in table 1 remark 2 the proposed interaction strategy has three folded advantages i it is a time varying and dynamic switching manner rather than the fdr in existing works which is more realistic ii it can consider some inherent properties i e limited view unlike most works in which a uuv is modelled as a particle with an omnidirectional view sahu and subudhi 2018 iii it can minimize the size of neighbor set with an optimal distribution which reduces the computation burden and increases the rate of convergence even providing more flexibility and expandability subsequently a bio inspired consensus approach will be given in section 3 1 by virtue of an optimized neighbor set it is convenient to model the interaction between agents by means of a graph g v e where a node from v n 1 n 2 n n corresponds to a uuv and an edge e i j n i n j v captures the dependence of interconnections between any pair uuvs suppose that no self loops exist i e n i n i e the laplacian matrix l t l i j ℝ n n is defined by l t d t a t with l i j t j 1 j i n a i j and l i j a i j i j where a t a i j ℝ n n corresponds to an adjacency matrix of g t with a i j 1 if n i n j v and a i j 0 otherwise and d t denotes a diagonal matrix for the sake of analyzing the following lemma and assumption are given as lemma 1 godsil and royle 2001 for an undirected connected g v e l is symmetrical and positive semi definite which satisfies 11 b t l b 1 2 i 1 n j n i a i j b i b j 2 where b b 1 b 2 b n for g v e and its minimum eigenvalue is zero with an associated eigenvector 1 1 1 t or l 1 0 0 0 0 t assumption 3 yang et al 2017 guo et al 2020 for an undirected g v e if an extended digraph g v e is given with v 0 1 n and e e e where node 0 denotes the leader and e represents interactions from the leader to the controlled agents then there exists a spanning tree from the leader as root note 2 3 bounded fuzzy potential field function in this paper to consider the limited power provided by small size and low cost uuv in practice a bounded fuzzy potential field function is employed to simultaneously address collision avoidance and connectivity preservation a fuzzy logic system can map an input x to a deterministic control y x which is expressed by a set of fuzzy rules for repulsive and attractive control functions 12 rule i i f x 1 is f 1 i x m is f m i then y 1 is q 1 i y m is q m i where x x 1 x 2 x m r m and y y 1 y 2 y m r m are input and output variables respectively f j i denotes an input fuzzy set in the j th dimension of the i th fuzzy rule j 1 2 m and i 1 2 l q k i denotes an output fuzzy set in the k th dimension of the i th fuzzy rule k 1 2 m and i 1 2 l in order to compute the fuzzy reasoning a max min operation of mandani chau et al 2020 is employed to calculate the output of overall fuzzy logic system thereby an overall membership function is considered as a single combined objective as follows 13 ϖ q k i y k max min ϖ f 1 i x 1 ϖ f 2 i x 2 ϖ f m i x m where ϖ f j i is a corresponding membership function for the input fuzzy set commonly a gaussian function is employed to describe ϖ f j i as follows 14 ϖ f j i exp x j ο 1 j i 2 2 σ 1 j i 2 where o 1 j i and σ 1 j i are the mean and variance respectively consequently a fuzzy basis function vector ξ x ξ 1 x ξ 2 x ξ m x t is defined by the center of gravity to obtain a single deterministic crisp value from all possible defuzzification subsets for each element ξ i x 15 ξ i x π i 1 m ϖ f j i x j i 1 l π i 1 m ϖ f j i x j then an overall output of fuzzy logic system is formulated 16 y q k t ξ x where q k q k 1 q k 2 q k m t lemma 2 gu and hu 2008 for any given nonlinear potential field function f x y if the gradient technique and lasalle s invariance principle are used then a control signal f x y deduced from fuzzy logic system is bounded 2 4 rbf neural network in this paper a radial basis function neural network rbf nn is employed to approximate the sum of uncertainties and disturbances due to its powerful approximation capacity with regard to a continuous function one h z r q r has 17 h z w t θ z ε z z ω r q where z r q is an input vector in a compact set ω z w r l denotes a weighting vector l is nn mode number and ε z is a bounded approximation error satisfying ε ε where ε 0 for all z ω z generally an rbf nn can approximate any continuous function h z to any arbitrary degree of accuracy as 18 h z w t θ z ε z ω r q where w is an optimal weight vector and it is defined as 19 w arg min w r l sup z ω z h z w t θ z where θ z θ 1 z θ 2 z θ l z r l is an activation vector of inputs which is given by 20 θ i z exp z ο 2 i t z ο 2 i σ 2 i 2 i 1 2 l where ο 2 i and σ 2 i are the center and variance of the i th basis function respectively it is worth emphasizing that w and ε are unknown constants both of which are only used for stability analyzing for real applications w is used for function approximation and an estimate of h z can be given by 21 h z w t θ z where w can be estimated online by an adaptive law assumption 4 shi et al 2019 for w w and w w w the error can be formulated by 22 w t θ z w t θ z w t θ z 23 ρ w t w t ρ 2 w 2 w 2 where ρ is a positive constant 2 5 problem formulation in this paper consider that only one leader uuv can access the desired path while remaining uuvs as followers track this leader and each uuv only utilizes its neighbors information in a leader follower flocking consequently this flocking control problem is shifted into a tracking control problem which is depicted in fig 1 this desired path is generated by a time varying signal η d x d θ y d θ ψ d θ where θ r is a given independent variable and ψ d θ atan 2 x d θ y d θ is defined as path tangential angle let x a y a t r 2 be the cof position of the entire system thus tracking errors between the cof and desired path are described as 24 x e y e cos ψ d sin ψ d sin ψ d cos ψ d t x a x d y a y d where x e r and y e r denote along tracking and cross tracking errors respectively and by the aid of 10 the cof position is calculated as 25 η a x a y a ψ a t 1 n i 1 n η i let u u 2 v 2 denote the velocity of cof and taking the derivative of 24 along 5 as 26 x e u cos ψ e ψ d y e θ u d y e u sin ψ e ψ d x e where u d x d 2 y d 2 x d x d θ θ y d y d θ θ and θ u cos ψ e λ x e u d where λ 0 is a designing parameter define ψ e ψ r ψ d where ψ r is an approach angle given by 27 ψ r ψ d atan y e δ where δ is a look ahead distance to make tracking errors converge asymptotically both desired velocity and heading angle for the i th uuv are formulated as 28 u d i x d i 2 y d i 2 ψ d i atan 2 x d i y d i the objective of this paper is to design suitable control laws τ u i and τ r i such that a crowded uuv swarm can track η d while guaranteeing collision avoidance and connectivity preservation in the presence of uncertainties and input saturation and the tracking error η i η d can converge to a predefined bound specifically the objective is formulated as 29 lim t η i η d ω 0 30 lim t 2 c d i j s where ω 0 is a positive constant d i j x i x j 2 y i y j 2 denotes the distance between the i th uuv and j th uuv and c 0 associated with an open ball centred at the i th uuv denotes collision avoiding area and s 0 denotes the maximal communicating distance assumption 5 yao et al 2020 liu et al 2019 peng et al 2019a b wang et al 2020 the desired path η d x d y d is bounded and smooth and its first derivative is bounded assumption 6 wang et al 2020 the x e y e and ψ e are assumed to be nonzero to avoid the possible singularity problem lemma 3 ge and wang 2004 consider a smooth function v t and its initial state v 0 is bounded if there exists an inequality v t μ v c holding with c 0 and μ 0 for any time the following inequality can be obtained as 31 v t v 0 c μ exp μ t c μ 3 decentralized leader follower flocking controller in this section a decentralized leader following flocking controller is designed which consists of bio inspired consensus sub controller and bounded fuzzy potential field sub controller the former is devised for estimating cof information to keep the flocking connected and the latter is avaiable for collision avoidance and connectivity preservation both of which are shown in fig 2 3 1 bio inspired consensus sub controller in the leader following pattern a swarm composed of n uuvs is divided into one leader and n 1 followers motivated by the bio inspired interaction strategy in table 1 both the one leader and followers obtain state information in their optimized neighbor set n i t s i ω i r where the cof plays an important role to keep the swarm connected therefore a bio inspired consensus is designed here to estimate cof information for each uuv specifically a consensus for the i th uuv is defined as follows 32 η i c j n i η i c η j c η i c η i where η j c is the estimated cof position of the j th uuv and n i is the neighbor number of the i th uuv alternatively 32 can be rewritten into a compact vector format 33 η c l η c η c η where η c η 1 c η 2 c η n c t is a matrix generated by the estimated cof positions of all uuvs and η η 1 η 2 η n t is a matrix generated by positions of uuvs to achieve the objective 29 for tracking a desired path η c should asymptotically converge to η a i e 34 lim t η c η a and lim t η i c η i define an error between η c and the average position coordinate of uuvs η a v as follows 35 e η a v η c where η a v is 36 η a v 1 n ξ t η where ξ r n n is a matrix of all ones taking time derivatives of 35 along 32 one has 37 e η a v l η c η c η by virtue of lemma1 and assumption2 there exists l η c 0 and using η c η a v e then 37 yields 38 e 1 n ξ t η η η l i e due to uniformly bounded positions and velocities of uuvs there exists 39 1 n ξ t η η η r where r is a positive constant consider a positive definite function v 0 1 2 e t e such that 40 v 0 1 2 e t e e t 1 n ξ t η η η e t l i e due to connected graph g v e existing e t l 1 e λ min l i e 2 e 2 where λ min l i is the minimum eigenvalue of l i and by the aid of e t i n e then 40 can be derived as v 0 e 2 ϕ 0 e where ϕ 0 ℵ n by defining the set π e e v 0 e ϕ 0 2 2 the inequality is transformed into 41 v 0 e ϕ 0 2 2 ϕ 0 2 2 according to the lasalle invariance principle it is deduced that v 0 0 hence cof errors are globally asymptotically stable olfati saber and murray 2004 remark 3 the proposed bio inspired consensus uses an optimized neighbor set which can reduce computational burden and enhance the rate of convergence additionally it is essentially different from most existing consensus where the neighbor set is a fixed distance interaction gu and hu 2008 liang et al 2020a b 3 2 bounded fuzzy potential field sub controller let a fixed radius s denote the communicating region associated with the i th uuv in fig 3 this region is divided into four zones collision zone separation zone alignment zone and attraction zone all of which are to achieve collision avoidance and connectivity preservation the collision zone with radius c is assumed as a rigid body rather than a particle in yan et al 2017 the separation zone is a ring domain z c z η i r 1 in which each uuv avoids collision by virtue of a repulsive potential function the alignment zone is a bigger ring domain z r 1 z η i r 2 in which each uuv adopts the velocity alignment to track the desired path and an attraction zone is z r 2 z η i s where an attractive potential function can keep a uuv swarm connected clearly if d i j η i η j 2 c it is implied that the swarm has collided and if d i j s it means that the connectivity is broken consequently a desired zone for each individual is z r 1 z η i r 2 where i 1 2 n the label with i 1 denotes the one leader uuv and η i represents a negative gradient in addition η i u i r η i η j satisfies η i u i r η i η j η j u i r η j η i by the aid of fuzzy potential field functions 12 16 a fuzzy repulsive function is designed by a group of rules with two inputs d i j 2 c and d i j r 1 and one output u i r η i η j such that the total repulsive potential field forces of the i th uuv can be rewritten as follows 43 η i u i r η i η j m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς r m η i η j m 1 2 l where ς r m is a positive scale parameter of the m th rule in η i η j repulsive force ii an attractive potential function u i a η i η j is used for keeping a swarm without any splits which satisfies following properties a u i a η i η j is strictly increasing on r 2 s and approaches infinity when d i j s and b it is cut off at r 2 and its attractive force f i a is defined as follows 44 f i a j n i η i u i a η i η j where η i u i a η i η j η j u i a η j η i similarly a fuzzy attractive potential field function is designed by a group of rules with two inputs d i j s and d i j r 2 and one output u i a η i η j such that the total attractive potential field forces of the i th uuv can be rewritten as follows 45 η i u i a η i η j m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς a m η i η j m 1 2 l where ς a m is a positive scale parameter of the m th rule in η i η j attractive force iii an additional attractive potential field function u i a c η i η i c and its f i a c is formulated to avoid the swarm splits satisfying 46 f i a c η i u i a c η i η i c where f i a c denotes an attractive force between the i th uuv and its cof in the fuzzy logic system the input and output are defined as d i c η i η a and u i a c η i η i c respectively here an additional attractive force of the i th uuv is given by 47 η i u i a c η i η i c m 1 l ϖ f j m x 1 m m 1 l ϖ f j m x 1 m ς a c m η i η i c m 1 2 l where ς a c m is a positive scale parameter of the m th rule in η i η i c attractive force iv an additional attractive potential field function u 1 a c η 1 η d and its f 1 a c is formulated to describe the one leader knowing the desired path which satisfies 48 f 1 a c η 1 u 1 a c η 1 η d where f 1 a c denotes an attractive force between the leader uuv and desired path in the fuzzy logic system the input and output are defined as d 1 d η 1 η d and u 1 a c η 1 η d respectively here an attractive force of the leader uuv is given by 49 u 1 a c η 1 η d m 1 l ϖ f j m x 1 m m 1 l ϖ f j m x 1 m ς a c m η 1 η d m 1 2 l where ς a c 1 m is a positive scale parameter of the m th rule in η 1 η d attractive force hence an overall potential function for the crowded uuv swarm is represented by 50 q i 1 n j n i u i r u i a u i a c u 1 a c further the corresponding force with combining 42 44 46 and 48 for the i th uuv yields 51 f i j n i η i u i r η i η j j n i η i u i r η i η j η i u i a c η i η i c η 1 u 1 a c η 1 η d by virtual of lemma 2 the control signal derived from 51 is bounded as follows 52 j n i η i u i r η i η j j n i m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς r m η i η j n i m 1 l ς r m d i j ℓ 1 53 j n i η i u i a η i η j j n i m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς a m η i η j n i m 1 l ς a m d i j ℓ 2 54 η i u i a c η i η i c m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς a m η i η i c m 1 l ς a c m d i c ℓ 3 55 η i u 1 a c η 1 η d m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς a m η 1 η d m 1 l ς a c 1 m d 1 d ℓ 4 where ℓ 1 ℓ 2 ℓ 3 and ℓ 4 are all positive constants furthermore it is easy to obtain that f i ℓ 1 ℓ 2 ℓ 3 ℓ 4 ℓ where ℓ is a positive constant remark 4 the overall potential function q works as an additional desired velocity term i e v d 0 k 1 q η where k 1 is a positive constant additionally v d 1 k 1 q η is bounded such that it can guarantee collision avoidance and connectivity preservation for crowded uuv swarm in this paper 3 3 flocking state feedback control design based on the two sub controllers a flocking state feedback control design is provided for uuv swarm to track the desired trajectory η d with a desired velocity v d motivated by liu 2015 a flocking function of crowded uuv swarm is determined by 56 p a j η v where p a x a y a t ℝ 2 n 1 j η ℝ 2 2 n represents the jacobian matrix satisfying 57 j η p a η p a 1 η t p a 2 η t t 58 p a 1 η 1 n 0 1 n 0 t p a 2 η 0 1 n 0 1 n t where v ℝ 2 n 1 denotes a vector of swarm velocity to guarantee the convergence of tracking errors asymptotically in 28 the desired velocity v d 1 is chosen as 59 v d 1 v d 1 τ v d 2 τ v d n τ τ j k p e p d where v d i x d i y d i t denotes the desired velocity of the i th uuv liang et al 2019 p d x d y d t ℝ 2 n 1 is given by η d x d θ y d θ ψ d θ j represents the pseudo inverse of j and satisfies j j t j j t 1 and j j i besides k d i a g k 11 k 22 recalling remark 4 the overall potential function q can provide an additional desired velocity term such that the total desired velocity of the entire uuv swarm can be rewritten as 60 v d v d 0 v d 1 k 1 q η j τ k p e j p d let cof tracking error dynamics be 61 p e p a p d e 1 e 2 t where e 1 x a x d e 2 y a y d consider a lyapunov like function 62 v 1 1 2 p e t κ p e k 1 q taking the time derivative of 62 along 61 and 24 one gives 63 v 1 p e t κ j η v p d k 1 q η substituting 60 into 63 yields 64 v 1 k 1 q η j t κ p e τ k 1 q η j t κ p e k 1 q η t j p d where ϒ k 1 q η j t κ p e and b k 1 q η t j p d is essentially a bounded parameter with respect to q η and p d then 64 can be obtained as follows 65 v 1 ϒ t ϒ b once collision avoidance and connectivity preservation can be achieved namely the desired zone for each individual is z r 1 z η i r 2 existing q η 0 i e b 0 then 65 becomes 66 v 1 ϒ t ϒ 0 consequently it is implied that v 1 0 can be guaranteed by designing the parameter k 1 thereby the proposed decentralized leader follower flocking controller can ensure stability conditions this concludes the proof 4 adaptive robust path following tracking controller to track the desired surge velocity and heading angle in 28 an adaptive robust path following controller is designed as fig 4 where rbf nns are employed to approximate uncertainties and auxiliary compensators are applied to handle input saturation problem due to the same design procedures for each uuv both surge velocity control and heading control for the i th uuv are designed to make tracking errors converge asymptotically the dynamics of 6 can be recalled and formulated as 67 u i φ u i d 11 m 11 u i τ u i d u i v i φ v i d v i r i φ r i τ r i d r i where φ u i 1 m 11 m 22 v i r i m 23 r i 2 φ v i 1 δ 1 m 23 2 m 11 m 22 m 22 m 23 m 11 m 23 u i r d 33 m 23 d 23 m 33 d 22 m 33 d 32 m 23 r i φ u i 1 δ 1 m 23 d 22 m 22 d 23 m 22 m 11 u i v i m 23 d 23 m 11 u i m 22 d 23 m 23 u i r i where δ 1 m 22 m 33 m 23 2 4 1 surge velocity control define the tracking error of surge velocity as 68 u e i u i u d i where u d i x d i 2 y d i 2 differentiating both sides of 68 along 67 one has 69 u e i φ u i d 11 m 11 u i τ u i d u i u d i to simplify the presentation uncertainties are defined as below 70 ϕ u i φ u i d 11 m 11 u i d u i u d i u e i substituting 70 into 69 yields 71 u e i ϕ u i τ u i u e i the rbf nn observer is designed to approximate ϕ u i and one has 72 ϕ u i w u i t θ z u ε u i where ϕ u i is the estimate of ϕ u i ε u i ε u i and w u i is an adaptive weight parameter and its estimate can be designed as 73 w u i γ u i u e i θ z u ρ u i w u i where γ u i and ρ u i are positive constants w u i t w u i t w u i t furthermore a compensator is proposed to resolve the input saturation in surge as follows 74 γ u i k u 1 γ u i δ τ u i where k u 1 0 and δ τ u i τ u i τ u i thus a yaw control law is formulated based on the rbf nn observer 72 and the input saturation compensator 74 as follows 75 τ u i k u 2 u e i w u i t θ z u k u 3 γ u i where k u 2 0 and k u 3 0 consider the lyapunov function 76 v u i 1 2 u u i 2 1 2 γ u i w u i t w u i 1 2 γ u i 2 taking the time differentiation of 76 one gives 77 v u i u e i u e i w u i t w u i γ u i γ u i substituting 71 72 73 74 and 75 into 77 and yields 78 v u i u e i ϕ u i τ u i u e i w u i t r u i θ z u ρ u i w u i γ u i k u 1 γ u i δ τ u i u e i w u i t θ z u ε u i k u 2 u e i w u i t θ z u k u 3 γ u i u e i w u i t u e i θ z u ρ u i w u i γ u i k u 1 γ u i δ τ u i u e i ε u i k u 2 u e i k u 3 γ u i u e i w u i t θ z u u e i w u i t θ z u ρ u i w u i t w u i k u 1 γ u i 2 γ u i δ τ u i ε u i u e i k u 2 u e i 2 k u 3 u e i γ u i u e i 2 u e i w u i t θ z u u e i w u i t θ z u ρ u i w u i t w u i k u 1 γ u i 2 γ u i δ τ u i k u 2 u e i 2 u e i 2 k u 1 γ u i 2 ρ u i w u i t w u i k u 3 u e i γ u i γ u i δ τ u i ε u i u e i using the young s inequality one has 79 u e i ε r i 1 2 u e i 2 1 2 ε u i 2 1 2 u e i 2 1 2 ε u i 2 80 k u 3 u e i γ u i 1 2 k u 3 u e i 2 1 2 k u 3 γ u i 2 81 γ u i δ τ u i 1 2 γ u i 2 1 2 δ τ u i 2 by virtue of assumption 4 one gives 82 ρ u i w u i t w u i ρ u i 2 w u i 2 w u i 2 substituting 79 80 81 and 82 into 78 yields 83 v u i k u 2 u e i 2 u e i 2 k u 1 γ u i 2 ρ u i 2 w u i 2 w u i 2 1 2 k u 3 u e i 2 1 2 k u 3 γ u i 2 1 2 γ u i 2 1 2 δ τ u i 2 1 2 u e i 2 1 2 ε u i 2 k u 2 u e i 2 u e i 2 1 2 k u 3 u e i 2 1 2 u e i 2 k u 1 γ u i 2 1 2 k u 3 γ u i 2 1 2 γ u i 2 ρ u i 2 w u i 2 ρ u i 2 w u i 2 1 2 δ τ u i 2 1 2 ε u i 2 k u 2 1 2 1 2 k u 3 u e i 2 k u 1 1 2 k u 3 1 2 γ u i 2 ρ u i 2 w u i 2 ρ u i 2 w u i 2 1 2 δ τ u i 2 1 2 ε u i 2 μ u i v u i c u i where 84 μ u i min k u 2 1 2 1 2 k u 3 k u 1 1 2 k u 3 1 2 min ρ u i λ max u γ u i 1 85 c u i 1 2 ρ u i w u i 2 ε u i 2 δ τ u i 2 where λ max u represents the maximum eigenvalue of γ u i 1 furthermore to guarantee positive of the 84 control gains k u 2 k u 2 and k u 3 should be selected to satisfy 86 2 k u 1 1 k u 3 0 2 k u 2 1 k u 3 0 according to lemma 3 the following inequality is given by 87 v u i t v u i 0 e μ u i t c u i μ u i 1 e μ u i t t 0 from the inequality 87 it is implied that the proposed surge velocity control can be achieved by choosing reasonable parameters 4 2 heading control define the tracking error of the yaw angle ψ i and yaw angular velocity r i as 88 ψ e i ψ i ψ d i 89 r e i r i r d i where ψ d i atan 2 y d i x d i and r d i is a virtual signal governed by 90 r d i k v ψ e i ψ d i where k v 0 differentiating 88 yields 91 ψ e i r i ψ d i differentiating both sides of 89 along 67 yields 92 r e i φ r i τ r i d r i r d i to simplify the presentation uncertainties are defined as below 93 ϕ r i φ r i d r i r d i r e i substituting 93 into 92 one has 94 r e i ϕ r i τ r i r e i the other rbf nn observer is designed to approximate the ϕ r i and one has 95 ϕ r i w r i t θ z r ε r i where ϕ r i is the estimate of ϕ r i ε r i ε r i and w r i is an adaptive weight parameter and its estimate can be designed as 96 w r i γ r i r e i θ z r ρ r i w r i where γ r i and ρ r i are positive constants w r i t w r i t w r i t furthermore the other compensator is proposed to resolve the input saturation in yaw as follows 97 γ r i k 1 γ r i δ τ r i where k r 1 0 and δ τ r i τ r i τ r i thus a heading control law is formulated based on the rbf nn observer 95 and the input saturation compensator 97 as follows 98 τ r i k r 2 r e i ψ e i w r i t θ z r k r 3 γ r i where k r 2 0 and k r 3 0 are control gains consider the lyapunov function 99 v r i 1 2 ψ e i 2 1 2 r e i 2 1 2 γ r i w r i t w r i 1 2 γ r i 2 taking the time differentiation of 99 yields 100 v r i ψ e i ψ e i r e i r e i w r i t w r i γ r i γ r i substituting 94 95 96 97 98 and 99 into 100 yields 101 v r i ψ e i ψ e i r e i r e i w r i t w r i γ r i γ r i ψ e i r i ψ d i r e i ϕ r i τ r i r e i w r i t r e i θ z r ρ r i w r i γ r i k r 1 γ r i δ τ r i ψ e i r e i k v ψ e i r e i w r i t θ z r ε r i k r 2 r e i ψ e i w r i t s z r k r 3 γ r i r e i w r i t r e i θ z r ρ r i w r i γ r i k r 1 γ r i δ τ r i ψ e i r e i k v ψ e i 2 k r 2 r e i 2 r e i ε r i k r 3 r e i γ r i r e i ψ e i r e i 2 r e i w r i t θ z r r e i w r i t θ z r ρ r i w r i t w r i γ r i k r 1 γ r i γ r i δ τ r i k v ψ e i 2 k r 2 r e i 2 r e i 2 r e i ε r i k r 3 r e i γ r i ρ r i w r i t w r i k r 1 γ r i 2 γ r i δ τ r i using the young s inequality one has 102 r e i ε r i 1 2 r e i 2 1 2 ε r i 2 1 2 r e i 2 1 2 ε r i 2 103 k r 3 r e i γ r i 1 2 k r 3 r e i 2 1 2 k r 3 γ r i 2 104 γ r i δ τ r i 1 2 γ r i 2 1 2 δ τ r i 2 by virtue of rbf nn one gives 105 ρ r i w r i t w r i ρ r i 2 w r i 2 w r i 2 substituting 102 103 104 and 105 into 101 yields 106 v r i k v ψ e i 2 k r 2 r e i 2 r e i 2 r e i ε r i k r 3 r e i γ r i ρ r i w r i t w r i k r 1 γ r i 2 γ r i δ τ r i k v ψ e i 2 k r 2 r e i 2 r e i 2 k r 1 γ r i 2 1 2 r e i 2 1 2 ε r i 2 1 2 k r 3 r e i 2 1 2 k r 3 γ r i 2 ρ r i 2 w r i 2 w r i 2 1 2 γ r i 2 1 2 δ τ r i 2 k v ψ e i 2 k r 2 r e i 2 r e i 2 1 2 r e i 2 1 2 k r 3 r e i 2 k r 1 γ r i 2 1 2 γ r i 2 1 2 k r 3 γ r i 2 1 2 ε r i 2 ρ r i 2 w r i 2 w r i 2 1 2 δ τ r i 2 k v ψ e i 2 k r 2 1 2 1 2 k r 3 r e i 2 k r 1 1 2 1 2 k r 3 γ r i 2 ρ r i 2 w r i 2 1 2 ε r i 2 ρ r i 2 w r i 2 1 2 δ τ r i 2 μ r i v r i c r i where 107 μ r i min k v k r 2 1 2 1 2 k r 3 k r 1 1 2 1 2 k r 3 min ρ r i λ max r γ r i 1 108 c r i 1 2 ε r i 2 ρ r i w r i 2 δ τ r i 2 where λ max r represents the maximum eigenvalue of γ r i 1 furthermore to guarantee positive of the 107 control gains k r 1 k r 2 and k r 3 should be selected to satisfy 109 2 k r 1 1 k r 3 0 2 k r 2 1 k r 3 0 according to lemma 3 the following inequality is given by 110 v r i t v r i 0 e μ r i t c r i μ r i 1 e μ r i t t 0 from the inequality 110 it is implied that the adaptive path following performance of heading control can be achieved by choosing reasonable parameters 5 stability analysis of the closed loop system theorem 1 consider a crowded uuv swarm in 4 5 and 67 in the presence of uncertainties and input saturation under the bio inspired consensus sub controller 32 and the fuzzy potential field sub controller 50 and the path following controllers 75 and 98 with nn based adaptive laws 73 and 96 and together with input saturation compensators 74 and 97 a decentralized adaptive flocking control design can guarantee following properties i all tracking error signals 26 61 68 88 and 89 in the closed loop system are uniformly ultimately bounded and ii the uuv swarm can track the desired path while avoiding collision and preserving connection proof consider a lyapunov function for the entire closed loop system as follows 111 v s v 1 1 2 x e 2 y e 2 i 1 n v u i v r i taking the time differentiation of 111 along errors 26 61 68 88 and 89 is expressed as 112 v s v 1 x e λ x e ψ d y e y e u sin ψ e ψ d x e i 1 n v u i v r i ϒ t ϒ λ x e 2 u y e sin ψ e i 1 n v u i v r i let ψ e ψ r ψ d and the following equation 113 can be deduced from 27 113 sin arctan y e δ y e y e 2 δ 2 substituting 113 into 112 yields 114 v s ϒ t ϒ λ x e 2 u y e 2 y e 2 δ 2 i 1 n v u i v r i for each l 0 0 and y e l 0 one gives wang et al 2020 115 χ y e u l 0 2 δ 2 χ such that substituting 114 into 112 yields 116 v s ϒ t ϒ λ x e 2 χ y e 2 i 1 n v u i v r i substituting 83 and 101 into 116 one has 117 v s ϒ t ϒ λ x e 2 χ y e 2 i 1 n μ r i v r i μ u i v u i i 1 n c r i c u i by virtue of lemma 3 one can obtain 118 v s μ s v s c s where μ s min 1 λ χ i 1 n μ r i i 1 n μ u i and c s i 1 n c r i c u i thus it can be concluded that all error signals in the closed loop system are uniformly ultimately bounded this concludes the proof remark 5 the guidance on how to choose the control parameters is shown as follows i ω i and r in bio inspired consensus relate to an optimal neighbor set which determines the computational burden generally these parameters satisfy 0 ω i π 2 and 6 r 8 ii ς r m ς a m and ς a c m in the bounded fuzzy potential functions related to the collision avoidance and connectivity preservation can be suitably chosen according to the number of fuzzy rules and the accuracy of sensors equipped on uuv iii k r 1 and k u 1 in the velocity and heading controls affect the compensated rates of saturated inputs and k r 2 k r 3 k u 2 and k u 3 relate to the control inputs all of which should be chosen as positive constants and satisfy 86 and 109 to guarantee stability of the proposed method 6 simulation studies in this section simulation results are provided to illustrate the effectiveness and robustness of the proposed decentralized flocking control for the crowded uuv swarm consider a swarm n 50 consisting of 49 followers and one leader to shape a formation where the uuv model is adopted from shaanxi normal university and its normal parameters are identified by particle filter liang and kang 2015 the normal parameters for each uuv are given as follows m 11 25 8 m 22 33 8 m 33 2 76 m 23 m 32 1 01 m 12 m 21 m 13 m 31 0 d 11 8 8065 20 u d 22 65 5457 70 v d 33 6 7352 20 r d 23 d 32 2 5 5 5 v 5 3 r and d 12 d 21 d 13 d 31 0 the model uncertainty is assumed as δ η v δ m v δ c v v δ d v v 0 35 0 1 u 2 0 1 r 2 sin v t in addition external disturbances n t caused by winds waves and ocean currents in earth fixed frame e are assumed as wang et al 2020 119 n t t d n t k d f d where t d d i a g 100 100 100 denotes the time constant matrix k d d i a g 10 5 6 denotes the gain matrix and f d denotes white noise whose largest amplitude is f d 1 then w t affecting on uuv in body fixed frame b can be formulated by w t j ψ t n t meanwhile saturation limits of both inputs are illustrated in table 2 the number of fuzzy set for two inputs d i j 2 c and d i j r 1 is given by m 5 and the whole number of fuzzy rules is l 5 2 where the fuzzy membership function is defined by o 1 2 5 and σ 1 1 the designed parameters for collision avoidance and connectivity preservation are selected as ς r m 8 ς a m 10 ς a c m 12 s 10 r 2 8 r 2 4 c 0 4 ω π 3 and r 8 liang et al 2021a an rbf nn composed by 50 neurons is employed to approximate uncertainties where a center o 2 i is distributed evenly in range 1 1 1 1 0 5 0 5 1 1 1 1 0 5 0 5 and its variance σ 2 i is set as 6 and w i u 0 w i u 0 0 the parameters of weight updating law given by 73 and 96 are chosen as γ i u γ i r 100 i 36 and ρ r i ρ u i 2 furthermore all parameters of input saturation compensators given by 74 and 97 are chosen as k r 1 k u 1 6 in addition all parameters of adaptive nn controllers given by 75 and 98 are chosen as 2 k r 2 2 k u 2 10 and k r 3 k u 3 10 6 1 closed loop performance to demonstrate the proposed decentralized flocking scheme two cases are considered i e straight line and curve line in the closed loop performance case 1 the desired path is generated by η d 2 θ 15 and η d 0 15 m 15 m 0 rad the initial position x i y i and heading angle ψ i of uuvs are randomly generated within the box 0 50 m 0 50 m and interval π r a d π r a d respectively and corresponding initial velocities are uniformly set as v i u i v i r i t 0 furthermore the desired velocity of this swarm is defined as v d 2 m s toward the desired path case 2 the desired path is generated as follows i 0 t 20 η d 1 2 θ 2 θ ii 20 θ 25 η d 2 θ h 2 sin 2 θ ϖ 2 h 2 2 ϖ 2 350 iii 25 θ 32 η d 3 60 2 θ iv 32 θ 40 η d 4 θ h 4 sin 2 θ ϖ 4 h 4 8 ϖ 4 500 v 40 θ 48 η d 5 θ h 5 sin 2 θ ϖ 5 h 5 18 ϖ 5 400 and vi θ 48 η d 2 θ 0 75 θ the initial position x i y i and heading angle ψ i of uuvs are randomly generated within 0 50 m 0 50 m and interval π r a d π r a d respectively and initial velocities are uniformly set as v i u i v i r i t 0 furthermore a desired velocity of this swarm is defined as v d 4 m s toward the desired path the simulation results of flocking motion for case 1 are illustrated in fig 5 fig 5 a shows the initial pattern under the interactive topology which is assumed as a spanning tree where the leader uuv marked by black circle can receive the desired path marked by red circle while other uuvs marked by green circle are followers and the cof is marked by blue circle and all neighbor links are solid line fig 5 b depicts motion trajectories of crowded uuv swarm in which the curves of cof and desired path are coincident fig 5 c plots the final pattern in which each uuv can be synchronized within a finite time and a marked arrow denotes its velocity from fig 5 b and fig 5 c it is observed that the proposed bio inspired consensus can keep the swarm connected via an estimated cof position in addition distances between each pair of uuvs are demonstrated in fig 5 d in which the minimum distance d min 0 95 is larger than 2 c 0 8 and the maximum distance d max 9 8 is smaller than s 10 both d min and d max remian invariable during the tracking process which implies that no collisions or splits occur consequently it can be seen that the proposed flocking control can guarantee the collision avoidance and connectivity preservation in the presence of uncertainties and input saturation fig 6 a and b demonstrate the performance of surge velocities and heading angles of uuvs respectively fig 6 c depicts the force τ u and moment τ r about the leader and the 28th follower all of which converge in a finite time and do not exceed the saturation limits given in table 2 fig 6 d shows norm of neural weights for surge control and heading control provided by adaptive laws respectively all of which are bounded it is observed that uncertainties can be approximated by rbf nn technique and the actual and estimated uncertain dynamics are shown in fig 6 e at last both along tracking and cross tracking errors in fig 6 f can converge to a small value close to zero which implies the universal applicability and effectiveness of the proposed scheme for the crowded uuv swarm the simulation results for case 2 are illustrated in fig 7 and fig 8 it can be observed that the proposed decentralized flocking is capable of tracking the curve path while guaranteeing collision avoidance and connectivity preservation for crowded uuv swarm and has outstanding robustness against uncertainties and external disturbances 6 2 comparative results to evaluate the transient and steady state performance model based method lu et al 2018 learning based method jafari et al 2017 and sliding mode control wang et al 2020 are employed to make comparative experiments and the number of repeated number is 50 times for two cases in which the integral of absolute error iae and maximum absolute error mae are employed i e 120 i a e x y 0 t 1 e x e y d t 121 m a e x y max max e x max e y where t 1 represents the total tracking time the two indicators are used to evaluate the transient and steady state performance in addition an average computational time act is introduced to describe computational burden for the good performance the smaller iae mae and act values are the more adaptive and robust effectiveness is all results are provided in figs 9 and 10 and average results of the entire flocking are shown in table 3 in figs 9 and 10 it can be observed that both cross tracking and along tracking errors of four methods all converge to zero however the convergence efficiency of the proposed method is faster than that of others especially for model based method i e both of tracking errors converging to zero is about t 20s by the proposed method while the time taken by model based method is about t 50s it indicates that the proposed controller is more robust owing to a stronger capability against uncertainties which can improve the stability of flocking system from the perspective of iae and mae in table 3 the mae value of model based method is much bigger than that of others in two cases it is also evident that its slower response speed can cause greater error accumulation in the tracking period by contrast iae and mae values of the proposed method are the smallest which implies that disturbances are successfully rejected by great transient and steady state performance in addition with regard to the computational burden the act of the proposed method is smaller compared with others this is because the bio inspired consensus provides an optimal neighbor set with optimal distribution as a consequence it is clear that the flocking control scheme developed using bio inspired consensus fuzzy potential field and adaptive nn technique outperforms other approaches for crowded uuv swarm in the presence of uncertain parameters and input saturation 7 conclusion in this paper a decentralized adaptive flocking control scheme with collision avoidance and connectivity preservation was addressed for crowded uuv swarm in spite of uncertainties and input saturation using bio inspired consensus and fuzzy potential field a flocking controller with leader follower pattern was proposed at the kinematic level in which one of the most important elements was an estimate of cof position to keep the swarm connected to reflect more realistic situation an adaptive path following tracking controller was developed to track desired surge velocity and heading at the kinetic level in which nns were employed to approximate uncertainties and an additional control term was introduced to handle the input saturation problem the simulation results showed the superior performance of the proposed scheme for tracking the desired straight and curve line paths the promising directions of future research will include the extension to the time delaying flocking control guided by multiple desired paths peng et al 2021 especially with the joint effects of directed topology and communicating delay for three dimension oceanic environment wang et al 2020 credit authorship contribution statement hongtao liang conceptualization methodology software visualization writing original draft preparation writing review editing validation hui cao writing review editing yanfang fu data curation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the financial support from the natural science foundation of shaanxi under grant 2019jq 026 and fundamental research funds for central universities under grant gk202103014 and the authors would like to thank all reviewers and editors who provided the extensive invaluable comments and suggestions appendix a table 4 notation table 4 symbol description η x y ψ position vector in surge sway and yaw v u v r velocity vector in surge sway and yaw w w u w v w r disturbance of surge sway and yaw in earth fixed frame b τ τ u 0 τ r surge force sway force and yaw moment δ input of saturated function τ max τ min saturation limits j ψ transformation matrix m nominal inertia matrix c nominal coriolis matrix d nominal damping matrix n swarm size n i neighbor set of the i th uuv n i 0 initial neighbor set of the i th uuv d i lumped unknown of the i th uuv d i j euclidean distance of the i th uuv and the j th uuv ζ i c estimated cof position of the i th agent ζ c average position of the entire system s communicating radius c collision avoidance radius ω blindness sector r sector number v n 1 n 2 n n node set of graph g v e e i j n i n j v edge set of graph g v e l laplacian matrix a adjacency matrix x x 1 x 2 x m input vector in fuzzy logic system y y 1 y 2 y m output vector in fuzzy logic system f j i input fuzzy set in the j th dimension of the i th fuzzy rule q k i fuzzy set in the k th dimension of the i th fuzzy rule ϖ f j i output membership function for the input fuzzy set l fuzzy rule number ξ x fuzzy basis function vector y overall output of fuzzy logic system θ z activation vector of inputs l nn mode number w nn weighting w optimal nn weighting ε approximation error ε optimal approximation error η d x d θ y d θ ψ d θ generalized position of desired path θ independent variable of desired path ψ d θ path tangential angle η a x a y a ψ a t cof position of the entire system u u 2 v 2 velocity of cof ψ r approach angle δ look ahead distance x e y e along tracking and cross tracking errors u d i desired velocity for the i th uuv ψ d i desired heading angle for the i th uuv η c η 1 c η 2 c η n c estimated cof vector of all the individual uuvs η η 1 η 2 η n t positions vector of all the individual uuvs λ min minimum eigenvalue λ max maximum eigenvalue u r repulsive potential field function f r repulsive force u a attractive potential field function f a attractive force u a c attractive potential field function between uuv and its cof f a c attractive force between uuv and its cof u 1 a c attractive potential field function between leader uuv and desired path f 1 a c attractive force between leader uuv and desired path q overall potential functions in the uuv swarm f i overall forces of the i th uuv p d x d y d positions of desired path in surge and sway v swarm velocity v d desired velocity of swarm p a x a y a cof positions in surge and sway p e tracking error j η jacobian matrix n disturbances in earth fixed frame e 
20282,this paper investigates a decentralized adaptive flocking control for crowded unmanned underwater vehicle uuv swarm in the presence of uncertainties and input saturation consider a realistic model of small size and low cost uuv with limited communication it is assumed that only one uuv can access global information desired path and each uuv only communicates with its neighbors to keep all uuvs connected in a crowded swarm the center of flocking cof of each uuv is identified using bio inspired consensus thereby a leader follower flocking controller is proposed to guarantee the collision avoidance and connectivity preservation with bounded fuzzy potential fields at the kinematic level an adaptive neural networks nns controller is further developed to track the desired path where an additional control term is incorporated to handle input saturation at the kinetic level stability analysis demonstrated that all closed loop signals are uniformly ultimately bounded the main contributions of this paper are three folded i a decentralized algorithm without a prior connectivity assumption on a directed spanning tree is proposed ii collision avoidance and connectivity preservation can be achieved simultaneously iii an adaptive controller which is robust against model uncertainties and disturbances is developed simulation results illustrate the effectiveness of the proposed approach keywords unmanned underwater vehicle decentralized flocking control bio inspired consensus fuzzy potential function neural network 1 introduction unmanned underwater vehicle uuv has played an important role in monitoring exploration surveillance exploitation and military applications over the past decades sahoo et al 2019 yao et al 2020 saback et al 2020 it can hardly be to accomplish some specific activities with one single uuv and therefore a flocking operation on a large scale group of small size and low cost uuvs becomes a promising solution sahu et al 2018 liu et al 2019 however due to the constraints imposed by size and cost communicating capability on these uuvs is generally limited liang et al 2021a to deal with this issue a flocking control of crowded uuv swarm has aroused compelling interest in the last few years sahu et al 2018 liu et al 2019 liang et al 2020b 2021a 2021b peng et al 2019a b decentralized flocking control is a self organized pattern of a group swarm by local interactions with each agent s neighbors and environment which is inspired from the fascinating behaviors in natural phenomena i e aggregation rendezvous tracking and cohesion boyd et al 2006 reza 2006 ohshirazi et al 2017 liang and qiang 2020b liang et al 2021a numerous studies have been developed to address the decentralized flocking control problem generally these can be divided into three categories leader following pattern yuan et al 2019 cui et al 2010 li et al 2021 liang et al 2021b virtual structure makavita et al 2019 and behavior based approach lyons et al 2015 cifuentes et al 2015 among them the leader following pattern where all followers can reach a consensus on the desired or actual leader s position cheng et al 2010 has attracted considerable attention due to its simplicity and practicality many representative breakthroughs about leader following for uuvs have been reported for instance a leader follower formation control of multiple underwater vehicles method was reported cui et al 2010 in which each follower tracked its reference trajectory based on leader position for a formation along the straight line path a leader follower tracking scheme was designed and an incorporated controller was given with the aim of separating tasks into position tracking and orientation parts loria et al 2016 additionally the case of multi leaders was also investigated dong and hu 2017 existing works mainly focused on the fixed formation or fixed number of neighbors jing and wang 2020 in which all followers were assumed to know the full global information and all the rest neighbors however due to the limited communication bandwidth and range each uuv can only obtain partial information i e only one informed uuv can access global information and each uuv can only communicate with its neighbors to this end several formation controllers based on velocity estimation were designed gustavi and hu 2008 for example a formation controller without measurement of the leader s velocity was designed such that communication between vehicles was not required liang et al 2020a b nevertheless these works maintain a fixed configuration where the self organized ability is not fully considered it is obvious that some works concerning the flocking control is based on the assumption that communication links are a directed topology in the practical environment the topology related to crowded uuv swarm should be an undirected graph that is established randomly due to its limited communication and external disturbance in boyd et al 2006 a flocking algorithm was reported that can be robust against changes in gossip communication in which neighbors were randomly chosen in silvestre et al 2019 a distributed algorithm was devised for a bidirectional communication graph in which the rate of convergence can be achieved to an average consensus based on this several works related to undirected graph and topology i e asymmetric communication ribeiro et al 2021 and decentralized structure ribeiro et al 2020 have been reported although the above mentioned works can achieve consensus with respect to an average mechanism in flocking more consensus inspired by the non average mechanism can be utilized to guide flocking effectively with reducing the computation burden and increasing the rate of convergence liang et al 2021a from a more practical point of view collision avoidance is a particularly challenging topic peng et al 2021 ribeiro et al 2020 existing techniques for collision avoidance can be roughly divided into two methodologies i e desired formation switching and potential field strategy park and yoo 2019 due to easily triggered oscillatory behaviors information switching more attention has been paid to collision avoidance using potential field strategy where each agent follows a gradient direction of the potential field generated by the sum of all virtual attractive and repulsive forces as a landmark work olfati saber and murray 2004 a distributed flocking algorithm based on the smooth potential field was proposed where rigorous stability was firstly provided based on this several mathematics based liang and qiang 2020b yuan et al 2019 and fuzzy based gu and wang 2019 chen et al 2015 works have been provided to address collision avoidance in flocking control more recently the fuzzy basis function for potential fields is a well studied topic sahu and subudhi 2018 wang et al 2020 qiu et al 2020 however some mentioned works suffered from two major limitations as follows i existing potential field functions are unbounded which generate infinite forces liang et al 2021a and ii connectivity property is not fully considered shi et al 2019 clearly it is challenging to satisfy collision avoidance and connectivity preservation simultaneously for a uuv swarm in a distance dependent communicating network liang et al 2021a jing and wang 2020 shi et al 2019 it is of great interest to note that uuvs in some works are assumed to have deterministic dynamics sahu et al 2018 liang et al 2021a liang and qiang 2020b makavita et al 2019 luo et al 2010 gu and wang et al 2019 however in practical applications uncertainties are inevitable due to high nonlinearity peng et al 2021 imprecise measurements chen et al 2020 and external disturbances li et al 2019 which severely deteriorate control performance this adverse effect has further exacerbated for small size and low cost uuvs makavita et al 2019 chen et al 2020 for example a low cost uuv generally has little or no access to hydrodynamic testing facilities makavita et al 2019 and a smaller mass of uuv makes it more susceptible to external disturbances chen et al 2020 besides most uuvs are underactuated which means that the number of actuators is less than the freedom degrees of movement such that the input saturation problem is easily triggered due to this nonlinear dynamics yao et al 2020 peng et al 2021 bechlioulis et al 2017 consequently it is challenging to address uncertainties and input saturation for the uuv swarm to guarantee stabilization and robustness under uncertainties several methods are available with varying degrees of effectiveness such as backstepping control cui et al 2010 yan et al 2019 sliding mode control liu et al 2019 xu et al 2015 model predictive control mpc yao et al 2020 li et al 2017 neural network control hou et al 2009 liu et al 2019 shi et al 2019 liang et al 2020c 2021b ma et al 2021 extended state observer peng et al 2019a b and fuzzy control wang et al 2020 qiu et al 2020 liang et al 2019 xiang et al 2017 liang et al 2018 among these techniques adaptive nn control is one of the most promising tools to improve performance under uncertainties and disturbances aryankia and selmic 2021 zhu et al 2021a 2021b 2021b park et al 2017 nevertheless some works fail to deal with input saturation shi et al 2019 li et al 2017 liang et al 2020a b peng et al 2019a b liang et al 2019 due to limited physical structure thrusters and rudders may exceed constraints of the maximum forces and moment which degrades control performance and even triggers instability consequently it is of critical importance to address this input saturation problem existing approaches include mpc li et al 2017 barrier lyapunov functions blf gavilan et al 2014 and auxiliary compensator cheng et al 2019 zhou and wen 2006 nie and lin 2020 looking at the above literature mpc requires an accurate dynamic model and blf only considers the upper bound of constraints both of which are quite difficult in practice therefore the auxiliary compensator is the most promising direction an auxiliary system was first proposed for uncertain nonlinear systems zhou and wen 2006 in addition an auxiliary compensator to address input saturation was proposed for the marine surface vessel nie and lin 2020 nevertheless it is noteworthy that few works on the input saturation problem in uuv swarm using auxiliary compensator have been considered motivated by the above observations this paper investigates the decentralized flocking control problem for crowded uuv swarm with uncertainties and input saturation it is considered that only one uuv can access global information and each uuv only communicates with its neighbors the center of flocking cof for each uuv is identified using bio inspired consensus to keep uuvs connected in a crowded flock with the aid of cof a leader following flocking controller is proposed employing bounded fuzzy potential fields to avoid collision and preserve connectivity at the kinetic level moreover an adaptive path following tracking controller is developed to track the desired surge velocity and heading angle in which nns are devised to approximate uncertainties and an additional control term is designed to deal with input saturation finally all error signals can be reduced as small as desired by selecting appropriate parameters according to theoretical analysis the main contributions of this paper are summarized as follows 1 different from the existing leader following works involved with a directed spanning tree cui et al 2010 this paper introduces a decentralized leader following flocking control under undirected topology for crowded uuv swarm where each uuv obtains global information from its neighbors thereby providing more flexibility and expandability 2 to keep uuvs connected in a crowded swarm the cof information is estimated via a novel bio inspired consensus with the minimum number of neighbors and their optimal spatial distribution rather than a fixed number of neighbors or distance liang et al 2021a a bounded fuzzy potential field strategy is subsequently developed to keep the flocking without any potential splits and collisions 3 an adaptive nn controller is devised for uuv subject to uncertainties and disturbances in which a saturation compensator is designed to handle the input saturation problem furthermore it is proved that all closed loop signals are uniformly ultimately bounded with a great convergence in comparison to the existing works the rest of this paper is organized as follows section 2 introduces preliminary knowledge and problem formulation section 3 provides the decentralized leader follower flocking controller section 4 presents the adaptive tracking controller section 5 gives the stability analysis section 6 illustrates simulation results finally section 7 concludes this paper and discusses the future work it is noted that every notation used to indicate parameter throughout this paper is listed in appendix a 2 preliminary knowledge and problem formulation 2 1 uuv model the kinematics and dynamics of an undersaturated uuv are formulated in two coordinate frames namely earth fixed frame e and body fixed frame b as illustrated in fig 1 consider a crowded uuv swarm composed of n agents in the horizontal plane the model of the i th uuv can be described as fossen 2011 1 η i j ψ i v i m i v i c i v i v i d i v i v i τ i w i where η i x i y i ψ i t ℝ 3 is a vector of position and yaw angle in earth fixed frame respectively v i u i v i r i t ℝ 3 is a velocity vector in surge u i sway v i and yaw r i in body fixed frame m i ℝ 3 3 c i ℝ 3 3 and d i ℝ 3 3 are the inertia matrix coriolis matrix and damping matrix respectively w i w i u w i v w i r t ℝ 3 denotes the external disturbance τ i τ u i 0 τ r i t ℝ 3 is a control input vector consisting of surge force sway force which is zero due to the undersaturation and yaw moment in real applications the control force or moment is subject to physical magnitude thrusters therefore a real input vector can be determined by a saturated function with an input δ j as follows 2 τ i sat δ j τ j max i f δ j τ j max δ j i f τ j min δ j τ j max τ j min i f δ j τ j min j u r where τ j max and τ j min are derived from magnitude constraints of the rotational speed of propeller and the deflection angle of rudder respectively both of which are known in addition j ψ i is a transformation matrix given by 3 j ψ i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 suffering from uncertainties i e unmodelled dynamics and parametric perturbations a precise model is difficult to be obtained such that each matrix can be divided into the nominal part and shift part i e m i m i δ m i c i c i δ c i and d i d i δ d i where i represents the nominal parameter and δ i denotes a shifted difference between the real and nominal parameters therefore considering model uncertainties and external disturbance the dynamics 1 can be formatted as 4 m i v i c i v i v i d i v i v i τ i d i where d i δ m i v i δ c i v i v i δ d i v i v i w i then the i th uuv s model can be modified as 5 x i x i cos ψ i v i sin ψ i y i x i sin ψ i v i cos ψ i ψ i r i 6 u i 1 m 11 m 22 v i r i d u d u u u i u i τ u i d u i v i 1 m 22 m 11 v i r i d v d v v v i v i τ v i d v i r i 1 m 33 m 11 m 22 v i r i d r d r r r i r i τ r i d r i assumption 1 the external disturbance w i w u i w v i w r i t and its derivative are bounded 7 w i t w i where w i is a positive constant assumption 2 the velocities of surge and yaw angle are bounded while the velocity of sway is passive bounded in sense that wang et al 2019 8 sup t 0 v i v i m where v i m is a positive constant remark 1 it is clearly noted that the lumped unknown d i is essentially a sum of all uncertainties with unmodelled dynamics parametric perturbations and the external disturbances 2 2 bio inspired consensus approach it has been reported that center of flocking cof information is useful for keeping the flock connected where each agent with this information can guarantee connections with others by moving toward cof sahu and subudhi 2018 therefore a consensus was proposed in gu and wang 2009 liang et al 2020a b to estimate the cof position of the i th agent as follows 9 ζ i c j n i ζ i c ζ j c ζ i c ζ i where ζ i c denotes the estimated cof position of the i th agent ζ i is the position of the i th agent and n i is the neighbors of the i th agent in addition an average position attached to coordinates of the entire system ζ c is defined as 10 ζ c 1 n i 0 n ζ i where n is the number of agents in a flocking by virtue of 9 and 10 agents with different initial positions and velocities can asymptotically converge to the desired trajectory then existing ζ i c ζ c however this consensus holds a prior neighbor assumption on fixed distance rule fdr in fact the neighbor number of each agent is large in a crowded swarm thereby the computation and communication may result in explosion if it is directly employed liang et al 2021a which leads to adverse effects on flocking control consequently inspired by visual attention mechanism a bio inspired interaction strategy based on nearest neighbor rule nnr was firstly designed in our previous works liang et al 2021a liang and qiang 2020 the essence of this strategy is to optimize neighbors for each agent with the minimum number and optimal distribution specifically its model for a crowded uuv swarm is exhibited in table 1 remark 2 the proposed interaction strategy has three folded advantages i it is a time varying and dynamic switching manner rather than the fdr in existing works which is more realistic ii it can consider some inherent properties i e limited view unlike most works in which a uuv is modelled as a particle with an omnidirectional view sahu and subudhi 2018 iii it can minimize the size of neighbor set with an optimal distribution which reduces the computation burden and increases the rate of convergence even providing more flexibility and expandability subsequently a bio inspired consensus approach will be given in section 3 1 by virtue of an optimized neighbor set it is convenient to model the interaction between agents by means of a graph g v e where a node from v n 1 n 2 n n corresponds to a uuv and an edge e i j n i n j v captures the dependence of interconnections between any pair uuvs suppose that no self loops exist i e n i n i e the laplacian matrix l t l i j ℝ n n is defined by l t d t a t with l i j t j 1 j i n a i j and l i j a i j i j where a t a i j ℝ n n corresponds to an adjacency matrix of g t with a i j 1 if n i n j v and a i j 0 otherwise and d t denotes a diagonal matrix for the sake of analyzing the following lemma and assumption are given as lemma 1 godsil and royle 2001 for an undirected connected g v e l is symmetrical and positive semi definite which satisfies 11 b t l b 1 2 i 1 n j n i a i j b i b j 2 where b b 1 b 2 b n for g v e and its minimum eigenvalue is zero with an associated eigenvector 1 1 1 t or l 1 0 0 0 0 t assumption 3 yang et al 2017 guo et al 2020 for an undirected g v e if an extended digraph g v e is given with v 0 1 n and e e e where node 0 denotes the leader and e represents interactions from the leader to the controlled agents then there exists a spanning tree from the leader as root note 2 3 bounded fuzzy potential field function in this paper to consider the limited power provided by small size and low cost uuv in practice a bounded fuzzy potential field function is employed to simultaneously address collision avoidance and connectivity preservation a fuzzy logic system can map an input x to a deterministic control y x which is expressed by a set of fuzzy rules for repulsive and attractive control functions 12 rule i i f x 1 is f 1 i x m is f m i then y 1 is q 1 i y m is q m i where x x 1 x 2 x m r m and y y 1 y 2 y m r m are input and output variables respectively f j i denotes an input fuzzy set in the j th dimension of the i th fuzzy rule j 1 2 m and i 1 2 l q k i denotes an output fuzzy set in the k th dimension of the i th fuzzy rule k 1 2 m and i 1 2 l in order to compute the fuzzy reasoning a max min operation of mandani chau et al 2020 is employed to calculate the output of overall fuzzy logic system thereby an overall membership function is considered as a single combined objective as follows 13 ϖ q k i y k max min ϖ f 1 i x 1 ϖ f 2 i x 2 ϖ f m i x m where ϖ f j i is a corresponding membership function for the input fuzzy set commonly a gaussian function is employed to describe ϖ f j i as follows 14 ϖ f j i exp x j ο 1 j i 2 2 σ 1 j i 2 where o 1 j i and σ 1 j i are the mean and variance respectively consequently a fuzzy basis function vector ξ x ξ 1 x ξ 2 x ξ m x t is defined by the center of gravity to obtain a single deterministic crisp value from all possible defuzzification subsets for each element ξ i x 15 ξ i x π i 1 m ϖ f j i x j i 1 l π i 1 m ϖ f j i x j then an overall output of fuzzy logic system is formulated 16 y q k t ξ x where q k q k 1 q k 2 q k m t lemma 2 gu and hu 2008 for any given nonlinear potential field function f x y if the gradient technique and lasalle s invariance principle are used then a control signal f x y deduced from fuzzy logic system is bounded 2 4 rbf neural network in this paper a radial basis function neural network rbf nn is employed to approximate the sum of uncertainties and disturbances due to its powerful approximation capacity with regard to a continuous function one h z r q r has 17 h z w t θ z ε z z ω r q where z r q is an input vector in a compact set ω z w r l denotes a weighting vector l is nn mode number and ε z is a bounded approximation error satisfying ε ε where ε 0 for all z ω z generally an rbf nn can approximate any continuous function h z to any arbitrary degree of accuracy as 18 h z w t θ z ε z ω r q where w is an optimal weight vector and it is defined as 19 w arg min w r l sup z ω z h z w t θ z where θ z θ 1 z θ 2 z θ l z r l is an activation vector of inputs which is given by 20 θ i z exp z ο 2 i t z ο 2 i σ 2 i 2 i 1 2 l where ο 2 i and σ 2 i are the center and variance of the i th basis function respectively it is worth emphasizing that w and ε are unknown constants both of which are only used for stability analyzing for real applications w is used for function approximation and an estimate of h z can be given by 21 h z w t θ z where w can be estimated online by an adaptive law assumption 4 shi et al 2019 for w w and w w w the error can be formulated by 22 w t θ z w t θ z w t θ z 23 ρ w t w t ρ 2 w 2 w 2 where ρ is a positive constant 2 5 problem formulation in this paper consider that only one leader uuv can access the desired path while remaining uuvs as followers track this leader and each uuv only utilizes its neighbors information in a leader follower flocking consequently this flocking control problem is shifted into a tracking control problem which is depicted in fig 1 this desired path is generated by a time varying signal η d x d θ y d θ ψ d θ where θ r is a given independent variable and ψ d θ atan 2 x d θ y d θ is defined as path tangential angle let x a y a t r 2 be the cof position of the entire system thus tracking errors between the cof and desired path are described as 24 x e y e cos ψ d sin ψ d sin ψ d cos ψ d t x a x d y a y d where x e r and y e r denote along tracking and cross tracking errors respectively and by the aid of 10 the cof position is calculated as 25 η a x a y a ψ a t 1 n i 1 n η i let u u 2 v 2 denote the velocity of cof and taking the derivative of 24 along 5 as 26 x e u cos ψ e ψ d y e θ u d y e u sin ψ e ψ d x e where u d x d 2 y d 2 x d x d θ θ y d y d θ θ and θ u cos ψ e λ x e u d where λ 0 is a designing parameter define ψ e ψ r ψ d where ψ r is an approach angle given by 27 ψ r ψ d atan y e δ where δ is a look ahead distance to make tracking errors converge asymptotically both desired velocity and heading angle for the i th uuv are formulated as 28 u d i x d i 2 y d i 2 ψ d i atan 2 x d i y d i the objective of this paper is to design suitable control laws τ u i and τ r i such that a crowded uuv swarm can track η d while guaranteeing collision avoidance and connectivity preservation in the presence of uncertainties and input saturation and the tracking error η i η d can converge to a predefined bound specifically the objective is formulated as 29 lim t η i η d ω 0 30 lim t 2 c d i j s where ω 0 is a positive constant d i j x i x j 2 y i y j 2 denotes the distance between the i th uuv and j th uuv and c 0 associated with an open ball centred at the i th uuv denotes collision avoiding area and s 0 denotes the maximal communicating distance assumption 5 yao et al 2020 liu et al 2019 peng et al 2019a b wang et al 2020 the desired path η d x d y d is bounded and smooth and its first derivative is bounded assumption 6 wang et al 2020 the x e y e and ψ e are assumed to be nonzero to avoid the possible singularity problem lemma 3 ge and wang 2004 consider a smooth function v t and its initial state v 0 is bounded if there exists an inequality v t μ v c holding with c 0 and μ 0 for any time the following inequality can be obtained as 31 v t v 0 c μ exp μ t c μ 3 decentralized leader follower flocking controller in this section a decentralized leader following flocking controller is designed which consists of bio inspired consensus sub controller and bounded fuzzy potential field sub controller the former is devised for estimating cof information to keep the flocking connected and the latter is avaiable for collision avoidance and connectivity preservation both of which are shown in fig 2 3 1 bio inspired consensus sub controller in the leader following pattern a swarm composed of n uuvs is divided into one leader and n 1 followers motivated by the bio inspired interaction strategy in table 1 both the one leader and followers obtain state information in their optimized neighbor set n i t s i ω i r where the cof plays an important role to keep the swarm connected therefore a bio inspired consensus is designed here to estimate cof information for each uuv specifically a consensus for the i th uuv is defined as follows 32 η i c j n i η i c η j c η i c η i where η j c is the estimated cof position of the j th uuv and n i is the neighbor number of the i th uuv alternatively 32 can be rewritten into a compact vector format 33 η c l η c η c η where η c η 1 c η 2 c η n c t is a matrix generated by the estimated cof positions of all uuvs and η η 1 η 2 η n t is a matrix generated by positions of uuvs to achieve the objective 29 for tracking a desired path η c should asymptotically converge to η a i e 34 lim t η c η a and lim t η i c η i define an error between η c and the average position coordinate of uuvs η a v as follows 35 e η a v η c where η a v is 36 η a v 1 n ξ t η where ξ r n n is a matrix of all ones taking time derivatives of 35 along 32 one has 37 e η a v l η c η c η by virtue of lemma1 and assumption2 there exists l η c 0 and using η c η a v e then 37 yields 38 e 1 n ξ t η η η l i e due to uniformly bounded positions and velocities of uuvs there exists 39 1 n ξ t η η η r where r is a positive constant consider a positive definite function v 0 1 2 e t e such that 40 v 0 1 2 e t e e t 1 n ξ t η η η e t l i e due to connected graph g v e existing e t l 1 e λ min l i e 2 e 2 where λ min l i is the minimum eigenvalue of l i and by the aid of e t i n e then 40 can be derived as v 0 e 2 ϕ 0 e where ϕ 0 ℵ n by defining the set π e e v 0 e ϕ 0 2 2 the inequality is transformed into 41 v 0 e ϕ 0 2 2 ϕ 0 2 2 according to the lasalle invariance principle it is deduced that v 0 0 hence cof errors are globally asymptotically stable olfati saber and murray 2004 remark 3 the proposed bio inspired consensus uses an optimized neighbor set which can reduce computational burden and enhance the rate of convergence additionally it is essentially different from most existing consensus where the neighbor set is a fixed distance interaction gu and hu 2008 liang et al 2020a b 3 2 bounded fuzzy potential field sub controller let a fixed radius s denote the communicating region associated with the i th uuv in fig 3 this region is divided into four zones collision zone separation zone alignment zone and attraction zone all of which are to achieve collision avoidance and connectivity preservation the collision zone with radius c is assumed as a rigid body rather than a particle in yan et al 2017 the separation zone is a ring domain z c z η i r 1 in which each uuv avoids collision by virtue of a repulsive potential function the alignment zone is a bigger ring domain z r 1 z η i r 2 in which each uuv adopts the velocity alignment to track the desired path and an attraction zone is z r 2 z η i s where an attractive potential function can keep a uuv swarm connected clearly if d i j η i η j 2 c it is implied that the swarm has collided and if d i j s it means that the connectivity is broken consequently a desired zone for each individual is z r 1 z η i r 2 where i 1 2 n the label with i 1 denotes the one leader uuv and η i represents a negative gradient in addition η i u i r η i η j satisfies η i u i r η i η j η j u i r η j η i by the aid of fuzzy potential field functions 12 16 a fuzzy repulsive function is designed by a group of rules with two inputs d i j 2 c and d i j r 1 and one output u i r η i η j such that the total repulsive potential field forces of the i th uuv can be rewritten as follows 43 η i u i r η i η j m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς r m η i η j m 1 2 l where ς r m is a positive scale parameter of the m th rule in η i η j repulsive force ii an attractive potential function u i a η i η j is used for keeping a swarm without any splits which satisfies following properties a u i a η i η j is strictly increasing on r 2 s and approaches infinity when d i j s and b it is cut off at r 2 and its attractive force f i a is defined as follows 44 f i a j n i η i u i a η i η j where η i u i a η i η j η j u i a η j η i similarly a fuzzy attractive potential field function is designed by a group of rules with two inputs d i j s and d i j r 2 and one output u i a η i η j such that the total attractive potential field forces of the i th uuv can be rewritten as follows 45 η i u i a η i η j m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς a m η i η j m 1 2 l where ς a m is a positive scale parameter of the m th rule in η i η j attractive force iii an additional attractive potential field function u i a c η i η i c and its f i a c is formulated to avoid the swarm splits satisfying 46 f i a c η i u i a c η i η i c where f i a c denotes an attractive force between the i th uuv and its cof in the fuzzy logic system the input and output are defined as d i c η i η a and u i a c η i η i c respectively here an additional attractive force of the i th uuv is given by 47 η i u i a c η i η i c m 1 l ϖ f j m x 1 m m 1 l ϖ f j m x 1 m ς a c m η i η i c m 1 2 l where ς a c m is a positive scale parameter of the m th rule in η i η i c attractive force iv an additional attractive potential field function u 1 a c η 1 η d and its f 1 a c is formulated to describe the one leader knowing the desired path which satisfies 48 f 1 a c η 1 u 1 a c η 1 η d where f 1 a c denotes an attractive force between the leader uuv and desired path in the fuzzy logic system the input and output are defined as d 1 d η 1 η d and u 1 a c η 1 η d respectively here an attractive force of the leader uuv is given by 49 u 1 a c η 1 η d m 1 l ϖ f j m x 1 m m 1 l ϖ f j m x 1 m ς a c m η 1 η d m 1 2 l where ς a c 1 m is a positive scale parameter of the m th rule in η 1 η d attractive force hence an overall potential function for the crowded uuv swarm is represented by 50 q i 1 n j n i u i r u i a u i a c u 1 a c further the corresponding force with combining 42 44 46 and 48 for the i th uuv yields 51 f i j n i η i u i r η i η j j n i η i u i r η i η j η i u i a c η i η i c η 1 u 1 a c η 1 η d by virtual of lemma 2 the control signal derived from 51 is bounded as follows 52 j n i η i u i r η i η j j n i m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς r m η i η j n i m 1 l ς r m d i j ℓ 1 53 j n i η i u i a η i η j j n i m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς a m η i η j n i m 1 l ς a m d i j ℓ 2 54 η i u i a c η i η i c m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς a m η i η i c m 1 l ς a c m d i c ℓ 3 55 η i u 1 a c η 1 η d m 1 l ϖ f j m x k m m 1 l ϖ f j m x k m ς a m η 1 η d m 1 l ς a c 1 m d 1 d ℓ 4 where ℓ 1 ℓ 2 ℓ 3 and ℓ 4 are all positive constants furthermore it is easy to obtain that f i ℓ 1 ℓ 2 ℓ 3 ℓ 4 ℓ where ℓ is a positive constant remark 4 the overall potential function q works as an additional desired velocity term i e v d 0 k 1 q η where k 1 is a positive constant additionally v d 1 k 1 q η is bounded such that it can guarantee collision avoidance and connectivity preservation for crowded uuv swarm in this paper 3 3 flocking state feedback control design based on the two sub controllers a flocking state feedback control design is provided for uuv swarm to track the desired trajectory η d with a desired velocity v d motivated by liu 2015 a flocking function of crowded uuv swarm is determined by 56 p a j η v where p a x a y a t ℝ 2 n 1 j η ℝ 2 2 n represents the jacobian matrix satisfying 57 j η p a η p a 1 η t p a 2 η t t 58 p a 1 η 1 n 0 1 n 0 t p a 2 η 0 1 n 0 1 n t where v ℝ 2 n 1 denotes a vector of swarm velocity to guarantee the convergence of tracking errors asymptotically in 28 the desired velocity v d 1 is chosen as 59 v d 1 v d 1 τ v d 2 τ v d n τ τ j k p e p d where v d i x d i y d i t denotes the desired velocity of the i th uuv liang et al 2019 p d x d y d t ℝ 2 n 1 is given by η d x d θ y d θ ψ d θ j represents the pseudo inverse of j and satisfies j j t j j t 1 and j j i besides k d i a g k 11 k 22 recalling remark 4 the overall potential function q can provide an additional desired velocity term such that the total desired velocity of the entire uuv swarm can be rewritten as 60 v d v d 0 v d 1 k 1 q η j τ k p e j p d let cof tracking error dynamics be 61 p e p a p d e 1 e 2 t where e 1 x a x d e 2 y a y d consider a lyapunov like function 62 v 1 1 2 p e t κ p e k 1 q taking the time derivative of 62 along 61 and 24 one gives 63 v 1 p e t κ j η v p d k 1 q η substituting 60 into 63 yields 64 v 1 k 1 q η j t κ p e τ k 1 q η j t κ p e k 1 q η t j p d where ϒ k 1 q η j t κ p e and b k 1 q η t j p d is essentially a bounded parameter with respect to q η and p d then 64 can be obtained as follows 65 v 1 ϒ t ϒ b once collision avoidance and connectivity preservation can be achieved namely the desired zone for each individual is z r 1 z η i r 2 existing q η 0 i e b 0 then 65 becomes 66 v 1 ϒ t ϒ 0 consequently it is implied that v 1 0 can be guaranteed by designing the parameter k 1 thereby the proposed decentralized leader follower flocking controller can ensure stability conditions this concludes the proof 4 adaptive robust path following tracking controller to track the desired surge velocity and heading angle in 28 an adaptive robust path following controller is designed as fig 4 where rbf nns are employed to approximate uncertainties and auxiliary compensators are applied to handle input saturation problem due to the same design procedures for each uuv both surge velocity control and heading control for the i th uuv are designed to make tracking errors converge asymptotically the dynamics of 6 can be recalled and formulated as 67 u i φ u i d 11 m 11 u i τ u i d u i v i φ v i d v i r i φ r i τ r i d r i where φ u i 1 m 11 m 22 v i r i m 23 r i 2 φ v i 1 δ 1 m 23 2 m 11 m 22 m 22 m 23 m 11 m 23 u i r d 33 m 23 d 23 m 33 d 22 m 33 d 32 m 23 r i φ u i 1 δ 1 m 23 d 22 m 22 d 23 m 22 m 11 u i v i m 23 d 23 m 11 u i m 22 d 23 m 23 u i r i where δ 1 m 22 m 33 m 23 2 4 1 surge velocity control define the tracking error of surge velocity as 68 u e i u i u d i where u d i x d i 2 y d i 2 differentiating both sides of 68 along 67 one has 69 u e i φ u i d 11 m 11 u i τ u i d u i u d i to simplify the presentation uncertainties are defined as below 70 ϕ u i φ u i d 11 m 11 u i d u i u d i u e i substituting 70 into 69 yields 71 u e i ϕ u i τ u i u e i the rbf nn observer is designed to approximate ϕ u i and one has 72 ϕ u i w u i t θ z u ε u i where ϕ u i is the estimate of ϕ u i ε u i ε u i and w u i is an adaptive weight parameter and its estimate can be designed as 73 w u i γ u i u e i θ z u ρ u i w u i where γ u i and ρ u i are positive constants w u i t w u i t w u i t furthermore a compensator is proposed to resolve the input saturation in surge as follows 74 γ u i k u 1 γ u i δ τ u i where k u 1 0 and δ τ u i τ u i τ u i thus a yaw control law is formulated based on the rbf nn observer 72 and the input saturation compensator 74 as follows 75 τ u i k u 2 u e i w u i t θ z u k u 3 γ u i where k u 2 0 and k u 3 0 consider the lyapunov function 76 v u i 1 2 u u i 2 1 2 γ u i w u i t w u i 1 2 γ u i 2 taking the time differentiation of 76 one gives 77 v u i u e i u e i w u i t w u i γ u i γ u i substituting 71 72 73 74 and 75 into 77 and yields 78 v u i u e i ϕ u i τ u i u e i w u i t r u i θ z u ρ u i w u i γ u i k u 1 γ u i δ τ u i u e i w u i t θ z u ε u i k u 2 u e i w u i t θ z u k u 3 γ u i u e i w u i t u e i θ z u ρ u i w u i γ u i k u 1 γ u i δ τ u i u e i ε u i k u 2 u e i k u 3 γ u i u e i w u i t θ z u u e i w u i t θ z u ρ u i w u i t w u i k u 1 γ u i 2 γ u i δ τ u i ε u i u e i k u 2 u e i 2 k u 3 u e i γ u i u e i 2 u e i w u i t θ z u u e i w u i t θ z u ρ u i w u i t w u i k u 1 γ u i 2 γ u i δ τ u i k u 2 u e i 2 u e i 2 k u 1 γ u i 2 ρ u i w u i t w u i k u 3 u e i γ u i γ u i δ τ u i ε u i u e i using the young s inequality one has 79 u e i ε r i 1 2 u e i 2 1 2 ε u i 2 1 2 u e i 2 1 2 ε u i 2 80 k u 3 u e i γ u i 1 2 k u 3 u e i 2 1 2 k u 3 γ u i 2 81 γ u i δ τ u i 1 2 γ u i 2 1 2 δ τ u i 2 by virtue of assumption 4 one gives 82 ρ u i w u i t w u i ρ u i 2 w u i 2 w u i 2 substituting 79 80 81 and 82 into 78 yields 83 v u i k u 2 u e i 2 u e i 2 k u 1 γ u i 2 ρ u i 2 w u i 2 w u i 2 1 2 k u 3 u e i 2 1 2 k u 3 γ u i 2 1 2 γ u i 2 1 2 δ τ u i 2 1 2 u e i 2 1 2 ε u i 2 k u 2 u e i 2 u e i 2 1 2 k u 3 u e i 2 1 2 u e i 2 k u 1 γ u i 2 1 2 k u 3 γ u i 2 1 2 γ u i 2 ρ u i 2 w u i 2 ρ u i 2 w u i 2 1 2 δ τ u i 2 1 2 ε u i 2 k u 2 1 2 1 2 k u 3 u e i 2 k u 1 1 2 k u 3 1 2 γ u i 2 ρ u i 2 w u i 2 ρ u i 2 w u i 2 1 2 δ τ u i 2 1 2 ε u i 2 μ u i v u i c u i where 84 μ u i min k u 2 1 2 1 2 k u 3 k u 1 1 2 k u 3 1 2 min ρ u i λ max u γ u i 1 85 c u i 1 2 ρ u i w u i 2 ε u i 2 δ τ u i 2 where λ max u represents the maximum eigenvalue of γ u i 1 furthermore to guarantee positive of the 84 control gains k u 2 k u 2 and k u 3 should be selected to satisfy 86 2 k u 1 1 k u 3 0 2 k u 2 1 k u 3 0 according to lemma 3 the following inequality is given by 87 v u i t v u i 0 e μ u i t c u i μ u i 1 e μ u i t t 0 from the inequality 87 it is implied that the proposed surge velocity control can be achieved by choosing reasonable parameters 4 2 heading control define the tracking error of the yaw angle ψ i and yaw angular velocity r i as 88 ψ e i ψ i ψ d i 89 r e i r i r d i where ψ d i atan 2 y d i x d i and r d i is a virtual signal governed by 90 r d i k v ψ e i ψ d i where k v 0 differentiating 88 yields 91 ψ e i r i ψ d i differentiating both sides of 89 along 67 yields 92 r e i φ r i τ r i d r i r d i to simplify the presentation uncertainties are defined as below 93 ϕ r i φ r i d r i r d i r e i substituting 93 into 92 one has 94 r e i ϕ r i τ r i r e i the other rbf nn observer is designed to approximate the ϕ r i and one has 95 ϕ r i w r i t θ z r ε r i where ϕ r i is the estimate of ϕ r i ε r i ε r i and w r i is an adaptive weight parameter and its estimate can be designed as 96 w r i γ r i r e i θ z r ρ r i w r i where γ r i and ρ r i are positive constants w r i t w r i t w r i t furthermore the other compensator is proposed to resolve the input saturation in yaw as follows 97 γ r i k 1 γ r i δ τ r i where k r 1 0 and δ τ r i τ r i τ r i thus a heading control law is formulated based on the rbf nn observer 95 and the input saturation compensator 97 as follows 98 τ r i k r 2 r e i ψ e i w r i t θ z r k r 3 γ r i where k r 2 0 and k r 3 0 are control gains consider the lyapunov function 99 v r i 1 2 ψ e i 2 1 2 r e i 2 1 2 γ r i w r i t w r i 1 2 γ r i 2 taking the time differentiation of 99 yields 100 v r i ψ e i ψ e i r e i r e i w r i t w r i γ r i γ r i substituting 94 95 96 97 98 and 99 into 100 yields 101 v r i ψ e i ψ e i r e i r e i w r i t w r i γ r i γ r i ψ e i r i ψ d i r e i ϕ r i τ r i r e i w r i t r e i θ z r ρ r i w r i γ r i k r 1 γ r i δ τ r i ψ e i r e i k v ψ e i r e i w r i t θ z r ε r i k r 2 r e i ψ e i w r i t s z r k r 3 γ r i r e i w r i t r e i θ z r ρ r i w r i γ r i k r 1 γ r i δ τ r i ψ e i r e i k v ψ e i 2 k r 2 r e i 2 r e i ε r i k r 3 r e i γ r i r e i ψ e i r e i 2 r e i w r i t θ z r r e i w r i t θ z r ρ r i w r i t w r i γ r i k r 1 γ r i γ r i δ τ r i k v ψ e i 2 k r 2 r e i 2 r e i 2 r e i ε r i k r 3 r e i γ r i ρ r i w r i t w r i k r 1 γ r i 2 γ r i δ τ r i using the young s inequality one has 102 r e i ε r i 1 2 r e i 2 1 2 ε r i 2 1 2 r e i 2 1 2 ε r i 2 103 k r 3 r e i γ r i 1 2 k r 3 r e i 2 1 2 k r 3 γ r i 2 104 γ r i δ τ r i 1 2 γ r i 2 1 2 δ τ r i 2 by virtue of rbf nn one gives 105 ρ r i w r i t w r i ρ r i 2 w r i 2 w r i 2 substituting 102 103 104 and 105 into 101 yields 106 v r i k v ψ e i 2 k r 2 r e i 2 r e i 2 r e i ε r i k r 3 r e i γ r i ρ r i w r i t w r i k r 1 γ r i 2 γ r i δ τ r i k v ψ e i 2 k r 2 r e i 2 r e i 2 k r 1 γ r i 2 1 2 r e i 2 1 2 ε r i 2 1 2 k r 3 r e i 2 1 2 k r 3 γ r i 2 ρ r i 2 w r i 2 w r i 2 1 2 γ r i 2 1 2 δ τ r i 2 k v ψ e i 2 k r 2 r e i 2 r e i 2 1 2 r e i 2 1 2 k r 3 r e i 2 k r 1 γ r i 2 1 2 γ r i 2 1 2 k r 3 γ r i 2 1 2 ε r i 2 ρ r i 2 w r i 2 w r i 2 1 2 δ τ r i 2 k v ψ e i 2 k r 2 1 2 1 2 k r 3 r e i 2 k r 1 1 2 1 2 k r 3 γ r i 2 ρ r i 2 w r i 2 1 2 ε r i 2 ρ r i 2 w r i 2 1 2 δ τ r i 2 μ r i v r i c r i where 107 μ r i min k v k r 2 1 2 1 2 k r 3 k r 1 1 2 1 2 k r 3 min ρ r i λ max r γ r i 1 108 c r i 1 2 ε r i 2 ρ r i w r i 2 δ τ r i 2 where λ max r represents the maximum eigenvalue of γ r i 1 furthermore to guarantee positive of the 107 control gains k r 1 k r 2 and k r 3 should be selected to satisfy 109 2 k r 1 1 k r 3 0 2 k r 2 1 k r 3 0 according to lemma 3 the following inequality is given by 110 v r i t v r i 0 e μ r i t c r i μ r i 1 e μ r i t t 0 from the inequality 110 it is implied that the adaptive path following performance of heading control can be achieved by choosing reasonable parameters 5 stability analysis of the closed loop system theorem 1 consider a crowded uuv swarm in 4 5 and 67 in the presence of uncertainties and input saturation under the bio inspired consensus sub controller 32 and the fuzzy potential field sub controller 50 and the path following controllers 75 and 98 with nn based adaptive laws 73 and 96 and together with input saturation compensators 74 and 97 a decentralized adaptive flocking control design can guarantee following properties i all tracking error signals 26 61 68 88 and 89 in the closed loop system are uniformly ultimately bounded and ii the uuv swarm can track the desired path while avoiding collision and preserving connection proof consider a lyapunov function for the entire closed loop system as follows 111 v s v 1 1 2 x e 2 y e 2 i 1 n v u i v r i taking the time differentiation of 111 along errors 26 61 68 88 and 89 is expressed as 112 v s v 1 x e λ x e ψ d y e y e u sin ψ e ψ d x e i 1 n v u i v r i ϒ t ϒ λ x e 2 u y e sin ψ e i 1 n v u i v r i let ψ e ψ r ψ d and the following equation 113 can be deduced from 27 113 sin arctan y e δ y e y e 2 δ 2 substituting 113 into 112 yields 114 v s ϒ t ϒ λ x e 2 u y e 2 y e 2 δ 2 i 1 n v u i v r i for each l 0 0 and y e l 0 one gives wang et al 2020 115 χ y e u l 0 2 δ 2 χ such that substituting 114 into 112 yields 116 v s ϒ t ϒ λ x e 2 χ y e 2 i 1 n v u i v r i substituting 83 and 101 into 116 one has 117 v s ϒ t ϒ λ x e 2 χ y e 2 i 1 n μ r i v r i μ u i v u i i 1 n c r i c u i by virtue of lemma 3 one can obtain 118 v s μ s v s c s where μ s min 1 λ χ i 1 n μ r i i 1 n μ u i and c s i 1 n c r i c u i thus it can be concluded that all error signals in the closed loop system are uniformly ultimately bounded this concludes the proof remark 5 the guidance on how to choose the control parameters is shown as follows i ω i and r in bio inspired consensus relate to an optimal neighbor set which determines the computational burden generally these parameters satisfy 0 ω i π 2 and 6 r 8 ii ς r m ς a m and ς a c m in the bounded fuzzy potential functions related to the collision avoidance and connectivity preservation can be suitably chosen according to the number of fuzzy rules and the accuracy of sensors equipped on uuv iii k r 1 and k u 1 in the velocity and heading controls affect the compensated rates of saturated inputs and k r 2 k r 3 k u 2 and k u 3 relate to the control inputs all of which should be chosen as positive constants and satisfy 86 and 109 to guarantee stability of the proposed method 6 simulation studies in this section simulation results are provided to illustrate the effectiveness and robustness of the proposed decentralized flocking control for the crowded uuv swarm consider a swarm n 50 consisting of 49 followers and one leader to shape a formation where the uuv model is adopted from shaanxi normal university and its normal parameters are identified by particle filter liang and kang 2015 the normal parameters for each uuv are given as follows m 11 25 8 m 22 33 8 m 33 2 76 m 23 m 32 1 01 m 12 m 21 m 13 m 31 0 d 11 8 8065 20 u d 22 65 5457 70 v d 33 6 7352 20 r d 23 d 32 2 5 5 5 v 5 3 r and d 12 d 21 d 13 d 31 0 the model uncertainty is assumed as δ η v δ m v δ c v v δ d v v 0 35 0 1 u 2 0 1 r 2 sin v t in addition external disturbances n t caused by winds waves and ocean currents in earth fixed frame e are assumed as wang et al 2020 119 n t t d n t k d f d where t d d i a g 100 100 100 denotes the time constant matrix k d d i a g 10 5 6 denotes the gain matrix and f d denotes white noise whose largest amplitude is f d 1 then w t affecting on uuv in body fixed frame b can be formulated by w t j ψ t n t meanwhile saturation limits of both inputs are illustrated in table 2 the number of fuzzy set for two inputs d i j 2 c and d i j r 1 is given by m 5 and the whole number of fuzzy rules is l 5 2 where the fuzzy membership function is defined by o 1 2 5 and σ 1 1 the designed parameters for collision avoidance and connectivity preservation are selected as ς r m 8 ς a m 10 ς a c m 12 s 10 r 2 8 r 2 4 c 0 4 ω π 3 and r 8 liang et al 2021a an rbf nn composed by 50 neurons is employed to approximate uncertainties where a center o 2 i is distributed evenly in range 1 1 1 1 0 5 0 5 1 1 1 1 0 5 0 5 and its variance σ 2 i is set as 6 and w i u 0 w i u 0 0 the parameters of weight updating law given by 73 and 96 are chosen as γ i u γ i r 100 i 36 and ρ r i ρ u i 2 furthermore all parameters of input saturation compensators given by 74 and 97 are chosen as k r 1 k u 1 6 in addition all parameters of adaptive nn controllers given by 75 and 98 are chosen as 2 k r 2 2 k u 2 10 and k r 3 k u 3 10 6 1 closed loop performance to demonstrate the proposed decentralized flocking scheme two cases are considered i e straight line and curve line in the closed loop performance case 1 the desired path is generated by η d 2 θ 15 and η d 0 15 m 15 m 0 rad the initial position x i y i and heading angle ψ i of uuvs are randomly generated within the box 0 50 m 0 50 m and interval π r a d π r a d respectively and corresponding initial velocities are uniformly set as v i u i v i r i t 0 furthermore the desired velocity of this swarm is defined as v d 2 m s toward the desired path case 2 the desired path is generated as follows i 0 t 20 η d 1 2 θ 2 θ ii 20 θ 25 η d 2 θ h 2 sin 2 θ ϖ 2 h 2 2 ϖ 2 350 iii 25 θ 32 η d 3 60 2 θ iv 32 θ 40 η d 4 θ h 4 sin 2 θ ϖ 4 h 4 8 ϖ 4 500 v 40 θ 48 η d 5 θ h 5 sin 2 θ ϖ 5 h 5 18 ϖ 5 400 and vi θ 48 η d 2 θ 0 75 θ the initial position x i y i and heading angle ψ i of uuvs are randomly generated within 0 50 m 0 50 m and interval π r a d π r a d respectively and initial velocities are uniformly set as v i u i v i r i t 0 furthermore a desired velocity of this swarm is defined as v d 4 m s toward the desired path the simulation results of flocking motion for case 1 are illustrated in fig 5 fig 5 a shows the initial pattern under the interactive topology which is assumed as a spanning tree where the leader uuv marked by black circle can receive the desired path marked by red circle while other uuvs marked by green circle are followers and the cof is marked by blue circle and all neighbor links are solid line fig 5 b depicts motion trajectories of crowded uuv swarm in which the curves of cof and desired path are coincident fig 5 c plots the final pattern in which each uuv can be synchronized within a finite time and a marked arrow denotes its velocity from fig 5 b and fig 5 c it is observed that the proposed bio inspired consensus can keep the swarm connected via an estimated cof position in addition distances between each pair of uuvs are demonstrated in fig 5 d in which the minimum distance d min 0 95 is larger than 2 c 0 8 and the maximum distance d max 9 8 is smaller than s 10 both d min and d max remian invariable during the tracking process which implies that no collisions or splits occur consequently it can be seen that the proposed flocking control can guarantee the collision avoidance and connectivity preservation in the presence of uncertainties and input saturation fig 6 a and b demonstrate the performance of surge velocities and heading angles of uuvs respectively fig 6 c depicts the force τ u and moment τ r about the leader and the 28th follower all of which converge in a finite time and do not exceed the saturation limits given in table 2 fig 6 d shows norm of neural weights for surge control and heading control provided by adaptive laws respectively all of which are bounded it is observed that uncertainties can be approximated by rbf nn technique and the actual and estimated uncertain dynamics are shown in fig 6 e at last both along tracking and cross tracking errors in fig 6 f can converge to a small value close to zero which implies the universal applicability and effectiveness of the proposed scheme for the crowded uuv swarm the simulation results for case 2 are illustrated in fig 7 and fig 8 it can be observed that the proposed decentralized flocking is capable of tracking the curve path while guaranteeing collision avoidance and connectivity preservation for crowded uuv swarm and has outstanding robustness against uncertainties and external disturbances 6 2 comparative results to evaluate the transient and steady state performance model based method lu et al 2018 learning based method jafari et al 2017 and sliding mode control wang et al 2020 are employed to make comparative experiments and the number of repeated number is 50 times for two cases in which the integral of absolute error iae and maximum absolute error mae are employed i e 120 i a e x y 0 t 1 e x e y d t 121 m a e x y max max e x max e y where t 1 represents the total tracking time the two indicators are used to evaluate the transient and steady state performance in addition an average computational time act is introduced to describe computational burden for the good performance the smaller iae mae and act values are the more adaptive and robust effectiveness is all results are provided in figs 9 and 10 and average results of the entire flocking are shown in table 3 in figs 9 and 10 it can be observed that both cross tracking and along tracking errors of four methods all converge to zero however the convergence efficiency of the proposed method is faster than that of others especially for model based method i e both of tracking errors converging to zero is about t 20s by the proposed method while the time taken by model based method is about t 50s it indicates that the proposed controller is more robust owing to a stronger capability against uncertainties which can improve the stability of flocking system from the perspective of iae and mae in table 3 the mae value of model based method is much bigger than that of others in two cases it is also evident that its slower response speed can cause greater error accumulation in the tracking period by contrast iae and mae values of the proposed method are the smallest which implies that disturbances are successfully rejected by great transient and steady state performance in addition with regard to the computational burden the act of the proposed method is smaller compared with others this is because the bio inspired consensus provides an optimal neighbor set with optimal distribution as a consequence it is clear that the flocking control scheme developed using bio inspired consensus fuzzy potential field and adaptive nn technique outperforms other approaches for crowded uuv swarm in the presence of uncertain parameters and input saturation 7 conclusion in this paper a decentralized adaptive flocking control scheme with collision avoidance and connectivity preservation was addressed for crowded uuv swarm in spite of uncertainties and input saturation using bio inspired consensus and fuzzy potential field a flocking controller with leader follower pattern was proposed at the kinematic level in which one of the most important elements was an estimate of cof position to keep the swarm connected to reflect more realistic situation an adaptive path following tracking controller was developed to track desired surge velocity and heading at the kinetic level in which nns were employed to approximate uncertainties and an additional control term was introduced to handle the input saturation problem the simulation results showed the superior performance of the proposed scheme for tracking the desired straight and curve line paths the promising directions of future research will include the extension to the time delaying flocking control guided by multiple desired paths peng et al 2021 especially with the joint effects of directed topology and communicating delay for three dimension oceanic environment wang et al 2020 credit authorship contribution statement hongtao liang conceptualization methodology software visualization writing original draft preparation writing review editing validation hui cao writing review editing yanfang fu data curation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the financial support from the natural science foundation of shaanxi under grant 2019jq 026 and fundamental research funds for central universities under grant gk202103014 and the authors would like to thank all reviewers and editors who provided the extensive invaluable comments and suggestions appendix a table 4 notation table 4 symbol description η x y ψ position vector in surge sway and yaw v u v r velocity vector in surge sway and yaw w w u w v w r disturbance of surge sway and yaw in earth fixed frame b τ τ u 0 τ r surge force sway force and yaw moment δ input of saturated function τ max τ min saturation limits j ψ transformation matrix m nominal inertia matrix c nominal coriolis matrix d nominal damping matrix n swarm size n i neighbor set of the i th uuv n i 0 initial neighbor set of the i th uuv d i lumped unknown of the i th uuv d i j euclidean distance of the i th uuv and the j th uuv ζ i c estimated cof position of the i th agent ζ c average position of the entire system s communicating radius c collision avoidance radius ω blindness sector r sector number v n 1 n 2 n n node set of graph g v e e i j n i n j v edge set of graph g v e l laplacian matrix a adjacency matrix x x 1 x 2 x m input vector in fuzzy logic system y y 1 y 2 y m output vector in fuzzy logic system f j i input fuzzy set in the j th dimension of the i th fuzzy rule q k i fuzzy set in the k th dimension of the i th fuzzy rule ϖ f j i output membership function for the input fuzzy set l fuzzy rule number ξ x fuzzy basis function vector y overall output of fuzzy logic system θ z activation vector of inputs l nn mode number w nn weighting w optimal nn weighting ε approximation error ε optimal approximation error η d x d θ y d θ ψ d θ generalized position of desired path θ independent variable of desired path ψ d θ path tangential angle η a x a y a ψ a t cof position of the entire system u u 2 v 2 velocity of cof ψ r approach angle δ look ahead distance x e y e along tracking and cross tracking errors u d i desired velocity for the i th uuv ψ d i desired heading angle for the i th uuv η c η 1 c η 2 c η n c estimated cof vector of all the individual uuvs η η 1 η 2 η n t positions vector of all the individual uuvs λ min minimum eigenvalue λ max maximum eigenvalue u r repulsive potential field function f r repulsive force u a attractive potential field function f a attractive force u a c attractive potential field function between uuv and its cof f a c attractive force between uuv and its cof u 1 a c attractive potential field function between leader uuv and desired path f 1 a c attractive force between leader uuv and desired path q overall potential functions in the uuv swarm f i overall forces of the i th uuv p d x d y d positions of desired path in surge and sway v swarm velocity v d desired velocity of swarm p a x a y a cof positions in surge and sway p e tracking error j η jacobian matrix n disturbances in earth fixed frame e 
20283,to explore the regularity of ship density and ensure the safety of maritime traffic a ship density model based on ship scale conversion and grid is established by considering the impact of ship size on traffic safety a non parametric kernel density estimation kde method is used to obtain the probability density function of the ship density by selecting the appropriate kernel function and determining the optimal bandwidth to process and store automatic identification system ais data efficiently a grid based storage method of ais data is proposed in this paper and the relationship between grid width and sampling interval is established the experiments result proves that the grid based ais data storage method saves 64 of storage space compared with the original ais data the ship density model based on ship scale conversion can reflect the impact of ship size on the maritime traffic the distribution regularity of ship density can be obtained through the probability density curve of ship density and statistical characteristics the research results show that the proposed method can provide theoretical support for the safety supervision of the maritime authority it can also be recommended for the evaluation of vts centers in vessel traffic management keywords ship density ais distribution characteristics non parametric kernel density estimation 1 introduction with the development of the economy the shipping industry has also developed driving the port industry into a stage of rapid development the rapid growth of the port traffic has led to marine traffic accidents happen frequently with heavy losses and the traffic situation is becoming severe to some extent the ship density reflects prosperity of shipping economy the higher the ship density is the more prosperous the economy is the ship density also reflects the risk level of maritime traffic wang et al 2019a the higher the ship density is the greater the probability of maritime traffic accidents is and the higher the risk of maritime navigation exits automatic identification system ais data contains a variety of information such as static information dynamic information and voyage related information which has motivated many efforts to study ship trajectories from different aspects liu et al 2020 e g ship density kim et al 2014 and motion pattern sheng and yin 2018 the characteristic of ship density is depicted on the chart to form the ship density distribution map at present there are many studies based on ship density map which can be seen that the number of ships in the ports estuaries and waterways is relatively great to ensure the port economy flourish it is necessary to study how to keep the reasonable distribution of ship density so that there is no congestion in case of heavy traffic under this background some researches li et al 2016 wu et al 2017 carried out the qualitative observation of ship density i e mapping ship density which cannot meet the needs of maritime traffic supervision in some cases so many researches began to focus on the quantitative analysis of ship density at present there are four methods to establish the different models for ship density the first method is using radar screen photos or aerial photographs to get the number of ships in the water area and further calculate the ship density the second is counting the number of ships in the study area in a certain period of time before and after the designated time and approximately calculating the number of ships in the study area instantaneously and then divided by the area of water to obtain the instantaneous ship density tang et al 2012 used this method to design an algorithm for plotting ship density distribution the third is to get the ship density by the frequency of sending ais information natale et al 2015 calculated the ais data entries in each grid by meshing the research waters and drew the density distribution map of fishing vessels in the research waters mazzarella et al 2014 used ais information coverage rate to characterize ship density but it is not comprehensive and accurate to describe ship density by ais information coverage rate exclusively the fourth is to characterize ship density in a variety of ways ning et al 2015 proposed a method for calculating ship density based on the grid statistics the statistical information includes the number of ais messages sent the interval between ais messages the number of ships passing through the grid and how long the ships stay in the grid dai et al 2019 proposed a grid based ship density assessment method which uses the frequency of ships in the grid as an index to evaluate the ship density in the grid liu et al 2019 proposed a ship density model based on the radial distribution function in molecular dynamics which identifies the density based on the relative distance between ships in summary most of the ship density models are based on ais data ma 2016 and require a large amount of ship traffic data the traditional ais data storage method based on trajectory points needs huge storage space so that it is difficult to process and analyze quickly and effectively in addition most of the ship density model are based on the number of ships in the research water area or the number of ais messages sent in the research area pietrzykowski et al 2015 ignoring the influence of ship size on the ship density to characterize maritime traffic risk if the ship size is not taken into account at all the maritime traffic risk level reflected by the calculated ship density would be different from the actual situation although zhu and liu 2014 calculated ship density taking into account ship length conversion there is no quantitative analysis of the characteristics of ship density before and after conversion and only the ship density in port waters was studied moreover most of the researches focus on the calculation method of ship density and the drawing method of ship density distribution chart but there are few studies on the quantitative analysis of the law of ship density distribution in the field of ship traffic risk assessment instantaneous ship density is suitable for dynamic assessment however the instantaneous ship density is not representative in the overall assessment and it is necessary to study the distribution law of ship density quantitatively to accurately assess the ship traffic risk in this paper the characteristics and laws of ship density distribution in different type of water areas are studied mainly by quantitative analysis the ship density can be regarded as a continuous random variable consequently it is necessary to understand the probability density function of ship density for studying the law of ship density distribution im and luong 2019 established a zone around a ship which is based on concept of ship domain by using kernel density algorithm there have also been some studies lampe et al 2010 lampe and hauser 2011 on the visualization of kernel density estimation kde of maritime traffic at present kde is the dominating means to visualize the ship traffic density wang et al 2019b however in the field of estimation of probability density function of random variable the non parametric estimation method overcomes the shortcoming of the parameter estimation method that needs to assume the distribution of the data sample in advance the non parametric kde method was first proposed in 1962 parzen 1962 which is completely data driven to solve the probability density function it has been applied in many fields such as analysis of stock market hu and zong 2014 description of uncertainties of wind power yang et al 2019 and intelligent video surveillance system zhang et al 2015 a collection of non parametric density estimation algorithms for high dimensional data were also reviewed wang and scott 2019 cheng et al 2017 proposed a non parametric localized bandwidth selection method and developed an asymptotic theory for it in a word most studies based on ship density have the following limitations first of all traditional ais data based methods require large storage space moreover the model of ship density without considering the effect of ship scale makes the calculation results inaccurate furthermore there is no comprehensive and detailed quantitative analysis of ship density and ship density distribution for different type of water area to address these problems ship scale conversion and non parametric kde method are introduced to model ship density the model of ship density based on ship scale conversion and grid is presented for the first time the non parametric kde method is chosen to establish the probability density function of the ship density which is a random variable the effect of different ship sizes on ship density is considered to obtain the characteristics of ship density in addition the distribution law of ship density can be obtained by calculating the ship density statistical characteristics the proposed method can be used to measure the risk of ship traffic more accurately based on the above mentioned ideas the main contributions of this paper are as follows a grid based ais data storage method is proposed for the grid based ship density calculation method to reasonably study the distribution law of ship density in a certain period of time the sampling time is discussed according to the ship speed and grid size secondly a ship density model based on ship scale conversion and grid is established to reduce the influence of ship size on ship density thirdly the probability density function estimation model of ship density is proposed by non parametric kde method finally the distribution law of ship density in different type of water areas are quantitatively analyzed 2 ship density model ship density and ship density distribution are the basic concept of the real situation of marine traffic in a certain water area which can reflect the busyness and the risk level of marine traffic to a certain extent the actual distribution of ship density in the study area is obtained by using ais data transmitted by ships in this paper 2 1 definition of ship density in the field of marine traffic safety research ship density includes instantaneous ship density and average ship density pan 2007 instantaneous ship density refers to the number of ships per unit area at a given moment which is obtained by dividing the number of ships in instantaneous by the area of the waters according to the definition the instantaneous ship density of grid i at time t can be represented as follows 1 d i t n i t s i where d i t is the ship density of grid i at time t n i t is the ship number of grid i at time t and s i is the area of grid i the average ship density is the average of several instantaneous ship densities the average ship density in the grid i can be calculated as formula 2 2 d i t 0 t n d i t n where d i is the average ship density of grid i and n is the sampling frequency according to the time interval of hours the average ship density of hours can be obtained in the same way the average ship density of days can also be obtained according to the time interval of days 2 2 ship density calculation model based on ship scale conversion ship size is the basic concept of ship scale gao 1986 to study the influence of different ship sizes on maritime traffic many countries have classified ships according to different ship size although the classification is primarily based on gross register ton and ship length the results vary from country to country depending on the perspective and purpose of the classification for example chinese researchers of marine traffic engineering mainly consider ship traffic accidents while japanese scholars mainly consider ship traffic investigation and british researchers consider the risk factor when they classify ships ship density can reflect the risk level of ship traffic in the water area the danger level of ship traffic in the water area is not only determined by the number of ships but also the size of ships in general the greater the number of ships in the waters is the higher the danger level is for waters with the same number of ships the larger the ship size in the waters is the higher the calculated ship density should be shao et al 2010 therefore the ship size should be taken into account when calculating ship density for evaluating the risk of maritime traffic to compare the ship traffic status in different time of the same water area or ship traffic status in different water area at the same time the ships in a certain size are often selected as the standard ships for conversion in the study of marine traffic a specific ship size is selected as the standard ship and ships of other sizes are assigned different conversion coefficients and then the numerical value of ship density is calculated in this way the ship density based on standard ship can reflect the danger level of ship traffic more accurately the selection of standard ship is mainly based on different research purposes usually the mainstream ships in a certain water area are selected table 1 is the ship conversion coefficient proposed by china when adopting safety index method to assess maritime traffic safety which has been used widely after the conversion coefficient is obtained the calculation formula of the instantaneous ship density changes accordingly the contribution of larger ships is increased in the calculation of ship density smaller ship size is used to reduce its contribution to the calculation of ship density the final instantaneous ship density formula is as follows 3 d i t s 1 s n i t c o n v e r t s h i p s s i where c o n v e r t s h i p s is the conversion function the conversion coefficient is queried in table 1 by the ship length or gross register ton of the ship which is represented as s h i p s when the gross register ton and the length of ship are known but their correspondence is inconsistent with table 1 the ship length should be considered first 2 3 probability density model of ship density the probability density function of ship density is estimated by non parametric kde method non parametric kde is purely non parametric in the sense that it makes no assumption at all regarding the parametric form of the true density the result is explicitly determined by the training data this property gives the non parametric kde an advantage over other methods regarding the ability to accurately describe the spatial distribution and density characteristics of ships laxhammar et al 2009 supposing x 1 x 2 x n is a sample of the random variable x the probability density function of x which is represented as f x is estimated by the kernel function as formula 4 4 f ˆ x 1 n h i 1 n k x x i h where f ˆ x is the estimate of f x x is a random variable representing ship density x i is a sample representing the s h i p i ship density h represents the bandwidth n is the number of samples and k represents the kernel function since each data needs to be computed the amount of computation is determined by the sample size n the larger the sample size is the greater the computation amount is the kernel function selection is the first step in estimating the probability density function of a random variable using non parametric kde at present the common kernel functions are cosine linear epanechnikov gauss and so on the most important factor affecting the outcome of the random variable s probability density function estimation is the choice of bandwidth if the bandwidth h is too great the probability density function f ˆ x of random variable will be over averaged and the probability density curve of random variable will be too smooth to make the random variable show uniform distribution if the bandwidth h is too small the probability density curve of the random variable is less smooth and the f ˆ x of random variable is a sharp pulse so that the random variable appears as a needle like distribution 3 methodology the model of ship density is based on grid so it is necessary to divide the water area into grids and store the ais data based on grid this not only reduces the storage space of ais data but also improves the efficiency of calculation process the kernel function and bandwidth need to be determined when estimating the probability density function of ship density using the non parametric kde method therefore the key technologies involved in ship density model include grid division ais data storage based on grid kernel function and bandwidth selection 3 1 grid division and selection of sampling interval the grid is composed of two dimensional interlaced straight lines and it is divided in many ways in this paper the grid is divided along the longitude and latitude the method of ship density calculation based on grid can refine the spatial distribution characteristics of ship density and the grid based ais data storage method can improve the calculation efficiency in the process of ship density calculation the accuracy of ship density reflected by different spatial resolution is different by choosing the appropriate spatial resolution the grid can not only display the spatial distribution characteristics of ship density but also control the computation amount and storage space within a reasonable range if the area covered by the mesh is too large the precision of the ship density distribution would be reduced otherwise the amount of calculation will increase sharply in the process of grid division most of the researches are based on degree or minute the commonly used grids are 10 10 1 1 0 01 0 01 10 10 1 1 the suitable sampling time interval should be determined at first because the minimum sampling time interval would directly affect the calculation results of ship density especially in the calculation process of average ship density if the sampling time interval is too long the ship density obtained is less accurate and more discrete on the contrary the overall ship density law is easily submerged in the local features to ensure the accuracy of ship density calculation it is necessary to select the appropriate grid size and sampling interval the grid width and sampling interval must satisfy the following conditions 5 t v m a x l where t is the sampling time interval l is the grid width v m a x is the maximum speed of the ship the product of t and v m a x is not greater than l that is the distance of sailing should not exceed the width of grid when the ship sails at maximum speed v m a x for t only in this way can the accuracy of ship density for evaluating the risk of maritime traffic be guaranteed the calculation results of ship density in these grids would be inaccurate if the sampling time interval is too great otherwise it would result in a significant increase in the amount of computation according to this rule the larger the grid is the greater the sampling time interval is selected meanwhile the smaller the grid is the smaller the sampling time interval should be selected 3 2 grid based ais data storage method the grid based ais data storage algorithm stores ais trajectory data in the form of grid establishing the mapping of data points to grid cells and using the passing grid sequence as the storage unit a ship s trajectory data set p p i 0 i n is obtained by its mobile maritime service identity mmsi all trajectory points of the p set constitute the n trajectory segments for each trajectory segment the span of time latitude and longitude are as formula 6 6 δ t p e t p s t δ λ p e λ p s λ δ φ p e φ p s φ where p s is the starting point p e is the ending point p s t p s λ and p s φ represent the time longitude and latitude of starting point respectively while p e t p e λ and p e φ are time longitude and latitude of ending point respectively the data set of ship trajectory p p i 0 i n is composed of two adjacent trajectory points p i and p i 1 p i is set as the starting point p s and p i 1 is set as the ending point p e it is necessary to determine whether the starting point p s and the ending point p e belong to the same grid if p i 1 belongs to the same grid with p s the next track point p i 2 is set to the ending point p e until the starting point p s and the ending point p e are not in the same grid if there is no intersecting relationship the next grid is traversed if there is an intersecting relation the intersection point p is calculated the above process is looped until all the grids have been traversed therefore it can be detected by traversing all the grids whether there is an intersection between the four boundaries of every grid and the line segment that connected by p s and p e the instantaneous motion of a ship has the characteristic of constant velocity that is the motion from the starting point p s to the ending point p e of a trajectory is a uniform linear motion by calculating the ratio of the navigational distance of the ship in each grid to the total navigational distance the stay time of the ship in the grid is calculated according to the total voyage time if δ λ 0 the line segment formed by starting point p s and ending point p e is parallel to longitude that is the line connecting p 1 and p 2 is parallel to longitude therefore the ratio of the width of the grid to the length of the trajectory segment is that of the time passing through the grid to the total time of the trajectory segment 7 c t g i p i 1 φ p i φ l φ δ t i 0 1 n 1 where c t g 1 is the sailing time of the ship in the grid g i the line segment connecting the starting point p s to the ending point p e is parallel to latitude when δ φ 0 whereas the projection is made in the longitude direction for the corresponding segment when δ φ 0 the ratio of the ship s stay time in the grid to the total time of the trajectory segment is equal to the ratio of the distance between the two projection points to the total length of the projection l λ therefore the sailing time of the ship in the grid is obtained using formula 8 8 c t g i p i 1 λ p i λ l λ δ t i 0 1 n 1 the trajectory base on points is transformed to the grid based representation which is g g 1 g 2 g n where each trajectory point is g i t t t is the time to enter the grid g i and t is the stay time of the ship in the grid g i a database is created by storing ais data in a grid as shown in table 2 to further study whether the grid based ais data storage method can reduce the storage cost the original ais data is re stored monthly in a database the number of records in each month of the ais database are compared and the results are shown in fig 1 the grid based ais data storage method saves about 64 of the storage space which greatly reduces the number of records in the database and the use of storage resources it is only necessary to pay attention to the time of the ships enter the grid and the time of stay in the grid because the calculation of instantaneous ship density is carried out in grid units the ais data storage method based on grid can save the storage space because it stores the information that is essential for calculating ship density and ignores the navigational details of ships in the grid 3 3 non parametric kde method for ship density 3 3 1 kernel function selection although the choice of the kernel function is one of the factors that influence the accuracy of calculation in solving the probability density function problem using the non parametric kde method the kernel estimation is not sensitive to the kernel function in the case of sufficient number of samples theoretically under the condition of independent distribution of the same sample kernel estimation method has the properties of asymptotic normality asymptotic unbiasedness and strong consistent hence reliable density estimation results can be obtained by using any kernel function some literatures use the parametric generalized gaussian chen et al 2015 or laplace chen et al 2017 as kernel functions to derive the robust state estimator to verify the influence of different kernel functions on ship density estimation four common kernel functions are selected for experimental comparison to select the optimal kernel function commonly used kernel functions include cosine linear epanechnikov gaussian and so on the expressions for the kernel function are shown in table 3 the 184 h average ship density is used as a sample and the probability density functions of ship density shown in fig 2 are estimated with constant bandwidth by cosine linear epanechnikov and gaussian kernel functions respectively the probability density curves obtained by different kernel functions tend to be approximately the same when estimating the probability density function of ship density using different kernel functions only with different degree of smoothness the epanechnikov kernel is the least smooth and the gaussian kernel is the smoothest eight different kernels i e uniform triangular epanechnikov quartic triweight tricube gaussian and cosine have been parallelly compared huang et al 2020 the comparison results show that the gaussian kernel function can produce more suitable kde based visualization of mass traffic trajectories therefore the gaussian kernel is chosen as the kernel function in the non parametric kde method for estimation of the probability density function of ship density 3 3 2 bandwidth selection the bandwidth is a crucial factor affecting the results of non parametric kde beside the kernel function the bandwidth has a greater impact on the result compared with the kernel function if the bandwidth is too great the estimated result can not reflect the individual characteristics of the sample data otherwise the individual characteristics would be too obvious in the estimation result even there is no sample in some interval this makes it difficult to provide a reasonable interpretation of the result the probability density function of ship density is estimated by selecting the gaussian kernel function with bandwidth h 0 5 h 1 h 2 respectively using 184 h average ship density as the sample the results are shown in fig 3 it can be seen that the probability density curves of ship density using different bandwidths are quite different when the bandwidth h 0 5 the probability density curve of ship density is very tortuous which fully reflects the change of probability density values corresponding to different ship density values however the curve is too tortuous and the law of the probability density of ship density cannot be summarized when h 2 the probability density function of ship density is very smooth with only one peak although the probability density of ship density is roughly described the description of the details is too rough and does not describe the fluctuation of the probability density value the obtained curve has a better smoothness by using bandwidth h 1 and the probability density value of different ship density shows a suitable high or low variation in order to get the probability density function of ship density with less error and keep the smoothness of the result curve it is necessary to select the optimal bandwidth one of the methods to select the optimal bandwidth is the cross validation method yang et al 2018 the cross validation method is used to determine the optimal bandwidth by calculating the integral square error ise ma et al 2019 the bandwidth is considered as the optimal when the ise reaches the minimum ise is calculated as formula 9 9 i s e f ˆ x f ˆ x f x 2 d x f ˆ 2 x d x 2 f ˆ x f x d x f 2 x d x where f ˆ x is the estimated probability density and f x is the actual probability density in the process of calculating the ise f x can be ignored in the process of solving i s e f ˆ x because it is independent of the bandwidth on the contrary f ˆ x is related to the bandwidth therefore the process of solving the optimal bandwidth is transformed into solving the bandwidth when the expression f ˆ 2 x d x 2 f ˆ x f x d x takes the minimum value the expression is then further split into two parts one part is i 1 f ˆ 2 x d x and another part is i 2 2 f ˆ x f x d x then two expressions are expanded separately as shown formula 10 and 11 10 i 1 i 1 i n j 1 j n k x i x j h n 2 h 11 i 2 i 1 i n f ˆ i x i n i 1 i n j 1 j i j n k x i x j h n n 1 h where f ˆ i x i is the probability density estimator after excluding the i sample the optimal bandwidth h f ˆ x of the probability density function obtained by the cross checking method is expressed as formula 12 12 h f ˆ x arg min h 0 i 1 2 i ˆ 2 taking the 184 h average ship density as a sample and selecting the gaussian kernel function the experiment for estimating probability density function of ship density is performed 20 times with bandwidth h 0 1 h 0 2 h 1 9 h 2 respectively for these 20 calculations the result of ise at different bandwidths is shown in fig 4 as seen from fig 4 the ise of the probability density function is different with bandwidth when h 0 6 the ise becomes smaller and smaller when h 0 6 the ise is increasing with the increase of bandwidth therefore the optimal bandwidth is 0 6 in this paper where the ise is the minimum however for many practical applications the choice of optimal bandwidth is still a problem that is not completely solved in practice the optimal bandwidth can be selected according to experience and practical situations 4 experiments a general understanding of the distribution characteristics of ship density sample data is obtained by using the grid based ship traffic data which is processed from ais data however there is a lack of representative quantitative eigenvalues to accurately describe the distribution of these data the characteristics of data distribution can be measured and described from three aspects firstly the centralized trend of data distribution can be measured by mean and median secondly the dispersion of data distribution can be measured by standard deviation and variance thirdly the skewness and kurtosis of the data distribution can be reflected by the probability density curve of the data sample this paper studies the distribution characteristics and distribution law of ship density in the fairway anchorage and harbor area of tianjin port respectively the study area is the whole tianjin port area including dagukou north anchorage dagukou south anchorage tianjin port main fairway tianjin port harbor basin area and other functional waters it ranges from 117 30 to 118 48 in longitude and from 38 36 to 39 18 in latitude the corresponding geographic location is shown in fig 5 in the experiments ais data was used from 00 00 00 may 1 2018 to 23 59 59 october 30 2018 table 4 shows the number of ships of different lengths counted after data cleaning based on the distribution characteristics of tianjin port waters this paper divides the tianjin port waters into 42 78 grids which are coded with row and column number connected by underline the unique latitude and longitude range are used to identify the geographical location of the grids considering the overall distribution of vessel speed in the waters of tianjin port to select v m a x the distribution of vessel speed in the waters of tianjin port is shown in fig 6 the ship speed is mainly concentrated between 0 and 20 knots ais data for ships with speed less than 15 knots accounted for 98 of the total data and with speed less than 12 knots accounted for 90 considering the effect of the ship speed on the grid size selection and the sampling time interval the maximum ship speed is selected as 12 knots correspondingly the grid size is selected as 1 1 according to formula 5 that is 1 nautical mile 1 nautical mile approximately consequently the sampling time interval is set to 5 min using ais data on may 1 which is stored by the grid based storage method the converted quantity of ships in the grid at every hour on the hour were obtained according to corresponding conversion coefficient of the ship size the hourly average ship density of the grid is calculated by dividing the sum of converted quantity of ships by 24 and the grid area the hourly average ship density of all the grids is got by traversing all the grid based data which is used to plot the ship density distribution map as shown in fig 7 fig 7 only shows these grids with ship density value in the interval 0 5 because the calculated hourly mean ship density values are mainly concentrated between 0 5 to show the details of the ship density distribution map the ship density value is replaced by 5 if it is greater than 5 it can be found from fig 7 that the water area with higher ship density is concentrated in the functional waters such as harbor basin area fairway and anchorage while the lower vessel density in the non functional waters is between 0 and 1 4 1 performance analysis of ship density calculation model based on the standard ship to emphasize the novelty and advantages of the proposed model a comparison is performed between the ship density model based on standard ship and the traditional density models in previous studies the selected traditional ship density model wu et al 2017 is built as the number of ships per unit area at a given moment this traditional density model is also used in many other previous studies of ship density marine management organization 2014 aronsen 2017 the difference in the calculation results of ship density between the traditional model and the proposed model in this paper can be visualized in fig 8 there are three grids of the same size each with 6 ships the density calculated using the traditional density model i e density 1 are all 6 the density obtained using the proposed model in this paper i e density 2 is relatively great in the grids with large ships based on the ais data on october 5 the method of calculating ship density only considers the number of ships and the method of calculating ship density based on the standard ship are used to calculate the instantaneous ship density of the 24 main fairway grids at 10 o clock respectively as shown in fig 9 the yellow bar represents the ship density calculated by the number of ships the red bar represents the ship density based on standard ship according to the ship density of different fairway grid the ship density of fairway grid calculated only by the number of ships and the ship density based on standard ship are ranked shown in table 5 as can be seen from table 5 the ship density of grid 23 21 ranks second by considering only the number of ships the ship density is 4 ships per square nautical mile however the grid 23 21 ranks fourth by the ship density model based on standard ship the ship density of grid 31 20 ranks fourth with 3 ships per square nautical mile but it ranks second by the ship density model based on standard ship the main reason is that the corresponding conversion coefficients are 1 18 1 18 2 2 25 according to the ship lengths which are 96m 113m 168m and 180m respectively among the four ships in the grid 23 21 meanwhile corresponding conversion coefficients are 0 5 4 4 because the ship lengths are 40m 260m and 266m respectively in the grid 31 20 although there are more ships in the grid 23 21 the ship size is relatively small the value of ship density becomes smaller using the conversion coefficient of ship length and the ranking of ship density is changed correspondingly in the 31 20 grid the number of ships is relatively small but the ship size is relatively great therefore the value of ship density becomes greater by using the conversion coefficient of ship length and the ranking of ship density is changed as well both the grid 31 20 and 32 20 have 3 ships per square nautical mile but the grid 31 20 ranks second based on standard ship while the grid 32 20 ranks sixth based on standard ship the main reason is the different ship length in grids in the grid 31 20 the ship lengths are 40m 260m and 266m respectively according to table 1 the corresponding ship conversion coefficients are 0 5 4 and 4 respectively whereas three ships appear simultaneously in the grid 32 20 having lengths 35m 40m and 266m respectively according to table 1 the corresponding conversion coefficients are 0 5 0 5 and 4 respectively the ship density based on standard ship of grid 31 20 is relatively great because the ships in grid 31 20 are relatively large in length although the number of ships in grid 31 20 is the same as that in grid 32 20 on the contrary the ship size in the grid 32 20 is relatively small the ship density is reduced and the order is also changed by using the conversion coefficient of ship length the risk level of maritime traffic is not only determined by the number of ships but also by the size of ships consequently the ship density which is obtained by the number of ships in the water area per unit area at a certain instant does not accurately reflect the risk level of maritime traffic in the waters because the ship size is not taken into account at all the ship density taking account for ship size can better reflect the risk of ship traffic 4 2 validation of probabilistic density model of ship density a total of 184 hourly average ship density values are obtained from may 1 to october 31 the 184 hourly average ship density values are taken as samples and the probability density function of the ship density is obtained by using the proposed model to measure the performance of the proposed model for estimating the probability density function it is necessary to verify the above results the kolmogorov smirnov ks test is a method based on kolmogorov theorem which is mainly used to test the fit degree between the empirical distribution and the hypothesized distribution of the data sample the ks test is a non parametric hypothesis testing method that does not require the distribution of the sample data in advance at the same time ks test is a stable method because that the test effect of it does not change in the case of a change in the position of the sample mean in testing the one dimensional sample of ship density using the ks test the empirical distribution function f n x is generated from the ship density sample data the estimated cumulative distribution function g x is obtained by integrating the probability density function of the ship density obtained in this paper the f n x and g x are compared to determine the matching degree the specific steps are shown below 1 formulation of hypotheses 13 h 0 f n x g x h 1 f n x g x 2 constructing the test statistic as 14 k s max f n x g x if h 0 is true that is the match between f n x and g x is high k s is a value with a tendency to be small and vice versa therefore the match between f n x and g x can be judged by the k s value in the same way the accuracy of the probability density function of the ship density obtained in this paper is further judged when g x is a continuous distribution function the limiting distribution of k s can be obtained if h 0 is true as shown in equation 15 15 lim n p n k s t 1 2 i 1 1 i 1 e 2 i 2 t 2 t 0 3 setting the critical value d based on the ship density sample data 4 calculating the k s value and comparing the k s value with the critical value d 5 making an acceptance or rejection judgment on the hypothesis when k s d it indicates an acceptance judgment on the original hypothesis when k s d it indicates a rejection judgment on the original hypothesis comparing the cumulative distribution function g x with the empirical distribution function f n x and the results are shown in fig 10 it can be seen that the g x function blue curve and f n x function red point have a good match this indicates that it has good performance for the probability density function of the ship density obtained by choosing the gaussian kernel function and bandwidth h 0 6 the ks test method is used for g x and f n x the critical value d 0 05 is set and ks 0 6476 is obtained by equation 15 because k s d it means that the acceptance judgment of the original hypothesis is made when the critical value of the ship density sample data is 0 05 it is concluded that the results of the ship density function obtained by using gaussian kernel function are reliable at the bandwidth h 0 6 4 3 studying on the law of ship density distribution 184 hourly average ship density values of each grid are obtained by traversing all the grid based data taking the 184 hourly average ship density of each grid as a random the probability density function of ship density is estimated by the non parametric kde method fig 11 shows 100 grids with relatively high hourly average ship density it can be seen that the 100 grids with high hourly average vessel density are mainly concentrated in tianjin harbor basin area main fairway of tianjin port caofeidian fairway and other functional waters 100 grids with high hourly average ship density are selected accordingly the frequency distribution histogram of the ship density and the corresponding probability density function are shown in fig 12 the horizontal coordinate of each subplot represents the range of values of the data samples the product of the vertical coordinate and the width of the horizontal coordinate represents the probability the ship density curves of the different grids obtained by the non parametric kde method are smooth and no unevenness at the same time the estimated probability density curves describe the fluctuation of ship density well the probability density curve with twin peaks of a few grids is well handled to keep the smoothness and to show the detail of peaks as well to further explore the distribution characteristics of ship density different water areas such as the fairway anchorage and harbor basin area are studied in detail this paper describes the statistical characteristics of ship density from probability density function mean median variance and standard deviation and explores the distribution law of ship density in different functional waters 4 3 1 ship density distribution in anchorage to study the ship density distribution of anchorage 40 grids representing dagukou north anchorage and dagukou south anchorage of tianjin port are selected as the research areas it should be noted that these 40 grids cannot completely describe the north anchorage and the south anchorage of dagukou because the 1 1 standardized grids do not match the anchorage exactly moreover not all of these 40 grids belong to anchorages maybe there are some discrepancies in details the 40 grids depict the corresponding locations of the dagukou north anchorage and dagukou south anchorage as shown in fig 13 the frequency distribution histogram of ship density corresponding to each anchorage grid and the estimated probability density curve of ship density are shown in fig 14 it can be seen that the probability density curves of ship density in north anchorage and south anchorage of dagukou are mainly single peak but less double peaks the top of the curve is relatively steep which indicates that the ship density in the anchorage area is concentrated showing the characteristics of small range aggregation several grides with double peaks such as 28 21 29 21 30 21 31 21 33 21 34 21 36 20 are located near the main fairway this indicates that ships travel between anchorage and fairway frequently resulting in the emergence of double peaks or multiple peaks the statistical characteristics of ship density for each anchorage grid are shown in fig 15 the ship density distribution of dagukou north anchorage and dagukou south anchorage can be classified into two types ship density of grid in the anchorage area near fairway and ship density of grid in the anchorage area away from fairway the mean and median of ship density in the grids 28 21 29 21 30 21 31 21 32 21 34 20 35 20 36 20 near the fairway is relatively great mainly distributing in the interval 1 2 5 and the variance is relatively great mainly in the vicinity of 0 5 the mean and median of ship density in the grids away from the fairway are relatively small mainly distributing in the interval 0 2 0 4 and the variance is relatively small generally less than 0 2 the results show that the ship density in the anchorage area near the fairway is great and the dispersion trend is large while the ship density in the anchorage area far from the fairway is small and the dispersion trend is slight 4 3 2 ship density distribution in the fairway 24 grids representing the main fairway of tianjin port are selected as the research objects since it is a standardized grid of 1 1 divided according to the latitude and longitude direction these 24 grids cannot completely match the main fairway of tianjin port the geographic location of the tianjin port main fairway described by these 24 grids is shown in fig 16 the frequency distribution histogram of ship density corresponding to each fairway grids and the estimated probability density curve are shown in fig 17 it can be seen that the probability density curves of ship density in the main fairway of tianjin port are mainly single peak but a few double peaks and the top of the curve is relatively flat without sharp the main fairway of tianjin port is a two way fairway so probability density curves appear twin peaks in some grids to ensure safe navigation the ships in the waterway would maintain a safe distance between each other and the overall distribution of ships in the fairway is relatively uniform consequently the top of the probability density curve of the fairway is relatively flat statistical characteristics of ship density for each fairway grid are shown in fig 18 means of ship density in the fairway grids 25 20 26 20 27 20 28 20 29 20 30 20 which have the same latitude are 0 17 0 22 0 29 0 51 0 96 1 30 2 40 2 49 respectively mean of ship density becomes greater with the increasing of longitude and the variance increases from 0 02 to 0 6 the mean value of the ship density in fairway grids 31 19 32 19 33 19 34 19 35 19 36 19 at another latitude increases from 0 25 to 1 56 as the longitude increases and the variance increased from 0 03 to 0 5 therefore the average and variance of ship density in the fairway increase with the increase of longitude the primary reason is that the fairway length in each grid is different and the fairway length within the grid increases with the increase of longitude the second reason is that ships head to different destinations after leaving the main fairway which causes the ship distribution dispersing and the variance increasing the ship traffic in the area with low longitude is not busy which resulting in a small value of mean of ship density because there are docks and berths for ship berthing loading and unloading in addition there is busy traffic at the high longitude area away from the berthing area because ships sail in and out of tianjin port and to other ports resulting in a great value of mean of ship density 4 3 3 ship density distribution in harbor basin 18 grids representing tianjin port harbor basin area are selected as the research objects to study the distribution of ship density in the harbor basin the shape of the harbor basin is usually complex and changeable so it is difficult to match with these grids accurately as shown in fig 19 these 18 grids fully cover harbor basin the frequency distribution histogram of ship density corresponding to each harbor basin grid and the estimated probability density curve of ship density are shown in fig 20 the probability density curve of ship density in harbor basin of tianjin port is mainly single peak and the top of the curve is generally very steep the probability density curve of the harbor area is steeper than that of the anchorage which indicates that the distribution of ships in the harbor area is more concentrated than the anchorage because there are more ships in the harbor basin docked near berths but few ships in other water areas the probability density curve is almost single peak in harbor area which indicates that the number of ships in the harbor basin is stable the statistical characteristics of ship density for each harbor basin grid are shown in fig 21 the ship density varies with geographical location because of the different proportions of water area and land area in each grid the average of ship density in grids such as 16 25 16 24 16 23 17 23 is much greater than that of grids such as 20 21 21 21 22 21 which indicates that the ship density is decreasing as ships sail from the external fairway into the inner harbor areas such as the eastern port area in a word the ship density in harbor basin is high while the ship density in anchorage and fairway is low from the trend of data concentration according to the dispersion degree of the ship traffic data the dispersion degree of the harbor basin is large the ship density distribution of the anchorage and the fairway is more uniform in the terms of data skewness the probability density curve of ship density in the harbor basin is the sharpest following by the anchorage and that of the fairway is relatively flat 5 conclusion the appearance and extensive use of ais provides abundant data support for maritime situational awareness msa but it poses a challenge on how to store and process massive data in this paper a grid based ais data storage method was proposed which reduces the storage space of ais data and lays a foundation for calculating ship density efficiently and accurately this paper built a ship density method based on ship scale conversion which can reflect the risk level of ships accurately in the waters in order to further study the law of ship density taken ship density as a random variable a non parametric kde method was used to estimate the probability density function of ship density obtaining the mean median variance and standard deviation etc this paper explored the statistical characteristics and distribution rules of ship density in the fairway anchorage and harbor basin of tianjin port the distribution of ships in the harbor area is the most concentrated followed by the anchorage area while the distribution of ships in the fairway is dispersed and uniform when a ship sails from the fairway to the anchorage it will lead to a relatively large density of ships in the local area and the distribution is discrete and dynamic which is prone to congestion in the harbor basin area as the ships sail into the internal waters the ship density increases with the decrease of navigable waters the previous analysis proves that the model proposed in this paper can accurately describe the characteristics and laws of ship distribution in different waters according to the characteristics of ship density in different areas obtained in this paper theory support and management suggestions can be provided for the safety supervision and macro traffic evaluation of the maritime safety administration 1 anchorage the maritime safety administration should strengthen traffic monitoring and organization at anchorage and surrounding waters and the vts center should reasonably arrange anchorages to ensure the safety of navigation in anchorages and the surrounding waters 2 fairway relevant departments should make rational use of navigational resources and functions of transportation organization to maintain the appropriate density distribution and ship flow and improve the efficiency of ship traffic 3 harbor reasonable arrangements should be made for the loading unloading and anchoring of ships to prevent the occurrence of ship congestion in the docks the ship density based on ship scale conversion and kernel estimation presented in this paper can calculate the ship density with high efficiency and accuracy and reflect the risk of marine traffic ship density directly reflects the busyness of ship traffic and the distribution characteristics of dangerous goods ships and large ships and the motion characteristics of engineering ships also determine the level of navigation safety therefore the calculation indicators of ship density can be composed of weighted ship traffic volume the proportion of different types of ships the impact of engineering ship on traffic and so on in addition more kernel functions should be taken into account in future studies to find the optimal credit authorship contribution statement jiaxuan yang conceptualization methodology software validation resources formal analysis lingqi ma data curation visualization writing original draft writing review editing jiaguo liu investigation supervision funding acquisition project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is partly supported by the fundamental research funds for the central universities dmu 31320210131 the authors are grateful to the editors and anonymous reviewers whose thoughtful comments and suggestions have contributed to improving of an earlier version of this paper 
20283,to explore the regularity of ship density and ensure the safety of maritime traffic a ship density model based on ship scale conversion and grid is established by considering the impact of ship size on traffic safety a non parametric kernel density estimation kde method is used to obtain the probability density function of the ship density by selecting the appropriate kernel function and determining the optimal bandwidth to process and store automatic identification system ais data efficiently a grid based storage method of ais data is proposed in this paper and the relationship between grid width and sampling interval is established the experiments result proves that the grid based ais data storage method saves 64 of storage space compared with the original ais data the ship density model based on ship scale conversion can reflect the impact of ship size on the maritime traffic the distribution regularity of ship density can be obtained through the probability density curve of ship density and statistical characteristics the research results show that the proposed method can provide theoretical support for the safety supervision of the maritime authority it can also be recommended for the evaluation of vts centers in vessel traffic management keywords ship density ais distribution characteristics non parametric kernel density estimation 1 introduction with the development of the economy the shipping industry has also developed driving the port industry into a stage of rapid development the rapid growth of the port traffic has led to marine traffic accidents happen frequently with heavy losses and the traffic situation is becoming severe to some extent the ship density reflects prosperity of shipping economy the higher the ship density is the more prosperous the economy is the ship density also reflects the risk level of maritime traffic wang et al 2019a the higher the ship density is the greater the probability of maritime traffic accidents is and the higher the risk of maritime navigation exits automatic identification system ais data contains a variety of information such as static information dynamic information and voyage related information which has motivated many efforts to study ship trajectories from different aspects liu et al 2020 e g ship density kim et al 2014 and motion pattern sheng and yin 2018 the characteristic of ship density is depicted on the chart to form the ship density distribution map at present there are many studies based on ship density map which can be seen that the number of ships in the ports estuaries and waterways is relatively great to ensure the port economy flourish it is necessary to study how to keep the reasonable distribution of ship density so that there is no congestion in case of heavy traffic under this background some researches li et al 2016 wu et al 2017 carried out the qualitative observation of ship density i e mapping ship density which cannot meet the needs of maritime traffic supervision in some cases so many researches began to focus on the quantitative analysis of ship density at present there are four methods to establish the different models for ship density the first method is using radar screen photos or aerial photographs to get the number of ships in the water area and further calculate the ship density the second is counting the number of ships in the study area in a certain period of time before and after the designated time and approximately calculating the number of ships in the study area instantaneously and then divided by the area of water to obtain the instantaneous ship density tang et al 2012 used this method to design an algorithm for plotting ship density distribution the third is to get the ship density by the frequency of sending ais information natale et al 2015 calculated the ais data entries in each grid by meshing the research waters and drew the density distribution map of fishing vessels in the research waters mazzarella et al 2014 used ais information coverage rate to characterize ship density but it is not comprehensive and accurate to describe ship density by ais information coverage rate exclusively the fourth is to characterize ship density in a variety of ways ning et al 2015 proposed a method for calculating ship density based on the grid statistics the statistical information includes the number of ais messages sent the interval between ais messages the number of ships passing through the grid and how long the ships stay in the grid dai et al 2019 proposed a grid based ship density assessment method which uses the frequency of ships in the grid as an index to evaluate the ship density in the grid liu et al 2019 proposed a ship density model based on the radial distribution function in molecular dynamics which identifies the density based on the relative distance between ships in summary most of the ship density models are based on ais data ma 2016 and require a large amount of ship traffic data the traditional ais data storage method based on trajectory points needs huge storage space so that it is difficult to process and analyze quickly and effectively in addition most of the ship density model are based on the number of ships in the research water area or the number of ais messages sent in the research area pietrzykowski et al 2015 ignoring the influence of ship size on the ship density to characterize maritime traffic risk if the ship size is not taken into account at all the maritime traffic risk level reflected by the calculated ship density would be different from the actual situation although zhu and liu 2014 calculated ship density taking into account ship length conversion there is no quantitative analysis of the characteristics of ship density before and after conversion and only the ship density in port waters was studied moreover most of the researches focus on the calculation method of ship density and the drawing method of ship density distribution chart but there are few studies on the quantitative analysis of the law of ship density distribution in the field of ship traffic risk assessment instantaneous ship density is suitable for dynamic assessment however the instantaneous ship density is not representative in the overall assessment and it is necessary to study the distribution law of ship density quantitatively to accurately assess the ship traffic risk in this paper the characteristics and laws of ship density distribution in different type of water areas are studied mainly by quantitative analysis the ship density can be regarded as a continuous random variable consequently it is necessary to understand the probability density function of ship density for studying the law of ship density distribution im and luong 2019 established a zone around a ship which is based on concept of ship domain by using kernel density algorithm there have also been some studies lampe et al 2010 lampe and hauser 2011 on the visualization of kernel density estimation kde of maritime traffic at present kde is the dominating means to visualize the ship traffic density wang et al 2019b however in the field of estimation of probability density function of random variable the non parametric estimation method overcomes the shortcoming of the parameter estimation method that needs to assume the distribution of the data sample in advance the non parametric kde method was first proposed in 1962 parzen 1962 which is completely data driven to solve the probability density function it has been applied in many fields such as analysis of stock market hu and zong 2014 description of uncertainties of wind power yang et al 2019 and intelligent video surveillance system zhang et al 2015 a collection of non parametric density estimation algorithms for high dimensional data were also reviewed wang and scott 2019 cheng et al 2017 proposed a non parametric localized bandwidth selection method and developed an asymptotic theory for it in a word most studies based on ship density have the following limitations first of all traditional ais data based methods require large storage space moreover the model of ship density without considering the effect of ship scale makes the calculation results inaccurate furthermore there is no comprehensive and detailed quantitative analysis of ship density and ship density distribution for different type of water area to address these problems ship scale conversion and non parametric kde method are introduced to model ship density the model of ship density based on ship scale conversion and grid is presented for the first time the non parametric kde method is chosen to establish the probability density function of the ship density which is a random variable the effect of different ship sizes on ship density is considered to obtain the characteristics of ship density in addition the distribution law of ship density can be obtained by calculating the ship density statistical characteristics the proposed method can be used to measure the risk of ship traffic more accurately based on the above mentioned ideas the main contributions of this paper are as follows a grid based ais data storage method is proposed for the grid based ship density calculation method to reasonably study the distribution law of ship density in a certain period of time the sampling time is discussed according to the ship speed and grid size secondly a ship density model based on ship scale conversion and grid is established to reduce the influence of ship size on ship density thirdly the probability density function estimation model of ship density is proposed by non parametric kde method finally the distribution law of ship density in different type of water areas are quantitatively analyzed 2 ship density model ship density and ship density distribution are the basic concept of the real situation of marine traffic in a certain water area which can reflect the busyness and the risk level of marine traffic to a certain extent the actual distribution of ship density in the study area is obtained by using ais data transmitted by ships in this paper 2 1 definition of ship density in the field of marine traffic safety research ship density includes instantaneous ship density and average ship density pan 2007 instantaneous ship density refers to the number of ships per unit area at a given moment which is obtained by dividing the number of ships in instantaneous by the area of the waters according to the definition the instantaneous ship density of grid i at time t can be represented as follows 1 d i t n i t s i where d i t is the ship density of grid i at time t n i t is the ship number of grid i at time t and s i is the area of grid i the average ship density is the average of several instantaneous ship densities the average ship density in the grid i can be calculated as formula 2 2 d i t 0 t n d i t n where d i is the average ship density of grid i and n is the sampling frequency according to the time interval of hours the average ship density of hours can be obtained in the same way the average ship density of days can also be obtained according to the time interval of days 2 2 ship density calculation model based on ship scale conversion ship size is the basic concept of ship scale gao 1986 to study the influence of different ship sizes on maritime traffic many countries have classified ships according to different ship size although the classification is primarily based on gross register ton and ship length the results vary from country to country depending on the perspective and purpose of the classification for example chinese researchers of marine traffic engineering mainly consider ship traffic accidents while japanese scholars mainly consider ship traffic investigation and british researchers consider the risk factor when they classify ships ship density can reflect the risk level of ship traffic in the water area the danger level of ship traffic in the water area is not only determined by the number of ships but also the size of ships in general the greater the number of ships in the waters is the higher the danger level is for waters with the same number of ships the larger the ship size in the waters is the higher the calculated ship density should be shao et al 2010 therefore the ship size should be taken into account when calculating ship density for evaluating the risk of maritime traffic to compare the ship traffic status in different time of the same water area or ship traffic status in different water area at the same time the ships in a certain size are often selected as the standard ships for conversion in the study of marine traffic a specific ship size is selected as the standard ship and ships of other sizes are assigned different conversion coefficients and then the numerical value of ship density is calculated in this way the ship density based on standard ship can reflect the danger level of ship traffic more accurately the selection of standard ship is mainly based on different research purposes usually the mainstream ships in a certain water area are selected table 1 is the ship conversion coefficient proposed by china when adopting safety index method to assess maritime traffic safety which has been used widely after the conversion coefficient is obtained the calculation formula of the instantaneous ship density changes accordingly the contribution of larger ships is increased in the calculation of ship density smaller ship size is used to reduce its contribution to the calculation of ship density the final instantaneous ship density formula is as follows 3 d i t s 1 s n i t c o n v e r t s h i p s s i where c o n v e r t s h i p s is the conversion function the conversion coefficient is queried in table 1 by the ship length or gross register ton of the ship which is represented as s h i p s when the gross register ton and the length of ship are known but their correspondence is inconsistent with table 1 the ship length should be considered first 2 3 probability density model of ship density the probability density function of ship density is estimated by non parametric kde method non parametric kde is purely non parametric in the sense that it makes no assumption at all regarding the parametric form of the true density the result is explicitly determined by the training data this property gives the non parametric kde an advantage over other methods regarding the ability to accurately describe the spatial distribution and density characteristics of ships laxhammar et al 2009 supposing x 1 x 2 x n is a sample of the random variable x the probability density function of x which is represented as f x is estimated by the kernel function as formula 4 4 f ˆ x 1 n h i 1 n k x x i h where f ˆ x is the estimate of f x x is a random variable representing ship density x i is a sample representing the s h i p i ship density h represents the bandwidth n is the number of samples and k represents the kernel function since each data needs to be computed the amount of computation is determined by the sample size n the larger the sample size is the greater the computation amount is the kernel function selection is the first step in estimating the probability density function of a random variable using non parametric kde at present the common kernel functions are cosine linear epanechnikov gauss and so on the most important factor affecting the outcome of the random variable s probability density function estimation is the choice of bandwidth if the bandwidth h is too great the probability density function f ˆ x of random variable will be over averaged and the probability density curve of random variable will be too smooth to make the random variable show uniform distribution if the bandwidth h is too small the probability density curve of the random variable is less smooth and the f ˆ x of random variable is a sharp pulse so that the random variable appears as a needle like distribution 3 methodology the model of ship density is based on grid so it is necessary to divide the water area into grids and store the ais data based on grid this not only reduces the storage space of ais data but also improves the efficiency of calculation process the kernel function and bandwidth need to be determined when estimating the probability density function of ship density using the non parametric kde method therefore the key technologies involved in ship density model include grid division ais data storage based on grid kernel function and bandwidth selection 3 1 grid division and selection of sampling interval the grid is composed of two dimensional interlaced straight lines and it is divided in many ways in this paper the grid is divided along the longitude and latitude the method of ship density calculation based on grid can refine the spatial distribution characteristics of ship density and the grid based ais data storage method can improve the calculation efficiency in the process of ship density calculation the accuracy of ship density reflected by different spatial resolution is different by choosing the appropriate spatial resolution the grid can not only display the spatial distribution characteristics of ship density but also control the computation amount and storage space within a reasonable range if the area covered by the mesh is too large the precision of the ship density distribution would be reduced otherwise the amount of calculation will increase sharply in the process of grid division most of the researches are based on degree or minute the commonly used grids are 10 10 1 1 0 01 0 01 10 10 1 1 the suitable sampling time interval should be determined at first because the minimum sampling time interval would directly affect the calculation results of ship density especially in the calculation process of average ship density if the sampling time interval is too long the ship density obtained is less accurate and more discrete on the contrary the overall ship density law is easily submerged in the local features to ensure the accuracy of ship density calculation it is necessary to select the appropriate grid size and sampling interval the grid width and sampling interval must satisfy the following conditions 5 t v m a x l where t is the sampling time interval l is the grid width v m a x is the maximum speed of the ship the product of t and v m a x is not greater than l that is the distance of sailing should not exceed the width of grid when the ship sails at maximum speed v m a x for t only in this way can the accuracy of ship density for evaluating the risk of maritime traffic be guaranteed the calculation results of ship density in these grids would be inaccurate if the sampling time interval is too great otherwise it would result in a significant increase in the amount of computation according to this rule the larger the grid is the greater the sampling time interval is selected meanwhile the smaller the grid is the smaller the sampling time interval should be selected 3 2 grid based ais data storage method the grid based ais data storage algorithm stores ais trajectory data in the form of grid establishing the mapping of data points to grid cells and using the passing grid sequence as the storage unit a ship s trajectory data set p p i 0 i n is obtained by its mobile maritime service identity mmsi all trajectory points of the p set constitute the n trajectory segments for each trajectory segment the span of time latitude and longitude are as formula 6 6 δ t p e t p s t δ λ p e λ p s λ δ φ p e φ p s φ where p s is the starting point p e is the ending point p s t p s λ and p s φ represent the time longitude and latitude of starting point respectively while p e t p e λ and p e φ are time longitude and latitude of ending point respectively the data set of ship trajectory p p i 0 i n is composed of two adjacent trajectory points p i and p i 1 p i is set as the starting point p s and p i 1 is set as the ending point p e it is necessary to determine whether the starting point p s and the ending point p e belong to the same grid if p i 1 belongs to the same grid with p s the next track point p i 2 is set to the ending point p e until the starting point p s and the ending point p e are not in the same grid if there is no intersecting relationship the next grid is traversed if there is an intersecting relation the intersection point p is calculated the above process is looped until all the grids have been traversed therefore it can be detected by traversing all the grids whether there is an intersection between the four boundaries of every grid and the line segment that connected by p s and p e the instantaneous motion of a ship has the characteristic of constant velocity that is the motion from the starting point p s to the ending point p e of a trajectory is a uniform linear motion by calculating the ratio of the navigational distance of the ship in each grid to the total navigational distance the stay time of the ship in the grid is calculated according to the total voyage time if δ λ 0 the line segment formed by starting point p s and ending point p e is parallel to longitude that is the line connecting p 1 and p 2 is parallel to longitude therefore the ratio of the width of the grid to the length of the trajectory segment is that of the time passing through the grid to the total time of the trajectory segment 7 c t g i p i 1 φ p i φ l φ δ t i 0 1 n 1 where c t g 1 is the sailing time of the ship in the grid g i the line segment connecting the starting point p s to the ending point p e is parallel to latitude when δ φ 0 whereas the projection is made in the longitude direction for the corresponding segment when δ φ 0 the ratio of the ship s stay time in the grid to the total time of the trajectory segment is equal to the ratio of the distance between the two projection points to the total length of the projection l λ therefore the sailing time of the ship in the grid is obtained using formula 8 8 c t g i p i 1 λ p i λ l λ δ t i 0 1 n 1 the trajectory base on points is transformed to the grid based representation which is g g 1 g 2 g n where each trajectory point is g i t t t is the time to enter the grid g i and t is the stay time of the ship in the grid g i a database is created by storing ais data in a grid as shown in table 2 to further study whether the grid based ais data storage method can reduce the storage cost the original ais data is re stored monthly in a database the number of records in each month of the ais database are compared and the results are shown in fig 1 the grid based ais data storage method saves about 64 of the storage space which greatly reduces the number of records in the database and the use of storage resources it is only necessary to pay attention to the time of the ships enter the grid and the time of stay in the grid because the calculation of instantaneous ship density is carried out in grid units the ais data storage method based on grid can save the storage space because it stores the information that is essential for calculating ship density and ignores the navigational details of ships in the grid 3 3 non parametric kde method for ship density 3 3 1 kernel function selection although the choice of the kernel function is one of the factors that influence the accuracy of calculation in solving the probability density function problem using the non parametric kde method the kernel estimation is not sensitive to the kernel function in the case of sufficient number of samples theoretically under the condition of independent distribution of the same sample kernel estimation method has the properties of asymptotic normality asymptotic unbiasedness and strong consistent hence reliable density estimation results can be obtained by using any kernel function some literatures use the parametric generalized gaussian chen et al 2015 or laplace chen et al 2017 as kernel functions to derive the robust state estimator to verify the influence of different kernel functions on ship density estimation four common kernel functions are selected for experimental comparison to select the optimal kernel function commonly used kernel functions include cosine linear epanechnikov gaussian and so on the expressions for the kernel function are shown in table 3 the 184 h average ship density is used as a sample and the probability density functions of ship density shown in fig 2 are estimated with constant bandwidth by cosine linear epanechnikov and gaussian kernel functions respectively the probability density curves obtained by different kernel functions tend to be approximately the same when estimating the probability density function of ship density using different kernel functions only with different degree of smoothness the epanechnikov kernel is the least smooth and the gaussian kernel is the smoothest eight different kernels i e uniform triangular epanechnikov quartic triweight tricube gaussian and cosine have been parallelly compared huang et al 2020 the comparison results show that the gaussian kernel function can produce more suitable kde based visualization of mass traffic trajectories therefore the gaussian kernel is chosen as the kernel function in the non parametric kde method for estimation of the probability density function of ship density 3 3 2 bandwidth selection the bandwidth is a crucial factor affecting the results of non parametric kde beside the kernel function the bandwidth has a greater impact on the result compared with the kernel function if the bandwidth is too great the estimated result can not reflect the individual characteristics of the sample data otherwise the individual characteristics would be too obvious in the estimation result even there is no sample in some interval this makes it difficult to provide a reasonable interpretation of the result the probability density function of ship density is estimated by selecting the gaussian kernel function with bandwidth h 0 5 h 1 h 2 respectively using 184 h average ship density as the sample the results are shown in fig 3 it can be seen that the probability density curves of ship density using different bandwidths are quite different when the bandwidth h 0 5 the probability density curve of ship density is very tortuous which fully reflects the change of probability density values corresponding to different ship density values however the curve is too tortuous and the law of the probability density of ship density cannot be summarized when h 2 the probability density function of ship density is very smooth with only one peak although the probability density of ship density is roughly described the description of the details is too rough and does not describe the fluctuation of the probability density value the obtained curve has a better smoothness by using bandwidth h 1 and the probability density value of different ship density shows a suitable high or low variation in order to get the probability density function of ship density with less error and keep the smoothness of the result curve it is necessary to select the optimal bandwidth one of the methods to select the optimal bandwidth is the cross validation method yang et al 2018 the cross validation method is used to determine the optimal bandwidth by calculating the integral square error ise ma et al 2019 the bandwidth is considered as the optimal when the ise reaches the minimum ise is calculated as formula 9 9 i s e f ˆ x f ˆ x f x 2 d x f ˆ 2 x d x 2 f ˆ x f x d x f 2 x d x where f ˆ x is the estimated probability density and f x is the actual probability density in the process of calculating the ise f x can be ignored in the process of solving i s e f ˆ x because it is independent of the bandwidth on the contrary f ˆ x is related to the bandwidth therefore the process of solving the optimal bandwidth is transformed into solving the bandwidth when the expression f ˆ 2 x d x 2 f ˆ x f x d x takes the minimum value the expression is then further split into two parts one part is i 1 f ˆ 2 x d x and another part is i 2 2 f ˆ x f x d x then two expressions are expanded separately as shown formula 10 and 11 10 i 1 i 1 i n j 1 j n k x i x j h n 2 h 11 i 2 i 1 i n f ˆ i x i n i 1 i n j 1 j i j n k x i x j h n n 1 h where f ˆ i x i is the probability density estimator after excluding the i sample the optimal bandwidth h f ˆ x of the probability density function obtained by the cross checking method is expressed as formula 12 12 h f ˆ x arg min h 0 i 1 2 i ˆ 2 taking the 184 h average ship density as a sample and selecting the gaussian kernel function the experiment for estimating probability density function of ship density is performed 20 times with bandwidth h 0 1 h 0 2 h 1 9 h 2 respectively for these 20 calculations the result of ise at different bandwidths is shown in fig 4 as seen from fig 4 the ise of the probability density function is different with bandwidth when h 0 6 the ise becomes smaller and smaller when h 0 6 the ise is increasing with the increase of bandwidth therefore the optimal bandwidth is 0 6 in this paper where the ise is the minimum however for many practical applications the choice of optimal bandwidth is still a problem that is not completely solved in practice the optimal bandwidth can be selected according to experience and practical situations 4 experiments a general understanding of the distribution characteristics of ship density sample data is obtained by using the grid based ship traffic data which is processed from ais data however there is a lack of representative quantitative eigenvalues to accurately describe the distribution of these data the characteristics of data distribution can be measured and described from three aspects firstly the centralized trend of data distribution can be measured by mean and median secondly the dispersion of data distribution can be measured by standard deviation and variance thirdly the skewness and kurtosis of the data distribution can be reflected by the probability density curve of the data sample this paper studies the distribution characteristics and distribution law of ship density in the fairway anchorage and harbor area of tianjin port respectively the study area is the whole tianjin port area including dagukou north anchorage dagukou south anchorage tianjin port main fairway tianjin port harbor basin area and other functional waters it ranges from 117 30 to 118 48 in longitude and from 38 36 to 39 18 in latitude the corresponding geographic location is shown in fig 5 in the experiments ais data was used from 00 00 00 may 1 2018 to 23 59 59 october 30 2018 table 4 shows the number of ships of different lengths counted after data cleaning based on the distribution characteristics of tianjin port waters this paper divides the tianjin port waters into 42 78 grids which are coded with row and column number connected by underline the unique latitude and longitude range are used to identify the geographical location of the grids considering the overall distribution of vessel speed in the waters of tianjin port to select v m a x the distribution of vessel speed in the waters of tianjin port is shown in fig 6 the ship speed is mainly concentrated between 0 and 20 knots ais data for ships with speed less than 15 knots accounted for 98 of the total data and with speed less than 12 knots accounted for 90 considering the effect of the ship speed on the grid size selection and the sampling time interval the maximum ship speed is selected as 12 knots correspondingly the grid size is selected as 1 1 according to formula 5 that is 1 nautical mile 1 nautical mile approximately consequently the sampling time interval is set to 5 min using ais data on may 1 which is stored by the grid based storage method the converted quantity of ships in the grid at every hour on the hour were obtained according to corresponding conversion coefficient of the ship size the hourly average ship density of the grid is calculated by dividing the sum of converted quantity of ships by 24 and the grid area the hourly average ship density of all the grids is got by traversing all the grid based data which is used to plot the ship density distribution map as shown in fig 7 fig 7 only shows these grids with ship density value in the interval 0 5 because the calculated hourly mean ship density values are mainly concentrated between 0 5 to show the details of the ship density distribution map the ship density value is replaced by 5 if it is greater than 5 it can be found from fig 7 that the water area with higher ship density is concentrated in the functional waters such as harbor basin area fairway and anchorage while the lower vessel density in the non functional waters is between 0 and 1 4 1 performance analysis of ship density calculation model based on the standard ship to emphasize the novelty and advantages of the proposed model a comparison is performed between the ship density model based on standard ship and the traditional density models in previous studies the selected traditional ship density model wu et al 2017 is built as the number of ships per unit area at a given moment this traditional density model is also used in many other previous studies of ship density marine management organization 2014 aronsen 2017 the difference in the calculation results of ship density between the traditional model and the proposed model in this paper can be visualized in fig 8 there are three grids of the same size each with 6 ships the density calculated using the traditional density model i e density 1 are all 6 the density obtained using the proposed model in this paper i e density 2 is relatively great in the grids with large ships based on the ais data on october 5 the method of calculating ship density only considers the number of ships and the method of calculating ship density based on the standard ship are used to calculate the instantaneous ship density of the 24 main fairway grids at 10 o clock respectively as shown in fig 9 the yellow bar represents the ship density calculated by the number of ships the red bar represents the ship density based on standard ship according to the ship density of different fairway grid the ship density of fairway grid calculated only by the number of ships and the ship density based on standard ship are ranked shown in table 5 as can be seen from table 5 the ship density of grid 23 21 ranks second by considering only the number of ships the ship density is 4 ships per square nautical mile however the grid 23 21 ranks fourth by the ship density model based on standard ship the ship density of grid 31 20 ranks fourth with 3 ships per square nautical mile but it ranks second by the ship density model based on standard ship the main reason is that the corresponding conversion coefficients are 1 18 1 18 2 2 25 according to the ship lengths which are 96m 113m 168m and 180m respectively among the four ships in the grid 23 21 meanwhile corresponding conversion coefficients are 0 5 4 4 because the ship lengths are 40m 260m and 266m respectively in the grid 31 20 although there are more ships in the grid 23 21 the ship size is relatively small the value of ship density becomes smaller using the conversion coefficient of ship length and the ranking of ship density is changed correspondingly in the 31 20 grid the number of ships is relatively small but the ship size is relatively great therefore the value of ship density becomes greater by using the conversion coefficient of ship length and the ranking of ship density is changed as well both the grid 31 20 and 32 20 have 3 ships per square nautical mile but the grid 31 20 ranks second based on standard ship while the grid 32 20 ranks sixth based on standard ship the main reason is the different ship length in grids in the grid 31 20 the ship lengths are 40m 260m and 266m respectively according to table 1 the corresponding ship conversion coefficients are 0 5 4 and 4 respectively whereas three ships appear simultaneously in the grid 32 20 having lengths 35m 40m and 266m respectively according to table 1 the corresponding conversion coefficients are 0 5 0 5 and 4 respectively the ship density based on standard ship of grid 31 20 is relatively great because the ships in grid 31 20 are relatively large in length although the number of ships in grid 31 20 is the same as that in grid 32 20 on the contrary the ship size in the grid 32 20 is relatively small the ship density is reduced and the order is also changed by using the conversion coefficient of ship length the risk level of maritime traffic is not only determined by the number of ships but also by the size of ships consequently the ship density which is obtained by the number of ships in the water area per unit area at a certain instant does not accurately reflect the risk level of maritime traffic in the waters because the ship size is not taken into account at all the ship density taking account for ship size can better reflect the risk of ship traffic 4 2 validation of probabilistic density model of ship density a total of 184 hourly average ship density values are obtained from may 1 to october 31 the 184 hourly average ship density values are taken as samples and the probability density function of the ship density is obtained by using the proposed model to measure the performance of the proposed model for estimating the probability density function it is necessary to verify the above results the kolmogorov smirnov ks test is a method based on kolmogorov theorem which is mainly used to test the fit degree between the empirical distribution and the hypothesized distribution of the data sample the ks test is a non parametric hypothesis testing method that does not require the distribution of the sample data in advance at the same time ks test is a stable method because that the test effect of it does not change in the case of a change in the position of the sample mean in testing the one dimensional sample of ship density using the ks test the empirical distribution function f n x is generated from the ship density sample data the estimated cumulative distribution function g x is obtained by integrating the probability density function of the ship density obtained in this paper the f n x and g x are compared to determine the matching degree the specific steps are shown below 1 formulation of hypotheses 13 h 0 f n x g x h 1 f n x g x 2 constructing the test statistic as 14 k s max f n x g x if h 0 is true that is the match between f n x and g x is high k s is a value with a tendency to be small and vice versa therefore the match between f n x and g x can be judged by the k s value in the same way the accuracy of the probability density function of the ship density obtained in this paper is further judged when g x is a continuous distribution function the limiting distribution of k s can be obtained if h 0 is true as shown in equation 15 15 lim n p n k s t 1 2 i 1 1 i 1 e 2 i 2 t 2 t 0 3 setting the critical value d based on the ship density sample data 4 calculating the k s value and comparing the k s value with the critical value d 5 making an acceptance or rejection judgment on the hypothesis when k s d it indicates an acceptance judgment on the original hypothesis when k s d it indicates a rejection judgment on the original hypothesis comparing the cumulative distribution function g x with the empirical distribution function f n x and the results are shown in fig 10 it can be seen that the g x function blue curve and f n x function red point have a good match this indicates that it has good performance for the probability density function of the ship density obtained by choosing the gaussian kernel function and bandwidth h 0 6 the ks test method is used for g x and f n x the critical value d 0 05 is set and ks 0 6476 is obtained by equation 15 because k s d it means that the acceptance judgment of the original hypothesis is made when the critical value of the ship density sample data is 0 05 it is concluded that the results of the ship density function obtained by using gaussian kernel function are reliable at the bandwidth h 0 6 4 3 studying on the law of ship density distribution 184 hourly average ship density values of each grid are obtained by traversing all the grid based data taking the 184 hourly average ship density of each grid as a random the probability density function of ship density is estimated by the non parametric kde method fig 11 shows 100 grids with relatively high hourly average ship density it can be seen that the 100 grids with high hourly average vessel density are mainly concentrated in tianjin harbor basin area main fairway of tianjin port caofeidian fairway and other functional waters 100 grids with high hourly average ship density are selected accordingly the frequency distribution histogram of the ship density and the corresponding probability density function are shown in fig 12 the horizontal coordinate of each subplot represents the range of values of the data samples the product of the vertical coordinate and the width of the horizontal coordinate represents the probability the ship density curves of the different grids obtained by the non parametric kde method are smooth and no unevenness at the same time the estimated probability density curves describe the fluctuation of ship density well the probability density curve with twin peaks of a few grids is well handled to keep the smoothness and to show the detail of peaks as well to further explore the distribution characteristics of ship density different water areas such as the fairway anchorage and harbor basin area are studied in detail this paper describes the statistical characteristics of ship density from probability density function mean median variance and standard deviation and explores the distribution law of ship density in different functional waters 4 3 1 ship density distribution in anchorage to study the ship density distribution of anchorage 40 grids representing dagukou north anchorage and dagukou south anchorage of tianjin port are selected as the research areas it should be noted that these 40 grids cannot completely describe the north anchorage and the south anchorage of dagukou because the 1 1 standardized grids do not match the anchorage exactly moreover not all of these 40 grids belong to anchorages maybe there are some discrepancies in details the 40 grids depict the corresponding locations of the dagukou north anchorage and dagukou south anchorage as shown in fig 13 the frequency distribution histogram of ship density corresponding to each anchorage grid and the estimated probability density curve of ship density are shown in fig 14 it can be seen that the probability density curves of ship density in north anchorage and south anchorage of dagukou are mainly single peak but less double peaks the top of the curve is relatively steep which indicates that the ship density in the anchorage area is concentrated showing the characteristics of small range aggregation several grides with double peaks such as 28 21 29 21 30 21 31 21 33 21 34 21 36 20 are located near the main fairway this indicates that ships travel between anchorage and fairway frequently resulting in the emergence of double peaks or multiple peaks the statistical characteristics of ship density for each anchorage grid are shown in fig 15 the ship density distribution of dagukou north anchorage and dagukou south anchorage can be classified into two types ship density of grid in the anchorage area near fairway and ship density of grid in the anchorage area away from fairway the mean and median of ship density in the grids 28 21 29 21 30 21 31 21 32 21 34 20 35 20 36 20 near the fairway is relatively great mainly distributing in the interval 1 2 5 and the variance is relatively great mainly in the vicinity of 0 5 the mean and median of ship density in the grids away from the fairway are relatively small mainly distributing in the interval 0 2 0 4 and the variance is relatively small generally less than 0 2 the results show that the ship density in the anchorage area near the fairway is great and the dispersion trend is large while the ship density in the anchorage area far from the fairway is small and the dispersion trend is slight 4 3 2 ship density distribution in the fairway 24 grids representing the main fairway of tianjin port are selected as the research objects since it is a standardized grid of 1 1 divided according to the latitude and longitude direction these 24 grids cannot completely match the main fairway of tianjin port the geographic location of the tianjin port main fairway described by these 24 grids is shown in fig 16 the frequency distribution histogram of ship density corresponding to each fairway grids and the estimated probability density curve are shown in fig 17 it can be seen that the probability density curves of ship density in the main fairway of tianjin port are mainly single peak but a few double peaks and the top of the curve is relatively flat without sharp the main fairway of tianjin port is a two way fairway so probability density curves appear twin peaks in some grids to ensure safe navigation the ships in the waterway would maintain a safe distance between each other and the overall distribution of ships in the fairway is relatively uniform consequently the top of the probability density curve of the fairway is relatively flat statistical characteristics of ship density for each fairway grid are shown in fig 18 means of ship density in the fairway grids 25 20 26 20 27 20 28 20 29 20 30 20 which have the same latitude are 0 17 0 22 0 29 0 51 0 96 1 30 2 40 2 49 respectively mean of ship density becomes greater with the increasing of longitude and the variance increases from 0 02 to 0 6 the mean value of the ship density in fairway grids 31 19 32 19 33 19 34 19 35 19 36 19 at another latitude increases from 0 25 to 1 56 as the longitude increases and the variance increased from 0 03 to 0 5 therefore the average and variance of ship density in the fairway increase with the increase of longitude the primary reason is that the fairway length in each grid is different and the fairway length within the grid increases with the increase of longitude the second reason is that ships head to different destinations after leaving the main fairway which causes the ship distribution dispersing and the variance increasing the ship traffic in the area with low longitude is not busy which resulting in a small value of mean of ship density because there are docks and berths for ship berthing loading and unloading in addition there is busy traffic at the high longitude area away from the berthing area because ships sail in and out of tianjin port and to other ports resulting in a great value of mean of ship density 4 3 3 ship density distribution in harbor basin 18 grids representing tianjin port harbor basin area are selected as the research objects to study the distribution of ship density in the harbor basin the shape of the harbor basin is usually complex and changeable so it is difficult to match with these grids accurately as shown in fig 19 these 18 grids fully cover harbor basin the frequency distribution histogram of ship density corresponding to each harbor basin grid and the estimated probability density curve of ship density are shown in fig 20 the probability density curve of ship density in harbor basin of tianjin port is mainly single peak and the top of the curve is generally very steep the probability density curve of the harbor area is steeper than that of the anchorage which indicates that the distribution of ships in the harbor area is more concentrated than the anchorage because there are more ships in the harbor basin docked near berths but few ships in other water areas the probability density curve is almost single peak in harbor area which indicates that the number of ships in the harbor basin is stable the statistical characteristics of ship density for each harbor basin grid are shown in fig 21 the ship density varies with geographical location because of the different proportions of water area and land area in each grid the average of ship density in grids such as 16 25 16 24 16 23 17 23 is much greater than that of grids such as 20 21 21 21 22 21 which indicates that the ship density is decreasing as ships sail from the external fairway into the inner harbor areas such as the eastern port area in a word the ship density in harbor basin is high while the ship density in anchorage and fairway is low from the trend of data concentration according to the dispersion degree of the ship traffic data the dispersion degree of the harbor basin is large the ship density distribution of the anchorage and the fairway is more uniform in the terms of data skewness the probability density curve of ship density in the harbor basin is the sharpest following by the anchorage and that of the fairway is relatively flat 5 conclusion the appearance and extensive use of ais provides abundant data support for maritime situational awareness msa but it poses a challenge on how to store and process massive data in this paper a grid based ais data storage method was proposed which reduces the storage space of ais data and lays a foundation for calculating ship density efficiently and accurately this paper built a ship density method based on ship scale conversion which can reflect the risk level of ships accurately in the waters in order to further study the law of ship density taken ship density as a random variable a non parametric kde method was used to estimate the probability density function of ship density obtaining the mean median variance and standard deviation etc this paper explored the statistical characteristics and distribution rules of ship density in the fairway anchorage and harbor basin of tianjin port the distribution of ships in the harbor area is the most concentrated followed by the anchorage area while the distribution of ships in the fairway is dispersed and uniform when a ship sails from the fairway to the anchorage it will lead to a relatively large density of ships in the local area and the distribution is discrete and dynamic which is prone to congestion in the harbor basin area as the ships sail into the internal waters the ship density increases with the decrease of navigable waters the previous analysis proves that the model proposed in this paper can accurately describe the characteristics and laws of ship distribution in different waters according to the characteristics of ship density in different areas obtained in this paper theory support and management suggestions can be provided for the safety supervision and macro traffic evaluation of the maritime safety administration 1 anchorage the maritime safety administration should strengthen traffic monitoring and organization at anchorage and surrounding waters and the vts center should reasonably arrange anchorages to ensure the safety of navigation in anchorages and the surrounding waters 2 fairway relevant departments should make rational use of navigational resources and functions of transportation organization to maintain the appropriate density distribution and ship flow and improve the efficiency of ship traffic 3 harbor reasonable arrangements should be made for the loading unloading and anchoring of ships to prevent the occurrence of ship congestion in the docks the ship density based on ship scale conversion and kernel estimation presented in this paper can calculate the ship density with high efficiency and accuracy and reflect the risk of marine traffic ship density directly reflects the busyness of ship traffic and the distribution characteristics of dangerous goods ships and large ships and the motion characteristics of engineering ships also determine the level of navigation safety therefore the calculation indicators of ship density can be composed of weighted ship traffic volume the proportion of different types of ships the impact of engineering ship on traffic and so on in addition more kernel functions should be taken into account in future studies to find the optimal credit authorship contribution statement jiaxuan yang conceptualization methodology software validation resources formal analysis lingqi ma data curation visualization writing original draft writing review editing jiaguo liu investigation supervision funding acquisition project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is partly supported by the fundamental research funds for the central universities dmu 31320210131 the authors are grateful to the editors and anonymous reviewers whose thoughtful comments and suggestions have contributed to improving of an earlier version of this paper 
20284,swell and wind seas generally co exist in the open ocean and are often difficult to segregate swell and wind sea characteristics of observed wave spectra at off kochi located along india s south west coast in the arabian sea during the south west monsoon are presented this paper attempts to split the observed wave spectra into individual wave partitions thereby enabling the computation of integral wave parameters of each partition the spectra with five partitions is found occur more frequently in the considered season to extract wind sea and swell information from the observed directional spectrum a consistent overshooting phenomenon op modified overshooting phenomenon mop and wave age wa method are employed in each partition the results show a prevalence of mixed sea states an analysis from wa method shows the absence of young wind seas the derived wind wave parameters of the spectral partitioning algorithm agree well with toba s 3 2 law with a good correlation the effectiveness of interaction between the derived swell and sea components is discussed through nonlinear interactions that are occurring between the set of four waves keywords swell sea partition algorithm south west monsoon kochi coast nonlinear wave wave interaction wind wave model 1 introduction the wave climate at an open ocean consists of both swell and wind sea components and their representative spectra often show multi peaks earle 1984 pointed out that the co existence of swell and wind sea can damage offshore structures the identification and segregation of swell and wind sea components characterize the sea state clearly and are essential for scientific and engineering applications most of the swell sea partitioning algorithm resides in the identification of a separation frequency f s wave models such as wavewatchiii tolman et al 2014 and wam thewamdigroup 1988 adapt wave age criteria for swell sea partitioning a threshold for the wave age is defined such that the swell dominates for higher values of it several authors adopted different threshold to separate swell and wind sea 1 3 by bidlot 2001 in the wam model 1 7 by tracy et al 2007 in wavewatch iii 1 5 by hanson and phillips 2001 to include possible wind peaks and 1 2 by de farias et al 2012 churchill et al 2006 carried out sensitivity tests for the directional spectra observed from bottom mounted acoustic doppler current profilers adcp at martha vineyard coastal observatory the spectra were partitioned according to hanson and phillips 2001 using applied physics laboratory apl waves software and proposed a threshold of 1 6 to capture wind sea effectively chen and ma 2002 adopted a separation frequency of 0 1 hz and suggested that this fixed cut off works only when swell and wind sea are explicitly separated in the frequency domain wang and hwang 2001 and gilhousen and hervey 2001 dictated the separation frequency based on wave steepness the scheme states that the steepness of swell part of the spectrum is smaller than wind sea part and maximum in the vicinity of wind sea peak the method is successfully implemented in national data buoy center ndbc the need for such a partition is discussed by bidlot 2001 a detailed review regarding the spectral partitioning schemes and their pitfalls was done by portilla et al 2009 they found that the approach proposed by wang and hwang 2001 tends to underestimate the wind sea particularly when the wind sea dominates the spectrum considering the suggestions of portilla et al 2009 and hwang et al 2012 modified the wave steepness algorithm of wang and hwang 2001 further portilla et al 2009 proposed one dimensional 1d partitioning algorithm called peakedness or over shooting phenomenon op which estimates the ratio between the peak energies of the wave system and pierson moskowitz pierson et al 1964 pm spectrum at the same peak frequency if γ is greater than 1 0 the system is identified as sea else it is considered as swell portilla et al 2015a incorporated the partitioning algorithm into the wam for the period 1979 2013 consisting of six hourly wave spectra amounting to 51 136 spectra yielding 111 093 partitions they also employed the algorithm and analyzed the measured spectra obtained from a directional wave buoy located in the southern north sea portilla et al 2015a b portilla 2017 confirmed this scheme s supremacy over the existing partitioning algorithms few researchers de farias et al 2012 zheng et al 2016 use statistical methods for wind sea separation zheng et al 2016 forced ww3 with european centre for medium range weather forecasts ecmwf https www ecmwf int wind data and produced global wave data for the year 2010 the obtained two dimensional wave spectra were separated into swell and wind sea using a statistical method called spectra energy partition sep scheme the results were linked with wave age method for wind sea the magnitude of the energy transfer between different frequency components decreases with increasingly separated spectral peaks and mean direction between the components of swell and wind sea and vice versa the nonlinear interactions between swell and wind sea systems has been theoretically investigated by several scientists young et al 1985 young 1999 masson 1993 in addition the mechanism of nonlinear interactions helps to understand the energy transfer between swell and sea components of the spectrum vincent et al 2019 mitsuyasu 2015 emphasized that the nonlinear interaction between sea and swell could not be understood specifically masson 1993 studied attenuation of wind waves by swell waves by performing spectrum evolution studies through the nonlinear interaction source term without wind action the energy from the wind part of the bimodal spectrum got transferred to the swell part and became uni modal tamura et al 2009 conducted hind cast wave simulation to understand the sea state at the time of suwa maru accident that occurred in japan during the year 2008 they showed nonlinear interaction between wind and swell waves of the spectra by considering all the source terms in a wind wave model the energy from wind sea was found to transfer to the swell part of the spectrum the spectral evolution showed that the nonlinear interaction of swell and sea was the key to the generation of the narrow swell spectrum at the time of the accident the magnitude of nonlinear interactions spectral peakedness and wave steepness were increased and the mean directional spreading was decreased the present third generation wave models such as wam wavewatch iii and tomawac gagnaire renou et al 2010 use discrete interaction approximation method thewamdigroup 1988 dia for nonlinear energy transfers dia uses only a subset of total interaction space compared to the full boltzmann integral perrie and resio 2009 fbi based on webb 1978 tracy and resio 1982 and hence cannot reproduce similar results as fbi the method is preferred for its computational efficiency despite its shortcomings perrie and resio 2009 uma et al 2018 although there exists several methods for nonlinear energy transfers liu et al 2017 their implementation in models remains a challenging task since these methods when integrated with other source terms in the wave model either give incorrect results or takes more computational time to achieve an efficient method perrie and resio 2009 implemented a two scale approximation tsa method for nonlinear energy transfers in wavewatch iii they showed using observed spectra that the tsa method behaved better than dia corresponding to fbi the observed spectra are taken from currituck sound and open north atlantic ocean conditions during hurricane wilma that occurred in 2005 recently prabhakar and uma 2016 and uma et al 2016 2018 attempted to develop a model for nonlinear energy transfer to improve both computational efficiency and accuracy in the present paper the spectra observed off kochi coast located along the south west coast of india in the arabian sea during the south west monsoon period is partitioned into swell and wind sea systems using different methods the op scheme the modified overshooting phenomenon mop and wave age wa methods the nonlinear interaction uma et al 2018 between swell and wind sea systems is then analyzed the present study implements the partitioning algorithm based on spectral peakedness portilla et al 2009 and hybrid functions of block pulse and lagrange polynomial in webb resio tracy s uma et al 2018 wrt hbl method for nonlinear energy transfers in tomawac model the wrt hbl method s advantage is that it suits for both deep thewamdigroup 1988 and finite water depths direct transfers the existing methods for nonlinear interactions such as dia multiple discrete interaction approximation method tolman 2004 mdia and gaussian quadrature method gagnaire renou et al 2010 gqm in the tomawac model consider the parameterization technique thewamdigroup 1988 for finite depth the source terms attributable to wind input and dissipation in the third generation wave models e g tomawac have been tuned and adjusted for dia in order to replace dia with other methods e g wrt hbl one has to re calibrate the source terms for practical application the organization of the paper is as follows section 2 presents the theory of spectral partitioning for the identification of swell and wind sea systems and the nonlinear interaction between the swell and wind sea through nonlinear interactions section 3 deals with the wave spectral data adopted for the present study section 4 discusses the results with the summarization in section 5 2 theoretical background 2 1 spectral partitioning and methods for identification of swell and wind sea systems the 2d wave spectrum obtained from the buoy response consists of both swell and wind sea components the purpose of spectral partitioning is to segregate swell and wind sea components in the present study the following steps are followed for spectral partitioning a convolution the wave spectrum is subjected to convolution described by 1 e f θ e f θ k m n where e and e are the measured and the convoluted 2d spectra the operator denotes the convolution of the functions e and k the convolution kernel k is chosen as a unit matrix hasselmann et al 1996 of size 3 b partitioning and combining the spectral peaks are identified by the method of steepest ascent called as mountaineer scheme by hasselmann et al 1996 the spectral partitioning is carried out by combining the neighboring peaks partitions upon setting a threshold value for the proximity and the magnitude the partitioning helps in identifying the distinguished wave systems c filtering partitions with negligible energy compared to that of the total spectrum are considered as noise and are filtered out by fixing the energy threshold d fixing partitions the maximum number of partitions is dictated as input to avoid the fallacy of wave systems if the number of partitions exceeds the prescribed number steps 1 3 are repeated till the target number of partitions is achieved the repeated convolution process may end up with blurred or indiscernible wave systems the subsequent calibration methods for wind sea are employed in each of the partitioned wave systems to identify sea and swell components i peakedness phenomenon following portilla et al 2009 the peakedness or overshooting phenomenon op which finds the ratio between the peak energy of a wave system and the pm spectrum γ at the same frequency is applied accordingly the different wave systems are categorized as wind sea or swell following γ 1 wind sea else swell theoretically γ 1 indicates the fully developed wind sea the above threshold value of 1 is arbitrary which has to be fixed by calibration for a given site location here a threshold t is chosen in such a way that the region inverse wave age u 10 c p t includes most of the wind sea peaks γ 1 where u 10 is the wind speed at 10 m above the free surface and c p is the phase speed op method could be employed when the wind information is not available or reliable having said the advantage the method does not include i the wave direction and ii finite water depth conditions as it uses pm spectrum in which there is no depth limitation ii modified overshooting phenomenon mop pm and jonswap spectra are depth independent and hence more suitable for deep water conditions bouws et al 1985 modified the latter as the tma spectrum to suit the finite depth conditions the pm spectrum in the op method is now replaced with the tma spectrum with peak enhancement factor set to unity for calculating γ values since the method is a slight modification to op method it can be named as modified op method the calibration is same as discussed in the op method iii wave age wa method wa method is represented to demarcate with reference to the threshold t komen et al 1994 2 w a c p u where u is the friction velocity the threshold t is chosen in such a way that w a t includes maximum wind sea peaks the present estimation of u is from the default settings janssen 1989 from the wind wave model tomawac to identify sea and swell components 2 2 swell and wind sea interaction modeling to understand the nonlinear interaction of swell and sea components the hybrid function of block pulse and lagrange polynomial in webb resio tracy s wrt hbl method is implemented in the tomawac wind wave model further the behavior of different methods of solving nonlinear source term s n l is also tested in swell sea environment the spectral wave model tomawac a part of telemac mascaret modeling suite solves the action balance equation fitri et al 2016 3 n t x n x y n y k x n k x k y n k y s k x k y x y t where n is the action density n e ω k x and k y are the x and y are the components of the wave number vector ω is the angular frequency and t is the time the term s on the right hand side is the total source term which describes the rate of change of action density at each spectral components due to the physical processes given by 4 s s i n s d s s n l s b f s b r s t r s d s c u r s v e g where s i n is the wind driven energy source s d s is the white capping induced energy dissipation s n l is the non linear quadruplet interactions s b f is the bottom friction induced energy dissipation s b r is the energy dissipation due to depth induced breaking s t r is the non linear triad interactions s d s c u r is the enhanced breaking dissipation of waves on a current and s v e g is the dissipation due to vegetation of the source terms the one due to quadruplet interactions s n l is considered in the rest of the study for understanding the swell sea interaction hasselmann 1960 proposed the basic expression for nonlinear energy transfers occurring between the set of four waves 5 n 1 t g k 1 k 2 k 3 k 4 δ k 1 k 2 k 3 k 4 δ ω 1 ω 2 ω 3 ω 4 n 1 n 3 n 4 n 2 n 2 n 4 n 3 n 1 d k 2 d k 3 d k 4 where g is the coupling coefficient herterich and hasselmann 1980 and n i is the action density at the wave number i 1 4 the linear dispersion relation connecting the angular frequency and the wave number is given by 6 ω i 2 g k i tanh k i h where g is the acceleration due to gravity and h is the water depth now eq 5 is rewritten as 7 n 1 t t k 1 k 3 d k 3 with the transfer function t given by 8 t k 1 k 3 g δ k 1 k 2 k 3 k 4 δ ω 1 ω 2 ω 3 ω 4 n 1 n 3 n 4 n 2 n 2 n 4 n 3 n 1 d k 2 the application of resonance conditions ω 1 ω 2 ω 3 ω 4 0 and k 1 k 2 k 3 k 4 0 reduces eq 8 to 9 t k 1 k 3 ω g n 1 n 3 n 4 n 2 n 2 n 4 n 3 n 1 j d s where ω is the closed integral and j is the jacobian term given by c g 2 c g 4 1 with c g 2 and c g 4 are the group velocities of k 2 and k 4 respectively and expressed as c g 1 2 1 2 k h s i n h 2 k h g k t a n h k h finite depth g ω h deep waters hybrid function of block pulse and lagrange polynomial hbl is used in wrt method to increase the computational efficiency along t the method has the flexibility of choosing the orders of block pulse function n and legendre polynomial m independently uma et al 2018 discussed the details regarding the application of hbl to the transfer integral the application of hbl to eq 9 yields 10 t k 1 k 3 b a n 1 n m 0 m 1 g s n m d s n m j s n m w n m where s n m n 1 n m 0 m are the hbl nodes along the curve ω w n m are the weights and l is the length of the curve now eq 7 in terms of polar coordinates 11 n 1 t t k 1 k 3 k 3 d θ 3 d k 3 is computed the scaling relations applicable in the case of deep waters prabhakar and uma 2016 do not hold in the case of varying depths uma et al 2018 in the tomawac model three methods dia mdia and gqm for solving s n l are available the quadruplet choice in the dia method depends on a single parameter λ which is set as 0 25 according to hasselmann and hasselmann 1985 this choice is adopted throughout the study the choice of quadruplet in mdia depends on two parameters λ μ herein the parameters are set as λ 0 075 and μ 0 023 in the model for the gqm method to compromise between accuracy and efficiency gagnaire renou et al 2010 suggested coarse resolution and the same is used herein for the gqm method the wrt hbl method of analysis of s n l is implemented in the third generation wave model tomawac along with the available methods such as dia mdia and gqm tomawac model has been satisfactorily used by several authors guimarães et al 2019 kirinus et al 2018 for practical purposes 3 data 3 1 observed data the wave spectra obtained from wave rider buoy wrb located at the nearshore kochi region 9 58 33 00 n 76 6 45 01 e have been analyzed in the present study fig 1 in this region the south west monsoon prevails from may to september a wrb was deployed in a water depth of about 21 m to measure the wave climate at every three hours interval the two dimensional 2d wave energy spectrum with 129 linearly spaced frequency bands from 0 005 hz to 0 64 hz and 121 different angles ranging between 0 360 was obtained by using fast fourier transform on the buoy response the measured wave spectra from 01 june 2016 to 30 september 2016 are partitioned to obtain swell or sea systems the three parameters prescribing the spectral shape such as the spectral width f w rogers and vledder 2013 babanin and soloviev 1988 wave steepness a k tamura et al 2009 and mean directional spread σ θ are used in the present study 12 f w m 0 f p e f p 13 a k 2 0 5 π h s l p 14 σ θ 2 1 a 2 b 2 e 2 1 2 1 2 where m n is the n th order moment a e f θ cos θ d f d θ e 2 b e f θ sin θ d f d θ e 2 and l p is the peak wave length of the spectra 3 2 data preparation to facilitate comparison between methods of s n l in wave model the mixed sea state spectra of the monsoon month july are taken into account for further calculations the observed spectra are converted from linear to geometrical spacing to facilitate the comparison among the s n l formulations dia mdia and gqm in the third generation wave model tomawac this conversion makes the integrand except energy spectrum in eq 5 to scale geometrically and thus favors computational efficiency prabhakar and uma 2016 the geometric grid is generated by specifying the number of bins in the spectrum s forward face f f p 1 and matching the spectral peak to a specific grid point when 14 bins in the forward spectral face are desired the geometrically spaced frequency coordinates shall be set as 15 f q f p 1 λ q 14 where f p 1 is the peak frequency q is the radial co ordinate and λ 1 say 1 1 the partitioned frequency spectrum is expressed with two parameter h s f p jonswap spectrum depth corrected in the wave model and the directional spreading is chosen as mitsuyasu model which is incorporated for the purpose of the present study the significant wave height peak frequency and mean wave direction of the partitioned swell and wind sea spectra are denoted by h s 1 and h s 2 f p 1 and f p 2 and θ m 1 and θ m 2 respectively 4 results and discussion 4 1 identification of swell or wind sea systems as an example the spectrum at 1800 utc 05 july 2016 is analyzed in detail measured and convoluted 2d spectrum are shown in figs 2a and b the plus markers in fig 2c show the peaks of the one dimensional measured spectrum whereas the triangle and circular markers denote the convoluted and de noised spectrum s partitions the dashed dotted and continuous lines are the measured convoluted and de noised spectrum employing the mountaineering scheme hasselmann et al 1996 the measured spectrum is identified with 16 peaks markers the application of a 2d convolution on the spectrum reduces the number of partitions to 9 markers merging the partitions by setting an energy threshold of 5 of the total energy and a noise energy threshold of 2 of the total energy the number of partitions further reduces to 4 o markers it is important to note that the de noised spectrum is used to finalize the partitions however to find the peaks of those partitions one always needs to refer to the measured spectrum since the de noised spectral peak would have been smoothened to less magnitude here the partition algorithm yields four partitions and hence the four wave systems are analyzed their characteristics are summarized in the table 1 wave system 1 ws1 fig 2d possesses the maximum spectral energy bin e p over other partitions in terms of integrated parameters ws2 contains more energy than other partitions meanwhile ws4 holds smaller energy in terms of the bin and integrated parameters the parameters of the overall spectrum other than the integrated ones agree with ws1 the respective 2d wave systems ws1 to ws4 are presented in figs 2d g respectively the histogram plot in fig 3 presents the wave systems observed in the monsoon season at off kochi a total of 649 spectra are observed and analyzed amounting to 3367 partitions the spectra containing 2 and 9 partitions occur rarely 1 or 2 times whereas those with 5 partitions are more frequent for the considered season an analysis has been performed to find the relation between u 10 c p and γ from op method fig 4 the wind speed at the chosen location is obtained from ecmwf at 0 125 0 125 resolution for u 10 c p 1 the median of γ is 1 implying a fully developed sea state fig 5 similar calibration is performed between u 10 c p and γ from mop method the third calibration method considering w a 30 includes possible wind peaks with the median of γ mop as 1 similar to earlier methods thewamdigroup 1988 showed that the wind sea dominates when u 10 c p 0 83 zheng et al 2016 established linkage between u 10 c p and the fraction of the swell energy in terms of the total energy the study concluded that wind sea started to dominate when u 10 c p exceeded 0 18 4 2 inter comparison between the identification methods op and wa methods are validated for individual spectra of different characteristics and the results are presented in figs 6 9 and tables 2 5 the figures show the partition results from the directional wave spectra the dashed and dotted lines represent the measured and pm spectra the wave spectrum in fig 6 is of category 1 in which the mean directions of swell and wind sea systems are in different quadrants third and second quadrants zero with reference to x axis rotated in counter clockwise direction the figure shows that peaks of the wave systems ws5 ws7 indicated by dashed lines are greater than pm spectra and identified as wind sea the remaining four wave systems are smaller than pm spectra and declared as swell sea the γ values of the wave systems are presented in table 2 table 2 exhibits wa 30 includes three wave systems ws5 ws7 with γ 1 and considered as wind sea the other wave systems are identified as swell the result agrees well with op method the directional wave spectrum shown in fig 7 falls in category 2 with mean directions of swell and sea in the same quadrant from fig 7 and table 3 it can be seen that the methods show same identification results with ws1 alone is identified as swell and the other wave systems ws2 ws5 as wind sea directional wave spectrum falling under category 1 is shown in fig 8 it is the spectrum which holds maximum number of wave systems observed at the end of month season op method identifies ws9 as wind system and the rest as swell system which is also confirmed by wa method from table 4 the directional wave spectrum showing different identification results are presented in fig 9 and table 5 as seen from the figure peaks of two wave systems are lower than the pm spectra and the respective γ values table 5 are lesser than 1 indicating the wave systems ws5 and ws6 as wind op method identifies the spectrum is of category 1 but wa exhibit another result in which wa values from table 5 are all greater than 30 indicating the wave systems as swell the findings with op method indicate that 60 of the measured spectra represent the mixed sea state the mop analysis reveals that mixed seas are more apparent with 62 during the south west monsoon with the remaining spectra being entirely influenced by swell components the mop method captures nearly 99 4 all of the spectra described as mixed sea by the op method in particular op classifies the directional spectra at 2100 utc on june 06 2016 and 0300 utc on september 2016 as mixed sea while mop classifies it as swell wa analysis concludes that nearly 62 represent mixed sea spectra and the balance is swell the results agree well with above two methods it is also found that 0 04 of the wa values lie between 5 and 10 indicating negligible young seas komen et al 1994 the result is consistent with those of de farias et al 2012 for global wave data using a different partition scheme de farias et al 2012 observed no young wind seas during their analysis of global wind sea regime using wa method the mixed sea state spectra can be classified into two broad categories category 1 contains the spectra whose swell energy is more than the wind energy category 2 has spectra with more energy in wind part than the swell part irrespective of the methods most of the mixed spectra in the monsoon period falls in category 1 overall agreement between the methods sound good alternatively to appraise the wind sea regime the wind wave parameters obtained from op and wa methods are validated with toba s power law toba 1973 16 h b t a where h g h s u 2 and t g t s u h s is the significant wave height t s is the significant wave period g is the acceleration due to gravity and b is the empirical constant ebuchi et al 1992 adopted a as 3 2 and defined b in the range 0 062 20 the op and wa approaches yielded good agreement of partitioned parameters with the line of best fit as 17 h 0 067 t 1 5 and h 0 065 t 1 5 and the results are shown in figs 10a and b the correlation coefficient of the partitioned parameters from op and wa methods are 0 82 and 0 87 respectively in addition to wa method 9 adopted two other approaches to study swell and wind sea dominance over the mid latitude and tropical north atlantic during the period 2002 2008 in the first approach named as wave energy statistical wes method if the satellite derived h s is greater than the numerically predicted significant wave height h p thewamdigroup 1988 the system is considered as swell else it is considered as wind sea for the wave data from wam model they used wave age method with a threshold of 1 2 to separate swell and wind sea regime the methods ended up with the conclusion of swell dominance to further substantiate the findings the wind sea parameters h s t p and u 10 obtained from wave age method were subjected to the theoretical fit hwang et al 1998 and the correlation was found to be 0 57 finally the wind speed for the study region during the monsoon period is also analyzed the box whisker and histogram plots of wind speed and its occurrences are shown in fig 11 the figure shows that median of wind speed is 4 34 m s and approximately 75 of the wind speed values are lesser than 5 04 m s the presence of low wind speed is an indication of negligible absence role of pure wind seas chen et al 2002 de farias et al 2012 and the findings coincide with the above numerical calibration methods for wind sea op mop and wa chen et al 2002 analyzed global swell and wind sea climate using measurements wind speed and wave height provided by altimeter and scatterometer the presence of pure wind sea was reported to be negligible in low wind speed region figure 1 of chen et al 2002 the two methods op and wa are applied to the directional wave spectrum observed during the monsoon season the methods show similar mean direction of swell and sea and they range from 137 281 and 163 293 respectively the wave rose plots of the mean directions of swell and sea spectra versus significant wave height are shown in fig 12 in the subsequent section the interaction between the swell and wind sea components is studied through a nonlinear interactions s n l 4 3 nonlinear swell sea interaction the magnitudes of the nonlinear interactions belonging to the spectrum of categories 1 and 2 section 2 are investigated as a function of inter modal distance distance between f p 1 and f p 2 and the difference in mean direction between swell and sea spectra it is observed that when the distance between the peak frequency and mean direction of the spectrum increases the magnitude of s n l decreases the left and right panels in fig 13 presents the one dimensional energy spectra observed at off kochi and their nonlinear energy transfers respectively without energy loss spurious peaks of the observed spectra are discarded and the significant peaks are considered for the swell sea partitioning scheme the separation frequency f s which is defined to segregate the swell and wind sea components table 6 shows the spectral characteristics together with initial and significant peaks of the observed spectra swell dominated spectra with larger inter modal distance 0 12 is considered in fig 13a in fig 13b wrt hbl method experiences minimum magnitude dia method behaves differently showing a shift towards left in the second peak f p 2 of the frequency domain swell dominated spectrum with minimum inter modal distance is shown in fig 13c for the considered spectra wrt hbl method attains maximum magnitude and is an order more than previous case fig 13b though the magnitudes of wrt hbl and gqm methods are in same order 10 5 wrt hbl is nearly seven times of the latter method and their one dimensional results are shown in fig 13d the s n l results of wrt hbl and gqm are almost similar in most cases in both shape and magnitude the ratio of s n l wrt hbl at swell peak and sea peak for the above cases of spectra are s n l f p 1 s n l f p 2 0 18 and 2 82 respectively the mechanism of s n l says that for the case 1 energy transfer is higher in the wind sea peak than that of the swell peak this indicates a larger difference in both shape and magnitude of s n l narrowness parameters of the considered spectra in fig 13 are presented in table 6 the narrowness parameters f w a k and 1 σ θ of case 2 spectrum is increasing relative to other case hence when the magnitude of s n l under the case 2 spectrum increases rapidly the narrowness parameters begin to increase thus leading to a narrow spectrum the results through wrt hbl method for mixed sea state observed spectra are consistent with the findings of masson 1993 tamura et al 2009 and young et al 1985 a bimodal spectrum with more energy in swell than wind sea was analyzed by masson 1993 using a different method of nonlinear interactions it was found that with increasing distance between the spectral peaks the magnitude of nonlinear interaction decreases young et al 1985 tested the behavior of exact nl a method of nonlinear interactions for a series of bimodal mixed sea spectra and agreed with the findings of masson 1993 the use of an accurate method of nonlinear interactions was emphasized for simulation of mixed sea state tamura et al 2009 also confirmed masson s findings the present study is a first step to properly simulate the mixed sea state and thereby helps to analyze the attenuation of swell waves by wind waves or vice versa with or without wind action through nonlinear interactions the wrt hbl method implemented in the wind wave model is found to perform well in swell sea environment and this method could be used for the purpose 5 summary and conclusions the spectral partitioning is carried out for the observed spectra at off kochi during the southwest monsoon of 2016 spectral partitioning scheme indicated that spectra with five partitions occur more frequently in the considered season the partitions are identified as swell or wind sea using the peakedness algorithm based on overshooting phenomenon op further to include the effects of water depth in dictating the wind sea and swell propagation the pm spectral representation in the op scheme is replaced with tma spectrum in the partitioning scheme named as modified overshooting phenomenon mop for assessing the swell and wind sea contribution the wave age wa method is also involved to identify the wind sea regime a linkage is established between inverse wave age and the spectral peakedness parameter the op and mop schemes are calibrated for the gamma factor with the inverse wave age the wa is calibrated with the gamma factor from mop method based on the analysis the observed spectra off kochi coast mostly consist of the mixed sea wa analysis clearly showed the negligible participation of young seas in the considered season op and wa methods yielded a correlation of 0 82 and 0 87 between wind sea derived parameters with theoretical fit in comparison to the commonly used wave age method for swell sea segregation the peakedness method does not depend on wind velocity this method is found to be efficient if the wind data is not available or reliable if the inter modal distance and the mean directions of swell and wind sea systems are close the spectrum becomes narrower the mechanism of nonlinear interaction works effectively for this case too if the role of nonlinear interactions is vital it has full control over the spectral shape the findings are in agreement with young et al 1985 masson 1993 and tamura et al 2009 credit authorship contribution statement g uma numerical calculations and paper preparation s a sannasiraj revisions given suggestions for shaping the manuncript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20284,swell and wind seas generally co exist in the open ocean and are often difficult to segregate swell and wind sea characteristics of observed wave spectra at off kochi located along india s south west coast in the arabian sea during the south west monsoon are presented this paper attempts to split the observed wave spectra into individual wave partitions thereby enabling the computation of integral wave parameters of each partition the spectra with five partitions is found occur more frequently in the considered season to extract wind sea and swell information from the observed directional spectrum a consistent overshooting phenomenon op modified overshooting phenomenon mop and wave age wa method are employed in each partition the results show a prevalence of mixed sea states an analysis from wa method shows the absence of young wind seas the derived wind wave parameters of the spectral partitioning algorithm agree well with toba s 3 2 law with a good correlation the effectiveness of interaction between the derived swell and sea components is discussed through nonlinear interactions that are occurring between the set of four waves keywords swell sea partition algorithm south west monsoon kochi coast nonlinear wave wave interaction wind wave model 1 introduction the wave climate at an open ocean consists of both swell and wind sea components and their representative spectra often show multi peaks earle 1984 pointed out that the co existence of swell and wind sea can damage offshore structures the identification and segregation of swell and wind sea components characterize the sea state clearly and are essential for scientific and engineering applications most of the swell sea partitioning algorithm resides in the identification of a separation frequency f s wave models such as wavewatchiii tolman et al 2014 and wam thewamdigroup 1988 adapt wave age criteria for swell sea partitioning a threshold for the wave age is defined such that the swell dominates for higher values of it several authors adopted different threshold to separate swell and wind sea 1 3 by bidlot 2001 in the wam model 1 7 by tracy et al 2007 in wavewatch iii 1 5 by hanson and phillips 2001 to include possible wind peaks and 1 2 by de farias et al 2012 churchill et al 2006 carried out sensitivity tests for the directional spectra observed from bottom mounted acoustic doppler current profilers adcp at martha vineyard coastal observatory the spectra were partitioned according to hanson and phillips 2001 using applied physics laboratory apl waves software and proposed a threshold of 1 6 to capture wind sea effectively chen and ma 2002 adopted a separation frequency of 0 1 hz and suggested that this fixed cut off works only when swell and wind sea are explicitly separated in the frequency domain wang and hwang 2001 and gilhousen and hervey 2001 dictated the separation frequency based on wave steepness the scheme states that the steepness of swell part of the spectrum is smaller than wind sea part and maximum in the vicinity of wind sea peak the method is successfully implemented in national data buoy center ndbc the need for such a partition is discussed by bidlot 2001 a detailed review regarding the spectral partitioning schemes and their pitfalls was done by portilla et al 2009 they found that the approach proposed by wang and hwang 2001 tends to underestimate the wind sea particularly when the wind sea dominates the spectrum considering the suggestions of portilla et al 2009 and hwang et al 2012 modified the wave steepness algorithm of wang and hwang 2001 further portilla et al 2009 proposed one dimensional 1d partitioning algorithm called peakedness or over shooting phenomenon op which estimates the ratio between the peak energies of the wave system and pierson moskowitz pierson et al 1964 pm spectrum at the same peak frequency if γ is greater than 1 0 the system is identified as sea else it is considered as swell portilla et al 2015a incorporated the partitioning algorithm into the wam for the period 1979 2013 consisting of six hourly wave spectra amounting to 51 136 spectra yielding 111 093 partitions they also employed the algorithm and analyzed the measured spectra obtained from a directional wave buoy located in the southern north sea portilla et al 2015a b portilla 2017 confirmed this scheme s supremacy over the existing partitioning algorithms few researchers de farias et al 2012 zheng et al 2016 use statistical methods for wind sea separation zheng et al 2016 forced ww3 with european centre for medium range weather forecasts ecmwf https www ecmwf int wind data and produced global wave data for the year 2010 the obtained two dimensional wave spectra were separated into swell and wind sea using a statistical method called spectra energy partition sep scheme the results were linked with wave age method for wind sea the magnitude of the energy transfer between different frequency components decreases with increasingly separated spectral peaks and mean direction between the components of swell and wind sea and vice versa the nonlinear interactions between swell and wind sea systems has been theoretically investigated by several scientists young et al 1985 young 1999 masson 1993 in addition the mechanism of nonlinear interactions helps to understand the energy transfer between swell and sea components of the spectrum vincent et al 2019 mitsuyasu 2015 emphasized that the nonlinear interaction between sea and swell could not be understood specifically masson 1993 studied attenuation of wind waves by swell waves by performing spectrum evolution studies through the nonlinear interaction source term without wind action the energy from the wind part of the bimodal spectrum got transferred to the swell part and became uni modal tamura et al 2009 conducted hind cast wave simulation to understand the sea state at the time of suwa maru accident that occurred in japan during the year 2008 they showed nonlinear interaction between wind and swell waves of the spectra by considering all the source terms in a wind wave model the energy from wind sea was found to transfer to the swell part of the spectrum the spectral evolution showed that the nonlinear interaction of swell and sea was the key to the generation of the narrow swell spectrum at the time of the accident the magnitude of nonlinear interactions spectral peakedness and wave steepness were increased and the mean directional spreading was decreased the present third generation wave models such as wam wavewatch iii and tomawac gagnaire renou et al 2010 use discrete interaction approximation method thewamdigroup 1988 dia for nonlinear energy transfers dia uses only a subset of total interaction space compared to the full boltzmann integral perrie and resio 2009 fbi based on webb 1978 tracy and resio 1982 and hence cannot reproduce similar results as fbi the method is preferred for its computational efficiency despite its shortcomings perrie and resio 2009 uma et al 2018 although there exists several methods for nonlinear energy transfers liu et al 2017 their implementation in models remains a challenging task since these methods when integrated with other source terms in the wave model either give incorrect results or takes more computational time to achieve an efficient method perrie and resio 2009 implemented a two scale approximation tsa method for nonlinear energy transfers in wavewatch iii they showed using observed spectra that the tsa method behaved better than dia corresponding to fbi the observed spectra are taken from currituck sound and open north atlantic ocean conditions during hurricane wilma that occurred in 2005 recently prabhakar and uma 2016 and uma et al 2016 2018 attempted to develop a model for nonlinear energy transfer to improve both computational efficiency and accuracy in the present paper the spectra observed off kochi coast located along the south west coast of india in the arabian sea during the south west monsoon period is partitioned into swell and wind sea systems using different methods the op scheme the modified overshooting phenomenon mop and wave age wa methods the nonlinear interaction uma et al 2018 between swell and wind sea systems is then analyzed the present study implements the partitioning algorithm based on spectral peakedness portilla et al 2009 and hybrid functions of block pulse and lagrange polynomial in webb resio tracy s uma et al 2018 wrt hbl method for nonlinear energy transfers in tomawac model the wrt hbl method s advantage is that it suits for both deep thewamdigroup 1988 and finite water depths direct transfers the existing methods for nonlinear interactions such as dia multiple discrete interaction approximation method tolman 2004 mdia and gaussian quadrature method gagnaire renou et al 2010 gqm in the tomawac model consider the parameterization technique thewamdigroup 1988 for finite depth the source terms attributable to wind input and dissipation in the third generation wave models e g tomawac have been tuned and adjusted for dia in order to replace dia with other methods e g wrt hbl one has to re calibrate the source terms for practical application the organization of the paper is as follows section 2 presents the theory of spectral partitioning for the identification of swell and wind sea systems and the nonlinear interaction between the swell and wind sea through nonlinear interactions section 3 deals with the wave spectral data adopted for the present study section 4 discusses the results with the summarization in section 5 2 theoretical background 2 1 spectral partitioning and methods for identification of swell and wind sea systems the 2d wave spectrum obtained from the buoy response consists of both swell and wind sea components the purpose of spectral partitioning is to segregate swell and wind sea components in the present study the following steps are followed for spectral partitioning a convolution the wave spectrum is subjected to convolution described by 1 e f θ e f θ k m n where e and e are the measured and the convoluted 2d spectra the operator denotes the convolution of the functions e and k the convolution kernel k is chosen as a unit matrix hasselmann et al 1996 of size 3 b partitioning and combining the spectral peaks are identified by the method of steepest ascent called as mountaineer scheme by hasselmann et al 1996 the spectral partitioning is carried out by combining the neighboring peaks partitions upon setting a threshold value for the proximity and the magnitude the partitioning helps in identifying the distinguished wave systems c filtering partitions with negligible energy compared to that of the total spectrum are considered as noise and are filtered out by fixing the energy threshold d fixing partitions the maximum number of partitions is dictated as input to avoid the fallacy of wave systems if the number of partitions exceeds the prescribed number steps 1 3 are repeated till the target number of partitions is achieved the repeated convolution process may end up with blurred or indiscernible wave systems the subsequent calibration methods for wind sea are employed in each of the partitioned wave systems to identify sea and swell components i peakedness phenomenon following portilla et al 2009 the peakedness or overshooting phenomenon op which finds the ratio between the peak energy of a wave system and the pm spectrum γ at the same frequency is applied accordingly the different wave systems are categorized as wind sea or swell following γ 1 wind sea else swell theoretically γ 1 indicates the fully developed wind sea the above threshold value of 1 is arbitrary which has to be fixed by calibration for a given site location here a threshold t is chosen in such a way that the region inverse wave age u 10 c p t includes most of the wind sea peaks γ 1 where u 10 is the wind speed at 10 m above the free surface and c p is the phase speed op method could be employed when the wind information is not available or reliable having said the advantage the method does not include i the wave direction and ii finite water depth conditions as it uses pm spectrum in which there is no depth limitation ii modified overshooting phenomenon mop pm and jonswap spectra are depth independent and hence more suitable for deep water conditions bouws et al 1985 modified the latter as the tma spectrum to suit the finite depth conditions the pm spectrum in the op method is now replaced with the tma spectrum with peak enhancement factor set to unity for calculating γ values since the method is a slight modification to op method it can be named as modified op method the calibration is same as discussed in the op method iii wave age wa method wa method is represented to demarcate with reference to the threshold t komen et al 1994 2 w a c p u where u is the friction velocity the threshold t is chosen in such a way that w a t includes maximum wind sea peaks the present estimation of u is from the default settings janssen 1989 from the wind wave model tomawac to identify sea and swell components 2 2 swell and wind sea interaction modeling to understand the nonlinear interaction of swell and sea components the hybrid function of block pulse and lagrange polynomial in webb resio tracy s wrt hbl method is implemented in the tomawac wind wave model further the behavior of different methods of solving nonlinear source term s n l is also tested in swell sea environment the spectral wave model tomawac a part of telemac mascaret modeling suite solves the action balance equation fitri et al 2016 3 n t x n x y n y k x n k x k y n k y s k x k y x y t where n is the action density n e ω k x and k y are the x and y are the components of the wave number vector ω is the angular frequency and t is the time the term s on the right hand side is the total source term which describes the rate of change of action density at each spectral components due to the physical processes given by 4 s s i n s d s s n l s b f s b r s t r s d s c u r s v e g where s i n is the wind driven energy source s d s is the white capping induced energy dissipation s n l is the non linear quadruplet interactions s b f is the bottom friction induced energy dissipation s b r is the energy dissipation due to depth induced breaking s t r is the non linear triad interactions s d s c u r is the enhanced breaking dissipation of waves on a current and s v e g is the dissipation due to vegetation of the source terms the one due to quadruplet interactions s n l is considered in the rest of the study for understanding the swell sea interaction hasselmann 1960 proposed the basic expression for nonlinear energy transfers occurring between the set of four waves 5 n 1 t g k 1 k 2 k 3 k 4 δ k 1 k 2 k 3 k 4 δ ω 1 ω 2 ω 3 ω 4 n 1 n 3 n 4 n 2 n 2 n 4 n 3 n 1 d k 2 d k 3 d k 4 where g is the coupling coefficient herterich and hasselmann 1980 and n i is the action density at the wave number i 1 4 the linear dispersion relation connecting the angular frequency and the wave number is given by 6 ω i 2 g k i tanh k i h where g is the acceleration due to gravity and h is the water depth now eq 5 is rewritten as 7 n 1 t t k 1 k 3 d k 3 with the transfer function t given by 8 t k 1 k 3 g δ k 1 k 2 k 3 k 4 δ ω 1 ω 2 ω 3 ω 4 n 1 n 3 n 4 n 2 n 2 n 4 n 3 n 1 d k 2 the application of resonance conditions ω 1 ω 2 ω 3 ω 4 0 and k 1 k 2 k 3 k 4 0 reduces eq 8 to 9 t k 1 k 3 ω g n 1 n 3 n 4 n 2 n 2 n 4 n 3 n 1 j d s where ω is the closed integral and j is the jacobian term given by c g 2 c g 4 1 with c g 2 and c g 4 are the group velocities of k 2 and k 4 respectively and expressed as c g 1 2 1 2 k h s i n h 2 k h g k t a n h k h finite depth g ω h deep waters hybrid function of block pulse and lagrange polynomial hbl is used in wrt method to increase the computational efficiency along t the method has the flexibility of choosing the orders of block pulse function n and legendre polynomial m independently uma et al 2018 discussed the details regarding the application of hbl to the transfer integral the application of hbl to eq 9 yields 10 t k 1 k 3 b a n 1 n m 0 m 1 g s n m d s n m j s n m w n m where s n m n 1 n m 0 m are the hbl nodes along the curve ω w n m are the weights and l is the length of the curve now eq 7 in terms of polar coordinates 11 n 1 t t k 1 k 3 k 3 d θ 3 d k 3 is computed the scaling relations applicable in the case of deep waters prabhakar and uma 2016 do not hold in the case of varying depths uma et al 2018 in the tomawac model three methods dia mdia and gqm for solving s n l are available the quadruplet choice in the dia method depends on a single parameter λ which is set as 0 25 according to hasselmann and hasselmann 1985 this choice is adopted throughout the study the choice of quadruplet in mdia depends on two parameters λ μ herein the parameters are set as λ 0 075 and μ 0 023 in the model for the gqm method to compromise between accuracy and efficiency gagnaire renou et al 2010 suggested coarse resolution and the same is used herein for the gqm method the wrt hbl method of analysis of s n l is implemented in the third generation wave model tomawac along with the available methods such as dia mdia and gqm tomawac model has been satisfactorily used by several authors guimarães et al 2019 kirinus et al 2018 for practical purposes 3 data 3 1 observed data the wave spectra obtained from wave rider buoy wrb located at the nearshore kochi region 9 58 33 00 n 76 6 45 01 e have been analyzed in the present study fig 1 in this region the south west monsoon prevails from may to september a wrb was deployed in a water depth of about 21 m to measure the wave climate at every three hours interval the two dimensional 2d wave energy spectrum with 129 linearly spaced frequency bands from 0 005 hz to 0 64 hz and 121 different angles ranging between 0 360 was obtained by using fast fourier transform on the buoy response the measured wave spectra from 01 june 2016 to 30 september 2016 are partitioned to obtain swell or sea systems the three parameters prescribing the spectral shape such as the spectral width f w rogers and vledder 2013 babanin and soloviev 1988 wave steepness a k tamura et al 2009 and mean directional spread σ θ are used in the present study 12 f w m 0 f p e f p 13 a k 2 0 5 π h s l p 14 σ θ 2 1 a 2 b 2 e 2 1 2 1 2 where m n is the n th order moment a e f θ cos θ d f d θ e 2 b e f θ sin θ d f d θ e 2 and l p is the peak wave length of the spectra 3 2 data preparation to facilitate comparison between methods of s n l in wave model the mixed sea state spectra of the monsoon month july are taken into account for further calculations the observed spectra are converted from linear to geometrical spacing to facilitate the comparison among the s n l formulations dia mdia and gqm in the third generation wave model tomawac this conversion makes the integrand except energy spectrum in eq 5 to scale geometrically and thus favors computational efficiency prabhakar and uma 2016 the geometric grid is generated by specifying the number of bins in the spectrum s forward face f f p 1 and matching the spectral peak to a specific grid point when 14 bins in the forward spectral face are desired the geometrically spaced frequency coordinates shall be set as 15 f q f p 1 λ q 14 where f p 1 is the peak frequency q is the radial co ordinate and λ 1 say 1 1 the partitioned frequency spectrum is expressed with two parameter h s f p jonswap spectrum depth corrected in the wave model and the directional spreading is chosen as mitsuyasu model which is incorporated for the purpose of the present study the significant wave height peak frequency and mean wave direction of the partitioned swell and wind sea spectra are denoted by h s 1 and h s 2 f p 1 and f p 2 and θ m 1 and θ m 2 respectively 4 results and discussion 4 1 identification of swell or wind sea systems as an example the spectrum at 1800 utc 05 july 2016 is analyzed in detail measured and convoluted 2d spectrum are shown in figs 2a and b the plus markers in fig 2c show the peaks of the one dimensional measured spectrum whereas the triangle and circular markers denote the convoluted and de noised spectrum s partitions the dashed dotted and continuous lines are the measured convoluted and de noised spectrum employing the mountaineering scheme hasselmann et al 1996 the measured spectrum is identified with 16 peaks markers the application of a 2d convolution on the spectrum reduces the number of partitions to 9 markers merging the partitions by setting an energy threshold of 5 of the total energy and a noise energy threshold of 2 of the total energy the number of partitions further reduces to 4 o markers it is important to note that the de noised spectrum is used to finalize the partitions however to find the peaks of those partitions one always needs to refer to the measured spectrum since the de noised spectral peak would have been smoothened to less magnitude here the partition algorithm yields four partitions and hence the four wave systems are analyzed their characteristics are summarized in the table 1 wave system 1 ws1 fig 2d possesses the maximum spectral energy bin e p over other partitions in terms of integrated parameters ws2 contains more energy than other partitions meanwhile ws4 holds smaller energy in terms of the bin and integrated parameters the parameters of the overall spectrum other than the integrated ones agree with ws1 the respective 2d wave systems ws1 to ws4 are presented in figs 2d g respectively the histogram plot in fig 3 presents the wave systems observed in the monsoon season at off kochi a total of 649 spectra are observed and analyzed amounting to 3367 partitions the spectra containing 2 and 9 partitions occur rarely 1 or 2 times whereas those with 5 partitions are more frequent for the considered season an analysis has been performed to find the relation between u 10 c p and γ from op method fig 4 the wind speed at the chosen location is obtained from ecmwf at 0 125 0 125 resolution for u 10 c p 1 the median of γ is 1 implying a fully developed sea state fig 5 similar calibration is performed between u 10 c p and γ from mop method the third calibration method considering w a 30 includes possible wind peaks with the median of γ mop as 1 similar to earlier methods thewamdigroup 1988 showed that the wind sea dominates when u 10 c p 0 83 zheng et al 2016 established linkage between u 10 c p and the fraction of the swell energy in terms of the total energy the study concluded that wind sea started to dominate when u 10 c p exceeded 0 18 4 2 inter comparison between the identification methods op and wa methods are validated for individual spectra of different characteristics and the results are presented in figs 6 9 and tables 2 5 the figures show the partition results from the directional wave spectra the dashed and dotted lines represent the measured and pm spectra the wave spectrum in fig 6 is of category 1 in which the mean directions of swell and wind sea systems are in different quadrants third and second quadrants zero with reference to x axis rotated in counter clockwise direction the figure shows that peaks of the wave systems ws5 ws7 indicated by dashed lines are greater than pm spectra and identified as wind sea the remaining four wave systems are smaller than pm spectra and declared as swell sea the γ values of the wave systems are presented in table 2 table 2 exhibits wa 30 includes three wave systems ws5 ws7 with γ 1 and considered as wind sea the other wave systems are identified as swell the result agrees well with op method the directional wave spectrum shown in fig 7 falls in category 2 with mean directions of swell and sea in the same quadrant from fig 7 and table 3 it can be seen that the methods show same identification results with ws1 alone is identified as swell and the other wave systems ws2 ws5 as wind sea directional wave spectrum falling under category 1 is shown in fig 8 it is the spectrum which holds maximum number of wave systems observed at the end of month season op method identifies ws9 as wind system and the rest as swell system which is also confirmed by wa method from table 4 the directional wave spectrum showing different identification results are presented in fig 9 and table 5 as seen from the figure peaks of two wave systems are lower than the pm spectra and the respective γ values table 5 are lesser than 1 indicating the wave systems ws5 and ws6 as wind op method identifies the spectrum is of category 1 but wa exhibit another result in which wa values from table 5 are all greater than 30 indicating the wave systems as swell the findings with op method indicate that 60 of the measured spectra represent the mixed sea state the mop analysis reveals that mixed seas are more apparent with 62 during the south west monsoon with the remaining spectra being entirely influenced by swell components the mop method captures nearly 99 4 all of the spectra described as mixed sea by the op method in particular op classifies the directional spectra at 2100 utc on june 06 2016 and 0300 utc on september 2016 as mixed sea while mop classifies it as swell wa analysis concludes that nearly 62 represent mixed sea spectra and the balance is swell the results agree well with above two methods it is also found that 0 04 of the wa values lie between 5 and 10 indicating negligible young seas komen et al 1994 the result is consistent with those of de farias et al 2012 for global wave data using a different partition scheme de farias et al 2012 observed no young wind seas during their analysis of global wind sea regime using wa method the mixed sea state spectra can be classified into two broad categories category 1 contains the spectra whose swell energy is more than the wind energy category 2 has spectra with more energy in wind part than the swell part irrespective of the methods most of the mixed spectra in the monsoon period falls in category 1 overall agreement between the methods sound good alternatively to appraise the wind sea regime the wind wave parameters obtained from op and wa methods are validated with toba s power law toba 1973 16 h b t a where h g h s u 2 and t g t s u h s is the significant wave height t s is the significant wave period g is the acceleration due to gravity and b is the empirical constant ebuchi et al 1992 adopted a as 3 2 and defined b in the range 0 062 20 the op and wa approaches yielded good agreement of partitioned parameters with the line of best fit as 17 h 0 067 t 1 5 and h 0 065 t 1 5 and the results are shown in figs 10a and b the correlation coefficient of the partitioned parameters from op and wa methods are 0 82 and 0 87 respectively in addition to wa method 9 adopted two other approaches to study swell and wind sea dominance over the mid latitude and tropical north atlantic during the period 2002 2008 in the first approach named as wave energy statistical wes method if the satellite derived h s is greater than the numerically predicted significant wave height h p thewamdigroup 1988 the system is considered as swell else it is considered as wind sea for the wave data from wam model they used wave age method with a threshold of 1 2 to separate swell and wind sea regime the methods ended up with the conclusion of swell dominance to further substantiate the findings the wind sea parameters h s t p and u 10 obtained from wave age method were subjected to the theoretical fit hwang et al 1998 and the correlation was found to be 0 57 finally the wind speed for the study region during the monsoon period is also analyzed the box whisker and histogram plots of wind speed and its occurrences are shown in fig 11 the figure shows that median of wind speed is 4 34 m s and approximately 75 of the wind speed values are lesser than 5 04 m s the presence of low wind speed is an indication of negligible absence role of pure wind seas chen et al 2002 de farias et al 2012 and the findings coincide with the above numerical calibration methods for wind sea op mop and wa chen et al 2002 analyzed global swell and wind sea climate using measurements wind speed and wave height provided by altimeter and scatterometer the presence of pure wind sea was reported to be negligible in low wind speed region figure 1 of chen et al 2002 the two methods op and wa are applied to the directional wave spectrum observed during the monsoon season the methods show similar mean direction of swell and sea and they range from 137 281 and 163 293 respectively the wave rose plots of the mean directions of swell and sea spectra versus significant wave height are shown in fig 12 in the subsequent section the interaction between the swell and wind sea components is studied through a nonlinear interactions s n l 4 3 nonlinear swell sea interaction the magnitudes of the nonlinear interactions belonging to the spectrum of categories 1 and 2 section 2 are investigated as a function of inter modal distance distance between f p 1 and f p 2 and the difference in mean direction between swell and sea spectra it is observed that when the distance between the peak frequency and mean direction of the spectrum increases the magnitude of s n l decreases the left and right panels in fig 13 presents the one dimensional energy spectra observed at off kochi and their nonlinear energy transfers respectively without energy loss spurious peaks of the observed spectra are discarded and the significant peaks are considered for the swell sea partitioning scheme the separation frequency f s which is defined to segregate the swell and wind sea components table 6 shows the spectral characteristics together with initial and significant peaks of the observed spectra swell dominated spectra with larger inter modal distance 0 12 is considered in fig 13a in fig 13b wrt hbl method experiences minimum magnitude dia method behaves differently showing a shift towards left in the second peak f p 2 of the frequency domain swell dominated spectrum with minimum inter modal distance is shown in fig 13c for the considered spectra wrt hbl method attains maximum magnitude and is an order more than previous case fig 13b though the magnitudes of wrt hbl and gqm methods are in same order 10 5 wrt hbl is nearly seven times of the latter method and their one dimensional results are shown in fig 13d the s n l results of wrt hbl and gqm are almost similar in most cases in both shape and magnitude the ratio of s n l wrt hbl at swell peak and sea peak for the above cases of spectra are s n l f p 1 s n l f p 2 0 18 and 2 82 respectively the mechanism of s n l says that for the case 1 energy transfer is higher in the wind sea peak than that of the swell peak this indicates a larger difference in both shape and magnitude of s n l narrowness parameters of the considered spectra in fig 13 are presented in table 6 the narrowness parameters f w a k and 1 σ θ of case 2 spectrum is increasing relative to other case hence when the magnitude of s n l under the case 2 spectrum increases rapidly the narrowness parameters begin to increase thus leading to a narrow spectrum the results through wrt hbl method for mixed sea state observed spectra are consistent with the findings of masson 1993 tamura et al 2009 and young et al 1985 a bimodal spectrum with more energy in swell than wind sea was analyzed by masson 1993 using a different method of nonlinear interactions it was found that with increasing distance between the spectral peaks the magnitude of nonlinear interaction decreases young et al 1985 tested the behavior of exact nl a method of nonlinear interactions for a series of bimodal mixed sea spectra and agreed with the findings of masson 1993 the use of an accurate method of nonlinear interactions was emphasized for simulation of mixed sea state tamura et al 2009 also confirmed masson s findings the present study is a first step to properly simulate the mixed sea state and thereby helps to analyze the attenuation of swell waves by wind waves or vice versa with or without wind action through nonlinear interactions the wrt hbl method implemented in the wind wave model is found to perform well in swell sea environment and this method could be used for the purpose 5 summary and conclusions the spectral partitioning is carried out for the observed spectra at off kochi during the southwest monsoon of 2016 spectral partitioning scheme indicated that spectra with five partitions occur more frequently in the considered season the partitions are identified as swell or wind sea using the peakedness algorithm based on overshooting phenomenon op further to include the effects of water depth in dictating the wind sea and swell propagation the pm spectral representation in the op scheme is replaced with tma spectrum in the partitioning scheme named as modified overshooting phenomenon mop for assessing the swell and wind sea contribution the wave age wa method is also involved to identify the wind sea regime a linkage is established between inverse wave age and the spectral peakedness parameter the op and mop schemes are calibrated for the gamma factor with the inverse wave age the wa is calibrated with the gamma factor from mop method based on the analysis the observed spectra off kochi coast mostly consist of the mixed sea wa analysis clearly showed the negligible participation of young seas in the considered season op and wa methods yielded a correlation of 0 82 and 0 87 between wind sea derived parameters with theoretical fit in comparison to the commonly used wave age method for swell sea segregation the peakedness method does not depend on wind velocity this method is found to be efficient if the wind data is not available or reliable if the inter modal distance and the mean directions of swell and wind sea systems are close the spectrum becomes narrower the mechanism of nonlinear interaction works effectively for this case too if the role of nonlinear interactions is vital it has full control over the spectral shape the findings are in agreement with young et al 1985 masson 1993 and tamura et al 2009 credit authorship contribution statement g uma numerical calculations and paper preparation s a sannasiraj revisions given suggestions for shaping the manuncript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
