index,text
21785,extreme meteorological events are becoming more frequent as a consequence of global warming typhoon as one of the natural disasters has caused significant damages globally therefore developing theoretical models to effectively predict typhoon probability is urgent based on the stochastic process theory this paper studies the local statistics of typhoon frequency and suggests a stochastic process model that can describe the number of typhoons occurring locally in time domain mathematical evidence has been provided to prove that the number of typhoons during a certain period can be described by using a stochastic process model furthermore the dependency of typhoon occurrences in different time periods and the probability distribution of typhoon occurrence intervals are explored the suggested model is employed to discuss the probability of typhoon on naozhou island in south china sea during may to september from year 2000 2016 subject to the absence of the event in may the results reveal that the probability distribution of typhoon events predicted by the suggested model is more reliable in comparison with conventional approach as it considered the typhoon occurrence in time domain which can provides useful information for predicting the probability of typhoons occurrence and intervals in engineering practice keywords typhoon frequency statistical characteristics stochastic process risk analysis 1 introduction frequent natural disasters often lead to a large number of casualties and economic losses according to the munich re group disaster database among the ten years from 2009 to 2018 natural disasters caused 371 000 deaths and 1 858 billion us dollar economic losses in united states of which meteorological disasters accounted for about 60 among all the meteorological disasters typhoons hurricanes impose significant threats to the human lives and urban development not only because of their high occurrence frequency and great destructive power but also due to other typhoon induced hazards such as inundation caused by storm surge and heavy precipitation in the context of global warming the occurrences of strong typhoons hurricanes have become more and more frequent as shown in fig 1 so as the induced marine disasters lin et al 2011 tajima et al 2014 nachman 2017 sun et al 2017 ha 2019 for instance super typhoon haiyan swept philippines in 2013 with the typhoon center maximum wind speed about 105 m s in tacloban city 90 of the buildings were razed to the ground tropical storm debbie ravaged the northern australia in 2017 and many towns in queensland were devastated in the following year in 2018 typhoon mangkhut caused extensive damages in asia area it is reported nearly 3 million people in china were affected and more than 1200 houses collapsed the total area of crops being affected was 174 400 ha resulting in direct economic losses of 52 million chinese yuan while in philippines 74 people were killed and economic losses accounted for 6 6 of its gdp which was more than 200 billion us dollars wang et al 2013 2016 2017 field 2017 liu et al 2019 liu et al 2019 2019 further to that if typhoon of similar intensity occurs multiple times the damages caused to marine coastal engineering facilities and coastal cities will be much more serious when conducting the risk assessment for such disasters the occurrence probability or frequency of the events will affect the value of risk function chen et al 2019b 2019a liu et al 2019 pence et al 2020 maclean et al 2020 namely r p i p i where p represents the occurrence probability of the event and i is the amount of losses due to the event therefore to give a reliable statistical description of the hazard factors e g frequency of typhoons hurricanes is not only important for gaining insight of the statistics of the hazards but also beneficial for engineering practices such as storm surge forecasting early warning and the risk assessment the key to successful risk assessment is the selection of hazard factors and the corresponding probability analysis of them liang et al 2019 2020 wu et al 2018 disasters caused by typhoons will be enhanced with the increasing frequency of typhoons if one can find a scientific way to determine the probability distribution of typhoon occurrence then the ability for risk management and mitigation in typhoon prone areas can be improved shao et al 2018 efforts were made to investigate the typhoon hurricane statistics e g jordan and ho 1962 analyzed the number of tropical cyclones from 1958 to 1986 where their numbers were considered as random variables while the seasonal and long term changes and the spatial correlations of tropical cyclone activities were studied later liu and ma 1976 and ma and liu 1979 suggested a compound distribution based on the discrete distribution of typhoon frequency and the continuous distribution of typhoon induced wave height in order to calculate their recurrence periods the stability of the results indicates that this method can overcome the shortcomings of the traditional method which is less reliable subject to limited data in short period shi 1992 further extended this model with the local frequency of typhoons fitted by poisson distribution and a stochastic model derived by simulating the local number of typhoons the model was verified by examining the typhoon statistics along the coast of shanghai and zhejiang in china and the results were in good agreement with the observations more recently kim et al 2019 considered typhoon frequency intensity and path etc based on the data collected among 2003 to 2014 and proposed a methodology to predict the loses which can be used in strategy making to reduce the typhoon risks tu and chen 2019 studied the correlation between the western pacific subtropical high wpsh and tropical sea surface temperature sst quantitatively and obtained the relationship between typhoon frequency wpsh and sst index in summer and early autumn in order to assess the typhoon activities in taiwan choi et al 2019 suggested a seasonal typhoon activity prediction model which can be used to investigate the contribution of the representative sst variability el niño southern oscillation north pacific sst and the increasing temperature of the entire pacific to the changes of typhoon activities in the western part of the northern pacific ocean those studies have made significant contributions to the current knowledge of typhoon statistics from the perspective of the typhoon frequency as a random variable however the frequency of typhoons in a certain sea area is essentially a random process which changes continuously with space and time montgomery et al 2014 katsuki et al 2017 kim and lee 2019 in fact the typhoon samples are a set of one dimensional time series thus should be described as a random process in other words the treatment of typhoon frequency as random variable cannot fully reflect the change of the number of typhoons over time as a consequence it imposes huge challenges to gain insight of the variation of probability of typhoon occurrence in time domain generally the traditional poisson distribution has been widely used in the analysis of typhoon probability in engineering practice shi 1992 zhang et al 2018 based on that the typhoon event occurs k times in the entire time interval can be described by the following equation 1 p x k p k λ 0 k k e λ 0 k 0 1 2 which is the so called poisson distribution and λ 0 denotes the average number of the events per interval eq 1 provides useful information for describing the probability of typhoon occurrence however it cannot be used to predict the probability of typhoon within an arbitrary specified time interval because number of typhoon x is regarded as a random variable obviously the number of typhoons in a certain period of time is a stochastic phenomenon if one examines the changes in the number of typhoons over time one must regard them as time dependent random variables i e a random process therefore as an alternative to eq 1 the state variable x t which is a function of time is introduced and the probability of typhoon occurring k times within 0 t can be given by ross et al 1996 2 p x t k p k t λ 1 t k k e λ 1 t k 0 1 2 where λ 1 denotes the time rate for the event to happen by using eq 2 the variation of probability of typhoon occurrence in time can be obtained such an approach has also be applied in many fields e g transition process in crystallography koag et al 2014 kou et al 2015 2018 pattern recognition in computer science escalante et al 2016 traffic flow modelling chen et al 2017 and earth sciences zhang et al 2018 zeng et al 2016 2017 this paper studied the statistical characteristics of typhoon occurrences based on a stochastic process model that can reflect the number of typhoons occurring in both time and space for the first time by using a family of random variables instead of one or a limited number of random variables to study the statistical characteristics of typhoon occurrence frequency one can get the probability of typhoon occurrence in different time periods and the probability corresponding to the number of occurrences in each time period based on whether the typhoon occurs in different time periods the probability of its occurrences intervals between events and the influence of the absence of typhoon on the probability of subsequent events is discussed comparisons with the conventional poisson distribution model have also been made in order to demonstrate the advantages of the present model the results indicate that the suggested model offers reliable predictions of probability of typhoon occurrences which can provide useful information in the practice of typhoon risk management and decision making process the paper is organized as the follows in section 2 the formulations of the model based on the random process theory for describing the probability of typhoon occurrences and its mathematical proof are presented section 3 discusses other statistical features of typhoon e g occurrence indicator and intervals examples of engineering applications are given in section 4 where the probability of typhoon recorded on naozhou island in china is analyzed finally section 5 presents the conclusions of this paper 2 probability model for the number of typhoon occurrence in a conventional approach the value of typhoon frequency within a time period t is defined as an observation while the set of observations at a consecutive sampling period t can be described as a group of random variables liu et al 2019 in this section however the mathematical model for describing the typhoon frequency within the specific time period is regarded as a random process instead of random variable specifically it is natural to assume that one can make limited number of observations within t on a time scale of t 0 t 2t 3t for example for the ς th observation at time t the deterministic function or sample function of number of typhoons can be expressed as n t which then forms a family of functions in terms of different values of ς this family of functions is dependent of time t therefore can be used to describe the typhoon frequency as a one dimensional random process liu et al 2019 next the deterministic sample function n t for describing the typhoon frequency from an engineering perspective will be given below definition to quantify the statistical nature of typhoon at a specified water area function n t is introduced as a counting process to represent the number of typhoons occurred within a specified time period 0 t for its purpose in engineering application n t meets the following criterions c1 initial value equals 0 n t 0 0 c2 independent increments the number of typhoons occurred within non overlapped time periods is independent c3 homogeneity the number of typhoons occurred within time period t 1 t 2 only depends on the length of the period t 2 t 1 regardless of the selection of t 1 c4 generality typhoon occurs no more than once within sufficiently short period for instance if p k δ t denotes the probability of typhoon occurred k times within period δ t when δ t is sufficiently small there must be a nonnegative number λ 1 that admits p 0 δ t 1 λ 1 δ t ο δ t the probability of no typhoon occurred within sufficiently small period is 1 λ 1 δ t p 1 δ t λ 1 δ t ο δ t the probability of typhoon occurred once within sufficiently small period is λ 1 δ t k 2 p k δ t ο δ t the probability of typhoon occurred more than once within sufficiently small period is extremely low where λ 1 denotes frequency of typhoon occurrence times per unit t i e the intensity or rate of the typhoon process for quantifying typhoon frequency in engineering practice it is understandable that function n t features the following properties for t t 0 t 0 0 1 the value of n t is a nonnegative integer 2 if t 1 t 2 then n t 1 n t 2 0 3 n t is an increasing step function 4 for t 1 t 2 n t1 t2 n t2 n t1 represents number of typhoons occurred within the period t1 t2 an example is displayed in fig 2 where it can be found that function n t is continuously increasing and differentiable everywhere in time domain except for a few limited points it is understandable that the deterministic sample function n t for the continuous observations of typhoon process is a step function with step length of 1 changing its value randomly in time domain theorem if n t t 0 as the counting process for representing the number of typhoons occurred within the specific time period meet the given criterions above it can be proved that the function n t describes a poisson process of strength λ 1 t liu et al 2019 i e the probability for n t k can be given by p k t λ 1 t k k e λ 1 t k 0 1 2 proof considering p k t δ t as the probability of typhoon occurring k times within period 0 t δ t according to c2 c3 and the total probability formulation one has ross et al 1996 3 p k t t p n t t k i 0 k p n t i n t t n t k i i 0 k p i i p k i t 1 for k 0 4 p 0 t δ t p n t δ t 0 p n t δ t n t 0 n t 0 p n t 0 p n t δ t n t 0 p 0 t p 0 δ t p 0 t 1 λ 1 δ t ο δ t p 0 t δ t p 0 t δ t λ 1 p 0 t ο δ t δ t let δ t 0 d p 0 t d t λ 1 p 0 t which leads to p 0 t c e λ 1 t where c is an arbitrary constant since p 0 0 p n 0 0 1 at t 0 p 0 t e λ 1 t 2 when k 1 5 p k t δ t p n t δ t k p n t δ t n 0 k p n t δ t n t n t n 0 k i 0 k p n t n 0 i n t δ t n t k i p n t δ t n t k i i 0 k p n t n 0 i p n t δ t n t k i i 0 k p i t p k i δ t p k t p 0 δ t p k 1 t p 1 δ t i 0 k 2 p i t p k i δ t 1 λ 1 δ t ο δ t p k t λ 1 δ t ο δ t p k 1 t ο δ t p k t δ t p k t δ t λ 1 p k t λ 1 p k 1 t ο δ t δ t let δ t 0 6 d p k t d t λ 1 p k t λ 1 p k 1 t for k 1 7 d p 1 t d t λ 1 p 1 t λ 1 e λ 1 t p 1 0 0 which yields 8 p 1 t λ 1 t e λ 1 t similarly making k 2 and using eq 8 will lead to the explicit formula for p 2 t by repeating this procedure one will eventually obtain 9 p k t λ 1 t k k e λ 1 t k 0 1 2 end of proof 3 mathematical description of other relevant statistical features of typhoon occurrences in addition to the above mentioned distribution of the number of typhoons it is also important to study the distribution of typhoon occurrence indicator and the distribution of typhoon time intervals t n 3 1 probability distribution of the typhoon occurrence indicator now let s use k t to indicate whether typhoon has occurred at time t where k t 1 means it occurred otherwise k t 1 based on that a function m t can be introduced to count the number of times that k t changes its value for instance when k t 1 m t will be 0 or an even number otherwise an odd number applies to m t when k t 1 as restated m t represents a group of random variables that changes its values in time therefore it is a measurable function defined in the sample space ω yielding real number values according to the section 2 m t for describing the number of times that k t changes its value induced by typhoon occurrence can be regarded as a poisson process during the time period 0 t m t follows the poisson distribution i e 10 p m t λ 1 t m m e λ 1 t which leads to the following one dimensional distributions 11 p k t 1 p m t is 0 or even k 0 p m t 2 k e λ 1 t cosh λ 1 t for describing no observation of typhoon occurrence and 12 p k t 1 p m t is odd k 0 p m t 2 k 1 e λ 1 t sinh λ 1 t for observation of typhoon occurrence at time t 3 2 probability distribution of the typhoon occurrence intervals given n t t 0 as the poisson process with a parameter λ 1 t n n 1 is time interval sequence for the corresponding n 1 th times to the n th times of typhoon occurrence then the time interval sequence t n n 1 2 is independent and follows index distribution with the mean of 1 λ 1 i e t n e λ 1 because t 1 indicates the time required before the first typhoon appearance thus t 1 t indicates that within 0 t typhoon has not yet appeared for t 0 there is 13 p t 1 t p n t 0 e λ 1 t therefore 14 p t 1 t 1 p t 1 t 1 e λ 1 t t 0 p t 1 t 0 t 0 the distribution function of t 1 is 15 f t 1 t 1 e λ 1 t t 0 0 t 0 this is an exponential distribution with mean of 1 λ 1 because t 2 is the time interval between the first and the second occurrences and the poisson process is an odd independent incremental process while considering the independence of the increment there is 16 p t 2 t t 1 s 1 p no typhoons in s 1 s 1 t t 1 s 1 p no typhoons in s 1 s 1 t p n s 1 t n s 1 0 p n t n 0 0 p n t 0 e λ 1 t it can be seen that t 2 also follows the exponential distribution with the mean 1 λ 1 and t 2 and t 1 are subject to same independent distribution in general for n 1 and t s 1 s 2 s n 1 0 there is p t n t t 1 s 1 t 2 s 2 t n 1 s n 1 p no typhoons in s 1 s n 1 s 1 s n 1 t t 1 s 1 t 2 s 2 t n 1 s n 1 p no typhoons in s 1 s n 1 s 1 s n 1 t p n s 1 s n 1 t n s 1 s n 1 0 p n t n 0 0 p n t 0 e λ 1 t that is the arrival time interval t n n 1 is an independent and uniformly distributed random variable which follows the exponential distribution with the mean of 1 λ 1 the distribution function of the typhoon arrival time interval is 17 f t n t 1 e λ 1 t t 0 0 t 0 the probability of typhoon interval is 1 minus the value obtained by eq 17 leading to 18 p t n t 1 f t n t e λ 1 t t 0 1 t 0 4 engineering application example in this paper the typhoon statistics in naozhou south china sea will be investigated and the maximum wind speed at the time of landfall is used to describe the intensity of the typhoon and the maximum wind speed on the ground near the center of the typhoon u m is selected as the criterion for justifying whether a typhoon occurs or not the typhoon characteristic data in 1960 and 2000 2016 without data in 2004 and 2007 e g its path maximum speed pressure etc are based on the reanalysis data obtained from shanghai typhoon institute of china meteorological administration which has been calibrated against observations according to the standards issued by the china meteorological administration the tropical cyclone is divided into six categories by u m as shown in table 1 according to the standard when u m exceeds 17 2 m s a tropical cyclone will be defined as a tropical storm ts and a typhoon blue warning signal will be issued at this time therefore in this article a typhoon occurs when the u m is larger than 17 2 m s and the center is within 400 km from naozhou island otherwise typhoon does not occur however to study typhoon statistics in other countries around the world users may refer to the local standards for its occurrence justification 4 1 typhoon frequency as a poisson process in 1960 the number of typhoon occurrences in a certain period of time is regarded as a random process in order to employ the mathematical model derived in section 2 and 3 the collection of all the observations of the typhoon is called the sample space and is denoted by ω in this way at every fixed time period t in the unit of month or season the number of typhoons observed within the same period becomes a set of random variables firstly the typhoon statistics in 1960 is studied and t as one month is selected the criteria for justifying typhoon s occurrence given above indicates that there were three typhoons in 2nd 17th june 21st june 1st july and 29th september 13th october respectively there was no typhoon in may thus the difference between the observed value of the number of typhoons in june and may is n 6 n 5 1 similarly n 10 n 9 1 and n 9 n 5 2 in general the probability of typhoon occurrences for 1960 can be represented by the poisson distribution of the mean value λ 0 3 meanwhile the number of typhoon occurrences n t should follow the poisson process with λ 1 0 25 and the sample curve of n t is shown in fig 3 based on that the one dimensional probability distribution of typhoon occurrences is given by p k t 0 25 t k k e 0 25 t k 0 1 2 the family of multi dimensional probability distributions of n t is 19 p n t 1 k 1 n t 2 k 2 n t n k n λ 1 k n e λ 1 t n t 1 k 1 t 2 t 1 k 2 k 1 t n t n 1 k n k n 1 k 1 k 2 k 1 k n k n 1 0 25 k n e 0 25 t n t 1 k 1 t 2 t 1 k 2 k 1 t n t n 1 k n k n 1 k 1 k 2 k 1 k n k n 1 in addition the typhoon occurrence indicator k t can be described as a poisson process with a mean value of λ 1 6 12 0 5 i e 20 p k t 1 k 0 p m t 2 k e 0 5 t cosh 0 5 t 21 p k t 1 k 0 p m t 2 k 1 e 0 5 t sinh 0 5 t where the number of k t changing its sign is m t 12 6 by using those equations derived in this subsection the probability of typhoon occurrences can be estimated it is found that the probability distributions based on the poisson process approach become a function of time which are distinguishable from the conventional poisson distribution the differences between the two methodologies will be discussed in the next subsection 4 2 on differences between poisson distribution and poisson process it is observed that typhoon mostly occurred among may and september in naozhou south china sea during the year 2000 2016 without data in 2004 and 2007 and the number of typhoons in each year is summarized in table 2 while the monthly distribution is displayed in fig 4 based on that the probability of typhoon occurrence frequency within these 15 years can be estimated and they are given in table 3 meanwhile their probability also follows the poisson distribution with λ 0 39 15 2 6 as described in fig 5 it indicates that the poisson distribution can generally be used to describe the probability of typhoon frequency between may and september throughout the entire 15 years however the poisson distribution does not provide further information about the probability of typhoon frequency varying in time it implies that for instance the probability of typhoon occurs k times between may and september is identical for each year from 2000 to 2016 according to the poisson distribution this imposes certain limitation on the poisson distribution in some real engineering applications where the temporal variation of the probability is of particular interest e g to conduct risk assessment within a given period next an example by direct comparison between the probability of typhoon frequency obtained by using poisson distribution and poisson process approaches is presented in order to further address this issue taking year 2000 for example since two typhoons occurred from may to september therefore the probability follows the poisson distribution with λ 0 2 and the probability of typhoons occurring once throughout the five months is p x 1 2 1 1 e 2 27 067 on the other hand the number of typhoon occurrences admits the poisson process of λ 1 0 4 and the probability that the typhoon occurs once throughout may to september is a function of time i e p 1 t 0 4 t e 0 4 t a comparison of the results obtained by using the poisson distribution and the poisson process is shown in fig 6 it shows that the poisson distribution gives a constant value regardless of time while the poisson process yields a curve of the typhoon probability that varies from may to september it is found that according to the predictions based on the poisson process approach the probability of typhoon occurs once from may to september achieves the maxima at august however such information cannot be provided by using the poisson distribution for analysis in addition it is noted that when t 5 the results of poisson process reduces to the poisson distribution indicating that the latter is indeed a special case of the former therefore the approach of using poisson process to describe the probability of typhoon frequency is more advantageous over the poisson distribution 4 3 impacts of typhoon s absence in may according to fig 4 typhoon in may only occurred once in 2006 among the 15 year data therefore it will be interesting to examine the probability of typhoon occurrence from may to september consider that no typhoon occurred in may for year 2000 the probability of one typhoon from may to september can be calculated by using eq 9 22 p n 1 0 n 5 1 p n 1 0 n 5 n 1 1 p n 1 0 p n 4 1 0 2165 it can be concluded that there is no typhoon in may and the probability of a typhoon in may to september is 21 65 by repeating this procedure the probability of typhoon occurring once twice three times and four times respectively from may to september from 2000 to 2016 is estimated and summarized in table 4 fig 7 a shows the probability distribution of typhoons that did not occur in may and a total number of 1 2 3 and 4 typhoons occurred among may to september from 2000 to 2016 it can be seen from the figure that when there is no typhoon in may the probability of typhoon occurrence from may to september decreases as the number of occurrences increases it further shows that considering typhoon s absence in may the probability distribution of typhoon frequency will become significantly different from the poisson distribution as demonstrated in fig 7 b taking year 2003 for example as indicated by the poisson distribution 4 typhoons occur from may to september in this year is most probably to happen however due to the inefficacy of the poisson distribution it cannot be used to estimate the probability of typhoon frequency by considering typhoon s absence in may in fact taking into account of typhoon s absence in may probability of typhoon occurring 3 times achieves the maxima instead of 4 times as predicted by the poisson distribution the probability of no typhoon in may every year from 2000 to 2016 no typhoon and one typhoon in the next four months are shown in table 5 respectively the comparison of the probability distributions in table 5 is shown in fig 8 a according to the prediction based on the poisson process considering the absence of typhoon in may the probability of typhoon occurring once from may to september is larger than that of no typhoon but smaller than that of one typhoon from june to september except for the year 2010 for year 2010 based on the prediction of poisson process if no typhoon occurs in may then most possibly there will be no typhoon happening in the next four months however the probability of one typhoon from may to september is still lower than the probability of one typhoon from june to september to further demonstrate the probability of typhoon frequency for the year 2000 the probability distributions based on poisson distribution and poisson process are presented in fig 8 b it implies that for the year 2010 considering that no typhoon occurs in may it is most possibly that no typhoon will occur among june and september as predicted by the poisson process approach however the poisson distribution underestimated its probability by about 7 4 4 application on forecasting the probability of typhoon occurrence in the previous subsection it has been demonstrated that the poisson process can be employed to estimate the probability of typhoon by considering its absence in may this section will discuss the application of the poisson process on forecasting the probability of typhoon before that it is understandable that the poisson distribution can also provide some information of the probability of future typhoon events as implied by table 3 based on the statistics in the past it is predicted in the future that the probability of typhoon occurring twice from may to september is the highest however this probability will not be affected by typhoon s occurrence absence in may nevertheless this is not true as indicated in the previous subsection to investigate probability of typhoon occurrences in naozhou island from may to september in the future by using the poisson process approach the probability of poisson intensity λ 1 is calculated and summarized in table 6 next we can examine the probability of the typhoon occurrence in naozhou island from may to september considering typhoon s absence in may in the future with respect to different poisson intensity when the poisson intensity is λ 1 0 2 the probability of no typhoon in may and one typhoon from may to september can be calculated through 23 p n 1 0 n 5 1 p λ 1 0 2 p n 1 0 n 5 n 1 1 p λ 1 0 2 p n 1 0 p n 4 1 p λ 1 0 2 0 0568 it indicates that when λ 1 0 2 there is no typhoon in may and one typhoon from may to september in the future is 5 68 repeating this procedure we can get the probability of such event in the future for poisson intensity equal to 0 4 0 6 0 8 respectively which are summarized in table 7 it can be obtained that there is no typhoon in may and one typhoon occurring from may to september in the future is 5 68 5 43 2 60 0 83 14 54 furthermore the probability of typhoon happening twice 3 times and 4 times in the future is 11 07 6 84 and 3 68 respectively it reveals that considering the typhoon s absence in may the probability of typhoon occurring once from may to september in the future is the highest and the probability decreases with larger typhoon frequency however such information cannot be provided by using the poisson distribution approach alone 4 5 prediction on the probability of typhoon occurrence intervals section 3 2 provides evidence that the number of typhoons from may to september n t t 0 can be described by the poisson process with parameter λ 1 taking t n n 1 as the time interval sequence from the n 1 th typhoon to the n th typhoon then the random variable t n n 1 2 is independent and follows the exponential distribution with mean 1 λ 1 i e t n e λ 1 for different poisson intensity the distribution function or the cumulative probability of typhoon are estimated by using eq 17 and they are displayed in fig 9 in addition the probability of a typhoon occurring within time interval t can be evaluated based on eq 18 and they are presented in fig 10 fig 9 shows that the cumulative probability grows in different speeds for different poisson intensities while the higher λ 1 is the faster the cumulative probability increases on the other hand the probability of typhoon interval also drops in different speeds regarding different poisson intensities and higher value of λ 1 leads to faster drop of its probability as shown in fig 10 for example when λ 1 0 6 the cumulative probability function and the probability density function can be given by 24 f t n t p t n t 1 e 0 6 t t 0 0 t 0 f t n t f t n t 0 6 e 0 6 t t 0 0 t 0 based on which the values of f t n t and f t n t are summarized in table 8 and displayed in figs 11 and 12 respectively table 8 depicts that the probability of the next typhoon occurring after 4 months is 1 0 9093 9 07 while the probability of the next occurrence after 7 months and 8 months is extremely low i e less than 2 and 1 respectively further to that the probability of the time interval t between the two typhoons greater than or equal to 1 month is p t n 1 1 f t n 1 0 5488 in addition the probability of typhoon interval can also be estimated on an even smaller time scale e g when λ 1 0 6 the probability of a typhoon in the next week is p t n 0 25 1 e 0 6 0 25 0 1393 furthermore the probability of a typhoon happening between the 1st and 2nd week is 25 p 0 25 t n 0 5 p t n 0 5 p t n 0 25 0 1199 the examples demonstrated in this subsection indicates that the poisson process approach can be used to predict the probability of typhoon occurrence interval and provide statistical information on a time scale of months or even weeks this is an important feature of the poisson process over the poisson distribution as a stochastic approach in the practice of typhoon forecasting 5 summary this study employs the poisson process approach to investigate the probability of typhoon occurrences and occurrence intervals based on the data collected on naozhou island in south china sea comparisons have been made between the results based on the poisson process and poisson distribution approach which shows that the former is the improvement of the latter in term of the purpose for predicting the probability of typhoon occurrences and occurrence intervals to be more specific the conclusions of this paper can be summarized as below 1 a strict mathematical description of the typhoon occurrence as a poison process and proof of its probability distribution is provided and its application in the practice of predicting the probability of typhoon occurrences is briefed based on that the probability of typhoon occurrences and occurrence intervals can be predicted theoretically which provides a new approach to gain insight of the typhoon statistics 2 a comparison between the poisson process and poisson distribution approach has been carried out according to the former the probability of typhoon occurs once from may to september in naozhou island achieves the maxima at august in year 2000 however such information cannot be provided by using the latter in addition it is noted that at the end of the observation the results of poisson process reduces to the poisson distribution implying the approach of using poisson process to describe the probability of typhoon occurrence is more advantageous over the poisson distribution 3 the study indicates that considering typhoon s absence in may the probability distribution of typhoon occurrences will become significantly different from the poisson distribution due to the inefficacy of the poisson distribution it cannot be used to estimate the probability of typhoon occurrences by considering typhoon s absence in may in fact taking into account of typhoon s absence in may the number of typhoons corresponding to the maximum probability will be different from that predicted by the poisson distribution 4 the poisson process approach can be employed to forecast the probability of typhoon occurrences in the future our results suggest that considering the typhoon s absence in may the probability of typhoon occurring once from may to september in the future is the highest and the probability decreases with larger number of typhoon occurrences however such information cannot be provided by using the poisson distribution approach alone 5 the cumulative probability of typhoon occurrences over time and probability of typhoon occurrence intervals have been obtained regarding different values of poisson intensities while their growth decline rate differs in response to different poisson intensities examples in subsection 4 5 suggests that the poisson process approach can be used to predict the probability of typhoon occurrence within specified time interval on a scale of months or even weeks the poisson process approach employed to study the probability of typhoon frequency in this paper can also be applied to investigate statistics of other natural disasters such as the water level and return period of storm surge and extreme wave heights etc in addition by incorporating the concept of poisson process the joint probability of typhoon and typhoon induced storm surge and extreme waves can be established which will be studied in the future credit authorship contribution statement guilin liu conceptualization methodology data curation funding acquisition writing original draft xiao li formal analysis investigation writing original draft visualization jinghua wang formal analysis investigation supervision writing review editing yi kou writing review editing xipeng wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was funded by the natural science foundation of shandong province no zr2019mee050 to which the authors show their gratitude 
21785,extreme meteorological events are becoming more frequent as a consequence of global warming typhoon as one of the natural disasters has caused significant damages globally therefore developing theoretical models to effectively predict typhoon probability is urgent based on the stochastic process theory this paper studies the local statistics of typhoon frequency and suggests a stochastic process model that can describe the number of typhoons occurring locally in time domain mathematical evidence has been provided to prove that the number of typhoons during a certain period can be described by using a stochastic process model furthermore the dependency of typhoon occurrences in different time periods and the probability distribution of typhoon occurrence intervals are explored the suggested model is employed to discuss the probability of typhoon on naozhou island in south china sea during may to september from year 2000 2016 subject to the absence of the event in may the results reveal that the probability distribution of typhoon events predicted by the suggested model is more reliable in comparison with conventional approach as it considered the typhoon occurrence in time domain which can provides useful information for predicting the probability of typhoons occurrence and intervals in engineering practice keywords typhoon frequency statistical characteristics stochastic process risk analysis 1 introduction frequent natural disasters often lead to a large number of casualties and economic losses according to the munich re group disaster database among the ten years from 2009 to 2018 natural disasters caused 371 000 deaths and 1 858 billion us dollar economic losses in united states of which meteorological disasters accounted for about 60 among all the meteorological disasters typhoons hurricanes impose significant threats to the human lives and urban development not only because of their high occurrence frequency and great destructive power but also due to other typhoon induced hazards such as inundation caused by storm surge and heavy precipitation in the context of global warming the occurrences of strong typhoons hurricanes have become more and more frequent as shown in fig 1 so as the induced marine disasters lin et al 2011 tajima et al 2014 nachman 2017 sun et al 2017 ha 2019 for instance super typhoon haiyan swept philippines in 2013 with the typhoon center maximum wind speed about 105 m s in tacloban city 90 of the buildings were razed to the ground tropical storm debbie ravaged the northern australia in 2017 and many towns in queensland were devastated in the following year in 2018 typhoon mangkhut caused extensive damages in asia area it is reported nearly 3 million people in china were affected and more than 1200 houses collapsed the total area of crops being affected was 174 400 ha resulting in direct economic losses of 52 million chinese yuan while in philippines 74 people were killed and economic losses accounted for 6 6 of its gdp which was more than 200 billion us dollars wang et al 2013 2016 2017 field 2017 liu et al 2019 liu et al 2019 2019 further to that if typhoon of similar intensity occurs multiple times the damages caused to marine coastal engineering facilities and coastal cities will be much more serious when conducting the risk assessment for such disasters the occurrence probability or frequency of the events will affect the value of risk function chen et al 2019b 2019a liu et al 2019 pence et al 2020 maclean et al 2020 namely r p i p i where p represents the occurrence probability of the event and i is the amount of losses due to the event therefore to give a reliable statistical description of the hazard factors e g frequency of typhoons hurricanes is not only important for gaining insight of the statistics of the hazards but also beneficial for engineering practices such as storm surge forecasting early warning and the risk assessment the key to successful risk assessment is the selection of hazard factors and the corresponding probability analysis of them liang et al 2019 2020 wu et al 2018 disasters caused by typhoons will be enhanced with the increasing frequency of typhoons if one can find a scientific way to determine the probability distribution of typhoon occurrence then the ability for risk management and mitigation in typhoon prone areas can be improved shao et al 2018 efforts were made to investigate the typhoon hurricane statistics e g jordan and ho 1962 analyzed the number of tropical cyclones from 1958 to 1986 where their numbers were considered as random variables while the seasonal and long term changes and the spatial correlations of tropical cyclone activities were studied later liu and ma 1976 and ma and liu 1979 suggested a compound distribution based on the discrete distribution of typhoon frequency and the continuous distribution of typhoon induced wave height in order to calculate their recurrence periods the stability of the results indicates that this method can overcome the shortcomings of the traditional method which is less reliable subject to limited data in short period shi 1992 further extended this model with the local frequency of typhoons fitted by poisson distribution and a stochastic model derived by simulating the local number of typhoons the model was verified by examining the typhoon statistics along the coast of shanghai and zhejiang in china and the results were in good agreement with the observations more recently kim et al 2019 considered typhoon frequency intensity and path etc based on the data collected among 2003 to 2014 and proposed a methodology to predict the loses which can be used in strategy making to reduce the typhoon risks tu and chen 2019 studied the correlation between the western pacific subtropical high wpsh and tropical sea surface temperature sst quantitatively and obtained the relationship between typhoon frequency wpsh and sst index in summer and early autumn in order to assess the typhoon activities in taiwan choi et al 2019 suggested a seasonal typhoon activity prediction model which can be used to investigate the contribution of the representative sst variability el niño southern oscillation north pacific sst and the increasing temperature of the entire pacific to the changes of typhoon activities in the western part of the northern pacific ocean those studies have made significant contributions to the current knowledge of typhoon statistics from the perspective of the typhoon frequency as a random variable however the frequency of typhoons in a certain sea area is essentially a random process which changes continuously with space and time montgomery et al 2014 katsuki et al 2017 kim and lee 2019 in fact the typhoon samples are a set of one dimensional time series thus should be described as a random process in other words the treatment of typhoon frequency as random variable cannot fully reflect the change of the number of typhoons over time as a consequence it imposes huge challenges to gain insight of the variation of probability of typhoon occurrence in time domain generally the traditional poisson distribution has been widely used in the analysis of typhoon probability in engineering practice shi 1992 zhang et al 2018 based on that the typhoon event occurs k times in the entire time interval can be described by the following equation 1 p x k p k λ 0 k k e λ 0 k 0 1 2 which is the so called poisson distribution and λ 0 denotes the average number of the events per interval eq 1 provides useful information for describing the probability of typhoon occurrence however it cannot be used to predict the probability of typhoon within an arbitrary specified time interval because number of typhoon x is regarded as a random variable obviously the number of typhoons in a certain period of time is a stochastic phenomenon if one examines the changes in the number of typhoons over time one must regard them as time dependent random variables i e a random process therefore as an alternative to eq 1 the state variable x t which is a function of time is introduced and the probability of typhoon occurring k times within 0 t can be given by ross et al 1996 2 p x t k p k t λ 1 t k k e λ 1 t k 0 1 2 where λ 1 denotes the time rate for the event to happen by using eq 2 the variation of probability of typhoon occurrence in time can be obtained such an approach has also be applied in many fields e g transition process in crystallography koag et al 2014 kou et al 2015 2018 pattern recognition in computer science escalante et al 2016 traffic flow modelling chen et al 2017 and earth sciences zhang et al 2018 zeng et al 2016 2017 this paper studied the statistical characteristics of typhoon occurrences based on a stochastic process model that can reflect the number of typhoons occurring in both time and space for the first time by using a family of random variables instead of one or a limited number of random variables to study the statistical characteristics of typhoon occurrence frequency one can get the probability of typhoon occurrence in different time periods and the probability corresponding to the number of occurrences in each time period based on whether the typhoon occurs in different time periods the probability of its occurrences intervals between events and the influence of the absence of typhoon on the probability of subsequent events is discussed comparisons with the conventional poisson distribution model have also been made in order to demonstrate the advantages of the present model the results indicate that the suggested model offers reliable predictions of probability of typhoon occurrences which can provide useful information in the practice of typhoon risk management and decision making process the paper is organized as the follows in section 2 the formulations of the model based on the random process theory for describing the probability of typhoon occurrences and its mathematical proof are presented section 3 discusses other statistical features of typhoon e g occurrence indicator and intervals examples of engineering applications are given in section 4 where the probability of typhoon recorded on naozhou island in china is analyzed finally section 5 presents the conclusions of this paper 2 probability model for the number of typhoon occurrence in a conventional approach the value of typhoon frequency within a time period t is defined as an observation while the set of observations at a consecutive sampling period t can be described as a group of random variables liu et al 2019 in this section however the mathematical model for describing the typhoon frequency within the specific time period is regarded as a random process instead of random variable specifically it is natural to assume that one can make limited number of observations within t on a time scale of t 0 t 2t 3t for example for the ς th observation at time t the deterministic function or sample function of number of typhoons can be expressed as n t which then forms a family of functions in terms of different values of ς this family of functions is dependent of time t therefore can be used to describe the typhoon frequency as a one dimensional random process liu et al 2019 next the deterministic sample function n t for describing the typhoon frequency from an engineering perspective will be given below definition to quantify the statistical nature of typhoon at a specified water area function n t is introduced as a counting process to represent the number of typhoons occurred within a specified time period 0 t for its purpose in engineering application n t meets the following criterions c1 initial value equals 0 n t 0 0 c2 independent increments the number of typhoons occurred within non overlapped time periods is independent c3 homogeneity the number of typhoons occurred within time period t 1 t 2 only depends on the length of the period t 2 t 1 regardless of the selection of t 1 c4 generality typhoon occurs no more than once within sufficiently short period for instance if p k δ t denotes the probability of typhoon occurred k times within period δ t when δ t is sufficiently small there must be a nonnegative number λ 1 that admits p 0 δ t 1 λ 1 δ t ο δ t the probability of no typhoon occurred within sufficiently small period is 1 λ 1 δ t p 1 δ t λ 1 δ t ο δ t the probability of typhoon occurred once within sufficiently small period is λ 1 δ t k 2 p k δ t ο δ t the probability of typhoon occurred more than once within sufficiently small period is extremely low where λ 1 denotes frequency of typhoon occurrence times per unit t i e the intensity or rate of the typhoon process for quantifying typhoon frequency in engineering practice it is understandable that function n t features the following properties for t t 0 t 0 0 1 the value of n t is a nonnegative integer 2 if t 1 t 2 then n t 1 n t 2 0 3 n t is an increasing step function 4 for t 1 t 2 n t1 t2 n t2 n t1 represents number of typhoons occurred within the period t1 t2 an example is displayed in fig 2 where it can be found that function n t is continuously increasing and differentiable everywhere in time domain except for a few limited points it is understandable that the deterministic sample function n t for the continuous observations of typhoon process is a step function with step length of 1 changing its value randomly in time domain theorem if n t t 0 as the counting process for representing the number of typhoons occurred within the specific time period meet the given criterions above it can be proved that the function n t describes a poisson process of strength λ 1 t liu et al 2019 i e the probability for n t k can be given by p k t λ 1 t k k e λ 1 t k 0 1 2 proof considering p k t δ t as the probability of typhoon occurring k times within period 0 t δ t according to c2 c3 and the total probability formulation one has ross et al 1996 3 p k t t p n t t k i 0 k p n t i n t t n t k i i 0 k p i i p k i t 1 for k 0 4 p 0 t δ t p n t δ t 0 p n t δ t n t 0 n t 0 p n t 0 p n t δ t n t 0 p 0 t p 0 δ t p 0 t 1 λ 1 δ t ο δ t p 0 t δ t p 0 t δ t λ 1 p 0 t ο δ t δ t let δ t 0 d p 0 t d t λ 1 p 0 t which leads to p 0 t c e λ 1 t where c is an arbitrary constant since p 0 0 p n 0 0 1 at t 0 p 0 t e λ 1 t 2 when k 1 5 p k t δ t p n t δ t k p n t δ t n 0 k p n t δ t n t n t n 0 k i 0 k p n t n 0 i n t δ t n t k i p n t δ t n t k i i 0 k p n t n 0 i p n t δ t n t k i i 0 k p i t p k i δ t p k t p 0 δ t p k 1 t p 1 δ t i 0 k 2 p i t p k i δ t 1 λ 1 δ t ο δ t p k t λ 1 δ t ο δ t p k 1 t ο δ t p k t δ t p k t δ t λ 1 p k t λ 1 p k 1 t ο δ t δ t let δ t 0 6 d p k t d t λ 1 p k t λ 1 p k 1 t for k 1 7 d p 1 t d t λ 1 p 1 t λ 1 e λ 1 t p 1 0 0 which yields 8 p 1 t λ 1 t e λ 1 t similarly making k 2 and using eq 8 will lead to the explicit formula for p 2 t by repeating this procedure one will eventually obtain 9 p k t λ 1 t k k e λ 1 t k 0 1 2 end of proof 3 mathematical description of other relevant statistical features of typhoon occurrences in addition to the above mentioned distribution of the number of typhoons it is also important to study the distribution of typhoon occurrence indicator and the distribution of typhoon time intervals t n 3 1 probability distribution of the typhoon occurrence indicator now let s use k t to indicate whether typhoon has occurred at time t where k t 1 means it occurred otherwise k t 1 based on that a function m t can be introduced to count the number of times that k t changes its value for instance when k t 1 m t will be 0 or an even number otherwise an odd number applies to m t when k t 1 as restated m t represents a group of random variables that changes its values in time therefore it is a measurable function defined in the sample space ω yielding real number values according to the section 2 m t for describing the number of times that k t changes its value induced by typhoon occurrence can be regarded as a poisson process during the time period 0 t m t follows the poisson distribution i e 10 p m t λ 1 t m m e λ 1 t which leads to the following one dimensional distributions 11 p k t 1 p m t is 0 or even k 0 p m t 2 k e λ 1 t cosh λ 1 t for describing no observation of typhoon occurrence and 12 p k t 1 p m t is odd k 0 p m t 2 k 1 e λ 1 t sinh λ 1 t for observation of typhoon occurrence at time t 3 2 probability distribution of the typhoon occurrence intervals given n t t 0 as the poisson process with a parameter λ 1 t n n 1 is time interval sequence for the corresponding n 1 th times to the n th times of typhoon occurrence then the time interval sequence t n n 1 2 is independent and follows index distribution with the mean of 1 λ 1 i e t n e λ 1 because t 1 indicates the time required before the first typhoon appearance thus t 1 t indicates that within 0 t typhoon has not yet appeared for t 0 there is 13 p t 1 t p n t 0 e λ 1 t therefore 14 p t 1 t 1 p t 1 t 1 e λ 1 t t 0 p t 1 t 0 t 0 the distribution function of t 1 is 15 f t 1 t 1 e λ 1 t t 0 0 t 0 this is an exponential distribution with mean of 1 λ 1 because t 2 is the time interval between the first and the second occurrences and the poisson process is an odd independent incremental process while considering the independence of the increment there is 16 p t 2 t t 1 s 1 p no typhoons in s 1 s 1 t t 1 s 1 p no typhoons in s 1 s 1 t p n s 1 t n s 1 0 p n t n 0 0 p n t 0 e λ 1 t it can be seen that t 2 also follows the exponential distribution with the mean 1 λ 1 and t 2 and t 1 are subject to same independent distribution in general for n 1 and t s 1 s 2 s n 1 0 there is p t n t t 1 s 1 t 2 s 2 t n 1 s n 1 p no typhoons in s 1 s n 1 s 1 s n 1 t t 1 s 1 t 2 s 2 t n 1 s n 1 p no typhoons in s 1 s n 1 s 1 s n 1 t p n s 1 s n 1 t n s 1 s n 1 0 p n t n 0 0 p n t 0 e λ 1 t that is the arrival time interval t n n 1 is an independent and uniformly distributed random variable which follows the exponential distribution with the mean of 1 λ 1 the distribution function of the typhoon arrival time interval is 17 f t n t 1 e λ 1 t t 0 0 t 0 the probability of typhoon interval is 1 minus the value obtained by eq 17 leading to 18 p t n t 1 f t n t e λ 1 t t 0 1 t 0 4 engineering application example in this paper the typhoon statistics in naozhou south china sea will be investigated and the maximum wind speed at the time of landfall is used to describe the intensity of the typhoon and the maximum wind speed on the ground near the center of the typhoon u m is selected as the criterion for justifying whether a typhoon occurs or not the typhoon characteristic data in 1960 and 2000 2016 without data in 2004 and 2007 e g its path maximum speed pressure etc are based on the reanalysis data obtained from shanghai typhoon institute of china meteorological administration which has been calibrated against observations according to the standards issued by the china meteorological administration the tropical cyclone is divided into six categories by u m as shown in table 1 according to the standard when u m exceeds 17 2 m s a tropical cyclone will be defined as a tropical storm ts and a typhoon blue warning signal will be issued at this time therefore in this article a typhoon occurs when the u m is larger than 17 2 m s and the center is within 400 km from naozhou island otherwise typhoon does not occur however to study typhoon statistics in other countries around the world users may refer to the local standards for its occurrence justification 4 1 typhoon frequency as a poisson process in 1960 the number of typhoon occurrences in a certain period of time is regarded as a random process in order to employ the mathematical model derived in section 2 and 3 the collection of all the observations of the typhoon is called the sample space and is denoted by ω in this way at every fixed time period t in the unit of month or season the number of typhoons observed within the same period becomes a set of random variables firstly the typhoon statistics in 1960 is studied and t as one month is selected the criteria for justifying typhoon s occurrence given above indicates that there were three typhoons in 2nd 17th june 21st june 1st july and 29th september 13th october respectively there was no typhoon in may thus the difference between the observed value of the number of typhoons in june and may is n 6 n 5 1 similarly n 10 n 9 1 and n 9 n 5 2 in general the probability of typhoon occurrences for 1960 can be represented by the poisson distribution of the mean value λ 0 3 meanwhile the number of typhoon occurrences n t should follow the poisson process with λ 1 0 25 and the sample curve of n t is shown in fig 3 based on that the one dimensional probability distribution of typhoon occurrences is given by p k t 0 25 t k k e 0 25 t k 0 1 2 the family of multi dimensional probability distributions of n t is 19 p n t 1 k 1 n t 2 k 2 n t n k n λ 1 k n e λ 1 t n t 1 k 1 t 2 t 1 k 2 k 1 t n t n 1 k n k n 1 k 1 k 2 k 1 k n k n 1 0 25 k n e 0 25 t n t 1 k 1 t 2 t 1 k 2 k 1 t n t n 1 k n k n 1 k 1 k 2 k 1 k n k n 1 in addition the typhoon occurrence indicator k t can be described as a poisson process with a mean value of λ 1 6 12 0 5 i e 20 p k t 1 k 0 p m t 2 k e 0 5 t cosh 0 5 t 21 p k t 1 k 0 p m t 2 k 1 e 0 5 t sinh 0 5 t where the number of k t changing its sign is m t 12 6 by using those equations derived in this subsection the probability of typhoon occurrences can be estimated it is found that the probability distributions based on the poisson process approach become a function of time which are distinguishable from the conventional poisson distribution the differences between the two methodologies will be discussed in the next subsection 4 2 on differences between poisson distribution and poisson process it is observed that typhoon mostly occurred among may and september in naozhou south china sea during the year 2000 2016 without data in 2004 and 2007 and the number of typhoons in each year is summarized in table 2 while the monthly distribution is displayed in fig 4 based on that the probability of typhoon occurrence frequency within these 15 years can be estimated and they are given in table 3 meanwhile their probability also follows the poisson distribution with λ 0 39 15 2 6 as described in fig 5 it indicates that the poisson distribution can generally be used to describe the probability of typhoon frequency between may and september throughout the entire 15 years however the poisson distribution does not provide further information about the probability of typhoon frequency varying in time it implies that for instance the probability of typhoon occurs k times between may and september is identical for each year from 2000 to 2016 according to the poisson distribution this imposes certain limitation on the poisson distribution in some real engineering applications where the temporal variation of the probability is of particular interest e g to conduct risk assessment within a given period next an example by direct comparison between the probability of typhoon frequency obtained by using poisson distribution and poisson process approaches is presented in order to further address this issue taking year 2000 for example since two typhoons occurred from may to september therefore the probability follows the poisson distribution with λ 0 2 and the probability of typhoons occurring once throughout the five months is p x 1 2 1 1 e 2 27 067 on the other hand the number of typhoon occurrences admits the poisson process of λ 1 0 4 and the probability that the typhoon occurs once throughout may to september is a function of time i e p 1 t 0 4 t e 0 4 t a comparison of the results obtained by using the poisson distribution and the poisson process is shown in fig 6 it shows that the poisson distribution gives a constant value regardless of time while the poisson process yields a curve of the typhoon probability that varies from may to september it is found that according to the predictions based on the poisson process approach the probability of typhoon occurs once from may to september achieves the maxima at august however such information cannot be provided by using the poisson distribution for analysis in addition it is noted that when t 5 the results of poisson process reduces to the poisson distribution indicating that the latter is indeed a special case of the former therefore the approach of using poisson process to describe the probability of typhoon frequency is more advantageous over the poisson distribution 4 3 impacts of typhoon s absence in may according to fig 4 typhoon in may only occurred once in 2006 among the 15 year data therefore it will be interesting to examine the probability of typhoon occurrence from may to september consider that no typhoon occurred in may for year 2000 the probability of one typhoon from may to september can be calculated by using eq 9 22 p n 1 0 n 5 1 p n 1 0 n 5 n 1 1 p n 1 0 p n 4 1 0 2165 it can be concluded that there is no typhoon in may and the probability of a typhoon in may to september is 21 65 by repeating this procedure the probability of typhoon occurring once twice three times and four times respectively from may to september from 2000 to 2016 is estimated and summarized in table 4 fig 7 a shows the probability distribution of typhoons that did not occur in may and a total number of 1 2 3 and 4 typhoons occurred among may to september from 2000 to 2016 it can be seen from the figure that when there is no typhoon in may the probability of typhoon occurrence from may to september decreases as the number of occurrences increases it further shows that considering typhoon s absence in may the probability distribution of typhoon frequency will become significantly different from the poisson distribution as demonstrated in fig 7 b taking year 2003 for example as indicated by the poisson distribution 4 typhoons occur from may to september in this year is most probably to happen however due to the inefficacy of the poisson distribution it cannot be used to estimate the probability of typhoon frequency by considering typhoon s absence in may in fact taking into account of typhoon s absence in may probability of typhoon occurring 3 times achieves the maxima instead of 4 times as predicted by the poisson distribution the probability of no typhoon in may every year from 2000 to 2016 no typhoon and one typhoon in the next four months are shown in table 5 respectively the comparison of the probability distributions in table 5 is shown in fig 8 a according to the prediction based on the poisson process considering the absence of typhoon in may the probability of typhoon occurring once from may to september is larger than that of no typhoon but smaller than that of one typhoon from june to september except for the year 2010 for year 2010 based on the prediction of poisson process if no typhoon occurs in may then most possibly there will be no typhoon happening in the next four months however the probability of one typhoon from may to september is still lower than the probability of one typhoon from june to september to further demonstrate the probability of typhoon frequency for the year 2000 the probability distributions based on poisson distribution and poisson process are presented in fig 8 b it implies that for the year 2010 considering that no typhoon occurs in may it is most possibly that no typhoon will occur among june and september as predicted by the poisson process approach however the poisson distribution underestimated its probability by about 7 4 4 application on forecasting the probability of typhoon occurrence in the previous subsection it has been demonstrated that the poisson process can be employed to estimate the probability of typhoon by considering its absence in may this section will discuss the application of the poisson process on forecasting the probability of typhoon before that it is understandable that the poisson distribution can also provide some information of the probability of future typhoon events as implied by table 3 based on the statistics in the past it is predicted in the future that the probability of typhoon occurring twice from may to september is the highest however this probability will not be affected by typhoon s occurrence absence in may nevertheless this is not true as indicated in the previous subsection to investigate probability of typhoon occurrences in naozhou island from may to september in the future by using the poisson process approach the probability of poisson intensity λ 1 is calculated and summarized in table 6 next we can examine the probability of the typhoon occurrence in naozhou island from may to september considering typhoon s absence in may in the future with respect to different poisson intensity when the poisson intensity is λ 1 0 2 the probability of no typhoon in may and one typhoon from may to september can be calculated through 23 p n 1 0 n 5 1 p λ 1 0 2 p n 1 0 n 5 n 1 1 p λ 1 0 2 p n 1 0 p n 4 1 p λ 1 0 2 0 0568 it indicates that when λ 1 0 2 there is no typhoon in may and one typhoon from may to september in the future is 5 68 repeating this procedure we can get the probability of such event in the future for poisson intensity equal to 0 4 0 6 0 8 respectively which are summarized in table 7 it can be obtained that there is no typhoon in may and one typhoon occurring from may to september in the future is 5 68 5 43 2 60 0 83 14 54 furthermore the probability of typhoon happening twice 3 times and 4 times in the future is 11 07 6 84 and 3 68 respectively it reveals that considering the typhoon s absence in may the probability of typhoon occurring once from may to september in the future is the highest and the probability decreases with larger typhoon frequency however such information cannot be provided by using the poisson distribution approach alone 4 5 prediction on the probability of typhoon occurrence intervals section 3 2 provides evidence that the number of typhoons from may to september n t t 0 can be described by the poisson process with parameter λ 1 taking t n n 1 as the time interval sequence from the n 1 th typhoon to the n th typhoon then the random variable t n n 1 2 is independent and follows the exponential distribution with mean 1 λ 1 i e t n e λ 1 for different poisson intensity the distribution function or the cumulative probability of typhoon are estimated by using eq 17 and they are displayed in fig 9 in addition the probability of a typhoon occurring within time interval t can be evaluated based on eq 18 and they are presented in fig 10 fig 9 shows that the cumulative probability grows in different speeds for different poisson intensities while the higher λ 1 is the faster the cumulative probability increases on the other hand the probability of typhoon interval also drops in different speeds regarding different poisson intensities and higher value of λ 1 leads to faster drop of its probability as shown in fig 10 for example when λ 1 0 6 the cumulative probability function and the probability density function can be given by 24 f t n t p t n t 1 e 0 6 t t 0 0 t 0 f t n t f t n t 0 6 e 0 6 t t 0 0 t 0 based on which the values of f t n t and f t n t are summarized in table 8 and displayed in figs 11 and 12 respectively table 8 depicts that the probability of the next typhoon occurring after 4 months is 1 0 9093 9 07 while the probability of the next occurrence after 7 months and 8 months is extremely low i e less than 2 and 1 respectively further to that the probability of the time interval t between the two typhoons greater than or equal to 1 month is p t n 1 1 f t n 1 0 5488 in addition the probability of typhoon interval can also be estimated on an even smaller time scale e g when λ 1 0 6 the probability of a typhoon in the next week is p t n 0 25 1 e 0 6 0 25 0 1393 furthermore the probability of a typhoon happening between the 1st and 2nd week is 25 p 0 25 t n 0 5 p t n 0 5 p t n 0 25 0 1199 the examples demonstrated in this subsection indicates that the poisson process approach can be used to predict the probability of typhoon occurrence interval and provide statistical information on a time scale of months or even weeks this is an important feature of the poisson process over the poisson distribution as a stochastic approach in the practice of typhoon forecasting 5 summary this study employs the poisson process approach to investigate the probability of typhoon occurrences and occurrence intervals based on the data collected on naozhou island in south china sea comparisons have been made between the results based on the poisson process and poisson distribution approach which shows that the former is the improvement of the latter in term of the purpose for predicting the probability of typhoon occurrences and occurrence intervals to be more specific the conclusions of this paper can be summarized as below 1 a strict mathematical description of the typhoon occurrence as a poison process and proof of its probability distribution is provided and its application in the practice of predicting the probability of typhoon occurrences is briefed based on that the probability of typhoon occurrences and occurrence intervals can be predicted theoretically which provides a new approach to gain insight of the typhoon statistics 2 a comparison between the poisson process and poisson distribution approach has been carried out according to the former the probability of typhoon occurs once from may to september in naozhou island achieves the maxima at august in year 2000 however such information cannot be provided by using the latter in addition it is noted that at the end of the observation the results of poisson process reduces to the poisson distribution implying the approach of using poisson process to describe the probability of typhoon occurrence is more advantageous over the poisson distribution 3 the study indicates that considering typhoon s absence in may the probability distribution of typhoon occurrences will become significantly different from the poisson distribution due to the inefficacy of the poisson distribution it cannot be used to estimate the probability of typhoon occurrences by considering typhoon s absence in may in fact taking into account of typhoon s absence in may the number of typhoons corresponding to the maximum probability will be different from that predicted by the poisson distribution 4 the poisson process approach can be employed to forecast the probability of typhoon occurrences in the future our results suggest that considering the typhoon s absence in may the probability of typhoon occurring once from may to september in the future is the highest and the probability decreases with larger number of typhoon occurrences however such information cannot be provided by using the poisson distribution approach alone 5 the cumulative probability of typhoon occurrences over time and probability of typhoon occurrence intervals have been obtained regarding different values of poisson intensities while their growth decline rate differs in response to different poisson intensities examples in subsection 4 5 suggests that the poisson process approach can be used to predict the probability of typhoon occurrence within specified time interval on a scale of months or even weeks the poisson process approach employed to study the probability of typhoon frequency in this paper can also be applied to investigate statistics of other natural disasters such as the water level and return period of storm surge and extreme wave heights etc in addition by incorporating the concept of poisson process the joint probability of typhoon and typhoon induced storm surge and extreme waves can be established which will be studied in the future credit authorship contribution statement guilin liu conceptualization methodology data curation funding acquisition writing original draft xiao li formal analysis investigation writing original draft visualization jinghua wang formal analysis investigation supervision writing review editing yi kou writing review editing xipeng wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was funded by the natural science foundation of shandong province no zr2019mee050 to which the authors show their gratitude 
21786,the localization performance of single beacon navigation system is affected by the accuracy of effective sound velocity esv which is difficult to precisely know the state augmented method and expectation maximization em based method the two existing state of the art single beacon navigation methods which can deal with the unknown esv are sensitive to the noise statistic parameters and vehicle initial position offset respectively this paper proposes a variational bayesian vb approximation based adaptive single beacon navigation method to deal with these deficiencies the esv is treated as a random variable with unknown statistic parameters and the state vector esv and esv uncertainty parameters are simultaneously estimated by vb approximation numerical studies indicate that the proposed vb approximation based navigation method can overcome the deficiencies of both state augmented and em based navigation methods achieve better localization and esv estimation performance than the existing state of the art methods keywords single beacon navigation variational bayesian effective sound velocity kalman filter 1 introduction autonomous underwater vehicles auvs are widely used in underwater operations such as exploration oceanographic survey or rescue mission and accurate underwater positioning is essential for these operations qin et al 2019a b emami and taban 2018 guerrero et al 2019 paull et al 2014 xiang et al 2017 unlike land and air operations lack of electromagnetic signals is a special issue in underwater environment range based acoustic navigation systems are mainstream methods in underwater operations the long baseline lbl underwater localization systems which depend on the slant range between vehicle and multi beacon are the most widely used underwater navigation methods lbl systems are expensive and time consuming due to the need of calibrating multi beacon positions before underwater missions paull et al 2014 chen et al 2016 miller et al 2010 in addition to lbl systems the single beacon navigation systems which fuse the slant range information of single beacon and the dead reckoning data have also attracted the attention of researchers existing studies on single beacon navigation system mainly focus on system design fallon et al 2010 claus et al 2018 kepper et al 2018 jin et al 2019 vaulin et al 2017 information fusion algorithm design wang et al 2013 walls and eustice 2014 webster et al 2013 webster et al 2012 and model observability analysis gadre and stilwell 2004 2005 de palma et al 2017 indiveri et al 2016 comparing with lbl systems the decrease in number of beacons reduces the cost and time consumption of single beacon navigation system and improves the utilization potential of the system in underwater environment the slant range is obtained from the effective sound velocity esv and the acoustic transit time measured by a hydrophone most existing single beacon navigation methods treat the esv as a known constant value fallon et al 2010 claus et al 2018 kepper et al 2018 jin et al 2019 wang et al 2013 walls and eustice 2014 webster et al 2013 webster et al 2012 gadre and stilwell 2004 2005 de palma et al 2017 indiveri et al 2016 however in the practical application of underwater navigation esv is time varying and hard to be accurately determined because of changing underwater environment the setting error of esv will lead to the ranging error and consequently deteriorate the performance of single beacon navigation system there are two common methods to deal with the unknown esv in single beacon navigation systems the state augmented method and the expectation maximization em method the state augmented based navigation method was originally proposed in zhu and hu 2018 and zhu et al 2016a b in which zhu et al treated the unknown esv as a part of state vector and estimated it along with the vehicle position by extended kalman filter ekf this method introduces an additional noise parameter related to the esv uncertainty which cannot be precisely obtained in practical application performance of navigation method proposed in zhu and hu 2018 zhu et al 2016a b is sensitive to the noise statistic parameter deng et al 2018 which limits its application the em based single beacon navigation method was recently proposed by qin et al 2019c which treated the esv as an unknown deterministic system parameter and used em method to simultaneously estimate the parameter and system state this method avoids the additional tuning parameter and achieves an ideal performance in the absence of initial position offset however a large initial position offset will induce large positioning error and esv estimated error to overcome the deficiencies of single beacon navigation methods proposed in zhu and hu 2018 zhu et al 2016a b and qin et al 2019c this paper proposes a variational bayesian vb approximation based adaptive single beacon navigation method vb approximation which has been widely concerned by the state estimation community is mainly used to estimate the unknown noise statistic parameters of state space model and design the corresponding adaptive kalman filter sarkka and nummenmaa 2009 huang et al 2018 xu et al 2018 2019 this paper treats the esv as a random variable with unknown statistic parameters and estimates the state vector esv and esv uncertainty parameters by vb approximation comparing with the state augmented method zhu and hu 2018 zhu et al 2016a b the esv uncertainty is modeled as a white gaussian process with unknown mean and variance which avoids the difficult kalman tuning process and enhances the adaptiveness of the navigation system comparing with the em based method qin et al 2019c the robustness of the proposed method to the initial position offset is improved with the help of bayesian treatment of esv field data will be used to study the possible improvement of the proposed vb based adaptive navigation method 2 single beacon underwater navigation model we roughly review the basic single beacon navigation model based on known esv in this section several studies describe the details of navigation model gadre and stilwell 2004 2005 casey et al 2007 in this paper the subscript k represents the k th epoch denote x k x k y k v c x k v c y k t as the discrete state vector in which x k and y k are the horizontal coordinates of the hydrophone in the x and y directions respectively and v c x k and v c y k are the corresponding ocean current components denote u k v w x k v w y k t as the input vector in which v w x k and v w y k are the in water velocity components of the vehicle in the x and y directions respectively v w x k and v w y k can be respectively obtained through v w x k v w k cos φ k and v w y k v w k sin φ k in which v w k is the vehicle speed obtained by the reading of propeller speed and φ k is the vehicle heading measured by electronic compass assuming that the ocean current and the vehicle in water velocity are constant within discrete time interval δ t the discrete time kinematic model of single beacon navigation can be expressed as 1 x k 1 y k 1 v c x k 1 v c y k 1 x k 1 1 0 δ t 0 0 1 0 δ t 0 0 1 0 0 0 0 1 a x k y k v c x k v c y k x k δ t 0 0 δ t 0 0 0 0 b v w x k v w y k u k w x k w y k w c x k w c y k w k in which a and b are the system transition matrix and the control matrix respectively and w k denotes the system uncertainty which is modeled as gaussian white noise process assuming that the two groups of uncertainties in w k are mutually independent the covariance matrix q k r 4 4 for w k can be characterized by two parameters σ c for the ocean current uncertainty and σ w for the vehicle in water speed uncertainty several studies describe the specific expression of q k zhu and hu 2018 zhu et al 2016a b by taking the slant range as measurement variable the measurement equation of single beacon navigation system can be written as 2 r k x k x b 2 y k y b 2 z k z b 2 ν r in which r k is the measured slant range ν r is the range measurement uncertainty which is modeled as a gaussian white noise process x k y k z k and x b y b z b are the coordinates of vehicle and beacon respectively in this paper the vehicle depth z k is assumed as a known quantity obtained from a depth sensor 3 vb based adaptive single beacon navigation method in this section vb method is used to estimate unknown esv and esv uncertainty parameters the measurement model is reformulated in section 3 1 and consequently the optimal filtering of the problem under consideration is described subsection in 3 2 the prediction and correction steps of vb based adaptive single beacon underwater navigation method are described in sections 3 3 and 3 4 respectively the proposed method is summarized in section 3 5 finally the influence of tuning parameters on system performance is analyzed in section 3 6 3 1 modified measurement model to estimate the esv online the unknown esv needs to be explicitly described in the measurement model denote t k t as the acoustic transit time at epoch k which is calculated by t k t t k a t k e in which t k a is the measured time of arrival toa and t k e is the known time of emission toe the acoustic transit time is treated as the measurement variable and eq 2 is reformulated as 3 m k t k t x k x b 2 y k y b 2 z k z b 2 v e k ν t where v e k is the esv at k th epoch and ν t is the measurement uncertainty associated with the acoustic transit time t t ν t is also modeled as a zero mean white gaussian process with the variance r k σ t m 2 instead of augmenting esv into the state vector zhu and hu 2018 zhu et al 2016a b this paper separately deals with the esv variation in underwater environment leads to the dramatic change of esv uncertainty which makes it difficult to accurately obtain the statistical characteristics of esv uncertainty to solve this problem esv uncertainty is modeled as a white gaussian process with unknown mean and variance thus the propagation model of esv is 4 v e k v e k 1 ω e k 1 in which ω e k 1 is a white gaussian process with unknown mean and variance denote μ k 1 and σ e k 1 2 as the mean and variance of esv uncertainty respectively from eq 3 the measurement model can be written as 5 m k h k x k v e k ν t in which h k x k v e k x k x b 2 y k y b 2 z k z b 2 v e k 3 2 problem formulation we assume that the statistical parameters of esv uncertainty μ k 1 and σ e k 1 2 are random variables with joint prior p μ k 1 σ e k 1 2 furthermore by assuming that the dynamic models of the state variables and esv are independent we get 6 p x k v e k μ k 1 σ e k 1 2 x k 1 v e k 1 p x k x k 1 p v e k v e k 1 μ k 1 σ e k 1 2 p μ k 1 σ e k 1 2 in the bayesian optimal filter the a posterior probability density function pdf p x k v e k μ k 1 σ e k 1 2 m 1 k needs to be computed in which m 1 k represents the measurement from the first to the k th epoch the a posterior pdf is commonly computed by the recursive procedure consisting of following steps sarkka and nummenmaa 2009 initialization the recursion starts from the initial pdf p x 1 v e 1 μ 0 σ e 0 2 prediction the a prior pdf of state variables esv and esv uncertainty statistical parameters is given by the chapman kolmogorov equation 7 p x k v e k μ k 1 σ e k 1 m k 1 p x k x k 1 p v e k v e k 1 μ k 1 σ e k 1 p μ k 1 σ e k 1 2 p x k 1 v e k 1 μ k 2 σ e k 2 2 m k 1 d x k 1 d v e k 1 d μ k 2 d σ e k 2 2 correction once the acoustic signal is received by auv the transit measurement m k can be calculated and consequently the correction procedure can be completed to get the a posterior pdf by the bayes rule 8 p x k v e k μ k 1 σ e k 1 2 m k p x k v e k μ k 1 σ e k 1 2 m k 1 p m k x k v e k μ k 1 σ e k 1 2 the procedures in eqs 7 8 commonly have no closed form solution since the integrations are not analytically tractable in the following part vb approximation will be applied to solve this problem and the corresponding approximate a posterior pdf will be obtained 3 3 prediction step due to the linearity of eq 1 if the a posterior pdf of x at k 1 th epoch is gaussian the a prior pdf of x at k th is gaussian 9 p x k m 1 k 1 n x k x ˆ k k 1 p k k 1 where n x μ σ denotes a gaussian pdf with mean vector μ and covariance matrix σ in this paper variables with subscript k k 1 and k k mean the a prior parameter and the a posterior parameter at k th epoch respectively x ˆ k k 1 and p k k 1 are the a prior state estimate and the a prior covariance matrix at k th epoch respectively from the prediction procedure of the kalman filter x ˆ k k 1 and p k k 1 can be calculated by 10 x ˆ k k 1 a k 1 x ˆ k 1 k 1 b k 1 u k 1 11 p k k 1 a k 1 p k 1 k 1 a k 1 t q k 1 in which x ˆ k 1 k 1 and p k 1 k 1 are the a posterior state estimate and the a posterior covariance matrix at k 1 th epoch respectively from eq 4 we get 12 p v e k v e k 1 μ k 1 σ e k 1 n v e k v e k 1 μ k 1 σ e k 1 2 the a prior pdf of v e at k th epoch is also gaussian if the a posterior pdf of v e at k 1 th epoch is gaussian 13 p v e k m 1 k 1 μ k 1 σ e k 1 n v e k v ˆ e k k 1 p e k k 1 in which v ˆ e k k 1 and p e k k 1 are the a prior estimation of esv and the a prior variance of esv at k th epoch respectively from the prediction procedure of the kalman filter v ˆ e k k 1 and p e k k 1 can be calculated as 14 v ˆ e k k 1 v ˆ e k 1 k 1 μ k 1 15 p e k k 1 p e k 1 k 1 σ e k 1 2 in which v ˆ e k 1 k 1 and p e k 1 k 1 are the a posterior estimation of esv and the a posterior variance of esv at k 1 th epoch respectively unknown σ e k 1 2 and μ k 1 require to be estimated in the process of estimating esv however direct estimation of σ e k 1 2 will induce an intractable integration without closed form analytical solution thus this paper will estimate p e k k 1 and the influence of inaccurate σ e k 1 2 can be compensated by the adaptive estimation of p e k k 1 denote the prediction equation of esv as 16 v ˆ e k k 1 v ˆ e k 1 k 1 μ k 1 17 p e k k 1 p e k 1 k 1 σ e k 1 2 in which μ k 1 and σ e k 1 2 are the nominal value of μ k 1 and σ e k 1 2 respectively v ˆ e k k 1 and p e k k 1 are the nominal a prior pdf statistic parameters of v e k denoting the a prior pdf of μ k 1 and p e k k 1 as their conjugate prior distribution the gaussian inverse gamma gig distribution is as follows 18 p μ k 1 p e k k 1 m 1 k 1 gig μ k 1 p e k k 1 τ ˆ k k 1 α ˆ k k 1 λ ˆ k k 1 ν ˆ k k 1 in which gig a a τ α λ ν is a gig distribution parameterized by τ α λ and ν gig distribution can be decoupled as 19 gig a a τ α λ ν n a τ β ig a λ ν in which β α a and ig a λ ν is an inverse gamma distribution from eqs 18 and 19 the conjugate prior distribution of μ k and p e k k 1 can be written as following hierarchical gaussian forms 20 p μ k 1 p e k k 1 m 1 k 1 n μ k 1 τ ˆ k k 1 β ˆ k k 1 21 p p e k k 1 m 1 k 1 ig p e k k 1 λ ˆ k k 1 ν ˆ k k 1 in which β ˆ k k 1 α ˆ k k 1 p e k k 1 if a ig a λ ν then e a 1 λ ν sarkka and nummenmaa 2009 in which e represents expectation operator to capture the a priori information of p e k k 1 and μ k 1 the expectation of p e k k 1 1 and μ k 1 should satisfy 22 e p e k k 1 1 1 p e k k 1 23 e μ k 1 μ k 1 combining eqs 20 23 yields 24 p e k k 1 ν ˆ k k 1 λ ˆ k k 1 25 μ k 1 τ ˆ k k 1 from eqs 24 and 25 the prediction equations for the statical parameters of μ k 1 and p e k k 1 can be designed as following heuristic form 26 τ ˆ k k 1 μ k 1 27 α ˆ k k 1 ρ α 28 λ ˆ k k 1 ρ λ 29 ν ˆ k k 1 ρ λ p e k k 1 where ρ α and ρ λ are the tuning parameters 3 4 correction step since the measurement model h k x k v e k is nonlinear conduct the linearization of h k x k v e k at the nominal point x ˇ k v ˇ e k and neglect higher order terms 30 h k x k v e k h k x ˇ k v ˇ e k h x k x k x ˇ k h v e k v e k v ˇ e k where 31 h x k h k x k v e k x k x k x ˇ k v e k v ˇ e k 32 h v e k h k x k v e k v e k x k x ˇ k v e k v ˇ e k are the jacobians of the measurement model at the nominal point using the linearized model eq 30 the likelihood pdf can be approximated by a gaussian distribution 33 p m k x k v e k n m k h ˇ k x k v e k r k in which h ˇ k x k v e k h k x ˇ k v ˇ e k h x k x k x ˇ k h v e k v e k v ˇ e k from eqs 9 13 and 33 the a posterior pdf of state and esv are both gaussian which can be respectively denoted as 34 p x k m 1 k n x k x ˆ k k p k k 35 p v e k m 1 k μ k 1 p e k k 1 n v e k v ˆ e k k p e k k since the a prior pdf of μ k 1 and p e k k 1 is chosen as their conjugate prior distribution the a posterior of these two variables is also gig distribution 36 p μ k 1 p e k k 1 m 1 k gig μ k 1 p e k k 1 τ ˆ k k α ˆ k k λ ˆ k k ν ˆ k k similarly eq 36 can be written as following hierarchical gaussian forms 37 p p e k k 1 m 1 k ig p e k k 1 λ ˆ k k ν ˆ k k 38 p μ k 1 p e k k 1 m 1 k n μ k 1 τ ˆ k k β ˆ k k in which β ˆ k k α ˆ k k p e k k 1 x k v e k μ k 1 and p e k k 1 are the unknown variables requiring joint estimation the joint a posterior pdf p x k v e k μ k 1 p e k k 1 m 1 k does not have analytical solution vb approach is utilized in this paper to get a free form factored approximation solution of p x k v e k μ k 1 p e k k 1 m 1 k 39 p x k v e k μ k 1 p e k k 1 m 1 k q x k q v e k q μ k 1 q p e k k 1 in which q x k q v e k q μ k 1 and q p e k k 1 are the approximation factor of joint a posterior pdf and satisfy 40 q x k q v e k q μ k 1 q p e k k 1 arg min kld q x k q v e k q μ k 1 q p e k k 1 p x k v e k μ k 1 p e k k 1 m 1 k where kld q x p x denotes the kullback leibler divergence kld between q x and p x kld is the degree of inconsistency between two pdfs and is defined as kld q x p x q x log q x p x d x from tzikas et al 2008 and huang et al 2018 the optimal solution for eq 40 satisfies 41 log q θ e x k v e k μ k 1 p e k k 1 θ log p x k v e k μ k 1 p e k k 1 m 1 k c θ in which θ is the arbitrary element of x k v e k μ k 1 and p e k k 1 superscript θ is the set of all elements except θ and c θ denotes a constant value with respect to variable θ from eqs 9 13 20 21 and 33 the logarithmic form of joint pdf p x k v e k μ k 1 p e k k 1 m 1 k can be written as 42 log p x k v e k μ k 1 p e k k 1 m 1 k m k h ˇ k x k v e k 2 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 v e k v ˆ e k 1 k 1 μ k 1 2 2 p e k k 1 μ k 1 τ ˆ k k 1 2 2 α ˆ k k 1 p e k k 1 λ ˆ k k 1 2 log p e k k 1 ν ˆ k k 1 p e k k 1 c x k v e k μ k 1 p e k k 1 since x k v e k μ k 1 and p e k k 1 are coupled the calculation of q θ is not analytically tractable fixed point iteration is used here denote the superscript i as the i th iteration take x ˆ k k i v ˆ e k k i as the linearized point and denote corresponding jacobians as h x k i and h v e k i respectively let θ x k substituting eq 42 into eq 41 yields 43 log q i 1 x k δ x m k i h x k i x k 2 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 c x k where δ x m k i m k h k x ˆ k k i v ˆ e k k i h x k i x ˆ k k i the proof of eq 43 is given in appendix a combining eqs 43 and 34 yields 44 log q i 1 x k x k x ˆ k k i 1 t p k k i 1 1 x k x ˆ k k i 1 2 c x k in which 45 k k i 1 p k k 1 h x k i t h x k i p k k 1 h x k i t r k 1 46 x ˆ k k i 1 x ˆ k k 1 k k i 1 δ x m k i h x k i x ˆ k k 1 47 p k k i 1 p k k 1 k k i 1 h x k i p k k 1 let θ p e k k 1 combining eqs 41 and 42 yields 48 log q i 1 p e k k 1 λ ˆ k k 1 2 log p e k k 1 ν ˆ k k 1 a ˆ k i b ˆ k i p e k k 1 c p e k k 1 in which 49 a ˆ k i 1 2 p e k k i v ˆ e k k i v ˆ e k 1 k 1 τ ˆ k k i 2 β ˆ k k i 50 b ˆ k i 1 2 β ˆ k k i τ ˆ k k i τ ˆ k k 1 2 α ˆ k k 1 the proof of eq 48 is given in appendix b combining eqs 37 and 48 yields 51 log q i 1 p e k k 1 λ ˆ k k i 1 1 log p e k k 1 ν ˆ k k i 1 p e k k 1 c p e k k 1 in which 52 λ ˆ k k i 1 λ ˆ k k 1 1 53 ν ˆ k k i 1 ν ˆ k k 1 a ˆ k i b ˆ k i choose the a prior variance of esv as 54 p e k k 1 i 1 1 e i 1 p e k k 1 1 ν ˆ k k i 1 λ ˆ k k i 1 let θ μ k and substitute eq 42 into eq 41 55 log q i 1 μ k 1 μ k 1 τ ˆ k k 1 α ˆ k k 1 v ˆ e k k i v ˆ e k 1 k 1 α ˆ k k 1 1 2 2 p e k k 1 i α ˆ k k 1 α ˆ k k 1 1 c μ k 1 the proof of eq 55 is given in appendix c combining eqs 38 and 55 yields 56 log q i 1 μ k 1 μ k 1 τ ˆ k k i 1 2 2 β ˆ k k i 1 c μ k 1 in which 57 τ ˆ k k i 1 τ ˆ k k 1 α ˆ k k 1 v ˆ e k k i v ˆ e k 1 k 1 α ˆ k k 1 1 58 β ˆ k k i 1 α ˆ k k 1 α ˆ k k 1 1 p e k k 1 i the estimated mean of esv uncertainty is calculated by 59 μ k 1 i 1 e i 1 μ k 1 τ ˆ k k i 1 denote 60 v ˆ e k k 1 i 1 v ˆ e k 1 k 1 μ k 1 i 1 take x ˆ k k i 1 v ˆ e k k 1 i 1 as the linearized point and denote corresponding jacobians as h x k i 1 and h v e k i 1 respectively let θ v e k substituting eq 42 into eq 41 yields 61 log q i 1 v e k δ v e m k i 1 h v e k i 1 v e k 2 2 r k v e k v ˆ e k k 1 i 1 2 2 p e k k 1 i 1 c v e k in which 62 δ v e m k i 1 m k h k x ˆ k k i 1 v ˆ e k k 1 i 1 h v e k i 1 v ˆ e k k 1 i 1 the proof of eq 61 is given in appendix d combining eqs 61 and 35 yields 63 log q i 1 v e k 1 2 v e k v ˆ e k k i 1 2 p e k k i 1 c v e k in which 64 k e k i 1 p e k k 1 i 1 h v e k i 1 h v e k i 1 2 p e k k 1 i 1 r k 1 65 v ˆ e k k i 1 v ˆ e k k 1 i 1 k e k i 1 δ v e m k i 1 h v e k i 1 v ˆ e k k 1 i 1 66 p e k k i 1 p e k k 1 i 1 k e k i 1 h v e k i 1 p e k k 1 i 1 3 5 algorithm combining the prediction and correction steps the vb based adaptive single beacon underwater navigation method at k th epoch is listed in algorithm 1 in particular we judge iterative convergence by detecting the change of esv which means that x k v e k μ k 1 and p e k k 1 are iteratively updated in the correction step they update repeatedly until the change of v e k i between two consecutive iterations is less than a threshold value ε in addition we use indirect ocean current measurement to correct the ocean current the corresponding standard deviation of measurement noise is denoted as σ c m specific correction steps can refer to zhu and hu 2018 zhu et al 2016a b and are omitted for simplicity theorem 1 if ρ α and r k in eq 64 is set as 0 line 8 line 13 in the algorithm 1 can be replaced by v ˆ e k k i 1 v ˆ e k k i 2 v ˆ e k k i m k r i 1 in which r i 1 x ˆ k k i 1 x b 2 y ˆ k k i 1 y b 2 z k z b 2 proof if r k 0 eq 64 can be simplified as 67 k e k i 1 1 h v e k i 1 v ˆ e k k 1 i 1 2 r i 1 in which 68 r i 1 x ˆ k k i 1 x b 2 y ˆ k k i 1 y b 2 z k z b 2 h k x ˆ k k i 1 v ˆ e k k 1 i 1 v ˆ e k k 1 i 1 substituting eqs 62 67 and 68 into eq 65 yields 69 v ˆ e k k i 1 v ˆ e k k 1 i 1 v ˆ e k k 1 i 1 2 r i 1 m k h k x ˆ k k i 1 v ˆ e k k 1 i 1 v ˆ e k k 1 i 1 2 v ˆ e k k 1 i 1 m k r i 1 combining eqs 26 27 57 59 and 60 one gets 70 v ˆ e k k 1 i 1 v ˆ e k 1 k 1 μ k 1 ρ α v ˆ e k k i v ˆ e k 1 k 1 ρ α 1 from eq 70 one gets 71 lim ρ α v ˆ e k k 1 i 1 v ˆ e k k i combine eqs 69 and 71 to prove theorem 1 remark 1 from theorem 1 if ρ α and r k in eq 64 is set as 0 the proposed vb based method is equivalent to the em based single beacon navigation method proposed in qin et al 2019c thus the navigation method in qin et al 2019c is a special case of the proposed method which indicates that the proposed method is more generalized 3 6 parameter selection to implement the proposed algorithm the tuning parameters ρ α and ρ λ and the nominal esv uncertainty parameters μ k and σ e k need to be selected 3 6 1 selection of ρ λ combining eqs 17 28 29 52 53 and 54 we get the recursive form of p e k k 1 i 1 as 72 p e k k 1 i 1 ρ λ p e k 1 k 1 σ e k 1 2 a ˆ k i b ˆ k i ρ λ 1 from eq 72 the modified a priori variance of esv p e k k 1 i 1 is the weighted sum of priori information p e k 1 k 1 σ e k 1 2 and the innovation a ˆ k i b ˆ k i with weights ρ λ and 1 respectively the nominal parameter σ e k 1 dominates the accuracy of the nominal a priori variance of esv uncertainty and the parameter ρ λ dominates the confidence level of σ e k 1 3 6 2 selection of ρ α from eqs 26 27 57 and 59 we get 73 μ k 1 i 1 μ k 1 ρ α v ˆ e k k i v ˆ e k 1 k 1 ρ α 1 eq 73 indicates that μ k 1 i 1 equals to the weighted average between μ k 1 and v ˆ e k k i v ˆ e k 1 k 1 similar with section 3 6 1 the nominal mean μ k 1 dominates the accuracy of the nominal a priori mean of esv uncertainty and the parameter ρ α dominates the confidence level of μ k 1 3 6 3 selection of μ k 1 and σ e k 1 since vb approach only guarantees the local convergence of variational iterations accurate priori information is necessary therefore the nominal parameters μ k 1 and σ e k 1 are required to be close to the true values μ k 1 and σ e k 1 respectively 4 numerical studies the field data collected from surface boat is utilized to evaluate the performance of proposed vb based navigation method referred to as the pm against that of the existing state augmented method zhu and hu 2018 zhu et al 2016a b and em based navigation method qin et al 2019c referred to as the sam and emm respectively several studies describe the methods of collecting field data zhu and hu 2018 zhu et al 2016a b the boat is equipped with hydrophone which can receive the acoustic signal transmitted by the beacon mounted at the sea floor with a surveyed location of 123 745 m underwater the boat cruises at a speed of about 3 m s and the ground truth trajectory is provided by gps when implementing sam emm and pm the following initial settings are selected 1 10 m in both the x and y directions for the initial position offset 2 0 5 m s in both the x and y directions for the initial ocean current offset 3 1500 m s for the nominal v e the tuning parameters of these three methods are 1 σ c 0 01 m s 2 σ w 0 1 m s 3 σ t m 0 001 s 4 σ c m 0 01 m s 5 σ e k 1 m s 6 μ k 0 m s 7 ρ α 9 8 ρ λ 1 and 9 the threshold value ε is chosen as 0 0001 m s the averaged root mean square arms of horizontal distance error arms δ h 1 t k 1 t x k x ˆ k 2 y k y ˆ k 2 and the arms of estimated esv error arms δ v e 1 k k 1 k v e k v ˆ e k 2 are utilized as the evaluation indexes t and k are the total number of fixed sampling intervals and the transit time measurements respectively the comparison of the estimated trajectories among sam emm and pm is shown in fig 1 similarly fig 2 is the corresponding comparison of the horizontal distance error δ h δ x 2 δ y 2 for all three methods the arms δ h of sam emm and pm are 7 56 m 14 44 m and 6 18 m respectively from figs 1 and 2 along with the arms δ h we get the conclusion that pm has the highest accuracy among three navigation methods the localization performance of existing state augmented method is slightly worse than that of pm due to the inaccuracy of statistical parameter related to esv uncertainty the large positioning error of emm is caused by large initial position offset whereas pm and sam will not be affected by this factor fig 3 shows the estimated esv by sam emm and pm the arms δ v e of three methods are 7 13 m s 23 38 m s and 5 41 m s respectively this demonstrates that both sam and pm can follow the variation trend of esv and the estimation outcome of pm is slightly better than that of sam due to the adaptiveness of pm to esv uncertainty parameters again the initial position offset deteriorates the esv estimation performance of emm to better illustrate the adaptiveness of pm we analyze the arms δ h and arms δ v e under different σ e in this part of simulation ρ λ is set as 0 which indicates that we have no confidence in σ e as shown in section 3 6 1 the numerical comparison between sam and pm is shown in fig 4 fig 4 shows that sam is sensitive to σ e whereas pm exhibits good navigation performance under different σ e which indicates the adaptiveness of pm finally we study the iteration times during each correction step fig 5 demonstrates that all the acoustic transit time corrections can converge to a steady state within 50 iterations except for the first correction epoch the measurement interval of transit time is commonly long enough to process the iterations in real application 30 s in this group of field data 5 concluding remarks the esv setting error will deteriorate the performance of single beacon navigation system the existing state of the art single beacon navigation methods include the state augmented method and the em based method the former is sensitive to the noise statistic parameter related to the esv uncertainty that is difficult to tune whereas the latter is sensitive to vehicle initial position offset to overcome the deficiencies of existing state of the art single beacon navigation methods this paper proposed a vb approximation based adaptive single beacon navigation method which treats the esv as a random variable with unknown statistic parameters and estimates the state vector esv and esv uncertainty parameters by vb approximation numerical studies using field data indicate that the proposed method has better navigation performance than the existing state augmented method and em based method both in localization error and esv estimation error comparing with state augmented method the adaptiveness of the proposed method to inaccurate statistic parameters is improved and comparing with em based navigation method the proposed method is more robust to the initial position offset credit authorship contribution statement hong de qin conceptualization funding acquisition project administration xiang yu conceptualization methodology validation writing original draft zhong ben zhu resources supervision writing review editing zhong chao deng investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was funded by the national natural science foundation of china under grant 51939003 and 51879062 appendix a derivation of eq 43 let θ x k substituting eq 42 into eq 41 we get 74 log q i 1 x k 1 2 e i m k h k x ˆ k k i v ˆ e k k i h x k i x k x ˆ k k i h v e k i v e k v ˆ e k k i 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 c x k 1 2 e i m k h k x ˆ k k i v ˆ e k k i h x k i x ˆ k k i h v e k i v e k v ˆ e k k i h x k i x k 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 c x k 1 2 δ x m k i h x k i x k 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 c x k thus eq 43 is got appendix b derivation of eq 48 let θ p e k k 1 substituting eq 42 into eq 41 yields 75 log q i 1 p e k k 1 λ ˆ k k 1 2 log p e k k 1 ν ˆ k k 1 p e k k 1 1 2 e i v e k v ˆ e k 1 k 1 μ k 1 2 μ k 1 τ ˆ k k 1 2 α ˆ k k 1 p e k k 1 c p e k k 1 the expectation can be calculated as 76 e i v e k v ˆ e k 1 k 1 μ k 1 2 e i v e k v ˆ e k k i v ˆ e k k i v ˆ e k 1 k 1 τ ˆ k k i τ ˆ k k i μ k 1 2 p e k k i v ˆ e k k i v ˆ e k 1 k 1 τ ˆ k k i 2 β ˆ k k i and 77 e i μ k 1 τ ˆ k k 1 2 e i μ k 1 τ ˆ k k i τ ˆ k k i τ ˆ k k 1 2 β ˆ k k i τ ˆ k k i τ ˆ k k 1 2 substituting eqs 76 and 77 into eq 75 yields eq 48 appendix c derivation of eq 55 let θ μ k 1 substituting eq 42 into eq 41 yields 78 log q i 1 μ k 1 1 2 e i v e k v ˆ e k 1 k 1 μ k 1 2 p e k k 1 1 2 μ k 1 τ ˆ k k 1 2 α ˆ k k 1 e i 1 p e k k 1 c μ k 1 1 2 p e k k 1 i μ k 1 2 2 μ k 1 e i v e k v ˆ e k 1 k 1 1 2 μ k 1 τ ˆ k k 1 2 α ˆ k k 1 p e k k 1 i c μ k 1 from e i v e k v ˆ e k 1 k 1 v e k i v ˆ e k 1 k 1 we get 79 log q i 1 μ k 1 1 2 p e k k 1 i μ k 1 v ˆ e k k i v ˆ e k 1 k 1 2 μ k 1 τ ˆ k k 1 2 α ˆ k k 1 c μ k 1 1 2 p e k k 1 i μ k 1 τ ˆ k k 1 α ˆ k k 1 v ˆ e k k i v ˆ e k 1 k 1 α ˆ k k 1 1 2 α ˆ k k 1 α ˆ k k 1 1 c μ k 1 thus eq 55 is got appendix d derivation of eq 61 the following lemma is needed to infer eq 61 lemma 1 suppose the joint pdf of random variables μ and p is a gig distribution i e p μ p g i g μ p τ α λ ν then 80 e μ p e μ e 1 p proof 81 e μ p 0 μ p n μ τ α p ig p λ ν d μ d p 2 π α 1 2 1 γ λ ν λ 0 μ p exp 1 2 α p μ τ 2 p λ 1 p 1 2 exp ν p d μ d p e μ 1 γ λ ν λ 0 p 1 p λ 1 exp ν p d p e μ e 1 p let θ v e k substituting eq 42 into eq 41 we get the equation given in box i from eq 60 we get e i 1 v ˆ e k 1 k 1 μ k 1 v ˆ e k k 1 i 1 then 83 log q i 1 v e k δ v e m k i 1 h v e k i 1 v e k 2 2 r k 1 2 p e k k 1 i 1 v e k 2 2 v e k v ˆ e k k 1 i 1 c v e k δ v e m k i 1 h v e k i 1 v e k 2 2 r k 1 2 p e k k 1 i 1 v e k v ˆ e k k 1 i 1 2 c v e k thus eq 61 is got 
21786,the localization performance of single beacon navigation system is affected by the accuracy of effective sound velocity esv which is difficult to precisely know the state augmented method and expectation maximization em based method the two existing state of the art single beacon navigation methods which can deal with the unknown esv are sensitive to the noise statistic parameters and vehicle initial position offset respectively this paper proposes a variational bayesian vb approximation based adaptive single beacon navigation method to deal with these deficiencies the esv is treated as a random variable with unknown statistic parameters and the state vector esv and esv uncertainty parameters are simultaneously estimated by vb approximation numerical studies indicate that the proposed vb approximation based navigation method can overcome the deficiencies of both state augmented and em based navigation methods achieve better localization and esv estimation performance than the existing state of the art methods keywords single beacon navigation variational bayesian effective sound velocity kalman filter 1 introduction autonomous underwater vehicles auvs are widely used in underwater operations such as exploration oceanographic survey or rescue mission and accurate underwater positioning is essential for these operations qin et al 2019a b emami and taban 2018 guerrero et al 2019 paull et al 2014 xiang et al 2017 unlike land and air operations lack of electromagnetic signals is a special issue in underwater environment range based acoustic navigation systems are mainstream methods in underwater operations the long baseline lbl underwater localization systems which depend on the slant range between vehicle and multi beacon are the most widely used underwater navigation methods lbl systems are expensive and time consuming due to the need of calibrating multi beacon positions before underwater missions paull et al 2014 chen et al 2016 miller et al 2010 in addition to lbl systems the single beacon navigation systems which fuse the slant range information of single beacon and the dead reckoning data have also attracted the attention of researchers existing studies on single beacon navigation system mainly focus on system design fallon et al 2010 claus et al 2018 kepper et al 2018 jin et al 2019 vaulin et al 2017 information fusion algorithm design wang et al 2013 walls and eustice 2014 webster et al 2013 webster et al 2012 and model observability analysis gadre and stilwell 2004 2005 de palma et al 2017 indiveri et al 2016 comparing with lbl systems the decrease in number of beacons reduces the cost and time consumption of single beacon navigation system and improves the utilization potential of the system in underwater environment the slant range is obtained from the effective sound velocity esv and the acoustic transit time measured by a hydrophone most existing single beacon navigation methods treat the esv as a known constant value fallon et al 2010 claus et al 2018 kepper et al 2018 jin et al 2019 wang et al 2013 walls and eustice 2014 webster et al 2013 webster et al 2012 gadre and stilwell 2004 2005 de palma et al 2017 indiveri et al 2016 however in the practical application of underwater navigation esv is time varying and hard to be accurately determined because of changing underwater environment the setting error of esv will lead to the ranging error and consequently deteriorate the performance of single beacon navigation system there are two common methods to deal with the unknown esv in single beacon navigation systems the state augmented method and the expectation maximization em method the state augmented based navigation method was originally proposed in zhu and hu 2018 and zhu et al 2016a b in which zhu et al treated the unknown esv as a part of state vector and estimated it along with the vehicle position by extended kalman filter ekf this method introduces an additional noise parameter related to the esv uncertainty which cannot be precisely obtained in practical application performance of navigation method proposed in zhu and hu 2018 zhu et al 2016a b is sensitive to the noise statistic parameter deng et al 2018 which limits its application the em based single beacon navigation method was recently proposed by qin et al 2019c which treated the esv as an unknown deterministic system parameter and used em method to simultaneously estimate the parameter and system state this method avoids the additional tuning parameter and achieves an ideal performance in the absence of initial position offset however a large initial position offset will induce large positioning error and esv estimated error to overcome the deficiencies of single beacon navigation methods proposed in zhu and hu 2018 zhu et al 2016a b and qin et al 2019c this paper proposes a variational bayesian vb approximation based adaptive single beacon navigation method vb approximation which has been widely concerned by the state estimation community is mainly used to estimate the unknown noise statistic parameters of state space model and design the corresponding adaptive kalman filter sarkka and nummenmaa 2009 huang et al 2018 xu et al 2018 2019 this paper treats the esv as a random variable with unknown statistic parameters and estimates the state vector esv and esv uncertainty parameters by vb approximation comparing with the state augmented method zhu and hu 2018 zhu et al 2016a b the esv uncertainty is modeled as a white gaussian process with unknown mean and variance which avoids the difficult kalman tuning process and enhances the adaptiveness of the navigation system comparing with the em based method qin et al 2019c the robustness of the proposed method to the initial position offset is improved with the help of bayesian treatment of esv field data will be used to study the possible improvement of the proposed vb based adaptive navigation method 2 single beacon underwater navigation model we roughly review the basic single beacon navigation model based on known esv in this section several studies describe the details of navigation model gadre and stilwell 2004 2005 casey et al 2007 in this paper the subscript k represents the k th epoch denote x k x k y k v c x k v c y k t as the discrete state vector in which x k and y k are the horizontal coordinates of the hydrophone in the x and y directions respectively and v c x k and v c y k are the corresponding ocean current components denote u k v w x k v w y k t as the input vector in which v w x k and v w y k are the in water velocity components of the vehicle in the x and y directions respectively v w x k and v w y k can be respectively obtained through v w x k v w k cos φ k and v w y k v w k sin φ k in which v w k is the vehicle speed obtained by the reading of propeller speed and φ k is the vehicle heading measured by electronic compass assuming that the ocean current and the vehicle in water velocity are constant within discrete time interval δ t the discrete time kinematic model of single beacon navigation can be expressed as 1 x k 1 y k 1 v c x k 1 v c y k 1 x k 1 1 0 δ t 0 0 1 0 δ t 0 0 1 0 0 0 0 1 a x k y k v c x k v c y k x k δ t 0 0 δ t 0 0 0 0 b v w x k v w y k u k w x k w y k w c x k w c y k w k in which a and b are the system transition matrix and the control matrix respectively and w k denotes the system uncertainty which is modeled as gaussian white noise process assuming that the two groups of uncertainties in w k are mutually independent the covariance matrix q k r 4 4 for w k can be characterized by two parameters σ c for the ocean current uncertainty and σ w for the vehicle in water speed uncertainty several studies describe the specific expression of q k zhu and hu 2018 zhu et al 2016a b by taking the slant range as measurement variable the measurement equation of single beacon navigation system can be written as 2 r k x k x b 2 y k y b 2 z k z b 2 ν r in which r k is the measured slant range ν r is the range measurement uncertainty which is modeled as a gaussian white noise process x k y k z k and x b y b z b are the coordinates of vehicle and beacon respectively in this paper the vehicle depth z k is assumed as a known quantity obtained from a depth sensor 3 vb based adaptive single beacon navigation method in this section vb method is used to estimate unknown esv and esv uncertainty parameters the measurement model is reformulated in section 3 1 and consequently the optimal filtering of the problem under consideration is described subsection in 3 2 the prediction and correction steps of vb based adaptive single beacon underwater navigation method are described in sections 3 3 and 3 4 respectively the proposed method is summarized in section 3 5 finally the influence of tuning parameters on system performance is analyzed in section 3 6 3 1 modified measurement model to estimate the esv online the unknown esv needs to be explicitly described in the measurement model denote t k t as the acoustic transit time at epoch k which is calculated by t k t t k a t k e in which t k a is the measured time of arrival toa and t k e is the known time of emission toe the acoustic transit time is treated as the measurement variable and eq 2 is reformulated as 3 m k t k t x k x b 2 y k y b 2 z k z b 2 v e k ν t where v e k is the esv at k th epoch and ν t is the measurement uncertainty associated with the acoustic transit time t t ν t is also modeled as a zero mean white gaussian process with the variance r k σ t m 2 instead of augmenting esv into the state vector zhu and hu 2018 zhu et al 2016a b this paper separately deals with the esv variation in underwater environment leads to the dramatic change of esv uncertainty which makes it difficult to accurately obtain the statistical characteristics of esv uncertainty to solve this problem esv uncertainty is modeled as a white gaussian process with unknown mean and variance thus the propagation model of esv is 4 v e k v e k 1 ω e k 1 in which ω e k 1 is a white gaussian process with unknown mean and variance denote μ k 1 and σ e k 1 2 as the mean and variance of esv uncertainty respectively from eq 3 the measurement model can be written as 5 m k h k x k v e k ν t in which h k x k v e k x k x b 2 y k y b 2 z k z b 2 v e k 3 2 problem formulation we assume that the statistical parameters of esv uncertainty μ k 1 and σ e k 1 2 are random variables with joint prior p μ k 1 σ e k 1 2 furthermore by assuming that the dynamic models of the state variables and esv are independent we get 6 p x k v e k μ k 1 σ e k 1 2 x k 1 v e k 1 p x k x k 1 p v e k v e k 1 μ k 1 σ e k 1 2 p μ k 1 σ e k 1 2 in the bayesian optimal filter the a posterior probability density function pdf p x k v e k μ k 1 σ e k 1 2 m 1 k needs to be computed in which m 1 k represents the measurement from the first to the k th epoch the a posterior pdf is commonly computed by the recursive procedure consisting of following steps sarkka and nummenmaa 2009 initialization the recursion starts from the initial pdf p x 1 v e 1 μ 0 σ e 0 2 prediction the a prior pdf of state variables esv and esv uncertainty statistical parameters is given by the chapman kolmogorov equation 7 p x k v e k μ k 1 σ e k 1 m k 1 p x k x k 1 p v e k v e k 1 μ k 1 σ e k 1 p μ k 1 σ e k 1 2 p x k 1 v e k 1 μ k 2 σ e k 2 2 m k 1 d x k 1 d v e k 1 d μ k 2 d σ e k 2 2 correction once the acoustic signal is received by auv the transit measurement m k can be calculated and consequently the correction procedure can be completed to get the a posterior pdf by the bayes rule 8 p x k v e k μ k 1 σ e k 1 2 m k p x k v e k μ k 1 σ e k 1 2 m k 1 p m k x k v e k μ k 1 σ e k 1 2 the procedures in eqs 7 8 commonly have no closed form solution since the integrations are not analytically tractable in the following part vb approximation will be applied to solve this problem and the corresponding approximate a posterior pdf will be obtained 3 3 prediction step due to the linearity of eq 1 if the a posterior pdf of x at k 1 th epoch is gaussian the a prior pdf of x at k th is gaussian 9 p x k m 1 k 1 n x k x ˆ k k 1 p k k 1 where n x μ σ denotes a gaussian pdf with mean vector μ and covariance matrix σ in this paper variables with subscript k k 1 and k k mean the a prior parameter and the a posterior parameter at k th epoch respectively x ˆ k k 1 and p k k 1 are the a prior state estimate and the a prior covariance matrix at k th epoch respectively from the prediction procedure of the kalman filter x ˆ k k 1 and p k k 1 can be calculated by 10 x ˆ k k 1 a k 1 x ˆ k 1 k 1 b k 1 u k 1 11 p k k 1 a k 1 p k 1 k 1 a k 1 t q k 1 in which x ˆ k 1 k 1 and p k 1 k 1 are the a posterior state estimate and the a posterior covariance matrix at k 1 th epoch respectively from eq 4 we get 12 p v e k v e k 1 μ k 1 σ e k 1 n v e k v e k 1 μ k 1 σ e k 1 2 the a prior pdf of v e at k th epoch is also gaussian if the a posterior pdf of v e at k 1 th epoch is gaussian 13 p v e k m 1 k 1 μ k 1 σ e k 1 n v e k v ˆ e k k 1 p e k k 1 in which v ˆ e k k 1 and p e k k 1 are the a prior estimation of esv and the a prior variance of esv at k th epoch respectively from the prediction procedure of the kalman filter v ˆ e k k 1 and p e k k 1 can be calculated as 14 v ˆ e k k 1 v ˆ e k 1 k 1 μ k 1 15 p e k k 1 p e k 1 k 1 σ e k 1 2 in which v ˆ e k 1 k 1 and p e k 1 k 1 are the a posterior estimation of esv and the a posterior variance of esv at k 1 th epoch respectively unknown σ e k 1 2 and μ k 1 require to be estimated in the process of estimating esv however direct estimation of σ e k 1 2 will induce an intractable integration without closed form analytical solution thus this paper will estimate p e k k 1 and the influence of inaccurate σ e k 1 2 can be compensated by the adaptive estimation of p e k k 1 denote the prediction equation of esv as 16 v ˆ e k k 1 v ˆ e k 1 k 1 μ k 1 17 p e k k 1 p e k 1 k 1 σ e k 1 2 in which μ k 1 and σ e k 1 2 are the nominal value of μ k 1 and σ e k 1 2 respectively v ˆ e k k 1 and p e k k 1 are the nominal a prior pdf statistic parameters of v e k denoting the a prior pdf of μ k 1 and p e k k 1 as their conjugate prior distribution the gaussian inverse gamma gig distribution is as follows 18 p μ k 1 p e k k 1 m 1 k 1 gig μ k 1 p e k k 1 τ ˆ k k 1 α ˆ k k 1 λ ˆ k k 1 ν ˆ k k 1 in which gig a a τ α λ ν is a gig distribution parameterized by τ α λ and ν gig distribution can be decoupled as 19 gig a a τ α λ ν n a τ β ig a λ ν in which β α a and ig a λ ν is an inverse gamma distribution from eqs 18 and 19 the conjugate prior distribution of μ k and p e k k 1 can be written as following hierarchical gaussian forms 20 p μ k 1 p e k k 1 m 1 k 1 n μ k 1 τ ˆ k k 1 β ˆ k k 1 21 p p e k k 1 m 1 k 1 ig p e k k 1 λ ˆ k k 1 ν ˆ k k 1 in which β ˆ k k 1 α ˆ k k 1 p e k k 1 if a ig a λ ν then e a 1 λ ν sarkka and nummenmaa 2009 in which e represents expectation operator to capture the a priori information of p e k k 1 and μ k 1 the expectation of p e k k 1 1 and μ k 1 should satisfy 22 e p e k k 1 1 1 p e k k 1 23 e μ k 1 μ k 1 combining eqs 20 23 yields 24 p e k k 1 ν ˆ k k 1 λ ˆ k k 1 25 μ k 1 τ ˆ k k 1 from eqs 24 and 25 the prediction equations for the statical parameters of μ k 1 and p e k k 1 can be designed as following heuristic form 26 τ ˆ k k 1 μ k 1 27 α ˆ k k 1 ρ α 28 λ ˆ k k 1 ρ λ 29 ν ˆ k k 1 ρ λ p e k k 1 where ρ α and ρ λ are the tuning parameters 3 4 correction step since the measurement model h k x k v e k is nonlinear conduct the linearization of h k x k v e k at the nominal point x ˇ k v ˇ e k and neglect higher order terms 30 h k x k v e k h k x ˇ k v ˇ e k h x k x k x ˇ k h v e k v e k v ˇ e k where 31 h x k h k x k v e k x k x k x ˇ k v e k v ˇ e k 32 h v e k h k x k v e k v e k x k x ˇ k v e k v ˇ e k are the jacobians of the measurement model at the nominal point using the linearized model eq 30 the likelihood pdf can be approximated by a gaussian distribution 33 p m k x k v e k n m k h ˇ k x k v e k r k in which h ˇ k x k v e k h k x ˇ k v ˇ e k h x k x k x ˇ k h v e k v e k v ˇ e k from eqs 9 13 and 33 the a posterior pdf of state and esv are both gaussian which can be respectively denoted as 34 p x k m 1 k n x k x ˆ k k p k k 35 p v e k m 1 k μ k 1 p e k k 1 n v e k v ˆ e k k p e k k since the a prior pdf of μ k 1 and p e k k 1 is chosen as their conjugate prior distribution the a posterior of these two variables is also gig distribution 36 p μ k 1 p e k k 1 m 1 k gig μ k 1 p e k k 1 τ ˆ k k α ˆ k k λ ˆ k k ν ˆ k k similarly eq 36 can be written as following hierarchical gaussian forms 37 p p e k k 1 m 1 k ig p e k k 1 λ ˆ k k ν ˆ k k 38 p μ k 1 p e k k 1 m 1 k n μ k 1 τ ˆ k k β ˆ k k in which β ˆ k k α ˆ k k p e k k 1 x k v e k μ k 1 and p e k k 1 are the unknown variables requiring joint estimation the joint a posterior pdf p x k v e k μ k 1 p e k k 1 m 1 k does not have analytical solution vb approach is utilized in this paper to get a free form factored approximation solution of p x k v e k μ k 1 p e k k 1 m 1 k 39 p x k v e k μ k 1 p e k k 1 m 1 k q x k q v e k q μ k 1 q p e k k 1 in which q x k q v e k q μ k 1 and q p e k k 1 are the approximation factor of joint a posterior pdf and satisfy 40 q x k q v e k q μ k 1 q p e k k 1 arg min kld q x k q v e k q μ k 1 q p e k k 1 p x k v e k μ k 1 p e k k 1 m 1 k where kld q x p x denotes the kullback leibler divergence kld between q x and p x kld is the degree of inconsistency between two pdfs and is defined as kld q x p x q x log q x p x d x from tzikas et al 2008 and huang et al 2018 the optimal solution for eq 40 satisfies 41 log q θ e x k v e k μ k 1 p e k k 1 θ log p x k v e k μ k 1 p e k k 1 m 1 k c θ in which θ is the arbitrary element of x k v e k μ k 1 and p e k k 1 superscript θ is the set of all elements except θ and c θ denotes a constant value with respect to variable θ from eqs 9 13 20 21 and 33 the logarithmic form of joint pdf p x k v e k μ k 1 p e k k 1 m 1 k can be written as 42 log p x k v e k μ k 1 p e k k 1 m 1 k m k h ˇ k x k v e k 2 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 v e k v ˆ e k 1 k 1 μ k 1 2 2 p e k k 1 μ k 1 τ ˆ k k 1 2 2 α ˆ k k 1 p e k k 1 λ ˆ k k 1 2 log p e k k 1 ν ˆ k k 1 p e k k 1 c x k v e k μ k 1 p e k k 1 since x k v e k μ k 1 and p e k k 1 are coupled the calculation of q θ is not analytically tractable fixed point iteration is used here denote the superscript i as the i th iteration take x ˆ k k i v ˆ e k k i as the linearized point and denote corresponding jacobians as h x k i and h v e k i respectively let θ x k substituting eq 42 into eq 41 yields 43 log q i 1 x k δ x m k i h x k i x k 2 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 c x k where δ x m k i m k h k x ˆ k k i v ˆ e k k i h x k i x ˆ k k i the proof of eq 43 is given in appendix a combining eqs 43 and 34 yields 44 log q i 1 x k x k x ˆ k k i 1 t p k k i 1 1 x k x ˆ k k i 1 2 c x k in which 45 k k i 1 p k k 1 h x k i t h x k i p k k 1 h x k i t r k 1 46 x ˆ k k i 1 x ˆ k k 1 k k i 1 δ x m k i h x k i x ˆ k k 1 47 p k k i 1 p k k 1 k k i 1 h x k i p k k 1 let θ p e k k 1 combining eqs 41 and 42 yields 48 log q i 1 p e k k 1 λ ˆ k k 1 2 log p e k k 1 ν ˆ k k 1 a ˆ k i b ˆ k i p e k k 1 c p e k k 1 in which 49 a ˆ k i 1 2 p e k k i v ˆ e k k i v ˆ e k 1 k 1 τ ˆ k k i 2 β ˆ k k i 50 b ˆ k i 1 2 β ˆ k k i τ ˆ k k i τ ˆ k k 1 2 α ˆ k k 1 the proof of eq 48 is given in appendix b combining eqs 37 and 48 yields 51 log q i 1 p e k k 1 λ ˆ k k i 1 1 log p e k k 1 ν ˆ k k i 1 p e k k 1 c p e k k 1 in which 52 λ ˆ k k i 1 λ ˆ k k 1 1 53 ν ˆ k k i 1 ν ˆ k k 1 a ˆ k i b ˆ k i choose the a prior variance of esv as 54 p e k k 1 i 1 1 e i 1 p e k k 1 1 ν ˆ k k i 1 λ ˆ k k i 1 let θ μ k and substitute eq 42 into eq 41 55 log q i 1 μ k 1 μ k 1 τ ˆ k k 1 α ˆ k k 1 v ˆ e k k i v ˆ e k 1 k 1 α ˆ k k 1 1 2 2 p e k k 1 i α ˆ k k 1 α ˆ k k 1 1 c μ k 1 the proof of eq 55 is given in appendix c combining eqs 38 and 55 yields 56 log q i 1 μ k 1 μ k 1 τ ˆ k k i 1 2 2 β ˆ k k i 1 c μ k 1 in which 57 τ ˆ k k i 1 τ ˆ k k 1 α ˆ k k 1 v ˆ e k k i v ˆ e k 1 k 1 α ˆ k k 1 1 58 β ˆ k k i 1 α ˆ k k 1 α ˆ k k 1 1 p e k k 1 i the estimated mean of esv uncertainty is calculated by 59 μ k 1 i 1 e i 1 μ k 1 τ ˆ k k i 1 denote 60 v ˆ e k k 1 i 1 v ˆ e k 1 k 1 μ k 1 i 1 take x ˆ k k i 1 v ˆ e k k 1 i 1 as the linearized point and denote corresponding jacobians as h x k i 1 and h v e k i 1 respectively let θ v e k substituting eq 42 into eq 41 yields 61 log q i 1 v e k δ v e m k i 1 h v e k i 1 v e k 2 2 r k v e k v ˆ e k k 1 i 1 2 2 p e k k 1 i 1 c v e k in which 62 δ v e m k i 1 m k h k x ˆ k k i 1 v ˆ e k k 1 i 1 h v e k i 1 v ˆ e k k 1 i 1 the proof of eq 61 is given in appendix d combining eqs 61 and 35 yields 63 log q i 1 v e k 1 2 v e k v ˆ e k k i 1 2 p e k k i 1 c v e k in which 64 k e k i 1 p e k k 1 i 1 h v e k i 1 h v e k i 1 2 p e k k 1 i 1 r k 1 65 v ˆ e k k i 1 v ˆ e k k 1 i 1 k e k i 1 δ v e m k i 1 h v e k i 1 v ˆ e k k 1 i 1 66 p e k k i 1 p e k k 1 i 1 k e k i 1 h v e k i 1 p e k k 1 i 1 3 5 algorithm combining the prediction and correction steps the vb based adaptive single beacon underwater navigation method at k th epoch is listed in algorithm 1 in particular we judge iterative convergence by detecting the change of esv which means that x k v e k μ k 1 and p e k k 1 are iteratively updated in the correction step they update repeatedly until the change of v e k i between two consecutive iterations is less than a threshold value ε in addition we use indirect ocean current measurement to correct the ocean current the corresponding standard deviation of measurement noise is denoted as σ c m specific correction steps can refer to zhu and hu 2018 zhu et al 2016a b and are omitted for simplicity theorem 1 if ρ α and r k in eq 64 is set as 0 line 8 line 13 in the algorithm 1 can be replaced by v ˆ e k k i 1 v ˆ e k k i 2 v ˆ e k k i m k r i 1 in which r i 1 x ˆ k k i 1 x b 2 y ˆ k k i 1 y b 2 z k z b 2 proof if r k 0 eq 64 can be simplified as 67 k e k i 1 1 h v e k i 1 v ˆ e k k 1 i 1 2 r i 1 in which 68 r i 1 x ˆ k k i 1 x b 2 y ˆ k k i 1 y b 2 z k z b 2 h k x ˆ k k i 1 v ˆ e k k 1 i 1 v ˆ e k k 1 i 1 substituting eqs 62 67 and 68 into eq 65 yields 69 v ˆ e k k i 1 v ˆ e k k 1 i 1 v ˆ e k k 1 i 1 2 r i 1 m k h k x ˆ k k i 1 v ˆ e k k 1 i 1 v ˆ e k k 1 i 1 2 v ˆ e k k 1 i 1 m k r i 1 combining eqs 26 27 57 59 and 60 one gets 70 v ˆ e k k 1 i 1 v ˆ e k 1 k 1 μ k 1 ρ α v ˆ e k k i v ˆ e k 1 k 1 ρ α 1 from eq 70 one gets 71 lim ρ α v ˆ e k k 1 i 1 v ˆ e k k i combine eqs 69 and 71 to prove theorem 1 remark 1 from theorem 1 if ρ α and r k in eq 64 is set as 0 the proposed vb based method is equivalent to the em based single beacon navigation method proposed in qin et al 2019c thus the navigation method in qin et al 2019c is a special case of the proposed method which indicates that the proposed method is more generalized 3 6 parameter selection to implement the proposed algorithm the tuning parameters ρ α and ρ λ and the nominal esv uncertainty parameters μ k and σ e k need to be selected 3 6 1 selection of ρ λ combining eqs 17 28 29 52 53 and 54 we get the recursive form of p e k k 1 i 1 as 72 p e k k 1 i 1 ρ λ p e k 1 k 1 σ e k 1 2 a ˆ k i b ˆ k i ρ λ 1 from eq 72 the modified a priori variance of esv p e k k 1 i 1 is the weighted sum of priori information p e k 1 k 1 σ e k 1 2 and the innovation a ˆ k i b ˆ k i with weights ρ λ and 1 respectively the nominal parameter σ e k 1 dominates the accuracy of the nominal a priori variance of esv uncertainty and the parameter ρ λ dominates the confidence level of σ e k 1 3 6 2 selection of ρ α from eqs 26 27 57 and 59 we get 73 μ k 1 i 1 μ k 1 ρ α v ˆ e k k i v ˆ e k 1 k 1 ρ α 1 eq 73 indicates that μ k 1 i 1 equals to the weighted average between μ k 1 and v ˆ e k k i v ˆ e k 1 k 1 similar with section 3 6 1 the nominal mean μ k 1 dominates the accuracy of the nominal a priori mean of esv uncertainty and the parameter ρ α dominates the confidence level of μ k 1 3 6 3 selection of μ k 1 and σ e k 1 since vb approach only guarantees the local convergence of variational iterations accurate priori information is necessary therefore the nominal parameters μ k 1 and σ e k 1 are required to be close to the true values μ k 1 and σ e k 1 respectively 4 numerical studies the field data collected from surface boat is utilized to evaluate the performance of proposed vb based navigation method referred to as the pm against that of the existing state augmented method zhu and hu 2018 zhu et al 2016a b and em based navigation method qin et al 2019c referred to as the sam and emm respectively several studies describe the methods of collecting field data zhu and hu 2018 zhu et al 2016a b the boat is equipped with hydrophone which can receive the acoustic signal transmitted by the beacon mounted at the sea floor with a surveyed location of 123 745 m underwater the boat cruises at a speed of about 3 m s and the ground truth trajectory is provided by gps when implementing sam emm and pm the following initial settings are selected 1 10 m in both the x and y directions for the initial position offset 2 0 5 m s in both the x and y directions for the initial ocean current offset 3 1500 m s for the nominal v e the tuning parameters of these three methods are 1 σ c 0 01 m s 2 σ w 0 1 m s 3 σ t m 0 001 s 4 σ c m 0 01 m s 5 σ e k 1 m s 6 μ k 0 m s 7 ρ α 9 8 ρ λ 1 and 9 the threshold value ε is chosen as 0 0001 m s the averaged root mean square arms of horizontal distance error arms δ h 1 t k 1 t x k x ˆ k 2 y k y ˆ k 2 and the arms of estimated esv error arms δ v e 1 k k 1 k v e k v ˆ e k 2 are utilized as the evaluation indexes t and k are the total number of fixed sampling intervals and the transit time measurements respectively the comparison of the estimated trajectories among sam emm and pm is shown in fig 1 similarly fig 2 is the corresponding comparison of the horizontal distance error δ h δ x 2 δ y 2 for all three methods the arms δ h of sam emm and pm are 7 56 m 14 44 m and 6 18 m respectively from figs 1 and 2 along with the arms δ h we get the conclusion that pm has the highest accuracy among three navigation methods the localization performance of existing state augmented method is slightly worse than that of pm due to the inaccuracy of statistical parameter related to esv uncertainty the large positioning error of emm is caused by large initial position offset whereas pm and sam will not be affected by this factor fig 3 shows the estimated esv by sam emm and pm the arms δ v e of three methods are 7 13 m s 23 38 m s and 5 41 m s respectively this demonstrates that both sam and pm can follow the variation trend of esv and the estimation outcome of pm is slightly better than that of sam due to the adaptiveness of pm to esv uncertainty parameters again the initial position offset deteriorates the esv estimation performance of emm to better illustrate the adaptiveness of pm we analyze the arms δ h and arms δ v e under different σ e in this part of simulation ρ λ is set as 0 which indicates that we have no confidence in σ e as shown in section 3 6 1 the numerical comparison between sam and pm is shown in fig 4 fig 4 shows that sam is sensitive to σ e whereas pm exhibits good navigation performance under different σ e which indicates the adaptiveness of pm finally we study the iteration times during each correction step fig 5 demonstrates that all the acoustic transit time corrections can converge to a steady state within 50 iterations except for the first correction epoch the measurement interval of transit time is commonly long enough to process the iterations in real application 30 s in this group of field data 5 concluding remarks the esv setting error will deteriorate the performance of single beacon navigation system the existing state of the art single beacon navigation methods include the state augmented method and the em based method the former is sensitive to the noise statistic parameter related to the esv uncertainty that is difficult to tune whereas the latter is sensitive to vehicle initial position offset to overcome the deficiencies of existing state of the art single beacon navigation methods this paper proposed a vb approximation based adaptive single beacon navigation method which treats the esv as a random variable with unknown statistic parameters and estimates the state vector esv and esv uncertainty parameters by vb approximation numerical studies using field data indicate that the proposed method has better navigation performance than the existing state augmented method and em based method both in localization error and esv estimation error comparing with state augmented method the adaptiveness of the proposed method to inaccurate statistic parameters is improved and comparing with em based navigation method the proposed method is more robust to the initial position offset credit authorship contribution statement hong de qin conceptualization funding acquisition project administration xiang yu conceptualization methodology validation writing original draft zhong ben zhu resources supervision writing review editing zhong chao deng investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was funded by the national natural science foundation of china under grant 51939003 and 51879062 appendix a derivation of eq 43 let θ x k substituting eq 42 into eq 41 we get 74 log q i 1 x k 1 2 e i m k h k x ˆ k k i v ˆ e k k i h x k i x k x ˆ k k i h v e k i v e k v ˆ e k k i 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 c x k 1 2 e i m k h k x ˆ k k i v ˆ e k k i h x k i x ˆ k k i h v e k i v e k v ˆ e k k i h x k i x k 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 c x k 1 2 δ x m k i h x k i x k 2 r k x k x ˆ k k 1 t p k k 1 1 x k x ˆ k k 1 2 c x k thus eq 43 is got appendix b derivation of eq 48 let θ p e k k 1 substituting eq 42 into eq 41 yields 75 log q i 1 p e k k 1 λ ˆ k k 1 2 log p e k k 1 ν ˆ k k 1 p e k k 1 1 2 e i v e k v ˆ e k 1 k 1 μ k 1 2 μ k 1 τ ˆ k k 1 2 α ˆ k k 1 p e k k 1 c p e k k 1 the expectation can be calculated as 76 e i v e k v ˆ e k 1 k 1 μ k 1 2 e i v e k v ˆ e k k i v ˆ e k k i v ˆ e k 1 k 1 τ ˆ k k i τ ˆ k k i μ k 1 2 p e k k i v ˆ e k k i v ˆ e k 1 k 1 τ ˆ k k i 2 β ˆ k k i and 77 e i μ k 1 τ ˆ k k 1 2 e i μ k 1 τ ˆ k k i τ ˆ k k i τ ˆ k k 1 2 β ˆ k k i τ ˆ k k i τ ˆ k k 1 2 substituting eqs 76 and 77 into eq 75 yields eq 48 appendix c derivation of eq 55 let θ μ k 1 substituting eq 42 into eq 41 yields 78 log q i 1 μ k 1 1 2 e i v e k v ˆ e k 1 k 1 μ k 1 2 p e k k 1 1 2 μ k 1 τ ˆ k k 1 2 α ˆ k k 1 e i 1 p e k k 1 c μ k 1 1 2 p e k k 1 i μ k 1 2 2 μ k 1 e i v e k v ˆ e k 1 k 1 1 2 μ k 1 τ ˆ k k 1 2 α ˆ k k 1 p e k k 1 i c μ k 1 from e i v e k v ˆ e k 1 k 1 v e k i v ˆ e k 1 k 1 we get 79 log q i 1 μ k 1 1 2 p e k k 1 i μ k 1 v ˆ e k k i v ˆ e k 1 k 1 2 μ k 1 τ ˆ k k 1 2 α ˆ k k 1 c μ k 1 1 2 p e k k 1 i μ k 1 τ ˆ k k 1 α ˆ k k 1 v ˆ e k k i v ˆ e k 1 k 1 α ˆ k k 1 1 2 α ˆ k k 1 α ˆ k k 1 1 c μ k 1 thus eq 55 is got appendix d derivation of eq 61 the following lemma is needed to infer eq 61 lemma 1 suppose the joint pdf of random variables μ and p is a gig distribution i e p μ p g i g μ p τ α λ ν then 80 e μ p e μ e 1 p proof 81 e μ p 0 μ p n μ τ α p ig p λ ν d μ d p 2 π α 1 2 1 γ λ ν λ 0 μ p exp 1 2 α p μ τ 2 p λ 1 p 1 2 exp ν p d μ d p e μ 1 γ λ ν λ 0 p 1 p λ 1 exp ν p d p e μ e 1 p let θ v e k substituting eq 42 into eq 41 we get the equation given in box i from eq 60 we get e i 1 v ˆ e k 1 k 1 μ k 1 v ˆ e k k 1 i 1 then 83 log q i 1 v e k δ v e m k i 1 h v e k i 1 v e k 2 2 r k 1 2 p e k k 1 i 1 v e k 2 2 v e k v ˆ e k k 1 i 1 c v e k δ v e m k i 1 h v e k i 1 v e k 2 2 r k 1 2 p e k k 1 i 1 v e k v ˆ e k k 1 i 1 2 c v e k thus eq 61 is got 
21787,this paper presents an attempts towards creation of generalized models of ships manoeuvring area determination and ship performance created on the base of real simulation results those models are needed for better understanding of the safe navigation process in ports areas and its approaches and for risk analysis when no full information about the ships behaviour is available the data coming from real time ship simulations that are conducted by experienced pilots and captains are applied in the study in the first step general regression models are created to determine manoeuvring areas and major correlations between basic parameters affecting the safe area needed for ships to navigate in restricted areas of ports and its approaches in the second step the ship performance models are created to describe the behaviour of the ship including human factors the ship performance for long term prediction of the navigation risk regarding the possibility of ships exceeding the channel limits assumed as grounding or collision with a fixed structure are created by the method which consists of two developed models 1 an armax auto regressive and moving average exogenous model is adopted to identify the ship steering dynamic system with the help of this model the outputs of the system course position etc can be estimated based on the system input conditions rudder engine etc 2 the stochastic sequences of the inputs for the first model used are generated using a semi markov model in the paper the implementation of the semi markov model for rudder actions has been described the study used input output measurements from a ship handling simulator to estimate the model parameters so the human factor has been included in the models the method allows us to extend the results obtained from the simulator to predict future conditions of the system outputs since the predicted results and using probabilistic approach possible ship manoeuvring area margins will be identified and long term assessment of the navigation risk can be realized keywords real time ship manoeuvring simulation ship manoeuvring area risk assessment generalization of ship simulation data 1 introduction maritime simulation is a reliable and indispensable tool in the assessment of navigational safety of a ship in conjunction with harbours and fairways the main application focuses essentially on channel design to indicate the ship manoeuvrability and possible accident occurrence in relation to the human behaviour and environmental conditions this approach usually consists of a two step process application of a ship handling simulator for generating the data of ship motions and assessment of waterway dimensions and navigation risk based on this data there are two approaches for long term assessment of navigating risk on the waterway one is the application of ship handling simulation and the other is assessing the risk based on historical and available data of ship tracks the first approach is focusing more on the accidental risk for transit concerning possible grounding on the shore or collision with the bank while the second is more applicable to the risk assessment of the ship traffic in busy waterway areas the bayesian network has often been found in the modelling of ship traffic and risk assessment of ship collision martins and maturana 2013 akhtar and utne 2014 further improvement of the bayesian network mode by integrating with technique for retrospective and predictive analysis of cognitive errors tracer studied by sotiralis et al 2016 more recently it is of great interesting to utilize ais data with simulation technique for verification and calibration of the risk assessment modes mou j m et al 2010 fangliang et al 2012 p chen et al 2017 rolf j b and asbjørn gilberg 2018 somewhat differs from the above is a more advanced model developed by shahrzad et al 2014 using a markov modelling approach and markov chain monte carlo mcmc the limitation of the existing literature in this approach group is that historical data of ship tracks and accidents is not always available and furthermore impossible to apply to newly developed waterways applying ship handling simulator to the risk assessment of the waterway is a merit tool belonging the first approach real time ship handling simulations should be executed for a wide range of environmental conditions grouped into scenarios and several repetitions for each condition in real time scale so the time required would be comparable to the lifetime of the waterway these requirements are expensive and seem impossible due to time consumption webster 1992 from this arises the question of how to estimate the probability of ship accident during the lifetime of the channel project the so called overall risk the real time simulations are based only on a limited number of conditions and trials in each condition so the risk calculated from the simulated data does not equal to the overall risk generalization of the real time simulation results of ship tracks for long term period research turns out to address the disadvantage of the ship handling simulator method finding ways of extending the real time simulation experimental results and applying to lifetime channel risk analysis is still challenging to researchers to make fast time simulation results closer with those obtained from real time simulation is a promising approach early works developed a ship navigator cognitive model to be constructed for simple course tracking task based on a cognitive task analysis of experimental navigation sessions using a maritime simulator itoh k et al 2001 willem a et al 2005 however this model was programmed to control a ship only in a so called simple single ship situation in recent years some authors developed a fast time simulation based models using either fuzzy logic controller guoqing xia et al 2016 sheng long kao et al 2017 or neural network controller weilin luo et al 2016 nam kyun im et al 2017 however significant efforts should be made to consider more complex navigation tasks multi ship situation to extend the model to more realistic ship navigation as met in the real world it have to be mentioned that many authors have undertaken researches focused on data generalization in the aspect of ship collisions which is more difficult because it requires taking into account the behaviour of two objects and collision geometry consideration an overview of currently used methods can be found in chen et al 2019 weng et al 2020 attempted to study the complex relationship among the traffic characteristics environmental conditions and ship collision frequency using ais data gil et al 2019 investigated feature based on an analysis of a process of merchant vessels collision avoidance nguyen et al 2018 examined the main elements of ship collision by mathematical model for the risk assessment and simulated a collision assessment based on ais information despite the fact that the paper consist of some previously performed research by the authors on the generalization of data from ship traffic manoeuvring simulations it contains a number of new unpublished yet researches these are mainly new analyses concerning parameters of safe manoeuvring areas required by ships including analyses based on linear multi criteria regression the new models of mean and standard deviation of ships manoeuvring area are presented together with the discussion of their applicability these models are utilitarian and provide data for potential risk analyses in addition the paper introduces new analyses of the quality of ship s manoeuvring including rudder movement and course analyses 1 1 ship handling simulators in waterway design many ship simulators exist worldwide for different applications with various levels of capacities essentially a ship handling simulator is a computer generated system that simulates the actual operation parameters of the ship in various manoeuvring conditions in real time and displays the scenery from the navigation bridge visually and audibly on the screen simulators comprise wide range facilities and man machine interfaces as depicted schematically in fig 1 an advanced ship simulator includes models of a ship the simulated navigation channel the environmental impacts the visual scene the radar image tugs and thrusters the ship bridge control and typical bridge instruments the core of the ship dynamic model is the set of hydrodynamic equations of ship motion referred to a coordinate system commonly fixed in the ship the equations should be complete and realistic with ship hull dynamics engine thrust bank and shallow water effects currents wind and wave impacts and tug supporting forces the most important data and results derived from simulator experiments for the use of waterway design are track plot a two dimensional plot which includes the proposed channel contour and the ship position at predetermined time intervals time series tables of different variables track distance rudder angles ship speed turning rate engine revolutions etc throughout the simulation swept path graphs and the channel border are presented in a two dimension plot reviews on the state of the practice application of this technique to navigation risk assessment and waterway design have been well documented in the two guidelines usace 2006 1 2 the typical setup of full mission bridge simulator the example of the full mission simulation is the kongsberg polaris navigational mock up bridge located in maritime university of szczecin fig 2 where large part of this study was conducted the facility consists of one navigational bridge with the visualization of 270 angle and equipped with identical with real control and steering devices dnv class a two part task simulators of 120 visualisations partly equipped with control devices with real like voith schneider tug console dnv class b two simulators of the type pc type with the visualization of the projection type and with simulated navigational devices all equipment of simulator is standardized according to requirements of stcw 95 training section a i 12 section b i 12 table a ii 1 table a ii 2 and table a ii 3 and is certified by dnv the creation of new hydrodynamic models is possible and is based on the dedicated computer tool there is also possibility of the creation of very exact ship models working in six degrees of freedom and the possibility of the modelling of ships with two engines and propellers of both fixed or controllable pitch azimuth drives and the different type of steering devices 1 3 ship movement on the waterways as source of statistical data the understanding of the type of information that simulation attempts to provide is fundamental to evaluate how simulation can contribute to the process of ships movement real time simulations are conducted by human pilots to navigate the simulated ship through the modelled waterway in real time scale interpretation of the simulated ship tracks provides insight into the various navigation factors characteristics and dimensions of the waterway and safety aspects grounding or collision risks typically the analysis of the real time runs aims at finding the ship response parameters including human factors based on distribution of ship track distances centre of gravity and extreme starboard and port points of ships in respect to centre of the waterway distribution of ships courses and distribution of ships speed horizontal vertical and angular one of the most important measures for the risk assessment associated to waterway width design is the probability of ship accidents in each of the waterway sections the probability of a ship exceeding from starboard i th section waterway p ex can be determined as follows 1 p e x p w p i p x d p e n v i d p f x d x where d p is half of the waterway width f x is the density function of the ship positions for a given environmental scenario env shown separately for port and starboard side and for all sections in fig 3 the simulations are usually conducted in series performed in different meteorological conditions each consists of several trials in principle the environmental conditions of wind waves and currents are divided into several regions or categories to facilitate the probability assessment of the navigation results these environmental categories reflecting the frequency of occurrence and severity are selected to define the different combinations of the environmental conditions that might be present when the ship is navigating the waterway the different combinations of environmental conditions are divided into various classes normally three or four known here as manoeuvring scenarios by ordering degree of affecting the ship manoeuvrability the probability of ship accident from the channel section borders during a given time p life can be determined as 2 p l i f e n s h i p i 1 n e p e x p o c e n v i where n ship is the number of ships presents in the channel during a given time period n e is the number of the manoeuvring scenarios p oc env i is the occurrence frequency of the manoeuvring scenario i estimation of occurrence frequencies of the manoeuvring scenarios is also an important topic two approaches could be found in the literature which based on a linear programming technique briggs et al 2003 or classifying external forces on the ship hull quy et al 2007 fig 4 shows the distributions of ship track distance respectively with three manoeuvring scenarios that are defined applying the above principle the ship track samples can be well described by a normal gaussian distribution the figure has been created based on the data of the study case at the entrance channel of ennore port vrijling 1995 real time simulations were performed with the use of a 4 500 teu container vessel eighteen scenarios of environmental conditions which are grouped into three scenarios extreme normal and gentle conditions were carried out for each scenario several runs were executed it was found that the distribution of ship courses is strongly correlated with ship positions referred to the middle of the waterway it can be straightforwardly explained that the more the ship is away from the centre of the waterway the more the navigator changes the course to come back to the desired track gucma 2006 the 30 simulation passages by the model of tanker with parameters l 196 m and b 28 m manoeuvring on the bend of the waterway was applied in this study fig 5 this relation between distance from the centre of waterway cross track error and course can be seen on fig 6 to include this phenomenon for the later analysis of the navigation risk it was proposed to use a linear regression model the distance from the middle of the waterway could therefore be calculated by the distribution of courses using this regression model the results presented in fig 6 are valid for single waterway section as shown on fig 5 and to consider waterway as a whole more advanced models such as the one presented in part 3 of this paper are needed it should be noted that eqs 1 and 2 can only give the probable results of ship position in given section of the waterway they are no indications for the waterway as whole two approaches of integrated risk for entire channel have been presented in the literature burgers and kok 1989 quy et al 2007 1 4 generalized models of ship movement and performance the existing systems due to their complexity require constructions of suitably specialized models with several parameters such as ships traffic hydrometeorological conditions parameters of the water area and other most of these parameters are random and simple analytical methods are not suitable especially when these models are supposed to include also a human factor the probability of navigator error the modelling of such systems can be carried out by means of simulation methods and particularly monte carlo based methods fig 7 presents several stages necessary for such models creation with previous generalization of various data comes from both simulations and real like ais based experiments or observations in general the present models can be divided into three following classes fig 8 1 general probabilistic models of ship manoeuvring area parameters 2 causation models 3 ship performance models the first and last were presented in this study in point 2 and 3 respectively the second kind of the models try to find the relation between ships consecutive positions of ship manoeuvring on the waterway some of them are presented in semerdjiev and mihaylova 2000 gucma 2007 the previously mentioned mcmc or hidden markov chains or other based on stochastic processes finding the dependence between consecutive ships position could be applied there such a model was presented by gucma 2007 it differs from the above in several ways it assumes that the next ship position can be generated from the past consecutive position using two types of probability distributions the first type describes the probability distribution of maximum and minimum points of ship track on starboard and port sides respectively the second is the conditional distributions between the ship course and the generated track distance the probabilistic model parameters were also obtained from statistical analysis results of the real time simulations 2 generalized models for determination of ship manoeuvring area authors carried out some researches concerned with generalization of ship data possessed in simulation experiments they were led in two directions to find the shape of distributions describing the position of the ship on waterways to estimate parameters of those distributions and model dependences between most important variables gucma 2012 it was proven in many studies that the normal distribution is well fitted for the description of the variability of the position of ships on waterways in the horizontal plane gucma 2012 in many researches iribarren 1999 the asymmetrical distributions e g extreme values were also successfully fitted to model the movement of ships on coastal areas the mixture of normal and uniform distribution in relation 99 1 is usually used karlsson et al 1998 such a mixture is useful when traffic consists of typical merchant ships normal distribution and pleasure crafts uniform distribution 2 1 models based on linear regression to find the general models of ships manoeuvring area parameters mean m and standard deviation s the database of real time ship simulation experiments was used the database includes 25 different ships manoeuvring in 121 conditions table 1 this experiment was not designed intentionally but done within the routine port design works made by simulation research team of maritime university of szczecin to find relation between the mean safe manoeuvring area denoted as m p i m z for straight part legs of waterway and bends accordingly and ships breadth b the simple linear regression model was chosen breadth of ship was chosen because it s the most significant factor influencing the width of waterway other factors like available width of manoeuvring water area length of ship ship s manoeuvrability wind or current influence are less important fig 9 demonstrates two models of linear relations of those parameters for straight and bend legs of waterway the parameters of regression for straight leg m p are as follows coefficient of determination r 2 0 76 overall regression error s e 9 5 m and f statistics f 440 similar model was built to find the relation of standard deviation of the width of available waterway area awa fig 10 shows this relation by linear regression model with use of simulations presented on table 1 the parameters of regression for straight s p were as follows coefficient of determination r 2 0 41 overall regression error s e 5 8 m and f statistics f 100 the linear model of standard deviation on straight waterway s p dependence of the available waterway s width d could be presented in the following form 3 s p 0 05 d 3 4 2 2 models based on linear multiple regression in this point the method of multiple regression was applied to determine the mean and the standard deviation of maximum ship distance from the middle of waterway the model based on multiple regression describes the relationship between the dependent variable y and n independent variables x in the form of 4 y b 0 b 1 x 1 b n x n where b i multiple regression model coefficients two types of characteristic water areas were chosen which results were taken from simulation tests straight leg of the waterway bend of the waterway as the dependable variables average width of safe waterway area the standard deviation of maximum distance from the middle of the waterway is selected average width of the safe manoeuvring area is therefore defined as 5 d m m d p m d l where m dp m dl average maximum distance of the ship points to the port and starboard from the middle of the waterway it was assumed that the middle of the waterway is symmetrically located in relations to the average mean width of safe manoeuvring area in most of simulation tests there is no specified centre and it is necessary to establish the hypothetical middle of the waterway fig 11 standard deviation of the maximum distance to the waterline to right and left from the middle of the waterway is devoted as s dl and s dp considering small differences between the standard deviations to the port and starboard side it was decided to analyse the mean of standard deviation as s d s dl s dp 2 following independent variables in the model of regression were used as the most influencing ships manoeuvring area 1 breadth of ship b m 2 available width of manoeuvring water area d m 3 length of ship l m 4 factor of ship s manoeuvrability ms dimensionless 5 cross wind intensity sw m s 6 water current factor pr dimensionless because of difficulty to define relations between variables within the model the wind direction was not taken into consideration during the research current factor is assumed as 0 for opposite and the lack of current 1 when a ship is moving downstream being consistent with its movement what is considered to be the most impeding the ship s manoeuvre to introduce different manoeuvring abilities of ships it is suggested to define manoeuvre factor as the number from 0 to 3 0 for small ships with the perfect manoeuvre ability which perform manoeuvres all on their own 1 for big ships with good manoeuvre ability equipped in bow thruster and twin propeller 2 for ships with poor manoeuvre ability and in ballast 3 for ships with very bad manoeuvrability and loaded basic problem during construction of multiple regression models is the internal correlation between independent variables in the proposed model the internal correlation is obvious and appears between ship s length and breadth ship s width and manoeuvre factor and available water area s width and ships breadth the first pair characterizes the biggest correlation however there was no decision made to remove independent variable which describes ship s length because in theory it has influence on the lane s width especially when the ship moves at a big rate of drift what occurs when moving through the bends in the model the width of available water area is the independent variable of great importance the smaller available width the manoeuvre width has to be done with higher confidence and precision and with smaller errors tolerance when the probability of collision rises it also decreases freedom of manoeuvre and only some manoeuvring methods are effective and safe the data for researches were gathered with use of simulation tests as presented in table 1 models of two dependent variables average width of the lane standard deviation of the distance in the defined level of significance can be described as 6 d m b 0 b b b b d d b l l b m s m s b s w s w b pr pr 7 s d b 0 b b b b d d b l l b m s m s b s w s w b pr pr parameters and verification of the models were described in gucma 2012 it is important to remember that application of models is often restricted by environmental conditions env prevailing during simulation tests table 2 presents the multiple regression coefficients of the models obtained by the least squares method in which all independent variables were included additionally the coefficient of determination r 2 is given which determines what percentage of dependent variable variation is explained by the model and standard error of estimation s which can be interpreted as the average deviation of the dependent variable in the sample from the theoretical value additionally the f statistics coefficient is presented some independent variables that are not bolded in table 2 weren t significate to overall model of regression which lead to need of further analysis considering the excluding variables it should be noted that the model is sensitive on regression parameters and some independent variables have unimportant influence on presented model mostly due to complexity of ships behaviour and too small sample size such model could be used for probability of a ship collision with technical structures or embankments assessment 3 ship performance model in the following part the use of armax model and semi markov process to extend real time simulation results for long term prediction of the navigation risk will be presented this study is an ongoing effort to the generalization of real time simulation used for the risk assessment of navigable limits two models have been developed the first model uses armax technique to estimate the system outputs course position etc from the inputs rudder engine etc of the ship steering dynamics the stochastic sequences of the inputs for the first model used are generated using a semi markov model one implementation of the semi markov model for rudder actions has been studied the study used input output measurements from a ship handling simulator to estimate the model parameters the human factor has therefore been included in the models the method allows the results obtained from the simulator to be extended to predict the future conditions of system outputs based on the predicted results and using probabilistic approach possible margins of ship manoeuvring area will be identified and long term assessment of the navigational risk can be implemented involving a straightforward use of the optimal design of the waterway widths satisfactory results were obtained even there were limited ship handling results available however the study is constrained to one failure mechanism which is the even of ships exceeding the waterway limits and being viewed as grounding or colliding with surrounding structures the general procedure for the study is presented in fig 12 3 1 model of ship steering dynamic a ship operating in seawater is assumed as an dynamic system with inputs u t outputs y t and white noises e t as shown in fig 13 the inputs can be rudder angle propellers and thrusters and etc the outputs are ship heading yaw sway surge roll yaw rate sway velocity surge velocity roll rate and etc there are several ways to represent the relationship between the outputs and inputs for example by means of a continuous time model classical way or differential equation a model in transfer function form a model in time or frequency domain and a discrete time model digital technique or difference equation fossen 1994 in this paper discrete time auto regressive moving average exogenous armax model was adopted the armax model applied to the above described dynamic system can be assumed as a discrete time model a multiple input and single output miso system in a transfer function form as follows ninness and wills 2005 8 y t g q u t h q e t in above u t and y t are sequences of the multiple input u t ε r m and single output y t ε r 1 system with the same length g q is 1 m rational transfer function of the system and h q is rational transfer function of the filter which are defined as 9 g i q q n k i b i q a i q h i q c q a i q where n ki is the number of delays from input to output of the ith input q is the delay operator a q b q and c q are polynomials of q 1 defined as 10 a i q 1 a 1 q 1 a 2 q 2 a n a q n a i 11 b i q b o b 1 q 1 b 2 q 2 b n b q n b i 12 c q 1 c 1 q 1 c 2 q 2 c n c q n c where n ai n bi and n c are orders of polynomials a i b i and c respectively having observed the input output data u y the most appropriate orders and the parameters of the polynomials can be determined using prediction error e t method ninness and wills 2005 which is available in the matlab identification system toolbox matlab 2005 the model described in eq 4 with known a b and c can then be applied to generate a random sequence ship course from the inputs u t the following section will present how to apply a semi markov model to describe rudder motions based on measured rudder angles achieved from the real time simulation 3 2 a semi markov model of rudder motions markov chains and semi markov models are powerful and commonly used technique for studying the reliability and characteristic of complex systems these models use a set of data observed in present to predict system behaviour in future by generating a random sequence that contains patterns of data characteristics details about this class of processes can be found in janssen and manca 2006 consider a finite set of rudder angles r r 1 r 2 r k degree and respectively numbered and represented by rudder states s 1 2 k that occur at random times during all the simulation trials and denote p i j as the transition probability that the helmsman moves the rudder randomly from state i at rudder angle r i at time t i to state j at rudder angle r j at time t j a markov chain is a discrete time stochastic process where the conditional probability of any future event depends on only the present state the transition probability p i j is expressed by this law as 13 p s t j j s t i i p i j t j t i in practice the transition probabilities p i j can be determined from the measured data as 14 p i j n i j m i m i j 1 k n i j where n i j is the number of times that the rudder is moved from state i to state j the quantity p i j is an element of square matrix called the transition probability matrix or transition matrix in which the size k x k equals to the number of the states all the transition probabilities of the markov process can be estimated based on the data recorded in the simulator trials now the markov chain can be extended to the semi markov model by considering the times that the helmsman used to move the rudder from state i to state j and retain it in each state the rudder motion records during a series of the simulator trials were obtained as shown in fig 14 the real time simulations were carried out at the piastowski canal leading from szczecin to the baltic sea fig 15 a total of 45 trials with various environmental conditions were performed at paprotno mielin bend part with the use of a 4 500 teu container vessel the rudder of the ship can be adjusted from 35 port to 35 starboard with a unit angle δr 1 it was observed that in all trials the helmsman tried to move the rudder with the same rudder rate v r the time that the helmsman spent moving the rudder from state i to state j can therefore be determined as 15 t i j t j t i r j r i v r j i δ r v r in this case the time spent on the transitions or moving rudder is a deterministic quantity the model thus has a transition time matrix analogous to transition probability matrix now the only thing left is to estimate the time called sojourn time that the helmsman maintains the rudder angle in every rudder state the sojourn times t i i are of course random and depending on many factors where the helmsman s competence ship characteristics and navigational conditions are the main factors usually a certain distribution can be found to fit the sojourn times obtained from simulator trials fig 16 shows for example distribution of the sojourn times in the state with the 5 rudder angle fitted lognormal distribution it should be clear that the sequence of rudder angles from the simulation is commonly recorded for every 1 s the sojourn time in a state therefore exactly equals to the number of times n i i that the same rudder angle values have continuously been recorded it means that the length of the sojourn times increases proportionally to the transition probabilities p i i this makes it easier to generate the sojourn times in each state 3 3 results of part 3 fig 17 presents sequences of rudder angles generated randomly from the semi markov model developed in the above section the results seem like those measured from the simulator trials in time series but some differences can be found in the shape of their probability distributions and power spectra as shown in fig 18 and fig 19 it is more interesting to observe the results in the frequency domain in both cases the power spectra of the motions shows significant peaks around zero frequency but the higher peak is obtained in the generated rudders than in the simulator however the amount of the rudder motion in the simulator is larger by comparison in the frequency range from 0 2 to 0 7 rad s and then both approximately drop to zero here remained only the problem of estimating parameters of the armax model for the measured data of rudders and courses as shown in fig 20 the resulting model has been found as follows 16 a q 1 1 878 q 1 0 1112 q 2 2 456 q 3 1 423 q 4 0 5896 q 5 0 5371 q 6 b q 0 05611 q 4 0 1714 q 5 0 1408 q 6 0 0858 q 7 0 1982 q 8 0 08981 q 9 c q 1 1 108 q 1 0 8104 q 2 1 744 q 3 0 2931 q 4 0 5921 q 5 0 1367 q 6 it can be seen from fig 13 that the simulated courses from the above armax model compare well with those from the measurement for the same generated rudder however there is still slightly different in aspect of a higher resolution in the simulated course this requires more effort on finding the parameters of armax model having determined the semi markov model of rudder motions and the armax model of the system sequences of the course fluctuation can be achieved which may represent true behaviour of the ship human performance the ship positions can then be calculated from the regression formula as investigated in fig 4 one of the most important aspects provided by the models presented might well be the validation with the use of extreme value distributions the probability of the ship exceeding any margin of the designed waterway widths during a given period can be estimated using eqs 1 and 2 4 conclusions and future study this paper presents the procedures of the analysis of real time ship manoeuvring simulation results and review of the existing approaches to extend the simulation results for determination of manoeuvring area and ship performance for long term risk assessment improving a fast time simulation for generated ship tracks is a promising approach however such procedure requires reliable description of human behaviour which is still beyond today s possibilities in marine industry the other approaches focus on generation of ship passages and track distances using the probabilistic based model and the monte carlo method however they generally fail to achieve satisfactory model parameters in the presented study several generalized models for determination the parameters of ships manoeuvring area in restricted waterways have been presented such generalisations lead to better understanding of process and have utilitarian value for marine traffic engineers as fast tools to predesign the waterways and their parts the models based on multiple regression revealed that further analysis with more simulation data are necessary the emphasis has been placed on the development of a new method with the application of armax and semi markov models that can be used for long term prediction of navigation risk in restricted waterways information that is lacking in the real time simulation due to a limited number of trials can be realized in the proposed models that will thus provide more accurate readings of the system behaviour the parameters of the system outputs achieved from these models can satisfy several aspects of the risk and consequence analysis in long term studies however the method is restricted to the problem when the trajectories of ship passage are stationary random processes following this approach the definition whether the ship trajectories are stationary or non stationary random processes is an important task as has been presented in quy et al 2006 this restriction produces issues that the model will be improved more comprehensive in the future first the transition matrix should be time dependence conditional probabilities it means that the next state of the rudder is not only depending on the present state but is also subjected to the space position given that state the procedure calculation is the same as that presented in this paper although of greater complexity because of more than one transition matrix being estimated secondly more efforts should also be made on the analysis of dependence between ship speed and rudder states credit authorship contribution statement n m quy conceptualization software methodology investigation writing original draft kinga łazuga writing review editing visualization formal analysis investigation lucjan gucma conceptualization software methodology investigation resources project administration data curation j k vrijling validation supervision p h a j m van gelder validation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge financial support from national university of civil engineering nuce hanoi vietnam grant number 227 2018 khxd td 
21787,this paper presents an attempts towards creation of generalized models of ships manoeuvring area determination and ship performance created on the base of real simulation results those models are needed for better understanding of the safe navigation process in ports areas and its approaches and for risk analysis when no full information about the ships behaviour is available the data coming from real time ship simulations that are conducted by experienced pilots and captains are applied in the study in the first step general regression models are created to determine manoeuvring areas and major correlations between basic parameters affecting the safe area needed for ships to navigate in restricted areas of ports and its approaches in the second step the ship performance models are created to describe the behaviour of the ship including human factors the ship performance for long term prediction of the navigation risk regarding the possibility of ships exceeding the channel limits assumed as grounding or collision with a fixed structure are created by the method which consists of two developed models 1 an armax auto regressive and moving average exogenous model is adopted to identify the ship steering dynamic system with the help of this model the outputs of the system course position etc can be estimated based on the system input conditions rudder engine etc 2 the stochastic sequences of the inputs for the first model used are generated using a semi markov model in the paper the implementation of the semi markov model for rudder actions has been described the study used input output measurements from a ship handling simulator to estimate the model parameters so the human factor has been included in the models the method allows us to extend the results obtained from the simulator to predict future conditions of the system outputs since the predicted results and using probabilistic approach possible ship manoeuvring area margins will be identified and long term assessment of the navigation risk can be realized keywords real time ship manoeuvring simulation ship manoeuvring area risk assessment generalization of ship simulation data 1 introduction maritime simulation is a reliable and indispensable tool in the assessment of navigational safety of a ship in conjunction with harbours and fairways the main application focuses essentially on channel design to indicate the ship manoeuvrability and possible accident occurrence in relation to the human behaviour and environmental conditions this approach usually consists of a two step process application of a ship handling simulator for generating the data of ship motions and assessment of waterway dimensions and navigation risk based on this data there are two approaches for long term assessment of navigating risk on the waterway one is the application of ship handling simulation and the other is assessing the risk based on historical and available data of ship tracks the first approach is focusing more on the accidental risk for transit concerning possible grounding on the shore or collision with the bank while the second is more applicable to the risk assessment of the ship traffic in busy waterway areas the bayesian network has often been found in the modelling of ship traffic and risk assessment of ship collision martins and maturana 2013 akhtar and utne 2014 further improvement of the bayesian network mode by integrating with technique for retrospective and predictive analysis of cognitive errors tracer studied by sotiralis et al 2016 more recently it is of great interesting to utilize ais data with simulation technique for verification and calibration of the risk assessment modes mou j m et al 2010 fangliang et al 2012 p chen et al 2017 rolf j b and asbjørn gilberg 2018 somewhat differs from the above is a more advanced model developed by shahrzad et al 2014 using a markov modelling approach and markov chain monte carlo mcmc the limitation of the existing literature in this approach group is that historical data of ship tracks and accidents is not always available and furthermore impossible to apply to newly developed waterways applying ship handling simulator to the risk assessment of the waterway is a merit tool belonging the first approach real time ship handling simulations should be executed for a wide range of environmental conditions grouped into scenarios and several repetitions for each condition in real time scale so the time required would be comparable to the lifetime of the waterway these requirements are expensive and seem impossible due to time consumption webster 1992 from this arises the question of how to estimate the probability of ship accident during the lifetime of the channel project the so called overall risk the real time simulations are based only on a limited number of conditions and trials in each condition so the risk calculated from the simulated data does not equal to the overall risk generalization of the real time simulation results of ship tracks for long term period research turns out to address the disadvantage of the ship handling simulator method finding ways of extending the real time simulation experimental results and applying to lifetime channel risk analysis is still challenging to researchers to make fast time simulation results closer with those obtained from real time simulation is a promising approach early works developed a ship navigator cognitive model to be constructed for simple course tracking task based on a cognitive task analysis of experimental navigation sessions using a maritime simulator itoh k et al 2001 willem a et al 2005 however this model was programmed to control a ship only in a so called simple single ship situation in recent years some authors developed a fast time simulation based models using either fuzzy logic controller guoqing xia et al 2016 sheng long kao et al 2017 or neural network controller weilin luo et al 2016 nam kyun im et al 2017 however significant efforts should be made to consider more complex navigation tasks multi ship situation to extend the model to more realistic ship navigation as met in the real world it have to be mentioned that many authors have undertaken researches focused on data generalization in the aspect of ship collisions which is more difficult because it requires taking into account the behaviour of two objects and collision geometry consideration an overview of currently used methods can be found in chen et al 2019 weng et al 2020 attempted to study the complex relationship among the traffic characteristics environmental conditions and ship collision frequency using ais data gil et al 2019 investigated feature based on an analysis of a process of merchant vessels collision avoidance nguyen et al 2018 examined the main elements of ship collision by mathematical model for the risk assessment and simulated a collision assessment based on ais information despite the fact that the paper consist of some previously performed research by the authors on the generalization of data from ship traffic manoeuvring simulations it contains a number of new unpublished yet researches these are mainly new analyses concerning parameters of safe manoeuvring areas required by ships including analyses based on linear multi criteria regression the new models of mean and standard deviation of ships manoeuvring area are presented together with the discussion of their applicability these models are utilitarian and provide data for potential risk analyses in addition the paper introduces new analyses of the quality of ship s manoeuvring including rudder movement and course analyses 1 1 ship handling simulators in waterway design many ship simulators exist worldwide for different applications with various levels of capacities essentially a ship handling simulator is a computer generated system that simulates the actual operation parameters of the ship in various manoeuvring conditions in real time and displays the scenery from the navigation bridge visually and audibly on the screen simulators comprise wide range facilities and man machine interfaces as depicted schematically in fig 1 an advanced ship simulator includes models of a ship the simulated navigation channel the environmental impacts the visual scene the radar image tugs and thrusters the ship bridge control and typical bridge instruments the core of the ship dynamic model is the set of hydrodynamic equations of ship motion referred to a coordinate system commonly fixed in the ship the equations should be complete and realistic with ship hull dynamics engine thrust bank and shallow water effects currents wind and wave impacts and tug supporting forces the most important data and results derived from simulator experiments for the use of waterway design are track plot a two dimensional plot which includes the proposed channel contour and the ship position at predetermined time intervals time series tables of different variables track distance rudder angles ship speed turning rate engine revolutions etc throughout the simulation swept path graphs and the channel border are presented in a two dimension plot reviews on the state of the practice application of this technique to navigation risk assessment and waterway design have been well documented in the two guidelines usace 2006 1 2 the typical setup of full mission bridge simulator the example of the full mission simulation is the kongsberg polaris navigational mock up bridge located in maritime university of szczecin fig 2 where large part of this study was conducted the facility consists of one navigational bridge with the visualization of 270 angle and equipped with identical with real control and steering devices dnv class a two part task simulators of 120 visualisations partly equipped with control devices with real like voith schneider tug console dnv class b two simulators of the type pc type with the visualization of the projection type and with simulated navigational devices all equipment of simulator is standardized according to requirements of stcw 95 training section a i 12 section b i 12 table a ii 1 table a ii 2 and table a ii 3 and is certified by dnv the creation of new hydrodynamic models is possible and is based on the dedicated computer tool there is also possibility of the creation of very exact ship models working in six degrees of freedom and the possibility of the modelling of ships with two engines and propellers of both fixed or controllable pitch azimuth drives and the different type of steering devices 1 3 ship movement on the waterways as source of statistical data the understanding of the type of information that simulation attempts to provide is fundamental to evaluate how simulation can contribute to the process of ships movement real time simulations are conducted by human pilots to navigate the simulated ship through the modelled waterway in real time scale interpretation of the simulated ship tracks provides insight into the various navigation factors characteristics and dimensions of the waterway and safety aspects grounding or collision risks typically the analysis of the real time runs aims at finding the ship response parameters including human factors based on distribution of ship track distances centre of gravity and extreme starboard and port points of ships in respect to centre of the waterway distribution of ships courses and distribution of ships speed horizontal vertical and angular one of the most important measures for the risk assessment associated to waterway width design is the probability of ship accidents in each of the waterway sections the probability of a ship exceeding from starboard i th section waterway p ex can be determined as follows 1 p e x p w p i p x d p e n v i d p f x d x where d p is half of the waterway width f x is the density function of the ship positions for a given environmental scenario env shown separately for port and starboard side and for all sections in fig 3 the simulations are usually conducted in series performed in different meteorological conditions each consists of several trials in principle the environmental conditions of wind waves and currents are divided into several regions or categories to facilitate the probability assessment of the navigation results these environmental categories reflecting the frequency of occurrence and severity are selected to define the different combinations of the environmental conditions that might be present when the ship is navigating the waterway the different combinations of environmental conditions are divided into various classes normally three or four known here as manoeuvring scenarios by ordering degree of affecting the ship manoeuvrability the probability of ship accident from the channel section borders during a given time p life can be determined as 2 p l i f e n s h i p i 1 n e p e x p o c e n v i where n ship is the number of ships presents in the channel during a given time period n e is the number of the manoeuvring scenarios p oc env i is the occurrence frequency of the manoeuvring scenario i estimation of occurrence frequencies of the manoeuvring scenarios is also an important topic two approaches could be found in the literature which based on a linear programming technique briggs et al 2003 or classifying external forces on the ship hull quy et al 2007 fig 4 shows the distributions of ship track distance respectively with three manoeuvring scenarios that are defined applying the above principle the ship track samples can be well described by a normal gaussian distribution the figure has been created based on the data of the study case at the entrance channel of ennore port vrijling 1995 real time simulations were performed with the use of a 4 500 teu container vessel eighteen scenarios of environmental conditions which are grouped into three scenarios extreme normal and gentle conditions were carried out for each scenario several runs were executed it was found that the distribution of ship courses is strongly correlated with ship positions referred to the middle of the waterway it can be straightforwardly explained that the more the ship is away from the centre of the waterway the more the navigator changes the course to come back to the desired track gucma 2006 the 30 simulation passages by the model of tanker with parameters l 196 m and b 28 m manoeuvring on the bend of the waterway was applied in this study fig 5 this relation between distance from the centre of waterway cross track error and course can be seen on fig 6 to include this phenomenon for the later analysis of the navigation risk it was proposed to use a linear regression model the distance from the middle of the waterway could therefore be calculated by the distribution of courses using this regression model the results presented in fig 6 are valid for single waterway section as shown on fig 5 and to consider waterway as a whole more advanced models such as the one presented in part 3 of this paper are needed it should be noted that eqs 1 and 2 can only give the probable results of ship position in given section of the waterway they are no indications for the waterway as whole two approaches of integrated risk for entire channel have been presented in the literature burgers and kok 1989 quy et al 2007 1 4 generalized models of ship movement and performance the existing systems due to their complexity require constructions of suitably specialized models with several parameters such as ships traffic hydrometeorological conditions parameters of the water area and other most of these parameters are random and simple analytical methods are not suitable especially when these models are supposed to include also a human factor the probability of navigator error the modelling of such systems can be carried out by means of simulation methods and particularly monte carlo based methods fig 7 presents several stages necessary for such models creation with previous generalization of various data comes from both simulations and real like ais based experiments or observations in general the present models can be divided into three following classes fig 8 1 general probabilistic models of ship manoeuvring area parameters 2 causation models 3 ship performance models the first and last were presented in this study in point 2 and 3 respectively the second kind of the models try to find the relation between ships consecutive positions of ship manoeuvring on the waterway some of them are presented in semerdjiev and mihaylova 2000 gucma 2007 the previously mentioned mcmc or hidden markov chains or other based on stochastic processes finding the dependence between consecutive ships position could be applied there such a model was presented by gucma 2007 it differs from the above in several ways it assumes that the next ship position can be generated from the past consecutive position using two types of probability distributions the first type describes the probability distribution of maximum and minimum points of ship track on starboard and port sides respectively the second is the conditional distributions between the ship course and the generated track distance the probabilistic model parameters were also obtained from statistical analysis results of the real time simulations 2 generalized models for determination of ship manoeuvring area authors carried out some researches concerned with generalization of ship data possessed in simulation experiments they were led in two directions to find the shape of distributions describing the position of the ship on waterways to estimate parameters of those distributions and model dependences between most important variables gucma 2012 it was proven in many studies that the normal distribution is well fitted for the description of the variability of the position of ships on waterways in the horizontal plane gucma 2012 in many researches iribarren 1999 the asymmetrical distributions e g extreme values were also successfully fitted to model the movement of ships on coastal areas the mixture of normal and uniform distribution in relation 99 1 is usually used karlsson et al 1998 such a mixture is useful when traffic consists of typical merchant ships normal distribution and pleasure crafts uniform distribution 2 1 models based on linear regression to find the general models of ships manoeuvring area parameters mean m and standard deviation s the database of real time ship simulation experiments was used the database includes 25 different ships manoeuvring in 121 conditions table 1 this experiment was not designed intentionally but done within the routine port design works made by simulation research team of maritime university of szczecin to find relation between the mean safe manoeuvring area denoted as m p i m z for straight part legs of waterway and bends accordingly and ships breadth b the simple linear regression model was chosen breadth of ship was chosen because it s the most significant factor influencing the width of waterway other factors like available width of manoeuvring water area length of ship ship s manoeuvrability wind or current influence are less important fig 9 demonstrates two models of linear relations of those parameters for straight and bend legs of waterway the parameters of regression for straight leg m p are as follows coefficient of determination r 2 0 76 overall regression error s e 9 5 m and f statistics f 440 similar model was built to find the relation of standard deviation of the width of available waterway area awa fig 10 shows this relation by linear regression model with use of simulations presented on table 1 the parameters of regression for straight s p were as follows coefficient of determination r 2 0 41 overall regression error s e 5 8 m and f statistics f 100 the linear model of standard deviation on straight waterway s p dependence of the available waterway s width d could be presented in the following form 3 s p 0 05 d 3 4 2 2 models based on linear multiple regression in this point the method of multiple regression was applied to determine the mean and the standard deviation of maximum ship distance from the middle of waterway the model based on multiple regression describes the relationship between the dependent variable y and n independent variables x in the form of 4 y b 0 b 1 x 1 b n x n where b i multiple regression model coefficients two types of characteristic water areas were chosen which results were taken from simulation tests straight leg of the waterway bend of the waterway as the dependable variables average width of safe waterway area the standard deviation of maximum distance from the middle of the waterway is selected average width of the safe manoeuvring area is therefore defined as 5 d m m d p m d l where m dp m dl average maximum distance of the ship points to the port and starboard from the middle of the waterway it was assumed that the middle of the waterway is symmetrically located in relations to the average mean width of safe manoeuvring area in most of simulation tests there is no specified centre and it is necessary to establish the hypothetical middle of the waterway fig 11 standard deviation of the maximum distance to the waterline to right and left from the middle of the waterway is devoted as s dl and s dp considering small differences between the standard deviations to the port and starboard side it was decided to analyse the mean of standard deviation as s d s dl s dp 2 following independent variables in the model of regression were used as the most influencing ships manoeuvring area 1 breadth of ship b m 2 available width of manoeuvring water area d m 3 length of ship l m 4 factor of ship s manoeuvrability ms dimensionless 5 cross wind intensity sw m s 6 water current factor pr dimensionless because of difficulty to define relations between variables within the model the wind direction was not taken into consideration during the research current factor is assumed as 0 for opposite and the lack of current 1 when a ship is moving downstream being consistent with its movement what is considered to be the most impeding the ship s manoeuvre to introduce different manoeuvring abilities of ships it is suggested to define manoeuvre factor as the number from 0 to 3 0 for small ships with the perfect manoeuvre ability which perform manoeuvres all on their own 1 for big ships with good manoeuvre ability equipped in bow thruster and twin propeller 2 for ships with poor manoeuvre ability and in ballast 3 for ships with very bad manoeuvrability and loaded basic problem during construction of multiple regression models is the internal correlation between independent variables in the proposed model the internal correlation is obvious and appears between ship s length and breadth ship s width and manoeuvre factor and available water area s width and ships breadth the first pair characterizes the biggest correlation however there was no decision made to remove independent variable which describes ship s length because in theory it has influence on the lane s width especially when the ship moves at a big rate of drift what occurs when moving through the bends in the model the width of available water area is the independent variable of great importance the smaller available width the manoeuvre width has to be done with higher confidence and precision and with smaller errors tolerance when the probability of collision rises it also decreases freedom of manoeuvre and only some manoeuvring methods are effective and safe the data for researches were gathered with use of simulation tests as presented in table 1 models of two dependent variables average width of the lane standard deviation of the distance in the defined level of significance can be described as 6 d m b 0 b b b b d d b l l b m s m s b s w s w b pr pr 7 s d b 0 b b b b d d b l l b m s m s b s w s w b pr pr parameters and verification of the models were described in gucma 2012 it is important to remember that application of models is often restricted by environmental conditions env prevailing during simulation tests table 2 presents the multiple regression coefficients of the models obtained by the least squares method in which all independent variables were included additionally the coefficient of determination r 2 is given which determines what percentage of dependent variable variation is explained by the model and standard error of estimation s which can be interpreted as the average deviation of the dependent variable in the sample from the theoretical value additionally the f statistics coefficient is presented some independent variables that are not bolded in table 2 weren t significate to overall model of regression which lead to need of further analysis considering the excluding variables it should be noted that the model is sensitive on regression parameters and some independent variables have unimportant influence on presented model mostly due to complexity of ships behaviour and too small sample size such model could be used for probability of a ship collision with technical structures or embankments assessment 3 ship performance model in the following part the use of armax model and semi markov process to extend real time simulation results for long term prediction of the navigation risk will be presented this study is an ongoing effort to the generalization of real time simulation used for the risk assessment of navigable limits two models have been developed the first model uses armax technique to estimate the system outputs course position etc from the inputs rudder engine etc of the ship steering dynamics the stochastic sequences of the inputs for the first model used are generated using a semi markov model one implementation of the semi markov model for rudder actions has been studied the study used input output measurements from a ship handling simulator to estimate the model parameters the human factor has therefore been included in the models the method allows the results obtained from the simulator to be extended to predict the future conditions of system outputs based on the predicted results and using probabilistic approach possible margins of ship manoeuvring area will be identified and long term assessment of the navigational risk can be implemented involving a straightforward use of the optimal design of the waterway widths satisfactory results were obtained even there were limited ship handling results available however the study is constrained to one failure mechanism which is the even of ships exceeding the waterway limits and being viewed as grounding or colliding with surrounding structures the general procedure for the study is presented in fig 12 3 1 model of ship steering dynamic a ship operating in seawater is assumed as an dynamic system with inputs u t outputs y t and white noises e t as shown in fig 13 the inputs can be rudder angle propellers and thrusters and etc the outputs are ship heading yaw sway surge roll yaw rate sway velocity surge velocity roll rate and etc there are several ways to represent the relationship between the outputs and inputs for example by means of a continuous time model classical way or differential equation a model in transfer function form a model in time or frequency domain and a discrete time model digital technique or difference equation fossen 1994 in this paper discrete time auto regressive moving average exogenous armax model was adopted the armax model applied to the above described dynamic system can be assumed as a discrete time model a multiple input and single output miso system in a transfer function form as follows ninness and wills 2005 8 y t g q u t h q e t in above u t and y t are sequences of the multiple input u t ε r m and single output y t ε r 1 system with the same length g q is 1 m rational transfer function of the system and h q is rational transfer function of the filter which are defined as 9 g i q q n k i b i q a i q h i q c q a i q where n ki is the number of delays from input to output of the ith input q is the delay operator a q b q and c q are polynomials of q 1 defined as 10 a i q 1 a 1 q 1 a 2 q 2 a n a q n a i 11 b i q b o b 1 q 1 b 2 q 2 b n b q n b i 12 c q 1 c 1 q 1 c 2 q 2 c n c q n c where n ai n bi and n c are orders of polynomials a i b i and c respectively having observed the input output data u y the most appropriate orders and the parameters of the polynomials can be determined using prediction error e t method ninness and wills 2005 which is available in the matlab identification system toolbox matlab 2005 the model described in eq 4 with known a b and c can then be applied to generate a random sequence ship course from the inputs u t the following section will present how to apply a semi markov model to describe rudder motions based on measured rudder angles achieved from the real time simulation 3 2 a semi markov model of rudder motions markov chains and semi markov models are powerful and commonly used technique for studying the reliability and characteristic of complex systems these models use a set of data observed in present to predict system behaviour in future by generating a random sequence that contains patterns of data characteristics details about this class of processes can be found in janssen and manca 2006 consider a finite set of rudder angles r r 1 r 2 r k degree and respectively numbered and represented by rudder states s 1 2 k that occur at random times during all the simulation trials and denote p i j as the transition probability that the helmsman moves the rudder randomly from state i at rudder angle r i at time t i to state j at rudder angle r j at time t j a markov chain is a discrete time stochastic process where the conditional probability of any future event depends on only the present state the transition probability p i j is expressed by this law as 13 p s t j j s t i i p i j t j t i in practice the transition probabilities p i j can be determined from the measured data as 14 p i j n i j m i m i j 1 k n i j where n i j is the number of times that the rudder is moved from state i to state j the quantity p i j is an element of square matrix called the transition probability matrix or transition matrix in which the size k x k equals to the number of the states all the transition probabilities of the markov process can be estimated based on the data recorded in the simulator trials now the markov chain can be extended to the semi markov model by considering the times that the helmsman used to move the rudder from state i to state j and retain it in each state the rudder motion records during a series of the simulator trials were obtained as shown in fig 14 the real time simulations were carried out at the piastowski canal leading from szczecin to the baltic sea fig 15 a total of 45 trials with various environmental conditions were performed at paprotno mielin bend part with the use of a 4 500 teu container vessel the rudder of the ship can be adjusted from 35 port to 35 starboard with a unit angle δr 1 it was observed that in all trials the helmsman tried to move the rudder with the same rudder rate v r the time that the helmsman spent moving the rudder from state i to state j can therefore be determined as 15 t i j t j t i r j r i v r j i δ r v r in this case the time spent on the transitions or moving rudder is a deterministic quantity the model thus has a transition time matrix analogous to transition probability matrix now the only thing left is to estimate the time called sojourn time that the helmsman maintains the rudder angle in every rudder state the sojourn times t i i are of course random and depending on many factors where the helmsman s competence ship characteristics and navigational conditions are the main factors usually a certain distribution can be found to fit the sojourn times obtained from simulator trials fig 16 shows for example distribution of the sojourn times in the state with the 5 rudder angle fitted lognormal distribution it should be clear that the sequence of rudder angles from the simulation is commonly recorded for every 1 s the sojourn time in a state therefore exactly equals to the number of times n i i that the same rudder angle values have continuously been recorded it means that the length of the sojourn times increases proportionally to the transition probabilities p i i this makes it easier to generate the sojourn times in each state 3 3 results of part 3 fig 17 presents sequences of rudder angles generated randomly from the semi markov model developed in the above section the results seem like those measured from the simulator trials in time series but some differences can be found in the shape of their probability distributions and power spectra as shown in fig 18 and fig 19 it is more interesting to observe the results in the frequency domain in both cases the power spectra of the motions shows significant peaks around zero frequency but the higher peak is obtained in the generated rudders than in the simulator however the amount of the rudder motion in the simulator is larger by comparison in the frequency range from 0 2 to 0 7 rad s and then both approximately drop to zero here remained only the problem of estimating parameters of the armax model for the measured data of rudders and courses as shown in fig 20 the resulting model has been found as follows 16 a q 1 1 878 q 1 0 1112 q 2 2 456 q 3 1 423 q 4 0 5896 q 5 0 5371 q 6 b q 0 05611 q 4 0 1714 q 5 0 1408 q 6 0 0858 q 7 0 1982 q 8 0 08981 q 9 c q 1 1 108 q 1 0 8104 q 2 1 744 q 3 0 2931 q 4 0 5921 q 5 0 1367 q 6 it can be seen from fig 13 that the simulated courses from the above armax model compare well with those from the measurement for the same generated rudder however there is still slightly different in aspect of a higher resolution in the simulated course this requires more effort on finding the parameters of armax model having determined the semi markov model of rudder motions and the armax model of the system sequences of the course fluctuation can be achieved which may represent true behaviour of the ship human performance the ship positions can then be calculated from the regression formula as investigated in fig 4 one of the most important aspects provided by the models presented might well be the validation with the use of extreme value distributions the probability of the ship exceeding any margin of the designed waterway widths during a given period can be estimated using eqs 1 and 2 4 conclusions and future study this paper presents the procedures of the analysis of real time ship manoeuvring simulation results and review of the existing approaches to extend the simulation results for determination of manoeuvring area and ship performance for long term risk assessment improving a fast time simulation for generated ship tracks is a promising approach however such procedure requires reliable description of human behaviour which is still beyond today s possibilities in marine industry the other approaches focus on generation of ship passages and track distances using the probabilistic based model and the monte carlo method however they generally fail to achieve satisfactory model parameters in the presented study several generalized models for determination the parameters of ships manoeuvring area in restricted waterways have been presented such generalisations lead to better understanding of process and have utilitarian value for marine traffic engineers as fast tools to predesign the waterways and their parts the models based on multiple regression revealed that further analysis with more simulation data are necessary the emphasis has been placed on the development of a new method with the application of armax and semi markov models that can be used for long term prediction of navigation risk in restricted waterways information that is lacking in the real time simulation due to a limited number of trials can be realized in the proposed models that will thus provide more accurate readings of the system behaviour the parameters of the system outputs achieved from these models can satisfy several aspects of the risk and consequence analysis in long term studies however the method is restricted to the problem when the trajectories of ship passage are stationary random processes following this approach the definition whether the ship trajectories are stationary or non stationary random processes is an important task as has been presented in quy et al 2006 this restriction produces issues that the model will be improved more comprehensive in the future first the transition matrix should be time dependence conditional probabilities it means that the next state of the rudder is not only depending on the present state but is also subjected to the space position given that state the procedure calculation is the same as that presented in this paper although of greater complexity because of more than one transition matrix being estimated secondly more efforts should also be made on the analysis of dependence between ship speed and rudder states credit authorship contribution statement n m quy conceptualization software methodology investigation writing original draft kinga łazuga writing review editing visualization formal analysis investigation lucjan gucma conceptualization software methodology investigation resources project administration data curation j k vrijling validation supervision p h a j m van gelder validation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge financial support from national university of civil engineering nuce hanoi vietnam grant number 227 2018 khxd td 
21788,course keeping control is the core of automatic navigation for ships in marine transportation to optimize the steering conditions of course keeping controller and enhance its robustness in heavy sea states a new nonlinear course keeping control algorithm is designed with power function nonlinear feedback and zoh model controller take the new generation of teaching training vessel yupeng from dalian maritime university as the research plant and the nonlinear nomoto ship model with a zero order holder component is constructed to design the zoh model controller then the deviation signal from the closed loop system is modified by a power function nonlinear feedback component to reduce the control output the stability of the closed loop system is analyzed by the describing function method and nyquist criterion the simulation experiments in normal sea states and heavy sea states are respectively carried out to verify the control performance the simulation experiments show that the performance of this nonlinear course keeping control algorithm is satisfactory which can still be effective in heavy sea states the steering frequency is reduced significantly and the steering condition of the controller meets the requirements of navigation practice the nonlinear course keeping control algorithm is more suitable for the navigation practice and engineering application keywords course keeping marine transportation heavy sea nonlinear feedback zero order holder navigation practice 1 introduction marine transportation is a significant mode of transportation and more than 70 of cargo in international trade is transported by ships one of the research hot spots in the field of transportation is to improve the efficiency of marine transportation and ship motion control is the most effective means due to the uncertainty of external disturbance such as wind wave current and so on a ship always presents a nonlinear motion fossen 2002 ship is a sizeable inertial system whose response to the control rudder angle is slow so that the motion of ship is not easy to change and the control period is extended in navigation practice frequent large rudder angle can cause the course of ship to oscillate continuously near the planned course moreover it can also result in a larger rolling amplitude in heavy sea states it is always a hot issue in the field of ship motion control to realize accurate and stable course keeping control with smaller rudder angle and lower steering frequency based on the course keeping control algorithm aarsaether and moan 2010 fossen 2011 johansen and fossen 2013 in recent years with the development of control theory and technology many linear or nonlinear control algorithms have been applied to ship motion control peng et al 2017 dai et al 2016 most of the feedback signals in these control algorithms are linear feedback signals where the unit negative feedback is the most when the ship is at sea its course will frequently change due to the changing disturbance of wind and wave and most of the linear feedback course keeping control algorithms have some deficiencies such as large rudder angle and high steering frequency which is inconsistent with navigation practice tu 2008 zenon 2014 an adaptive neural network control algorithm had been used in lin and miao 2014 and the effect of course keeping control was good but the rudder angle was large and the frequency of steering was high research of second order nonlinear multi agent system had been carried out in wang et al 2015 the rudder angle of it was reduced but the steering frequency was still too high the simulation control of two vessels based on rbf neural network had been carried out in liu and guo 2013 the rudder angle of it was steered frequently within the range of 0 3 deficiencies of linear feedback course keeping control algorithms that may be deemed to pose a danger to the new marine objective of international maritime organization include the following 1 unstable navigation in heavy sea states 2 inefficient shipping caused by large rudder angle and high steering frequency aiming at the deficiencies of some linear feedback control algorithms a nonlinear feedback control algorithm was put forward in zhang and zhang 2016 by using the sine function nonlinear feedback method the course deviation in which was modified in a nonlinear way which effectively reduced the rudder angle and the steering frequency was optimized to a certain extent zhang et al 2017 had combined the nonlinear feedback theory with backstepping control theory and established the ship course keeping control algorithm that satisfied the lyapunov stability theory in which the procedure of nonlinear controller design had been reduced from two steps to one step fan et al 2018 had successfully applied the nonlinear feedback control theory to the course keeping control of usv based on the above research this paper proposes a new course keeping control algorithm with power function nonlinear feedback and zoh component the main contributions are mainly twofold 1 in order to make the ship model more accurate a nonlinear zoh nomoto ship model is constructed furthermore a zoh model controller is designed based on the nonlinear zoh nomoto ship model which makes the controller catch the zero order holder component better 2 a power function nonlinear feedback module is applied to deal with the error signal then the zoh model nonlinear feedback algorithm is established the stability of the whole system is analyzed by the describing function method and the nyquist criterion 2 preparation work 2 1 the nonlinear feedback control system the block diagram of a nonlinear feedback control system is shown in fig 1 in a nonlinear feedback control system r is the input signal y is the output signal the deviation signal is represented by e r y and the nonlinear feedback algorithm is represented by m g e the nonlinear feedback controller consists of controller k and the nonlinear feedback module m δ is the output of the controller g is the model of controlled plant and d represents the external disturbance the output of a linear feedback controller is δ f e e contrary to the linear feedback system the output of a nonlinear feedback controller is δ f e g e the difference between the outputs of two controllers is that a nonlinear feedback algorithm g e is used by the nonlinear feedback system to replace the deviation signal e of the linear feedback system and the control law f e of the nonlinear controller is still the same the purpose of this method is to reduce the output energy of the system when the control effect is similar or improve the control effect in large disturbance conditions 2 2 signal processing of time delay and zero order hold the phenomenon of time delay is quite common in practical engineering there are a large number of time delay models in the industry such as the distillation tower vibration isolator water tank and magnetic levitation many published literature such as lei and guo 2015 zhao et al 2007 zhang et al 2014 zhang et al 2016 and yang et al 2015 had carried out some research about time delay models in navigation practice due to the characteristics of inertia there exists a certain delay from the time when the rudder angle is given by the controller to the moment that the response of the steering engine is completed take the steering order signal with sinusoidal variation as an example the comparison of the results after the time delay and zero order hold processing is shown in fig 2 in some engineering fields the reasonable application of the controller with a time delay module can improve the performance of the control system however the course of a ship that affected by the continually changing disturbance can frequently change at sea which can cause the course keeping controller to provide various steering orders too frequently as shown in fig 2 time delay processing only lags the output of signal in time domain but the frequency and amplitude of the signal have not changed therefore it cannot avoid frequent steering which does not satisfy the requirements of navigation practice different from time delay processing as shown by the solid line in fig 2 the controller with a signal holding component can hold the same control output for a short period of time this character not only reflects the time of signal delay between the controller and the steering engine but also reduces the steering frequency which meets the requirements of navigation practice 3 controller design 3 1 linear feedback controller the second order nonlinear responding nomoto ship model is 1 ψ k 0 t 0 α ψ β ψ 3 k 0 t 0 δ where α and β are the proportional coefficients of yaw rate ψ and can be identified by the least square method a linear approximation for equation 1 is carried out and the derived transfer function is 2 g ψ δ s ψ δ k 0 s t 0 s 1 based on closed loop gain shaping algorithm zhang and zhang 2013 the ship course keeping controller k is designed under the following three conditions 1 set the bandwidth frequency of the closed system to 1 t 1 2 let the high frequency asymptote slope be 20db dec for the controller design 3 the frequency spectrum of the closed loop system is made equal to the frequency spectrum of a first order inertial system with the largest singular value approximately to one then the course keeping controller k 1 is 3 k 1 s 1 k 0 t 1 ρ p i d ε k 0 t 1 1 s t 0 k 0 t 1 s since the inertia of ship is large and the control time is long a small constant ρ p i d is added to improve the response speed of the control system zhang and zhang 2016 and ρ p i d is usually 2 6 ε is a small constant which is used to eliminate the static difference caused by closed loop gain shaping algorithm 3 2 time delay model controller according to zhang 2011 a nonlinear ship model with time delay component is 4 g 1 s k 0 e θ 1 s s t 0 s 1 use the expansion of first order taylor series we can get e θ 1 s 1 θ 1 s and equation 4 can be written as 5 g 1 s k 0 1 θ 1 s s t 0 s 1 theorem 1 maximum modulus theorem assume that f s is a function that has no poles in ω if f s is not a constant then f s does not attain its maximum value at an interior point of ω let ω equal the open right half plane and w 1 s s 1 s denotes the transfer function from the normalized disturbance to the system output w 1 s is the weight function which has no poles in ω and s 1 s is the sensitivity function 6 w 1 s s 1 s w 1 s 1 g 1 s q 1 s sup re s 0 w 1 s 1 g 1 s q 1 s the transfer function g 1 s has a zero point at s 1 θ 1 in the open right half plane and s 1 θ 1 is in the region ω according to theorem 1 7 sup re s 0 w 1 s 1 g 1 s q 1 s w 1 s 1 g 1 s q 1 s s 1 θ 1 θ 1 the minimum value of w 1 s s 1 s which can be obtained from equation 7 is θ 1 assuming that the system input is a step signal 1 s the disturbance at the plant output is d s then the weight function w 1 s should satisfy d s w 1 s 2 1 in the h robust control w 1 s is taken as 1 s substituting equation 6 into equation 7 and minimizing the left hand side of the equation yields 8 w 1 s 1 g 1 s q 1 s 1 s 1 k 0 1 θ 1 s s t 0 s 1 q 1 s θ 1 in this case the unique optimal solution is 9 q o p t 1 s t 0 s 2 s k 0 since the asymptotic tracking property requires that lim s 0 1 g 1 s q 1 s 0 the following filter is introduced to roll q o p 1 s off at high frequency 10 j 1 s 1 ϕ s 1 2 then add the filter and a proper q 1 can be obtained 11 q 1 s q o p t 1 s j 1 s t 0 s 2 s k 0 1 ϕ s 1 2 the time delay unity feedback controller is 12 k 2 s q 1 s 1 g 1 s q 1 s 1 k 0 t 0 s 1 ϕ 2 s 2 ϕ θ 1 based on navigation practice we add a no steering component in small course deviation ξ in front of the time delay model controller the time delay coefficient θ 1 10 s parameter ϕ is usually equal to 0 5 θ 1 2 0 θ 1 and ξ is 1 the time delay model controller k 2 is used to provide a comparison in the simulation experiments 3 3 zoh nonlinear feedback controller the nonlinear nomoto ship model with zoh component is 13 g 2 s k 0 1 e θ 2 s s t 0 s 1 expend 1 e θ 2 s s into a power series and obtain the first two terms of it 14 1 e θ 2 s s 1 s 1 1 e θ 2 s θ 2 1 θ 2 s substitute equation 14 into equation 13 15 g 2 s k 0 θ 2 t 0 s 1 1 θ 2 s let ω equal the open right half plane and w 2 s s 2 s denotes the transfer function from the normalized disturbance to the system output 16 w 2 s s 2 s w 2 s 1 g 2 s q 2 s sup re s 0 w 2 s 1 g 2 s q 2 s w 2 s is taken as 1 s and the minimum value of w 2 s s 2 s needs to be asymptotically convergent 17 lim s 0 s 2 s lim s 0 1 g 2 s q 2 s 0 in this case the unique optimal solution is 18 q o p t 2 s t 0 s 1 1 θ 2 s k 0 θ 2 the following filter is introduced to roll q o p t 2 s off at high frequency 19 j 2 s 1 0 01 λ s 1 0 6 λ s 1 2 λ s 1 1 a proper q 2 s can be obtained 20 q 2 s q o p t 2 s j 2 s t 0 s 1 1 θ 2 s k 0 θ 2 0 01 λ s 1 0 6 λ s 1 2 λ s 1 1 the zoh unity feedback controller is 21 k 3 s 1 k 0 θ 2 t 0 s 1 1 θ 2 s s 0 012 λ 3 s 2 1 226 λ 2 s 2 61 λ 1 the power function nonlinear feedback module m μ e 0 6 is added after the unit feedback signal where the unit feedback signal e is substituted by e 0 6 a no steering component in small course deviation within ξ is added in front of the nonlinear feedback module combined with the zoh model controller and zoh component a zoh model power function nonlinear feedback controller is formed and the block diagram is shown as fig 3 the coefficient θ 2 of zero order holder usually equals to 5 15s parameter λ generally equals to 0 5 θ 2 2 0 θ 2 the coefficient μ of power function nonlinear feedback module is 0 1 0 5 and ξ is usually equal to 0 5 1 4 the effect of power function nonlinear feedback to control system the input and output of the nonlinear feedback can be described as 22 y f x μ x 0 6 when the input signal of nonlinear feedback is a sinusoidal signal x t a sin ω t 23 y t μ a sin ω t 0 6 harmonic analysis is carried out for the steady output y t of the nonlinear feedback typically y t is a non sinusoidal periodic signal expand y t into the fourier series and take the first harmonic component 24 y t a 0 a 1 cos ω t b 1 sin ω t a 0 is the direct current component a 1 and b 1 are the first harmonic components 25 a 0 1 2 π 0 2 π y t d ω t a 1 1 π 0 2 π y t cos ω t d ω t b 1 1 π 0 2 π y t sin ω t d ω t under the impact of sinusoidal input signal x t asin ω t the describing function of nonlinear feedback is a complex ratio between the first order harmonic component and the input signal where the first harmonic component is from the steady output signal in nonlinear feedback and the describing function can be expressed as n a 26 n a n a e j n a b 1 j a 1 a the nonlinear feedback control system can be expressed in fig 4 the first harmonic components of a 1 and b 1 can be calculated as follows 27 a 1 1 π 0 2 π μ a sin ω t 0 6 cos ω t d ω t μ a 0 6 π sin ω t 1 6 1 6 0 2 π 0 28 b 1 1 π 0 2 π y t sin ω t d ω t μ a 0 6 π 0 2 π sin ω t 1 6 d ω t the sin ω t can be expanded by taylor series and retain it to the 9 t h order 29 sin ω t ω t ω t 3 3 ω t 5 5 ω t 7 7 ω t 9 9 set τ μ a 0 6 π and substitute equation 29 into equation 28 then 30 b 1 τ 0 2 π ω t 1 6 1 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 1 6 d ω t set z ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 and expand 1 z 1 6 by taylor series and retain it to 2 n d order 31 1 z 1 6 1 1 6 z 1 6 0 6 2 z 2 substitute equation 31 into equation 30 and calculate the result of integral 32 b 1 τ 0 2 π ω t 1 6 1 1 6 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 0 48 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 2 d ω t τ 6 4277 6 4277 μ a 0 6 π the describing function of nonlinear feedback is 33 n a b 1 j a 1 a 6 4277 μ a 0 6 π a 4 1 effect on the dynamic performance of the closed loop system according to fig 4 the transfer function of the nonlinear feedback control system from the input r i e the intended course to the output y of the system i e the heading angle ψ is 34 y r g k n a 1 g k n a for the ship course keeping problem the frequency spectrum of wave interference lies in the range of 0 3 1 25 rad s the bandwidth frequency of the closed loop system is usually set at 1 t 1 0 3 rad s to shy away from the wave frequency spectrum in navigation practice the course changing range is between 0 2 π rad therefore 0 n a 1 according to closed loop gain shaping theory the open loop transfer matrix gk satisfies robust performance in the low frequency zone and robust stability in the high frequency zone zhang 2012 the comparison between the transfer function of equation 34 and the closed loop transfer function of the standard feedback system in low frequency range shows that the introduction of n a has less effect on the dynamic performance of the closed loop system therefore the control system can have better stabilizing performance and robustness can be obtained by selecting the proper parameters 4 2 effect on the output of the closed loop system the transfer function from the input r to the output δ of the controller i e the rudder angle is 35 δ r k n a 1 g k n a k has a large first order gain and gk has a large second order gain hu 2013 similar analysis as for equation 34 can proceed to represent that the introduction of n a can bring about the benefit of reducing the output of the controller moreover the power function y μ x 0 6 can make the maximum and minimum values of the error which is the input signal of the controller within 1 when the coefficient μ is 0 1 0 5 a similar processing technique can be seen in fuzzy control neural network and optimized genetic algorithms 4 3 proof for the stability of the whole nonlinear feedback control system combine the modules k and g in fig 4 and then the equivalent diagram is shown in fig 5 c s is the equivalent form after the combination of module k and g 36 c s 1 0 01 λ s 1 0 6 λ s 1 2 λ s 1 it can be seen that the poles of c s are all located in the left half part of s plane thus c s has low pass characteristics when the nonlinear characteristics of the control system are approximately equivalent to the describing function the characteristic equation of the closed loop system is 37 1 n a c j ω 0 from equation 37 we can know that 38 c j ω 1 n a where 1 n a is the negative inverse describing function of the nonlinear part a shown in fig 6 the nyquist curve γ g and the curve of 1 n a are plotted in the complex plane according to nyquist criterion 1 if the curve of γ g encircles the curve of 1 n a the system is unstable at that time 2 the system is stable if the curve of γ g does not enclose the curve of 1 n a 3 if the curve γ g intersects curve 1 n a which means there is a real solution of ω in equation 37 the stability of the system and the stability of the periodic motion must be analyzed separately hu 2013 therefore the curve γ g does not enclose the curve of 1 n a and the whole system is stable 5 simulation research 5 1 simulation of steering engine characteristics the steering servo system usually regards as a first order inertial component in the modeling of ship motion control in fact the steering servo system is an electro hydraulic system with pure delay dead zone hysteresis saturation and other nonlinear characteristics zhang 2012 the steering servo system of each ship is different due to the differences among different parameters from ships and steering engines therefore in order to set up a steering servo system which is consistent with navigation practice the parameters of the steering servo system must be adjusted according to the characteristic of the real ship add the no steering component in small rudder order inertial module rudder angle saturation component and maximum rudder speed limit component into the steering servo system parameters of each component are set according to the actual character of the ship and the improved steering servo simulation system is shown in fig 7 for ship yupeng the small rudder order that the steering gear does not respond is within 0 3 the inertial module is the first order inertial module represented as 1 t r s 1 and the inertia time coefficient of the steering gear is t r 2 1s the rudder angle saturation limit is 35 and the maximum speed of steering gear is 2 55 s in single pump operation because the steering gear of yupeng has a low hydraulic pump power which increases the inertia coefficient of the steering gear and the maximum steering speed of yupeng is decreased the above reasons increase the difficulty of course keeping control the improved steering engine system is respectively combined with the time delay model controller and the zoh model nonlinear feedback controller to carry out the following simulation experiments together with the linear feedback control system which still uses the traditional steering engine system 5 2 simulation of wind and wave in the process of navigation the disturbance of wind and wave is the leading cause of the deviation for ships the disturbance of wind can be divided into average wind and random wind the average wind can generate a leeway and according to jia and zhang 2015 it can be treated equivalently to an equivalent rudder angle that acts on the hull based on kallstrom 1982 the random wind can be considered as the realization of some white noise whose deviation is proportional to the square of absolute wind speed v t 39 σ y 0 2 ρ a v t 2 c y γ r l 2 σ n 0 2 ρ a v t 2 c n γ r l 3 ρ a is the air density c y γ r and c n λ r are respectively the dimensionless coefficients of wind force and wind torque l is the length of the ship in the field of course keeping control the influence of wave can be approximated by a second order system in the dof around the z axis a linear approximation of ittc wave spectral density function is yang et al 2001 40 y s h s ω s ω s is the zero mean gaussian white noise and its power spectral density is 1 0 h s is the second order transfer function of the wave 41 h s 2 ζ ω 0 σ ω s s 2 2 ξ ω 0 s ω 0 2 where σ ω is a coefficient to describe the strength of the wave ζ is the damping coefficient and ω 0 is the dominant frequency of the wave therefore substitute s j ω into equation 41 and we can get 42 h j ω 2 ζ ω 0 σ w ω j ω 0 2 ω 2 2 ζ ω 0 ω j the amplitude of h j ω is 43 h j ω 2 ζ ω 0 σ w ω ω 0 2 ω 2 2 4 ζ ω 0 ω 2 the spectral density function of y j ω is 44 g y y ω h j ω 2 g w w ω h j ω 2 1 0 4 ζ ω 0 σ w 2 ω 2 ω 0 2 ω 2 2 4 ζ ω 0 ω 2 when ω is equal to the dominant wave frequency ω 0 at that time the maximum of g y y ω is 45 max g y y ω g y y ω 0 σ w 2 when the wave is in the same conditions the dominant wave frequency of the wave in y s should be equal to the modal frequency in the ittc spectrum therefore the dominant frequency of the wave is 46 ω 0 4 4 5 691 t w 4 4 85 t w t w is the period of wave and the value of σ w is σ w h 1 3 0 0185 t w which equals the value of the mpm power spectrum in the same ω 0 47 g y y ω 0 173 h 1 3 2 4 85 t w 5 t w 4 e 691 t w 4 4 85 t w 4 0 0185 t w h 1 3 2 the transfer functions of wave disturbance in beaufort no 6 and beaufort no 8 wind are guan 2010 48 h 1 s 0 4198 s s 2 0 3638 s 0 3675 h 2 s 1 3353 s s 2 0 5153 s 0 2655 the power spectral density functions of the wave in beaufort no 6 and beaufort no 8 are 49 g y y 1 ω 0 1762 ω 2 0 3675 ω 2 2 0 1323 ω 2 g y y 2 ω 1 7608 ω 2 0 2606 ω 2 2 0 2606 ω 2 based on the power spectral density functions in eq 49 the three dimensional views of wave interference under the effect of winds in beaufort no 6 and beaufort no 8 are respectively shown in fig 8 and fig 9 5 3 simulation experiments of nonlinear nomoto model the teaching training vessel yupeng is taken as the simulation plant because the maneuverability of yupeng in the full loaded condition is poor therefore the second order nonlinear nomoto model of yupeng in the full loaded condition is used and the improved steering engine simulation system is adopted to carry out the simulation experiments based on the actual situation and in order to ensure the safety of navigation the rudder angle saturation is limited at 25 in time delay nonlinear feedback controller parameter ϕ 1 5 θ 1 and in zoh nonlinear feedback controller the coefficient μ 0 22 λ 0 8 θ 2 in order to analyze the comprehensive performance and the robustness of ship course keeping controller the simulation research for yupeng is carried out respectively under normal sea states and heavy sea states three evaluation indexes as mean course deviation mcd total steering frequency tsf and mean steering amplitude msa are introduced to analyze the simulation results quantitatively 50 mcd 1 t δ t s σ ψ t ψ 0 tsf σ sf δ t msa 1 tsf σ ara δ t t δ is the time of simulation t s is the control time ψ 0 is the intended course sf is the steering frequency and ara is the amplitude of rudder angle mcd can evaluate the overall control deviation of the controller and tsf can analyze the overall steering frequency and msa can be used to evaluate the overall steering amplitude to analyze the energy output of the control system 5 3 1 simulation experiments of nonlinear nomoto model in normal sea states in most cases yupeng is navigating under the sea states where the wave strength blows beaufort no 6 therefore the interference of wind and wave in beaufort no 6 is applied to simulate the navigation condition in normal sea states set the initial course 000 the intended course 080 and the time of simulation 600s the results of the control effect and the steering condition of linear feedback controller time delay model controller and zoh nonlinear feedback controller are respectively shown in fig 10 and fig 11 the quantitative analysis of simulation results is shown in table 1 in normal sea states the linear feedback controller has good control accuracy but the settling time of it is long the control accuracy of zoh nonlinear feedback controller is better than linear feedback controller the control accuracy of time delay model controller is a little worse than linear feedback controller for the output rudder angle the linear feedback controller has large rudder angle and high steering frequency which is inconsistent with navigation practice the rudder angle of time delay model controller is the lowest among three controllers msa is 44 7 lower than that of the linear feedback controller and the frequency is moderate the rudder angle of zoh nonlinear feedback controller is moderate and msa is 33 8 lower than that of the linear feedback controller and the steering frequency of it is the lowest among three controllers which is more consistent with navigation practice 5 3 2 simulation experiments of nonlinear nomoto model in heavy sea states in actual situations when yupeng is navigating in heavy sea states the interference of wind and wave is usually around the strength of beaufort no 8 at that time the amplitude of yawing and rolling motion is large which makes it challenging to maintain the ship course around the setting course and in navigation practice most of ship companies stipulate that if the strength of wind and wave is stronger than beaufort no 8 the use of autopilot should be stopped and let helmsman control the sailing of ship under captain s command therefore the interference of wind and wave in beaufort no 8 is applied to carry out the simulation experiments set the initial course 000 the intended course 080 and the simulation time is 800s the results of control effect and the steering condition of three controllers are respectively shown in fig 12 and fig 13 the quantitative analysis of simulation results is shown in table 2 in heavy sea states the course control effect of linear feedback controller is poor the rudder angle and the steering frequency are inconsistent with the navigation practice at this time the linear feedback controller does not satisfy the requirements of navigation the time delay model controller has a longer settling time the msa of it is the smallest among three controllers compared with the linear feedback controller the msa of time delay model controller decreases 52 9 and the tsf of it decreases 65 1 but the course keeping accuracy of it is not satisfactory the zoh nonlinear feedback controller has the shortest settling time and the course keeping control accuracy of it is the highest among three controllers the msa of zoh nonlinear feedback controller decreases 40 4 and the tsf of it decreases 81 4 the rudder angle and the steering frequency are ideal therefore in heavy sea states the course keeping control effect and steering condition of zoh nonlinear feedback controller meet the navigation requirements since the superstructure of yupeng is large and the deck of yupeng is usually loaded with large machinery in routine transport arrangements the value of stability arm gm is small when plenty of deck cargoes are loaded therefore in heavy sea states the steering frequency and the steering amplitude of zoh nonlinear feedback controller are small in the premise of good control performance which can effectively reduce the rolling motion due to the frequent large rudder angle is avoided and make the ship safer to sail 5 4 simulation experiments of mmg model in order to make the results of simulation experiments more accurate the mmg model with higher accuracy is applied in simulation research the mmg model is a set of systematic analytical ship motion models developed by the mathematical model group of ship steering movement of japan in mmg model the hydrodynamic forces and moments that act on the hull are decomposed into the hydrodynamic forces and moments acting on the naked hull the open water propeller and the open water rudder according to the physical meaning then the mutual influence of them is considered to calculate the hydrodynamic forces and moments that interfere with each other the mmg model of ship is shown in equation 51 51 m m x u m m y v r m x g r 2 x h x p x r m m y v m m x u r m x g r y h y p y r i z z j z z r m x g v u r n h n p n r ψ r x 0 u cos ψ v sin ψ y 0 v cos ψ u sin ψ in equation 51 u v x 0 y 0 n are respectively the linear velocity angular velocity position and the propeller revolving speed m x m y j z z are the additional mass and additional moment of inertia x h y h n h x p y p n p x r y r n r are the hydrodynamic forces and moments acting on the hull propeller and rudder the relevant non dimensional hydrodynamic coefficients for ship yupeng are listed in table 3 more details about the specific calculation formula can be found in jia and yang 1999 and peng et al 2016 5 4 1 simulation experiments of mmg model in normal sea states the interference of wind and wave in beaufort no 6 is applied to simulate the navigation condition in normal sea states then evaluate the control performance and steering condition of course keeping controllers together with the results from the simulation experiments of nonlinear nomoto model the control effect and steering condition of three controllers are respectively shown in fig 14 and fig 15 and the quantitative analysis of simulation results is shown in table 4 in normal sea states the control accuracy of linear feedback controller is good but the settling time of it is long and the steering frequency of linear feedback controller is high which is inconsistent with navigation practice the control effect of time delay model controller is relatively poor and the settling time of it is longer than that of zoh nonlinear feedback controller zoh nonlinear feedback controller has a satisfactory control effect and the settling time of it is the shortest among three controllers compared with linear feedback controller the msa and tsf of time delay controller are respectively reduced by 35 9 and 58 8 the msa and tsf of zoh nonlinear feedback controller are respectively decreased by 19 6 and 77 0 therefore the control effect and the steering condition of zoh nonlinear feedback controller are more consistent with navigation practice 5 4 2 simulation experiments of mmg model in heavy sea states the interference of wind and wave in the strength of beaufort no 8 is applied to carry out the simulation experiments for yupeng in heavy sea states course control effect and steering condition of three controllers are shown in fig 16 and fig 17 the quantitative analysis of simulation results is shown in table 5 in heavy sea states the course keeping accuracy of linear feedback controller is poor the rudder angle is large and the steering frequency is too high which does not meet the requirements of navigation practice the settling time of time delay model controller is good and the rudder angle of time delay model controller is the smallest the msa and tsf of time delay model controller are respectively decreased by 41 2 and 52 6 than linear feedback controller and it has a moderate steering frequency but the control accuracy is a little poor zoh nonlinear feedback controller has the shortest settling time and the course keeping accuracy of it is the best among three controllers which satisfies the requirements of navigation practice and the msa and tsf of it are respectively reduced by 30 5 and 73 5 than linear feedback controller it has the satisfying control accuracy and steering condition in heavy sea states 5 4 3 the comparison between zoh nonlinear feedback and sine function nonlinear feedback a comparison with the sine function nonlinear feedback control algorithm in zhang and zhang 2016 is carried out to research further the performance and steering condition of zoh nonlinear feedback control algorithm the simulation experiments of two kinds of nonlinear feedback control algorithms in the normal and heavy sea states are respectively carried out the course keeping control effects and steering conditions of two nonlinear feedback controllers in normal sea states are shown in fig 18 and fig 19 and the quantitative analysis of simulation results is shown in table 6 in normal sea states the sine function nonlinear feedback controller has a shorter settling time and the control accuracy of it is better the rudder angle of it is satisfactory but the frequency of steering is high the control performance of zoh nonlinear feedback controller is a little poor in the other hand in the case of lower rudder angle the steering frequency of it is decreased by 68 0 than sine function nonlinear feedback controller which means that the steering condition of it is more consistent with navigation practice the control effects and steering conditions of two nonlinear feedback controllers in heavy sea states are respectively shown in fig 20 and fig 21 the quantitative analysis of simulation results is shown in table 7 in heavy sea states the settling time of sine function nonlinear feedback controller is shorter but the steering frequency of it is higher zoh nonlinear feedback controller has a longer settling time and the control accuracy of it is similar to that of the sine function nonlinear feedback controller under the condition of lower rudder angle and more satisfactory steering frequency the msa and tsf of zoh nonlinear feedback controller are respectively decreased by 23 9 and 64 3 compared with that of the sine function nonlinear feedback controller in general the sine function nonlinear feedback controller has a shorter settling time and in normal sea states the control performance of the sine function nonlinear feedback controller is better on the other hand the steering condition of zoh nonlinear feedback controller is more satisfactory to the requirements of navigation practice especially the steering frequency of it and in heavy sea states zoh nonlinear feedback controller has a better control performance and it can make ship sail safer by the lower rudder angle and steering frequency 6 conclusion in this paper a nonlinear course keeping control algorithm is designed to make the steering conditions meet the requirements of navigation practice and enhance the robustness the nonlinear zoh nomoto ship model is constructed and the zoh model controller is proposed based on it then the control error between the reference input and the output is modified by a power function nonlinear feedback component instead of the original linear feedback the describing function method and nyquist criterion are used to analyze the stability of the closed loop system the results from simulation experiments show that the steering amplitude and steering frequency of the designed nonlinear couse keeping control algorithm are significantly decreased in normal sea states and the designed control algorithm can still ensure good control accuracy in heavy sea states meanwhile the steering condition of it satisfies the requirements of navigation practice which improves the safety of ship under the premise of ensuring the control accuracy compared with the existing sine function course keeping nonlinear feedback control algorithm the designed control algorithm has better control accuracy in heavy sea states the steering amplitude and steering frequency of the designed control algorithm are respectively decreased by 23 9 and 64 3 in heavy sea states on the other hand it is also found that although the designed course keeping control algorithm has higher accuracy in heavy sea states and a satisfactory steering condition the settling time of it is longer than that of the existing sine function nonlinear feedback controller it presents a challenge for further improvement of response speed and the control accuracy in normal sea states credit authorship contribution statement zhaokun yan conceptualization methodology software investigation visualization writing original draft xianku zhang conceptualization validation formal analysis software huiying zhu writing review editing zheng li software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement much appreciation to each reviewer for the valuable comments and suggestions to improve the quality of this note this work is partially supported by the national natural science foundation of china grant no 51679024 the fundamental research funds for the central universities grant no 3132016315 and the university 111 project of china grant no b08046 
21788,course keeping control is the core of automatic navigation for ships in marine transportation to optimize the steering conditions of course keeping controller and enhance its robustness in heavy sea states a new nonlinear course keeping control algorithm is designed with power function nonlinear feedback and zoh model controller take the new generation of teaching training vessel yupeng from dalian maritime university as the research plant and the nonlinear nomoto ship model with a zero order holder component is constructed to design the zoh model controller then the deviation signal from the closed loop system is modified by a power function nonlinear feedback component to reduce the control output the stability of the closed loop system is analyzed by the describing function method and nyquist criterion the simulation experiments in normal sea states and heavy sea states are respectively carried out to verify the control performance the simulation experiments show that the performance of this nonlinear course keeping control algorithm is satisfactory which can still be effective in heavy sea states the steering frequency is reduced significantly and the steering condition of the controller meets the requirements of navigation practice the nonlinear course keeping control algorithm is more suitable for the navigation practice and engineering application keywords course keeping marine transportation heavy sea nonlinear feedback zero order holder navigation practice 1 introduction marine transportation is a significant mode of transportation and more than 70 of cargo in international trade is transported by ships one of the research hot spots in the field of transportation is to improve the efficiency of marine transportation and ship motion control is the most effective means due to the uncertainty of external disturbance such as wind wave current and so on a ship always presents a nonlinear motion fossen 2002 ship is a sizeable inertial system whose response to the control rudder angle is slow so that the motion of ship is not easy to change and the control period is extended in navigation practice frequent large rudder angle can cause the course of ship to oscillate continuously near the planned course moreover it can also result in a larger rolling amplitude in heavy sea states it is always a hot issue in the field of ship motion control to realize accurate and stable course keeping control with smaller rudder angle and lower steering frequency based on the course keeping control algorithm aarsaether and moan 2010 fossen 2011 johansen and fossen 2013 in recent years with the development of control theory and technology many linear or nonlinear control algorithms have been applied to ship motion control peng et al 2017 dai et al 2016 most of the feedback signals in these control algorithms are linear feedback signals where the unit negative feedback is the most when the ship is at sea its course will frequently change due to the changing disturbance of wind and wave and most of the linear feedback course keeping control algorithms have some deficiencies such as large rudder angle and high steering frequency which is inconsistent with navigation practice tu 2008 zenon 2014 an adaptive neural network control algorithm had been used in lin and miao 2014 and the effect of course keeping control was good but the rudder angle was large and the frequency of steering was high research of second order nonlinear multi agent system had been carried out in wang et al 2015 the rudder angle of it was reduced but the steering frequency was still too high the simulation control of two vessels based on rbf neural network had been carried out in liu and guo 2013 the rudder angle of it was steered frequently within the range of 0 3 deficiencies of linear feedback course keeping control algorithms that may be deemed to pose a danger to the new marine objective of international maritime organization include the following 1 unstable navigation in heavy sea states 2 inefficient shipping caused by large rudder angle and high steering frequency aiming at the deficiencies of some linear feedback control algorithms a nonlinear feedback control algorithm was put forward in zhang and zhang 2016 by using the sine function nonlinear feedback method the course deviation in which was modified in a nonlinear way which effectively reduced the rudder angle and the steering frequency was optimized to a certain extent zhang et al 2017 had combined the nonlinear feedback theory with backstepping control theory and established the ship course keeping control algorithm that satisfied the lyapunov stability theory in which the procedure of nonlinear controller design had been reduced from two steps to one step fan et al 2018 had successfully applied the nonlinear feedback control theory to the course keeping control of usv based on the above research this paper proposes a new course keeping control algorithm with power function nonlinear feedback and zoh component the main contributions are mainly twofold 1 in order to make the ship model more accurate a nonlinear zoh nomoto ship model is constructed furthermore a zoh model controller is designed based on the nonlinear zoh nomoto ship model which makes the controller catch the zero order holder component better 2 a power function nonlinear feedback module is applied to deal with the error signal then the zoh model nonlinear feedback algorithm is established the stability of the whole system is analyzed by the describing function method and the nyquist criterion 2 preparation work 2 1 the nonlinear feedback control system the block diagram of a nonlinear feedback control system is shown in fig 1 in a nonlinear feedback control system r is the input signal y is the output signal the deviation signal is represented by e r y and the nonlinear feedback algorithm is represented by m g e the nonlinear feedback controller consists of controller k and the nonlinear feedback module m δ is the output of the controller g is the model of controlled plant and d represents the external disturbance the output of a linear feedback controller is δ f e e contrary to the linear feedback system the output of a nonlinear feedback controller is δ f e g e the difference between the outputs of two controllers is that a nonlinear feedback algorithm g e is used by the nonlinear feedback system to replace the deviation signal e of the linear feedback system and the control law f e of the nonlinear controller is still the same the purpose of this method is to reduce the output energy of the system when the control effect is similar or improve the control effect in large disturbance conditions 2 2 signal processing of time delay and zero order hold the phenomenon of time delay is quite common in practical engineering there are a large number of time delay models in the industry such as the distillation tower vibration isolator water tank and magnetic levitation many published literature such as lei and guo 2015 zhao et al 2007 zhang et al 2014 zhang et al 2016 and yang et al 2015 had carried out some research about time delay models in navigation practice due to the characteristics of inertia there exists a certain delay from the time when the rudder angle is given by the controller to the moment that the response of the steering engine is completed take the steering order signal with sinusoidal variation as an example the comparison of the results after the time delay and zero order hold processing is shown in fig 2 in some engineering fields the reasonable application of the controller with a time delay module can improve the performance of the control system however the course of a ship that affected by the continually changing disturbance can frequently change at sea which can cause the course keeping controller to provide various steering orders too frequently as shown in fig 2 time delay processing only lags the output of signal in time domain but the frequency and amplitude of the signal have not changed therefore it cannot avoid frequent steering which does not satisfy the requirements of navigation practice different from time delay processing as shown by the solid line in fig 2 the controller with a signal holding component can hold the same control output for a short period of time this character not only reflects the time of signal delay between the controller and the steering engine but also reduces the steering frequency which meets the requirements of navigation practice 3 controller design 3 1 linear feedback controller the second order nonlinear responding nomoto ship model is 1 ψ k 0 t 0 α ψ β ψ 3 k 0 t 0 δ where α and β are the proportional coefficients of yaw rate ψ and can be identified by the least square method a linear approximation for equation 1 is carried out and the derived transfer function is 2 g ψ δ s ψ δ k 0 s t 0 s 1 based on closed loop gain shaping algorithm zhang and zhang 2013 the ship course keeping controller k is designed under the following three conditions 1 set the bandwidth frequency of the closed system to 1 t 1 2 let the high frequency asymptote slope be 20db dec for the controller design 3 the frequency spectrum of the closed loop system is made equal to the frequency spectrum of a first order inertial system with the largest singular value approximately to one then the course keeping controller k 1 is 3 k 1 s 1 k 0 t 1 ρ p i d ε k 0 t 1 1 s t 0 k 0 t 1 s since the inertia of ship is large and the control time is long a small constant ρ p i d is added to improve the response speed of the control system zhang and zhang 2016 and ρ p i d is usually 2 6 ε is a small constant which is used to eliminate the static difference caused by closed loop gain shaping algorithm 3 2 time delay model controller according to zhang 2011 a nonlinear ship model with time delay component is 4 g 1 s k 0 e θ 1 s s t 0 s 1 use the expansion of first order taylor series we can get e θ 1 s 1 θ 1 s and equation 4 can be written as 5 g 1 s k 0 1 θ 1 s s t 0 s 1 theorem 1 maximum modulus theorem assume that f s is a function that has no poles in ω if f s is not a constant then f s does not attain its maximum value at an interior point of ω let ω equal the open right half plane and w 1 s s 1 s denotes the transfer function from the normalized disturbance to the system output w 1 s is the weight function which has no poles in ω and s 1 s is the sensitivity function 6 w 1 s s 1 s w 1 s 1 g 1 s q 1 s sup re s 0 w 1 s 1 g 1 s q 1 s the transfer function g 1 s has a zero point at s 1 θ 1 in the open right half plane and s 1 θ 1 is in the region ω according to theorem 1 7 sup re s 0 w 1 s 1 g 1 s q 1 s w 1 s 1 g 1 s q 1 s s 1 θ 1 θ 1 the minimum value of w 1 s s 1 s which can be obtained from equation 7 is θ 1 assuming that the system input is a step signal 1 s the disturbance at the plant output is d s then the weight function w 1 s should satisfy d s w 1 s 2 1 in the h robust control w 1 s is taken as 1 s substituting equation 6 into equation 7 and minimizing the left hand side of the equation yields 8 w 1 s 1 g 1 s q 1 s 1 s 1 k 0 1 θ 1 s s t 0 s 1 q 1 s θ 1 in this case the unique optimal solution is 9 q o p t 1 s t 0 s 2 s k 0 since the asymptotic tracking property requires that lim s 0 1 g 1 s q 1 s 0 the following filter is introduced to roll q o p 1 s off at high frequency 10 j 1 s 1 ϕ s 1 2 then add the filter and a proper q 1 can be obtained 11 q 1 s q o p t 1 s j 1 s t 0 s 2 s k 0 1 ϕ s 1 2 the time delay unity feedback controller is 12 k 2 s q 1 s 1 g 1 s q 1 s 1 k 0 t 0 s 1 ϕ 2 s 2 ϕ θ 1 based on navigation practice we add a no steering component in small course deviation ξ in front of the time delay model controller the time delay coefficient θ 1 10 s parameter ϕ is usually equal to 0 5 θ 1 2 0 θ 1 and ξ is 1 the time delay model controller k 2 is used to provide a comparison in the simulation experiments 3 3 zoh nonlinear feedback controller the nonlinear nomoto ship model with zoh component is 13 g 2 s k 0 1 e θ 2 s s t 0 s 1 expend 1 e θ 2 s s into a power series and obtain the first two terms of it 14 1 e θ 2 s s 1 s 1 1 e θ 2 s θ 2 1 θ 2 s substitute equation 14 into equation 13 15 g 2 s k 0 θ 2 t 0 s 1 1 θ 2 s let ω equal the open right half plane and w 2 s s 2 s denotes the transfer function from the normalized disturbance to the system output 16 w 2 s s 2 s w 2 s 1 g 2 s q 2 s sup re s 0 w 2 s 1 g 2 s q 2 s w 2 s is taken as 1 s and the minimum value of w 2 s s 2 s needs to be asymptotically convergent 17 lim s 0 s 2 s lim s 0 1 g 2 s q 2 s 0 in this case the unique optimal solution is 18 q o p t 2 s t 0 s 1 1 θ 2 s k 0 θ 2 the following filter is introduced to roll q o p t 2 s off at high frequency 19 j 2 s 1 0 01 λ s 1 0 6 λ s 1 2 λ s 1 1 a proper q 2 s can be obtained 20 q 2 s q o p t 2 s j 2 s t 0 s 1 1 θ 2 s k 0 θ 2 0 01 λ s 1 0 6 λ s 1 2 λ s 1 1 the zoh unity feedback controller is 21 k 3 s 1 k 0 θ 2 t 0 s 1 1 θ 2 s s 0 012 λ 3 s 2 1 226 λ 2 s 2 61 λ 1 the power function nonlinear feedback module m μ e 0 6 is added after the unit feedback signal where the unit feedback signal e is substituted by e 0 6 a no steering component in small course deviation within ξ is added in front of the nonlinear feedback module combined with the zoh model controller and zoh component a zoh model power function nonlinear feedback controller is formed and the block diagram is shown as fig 3 the coefficient θ 2 of zero order holder usually equals to 5 15s parameter λ generally equals to 0 5 θ 2 2 0 θ 2 the coefficient μ of power function nonlinear feedback module is 0 1 0 5 and ξ is usually equal to 0 5 1 4 the effect of power function nonlinear feedback to control system the input and output of the nonlinear feedback can be described as 22 y f x μ x 0 6 when the input signal of nonlinear feedback is a sinusoidal signal x t a sin ω t 23 y t μ a sin ω t 0 6 harmonic analysis is carried out for the steady output y t of the nonlinear feedback typically y t is a non sinusoidal periodic signal expand y t into the fourier series and take the first harmonic component 24 y t a 0 a 1 cos ω t b 1 sin ω t a 0 is the direct current component a 1 and b 1 are the first harmonic components 25 a 0 1 2 π 0 2 π y t d ω t a 1 1 π 0 2 π y t cos ω t d ω t b 1 1 π 0 2 π y t sin ω t d ω t under the impact of sinusoidal input signal x t asin ω t the describing function of nonlinear feedback is a complex ratio between the first order harmonic component and the input signal where the first harmonic component is from the steady output signal in nonlinear feedback and the describing function can be expressed as n a 26 n a n a e j n a b 1 j a 1 a the nonlinear feedback control system can be expressed in fig 4 the first harmonic components of a 1 and b 1 can be calculated as follows 27 a 1 1 π 0 2 π μ a sin ω t 0 6 cos ω t d ω t μ a 0 6 π sin ω t 1 6 1 6 0 2 π 0 28 b 1 1 π 0 2 π y t sin ω t d ω t μ a 0 6 π 0 2 π sin ω t 1 6 d ω t the sin ω t can be expanded by taylor series and retain it to the 9 t h order 29 sin ω t ω t ω t 3 3 ω t 5 5 ω t 7 7 ω t 9 9 set τ μ a 0 6 π and substitute equation 29 into equation 28 then 30 b 1 τ 0 2 π ω t 1 6 1 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 1 6 d ω t set z ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 and expand 1 z 1 6 by taylor series and retain it to 2 n d order 31 1 z 1 6 1 1 6 z 1 6 0 6 2 z 2 substitute equation 31 into equation 30 and calculate the result of integral 32 b 1 τ 0 2 π ω t 1 6 1 1 6 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 0 48 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 2 d ω t τ 6 4277 6 4277 μ a 0 6 π the describing function of nonlinear feedback is 33 n a b 1 j a 1 a 6 4277 μ a 0 6 π a 4 1 effect on the dynamic performance of the closed loop system according to fig 4 the transfer function of the nonlinear feedback control system from the input r i e the intended course to the output y of the system i e the heading angle ψ is 34 y r g k n a 1 g k n a for the ship course keeping problem the frequency spectrum of wave interference lies in the range of 0 3 1 25 rad s the bandwidth frequency of the closed loop system is usually set at 1 t 1 0 3 rad s to shy away from the wave frequency spectrum in navigation practice the course changing range is between 0 2 π rad therefore 0 n a 1 according to closed loop gain shaping theory the open loop transfer matrix gk satisfies robust performance in the low frequency zone and robust stability in the high frequency zone zhang 2012 the comparison between the transfer function of equation 34 and the closed loop transfer function of the standard feedback system in low frequency range shows that the introduction of n a has less effect on the dynamic performance of the closed loop system therefore the control system can have better stabilizing performance and robustness can be obtained by selecting the proper parameters 4 2 effect on the output of the closed loop system the transfer function from the input r to the output δ of the controller i e the rudder angle is 35 δ r k n a 1 g k n a k has a large first order gain and gk has a large second order gain hu 2013 similar analysis as for equation 34 can proceed to represent that the introduction of n a can bring about the benefit of reducing the output of the controller moreover the power function y μ x 0 6 can make the maximum and minimum values of the error which is the input signal of the controller within 1 when the coefficient μ is 0 1 0 5 a similar processing technique can be seen in fuzzy control neural network and optimized genetic algorithms 4 3 proof for the stability of the whole nonlinear feedback control system combine the modules k and g in fig 4 and then the equivalent diagram is shown in fig 5 c s is the equivalent form after the combination of module k and g 36 c s 1 0 01 λ s 1 0 6 λ s 1 2 λ s 1 it can be seen that the poles of c s are all located in the left half part of s plane thus c s has low pass characteristics when the nonlinear characteristics of the control system are approximately equivalent to the describing function the characteristic equation of the closed loop system is 37 1 n a c j ω 0 from equation 37 we can know that 38 c j ω 1 n a where 1 n a is the negative inverse describing function of the nonlinear part a shown in fig 6 the nyquist curve γ g and the curve of 1 n a are plotted in the complex plane according to nyquist criterion 1 if the curve of γ g encircles the curve of 1 n a the system is unstable at that time 2 the system is stable if the curve of γ g does not enclose the curve of 1 n a 3 if the curve γ g intersects curve 1 n a which means there is a real solution of ω in equation 37 the stability of the system and the stability of the periodic motion must be analyzed separately hu 2013 therefore the curve γ g does not enclose the curve of 1 n a and the whole system is stable 5 simulation research 5 1 simulation of steering engine characteristics the steering servo system usually regards as a first order inertial component in the modeling of ship motion control in fact the steering servo system is an electro hydraulic system with pure delay dead zone hysteresis saturation and other nonlinear characteristics zhang 2012 the steering servo system of each ship is different due to the differences among different parameters from ships and steering engines therefore in order to set up a steering servo system which is consistent with navigation practice the parameters of the steering servo system must be adjusted according to the characteristic of the real ship add the no steering component in small rudder order inertial module rudder angle saturation component and maximum rudder speed limit component into the steering servo system parameters of each component are set according to the actual character of the ship and the improved steering servo simulation system is shown in fig 7 for ship yupeng the small rudder order that the steering gear does not respond is within 0 3 the inertial module is the first order inertial module represented as 1 t r s 1 and the inertia time coefficient of the steering gear is t r 2 1s the rudder angle saturation limit is 35 and the maximum speed of steering gear is 2 55 s in single pump operation because the steering gear of yupeng has a low hydraulic pump power which increases the inertia coefficient of the steering gear and the maximum steering speed of yupeng is decreased the above reasons increase the difficulty of course keeping control the improved steering engine system is respectively combined with the time delay model controller and the zoh model nonlinear feedback controller to carry out the following simulation experiments together with the linear feedback control system which still uses the traditional steering engine system 5 2 simulation of wind and wave in the process of navigation the disturbance of wind and wave is the leading cause of the deviation for ships the disturbance of wind can be divided into average wind and random wind the average wind can generate a leeway and according to jia and zhang 2015 it can be treated equivalently to an equivalent rudder angle that acts on the hull based on kallstrom 1982 the random wind can be considered as the realization of some white noise whose deviation is proportional to the square of absolute wind speed v t 39 σ y 0 2 ρ a v t 2 c y γ r l 2 σ n 0 2 ρ a v t 2 c n γ r l 3 ρ a is the air density c y γ r and c n λ r are respectively the dimensionless coefficients of wind force and wind torque l is the length of the ship in the field of course keeping control the influence of wave can be approximated by a second order system in the dof around the z axis a linear approximation of ittc wave spectral density function is yang et al 2001 40 y s h s ω s ω s is the zero mean gaussian white noise and its power spectral density is 1 0 h s is the second order transfer function of the wave 41 h s 2 ζ ω 0 σ ω s s 2 2 ξ ω 0 s ω 0 2 where σ ω is a coefficient to describe the strength of the wave ζ is the damping coefficient and ω 0 is the dominant frequency of the wave therefore substitute s j ω into equation 41 and we can get 42 h j ω 2 ζ ω 0 σ w ω j ω 0 2 ω 2 2 ζ ω 0 ω j the amplitude of h j ω is 43 h j ω 2 ζ ω 0 σ w ω ω 0 2 ω 2 2 4 ζ ω 0 ω 2 the spectral density function of y j ω is 44 g y y ω h j ω 2 g w w ω h j ω 2 1 0 4 ζ ω 0 σ w 2 ω 2 ω 0 2 ω 2 2 4 ζ ω 0 ω 2 when ω is equal to the dominant wave frequency ω 0 at that time the maximum of g y y ω is 45 max g y y ω g y y ω 0 σ w 2 when the wave is in the same conditions the dominant wave frequency of the wave in y s should be equal to the modal frequency in the ittc spectrum therefore the dominant frequency of the wave is 46 ω 0 4 4 5 691 t w 4 4 85 t w t w is the period of wave and the value of σ w is σ w h 1 3 0 0185 t w which equals the value of the mpm power spectrum in the same ω 0 47 g y y ω 0 173 h 1 3 2 4 85 t w 5 t w 4 e 691 t w 4 4 85 t w 4 0 0185 t w h 1 3 2 the transfer functions of wave disturbance in beaufort no 6 and beaufort no 8 wind are guan 2010 48 h 1 s 0 4198 s s 2 0 3638 s 0 3675 h 2 s 1 3353 s s 2 0 5153 s 0 2655 the power spectral density functions of the wave in beaufort no 6 and beaufort no 8 are 49 g y y 1 ω 0 1762 ω 2 0 3675 ω 2 2 0 1323 ω 2 g y y 2 ω 1 7608 ω 2 0 2606 ω 2 2 0 2606 ω 2 based on the power spectral density functions in eq 49 the three dimensional views of wave interference under the effect of winds in beaufort no 6 and beaufort no 8 are respectively shown in fig 8 and fig 9 5 3 simulation experiments of nonlinear nomoto model the teaching training vessel yupeng is taken as the simulation plant because the maneuverability of yupeng in the full loaded condition is poor therefore the second order nonlinear nomoto model of yupeng in the full loaded condition is used and the improved steering engine simulation system is adopted to carry out the simulation experiments based on the actual situation and in order to ensure the safety of navigation the rudder angle saturation is limited at 25 in time delay nonlinear feedback controller parameter ϕ 1 5 θ 1 and in zoh nonlinear feedback controller the coefficient μ 0 22 λ 0 8 θ 2 in order to analyze the comprehensive performance and the robustness of ship course keeping controller the simulation research for yupeng is carried out respectively under normal sea states and heavy sea states three evaluation indexes as mean course deviation mcd total steering frequency tsf and mean steering amplitude msa are introduced to analyze the simulation results quantitatively 50 mcd 1 t δ t s σ ψ t ψ 0 tsf σ sf δ t msa 1 tsf σ ara δ t t δ is the time of simulation t s is the control time ψ 0 is the intended course sf is the steering frequency and ara is the amplitude of rudder angle mcd can evaluate the overall control deviation of the controller and tsf can analyze the overall steering frequency and msa can be used to evaluate the overall steering amplitude to analyze the energy output of the control system 5 3 1 simulation experiments of nonlinear nomoto model in normal sea states in most cases yupeng is navigating under the sea states where the wave strength blows beaufort no 6 therefore the interference of wind and wave in beaufort no 6 is applied to simulate the navigation condition in normal sea states set the initial course 000 the intended course 080 and the time of simulation 600s the results of the control effect and the steering condition of linear feedback controller time delay model controller and zoh nonlinear feedback controller are respectively shown in fig 10 and fig 11 the quantitative analysis of simulation results is shown in table 1 in normal sea states the linear feedback controller has good control accuracy but the settling time of it is long the control accuracy of zoh nonlinear feedback controller is better than linear feedback controller the control accuracy of time delay model controller is a little worse than linear feedback controller for the output rudder angle the linear feedback controller has large rudder angle and high steering frequency which is inconsistent with navigation practice the rudder angle of time delay model controller is the lowest among three controllers msa is 44 7 lower than that of the linear feedback controller and the frequency is moderate the rudder angle of zoh nonlinear feedback controller is moderate and msa is 33 8 lower than that of the linear feedback controller and the steering frequency of it is the lowest among three controllers which is more consistent with navigation practice 5 3 2 simulation experiments of nonlinear nomoto model in heavy sea states in actual situations when yupeng is navigating in heavy sea states the interference of wind and wave is usually around the strength of beaufort no 8 at that time the amplitude of yawing and rolling motion is large which makes it challenging to maintain the ship course around the setting course and in navigation practice most of ship companies stipulate that if the strength of wind and wave is stronger than beaufort no 8 the use of autopilot should be stopped and let helmsman control the sailing of ship under captain s command therefore the interference of wind and wave in beaufort no 8 is applied to carry out the simulation experiments set the initial course 000 the intended course 080 and the simulation time is 800s the results of control effect and the steering condition of three controllers are respectively shown in fig 12 and fig 13 the quantitative analysis of simulation results is shown in table 2 in heavy sea states the course control effect of linear feedback controller is poor the rudder angle and the steering frequency are inconsistent with the navigation practice at this time the linear feedback controller does not satisfy the requirements of navigation the time delay model controller has a longer settling time the msa of it is the smallest among three controllers compared with the linear feedback controller the msa of time delay model controller decreases 52 9 and the tsf of it decreases 65 1 but the course keeping accuracy of it is not satisfactory the zoh nonlinear feedback controller has the shortest settling time and the course keeping control accuracy of it is the highest among three controllers the msa of zoh nonlinear feedback controller decreases 40 4 and the tsf of it decreases 81 4 the rudder angle and the steering frequency are ideal therefore in heavy sea states the course keeping control effect and steering condition of zoh nonlinear feedback controller meet the navigation requirements since the superstructure of yupeng is large and the deck of yupeng is usually loaded with large machinery in routine transport arrangements the value of stability arm gm is small when plenty of deck cargoes are loaded therefore in heavy sea states the steering frequency and the steering amplitude of zoh nonlinear feedback controller are small in the premise of good control performance which can effectively reduce the rolling motion due to the frequent large rudder angle is avoided and make the ship safer to sail 5 4 simulation experiments of mmg model in order to make the results of simulation experiments more accurate the mmg model with higher accuracy is applied in simulation research the mmg model is a set of systematic analytical ship motion models developed by the mathematical model group of ship steering movement of japan in mmg model the hydrodynamic forces and moments that act on the hull are decomposed into the hydrodynamic forces and moments acting on the naked hull the open water propeller and the open water rudder according to the physical meaning then the mutual influence of them is considered to calculate the hydrodynamic forces and moments that interfere with each other the mmg model of ship is shown in equation 51 51 m m x u m m y v r m x g r 2 x h x p x r m m y v m m x u r m x g r y h y p y r i z z j z z r m x g v u r n h n p n r ψ r x 0 u cos ψ v sin ψ y 0 v cos ψ u sin ψ in equation 51 u v x 0 y 0 n are respectively the linear velocity angular velocity position and the propeller revolving speed m x m y j z z are the additional mass and additional moment of inertia x h y h n h x p y p n p x r y r n r are the hydrodynamic forces and moments acting on the hull propeller and rudder the relevant non dimensional hydrodynamic coefficients for ship yupeng are listed in table 3 more details about the specific calculation formula can be found in jia and yang 1999 and peng et al 2016 5 4 1 simulation experiments of mmg model in normal sea states the interference of wind and wave in beaufort no 6 is applied to simulate the navigation condition in normal sea states then evaluate the control performance and steering condition of course keeping controllers together with the results from the simulation experiments of nonlinear nomoto model the control effect and steering condition of three controllers are respectively shown in fig 14 and fig 15 and the quantitative analysis of simulation results is shown in table 4 in normal sea states the control accuracy of linear feedback controller is good but the settling time of it is long and the steering frequency of linear feedback controller is high which is inconsistent with navigation practice the control effect of time delay model controller is relatively poor and the settling time of it is longer than that of zoh nonlinear feedback controller zoh nonlinear feedback controller has a satisfactory control effect and the settling time of it is the shortest among three controllers compared with linear feedback controller the msa and tsf of time delay controller are respectively reduced by 35 9 and 58 8 the msa and tsf of zoh nonlinear feedback controller are respectively decreased by 19 6 and 77 0 therefore the control effect and the steering condition of zoh nonlinear feedback controller are more consistent with navigation practice 5 4 2 simulation experiments of mmg model in heavy sea states the interference of wind and wave in the strength of beaufort no 8 is applied to carry out the simulation experiments for yupeng in heavy sea states course control effect and steering condition of three controllers are shown in fig 16 and fig 17 the quantitative analysis of simulation results is shown in table 5 in heavy sea states the course keeping accuracy of linear feedback controller is poor the rudder angle is large and the steering frequency is too high which does not meet the requirements of navigation practice the settling time of time delay model controller is good and the rudder angle of time delay model controller is the smallest the msa and tsf of time delay model controller are respectively decreased by 41 2 and 52 6 than linear feedback controller and it has a moderate steering frequency but the control accuracy is a little poor zoh nonlinear feedback controller has the shortest settling time and the course keeping accuracy of it is the best among three controllers which satisfies the requirements of navigation practice and the msa and tsf of it are respectively reduced by 30 5 and 73 5 than linear feedback controller it has the satisfying control accuracy and steering condition in heavy sea states 5 4 3 the comparison between zoh nonlinear feedback and sine function nonlinear feedback a comparison with the sine function nonlinear feedback control algorithm in zhang and zhang 2016 is carried out to research further the performance and steering condition of zoh nonlinear feedback control algorithm the simulation experiments of two kinds of nonlinear feedback control algorithms in the normal and heavy sea states are respectively carried out the course keeping control effects and steering conditions of two nonlinear feedback controllers in normal sea states are shown in fig 18 and fig 19 and the quantitative analysis of simulation results is shown in table 6 in normal sea states the sine function nonlinear feedback controller has a shorter settling time and the control accuracy of it is better the rudder angle of it is satisfactory but the frequency of steering is high the control performance of zoh nonlinear feedback controller is a little poor in the other hand in the case of lower rudder angle the steering frequency of it is decreased by 68 0 than sine function nonlinear feedback controller which means that the steering condition of it is more consistent with navigation practice the control effects and steering conditions of two nonlinear feedback controllers in heavy sea states are respectively shown in fig 20 and fig 21 the quantitative analysis of simulation results is shown in table 7 in heavy sea states the settling time of sine function nonlinear feedback controller is shorter but the steering frequency of it is higher zoh nonlinear feedback controller has a longer settling time and the control accuracy of it is similar to that of the sine function nonlinear feedback controller under the condition of lower rudder angle and more satisfactory steering frequency the msa and tsf of zoh nonlinear feedback controller are respectively decreased by 23 9 and 64 3 compared with that of the sine function nonlinear feedback controller in general the sine function nonlinear feedback controller has a shorter settling time and in normal sea states the control performance of the sine function nonlinear feedback controller is better on the other hand the steering condition of zoh nonlinear feedback controller is more satisfactory to the requirements of navigation practice especially the steering frequency of it and in heavy sea states zoh nonlinear feedback controller has a better control performance and it can make ship sail safer by the lower rudder angle and steering frequency 6 conclusion in this paper a nonlinear course keeping control algorithm is designed to make the steering conditions meet the requirements of navigation practice and enhance the robustness the nonlinear zoh nomoto ship model is constructed and the zoh model controller is proposed based on it then the control error between the reference input and the output is modified by a power function nonlinear feedback component instead of the original linear feedback the describing function method and nyquist criterion are used to analyze the stability of the closed loop system the results from simulation experiments show that the steering amplitude and steering frequency of the designed nonlinear couse keeping control algorithm are significantly decreased in normal sea states and the designed control algorithm can still ensure good control accuracy in heavy sea states meanwhile the steering condition of it satisfies the requirements of navigation practice which improves the safety of ship under the premise of ensuring the control accuracy compared with the existing sine function course keeping nonlinear feedback control algorithm the designed control algorithm has better control accuracy in heavy sea states the steering amplitude and steering frequency of the designed control algorithm are respectively decreased by 23 9 and 64 3 in heavy sea states on the other hand it is also found that although the designed course keeping control algorithm has higher accuracy in heavy sea states and a satisfactory steering condition the settling time of it is longer than that of the existing sine function nonlinear feedback controller it presents a challenge for further improvement of response speed and the control accuracy in normal sea states credit authorship contribution statement zhaokun yan conceptualization methodology software investigation visualization writing original draft xianku zhang conceptualization validation formal analysis software huiying zhu writing review editing zheng li software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement much appreciation to each reviewer for the valuable comments and suggestions to improve the quality of this note this work is partially supported by the national natural science foundation of china grant no 51679024 the fundamental research funds for the central universities grant no 3132016315 and the university 111 project of china grant no b08046 
21789,the objective of this paper is to predict the dipole noises caused by the marine propeller of an oceanography research ship and compare the calculated results with the experimental data to verify the applied numerical method as the propellers are of free cavitation such as those of submarines at diving depth and the surface vessels operating at cruising speed the dominant noises are generated by the unsteady forces i e dipole noise studies discussing the dipole noises generated by marine propellers are rare and the measured results are always confidential for military purpose in this paper the unsteady forces were calculated by computational fluid dynamics cfd and transformed into the dipole strengths the dipole strengths were then applied in the linear wave theory to solve the radiated noises the scattered noises from the ship hull were computed by the iterating boundary element method the experiments were carried out in the underwater anechoic chamber of the cavitation tunnel in national taiwan ocean university ntou the results show that the comparisons between the numerical and experimental results are in good agreement keywords propeller dipole noise cfd linear wave theory iterating boundary element method 1 introduction a propeller operating in a non uniform wake field is the primary source of underwater noise for a ship the prediction of radiated and scattered noises due to the operating propeller in the behind hull condition is of great concern in regard to military applications marine propeller noise can be classified into cavitating and non cavitating noises as the propellers are free from cavitation such as in oceanography research ships and warships the noises generated by dipoles i e propeller unsteady forces are dominant according to the published literature the dipole noises of the marine propellers are rarely discussed and the experimental data are always kept confidential the ffowcs williams and hawkings fwh equation has been widely used in predicting the radiated noises due to the operating marine propeller for both cavitating and non cavitating conditions ref paula et al 2013 ref özden et al 2016 ref li et al 2018a and ref testa and greco 2018a the noise sources are presented as monopole i e sheet cavitation dipole i e unsteady loadings and quadrupole i e tip vortex cavitation in the fwh equation ref li et al 2015 ref lidtke et al 2016 ref li et al 2018b and ref sakamoto and kamiirisa 2018 predicted radiated noise due to the marine cavitating propeller by combining cfd computation fluid dynamics technology and the fwh model it was found that at the higher blade rate frequencies the predicted tones were lower than the sea trial data due to the insufficient resolutions for the cfd simulation according to ref seol et al 2002 the flow field was analyzed with the potential based panel method the time dependent pressures were then used as the input for fwh formulation to predict the far field acoustics i e the dipole noise at far field the delay time of wave propagation was not considered in the potential based panel method thus this method is unsuitable for near field predictions in ref ozden et al 2012 the propeller noise was studied numerically and experimentally for non cavitating conditions the hydroacoustic analysis was performed using a model based on the fwh equation the noise predictions were in a good agreement with the experimental results however for the receiver with an angle to the shaft axis the numerical scheme under predicted the noise levels ref kim et al 2014 applied the matched field inversion mfi method to determine the dipole parameters of propeller non cavitating noise in the model scale experiment the exciting force on the ship hull was then computed by the boundary element method the inversion based on the model experiment included simplified parameterization ref mousavi et al 2014 and ref du et al 2017 simulated the blade rate noise generated by the non cavitating propeller the les large eddy simulation turbulence model was recommended to calculate the hydrodynamic parameters and the fwh model was used to find the spectral distributions of flow noise for different advance coefficients ref wei et al 2016 predicted the scattered noise of a submarine hull due to the non cavitating propeller the dipole strengths of the non cavitating propeller were calculated by cfd and the scattering effect from the hull was solved by the iterating boundary element method in time domain as proposed by ref kao and kehr 2006 there were no experimental verifications in ref wei et al 2016 in this paper the method derived in ref kao and kehr 2006 will be verified by the experiments carried out in the cavitation tunnel of ntou in ref testa and greco 2018b the incident wave due to the non cavitating propeller was calculated by the 3d unsteady panel method the incident waves were then treated as the input in the frequency domain formulation based on the acoustic analogy to simulate the scattered noise by the hull the results were only compared with the analysis of the whole propeller hull configuration within the framework of potential flows and there were no experimental comparisons presently there are few published studies referring to the dipole noise of the marine propellers and most numerical schemes are modeled by the fwh equation comparisons between the numerical and experimental results are rare in this paper cfd technology and the formulations derived by ref kehr and kao 2004 are combined to solve the dipole noises radiated from the marine propeller ref kehr and kao 2004 developed a method in time domain which can calculate the acoustic pressure fields both at far and near fields induced by unsteady propeller axial thrust and tangential torque force the scattered waves from the hull are considered according to the method proposed in ref kao and kehr 2006 whose robust new method based on scattered potential in time domain can treat the multi frequency scattered waves from complex objects an oceanography research ship is treated as the calculating sample the scattered noises on the hull and the radiated noises in the fields are both computed the experiments are conducted in the underwater anechoic chamber of ntou cavitation tunnel to verify the numerical schemes used refs kao and kehr 2006 and kehr and kao 2004 in this paper 2 numerical schemes and experimental setup in this paper the unsteady forces due to the operating propeller i e the dipole strengths are predicted by cfd the dipole strengths are then treated as the noise sources in the linear wave equation to solve the radiated noises according to ref kehr and kao 2004 the scattering effect caused by the hull is considered by the iterating boundary element method in time domain ref kao and kehr 2006 2 1 propeller unsteady forces the unsteady propeller forces are investigated by using the commercial cfd software ansys fluent in order to save the computing time the sst k ω turbulent model is used first to attain the convergent results the les turbulent model suggested by ref mousavi et al 2014 and ref du et al 2017 is then applied to capture the fluctuations of the propeller unsteady forces more precisely the simple algorithm derived by ref patankar and spalding 1972 is used to solve the forces and velocities the main idea of this scheme is to update the forces and velocities by corrected terms 2 2 radiated noise caused by the non cavitating propeller the method proposed by ref kehr and kao 2004 is used to solve the propeller noise in this paper the numerical equations are indicated as follows and the detailed deriving process can be referred in ref kehr and kao 2004 as shown in fig 1 the rotating noise source with angular velocity ω is located at position vector r s x s r s θ s θ n ω t s at t s and the observer is located at position vector r x r θ r is the distance from the noise source to the observer at time t s the dipole strengths corresponding to the unsteady forces f on each blade are calculated by cfd if the propeller unsteady force is assumed to be the only noise source the governing equation of linear wave is 1 2 p l o a d 1 c 0 2 2 p l o a d t 2 s f where p l o a d is the acoustic pressure due to the unsteady propeller force s denotes the vector gradient operator in the noise source coordinates and f is the unsteady force vector per unit volume acting on the fluid the unsteady force of a propeller includes three components the axial thrust tangential torque force and radial force but the radial force will be omitted because it is much smaller than the first two the solution to equation 1 has the following form 2 p l o a d r t 1 4 π t s s s f r s t s r δ t s t r c 0 d v s d t s the total unsteady forces of a propeller at time t s can then be represented by 3 f x t s m 1 b i 1 i j 1 j t m i j t s m 1 b i 1 i j 1 j h m i j 0 q 1 h m i j q cos q ω t s θ n ε m i j q 4 f θ t s m 1 b i 1 i j 1 j q m i j t s r s m 1 b i 1 i j 1 j h m i j 0 q 1 h m i j q cos q ω t s θ n ε m i j q r s where b is the number of propeller blades t m i j t s and q m i j t s are the respective axial thrust and tangential torque acting on the i j element on the mth blade camber surface at time t s because t m i j t s and q m i j t s vary periodically they can also be expressed by the fourier series as shown in equations 3 and 4 h and h are amplitudes of the thrust and torque fourier series respectively h and h are the so called dipole strengths using gauss s theorem substituting equations 3 and 4 into equation 2 and denoting t s t r c 0 the acoustic pressures induced by the unsteady thrust and torque can be obtained as follows 5 p t r t m 1 b i 1 i j 1 j q 1 x s x q ω 4 π r 2 c 0 h m i j q sin q ω t s θ n ε m i j q x s x 4 π r 3 h m i j 0 h m i j q cos q ω t s θ n ε m i j q ω r n r x s x 4 π c 0 r 4 sin ω t s θ θ n h m i j 0 h m i j q cos q ω t s θ n ε m i j q 6 p q r t m 1 b i 1 i j 1 j q 1 q ω r 4 π r 2 r n c 0 h m i j q sin ω t s θ θ n sin q ω t s θ n ε m i j q r 4 π r n r 3 h m i j 0 h m i j q cos q ω t s θ n ε m i j q sin ω t s θ θ n ω r 2 4 π c 0 r n 4 h m i j 0 h m i j q cos q ω t s θ n ε m i j q sin 2 ω t s θ θ n p t r t is the acoustic pressure induced by the unsteady thrust of all the propeller blades p q r t is the acoustic pressure induced by the unsteady torque of all the propeller blades here it is noted that p t r t consists of three parts the first part is proportional to the ratio of x x s r 2 and depends on the factor q ω c 0 the second part is a higher order term which is proportional to the ratio of x x s r 4 the third part is relationally small for marine propellers at both near field and far field conditions because it is proportional to ω r n c 0 and decays with the ratio of r x x s r 4 as the distance r is far enough that is 1 r is much smaller than q ω c 0 the higher order term decays very fast and the acoustic pressure will be proportional to 1 r in the same direction from the propeller center to the field point at near field the second part plays an important role similarly p q r t consists of three parts the first term which is proportional to the ratio of r r 2 and depends on the factor q ω c 0 is due to the temporal variation of torque force the second term is proportional to the ratio of r r 3 and decays faster than the first term at far field the third term is also negligibly small for marine propellers both at near field and far field 2 3 scattered waves due to the hull the scattered waves were solved by the time domain iterating boundary element method introduced in ref kao and kehr 2006 the iterations for the scattered pressure in the time domain are carried out by the boundary integral equation 7 z f p t o t a l f t s p t o t a l o g f o n e i ω t ds d ω s g f o p t o t a l o e i ω t n ds d ω 4 π p i n c i d e n t p r e f l e c t a part b p a r t 4 π p i n c i d e n t p r e f l e c t p t o t a l is the total acoustic measured at the field point p t o t a l is contributed by three parts the radiated pressure due to the propeller p i n c i d e n t scattered and reflected pressures due to the ship hull a part b p a r t and the reflected pressure due to the propeller p i r e f l e c t p i n c i d e n t is calculated by equations 5 and 6 i e p i n c i d e n t p t p q according to ref wu 2000 the boundary integral equation equation 7 is used to indicate the relation between p t o t a l and these three parts z f is the solid angle for the field point f g f o is the half space green function that depends on the locations of a field point f and a point dipole o 8 g f o 1 4 π e i k r r r h e i k r i r i where r is the distance between f and o and r i is the distance between f and o o is the imaged point of o to simulate the free surface the reflection coefficient of the ship hull r h is equal to 1 for a rigid free surface and 1 for a soft free surface in equation 7 a part can be expressed in the time domain as 9 a p a r t m 1 m p t o t a l o t r c 1 r 2 p t o t a l o t r c t 1 c r r n r h p t o t a l o t r i c 1 r i 2 p t o t a l o t r i c t 1 c r i r i n i m δ s m 4 π δ s m is the element area on the hull subscript i refers to the imaged object for simulating the free surface in view of the rigid boundary condition the b p a r t term of equation 7 can be omitted in the total potential scheme the following proves that b p a r t can be omitted due to the rigid boundary condition according to ref kinsler et al 1982 the total pressure p t o t a l o e i ω t can be presented by the total velocity potential φ t o t a l o e i ω t 10 p t o t a l o e i ω t ρ φ t o t a l o e i ω t t i ρ ω φ t o t a l o e i ω t where ρ is the fluid density the differential term in b p a r t can now be reformed 11 p t o t a l o e i ω t n i ρ ω φ total o e i ω t n i ρ ω v n t o t a l o t v n t o t a l o t denotes the total normal velocity on the element of the ship hull and is zero due to the rigid boundary condition i e the fluid cannot penetrate through the ship hull therefore b p a r t is zero for the rigid boundary condition and can be omitted the iterations are conducted by equations 7 and 9 before the first iterating loop the total pressures p total on every element at each time step are unknown the value of initial total pressure for the scattering noise calculation can be set arbitrarily according to ref kao and kehr 2006 the iterating results can robustly converge to correct values by setting zero initial total pressure of p t o t a l thus the initial total pressure p t o t a l in this paper is also specified to be zero the first loop iteration goes from the first time step to the final time step at any time step the total pressure of the element 1 is updated first by the right side of equation 7 that of element 2 is then updated until the total pressure of every element is updated as we march from the first time step to the last time step the first iterating loop is completed and the next iterating loop is then carried out after several loops a robust convergence can be achieved please refer to ref kao and kehr 2006 for the details of iterating process the scattered pressure can be obtained by the iteration process in which the boundary condition on each panel is naturally satisfied but not by solving the matrix formed by the fulfillment of boundary condition on some node points of the discrete panels thus the present method can stably solve the scattered problem of the complex geometry such as the ship in the iterating scheme the time interpolation is replaced by fourier series not linear or second order interpolation ref kao and kehr 2006 has proven that the numerical error can be minimized by using the fourier series instead of using linear or second order interpolation 2 4 free surface effect when the radiated wave of the propeller and scattered wave of the ship hull are incident on the free surface reflected waves are generated to the field point as illustrated in fig 2 the sounds reflected from the free surface can be considered as being generated from the imaged propeller and imaged ship hull which are symmetrically on the opposite side of the free surface i e lloyd mirror in the model test the free surface was substituted by aluminum plates as shown in fig 3 a to suppress the wave system of the model thus the free surface is assumed to be rigid the rigid free surface presents the rigid plane consequently the imaged propeller and imaged ship hull have positive dipole strengths with respect to the actual propeller and ship hull ref kehr and kao 2004 the equations expressed in section 2 2 p t and p q are used to compute the blade rate acoustic pressure due to the imaged propeller p r e f l e c t r i t the coordinates system r i x i r i θ i relative to the imaged propeller center is adopted the coordinates system r i x i r i θ i can be represented as follows 12 x i x r i y i 2 z i 2 2 h r cos θ 2 r sin θ 2 θ i tan 1 z i y i tan 1 r sin θ 2 h r cos θ where h is the propeller shaft immersion the reflected sound pressure generated by the imaged ship hull is included in equation 9 i e the term combined with the reflection coefficient of the ship hull r h it is noted that r i presents the distance from the point dipole on the imaged ship hull to the field point because the ship hull is assumed to be rigid i e rigid boundary condition the normal total velocity on the ship hull is zero therefore the b p a r t term of equation 7 can be omitted and will not contribute the reflected wave to the filed point 2 5 experimental setup the dipole noises due to the operating propeller of the oceanography research ship were measured in the underwater anechoic chamber of the cavitation tunnel in national taiwan ocean university ntou the experimental results were compared with the numerical predictions to verify the applied methods proposed by refs kao and kehr 2006 and kehr and kao 2004 model scale experiments were carried out in the ntou cavitation tunnel the test section of the tunnel was 2 6m w x 1 5m h x 10m l and allowed the installation of the whole ship model the free surface was substituted by aluminum plates shown in fig 3 a to suppress the wave system of the model in order to compensate for the deceleration of the flow due to the boundary layer below the plate the model draught in the tunnel was increased by 50 mm in the model test the scaled propeller diameter was 0 25 m and the corresponding shaft speed was 20 rps the ship model was equipped with rudder propeller and shaft line the stern arrangement is shown in fig 4 eight pressure pick ups were installed on the stern above the propeller as seen in fig 4 for measuring noises in the near field three underwater microphones illustrated in fig 5 were also mounted in the underwater anechoic chamber to measure the far field noise the coordinates of the microphone positions are listed in table 1 according to ref kehr and kao 2004 when the distance from the noise source to the field point is larger than 10 times the propeller radius the field point belongs to far field thus the positions of the three mounted microphones can be treated as the far field points in the experimental procedure the kt identity rule was followed to ensure that the loading of the ship and model propellers are equal moreover the cavitation number responded to the local value in a horizontal plane through 0 8r r the propeller radius in the 12 o clock blade position as indicated in figs 3 a and 6 the underwater anechoic chamber is below the test section of the cavitation tunnel and full of water the shells of the test section and the anechoic chamber are designed specially thus the sound waves of the external environment cannot penetrate into the test section and the anechoic chamber the window with the same acoustic impedance as that of the water separates the test section and anechoic chamber although the propeller is installed in a reverberant environment the radiated noise of the propeller can pass completely through the window due to the same acoustic impedance and be measured in the anechoic chamber this test equipment and setup is the same as that of the well known hydrodynamics and cavitation tunnel hykat of hsva in order to purely measure the dipole noise generated by the operating propeller the noises caused by the shaft vibration the motor operation and the turbulence in the flow field are classified as the background noise the background noise should be measured in advance when measuring the background noise the propeller is removed and a dummy hub is installed the background noise is measured under the same test conditions the measured background noise is then used to correct the measured results with the propeller according to the recommendations of ref ross 1976 13 s p l r e a l 10 log 10 s p l t 10 10 s p l b 10 in equation 13 spl real refers to the corrected sound pressure level spl t is the sound pressure level including the propeller operation and the background noise and spl b is the sound pressure level of the background noise 3 numerical results this paper studies the dipole noises induced by the unsteady forces of the non cavitating propeller the propeller s unsteady forces are first predicted by cfd the linear wave theory and iterating boundary element method in time domain are then applied in solving the underwater noises 3 1 prediction of the propeller unsteady forces in this paper an oceanography research ship shown in fig 3 is taken as the computing sample the detailed sizes of the cfd computing domain are given in fig 7 in order to correctly analyze the relative velocity of a rotating turbine two computing domains are necessary one encloses the calculated propeller and the other one includes the whole computing domain the length width and depth of the outer domain are 4l 2l and 2l respectively l is the hull length overall the distance between the inlet and the bow of the hull is 1l the distance from the outlet to the stern of the hull is 2l the boundary conditions for the presented simulation are also indicated in fig 7 on the outer domain inlet the steady uniform velocity is imposed and the outer domain outlet is set as the pressure outlet the side faces of the outer and inner domains are considered as the interfaces rotational moving and slip walls are applied in the inner domain the plots of the ship and propeller meshes are shown in fig 8 the total mesh of this computing case is about 9 million table 2 lists the associated parameters and operating conditions of the propeller kt and kq are the thrust and torque coefficients of the propeller 14 k t t ρ n 2 d 4 15 k q q ρ n 2 d 5 where t is the propeller thrust q is the propeller torque ρ is the density and d is the propeller diameter ja is the propeller advanced ratio and defined by equation 16 16 j a v a n d va is the propeller inflow the cfd computations are based on the conditions listed in table 3 the propeller s unsteady radial force is relatively smaller than the unsteady thrust and torque forces and can be ignored the unsteady thrust and torque forces are calculated by cfd fig 9 plots the unsteady thrust of the propeller and a single blade at different angular positions the propeller blade delivers a relatively large total thrust nearly 90 on the starboard side due to the asymmetry in the tangential wake component fig 10 presents the unsteady torque of the propeller and one blade at different angular positions the distribution of torque is similar to that of the thrust table 4 shows the comparisons between the cfd and the experimental results it indicates that the deviations of the kt and kq values for the model and full scales are all under 1 the unsteady propeller forces are transformed into the dipole strengths i e the force amplitudes by the fourier transform for computing the radiated noises as discussed in section 2 2 equations 5 and 6 indicate that the dipole noises due to the operating propeller are caused by the dipole strengths at blade rate frequencies figs 11 and 12 illustrate the thrust and torque amplitudes of the propeller at different blade rate frequencies respectively and show that the first blade rate amplitude is dominant 3 2 the generated noise in the far field in the following p t and p q derived from equations 5 and 6 are summarized as the radiated noise pressure the generated noises are expressed as the sound pressure levels spls in db by the reference pressure 1μ pa and the maximum spl is selected to be plotted for this computing sample the maximum spl appears in the first blade rate frequency due to the maximum dipole strength in the first blade rate frequency shown in figs 11 and 12 in the cavitation tunnel facility a hard surface is used to simulate a free surface therefore a rigid free surface i e positive image is considered in this paper fig 13 shows the radiated contour plots of first blade rate spls due to the operating non cavitating propeller in the far field the y z plane is at x 15 rp rp the propeller radius according to equations 5 and 6 p t is proportional to the x value i e the axial position of the field point and p q is proportional to the r value i e the radial position of the field point thus the greater spls are detected along the 45 deg direction in fig 13 a as the rigid free surface simulated by positive image is considered the spls near the free surface are amplified by the reflected waves as shown in fig 13 b and d p q is dependent on the radial and angular positions r θ of the field point consequently the spls shown in fig 13 c and d do not form as concentric circles fig 14 presents the spls due to the scattered waves propagated from the ship hull by comparing figs 13 and 14 it is known that the radiated spls due to the operating non cavitating propeller are remarkably stronger than those due to the scattered waves of the hull as observed the propeller noise is greater than the hull scattering noise by up to 5 db at most considering this is the first bpf greater difference is expected in the spl in fig 14 a the greater spls appear along the y axis this phenomenon can be explained by two causes first the stern is nearer the operating propeller the operating propeller is the noise source thus the scattered pressure on the stern hull is more remarkable and the stern s scatter is stronger the field points along the y axis are near the stern and consequently the greater spls appear along the y axis 2 the hull stern is like a flat plane as shown in fig 3 b for the field points on the y axis the angle between the vector r and the normal vector on the stern is small i e the values of r n are larger according to equation 9 the larger the value of r n the stronger the spl caused unlike the constructive interferences illustrated in fig 13 b and d fig 14 b and d indicate that the rigid free surface causes the destructive interferences in the far field as the rigid free surface is considered the reflected waves due to the imaged ship hull cause the destructive interferences the destructive interferences are due to the opposite direction of the normal vector on the imaged hull as shown in fig 3 b the normal vector on the ship stern is downward it can be expected that the normal vector on the imaged hull stern is upward therefore the value of r i n i is negative r n and r i n i have opposite signs so the imaged ship hull causes the destructive interferences the spls shown in fig 11 c form concentric circles the radiated and scattered noises caused by the propeller s unsteady thrust and torque forces are combined in fig 15 the distributions of the total spl contours shown in fig 15 are similar to those shown in fig 13 because the radiated noise is dominant the positions of the field points listed in table 1 are transformed to the full scale positions and fig 16 plots the total spls with the consideration of the rigid free surface at different blade rate frequencies for these full scale field points fig 16 indicates that the maximum spl appears at the first blade rate frequency and is about 104 2 104 6 db noise at the fourth bpf is greater than the third bpf because the dipole strength at the fourth bpf is greater than the third bpf please refer figs 11 and 12 3 3 the generated noise in the near field according to ref kehr and kao 2004 as the distance between the point dipole and the field point is less than 10 times propeller radius i e 10rp the field point belongs to near field figs 17 21 are the near field acoustic fields at the near field the y z plane is at x 0 5 rp by comparing fig 13 with fig 17 it is found that the distributions of the spls are similar however in the near field the spls decay faster than those in the far field the differences discussed above can be explained by the right sides of equations 5 and 6 there are three parts in the right sides of equations 5 and 6 respectively for the far field the acoustic amplitudes are mainly contributed by the first part they are proportional to 1 r 2 as the field points are at the near field some acoustic contributions come from the second part they are proportional to 1 r 3 the high order term 1 r 3 decays faster than the low order term 1 r 2 fig 18 illustrates the spls due to the scattered waves from the hull in the near field for the same reason explained in section 3 2 the greater spls can be found along the y axis i e the dominant propagation is along the y axis in fig 18 a and b and the destructive interferences are caused in fig 18 b and d it is noted that the decay of the spls in the near field does not become faster because the propagation of the scattered wave is independent of 1 r n the radiated and scattered waves are considered together in fig 19 the radiated spls are obviously greater than the scattered spls thus the distributions of total spls in fig 19 are similar to those in fig 17 fig 20 demonstrates the scattered spls on the stern it shows the maximum scattered spl appears in the upper propeller center and the value is 172 db the predicted scattered noises on other position of the ship hull are shown in fig 21 the scattered spls on the ship hull are solved by the iterating boundary element method ref kao and kehr 2006 and the convergent history is shown in fig 22 4 experimental results in this study the model scale experiments were conducted in the underwater anechoic chamber of the ntou cavitation tunnel the model scale results were transformed into full scale ones and then the full scale values were compared with the numerical results to verify the applied numerical schemes 4 1 full scale transformations the scaling laws shown in ref ittc 2017 are used to transform the measured spls in the cavitation tunnel into the full scale values according to ref ittc 2017 the increased spl for the full scale is as follows 17 δ s p l 20 log d s d m 1 r m r s 1 σ s σ m 1 n s d s n m d m 2 ρ s ρ m 1 db the subscript s indicates the full scale and subscript m refers to the model scale d is the propeller diameter r is the distance from the noise source to the field point σ is the cavitation number n is the rotating speed and ρ the fluid density the right side of equation 17 includes five terms in this paper the full scale position of the field point is directly scaled by the ratio d s d m thus the first two terms can be reformulated as below 18 d s d m 1 r m r s 1 d s d m 1 r m r m d s d m 1 1 moreover the cavitation number of the experiment is identical to the full scale condition i e σ s σ m thus equation 16 can be summarized as equation 19 19 δ s p l 20 log n s d s n m d m 2 ρ s ρ m 1 db ref atlar et al 2001 proved that the laws recommended by ref ittc 2017 are suitable for low noise propellers such as the cavitation free propellers in ref atlar et al 2001 a fisheries research vessel frv was tested under the test conditions the sheet cavitation was free and only slight tip vortex cavitation appeared i e the dipole noise was dominant at blade rate frequencies the measured spls at the bpf were transformed into full scale values according to the scaling laws proposed by ref ittc 2017 by comparing the scaled values with the sea trial results good agreement was attained 4 2 experimental results and comparisons with numerical results fig 23 shows the measured spectra for the three mounted microphones arranged in fig 5 in fig 23 the distribution of the spectrum is of narrow band and the spls in blade rate frequencies are remarkable the greatest spl appears in the first blade rate frequency the model scale values in fig 23 are transformed into the full scale values according to equation 19 and the transformed full scale spls at every blade rate frequency are plotted in fig 24 the comparisons between the numerical and the transformed full scale results are illustrated in fig 25 and the deviations are indicated in table 5 for the three microphones the deviation in the first blade frequency between the predicted and transformed full scale spls is from 3 2 5 8 db however in the higher blade rate frequencies unacceptable deviations appear due to the insufficient resolutions of the dipole strengths in higher blade rate frequencies by the cfd simulation as shown in figs 11 and 12 the comparisons of the full scale scattered spls in the near field are shown in fig 26 the full scale values of the eight pressure pick ups are transformed from the measured model scale values according to equation 19 table 6 indicates that the deviation of the full scale scattered spl between the transformed and numerical results is 5 db the scattered pressures on the hull surface due to the dipoles are very small and the maximum value is under 1 kpa thus the deviation of the scattered pressure between the experimental and numerical results is usually high in percentage consequently the spl deviation between the experimental and numerical results is easily large 5 conclusions in this paper the dipole noises due to the marine propeller of an oceanography research ship are predicted and the calculated results are compared with the experimental data measured in the ntou cavitation tunnel due to the directional propagation of the dipole noise the radiated spls are dominant along the 45 deg direction in the x y plane and form non concentrically in the y z plane the rigid free surface amplifies the radiated spls near the free surface it is found that the distributions of the radiated spls in the far field are similar to those in the near field however in the near field the radiated spls decay faster than those in the far field the greater scattered spls appear along the y axis because the stern near the propeller has stronger scattering and the values of r n are larger the rigid free surface causes the destructive interferences for the scattered wave due to the opposite direction of the normal vector of the imaged hull the distributions of the total spls are similar to those of the radiated spls because the radiated spls due to the operating non cavitating propeller are remarkably stronger than those due to the scattered waves of the hull a comparison of the experimental and numerical results shows that the deviation of the total spls in the first blade rate frequency is from 3 2 5 8 db for the far field points however in the higher blade rate frequencies unacceptable deviations appear due to the insufficient resolutions of the dipole strengths by cfd simulations the deviation of the maximum scattered spl on the stern upper the propeller i e in the near field is 5 db the scattered pressures on the hull surface due to the dipoles are very small and high deviation of scattered pressure in percentage between the experimental and numerical results is easily caused according to the published literature the dipole noises of the marine propellers are rarely discussed and the experimental data are always held confidential this paper provides both numerical and experimental results for further associative studies moreover the numerical methods verified by the experiments in this paper can be applied to predict the dipole noises convincingly in the future credit authorship contribution statement jui hsiang kao formal analysis data curation writing original draft yan jhang lin data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21789,the objective of this paper is to predict the dipole noises caused by the marine propeller of an oceanography research ship and compare the calculated results with the experimental data to verify the applied numerical method as the propellers are of free cavitation such as those of submarines at diving depth and the surface vessels operating at cruising speed the dominant noises are generated by the unsteady forces i e dipole noise studies discussing the dipole noises generated by marine propellers are rare and the measured results are always confidential for military purpose in this paper the unsteady forces were calculated by computational fluid dynamics cfd and transformed into the dipole strengths the dipole strengths were then applied in the linear wave theory to solve the radiated noises the scattered noises from the ship hull were computed by the iterating boundary element method the experiments were carried out in the underwater anechoic chamber of the cavitation tunnel in national taiwan ocean university ntou the results show that the comparisons between the numerical and experimental results are in good agreement keywords propeller dipole noise cfd linear wave theory iterating boundary element method 1 introduction a propeller operating in a non uniform wake field is the primary source of underwater noise for a ship the prediction of radiated and scattered noises due to the operating propeller in the behind hull condition is of great concern in regard to military applications marine propeller noise can be classified into cavitating and non cavitating noises as the propellers are free from cavitation such as in oceanography research ships and warships the noises generated by dipoles i e propeller unsteady forces are dominant according to the published literature the dipole noises of the marine propellers are rarely discussed and the experimental data are always kept confidential the ffowcs williams and hawkings fwh equation has been widely used in predicting the radiated noises due to the operating marine propeller for both cavitating and non cavitating conditions ref paula et al 2013 ref özden et al 2016 ref li et al 2018a and ref testa and greco 2018a the noise sources are presented as monopole i e sheet cavitation dipole i e unsteady loadings and quadrupole i e tip vortex cavitation in the fwh equation ref li et al 2015 ref lidtke et al 2016 ref li et al 2018b and ref sakamoto and kamiirisa 2018 predicted radiated noise due to the marine cavitating propeller by combining cfd computation fluid dynamics technology and the fwh model it was found that at the higher blade rate frequencies the predicted tones were lower than the sea trial data due to the insufficient resolutions for the cfd simulation according to ref seol et al 2002 the flow field was analyzed with the potential based panel method the time dependent pressures were then used as the input for fwh formulation to predict the far field acoustics i e the dipole noise at far field the delay time of wave propagation was not considered in the potential based panel method thus this method is unsuitable for near field predictions in ref ozden et al 2012 the propeller noise was studied numerically and experimentally for non cavitating conditions the hydroacoustic analysis was performed using a model based on the fwh equation the noise predictions were in a good agreement with the experimental results however for the receiver with an angle to the shaft axis the numerical scheme under predicted the noise levels ref kim et al 2014 applied the matched field inversion mfi method to determine the dipole parameters of propeller non cavitating noise in the model scale experiment the exciting force on the ship hull was then computed by the boundary element method the inversion based on the model experiment included simplified parameterization ref mousavi et al 2014 and ref du et al 2017 simulated the blade rate noise generated by the non cavitating propeller the les large eddy simulation turbulence model was recommended to calculate the hydrodynamic parameters and the fwh model was used to find the spectral distributions of flow noise for different advance coefficients ref wei et al 2016 predicted the scattered noise of a submarine hull due to the non cavitating propeller the dipole strengths of the non cavitating propeller were calculated by cfd and the scattering effect from the hull was solved by the iterating boundary element method in time domain as proposed by ref kao and kehr 2006 there were no experimental verifications in ref wei et al 2016 in this paper the method derived in ref kao and kehr 2006 will be verified by the experiments carried out in the cavitation tunnel of ntou in ref testa and greco 2018b the incident wave due to the non cavitating propeller was calculated by the 3d unsteady panel method the incident waves were then treated as the input in the frequency domain formulation based on the acoustic analogy to simulate the scattered noise by the hull the results were only compared with the analysis of the whole propeller hull configuration within the framework of potential flows and there were no experimental comparisons presently there are few published studies referring to the dipole noise of the marine propellers and most numerical schemes are modeled by the fwh equation comparisons between the numerical and experimental results are rare in this paper cfd technology and the formulations derived by ref kehr and kao 2004 are combined to solve the dipole noises radiated from the marine propeller ref kehr and kao 2004 developed a method in time domain which can calculate the acoustic pressure fields both at far and near fields induced by unsteady propeller axial thrust and tangential torque force the scattered waves from the hull are considered according to the method proposed in ref kao and kehr 2006 whose robust new method based on scattered potential in time domain can treat the multi frequency scattered waves from complex objects an oceanography research ship is treated as the calculating sample the scattered noises on the hull and the radiated noises in the fields are both computed the experiments are conducted in the underwater anechoic chamber of ntou cavitation tunnel to verify the numerical schemes used refs kao and kehr 2006 and kehr and kao 2004 in this paper 2 numerical schemes and experimental setup in this paper the unsteady forces due to the operating propeller i e the dipole strengths are predicted by cfd the dipole strengths are then treated as the noise sources in the linear wave equation to solve the radiated noises according to ref kehr and kao 2004 the scattering effect caused by the hull is considered by the iterating boundary element method in time domain ref kao and kehr 2006 2 1 propeller unsteady forces the unsteady propeller forces are investigated by using the commercial cfd software ansys fluent in order to save the computing time the sst k ω turbulent model is used first to attain the convergent results the les turbulent model suggested by ref mousavi et al 2014 and ref du et al 2017 is then applied to capture the fluctuations of the propeller unsteady forces more precisely the simple algorithm derived by ref patankar and spalding 1972 is used to solve the forces and velocities the main idea of this scheme is to update the forces and velocities by corrected terms 2 2 radiated noise caused by the non cavitating propeller the method proposed by ref kehr and kao 2004 is used to solve the propeller noise in this paper the numerical equations are indicated as follows and the detailed deriving process can be referred in ref kehr and kao 2004 as shown in fig 1 the rotating noise source with angular velocity ω is located at position vector r s x s r s θ s θ n ω t s at t s and the observer is located at position vector r x r θ r is the distance from the noise source to the observer at time t s the dipole strengths corresponding to the unsteady forces f on each blade are calculated by cfd if the propeller unsteady force is assumed to be the only noise source the governing equation of linear wave is 1 2 p l o a d 1 c 0 2 2 p l o a d t 2 s f where p l o a d is the acoustic pressure due to the unsteady propeller force s denotes the vector gradient operator in the noise source coordinates and f is the unsteady force vector per unit volume acting on the fluid the unsteady force of a propeller includes three components the axial thrust tangential torque force and radial force but the radial force will be omitted because it is much smaller than the first two the solution to equation 1 has the following form 2 p l o a d r t 1 4 π t s s s f r s t s r δ t s t r c 0 d v s d t s the total unsteady forces of a propeller at time t s can then be represented by 3 f x t s m 1 b i 1 i j 1 j t m i j t s m 1 b i 1 i j 1 j h m i j 0 q 1 h m i j q cos q ω t s θ n ε m i j q 4 f θ t s m 1 b i 1 i j 1 j q m i j t s r s m 1 b i 1 i j 1 j h m i j 0 q 1 h m i j q cos q ω t s θ n ε m i j q r s where b is the number of propeller blades t m i j t s and q m i j t s are the respective axial thrust and tangential torque acting on the i j element on the mth blade camber surface at time t s because t m i j t s and q m i j t s vary periodically they can also be expressed by the fourier series as shown in equations 3 and 4 h and h are amplitudes of the thrust and torque fourier series respectively h and h are the so called dipole strengths using gauss s theorem substituting equations 3 and 4 into equation 2 and denoting t s t r c 0 the acoustic pressures induced by the unsteady thrust and torque can be obtained as follows 5 p t r t m 1 b i 1 i j 1 j q 1 x s x q ω 4 π r 2 c 0 h m i j q sin q ω t s θ n ε m i j q x s x 4 π r 3 h m i j 0 h m i j q cos q ω t s θ n ε m i j q ω r n r x s x 4 π c 0 r 4 sin ω t s θ θ n h m i j 0 h m i j q cos q ω t s θ n ε m i j q 6 p q r t m 1 b i 1 i j 1 j q 1 q ω r 4 π r 2 r n c 0 h m i j q sin ω t s θ θ n sin q ω t s θ n ε m i j q r 4 π r n r 3 h m i j 0 h m i j q cos q ω t s θ n ε m i j q sin ω t s θ θ n ω r 2 4 π c 0 r n 4 h m i j 0 h m i j q cos q ω t s θ n ε m i j q sin 2 ω t s θ θ n p t r t is the acoustic pressure induced by the unsteady thrust of all the propeller blades p q r t is the acoustic pressure induced by the unsteady torque of all the propeller blades here it is noted that p t r t consists of three parts the first part is proportional to the ratio of x x s r 2 and depends on the factor q ω c 0 the second part is a higher order term which is proportional to the ratio of x x s r 4 the third part is relationally small for marine propellers at both near field and far field conditions because it is proportional to ω r n c 0 and decays with the ratio of r x x s r 4 as the distance r is far enough that is 1 r is much smaller than q ω c 0 the higher order term decays very fast and the acoustic pressure will be proportional to 1 r in the same direction from the propeller center to the field point at near field the second part plays an important role similarly p q r t consists of three parts the first term which is proportional to the ratio of r r 2 and depends on the factor q ω c 0 is due to the temporal variation of torque force the second term is proportional to the ratio of r r 3 and decays faster than the first term at far field the third term is also negligibly small for marine propellers both at near field and far field 2 3 scattered waves due to the hull the scattered waves were solved by the time domain iterating boundary element method introduced in ref kao and kehr 2006 the iterations for the scattered pressure in the time domain are carried out by the boundary integral equation 7 z f p t o t a l f t s p t o t a l o g f o n e i ω t ds d ω s g f o p t o t a l o e i ω t n ds d ω 4 π p i n c i d e n t p r e f l e c t a part b p a r t 4 π p i n c i d e n t p r e f l e c t p t o t a l is the total acoustic measured at the field point p t o t a l is contributed by three parts the radiated pressure due to the propeller p i n c i d e n t scattered and reflected pressures due to the ship hull a part b p a r t and the reflected pressure due to the propeller p i r e f l e c t p i n c i d e n t is calculated by equations 5 and 6 i e p i n c i d e n t p t p q according to ref wu 2000 the boundary integral equation equation 7 is used to indicate the relation between p t o t a l and these three parts z f is the solid angle for the field point f g f o is the half space green function that depends on the locations of a field point f and a point dipole o 8 g f o 1 4 π e i k r r r h e i k r i r i where r is the distance between f and o and r i is the distance between f and o o is the imaged point of o to simulate the free surface the reflection coefficient of the ship hull r h is equal to 1 for a rigid free surface and 1 for a soft free surface in equation 7 a part can be expressed in the time domain as 9 a p a r t m 1 m p t o t a l o t r c 1 r 2 p t o t a l o t r c t 1 c r r n r h p t o t a l o t r i c 1 r i 2 p t o t a l o t r i c t 1 c r i r i n i m δ s m 4 π δ s m is the element area on the hull subscript i refers to the imaged object for simulating the free surface in view of the rigid boundary condition the b p a r t term of equation 7 can be omitted in the total potential scheme the following proves that b p a r t can be omitted due to the rigid boundary condition according to ref kinsler et al 1982 the total pressure p t o t a l o e i ω t can be presented by the total velocity potential φ t o t a l o e i ω t 10 p t o t a l o e i ω t ρ φ t o t a l o e i ω t t i ρ ω φ t o t a l o e i ω t where ρ is the fluid density the differential term in b p a r t can now be reformed 11 p t o t a l o e i ω t n i ρ ω φ total o e i ω t n i ρ ω v n t o t a l o t v n t o t a l o t denotes the total normal velocity on the element of the ship hull and is zero due to the rigid boundary condition i e the fluid cannot penetrate through the ship hull therefore b p a r t is zero for the rigid boundary condition and can be omitted the iterations are conducted by equations 7 and 9 before the first iterating loop the total pressures p total on every element at each time step are unknown the value of initial total pressure for the scattering noise calculation can be set arbitrarily according to ref kao and kehr 2006 the iterating results can robustly converge to correct values by setting zero initial total pressure of p t o t a l thus the initial total pressure p t o t a l in this paper is also specified to be zero the first loop iteration goes from the first time step to the final time step at any time step the total pressure of the element 1 is updated first by the right side of equation 7 that of element 2 is then updated until the total pressure of every element is updated as we march from the first time step to the last time step the first iterating loop is completed and the next iterating loop is then carried out after several loops a robust convergence can be achieved please refer to ref kao and kehr 2006 for the details of iterating process the scattered pressure can be obtained by the iteration process in which the boundary condition on each panel is naturally satisfied but not by solving the matrix formed by the fulfillment of boundary condition on some node points of the discrete panels thus the present method can stably solve the scattered problem of the complex geometry such as the ship in the iterating scheme the time interpolation is replaced by fourier series not linear or second order interpolation ref kao and kehr 2006 has proven that the numerical error can be minimized by using the fourier series instead of using linear or second order interpolation 2 4 free surface effect when the radiated wave of the propeller and scattered wave of the ship hull are incident on the free surface reflected waves are generated to the field point as illustrated in fig 2 the sounds reflected from the free surface can be considered as being generated from the imaged propeller and imaged ship hull which are symmetrically on the opposite side of the free surface i e lloyd mirror in the model test the free surface was substituted by aluminum plates as shown in fig 3 a to suppress the wave system of the model thus the free surface is assumed to be rigid the rigid free surface presents the rigid plane consequently the imaged propeller and imaged ship hull have positive dipole strengths with respect to the actual propeller and ship hull ref kehr and kao 2004 the equations expressed in section 2 2 p t and p q are used to compute the blade rate acoustic pressure due to the imaged propeller p r e f l e c t r i t the coordinates system r i x i r i θ i relative to the imaged propeller center is adopted the coordinates system r i x i r i θ i can be represented as follows 12 x i x r i y i 2 z i 2 2 h r cos θ 2 r sin θ 2 θ i tan 1 z i y i tan 1 r sin θ 2 h r cos θ where h is the propeller shaft immersion the reflected sound pressure generated by the imaged ship hull is included in equation 9 i e the term combined with the reflection coefficient of the ship hull r h it is noted that r i presents the distance from the point dipole on the imaged ship hull to the field point because the ship hull is assumed to be rigid i e rigid boundary condition the normal total velocity on the ship hull is zero therefore the b p a r t term of equation 7 can be omitted and will not contribute the reflected wave to the filed point 2 5 experimental setup the dipole noises due to the operating propeller of the oceanography research ship were measured in the underwater anechoic chamber of the cavitation tunnel in national taiwan ocean university ntou the experimental results were compared with the numerical predictions to verify the applied methods proposed by refs kao and kehr 2006 and kehr and kao 2004 model scale experiments were carried out in the ntou cavitation tunnel the test section of the tunnel was 2 6m w x 1 5m h x 10m l and allowed the installation of the whole ship model the free surface was substituted by aluminum plates shown in fig 3 a to suppress the wave system of the model in order to compensate for the deceleration of the flow due to the boundary layer below the plate the model draught in the tunnel was increased by 50 mm in the model test the scaled propeller diameter was 0 25 m and the corresponding shaft speed was 20 rps the ship model was equipped with rudder propeller and shaft line the stern arrangement is shown in fig 4 eight pressure pick ups were installed on the stern above the propeller as seen in fig 4 for measuring noises in the near field three underwater microphones illustrated in fig 5 were also mounted in the underwater anechoic chamber to measure the far field noise the coordinates of the microphone positions are listed in table 1 according to ref kehr and kao 2004 when the distance from the noise source to the field point is larger than 10 times the propeller radius the field point belongs to far field thus the positions of the three mounted microphones can be treated as the far field points in the experimental procedure the kt identity rule was followed to ensure that the loading of the ship and model propellers are equal moreover the cavitation number responded to the local value in a horizontal plane through 0 8r r the propeller radius in the 12 o clock blade position as indicated in figs 3 a and 6 the underwater anechoic chamber is below the test section of the cavitation tunnel and full of water the shells of the test section and the anechoic chamber are designed specially thus the sound waves of the external environment cannot penetrate into the test section and the anechoic chamber the window with the same acoustic impedance as that of the water separates the test section and anechoic chamber although the propeller is installed in a reverberant environment the radiated noise of the propeller can pass completely through the window due to the same acoustic impedance and be measured in the anechoic chamber this test equipment and setup is the same as that of the well known hydrodynamics and cavitation tunnel hykat of hsva in order to purely measure the dipole noise generated by the operating propeller the noises caused by the shaft vibration the motor operation and the turbulence in the flow field are classified as the background noise the background noise should be measured in advance when measuring the background noise the propeller is removed and a dummy hub is installed the background noise is measured under the same test conditions the measured background noise is then used to correct the measured results with the propeller according to the recommendations of ref ross 1976 13 s p l r e a l 10 log 10 s p l t 10 10 s p l b 10 in equation 13 spl real refers to the corrected sound pressure level spl t is the sound pressure level including the propeller operation and the background noise and spl b is the sound pressure level of the background noise 3 numerical results this paper studies the dipole noises induced by the unsteady forces of the non cavitating propeller the propeller s unsteady forces are first predicted by cfd the linear wave theory and iterating boundary element method in time domain are then applied in solving the underwater noises 3 1 prediction of the propeller unsteady forces in this paper an oceanography research ship shown in fig 3 is taken as the computing sample the detailed sizes of the cfd computing domain are given in fig 7 in order to correctly analyze the relative velocity of a rotating turbine two computing domains are necessary one encloses the calculated propeller and the other one includes the whole computing domain the length width and depth of the outer domain are 4l 2l and 2l respectively l is the hull length overall the distance between the inlet and the bow of the hull is 1l the distance from the outlet to the stern of the hull is 2l the boundary conditions for the presented simulation are also indicated in fig 7 on the outer domain inlet the steady uniform velocity is imposed and the outer domain outlet is set as the pressure outlet the side faces of the outer and inner domains are considered as the interfaces rotational moving and slip walls are applied in the inner domain the plots of the ship and propeller meshes are shown in fig 8 the total mesh of this computing case is about 9 million table 2 lists the associated parameters and operating conditions of the propeller kt and kq are the thrust and torque coefficients of the propeller 14 k t t ρ n 2 d 4 15 k q q ρ n 2 d 5 where t is the propeller thrust q is the propeller torque ρ is the density and d is the propeller diameter ja is the propeller advanced ratio and defined by equation 16 16 j a v a n d va is the propeller inflow the cfd computations are based on the conditions listed in table 3 the propeller s unsteady radial force is relatively smaller than the unsteady thrust and torque forces and can be ignored the unsteady thrust and torque forces are calculated by cfd fig 9 plots the unsteady thrust of the propeller and a single blade at different angular positions the propeller blade delivers a relatively large total thrust nearly 90 on the starboard side due to the asymmetry in the tangential wake component fig 10 presents the unsteady torque of the propeller and one blade at different angular positions the distribution of torque is similar to that of the thrust table 4 shows the comparisons between the cfd and the experimental results it indicates that the deviations of the kt and kq values for the model and full scales are all under 1 the unsteady propeller forces are transformed into the dipole strengths i e the force amplitudes by the fourier transform for computing the radiated noises as discussed in section 2 2 equations 5 and 6 indicate that the dipole noises due to the operating propeller are caused by the dipole strengths at blade rate frequencies figs 11 and 12 illustrate the thrust and torque amplitudes of the propeller at different blade rate frequencies respectively and show that the first blade rate amplitude is dominant 3 2 the generated noise in the far field in the following p t and p q derived from equations 5 and 6 are summarized as the radiated noise pressure the generated noises are expressed as the sound pressure levels spls in db by the reference pressure 1μ pa and the maximum spl is selected to be plotted for this computing sample the maximum spl appears in the first blade rate frequency due to the maximum dipole strength in the first blade rate frequency shown in figs 11 and 12 in the cavitation tunnel facility a hard surface is used to simulate a free surface therefore a rigid free surface i e positive image is considered in this paper fig 13 shows the radiated contour plots of first blade rate spls due to the operating non cavitating propeller in the far field the y z plane is at x 15 rp rp the propeller radius according to equations 5 and 6 p t is proportional to the x value i e the axial position of the field point and p q is proportional to the r value i e the radial position of the field point thus the greater spls are detected along the 45 deg direction in fig 13 a as the rigid free surface simulated by positive image is considered the spls near the free surface are amplified by the reflected waves as shown in fig 13 b and d p q is dependent on the radial and angular positions r θ of the field point consequently the spls shown in fig 13 c and d do not form as concentric circles fig 14 presents the spls due to the scattered waves propagated from the ship hull by comparing figs 13 and 14 it is known that the radiated spls due to the operating non cavitating propeller are remarkably stronger than those due to the scattered waves of the hull as observed the propeller noise is greater than the hull scattering noise by up to 5 db at most considering this is the first bpf greater difference is expected in the spl in fig 14 a the greater spls appear along the y axis this phenomenon can be explained by two causes first the stern is nearer the operating propeller the operating propeller is the noise source thus the scattered pressure on the stern hull is more remarkable and the stern s scatter is stronger the field points along the y axis are near the stern and consequently the greater spls appear along the y axis 2 the hull stern is like a flat plane as shown in fig 3 b for the field points on the y axis the angle between the vector r and the normal vector on the stern is small i e the values of r n are larger according to equation 9 the larger the value of r n the stronger the spl caused unlike the constructive interferences illustrated in fig 13 b and d fig 14 b and d indicate that the rigid free surface causes the destructive interferences in the far field as the rigid free surface is considered the reflected waves due to the imaged ship hull cause the destructive interferences the destructive interferences are due to the opposite direction of the normal vector on the imaged hull as shown in fig 3 b the normal vector on the ship stern is downward it can be expected that the normal vector on the imaged hull stern is upward therefore the value of r i n i is negative r n and r i n i have opposite signs so the imaged ship hull causes the destructive interferences the spls shown in fig 11 c form concentric circles the radiated and scattered noises caused by the propeller s unsteady thrust and torque forces are combined in fig 15 the distributions of the total spl contours shown in fig 15 are similar to those shown in fig 13 because the radiated noise is dominant the positions of the field points listed in table 1 are transformed to the full scale positions and fig 16 plots the total spls with the consideration of the rigid free surface at different blade rate frequencies for these full scale field points fig 16 indicates that the maximum spl appears at the first blade rate frequency and is about 104 2 104 6 db noise at the fourth bpf is greater than the third bpf because the dipole strength at the fourth bpf is greater than the third bpf please refer figs 11 and 12 3 3 the generated noise in the near field according to ref kehr and kao 2004 as the distance between the point dipole and the field point is less than 10 times propeller radius i e 10rp the field point belongs to near field figs 17 21 are the near field acoustic fields at the near field the y z plane is at x 0 5 rp by comparing fig 13 with fig 17 it is found that the distributions of the spls are similar however in the near field the spls decay faster than those in the far field the differences discussed above can be explained by the right sides of equations 5 and 6 there are three parts in the right sides of equations 5 and 6 respectively for the far field the acoustic amplitudes are mainly contributed by the first part they are proportional to 1 r 2 as the field points are at the near field some acoustic contributions come from the second part they are proportional to 1 r 3 the high order term 1 r 3 decays faster than the low order term 1 r 2 fig 18 illustrates the spls due to the scattered waves from the hull in the near field for the same reason explained in section 3 2 the greater spls can be found along the y axis i e the dominant propagation is along the y axis in fig 18 a and b and the destructive interferences are caused in fig 18 b and d it is noted that the decay of the spls in the near field does not become faster because the propagation of the scattered wave is independent of 1 r n the radiated and scattered waves are considered together in fig 19 the radiated spls are obviously greater than the scattered spls thus the distributions of total spls in fig 19 are similar to those in fig 17 fig 20 demonstrates the scattered spls on the stern it shows the maximum scattered spl appears in the upper propeller center and the value is 172 db the predicted scattered noises on other position of the ship hull are shown in fig 21 the scattered spls on the ship hull are solved by the iterating boundary element method ref kao and kehr 2006 and the convergent history is shown in fig 22 4 experimental results in this study the model scale experiments were conducted in the underwater anechoic chamber of the ntou cavitation tunnel the model scale results were transformed into full scale ones and then the full scale values were compared with the numerical results to verify the applied numerical schemes 4 1 full scale transformations the scaling laws shown in ref ittc 2017 are used to transform the measured spls in the cavitation tunnel into the full scale values according to ref ittc 2017 the increased spl for the full scale is as follows 17 δ s p l 20 log d s d m 1 r m r s 1 σ s σ m 1 n s d s n m d m 2 ρ s ρ m 1 db the subscript s indicates the full scale and subscript m refers to the model scale d is the propeller diameter r is the distance from the noise source to the field point σ is the cavitation number n is the rotating speed and ρ the fluid density the right side of equation 17 includes five terms in this paper the full scale position of the field point is directly scaled by the ratio d s d m thus the first two terms can be reformulated as below 18 d s d m 1 r m r s 1 d s d m 1 r m r m d s d m 1 1 moreover the cavitation number of the experiment is identical to the full scale condition i e σ s σ m thus equation 16 can be summarized as equation 19 19 δ s p l 20 log n s d s n m d m 2 ρ s ρ m 1 db ref atlar et al 2001 proved that the laws recommended by ref ittc 2017 are suitable for low noise propellers such as the cavitation free propellers in ref atlar et al 2001 a fisheries research vessel frv was tested under the test conditions the sheet cavitation was free and only slight tip vortex cavitation appeared i e the dipole noise was dominant at blade rate frequencies the measured spls at the bpf were transformed into full scale values according to the scaling laws proposed by ref ittc 2017 by comparing the scaled values with the sea trial results good agreement was attained 4 2 experimental results and comparisons with numerical results fig 23 shows the measured spectra for the three mounted microphones arranged in fig 5 in fig 23 the distribution of the spectrum is of narrow band and the spls in blade rate frequencies are remarkable the greatest spl appears in the first blade rate frequency the model scale values in fig 23 are transformed into the full scale values according to equation 19 and the transformed full scale spls at every blade rate frequency are plotted in fig 24 the comparisons between the numerical and the transformed full scale results are illustrated in fig 25 and the deviations are indicated in table 5 for the three microphones the deviation in the first blade frequency between the predicted and transformed full scale spls is from 3 2 5 8 db however in the higher blade rate frequencies unacceptable deviations appear due to the insufficient resolutions of the dipole strengths in higher blade rate frequencies by the cfd simulation as shown in figs 11 and 12 the comparisons of the full scale scattered spls in the near field are shown in fig 26 the full scale values of the eight pressure pick ups are transformed from the measured model scale values according to equation 19 table 6 indicates that the deviation of the full scale scattered spl between the transformed and numerical results is 5 db the scattered pressures on the hull surface due to the dipoles are very small and the maximum value is under 1 kpa thus the deviation of the scattered pressure between the experimental and numerical results is usually high in percentage consequently the spl deviation between the experimental and numerical results is easily large 5 conclusions in this paper the dipole noises due to the marine propeller of an oceanography research ship are predicted and the calculated results are compared with the experimental data measured in the ntou cavitation tunnel due to the directional propagation of the dipole noise the radiated spls are dominant along the 45 deg direction in the x y plane and form non concentrically in the y z plane the rigid free surface amplifies the radiated spls near the free surface it is found that the distributions of the radiated spls in the far field are similar to those in the near field however in the near field the radiated spls decay faster than those in the far field the greater scattered spls appear along the y axis because the stern near the propeller has stronger scattering and the values of r n are larger the rigid free surface causes the destructive interferences for the scattered wave due to the opposite direction of the normal vector of the imaged hull the distributions of the total spls are similar to those of the radiated spls because the radiated spls due to the operating non cavitating propeller are remarkably stronger than those due to the scattered waves of the hull a comparison of the experimental and numerical results shows that the deviation of the total spls in the first blade rate frequency is from 3 2 5 8 db for the far field points however in the higher blade rate frequencies unacceptable deviations appear due to the insufficient resolutions of the dipole strengths by cfd simulations the deviation of the maximum scattered spl on the stern upper the propeller i e in the near field is 5 db the scattered pressures on the hull surface due to the dipoles are very small and high deviation of scattered pressure in percentage between the experimental and numerical results is easily caused according to the published literature the dipole noises of the marine propellers are rarely discussed and the experimental data are always held confidential this paper provides both numerical and experimental results for further associative studies moreover the numerical methods verified by the experiments in this paper can be applied to predict the dipole noises convincingly in the future credit authorship contribution statement jui hsiang kao formal analysis data curation writing original draft yan jhang lin data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
