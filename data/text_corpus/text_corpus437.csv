index,text
2185,operation of multipurpose reservoirs during flood season is a challenging task if there is a conflict among the purposes despite the importance of this theme in water resources management and a large number of relevant studies carried out a detailed review paper on this topic is missing in the literature present paper aims to fill this gap by providing a comprehensive review of the published literature by classifying the articles the conventional and advanced techniques used in flood control operation of single and multiple reservoirs have been reviewed for flood control regulation the best results are obtained by judicious use of current data and forecasts since the operators need to maintain a balance between conflicting demands in presence of uncertain inflows assessment of risks and uncertainties and their management is crucial finally suggestions for future research and development on this topic are provided data availability no data was used for the research described in the article 1 introduction storage reservoirs are commonly constructed to meet conservation demands that require water to be stored conserved for the best results flood control or a combination thereof common conservation demands are irrigation hydroelectric power generation municipal and industrial water supply recreation and navigation depending upon the purposes served a reservoir can be classified as single purpose or multipurpose to better utilize limited resources many projects serve multiple purposes reservoir storage increases when the inflows exceed release to meet demands and is depleted when the situation reverses conservation demands are best served when the reservoir is as much full as possible however to control floods reservoir should be kept vacant during the flood season to moderate the incoming floods to the maximum possible extent storage requirements of conservation purposes and flood control are different and conflicting therefore operation of a single purpose reservoir is much less complex than a multipurpose reservoir to operate most major and medium reservoirs policies are developed that suggest the volume of water to be stored and or discharged at a given time depending upon the state of the reservoir magnitude of demands vacant storage space hydrological conditions in areas downstream to reservoir and inflow forecasts operating decisions are taken using the developed policy this mechanism works well when there is no conflict in the purposes being served or the state of the reservoir does not change rapidly however it is a challenge to operate a multipurpose reservoir during flood season in several situations a when the reservoir serves conflicting purposes such as conservation and flood control b when the space allocated available for flood moderation is small compared to the expected inflows c when in a system of reservoirs managers need to decide how much water to store and release from each reservoir d when decision making time is rather short and a wrong decision may endanger dam safety life of the people and damages in downstream areas and e when decisions need to be reviewed frequently say every few hours due to rapid changes in the system state a reservoir helps moderate the floods by reducing the peak delaying its arrival and extending the hydrograph base operation of a multipurpose reservoir during high flows can be divided in three periods fig 1 here ①is the pre depletion stage where if necessary vacant space is created by releasing stored water ② is the period of very high flows when reservoir is regulated to maintain outflows below safe channel capacity ensuring safety of dam after the high flow period is over reservoir is filled in stage ③ correct identification of beginning and termination of various stages is important 1 1 objectives and organization of the present paper in view of its importance reservoir operation has been studied by numerous researchers yeh 1985 published a review on reservoir management and operation models review by labadie 2004 was concerned with optimal operation of multi reservoir systems rani and moreira 2010 reviewed applications of simulation optimization models in reservoir operation and ahmad et al 2014 reviewed reservoir optimization in water resources macian sorribes and pulido velazquez 2020 presented a review on how to derive optimal reservoir operating rules these reviews are comprehensive and provide excellent insight into the problem of reservoir operation however a comprehensive review on operation of multipurpose reservoirs during flood season is missing in the literature the aim of this paper is to review the current state of the art regarding operation of multipurpose reservoirs during flood season it is assumed that reservoirs have a distinct wet season in which bulk of the annual inflows is received and this is also the season when flood damages occur the reservoir managers aim to moderate the incoming floods to the maximum feasible extent and finish the wet season with a full reservoir this paper focuses on challenges associated with reservoir flood control operation necessity of real time operation during floods and techniques used and risk and uncertainties and ways to manage these the paper has also identified the potential topics on which future research may be focused the organization of the paper is shown in fig 2 after introducing the topic section 1 2 encapsulates the status and trend of research publications in the field of flood control operation of reservoirs the flood mitigation approaches in a multipurpose reservoir have been classified into three categories and are discussed in section 2 systems analysis techniques are widely used for developing operation policies for reservoirs and are presented in section 3 this section introduces the popular systems analysis tools and discusses applications of common systems analysis techniques viz simulation optimization and coupled simulation optimization this section also discusses operation of a network of multi purpose reservoirs including cascade systems section 4 briefly describes flow forecasting approaches followed by a detailed review of important studies that deal with real time flood control operation including the gate operation strategy of single reservoir or multi reservoir systems any review of reservoir operation is incomplete without consideration of uncertainties and associated risks therefore various uncertainty analysis techniques and the risk evaluation methods are discussed in the penultimate section each section in the paper culminates with brief remarks on the contents of that section the paper concludes with listing the gaps in the knowledge and suggestions for the way forward 1 2 status and trend of research in flood control operation of reservoirs bibliometric data of the publications on topics relevant to this paper published in peer reviewed journals books etc was compiled more than 180 articles were reviewed for this paper which are pertaining to the broad area of reservoir operation for flood mitigation during flood season the literature is collected from various databases which include scopus and google scholar different combinations of the following keywords flood season reservoir operation flood mitigation simulation optimization uncertainty risk analysis flood forecasting and real time operation were used to identify the relevant papers which were further classified under suitable sub sections in this review paper it is to be mentioned that no specific year was mentioned during the search however the resulting papers were mostly published during the last 30 years a synopsis of literature reviewed is presented in table s1 through table s9 supplementary material these tables contain extracted data based on the focus of publications location of the case study and the methodology employed these tables also provide information on the purpose of the reservoir single multi objective and consideration of risk uncertainty table 1 gives the number of publications in different peer reviewed journals books theses etc mostly during the past 30 years we note that four journals account for bulk of the papers published on this topic the reviewed literatures were categorized into groups based on the approaches used for reservoir operation table 2 gives the number of papers published in each sub area it is noted that most of the published papers were concerned with application of systems analysis techniques closely followed by risk and uncertainty analysis and real time operation of reservoirs some papers can be classified in more than one sub area and different persons may classify the papers differently 2 approaches for flood control operation of a multipurpose reservoir with frequent water shortages across the world there is growing need to operate multipurpose reservoirs such that the maximum possible water is conserved while ensuring dam safety and best flood moderation the broad reservoir operation approaches strategies adopted for flood mitigation in a multipurpose scenario and covered in this review could be classified into three categories viz the flood control rule curves the concept of flood limited water level and the concept of hedging the three approaches are presented in the chronological order of their appearance in research articles the latest being the hedging approach each sub section reviews numerous articles and discusses robustness usefulness and practical usability of each flood mitigation approach 2 1 flood control rule curves for the multipurpose reservoirs wherein flood control is the main purpose some storage space is allocated for flood control and is specified by rule curves loucks and van beek 2017 this space is typically kept vacant to moderate the incoming floods the size of this space is based on the volume of design flood the spillway release capacity and the safe carrying capacity at the downstream damage center the incoming floods are moderated by utilizing this space it is emptied after a flood event to be ready for a subsequent flood this practice is based on the premise that damage causing releases should be avoided till the available storage is utilized chaleeraktrakoon and chinsomboon 2015 proposed dynamic flood control rule curves for maximum utilization of reservoir capacity a range of possible design flood hydrographs are predicted and corresponding dynamic flood rule curves are derived this approach better tackles the uncertainty associated with the incoming flood malekmohammadi et al 2010 used a simulation optimization so approach and applied k nn nearest neighbor algorithm to develop real time reservoir operating rules from the results of the reservoir optimization model the objective function had incorporated coefficient of variation of releases to avoid large fluctuations in optimal release a major limitation of flood rule curves is their inflexibility during real time operation especially with environmental constraints şensoy et al 2018 notwithstanding the limitations rule curves offer a backup even when advanced decision making tools are present valdes and marco 1995 improvements in the way rule curves are developed and implemented would be helpful in flood control regulation these topics are discussed next 2 2 concept of flood limited water level flwl reservoir operation during the flood season should aim to moderate floods while conserving water to meet dry season demands the concept of flood limited water level flwl to operate reservoirs during the flood season was developed in china where a distinct flood season is experienced however the concept can be applied to any region which has a distinct high flow season and the reservoirs follow a drawdown refill cycle somewhat similar is the concept of wurbs and cabezas 1987 redistributing reservoir storage capacity in brazos basin usa based on the seasonal variation of floods properties the maximum allowable water level to be maintained in the reservoir to ensure adequate vacant space for flood control during the high flow season is termed as the flood limited water level flwl li et al 2010 the storage space between flwl and the maximum water level mwl or full reservoir level frl is used to store flood water fig 3 flwl is an important parameter that governs the trade off between flood control and water conservation yun and singh 2008 liu et al 2008 li et al 2010 flwl computed using the annual design storm does not vary within the flood season if the reservoir water level at the beginning of flood season is above flwl it is lowered to flwl and near the end of the flood season the reservoir is filled up to frl use of single valued flwl also termed the annual flwl is sub optimal in some cases if the flood season begins late and the reservoir level is low demands may be met partially till inflows increase sufficiently if flood season ends before the usual dates reservoir may not be filled to the desired level and shortages may be faced hence flood mitigation policies have to be devised considering significant variability in timing magnitude and frequency of flood flows for the flood mitigation strategies to work efficiently it is desirable to identify multiple sub seasons weeks months within whole flood season flood season is usually segmented by adopting one of the following methods i graphical method ouarda et al 1993 ii evaluating relative flood frequencies black and werrity 1997 cunderlik et al 2004 chen et al 2015a xiong et al 2018 iii directional statistics fisher 1995 ouarda et al 2006 chen et al 2013a iv probability change point analysis liu et al 2010 zhou and guo 2014 v fuzzy c means clustering wang et al 2012 the commonly used indices in the flood season segmentation are precipitation information jiang et al 2017 flood volume jiang et al 2017 and flood discharge data cunderlik et al 2004 chen et al 2010 2013 jiang et al 2015a the index magnitude and the time of occurrence are the prime considerations in a flood segmentation method probability change point analysis method is reported to be more objective compared with the other two methods of segmentation in terms of identifying the exact dates of change of points jiang et al 2017 zhou 2022 two pioneering improvements in flwl approach are the multiple duration flwl mdflwl also termed as seasonal flwl liu et al 2008 mu et al 2022 and the dynamic flwl dflwl yun and singh 2008 in case of mdflwl instead of deriving one design storm for the whole flood season design storms for smaller durations such as a month are derived and used to determine monthly limited water level fig 4 shows the monthly and annual duration limited water levels mdflwl are commonly higher than the annual flwl implying that more water is conserved and the demands are served better since occurrence of a large flood event early in the flood season reduces the occurrence probability of another large event in later parts of the flood season and vice versa the limited water levels in the subsequent periods can be raised for that year by using conditional probabilities of occurrence of large storms in the reservoir s catchment the limiting water levels in the larger segments do not require an adjustment in case no large floods occur in the initial segment dynamic flood limited water level dflwl method considers revising the limited water levels dynamically in light of new data applications of dflwl showed that it conserves more water in the reservoir without harming its effectiveness in flood control and water shortages due to delays in flood season or short flood season can also be addressed some studies have recommended following monthly limited water levels in actual reservoir operation in place of annual flwl analysing the performance of the annual flwl li et al 2010 noted that the reservoir operation by using the flwl gives high priority to low probability flood events and neglects the inflow uncertainty in this regard researchers have successfully integrated the forecast information in the reservoir operation module within the flood season commonly called the dynamic flwl during real time operation li et al 2010 peng et al 2017 wan et al 2021 dynamic updating of flwl in the flood season provides better water utilization a direct improvement to the mdflwl seasonal flwl is to optimize the seasonal water levels using non dominated sorting genetic algorithm ii nsga ii liu et al 2015a and non linear complex method xie et al 2018 jiang et al 2015b identified the seasonal flwl while considering forecast error as a fuzzy variable and using a credibility based chance constrained simulation incorporation of seasonal flood risk analysis zhou and guo 2014 and analysis of hydrologic hydraulic and reservoir conditions zhou et al 2015 along with forecast information has allowed higher water conservation levels in the sub seasons the characteristics of 2011 flood in the chao phraya river basin thailand komori et al 2012 contradicts the supposition of conditional probability of occurrence of successive large events in the multiple flood sub seasons yun and singh 2008 this is because the high rainfalls in the season occurred due to multiple typhoons initially followed by an above normal monsoon rainfall in the year when the downstream flooding in the basin could be attributed to low terrain slope poor inflow forecast led to bad flood mitigation at the reservoirs leading to levee breaks another notable aspect is the lack of flood operation strategies for an early start and late ending of flood season hence it is recommended to devise flood operation policies that takes into consideration within year and across year variability of floods within the flood season such an adaptive reservoir operation strategy along with reliable forecast of precipitation and evaporation helps in real time operation of reservoirs for flood mitigation kompor et al 2020 abhishek et al 2021 loc et al 2023 revisited the effect of reservoir operation in mitigating the 2011 flood of thailand and found that the event was catastrophic and the downstream flooding was inevitable because of large local flows the dynamic flwl approach was also implemented to derive joint operation schemes for cascade reservoirs chen et al 2013b tan et al 2017 zhou et al 2018a zhou et al 2018b and mixed cascade reservoirs zhou et al 2014 chen et al 2022 the size of the problem was tackled using aggregation decomposition technique gong et al 2020a and dynamic programming zhou et al 2014 to drive the optimal dynamic flwl progressive optimality algorithm poa chen et al 2013b zhou et al 2014 zhang et al 2018 nsga ii zhou et al 2018a gong et al 2020a ma et al 2020 non dominated sorting culture differential evolution nscde algorithm liu et al 2019 and particle swarm optimization pso chen et al 2022 were used even though the studies discussed above vary in the techniques used to derive dynamic flwl optimal seasonal flwl and joint dynamic flwl for multi reservoir system the problem was formulated to seek trade off between flood mitigation and conservation use floodplains of some rivers can temporarily hold substantial quantity of water and hence joint operation of reservoirs and floodplains can be highly beneficial without additional flood risks xie et al 2018 xiong et al 2019 analysed annual flwl based on design flood in construction period and design flood in operation period using the multivariate t copula and the genetic algorithm ga and implemented the methodology on a system of 13 cascade reservoirs the results revealed that compared to the design floods in construction period the design floods in operation period for the downstream reservoir were considerably reduced by the regulation of upstream reservoir which had facilitated raising the annual flwl for the downstream reservoirs ma et al 2020 examined flwl from the perspective of fishery they proposed an optimizing framework to compute the optimum water levels by adopting a three objective hydropower generation flood control and fish spawning evolutionary algorithm studies reviewed here have examined the various facets of flwl performance of flwl is satisfactory even when flow forecasts are not available most of the flwl studies were conducted in china and the applications of this approach in other countries is low 2 3 hedging in reservoir operation for flood control hedging is basically rationing of water supplied for various demands its rationality is that the expected marginal benefit from storage must be the same as the marginal benefit from release draper and lund 2004 when applying the hedging concept for flood control storage space to moderate floods is considered a scare resource which should be judiciously allocated between the current and future time periods hedging is difficult in large flood events owing to enormous flood volume and would be of little help for small floods the optimal hedging releases are useful for medium floods to minimize the overall risk zhao et al 2014 hui et al 2016 hedging involves accepting small current losses so as to avoid larger future losses fig 5 depicts an operating policy based on the hedging concept in the backdrop of the standard linear operating policy jain and singh 2003 jain 2013 the reservoir releases r depend upon the expected water availability during the decision period from time d onwards on x axis the operator may keep reservoir sufficiently vacant by progressively increasing releases thereby minimizing flood risk the downstream flood risk is avoided by making releases smaller than the safe river capacity horizontal line at r the parameters in a two point linear non linear hedging rule analogous to the generalized two point hedging rule identified by kumar and kasthurirengan 2018 are the starting and ending water availability swa and ewa respectively pre depletion of storage before a flood increases vacant storage and increases the ability to regulate large future floods this is akin to hedging reliable forecasts help in successful implementation of hedging concept although the downstream flood protection is enhanced by pre releases from the reservoir excessive releases increase downstream flood risk and may also increase water shortage if post flood inflows are insufficient chou and wu 2013 studied the post flood water shortage risk under various pre release strategies and identified target pre release strategy before the arrival of the typhoon for a given acceptable shortage risk compared to historical operation this strategy helped in retaining 50 of the inflows in the reservoir and the maximum release was 10 below the safe capacity of downstream river with perfect forecast of incoming storm and known damage function optimal pre releases could be made hui and lund 2015 hui et al 2016 attempted to minimize the overall losses that arise due to pre releases under various cases of storm forecasts and damage functions hua et al 2020 extended the pre release concept considering the dry days between flood occurrences depending upon the forecast lead time and the expected length of dry days releases were made either to vacate the space above the upper bound of dynamic control of flwl dc flwl or to generate hydropower lately wei et al 2022 developed a framework to derive optimal flood reservoir operation by including an early stage pre release module to create flood cushion in the reservoir and followed by using a fuzzing algorithm to select suitable operating policies zhao et al 2014 employed hedging to derive flood operation policy suitable for real time operation analogous to water supply hedging rule of draper and lund 2004 this was a two stage policy which could be adopted in real time during the progression of a flood event and within the forecast period they used the karush kuhn tucker kkt condition to optimally allocate the expected flood safety margin efsm the difference between the expected flood volume and the safe carrying capacity of the river at the downstream control point between the current period and remaining periods in forecast horizon unlike the formulations which seek trade off between water conservation and flood risk here the final water level in the reservoir reaches the target level only when the efsm is greatly allotted to channel in most of the time periods the study assumed no fail condition of the reservoir which may not be realistic ding et al 2017 specified three types of hedging rules in their theoretical analysis to seek trade off between flood risk and water conservation the comprehensive analysis provides the decision makers with a range of plausible optimal hedging flood releases for various levels of acceptable risk ding et al 2015 2017 described the mathematical underpinning for a two stage hedging operation to seek trade off between water conservation in stage 1 see eq 1 and flood risk in stage 2 see eq 2 they considered flood risk associated with inflow uncertainty to be zero in stage 1 as the forecast error in the near future is less and the water conservation loss in stage 2 is taken as 1 as the target level at the end of flood season is set to the lower flwl the objective functions for stages 1 and 2 are given as 1 g w 1 w 1 s r s 1 s r s min m w r w 1 w r m 2 g f 2 δ σ δ h ε d ε in eq 1 sr denotes reservoir storage capacity for water supply and w r is corresponding water availability smin is the storage corresponding to lower bound of flwl and w1 is the water availability in stage 1 further w1 is the difference between s1 and smin and is denoted as excess storage carried over to stage 2 as water conservation the shape of the water conservation objective function is guided by factor m m 1 is the condition for a convex g w 1 hui et al 2016 in eq 2 h ε is the probability density function of forecast error ε with forecast uncertainty σ the downstream flood risk is brought into the objective function g f 2 through δ which is the efsm zhao et al 2014 the general framework of ding et al 2015 2017 utilized by zhang et al 2022 to derive hedging operation rules that considers flood risk and hydropower generation as two purposes of the nierji reservoir china another real time implementation of hedging is credited to wan et al 2016 who derived hedging refill strategies kkt conditions were used to solve a two stage optimization problem and the result showed that the refill operation is optimal when the marginal loss of conservation in the current period equals the marginal flood damage in the future period implementation of the methodology highlighted its practical use as it invoked gradual refilling of reservoir using forecasts a hedging reservoir operation strategy similar to water supply hedging rule yun and singh 2008 was proposed by xu et al 2020a they modified the linear hedging refill rule of wan et al 2016 and defined a quasi linear hedging rule for real time flood operation the methodology consisted of a two stage kkt based optimization model that attempted to minimize the overall risk flood risk at the current time step and water shortage risk at a later stage fig 5 shows hedging rule used in the study the study adopted a static swa and ewa as decision variables thereby leaving a scope to test the efficacy of the use of dynamic swa and ewa in flood mitigation in real time results suggested that the hedging rules conserve more flood water and improved deliverability than the designed flood control rules or capacity constrained pre release rules without increasing flood risks lian et al 2019 incorporated environmental safety against the vibration induced due to large reservoir releases in flood operation the risk of environmental safety was considered by a two period reservoir dispatch hedging model constraints were placed on the relationship between the root mean square rms of acceleration in the vertical direction and the discharge estimated by field tests and hydraulic model if forecasts show higher floods restricted releases are made to deplete the reservoir subject to near field vibration safety discharge hence a two stage optimization framework that minimizes risk of safety was adopted optimal allocation of the gap between the expected flood volume and the near field vibration safety discharges analogous to the efsm in zhao et al 2014 was the objective of the study that sought trade off between environmental safety and water conservation authors concluded that in case of a large flood the hedging strategy can alleviate the average near field vibration better than uniform discharge the efficacy of flood control operation largely depends on the accuracy of inflow forecast available flood storage space in the reservoir and downstream channel acceptable risk and decisions maker s preferences for other water uses thus there is need for a comprehensive dynamic hedging strategy that helps managers attain the largest benefits without compromising on dam safety currently potential of hedging is underutilized and more research on this topic is needed 3 systems analysis techniques commonly two systems analysis techniques optimization and simulation are used for optimal design and operation of a hydro project optimal solution of problems that involve competitive water demands needs systems approach as a methodological way votruba 1988 optimization is the technique to find the best solution amongst a number of feasible alternatives labadie 2004 reviewed applications of optimization methods to reservoir systems he also provided an overview of multi objective and heuristic optimization procedures besides application of machine learning algorithms neural network and fuzzy theory in reservoir operation generalized formulations of optimization models for flood control problems are described in appendix a supplementary file simulation technique mostly follows a trial and error approach to determine the best set of design or controlling variables jain and singh 2003 a working simulation model of the system is developed and is used to find answer to the question what if answer to this question leads to assessment of the consequences of a decision although simulation and optimization are different approaches many models employ both while converging to the optimal solution optimization models reproduce behavior of the system by a simulation model it is often impossible to consider all the complexities of a system in an optimization model but a simulation model can handle most such complexities at times it is best to use optimization and simulation together to harness the strengths of both techniques rani and moreira 2010 an optimization model may be used for preliminary screening of alternatives and the short listed alternatives may be investigated in detail by a simulation model wurbs 2005 using systems approach a number of generalized mathematical models that analyse the river reservoir system include the tools developed by the hydrologic engineering center hec u s army corps of engineers such as the hydrologic modeling system hec hms river analysis system hec ras reservoir system simulation hec ressim and flood damage reduction analysis hec fda https www hec usace army mil the corps water management system links hec hms hec ras hec ressim and hec fia flood impact analysis its public version hec rts real time system is still under development şensoy et al 2018 other models include mike 11 le ngo et al 2008 nih resyp nih reservoir systems package developed by the national institute of hydrology of india goel et al 2020 and riverware developed at university of colorado https cadswes colorado edu zagona et al 2001 and modsim labadie 2006 shenava and shourian 2018 in these software reservoir operating rules policies are implemented through a set of logical and mathematical statements recently the soil and water assessment tool swat has been updated to include generalized reservoir operation module swat m which is suitable for small reservoir with flood control function and for large multipurpose reservoirs wang et al 2022 3 1 applications of systems analysis techniques for flood management real life reservoirs are operated by using rules of thumb rule curves and operation policies the decision making concerning reservoir flood management involves risk jain et al 1992 suggested a methodology with explicit risk consideration to develop flood season operation policy for a reservoir by maximizing storage at the end of the flood season ensuring that the risk of an overflow is kept below the acceptable limit jain et al 1998 divided the reservoir flood control space in two parts lower and upper when reservoir level is in lower part incoming flood is regulated by following the normal flood regulation policy if the reservoir level rises to the upper part and safety of the dam is threatened attempts should be made to lower the level at the earliest the current reservoir level and nature of inflow increasing or decreasing determines which operation mode to follow le ngo et al 2007 derived optimal flood rule curves considering the downstream non damaging discharge conditions the suitability of the operating policies can be evaluated based on indices related to the flood mitigation efficiency e g peak reservoir release maximum water level mean number of gate maneuvers power generation bianucci et al 2015 in addition to reservoir operation holistic assessment of hydroclimatic extremes is helpful to manage associated environmental societal and economic challenges lazin et al 2022 abdi dehkordi et al 2021 applied system dynamics approach to integrated flood management by considering structural and non structural flood mitigation measures the structural measures were the dams and watershed management and the non structural measures included determination of the reservoir level at the start and safe reservoir release at the start and end of the flood it was found that a 200 year return period flood could be reduced by 62 by adopting integrated flood mitigation strategy zhao et al 2022a in their work proposed and employed a novel ann based framework to develop intensity duration frequency idf curves and flood risk change maps in the changing climate and socio economic scenarios for phnom penh cambodia the study emphasized on the joint implementation of mitigation structural measure and adaptation strategies non structural measures to attain best and sustainable results their adaptation strategies are flexible to be extended to other geographic locations and also put forward the expertise of the policymaker for efficient and effective countermeasures due to climate and landuse land cover lulc changes reservoir inflow and demand properties may change and previously developed rule levels may not remain optimal hence dynamic rule curves may be adopted wherein the system under study is re optimized for every operational period by using ensemble streamflow and forecasts of water demand to produce ensemble of optimized reservoir storages the optimized storage values are used to produce rule levels for each operational period as a function of the system state and streamflow forecast an advantage of this method is that systems self adjust as the climate evolves lee et al 2011 convergence of optimization algorithm to a local optimum is a common problem and many attempts have been made to address it diao et al 2022 presented an improved version of the particle swarm optimization pso algorithm called simulated annealing pso sapso algorithm to optimize flood peak reduction through a reservoir by applying sapso algorithm to the operation of a cascade system the authors could reduce the maximum outflows by 9 to 18 and lower maximum water levels by about 0 4 m in two reservoirs to harness the advantages of both simulation and optimization many researches have used s o approaches for flood control reservoir operation the coupled s o approach has been widely used for design of flood control reservoirs or to develop operation policies the decision variables in the optimization formulation are either the reservoir releases or the parameters of the operation policy which are obtained by optimizing a single objective flood mitigation or multiple objectives flood mitigation and other purposes le ngo et al 2007 finding efficient operating policies for a complex multi reservoir system with simulation alone is challenging the combined use of simulation and optimization gives a framework to efficiently complete this task rani and moreira 2010 the basic idea behind coupled so is fig 6 an outer loop finds optimum values for the decision variables by using an approximate system configuration and an inner loop simulates operation by using more realistic configuration determines the values for the uncertain variables completes statistical evaluation and returns values that the outer loop search process can use the process repeats till the best possible outcome is obtained in case of flood control operation the optimization model guided by a particular objective function searches for optimal decisions during each operation period when all the simulation runs are complete the outputs are compiled and the best decisions are used to establish operation rules yazdi and neyshabouri 2012 coupled the mike 11 software for simulation with nsga ii model for optimization to determine the optimal dam height considering trade off between the construction cost and downstream flood damages the dynamic nature of a river reservoir system requires that flood rule curves be developed for the reservoir as well as the downstream river le ngo et al 2007 adopted such an approach by coupling mike 11 and shuffled complex algorithm sce for optimization they adopted a two stage optimization model comprising of three objective functions minimization of maximum reservoir level maximizing hydropower generation and maximizing conservation storage s o approach was used to modify the design rule curves by considering the altered reservoir inflow conditions due to climate change lee et al 2009 lee et al 2011 or the ecological flow requirements dittmann et al 2009 ma et al 2020 the flood mitigation through peak outflow reduction along with conservation of water at the end of the flood season were the primary objectives in most studies the direct interpolation of monthly optimal flood rule curve parameters to daily scale was found to increase the flood risk hence lee et al 2011 suggested that daily rule curves should be developed independently gabriel martin et al 2020 emphasized the use of dynamic conservation levels which are attainable based on the expected seasonal inflows and the initial reservoir level when the flood enters the reservoir the optimization was performed using generalized software like the hec prm hydrologic engineering center prescriptive reservoir model https www hec usace army mil software and evolutionary algorithms which were found efficient in handling multiple objectives albo salih and mays 2021 used combined optimization simulation approach consisting of four models interfaced through matlab a rainfall forecasting model a rainfall runoff model a combined 1d 2d unsteady flow model hec ras and an optimization model solved using genetic algorithm they found that although the genetic algorithm required many function evaluations simulation runs of hec ras to reach an optimum solution it is amenable to interface with simulators zhao et al 2022b integrated the hec hms and the flo 2d models to accurately infer the impact of dams and reservoirs on reducing flood inundation for various events of return period 5 20 50 200 and 500 years excessive withdrawal or diversion of water from rivers is harmful to the health of a river hence assessment and implementation of environmental flows e flows is important for maintaining healthy ecosystems during flood season flows in most rivers are enough to meet the needs of environment hence this topic is not further pursued here the objectives of reservoir flood control operation viz minimizing the maximum reservoir water level as well as downstream water levels can be efficiently achieved through the use of advanced optimization algorithms such as multi objective evolutionary algorithms moeas the advantage of multi objective evolutionary algorithms moeas over traditional multi criteria methods is that these could produce a set of non dominated solutions in a single run zhou et al 2011 the inbuilt superiority of the improved non dominated sorting genetic algorithm iii ensga iii could produce more preferred solution than nsga ii chen et al 2017 combination of conventional decomposition techniques with moeas moea d have received wide application recently qi et al 2017 zhang et al 2019a yang et al 2022 moea d decomposes the target multi objective optimization problem into multiple sub problems by using aggregation approaches and then optimizes them simultaneously by using an evolutionary algorithm such models were found to be suitable to incorporate preference information weights moea d pwa which could refine the solution search qi et al 2017 thoughtful amendments to any evolutionary algorithm e g nsga ii like the re initialization of the initial population of the decision variables releases in the forecast period based on executed reservoir releases in the previous time steps and use of a differential evolution operator for the evolutionary process creates an interactive model that involves the decision maker s expertise liu and luo 2019 zhang et al 2019a in finding preferred solutions the dynamic changes occurring in the physical river reservoir system such as the hydro meteorological conditions in the catchment the vacant storage for flood mitigation the river stage at the damage center and the available river capacities below the bank full stage influence the reservoir operation decisions prakash et al 2015 liu and luo 2019 an adaptive so framework in which the flood hydrograph was divided into three phases according to their slope in the rising and recession limbs was used by prakash et al 2014 in a multi reservoir system to consider dynamic changes prakash et al 2015 and chou and wu 2015 used similar approach for a single reservoir system note that the studies considered mitigation of a single flood event with specified initial conditions at the river and the reservoir the priorities of the operator with the progression of the flood event were driven by invoking one or more of the objective functions within the so framework the nsga ii prakash et al 2014 2015 and bobyq chou and wu 2015 were used to solve the multi objective optimization problem most earlier studies did not consider the social implications of the flood regulation however several recent socio hydrological studies have addressed the complex interaction between flood and humankind baldassarre et al 2013a b 2017 fuchs et al 2017 albertini et al 2020 proposed a socio hydrological tool to simulate interaction between humans and flood that represents the modifications in the reservoir flood management approaches and the changes to the downstream levee system the model was implemented to evaluate three flood protection strategies the green systems where the affected community is resettled out of the flood prone area the technological systems where the societies depend on structure measures like a levee for flood protection and the green to techno systems in which societies shifts focus from nature based to technological tools data of brisbane australia was used to explore floodplain dynamics by simulation of likely future scenarios results showed that flood risk depends on changes in flood and drought memory of reservoir operators and risk awareness influences how floodplains are urbanized fig 7 higher and frequent flood occurrences enhance the social flood memory in the green system whereas the technological system experiences severe losses if flood losses are large and larger structural measures are technically or economically unfeasible the green to techno solutions may develop as a green floodplain management system the loop diagram of fig 7 shows how the state variables in the model are related and interact the foregoing discussions indicates that most of the studies on reservoir operation during flood have used coupled s o framework a variety of optimization methods have been employed for reservoir operation optimization and the utility of the results depends on how realistically the problem has been formulated and solved several researchers have suggested that a multi objective formulation carefully considering conflicting objectives may yield better operational strategies 3 2 operation of a network of multi purpose reservoirs the development of operation policy for multi purpose multi reservoir systems is even more challenging because of nonlinearity high dimensionality correlated decision variables and conflicting objectives different reservoirs receive different regulated and unregulated inflows have different storage capacities and different vacant storages however by skillful regulation these factors can be turned to advantage and a high peak hydrograph can be turned into an outflow with smaller peaks lund and guzmann 1999 provided an overview of operating policies for network of multipurpose reservoirs and also highlighted the opportunities for developing rules for water allocation and storage for various system configurations and uses a widely studied strategy for flood control operation is the dc flwl the concept was extended to a multi reservoir system by chen et al 2013b zhou et al 2014 ouyang et al 2015 zhou et al 2018a zhou et al 2018b gong et al 2020a and lu et al 2021 in network application dc flwl is simultaneously derived for all the reservoirs in the system the optimization algorithms to arrive at the optimal dc flwl for each reservoir in a system include progressive optimality algorithm poa chen et al 2013a zhou et al 2014 modified self adaptive electromagnetism like mechanism sem algorithm ouyang et al 2015 ngsa ii zhou et al 2018a gong et al 2020a and stochastic programming lu et al 2021 the studies were implemented on cascade reservoir system or mixed reservoir systems with encouraging results they confirmed that jointly developed operation rules for multi reservoir systems provide better flood protection than the individual flood operation rules moridi and yazdi 2017 keophila et al 2019 zhang et al 2019b and there was higher water conservation in joint operation a concern with so framework is that the problem dimensionality increases with the number of reservoirs curse of dimensionality is a common problem in studies dealing with multireservoir systems a popular approach to tackle this problem is the aggregation decomposition ad wherein reservoirs are aggregated into a single virtual reservoir whose operation is optimized and the decisions are distributed among the individual reservoirs liu et al 2011 a third order hierarchical optimization decomposition model was also found suitable in arriving at optimal releases from a group of reservoirs jia et al 2015 the ad approach was used to derive optimal joint flood control rule curves for a parallel multi reservoir system in the lijiang river basin by pan et al 2020 who used the nested annealing accuracy penalty function adaptive multi variant particle swarm optimisation aapf ampso algorithm to maximize the peak reduction decomposition of the aggregated results was based on the ratio of the flood storage capacity in individual reservoirs to the aggregated single reservoir application of this technique resulted in higher reduction of flood peaks li et al 2019 reduced the number of reservoirs to handle by identifying a set of effective reservoirs that were jointly operated non effective reservoirs were handled separately this method was tested on a system of 14 reservoirs in the huaihe river basin china it was shown that the number of reservoirs to be handled could be halved while equivalent flood control benefits were achieved dynamic programming dp has been widely employed for optimizing reservoir operation rules nandalal and bogardi 2007 as it can efficiently handle discrete variables and non convex non continuous and non differentiable objective functions however the curse of dimensionality limits its use in optimization of multi reservoir systems to overcome this curse modified dp algorithms like the discrete differential dp dddp cheng et al 2014 and the progressive optimality algorithm poa zhou et al 2018b have been used zhou et al 2018b used dp poa in a two stage model to derive optimal rules for a cascade of reservoirs with multiple control points by sequentially progressing from upstream to downstream the three stage operation of flood mitigation proposed by chou and wu 2015 was extended to a parallel set of multi reservoir system by zhu et al 2021 who used the stage wise storage compensation method to arrive at the optimal flood routing policy while maximizing the outflow peak reduction rate hui and lund 2015 investigated the impact of hydrograph shapes in arriving at optimal operation of parallel reservoirs four basic hydrograph shapes that appeared in connaughton et al 2014 were considered and two useful concepts that relate peak flow reduction and additional storage requirements were defined flood storage efficiency fse the peak reduction per unit storage and marginal flood storage efficiency mfse first derivative of fse optimal flood storage allocation was derived for various combinations of storms a conclusion was that flood storage be allotted such that the mfse is equally distributed among the reservoirs and the series of storms the derived optimal flood storage capacity allocation rules were successfully applied to the oroville and the new bullards bar reservoirs in california zhang et al 2016 explicitly considered movement of flood waves in the downstream river channel a hybrid algorithm termed as the progressive optimality algorithm and successive approximation poa sa was used to solve the optimization problem application to the multi reservoir system in the xijiang river china showed that the peak of flood could be reduced by 12 8 for the 100 year return period flood a multi objective stochastic programming algorithm with recourses mosp by considering inflow forecasts errors as stochastic and having spatial and temporal correlation was proposed by xu et al 2020b they used an epsilon constraint method to find optimal solution and explicitly considered risk objectives they tested the developed methodology on the pi river basin in china and reported that the non inferior solutions provided by mosp could conserve more water while reducing flood risk design floods are important in flood control regulation flood risk may be over or under estimated if the flood spatial pattern fsp of design flood is incorrectly considered tan et al 2017 considered capacity compensation regulation and uncertainty of fsp to develop a model for a system of serial multipurpose reservoirs to derive dc flwl in compensation regulation a part of flood control storage in an upstream reservoir is reserved for the downstream reservoir moridi and yazdi 2017 developed a general nonlinear non convex multi objective optimization model for a multi reservoir system to mitigate flood release rate from the reservoir and the flood storage capacity of the reservoirs were considered as decision variables and mixed integer linear programming milp algorithm was used to solve the model the study considered two scenarios a 2 reservoir system cascade and a 6 reservoir system mixed with 25 and 50 year return period floods it was revealed that if the 6 reservoirs are simultaneously operated flood damage would be fully prevented without much reduction in hydropower generation sudheer et al 2019 carried out a post event analysis of august 2018 kerala india floods that affected large population and damaged infrastructure and environment one of the worst affected basins the periyar river basin prb has 17 interconnected dams barrages authors analyzed reservoir operation to examine the possibility of improvements and to find whether pre depletion of the prb reservoirs could have helped in higher flood attenuation they concluded that releases from major reservoirs had a minor role in flooding in the prb most of the flow that caused damages came from the areas which did not have any reservoir thus better reservoir regulation would have helped in limited reduction of flood peaks improved decisions were possible if reliable rainfall forecasts at higher lead time were available floods and droughts are two extremes of the hydrologic cycle and an integrated management can reduce the harmful impacts of these bahrami et al 2022 studied and compared scenarios of integrated management of floods and droughts imfd and non integrated management nmfd by means of reservoirs they found that when nmfd is practiced drought conditions for downstream water users were intensified all the water users had higher vulnerability and the scenarios were less sustainable greater wealth was generated in the imfd scenario ifmd is a powerful concept for countries like india where dry season comes a few months after the flood season although many reservoir operation studies have been conducted employing systems analysis tools the largest size of systems considered so far is about 14 reservoirs more research is needed to develop methodologies for regulation of larger reservoir systems to manage large water resources systems it is important that the selected model has the ability to efficiently handle complex systems further the success of flood control operation by reservoirs critically depends on accurate rainfall prediction at higher lead times 4 real time flood control operation of reservoirs in a flood event reservoir inflows and flows in downstream river can rapidly change and the operators need to take implement and update decisions accounting for changed situation thus the main feature of real time flood control operation is to implement decisions based on the system state at that very instant reliable forecasting of streamflow is essential for efficient flood control operation of reservoirs mathematical models are of great help in inflow forecasting and assist operators in taking right decision in this section we briefly discuss the use importance and methods of flow forecasting followed by real time flood control operation of reservoirs 4 1 flow forecasting flow forecasting ff is the estimation of future water levels or flows at a single or multiple sites of a river system for different lead times tiwari et al 2021 it is one the most challenging and difficult problems in hydrology jain et al 2018 when reliable forecasts of incoming floods are available sufficient in advance projects can be operated more efficiently forecasts of floods are commonly prepared by using a hydrologic model depending upon the catchment features size climate etc the hydrologic model may be a flood routing model a rainfall runoff model a statistical model etc the typical inputs to a flow forecast model are observed precipitation and or flows if precipitation forecasts are available in real time better forecasts with higher lead times can be prepared point measurements of precipitation are commonly used to compute spatial average values these days such measurements may be supplemented by data obtained from weather radars which produce spatial estimates of precipitation and also describe storm movement forecast based operation of reservoirs provides better flood mitigation reduces water deficit and meets ecological demands wang et al 2019a a key requirement in real time reservoir operation is to update release decisions based on the current and forecasted inputs to the reservoir fig 8 shows a schematic of real time reservoir operation by using inflow forecasts rainfall runoff models are frequently used to transform rainfall observed or predicted into reservoir inflows whose values are used for decision making in recent times the field of flood forecasting has significantly advanced jain et al 2018 reviewed techniques and applications of flood forecasting they highlighted the need for computationally efficient models that can adequately consider catchment properties and their variabilities can efficiently update forecasts can compute uncertainties in forecasts and incorporate them in decisions and warnings ensemble forecasts that rely on a set of likely forecasts help produce better forecasts and provide estimates of uncertainty in outcomes a hydrologic model forced by an ensemble of precipitation forecast provides a band of reservoir inflows and estimates of forecast uncertainty wu et al 2020 reviewed the current status and future opportunities in ensemble flood forecasting many of the works reviewed by them have focused on research questions related to ensemble modeling techniques or their use to simulate past flood events greater application of ensemble forecasting would definitely help in improved flood control by reservoirs the latest advancement in the domain of streamflow prediction is the use of artificial intelligence ai models namely long short term memory lstm gated recurrent unit gru and least squares support vector machine lssvm guo et al 2021 he et al 2022 typical components of reservoir flood forecasting and control systems are telemetering and data acquisition data communication database management real time forecasting decisions concerning release of water flood warning and dissemination and updating guo et al 2004 described a reservoir flood forecasting and control system rffcs which integrated all these components it was probably one of the earliest systems that was implemented at a large number of reservoirs guo et al 2004 described in detail the application of rffcs to the danjiangkou reservoir china and listed several benefits from its use in later times many similar systems were developed and used across the world che and mays 2015 2017 connaughton et al 2014 explored the role of inflow forecasting by comparing the efficacy of three flood operating rules in controlling the peak of outflow and provided insight into the role of inflow forecasting and damage functions in reservoir operation they used four hydrograph shapes triangular flood pulse abrupt wave and broad peak and three operation rules i the minimize flood peak rule uses vacant reservoir storage to control flood ii the minimize flooding frequency rule reservoir release is kept below the safe carrying capacity of the downstream river to the extent possible and iii the short forecast peak minimization rule use existing flood storage capacity to minimize peak over a short future horizon in this rule release rt is calculated as 3 r t t t f i t τ d τ s t f where st is unfilled storage capacity at time t f is the forecast period and it are the forecasted flows eq 3 is basically the pack rule of reservoir operation jain and singh 2003 without using inflow forecast the flood storage capacity may fill up before the arrival of flood peak and moderation would be less however flow forecast errors and uncertainty pose a challenge in the reservoir operation if the forecast errors are heteroscedastic variance increases as inflows increase forecast uncertainty would be large when the inflow is large hence a larger part of storage would have to be reserved to control floods but when forecasted inflow is comparatively small due to heteroscedastic forecast errors forecast uncertainty will be smaller this requires that reliable forecast horizons be identified for an efficient forecast based flood control operation zhang et al 2019b wang et al 2021a traditionally lumped catchment models are used to prepare reservoir inflow forecasts but at times these models are unable to provide the desired accuracy errors may also creep in due to complex catchment conditions and data errors this promoted the use of physically based distributed hydrological model pbdhm to forecast inflows yang et al 2022 xu et al 2021 however research is needed to overcome issues concerning calibration and forecast updating while using pbdhm in future pbdhm will likely be increasingly used in reservoir inflow forecasting the performance of hydrological models for forecasting could also be improved through data assimilation techniques leading to their wider use in real time operations zhang et al 2021a in the past few decades machine learning ml methods have been developed to simulate the complex processes of flood formation li et al 2010 mosavi et al 2018 reviewed the state of the art of ml models in flood forecasting popular ml techniques include artificial neural networks anns adaptive neuro fuzzy inference systems anfis multilayer perceptron mlp wavelet neural networks support vector machines svm and ensemble prediction systems ml models can learn the nonlinear rainfall runoff process based on historical data and do not require detailed knowledge of the underlying processes training is very important in application of ml methods an improperly trained ml model can give misleading results anns and deep networks are the most popular ml tools used in water resources because of their accuracy fault tolerance capacity and parallel processing abilities some studies have tried to use an ensemble of ml methods to increase the generalization ability and reduce uncertainty use of ml methods for hydrological modeling and forecasting is expected to grow with time hydrodynamic models are commonly used to compute the flood inundation areas ridolfi et al 2019 making reliable forecasts particularly in data scarce areas is a challenge and forecasts have considerable uncertainty to overcome this handicap satellite based flood data say synthetic aperture radar images are being assimilated with hydrologic model output to reduce the uncertainties in forecasts for example garcía pintado et al 2015 hostache et al 2018 described algorithms that automatically delineate flood inundated areas and found that that the downstream water levels forecasts were significantly improved by sequential assimilation of flood extent maps and the errors were reduced by half despite numerous benefits by the use of forecasts for reservoir operation and flood management reliable short term forecasts are not widely available and used in reservoir regulation particularly in developing countries key reasons behind this are lack of skills and expertise lack of data and lack of infrastructure logistics it would be hugely rewarding to overcome these limitations pappenberger et al 2015 estimated potential monetary benefits of early flood warnings in europe by using flood damage cost data and found that the benefits were to the tune of 400 euro for every 1 euro invested 4 2 real time flood control operation of reservoirs real time flood control operation is accomplished by integrating i data collection ii validation and processing of observed data iii flow forecasting iv flood reservoir operation and v information query cheng and chau 2004 rani and moreira 2010 emphasized on developing computationally intelligent decision support tools various researchers have attempted real time reservoir operation for flood mitigation by integrating a flood forecasting model with an optimization model some of the optimization models that were used to make reservoir release decision during the forecast period were milp hsu and wei 2007 wei and hsu 2008 2009 ga chang et al 2010 pre emptive goal programming choudhury 2010 gp fallah mehdipour et al 2012 later ga in combination with model predictive control mpc technique had found wider application in the field chiang and willems 2015 schwanenberg et al 2015 vermuyten et al 2018 yang et al 2019 used the recurrent neural networks rnn to simulate reservoir operations the optimization models approximately represent the physical system hence various system simulation models were integrated with optimization models for real time reservoir operation malekmohammadi et al 2010 bayat et al 2011 wang et al 2013 evolutionary algorithms like ga penalty type ga reduced ga have found wide application to reservoir operation and specifically to real time reservoir operation for flood mitigation due to their suitability in coupling with hydrologic modelling software chang 2008 che and mays 2017 vermuyten et al 2018 liu and luo 2019 che and mays 2015 2017 developed and illustrated the applicability of an elaborate real time optimal operation model for a multi reservoir system that consists of i a short term rainfall forecasting module ii hec hms for rainfall runoff modelling iii hec ras for unsteady river flow routing and iv ga based optimization module to decide on reservoir releases the optimization algorithm was developed by using matlab which also served to link the hydrologic models applications of the model to a hypothetical system showed their utility and suitability but problem may arise in practical applications when a key module fails to give realistic output in many cases the managers lacked predictive information to control reservoirs and mitigate extreme floods this was experienced in managing the largest flood event in the history of thailand in 2011 kompor et al 2020 developed a method to use streamflow predictions in adaptive reservoir operations for managing extreme floods in the chao phraya river basin predictive information was derived from an ensemble of seasonal precipitation data obtained from the european centre for medium range weather forecasts ecmwf when the reservoir operation plan was changed and seasonal predictions were used the peak river discharge could be decreased by about 20 since a number of factors and data are involved in real time operation a decision support system dss that logically organizes data and models can be of great value dam managers are motivated to use dss by their successful application in many engineering management tasks and wider availability of computers with user friendly graphic interfaces but some are awed by their complexity shim et al 2002 presented a spatial dss sdss for real time flood control in a multipurpose multi reservoir system by integrating several sub systems real time data monitoring database management geographic information and so an ann was employed to develop spatially distributed flood forecasts in real time which are regularly updated application of the sdss to the han river basin korea showed that it helped in reducing flood impacts and conserving water for later use many subsequent studies describe development and application of dss to real life problems with the aid of remote sensing gis graphical tools integrated to multiple criteria decision making levy 2005 knebl et al 2005 ahmad and simonovic 2006 qi and altinakar 2011 werner et al 2013 şensoy et al 2018 lately combined supervisory council and data acquisition scada system with numerical weather prediction nwp data hec hms hec ressim and hec ras models to create a dss for real time reservoir operation and reported improved system performance by use of this dss using the data of danjiangkou reservoir zhang et al 2021b have systematically described the steps of flood control operation including pre depletion for various forecast horizons and types of floods during a flood event release decision of a real time operation model is implemented by operating spillway gates an optimal gate operation reduces the dam susceptibility to overtop che and mays 2017 hence spillway gate operation is an essential part of flood control operation where decisions direct how many gates to be operated to what extent and sequence of opening to arrive at optimal spillway gate operation schedule various optimization algorithms have been employed which include tabu search fuzzy optimization karaboga et al 2008 mixed integer linear programming milp feng and liu 2014 sordo ward et al 2017 cuevas velásquez et al 2020 ga zargar et al 2016 amirkhani et al 2017 albo salih and mays 2021 progressive optimality algorithm poa liu et al 2017 non dominated sorting genetic algorithm amirkhani et al 2017 and particle swarm optimization pso kim et al 2021 for the ease in application commonly used gate types are built in software some software have functions to consider complex structures and operating rules the six stage acanal and haktanir 2000 and the fifteen stage haktanir et al 2013 gate operation policies are the fixed spillway simulation rules that do not require forecast information these prefixed critical levels in the reservoir guide gate manoeuvring optimized critical levels ensure better flood mitigation zargar et al 2016 and allow smooth and continuous gate manoeuvring kim et al 2021 real time operation presents challenges in terms of reliability of operations mechanical electrical faults and human setbacks comparison of various spillway operation strategies reveal the practical relevance of considering the cases of blocked faulty gates amirkhani et al 2017 inoperable spillway gates increase downstream and upstream flood risks hence in real time an event tree based model that considers flood forecasting human availability and response reliability of gate system and the operator error could ensure better representation of the problem paxson et al 2016 although computer models are of immense value in real time operation seasoned operators cross check the results with their experience and in situ data say verify the inflow rate with rate of change of reservoir water level undoubtedly decisions are to be taken quickly but risk of wrong decisions taken in haste is to be avoided spillway gate operation is a critical component of real time operation it is a specialized task and the sequence and rate of opening the gates is project specific 5 uncertainties and risks in flood control operation of reservoirs during reservoir operation for flood mitigation risks arise due to the uncertainties in current and predicted inflows remaining flood cushion in the reservoir or the downstream channel characteristics reservoir regulation also involves a small risk of dam overtopping and break these uncertainties put the operators in a risky situation where flood mitigation or conservation targets or the safety of the dam may be compromised the flood mitigation decisions depend on the flood damage risk estimated as the probability of reservoir releases exceeding the conveyance capacity of river at the control point zhao et al 2014 ding et al 2015 2017 and the dam overtopping risk which is the safety margin relating dam crest height to the likely reservoir water level while routing the floods kuo et al 2007 goodarzi et al 2013 sun et al 2012 the impact of streamflow forecasting on flood control operations depends on many factors valdes and marco 1995 such as the size of the reservoir the lead time over which reliable forecasts can be made the ability of the decision making process to utilize the forecasts the reservoir capacity inflow ratio the spillway release capacity and safe downstream river carrying capacity the uncertainty analysis methods include the first order second moment method fosm the point estimation methods the latin hypercube sampling lhs and the monte carlo simulation mcs lian and yen 2003 the analytical methods are simple but may get cumbersome with increasing number of random variables lack of reliable data and round off errors affect the risk estimates which are mostly based on empirical estimates of the moments of random variables the latin hypercube sampling lhs and monte carlo simulation methods overcome such shortcomings and also yield output distribution the mean the variance and the distribution of the output obtained by using the lhs is nearly unbiased lian and yen 2003 and requires much less effort for the same level of precision compared to the conventional mcs methods impact of various uncertainty factors on reservoir operation can also be quantified by using the shannon entropy concept huang et al 2018 errors in inflow forecast are a major source of uncertainty in reservoir operation and their effect on flood operation rules is crucial li et al 2010 stochastic simulation of inflows chen et al 2015b huang et al 2018 or ensemble forecasts liu et al 2015b cheng et al 2017 ma et al 2021 are adopted to describe uncertainty in reservoir inflow and local flows at the downstream control point to reduce the risk due to inflow forecast errors wang et al 2021a defined a reliable forecast horizon based on various levels of streamflow forecast uncertainties for different lead times zhu et al 2017 emphasized on investigating the effect of forecast uncertainties on optimal flood operation rules and evaluating the associated flood risk the other kinds of uncertainties that invoke flood risks are associated with the water level storage curve flood hydrograph shape chen et al 2019 chen et al 2020 reservoir operation parameters bianucci et al 2013 fu et al 2016 wind wave effect huang et al 2018 and lately the climate induced uncertainties wang et al 2021b the various uncertainties were jointly considered for evaluating the upstream and downstream flood risks the relationships among various uncertainties were modelled using i the theory of stochastic process chen et al 2015b where the uncertainties of reservoir discharge errors forecasting errors of lateral inflows and river flood routing errors were simultaneously considered ii copula chen et al 2016 wang et al 2019b where joint occurrence of the uncertainties in the evolution of flood forecast errors the discharge capacity and the water level storage were considered and iii bayesian networks chen et al 2019 lu et al 2020 which could simultaneously capture the temporal and spatial uncertainty associated with inflow forecasts to ensure uniformity in sampling lhs was employed for generating a vector of uncertainties which could be used in risk evaluation huang et al 2018 wang et al 2019b wang et al 2021c risk analysis was performed by using methods that include the statistical method bianucci et al 2013 chen et al 2015b cheng et al 2017 ning et al 2021 the entropy based method huang et al 2018 sun et al 2018 and the monte carlo simulations chen et al 2019 studies have computed the risk during reservoir operation for flood mitigation in a multi reservoir system also chen et al 2015b wang et al 2019b meng et al 2019 chen et al 2020 wang et al 2021c the forecast horizons fh of each reservoir in a multi reservoir system could be different whereas their operation horizons oh are the same gong et al 2020b developed a two stage model in which a multivariate autoregressive model was used to derive multi normal distribution of multi reservoir storage during the first stage of fh for the time between fh and oh the flood risk was computed by routing the design floods through the reservoirs total risk during the oh was the combined risk at all the stages and the operation corresponding to minimum total flood risk was optimal operation for the entire system ning et al 2021 evaluated the risk created by single hazard events and union and intersection of single hazard events uhe and ihe through an analytical framework the authors claimed that the proposed methodology is more precise compared to the risk analysis method that uses total probability law wang et al 2021c examined the uncertainties and evaluated the associated risk in a multi reservoir system they performed a detailed evaluation of the risk that arises due to the uncertainty in streamflow series flood forecast error water level storage curve error and reservoir discharge capacity error independently this was followed by simultaneously considering the above four uncertainties for risk evaluation the daily streamflow at the multiple sites were generated by using a multivariate seasonal autoregressive model the error in flood forecast was modelled by a wakeby distribution and the error in water level storage and discharge capacity was assumed to follow a standard normal distribution lhs was used to generate samples of uncertainties for risk evaluation the overall risk of the multi reservoir system was expressed as product of the probability of failure and the consequences of failure the probability of failure is the number of times the loading maximum flood storage capacity the largest peak discharge at the downstream control point and the flood diversion volumes in the flood detention basins exceeds the resistance safe storage capacity safe water release and safe flood diversion consequences of failure are quantified using the conditional value at risk index their study is a comprehensive evaluation of uncertainties and associated risk in a multi reservoir flood control system located in the upper yangtze river basin in china when the incoming flood at a reservoir exceeds the design flood hydrologic failure may occur whose risk is associated with the return period of the design flood yan et al 2022 evaluated risk associated with changing climatic conditions and hence increased occurrences of extremes three scenarios of the gcms were used in conjunction with swat model to generate future daily flow series a stochastic arima model was used to simulate various possibilities of the annual flood peak series while preserving the characteristics of past and future floods the bayesian model averaging approach was used to weight the flood risks projected by each gcm to better incorporate the uncertainty of gcms risks associated with reservoir operation and dam safety were computed and could be used to upgrade the design standards or fortify structures to summarize uncertainties arise in flood control operation of reservoirs due to imperfect knowledge about the system inputs including forecasts and downstream conditions uncertainty analysis should be a necessary component of real time reservoir operation every uncertainty analysis method has its own hypothesis advantages and limitations kuo et al 2007 however important factors are the robustness of the flood control model and its associated parameters bianucci et al 2013 the reservoir simulation models have to be tested under various uncertain conditions and an ensemble of hydrologic loading for better performance the review reveals that there is big scope for research concerning uncertainty analysis in a multi reservoir system the temporal and spatial joint modelling of multiple uncertain factors followed by risk evaluation of the reservoir flood mitigation system could ensure better performance the uncertainty arising due the variable length of the forecast period in different reservoirs in a system has seldom been considered structural measures for flood disaster risk reduction such as dams and embankments provide a feel of safety to the people residing in their vicinity since the structures particularly embankments may fail some experts perceive this sense of security to be false and therefore frequently the residual risk is underestimated thus there is a need of increasing flood risk awareness and accounting for residual flood risk related with the structural flood control measures 6 way forward operation of a multipurpose reservoir during the flood is a challenging task since it involves making decisions to maximize benefits from mutually conflicting purposes in such regulation priority would be to avoid dam overtopping control flooding in downstream and attain the highest reservoir level at the end of high flow season the discussions presented in this review paper show that the research on reservoir operation during floods has received considerable attention from researchers across the globe the most common strategy of research and operational suggestions were based on employing an inflow forecast model a reservoir simulation model and an optimizer to arrive at best possible solutions that ensure the fulfilment of prioritized objectives most of them were case specific such as formulation of the simulation model that represent the system being studied formulation of objective functions and their priority for the system formulation of optimization model by varying algorithms etc nonetheless persistent efforts are still required to assist the reservoir managers take decisions to operate the reservoir in situations of extreme flood event the reservoir operation during a flood is highly complex owing to the dynamic variability of the state of the system the reservoir flood control parameters rfcp and the inflows during the event by judicious use of weather and inflow forecasts managers can efficiently use the storage space capture additional water avoid sharp fluctuations in outflows and reduce downstream flood risks however availability of reliable forecasts of weather variables and reservoir inflow is still an area of research the forecast models do propagate a large amount of uncertainty in their output that is inherited from the uncertainty in input variables model structure and parameters while there were quite some studies about quantification of uncertainty in the forecast models efforts to reduce the uncertainty in the output so as to develop confidence in the forecasted variables are still lacking a major challenge is when a conservation based reservoir single purpose is to be employed for flood management in critical situations although both flood control and conservation are important usually flood control gets more attention than reservoir filling in such situations since flood damages are visible get bad publicity and make managers vulnerable in cases where a major flood arrives at the end of the flood season when the reservoir is mostly filled to its full capacity emergency operations are warranted in such cases the objectives would certainly be conflicting and assigning priorities for these objectives would be an intricate task the decision making in such situations could be posed as a coordinated management problem rather than an engineering based operational problem therefore further research efforts are essential to develop customized decision support systems dss that can forecast reliable inflows aid analyze operation alternatives and help perform scenario analysis so as to manage real world complexities yet another challenge which did not receive much attention by the research community is to formulate the reservoir operation problem in cases where multiple flood events successively enter into the reservoir with short inter event time number of flood events and time of occurrence are crucial in decision making in such cases the time span of operation become large and enough storage room is to be maintained in the reservoir prior to the arrival of the subsequent flood and therefore require derivation of rfcp in a dynamic manner implying different rfcp values for pre main and post flood time periods effective integration of stochastic tools in planning and forecasting tools for real time decisions is to be explored further to address this issue the warming climate is projected to introduce increased variabilities in the river flows in terms of both the extremes drought and floods in the future therefore the reservoirs would require judicious management to provide the desired protection against floods while conserving more water flood management by reservoirs also has social and environmental dimensions a fact usually ignored solutions obtained by involving the society would have more acceptability and have higher chances of success application of artificial intelligence and machine learning tools to develop transdisciplinary tools that use knowledge of meteorology hydrology operations research information technology social sciences etc may be explored in reservoir system management 7 data availability this is a review paper we have not used any data in the analyses reported reviewed here declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank their respective institutes the indian institute of technology roorkee the indian institute of technology madras and the national institute of hydrology roorkee for making available the requisite facilities while working on this paper the second author would also like to thank prof k srinivasan indian institute of technology madras for many disccussions which enabled her to contribute to the current work appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129165 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2185,operation of multipurpose reservoirs during flood season is a challenging task if there is a conflict among the purposes despite the importance of this theme in water resources management and a large number of relevant studies carried out a detailed review paper on this topic is missing in the literature present paper aims to fill this gap by providing a comprehensive review of the published literature by classifying the articles the conventional and advanced techniques used in flood control operation of single and multiple reservoirs have been reviewed for flood control regulation the best results are obtained by judicious use of current data and forecasts since the operators need to maintain a balance between conflicting demands in presence of uncertain inflows assessment of risks and uncertainties and their management is crucial finally suggestions for future research and development on this topic are provided data availability no data was used for the research described in the article 1 introduction storage reservoirs are commonly constructed to meet conservation demands that require water to be stored conserved for the best results flood control or a combination thereof common conservation demands are irrigation hydroelectric power generation municipal and industrial water supply recreation and navigation depending upon the purposes served a reservoir can be classified as single purpose or multipurpose to better utilize limited resources many projects serve multiple purposes reservoir storage increases when the inflows exceed release to meet demands and is depleted when the situation reverses conservation demands are best served when the reservoir is as much full as possible however to control floods reservoir should be kept vacant during the flood season to moderate the incoming floods to the maximum possible extent storage requirements of conservation purposes and flood control are different and conflicting therefore operation of a single purpose reservoir is much less complex than a multipurpose reservoir to operate most major and medium reservoirs policies are developed that suggest the volume of water to be stored and or discharged at a given time depending upon the state of the reservoir magnitude of demands vacant storage space hydrological conditions in areas downstream to reservoir and inflow forecasts operating decisions are taken using the developed policy this mechanism works well when there is no conflict in the purposes being served or the state of the reservoir does not change rapidly however it is a challenge to operate a multipurpose reservoir during flood season in several situations a when the reservoir serves conflicting purposes such as conservation and flood control b when the space allocated available for flood moderation is small compared to the expected inflows c when in a system of reservoirs managers need to decide how much water to store and release from each reservoir d when decision making time is rather short and a wrong decision may endanger dam safety life of the people and damages in downstream areas and e when decisions need to be reviewed frequently say every few hours due to rapid changes in the system state a reservoir helps moderate the floods by reducing the peak delaying its arrival and extending the hydrograph base operation of a multipurpose reservoir during high flows can be divided in three periods fig 1 here ①is the pre depletion stage where if necessary vacant space is created by releasing stored water ② is the period of very high flows when reservoir is regulated to maintain outflows below safe channel capacity ensuring safety of dam after the high flow period is over reservoir is filled in stage ③ correct identification of beginning and termination of various stages is important 1 1 objectives and organization of the present paper in view of its importance reservoir operation has been studied by numerous researchers yeh 1985 published a review on reservoir management and operation models review by labadie 2004 was concerned with optimal operation of multi reservoir systems rani and moreira 2010 reviewed applications of simulation optimization models in reservoir operation and ahmad et al 2014 reviewed reservoir optimization in water resources macian sorribes and pulido velazquez 2020 presented a review on how to derive optimal reservoir operating rules these reviews are comprehensive and provide excellent insight into the problem of reservoir operation however a comprehensive review on operation of multipurpose reservoirs during flood season is missing in the literature the aim of this paper is to review the current state of the art regarding operation of multipurpose reservoirs during flood season it is assumed that reservoirs have a distinct wet season in which bulk of the annual inflows is received and this is also the season when flood damages occur the reservoir managers aim to moderate the incoming floods to the maximum feasible extent and finish the wet season with a full reservoir this paper focuses on challenges associated with reservoir flood control operation necessity of real time operation during floods and techniques used and risk and uncertainties and ways to manage these the paper has also identified the potential topics on which future research may be focused the organization of the paper is shown in fig 2 after introducing the topic section 1 2 encapsulates the status and trend of research publications in the field of flood control operation of reservoirs the flood mitigation approaches in a multipurpose reservoir have been classified into three categories and are discussed in section 2 systems analysis techniques are widely used for developing operation policies for reservoirs and are presented in section 3 this section introduces the popular systems analysis tools and discusses applications of common systems analysis techniques viz simulation optimization and coupled simulation optimization this section also discusses operation of a network of multi purpose reservoirs including cascade systems section 4 briefly describes flow forecasting approaches followed by a detailed review of important studies that deal with real time flood control operation including the gate operation strategy of single reservoir or multi reservoir systems any review of reservoir operation is incomplete without consideration of uncertainties and associated risks therefore various uncertainty analysis techniques and the risk evaluation methods are discussed in the penultimate section each section in the paper culminates with brief remarks on the contents of that section the paper concludes with listing the gaps in the knowledge and suggestions for the way forward 1 2 status and trend of research in flood control operation of reservoirs bibliometric data of the publications on topics relevant to this paper published in peer reviewed journals books etc was compiled more than 180 articles were reviewed for this paper which are pertaining to the broad area of reservoir operation for flood mitigation during flood season the literature is collected from various databases which include scopus and google scholar different combinations of the following keywords flood season reservoir operation flood mitigation simulation optimization uncertainty risk analysis flood forecasting and real time operation were used to identify the relevant papers which were further classified under suitable sub sections in this review paper it is to be mentioned that no specific year was mentioned during the search however the resulting papers were mostly published during the last 30 years a synopsis of literature reviewed is presented in table s1 through table s9 supplementary material these tables contain extracted data based on the focus of publications location of the case study and the methodology employed these tables also provide information on the purpose of the reservoir single multi objective and consideration of risk uncertainty table 1 gives the number of publications in different peer reviewed journals books theses etc mostly during the past 30 years we note that four journals account for bulk of the papers published on this topic the reviewed literatures were categorized into groups based on the approaches used for reservoir operation table 2 gives the number of papers published in each sub area it is noted that most of the published papers were concerned with application of systems analysis techniques closely followed by risk and uncertainty analysis and real time operation of reservoirs some papers can be classified in more than one sub area and different persons may classify the papers differently 2 approaches for flood control operation of a multipurpose reservoir with frequent water shortages across the world there is growing need to operate multipurpose reservoirs such that the maximum possible water is conserved while ensuring dam safety and best flood moderation the broad reservoir operation approaches strategies adopted for flood mitigation in a multipurpose scenario and covered in this review could be classified into three categories viz the flood control rule curves the concept of flood limited water level and the concept of hedging the three approaches are presented in the chronological order of their appearance in research articles the latest being the hedging approach each sub section reviews numerous articles and discusses robustness usefulness and practical usability of each flood mitigation approach 2 1 flood control rule curves for the multipurpose reservoirs wherein flood control is the main purpose some storage space is allocated for flood control and is specified by rule curves loucks and van beek 2017 this space is typically kept vacant to moderate the incoming floods the size of this space is based on the volume of design flood the spillway release capacity and the safe carrying capacity at the downstream damage center the incoming floods are moderated by utilizing this space it is emptied after a flood event to be ready for a subsequent flood this practice is based on the premise that damage causing releases should be avoided till the available storage is utilized chaleeraktrakoon and chinsomboon 2015 proposed dynamic flood control rule curves for maximum utilization of reservoir capacity a range of possible design flood hydrographs are predicted and corresponding dynamic flood rule curves are derived this approach better tackles the uncertainty associated with the incoming flood malekmohammadi et al 2010 used a simulation optimization so approach and applied k nn nearest neighbor algorithm to develop real time reservoir operating rules from the results of the reservoir optimization model the objective function had incorporated coefficient of variation of releases to avoid large fluctuations in optimal release a major limitation of flood rule curves is their inflexibility during real time operation especially with environmental constraints şensoy et al 2018 notwithstanding the limitations rule curves offer a backup even when advanced decision making tools are present valdes and marco 1995 improvements in the way rule curves are developed and implemented would be helpful in flood control regulation these topics are discussed next 2 2 concept of flood limited water level flwl reservoir operation during the flood season should aim to moderate floods while conserving water to meet dry season demands the concept of flood limited water level flwl to operate reservoirs during the flood season was developed in china where a distinct flood season is experienced however the concept can be applied to any region which has a distinct high flow season and the reservoirs follow a drawdown refill cycle somewhat similar is the concept of wurbs and cabezas 1987 redistributing reservoir storage capacity in brazos basin usa based on the seasonal variation of floods properties the maximum allowable water level to be maintained in the reservoir to ensure adequate vacant space for flood control during the high flow season is termed as the flood limited water level flwl li et al 2010 the storage space between flwl and the maximum water level mwl or full reservoir level frl is used to store flood water fig 3 flwl is an important parameter that governs the trade off between flood control and water conservation yun and singh 2008 liu et al 2008 li et al 2010 flwl computed using the annual design storm does not vary within the flood season if the reservoir water level at the beginning of flood season is above flwl it is lowered to flwl and near the end of the flood season the reservoir is filled up to frl use of single valued flwl also termed the annual flwl is sub optimal in some cases if the flood season begins late and the reservoir level is low demands may be met partially till inflows increase sufficiently if flood season ends before the usual dates reservoir may not be filled to the desired level and shortages may be faced hence flood mitigation policies have to be devised considering significant variability in timing magnitude and frequency of flood flows for the flood mitigation strategies to work efficiently it is desirable to identify multiple sub seasons weeks months within whole flood season flood season is usually segmented by adopting one of the following methods i graphical method ouarda et al 1993 ii evaluating relative flood frequencies black and werrity 1997 cunderlik et al 2004 chen et al 2015a xiong et al 2018 iii directional statistics fisher 1995 ouarda et al 2006 chen et al 2013a iv probability change point analysis liu et al 2010 zhou and guo 2014 v fuzzy c means clustering wang et al 2012 the commonly used indices in the flood season segmentation are precipitation information jiang et al 2017 flood volume jiang et al 2017 and flood discharge data cunderlik et al 2004 chen et al 2010 2013 jiang et al 2015a the index magnitude and the time of occurrence are the prime considerations in a flood segmentation method probability change point analysis method is reported to be more objective compared with the other two methods of segmentation in terms of identifying the exact dates of change of points jiang et al 2017 zhou 2022 two pioneering improvements in flwl approach are the multiple duration flwl mdflwl also termed as seasonal flwl liu et al 2008 mu et al 2022 and the dynamic flwl dflwl yun and singh 2008 in case of mdflwl instead of deriving one design storm for the whole flood season design storms for smaller durations such as a month are derived and used to determine monthly limited water level fig 4 shows the monthly and annual duration limited water levels mdflwl are commonly higher than the annual flwl implying that more water is conserved and the demands are served better since occurrence of a large flood event early in the flood season reduces the occurrence probability of another large event in later parts of the flood season and vice versa the limited water levels in the subsequent periods can be raised for that year by using conditional probabilities of occurrence of large storms in the reservoir s catchment the limiting water levels in the larger segments do not require an adjustment in case no large floods occur in the initial segment dynamic flood limited water level dflwl method considers revising the limited water levels dynamically in light of new data applications of dflwl showed that it conserves more water in the reservoir without harming its effectiveness in flood control and water shortages due to delays in flood season or short flood season can also be addressed some studies have recommended following monthly limited water levels in actual reservoir operation in place of annual flwl analysing the performance of the annual flwl li et al 2010 noted that the reservoir operation by using the flwl gives high priority to low probability flood events and neglects the inflow uncertainty in this regard researchers have successfully integrated the forecast information in the reservoir operation module within the flood season commonly called the dynamic flwl during real time operation li et al 2010 peng et al 2017 wan et al 2021 dynamic updating of flwl in the flood season provides better water utilization a direct improvement to the mdflwl seasonal flwl is to optimize the seasonal water levels using non dominated sorting genetic algorithm ii nsga ii liu et al 2015a and non linear complex method xie et al 2018 jiang et al 2015b identified the seasonal flwl while considering forecast error as a fuzzy variable and using a credibility based chance constrained simulation incorporation of seasonal flood risk analysis zhou and guo 2014 and analysis of hydrologic hydraulic and reservoir conditions zhou et al 2015 along with forecast information has allowed higher water conservation levels in the sub seasons the characteristics of 2011 flood in the chao phraya river basin thailand komori et al 2012 contradicts the supposition of conditional probability of occurrence of successive large events in the multiple flood sub seasons yun and singh 2008 this is because the high rainfalls in the season occurred due to multiple typhoons initially followed by an above normal monsoon rainfall in the year when the downstream flooding in the basin could be attributed to low terrain slope poor inflow forecast led to bad flood mitigation at the reservoirs leading to levee breaks another notable aspect is the lack of flood operation strategies for an early start and late ending of flood season hence it is recommended to devise flood operation policies that takes into consideration within year and across year variability of floods within the flood season such an adaptive reservoir operation strategy along with reliable forecast of precipitation and evaporation helps in real time operation of reservoirs for flood mitigation kompor et al 2020 abhishek et al 2021 loc et al 2023 revisited the effect of reservoir operation in mitigating the 2011 flood of thailand and found that the event was catastrophic and the downstream flooding was inevitable because of large local flows the dynamic flwl approach was also implemented to derive joint operation schemes for cascade reservoirs chen et al 2013b tan et al 2017 zhou et al 2018a zhou et al 2018b and mixed cascade reservoirs zhou et al 2014 chen et al 2022 the size of the problem was tackled using aggregation decomposition technique gong et al 2020a and dynamic programming zhou et al 2014 to drive the optimal dynamic flwl progressive optimality algorithm poa chen et al 2013b zhou et al 2014 zhang et al 2018 nsga ii zhou et al 2018a gong et al 2020a ma et al 2020 non dominated sorting culture differential evolution nscde algorithm liu et al 2019 and particle swarm optimization pso chen et al 2022 were used even though the studies discussed above vary in the techniques used to derive dynamic flwl optimal seasonal flwl and joint dynamic flwl for multi reservoir system the problem was formulated to seek trade off between flood mitigation and conservation use floodplains of some rivers can temporarily hold substantial quantity of water and hence joint operation of reservoirs and floodplains can be highly beneficial without additional flood risks xie et al 2018 xiong et al 2019 analysed annual flwl based on design flood in construction period and design flood in operation period using the multivariate t copula and the genetic algorithm ga and implemented the methodology on a system of 13 cascade reservoirs the results revealed that compared to the design floods in construction period the design floods in operation period for the downstream reservoir were considerably reduced by the regulation of upstream reservoir which had facilitated raising the annual flwl for the downstream reservoirs ma et al 2020 examined flwl from the perspective of fishery they proposed an optimizing framework to compute the optimum water levels by adopting a three objective hydropower generation flood control and fish spawning evolutionary algorithm studies reviewed here have examined the various facets of flwl performance of flwl is satisfactory even when flow forecasts are not available most of the flwl studies were conducted in china and the applications of this approach in other countries is low 2 3 hedging in reservoir operation for flood control hedging is basically rationing of water supplied for various demands its rationality is that the expected marginal benefit from storage must be the same as the marginal benefit from release draper and lund 2004 when applying the hedging concept for flood control storage space to moderate floods is considered a scare resource which should be judiciously allocated between the current and future time periods hedging is difficult in large flood events owing to enormous flood volume and would be of little help for small floods the optimal hedging releases are useful for medium floods to minimize the overall risk zhao et al 2014 hui et al 2016 hedging involves accepting small current losses so as to avoid larger future losses fig 5 depicts an operating policy based on the hedging concept in the backdrop of the standard linear operating policy jain and singh 2003 jain 2013 the reservoir releases r depend upon the expected water availability during the decision period from time d onwards on x axis the operator may keep reservoir sufficiently vacant by progressively increasing releases thereby minimizing flood risk the downstream flood risk is avoided by making releases smaller than the safe river capacity horizontal line at r the parameters in a two point linear non linear hedging rule analogous to the generalized two point hedging rule identified by kumar and kasthurirengan 2018 are the starting and ending water availability swa and ewa respectively pre depletion of storage before a flood increases vacant storage and increases the ability to regulate large future floods this is akin to hedging reliable forecasts help in successful implementation of hedging concept although the downstream flood protection is enhanced by pre releases from the reservoir excessive releases increase downstream flood risk and may also increase water shortage if post flood inflows are insufficient chou and wu 2013 studied the post flood water shortage risk under various pre release strategies and identified target pre release strategy before the arrival of the typhoon for a given acceptable shortage risk compared to historical operation this strategy helped in retaining 50 of the inflows in the reservoir and the maximum release was 10 below the safe capacity of downstream river with perfect forecast of incoming storm and known damage function optimal pre releases could be made hui and lund 2015 hui et al 2016 attempted to minimize the overall losses that arise due to pre releases under various cases of storm forecasts and damage functions hua et al 2020 extended the pre release concept considering the dry days between flood occurrences depending upon the forecast lead time and the expected length of dry days releases were made either to vacate the space above the upper bound of dynamic control of flwl dc flwl or to generate hydropower lately wei et al 2022 developed a framework to derive optimal flood reservoir operation by including an early stage pre release module to create flood cushion in the reservoir and followed by using a fuzzing algorithm to select suitable operating policies zhao et al 2014 employed hedging to derive flood operation policy suitable for real time operation analogous to water supply hedging rule of draper and lund 2004 this was a two stage policy which could be adopted in real time during the progression of a flood event and within the forecast period they used the karush kuhn tucker kkt condition to optimally allocate the expected flood safety margin efsm the difference between the expected flood volume and the safe carrying capacity of the river at the downstream control point between the current period and remaining periods in forecast horizon unlike the formulations which seek trade off between water conservation and flood risk here the final water level in the reservoir reaches the target level only when the efsm is greatly allotted to channel in most of the time periods the study assumed no fail condition of the reservoir which may not be realistic ding et al 2017 specified three types of hedging rules in their theoretical analysis to seek trade off between flood risk and water conservation the comprehensive analysis provides the decision makers with a range of plausible optimal hedging flood releases for various levels of acceptable risk ding et al 2015 2017 described the mathematical underpinning for a two stage hedging operation to seek trade off between water conservation in stage 1 see eq 1 and flood risk in stage 2 see eq 2 they considered flood risk associated with inflow uncertainty to be zero in stage 1 as the forecast error in the near future is less and the water conservation loss in stage 2 is taken as 1 as the target level at the end of flood season is set to the lower flwl the objective functions for stages 1 and 2 are given as 1 g w 1 w 1 s r s 1 s r s min m w r w 1 w r m 2 g f 2 δ σ δ h ε d ε in eq 1 sr denotes reservoir storage capacity for water supply and w r is corresponding water availability smin is the storage corresponding to lower bound of flwl and w1 is the water availability in stage 1 further w1 is the difference between s1 and smin and is denoted as excess storage carried over to stage 2 as water conservation the shape of the water conservation objective function is guided by factor m m 1 is the condition for a convex g w 1 hui et al 2016 in eq 2 h ε is the probability density function of forecast error ε with forecast uncertainty σ the downstream flood risk is brought into the objective function g f 2 through δ which is the efsm zhao et al 2014 the general framework of ding et al 2015 2017 utilized by zhang et al 2022 to derive hedging operation rules that considers flood risk and hydropower generation as two purposes of the nierji reservoir china another real time implementation of hedging is credited to wan et al 2016 who derived hedging refill strategies kkt conditions were used to solve a two stage optimization problem and the result showed that the refill operation is optimal when the marginal loss of conservation in the current period equals the marginal flood damage in the future period implementation of the methodology highlighted its practical use as it invoked gradual refilling of reservoir using forecasts a hedging reservoir operation strategy similar to water supply hedging rule yun and singh 2008 was proposed by xu et al 2020a they modified the linear hedging refill rule of wan et al 2016 and defined a quasi linear hedging rule for real time flood operation the methodology consisted of a two stage kkt based optimization model that attempted to minimize the overall risk flood risk at the current time step and water shortage risk at a later stage fig 5 shows hedging rule used in the study the study adopted a static swa and ewa as decision variables thereby leaving a scope to test the efficacy of the use of dynamic swa and ewa in flood mitigation in real time results suggested that the hedging rules conserve more flood water and improved deliverability than the designed flood control rules or capacity constrained pre release rules without increasing flood risks lian et al 2019 incorporated environmental safety against the vibration induced due to large reservoir releases in flood operation the risk of environmental safety was considered by a two period reservoir dispatch hedging model constraints were placed on the relationship between the root mean square rms of acceleration in the vertical direction and the discharge estimated by field tests and hydraulic model if forecasts show higher floods restricted releases are made to deplete the reservoir subject to near field vibration safety discharge hence a two stage optimization framework that minimizes risk of safety was adopted optimal allocation of the gap between the expected flood volume and the near field vibration safety discharges analogous to the efsm in zhao et al 2014 was the objective of the study that sought trade off between environmental safety and water conservation authors concluded that in case of a large flood the hedging strategy can alleviate the average near field vibration better than uniform discharge the efficacy of flood control operation largely depends on the accuracy of inflow forecast available flood storage space in the reservoir and downstream channel acceptable risk and decisions maker s preferences for other water uses thus there is need for a comprehensive dynamic hedging strategy that helps managers attain the largest benefits without compromising on dam safety currently potential of hedging is underutilized and more research on this topic is needed 3 systems analysis techniques commonly two systems analysis techniques optimization and simulation are used for optimal design and operation of a hydro project optimal solution of problems that involve competitive water demands needs systems approach as a methodological way votruba 1988 optimization is the technique to find the best solution amongst a number of feasible alternatives labadie 2004 reviewed applications of optimization methods to reservoir systems he also provided an overview of multi objective and heuristic optimization procedures besides application of machine learning algorithms neural network and fuzzy theory in reservoir operation generalized formulations of optimization models for flood control problems are described in appendix a supplementary file simulation technique mostly follows a trial and error approach to determine the best set of design or controlling variables jain and singh 2003 a working simulation model of the system is developed and is used to find answer to the question what if answer to this question leads to assessment of the consequences of a decision although simulation and optimization are different approaches many models employ both while converging to the optimal solution optimization models reproduce behavior of the system by a simulation model it is often impossible to consider all the complexities of a system in an optimization model but a simulation model can handle most such complexities at times it is best to use optimization and simulation together to harness the strengths of both techniques rani and moreira 2010 an optimization model may be used for preliminary screening of alternatives and the short listed alternatives may be investigated in detail by a simulation model wurbs 2005 using systems approach a number of generalized mathematical models that analyse the river reservoir system include the tools developed by the hydrologic engineering center hec u s army corps of engineers such as the hydrologic modeling system hec hms river analysis system hec ras reservoir system simulation hec ressim and flood damage reduction analysis hec fda https www hec usace army mil the corps water management system links hec hms hec ras hec ressim and hec fia flood impact analysis its public version hec rts real time system is still under development şensoy et al 2018 other models include mike 11 le ngo et al 2008 nih resyp nih reservoir systems package developed by the national institute of hydrology of india goel et al 2020 and riverware developed at university of colorado https cadswes colorado edu zagona et al 2001 and modsim labadie 2006 shenava and shourian 2018 in these software reservoir operating rules policies are implemented through a set of logical and mathematical statements recently the soil and water assessment tool swat has been updated to include generalized reservoir operation module swat m which is suitable for small reservoir with flood control function and for large multipurpose reservoirs wang et al 2022 3 1 applications of systems analysis techniques for flood management real life reservoirs are operated by using rules of thumb rule curves and operation policies the decision making concerning reservoir flood management involves risk jain et al 1992 suggested a methodology with explicit risk consideration to develop flood season operation policy for a reservoir by maximizing storage at the end of the flood season ensuring that the risk of an overflow is kept below the acceptable limit jain et al 1998 divided the reservoir flood control space in two parts lower and upper when reservoir level is in lower part incoming flood is regulated by following the normal flood regulation policy if the reservoir level rises to the upper part and safety of the dam is threatened attempts should be made to lower the level at the earliest the current reservoir level and nature of inflow increasing or decreasing determines which operation mode to follow le ngo et al 2007 derived optimal flood rule curves considering the downstream non damaging discharge conditions the suitability of the operating policies can be evaluated based on indices related to the flood mitigation efficiency e g peak reservoir release maximum water level mean number of gate maneuvers power generation bianucci et al 2015 in addition to reservoir operation holistic assessment of hydroclimatic extremes is helpful to manage associated environmental societal and economic challenges lazin et al 2022 abdi dehkordi et al 2021 applied system dynamics approach to integrated flood management by considering structural and non structural flood mitigation measures the structural measures were the dams and watershed management and the non structural measures included determination of the reservoir level at the start and safe reservoir release at the start and end of the flood it was found that a 200 year return period flood could be reduced by 62 by adopting integrated flood mitigation strategy zhao et al 2022a in their work proposed and employed a novel ann based framework to develop intensity duration frequency idf curves and flood risk change maps in the changing climate and socio economic scenarios for phnom penh cambodia the study emphasized on the joint implementation of mitigation structural measure and adaptation strategies non structural measures to attain best and sustainable results their adaptation strategies are flexible to be extended to other geographic locations and also put forward the expertise of the policymaker for efficient and effective countermeasures due to climate and landuse land cover lulc changes reservoir inflow and demand properties may change and previously developed rule levels may not remain optimal hence dynamic rule curves may be adopted wherein the system under study is re optimized for every operational period by using ensemble streamflow and forecasts of water demand to produce ensemble of optimized reservoir storages the optimized storage values are used to produce rule levels for each operational period as a function of the system state and streamflow forecast an advantage of this method is that systems self adjust as the climate evolves lee et al 2011 convergence of optimization algorithm to a local optimum is a common problem and many attempts have been made to address it diao et al 2022 presented an improved version of the particle swarm optimization pso algorithm called simulated annealing pso sapso algorithm to optimize flood peak reduction through a reservoir by applying sapso algorithm to the operation of a cascade system the authors could reduce the maximum outflows by 9 to 18 and lower maximum water levels by about 0 4 m in two reservoirs to harness the advantages of both simulation and optimization many researches have used s o approaches for flood control reservoir operation the coupled s o approach has been widely used for design of flood control reservoirs or to develop operation policies the decision variables in the optimization formulation are either the reservoir releases or the parameters of the operation policy which are obtained by optimizing a single objective flood mitigation or multiple objectives flood mitigation and other purposes le ngo et al 2007 finding efficient operating policies for a complex multi reservoir system with simulation alone is challenging the combined use of simulation and optimization gives a framework to efficiently complete this task rani and moreira 2010 the basic idea behind coupled so is fig 6 an outer loop finds optimum values for the decision variables by using an approximate system configuration and an inner loop simulates operation by using more realistic configuration determines the values for the uncertain variables completes statistical evaluation and returns values that the outer loop search process can use the process repeats till the best possible outcome is obtained in case of flood control operation the optimization model guided by a particular objective function searches for optimal decisions during each operation period when all the simulation runs are complete the outputs are compiled and the best decisions are used to establish operation rules yazdi and neyshabouri 2012 coupled the mike 11 software for simulation with nsga ii model for optimization to determine the optimal dam height considering trade off between the construction cost and downstream flood damages the dynamic nature of a river reservoir system requires that flood rule curves be developed for the reservoir as well as the downstream river le ngo et al 2007 adopted such an approach by coupling mike 11 and shuffled complex algorithm sce for optimization they adopted a two stage optimization model comprising of three objective functions minimization of maximum reservoir level maximizing hydropower generation and maximizing conservation storage s o approach was used to modify the design rule curves by considering the altered reservoir inflow conditions due to climate change lee et al 2009 lee et al 2011 or the ecological flow requirements dittmann et al 2009 ma et al 2020 the flood mitigation through peak outflow reduction along with conservation of water at the end of the flood season were the primary objectives in most studies the direct interpolation of monthly optimal flood rule curve parameters to daily scale was found to increase the flood risk hence lee et al 2011 suggested that daily rule curves should be developed independently gabriel martin et al 2020 emphasized the use of dynamic conservation levels which are attainable based on the expected seasonal inflows and the initial reservoir level when the flood enters the reservoir the optimization was performed using generalized software like the hec prm hydrologic engineering center prescriptive reservoir model https www hec usace army mil software and evolutionary algorithms which were found efficient in handling multiple objectives albo salih and mays 2021 used combined optimization simulation approach consisting of four models interfaced through matlab a rainfall forecasting model a rainfall runoff model a combined 1d 2d unsteady flow model hec ras and an optimization model solved using genetic algorithm they found that although the genetic algorithm required many function evaluations simulation runs of hec ras to reach an optimum solution it is amenable to interface with simulators zhao et al 2022b integrated the hec hms and the flo 2d models to accurately infer the impact of dams and reservoirs on reducing flood inundation for various events of return period 5 20 50 200 and 500 years excessive withdrawal or diversion of water from rivers is harmful to the health of a river hence assessment and implementation of environmental flows e flows is important for maintaining healthy ecosystems during flood season flows in most rivers are enough to meet the needs of environment hence this topic is not further pursued here the objectives of reservoir flood control operation viz minimizing the maximum reservoir water level as well as downstream water levels can be efficiently achieved through the use of advanced optimization algorithms such as multi objective evolutionary algorithms moeas the advantage of multi objective evolutionary algorithms moeas over traditional multi criteria methods is that these could produce a set of non dominated solutions in a single run zhou et al 2011 the inbuilt superiority of the improved non dominated sorting genetic algorithm iii ensga iii could produce more preferred solution than nsga ii chen et al 2017 combination of conventional decomposition techniques with moeas moea d have received wide application recently qi et al 2017 zhang et al 2019a yang et al 2022 moea d decomposes the target multi objective optimization problem into multiple sub problems by using aggregation approaches and then optimizes them simultaneously by using an evolutionary algorithm such models were found to be suitable to incorporate preference information weights moea d pwa which could refine the solution search qi et al 2017 thoughtful amendments to any evolutionary algorithm e g nsga ii like the re initialization of the initial population of the decision variables releases in the forecast period based on executed reservoir releases in the previous time steps and use of a differential evolution operator for the evolutionary process creates an interactive model that involves the decision maker s expertise liu and luo 2019 zhang et al 2019a in finding preferred solutions the dynamic changes occurring in the physical river reservoir system such as the hydro meteorological conditions in the catchment the vacant storage for flood mitigation the river stage at the damage center and the available river capacities below the bank full stage influence the reservoir operation decisions prakash et al 2015 liu and luo 2019 an adaptive so framework in which the flood hydrograph was divided into three phases according to their slope in the rising and recession limbs was used by prakash et al 2014 in a multi reservoir system to consider dynamic changes prakash et al 2015 and chou and wu 2015 used similar approach for a single reservoir system note that the studies considered mitigation of a single flood event with specified initial conditions at the river and the reservoir the priorities of the operator with the progression of the flood event were driven by invoking one or more of the objective functions within the so framework the nsga ii prakash et al 2014 2015 and bobyq chou and wu 2015 were used to solve the multi objective optimization problem most earlier studies did not consider the social implications of the flood regulation however several recent socio hydrological studies have addressed the complex interaction between flood and humankind baldassarre et al 2013a b 2017 fuchs et al 2017 albertini et al 2020 proposed a socio hydrological tool to simulate interaction between humans and flood that represents the modifications in the reservoir flood management approaches and the changes to the downstream levee system the model was implemented to evaluate three flood protection strategies the green systems where the affected community is resettled out of the flood prone area the technological systems where the societies depend on structure measures like a levee for flood protection and the green to techno systems in which societies shifts focus from nature based to technological tools data of brisbane australia was used to explore floodplain dynamics by simulation of likely future scenarios results showed that flood risk depends on changes in flood and drought memory of reservoir operators and risk awareness influences how floodplains are urbanized fig 7 higher and frequent flood occurrences enhance the social flood memory in the green system whereas the technological system experiences severe losses if flood losses are large and larger structural measures are technically or economically unfeasible the green to techno solutions may develop as a green floodplain management system the loop diagram of fig 7 shows how the state variables in the model are related and interact the foregoing discussions indicates that most of the studies on reservoir operation during flood have used coupled s o framework a variety of optimization methods have been employed for reservoir operation optimization and the utility of the results depends on how realistically the problem has been formulated and solved several researchers have suggested that a multi objective formulation carefully considering conflicting objectives may yield better operational strategies 3 2 operation of a network of multi purpose reservoirs the development of operation policy for multi purpose multi reservoir systems is even more challenging because of nonlinearity high dimensionality correlated decision variables and conflicting objectives different reservoirs receive different regulated and unregulated inflows have different storage capacities and different vacant storages however by skillful regulation these factors can be turned to advantage and a high peak hydrograph can be turned into an outflow with smaller peaks lund and guzmann 1999 provided an overview of operating policies for network of multipurpose reservoirs and also highlighted the opportunities for developing rules for water allocation and storage for various system configurations and uses a widely studied strategy for flood control operation is the dc flwl the concept was extended to a multi reservoir system by chen et al 2013b zhou et al 2014 ouyang et al 2015 zhou et al 2018a zhou et al 2018b gong et al 2020a and lu et al 2021 in network application dc flwl is simultaneously derived for all the reservoirs in the system the optimization algorithms to arrive at the optimal dc flwl for each reservoir in a system include progressive optimality algorithm poa chen et al 2013a zhou et al 2014 modified self adaptive electromagnetism like mechanism sem algorithm ouyang et al 2015 ngsa ii zhou et al 2018a gong et al 2020a and stochastic programming lu et al 2021 the studies were implemented on cascade reservoir system or mixed reservoir systems with encouraging results they confirmed that jointly developed operation rules for multi reservoir systems provide better flood protection than the individual flood operation rules moridi and yazdi 2017 keophila et al 2019 zhang et al 2019b and there was higher water conservation in joint operation a concern with so framework is that the problem dimensionality increases with the number of reservoirs curse of dimensionality is a common problem in studies dealing with multireservoir systems a popular approach to tackle this problem is the aggregation decomposition ad wherein reservoirs are aggregated into a single virtual reservoir whose operation is optimized and the decisions are distributed among the individual reservoirs liu et al 2011 a third order hierarchical optimization decomposition model was also found suitable in arriving at optimal releases from a group of reservoirs jia et al 2015 the ad approach was used to derive optimal joint flood control rule curves for a parallel multi reservoir system in the lijiang river basin by pan et al 2020 who used the nested annealing accuracy penalty function adaptive multi variant particle swarm optimisation aapf ampso algorithm to maximize the peak reduction decomposition of the aggregated results was based on the ratio of the flood storage capacity in individual reservoirs to the aggregated single reservoir application of this technique resulted in higher reduction of flood peaks li et al 2019 reduced the number of reservoirs to handle by identifying a set of effective reservoirs that were jointly operated non effective reservoirs were handled separately this method was tested on a system of 14 reservoirs in the huaihe river basin china it was shown that the number of reservoirs to be handled could be halved while equivalent flood control benefits were achieved dynamic programming dp has been widely employed for optimizing reservoir operation rules nandalal and bogardi 2007 as it can efficiently handle discrete variables and non convex non continuous and non differentiable objective functions however the curse of dimensionality limits its use in optimization of multi reservoir systems to overcome this curse modified dp algorithms like the discrete differential dp dddp cheng et al 2014 and the progressive optimality algorithm poa zhou et al 2018b have been used zhou et al 2018b used dp poa in a two stage model to derive optimal rules for a cascade of reservoirs with multiple control points by sequentially progressing from upstream to downstream the three stage operation of flood mitigation proposed by chou and wu 2015 was extended to a parallel set of multi reservoir system by zhu et al 2021 who used the stage wise storage compensation method to arrive at the optimal flood routing policy while maximizing the outflow peak reduction rate hui and lund 2015 investigated the impact of hydrograph shapes in arriving at optimal operation of parallel reservoirs four basic hydrograph shapes that appeared in connaughton et al 2014 were considered and two useful concepts that relate peak flow reduction and additional storage requirements were defined flood storage efficiency fse the peak reduction per unit storage and marginal flood storage efficiency mfse first derivative of fse optimal flood storage allocation was derived for various combinations of storms a conclusion was that flood storage be allotted such that the mfse is equally distributed among the reservoirs and the series of storms the derived optimal flood storage capacity allocation rules were successfully applied to the oroville and the new bullards bar reservoirs in california zhang et al 2016 explicitly considered movement of flood waves in the downstream river channel a hybrid algorithm termed as the progressive optimality algorithm and successive approximation poa sa was used to solve the optimization problem application to the multi reservoir system in the xijiang river china showed that the peak of flood could be reduced by 12 8 for the 100 year return period flood a multi objective stochastic programming algorithm with recourses mosp by considering inflow forecasts errors as stochastic and having spatial and temporal correlation was proposed by xu et al 2020b they used an epsilon constraint method to find optimal solution and explicitly considered risk objectives they tested the developed methodology on the pi river basin in china and reported that the non inferior solutions provided by mosp could conserve more water while reducing flood risk design floods are important in flood control regulation flood risk may be over or under estimated if the flood spatial pattern fsp of design flood is incorrectly considered tan et al 2017 considered capacity compensation regulation and uncertainty of fsp to develop a model for a system of serial multipurpose reservoirs to derive dc flwl in compensation regulation a part of flood control storage in an upstream reservoir is reserved for the downstream reservoir moridi and yazdi 2017 developed a general nonlinear non convex multi objective optimization model for a multi reservoir system to mitigate flood release rate from the reservoir and the flood storage capacity of the reservoirs were considered as decision variables and mixed integer linear programming milp algorithm was used to solve the model the study considered two scenarios a 2 reservoir system cascade and a 6 reservoir system mixed with 25 and 50 year return period floods it was revealed that if the 6 reservoirs are simultaneously operated flood damage would be fully prevented without much reduction in hydropower generation sudheer et al 2019 carried out a post event analysis of august 2018 kerala india floods that affected large population and damaged infrastructure and environment one of the worst affected basins the periyar river basin prb has 17 interconnected dams barrages authors analyzed reservoir operation to examine the possibility of improvements and to find whether pre depletion of the prb reservoirs could have helped in higher flood attenuation they concluded that releases from major reservoirs had a minor role in flooding in the prb most of the flow that caused damages came from the areas which did not have any reservoir thus better reservoir regulation would have helped in limited reduction of flood peaks improved decisions were possible if reliable rainfall forecasts at higher lead time were available floods and droughts are two extremes of the hydrologic cycle and an integrated management can reduce the harmful impacts of these bahrami et al 2022 studied and compared scenarios of integrated management of floods and droughts imfd and non integrated management nmfd by means of reservoirs they found that when nmfd is practiced drought conditions for downstream water users were intensified all the water users had higher vulnerability and the scenarios were less sustainable greater wealth was generated in the imfd scenario ifmd is a powerful concept for countries like india where dry season comes a few months after the flood season although many reservoir operation studies have been conducted employing systems analysis tools the largest size of systems considered so far is about 14 reservoirs more research is needed to develop methodologies for regulation of larger reservoir systems to manage large water resources systems it is important that the selected model has the ability to efficiently handle complex systems further the success of flood control operation by reservoirs critically depends on accurate rainfall prediction at higher lead times 4 real time flood control operation of reservoirs in a flood event reservoir inflows and flows in downstream river can rapidly change and the operators need to take implement and update decisions accounting for changed situation thus the main feature of real time flood control operation is to implement decisions based on the system state at that very instant reliable forecasting of streamflow is essential for efficient flood control operation of reservoirs mathematical models are of great help in inflow forecasting and assist operators in taking right decision in this section we briefly discuss the use importance and methods of flow forecasting followed by real time flood control operation of reservoirs 4 1 flow forecasting flow forecasting ff is the estimation of future water levels or flows at a single or multiple sites of a river system for different lead times tiwari et al 2021 it is one the most challenging and difficult problems in hydrology jain et al 2018 when reliable forecasts of incoming floods are available sufficient in advance projects can be operated more efficiently forecasts of floods are commonly prepared by using a hydrologic model depending upon the catchment features size climate etc the hydrologic model may be a flood routing model a rainfall runoff model a statistical model etc the typical inputs to a flow forecast model are observed precipitation and or flows if precipitation forecasts are available in real time better forecasts with higher lead times can be prepared point measurements of precipitation are commonly used to compute spatial average values these days such measurements may be supplemented by data obtained from weather radars which produce spatial estimates of precipitation and also describe storm movement forecast based operation of reservoirs provides better flood mitigation reduces water deficit and meets ecological demands wang et al 2019a a key requirement in real time reservoir operation is to update release decisions based on the current and forecasted inputs to the reservoir fig 8 shows a schematic of real time reservoir operation by using inflow forecasts rainfall runoff models are frequently used to transform rainfall observed or predicted into reservoir inflows whose values are used for decision making in recent times the field of flood forecasting has significantly advanced jain et al 2018 reviewed techniques and applications of flood forecasting they highlighted the need for computationally efficient models that can adequately consider catchment properties and their variabilities can efficiently update forecasts can compute uncertainties in forecasts and incorporate them in decisions and warnings ensemble forecasts that rely on a set of likely forecasts help produce better forecasts and provide estimates of uncertainty in outcomes a hydrologic model forced by an ensemble of precipitation forecast provides a band of reservoir inflows and estimates of forecast uncertainty wu et al 2020 reviewed the current status and future opportunities in ensemble flood forecasting many of the works reviewed by them have focused on research questions related to ensemble modeling techniques or their use to simulate past flood events greater application of ensemble forecasting would definitely help in improved flood control by reservoirs the latest advancement in the domain of streamflow prediction is the use of artificial intelligence ai models namely long short term memory lstm gated recurrent unit gru and least squares support vector machine lssvm guo et al 2021 he et al 2022 typical components of reservoir flood forecasting and control systems are telemetering and data acquisition data communication database management real time forecasting decisions concerning release of water flood warning and dissemination and updating guo et al 2004 described a reservoir flood forecasting and control system rffcs which integrated all these components it was probably one of the earliest systems that was implemented at a large number of reservoirs guo et al 2004 described in detail the application of rffcs to the danjiangkou reservoir china and listed several benefits from its use in later times many similar systems were developed and used across the world che and mays 2015 2017 connaughton et al 2014 explored the role of inflow forecasting by comparing the efficacy of three flood operating rules in controlling the peak of outflow and provided insight into the role of inflow forecasting and damage functions in reservoir operation they used four hydrograph shapes triangular flood pulse abrupt wave and broad peak and three operation rules i the minimize flood peak rule uses vacant reservoir storage to control flood ii the minimize flooding frequency rule reservoir release is kept below the safe carrying capacity of the downstream river to the extent possible and iii the short forecast peak minimization rule use existing flood storage capacity to minimize peak over a short future horizon in this rule release rt is calculated as 3 r t t t f i t τ d τ s t f where st is unfilled storage capacity at time t f is the forecast period and it are the forecasted flows eq 3 is basically the pack rule of reservoir operation jain and singh 2003 without using inflow forecast the flood storage capacity may fill up before the arrival of flood peak and moderation would be less however flow forecast errors and uncertainty pose a challenge in the reservoir operation if the forecast errors are heteroscedastic variance increases as inflows increase forecast uncertainty would be large when the inflow is large hence a larger part of storage would have to be reserved to control floods but when forecasted inflow is comparatively small due to heteroscedastic forecast errors forecast uncertainty will be smaller this requires that reliable forecast horizons be identified for an efficient forecast based flood control operation zhang et al 2019b wang et al 2021a traditionally lumped catchment models are used to prepare reservoir inflow forecasts but at times these models are unable to provide the desired accuracy errors may also creep in due to complex catchment conditions and data errors this promoted the use of physically based distributed hydrological model pbdhm to forecast inflows yang et al 2022 xu et al 2021 however research is needed to overcome issues concerning calibration and forecast updating while using pbdhm in future pbdhm will likely be increasingly used in reservoir inflow forecasting the performance of hydrological models for forecasting could also be improved through data assimilation techniques leading to their wider use in real time operations zhang et al 2021a in the past few decades machine learning ml methods have been developed to simulate the complex processes of flood formation li et al 2010 mosavi et al 2018 reviewed the state of the art of ml models in flood forecasting popular ml techniques include artificial neural networks anns adaptive neuro fuzzy inference systems anfis multilayer perceptron mlp wavelet neural networks support vector machines svm and ensemble prediction systems ml models can learn the nonlinear rainfall runoff process based on historical data and do not require detailed knowledge of the underlying processes training is very important in application of ml methods an improperly trained ml model can give misleading results anns and deep networks are the most popular ml tools used in water resources because of their accuracy fault tolerance capacity and parallel processing abilities some studies have tried to use an ensemble of ml methods to increase the generalization ability and reduce uncertainty use of ml methods for hydrological modeling and forecasting is expected to grow with time hydrodynamic models are commonly used to compute the flood inundation areas ridolfi et al 2019 making reliable forecasts particularly in data scarce areas is a challenge and forecasts have considerable uncertainty to overcome this handicap satellite based flood data say synthetic aperture radar images are being assimilated with hydrologic model output to reduce the uncertainties in forecasts for example garcía pintado et al 2015 hostache et al 2018 described algorithms that automatically delineate flood inundated areas and found that that the downstream water levels forecasts were significantly improved by sequential assimilation of flood extent maps and the errors were reduced by half despite numerous benefits by the use of forecasts for reservoir operation and flood management reliable short term forecasts are not widely available and used in reservoir regulation particularly in developing countries key reasons behind this are lack of skills and expertise lack of data and lack of infrastructure logistics it would be hugely rewarding to overcome these limitations pappenberger et al 2015 estimated potential monetary benefits of early flood warnings in europe by using flood damage cost data and found that the benefits were to the tune of 400 euro for every 1 euro invested 4 2 real time flood control operation of reservoirs real time flood control operation is accomplished by integrating i data collection ii validation and processing of observed data iii flow forecasting iv flood reservoir operation and v information query cheng and chau 2004 rani and moreira 2010 emphasized on developing computationally intelligent decision support tools various researchers have attempted real time reservoir operation for flood mitigation by integrating a flood forecasting model with an optimization model some of the optimization models that were used to make reservoir release decision during the forecast period were milp hsu and wei 2007 wei and hsu 2008 2009 ga chang et al 2010 pre emptive goal programming choudhury 2010 gp fallah mehdipour et al 2012 later ga in combination with model predictive control mpc technique had found wider application in the field chiang and willems 2015 schwanenberg et al 2015 vermuyten et al 2018 yang et al 2019 used the recurrent neural networks rnn to simulate reservoir operations the optimization models approximately represent the physical system hence various system simulation models were integrated with optimization models for real time reservoir operation malekmohammadi et al 2010 bayat et al 2011 wang et al 2013 evolutionary algorithms like ga penalty type ga reduced ga have found wide application to reservoir operation and specifically to real time reservoir operation for flood mitigation due to their suitability in coupling with hydrologic modelling software chang 2008 che and mays 2017 vermuyten et al 2018 liu and luo 2019 che and mays 2015 2017 developed and illustrated the applicability of an elaborate real time optimal operation model for a multi reservoir system that consists of i a short term rainfall forecasting module ii hec hms for rainfall runoff modelling iii hec ras for unsteady river flow routing and iv ga based optimization module to decide on reservoir releases the optimization algorithm was developed by using matlab which also served to link the hydrologic models applications of the model to a hypothetical system showed their utility and suitability but problem may arise in practical applications when a key module fails to give realistic output in many cases the managers lacked predictive information to control reservoirs and mitigate extreme floods this was experienced in managing the largest flood event in the history of thailand in 2011 kompor et al 2020 developed a method to use streamflow predictions in adaptive reservoir operations for managing extreme floods in the chao phraya river basin predictive information was derived from an ensemble of seasonal precipitation data obtained from the european centre for medium range weather forecasts ecmwf when the reservoir operation plan was changed and seasonal predictions were used the peak river discharge could be decreased by about 20 since a number of factors and data are involved in real time operation a decision support system dss that logically organizes data and models can be of great value dam managers are motivated to use dss by their successful application in many engineering management tasks and wider availability of computers with user friendly graphic interfaces but some are awed by their complexity shim et al 2002 presented a spatial dss sdss for real time flood control in a multipurpose multi reservoir system by integrating several sub systems real time data monitoring database management geographic information and so an ann was employed to develop spatially distributed flood forecasts in real time which are regularly updated application of the sdss to the han river basin korea showed that it helped in reducing flood impacts and conserving water for later use many subsequent studies describe development and application of dss to real life problems with the aid of remote sensing gis graphical tools integrated to multiple criteria decision making levy 2005 knebl et al 2005 ahmad and simonovic 2006 qi and altinakar 2011 werner et al 2013 şensoy et al 2018 lately combined supervisory council and data acquisition scada system with numerical weather prediction nwp data hec hms hec ressim and hec ras models to create a dss for real time reservoir operation and reported improved system performance by use of this dss using the data of danjiangkou reservoir zhang et al 2021b have systematically described the steps of flood control operation including pre depletion for various forecast horizons and types of floods during a flood event release decision of a real time operation model is implemented by operating spillway gates an optimal gate operation reduces the dam susceptibility to overtop che and mays 2017 hence spillway gate operation is an essential part of flood control operation where decisions direct how many gates to be operated to what extent and sequence of opening to arrive at optimal spillway gate operation schedule various optimization algorithms have been employed which include tabu search fuzzy optimization karaboga et al 2008 mixed integer linear programming milp feng and liu 2014 sordo ward et al 2017 cuevas velásquez et al 2020 ga zargar et al 2016 amirkhani et al 2017 albo salih and mays 2021 progressive optimality algorithm poa liu et al 2017 non dominated sorting genetic algorithm amirkhani et al 2017 and particle swarm optimization pso kim et al 2021 for the ease in application commonly used gate types are built in software some software have functions to consider complex structures and operating rules the six stage acanal and haktanir 2000 and the fifteen stage haktanir et al 2013 gate operation policies are the fixed spillway simulation rules that do not require forecast information these prefixed critical levels in the reservoir guide gate manoeuvring optimized critical levels ensure better flood mitigation zargar et al 2016 and allow smooth and continuous gate manoeuvring kim et al 2021 real time operation presents challenges in terms of reliability of operations mechanical electrical faults and human setbacks comparison of various spillway operation strategies reveal the practical relevance of considering the cases of blocked faulty gates amirkhani et al 2017 inoperable spillway gates increase downstream and upstream flood risks hence in real time an event tree based model that considers flood forecasting human availability and response reliability of gate system and the operator error could ensure better representation of the problem paxson et al 2016 although computer models are of immense value in real time operation seasoned operators cross check the results with their experience and in situ data say verify the inflow rate with rate of change of reservoir water level undoubtedly decisions are to be taken quickly but risk of wrong decisions taken in haste is to be avoided spillway gate operation is a critical component of real time operation it is a specialized task and the sequence and rate of opening the gates is project specific 5 uncertainties and risks in flood control operation of reservoirs during reservoir operation for flood mitigation risks arise due to the uncertainties in current and predicted inflows remaining flood cushion in the reservoir or the downstream channel characteristics reservoir regulation also involves a small risk of dam overtopping and break these uncertainties put the operators in a risky situation where flood mitigation or conservation targets or the safety of the dam may be compromised the flood mitigation decisions depend on the flood damage risk estimated as the probability of reservoir releases exceeding the conveyance capacity of river at the control point zhao et al 2014 ding et al 2015 2017 and the dam overtopping risk which is the safety margin relating dam crest height to the likely reservoir water level while routing the floods kuo et al 2007 goodarzi et al 2013 sun et al 2012 the impact of streamflow forecasting on flood control operations depends on many factors valdes and marco 1995 such as the size of the reservoir the lead time over which reliable forecasts can be made the ability of the decision making process to utilize the forecasts the reservoir capacity inflow ratio the spillway release capacity and safe downstream river carrying capacity the uncertainty analysis methods include the first order second moment method fosm the point estimation methods the latin hypercube sampling lhs and the monte carlo simulation mcs lian and yen 2003 the analytical methods are simple but may get cumbersome with increasing number of random variables lack of reliable data and round off errors affect the risk estimates which are mostly based on empirical estimates of the moments of random variables the latin hypercube sampling lhs and monte carlo simulation methods overcome such shortcomings and also yield output distribution the mean the variance and the distribution of the output obtained by using the lhs is nearly unbiased lian and yen 2003 and requires much less effort for the same level of precision compared to the conventional mcs methods impact of various uncertainty factors on reservoir operation can also be quantified by using the shannon entropy concept huang et al 2018 errors in inflow forecast are a major source of uncertainty in reservoir operation and their effect on flood operation rules is crucial li et al 2010 stochastic simulation of inflows chen et al 2015b huang et al 2018 or ensemble forecasts liu et al 2015b cheng et al 2017 ma et al 2021 are adopted to describe uncertainty in reservoir inflow and local flows at the downstream control point to reduce the risk due to inflow forecast errors wang et al 2021a defined a reliable forecast horizon based on various levels of streamflow forecast uncertainties for different lead times zhu et al 2017 emphasized on investigating the effect of forecast uncertainties on optimal flood operation rules and evaluating the associated flood risk the other kinds of uncertainties that invoke flood risks are associated with the water level storage curve flood hydrograph shape chen et al 2019 chen et al 2020 reservoir operation parameters bianucci et al 2013 fu et al 2016 wind wave effect huang et al 2018 and lately the climate induced uncertainties wang et al 2021b the various uncertainties were jointly considered for evaluating the upstream and downstream flood risks the relationships among various uncertainties were modelled using i the theory of stochastic process chen et al 2015b where the uncertainties of reservoir discharge errors forecasting errors of lateral inflows and river flood routing errors were simultaneously considered ii copula chen et al 2016 wang et al 2019b where joint occurrence of the uncertainties in the evolution of flood forecast errors the discharge capacity and the water level storage were considered and iii bayesian networks chen et al 2019 lu et al 2020 which could simultaneously capture the temporal and spatial uncertainty associated with inflow forecasts to ensure uniformity in sampling lhs was employed for generating a vector of uncertainties which could be used in risk evaluation huang et al 2018 wang et al 2019b wang et al 2021c risk analysis was performed by using methods that include the statistical method bianucci et al 2013 chen et al 2015b cheng et al 2017 ning et al 2021 the entropy based method huang et al 2018 sun et al 2018 and the monte carlo simulations chen et al 2019 studies have computed the risk during reservoir operation for flood mitigation in a multi reservoir system also chen et al 2015b wang et al 2019b meng et al 2019 chen et al 2020 wang et al 2021c the forecast horizons fh of each reservoir in a multi reservoir system could be different whereas their operation horizons oh are the same gong et al 2020b developed a two stage model in which a multivariate autoregressive model was used to derive multi normal distribution of multi reservoir storage during the first stage of fh for the time between fh and oh the flood risk was computed by routing the design floods through the reservoirs total risk during the oh was the combined risk at all the stages and the operation corresponding to minimum total flood risk was optimal operation for the entire system ning et al 2021 evaluated the risk created by single hazard events and union and intersection of single hazard events uhe and ihe through an analytical framework the authors claimed that the proposed methodology is more precise compared to the risk analysis method that uses total probability law wang et al 2021c examined the uncertainties and evaluated the associated risk in a multi reservoir system they performed a detailed evaluation of the risk that arises due to the uncertainty in streamflow series flood forecast error water level storage curve error and reservoir discharge capacity error independently this was followed by simultaneously considering the above four uncertainties for risk evaluation the daily streamflow at the multiple sites were generated by using a multivariate seasonal autoregressive model the error in flood forecast was modelled by a wakeby distribution and the error in water level storage and discharge capacity was assumed to follow a standard normal distribution lhs was used to generate samples of uncertainties for risk evaluation the overall risk of the multi reservoir system was expressed as product of the probability of failure and the consequences of failure the probability of failure is the number of times the loading maximum flood storage capacity the largest peak discharge at the downstream control point and the flood diversion volumes in the flood detention basins exceeds the resistance safe storage capacity safe water release and safe flood diversion consequences of failure are quantified using the conditional value at risk index their study is a comprehensive evaluation of uncertainties and associated risk in a multi reservoir flood control system located in the upper yangtze river basin in china when the incoming flood at a reservoir exceeds the design flood hydrologic failure may occur whose risk is associated with the return period of the design flood yan et al 2022 evaluated risk associated with changing climatic conditions and hence increased occurrences of extremes three scenarios of the gcms were used in conjunction with swat model to generate future daily flow series a stochastic arima model was used to simulate various possibilities of the annual flood peak series while preserving the characteristics of past and future floods the bayesian model averaging approach was used to weight the flood risks projected by each gcm to better incorporate the uncertainty of gcms risks associated with reservoir operation and dam safety were computed and could be used to upgrade the design standards or fortify structures to summarize uncertainties arise in flood control operation of reservoirs due to imperfect knowledge about the system inputs including forecasts and downstream conditions uncertainty analysis should be a necessary component of real time reservoir operation every uncertainty analysis method has its own hypothesis advantages and limitations kuo et al 2007 however important factors are the robustness of the flood control model and its associated parameters bianucci et al 2013 the reservoir simulation models have to be tested under various uncertain conditions and an ensemble of hydrologic loading for better performance the review reveals that there is big scope for research concerning uncertainty analysis in a multi reservoir system the temporal and spatial joint modelling of multiple uncertain factors followed by risk evaluation of the reservoir flood mitigation system could ensure better performance the uncertainty arising due the variable length of the forecast period in different reservoirs in a system has seldom been considered structural measures for flood disaster risk reduction such as dams and embankments provide a feel of safety to the people residing in their vicinity since the structures particularly embankments may fail some experts perceive this sense of security to be false and therefore frequently the residual risk is underestimated thus there is a need of increasing flood risk awareness and accounting for residual flood risk related with the structural flood control measures 6 way forward operation of a multipurpose reservoir during the flood is a challenging task since it involves making decisions to maximize benefits from mutually conflicting purposes in such regulation priority would be to avoid dam overtopping control flooding in downstream and attain the highest reservoir level at the end of high flow season the discussions presented in this review paper show that the research on reservoir operation during floods has received considerable attention from researchers across the globe the most common strategy of research and operational suggestions were based on employing an inflow forecast model a reservoir simulation model and an optimizer to arrive at best possible solutions that ensure the fulfilment of prioritized objectives most of them were case specific such as formulation of the simulation model that represent the system being studied formulation of objective functions and their priority for the system formulation of optimization model by varying algorithms etc nonetheless persistent efforts are still required to assist the reservoir managers take decisions to operate the reservoir in situations of extreme flood event the reservoir operation during a flood is highly complex owing to the dynamic variability of the state of the system the reservoir flood control parameters rfcp and the inflows during the event by judicious use of weather and inflow forecasts managers can efficiently use the storage space capture additional water avoid sharp fluctuations in outflows and reduce downstream flood risks however availability of reliable forecasts of weather variables and reservoir inflow is still an area of research the forecast models do propagate a large amount of uncertainty in their output that is inherited from the uncertainty in input variables model structure and parameters while there were quite some studies about quantification of uncertainty in the forecast models efforts to reduce the uncertainty in the output so as to develop confidence in the forecasted variables are still lacking a major challenge is when a conservation based reservoir single purpose is to be employed for flood management in critical situations although both flood control and conservation are important usually flood control gets more attention than reservoir filling in such situations since flood damages are visible get bad publicity and make managers vulnerable in cases where a major flood arrives at the end of the flood season when the reservoir is mostly filled to its full capacity emergency operations are warranted in such cases the objectives would certainly be conflicting and assigning priorities for these objectives would be an intricate task the decision making in such situations could be posed as a coordinated management problem rather than an engineering based operational problem therefore further research efforts are essential to develop customized decision support systems dss that can forecast reliable inflows aid analyze operation alternatives and help perform scenario analysis so as to manage real world complexities yet another challenge which did not receive much attention by the research community is to formulate the reservoir operation problem in cases where multiple flood events successively enter into the reservoir with short inter event time number of flood events and time of occurrence are crucial in decision making in such cases the time span of operation become large and enough storage room is to be maintained in the reservoir prior to the arrival of the subsequent flood and therefore require derivation of rfcp in a dynamic manner implying different rfcp values for pre main and post flood time periods effective integration of stochastic tools in planning and forecasting tools for real time decisions is to be explored further to address this issue the warming climate is projected to introduce increased variabilities in the river flows in terms of both the extremes drought and floods in the future therefore the reservoirs would require judicious management to provide the desired protection against floods while conserving more water flood management by reservoirs also has social and environmental dimensions a fact usually ignored solutions obtained by involving the society would have more acceptability and have higher chances of success application of artificial intelligence and machine learning tools to develop transdisciplinary tools that use knowledge of meteorology hydrology operations research information technology social sciences etc may be explored in reservoir system management 7 data availability this is a review paper we have not used any data in the analyses reported reviewed here declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank their respective institutes the indian institute of technology roorkee the indian institute of technology madras and the national institute of hydrology roorkee for making available the requisite facilities while working on this paper the second author would also like to thank prof k srinivasan indian institute of technology madras for many disccussions which enabled her to contribute to the current work appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129165 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2186,the xiluodu arch dam is one of the highest dams in the world a noticeable leakage having a maximum rate of 192 l s and accounting for 46 75 of the total discharge at the site has been observed in the plunge pool area since impoundment for long term safety of the dam an integrated approach of groundwater temperature analysis hydrochemical data clustering cross correlation function and inverse modelling is presented to detect the sources and flow paths of the leakage it is found that the leakage is originated from three major sources i e the confined limestone aquifer underlain by the unconfined basalt aquifer the reservoir and the downstream river the vertical leakage from the limestone aquifer occurs through unplugged boreholes drilled during site investigation inverse modelling shows that induced by particle filling clogging and rock deformation the effective permeability of the unplugged boreholes follows the same exponential decay with the near field basalt rocks upstream the impervious system consequently the amount of the vertical leakage decreases annually which leads to an annual decrease of the discharge in the plunge pool area the leakage from the reservoir and the downstream river is dynamically stable in magnitude which occurs through the basalt aquifer by bypassing the grout curtains in the dam and subsidiary dam foundations respectively during the past seven years of operation the proportions of leakage from the above three sources account for on average 44 31 and 25 respectively keywords leakage detection hydrochemistry analysis cross correlation analysis inverse modelling permeability variation data availability data will be made available on request 1 introduction in the last three decades a considerable number of large scale dams with a height over 200 m have been built or are under construction worldwide for power generation flood control navigation and water resources utilization the construction of high dams underground powerhouse caverns and hydraulic tunnels significantly changes the groundwater flow at the sites by raising reservoir water levels and or presenting new discharge boundaries chen et al 2016 zheng et al 2021 the change in groundwater flow patterns may induce various geological hazards such as leakage liu et al 2021 water mud inrush li et al 2016 seepage erosion zhang et al 2022 ground subsidence tangdamrongsub et al 2019 valley contraction wang et al 2020 zhou et al 2022 landslide chen et al 2022a and even dam collapse chen and capart 2020 franci et al 2020 groundwater flow control is therefore indispensable in dam engineering to limit the amount of leakage reduce the pore pressure and increase the resistance to erosion by means of impervious barriers drains and filters zhou et al 2023 but due to the heterogeneity of geological media and the complexity of site conditions the events of leakage through dam foundations frequently occur even a seepage control system is elaborately designed and constructed chen et al 2016 2021 zhou et al 2015 the primary task for leakage treatment is to identify the origin of leakage and the path where it takes place zhou et al 2015 various techniques have been developed for this purpose and they can be broadly classified into four categories 1 geophysical survey 2 tracer test and groundwater chemical analysis 3 cross correlation analysis and 4 inverse modelling geophysical survey has been proven effective in detecting cavities and water content zones by using ground penetrating radar electrical resistivity tomography or self potential survey chalikakis et al 2011 afshar et al 2015 liu et al 2021 but due to its limitations in penetration depth and resolution this technique is less applicable to the foundation of a large scale dam during operation martínez moreno et al 2015 lee et al 2020 tracer test is a widely used tool to investigate the origin of leakage the interconnectivity of flow paths and the flow velocity in boreholes bolève et al 2011 environmental isotopes e g δ18o δd and δ13c groundwater temperature and hydrochemical components are frequently used as natural tracers chiogna et al 2014 yin et al 2021 the cross correlation function ccf is often used to analyse the relationships between two time series of the quantities such as reservoir water level discharge and groundwater level in boreholes bailly comte et al 2011 fu et al 2016 schuler et al 2020 the peak and the lag value of the cross correlation provide useful information about the time interval of pressure pulse transfer in the aquifers hence indicating the hydraulic interconnectivity from one location to another zhou et al 2021 luo et al 2022 chen et al 2022b inverse modelling is another tool that has been widely used to determine the permeability of aquifers on the site scale and infer the aquifer where the leakage path is located schilling et al 2019 this technique relies on an optimization procedure to minimize the objective function constructed with field observation data and the continuum approach is commonly applied for its computational efficiency to solve the site scale problems even for groundwater flow in fractured aquifers jiang et al 2017 zhou et al 2023 the above techniques are often combined for a more reliable detection of leakage through dam foundations chen et al 2016 yin et al 2021 located on the lower reach of jinsha river southwest china the xiluodu arch dam has a height of 285 5 m dominating as the fourth highest dam of the same type in the world since reservoir impoundment leakage has been observed in the plunge pool area with a maximum flow rate up to 192 l s chen et al 2021 the leakage rate accounts for 45 9 74 8 of the total discharge at the site including dam foundation underground caverns and plunge pool and is remarkably larger than those of other high arch dams therefore there is a need to understand how this leakage occurs and how it may influence the long term safety of the dam this study presents an integrated technique of groundwater temperature analysis hydrochemical analysis cross correlation analysis and inverse modelling for leakage detection in the plunge pool area at the xiluodu dam combined with site characterization and field monitoring data the former three approaches are applied to identify the origins and flow paths of the leakage inverse modelling and numerical simulation are then performed to investigate the permeability variation of the aquifers where the flow paths are located and the proportions of the leakage that are originated from different sources the potential influence of the leakage on the dam safety is discussed 2 site characterization 2 1 project description located on the lower reach of jinsha river between leibo sichuan and yongshan yunnan the xiluodu hydropower plant xhp is one of the largest hydropower plants in the world fig 1 the xhp mainly consists of a concrete double curvature arch dam with a height of 285 5 m and a crest length of 681 5 m two underground powerhouse cavern systems and four spillway tunnels located almost symmetrically in both banks fig 2 the xhp has a total installed capacity of 13 8 gw and the reservoir has a total capacity of 1 28 1010 m3 at the normal pool level of 600 m a s l the dam is endowed with 7 surface spillways and 8 deep orifices together with 4 spillway tunnels for flood control and a subsidiary dam downstream the arch dam to form a plunge pool for energy dissipation fig 3 the construction of the dam was completed in march 2014 and the reservoir filling started in september 2012 2 2 geological settings the dam site is located in a typical u shaped valley roughly at the center of the yongsheng synclinal basin where the jinsha river turns 90 from northeast to southeast fig 1b and c the yongsheng basin having a diameter of about 30 5 km and an area of 730 km2 is an independent hydrogeological unit hu the formations from bottom to top consist of clastic sedimentary rocks of the silurian system s limestone of the lower permian yangxin group p1y basalt of the upper permian emeishan group p2β clastic sedimentary rocks of the upper permian xuanwei group p2x clastic and carbonate sedimentary rocks of the triassic system t and quaternary loose deposits q as shown in fig 1d and 2b between the limestone p1y and basalt p2β formations there deposits a thin clay shale layer p2βn with a thickness of 3 5 m the rock layers s p2x and p2βn are of low permeability hence making aquifers p1y p2β t and q and aquitards s p2x and p2βn alternately distributed in the basin consequently the limestone aquifer p1y is confined which is recharged by precipitation and melt snow on the margins of the basin where the aquifer outcrops and eventually discharged to the jinsha river the xiluodu dam is situated on the basalt aquifer p2β which consists of a sequence of lava flow layers typically with a tuff layer c1 c12 on the top of each layer fig 2b this aquifer is unconfined and has a low groundwater level owing to the overlying aquitard p2x that impedes the vertical infiltration into it thousands of packer tests together with other hydraulic tests and inverse calibrations were performed to evaluate the permeability of the aquifer and aquitard systems chen et al 2018 particularly at the dam site fig 2b the permeability of the basalt formations p2β was found to follow a power law decrease with depth and can be correlated with the degree of weathering by dividing the formations into a heavily weathered zone hwz an upper moderately weathered zone umwz a lower moderately weathered zone lmwz a slightly weathered zone swz and a fresh bedrock zone fbz according to its permeability the limestone formation p1y can be divided into an upper zone and a lower zone chen et al 2021 the upper zone about 80 m in thickness is karstified and has a permeability about one order of magnitude higher than that of the lower zone the hydraulic properties of the rock formations at the dam site are listed in table 1 2 3 groundwater observation and leakage in the plunge pool area to properly control the groundwater flow in the dam and underground powerhouse areas grout curtains were constructed from 6 levels of grouting tunnels fig 2a and fig s1 in supplementary material the curtains cover an area of 8 7 105 m2 and extend downwards to a lowest elevation of about 180 m a s l chen et al 2021 a total number of 7980 drainage holes were drilled from 5 levels of drainage tunnels downstream the grout curtains in the plunge pool area there is a small grout curtain in the foundation of the subsidiary dam together with a drainage system consisting of 4 longitudinal galleries along the river 6 transverse galleries perpendicular to the river and drainage hole arrays fig 3 the seeped water in this area flows into a pump house through a diversion tunnel a monitoring system consisting of 123 peizometers and 52 weirs were installed to assess the groundwater flow behaviour at the dam site fig s2 in supplementary material chen et al 2021 the pore pressure and flow rate data have been continuously recorded since the end of 2014 the data shows that there is a remarkable amount of leakage in the plunge pool area attaining 192 l s at its maximum and accounting for 45 9 74 8 of the total discharge at the dam site as shown in fig 4 this leakage rate is much larger than those of other high arch dams e g no more than 60 l s for ertan arch dam 240 m high gao et al 2021 and 30 l s for goupitan arch dam 232 5 m high hu et al 2020 furthermore the leakage fluctuates violently in each operation cycle and displays a clear trend of decrease from year to year during site characterization a number of 28 boreholes were drilled but not plugged in the plunge pool area fig 3 these boreholes were penetrated into the confined aquifer p1y across the aquitard p2βn and may provide channels for the confined groundwater to move up to the drainage system to further understand the groundwater flow behavior at the dam site a total of 17 observation boreholes were drilled since december 15 2018 to collect the groundwater level temperature and hydrochemical data in the unconfined p2β aquifer xzk01 and xzk04 xzk10 and in the confined p1y aquifer xzk02 xzk03 and hzk01 hzk07 as shown in fig 2 3 materials and methods 3 1 hydrochemical analysis a total of 31 water samples were collected in december 2018 and january 2021 respectively from the reservoir the downstream river channel the drainage holes in the plunge pool area and the observation boreholes as listed in table 2 the chemical and stable isotope compositions of the water samples were analyzed to identify the sources of the leakage as shown in table 3 the stable isotopes were analyzed with an lgr water isotope analyzer device and the results were reported as δ18o and δd values representing per mil deviations from the vsmom vienna standard mean ocean water standard zhou et al 2020 the ph values were measured in situ by an hi9124 instrument with a precision of 0 01 which also recorded the temperature of the samples the primary metal ions e g na k ca2 and mg2 were analyzed by an inductively coupled plasma optical emission spectrometry icp oes anions were measured by an lc 10a instrument for cl and so 4 2 and by hydrochloric acid titration for hco 3 and co 3 2 ionic balance analysis was performed for all samples with an error smaller than 10 ward s hierarchical clustering method was used to group the water samples by minimizing the total within cluster variance yang et al 2020 zhong et al 2022 given that the tds total dissolved solids data is unavailable for some water samples the ph value and the concentrations of six chemical components ca2 mg2 na k cl so 4 2 and hco 3 co 3 2 are selected as the variables for clustering the variables are first nondimensionalized by 1 z ij x ij x j σ j where xij is the jth data of sample i zij is the nondimensionalized value of xij and x j and σj are the mean and standard deviation of the jth data over all samples initially ward s method treats each water sample as an individual cluster then the pair of clusters with minimum distance is grouped to form a new cluster this procedure iterates until all samples are agglomerated in a whole cluster the ward s distance dpk between clusters p and k is defined as 2 d pk n p n k n p n k d pk where np and nk are the number of samples in clusters p and k respectively and dpk is the distance between the cluster centers which can be evaluated with euclidean distances 3 d pk j 1 m 1 n p i 1 n p z pij 1 n k i 1 n k z kij 2 where zpij and zkij are the jth nondimensionalized data of sample i in clusters p and k respectively and m is the number of variables in each water sample m 7 in this study in this study the software r version 3 5 1 was used for the clustering analysis 3 2 cross correlation analysis since may 2014 the reservoir water level fluctuates annually fig 4 therefore the time series data of reservoir water level discharge and borehole water level can be first decomposed into the following three major components 4 y t y tr t y pr t y ir t ε t where y t is the target time series to be fitted y tr t y pr t and y ir t denote the non periodic trend periodic and potentially irregular components of y t respectively and εt is an error term that follows a normal distribution the prophet model was applied to detrend the time series for its high accuracy and strong robustness in disposing of complex time series features such as strong seasonality trend changes and outliers taylor and letham 2018 aguilera et al 2019 papacharalampous and tyralis 2020 the machine learning algorithm i e the penalized maximum likelihood estimation with optimization embedded in prophet was used to improve the fitting precision taylor and letham 2018 the non periodic trend component y tr t is modelled by logistic growth function and the periodic component y pr t is fitted by fourier series the cross correlation between a pair of time series is then evaluated over the decomposed periodic components which helps identify the hydraulic connectivity and groundwater flow paths from the reservoir for any two periodic time series x and y the cross correlation rxy τ at lag τ is defined as 5 r xy τ c xy τ σ x σ y 6 c xy τ 1 n t 1 n τ x t x y t τ y where cxy τ is the cross covariance at lag τ σx and σy are the standard deviations of series x and y respectively x and y are the means of x and y and n is the number of time series data 3 3 numerical simulation and inverse modelling it is widely accepted in dam engineering that the continuum approach can be satisfactorily applied to model the groundwater flow through fractured foundation rocks with sufficient accuracy since the construction of impervious barriers significantly weaken the role of individual faults and fractures chen et al 2016 2021 2022b a 3d finite element model with a dimension of 4000 3550 1000 m was created for flow simulation and inverse modeling at the dam site the model well represents the geological settings hydraulic structures and the seepage control systems containing 10 8 million brick elements with some of them degenerated to tetrahedral elements and 3 6 million nodes as shown in fig 5 a and fig s1 in supplementary material particularly a substructure technique was used to accurately represent the geometries and boundary conditions of 7980 drainage holes at the site chen et al 2008 the preferential flow along the 28 unplugged boreholes in the plunge pool area was assumed to follow hagen poiseuille s law and 1d pipe elements of hydraulic conductivity k b were adopted to simulate these boreholes the transient groundwater flow through the dam foundation follows the following continuity equation chen et al 2011 7 1 h s s ϕ t 1 h k ϕ where ϕ p ρ w g z is the total water head p is the pore water pressure ρ w is the density of water g is the gravitational acceleration k is the hydraulic conductivity tensor s s is the specific storage h is a heaviside function defined as h 0 if ϕ z in wet domain and h 1 if ϕ z in dry domain and t is time the governing equation eq 7 is formulated in a domain consisting of a wet domain below phreatic surface and a dry domain above it by means of heaviside function this enables eq 7 to be rigorously and effectively solved with the discretized parabolic variational inequality pvi method by formulating the seepage boundary condition as the unilateral condition of signorini s type and transforming the phreatic surface as an inner boundary inside the domain chen et al 2011 the flow simulation lasted for 85 months from may 2014 to may 2021 with a time step of 3 days the initial condition of eq 7 i e the initial distribution of water head in the domain was given by a steady state simulation calibrated with observations of groundwater level table s1 in supplementary material the boundary conditions were specified as follows 1 the time variant reservoir water level and the corresponding downstream river stage were prescribed as water head boundary conditions 2 the base of the model was taken as no flow boundary 3 to approximate the lateral flux exchange the lateral boundaries were prescribed with water head calibrated by a basin scale flow simulation zhou et al 2023 as shown in fig 5b and fig s3 in supplementary material and 4 the walls of drains and the surfaces of drainage tunnels were taken as the potential seepage boundary except the lowest level of drains which may satisfy the water head boundary condition the finite element code thyme3d that has been developed for decade chen et al 2011 2016 2021 li et al 2014 zhou et al 2015 is adopted for numerical simulation it has been clarified that during reservoir operation the permeability of fractured rocks upstream the grout curtains is significantly influenced by suspended sediment deposition and fracture clogging chen et al 2021 furthermore the unplugged boreholes in the plunge pool area were filled with gravels sands and fine particles after being drilled and during construction the permeability of the unplugged boreholes may be further influenced by particle movement from the limestone aquifer p1y and the deformation of the thin clay shale layer p2βn inverse modelling was therefore performed to more representatively obtain the permeability of the fractured rocks and the unplugged boreholes by optimizing the following objective function 8 min f p i 1 m ϕ i p ϕ i 2 2 ϕ i 2 2 1 2 w j 1 n q j p q j 2 2 q j 2 2 1 2 where f is the weighted objective function p is the vector of hydraulic parameters to be back calculated m and n are the number of piezometers and weirs respectively ϕ i and ϕ i are the time series of simulated and measured piezometric head at piezometer i respectively q j and q j are the time series of simulated and measured discharge at weir j respectively and w is a weight coefficient in this study seven parameters were selected for inverse modelling i e p k i ν i k ii ν ii k iii ν iii k b here k i k ii and k iii denote the in plane hydraulic conductivity in the lmwz i swz ii and fbz iii zones upstream the grout curtains fig 3 respectively ν i ν ii and ν iii denote the anisotropic ratio of the hydraulic conductivity perpendicular to the bedding planes to the in plane component in the corresponding zones and k b represents the equivalent hydraulic conductivity of the unplugged boreholes the time series data at 21 peizometers and 11 weirs were selected for weighted objective function fig s2 and table s2 in supplementary material the weight coefficient takes w 0 06 such that the magnitude of the two terms on the right hand side of eq 8 is balanced the inverse modelling was performed for each annual cycle of the reservoir water level the procedure combining orthogonal design transient flow analysis artificial neural network and genetic algorithm was adopted for its high efficiency chen et al 2016 2020 2021 zhou et al 2015 as shown in fig s4 in supplementary material 4 results 4 1 result of groundwater temperature analysis as a natural tracer the groundwater temperature was first analyzed and compared to the temperature of surface water i e the reservoir water and the downstream river water table 2 shows that the groundwater seeped out of the drainage system in the plunge pool area can be classified into two types warm groundwater above 25 c and cold groundwater below 25 c the warm groundwater was all sampled from the drainage holes in the lowest level galleries at 335 m a s l and the temperature ranged in 26 4 38 5 c with a mean of 31 1 c the cold groundwater was observed at various locations including drainage holes and gallery walls in the plunge pool drainage system from 335 m a s l to 355 m a s l the temperature of cold groundwater was in the range of 20 8 24 4 c with a mean of 22 3 c which is rather close to the range 18 9 23 2 c and mean 20 7 c of the temperature of surface water samples fig 6 plots the temperature curves measured by five typical piezometers installed in the plunge pool foundation 335 m a s l and the bank slopes 386 m a s l the curves show that the temperature of groundwater in the bank slopes varies around 20 c which is comparable to the temperature of reservoir water and downstream river water the groundwater temperature in the plunge pool foundation however is constantly higher than 25 c with a maximum of 33 c table 4 lists the mean groundwater temperature measured at the observation boreholes between 2019 and 2021 which well represents the borehole groundwater temperature that varies in a rather narrow range the data shows that the mean temperature of the confined groundwater limestone aquifer ranging in 24 2 39 0 c is on average 6 c higher than that of the unconfined groundwater basalt aquifer ranging in 22 6 30 2 c and is significantly higher than the temperature of surface water below 20 c fig 6 it can be inferred from the above analysis that at the dam site the temperature of the confined groundwater is higher than that of the unconfined groundwater which is in turn slightly higher than the temperature of surface water the groundwater temperature in the plunge pool area lies in between the temperature of the confined groundwater and that of surface water implying that the leakage has different sources of supply and the temperature is a result of the mixing of different sources of water 4 2 result of hydrochemical analysis table 3 shows that the tds concentration of the warm groundwater samples taken from the lowest level galleries 194 268 mg l is remarkably smaller than that of other water samples 264 382 mg l implying a potential different origin of the warm groundwater fig 7 a shows a piper diagram of the water samples which classifies the water samples into hco3 cl and hco3 so4 hydrochemical facies the former were sampled from surface water including reservoir water downstream river water and plunge pool surface water and cold groundwater in the plunge pool foundation and are characteristic of relatively higher contents of cl and so4 ions cl content so 4 2 content the latter consist of warm groundwater samples taken from the drainage holes in the plunge pool foundation and the observation boreholes in the limestone aquifer characterized by much lower content of cl ion than the former facies cl content so 4 2 content fig 7b shows the dendrogram constructed by ward s minimum variance method which clusters the water samples into four groups with a ward s distance of 6 group 1 contains water samples taken from the reservoir and the downstream river group 2 contains the reservoir water samples the downstream river water samples and the cold groundwater samples taken from the plunge pool drainage galleries 335 355 m a s l this implies that the reservoir and the downstream river are the sources of supply for the cold groundwater in the plunge pool foundation group 3 contains warm groundwater samples from the observation boreholes in the limestone aquifer and the drainage holes at 335 m a s l indicating that the warm groundwater in the plunge pool foundation is originated from the confined limestone aquifer besides warm groundwater samples e g hzk04 cold groundwater samples w09 and w10 are also contained in group 4 this is because the samples w09 and w10 were taken in december 2018 when the increasing flood discharge fig 4 sped up the mixing between the warm and cold groundwater of different origins if using a ward s distance of 8 then all the water samples can be clustered into two groups one contains surface water samples and cold groundwater samples originated from surface water and the other contains warm groundwater samples originated from the confined limestone aquifer the stable isotopic compositions of δ18o and δd were collected from part of the water samples as shown in table 5 and fig 8 it should be noted that the δd value of the borehole groundwater samples is influenced by high mud content and is hence scattered widely the warm groundwater samples from the plunge pool drains and the observation boreholes can be clustered as one group for their higher values of δ18o and δd whereas the cold groundwater samples from the plunge pool drains possess almost the same lower δ18o and δd values with the surface water samples from the reservoir and the downstream river interestingly the groundwater samples w03 and w04 collected from the side walls of the drainage galleries tables 2 and 5 have middle isotopic compositions between the above two groups evidencing the occurrence of vertical leakage from the confined limestone aquifer to the plunge pool foundation fig 8 further shows that the stable isotope data of the warm and cold groundwater samples from the plunge pool drains are closely around the local meteoric water line lmwl δd 7 44δ18o 6 36 r2 0 88 and the global meteoric water line gmwl δd 8δ18o 10 r2 0 91 respectively this implies that the warm groundwater is recharged by precipitation along the margins of the yongsheng basin where stronger evaporation occurs 4 3 result of cross correlation analysis the ccfs between the periodic components of the plunge pool discharge and the reservoir water level the downstream river stage and the groundwater level at two observation boreholes hzk03 and hzk07 were calculated as shown in fig 9 it shows that the leakage is highly correlated to the downstream river stage r 0 87 with a quick hydraulic response τ less than 1 d this is not surprising because the grout curtain in the subsidiary dam foundation has a limited depth of 67 m and hence the river water can bypass this local grout curtain and infiltrate into the plunge pool drainage system through the basalt formation the grout curtain of the arch dam foundation however has a maximum depth of 152 m which results in longer flow path from the reservoir τ 1 d and lower cross correlation of the leakage with the reservoir water r 0 74 furthermore there is also a high cross correlation between the plunge pool leakage and the confined groundwater in the limestone aquifer as evidenced by r 0 85 and τ 2 d for the groundwater level observations at borehole xzk03 the above cross correlation analysis indicates again that the plunge pool leakage is originated from multiple sources including the reservoir the downstream river and the confined limestone aquifer 4 4 result of inverse modelling it can be inferred from sections 4 1 4 3 that the confined limestone aquifer p1y underlain by the unconfined basalt aquifer p2β is one of the major source for the leakage into the plunge pool drainage system however there is a thin bedded aquitard p2βn between p1y and p2β fig 1d and 2b then how the vertical leakage occurs across this aquitard the answer is the 28 unplugged exploratory boreholes drilled during site characterization fig 3 which penetrated into the limestone aquifer and ever caused vertical leakage during the excavation of the plunge pool foundation to further understand the flow behavior through the unplugged boreholes inverse modelling was performed by using the model shown in fig 5 our previous inverse modelling has shown that the permeability of the near field basalt rocks upstream the grout curtains follows an exponential decay with time as a result of sediment deposition and fracture clogging chen et al 2021 9 k k 0 e α t β 1 β where k is the component of hydraulic conductivity parallel to bedding planes k 0 is the inversed value of k in the first operation cycle may 2014 may 2015 α and β are fitting coefficients and t is time in year interestingly the inverse modelling in this study confirms that eq 9 also applies to the equivalent hydraulic conductivity k b of the unplugged boreholes modelled by pipe elements fig 10 a shows that the mean annual discharge q in l s from the plunge pool drainage system decreases annually and can be well correlated to the inversed hydraulic conductivity k b in cm s of the pipe elements with a power law function q 28 k b 0 35 46 r2 0 98 by virtue of eq 9 it is found that the hydraulic conductivity of the pipe elements and the near field basalt rocks varies in a unified pattern with a high coefficient of determination r2 0 988 with α 0 536 and β 0 008 as shown in fig 10b the inversed initial values of hydraulic conductivity in the first operation cycle are listed in table 6 by hagen poiseuille s law the estimated initial value of k b 50 cm s in the first operation cycle implies an effective diameter of 1 3 mm for the unplugged boreholes this result is reasonable because after the exploratory boreholes were abandoned and during construction of the dam they had been filled with gravels sands and rock fragments the permeability decay of the unplugged boreholes afterwards is attributed to clogging and rock deformation mud inrush was often observed as the observation boreholes were drilled into the limestone aquifer fig s5 in supplementary material indicating that muds and fine grained sediments are abundant in the karstified upper zone of the limestone formation after the reservoir impoundment there is a significant increase of pressure difference between the limestone and basalt aquifers the induced vertical flow from the limestone to the basalt aquifers continuously transports and deposits mud particles and fine grained sediments in the unplugged boreholes furthermore the clay shale p2βn is a soft rock with its mechanical properties much weaker than those of the limestone and basalt formations table s3 in supplementary material the creep deformation of the clay shale surrounding the unplugged boreholes may be another important factor that induces a decrease in the effective diameter of the boreholes and hence the decay of the borehole conductivity figs 4 and 11 show comparisons between the simulated and measured curves of discharge in different areas and groundwater level at the observation boreholes respectively tables 7 and 8 list the mean absolute error mae root mean square error rmse and mean absolute percent error mape between the simulated and measured time series data of discharge and borehole groundwater level respectively fig 12 further compares the simulated and measured mean piezometric heads at 19 piezometers in the dam foundation 18 piezometers around the underground powerhouse cavern systems and 6 piezometers in the plunge pool foundation see fig s2 and table s4 in supplementary material for their locations the results show that the groundwater flow behaviors at the dam site are satisfactorily simulated with engineering accuracy the mae rmse and mape values for discharge in different areas are 0 64 10 40 l s 0 85 14 28 l s and 9 08 27 59 respectively table 7 and fig 4 the simulated discharge in the plunge pool area has the highest mae and rmse but the lowest mape caused by the fact that the discharge is periodically influenced by flood discharging and the subsequent overhauls on the contrary the magnitude of discharge in the dam foundation is quite small hence having the highest mape but the lowest mae and rmse fig 11 shows that the groundwater level at all the observation boreholes in the confined limestone aquifer is well correlated with the reservoir water level this is because the aquifer crops out at the confluence of doushaxi stream about 2 km upstream the dam fig 1c which facilitates the pressure pulse transfer from the reservoir to the dam site along the karstified upper zone of the aquifer except the borehole xzk08 fig 2a located upstream the impervious system the groundwater level at the observation boreholes in the unconfined basalt aquifer keeps rather stable as a result of the drainage system and is less correlated to the reservoir water level the values of mae rmse and mape for the simulated groundwater level or piezometric head are in the ranges of 2 28 14 87 m 3 28 17 25 m and 0 85 2 94 respectively table 8 and fig 12 this simulation result is reasonable given the complexity of the site conditions 4 5 sources and flow paths for the plunge pool leakage the numerical tool that has been calibrated and validated in section 4 4 is further applied to identify the sources and flow paths for the leakage into the plunge pool drainage system by treating the aquitard p2βn as an impervious media and removing the pipe elements the amount of vertical leakage from the confined limestone aquifer p1y across the aquitard and through the unplugged exploratory boreholes can be calculated on this basis by changing the water head boundary condition on the downstream river channel to the seepage boundary condition the amount of supply from the downstream river is then separated from the remaining part that is mainly originated from the reservoir through the unconfined basalt aquifer p1β fig 13 shows the amount of discharge in the plunge pool area originated from the limestone aquifer the downstream river and the reservoir respectively in the first operation year may 2014 may 2015 the vertical leakage from the limestone aquifer accounts for 56 of the total discharge this amount of leakage then decreases annually to 33 in the last operation cycle may 2020 may 2021 due to the decay of the effective permeability of the unplugged boreholes the amount of supply from the downstream river keeps rather stable from year to year varying between 22 and 28 the amount of leakage originated from the reservoir is also dynamically stable in magnitude but its proportion increases annually from 22 to 42 due to the annual decrease in the magnitude of the total discharge the decay of hydraulic conductivity in the near field basalt rocks upstream the grout curtains has negligible impact on the discharge in the plunge pool area as shown by the difference between curves 1 and 2 in fig 13 where curve 2 is calculated with the initial value of k calibrated in the first operation cycle during the seven years of operation the proportions of leakage from the above three sources are on average 44 25 and 31 respectively fig 14 shows the distribution of the calculated discharge in the plunge pool drainage system on may 31 2021 it shows that the discharge from the lower level galleries 335 m a s l is much larger than that from the higher level galleries 355 m a s l and the discharge from the right bank galleries is higher than that from the left bank galleries fig 14a the vertical leakage originated from the confined limestone aquifer mainly occurs through the drainage holes where an unplugged exploratory borehole is located nearby fig 14b typically with the leakage rate from a single drainage hole much larger than 0 5 l s the above phenomena are all consistent with the field observations the leakage from the downstream river mostly occurs on the downstream side of the drainage system more on the left bank fig 14c while the leakage from the reservoir mainly occurs on the upstream side more on the right bank fig 14d 5 discussion in this study an integrated technique of groundwater temperature analysis hydrochemical analysis cross correlation analysis and inverse modelling was applied for leakage detection in the plunge pool area at the xhp site this is done on the basis that the basin scale hydrogeological conditions and the site scale groundwater flow behaviors have been properly understood chen et al 2021 zhou et al 2022 our recent study has clarified that the annually decreased discharge in the dam foundation and the underground cavern areas is induced by suspended particle deposition and fracture clogging in the near field basalt formations upstream the impervious system chen et al 2021 it remains unsolved however why the leakage in the plunge pool area accounts for over half of the total discharge at the site and how this leakage occurs and evolves this phenomenon is closely related to the specific hydrogeological structure of alternate aquifers and aquitards in the basin which induces valley contraction at the dam site and poses a potential threat to the long term dam safety wang et al 2020 zhou et al 2022 this follow on investigation clarifies the sources and flow paths of the leakage and quantifies the amount and its variation of the leakage originated from each source a similar conclusion about the leakage sources was reported by zhou et al 2020 after comparing the chemistries of water samples before and after the impoundment after the reservoir impoundment the confined groundwater in the limestone aquifer p1y is recharged by two sources one is precipitation along the margins of the yongsheng basin and the other is the reservoir near the confluence of doushaxi stream fig 1c the former results in higher groundwater temperature whereas the latter makes the confined groundwater cooling down this is evidenced by much lower temperature at boreholes xzk02 hzk04 and hzk01 located closer to the reservoir table 4 and fig 2a there is no wonder of a relatively larger lag τ 2 d for the vertical leakage through the unplugged boreholes from the limestone aquifer as the borehole conductivity has been significantly reduced after years of infilling clogging or creep deformation if no unplugged boreholes are present the amount of leakage across the thin bedded aquitard p2βn itself is negligible and about half of the discharge from the plunge pool drainage system can be avoided fig 13 this statement can be confirmed by the extremely small discharge in the dam foundation adjacent to the plunge pool foundation fig 4 sensitivity analysis further shows that the flux exchange on the lateral boundaries of the unconfined basalt aquifer p2β is negligible and has little impact on the plunge pool leakage this is also consistent with the low and flat groundwater level in this unconfined aquifer in natural state compared to the annual average runoff of the jinsha river 4570 m3 s the amount of the plunge pool leakage 55 192 l s fig 4 is negligible furthermore there is no evidence of internal erosion induced by the vertical flow along the unplugged boreholes therefore the plunge pool leakage itself does not pose a threat to the safety of the dam however this leakage event implies that there is hydraulic connectivity between the unconfined basalt aquifer and the underlying confined limestone aquifer and hence a mixing between the unconfined and confined groundwater in the local plunge pool area this phenomenon deserves attention for future study on the mechanisms of how the contractive deformation of valley occurs and evolves at the dam site after the reservoir impoundment 6 conclusions in this study the leakage in the plunge pool area at the xhp site was dissected with an integrated approach the data of groundwater temperature chemical and stable isotope compositions piezometric head and discharge were collected from various locations and comprehensively analyzed with the clustering method and the cross correlation function it was found that the leakage mainly originates from three sources the confined limestone aquifer the reservoir and the downstream river the vertical leakage from the confined aquifer occurs across the thin bedded aquitard through the unplugged boreholes drilled during site investigation and the mixing of groundwater from different sources makes the seeped water having varied temperature and chemical compositions between the confined groundwater and surface water the amount of the vertical leakage decreases annually mainly induced by borehole clogging and soft rock deformation inverse modelling shows that the effective permeability of the boreholes decays exponentially with time which follows exactly the same pattern with the permeability of the near field basalt rocks upstream the impervious system this conductive behavior of the boreholes leads to a considerable delay of pressure pulse transfer from the confined aquifer with a lag of about 2 days the leakage from the reservoir and the downstream river is dynamically stable in magnitude during the operation which occurs through the basalt aquifer by bypassing the grout curtains constructed in the dam and the subsidiary dam foundations respectively the leakage from the reservoir has a lag of about 1 day while the leakage from the downstream river transfers faster with a lag less than 1 day due to much smaller depth of local grout curtain in the subsidiary dam foundation the amount of leakage from the above three sources accounts for on average 44 31 and 25 respectively during the past seven years of operation also demonstrated were the distributions of discharge from different sources in the plunge pool drainage system the potential impact of the leakage on the dam safety was discussed credit authorship contribution statement yi feng chen conceptualization supervision formal analysis resources funding acquisition writing original draft writing review editing sheng wang investigation methodology formal analysis validation writing original draft writing review editing wang ren investigation methodology validation zhibing yang methodology formal analysis validation ran hu formal analysis validation yan pian mao investigation methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the financial supports from the national natural science foundation of china grant nos 51925906 and 51988101 are gratefully acknowledged appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129135 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2186,the xiluodu arch dam is one of the highest dams in the world a noticeable leakage having a maximum rate of 192 l s and accounting for 46 75 of the total discharge at the site has been observed in the plunge pool area since impoundment for long term safety of the dam an integrated approach of groundwater temperature analysis hydrochemical data clustering cross correlation function and inverse modelling is presented to detect the sources and flow paths of the leakage it is found that the leakage is originated from three major sources i e the confined limestone aquifer underlain by the unconfined basalt aquifer the reservoir and the downstream river the vertical leakage from the limestone aquifer occurs through unplugged boreholes drilled during site investigation inverse modelling shows that induced by particle filling clogging and rock deformation the effective permeability of the unplugged boreholes follows the same exponential decay with the near field basalt rocks upstream the impervious system consequently the amount of the vertical leakage decreases annually which leads to an annual decrease of the discharge in the plunge pool area the leakage from the reservoir and the downstream river is dynamically stable in magnitude which occurs through the basalt aquifer by bypassing the grout curtains in the dam and subsidiary dam foundations respectively during the past seven years of operation the proportions of leakage from the above three sources account for on average 44 31 and 25 respectively keywords leakage detection hydrochemistry analysis cross correlation analysis inverse modelling permeability variation data availability data will be made available on request 1 introduction in the last three decades a considerable number of large scale dams with a height over 200 m have been built or are under construction worldwide for power generation flood control navigation and water resources utilization the construction of high dams underground powerhouse caverns and hydraulic tunnels significantly changes the groundwater flow at the sites by raising reservoir water levels and or presenting new discharge boundaries chen et al 2016 zheng et al 2021 the change in groundwater flow patterns may induce various geological hazards such as leakage liu et al 2021 water mud inrush li et al 2016 seepage erosion zhang et al 2022 ground subsidence tangdamrongsub et al 2019 valley contraction wang et al 2020 zhou et al 2022 landslide chen et al 2022a and even dam collapse chen and capart 2020 franci et al 2020 groundwater flow control is therefore indispensable in dam engineering to limit the amount of leakage reduce the pore pressure and increase the resistance to erosion by means of impervious barriers drains and filters zhou et al 2023 but due to the heterogeneity of geological media and the complexity of site conditions the events of leakage through dam foundations frequently occur even a seepage control system is elaborately designed and constructed chen et al 2016 2021 zhou et al 2015 the primary task for leakage treatment is to identify the origin of leakage and the path where it takes place zhou et al 2015 various techniques have been developed for this purpose and they can be broadly classified into four categories 1 geophysical survey 2 tracer test and groundwater chemical analysis 3 cross correlation analysis and 4 inverse modelling geophysical survey has been proven effective in detecting cavities and water content zones by using ground penetrating radar electrical resistivity tomography or self potential survey chalikakis et al 2011 afshar et al 2015 liu et al 2021 but due to its limitations in penetration depth and resolution this technique is less applicable to the foundation of a large scale dam during operation martínez moreno et al 2015 lee et al 2020 tracer test is a widely used tool to investigate the origin of leakage the interconnectivity of flow paths and the flow velocity in boreholes bolève et al 2011 environmental isotopes e g δ18o δd and δ13c groundwater temperature and hydrochemical components are frequently used as natural tracers chiogna et al 2014 yin et al 2021 the cross correlation function ccf is often used to analyse the relationships between two time series of the quantities such as reservoir water level discharge and groundwater level in boreholes bailly comte et al 2011 fu et al 2016 schuler et al 2020 the peak and the lag value of the cross correlation provide useful information about the time interval of pressure pulse transfer in the aquifers hence indicating the hydraulic interconnectivity from one location to another zhou et al 2021 luo et al 2022 chen et al 2022b inverse modelling is another tool that has been widely used to determine the permeability of aquifers on the site scale and infer the aquifer where the leakage path is located schilling et al 2019 this technique relies on an optimization procedure to minimize the objective function constructed with field observation data and the continuum approach is commonly applied for its computational efficiency to solve the site scale problems even for groundwater flow in fractured aquifers jiang et al 2017 zhou et al 2023 the above techniques are often combined for a more reliable detection of leakage through dam foundations chen et al 2016 yin et al 2021 located on the lower reach of jinsha river southwest china the xiluodu arch dam has a height of 285 5 m dominating as the fourth highest dam of the same type in the world since reservoir impoundment leakage has been observed in the plunge pool area with a maximum flow rate up to 192 l s chen et al 2021 the leakage rate accounts for 45 9 74 8 of the total discharge at the site including dam foundation underground caverns and plunge pool and is remarkably larger than those of other high arch dams therefore there is a need to understand how this leakage occurs and how it may influence the long term safety of the dam this study presents an integrated technique of groundwater temperature analysis hydrochemical analysis cross correlation analysis and inverse modelling for leakage detection in the plunge pool area at the xiluodu dam combined with site characterization and field monitoring data the former three approaches are applied to identify the origins and flow paths of the leakage inverse modelling and numerical simulation are then performed to investigate the permeability variation of the aquifers where the flow paths are located and the proportions of the leakage that are originated from different sources the potential influence of the leakage on the dam safety is discussed 2 site characterization 2 1 project description located on the lower reach of jinsha river between leibo sichuan and yongshan yunnan the xiluodu hydropower plant xhp is one of the largest hydropower plants in the world fig 1 the xhp mainly consists of a concrete double curvature arch dam with a height of 285 5 m and a crest length of 681 5 m two underground powerhouse cavern systems and four spillway tunnels located almost symmetrically in both banks fig 2 the xhp has a total installed capacity of 13 8 gw and the reservoir has a total capacity of 1 28 1010 m3 at the normal pool level of 600 m a s l the dam is endowed with 7 surface spillways and 8 deep orifices together with 4 spillway tunnels for flood control and a subsidiary dam downstream the arch dam to form a plunge pool for energy dissipation fig 3 the construction of the dam was completed in march 2014 and the reservoir filling started in september 2012 2 2 geological settings the dam site is located in a typical u shaped valley roughly at the center of the yongsheng synclinal basin where the jinsha river turns 90 from northeast to southeast fig 1b and c the yongsheng basin having a diameter of about 30 5 km and an area of 730 km2 is an independent hydrogeological unit hu the formations from bottom to top consist of clastic sedimentary rocks of the silurian system s limestone of the lower permian yangxin group p1y basalt of the upper permian emeishan group p2β clastic sedimentary rocks of the upper permian xuanwei group p2x clastic and carbonate sedimentary rocks of the triassic system t and quaternary loose deposits q as shown in fig 1d and 2b between the limestone p1y and basalt p2β formations there deposits a thin clay shale layer p2βn with a thickness of 3 5 m the rock layers s p2x and p2βn are of low permeability hence making aquifers p1y p2β t and q and aquitards s p2x and p2βn alternately distributed in the basin consequently the limestone aquifer p1y is confined which is recharged by precipitation and melt snow on the margins of the basin where the aquifer outcrops and eventually discharged to the jinsha river the xiluodu dam is situated on the basalt aquifer p2β which consists of a sequence of lava flow layers typically with a tuff layer c1 c12 on the top of each layer fig 2b this aquifer is unconfined and has a low groundwater level owing to the overlying aquitard p2x that impedes the vertical infiltration into it thousands of packer tests together with other hydraulic tests and inverse calibrations were performed to evaluate the permeability of the aquifer and aquitard systems chen et al 2018 particularly at the dam site fig 2b the permeability of the basalt formations p2β was found to follow a power law decrease with depth and can be correlated with the degree of weathering by dividing the formations into a heavily weathered zone hwz an upper moderately weathered zone umwz a lower moderately weathered zone lmwz a slightly weathered zone swz and a fresh bedrock zone fbz according to its permeability the limestone formation p1y can be divided into an upper zone and a lower zone chen et al 2021 the upper zone about 80 m in thickness is karstified and has a permeability about one order of magnitude higher than that of the lower zone the hydraulic properties of the rock formations at the dam site are listed in table 1 2 3 groundwater observation and leakage in the plunge pool area to properly control the groundwater flow in the dam and underground powerhouse areas grout curtains were constructed from 6 levels of grouting tunnels fig 2a and fig s1 in supplementary material the curtains cover an area of 8 7 105 m2 and extend downwards to a lowest elevation of about 180 m a s l chen et al 2021 a total number of 7980 drainage holes were drilled from 5 levels of drainage tunnels downstream the grout curtains in the plunge pool area there is a small grout curtain in the foundation of the subsidiary dam together with a drainage system consisting of 4 longitudinal galleries along the river 6 transverse galleries perpendicular to the river and drainage hole arrays fig 3 the seeped water in this area flows into a pump house through a diversion tunnel a monitoring system consisting of 123 peizometers and 52 weirs were installed to assess the groundwater flow behaviour at the dam site fig s2 in supplementary material chen et al 2021 the pore pressure and flow rate data have been continuously recorded since the end of 2014 the data shows that there is a remarkable amount of leakage in the plunge pool area attaining 192 l s at its maximum and accounting for 45 9 74 8 of the total discharge at the dam site as shown in fig 4 this leakage rate is much larger than those of other high arch dams e g no more than 60 l s for ertan arch dam 240 m high gao et al 2021 and 30 l s for goupitan arch dam 232 5 m high hu et al 2020 furthermore the leakage fluctuates violently in each operation cycle and displays a clear trend of decrease from year to year during site characterization a number of 28 boreholes were drilled but not plugged in the plunge pool area fig 3 these boreholes were penetrated into the confined aquifer p1y across the aquitard p2βn and may provide channels for the confined groundwater to move up to the drainage system to further understand the groundwater flow behavior at the dam site a total of 17 observation boreholes were drilled since december 15 2018 to collect the groundwater level temperature and hydrochemical data in the unconfined p2β aquifer xzk01 and xzk04 xzk10 and in the confined p1y aquifer xzk02 xzk03 and hzk01 hzk07 as shown in fig 2 3 materials and methods 3 1 hydrochemical analysis a total of 31 water samples were collected in december 2018 and january 2021 respectively from the reservoir the downstream river channel the drainage holes in the plunge pool area and the observation boreholes as listed in table 2 the chemical and stable isotope compositions of the water samples were analyzed to identify the sources of the leakage as shown in table 3 the stable isotopes were analyzed with an lgr water isotope analyzer device and the results were reported as δ18o and δd values representing per mil deviations from the vsmom vienna standard mean ocean water standard zhou et al 2020 the ph values were measured in situ by an hi9124 instrument with a precision of 0 01 which also recorded the temperature of the samples the primary metal ions e g na k ca2 and mg2 were analyzed by an inductively coupled plasma optical emission spectrometry icp oes anions were measured by an lc 10a instrument for cl and so 4 2 and by hydrochloric acid titration for hco 3 and co 3 2 ionic balance analysis was performed for all samples with an error smaller than 10 ward s hierarchical clustering method was used to group the water samples by minimizing the total within cluster variance yang et al 2020 zhong et al 2022 given that the tds total dissolved solids data is unavailable for some water samples the ph value and the concentrations of six chemical components ca2 mg2 na k cl so 4 2 and hco 3 co 3 2 are selected as the variables for clustering the variables are first nondimensionalized by 1 z ij x ij x j σ j where xij is the jth data of sample i zij is the nondimensionalized value of xij and x j and σj are the mean and standard deviation of the jth data over all samples initially ward s method treats each water sample as an individual cluster then the pair of clusters with minimum distance is grouped to form a new cluster this procedure iterates until all samples are agglomerated in a whole cluster the ward s distance dpk between clusters p and k is defined as 2 d pk n p n k n p n k d pk where np and nk are the number of samples in clusters p and k respectively and dpk is the distance between the cluster centers which can be evaluated with euclidean distances 3 d pk j 1 m 1 n p i 1 n p z pij 1 n k i 1 n k z kij 2 where zpij and zkij are the jth nondimensionalized data of sample i in clusters p and k respectively and m is the number of variables in each water sample m 7 in this study in this study the software r version 3 5 1 was used for the clustering analysis 3 2 cross correlation analysis since may 2014 the reservoir water level fluctuates annually fig 4 therefore the time series data of reservoir water level discharge and borehole water level can be first decomposed into the following three major components 4 y t y tr t y pr t y ir t ε t where y t is the target time series to be fitted y tr t y pr t and y ir t denote the non periodic trend periodic and potentially irregular components of y t respectively and εt is an error term that follows a normal distribution the prophet model was applied to detrend the time series for its high accuracy and strong robustness in disposing of complex time series features such as strong seasonality trend changes and outliers taylor and letham 2018 aguilera et al 2019 papacharalampous and tyralis 2020 the machine learning algorithm i e the penalized maximum likelihood estimation with optimization embedded in prophet was used to improve the fitting precision taylor and letham 2018 the non periodic trend component y tr t is modelled by logistic growth function and the periodic component y pr t is fitted by fourier series the cross correlation between a pair of time series is then evaluated over the decomposed periodic components which helps identify the hydraulic connectivity and groundwater flow paths from the reservoir for any two periodic time series x and y the cross correlation rxy τ at lag τ is defined as 5 r xy τ c xy τ σ x σ y 6 c xy τ 1 n t 1 n τ x t x y t τ y where cxy τ is the cross covariance at lag τ σx and σy are the standard deviations of series x and y respectively x and y are the means of x and y and n is the number of time series data 3 3 numerical simulation and inverse modelling it is widely accepted in dam engineering that the continuum approach can be satisfactorily applied to model the groundwater flow through fractured foundation rocks with sufficient accuracy since the construction of impervious barriers significantly weaken the role of individual faults and fractures chen et al 2016 2021 2022b a 3d finite element model with a dimension of 4000 3550 1000 m was created for flow simulation and inverse modeling at the dam site the model well represents the geological settings hydraulic structures and the seepage control systems containing 10 8 million brick elements with some of them degenerated to tetrahedral elements and 3 6 million nodes as shown in fig 5 a and fig s1 in supplementary material particularly a substructure technique was used to accurately represent the geometries and boundary conditions of 7980 drainage holes at the site chen et al 2008 the preferential flow along the 28 unplugged boreholes in the plunge pool area was assumed to follow hagen poiseuille s law and 1d pipe elements of hydraulic conductivity k b were adopted to simulate these boreholes the transient groundwater flow through the dam foundation follows the following continuity equation chen et al 2011 7 1 h s s ϕ t 1 h k ϕ where ϕ p ρ w g z is the total water head p is the pore water pressure ρ w is the density of water g is the gravitational acceleration k is the hydraulic conductivity tensor s s is the specific storage h is a heaviside function defined as h 0 if ϕ z in wet domain and h 1 if ϕ z in dry domain and t is time the governing equation eq 7 is formulated in a domain consisting of a wet domain below phreatic surface and a dry domain above it by means of heaviside function this enables eq 7 to be rigorously and effectively solved with the discretized parabolic variational inequality pvi method by formulating the seepage boundary condition as the unilateral condition of signorini s type and transforming the phreatic surface as an inner boundary inside the domain chen et al 2011 the flow simulation lasted for 85 months from may 2014 to may 2021 with a time step of 3 days the initial condition of eq 7 i e the initial distribution of water head in the domain was given by a steady state simulation calibrated with observations of groundwater level table s1 in supplementary material the boundary conditions were specified as follows 1 the time variant reservoir water level and the corresponding downstream river stage were prescribed as water head boundary conditions 2 the base of the model was taken as no flow boundary 3 to approximate the lateral flux exchange the lateral boundaries were prescribed with water head calibrated by a basin scale flow simulation zhou et al 2023 as shown in fig 5b and fig s3 in supplementary material and 4 the walls of drains and the surfaces of drainage tunnels were taken as the potential seepage boundary except the lowest level of drains which may satisfy the water head boundary condition the finite element code thyme3d that has been developed for decade chen et al 2011 2016 2021 li et al 2014 zhou et al 2015 is adopted for numerical simulation it has been clarified that during reservoir operation the permeability of fractured rocks upstream the grout curtains is significantly influenced by suspended sediment deposition and fracture clogging chen et al 2021 furthermore the unplugged boreholes in the plunge pool area were filled with gravels sands and fine particles after being drilled and during construction the permeability of the unplugged boreholes may be further influenced by particle movement from the limestone aquifer p1y and the deformation of the thin clay shale layer p2βn inverse modelling was therefore performed to more representatively obtain the permeability of the fractured rocks and the unplugged boreholes by optimizing the following objective function 8 min f p i 1 m ϕ i p ϕ i 2 2 ϕ i 2 2 1 2 w j 1 n q j p q j 2 2 q j 2 2 1 2 where f is the weighted objective function p is the vector of hydraulic parameters to be back calculated m and n are the number of piezometers and weirs respectively ϕ i and ϕ i are the time series of simulated and measured piezometric head at piezometer i respectively q j and q j are the time series of simulated and measured discharge at weir j respectively and w is a weight coefficient in this study seven parameters were selected for inverse modelling i e p k i ν i k ii ν ii k iii ν iii k b here k i k ii and k iii denote the in plane hydraulic conductivity in the lmwz i swz ii and fbz iii zones upstream the grout curtains fig 3 respectively ν i ν ii and ν iii denote the anisotropic ratio of the hydraulic conductivity perpendicular to the bedding planes to the in plane component in the corresponding zones and k b represents the equivalent hydraulic conductivity of the unplugged boreholes the time series data at 21 peizometers and 11 weirs were selected for weighted objective function fig s2 and table s2 in supplementary material the weight coefficient takes w 0 06 such that the magnitude of the two terms on the right hand side of eq 8 is balanced the inverse modelling was performed for each annual cycle of the reservoir water level the procedure combining orthogonal design transient flow analysis artificial neural network and genetic algorithm was adopted for its high efficiency chen et al 2016 2020 2021 zhou et al 2015 as shown in fig s4 in supplementary material 4 results 4 1 result of groundwater temperature analysis as a natural tracer the groundwater temperature was first analyzed and compared to the temperature of surface water i e the reservoir water and the downstream river water table 2 shows that the groundwater seeped out of the drainage system in the plunge pool area can be classified into two types warm groundwater above 25 c and cold groundwater below 25 c the warm groundwater was all sampled from the drainage holes in the lowest level galleries at 335 m a s l and the temperature ranged in 26 4 38 5 c with a mean of 31 1 c the cold groundwater was observed at various locations including drainage holes and gallery walls in the plunge pool drainage system from 335 m a s l to 355 m a s l the temperature of cold groundwater was in the range of 20 8 24 4 c with a mean of 22 3 c which is rather close to the range 18 9 23 2 c and mean 20 7 c of the temperature of surface water samples fig 6 plots the temperature curves measured by five typical piezometers installed in the plunge pool foundation 335 m a s l and the bank slopes 386 m a s l the curves show that the temperature of groundwater in the bank slopes varies around 20 c which is comparable to the temperature of reservoir water and downstream river water the groundwater temperature in the plunge pool foundation however is constantly higher than 25 c with a maximum of 33 c table 4 lists the mean groundwater temperature measured at the observation boreholes between 2019 and 2021 which well represents the borehole groundwater temperature that varies in a rather narrow range the data shows that the mean temperature of the confined groundwater limestone aquifer ranging in 24 2 39 0 c is on average 6 c higher than that of the unconfined groundwater basalt aquifer ranging in 22 6 30 2 c and is significantly higher than the temperature of surface water below 20 c fig 6 it can be inferred from the above analysis that at the dam site the temperature of the confined groundwater is higher than that of the unconfined groundwater which is in turn slightly higher than the temperature of surface water the groundwater temperature in the plunge pool area lies in between the temperature of the confined groundwater and that of surface water implying that the leakage has different sources of supply and the temperature is a result of the mixing of different sources of water 4 2 result of hydrochemical analysis table 3 shows that the tds concentration of the warm groundwater samples taken from the lowest level galleries 194 268 mg l is remarkably smaller than that of other water samples 264 382 mg l implying a potential different origin of the warm groundwater fig 7 a shows a piper diagram of the water samples which classifies the water samples into hco3 cl and hco3 so4 hydrochemical facies the former were sampled from surface water including reservoir water downstream river water and plunge pool surface water and cold groundwater in the plunge pool foundation and are characteristic of relatively higher contents of cl and so4 ions cl content so 4 2 content the latter consist of warm groundwater samples taken from the drainage holes in the plunge pool foundation and the observation boreholes in the limestone aquifer characterized by much lower content of cl ion than the former facies cl content so 4 2 content fig 7b shows the dendrogram constructed by ward s minimum variance method which clusters the water samples into four groups with a ward s distance of 6 group 1 contains water samples taken from the reservoir and the downstream river group 2 contains the reservoir water samples the downstream river water samples and the cold groundwater samples taken from the plunge pool drainage galleries 335 355 m a s l this implies that the reservoir and the downstream river are the sources of supply for the cold groundwater in the plunge pool foundation group 3 contains warm groundwater samples from the observation boreholes in the limestone aquifer and the drainage holes at 335 m a s l indicating that the warm groundwater in the plunge pool foundation is originated from the confined limestone aquifer besides warm groundwater samples e g hzk04 cold groundwater samples w09 and w10 are also contained in group 4 this is because the samples w09 and w10 were taken in december 2018 when the increasing flood discharge fig 4 sped up the mixing between the warm and cold groundwater of different origins if using a ward s distance of 8 then all the water samples can be clustered into two groups one contains surface water samples and cold groundwater samples originated from surface water and the other contains warm groundwater samples originated from the confined limestone aquifer the stable isotopic compositions of δ18o and δd were collected from part of the water samples as shown in table 5 and fig 8 it should be noted that the δd value of the borehole groundwater samples is influenced by high mud content and is hence scattered widely the warm groundwater samples from the plunge pool drains and the observation boreholes can be clustered as one group for their higher values of δ18o and δd whereas the cold groundwater samples from the plunge pool drains possess almost the same lower δ18o and δd values with the surface water samples from the reservoir and the downstream river interestingly the groundwater samples w03 and w04 collected from the side walls of the drainage galleries tables 2 and 5 have middle isotopic compositions between the above two groups evidencing the occurrence of vertical leakage from the confined limestone aquifer to the plunge pool foundation fig 8 further shows that the stable isotope data of the warm and cold groundwater samples from the plunge pool drains are closely around the local meteoric water line lmwl δd 7 44δ18o 6 36 r2 0 88 and the global meteoric water line gmwl δd 8δ18o 10 r2 0 91 respectively this implies that the warm groundwater is recharged by precipitation along the margins of the yongsheng basin where stronger evaporation occurs 4 3 result of cross correlation analysis the ccfs between the periodic components of the plunge pool discharge and the reservoir water level the downstream river stage and the groundwater level at two observation boreholes hzk03 and hzk07 were calculated as shown in fig 9 it shows that the leakage is highly correlated to the downstream river stage r 0 87 with a quick hydraulic response τ less than 1 d this is not surprising because the grout curtain in the subsidiary dam foundation has a limited depth of 67 m and hence the river water can bypass this local grout curtain and infiltrate into the plunge pool drainage system through the basalt formation the grout curtain of the arch dam foundation however has a maximum depth of 152 m which results in longer flow path from the reservoir τ 1 d and lower cross correlation of the leakage with the reservoir water r 0 74 furthermore there is also a high cross correlation between the plunge pool leakage and the confined groundwater in the limestone aquifer as evidenced by r 0 85 and τ 2 d for the groundwater level observations at borehole xzk03 the above cross correlation analysis indicates again that the plunge pool leakage is originated from multiple sources including the reservoir the downstream river and the confined limestone aquifer 4 4 result of inverse modelling it can be inferred from sections 4 1 4 3 that the confined limestone aquifer p1y underlain by the unconfined basalt aquifer p2β is one of the major source for the leakage into the plunge pool drainage system however there is a thin bedded aquitard p2βn between p1y and p2β fig 1d and 2b then how the vertical leakage occurs across this aquitard the answer is the 28 unplugged exploratory boreholes drilled during site characterization fig 3 which penetrated into the limestone aquifer and ever caused vertical leakage during the excavation of the plunge pool foundation to further understand the flow behavior through the unplugged boreholes inverse modelling was performed by using the model shown in fig 5 our previous inverse modelling has shown that the permeability of the near field basalt rocks upstream the grout curtains follows an exponential decay with time as a result of sediment deposition and fracture clogging chen et al 2021 9 k k 0 e α t β 1 β where k is the component of hydraulic conductivity parallel to bedding planes k 0 is the inversed value of k in the first operation cycle may 2014 may 2015 α and β are fitting coefficients and t is time in year interestingly the inverse modelling in this study confirms that eq 9 also applies to the equivalent hydraulic conductivity k b of the unplugged boreholes modelled by pipe elements fig 10 a shows that the mean annual discharge q in l s from the plunge pool drainage system decreases annually and can be well correlated to the inversed hydraulic conductivity k b in cm s of the pipe elements with a power law function q 28 k b 0 35 46 r2 0 98 by virtue of eq 9 it is found that the hydraulic conductivity of the pipe elements and the near field basalt rocks varies in a unified pattern with a high coefficient of determination r2 0 988 with α 0 536 and β 0 008 as shown in fig 10b the inversed initial values of hydraulic conductivity in the first operation cycle are listed in table 6 by hagen poiseuille s law the estimated initial value of k b 50 cm s in the first operation cycle implies an effective diameter of 1 3 mm for the unplugged boreholes this result is reasonable because after the exploratory boreholes were abandoned and during construction of the dam they had been filled with gravels sands and rock fragments the permeability decay of the unplugged boreholes afterwards is attributed to clogging and rock deformation mud inrush was often observed as the observation boreholes were drilled into the limestone aquifer fig s5 in supplementary material indicating that muds and fine grained sediments are abundant in the karstified upper zone of the limestone formation after the reservoir impoundment there is a significant increase of pressure difference between the limestone and basalt aquifers the induced vertical flow from the limestone to the basalt aquifers continuously transports and deposits mud particles and fine grained sediments in the unplugged boreholes furthermore the clay shale p2βn is a soft rock with its mechanical properties much weaker than those of the limestone and basalt formations table s3 in supplementary material the creep deformation of the clay shale surrounding the unplugged boreholes may be another important factor that induces a decrease in the effective diameter of the boreholes and hence the decay of the borehole conductivity figs 4 and 11 show comparisons between the simulated and measured curves of discharge in different areas and groundwater level at the observation boreholes respectively tables 7 and 8 list the mean absolute error mae root mean square error rmse and mean absolute percent error mape between the simulated and measured time series data of discharge and borehole groundwater level respectively fig 12 further compares the simulated and measured mean piezometric heads at 19 piezometers in the dam foundation 18 piezometers around the underground powerhouse cavern systems and 6 piezometers in the plunge pool foundation see fig s2 and table s4 in supplementary material for their locations the results show that the groundwater flow behaviors at the dam site are satisfactorily simulated with engineering accuracy the mae rmse and mape values for discharge in different areas are 0 64 10 40 l s 0 85 14 28 l s and 9 08 27 59 respectively table 7 and fig 4 the simulated discharge in the plunge pool area has the highest mae and rmse but the lowest mape caused by the fact that the discharge is periodically influenced by flood discharging and the subsequent overhauls on the contrary the magnitude of discharge in the dam foundation is quite small hence having the highest mape but the lowest mae and rmse fig 11 shows that the groundwater level at all the observation boreholes in the confined limestone aquifer is well correlated with the reservoir water level this is because the aquifer crops out at the confluence of doushaxi stream about 2 km upstream the dam fig 1c which facilitates the pressure pulse transfer from the reservoir to the dam site along the karstified upper zone of the aquifer except the borehole xzk08 fig 2a located upstream the impervious system the groundwater level at the observation boreholes in the unconfined basalt aquifer keeps rather stable as a result of the drainage system and is less correlated to the reservoir water level the values of mae rmse and mape for the simulated groundwater level or piezometric head are in the ranges of 2 28 14 87 m 3 28 17 25 m and 0 85 2 94 respectively table 8 and fig 12 this simulation result is reasonable given the complexity of the site conditions 4 5 sources and flow paths for the plunge pool leakage the numerical tool that has been calibrated and validated in section 4 4 is further applied to identify the sources and flow paths for the leakage into the plunge pool drainage system by treating the aquitard p2βn as an impervious media and removing the pipe elements the amount of vertical leakage from the confined limestone aquifer p1y across the aquitard and through the unplugged exploratory boreholes can be calculated on this basis by changing the water head boundary condition on the downstream river channel to the seepage boundary condition the amount of supply from the downstream river is then separated from the remaining part that is mainly originated from the reservoir through the unconfined basalt aquifer p1β fig 13 shows the amount of discharge in the plunge pool area originated from the limestone aquifer the downstream river and the reservoir respectively in the first operation year may 2014 may 2015 the vertical leakage from the limestone aquifer accounts for 56 of the total discharge this amount of leakage then decreases annually to 33 in the last operation cycle may 2020 may 2021 due to the decay of the effective permeability of the unplugged boreholes the amount of supply from the downstream river keeps rather stable from year to year varying between 22 and 28 the amount of leakage originated from the reservoir is also dynamically stable in magnitude but its proportion increases annually from 22 to 42 due to the annual decrease in the magnitude of the total discharge the decay of hydraulic conductivity in the near field basalt rocks upstream the grout curtains has negligible impact on the discharge in the plunge pool area as shown by the difference between curves 1 and 2 in fig 13 where curve 2 is calculated with the initial value of k calibrated in the first operation cycle during the seven years of operation the proportions of leakage from the above three sources are on average 44 25 and 31 respectively fig 14 shows the distribution of the calculated discharge in the plunge pool drainage system on may 31 2021 it shows that the discharge from the lower level galleries 335 m a s l is much larger than that from the higher level galleries 355 m a s l and the discharge from the right bank galleries is higher than that from the left bank galleries fig 14a the vertical leakage originated from the confined limestone aquifer mainly occurs through the drainage holes where an unplugged exploratory borehole is located nearby fig 14b typically with the leakage rate from a single drainage hole much larger than 0 5 l s the above phenomena are all consistent with the field observations the leakage from the downstream river mostly occurs on the downstream side of the drainage system more on the left bank fig 14c while the leakage from the reservoir mainly occurs on the upstream side more on the right bank fig 14d 5 discussion in this study an integrated technique of groundwater temperature analysis hydrochemical analysis cross correlation analysis and inverse modelling was applied for leakage detection in the plunge pool area at the xhp site this is done on the basis that the basin scale hydrogeological conditions and the site scale groundwater flow behaviors have been properly understood chen et al 2021 zhou et al 2022 our recent study has clarified that the annually decreased discharge in the dam foundation and the underground cavern areas is induced by suspended particle deposition and fracture clogging in the near field basalt formations upstream the impervious system chen et al 2021 it remains unsolved however why the leakage in the plunge pool area accounts for over half of the total discharge at the site and how this leakage occurs and evolves this phenomenon is closely related to the specific hydrogeological structure of alternate aquifers and aquitards in the basin which induces valley contraction at the dam site and poses a potential threat to the long term dam safety wang et al 2020 zhou et al 2022 this follow on investigation clarifies the sources and flow paths of the leakage and quantifies the amount and its variation of the leakage originated from each source a similar conclusion about the leakage sources was reported by zhou et al 2020 after comparing the chemistries of water samples before and after the impoundment after the reservoir impoundment the confined groundwater in the limestone aquifer p1y is recharged by two sources one is precipitation along the margins of the yongsheng basin and the other is the reservoir near the confluence of doushaxi stream fig 1c the former results in higher groundwater temperature whereas the latter makes the confined groundwater cooling down this is evidenced by much lower temperature at boreholes xzk02 hzk04 and hzk01 located closer to the reservoir table 4 and fig 2a there is no wonder of a relatively larger lag τ 2 d for the vertical leakage through the unplugged boreholes from the limestone aquifer as the borehole conductivity has been significantly reduced after years of infilling clogging or creep deformation if no unplugged boreholes are present the amount of leakage across the thin bedded aquitard p2βn itself is negligible and about half of the discharge from the plunge pool drainage system can be avoided fig 13 this statement can be confirmed by the extremely small discharge in the dam foundation adjacent to the plunge pool foundation fig 4 sensitivity analysis further shows that the flux exchange on the lateral boundaries of the unconfined basalt aquifer p2β is negligible and has little impact on the plunge pool leakage this is also consistent with the low and flat groundwater level in this unconfined aquifer in natural state compared to the annual average runoff of the jinsha river 4570 m3 s the amount of the plunge pool leakage 55 192 l s fig 4 is negligible furthermore there is no evidence of internal erosion induced by the vertical flow along the unplugged boreholes therefore the plunge pool leakage itself does not pose a threat to the safety of the dam however this leakage event implies that there is hydraulic connectivity between the unconfined basalt aquifer and the underlying confined limestone aquifer and hence a mixing between the unconfined and confined groundwater in the local plunge pool area this phenomenon deserves attention for future study on the mechanisms of how the contractive deformation of valley occurs and evolves at the dam site after the reservoir impoundment 6 conclusions in this study the leakage in the plunge pool area at the xhp site was dissected with an integrated approach the data of groundwater temperature chemical and stable isotope compositions piezometric head and discharge were collected from various locations and comprehensively analyzed with the clustering method and the cross correlation function it was found that the leakage mainly originates from three sources the confined limestone aquifer the reservoir and the downstream river the vertical leakage from the confined aquifer occurs across the thin bedded aquitard through the unplugged boreholes drilled during site investigation and the mixing of groundwater from different sources makes the seeped water having varied temperature and chemical compositions between the confined groundwater and surface water the amount of the vertical leakage decreases annually mainly induced by borehole clogging and soft rock deformation inverse modelling shows that the effective permeability of the boreholes decays exponentially with time which follows exactly the same pattern with the permeability of the near field basalt rocks upstream the impervious system this conductive behavior of the boreholes leads to a considerable delay of pressure pulse transfer from the confined aquifer with a lag of about 2 days the leakage from the reservoir and the downstream river is dynamically stable in magnitude during the operation which occurs through the basalt aquifer by bypassing the grout curtains constructed in the dam and the subsidiary dam foundations respectively the leakage from the reservoir has a lag of about 1 day while the leakage from the downstream river transfers faster with a lag less than 1 day due to much smaller depth of local grout curtain in the subsidiary dam foundation the amount of leakage from the above three sources accounts for on average 44 31 and 25 respectively during the past seven years of operation also demonstrated were the distributions of discharge from different sources in the plunge pool drainage system the potential impact of the leakage on the dam safety was discussed credit authorship contribution statement yi feng chen conceptualization supervision formal analysis resources funding acquisition writing original draft writing review editing sheng wang investigation methodology formal analysis validation writing original draft writing review editing wang ren investigation methodology validation zhibing yang methodology formal analysis validation ran hu formal analysis validation yan pian mao investigation methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the financial supports from the national natural science foundation of china grant nos 51925906 and 51988101 are gratefully acknowledged appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2023 129135 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2187,this study based on the stable isotope tracer technique δ18o and δ2h focuses on the recharge sources of plant water in the three rivers headwaters region in qinghai province china the oxygen and hydrogen isotope signatures of trees and shrubs were more depleted than those of herbs however the d excess pattern was the opposite of the patterns of stable isotopes of oxygen and hydrogen from the distribution of stable isotope characteristics of water bodies the direct source of plant water was determined to be soil water whereas the indirect sources were river water supra permafrost water soil water precipitation and ground ice the contribution proportions of soil water layers between 0 cm and 20 cm and between 40 cm and 60 cm to the plant water were higher than those of other soil water layers for trees more importantly the plant water of shrubs was similar to trees in the cold region the analysis of the indirect recharge sources of plant water revealed that soil water was still the major source of plant water while glacier snow meltwater precipitation and ground ice meltwater are also the main supply sources of plant water the proportion of supra permafrost water to plant water was relatively high mainly because herbs grow in the active layer in the cold region therefore the proportion of plant water recharged by supra permafrost water and ground ice meltwater was higher than that of other water bodies during the plant growing season keywords recharge source recharge mechanism plant water cold region three rivers headwaters region data availability data will be made available on request 1 introduction important changes in ecosystem degradation and soil hydrology are related to freeze thaw cycles and frozen soil degradation such changes considerably impact the characteristics of ecosystem structure composition function and spatial distribution pattern of plants in the source area of three rivers in the qinghai tibet plateau cuneo et al 2018 mills et al 2018 dai et al 2020 luo et al 2020 supply of supra permafrost water has declined considerably therefore low level swamp wetlands with a strong dependence on the supply of shallow groundwater have shrunk substantially as a result mountainous swamp meadows in most sections of cold regions have been replaced by mountainous meadows and mountainous grasslands the vegetation coverage and root system will change which will weaken the regulation of vegetation on soil water content and reduce soil conservation and storage capacity of surface water causing serious water loss resulting in the reduction of water storage and biomass and the loss of soil organic carbon all these changes may finally lead to surface desertification qiu et al 2019 therefore it is crucial to elucidate the hydrological processes of frozen soil in the context of climate warming and the accelerated melting of the cryosphere in particular the quantitative analyses of plant water sources of different vegetation types and the adaptive mechanism of plant water sources to frozen soil degradation are helpful in comprehensively understanding the water cycle and eco hydrological processes in cold areas piao et al 2019 the research results would provide scientific and technological support for ecological restoration and environmental reconstruction in cold regions plant water is an important component of the water cycle in the context of global warming accelerated melting of frozen soil has affected the usual water cycle which has altered the ecological environment in cold regions mills et al 2018 barbeta et al 2019 tiemuerbieke et al 2018 thus the continuous degradation of permafrost areas has a critical impact on the plant water sources pws in cold areas to date insufficient attention to the plant water sources pws in permafrost areas has led to an imprecise understanding of the response of plant water sources to permafrost degradation in cold regions beyer et al 2018 václav et al 2019 benettin et al 2021 jia et al 2022 nehemy et al 2019 2021 2022 more importantly quantitative analyses of plant water sources can form an important basis for a comprehensive understanding of the water cycle and ecohydrology processes in cold regions yao et al 2014 wu et al 2019 due to climate warming changes in the ecosystem and surface water and heat processes caused by frozen soil degradation have affected plant ecological processes in cold regions yin et al 2021 however owing to the lack of systematic research on a regional scale the response mechanism of plant water sources to frozen soil degradation remains insufficient the study on the plant water sources pws by using stable oxygen and hydrogen isotope technology is helpful to clearly understand and master the mechanism of hydrological cycle in this area and is of great significance to protect the unique ecological environment in the source area of the three rivers the quantitative analysis of the plant water sources pws of different vegetation types in the source area of the three rivers and the in depth discussion of the plant water sources pws of different plants in the same habitat and the changes in the water sources selected by the same plant in different growth stages which will help to comprehensively understand the water cycle process and the ecological hydrological process of the plants in the cold region meanwhile it will provide the basis for the ecological restoration and environmental construction in the cold region the research on plant water source and water use mode is conducive to formulating a reasonable ecological water allocation scheme to ensure that ecological water can be effectively used by plants moreover the three rivers headwaters region is an important ecological barrier and water conservation area in china crucial for global biodiversity protection liu et al 2022 it is a sensitive area in the context of climate change in asia the northern hemisphere and the world li et al 2021 furthermore the degradation of permafrost is mainly manifested by the change of the active layer the change in the frozen soil active layer not only changes the soil water holding capacity but also directly affects the growth environment of vegetation in cold regions meanwhile permafrost degradation reduces the hydraulic conductivity of soil leading to the reduction of glacier snow meltwater or precipitation infiltration and changes the processes and characteristics of runoff production and conflux in cold regions liu et al 2021 unger et al 2022 however under continuous warming the plant water source pws has undergone significant changes in cold regions in cold regions permafrost degradation has a strong impact on plant water sources pws therefore this study focused on the three rivers headwaters region and it aimed to 1 analyze the variation characteristics of stable isotope signatures of plant water and other water bodies in the source area of the yangtze river 2 explore the recharge sources of plant water indicated by stable isotope signatures of plant water and potential water sources and 3 quantify the recharge source and proportion of plant water in the source area of the yangtze river these findings may provide scientific guidance for ecological protection and vegetation restoration in cold regions and provide a better decision making basis for coping with climate change water resource management and environmental protection in cold regions 2 materials and methods 2 1 study area the source area of the three rivers located in the south of qinghai province 31 39 36 12 n 89 45 102 23 e fig 1 with a total area of 36 3 104 km2 the sanjiangyuan national park accounts for 31 16 of the area including three parks the respective sources of the yangtze river yellow river and lancang river the landforms of the source areas of the three rivers are mainly complex mountain landforms and the terrain gradually rises from southeast to northwest with an average altitude of more than 4 000 m the three rivers headwaters region is a typical permafrost area permafrost coverage 107 619 13 km2 accounts for 77 of the total area yao et al 2014 seasonal permafrost is mainly distributed in river valleys with an area of 30 754 34 km2 zhou et al 2015 the source area has a typical plateau continental climate with alternating cold and hot seasons and distinct dry and wet seasons the annual average temperature is between 5 6 to 4 9 c and the annual total precipitation is 391 7 764 mm the temperature and precipitation in the source area gradually decreased from southeast to northwest due to the interception of the warm and humid airflow from the southern bay of bengal and the animaqing mountain ranges and bayankara mountain ranges from 1960 to 2019 the temperature increased significantly by 0 32 c 10a in the source area of the three rivers fig a1 more importantly the precipitation also showed a significant increasing trend with the value of 35 79 mm 10a fig a1 the vegetation in the source area is mainly natural grassland which accounts for 65 4 of the total source area grassland ecosystem is the most important ecosystem type in the source area of the three rivers from southeast to northwest there are alpine meadow mountain meadow alpine steppe temperate steppe temperate desert grassland alpine swamp meadow alpine desert and gobi yang et al 2018 2 2 sample collection and data analysis all samples in this study were collected during the vegetation growing season from june to september in the three rivers headwaters region the sampling process was as follows plant water plant water was mainly collected from the stems of plants three plants of the same species with good growth conditions and similar crown widths heights and diameters were selected every selected plant was cut into 5 7 tethered branches with a diameter of approximately 0 3 cm and a length of approximately 5 cm first the epidermis of the stem of the cut plants was quickly removed then it was placed in a 10 ml borosilicate glass bottle and immediately sealed using parafilm finally the samples were frozen and stored in a low temperature freezer 5 c a total of 70 plant quadrats were used in this study and 30 species table a1 of plants in cold regions were investigated soil water soil samples were collected by hand every 20 cm down to a depth of 100 cm using a 1 m long drill three parallel samples were collected from each layer for the soil water isotope analysis in this study there were 70 sampling sites and 96 soil samples were collected in july 2021 in the three rivers headwaters region a li 2100 automatic vacuum condensation extraction system was used to extract water from xylem and soil samples before extracting soil and plant samples connecting sample tube and condensation tube to the u shaped glass tube of the independent extraction unit then liquid nitrogen is used as refrigerant and a holding cup filled with liquid nitrogen is placed under the sample tube to immerse it in liquid nitrogen for quick freezing for 10 15 min use the vacuum pump to pump the pressure of the entire extraction system to below 1 pa then close the vacuum valve and observe the pressure change of the independent system on the vacuum gauge at that time transfer the insulation cup to the lower part of the condensation tube and cover the heating tube on the sample tube and keep the temperature constant to 95 c during the collection of liquid water it is necessary to add proper amount of liquid nitrogen in the cooling cup in order to avoid fractionation of extracted water it is necessary to keep the extraction time above 60 90 min at this time the extraction efficiency of liquid water in the sample can be guaranteed to be above 99 0 moreover when there is no water drop on the glass tube wall below the vacuum glass valve of the branch channel the lower part of the condensing tube is frozen into ice and there is no water drop on the upper part and there is no water drop in the tube between the upper part of the sample tube and the condensing tube it indicates that the water in the sample has been extracted vacuum pump was 5 l min 24 v higher pressure was 0 3 bar the recovery rate is 99 101 the extracted water was stored in a glass sample bottle at low temperature to assess stable isotopes a dlt 100 liquid water isotope analyzer was used to measure the stable isotope values of each water body the stable isotope values of the soil water and plant xylem water samples were measured using a mat 253 gas stable isotope ratio mass spectrometer and then d excess was calculated dansgaard 1964 to evaluate whether there is isotope migration between plant water and its potential water source landwehr and coplen 2006 proposed line conditioned exception lc excess the formula was as follows lc excess δ2h aδ18o b where a and b are the slope and intercept of lmwl respectively δ2h and δ18o are the hydrogen and oxygen isotope value in the plant sample respectively this value can reflect the evaporation and non equilibrium fractionation degree of surface water and groundwater in the recharge process the smaller the ic excess value the greater the evaporation degree of water body moreover to evaluate whether there is an isotopic shift between plant xylem water and its potential water source barbeta et al 2019 modified the equation and proposed a xylem offset with respect to soil water i e soil water excess sw excess the formula was as follows sw excess δ2h aδ18o b where a and b are the slope and intercept of the soil water line at the same sampling point during the same period respectively δ2h and δ18o are the hydrogen and oxygen isotope values of the corresponding xylem water sample respectively the sw excess indicates the distance between the xylem sample and its soil waterline δ2h offset an sw excess greater than 0 indicates that xylem samples are more enriched than the δ2h of soil water while sw excess is less than 0 indicating that the xylem sample is more depleted than the δ2h of soil water 2 3 bayesian mixture model to overcome the uncertainty of the isosource model in quantifying plant water sources this study adopted mixsiar models based on the bayesian theory to calculate the contribution rate of plant water sources the mixsiar model combines the advantages of the siar and mixsir models stock and semmens 2016 and it adds modules such as the input form of multivariate isotope raw data source of contribution source random effect classification variable and residual process error when the mixsiar model is used for calculation the running step of monte carlo markov chain mcmc is set as long and the model error is selected as process the corresponding median contribution rate of each estimated water source is regarded as the contribution rate of the water source to plant water ehleringer and dawson 1992 hervé fernández et al 2016 poca et al 2020 2 4 uncertainty analysis it is impossible to directly measure the contribution rate of different potential water sources to plants which can only be calculated by the model however there is great uncertainty in the estimation results of the model stock and semmens 2016 rothfuss and javaux 2017 therefore the calculation results of the model are evaluated this study indirectly evaluated the prediction effect of different model methods by evaluating the degree of matching between the observed and predicted values of plant water isotopes in this study the measured isotopic value of plant xylem water was recorded as oi and the calculation of the predicted value pi was based on the following assumptions the isotopic composition of plant xylem water is a combination of various potential water sources then pi can be obtained using the following formula 1 p i i 1 k f j i where j represents the jth water source utilized by the plants k is the number of potential water sources f represents the contribution rate of each water source to the plants calculated using different models and i represents the isotopic value of each potential water source δ18o or δd in order to evaluate the reliability of the results we use the root mean square error rmse parameter to measure 2 rmse 1 n i 1 n p i o i 2 1 2 where n is the number of validation samples and pi and oi represent the predicted and measured values of isotope composition of plant water respectively the smaller the rmse value is the smaller the model error is and the more accurate the simulation results are li and heap 2011 all data were not normally distributed the nonparametric mann whitney rank sum test m w was used for statistical analysis to compare the isotopic characteristics between different types of plant water and soil water δ18o and δ2h kruskall wallis test k w and posterior multiple comparison using dunn method were used to analyze the isotopic characteristics of plant water and lc excess compare the slope and intercept of lmwl using student s t test statistical significance is set to α 0 05 evaristo et al 2015 hervé fernández et al 2016 poca et al 2020 3 results 3 1 spatial characteristics of stable isotopes in plant water to analyze the spatial characteristics of stable isotopes in plant water in the three rivers headwaters region this study mainly focused on the altitude effect of stable isotopes and then used the inverse distance weight method to interpolate the stable isotope values of all plant water samples using arcgis software in the study area as shown in fig 2 the oxygen isotope value of plant water was depleted especially in the southeast of the source region of the yangtze river and northeast of the source region of the yellow river fig 2a however the oxygen isotope value of plant water was enriched in southwest of the source region of the yellow river and northeast of the source region of the lancang river these results indicate that the spatial characteristics of stable isotopes in plant water may be related to the evaporation intensity of the study area distribution of plants of different vegetation types evapotranspiration pattern and possible recharge source type or proportion of plant water the hydrogen isotope value was depleted in the southwest of the study area particularly in the source region of the lancang river however the hydrogen isotopic values in the northeastern part of the study area were enriched this result may be due to the distribution of several forests in the source region of the lancang river whereas the distribution of herbaceous plants in the northeast of the source region of the yellow river may be more extensive this phenomenon further confirms the influence of the plant distribution of different vegetation types on the spatial distribution characteristics of the stable isotopes more importantly there were significant spatial variations in deuterium excess in the plant water in the study area fig 2 the d excess was enriched in all regions except the southwest of the source region of the yellow river and northeast of the source region of the lancang river the spatial distribution of d excess was opposite to that of the oxygen isotopes in other words the spatial variation of plant water stable isotopes mainly reflects the influence of three factors difference in evaporation characteristics in different vegetation growth areas difference in spatial distribution characteristics of plants of different vegetation types arbors shrubs and herbs and the difference in the main soil recharge sources and proportion of plant water of different vegetation types 3 2 distribution characteristics of stable isotopes of plant water as shown in fig 3 the local meteoric water line lmwl determined by δ18o and δ2h of precipitation was δ2h 7 95δ18o 10 78 r2 0 96 p 0 01 and the global meteoric water line gmwl was δ2h 8δ18o 10 dansgaard 1964 the slope and intercept of the local meteoric water line lmwl were similar to those of the global meteoric water line indicating a dry climate and strong evaporation in the study area from the hydrogen and oxygen stable isotope values of soil water the soil water line swl equation can be obtained as δ2h 3 49δ18o 56 17 r2 0 93 p 0 01 the soil water line is at the lower right of the local meteoric water line and the slope and intercept were less than those of the global meteoric water line and the local meteoric water line indicating that the soil water experienced strong evaporation moreover the δ18o of intersection of the lmwl and swl was 15 01 and the δ2h of intersection of the lmwl and swl was 108 56 the intersection of the lmwl and swl was the mean weighted average precipitation signature of water that evaporates and forms the swl the δ18o and δ2h of plant water for tree shrubs and herbs was more enriched than that of intersection of the lmwl and swl which indicated that a warmer period water recharge meanwhile the hydrogen and oxygen stable isotope values of plant water and soil water were located at the lower right of the local meteoric water line indicating that plant water is also affected by strong evaporation and compared with herb arbor and shrub plant water a small part of herbaceous plant water are distributed near the local meteoric water line which indicates that precipitation may be the major recharge source of plant water as shown in fig 4 the stable isotope signatures of the different plant types were significantly different the hydrogen isotope values of arbor 102 28 and shrub 102 48 plants were more depleted than those of herbs 83 82 the variation characteristics of the oxygen isotopes were the same as those of the hydrogen isotopes the oxygen isotope values of arbor 13 51 and shrub 13 47 plants were more depleted than those of herbs 6 88 however the d excess pattern was the opposite of the stable isotope patterns of hydrogen and oxygen the d excess values of arbor 5 77 and shrub 5 31 plants were enriched while that of herbs 28 76 was depleted the stable isotope characteristics of arbor and shrubs were very similar in the three rivers headwaters region the latter may be mainly due to the similar growth patterns or water use mechanisms of water sources of arbor and shrubs in cold areas however the hydrogen and oxygen isotope values of herbs were enriched which indicated that the herbaceous plant water or potential recharge source of plant water is strongly affected by evaporation during the transport and transformation process 3 3 variation characteristics of ic excess and sw excess the difference of ic excess and sw excess among shrubs herbs and tree was shown in fig 5 ic excess and sw excess of different types of plants showed significant change characteristics which indicated that there may be significant differences in recharge sources and recharge processes of different types of plants the average value of ic excess for tree 5 69 1 31 was higher than that of shrubs 6 15 1 55 while the value of ic excess for shrubs was lower than that of herbs 39 72 7 75 this result showed that the plant water of herbs was affected by strong evaporation or the possible recharge source of plant water for herbs may be affected by evaporation to a greater extent followed by shrubs and tree more importantly the average value of sw excess of different plants was also negative fig 5b which indicated that the phenomenon of hydrogen isotope depletion existed in the plant water in the study area the sw excess indicates the distance between the xylem sample and its soil waterline δ2h offset the mean value of sw excess of trees was 23 98 1 50 and the mean value of sw excess of shrubs was 24 40 1 41 while that of herbs was 49 52 6 40 these results indicated that the plant water was more depleted than the δ2h of soil water whether tree or shrubs or herbs more importantly it was confirmed that hydrogen isotope depletion exists in plants water 4 discussions 4 1 factors affecting stable isotope characteristics of plant water to analyze the factors influencing the stable isotope signatures of plant water the relationships between soil temperature soil water content soil bulk density and oxygen isotope values of plant water were determined fig 6 there was a decreasing trend first and then an increasing one between δ18o of plant water and soil temperature from 0 to 60 cm while there was a significant positive correlation between the oxygen isotope value of plant water and soil temperature from 60 to 100 cm this result showed that soil temperature from 60 to 100 cm was the factor affecting the stable isotopic characteristics of plant water meanwhile there was a close relationship between the recharge sources of plant water and soil water from 60 to 100 cm more importantly there was a significant negative correlation between the oxygen isotope value of plant water and soil water compartment regardless of the soil layer the higher the soil water compartment the more depleted the stable isotopes of plant water this indicated that soil water was not only the direct recharge source but also the main recharge source of plant water similar to the soil water compartment there was a significant negative correlation between the oxygen isotope value of plant water and soil bulk density in all soil layer except 20 40 cm this phenomenon indicated that soil bulk density was also a factor affecting the stable isotopic characteristics of plant water soil bulk density not only reflects the total porosity of soil but also shows the tightness and structure of the soil soil porosity tightness and structure determine the infiltration process of soil water which fundamentally affects the stable isotopic characteristics of plant water this result confirms that soil water is the major recharge source of plant water from another point of view in the three rivers headwaters region soil temperature soil water compartment and soil bulk density as important physical parameters of the surface are important indicators of soil on plants chen et al 2019 as an important environmental factor in terrestrial ecosystem soil temperature directly affects soil water transformation soil respiration and plant growth and development in cold regions soil water compartment is a basic environmental factor affecting plant growth and an important link in determining soil hydrology and the water cycle process of soil vegetation atmosphere in cold regions li et al 2020b soil bulk density reflects the compactness of soil and is closely related to soil porosity the three soil physical properties play a key role in the growth and development of plants in cold regions especially in the water supply mode of plants in cold regions song et al 2022 4 2 recharge components indicated by stable isotope signatures of water bodies as shown in fig 7 the stable isotope characteristics of plant water and other possible recharge sources river water supra permafrost water soil water precipitation and ground ice were analyzed the recharge sources of plant water can be divided into two types direct and indirect from the distribution of stable isotope characteristics of water bodies the direct source was soil water whereas the indirect source was the direct source of soil water such as river water supra permafrost water soil water precipitation and ground ice the stable isotope values of plant water from arbor and shrubs were very close to that of soil water fig 7a especially close to 40 60 cm of soil water this result showed that soil water was a direct source of plant water however the isotope of the herbs was far from the stable isotope of the soil water in any layer this may be mainly due to the strong evaporation of herbs water from the plateau which makes the values of stable isotopes more positive than those of other plants in the three rivers headwaters region to further determine the relationship between the stable isotopes of plant water and stable isotopes of soil water we systematically analyzed the distribution characteristics of the stable isotopes of plant water and soil water as shown in fig 7b except for some herbs all other plants including trees shrubs and remaining herbs were very close to soil water which further confirmed the above analysis the sources of soil water in cold regions are mainly precipitation and ground ice meltwater li et al 2020a however soil water is an important link between plant water and other water bodies soil water is the most direct source of plant water 4 3 quantitative analysis of the recharge source of plant water as shown in fig 8 the results of the direct comparison between different plant waters were calculated for the three rivers headwaters region the results showed that there were differences in the intersection between plant water and soil water in different soil layers in different vegetation types in the plant quadrat of trees the stable isotope of tree water intersects with soil water between 60 cm and 80 cm indicating that soil water may be the main source of tree water especially soil water between 60 and 80 cm moreover the stable isotope of shrubs water intersects with soil water between 20 and 40 cm indicating that soil water may be the main source of plant water especially soil water between 20 and 40 cm in the plant quadrat of shrubs however in the plant quadrat of the herbs the stable isotope of herb water had no intersection with soil water in each layer so it was impossible to judge its main water source this result may be mainly due to the more complex water sources of herbal plants soil is the main medium for vegetation growth in cold arid humid and other regions therefore soil water is the main direct source of plant water but the contributions of different soil layers to different types of plant water are different as shown in fig 9 the contribution proportions of soil water between 0 cm and 20 cm and between 40 cm and 60 cm to the plant water were higher than that of other soil layers for trees with contribution values of 24 and 32 respectively this result showed that the contribution of soil water between 0 cm and 20 cm and between 40 cm and 60 cm to the growth of trees was greater in the study area this may be related to the root distribution and water absorption mode of trees in cold areas similar to the tree the contribution proportion of soil water between 0 and 20 cm to the shrubs water was 26 and the contribution proportion of soil water between 40 and 60 cm to the shrubs plant water was 30 this result showed that water sources of arbor and shrubs were similar in this cold region more importantly each layer of soil water recharged approximately 20 of plant water fig 9 this may be related to the diversity of plant water sources in the cold regions it is also closely related to the natural environment in cold regions the growing season in the cold region is also the melting period and it is also the period of rain and heat over the same time water is a necessary condition for plant survival and determines the processes of plant growth development and reproduction in terms of temporal and spatial variability and availability of water resources in the environment different plants have different preferences for different water sources liu et al 2020 at the same time due to the differences in water physiological and ecological characteristics there are great differences in water sources and water use patterns among different plants deng et al 2020 the water source of the same plant also changes with the availability and seasonality of the environmental water zhang et al 2021 exploring the water source of plants is not only conducive to an in depth understanding of plant growth and survival but also enables scholars to master the plasticity response of different plants in the ecosystem to environmental water variation which enables the changes in species composition and vegetation dynamics of the ecosystem under the scenario of global change grossiord et al 2017 soil water is a direct source of plant water but soil water mainly comes from precipitation and ground ice meltwater in cold regions li et al 2020b therefore to elucidate the sources of plant water in cold regions we also systematically and quantitatively analyzed the indirect sources of plant water in this study indirect sources of plant water mainly include precipitation glacier snow meltwater ground ice meltwater river water and supra permafrost water in cold regions the plant water sources of the different types of vegetation were quantified and the contribution rate of potential water sources to plant water was calculated using the mixsiar model as shown in fig 10 the main recharge of tree water was still soil water 0 100 cm soil layer while the recharge of tree water from indirect sources such as precipitation glacier snow meltwater ground ice meltwater river water and supra permafrost water could not be ignored the contribution of soil water to tree water was 59 which further confirmed that soil water was the direct recharge source of plant water meanwhile the glacier snow meltwater 10 precipitation 9 and ground ice meltwater 8 river water 7 and supra permafrost water 7 were also the important recharge sources of plant water this result shows that glacier snow meltwater precipitation and ground ice meltwater are also the main supply sources of plant water except for soil water for shrubs the quantitative results of the main plant water supply were very similar to those of trees fig 10 this may be mainly due to the similar water use strategies and lifestyles of shrub and trees in cold region moreover the contribution of soil water to herb plant water was 46 which further confirmed that soil water was the direct recharge source of herbs plant water however the contribution of other indirect recharge sources accounted for a large proportion 54 especially the contribution of supra permafrost water 12 ground ice meltwater 11 river water 11 precipitation 11 and glacier snow meltwater 9 the proportion of supra permafrost water to plant water was relatively high mainly because herbaceous plants grow in the active layer in the cold region therefore the proportion of plant water recharged by supra permafrost water and ground ice meltwater was higher than that of other water bodies during the plant growing season the uncertainty caused by the change of production trace and measurement method can be calculated by formula 2 the root mean square error rmse index was selected to analyze the direct source error of water sources of different types of plants stock and semmens 2016 rothfuss and javaux 2017 according to the analysis results the rmse values of trees shrubs and herbs were 0 0311 0 0314 and 0 526 respectively moreover the error analysis of indirect sources showed that the rmse values of trees shrubs and herbs were 0 271 0 342 and 1 326 respectively when the concentration of tracers from potential sources of plant water changes greatly and the difference is small the uncertainty of calculation results will become more sensitive the mixsir model takes into account the spatial differences in the isotopic composition of potential water sources however when the standard deviation of the isotope values of plant xylem water and potential water sources is large the calculation results of the model will produce large errors however the mixsiar model takes into account prior information and sets process modules and residual modules which greatly improves the calculation accuracy although there is some uncertainty in this method mixsiar model based on stable isotope is still an effective tool to evaluate the contribution of water sources to plant water which is especially helpful to strengthen our understanding of hydrological processes in alpine regions where observation data are lacking 5 conclusions this study focuses on the recharge sources of plant water based on the stable isotope tracer technique δ18o and δ2h in the three rivers headwaters region the results showed that the oxygen and hydrogen isotope signatures of arbor and shrub plants were more depleted than those of herbs the oxygen isotope signatures of plant water were depleted especially in the southeast of the source region of the yangtze river and the northeast of the source region of the yellow river ic excess and sw excess of different types of plants showed significant change characteristics which indicated that there may be significant differences in recharge sources and recharge processes of different types of plants there was an initial decreasing trend and then an increasing one between δ18o of plant water and soil temperature from 0 to 60 cm while there was a significant positive correlation between the oxygen isotope of plant water and soil temperature from 60 to 100 cm moreover there was a significant negative correlation between the oxygen isotope of plant water and soil water compartment while there was a significant negative correlation between the oxygen isotope signatures of plant water and soil bulk density in all soil layers except at 20 40 cm from the distribution of stable isotope characteristics of water bodies the direct source was soil water whereas the indirect source was the direct source of soil water such as river water supra permafrost water soil water precipitation and ground ice through the analysis of the direct recharge source of plant water the contribution proportion of soil water between 0 cm and 20 cm and between 40 cm and 60 cm to the plant water was higher than that of other soil layers for trees through the analysis of the indirect recharge source of plant water the contribution of soil water to tree water was 60 while the glacier snow meltwater precipitation and ground ice meltwater river water and supra permafrost water were also the important recharge sources of plant water additionally the contribution of other indirect recharge sources accounted for a large proportion especially the contribution of supra permafrost water ground ice meltwater river water and precipitation the proportion of supra permafrost water to plant water was relatively high and the proportion of plant water recharged by supra permafrost water and ground ice meltwater was higher than that of other water bodies during the plant growing season credit authorship contribution statement zongjie li writing original draft formal analysis methodology xiaoying liu software data curation zongxing li writing review editing conceptualization resources supervision project administration qi feng writing review editing conceptualization resources supervision project administration mengqing liu writing review editing bin xu investigation data curation juan gui investigation formal analysis qiao cui investigation formal analysis yue zhao software jian xue software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by national nature science foundation of china 42107063 42077187 the second tibetan plateau scientific expedition and research program 2019qzkk0405 chinese academy of sciences young crossover team project jctd 2022 18 the national key research and development program of china 2020yfa0607702 the western light key laboratory cooperative research cross team project of chinese academy of sciences innovative groups in gansu province 20jr10ra038 we greatly appreciate suggestions from anonymous referees for the improvement of our paper thanks also to the editorial staff appendix a 
2187,this study based on the stable isotope tracer technique δ18o and δ2h focuses on the recharge sources of plant water in the three rivers headwaters region in qinghai province china the oxygen and hydrogen isotope signatures of trees and shrubs were more depleted than those of herbs however the d excess pattern was the opposite of the patterns of stable isotopes of oxygen and hydrogen from the distribution of stable isotope characteristics of water bodies the direct source of plant water was determined to be soil water whereas the indirect sources were river water supra permafrost water soil water precipitation and ground ice the contribution proportions of soil water layers between 0 cm and 20 cm and between 40 cm and 60 cm to the plant water were higher than those of other soil water layers for trees more importantly the plant water of shrubs was similar to trees in the cold region the analysis of the indirect recharge sources of plant water revealed that soil water was still the major source of plant water while glacier snow meltwater precipitation and ground ice meltwater are also the main supply sources of plant water the proportion of supra permafrost water to plant water was relatively high mainly because herbs grow in the active layer in the cold region therefore the proportion of plant water recharged by supra permafrost water and ground ice meltwater was higher than that of other water bodies during the plant growing season keywords recharge source recharge mechanism plant water cold region three rivers headwaters region data availability data will be made available on request 1 introduction important changes in ecosystem degradation and soil hydrology are related to freeze thaw cycles and frozen soil degradation such changes considerably impact the characteristics of ecosystem structure composition function and spatial distribution pattern of plants in the source area of three rivers in the qinghai tibet plateau cuneo et al 2018 mills et al 2018 dai et al 2020 luo et al 2020 supply of supra permafrost water has declined considerably therefore low level swamp wetlands with a strong dependence on the supply of shallow groundwater have shrunk substantially as a result mountainous swamp meadows in most sections of cold regions have been replaced by mountainous meadows and mountainous grasslands the vegetation coverage and root system will change which will weaken the regulation of vegetation on soil water content and reduce soil conservation and storage capacity of surface water causing serious water loss resulting in the reduction of water storage and biomass and the loss of soil organic carbon all these changes may finally lead to surface desertification qiu et al 2019 therefore it is crucial to elucidate the hydrological processes of frozen soil in the context of climate warming and the accelerated melting of the cryosphere in particular the quantitative analyses of plant water sources of different vegetation types and the adaptive mechanism of plant water sources to frozen soil degradation are helpful in comprehensively understanding the water cycle and eco hydrological processes in cold areas piao et al 2019 the research results would provide scientific and technological support for ecological restoration and environmental reconstruction in cold regions plant water is an important component of the water cycle in the context of global warming accelerated melting of frozen soil has affected the usual water cycle which has altered the ecological environment in cold regions mills et al 2018 barbeta et al 2019 tiemuerbieke et al 2018 thus the continuous degradation of permafrost areas has a critical impact on the plant water sources pws in cold areas to date insufficient attention to the plant water sources pws in permafrost areas has led to an imprecise understanding of the response of plant water sources to permafrost degradation in cold regions beyer et al 2018 václav et al 2019 benettin et al 2021 jia et al 2022 nehemy et al 2019 2021 2022 more importantly quantitative analyses of plant water sources can form an important basis for a comprehensive understanding of the water cycle and ecohydrology processes in cold regions yao et al 2014 wu et al 2019 due to climate warming changes in the ecosystem and surface water and heat processes caused by frozen soil degradation have affected plant ecological processes in cold regions yin et al 2021 however owing to the lack of systematic research on a regional scale the response mechanism of plant water sources to frozen soil degradation remains insufficient the study on the plant water sources pws by using stable oxygen and hydrogen isotope technology is helpful to clearly understand and master the mechanism of hydrological cycle in this area and is of great significance to protect the unique ecological environment in the source area of the three rivers the quantitative analysis of the plant water sources pws of different vegetation types in the source area of the three rivers and the in depth discussion of the plant water sources pws of different plants in the same habitat and the changes in the water sources selected by the same plant in different growth stages which will help to comprehensively understand the water cycle process and the ecological hydrological process of the plants in the cold region meanwhile it will provide the basis for the ecological restoration and environmental construction in the cold region the research on plant water source and water use mode is conducive to formulating a reasonable ecological water allocation scheme to ensure that ecological water can be effectively used by plants moreover the three rivers headwaters region is an important ecological barrier and water conservation area in china crucial for global biodiversity protection liu et al 2022 it is a sensitive area in the context of climate change in asia the northern hemisphere and the world li et al 2021 furthermore the degradation of permafrost is mainly manifested by the change of the active layer the change in the frozen soil active layer not only changes the soil water holding capacity but also directly affects the growth environment of vegetation in cold regions meanwhile permafrost degradation reduces the hydraulic conductivity of soil leading to the reduction of glacier snow meltwater or precipitation infiltration and changes the processes and characteristics of runoff production and conflux in cold regions liu et al 2021 unger et al 2022 however under continuous warming the plant water source pws has undergone significant changes in cold regions in cold regions permafrost degradation has a strong impact on plant water sources pws therefore this study focused on the three rivers headwaters region and it aimed to 1 analyze the variation characteristics of stable isotope signatures of plant water and other water bodies in the source area of the yangtze river 2 explore the recharge sources of plant water indicated by stable isotope signatures of plant water and potential water sources and 3 quantify the recharge source and proportion of plant water in the source area of the yangtze river these findings may provide scientific guidance for ecological protection and vegetation restoration in cold regions and provide a better decision making basis for coping with climate change water resource management and environmental protection in cold regions 2 materials and methods 2 1 study area the source area of the three rivers located in the south of qinghai province 31 39 36 12 n 89 45 102 23 e fig 1 with a total area of 36 3 104 km2 the sanjiangyuan national park accounts for 31 16 of the area including three parks the respective sources of the yangtze river yellow river and lancang river the landforms of the source areas of the three rivers are mainly complex mountain landforms and the terrain gradually rises from southeast to northwest with an average altitude of more than 4 000 m the three rivers headwaters region is a typical permafrost area permafrost coverage 107 619 13 km2 accounts for 77 of the total area yao et al 2014 seasonal permafrost is mainly distributed in river valleys with an area of 30 754 34 km2 zhou et al 2015 the source area has a typical plateau continental climate with alternating cold and hot seasons and distinct dry and wet seasons the annual average temperature is between 5 6 to 4 9 c and the annual total precipitation is 391 7 764 mm the temperature and precipitation in the source area gradually decreased from southeast to northwest due to the interception of the warm and humid airflow from the southern bay of bengal and the animaqing mountain ranges and bayankara mountain ranges from 1960 to 2019 the temperature increased significantly by 0 32 c 10a in the source area of the three rivers fig a1 more importantly the precipitation also showed a significant increasing trend with the value of 35 79 mm 10a fig a1 the vegetation in the source area is mainly natural grassland which accounts for 65 4 of the total source area grassland ecosystem is the most important ecosystem type in the source area of the three rivers from southeast to northwest there are alpine meadow mountain meadow alpine steppe temperate steppe temperate desert grassland alpine swamp meadow alpine desert and gobi yang et al 2018 2 2 sample collection and data analysis all samples in this study were collected during the vegetation growing season from june to september in the three rivers headwaters region the sampling process was as follows plant water plant water was mainly collected from the stems of plants three plants of the same species with good growth conditions and similar crown widths heights and diameters were selected every selected plant was cut into 5 7 tethered branches with a diameter of approximately 0 3 cm and a length of approximately 5 cm first the epidermis of the stem of the cut plants was quickly removed then it was placed in a 10 ml borosilicate glass bottle and immediately sealed using parafilm finally the samples were frozen and stored in a low temperature freezer 5 c a total of 70 plant quadrats were used in this study and 30 species table a1 of plants in cold regions were investigated soil water soil samples were collected by hand every 20 cm down to a depth of 100 cm using a 1 m long drill three parallel samples were collected from each layer for the soil water isotope analysis in this study there were 70 sampling sites and 96 soil samples were collected in july 2021 in the three rivers headwaters region a li 2100 automatic vacuum condensation extraction system was used to extract water from xylem and soil samples before extracting soil and plant samples connecting sample tube and condensation tube to the u shaped glass tube of the independent extraction unit then liquid nitrogen is used as refrigerant and a holding cup filled with liquid nitrogen is placed under the sample tube to immerse it in liquid nitrogen for quick freezing for 10 15 min use the vacuum pump to pump the pressure of the entire extraction system to below 1 pa then close the vacuum valve and observe the pressure change of the independent system on the vacuum gauge at that time transfer the insulation cup to the lower part of the condensation tube and cover the heating tube on the sample tube and keep the temperature constant to 95 c during the collection of liquid water it is necessary to add proper amount of liquid nitrogen in the cooling cup in order to avoid fractionation of extracted water it is necessary to keep the extraction time above 60 90 min at this time the extraction efficiency of liquid water in the sample can be guaranteed to be above 99 0 moreover when there is no water drop on the glass tube wall below the vacuum glass valve of the branch channel the lower part of the condensing tube is frozen into ice and there is no water drop on the upper part and there is no water drop in the tube between the upper part of the sample tube and the condensing tube it indicates that the water in the sample has been extracted vacuum pump was 5 l min 24 v higher pressure was 0 3 bar the recovery rate is 99 101 the extracted water was stored in a glass sample bottle at low temperature to assess stable isotopes a dlt 100 liquid water isotope analyzer was used to measure the stable isotope values of each water body the stable isotope values of the soil water and plant xylem water samples were measured using a mat 253 gas stable isotope ratio mass spectrometer and then d excess was calculated dansgaard 1964 to evaluate whether there is isotope migration between plant water and its potential water source landwehr and coplen 2006 proposed line conditioned exception lc excess the formula was as follows lc excess δ2h aδ18o b where a and b are the slope and intercept of lmwl respectively δ2h and δ18o are the hydrogen and oxygen isotope value in the plant sample respectively this value can reflect the evaporation and non equilibrium fractionation degree of surface water and groundwater in the recharge process the smaller the ic excess value the greater the evaporation degree of water body moreover to evaluate whether there is an isotopic shift between plant xylem water and its potential water source barbeta et al 2019 modified the equation and proposed a xylem offset with respect to soil water i e soil water excess sw excess the formula was as follows sw excess δ2h aδ18o b where a and b are the slope and intercept of the soil water line at the same sampling point during the same period respectively δ2h and δ18o are the hydrogen and oxygen isotope values of the corresponding xylem water sample respectively the sw excess indicates the distance between the xylem sample and its soil waterline δ2h offset an sw excess greater than 0 indicates that xylem samples are more enriched than the δ2h of soil water while sw excess is less than 0 indicating that the xylem sample is more depleted than the δ2h of soil water 2 3 bayesian mixture model to overcome the uncertainty of the isosource model in quantifying plant water sources this study adopted mixsiar models based on the bayesian theory to calculate the contribution rate of plant water sources the mixsiar model combines the advantages of the siar and mixsir models stock and semmens 2016 and it adds modules such as the input form of multivariate isotope raw data source of contribution source random effect classification variable and residual process error when the mixsiar model is used for calculation the running step of monte carlo markov chain mcmc is set as long and the model error is selected as process the corresponding median contribution rate of each estimated water source is regarded as the contribution rate of the water source to plant water ehleringer and dawson 1992 hervé fernández et al 2016 poca et al 2020 2 4 uncertainty analysis it is impossible to directly measure the contribution rate of different potential water sources to plants which can only be calculated by the model however there is great uncertainty in the estimation results of the model stock and semmens 2016 rothfuss and javaux 2017 therefore the calculation results of the model are evaluated this study indirectly evaluated the prediction effect of different model methods by evaluating the degree of matching between the observed and predicted values of plant water isotopes in this study the measured isotopic value of plant xylem water was recorded as oi and the calculation of the predicted value pi was based on the following assumptions the isotopic composition of plant xylem water is a combination of various potential water sources then pi can be obtained using the following formula 1 p i i 1 k f j i where j represents the jth water source utilized by the plants k is the number of potential water sources f represents the contribution rate of each water source to the plants calculated using different models and i represents the isotopic value of each potential water source δ18o or δd in order to evaluate the reliability of the results we use the root mean square error rmse parameter to measure 2 rmse 1 n i 1 n p i o i 2 1 2 where n is the number of validation samples and pi and oi represent the predicted and measured values of isotope composition of plant water respectively the smaller the rmse value is the smaller the model error is and the more accurate the simulation results are li and heap 2011 all data were not normally distributed the nonparametric mann whitney rank sum test m w was used for statistical analysis to compare the isotopic characteristics between different types of plant water and soil water δ18o and δ2h kruskall wallis test k w and posterior multiple comparison using dunn method were used to analyze the isotopic characteristics of plant water and lc excess compare the slope and intercept of lmwl using student s t test statistical significance is set to α 0 05 evaristo et al 2015 hervé fernández et al 2016 poca et al 2020 3 results 3 1 spatial characteristics of stable isotopes in plant water to analyze the spatial characteristics of stable isotopes in plant water in the three rivers headwaters region this study mainly focused on the altitude effect of stable isotopes and then used the inverse distance weight method to interpolate the stable isotope values of all plant water samples using arcgis software in the study area as shown in fig 2 the oxygen isotope value of plant water was depleted especially in the southeast of the source region of the yangtze river and northeast of the source region of the yellow river fig 2a however the oxygen isotope value of plant water was enriched in southwest of the source region of the yellow river and northeast of the source region of the lancang river these results indicate that the spatial characteristics of stable isotopes in plant water may be related to the evaporation intensity of the study area distribution of plants of different vegetation types evapotranspiration pattern and possible recharge source type or proportion of plant water the hydrogen isotope value was depleted in the southwest of the study area particularly in the source region of the lancang river however the hydrogen isotopic values in the northeastern part of the study area were enriched this result may be due to the distribution of several forests in the source region of the lancang river whereas the distribution of herbaceous plants in the northeast of the source region of the yellow river may be more extensive this phenomenon further confirms the influence of the plant distribution of different vegetation types on the spatial distribution characteristics of the stable isotopes more importantly there were significant spatial variations in deuterium excess in the plant water in the study area fig 2 the d excess was enriched in all regions except the southwest of the source region of the yellow river and northeast of the source region of the lancang river the spatial distribution of d excess was opposite to that of the oxygen isotopes in other words the spatial variation of plant water stable isotopes mainly reflects the influence of three factors difference in evaporation characteristics in different vegetation growth areas difference in spatial distribution characteristics of plants of different vegetation types arbors shrubs and herbs and the difference in the main soil recharge sources and proportion of plant water of different vegetation types 3 2 distribution characteristics of stable isotopes of plant water as shown in fig 3 the local meteoric water line lmwl determined by δ18o and δ2h of precipitation was δ2h 7 95δ18o 10 78 r2 0 96 p 0 01 and the global meteoric water line gmwl was δ2h 8δ18o 10 dansgaard 1964 the slope and intercept of the local meteoric water line lmwl were similar to those of the global meteoric water line indicating a dry climate and strong evaporation in the study area from the hydrogen and oxygen stable isotope values of soil water the soil water line swl equation can be obtained as δ2h 3 49δ18o 56 17 r2 0 93 p 0 01 the soil water line is at the lower right of the local meteoric water line and the slope and intercept were less than those of the global meteoric water line and the local meteoric water line indicating that the soil water experienced strong evaporation moreover the δ18o of intersection of the lmwl and swl was 15 01 and the δ2h of intersection of the lmwl and swl was 108 56 the intersection of the lmwl and swl was the mean weighted average precipitation signature of water that evaporates and forms the swl the δ18o and δ2h of plant water for tree shrubs and herbs was more enriched than that of intersection of the lmwl and swl which indicated that a warmer period water recharge meanwhile the hydrogen and oxygen stable isotope values of plant water and soil water were located at the lower right of the local meteoric water line indicating that plant water is also affected by strong evaporation and compared with herb arbor and shrub plant water a small part of herbaceous plant water are distributed near the local meteoric water line which indicates that precipitation may be the major recharge source of plant water as shown in fig 4 the stable isotope signatures of the different plant types were significantly different the hydrogen isotope values of arbor 102 28 and shrub 102 48 plants were more depleted than those of herbs 83 82 the variation characteristics of the oxygen isotopes were the same as those of the hydrogen isotopes the oxygen isotope values of arbor 13 51 and shrub 13 47 plants were more depleted than those of herbs 6 88 however the d excess pattern was the opposite of the stable isotope patterns of hydrogen and oxygen the d excess values of arbor 5 77 and shrub 5 31 plants were enriched while that of herbs 28 76 was depleted the stable isotope characteristics of arbor and shrubs were very similar in the three rivers headwaters region the latter may be mainly due to the similar growth patterns or water use mechanisms of water sources of arbor and shrubs in cold areas however the hydrogen and oxygen isotope values of herbs were enriched which indicated that the herbaceous plant water or potential recharge source of plant water is strongly affected by evaporation during the transport and transformation process 3 3 variation characteristics of ic excess and sw excess the difference of ic excess and sw excess among shrubs herbs and tree was shown in fig 5 ic excess and sw excess of different types of plants showed significant change characteristics which indicated that there may be significant differences in recharge sources and recharge processes of different types of plants the average value of ic excess for tree 5 69 1 31 was higher than that of shrubs 6 15 1 55 while the value of ic excess for shrubs was lower than that of herbs 39 72 7 75 this result showed that the plant water of herbs was affected by strong evaporation or the possible recharge source of plant water for herbs may be affected by evaporation to a greater extent followed by shrubs and tree more importantly the average value of sw excess of different plants was also negative fig 5b which indicated that the phenomenon of hydrogen isotope depletion existed in the plant water in the study area the sw excess indicates the distance between the xylem sample and its soil waterline δ2h offset the mean value of sw excess of trees was 23 98 1 50 and the mean value of sw excess of shrubs was 24 40 1 41 while that of herbs was 49 52 6 40 these results indicated that the plant water was more depleted than the δ2h of soil water whether tree or shrubs or herbs more importantly it was confirmed that hydrogen isotope depletion exists in plants water 4 discussions 4 1 factors affecting stable isotope characteristics of plant water to analyze the factors influencing the stable isotope signatures of plant water the relationships between soil temperature soil water content soil bulk density and oxygen isotope values of plant water were determined fig 6 there was a decreasing trend first and then an increasing one between δ18o of plant water and soil temperature from 0 to 60 cm while there was a significant positive correlation between the oxygen isotope value of plant water and soil temperature from 60 to 100 cm this result showed that soil temperature from 60 to 100 cm was the factor affecting the stable isotopic characteristics of plant water meanwhile there was a close relationship between the recharge sources of plant water and soil water from 60 to 100 cm more importantly there was a significant negative correlation between the oxygen isotope value of plant water and soil water compartment regardless of the soil layer the higher the soil water compartment the more depleted the stable isotopes of plant water this indicated that soil water was not only the direct recharge source but also the main recharge source of plant water similar to the soil water compartment there was a significant negative correlation between the oxygen isotope value of plant water and soil bulk density in all soil layer except 20 40 cm this phenomenon indicated that soil bulk density was also a factor affecting the stable isotopic characteristics of plant water soil bulk density not only reflects the total porosity of soil but also shows the tightness and structure of the soil soil porosity tightness and structure determine the infiltration process of soil water which fundamentally affects the stable isotopic characteristics of plant water this result confirms that soil water is the major recharge source of plant water from another point of view in the three rivers headwaters region soil temperature soil water compartment and soil bulk density as important physical parameters of the surface are important indicators of soil on plants chen et al 2019 as an important environmental factor in terrestrial ecosystem soil temperature directly affects soil water transformation soil respiration and plant growth and development in cold regions soil water compartment is a basic environmental factor affecting plant growth and an important link in determining soil hydrology and the water cycle process of soil vegetation atmosphere in cold regions li et al 2020b soil bulk density reflects the compactness of soil and is closely related to soil porosity the three soil physical properties play a key role in the growth and development of plants in cold regions especially in the water supply mode of plants in cold regions song et al 2022 4 2 recharge components indicated by stable isotope signatures of water bodies as shown in fig 7 the stable isotope characteristics of plant water and other possible recharge sources river water supra permafrost water soil water precipitation and ground ice were analyzed the recharge sources of plant water can be divided into two types direct and indirect from the distribution of stable isotope characteristics of water bodies the direct source was soil water whereas the indirect source was the direct source of soil water such as river water supra permafrost water soil water precipitation and ground ice the stable isotope values of plant water from arbor and shrubs were very close to that of soil water fig 7a especially close to 40 60 cm of soil water this result showed that soil water was a direct source of plant water however the isotope of the herbs was far from the stable isotope of the soil water in any layer this may be mainly due to the strong evaporation of herbs water from the plateau which makes the values of stable isotopes more positive than those of other plants in the three rivers headwaters region to further determine the relationship between the stable isotopes of plant water and stable isotopes of soil water we systematically analyzed the distribution characteristics of the stable isotopes of plant water and soil water as shown in fig 7b except for some herbs all other plants including trees shrubs and remaining herbs were very close to soil water which further confirmed the above analysis the sources of soil water in cold regions are mainly precipitation and ground ice meltwater li et al 2020a however soil water is an important link between plant water and other water bodies soil water is the most direct source of plant water 4 3 quantitative analysis of the recharge source of plant water as shown in fig 8 the results of the direct comparison between different plant waters were calculated for the three rivers headwaters region the results showed that there were differences in the intersection between plant water and soil water in different soil layers in different vegetation types in the plant quadrat of trees the stable isotope of tree water intersects with soil water between 60 cm and 80 cm indicating that soil water may be the main source of tree water especially soil water between 60 and 80 cm moreover the stable isotope of shrubs water intersects with soil water between 20 and 40 cm indicating that soil water may be the main source of plant water especially soil water between 20 and 40 cm in the plant quadrat of shrubs however in the plant quadrat of the herbs the stable isotope of herb water had no intersection with soil water in each layer so it was impossible to judge its main water source this result may be mainly due to the more complex water sources of herbal plants soil is the main medium for vegetation growth in cold arid humid and other regions therefore soil water is the main direct source of plant water but the contributions of different soil layers to different types of plant water are different as shown in fig 9 the contribution proportions of soil water between 0 cm and 20 cm and between 40 cm and 60 cm to the plant water were higher than that of other soil layers for trees with contribution values of 24 and 32 respectively this result showed that the contribution of soil water between 0 cm and 20 cm and between 40 cm and 60 cm to the growth of trees was greater in the study area this may be related to the root distribution and water absorption mode of trees in cold areas similar to the tree the contribution proportion of soil water between 0 and 20 cm to the shrubs water was 26 and the contribution proportion of soil water between 40 and 60 cm to the shrubs plant water was 30 this result showed that water sources of arbor and shrubs were similar in this cold region more importantly each layer of soil water recharged approximately 20 of plant water fig 9 this may be related to the diversity of plant water sources in the cold regions it is also closely related to the natural environment in cold regions the growing season in the cold region is also the melting period and it is also the period of rain and heat over the same time water is a necessary condition for plant survival and determines the processes of plant growth development and reproduction in terms of temporal and spatial variability and availability of water resources in the environment different plants have different preferences for different water sources liu et al 2020 at the same time due to the differences in water physiological and ecological characteristics there are great differences in water sources and water use patterns among different plants deng et al 2020 the water source of the same plant also changes with the availability and seasonality of the environmental water zhang et al 2021 exploring the water source of plants is not only conducive to an in depth understanding of plant growth and survival but also enables scholars to master the plasticity response of different plants in the ecosystem to environmental water variation which enables the changes in species composition and vegetation dynamics of the ecosystem under the scenario of global change grossiord et al 2017 soil water is a direct source of plant water but soil water mainly comes from precipitation and ground ice meltwater in cold regions li et al 2020b therefore to elucidate the sources of plant water in cold regions we also systematically and quantitatively analyzed the indirect sources of plant water in this study indirect sources of plant water mainly include precipitation glacier snow meltwater ground ice meltwater river water and supra permafrost water in cold regions the plant water sources of the different types of vegetation were quantified and the contribution rate of potential water sources to plant water was calculated using the mixsiar model as shown in fig 10 the main recharge of tree water was still soil water 0 100 cm soil layer while the recharge of tree water from indirect sources such as precipitation glacier snow meltwater ground ice meltwater river water and supra permafrost water could not be ignored the contribution of soil water to tree water was 59 which further confirmed that soil water was the direct recharge source of plant water meanwhile the glacier snow meltwater 10 precipitation 9 and ground ice meltwater 8 river water 7 and supra permafrost water 7 were also the important recharge sources of plant water this result shows that glacier snow meltwater precipitation and ground ice meltwater are also the main supply sources of plant water except for soil water for shrubs the quantitative results of the main plant water supply were very similar to those of trees fig 10 this may be mainly due to the similar water use strategies and lifestyles of shrub and trees in cold region moreover the contribution of soil water to herb plant water was 46 which further confirmed that soil water was the direct recharge source of herbs plant water however the contribution of other indirect recharge sources accounted for a large proportion 54 especially the contribution of supra permafrost water 12 ground ice meltwater 11 river water 11 precipitation 11 and glacier snow meltwater 9 the proportion of supra permafrost water to plant water was relatively high mainly because herbaceous plants grow in the active layer in the cold region therefore the proportion of plant water recharged by supra permafrost water and ground ice meltwater was higher than that of other water bodies during the plant growing season the uncertainty caused by the change of production trace and measurement method can be calculated by formula 2 the root mean square error rmse index was selected to analyze the direct source error of water sources of different types of plants stock and semmens 2016 rothfuss and javaux 2017 according to the analysis results the rmse values of trees shrubs and herbs were 0 0311 0 0314 and 0 526 respectively moreover the error analysis of indirect sources showed that the rmse values of trees shrubs and herbs were 0 271 0 342 and 1 326 respectively when the concentration of tracers from potential sources of plant water changes greatly and the difference is small the uncertainty of calculation results will become more sensitive the mixsir model takes into account the spatial differences in the isotopic composition of potential water sources however when the standard deviation of the isotope values of plant xylem water and potential water sources is large the calculation results of the model will produce large errors however the mixsiar model takes into account prior information and sets process modules and residual modules which greatly improves the calculation accuracy although there is some uncertainty in this method mixsiar model based on stable isotope is still an effective tool to evaluate the contribution of water sources to plant water which is especially helpful to strengthen our understanding of hydrological processes in alpine regions where observation data are lacking 5 conclusions this study focuses on the recharge sources of plant water based on the stable isotope tracer technique δ18o and δ2h in the three rivers headwaters region the results showed that the oxygen and hydrogen isotope signatures of arbor and shrub plants were more depleted than those of herbs the oxygen isotope signatures of plant water were depleted especially in the southeast of the source region of the yangtze river and the northeast of the source region of the yellow river ic excess and sw excess of different types of plants showed significant change characteristics which indicated that there may be significant differences in recharge sources and recharge processes of different types of plants there was an initial decreasing trend and then an increasing one between δ18o of plant water and soil temperature from 0 to 60 cm while there was a significant positive correlation between the oxygen isotope of plant water and soil temperature from 60 to 100 cm moreover there was a significant negative correlation between the oxygen isotope of plant water and soil water compartment while there was a significant negative correlation between the oxygen isotope signatures of plant water and soil bulk density in all soil layers except at 20 40 cm from the distribution of stable isotope characteristics of water bodies the direct source was soil water whereas the indirect source was the direct source of soil water such as river water supra permafrost water soil water precipitation and ground ice through the analysis of the direct recharge source of plant water the contribution proportion of soil water between 0 cm and 20 cm and between 40 cm and 60 cm to the plant water was higher than that of other soil layers for trees through the analysis of the indirect recharge source of plant water the contribution of soil water to tree water was 60 while the glacier snow meltwater precipitation and ground ice meltwater river water and supra permafrost water were also the important recharge sources of plant water additionally the contribution of other indirect recharge sources accounted for a large proportion especially the contribution of supra permafrost water ground ice meltwater river water and precipitation the proportion of supra permafrost water to plant water was relatively high and the proportion of plant water recharged by supra permafrost water and ground ice meltwater was higher than that of other water bodies during the plant growing season credit authorship contribution statement zongjie li writing original draft formal analysis methodology xiaoying liu software data curation zongxing li writing review editing conceptualization resources supervision project administration qi feng writing review editing conceptualization resources supervision project administration mengqing liu writing review editing bin xu investigation data curation juan gui investigation formal analysis qiao cui investigation formal analysis yue zhao software jian xue software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by national nature science foundation of china 42107063 42077187 the second tibetan plateau scientific expedition and research program 2019qzkk0405 chinese academy of sciences young crossover team project jctd 2022 18 the national key research and development program of china 2020yfa0607702 the western light key laboratory cooperative research cross team project of chinese academy of sciences innovative groups in gansu province 20jr10ra038 we greatly appreciate suggestions from anonymous referees for the improvement of our paper thanks also to the editorial staff appendix a 
2188,stratified water temperature and low temperature outflow water caused by water storage characteristics in deep reservoirs are common practical problems the temperature control curtain tcc is a novel low temperature water treatment technique characterized by a simple structure and low cost in the present paper a new type of flexible tcc scheme is proposed moreover its applicability in engineering is explored by analyzing the thermal structure and hydrodynamic characteristics of the tcc the general notions and theoretical basis of boussinesq approximation for thermal flow are first elaborated then the three dimensional tcc form is obtained through the structural nonlinear analysis method based on vector form intrinsic finite element vfife in addition using a reservoir which is under tcc construction in southwest china as the research object the thermal structure change with and without tcc scenario is observed to evaluate the improvement effect of outflow temperature from april to june lastly taking the flood situation from july to august as the most unfavorable condition the hydrodynamic characteristics are investigated including the static and the dynamic pressures applied on the curtain these preliminary modeling works provide important theoretical references for further engineering operation keywords water temperature stratification temperature control curtain thermal flow thermal structure hydrodynamic analysis data availability data will be made available on request 1 introduction deep reservoirs not only contribute to the spatial distribution of water resources but also have a significant role in shipping farmland irrigation flood storage and power generation as illustrated in fig 1 the impoundment in deep reservoirs and solar radiation bring about a lentic environment and cause the surface water to warm owing to the density difference and low thermal conductivity the heat transfer between the surface and bottom layer of water may be insufficient leading to vertically stable water temperature stratification during the summer he et al 2018a b yang et al 2020 zhang et al 2022 this stratification phenomenon is influenced by seasonal variation reservoir operation conditions impoundment depth as well as other factors azadi et al 2021 duka et al 2021 zhang et al 2022 in general the reservoir water intake is located in the hypolimnion tending to discharge low temperature water during the summer irrigation months tranmer et al 2020 thus long term stratified temperature in reservoirs may cause other ecological problems first this phenomenon may influence the vertical distribution of dissolved oxygen carbon dioxide and bacteria leoni et al 2014 furthermore long term stratified temperature can easily create an acidic environment at hypolimnion resulting in a large amount of precipitation of heavy metal ions and water quality deterioration tranmer et al 2018 xing et al 2018 zhang et al 2021a b zhang et al 2015 zhou et al 2020 lastly the temperature may have a number of adverse effects on the downstream ecology including impacting the reproduction of aquatic organisms matsuura et al 2015 crop reduction zhang et al 2016 and sediment deposition asaeda et al 2001 asaeda et al 1996 elçi 2008 to alleviate the temperature stratification and increase the outflow temperature certain measures are adopted in projects including special reservoir operation he et al 2020 zhang et al 2018 as well as selective withdrawal and avoidance of thermocline sun et al 2014 among these measures selective withdrawal especially multi level intake song et al 2019 and stop log gate kuang et al 2019 zhang and gao 2015 zheng et al 2020 are extensively applied most of the above schemes have strong rigid structures that are extremely durable however such structures need to be designed with reservoirs whose construction cost can be expensive the water in completed reservoirs that are in operation needs to be emptied before constructing selective withdrawal facilities however all of these tasks reduce power generation and cause great economic losses the temperature control curtain tcc is a flexible structure designed for selective withdrawal bohac 1989 compared to traditional schemes the tcc has a much simpler structure lower cost and no influence on reservoir operations he et al 2019 numerous in situ observations and studies have dealt with the outflow temperature improvement effects of tcc through both experiments and numerical simulations vermeyen 2000 used the doppler analyzer and temperature distributor to observe the water retaining performance of three curtains in the whiskeytown reservoir the paper concluded that the curtains effectively prevent water mixing between the hypolimnion and thermocline during the salmon spawning period politano et al 2008 constructed a three dimensional 3d numerical simulation for velocity and temperature distribution in front of the dam in the mcnary reservoir making comparisons with 24 hour in situ observations furthermore shammaa and zhu 2010 examined the flow field change behind the curtain by using particle image velocimetry piv and laser induced fluorescence lif subsequently lian et al 2016 proposed a tcc approach for improving the outflow temperature of deep reservoirs in their paper the researchers proposed three different tcc modes floating suspended and hybrid through reduced scale tests and numerical simulations he et al 2017a b verified that the tcc effectively increases the outflow temperature in addition they also demonstrated a link between the temperature and retaining ratio of the tcc song et al 2020 investigated the influence of different positions outflow flow rates and submerged depths of the tcc on the outflow temperature their results suggested that the installation location of the tcc has little impact on the outflow temperature rather the outflow temperature increased with the increase in outflow rate and the decrease in submerged depth lastly nguyen and wang 2020 showed that the enhancement of permeability does not cause a drop in the outflow temperature on the other hand there is little research on the hydrodynamic characteristics of the tcc sheng et al 2016 suggested that the hydraulic pressure applied to the tcc enhanced with increasing distance between the tcc and the intake declining outflow flow rate and reducing overflow height conversely the change in the water level had little effect on the hydraulic pressure he et al 2017a b observed that a higher flow rate was associated with a higher dynamic pressure difference and a stronger temperature stratification subsequently he et al 2018a b also analyzed the pressure variation law under different inclination ratios arc length ratios and water retaining ratios of the tcc without temperature stratification moreover lian et al 2020 proposed that the water retaining ratio of the tcc has the greatest effect on the pressure in addition the researchers determined that the resistance coefficient of the tcc increased exponentially with the increase in the water retaining ratio twice with the increase in the area ratio and linearly with the increase in the inclination ratio as the evolution of the tcc and its effect on the flow field are complex notions most studies have presented the tcc as a vertical plate or arc plate in numerical simulations however such a presentation deviates from the actual situation thus a new flexible tcc scheme based on the existing research is proposed in this paper after obtaining the 3d form of the tcc the feasibility and effectiveness of the novel tcc scheme in engineering practice are explored specifically with respect to the thermal structure and hydrodynamic characteristics 2 materials and methods 2 1 study area the research object is a high dam with a large reservoir situated in southwest china the dam is primarily used for power generation while also having benefits such as flood control and irrigation the basin area covers 11051 km2 while the storage capacity is 3 748 billion m3 moreover the normal water level is 475 m the starting regulation level is 447 m and the dead water level is 425 m lastly the altitude of the water intake floor is 408 m while the maximum dam height is 185 5 m typical of a deep reservoir due to the great depth there is thermal stratification in front of the dam along the vertical direction fig 2 a and fig 2 b depict the monthly average water temperature distribution and monthly water level between 2018 and 2020 fig 2 a illustrates that the temperature has a stable stratification and that the water temperature between 440 m and 470 m is the highest also known as epilimnion the temperature within this layer varies between the seasons gradually increasing from may to august it begins to decline in september and reaches the lowest point in march the following year furthermore because the temperature gradient between 380 m and 440 m is the largest this layer is defined as thermocline the temperature gradient in the thermocline is more than 0 2 c m from may to october on the other hand the gradient is relatively small between november and april below 380 m i e hypolimnion the temperature is stable at 8 c to 10 c throughout the year fig 2 b shows that the water level from february to june is lower compared to other months 2 2 flexible tcc scheme fig 3 depicts the overall scheme of a flexible tcc the components of the novel tcc are the anchoring system curtain made of impervious geotextile horizontal and vertical cables composed of dyneema ropes upper and lower strings combined floating tanks a main cable and fixed height towers the functions of these various parts are as follows 1 fixed height towers the main cable and combined floating tanks the hollowed towers are embedded on the riverbank at a constant altitude of 455 m the floating tanks within the tower slide through vertical chutes and remain on the water surface this design enables the tcc to automatically adjust its form in response to water level variation as shown in fig 4 this design reduces the mechanical operations and force placed on the main cable and tower improving the structural flexibility and safety bohac 1989 he et al 2017a b the main cable is connected to the floating tanks within the tower and is prestressed in advance lastly the combined floating tanks are attached to the main cable so that the latter always floats on the water for maintenance 2 major structure the major structure of the tcc comprises the upper and lower strings the horizontal and vertical cables composed of dyneema ropes and a curtain made of impervious geotextile it is more elaborate than previous schemes as shown in table 1 the vertical string top ends are attached to the main cable while its bottom ends are connected to the anchoring system the geotextiles are coupled with strings through sleeve holes and thus produce a flexible water blocking structure furthermore the height between the upper string and the main cable is defined as the outflow height which directly impacts the outflow temperature the horizontal string improves the constraint effect on the geotextiles thus also improving the structure s overall stability as shown in fig 5 the string also increases the force transmission path of the geotextile thus better realizing the multi point distribution of the tcc force the presence of the upper string lessens the disruption induced by the flow to the tcc and guarantees structural integrity on the other hand the lower string accelerates the speed of the tcc sinking into the water during installation 3 anchoring system the anchoring system which is fixed to the riverbed connects the vertical cables at the bottom to maintain the tcc s overall stability under hydrodynamic load the design uses either gravity or underwater anchor piles with a large bearing capacity 2 3 methodology 2 3 1 governing equations with respect to the viscous flow considering temperature field the equations of the rng k ε turbulence model are as follows 1 ρ t ρ u i x i 0 2 ρ u i t u j ρ u i x j p x i x j μ u i x j x j μ t u i x j u j x i 2 3 ρ k μ t u i x i δ ij ρ g i 3 ρ c p t t x i ρ u i c p t x j k t x i s e 4 ρ k t ρ u i k x i x j μ μ t σ k k x j p k ρ ε 5 ρ ε t ρ u i ε x i x j μ μ t σ ε ε x j c 1 ε ε k p k c 2 ε ε 2 k ρ 6 μ t ρ c μ k 2 ε 7 p k μ t u i x j u j x i u i x j 8 c 2 ε c 2 ε c μ η 1 η η 0 1 β η 3 in the equation above ρ represents the fluid density while u denotes the velocity in the x y z direction next p represents the pressure while μ denotes the dynamic viscosity and c p denotes the specific heat at constant pressure the symbol κ represents the coefficient of thermal conductivity and s e denotes the source term for internal heat lastly k represents the turbulence intensity and ε denotes energy dissipation rate η s k ε and s 2 s ij s ij σ k 0 07194 σ ε 0 07194 are turbulent prandtl numbers while c μ 0 0845 c 1 ε 1 42 c 2 ε 1 68 η 0 4 38 and β 0 012 are the empirical constants for low mach number flows the above equations may be simplified into an incompressible form furthermore in the present examples with mild thermal expansion effect the boussinesq approximation may also be adopted ferziger et al 2020 mayeli and sheard 2021 the precondition for applying the boussinesq approximation is that the density variation induced by thermal effects is much smaller than the reference density of the fluid i e δ ρ ρ this guarantees that the thermal expansion will be approximately described by a buoyancy term in the momentum equation the equation for the linear variation of density with temperature is given below 9 ρ ρ 0 1 β t t 0 g 2 3 2 research data the topographic data used in the numerical simulation represent the observed dem data with a resolution accuracy of 30 m hydrological data obtained between january 2020 and december 2020 were used herein including inflow and outflow discharge and water level moreover the annual water temperature distribution in 2020 was used which was recorded 1 52 km in front of the dam every 10 days the discharge water temperature was recorded at the inlet as shown in fig 6 the calculated outflow temperature was acquired by probes placed in the center of every diversion pipe s end 2 3 3 models 2 3 3 1 model description flow 3d is a high performance cfd software developed by the flow science corporation it effectively simulates free surface and multiphase flow the software s accuracy and reliability have been demonstrated in numerous hydraulic engineering instances aydin et al 2022 behroozi and vaghefi 2022 gadhe et al 2022 the 3d hydrodynamic and water temperature model is based on flow 3d after modeling the 3d terrain main dam auxiliary dam intake conveyance conduits and other buildings the structured mesh is created with a computational layout of 1420 m 1260 m fig 6 the tcc with a thickness of 1 cm is situated 200 m in front of the water intake the mesh refinement is implemented in flow fields where the velocity is relatively high i e in the flow field between the tcc and the intake boundary outlet the designated flow rate functions as the upstream inlet boundary while the pressure boundary condition with a specified water level is defined as the downstream outlet boundary situated at the diversion pipes ends the free surface is a rigid cover set as a symmetrical boundary lian et al 2020 while the riverbed is a non slip wall boundary li et al 2019 li et al 2020 the initial temperature field is fitted through the user defined function by piecewise linear interpolation of the water temperature distribution in addition the water flows into the intake and square funnel section 8 m 8 m and gathers at the diversion pipe with a 7 m diameter and 30 m length the tcc is subjected to water pressure in the river causing rigid body displacement and elastic deformation with a high degree of geometric nonlinearity the traditional finite element method has certain limitations when faced with the large structural deformation problem on the other hand the vector form intrinsic finite element vfife method is highly reliable and efficient when dealing with such nonlinear problems wu et al 2020 yu et al 2021 in this paper the 3d shape of the tcc the outflow temperature and 3d distribution of pressure difference are obtained by combining the vfife method and flow 3d fig 7 illustrates the solving flow of vfife and flow 3d interaction the initial spatial form of the tcc is the conical surface due to superior load bearing capacity and more convenient construction which is based on previous research results zhang et al 2021a b the tcc is first modeled and imported into the flow 3d as a baffle while the initial pressure p is obtained by calculation the deformation and internal force f are further resolved by the vfife method in addition it is essential to determine whether the imbalance force composed of internal and external force is less than the error limit δ if the imbalance force is greater it continues to update the pressure and solve the structural deformation and internal force until its value becomes less than the error limit 2 3 3 2 model validation to verify the feasibility of the applied numerical model a comparative analysis is conducted between the calculated outflow temperature and measured outflow temperature three practical models are used herein to evaluate model performance including root mean square error rmse the nash sutcliffe efficiency coefficient nse and the rmse observations standard deviation ratio rsr golmohammadi et al 2014 the model is considered to be acceptable if nse 0 50 and rsr 0 70 moriasi et al 2007 10 rmse i 1 n y i obs y i sim 2 n 11 nse 1 i 1 n y i obs y i sim 2 i 1 n y i obs y mean 2 12 rsr i 1 n y i obs y i sim 2 i 1 n y i obs y mean 2 in the above equation n represents the total number of observations while y i obs denotes the i th observed value y i sim represents the i th simulated value and y mean denotes mean of the observed data fig 8 indicates that the calculated values fit well with the measured values with a maximum discrepancy of less than 1 5 c since atmospheric heat exchange and solar radiation are not considered in the numerical simulation the above discrepancy is acceptable the rmse value is 0 609 c nse value is 0 981 and rsr value is 0 491 these measurements demonstrate that the applied temperature model accurately simulates both the temperature distribution and outflow temperature 2 3 3 3 mesh sensitivity analysis the numerical results are often influenced by mesh size herein three different mesh sizes are examined to determine their sensitivity the initial scenario is taken to be mid august with 870 m3 s flow rate as the velocity gradient is considerable along the flow direction and has a relationship with dynamic pressure the velocity distribution at 5 m in front of the tcc is chosen as the comparison index in this study table 2 provides the total mesh number and averaged outflow temperature furthermore fig 9 illustrates the velocity distribution at 5 m in front of the tcc and temperature distribution behind the tcc the outflow temperature and velocity both begin to vary as the mesh number increases while the temperature distribution behind the tcc remains unchanged thus the increase in the mesh number within a certain range has a limited influence on the results based on the numerical accuracy and computational efficiency 0 9 million is taken as the final total mesh number in this paper 2 4 model scenarios to further verify the applicability of the tcc scheme a number of test conditions are selected in this paper which are all shown in table 3 as april may and june are part of an essential season for the reproduction of aquatic species and agricultural irrigation they are taken as the test months controlled by the outflow temperature furthermore as the reservoir s flow rate reaches the maximum at 870 m3 s in july and august potentially exerting great pressure on the tcc these two months are selected as the test months controlled by hydrodynamic characteristics the water level between april and june is 450 m while that between july and august is 475 m fig 10 depicts the temperature stratification under various selected circumstances the condition sequence in table 3 and in the follow up discussion is based on the stratification intensity which is in turn dependent on the temperature gradient in the thermocline a higher temperature gradient is related to a stronger stratification 3 results and discussion 3 1 flow field the flow characteristics and temperature stratification analysis are conducted from the cross section within the central axis of the tcc fig 11 suggests that even if the temperature stratification is different during each month the flow characteristics remain similar with two main streams the first stream is located at the epilimnion it maintains horizontal flow in front of the tcc submerges swiftly after passing through the tcc and finally resumes its horizontal flow on the other hand the second stream is situated at the hypolimnion its flow behind the tcc is similar to the jet flow with a quick rise in velocity because the bottom of the tcc is not entirely sealed these two major streams merge and flow into the intake behind the tcc the velocity between 350 m and 430 m gradually drops because of the tcc s blocking effect potentially causing backflow without the tcc there would be only one mainstream situated in front of the dam because of the withdrawal effect whose elevation is from 380 m to 430 m furthermore in this case the maximum velocity would be less than that with the tcc the flow characteristics of different months are generally similar with and without the tcc 3 2 thermal structure the thermal structure is influenced by the different flow patterns both in front of and behind the tcc fig 12 illustrates that the temperature difference between the front and back of the tcc is more significant when the stratification is more intense furthermore the water present behind the tcc at 415 m to 445 m quickly warms up due to the inflow of surface high temperature water its temperature is thus higher than that of water in front of the tcc at the same altitude since the jet flow at the bottom of the tcc causes an uplift of low temperature water the water temperature between 380 m and 400 m is lower than the water temperature in front of the tcc furthermore the confluence of high temperature and low temperature water contributes to a thin thermocline with a large temperature gradient at the altitude of 410 m in addition stronger stratification is related to a greater temperature gradient table 4 depicts the outflow temperature under different test conditions both with and without the presence of the tcc although a small portion of low temperature water flows into the intake the flexible tcc can still improve the outflow temperature by an average of 2 c and a maximum of 3 8 c in mid may which is beneficial for the downstream ecology 3 3 hydrodynamic characteristics the non uniform density distribution is induced by the thermal structure with the density differences in front of and behind the tcc as the main contributors to the generated static pressure fig 13 and fig 14 illustrate the spatial distribution of the static pressure difference and temperature difference these two results exhibit the same variation trend the temperature difference is the largest at the intake altitude 410 m reaching 5 4 c during mid july thus contributing to the maximum positive static pressure difference of 762 3 pa moreover because of the uplift of low temperature water the density at the back of the tcc is higher than in front of it thus resulting in a negative static pressure difference the maximum negative pressure difference is measured at 290 pa when viewed together with fig 6 the static pressure difference on the right side of the tcc is greater than that on the left this phenomenon is due to the fact that the right side of the tcc is closer to the intake meaning that more water from the right side flows into the intake making water mixing more thorough fig 15 illustrates the vertical distribution of the static pressure difference under different test conditions the maximum positive pressure difference increases while the maximum negative pressure difference decreases with stronger stratification the positive and negative static pressure difference exerts a forcing moment on the tcc enabling it to deform and move downstream however this deformation and displacement may adversely affect the tcc structure and should be seriously considered in engineering practice moreover the non uniformity of the velocity field induces the dynamic pressure difference fig 16 illustrates the spatial distribution of the dynamic pressure difference with a decline in altitude the dynamic pressure difference rapidly increases and reaches a maximum of 185 7 pa near the intake about 408 m in front of the tcc the velocity decreases due to the blocking effect of the tcc conversely the velocity at the back of the tcc is higher than that in front of tcc on account of the withdrawal effect in addition the tcc structure will also move downstream under the influence of the dynamic pressure difference below 408 m this difference will gradually weaken and remain stable at 380 m and below the dynamic pressure difference on the right and left sides shows a similar pattern to that of the static pressure difference fig 17 illustrates the vertical distribution of the dynamic pressure difference under different test conditions in the case that the stratification becomes more considerable the maximum dynamic pressure difference will increase because high temperature water with low density is affected more easily by the intake the maximum difference of dynamic pressure is measured to be 35 7 pa in sum the static pressure difference applied to the tcc is four times the dynamic pressure difference thus the influence of the static pressure difference should be considered during project design 4 conclusions in this paper a new kind of flexible temperature control curtain tcc is presented and its influence on outflow temperature improvement and hydrodynamic characteristics during different months is evaluated the main conclusions are presented below 1 first an innovative scheme of flexible tcc is proposed herein which is capable of automatically adjusting the tcc form with water level variation compared to previous schemes this design offers higher security and flexibility 2 april may and june were selected as the test months controlled by outflow temperature based on temperature stratification the improvement of outflow temperature is investigated after establishing the tcc in nine conditions the results suggest that the tcc enhanced the outflow temperature by about 2 c on average while the maximum increase was 3 8 c in mid may which was in turn beneficial for downstream ecology 3 july and august are the test months controlled by hydrodynamic characteristics during this period the static and dynamic pressures applied on the tcc are explored the results suggest that the maximum static pressure difference was 762 3 pa roughly four times the maximum dynamic pressure difference and both of them peak at or near the position of intake in addition the pressure difference on the tcc s right side was greater than that on the left side at the same altitude 4 both the static and dynamic pressure differences increase with stronger stratification the moment on the tcc caused by positive and negative static pressure differences could adversely affect the structure thus this issue should be considered in engineering practice declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the author gratefully acknowledges the support from the national natural science foundation of china grant no 51808168 china postdoctoral science foundation grant no 2020m672132 
2188,stratified water temperature and low temperature outflow water caused by water storage characteristics in deep reservoirs are common practical problems the temperature control curtain tcc is a novel low temperature water treatment technique characterized by a simple structure and low cost in the present paper a new type of flexible tcc scheme is proposed moreover its applicability in engineering is explored by analyzing the thermal structure and hydrodynamic characteristics of the tcc the general notions and theoretical basis of boussinesq approximation for thermal flow are first elaborated then the three dimensional tcc form is obtained through the structural nonlinear analysis method based on vector form intrinsic finite element vfife in addition using a reservoir which is under tcc construction in southwest china as the research object the thermal structure change with and without tcc scenario is observed to evaluate the improvement effect of outflow temperature from april to june lastly taking the flood situation from july to august as the most unfavorable condition the hydrodynamic characteristics are investigated including the static and the dynamic pressures applied on the curtain these preliminary modeling works provide important theoretical references for further engineering operation keywords water temperature stratification temperature control curtain thermal flow thermal structure hydrodynamic analysis data availability data will be made available on request 1 introduction deep reservoirs not only contribute to the spatial distribution of water resources but also have a significant role in shipping farmland irrigation flood storage and power generation as illustrated in fig 1 the impoundment in deep reservoirs and solar radiation bring about a lentic environment and cause the surface water to warm owing to the density difference and low thermal conductivity the heat transfer between the surface and bottom layer of water may be insufficient leading to vertically stable water temperature stratification during the summer he et al 2018a b yang et al 2020 zhang et al 2022 this stratification phenomenon is influenced by seasonal variation reservoir operation conditions impoundment depth as well as other factors azadi et al 2021 duka et al 2021 zhang et al 2022 in general the reservoir water intake is located in the hypolimnion tending to discharge low temperature water during the summer irrigation months tranmer et al 2020 thus long term stratified temperature in reservoirs may cause other ecological problems first this phenomenon may influence the vertical distribution of dissolved oxygen carbon dioxide and bacteria leoni et al 2014 furthermore long term stratified temperature can easily create an acidic environment at hypolimnion resulting in a large amount of precipitation of heavy metal ions and water quality deterioration tranmer et al 2018 xing et al 2018 zhang et al 2021a b zhang et al 2015 zhou et al 2020 lastly the temperature may have a number of adverse effects on the downstream ecology including impacting the reproduction of aquatic organisms matsuura et al 2015 crop reduction zhang et al 2016 and sediment deposition asaeda et al 2001 asaeda et al 1996 elçi 2008 to alleviate the temperature stratification and increase the outflow temperature certain measures are adopted in projects including special reservoir operation he et al 2020 zhang et al 2018 as well as selective withdrawal and avoidance of thermocline sun et al 2014 among these measures selective withdrawal especially multi level intake song et al 2019 and stop log gate kuang et al 2019 zhang and gao 2015 zheng et al 2020 are extensively applied most of the above schemes have strong rigid structures that are extremely durable however such structures need to be designed with reservoirs whose construction cost can be expensive the water in completed reservoirs that are in operation needs to be emptied before constructing selective withdrawal facilities however all of these tasks reduce power generation and cause great economic losses the temperature control curtain tcc is a flexible structure designed for selective withdrawal bohac 1989 compared to traditional schemes the tcc has a much simpler structure lower cost and no influence on reservoir operations he et al 2019 numerous in situ observations and studies have dealt with the outflow temperature improvement effects of tcc through both experiments and numerical simulations vermeyen 2000 used the doppler analyzer and temperature distributor to observe the water retaining performance of three curtains in the whiskeytown reservoir the paper concluded that the curtains effectively prevent water mixing between the hypolimnion and thermocline during the salmon spawning period politano et al 2008 constructed a three dimensional 3d numerical simulation for velocity and temperature distribution in front of the dam in the mcnary reservoir making comparisons with 24 hour in situ observations furthermore shammaa and zhu 2010 examined the flow field change behind the curtain by using particle image velocimetry piv and laser induced fluorescence lif subsequently lian et al 2016 proposed a tcc approach for improving the outflow temperature of deep reservoirs in their paper the researchers proposed three different tcc modes floating suspended and hybrid through reduced scale tests and numerical simulations he et al 2017a b verified that the tcc effectively increases the outflow temperature in addition they also demonstrated a link between the temperature and retaining ratio of the tcc song et al 2020 investigated the influence of different positions outflow flow rates and submerged depths of the tcc on the outflow temperature their results suggested that the installation location of the tcc has little impact on the outflow temperature rather the outflow temperature increased with the increase in outflow rate and the decrease in submerged depth lastly nguyen and wang 2020 showed that the enhancement of permeability does not cause a drop in the outflow temperature on the other hand there is little research on the hydrodynamic characteristics of the tcc sheng et al 2016 suggested that the hydraulic pressure applied to the tcc enhanced with increasing distance between the tcc and the intake declining outflow flow rate and reducing overflow height conversely the change in the water level had little effect on the hydraulic pressure he et al 2017a b observed that a higher flow rate was associated with a higher dynamic pressure difference and a stronger temperature stratification subsequently he et al 2018a b also analyzed the pressure variation law under different inclination ratios arc length ratios and water retaining ratios of the tcc without temperature stratification moreover lian et al 2020 proposed that the water retaining ratio of the tcc has the greatest effect on the pressure in addition the researchers determined that the resistance coefficient of the tcc increased exponentially with the increase in the water retaining ratio twice with the increase in the area ratio and linearly with the increase in the inclination ratio as the evolution of the tcc and its effect on the flow field are complex notions most studies have presented the tcc as a vertical plate or arc plate in numerical simulations however such a presentation deviates from the actual situation thus a new flexible tcc scheme based on the existing research is proposed in this paper after obtaining the 3d form of the tcc the feasibility and effectiveness of the novel tcc scheme in engineering practice are explored specifically with respect to the thermal structure and hydrodynamic characteristics 2 materials and methods 2 1 study area the research object is a high dam with a large reservoir situated in southwest china the dam is primarily used for power generation while also having benefits such as flood control and irrigation the basin area covers 11051 km2 while the storage capacity is 3 748 billion m3 moreover the normal water level is 475 m the starting regulation level is 447 m and the dead water level is 425 m lastly the altitude of the water intake floor is 408 m while the maximum dam height is 185 5 m typical of a deep reservoir due to the great depth there is thermal stratification in front of the dam along the vertical direction fig 2 a and fig 2 b depict the monthly average water temperature distribution and monthly water level between 2018 and 2020 fig 2 a illustrates that the temperature has a stable stratification and that the water temperature between 440 m and 470 m is the highest also known as epilimnion the temperature within this layer varies between the seasons gradually increasing from may to august it begins to decline in september and reaches the lowest point in march the following year furthermore because the temperature gradient between 380 m and 440 m is the largest this layer is defined as thermocline the temperature gradient in the thermocline is more than 0 2 c m from may to october on the other hand the gradient is relatively small between november and april below 380 m i e hypolimnion the temperature is stable at 8 c to 10 c throughout the year fig 2 b shows that the water level from february to june is lower compared to other months 2 2 flexible tcc scheme fig 3 depicts the overall scheme of a flexible tcc the components of the novel tcc are the anchoring system curtain made of impervious geotextile horizontal and vertical cables composed of dyneema ropes upper and lower strings combined floating tanks a main cable and fixed height towers the functions of these various parts are as follows 1 fixed height towers the main cable and combined floating tanks the hollowed towers are embedded on the riverbank at a constant altitude of 455 m the floating tanks within the tower slide through vertical chutes and remain on the water surface this design enables the tcc to automatically adjust its form in response to water level variation as shown in fig 4 this design reduces the mechanical operations and force placed on the main cable and tower improving the structural flexibility and safety bohac 1989 he et al 2017a b the main cable is connected to the floating tanks within the tower and is prestressed in advance lastly the combined floating tanks are attached to the main cable so that the latter always floats on the water for maintenance 2 major structure the major structure of the tcc comprises the upper and lower strings the horizontal and vertical cables composed of dyneema ropes and a curtain made of impervious geotextile it is more elaborate than previous schemes as shown in table 1 the vertical string top ends are attached to the main cable while its bottom ends are connected to the anchoring system the geotextiles are coupled with strings through sleeve holes and thus produce a flexible water blocking structure furthermore the height between the upper string and the main cable is defined as the outflow height which directly impacts the outflow temperature the horizontal string improves the constraint effect on the geotextiles thus also improving the structure s overall stability as shown in fig 5 the string also increases the force transmission path of the geotextile thus better realizing the multi point distribution of the tcc force the presence of the upper string lessens the disruption induced by the flow to the tcc and guarantees structural integrity on the other hand the lower string accelerates the speed of the tcc sinking into the water during installation 3 anchoring system the anchoring system which is fixed to the riverbed connects the vertical cables at the bottom to maintain the tcc s overall stability under hydrodynamic load the design uses either gravity or underwater anchor piles with a large bearing capacity 2 3 methodology 2 3 1 governing equations with respect to the viscous flow considering temperature field the equations of the rng k ε turbulence model are as follows 1 ρ t ρ u i x i 0 2 ρ u i t u j ρ u i x j p x i x j μ u i x j x j μ t u i x j u j x i 2 3 ρ k μ t u i x i δ ij ρ g i 3 ρ c p t t x i ρ u i c p t x j k t x i s e 4 ρ k t ρ u i k x i x j μ μ t σ k k x j p k ρ ε 5 ρ ε t ρ u i ε x i x j μ μ t σ ε ε x j c 1 ε ε k p k c 2 ε ε 2 k ρ 6 μ t ρ c μ k 2 ε 7 p k μ t u i x j u j x i u i x j 8 c 2 ε c 2 ε c μ η 1 η η 0 1 β η 3 in the equation above ρ represents the fluid density while u denotes the velocity in the x y z direction next p represents the pressure while μ denotes the dynamic viscosity and c p denotes the specific heat at constant pressure the symbol κ represents the coefficient of thermal conductivity and s e denotes the source term for internal heat lastly k represents the turbulence intensity and ε denotes energy dissipation rate η s k ε and s 2 s ij s ij σ k 0 07194 σ ε 0 07194 are turbulent prandtl numbers while c μ 0 0845 c 1 ε 1 42 c 2 ε 1 68 η 0 4 38 and β 0 012 are the empirical constants for low mach number flows the above equations may be simplified into an incompressible form furthermore in the present examples with mild thermal expansion effect the boussinesq approximation may also be adopted ferziger et al 2020 mayeli and sheard 2021 the precondition for applying the boussinesq approximation is that the density variation induced by thermal effects is much smaller than the reference density of the fluid i e δ ρ ρ this guarantees that the thermal expansion will be approximately described by a buoyancy term in the momentum equation the equation for the linear variation of density with temperature is given below 9 ρ ρ 0 1 β t t 0 g 2 3 2 research data the topographic data used in the numerical simulation represent the observed dem data with a resolution accuracy of 30 m hydrological data obtained between january 2020 and december 2020 were used herein including inflow and outflow discharge and water level moreover the annual water temperature distribution in 2020 was used which was recorded 1 52 km in front of the dam every 10 days the discharge water temperature was recorded at the inlet as shown in fig 6 the calculated outflow temperature was acquired by probes placed in the center of every diversion pipe s end 2 3 3 models 2 3 3 1 model description flow 3d is a high performance cfd software developed by the flow science corporation it effectively simulates free surface and multiphase flow the software s accuracy and reliability have been demonstrated in numerous hydraulic engineering instances aydin et al 2022 behroozi and vaghefi 2022 gadhe et al 2022 the 3d hydrodynamic and water temperature model is based on flow 3d after modeling the 3d terrain main dam auxiliary dam intake conveyance conduits and other buildings the structured mesh is created with a computational layout of 1420 m 1260 m fig 6 the tcc with a thickness of 1 cm is situated 200 m in front of the water intake the mesh refinement is implemented in flow fields where the velocity is relatively high i e in the flow field between the tcc and the intake boundary outlet the designated flow rate functions as the upstream inlet boundary while the pressure boundary condition with a specified water level is defined as the downstream outlet boundary situated at the diversion pipes ends the free surface is a rigid cover set as a symmetrical boundary lian et al 2020 while the riverbed is a non slip wall boundary li et al 2019 li et al 2020 the initial temperature field is fitted through the user defined function by piecewise linear interpolation of the water temperature distribution in addition the water flows into the intake and square funnel section 8 m 8 m and gathers at the diversion pipe with a 7 m diameter and 30 m length the tcc is subjected to water pressure in the river causing rigid body displacement and elastic deformation with a high degree of geometric nonlinearity the traditional finite element method has certain limitations when faced with the large structural deformation problem on the other hand the vector form intrinsic finite element vfife method is highly reliable and efficient when dealing with such nonlinear problems wu et al 2020 yu et al 2021 in this paper the 3d shape of the tcc the outflow temperature and 3d distribution of pressure difference are obtained by combining the vfife method and flow 3d fig 7 illustrates the solving flow of vfife and flow 3d interaction the initial spatial form of the tcc is the conical surface due to superior load bearing capacity and more convenient construction which is based on previous research results zhang et al 2021a b the tcc is first modeled and imported into the flow 3d as a baffle while the initial pressure p is obtained by calculation the deformation and internal force f are further resolved by the vfife method in addition it is essential to determine whether the imbalance force composed of internal and external force is less than the error limit δ if the imbalance force is greater it continues to update the pressure and solve the structural deformation and internal force until its value becomes less than the error limit 2 3 3 2 model validation to verify the feasibility of the applied numerical model a comparative analysis is conducted between the calculated outflow temperature and measured outflow temperature three practical models are used herein to evaluate model performance including root mean square error rmse the nash sutcliffe efficiency coefficient nse and the rmse observations standard deviation ratio rsr golmohammadi et al 2014 the model is considered to be acceptable if nse 0 50 and rsr 0 70 moriasi et al 2007 10 rmse i 1 n y i obs y i sim 2 n 11 nse 1 i 1 n y i obs y i sim 2 i 1 n y i obs y mean 2 12 rsr i 1 n y i obs y i sim 2 i 1 n y i obs y mean 2 in the above equation n represents the total number of observations while y i obs denotes the i th observed value y i sim represents the i th simulated value and y mean denotes mean of the observed data fig 8 indicates that the calculated values fit well with the measured values with a maximum discrepancy of less than 1 5 c since atmospheric heat exchange and solar radiation are not considered in the numerical simulation the above discrepancy is acceptable the rmse value is 0 609 c nse value is 0 981 and rsr value is 0 491 these measurements demonstrate that the applied temperature model accurately simulates both the temperature distribution and outflow temperature 2 3 3 3 mesh sensitivity analysis the numerical results are often influenced by mesh size herein three different mesh sizes are examined to determine their sensitivity the initial scenario is taken to be mid august with 870 m3 s flow rate as the velocity gradient is considerable along the flow direction and has a relationship with dynamic pressure the velocity distribution at 5 m in front of the tcc is chosen as the comparison index in this study table 2 provides the total mesh number and averaged outflow temperature furthermore fig 9 illustrates the velocity distribution at 5 m in front of the tcc and temperature distribution behind the tcc the outflow temperature and velocity both begin to vary as the mesh number increases while the temperature distribution behind the tcc remains unchanged thus the increase in the mesh number within a certain range has a limited influence on the results based on the numerical accuracy and computational efficiency 0 9 million is taken as the final total mesh number in this paper 2 4 model scenarios to further verify the applicability of the tcc scheme a number of test conditions are selected in this paper which are all shown in table 3 as april may and june are part of an essential season for the reproduction of aquatic species and agricultural irrigation they are taken as the test months controlled by the outflow temperature furthermore as the reservoir s flow rate reaches the maximum at 870 m3 s in july and august potentially exerting great pressure on the tcc these two months are selected as the test months controlled by hydrodynamic characteristics the water level between april and june is 450 m while that between july and august is 475 m fig 10 depicts the temperature stratification under various selected circumstances the condition sequence in table 3 and in the follow up discussion is based on the stratification intensity which is in turn dependent on the temperature gradient in the thermocline a higher temperature gradient is related to a stronger stratification 3 results and discussion 3 1 flow field the flow characteristics and temperature stratification analysis are conducted from the cross section within the central axis of the tcc fig 11 suggests that even if the temperature stratification is different during each month the flow characteristics remain similar with two main streams the first stream is located at the epilimnion it maintains horizontal flow in front of the tcc submerges swiftly after passing through the tcc and finally resumes its horizontal flow on the other hand the second stream is situated at the hypolimnion its flow behind the tcc is similar to the jet flow with a quick rise in velocity because the bottom of the tcc is not entirely sealed these two major streams merge and flow into the intake behind the tcc the velocity between 350 m and 430 m gradually drops because of the tcc s blocking effect potentially causing backflow without the tcc there would be only one mainstream situated in front of the dam because of the withdrawal effect whose elevation is from 380 m to 430 m furthermore in this case the maximum velocity would be less than that with the tcc the flow characteristics of different months are generally similar with and without the tcc 3 2 thermal structure the thermal structure is influenced by the different flow patterns both in front of and behind the tcc fig 12 illustrates that the temperature difference between the front and back of the tcc is more significant when the stratification is more intense furthermore the water present behind the tcc at 415 m to 445 m quickly warms up due to the inflow of surface high temperature water its temperature is thus higher than that of water in front of the tcc at the same altitude since the jet flow at the bottom of the tcc causes an uplift of low temperature water the water temperature between 380 m and 400 m is lower than the water temperature in front of the tcc furthermore the confluence of high temperature and low temperature water contributes to a thin thermocline with a large temperature gradient at the altitude of 410 m in addition stronger stratification is related to a greater temperature gradient table 4 depicts the outflow temperature under different test conditions both with and without the presence of the tcc although a small portion of low temperature water flows into the intake the flexible tcc can still improve the outflow temperature by an average of 2 c and a maximum of 3 8 c in mid may which is beneficial for the downstream ecology 3 3 hydrodynamic characteristics the non uniform density distribution is induced by the thermal structure with the density differences in front of and behind the tcc as the main contributors to the generated static pressure fig 13 and fig 14 illustrate the spatial distribution of the static pressure difference and temperature difference these two results exhibit the same variation trend the temperature difference is the largest at the intake altitude 410 m reaching 5 4 c during mid july thus contributing to the maximum positive static pressure difference of 762 3 pa moreover because of the uplift of low temperature water the density at the back of the tcc is higher than in front of it thus resulting in a negative static pressure difference the maximum negative pressure difference is measured at 290 pa when viewed together with fig 6 the static pressure difference on the right side of the tcc is greater than that on the left this phenomenon is due to the fact that the right side of the tcc is closer to the intake meaning that more water from the right side flows into the intake making water mixing more thorough fig 15 illustrates the vertical distribution of the static pressure difference under different test conditions the maximum positive pressure difference increases while the maximum negative pressure difference decreases with stronger stratification the positive and negative static pressure difference exerts a forcing moment on the tcc enabling it to deform and move downstream however this deformation and displacement may adversely affect the tcc structure and should be seriously considered in engineering practice moreover the non uniformity of the velocity field induces the dynamic pressure difference fig 16 illustrates the spatial distribution of the dynamic pressure difference with a decline in altitude the dynamic pressure difference rapidly increases and reaches a maximum of 185 7 pa near the intake about 408 m in front of the tcc the velocity decreases due to the blocking effect of the tcc conversely the velocity at the back of the tcc is higher than that in front of tcc on account of the withdrawal effect in addition the tcc structure will also move downstream under the influence of the dynamic pressure difference below 408 m this difference will gradually weaken and remain stable at 380 m and below the dynamic pressure difference on the right and left sides shows a similar pattern to that of the static pressure difference fig 17 illustrates the vertical distribution of the dynamic pressure difference under different test conditions in the case that the stratification becomes more considerable the maximum dynamic pressure difference will increase because high temperature water with low density is affected more easily by the intake the maximum difference of dynamic pressure is measured to be 35 7 pa in sum the static pressure difference applied to the tcc is four times the dynamic pressure difference thus the influence of the static pressure difference should be considered during project design 4 conclusions in this paper a new kind of flexible temperature control curtain tcc is presented and its influence on outflow temperature improvement and hydrodynamic characteristics during different months is evaluated the main conclusions are presented below 1 first an innovative scheme of flexible tcc is proposed herein which is capable of automatically adjusting the tcc form with water level variation compared to previous schemes this design offers higher security and flexibility 2 april may and june were selected as the test months controlled by outflow temperature based on temperature stratification the improvement of outflow temperature is investigated after establishing the tcc in nine conditions the results suggest that the tcc enhanced the outflow temperature by about 2 c on average while the maximum increase was 3 8 c in mid may which was in turn beneficial for downstream ecology 3 july and august are the test months controlled by hydrodynamic characteristics during this period the static and dynamic pressures applied on the tcc are explored the results suggest that the maximum static pressure difference was 762 3 pa roughly four times the maximum dynamic pressure difference and both of them peak at or near the position of intake in addition the pressure difference on the tcc s right side was greater than that on the left side at the same altitude 4 both the static and dynamic pressure differences increase with stronger stratification the moment on the tcc caused by positive and negative static pressure differences could adversely affect the structure thus this issue should be considered in engineering practice declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the author gratefully acknowledges the support from the national natural science foundation of china grant no 51808168 china postdoctoral science foundation grant no 2020m672132 
2189,predicting the matrix permeability of subsurface sandstone aquifers is a formidable challenge one test showing great promise is nuclear magnetic resonance nmr as it is the only advanced hydrogeophysical technique non invasively measuring subsurface pore structure information and being applied in downhole well log analysis with core calibration unfortunately the classical nmr based permeability models suffer from more than two empirical constants that limit prediction accuracy greatly in this study a nmr data driven method was reported with nine machine learning models results indicate that the type of input data strongly influences the machine learning modeling of matrix permeability using the cumulative t 2 relaxation data instead of the original t 2 data a stronger agreement was found between experimental results and nmr estimates of matrix permeability from the gradient boosting decision tree model automatically tuned by gridsearchcv the correlation coefficient reaches 0 92 with the lowest mse of 0 12 due to the nature of black box of machine learning model the visualization and interpretation of the optimal model were performed through the shapley additive explanations method the 38th variable of 501 ms in the cumulative t 2 spectrum positively contributes the most to the matrix permeability however the 26th variable of 31 6 ms provides the largest negative contribution to the final predicted matrix permeability this work aims to provide a new idea to the from curve to value prediction process for a rapid and accurate matrix bedrock permeability estimation via nmr t 2 data in deep sandstone aquifers and extensive porous rocks keywords matrix permeability nuclear magnetic resonance t 2 spectrum data driven machine learning sandstone aquifer data availability data will be made available on request 1 introduction accurately estimating matrix bedrock permeability k m2 in deep sandstone aquifers is of great significance for mining safety modeling contaminant diffusion and distribution clarifying the contribution of fractures to flow and geological carbon storage gcs li and benson 2015 reynolds et al 2018 xu et al 2020 ma et al 2021 saraf and bera 2021 gholami and raza 2022 however predicting k of sandstone aquifers with extensive variability is inherently a difficult task urang et al 2020 talebmorad and ostad ali askari 2022 generally the permeability of aquifers is characterized by multiscale effects and heterogeneity desbarats and bachu 1994 schulze makuch et al 1999 rogiers et al 2014 for heterogeneous karst media formed in carbonate aquifers the volume permeability increases with the observation scale worthington 2009 dissolution and tectonic related fractures enhance the permeability of aquifers and induce a preferential flow of groundwater resulting in self organized permeability worthington and ford 2009 worthington et al 2016 currently different experimental testing methods are employed for different scales of permeability providing different perspectives on the spatial variability of permeability including pumping tests electromagnetic flow meter logging and core permeability measurements the pumping test is the volume permeability of the full thickness approximately 50 m the flowmeter tests effective permeability at the mid scale 2 to 9 m core permeability measurement provides reliable matrix bedrock permeability data at the smallest measurement scale 0 1 m sub meter scale pavelic et al 2006 cardiff et al 2012 zhu et al 2022 however for deep sandstone aquifers without fractures permeability is dominated by intergranular flow namely the pore scale k becomes progressively dominant with a huge lithostatic load e g buried depths greater than 2 000 m medici et al 2018 deep sandstone aquifers are generally considered to represent porous media characterized by a permeable matrix in unfaulted areas only a minor contribution to permeability is provided by bedding plane fractures medici et al 2016 additionally as a classical procedure pumping test data as a function of time suffer from non uniqueness owing to the potential physical or conceptual limitations where the interpretations reflect macroscopic contribution of large volume porous media small scale structural changes and heterogeneity that may be essential to effectively solve hydrological issues are lost de lima and niwas 2000 in relatively homogeneous strata small volume k can provide a reasonable estimate of the characteristics of bulk aquifers which would be valuable in the absence of data from larger scale experiments for example the k of a small core or core plug size sample can be compared with formation scale values obtained from pumping tests to estimate the effect and contribution of secondary porosity such as fractures and pipes on aquifer volume permeability maliva 2016b worthington 2022 therefore the prediction of matrix permeability is highly urgent for studying the hydraulic characteristics of deep sandstone aquifers methods to obtain matrix permeability fall into three categories 1 direct core measurements based on darcy s law 2 pore scale simulation and 3 inversion or indirect calculation sahimi 2011 maliva 2016a vogelgesang et al 2020 direct core measurements have some inherent limitations such as sampling bias and low coring recoveries for unconsolidated rocks such as sediments and soils the partial sampling bias barlebo et al 2004 combined with the limited sampling number can lead to an underestimation of the effective permeability of aquifers by a factor of nearly 50 pavelic et al 2006 as a small volume technique core analysis captures fine scale heterogeneity in k but provides data that is often not representative of the effective permeability for large scale aquifers the depositional conditions of sandstone aquifers can result in strong vertical heterogeneity of permeability such as the small scale stratifications with k varying by a factor of 10 to 100 swanson et al 2006 for deep aquifers the continuous in situ coring to obtain high resolution k profiles is expensive and unrealistic pore scale simulations provide a dynamic view at the micro scale but have high computational costs and limited sample size liu et al 2016 overcoming the limitations of core testing and simulation the advanced geophysical method nuclear magnetic resonance nmr provides point by point high resolution vertical formation information such as porosity and pore size distribution in which aquifer hydraulic parameters such as k are well reflected behroozmand et al 2015 zhao et al 2017 wang et al 2018 pehme et al 2022 as reviewed by slater 2007 nmr may in the future significantly advance the science of estimating k from geophysical measurements nmr is currently the only technique available that specifically measures water content and estimates k in situ without the active use of nuclear sources nmr measurements provide insights into in situ hydrogeological conditions that are difficult to achieve or explain with other downhole and or core measurements pehme et al 2022 nmr logging can complement core measurements by placing core testing in a broader context predicting aquifer parameters from geophysical data is perhaps the most important goal of the emerging field of hydrogeophysics lesmes and friedman 2005 vogelgesang et al 2020 however although nmr provides a wealth of hydrological information there are two widely used classical theoretical models for evaluating k based on nmr data the timur coates model and schlumberger doll research sdr model timur 1968 dlubac et al 2013 two models all contain no less than three empirical constants and require the determinations of bound water saturation and cut off value of the nmr t 2 spectrum which often introduces unacceptable errors for k ren et al 2019 fortunately data driven methods have brought new insights and opportunities for evaluating k using nmr data in recent years machine learning techniques have been widely used in subsurface aquifer analysis in solving flow equations pollutant transport salinity mapping permeability and hydraulic conductivity etc rabbani et al 2020 sahour et al 2020 tahmasebi et al 2020 tahmasebi and sahimi 2021 ostad ali askari 2022b machine learning has demonstrated its ability to handle multi scale and data information which provides opportunities to cope with complex problems such as fine scale k in hydrological sciences bao et al 2020 ostad ali askari and shayan 2021 ostad ali askari 2022a applied to predict k the machine learning model utilizes linear and nonlinear regressions to discover the intrinsic correlations between input parameters reflecting flow such as pore grain structure parameters rock composition content and permeability these inputs tend to have lower acquisition costs and higher data volumes depending on the source of the input machine learning methods for evaluating k can be divided into two broad categories 1 cnns based on 2d 3d pore images rabbani et al 2021 tang et al 2022 and 2 parametric regression for the parametric regression using the k related structure parameters machine learning instead of pedotransfer functions is successfully used to model soil permeability araya and ghezzehei 2019 singh et al 2020 rios et al 2011 developed a partial least squares regression technique for the permeability of carbonate rocks with acceptable errors using the original t 2 data by combining the classification with regression the sequential minimal optimization smo based two nearest neighbor model was proposed for estimating permeability in the carbonate systems using t 2 data plastino et al 2017 therefore predicting k in sandstone aquifers using a small number of core tests combined with nmr has become an encouraging research goal additionally it is difficult to quantify the contribution of inputs in the modeling k owing to the black box nature of the machine learning models the primary objective of this study is to investigate the performance of nmr data driven methods for matrix permeability prediction in sandstone aquifers firstly cores from different depths and formations in different regions are collected and tested in the laboratory furthermore the influences of two input t 2 data types original and cumulative on predicting k from the machine learning models are investigated finally the optimal machine learning model is visualized and interpreted to reveal the prediction process meanwhile a comparative analysis is conducted to evaluate two techniques including the nmr data driven method and the classical theoretical models in predicting k 2 methodology to eliminate the influences of different groundwater properties for comparing the flow capacity of samples from different regions the inherent permeability k m2 was uniformly used instead of hydraulic conductivity k m d if the fluid properties dynamic viscosity coefficient and density of groundwater are available in one formation k can be easily converted to k the regression methods commonly include three categories namely linear regression algorithms tree regression techniques and boosting methods linear regression is a statistical analysis method that uses regression analysis by the generalized least squares tree regression and boosting algorithms are both nonlinear regression methods which eliminate the collinearity of independent variables the nmr t 2 data and the core based measured k data are used to establish prediction models of matrix k besides five validation indicators are employed to compare the accuracy of each developed model 2 1 nmr tests an nmr core analyzer typed by corespec 1000 us numar company was used to capture the t 2 signal of water saturated sample nmr experiments were carried out at room temperature 28 c with an operating frequency of 2 mhz up to 4096 cpmg echoes were collected from a single pulse train the parameter of echo interval was set as 0 2 ms in this study firstly a sandstone core was processed into the core column with a diameter of 2 5 cm and a length of 2 5 cm the core matrix porosity matrix permeability dry weight wet weight and volume density were measured in the laboratory after cleaning and drying after the echo data were collected the multi exponential inversion process was carried out to invert echo trains data and obtain transversal t 2 relaxation using the nonnegative least squares method dunn et al 2002 ge et al 2017 2 2 algorithm descriptions in this section the utilized algorithms are briefly described which include 2 2 1 models using linear regression as kernel functions 1 linear regression lr the simple theoretical description of the linear model is as follows for data set d x i y i i 1 m x i x i 1 x i 2 x id y i r m is the number of samples and d is the number of input variables the lr model is expressed as 1 f x i ω t x i b where ω t represents the coefficient matrix f x i is the predicted value and b represents a constant the ε i represents the error between f x i and the true value y i thus 2 y i ω t x i ε i if ε i follows a gaussian distribution which can be expressed as 3 p ε i 1 2 π σ e x p ε i 2 2 σ 2 substituting eq 2 into eq 3 then 4 p y i x i ω 1 2 π σ e x p y i ω t x i 2 2 σ 2 introducing the like hood function l ω then 5 l ω i 1 m p y i x i ω i 1 m 1 2 π σ e x p y i ω t x i 2 2 σ 2 taking the logarithm on both sides of the eq 5 6 l ω i 1 m l o g 10 1 2 π σ exp y i ω t x i 2 2 σ 2 m l o g 10 1 2 π σ 1 2 1 σ 2 i 1 m y i ω t x i 2 finally the objective function j ω can be expressed as 7 j ω 1 2 i 1 m y i ω t x i 2 1 2 y i ω t x i t y i ω t x i 2 lasso regression lasso is an effective model based on linear regression with l1 regularization which is expressed as 8 min ω b f ω b 1 m i 1 m ω x i b y i 2 λ ω 1 3 ridge regression using the tikhonov regularization the ridge regression model is developed based on traditional linear regression the model is derived as 9 min ω b f ω b 1 m i 1 m ω x i b y i 2 λ ω 2 2 2 2 2 models using regression tree as kernel functions 1 decision tree classification and regression trees cart are used as the basis of tree models the generation of the decision tree is the process of recursively constructing a binary decision tree the mean squared error minimization criterion is used for the regression tree to generate a binary tree by feature selection in regression issues by selecting the optimal segmentation variable j and the segmentation point s 10 min j s min c 1 x i r 1 j s y i c 1 2 min c 2 x i r 2 j s y i c 2 2 where r 1 j s x x j s r 2 j s x x j s r m is the divided input space c m 1 n m x i r m j s y i x r m m 1 2 refers to the output value reflecting r m for all the values of j the minimum value is obtained by scanning the segmentation point s the decision tree is obtained by dividing the input space into r 1 r 2 r 3 r m 11 f x m 1 m c m i x r 2 extra tree regression etr using multiple decision trees as indicators the extra tree regression is developed which belongs to an ensemble method for supervised regression issues marée et al 2004 sagi and rokach 2020 okoro et al 2021 the main idea of etr follows the classic top down procedure in which numerous regression trees are created being different from other tree based models etr separates nodes by selecting cut points randomly and developing the tree using the entire learning sample after the forecasts of multiple decision trees the prediction of the final result is obtained based on the arithmetic average the tree based structure was stated in detail by seyyedattar et al 2020 3 random forest rf rf is an ensemble method based on the decision tree random subspace and bootstrap aggregating consisting of multiple decision trees breiman 2001 rf shows many advantages in regression problems for example rf is considered as a good method for dimensionality reduction because it has a good processing ability for high dimensional data sets in addition the model can output the importance of features in the regression process moreover it can be used to deal with the problem of data missing directly without normalization the details of rf can be found in the published works breiman 2001 2 2 3 models using boosting algorithms based on regression tree boosting also known as the enhanced learning or lifting method is a kind of important ensemble learning technology boosting can be randomly surmised slightly with higher prediction accuracy than that of weak learning enhancement study which provides effective new ideas and new methods for machine learning methods freund et al 1999 schapire 1999 cai et al 2020 zounemat kermani et al 2021 1 adaptive boosting adaboost as an effective machine learning model using the boosting idea the adaptive boosting regression integrates multiple weak predictors to establish a stronger predictor freund et al 1999 in the process of model training the weight of the base learners with the small error is increased and the base learners with large errors are reduced through multiple iterations the optimal model is obtained the derivation of the model was presented in many publications zhao et al 2019 wang et al 2022 2 gradient boosting decision tree gbdt gbdt as an iterative cart based forward algorithm commonly consists of several hundreds of carts during the training process gbdt builds a learner that reduces the loss along the direction of the largest gradient to improve the existing model in each iteration as the iterations increase the loss keeps decreasing and the number of carts keeps increasing finally the prediction values from all of the carts are accumulated to provide the final output 1 weak learner for data set d x 1 y 1 x 2 y 2 x n y n with n samples the regression loss function uses mean square error which can be written as l y i f x i 1 2 y i f x i 2 the weaker learner f x γ is expressed as 12 f 0 x argmin γ i 1 n l y i γ where γ is the weight vector of features which needs to be determined by training 2 training the negative gradient of l y i f x i for the i th sample in the t th iteration is expressed as 13 r it l y i f x i f x i f f t 1 where t represents the times of iterations which ranged from 1 to the maximum iteration of t r jt j 1 2 j t is the leaf node region corresponding to the new regression tree which corresponds to the leaf node area r tj j 1 2 j t where j represents the number of leaf nodes for the i th sample in each leaf node the best fitting value is expressed as 14 γ it argmin γ x i r jt n l y i f t 1 x i γ then the cart fitting function for the t th iteration 15 f t x f t 1 x j 1 j t γ jt i x r jt 3 strong learner 16 f x f t x f 0 x ν t 1 t j 1 j γ jt i x r jt where ν is a hyperparameter where the smaller ν indicates the more iterative number 3 extreme gradient boosting xgboost 1 initial model the data set d x i y i x i r m y i r contains n samples with m features after the total of k iterations the objective function l y f k x is defined as 17 l y f k x i 1 n l y i y i k 1 k ω f k where l y i y i is the loss function ω f k is the regularization term f k is the k th cart y i y i are the true and predicted values of the i th samples respectively 2 optimizing l y f k x the predicted value y i k in the k th iteration is calculated as the sum of the predicted results y i k 1 by the k 1 times iterations and the predicted result f k x i of the k th iteration 18 y i k k 1 k f k x i y i k 1 f k x i according to the second order taylor series combining eq 18 with eq 17 then 19 l k y f k x i 1 n g i f k x i 1 2 h i f k 2 x i ω f k i 1 n l y i y i k 1 k 1 k 1 ω f k where g i y i t 1 l y i y i t 1 h i y i t 1 2 l y i y i t 1 are the first and second derivative forms of l y i y i concerning y i k 1 respectively rearranging eq 19 then 20 l k y f k x i 1 n g i f k x i 1 2 h i f k 2 x i ω f k the predicted value from the cart f x is obtained as 21 f x ω q x where q x indicates the leaf node location of sample x the ω is the score of leaf node combined eq 21 with eq 20 then 22 l k y f k x i 1 n g i ω k q x i 1 2 h i ω k q x i 2 ω f k the l2 normalization is adopted to avoid the over fitting effect which is calculated as 23 ω f k γ t k 1 2 λ j 1 t k ω k j 2 where t k represents the leaf node number two hyperparameters γ λ are contraction and penalty coefficients respectively 3 strong learner substituting eq 23 into eq 22 then 24 l k y f k x j 1 t k g j ω k j 1 2 h j λ ω k j 2 γ t k where g j i i j g i h j i i j h i the derivative of ω k j is used to find the minimum l k y f k x as 25 ω t j g j h j λ 26 l k y f k x 1 2 j 1 t k g j 2 h j λ γ t k thus y i k can be calculated as 27 y i k k 1 k f k x i y i k 1 f k x i a strong learner can be expressed as 28 l y f k x y i 0 k 1 k j 1 t k ω k j 2 3 gridsearchcv optimization machine learning models commonly have multiple hyperparameters that affect the performance of the models therefore tuning hyperparameters is of great significance to optimization of objective function gridsearchcv is an effective tool for finding the optimal hyperparameters of machine learning models the core structure of gridsearchcv consists of two parts including gridsearch and cross validation firstly in the grid search process every hyperparameter was assigned a specific value which is a sequence of arithmetic numbers within a specified interval and then in the process of cross validation numerous models were obtained and every model s performance was compared by k fold cross validation when all values of hyperparameters in the given interval were tried the optimization of objective function was achieved using specific hyperparameter values grid search for specific hyperparameter values is probably the simplest and most widely used hyperparameter search algorithm which determines the optimal value by finding all the points in the search range if a large search range and a small step size are used grid search has a high probability of finding the global optimal value 2 4 accuracy verification indicators verifying the predicted results of the machine learning methods is one of the key steps as such five error indicators were computed for each model after the prediction including mean absolute error mae mean squared error mse root mean squared error rmse correlation coefficient r 2 and explained variance score evs five error indicators indicated the prediction accuracy of results and the performances of different machine learning models the theoretical expressions used are shown as follows 29 m s e 1 m i 1 m y i f i 2 30 r m s e 1 m i 1 m y i f i 2 31 m a e 1 m i 1 m y i f i 32 e v s 1 v a r y i f i v a r y i 33 r 2 1 i 1 m y i f i 2 i 1 m y i y i 2 where m is the number of total samples i refers to the number of a specific sample y i is the true value f i represents the predicted value 2 5 shapley additive explanations shap shap is a machine learning interpretation tool based on cooperative game theory which is a model ex post interpretation method shap s core idea is to calculate the marginal contribution of features to model output and then explain the black box model from the global and local levels marginal contribution is introduced into shap which is used to measure the contribution of one feature to model s prediction results in the shap method the final predicted result is expressed as the sum of all shap values in the interpretation of machine learning models 34 y i y b a s e v a l u e f x i 1 f x i 2 f x i 3 f x ik where f x ik is the shap value of the k t h feature of the sample x i when f x ik 0 it means that this feature improves the predicted value and has a positive effect on the contrary it shows that this feature makes the predicted value decrease and has a reverse effect 2 6 workflow the complete workflow for predicting matrix permeability of deep sandstone aquifers starting from the procedure of data collection to model validation is shown in fig 1 firstly both nmr and petrophysical tests were conducted the original t 2 data with 51 bins were obtained from the original echo data secondly the cumulative version of t 2 data was generated fig 1a two categories of t 2 relaxation data were used as inputs to train different models including the t 2 original data with 51 bins and cumulative t 2 data with 51 variables automatic tuning was introduced into the model training procedure the boosting models were optimized by adjusting key hyperparameters including max depth learning rate and n eatimators fig 1b finally five indicators of validation were used to evaluate the performances of trained machine learning models eqs 29 to 33 3 results 3 1 data collection and processing to overcome the narrow k range caused by the nonrepresentative sampling a total of 132 sandstone cores from several sandstone aquifers at different depths regions and geological ages were collected as much as possible the depths cover from 1 222 00 m to 4 020 00 m focusing on formations of neogene and paleogene the specific sampling backgrounds are 1 11 cores huangliu formation miocene neogene in dongfang df region yinggehai basin with depths ranging from 2 862 00 m to 3 091 00 m 2 12 cores huangliu and meishan formations miocene neogene in lingshui ls region qiongdongnan basin from 3 091 55 m to 3 345 10 m 3 16 cores sanya formation miocene neogene in songtao st region qiongdongnan basin from 2 269 50 m to 2 981 60 m 4 33 cores zhuhai and zhujiang formations miocene neogene and oligocene paleogene in wenchang wc region pearl river mouth basin depth from 1378 88 m to 3817 00 m 5 18 cores oligocene eocene paleogene liushagang and weizhou formations wushi ws region beibuwan basin from 1 222 00 m to 3 891 50 m 6 32 cores liushagang and weizhou formations eocene paleogene in weizhou wz region beibuwan basin from 2 266 00 m to 3 686 75 m 7 10 cores meishan and enping formations miocene neogene oligocene paleogene in yacheng yc region qiongdongnan basin from 3 429 99 m to 4 020 00 m all the cores were tested by petrophysical measurements and nmr experiments two sets of nmr t 2 relaxation data were obtained and used for constructing the matrix permeability models in two scenarios including using t 2 relaxation data with 51 original bins scenario 1 and cumulative t 2 data with 51 variables scenario 2 the mathematical matrix of input data is expressed as x 132 51 and x 132 51 respectively which both have 132 samples with 51 variables 1 original t 2 relaxation data by the inversion of echo data t 2 relaxation data t 0 1 t 0 13 t 0 16 t 10000 were obtained with 51 bins logarithmically distributed between 0 1 ms and 10 000 ms in the model construction the 51 variables were renamed as x 1 x 2 x 3 x 51 for a better comparison with the cumulative t 2 relaxation data named as x 1 x 2 x 3 x 51 2 cumulative t 2 relaxation data on the other hand the cumulative data set contains 51 variables x 1 x 2 x 3 x 51 which were produced by cumulating the t 2 relaxation data to explore if such a representation of data can lead to enhance the differences between t 2 spectra to providing a more accurate k prediction the accumulation method is expressed as follows x 1 t 0 1 x 2 t 0 1 t 0 13 x 3 t 0 1 t 0 13 t 0 16 35 x 51 t 0 1 t 0 13 t 0 16 t 7940 t 10000 matching the nmr data with the k data the full data set was developed and subsequently divided randomly into training 80 and testing 20 data sets where the testing data were just employed in the model validation the original t 2 and cumulative t 2 data sets were separately prepared for scenarios 1 and 2 for some of the implemented algorithms with many user dependent parameters a sensitivity analysis was conducted for example boosting models commonly have many hyperparameters thus a detailed tuning process is needed to find out the best combination of such parameters to obtain the best prediction results gridsearchcv was applied to gbdt and xgboost models for hyperparameters auto tuning process including max depth learning rate and n eatimators 3 2 matrix porosity permeability and correlation analysis petrophysical data of matrix porosity and k were measured from core experiments in the laboratory fig 2 a matrix porosity values ranged from 6 57 to 32 91 with an average value of 18 51 fig 2b due to the joint control of sedimentary facies and diagenesis aquifers in different regions have different porosity ranges medici et al 2016 ershadnia et al 2020 the matrix porosity in the lingshui region is higher than that in the dongfang region fig 2a which may also suffer from sampling bias the measured k ranges from 1 8 10 18 m2 to 1 54 10 11 m2 with an average value of 2 87 10 13 m2 287 millidarcy fig 2c overall k varied much larger than matrix porosity spanning seven orders of magnitude under extensive sampling from different aquifers fig 2b and c to reduce the probability of collinearity and heteroscedasticity k values were transformed into logarithmic values expressed as l o g 10 k as expected the cumulative t 2 data highlighted the difference between the variable distributions by the heights of the cumulative t 2 spectra fig 2d and e moreover as shown in fig 2f and g the original t 2 relaxation data with 51 bins shared a poor correlation with log 10 k showing on the right of the cross correlation matrix map fig 2g however the cumulative of the t 2 relaxation data manifest a reasonable correlation especially for variables from variable x 31 to variable x 51 fig 2f 3 3 estimated results of traditional methods two classic permeability estimation models from nmr t 2 spectra are sdr and timur coates models the sdr model was developed based on the relationship between pore size distribution and permeability the timur coates model was developed by considering the contribution of movable and bound fluids to permeability both models are empirical models including their modified or improved models that have been widely used in homogeneous sandstones dunn et al 2002 1 the sdr model 36 k s d r c 1 ϕ a 1 t 2 g m b 2 where k sdr is the k estimated by the sdr model ϕ is the nmr based matrix porosity t 2 g m is the geometric mean of the t 2 spectrum a 1 b 1 and c 1 are the empirical constants that need to be determined commonly the original a 1 b 1 and c 1 equal to 4 2 4 respectively taking the logarithm of both sides of eq 36 eq 36 can be rearranged as 37 l o g 10 k s d r a 1 l o g 10 ϕ b 2 l o g 10 t 2 g m l o g 10 c 1 using the multiple linear regression method from the data used the original a 1 b 1 and c 1 can be fitted mathematically a 1 5 584 b 1 1 589 c 1 3 55e 09 r 2 0 801 the final sdr model with the fitting constants can be expressed as 38 k s d r 3 55 e 09 ϕ 5 584 t 2 g m 1 589 2 the timur coates model 39 k t c ϕ c 2 a 2 f f i b v i b 2 where k t c is the k estimated by the timur coates model ϕ is the nmr based matrix porosity f f i represents the free fluid index calculated by the accumulated matrix porosity component spanning t 2 range larger than t 2 cut off value b v i represents the bound volume index calculated by the accumulated matrix porosity component spanning t 2 range less than t 2 cut off value constants a 2 b 2 and c 2 are the empirical constants that need to be determined commonly the original a 2 b 2 and c 2 equal to 4 2 10 respectively taking the logarithm of both sides of eq 39 eq 39 can be rearranged as 40 l o g 10 k t c a 2 l o g 10 ϕ b 2 l o g 10 f f i b v i a 2 l o g 10 c 2 using the multiple linear regression method from this data used the original a 2 b 2 and c 2 can be fitted mathematically a 2 5 578 b 2 1 307 c 2 10 829 r 2 0 803 the final timur coates model with the fitting constants can be expressed as 41 k t c ϕ 10 829 5 578 f f i b v i 1 307 the measured k was compared with the predicted k from the sdr and timur coates models as shown in fig 3 it can be found that both models produced an unacceptable error especially from the sdr model which suggests that for sandstone aquifers with a wide range of k only considering the pore size distribution to estimate k has limited success the reason can be attributed to that such sandstone aquifers have numerous pore structure types leading to non consistent correlations between k and fixed pore size although the mathematical fitting was used to determine the optimal empirical constants the sdr model still underestimate k in the most range fig 3a where similar phenomenon was observed in the timur coates model fig 3b compared with the sdr model the timur coates model presents a better performance which can be attributed to that the timur coates model considered the contributions of ffi and bvi for pore fluid flow the errors were attributed to a fixed t 2 cut off value of 33 ms assigned to all sandstone cores it is worth noting that in the actual k prediction there is commonly no measured matrix k data to fit the empirical constants for both the sdr and timur coates models thus in such a case predicting k from nmr t 2 data is highly risky in different sandstone aquifers with a wide range of k using the classical models 3 4 estimated results of machine learning models 3 4 1 scenario 1 in scenario 1 the original t 2 relaxation data was used as training data to construct the k models the validation results are shown in fig 4 and table 1 r 2 was used as an indicator it is confirmed that the ridge regression model shows the optimal performance with the highest r 2 of 0 8733 at a lower level three models of rf adaboost and gbdt have r 2 values ranging from 0 8 to 0 85 additionally five other models have the worst performance with low r 2 values 0 8 including the lr 0 5345 lasso regression 0 5653 dt 0 5910 etr 0 4942 and xgboost 0 7037 models table 1 five widely used error indicators were introduced generally the predictions with higher values of r 2 and evs are thought to be more accurate and reliable on the contrary the models are seen to be ill suited with higher values of mse rmse and mae but lower r 2 and evs values as shown in table 1 the results of five indicators for k were collected to make a full evaluation of the performances of nine models for the 27 testing cores the ridge model has the best performance with the highest r 2 and evs values and the lowest mse the traditional lr model provided the worst k estimations which only has a r 2 of 0 3712 adaboost and gbdt models show a close performance with low mse which are 0 2615 and 0 2611 respectively 3 4 2 scenario 2 in scenario 2 the cumulative t 2 data were used for comparison by using changing input data compared with scenario 1 the optimal model has changed the predicted results also present different error characteristics fig 5 and table 2 better results were obtained for all the models using the new form of input data the gbdt model represented the best performance to predict permeability with a r 2 of 0 9227 fig 5i except for the lr and lasso models the accuracy of other models reached over 0 7 r 2 fig 5a and b the ridge rf and adaboost methods share the close r 2 values ranging from 0 8 to 0 9 fig 5c f and g while the dt etr and xgboost models present lower performance with a r 2 of around 0 7 fig 5d e and h except for r2 other error evaluation indicators were summarized in table 2 the gbdt has a minimum mse of 0 1846 and the lr model is the least model with a mse of 1 8443 the ridge rf and adaboost models provide three close values of r 2 0 8733 0 8576 and 0 8547 respectively as well as mses 0 2561 0 1840 and 0 1846 respectively 3 5 comparison of different machine learning models the performances of nine machine learning models were compared and evaluated on the full dataset fig 6 a f as trained the nmr data driven method for k prediction was investigated using nine machine learning models in sandstone aquifers spanning seven orders of magnitude in k using the developed models all the data including the training and test data were re predicted data represented by spherical shapes were the predicted results of training data while samples represented by star shapes referred to the test data in addition different models were distinguished by different colors the predictive results were compared with the measured k values compared with the classical models the appropriate data mining methods show a better performance in estimating k than the classical methods figs 3 and 6 both the classical sdr and timur coates models with mathematically fitting constants underestimated k with an unacceptable error in this study area fig 3 for the test data the ridge model was regarded as the best predictor of k in scenario 1 however full scale predicted results indicate that ridge performed not as well as the gbdt model in addition the predicted k values from the lasso model were quite scattered in the cross plot fig 6a representing a poor performance it is concluded that the machine learning models with linear regression algorithms do not show good performance compared with decision tree based and boosting methods in predicting k with a wide range in scenario 2 it is further confirmed that boosting methods show better responses in predicting k compared with linear based and tree based models especially the gbdt model is the best one verified by accuracy indicators and cross plots in fig 6c all the predicted k values from the gbdt model are concentrated near the standard line of y x where almost no k values are out of the error margins of 10 in scenario 2 in contrast the predicted k values from three models of lr ridge and lasso are far away from the line of y x even out of the margins of 10 notably the tree based models just show satisfactory behaviors in training data while the predicted k values from test data represented by stars are out of the y x in summary the predicted k values provide insights into model selection and into using different nmr data types as input the boosting models including adaboost gbdt and xgboost were more suitable for predicting k in sandstone aquifers than the linear based and tree based models fig 6 4 discussion 4 1 interpretation to the optimal model as mentioned above the gbdt model shows the best performance providing the huge potential for rapid and accurate prediction of k compared with theoretical models with empirical constants however the interpretation of the gbdt model needs to be taken seriously because the increasing trust needs to be paid to overcome the nature of black box in the gbdt model the lack of model visualization makes it difficult to understand how the model works and why accurate results are archived a simple model such as linear regression is best explained by the model itself however for some complex models such as ensemble models or machine learning models the original model itself cannot be used as its explanation shap provides the global and local interpretations with the shapley value as an additive feature attribution method thus shap interprets the predicted k value of the machine learning model as the sum of the attributed values of each input feature lundberg et al 2020 in this section the optimal model of gbdt with the cumulative t 2 data scenario 2 was collected as an example to discuss the model visualization process based on the shap method which helps to understand the overlying work details of the gbdt model as shown in fig 7 the visual contribution was provided by the shap method which was reconstructed the complete decision making process positive contributions to the predicted k value are represented by red arrows pointing to the right while blue arrows pointing to the left represent negative contributions to the predicted k value in other words red contributions indicate that the variables make the predicted k value higher than the base value and the blue ones make it lower in the black box of the gbdt model the decision making process was hidden behind the model here the shap method provides an intuitive and effective way to present the process of obtaining prediction results specifically the predicted k value is considered the sum of the shap values assigned to each variable by the gbdt model in addition the length of the arrow indicates the degree of contribution of the variable in the case shown in fig 7 a base value of 0 75 was given to the log10 k firstly then the contribution of each variable given separately by the model was visually shown through the shap method the variable of x 38 showed the highest positive contribution for the final predicted k value while the x 26 was considered to provide the highest negative contribution to the final log10 k value of 0 92 in addition to an individual explanation for one sandstone core as shown in fig 8 a global interpretation of all sandstone cores was also provided by the shap map the color describes the direction and strength of the influence of the feature on the predicted k value like the local interpretation the red color represents the positive contribution which makes the base value higher while the bule ones showed a negative contribution in addition the transparency of the color represents the degree of contribution the contribution degree and direction of the same variable in different cores often show different characteristics which can only be obtained from the global interpretation for instance the variable x 38 made a negative contribution to the prediction results in cores no 1 to no 39 but made a positive contribution in core no 40 and its contribution to the results was also significantly improved the comparison between the predicted and base values of all cores was also shown in fig 8 which was expressed as the f x the gray line represents the base value given by the gbdt model and f x responds to the sum of contributions of each variable in the cumulative t 2 spectrum data the shap values of each variable were arranged in the model based on the true values indicating the magnitude and direction of the contribution of the variable to the prediction k values as shown in fig 9 a the color bar on the right represents the size of the features value where the redder the color is the larger the value was achieved the x axis represents the shap value which is also the contribution of the input feature to the final output k data in the gbdt model for example a higher value of variable x 38 will have a positive shap value indicating a positive contribution to the predicted matrix k value from the perspective of petrophysics x 38 represents pores with critical flow threshold pore radius information located in the middle of the entire pore interval thus the larger the value of x 38 is the higher the matrix permeability of the core will be on the contrary x 26 represents the micropores corresponding to bound fluids and its contribution to the predicted matrix permeability is negatively correlated in addition to visualize the contribution of each bin of the nmr t 2 spectrum their ranks of importance were explained the important ranking of different variables in the gbdt model s decision making has already been mentioned both in local and global interpretations as shown in fig 9b the y axis shows the 15 variables which were arranged from top to bottom in terms of importance the x axis shows the shap value which represented the contribution order of features variables to the final output in the gbdt model thus the importance of different bins of the nmr t 2 spectrum was obtained and ranked in the following way the variables of x 38 and x 26 in the cumulative t 2 spectrum shared the most important contributions to matrix permeability prediction 4 2 effects of input data types the types of input raw data deeply affect the accuracy of predicted k results which is also found in other regression problems yin et al 2021 in this study both the original and cumulative t 2 data were fed into nine machine learning models nmr data driven models showed reliable performance in k prediction as shown in fig 6a and d the data types profoundly affected the predicted results from the same model for the original t 2 spectrum data as input the predicted k values were scattered in the cross plot especially for the lasso model where the data points were away from the error bars of y x and even the error line of 10 fig 6a moreover the predicted k values from other models also showed similar phenomena fig 6b and e however the models trained using cumulative t 2 relaxation spectra show better performance than those using original t 2 relaxation data fig 6c d and e thus the selection of input data needs to reflect the differences between the input sample which affects the performance of machine learning models as such combined with the findings of rios et al 2011 the priority order of data selection should be the cumulative t 2 data original t 2 bins and raw echo curves when using nmr data as input data to predict k this work provides some insights into the prediction process from curve to value or spectrum to value for the same set of data the pre processing of the data directly affects the accuracy of the prediction results which means that machine learning may not be able to compare and detect the size and correlations between the input data but to establish an implicit correlations between the input and the output this may mean that when predicting a single target value from a curve or spectrum the machine learning model cannot detect the fluctuation of the original data therefore when using the machine learning model to establish the process of from spectrum to value the input data must be preprocessed to highlight the differences between each other the preprocessing process includes the accumulation used in this work and maybe accumulation difference or derivation etc using the position difference of the curves in the 2d or 3d coordinate system to replace the components and fluctuations of the curves spectrums can improve the prediction accuracy of the machine learning models this may be applied to any spectrum to value or curve to value processes such as predicting permeability from pore size distribution the coefficient of permeability from particle size distribution and unsaturated permeability from soil water characteristic curves 4 3 feasibility of application in aquifer matrix permeability estimation nmr data can be used for accurate and rapid matrix permeability prediction in formations without cores and the predicted results were confirmed to be comparable with laboratory measurements weathering causes the permeability of bedrock aquifers to vary by more than four orders of magnitude between different lithologies worthington et al 2016 the matrix k data obtained from laboratory petrophysical measurements as shown in fig 2c spans a wide permeability range from 1 8 10 18 m2 to 1 54 10 11 m2 which has involved the matrix k range of the considerable deep sandstone aquifers worldwide according to the permeability grading standard of sandstones in petrophysics the permeability range in this study involved the most of water bearing sandstone reservoirs such as the tight k 1 10 15 m2 low permeability 1 10 15 m2 k 5 10 14 m2 medium permeability 5 10 14 m2 k 5 10 13 m2 high permeability 5 10 13 m2 k 2 10 12 m2 and ultra high permeability k 2 10 12 m2 cases the measured matrix permeability values were used as objective variables in machine learning model construction the predicted results obtained from machine learning models using cumulative t 2 relaxation data provided the experience of matrix permeability prediction in rocks and even soils with different ranges of petrophysical properties fig 6g for borehole nmr testing the proposed workflow provides a promising technique to construct continuous matrix permeability profiles for aquifer sections fig 6g furthermore the presented results indicated an opportunity for the industrial applications of borehole nmr logging interpretation as the only advanced hydrogeophysical technique that can probe the spatial size information of groundwater within the formations nmr can output continuous nmr t 2 spectra with the ultra high vertical resolution maliva 2016b through prior core test based matrix permeability and machine learning model training nmr logging data can be core calibrated to obtain vertical high resolution matrix permeability profiles if the in situ properties of the formation water are known this k profile can finely interpret the heterogeneity information contained in a medium scale effective hydraulic conductivity at the sub meter scale in addition continuous matrix permeability profiles can be used to calculate the average matrix permeability upscaled to any scale for the macroscopic hydrogeological simulation most importantly shallow sandstone aquifers and carbonatite aquifers often have preferential flow through fracture networks forming a dual porosity feature worthington et al 2019 continuous matrix permeability profiles can be combined with pumping tests to clarify the contribution of these secondary pores fracture network which is crucial for the fracture network to model hydrological behavior maliva 2016a lei et al 2017 5 conclusions in this study nine machine learning models were used to predict the k of sandstone aquifers with seven orders of magnitude variation based on nmr t 2 data the main conclusions are drawn as follows 1 the classical schlumberger doll research sdr and timur coates models provided an unacceptable error for k however the nmr driven models can achieve rapid and accurate predictions of k from 132 sandstone cores with a wide range of 1 8 10 18 1 54 10 11 m2 2 three categories of machine learning algorithms were developed including linear regression decision tree regression and boosting algorithms it was demonstrated that the boosting methods show better performance in predicting k compared with linear based and tree based models 3 the pre processing of the input data directly affects the performances of machine learning models using cumulative t 2 relaxation data as input showed better performance than the original t 2 relaxation data for machine learning models especially the gbdt model achieved the optimal results in the total nine machine learning models with the best correlation coefficient of 0 9227 and the lowest mse of 0 1166 4 through visualization and shap interpretation tools in the gbdt model decision making process the x 38 variable provided the largest positive contribution in the cumulative t 2 data which may be attribute to that the x 38 variable 501 ms of t 2 time reflects intermediate and critical pore size information controlling flow however the x 26 variable 31 6 ms of t 2 time provided the largest negative contribution which may be attribute to that x 26 represents the size information of bound water pores in this dataset 5 this work provides insights into the prediction process from curve to value or spectrum to value the input data need to be preprocessed to highlight the differences between each other for improving the performance of the machine learning models this work using curve to value has some potential applications such as 1 predicting matrix permeability or unsaturated hydraulic conductivity from pore size distribution particle size distribution and soil water characteristic curves swcc and 2 enhancing industrial accuracy of hydrogeophysical nmr well logging in predicting k to provide a continuous matrix permeability profile declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china no 42002171 the china postdoctoral science foundation and special foundation nos 2020tq0299 2020m682520 and the postdoctoral innovation science foundation from hubei province of china china scholarship council is gratefully acknowledged for funding chen s research the zhanjiang branch of cnooc is appreciated for the support of experiments and samples the authors really appreciate the valuable discussions with prof martain j blunt of imperial college london uk the experimental data used can be available at 10 5281 zenodo 6487905 
2189,predicting the matrix permeability of subsurface sandstone aquifers is a formidable challenge one test showing great promise is nuclear magnetic resonance nmr as it is the only advanced hydrogeophysical technique non invasively measuring subsurface pore structure information and being applied in downhole well log analysis with core calibration unfortunately the classical nmr based permeability models suffer from more than two empirical constants that limit prediction accuracy greatly in this study a nmr data driven method was reported with nine machine learning models results indicate that the type of input data strongly influences the machine learning modeling of matrix permeability using the cumulative t 2 relaxation data instead of the original t 2 data a stronger agreement was found between experimental results and nmr estimates of matrix permeability from the gradient boosting decision tree model automatically tuned by gridsearchcv the correlation coefficient reaches 0 92 with the lowest mse of 0 12 due to the nature of black box of machine learning model the visualization and interpretation of the optimal model were performed through the shapley additive explanations method the 38th variable of 501 ms in the cumulative t 2 spectrum positively contributes the most to the matrix permeability however the 26th variable of 31 6 ms provides the largest negative contribution to the final predicted matrix permeability this work aims to provide a new idea to the from curve to value prediction process for a rapid and accurate matrix bedrock permeability estimation via nmr t 2 data in deep sandstone aquifers and extensive porous rocks keywords matrix permeability nuclear magnetic resonance t 2 spectrum data driven machine learning sandstone aquifer data availability data will be made available on request 1 introduction accurately estimating matrix bedrock permeability k m2 in deep sandstone aquifers is of great significance for mining safety modeling contaminant diffusion and distribution clarifying the contribution of fractures to flow and geological carbon storage gcs li and benson 2015 reynolds et al 2018 xu et al 2020 ma et al 2021 saraf and bera 2021 gholami and raza 2022 however predicting k of sandstone aquifers with extensive variability is inherently a difficult task urang et al 2020 talebmorad and ostad ali askari 2022 generally the permeability of aquifers is characterized by multiscale effects and heterogeneity desbarats and bachu 1994 schulze makuch et al 1999 rogiers et al 2014 for heterogeneous karst media formed in carbonate aquifers the volume permeability increases with the observation scale worthington 2009 dissolution and tectonic related fractures enhance the permeability of aquifers and induce a preferential flow of groundwater resulting in self organized permeability worthington and ford 2009 worthington et al 2016 currently different experimental testing methods are employed for different scales of permeability providing different perspectives on the spatial variability of permeability including pumping tests electromagnetic flow meter logging and core permeability measurements the pumping test is the volume permeability of the full thickness approximately 50 m the flowmeter tests effective permeability at the mid scale 2 to 9 m core permeability measurement provides reliable matrix bedrock permeability data at the smallest measurement scale 0 1 m sub meter scale pavelic et al 2006 cardiff et al 2012 zhu et al 2022 however for deep sandstone aquifers without fractures permeability is dominated by intergranular flow namely the pore scale k becomes progressively dominant with a huge lithostatic load e g buried depths greater than 2 000 m medici et al 2018 deep sandstone aquifers are generally considered to represent porous media characterized by a permeable matrix in unfaulted areas only a minor contribution to permeability is provided by bedding plane fractures medici et al 2016 additionally as a classical procedure pumping test data as a function of time suffer from non uniqueness owing to the potential physical or conceptual limitations where the interpretations reflect macroscopic contribution of large volume porous media small scale structural changes and heterogeneity that may be essential to effectively solve hydrological issues are lost de lima and niwas 2000 in relatively homogeneous strata small volume k can provide a reasonable estimate of the characteristics of bulk aquifers which would be valuable in the absence of data from larger scale experiments for example the k of a small core or core plug size sample can be compared with formation scale values obtained from pumping tests to estimate the effect and contribution of secondary porosity such as fractures and pipes on aquifer volume permeability maliva 2016b worthington 2022 therefore the prediction of matrix permeability is highly urgent for studying the hydraulic characteristics of deep sandstone aquifers methods to obtain matrix permeability fall into three categories 1 direct core measurements based on darcy s law 2 pore scale simulation and 3 inversion or indirect calculation sahimi 2011 maliva 2016a vogelgesang et al 2020 direct core measurements have some inherent limitations such as sampling bias and low coring recoveries for unconsolidated rocks such as sediments and soils the partial sampling bias barlebo et al 2004 combined with the limited sampling number can lead to an underestimation of the effective permeability of aquifers by a factor of nearly 50 pavelic et al 2006 as a small volume technique core analysis captures fine scale heterogeneity in k but provides data that is often not representative of the effective permeability for large scale aquifers the depositional conditions of sandstone aquifers can result in strong vertical heterogeneity of permeability such as the small scale stratifications with k varying by a factor of 10 to 100 swanson et al 2006 for deep aquifers the continuous in situ coring to obtain high resolution k profiles is expensive and unrealistic pore scale simulations provide a dynamic view at the micro scale but have high computational costs and limited sample size liu et al 2016 overcoming the limitations of core testing and simulation the advanced geophysical method nuclear magnetic resonance nmr provides point by point high resolution vertical formation information such as porosity and pore size distribution in which aquifer hydraulic parameters such as k are well reflected behroozmand et al 2015 zhao et al 2017 wang et al 2018 pehme et al 2022 as reviewed by slater 2007 nmr may in the future significantly advance the science of estimating k from geophysical measurements nmr is currently the only technique available that specifically measures water content and estimates k in situ without the active use of nuclear sources nmr measurements provide insights into in situ hydrogeological conditions that are difficult to achieve or explain with other downhole and or core measurements pehme et al 2022 nmr logging can complement core measurements by placing core testing in a broader context predicting aquifer parameters from geophysical data is perhaps the most important goal of the emerging field of hydrogeophysics lesmes and friedman 2005 vogelgesang et al 2020 however although nmr provides a wealth of hydrological information there are two widely used classical theoretical models for evaluating k based on nmr data the timur coates model and schlumberger doll research sdr model timur 1968 dlubac et al 2013 two models all contain no less than three empirical constants and require the determinations of bound water saturation and cut off value of the nmr t 2 spectrum which often introduces unacceptable errors for k ren et al 2019 fortunately data driven methods have brought new insights and opportunities for evaluating k using nmr data in recent years machine learning techniques have been widely used in subsurface aquifer analysis in solving flow equations pollutant transport salinity mapping permeability and hydraulic conductivity etc rabbani et al 2020 sahour et al 2020 tahmasebi et al 2020 tahmasebi and sahimi 2021 ostad ali askari 2022b machine learning has demonstrated its ability to handle multi scale and data information which provides opportunities to cope with complex problems such as fine scale k in hydrological sciences bao et al 2020 ostad ali askari and shayan 2021 ostad ali askari 2022a applied to predict k the machine learning model utilizes linear and nonlinear regressions to discover the intrinsic correlations between input parameters reflecting flow such as pore grain structure parameters rock composition content and permeability these inputs tend to have lower acquisition costs and higher data volumes depending on the source of the input machine learning methods for evaluating k can be divided into two broad categories 1 cnns based on 2d 3d pore images rabbani et al 2021 tang et al 2022 and 2 parametric regression for the parametric regression using the k related structure parameters machine learning instead of pedotransfer functions is successfully used to model soil permeability araya and ghezzehei 2019 singh et al 2020 rios et al 2011 developed a partial least squares regression technique for the permeability of carbonate rocks with acceptable errors using the original t 2 data by combining the classification with regression the sequential minimal optimization smo based two nearest neighbor model was proposed for estimating permeability in the carbonate systems using t 2 data plastino et al 2017 therefore predicting k in sandstone aquifers using a small number of core tests combined with nmr has become an encouraging research goal additionally it is difficult to quantify the contribution of inputs in the modeling k owing to the black box nature of the machine learning models the primary objective of this study is to investigate the performance of nmr data driven methods for matrix permeability prediction in sandstone aquifers firstly cores from different depths and formations in different regions are collected and tested in the laboratory furthermore the influences of two input t 2 data types original and cumulative on predicting k from the machine learning models are investigated finally the optimal machine learning model is visualized and interpreted to reveal the prediction process meanwhile a comparative analysis is conducted to evaluate two techniques including the nmr data driven method and the classical theoretical models in predicting k 2 methodology to eliminate the influences of different groundwater properties for comparing the flow capacity of samples from different regions the inherent permeability k m2 was uniformly used instead of hydraulic conductivity k m d if the fluid properties dynamic viscosity coefficient and density of groundwater are available in one formation k can be easily converted to k the regression methods commonly include three categories namely linear regression algorithms tree regression techniques and boosting methods linear regression is a statistical analysis method that uses regression analysis by the generalized least squares tree regression and boosting algorithms are both nonlinear regression methods which eliminate the collinearity of independent variables the nmr t 2 data and the core based measured k data are used to establish prediction models of matrix k besides five validation indicators are employed to compare the accuracy of each developed model 2 1 nmr tests an nmr core analyzer typed by corespec 1000 us numar company was used to capture the t 2 signal of water saturated sample nmr experiments were carried out at room temperature 28 c with an operating frequency of 2 mhz up to 4096 cpmg echoes were collected from a single pulse train the parameter of echo interval was set as 0 2 ms in this study firstly a sandstone core was processed into the core column with a diameter of 2 5 cm and a length of 2 5 cm the core matrix porosity matrix permeability dry weight wet weight and volume density were measured in the laboratory after cleaning and drying after the echo data were collected the multi exponential inversion process was carried out to invert echo trains data and obtain transversal t 2 relaxation using the nonnegative least squares method dunn et al 2002 ge et al 2017 2 2 algorithm descriptions in this section the utilized algorithms are briefly described which include 2 2 1 models using linear regression as kernel functions 1 linear regression lr the simple theoretical description of the linear model is as follows for data set d x i y i i 1 m x i x i 1 x i 2 x id y i r m is the number of samples and d is the number of input variables the lr model is expressed as 1 f x i ω t x i b where ω t represents the coefficient matrix f x i is the predicted value and b represents a constant the ε i represents the error between f x i and the true value y i thus 2 y i ω t x i ε i if ε i follows a gaussian distribution which can be expressed as 3 p ε i 1 2 π σ e x p ε i 2 2 σ 2 substituting eq 2 into eq 3 then 4 p y i x i ω 1 2 π σ e x p y i ω t x i 2 2 σ 2 introducing the like hood function l ω then 5 l ω i 1 m p y i x i ω i 1 m 1 2 π σ e x p y i ω t x i 2 2 σ 2 taking the logarithm on both sides of the eq 5 6 l ω i 1 m l o g 10 1 2 π σ exp y i ω t x i 2 2 σ 2 m l o g 10 1 2 π σ 1 2 1 σ 2 i 1 m y i ω t x i 2 finally the objective function j ω can be expressed as 7 j ω 1 2 i 1 m y i ω t x i 2 1 2 y i ω t x i t y i ω t x i 2 lasso regression lasso is an effective model based on linear regression with l1 regularization which is expressed as 8 min ω b f ω b 1 m i 1 m ω x i b y i 2 λ ω 1 3 ridge regression using the tikhonov regularization the ridge regression model is developed based on traditional linear regression the model is derived as 9 min ω b f ω b 1 m i 1 m ω x i b y i 2 λ ω 2 2 2 2 2 models using regression tree as kernel functions 1 decision tree classification and regression trees cart are used as the basis of tree models the generation of the decision tree is the process of recursively constructing a binary decision tree the mean squared error minimization criterion is used for the regression tree to generate a binary tree by feature selection in regression issues by selecting the optimal segmentation variable j and the segmentation point s 10 min j s min c 1 x i r 1 j s y i c 1 2 min c 2 x i r 2 j s y i c 2 2 where r 1 j s x x j s r 2 j s x x j s r m is the divided input space c m 1 n m x i r m j s y i x r m m 1 2 refers to the output value reflecting r m for all the values of j the minimum value is obtained by scanning the segmentation point s the decision tree is obtained by dividing the input space into r 1 r 2 r 3 r m 11 f x m 1 m c m i x r 2 extra tree regression etr using multiple decision trees as indicators the extra tree regression is developed which belongs to an ensemble method for supervised regression issues marée et al 2004 sagi and rokach 2020 okoro et al 2021 the main idea of etr follows the classic top down procedure in which numerous regression trees are created being different from other tree based models etr separates nodes by selecting cut points randomly and developing the tree using the entire learning sample after the forecasts of multiple decision trees the prediction of the final result is obtained based on the arithmetic average the tree based structure was stated in detail by seyyedattar et al 2020 3 random forest rf rf is an ensemble method based on the decision tree random subspace and bootstrap aggregating consisting of multiple decision trees breiman 2001 rf shows many advantages in regression problems for example rf is considered as a good method for dimensionality reduction because it has a good processing ability for high dimensional data sets in addition the model can output the importance of features in the regression process moreover it can be used to deal with the problem of data missing directly without normalization the details of rf can be found in the published works breiman 2001 2 2 3 models using boosting algorithms based on regression tree boosting also known as the enhanced learning or lifting method is a kind of important ensemble learning technology boosting can be randomly surmised slightly with higher prediction accuracy than that of weak learning enhancement study which provides effective new ideas and new methods for machine learning methods freund et al 1999 schapire 1999 cai et al 2020 zounemat kermani et al 2021 1 adaptive boosting adaboost as an effective machine learning model using the boosting idea the adaptive boosting regression integrates multiple weak predictors to establish a stronger predictor freund et al 1999 in the process of model training the weight of the base learners with the small error is increased and the base learners with large errors are reduced through multiple iterations the optimal model is obtained the derivation of the model was presented in many publications zhao et al 2019 wang et al 2022 2 gradient boosting decision tree gbdt gbdt as an iterative cart based forward algorithm commonly consists of several hundreds of carts during the training process gbdt builds a learner that reduces the loss along the direction of the largest gradient to improve the existing model in each iteration as the iterations increase the loss keeps decreasing and the number of carts keeps increasing finally the prediction values from all of the carts are accumulated to provide the final output 1 weak learner for data set d x 1 y 1 x 2 y 2 x n y n with n samples the regression loss function uses mean square error which can be written as l y i f x i 1 2 y i f x i 2 the weaker learner f x γ is expressed as 12 f 0 x argmin γ i 1 n l y i γ where γ is the weight vector of features which needs to be determined by training 2 training the negative gradient of l y i f x i for the i th sample in the t th iteration is expressed as 13 r it l y i f x i f x i f f t 1 where t represents the times of iterations which ranged from 1 to the maximum iteration of t r jt j 1 2 j t is the leaf node region corresponding to the new regression tree which corresponds to the leaf node area r tj j 1 2 j t where j represents the number of leaf nodes for the i th sample in each leaf node the best fitting value is expressed as 14 γ it argmin γ x i r jt n l y i f t 1 x i γ then the cart fitting function for the t th iteration 15 f t x f t 1 x j 1 j t γ jt i x r jt 3 strong learner 16 f x f t x f 0 x ν t 1 t j 1 j γ jt i x r jt where ν is a hyperparameter where the smaller ν indicates the more iterative number 3 extreme gradient boosting xgboost 1 initial model the data set d x i y i x i r m y i r contains n samples with m features after the total of k iterations the objective function l y f k x is defined as 17 l y f k x i 1 n l y i y i k 1 k ω f k where l y i y i is the loss function ω f k is the regularization term f k is the k th cart y i y i are the true and predicted values of the i th samples respectively 2 optimizing l y f k x the predicted value y i k in the k th iteration is calculated as the sum of the predicted results y i k 1 by the k 1 times iterations and the predicted result f k x i of the k th iteration 18 y i k k 1 k f k x i y i k 1 f k x i according to the second order taylor series combining eq 18 with eq 17 then 19 l k y f k x i 1 n g i f k x i 1 2 h i f k 2 x i ω f k i 1 n l y i y i k 1 k 1 k 1 ω f k where g i y i t 1 l y i y i t 1 h i y i t 1 2 l y i y i t 1 are the first and second derivative forms of l y i y i concerning y i k 1 respectively rearranging eq 19 then 20 l k y f k x i 1 n g i f k x i 1 2 h i f k 2 x i ω f k the predicted value from the cart f x is obtained as 21 f x ω q x where q x indicates the leaf node location of sample x the ω is the score of leaf node combined eq 21 with eq 20 then 22 l k y f k x i 1 n g i ω k q x i 1 2 h i ω k q x i 2 ω f k the l2 normalization is adopted to avoid the over fitting effect which is calculated as 23 ω f k γ t k 1 2 λ j 1 t k ω k j 2 where t k represents the leaf node number two hyperparameters γ λ are contraction and penalty coefficients respectively 3 strong learner substituting eq 23 into eq 22 then 24 l k y f k x j 1 t k g j ω k j 1 2 h j λ ω k j 2 γ t k where g j i i j g i h j i i j h i the derivative of ω k j is used to find the minimum l k y f k x as 25 ω t j g j h j λ 26 l k y f k x 1 2 j 1 t k g j 2 h j λ γ t k thus y i k can be calculated as 27 y i k k 1 k f k x i y i k 1 f k x i a strong learner can be expressed as 28 l y f k x y i 0 k 1 k j 1 t k ω k j 2 3 gridsearchcv optimization machine learning models commonly have multiple hyperparameters that affect the performance of the models therefore tuning hyperparameters is of great significance to optimization of objective function gridsearchcv is an effective tool for finding the optimal hyperparameters of machine learning models the core structure of gridsearchcv consists of two parts including gridsearch and cross validation firstly in the grid search process every hyperparameter was assigned a specific value which is a sequence of arithmetic numbers within a specified interval and then in the process of cross validation numerous models were obtained and every model s performance was compared by k fold cross validation when all values of hyperparameters in the given interval were tried the optimization of objective function was achieved using specific hyperparameter values grid search for specific hyperparameter values is probably the simplest and most widely used hyperparameter search algorithm which determines the optimal value by finding all the points in the search range if a large search range and a small step size are used grid search has a high probability of finding the global optimal value 2 4 accuracy verification indicators verifying the predicted results of the machine learning methods is one of the key steps as such five error indicators were computed for each model after the prediction including mean absolute error mae mean squared error mse root mean squared error rmse correlation coefficient r 2 and explained variance score evs five error indicators indicated the prediction accuracy of results and the performances of different machine learning models the theoretical expressions used are shown as follows 29 m s e 1 m i 1 m y i f i 2 30 r m s e 1 m i 1 m y i f i 2 31 m a e 1 m i 1 m y i f i 32 e v s 1 v a r y i f i v a r y i 33 r 2 1 i 1 m y i f i 2 i 1 m y i y i 2 where m is the number of total samples i refers to the number of a specific sample y i is the true value f i represents the predicted value 2 5 shapley additive explanations shap shap is a machine learning interpretation tool based on cooperative game theory which is a model ex post interpretation method shap s core idea is to calculate the marginal contribution of features to model output and then explain the black box model from the global and local levels marginal contribution is introduced into shap which is used to measure the contribution of one feature to model s prediction results in the shap method the final predicted result is expressed as the sum of all shap values in the interpretation of machine learning models 34 y i y b a s e v a l u e f x i 1 f x i 2 f x i 3 f x ik where f x ik is the shap value of the k t h feature of the sample x i when f x ik 0 it means that this feature improves the predicted value and has a positive effect on the contrary it shows that this feature makes the predicted value decrease and has a reverse effect 2 6 workflow the complete workflow for predicting matrix permeability of deep sandstone aquifers starting from the procedure of data collection to model validation is shown in fig 1 firstly both nmr and petrophysical tests were conducted the original t 2 data with 51 bins were obtained from the original echo data secondly the cumulative version of t 2 data was generated fig 1a two categories of t 2 relaxation data were used as inputs to train different models including the t 2 original data with 51 bins and cumulative t 2 data with 51 variables automatic tuning was introduced into the model training procedure the boosting models were optimized by adjusting key hyperparameters including max depth learning rate and n eatimators fig 1b finally five indicators of validation were used to evaluate the performances of trained machine learning models eqs 29 to 33 3 results 3 1 data collection and processing to overcome the narrow k range caused by the nonrepresentative sampling a total of 132 sandstone cores from several sandstone aquifers at different depths regions and geological ages were collected as much as possible the depths cover from 1 222 00 m to 4 020 00 m focusing on formations of neogene and paleogene the specific sampling backgrounds are 1 11 cores huangliu formation miocene neogene in dongfang df region yinggehai basin with depths ranging from 2 862 00 m to 3 091 00 m 2 12 cores huangliu and meishan formations miocene neogene in lingshui ls region qiongdongnan basin from 3 091 55 m to 3 345 10 m 3 16 cores sanya formation miocene neogene in songtao st region qiongdongnan basin from 2 269 50 m to 2 981 60 m 4 33 cores zhuhai and zhujiang formations miocene neogene and oligocene paleogene in wenchang wc region pearl river mouth basin depth from 1378 88 m to 3817 00 m 5 18 cores oligocene eocene paleogene liushagang and weizhou formations wushi ws region beibuwan basin from 1 222 00 m to 3 891 50 m 6 32 cores liushagang and weizhou formations eocene paleogene in weizhou wz region beibuwan basin from 2 266 00 m to 3 686 75 m 7 10 cores meishan and enping formations miocene neogene oligocene paleogene in yacheng yc region qiongdongnan basin from 3 429 99 m to 4 020 00 m all the cores were tested by petrophysical measurements and nmr experiments two sets of nmr t 2 relaxation data were obtained and used for constructing the matrix permeability models in two scenarios including using t 2 relaxation data with 51 original bins scenario 1 and cumulative t 2 data with 51 variables scenario 2 the mathematical matrix of input data is expressed as x 132 51 and x 132 51 respectively which both have 132 samples with 51 variables 1 original t 2 relaxation data by the inversion of echo data t 2 relaxation data t 0 1 t 0 13 t 0 16 t 10000 were obtained with 51 bins logarithmically distributed between 0 1 ms and 10 000 ms in the model construction the 51 variables were renamed as x 1 x 2 x 3 x 51 for a better comparison with the cumulative t 2 relaxation data named as x 1 x 2 x 3 x 51 2 cumulative t 2 relaxation data on the other hand the cumulative data set contains 51 variables x 1 x 2 x 3 x 51 which were produced by cumulating the t 2 relaxation data to explore if such a representation of data can lead to enhance the differences between t 2 spectra to providing a more accurate k prediction the accumulation method is expressed as follows x 1 t 0 1 x 2 t 0 1 t 0 13 x 3 t 0 1 t 0 13 t 0 16 35 x 51 t 0 1 t 0 13 t 0 16 t 7940 t 10000 matching the nmr data with the k data the full data set was developed and subsequently divided randomly into training 80 and testing 20 data sets where the testing data were just employed in the model validation the original t 2 and cumulative t 2 data sets were separately prepared for scenarios 1 and 2 for some of the implemented algorithms with many user dependent parameters a sensitivity analysis was conducted for example boosting models commonly have many hyperparameters thus a detailed tuning process is needed to find out the best combination of such parameters to obtain the best prediction results gridsearchcv was applied to gbdt and xgboost models for hyperparameters auto tuning process including max depth learning rate and n eatimators 3 2 matrix porosity permeability and correlation analysis petrophysical data of matrix porosity and k were measured from core experiments in the laboratory fig 2 a matrix porosity values ranged from 6 57 to 32 91 with an average value of 18 51 fig 2b due to the joint control of sedimentary facies and diagenesis aquifers in different regions have different porosity ranges medici et al 2016 ershadnia et al 2020 the matrix porosity in the lingshui region is higher than that in the dongfang region fig 2a which may also suffer from sampling bias the measured k ranges from 1 8 10 18 m2 to 1 54 10 11 m2 with an average value of 2 87 10 13 m2 287 millidarcy fig 2c overall k varied much larger than matrix porosity spanning seven orders of magnitude under extensive sampling from different aquifers fig 2b and c to reduce the probability of collinearity and heteroscedasticity k values were transformed into logarithmic values expressed as l o g 10 k as expected the cumulative t 2 data highlighted the difference between the variable distributions by the heights of the cumulative t 2 spectra fig 2d and e moreover as shown in fig 2f and g the original t 2 relaxation data with 51 bins shared a poor correlation with log 10 k showing on the right of the cross correlation matrix map fig 2g however the cumulative of the t 2 relaxation data manifest a reasonable correlation especially for variables from variable x 31 to variable x 51 fig 2f 3 3 estimated results of traditional methods two classic permeability estimation models from nmr t 2 spectra are sdr and timur coates models the sdr model was developed based on the relationship between pore size distribution and permeability the timur coates model was developed by considering the contribution of movable and bound fluids to permeability both models are empirical models including their modified or improved models that have been widely used in homogeneous sandstones dunn et al 2002 1 the sdr model 36 k s d r c 1 ϕ a 1 t 2 g m b 2 where k sdr is the k estimated by the sdr model ϕ is the nmr based matrix porosity t 2 g m is the geometric mean of the t 2 spectrum a 1 b 1 and c 1 are the empirical constants that need to be determined commonly the original a 1 b 1 and c 1 equal to 4 2 4 respectively taking the logarithm of both sides of eq 36 eq 36 can be rearranged as 37 l o g 10 k s d r a 1 l o g 10 ϕ b 2 l o g 10 t 2 g m l o g 10 c 1 using the multiple linear regression method from the data used the original a 1 b 1 and c 1 can be fitted mathematically a 1 5 584 b 1 1 589 c 1 3 55e 09 r 2 0 801 the final sdr model with the fitting constants can be expressed as 38 k s d r 3 55 e 09 ϕ 5 584 t 2 g m 1 589 2 the timur coates model 39 k t c ϕ c 2 a 2 f f i b v i b 2 where k t c is the k estimated by the timur coates model ϕ is the nmr based matrix porosity f f i represents the free fluid index calculated by the accumulated matrix porosity component spanning t 2 range larger than t 2 cut off value b v i represents the bound volume index calculated by the accumulated matrix porosity component spanning t 2 range less than t 2 cut off value constants a 2 b 2 and c 2 are the empirical constants that need to be determined commonly the original a 2 b 2 and c 2 equal to 4 2 10 respectively taking the logarithm of both sides of eq 39 eq 39 can be rearranged as 40 l o g 10 k t c a 2 l o g 10 ϕ b 2 l o g 10 f f i b v i a 2 l o g 10 c 2 using the multiple linear regression method from this data used the original a 2 b 2 and c 2 can be fitted mathematically a 2 5 578 b 2 1 307 c 2 10 829 r 2 0 803 the final timur coates model with the fitting constants can be expressed as 41 k t c ϕ 10 829 5 578 f f i b v i 1 307 the measured k was compared with the predicted k from the sdr and timur coates models as shown in fig 3 it can be found that both models produced an unacceptable error especially from the sdr model which suggests that for sandstone aquifers with a wide range of k only considering the pore size distribution to estimate k has limited success the reason can be attributed to that such sandstone aquifers have numerous pore structure types leading to non consistent correlations between k and fixed pore size although the mathematical fitting was used to determine the optimal empirical constants the sdr model still underestimate k in the most range fig 3a where similar phenomenon was observed in the timur coates model fig 3b compared with the sdr model the timur coates model presents a better performance which can be attributed to that the timur coates model considered the contributions of ffi and bvi for pore fluid flow the errors were attributed to a fixed t 2 cut off value of 33 ms assigned to all sandstone cores it is worth noting that in the actual k prediction there is commonly no measured matrix k data to fit the empirical constants for both the sdr and timur coates models thus in such a case predicting k from nmr t 2 data is highly risky in different sandstone aquifers with a wide range of k using the classical models 3 4 estimated results of machine learning models 3 4 1 scenario 1 in scenario 1 the original t 2 relaxation data was used as training data to construct the k models the validation results are shown in fig 4 and table 1 r 2 was used as an indicator it is confirmed that the ridge regression model shows the optimal performance with the highest r 2 of 0 8733 at a lower level three models of rf adaboost and gbdt have r 2 values ranging from 0 8 to 0 85 additionally five other models have the worst performance with low r 2 values 0 8 including the lr 0 5345 lasso regression 0 5653 dt 0 5910 etr 0 4942 and xgboost 0 7037 models table 1 five widely used error indicators were introduced generally the predictions with higher values of r 2 and evs are thought to be more accurate and reliable on the contrary the models are seen to be ill suited with higher values of mse rmse and mae but lower r 2 and evs values as shown in table 1 the results of five indicators for k were collected to make a full evaluation of the performances of nine models for the 27 testing cores the ridge model has the best performance with the highest r 2 and evs values and the lowest mse the traditional lr model provided the worst k estimations which only has a r 2 of 0 3712 adaboost and gbdt models show a close performance with low mse which are 0 2615 and 0 2611 respectively 3 4 2 scenario 2 in scenario 2 the cumulative t 2 data were used for comparison by using changing input data compared with scenario 1 the optimal model has changed the predicted results also present different error characteristics fig 5 and table 2 better results were obtained for all the models using the new form of input data the gbdt model represented the best performance to predict permeability with a r 2 of 0 9227 fig 5i except for the lr and lasso models the accuracy of other models reached over 0 7 r 2 fig 5a and b the ridge rf and adaboost methods share the close r 2 values ranging from 0 8 to 0 9 fig 5c f and g while the dt etr and xgboost models present lower performance with a r 2 of around 0 7 fig 5d e and h except for r2 other error evaluation indicators were summarized in table 2 the gbdt has a minimum mse of 0 1846 and the lr model is the least model with a mse of 1 8443 the ridge rf and adaboost models provide three close values of r 2 0 8733 0 8576 and 0 8547 respectively as well as mses 0 2561 0 1840 and 0 1846 respectively 3 5 comparison of different machine learning models the performances of nine machine learning models were compared and evaluated on the full dataset fig 6 a f as trained the nmr data driven method for k prediction was investigated using nine machine learning models in sandstone aquifers spanning seven orders of magnitude in k using the developed models all the data including the training and test data were re predicted data represented by spherical shapes were the predicted results of training data while samples represented by star shapes referred to the test data in addition different models were distinguished by different colors the predictive results were compared with the measured k values compared with the classical models the appropriate data mining methods show a better performance in estimating k than the classical methods figs 3 and 6 both the classical sdr and timur coates models with mathematically fitting constants underestimated k with an unacceptable error in this study area fig 3 for the test data the ridge model was regarded as the best predictor of k in scenario 1 however full scale predicted results indicate that ridge performed not as well as the gbdt model in addition the predicted k values from the lasso model were quite scattered in the cross plot fig 6a representing a poor performance it is concluded that the machine learning models with linear regression algorithms do not show good performance compared with decision tree based and boosting methods in predicting k with a wide range in scenario 2 it is further confirmed that boosting methods show better responses in predicting k compared with linear based and tree based models especially the gbdt model is the best one verified by accuracy indicators and cross plots in fig 6c all the predicted k values from the gbdt model are concentrated near the standard line of y x where almost no k values are out of the error margins of 10 in scenario 2 in contrast the predicted k values from three models of lr ridge and lasso are far away from the line of y x even out of the margins of 10 notably the tree based models just show satisfactory behaviors in training data while the predicted k values from test data represented by stars are out of the y x in summary the predicted k values provide insights into model selection and into using different nmr data types as input the boosting models including adaboost gbdt and xgboost were more suitable for predicting k in sandstone aquifers than the linear based and tree based models fig 6 4 discussion 4 1 interpretation to the optimal model as mentioned above the gbdt model shows the best performance providing the huge potential for rapid and accurate prediction of k compared with theoretical models with empirical constants however the interpretation of the gbdt model needs to be taken seriously because the increasing trust needs to be paid to overcome the nature of black box in the gbdt model the lack of model visualization makes it difficult to understand how the model works and why accurate results are archived a simple model such as linear regression is best explained by the model itself however for some complex models such as ensemble models or machine learning models the original model itself cannot be used as its explanation shap provides the global and local interpretations with the shapley value as an additive feature attribution method thus shap interprets the predicted k value of the machine learning model as the sum of the attributed values of each input feature lundberg et al 2020 in this section the optimal model of gbdt with the cumulative t 2 data scenario 2 was collected as an example to discuss the model visualization process based on the shap method which helps to understand the overlying work details of the gbdt model as shown in fig 7 the visual contribution was provided by the shap method which was reconstructed the complete decision making process positive contributions to the predicted k value are represented by red arrows pointing to the right while blue arrows pointing to the left represent negative contributions to the predicted k value in other words red contributions indicate that the variables make the predicted k value higher than the base value and the blue ones make it lower in the black box of the gbdt model the decision making process was hidden behind the model here the shap method provides an intuitive and effective way to present the process of obtaining prediction results specifically the predicted k value is considered the sum of the shap values assigned to each variable by the gbdt model in addition the length of the arrow indicates the degree of contribution of the variable in the case shown in fig 7 a base value of 0 75 was given to the log10 k firstly then the contribution of each variable given separately by the model was visually shown through the shap method the variable of x 38 showed the highest positive contribution for the final predicted k value while the x 26 was considered to provide the highest negative contribution to the final log10 k value of 0 92 in addition to an individual explanation for one sandstone core as shown in fig 8 a global interpretation of all sandstone cores was also provided by the shap map the color describes the direction and strength of the influence of the feature on the predicted k value like the local interpretation the red color represents the positive contribution which makes the base value higher while the bule ones showed a negative contribution in addition the transparency of the color represents the degree of contribution the contribution degree and direction of the same variable in different cores often show different characteristics which can only be obtained from the global interpretation for instance the variable x 38 made a negative contribution to the prediction results in cores no 1 to no 39 but made a positive contribution in core no 40 and its contribution to the results was also significantly improved the comparison between the predicted and base values of all cores was also shown in fig 8 which was expressed as the f x the gray line represents the base value given by the gbdt model and f x responds to the sum of contributions of each variable in the cumulative t 2 spectrum data the shap values of each variable were arranged in the model based on the true values indicating the magnitude and direction of the contribution of the variable to the prediction k values as shown in fig 9 a the color bar on the right represents the size of the features value where the redder the color is the larger the value was achieved the x axis represents the shap value which is also the contribution of the input feature to the final output k data in the gbdt model for example a higher value of variable x 38 will have a positive shap value indicating a positive contribution to the predicted matrix k value from the perspective of petrophysics x 38 represents pores with critical flow threshold pore radius information located in the middle of the entire pore interval thus the larger the value of x 38 is the higher the matrix permeability of the core will be on the contrary x 26 represents the micropores corresponding to bound fluids and its contribution to the predicted matrix permeability is negatively correlated in addition to visualize the contribution of each bin of the nmr t 2 spectrum their ranks of importance were explained the important ranking of different variables in the gbdt model s decision making has already been mentioned both in local and global interpretations as shown in fig 9b the y axis shows the 15 variables which were arranged from top to bottom in terms of importance the x axis shows the shap value which represented the contribution order of features variables to the final output in the gbdt model thus the importance of different bins of the nmr t 2 spectrum was obtained and ranked in the following way the variables of x 38 and x 26 in the cumulative t 2 spectrum shared the most important contributions to matrix permeability prediction 4 2 effects of input data types the types of input raw data deeply affect the accuracy of predicted k results which is also found in other regression problems yin et al 2021 in this study both the original and cumulative t 2 data were fed into nine machine learning models nmr data driven models showed reliable performance in k prediction as shown in fig 6a and d the data types profoundly affected the predicted results from the same model for the original t 2 spectrum data as input the predicted k values were scattered in the cross plot especially for the lasso model where the data points were away from the error bars of y x and even the error line of 10 fig 6a moreover the predicted k values from other models also showed similar phenomena fig 6b and e however the models trained using cumulative t 2 relaxation spectra show better performance than those using original t 2 relaxation data fig 6c d and e thus the selection of input data needs to reflect the differences between the input sample which affects the performance of machine learning models as such combined with the findings of rios et al 2011 the priority order of data selection should be the cumulative t 2 data original t 2 bins and raw echo curves when using nmr data as input data to predict k this work provides some insights into the prediction process from curve to value or spectrum to value for the same set of data the pre processing of the data directly affects the accuracy of the prediction results which means that machine learning may not be able to compare and detect the size and correlations between the input data but to establish an implicit correlations between the input and the output this may mean that when predicting a single target value from a curve or spectrum the machine learning model cannot detect the fluctuation of the original data therefore when using the machine learning model to establish the process of from spectrum to value the input data must be preprocessed to highlight the differences between each other the preprocessing process includes the accumulation used in this work and maybe accumulation difference or derivation etc using the position difference of the curves in the 2d or 3d coordinate system to replace the components and fluctuations of the curves spectrums can improve the prediction accuracy of the machine learning models this may be applied to any spectrum to value or curve to value processes such as predicting permeability from pore size distribution the coefficient of permeability from particle size distribution and unsaturated permeability from soil water characteristic curves 4 3 feasibility of application in aquifer matrix permeability estimation nmr data can be used for accurate and rapid matrix permeability prediction in formations without cores and the predicted results were confirmed to be comparable with laboratory measurements weathering causes the permeability of bedrock aquifers to vary by more than four orders of magnitude between different lithologies worthington et al 2016 the matrix k data obtained from laboratory petrophysical measurements as shown in fig 2c spans a wide permeability range from 1 8 10 18 m2 to 1 54 10 11 m2 which has involved the matrix k range of the considerable deep sandstone aquifers worldwide according to the permeability grading standard of sandstones in petrophysics the permeability range in this study involved the most of water bearing sandstone reservoirs such as the tight k 1 10 15 m2 low permeability 1 10 15 m2 k 5 10 14 m2 medium permeability 5 10 14 m2 k 5 10 13 m2 high permeability 5 10 13 m2 k 2 10 12 m2 and ultra high permeability k 2 10 12 m2 cases the measured matrix permeability values were used as objective variables in machine learning model construction the predicted results obtained from machine learning models using cumulative t 2 relaxation data provided the experience of matrix permeability prediction in rocks and even soils with different ranges of petrophysical properties fig 6g for borehole nmr testing the proposed workflow provides a promising technique to construct continuous matrix permeability profiles for aquifer sections fig 6g furthermore the presented results indicated an opportunity for the industrial applications of borehole nmr logging interpretation as the only advanced hydrogeophysical technique that can probe the spatial size information of groundwater within the formations nmr can output continuous nmr t 2 spectra with the ultra high vertical resolution maliva 2016b through prior core test based matrix permeability and machine learning model training nmr logging data can be core calibrated to obtain vertical high resolution matrix permeability profiles if the in situ properties of the formation water are known this k profile can finely interpret the heterogeneity information contained in a medium scale effective hydraulic conductivity at the sub meter scale in addition continuous matrix permeability profiles can be used to calculate the average matrix permeability upscaled to any scale for the macroscopic hydrogeological simulation most importantly shallow sandstone aquifers and carbonatite aquifers often have preferential flow through fracture networks forming a dual porosity feature worthington et al 2019 continuous matrix permeability profiles can be combined with pumping tests to clarify the contribution of these secondary pores fracture network which is crucial for the fracture network to model hydrological behavior maliva 2016a lei et al 2017 5 conclusions in this study nine machine learning models were used to predict the k of sandstone aquifers with seven orders of magnitude variation based on nmr t 2 data the main conclusions are drawn as follows 1 the classical schlumberger doll research sdr and timur coates models provided an unacceptable error for k however the nmr driven models can achieve rapid and accurate predictions of k from 132 sandstone cores with a wide range of 1 8 10 18 1 54 10 11 m2 2 three categories of machine learning algorithms were developed including linear regression decision tree regression and boosting algorithms it was demonstrated that the boosting methods show better performance in predicting k compared with linear based and tree based models 3 the pre processing of the input data directly affects the performances of machine learning models using cumulative t 2 relaxation data as input showed better performance than the original t 2 relaxation data for machine learning models especially the gbdt model achieved the optimal results in the total nine machine learning models with the best correlation coefficient of 0 9227 and the lowest mse of 0 1166 4 through visualization and shap interpretation tools in the gbdt model decision making process the x 38 variable provided the largest positive contribution in the cumulative t 2 data which may be attribute to that the x 38 variable 501 ms of t 2 time reflects intermediate and critical pore size information controlling flow however the x 26 variable 31 6 ms of t 2 time provided the largest negative contribution which may be attribute to that x 26 represents the size information of bound water pores in this dataset 5 this work provides insights into the prediction process from curve to value or spectrum to value the input data need to be preprocessed to highlight the differences between each other for improving the performance of the machine learning models this work using curve to value has some potential applications such as 1 predicting matrix permeability or unsaturated hydraulic conductivity from pore size distribution particle size distribution and soil water characteristic curves swcc and 2 enhancing industrial accuracy of hydrogeophysical nmr well logging in predicting k to provide a continuous matrix permeability profile declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china no 42002171 the china postdoctoral science foundation and special foundation nos 2020tq0299 2020m682520 and the postdoctoral innovation science foundation from hubei province of china china scholarship council is gratefully acknowledged for funding chen s research the zhanjiang branch of cnooc is appreciated for the support of experiments and samples the authors really appreciate the valuable discussions with prof martain j blunt of imperial college london uk the experimental data used can be available at 10 5281 zenodo 6487905 
