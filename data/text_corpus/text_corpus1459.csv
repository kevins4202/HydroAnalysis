index,text
7295,a modified green and ampt model is formulated to quantify infiltration on sloping terrain underlain by homogeneous soil wetted by surficial water application this paper s theory for quantifying infiltration relies on the mathematical statement of the coupled partial differential equations pdes governing infiltration and runoff these pdes are solved by employing an explicit finite difference numerical method that yields the infiltration the infiltration rate the depth to the wetting front the rate of runoff and the depth of runoff everywhere on the slope during external wetting data inputs consist of a water application rate or the rainfall hyetograph of a storm of arbitrary duration soil hydraulic characteristics and antecedent moisture and the slope s hydraulic and geometric characteristics the presented theory predicts the effect an advancing wetting front has on slope stability with respect to translational sliding this paper s theory also develops the 1d pde governing suspended sediment transport and slope degradation caused by runoff influenced by infiltration three examples illustrate the application of the developed theory to calculate infiltration and runoff on a slope and their role on the stability of cohesive and cohesionless soils forming sloping terrain keywords infiltration kinematic wave runoff factor of safety landslides rainfall 1 introduction this paper develops and tests a numerical model for the prediction of infiltration runoff and soil stability in slopes subjected to water application by rainfall or other forms of surficial water application e g irrigation our work also develops the 1d pde governing suspended sediment transport and slope degradation caused by runoff influenced by infiltration fig 1 depicts the geometry considered in this work showing a slope with angle θ length l and width b perpendicular to the plane of the figure a water application rate or rainfall rate r t wets the slope the rate of water application could be caused by artificial means such as irrigation the water application rate may cause runoff on the slope if it exceeds the infiltration rate g in that case the variable depth of runoff is denoted by d in fig 1 the water pressure exerted by a water depth d equals d cos θ γ w as shown in fig 1 with γ w denoting the unit weight of water 9 81 kn m3 the equations governing runoff and infiltration on sloping terrain are derived relying on cartesian coordinates s and z shown in fig 1 the axis of the s coordinate is parallel to the slope surface and s increases downslope the axis of the coordinate z is normal to the axis s and increases downwards from the slope surface the runoff on the slope varies with distance s and with time and is denoted by q s t it is seen in fig 1 that the infiltration rate has components equal to g cos θ and g sin θ along the coordinates z and s respectively the slope s soil has a volumetric water content deficit equal to w o n v o prior to the onset of infiltration in which n denotes the porosity of the soil and v o represents the antecedent volumetric water content the depth to the wetting front varies along the slope and is represented by two variables z vf and z f the former variable is measured vertically downward from the slope surface and the latter is measured downward from the slope surface along the coordinate axis z as depicted in fig 1 the infiltration is denoted by g units of length whose time derivative equals the infiltration rate i e g t g units of length over time the volume of water entering the soil fills the available pore space n v o as it moves vertically downward on a per unit area of slope such volume of water equals the infiltration g which in turn equals the depth of water penetration times the available pore space that fills with entering water this reasoning in conjunction with the geometry of the coordinates aligned with the vertical axis and with the axis normal to the slope surface leads to eqs 1 and 2 expressing respectively the depths z vf and z f in terms of the infiltration and the volumetric water content deficit as follows 1 z vf g n v o 2 z f g n v o cos θ the soil water tension along the wetting front is denoted by h pf units of length in fig 1 the soil water tension equals the negative of the pore pressure head along the wetting front and thus is a positively valued variable given that the pore pressure in unsaturated soil is negative i e less than atmospheric the soil water tension on the wetting front h pf is a hydraulic characteristic that varies with soil texture see e g rawls and brakensiek 1983 rawls et al 1992 this work introduces a modified version of the classic green and ampt infiltration model see green and ampt 1911 applicable to sloping terrain subjected to time variable surficial wetting a review of the green and ampt model the g a model henceforth and its underlying assumptions can be found in dingman 2015 among others this work s modified g a model calculates coupled infiltration and runoff on sloping terrain and resolves the effect of infiltration depth on slope stability furthermore this paper presents the 1d pde describing the combined erosive power of slope runoff and infiltration the erosion rate is expressed as function of the runoff rate infiltration rate and suspended sediment concentration under approximate steady state conditions the simultaneous calculation of slope wetting infiltration runoff and erosion constitutes this paper s theoretical novelty the numerical algorithms for the calculation of slope infiltration runoff and slope stability constitute the practical result of this paper s theory the original g a infiltration model estimates the infiltration in a homogeneous and isotropic soil underlying level ground the classic g a model has been implemented by several authors see e g mein and larson 1973 morel seytoux 1980 hydrologic engineering center 2000 chen and young 2006 reported a model for g a infiltration in sloping surfaces the latter work did not address the effect of infiltration on slope stability and slope degradation as this paper does the g a model has been shown to comply well with the richards equation results under the model assumptions salvucci and entekhabi 1995 loáiciga 2005 reported calculation of groundwater recharge to sloping aquifers loáiciga and huang 2007 presented a g a infiltration model that accounted for temporally variable rainfall with interspersed dry periods in which the ponding depth was depleted by infiltration and evaporation several authors have reported simulations of surface flow affected by infiltration on sloping terrain relying on models other than the g a formulation strelkoff and clemmens 1994 for example calculated surface flow in sloping border irrigation by solving the saint venant equations with infiltration described by kostiakov s formula bradford and katopodes 2001 presented a finite volume model for unsteady two dimensional shallow water flow to simulate the advance and infiltration of an irrigation wave in non level basins wöhling et al 2004 reported a surface subsurface flow model for furrow irrigation employing the hydrus 2d model for subsurface simulation of water flow zerihun et al 2005 developed a hydraulic model coupled to a surface model hydrus 1d for flow and solute transport in irrigation borders and basins the four latter publications on irrigation models did not address slope stability by soil wetting weill et al 2009 reported a numerical model for coupled surface and subsurface flow simulation with the objective of elucidating water dynamics in catchments with consideration to the surface subsurface interface employing a generalized richards equation their model was not concerned with the analysis of slope stability or erosion caused by slope wetting morbidelli et al 2018 presented a review of research dealing with infiltration on sloping terrain this paper s contribution is the development of the g a model for infiltration on sloping ground coupled with kinematic wave modeling of runoff the infiltration runoff model solves the coupled equations of runoff and infiltration driven by time variable water input on sloping terrain this paper generalizes the work of johnson and loáiciga 2017 by considering the existence of lateral subsurface flow downslope by applying a time variable upstream boundary condition at s 0 for infiltration that accounts for the temporal evolution of soil wetting at the slope crown and by elucidating the effect of infiltration on slope erosion centrally this paper resolves the effect an advancing wetting front has on reducing the factor of safety fs against translational sliding in sloping terrain formed by cohesive or cohesionless soils our work generalizes the slope sliding model by iverson 2000 by jointly simulating infiltration and slope runoff and accounting for their combined effect on translational slope stability this paper s analytical and numerical methods complement experimental research of infiltration in sloping terrain morbidelli et al 2015 2016 lastly this work develops the pde governing suspended sediment continuity and submerged slope degradation caused by external wetting and influenced by infiltration section 2 presents the geometric setting hydrologic methods and numerical algorithms employed in this paper section 3 summarizes this paper s results section 4 outlines extensions to the theory presented in section 2 the extensions cover linearly variable antecedent water content and the development of the partial differential equations governing suspended sediment concentration runoff infiltration and slope degradation section 5 conclusion summarizes this paper s key findings the appendix a develops the 2d richards equation for unsaturated soil in arbitrarily rotated cartesian coordinates all the symbols employed in this paper are listed in section 6 symbology a list of bibliographic references is found in the section 2 theory and methods 2 1 the g a infiltration equation in sloping terrain this section develops a g a infiltration model for sloping terrain prior to the initiation of runoff at time t q infiltration equals the cumulative water input r 3 g s t r t 0 t t q 0 s l once runoff begins a positive pressure head d cos θ in fig 1 forms on the slope surface z 0 which gives rise to simultaneous and coupled infiltration and runoff fig 2 depicts a representative elementary volume abcd rev whose sides are oriented parallel to the axes s and z introduced in fig 1 the third dimension of the rev shown in fig 2 is unitary and perpendicular to the s and z axes the hydraulic head h within the rev is defined with respect to a datum on which the elevation head z v 0 and z v increases in magnitude in a downward direction as shown in fig 2 the pressure head within the rev is negative given that it is partially saturated the pressure head within the rev is denoted by h p in which h p represents the soil water tension positive in m the hydraulic head within the rev equals h z v h p this choice of variables and the geometry of fig 2 imply that δ z v δ z cos θ and δ z v δ s sin θ it follows that in the limit as δ s δ z and δ z v 0 the darcian fluxes q s and q z along the axes s and z respectively are given by the following equations 4 q s k h s k sin θ k h p s 5 q z k h z k cos θ k h p z in which k denotes the soil s hydraulic conductivity the unsaturated hydraulic conductivity can be expressed in terms of the volumetric water content according to the soil s moisture conductivity curve alternatively the unsaturated hydraulic conductivity is expressible as a function of the soil water tension relying on the soil s moisture characteristic curve brooks and corey 1964 campbell 1974 van genuchten 1980 the modified g a infiltration model expresses eq 5 for the subsurface water flux perpendicular to the slope in discrete form between the slope surface where z 0 and the wetting front where z z f the pressure head equals d cos θ on the slope surface and h pf on the wetting front therefore letting k o denote the saturated hydraulic conductivity the darcian flux along coordinate z is given by 6 q z k o cos θ k o d cos θ h pf z f the infiltration rate along the z coordinate equals g cos θ which equals the darcian flux given by eq 6 furthermore the infiltration rate equals the time derivative of the infiltration g eq 6 is valid after the time t q when runoff begins and generates a positive pressure head on the slope surface the g a formulation of the darcian flux in eq 6 assumes a piston like advance of the wetting front with the pressure head varying between d cos θ on the slope surface and h pf at the wetting front the homogeneous soil layer of thickness z f between the slope surface and the wetting front is saturated these conditions render the g a model of infiltration quite tractable compared to a formulation based on the exact equation of unsaturated flow i e the 2d richards equation the exact formulation of infiltration on sloping terrain raises several complex issues concerning the calculation of the time to runoff initiation and the formulation of boundary conditions of the subsurface flow domain that do not arise with the g a model the appendix a presents an analysis of the 2d richards equation of unsaturated flow in rotated coordinates and explains the complexities that arise in solving simultaneously the runoff and infiltration equations with the exact formulation eq 6 is rewritten in terms of the infiltration g employing eq 2 to express z f and leveraging the fact that q z equals g cos θ g t cos θ 7 g s t t cos θ k o cos θ k o d s t cos θ h pf g s t n v o cos θ eq 7 is rewritten as a conventional partial differential equation 8 g g t k o g a o d a 1 0 t t q 0 s l where 9 a o k o n v 0 cos θ 10 a 1 k o n v 0 h pf cos 2 θ the initial condition for infiltration is that infiltration equals the cumulative rainfall or cumulative water input r t q at the time when runoff begins t q 11 g s t q r t q 0 s l the infiltration increment over a time step equals the amount of rain falling during that period whenever the runoff ceases and rainfall continues to fall the upstream boundary condition for infiltration takes into account that at s 0 the runoff depth d equals zero therefore setting d 0 in eq 8 permits writing the infiltration boundary condition in the following form that is useful for its numerical integration 12 g 0 t t k o a 1 g 0 t t t q eq 12 expressing the boundary condition for infiltration is integrated by separation of variables to yield the following implicit relation between time and infiltration 13 t t q g 0 t r t q k 0 a 1 k o 2 ln k o g 0 t a 1 k o r t q a 1 t t q eq 12 is the preferred formulation of the boundary condition for the purpose of numerical solution of the infiltration problem it is worthy of mention that the g a formulation of infiltration with water application on a slope involves simple flow domain geometry depicted in fig 1 and mathematical description of the boundary condition no assumption is necessary for a phreatic surface beneath the wetting front eqs 8 12 summarize the mathematical statement for infiltration on sloping terrain eq 8 involves the unknown runoff depth a second equation is needed for the runoff depth which is derived employing kinematic wave theory in the kinematic wave runoff section a key variable for slope stability analysis is the depth to the wetting front which is calculated with either eqs 1 or 2 once the infiltration is resolved 2 2 the time to the initiation of slope runoff t q the time required to initiate slope runoff t q is defined by the instant in which the component of the rainfall rate or water input rate in general along the coordinate z first equals the infiltration rate along that same coordinate employing eq 7 with d 0 we have 14 r t q cos θ k o cos θ k o h pf r t q n v o cos θ in which r t q denotes the cumulative rainfall at time t q eq 14 must be solved numerically for most instances of variable water input the case of constant water input r o leads to a closed form solution for t q 15 t q 1 r o k o h pf n v o r o k o cos 2 θ where the constant water input r o must exceed the saturated hydraulic conductivity k o to obtain physically meaningful results another case of interest in this work is that of a symmetric triangular water input rate over a duration d as shown in fig 3 in fig 3 the rising limb of the water input rate is expressed as r c t in this case the time t q is the smallest root positive and real valued of the following third order polynomial 16 b o t 3 b 1 t 2 b 2 0 where b o c 2 cos 2 θ b 1 ck 0 cos 2 θ b 2 2 k o h pf n v o determining the time t q for rainfall rates specified as a time series of discrete values of rain depth r d each occurring over a computational time period δ t requires a numerical solution of eq 14 fig 4 depicts the united states department of agricultural s natural resources conservation service nrcs 24 h type i rainfall hyetograph in this case scaled to produce a depth of rain equal to 0 400 m notice the high intensity of rainfall near half the duration of the storm letting the index j denote the counter for time intervals j 1 2 t the cumulative rain at time j δ t is calculated as follows 17 r j δ t l 1 j r d l δ t the discrete form of eq 14 applied to estimate the time t q takes the form 18 r d j δ t δ t k o k o h pf r j δ t n v o cos 2 θ the value j that satisfies eq 18 for the first time is denoted by j q and the time of runoff initiation is given by t q j q δ t 2 3 kinematic wave runoff runoff on a slope surface is wide and shallow resulting in a hydraulic radius approximately equal to the depth of runoff d this permits the application of the kinematic wave approximation to the flow equation on a slope runoff is herein modeled with the kinematic wave approximation to the equation of 1 d of overland flow on a slope with accretion by rainfall and depletion by infiltration the kinematic flow approximation expresses the flow rate as a function of the depth of flow see e g chow 1959 cunge et al 1980 chaudry 1993 johnson and loáiciga 2017 singh 2017 the kinematic wave flow equation is as follows 19 β m d m 1 d s d t r g r g t in which d denotes the depth of runoff g and r denote respectively the infiltration rate and rainfall rate and the derivative of the infiltration g with respect to time is represented by g t g the coefficient m 5 3 and β is defined as 20 β 1 n s 0 where n and s 0 denote the manning s roughness coefficient and the slope of the terrain respectively the initial condition of eq 19 is defined as follows 21 d s t t q 0 0 s l in which t q denotes the time when runoff emerges on the slope the depth of runoff equals zero prior to the time t q the boundary condition of eq 19 at the upstream end is given by 22 d s 0 t 0 t t q the overland flow q s t in m3 s at location s and time t is given by manning s equation 23 q s t 1 n s 0 b d s t 5 3 the following section introduces a numerical method for the joint solution of the infiltration and runoff equations outlined above 2 4 numerical solution of the infiltration and runoff equations 2 4 1 explicit finite difference formulation of the infiltration equation the flow domain has m 1 nodes with an inter nodal separation equal to δ s as shown in fig 1 the nodal index equals k 0 1 2 3 m the node at k 0 corresponds to the upstream boundary where the value of runoff depth equals zero the time domain is divided into a computational time step δ t with time index j 1 2 t the finite difference explicit numerical discretization of the infiltration eq 8 applied in this work is given by the following expression 24 g k j 1 g k 1 j 1 2 g k j g k j 1 δ t k o g k j 1 g k 1 j 1 2 a 0 d k j d k j 1 2 a 1 0 k 1 2 3 m and j j q 1 j q 2 j q 3 where t q j q δ t represents the time of runoff initiation the indexed notation applied in eq 24 is such that 25 g k 1 j 1 g k 1 δ s j 1 δ t 26 g k j 1 g k δ s j 1 δ t 27 g k j g k δ s j δ t 28 d k j d k δ s j δ t 29 d k j 1 d k δ s j 1 δ t the initial condition associated with eq 24 is given by the following formula 30 g k j q r t q k 0 1 2 3 m the boundary condition of eq 24 is the discretized form of eq 12 at k 0 31 g 0 j g 0 j 1 k o δ t a 1 δ t g o j 1 in which j j q 1 j q 2 j q 3 2 4 2 explicit finite difference formulation of the kinematic wave runoff the kinematic wave pde 19 is a nonlinear hyperbolic pde smith 1984 this paper implements a modified lax wendroff explicit finite difference method for its solution see lax 1954 and smith 1984 for an exposition of the lax wendroff method the explicit numerical scheme for kinematic wave runoff must meet the following numerical courant friedrichs lewy cfl stability condition courant et al 1928 cunge et al 1980 smith 1984 hydrologic engineering center 2000 johnson and loáiciga 2017 32 δ t δ s g d in which g equals 981 cm s2 and represents the acceleration of gravity and d denotes an average depth of runoff the selection of δ t and δ s must be made judiciously to satisfy eq 32 thus for example δ s may be set equal to 100 cm 1 m to calculate runoff depth and infiltration with adequate spatial resolution in which case by virtue of eq 32 δ t may not exceed 1 4 s for an average runoff depth d 5 cm the explicit finite difference formulation of the kinematic wave runoff equation is relatively simple and it is stable and accurate when the condition 32 is met and a suitable inter nodal computational step is chosen it is obtained by discretizing eq 19 the node at k 0 corresponds to the upstream boundary where the value of runoff depth equals zero 33 d k j d k j 1 δ t β m d k j 1 d k 1 j 1 2 m 1 d k j 1 d k 1 j 1 δ s r k j g k j g k j 1 δ t k 1 2 3 m and j j q 1 j q 2 j q 3 the following indexed notation applies to d k 1 j 1 and to the water application rate r in eq 33 34 d k 1 j 1 d k 1 δ s j 1 δ t 35 r k j r j δ t the initial condition associated with eq 33 is 36 d k j q 0 k 0 1 2 3 m the upstream boundary condition associated with eq 33 specifies zero depth at the slope s crown implying a dirichlet boundary value problem whose upstream boundary condition is 37 d 0 j 0 j j q 1 j q 2 j q 3 the kinematic wave runoff rate is calculated with the following equation 38 q k j 1 n s 0 b d k j 5 3 k 1 2 3 m and j j q 1 j q 2 j q 3 2 4 3 explicit finite difference solution of the infiltration and kinematic wave runoff equations eqs 24 and 33 constitute a set of coupled nonlinear finite difference equations involving the unknowns d k j and g k j the discretized infiltration eq 24 is rewritten in explicit form for the infiltration in the current time step 39 g k j g k j 1 a k k 1 j 1 d k j b k k 1 j 1 k 1 2 3 m and j j q 1 j q 2 j q 3 in which 40 a k k 1 j 1 a 0 2 g k k 1 j 1 41 g k k 1 j 1 g k j 1 g k 1 j 1 2 δ t 42 b k k 1 j 1 k o δ t a 1 g k k 1 j 1 a 0 g k k 1 j 1 d k j 1 2 the runoff depth eq 33 is rewritten in explicit form for the current time step 43 d k j d k j 1 g k j f k k 1 j 1 in which 44 f k k 1 j 1 x k k 1 j 1 r d k j g k j 1 where r d k j r k j δ t denotes the depth of water application in time step j δ t at node k 45 x k k 1 j 1 δ t β m d k j 1 d k 1 j 1 2 m 1 d k j 1 d k 1 j 1 δ s eq 39 for g k j is substituted into eq 43 to produce an explicit equation for the runoff depth in the j th computational time step 46 d k j h k k 1 j 1 d k j 1 h k k 1 j 1 g k j 1 h k k 1 j 1 b k k 1 j 1 h k k 1 j 1 f k k 1 j 1 k 1 2 3 m and j j q 1 j q 2 j q 3 with boundary condition d 0 j 0 in which 47 h k k 1 j 1 1 1 a k k 1 j 1 the runoff depth calculated with eq 46 must be non negative for physical feasibility the solution algorithm for coupled runoff and infiltration starts by solving eq 46 at time step j q 1 δ t once the runoff depth has been calculated it is used in eq 39 to solve for the infiltration at time step j q 1 δ t the time index is then increased to j q 2 and the consecutive solutions for runoff depth and infiltration are calculated at all active nodes the solution algorithm is advanced to the third and higher time steps by increasing the time index j by one unit consecutively solving for infiltration and runoff depth in each time step until reaching the end of the simulation the ratio input output input 100 constitutes the percentage error in mass balance associated with the calculated runoff and infiltration with input cumulative rainfall and output cumulative runoff volume infiltration the percentage error measures the accuracy of the numerical solution scheme in preserving balance of inputs and outputs see e g mcdonald and harbaugh 1988 the accuracy of the numerical algorithm is evaluated by checking the percentage error in mass balance approaches zero upon termination of the numerical simulation as shown in the results section this paper s simulation algorithm for solving eqs 39 and 46 was written in the public domain software r the program is accessible at https github com mikejohnson51 rainslope for free download 2 4 4 the depth to the wetting front the depth to the wetting front is a key factor controlling slope stability it is calculated at any node k and time step j δ t with the following equation 48 z vf k j g k j n v 0 in which k 0 1 2 m j 1 2 3 notice that for j 1 2 3 t q the infiltration g k j equals the cumulative rainfall r j δ t 2 5 slope infiltration and translational slope stability the classic model for translational slope stability proposes that subsurface water perches over a surface of hydraulic conductivity lower than that of the overlying slope s soil the surface of hydraulic conductivity discontinuity is the slip surface along which overlying soil may move downslope causing landslides the rising thickness of saturation above the slip surface reduces the frictional effective stress on that surface and may cause sliding along the slip surface descriptions of the classic infinite read long slope translational stability model can be found in duncan et al 2014 and loáiciga 2015 among others however empirical evidence indicates slopes wetted by rainfall commonly do not feature such zones of conductivity discontinuity in fact many translational landslides occur in relatively homogeneous soils driven by the downward advance of saturation as depicted in fig 5 and not by the rise of perched saturation above the slip surface as proposed by the classic model of translational slope stability it is possible air may be entrapped along the wetting front when there is rapid infiltration thus hindering the advance of the wetting front and creating positive pore water pressure through the zone of saturation it might possible also that a reduction in hydraulic conductivity produce a profile of positive pore water pressure through the zone of saturation these condition is propitious for shallow sliding wherever the advance of the wetting front is retarded this work introduces a method for evaluating translational slope stability considering coupled runoff and infiltration soil characteristics and slope geometry the soil saturated unit weight and the antecedent unit weight prior to external wetting are denoted by γ o and γ respectively as shown in fig 5 let c and ϕ denote respectively the effective cohesion and the effective angle of friction of the slope s soil the ratio of the resisting stress along the slip surface shown in fig 5 to the driving stress that often destabilizes the slope along that surface is called the factor of safety fs the slope is stable when the factor of safety exceeds 1 is unstable when the factor of safety is less than 1 and is in limiting equilibrium when the factor of safety equals 1 the factor of safety fs o at a depth z vf is determined by force equilibrium and geometric analyses of the soil block depicted in figure prior to infiltration the factor of safety is given by the following expression in which the pressure head at depth z vf prior to saturation is denoted by h p 0 h pf 49 fs o c z vf γ cos θ sin θ 1 h po z vf γ w γ 1 cos 2 θ tan ϕ tan θ as water infiltrates it changes the water content of the slope s soil at the advancing wetting front the soil water tension at depth z vf equals h pf and the factor safety equals 50 fs c z vf γ o cos θ sin θ 1 h pf z vf γ w γ o 1 cos 2 θ tan ϕ tan θ eq 50 demonstrates the factor of safety decreases with increasing depth of the wetting front z vf therefore the deeper a wetting front driven by infiltration advances the greater the reduction of the factor of safety would be with concomitant reduction of slope stability a comparison of eqs 49 and 50 demonstrates the factor of safety with infiltration eq 50 is less than that without infiltration for the same depth z vf because eq 50 features a larger unit weight saturated unit weight γ o and a smaller soil water tension h pf rapid infiltration may trap air in the soil along the wetting front which may slow down or impede further infiltration in this instance the water pressure would equal d cos θ γ w on the slope surface see fig 1 and d cos θ z vf cos 2 θ γ w along the wetting front this situation may also arise if the hydraulic conductivity is reduced at depth z vf yet it would be caused by induced saturation from the slope surface downward rather than by perching of soil water over a soil discontinuity as assumed in the classic model of slope stability loáiciga 2015 either one of these two situations is associated with a factor of safety given by 51 fs c z vf γ o cos θ sin θ γ o γ w γ o tan ϕ tan θ from eq 51 follows the maximum angle a slope of cohesionless soil c 0 may have and be stable 52 θ tan 1 γ o γ w γ o tan ϕ eq 52 states the maximum angle natural or constructed slopes may have when induced soil saturation produces air trapping along the wetting front or a reduction of hydraulic conductivity occurs at any depth the results section offers examples of the effect of infiltration on translational slope stability 3 results 3 1 cohesive soil the first example illustrates this paper s theory with a cohesive soil with negligible friction strength whose factor of safety against sliding is given by the first term of the right hand side of eq 50 two 24 h storms were employed in separate applications of this paper s runoff infiltration method and slope stability analysis table 1 lists the slope geometry and hydraulic parameters applied in this example the spatial computation step was set to δ s 1 m and the time step δ t 1 s numerical calculations were also conducted with combinations of δ s and δ t that satisfied the cfl stability condition 32 while keeping δ s less than 2 m the numerical simulation produced identical results with all chosen combinations of δ s and δ t two distinct rainfall distributions were employed one of the storms had a constant intensity yielding a total depth of 0 400 m over 24 h see diagram in fig 3 with the rainfall rate r 0 4 63 10 6 m s the other storm features a symmetric triangular rainfall rate as depicted in fig 3 with the slope coefficient in fig 3 having magnitude 2 14335 10 10 m s2 in the rising and recession limbs respectively also yielding 0 400 m of rain over 24 h table 2 lists the cohesive soil s characteristics used in this example which in this case are the porosity n volumetric water content v 0 water tension at the wetting front h pf hydraulic conductivity k 0 effective cohesion c and saturated unit weight γ o fig 6 illustrates the determination of the time of runoff initiation t q corresponding to the constant rainfall rate t q equals 3610 s in this case which is the time when the rainfall rate equals the infiltration rate notice the relatively high rate of infiltration at early time fig 7 displays the diagram illustrating the determination of the time of runoff initiation associated with the triangular rainfall rate in which case t q 15 858 s it is seen in fig 7 the constant rainfall rate generates runoff at a much earlier time t q 3610 s than the symmetric triangular rainfall rate it is seen in fig 7 the relatively high value of the infiltration rate at early time fig 8 displays the variation of the runoff depth calculated for various times since the beginning of constant rainfall that delivers 0 400 m of water in 24 h the graphs shown in fig 8 demonstrate the runoff depth converges to a steady state after 1365 min of uniform rainfall and so does the runoff rate because it is a function of the depth in the kinematic wave formulation see eq 23 the infiltration rate corresponding to the runoff depth that approaches steady state is derived from eq 8 to yield the following expression when d s t d s 53 g s t k o a o d s a 1 g s t fig 9 displays the calculated runoff depth d associated with the constant and triangular symmetric rainfall rates the runoff depth was calculated at the toe of the slope s l 300 m where it reaches its maximum magnitude it is seen in fig 9 the earlier appearance of runoff produced by the constant rainfall rate the runoff depth produced by constant rainfall increases rapidly until the time when the entire slope is contributing to runoff at the toe of slope which happens at about 9000 s when the runoff depth is about 7 mm thereafter the runoff depth increases slowly from about 7 mm to about 9 mm of depth at the end of the rainfall event 24 h 86 400 s the graph of runoff depth corresponding to the triangular rainfall indicates the rate of increase of the runoff depth is largest between 0 and 20 600 s peaking at the latter time when the runoff depth equals 5 7 mm at this time the entire slope is contributing runoff to the slope s toe the runoff depth caused by the triangular rainfall increases until reaching a maximum at about 44 000 s when it equals about 15 5 mm at the slope s toe thereafter it decreases to a nil value at 82 400 s the overall shapes of the runoff depth diagrams associated with the constant and triangular rainfalls at all other locations along the slope 0 s l are similar to those depicted in fig 9 but with the depth d progressively scaled down as each approaches the upstream boundary where d 0 for all times fig 10 displays the calculated depth to the wetting front associated with the constant and triangular rainfalls the depths to the wetting front were calculated at the times of initiation of runoff t q corresponding to the constant and triangular rainfalls which were 3610 and 15 858 s respectively and at the end of rainfall 86 400 s the depth to the wetting front at the end of rainfall is of special importance because it represents the critical condition for slope stability as shown below fig 10 indicates the depth to the wetting front is fairly uniform along the slope reaching its largest magnitude at the slope toe the depths to the wetting fronts associated with constant rainfall and triangular rainfall at the slope toe equal 1 30 and 1 13 respectively evidently infiltration is more effective when the water application rate is constant all other factors being equal therefore the constant rainfall poses a greater hazard to slope stability than the triangular rainfall due to its deeper penetration depth the percentage error in mass balance was less than 0 1 in this example which demonstrates the accuracy of the calculated infiltration and cumulative runoff the factor of safety shown in fig 11 was calculated with the first term on the right hand side of eq 50 for a soil exhibiting cohesive strength only which as listed in table 2 is typical of a very soft cohesive soil c 10 kn m2 in this example nevertheless the results of fig 11 indicate this slope would remain stable when the wetting front reaches its maximum value equal to 1 30 m which has a corresponding factor of safety equal to 2 the factor of safety was extrapolated to a depth of the wetting front equal to 2 60 m in fig 11 which is the depth the wetting front would need to penetrate to cause a translational slide the results from this example establish that translational slides are unlikely to occur even in soft cohesive soils by external wetting unless the soil is sensitive and its structure collapses under wetting cohesive homogeneous soils are more prone to fail along circular or logarithmic spiraled deep seated slip surfaces lambe and whitman 1969 griffiths and marquez 2007 duncan et al 2014 loáiciga 2015 3 2 cohesionless soil cohesionless soils effective cohesion c 0 are known to be prone to translational sliding by rainfall wetting cedegren 1989 loáiciga 2015 and they cause substantial loss of life and property annually the world over see e g schuster et al 2002 the factor of safety against sliding of a cohesionless soil is given by the second term on the right hand side of eq 50 the calculation of coupled runoff and infiltration and their effect on slope stability is illustrated in this second example relying on the nrcs 24 h type i rainfall hyetograph scaled to a total depth of rainfall equal to 0 400 m shown in fig 4 table 3 lists the hydraulic and geometric properties applied in this second example in which the computational steps δ s and δ t were set to 10 m and 10 s respectively numerical calculations were also conducted with combinations of δ s and δ t that satisfied the cfl stability condition 32 while keeping δ s less than 10 m numerical simulations produced identical results with all chosen combinations of δ s and δ t the slope used in this second example is steeper than in the first example table 4 lists the cohesionless soil s properties applied in this example which in this case are the porosity n volumetric water content v 0 water tension at the wetting front h pf hydraulic conductivity k 0 effective friction angle ϕ and saturated unit weight γ o one remarkable feature of the cohesionless soil employed in this example is that it is ten times more permeable than the cohesive soil of the first example compare the k 0 values in tables 2 and 4 the friction angle of the cohesionless soil 35 is less than the slope angle 39 81 meaning the cohesionless soil is stable so long as the friction stress induced by soil water tension is sufficient to overcome the deficit of frictional strength that would occur on the same dry slope with the given geometric characteristics fig 12 displays the time history of the rainfall rate infiltration rate the time of initiation of runoff t q 34 740 s and the infiltration g at the slope toe it is evident the duration of excess rainfall generating runoff is short lived starting at the time of initiation of runoff t q 34 740 s the infiltration at the slope toe equals 0 326 m at the end of rainfall meaning 0 074 m of the total rainfall 0 400 m drains from the slope as runoff at that location fig 13 displays the calculated runoff depth d and the depth to the wetting front at the toe of the slope z vf runoff begins at time 34 740 s and ends at 46 630 s at this location this is the time interval when rainfall is most intense which causes the wetting front to advance at its fastest rate during the 24 h period of rainfall the depth to the wetting front reached a maximum equal to 2 17 m the calculated percentage error in mass balance was less than 0 1 in this example proving the accuracy of the numerical algorithm fig 14 depicts the factor of safety fs calculated for the cohesionless soil with properties listed in table 4 the factor of safety graphed in fig 14 was calculated with the second term on the right hand side the frictional term of eq 50 it is evident from fig 14 the slope would fail in this case when the depth to the wetting front reaches 0 65 m which corresponds to 0 0975 m of infiltration 0 65 0 15 where 0 15 equals the water content deficit n v 0 this shows permeable soil receiving rainfall depth on the order of 0 0975 m could experience sliding eq 52 can be employed to calculate the maximum slope angle for which slope stability is maintained when the advance of the wetting front is impeded by compressed air or a reduction of hydraulic conductivity at any depth thus causing positive pressure from the slope surface through the wetting front using a saturated unit weight equal to 20 kn m3 and angle of effective friction equal to 35 as before it is determined the maximum angle the slope may have to be stable equals 19 6 4 extensions of this paper s theory 4 1 linearly variable antecedent volumetric water content the theory presented in this work assumes a constant antecedent volumetric water content v o this section describes an extension of this paper s theory to include an antecedent water content that varies linearly with depth as shown in fig 15 the antecedent volumetric water content v o is given by the following expression 54 v o z a e 0 z in which the coefficients a and e 0 describe the variation of the antecedent water content with depth as depicted in fig 15 the antecedent water content v o increases or decreases with increasing depth z when the coefficient e 0 is positive or negative the component of infiltration along the axes equals the integral of the water content deficit from the slope surface to the depth of the wetting front z f 55 g cos θ z 0 z f n v 0 z dz n a z f e 2 z f 2 substituting eq 54 into eq 7 produces the following partial differential equation for the depth to the wetting front 56 n a e z f z f z f t k o cos θ z f k o d s t cos θ h pf 0 by solving eq 56 numerically for z f s t one can obtain the infiltration from eq 55 57 g s t 1 cos θ n a z f e 2 z f 2 eq 56 involves the runoff depth d s t the numerical solution of eqs 56 and 57 for infiltration and of eq 19 for the runoff depth proceeds similarly to the explicit finite difference algorithm described in this paper for the case when e 0 i e constant antecedent water content deficit n v o the calculation of the time to the initiation of runoff t q when the antecedent water content varies linearly with depth is needed to solve the runoff and infiltration equations recall slope runoff begins when the rainfall rate first equals the infiltration rate and exceeds it immediately thereafter this condition is determined resorting to eq 6 to yield the following equality 58 r t q k o k o h pf z f s t q cos θ in which z f s t q must be written in terms of the infiltration at time t q or g s t q which in turn equals the cumulative rainfall at time t q i e g s t q r t q the formula expressing z f s t q in terms of the cumulative rainfall r t q is obtained by solving the quadratic eq 57 to yield the following result in this instance 59 z f s t q n a n a 2 2 er t q cos θ e where the following condition must be met for eq 59 to produce a real valued answer when the coefficient e is positive 60 n a 2 2 e r t q cos θ if e 0 eq 60 for z f s t q must be substituted in eq 56 and subsequently the time t q is that which achieves equality of the right hand and left hand sides of eq 58 the depth z f s t q represents the initial boundary condition of the pde 56 the upstream boundary condition of eq 56 for time t t q is derived by setting the runoff depth to zero in eq 56 at s 0 such that 61 n a e z f 0 t z f 0 t z f 0 t t k o cos θ z f 0 t k o h pf the upstream boundary condition for infiltration is derived from eq 57 once the depth to the wetting front at that location z f 0 t is solved for numerically 62 g 0 t 1 cos θ n a z f 0 t e 2 z f 0 t 2 the set of equations derived in this section plus those presented governing runoff can be solved to quantify infiltration runoff and translational slope stability when the antecedent water content varies linearly with increasing depth 4 2 continuity of suspended sediment and slope degradation the role of infiltration water moving on the surface of the earth is a key agent of landform change the processes of erosion sediment transport and sedimentation or deposition control how the land surface undergoes aggradation rise of its elevation or degradation lowering of its elevation the factors and processes governing erosion sediment transport and sedimentation by moving water are complex renard et al 1997 julien 2010 this paper has shown infiltration influences slope runoff and vice versa this section develops the advective pde of 1d suspended sediment continuity involving slope degradation driven by runoff and infiltration fig 16 depicts the variables and geometry that control the continuity or conservation of suspended sediment and slope degradation fig 16 displays the vertically averaged concentration of suspended sediment c ss s t and the thickness of slope degradation z vd s t the concentration of suspended sediment is herein defined as the volume of sediment detached from the slope surface per unit volume of water in the water column of depth d as shown in fig 16 the suspended sediment discharge q ss advected by runoff equals the runoff rate multiplied by the sediment concentration or q ss qc ss it has units of volume of suspended sediment per unit time slope degradation results from the detachment of sediment or soil from the slope surface that undergoes two types of downslope transport processes one process produces the motion of detached sediment that remains in contact with the eroding surface as it rolls and slides downslope the volume of sediment transported in this manner is called the bed load the bed load does not contribute to suspended sediment in the water column the second process transports detached sediment in suspension the volume of sediment transported in this manner is called the suspended load sediment detachment occurs when the shear stress on the slope surface exerted by moving water exceeds the critical shear stress necessary to mobilize soil particles the transport of detached sediment particles depends on the specific runoff and particle characteristics the critical shear stress of cohesive soils is commonly too large to be exceeded by the tractive shear exerted by shallow slope runoff smerdon and beasley 1961 moody and smith 2005 shan et al 2015 the impact of raindrops however can exert stresses that break up the bonds between cohesive soil particles prior to the initiation of runoff those particles may be transported by runoff thereafter as either bed load or suspended load depending on runoff and particle characteristics let z vb and z vs denote respectively the thicknesses of slope degradation caused by bed load and suspended load transport the corresponding volume of transported sediment are denoted respectively by v vb and v vs the total slope degradation is the sum of the degradations caused by bed load and suspended load transport z vd z vb z vs with a corresponding volume of transported sediment denoted by v vd the time rate of change of the total volume of sediment transport equals the sum of the time rate of change of the volume of sediment that is transported as bed load plus the time rate of change of the volume of sediment transported as suspended load expressed by the following formula 63 v vd t v vb t v vs t z vb t z vs t cos θ δ s b 1 n in which n denotes the porosity of the slope soil the equation of continuity of suspended load or suspended sediment developed in this section considers i the sediment load advected with runoff ii the sediment load carried onto the slope surface by infiltration and iii the volume of sediment eroded from the slope surface that becomes suspended load in the overlying water column v vs the balance of the rates of sediment in and out of the fluid control volume abcd shown in fig 16 determines the rate of change of the concentration of suspended load in the control volume the control body of water abcd encompasses a volume equal to b d δ s in which δ s denotes its dimension along the coordinate axis s the pde describing the continuity of suspended sediment is given by the following expression 64 1 b qc ss s c ss cos θ g t cos θ 1 n f z vs t c ss d t where n f represents the porosity of the sediment fraction that becomes suspended the initial condition associated with eq 64 prescribes zero sediment concentration at time t q when slope runoff begins the upstream boundary condition of eq 64 specifies the sediment concentration at s 0 is equal to zero for all time following the initiation of runoff the runoff depth d see the pde 19 and the infiltration rate see the pde 8 are coupled with the sediment concentration c ss governed by the pde 64 this constitutes a set of three coupled nonlinear pdes the rate of slope degradation by suspension and transport of detached sediment z vs t must be specified to solve the runoff infiltration and sediment continuity equations that rate must be expressed as a function of the runoff regime and sediment characteristics including its resistance to shear detachment see e g simons et al 1981 schiettecatte et al 2008 in general the rate of slope degradation introduces a fourth equation that must be coupled with the pdes for sediment transport runoff and infiltration to yield a tetrad of nonlinear equations their solution remains an unresolved research problem the rate of slope degradation can be solved for from eq 64 if steady state conditions are approached see figs 8 and 9 setting the runoff rate equal to its steady state value q s t q s in eq 64 and assuming the suspended sediment concentration converges to a steady state condition after sustained external constant wetting we have the following result 65 z vs t 1 b cos θ 1 n f q s c ss s s c ss s 1 n f g eq 65 states the rate of slope degradation is proportional to the sum of the change of suspended sediment with respect to slope location plus the deposition of suspended sediment induced by infiltration 5 conclusions this paper presented a theory for the calculation of slope runoff and infiltration and for the assessment of translational slope stability based on a generalization of the g a model to the case of sloping terrain several examples involving external water application by rainfall with different temporal distributions and relying on soil and hydraulic characteristics demonstrated the solution capacity of this paper s solution algorithm the solution algorithm was found numerically stable and accurate and its execution for several runs involving constant triangular or nrcs rainfall patterns required processing times of less than 10 min each in a standard laptop computer this paper s results demonstrated long and sustained water application produces larger infiltration than triangular or nrcs type rainfall distributions of the same duration and the same total depth of precipitation evidently infiltration is more effective when the water application rate is constant all other factors being equal therefore the constant rainfall or water application poses a greater hazard to slope stability than the other rainfall types or water applications this paper introduced a novel interpretation of and solution method for the long slope stability problem it was shown by quantitative analysis that cohesionless and unsaturated soils forming sloping terrain are prone to translational sliding as the wetting front descends through the soil profile this work demonstrated the stability of long slopes formed by cohesionless soils depends on basic factors such as slope geometry the water application rate the depth of penetration of the wetting front and the soil hydraulic and strength characteristics there is no requirement in this paper s slope stability theory for discontinuities of hydraulic conductivity within the wetted soil profile or the formation of a perched groundwater flow system to explain slope stability it was demonstrated however that compressed air or reduction of the hydraulic conductivity at any depth imposes a limiting slope angle to preserve stability on the other hand this paper has shown long slopes formed by cohesive soils are not likely to undergo shallow sliding by a penetrating wetting front the pde relating the continuity of suspended sediment to the rate of slope degradation caused by slope runoff and influenced by infiltration was developed in this work the pde governing suspended sediment concentration must be coupled with the pdes governing infiltration and runoff to form a system of three nonlinear pdes from which to calculate sediment concentration runoff and infiltration provided the rate of slope degradation is unknown or is formulated in terms of runoff and soil resistance characteristics the joint solution of the runoff infiltration sediment transport and slope degradation equations for sloping terrain remains an unresolved research problem 6 symbology the symbols l and t denote units of length and time respectively kn and kpa denote kilo newtons and kilo pascals respectively a antecedent volumetric water content at the slope surface depicted in fig 15 dimensionless a o coefficient defined in eq 9 l t 1 a 1 coefficient defined in eq 10 l 2 t 1 a k k 1 j 1 recursive equation defined in eq 40 dimensionless b slope width l b o coefficient in the polynomial of eq 16 l 2 t 4 b 1 coefficient in the polynomial of eq 16 l 2 t 3 b 2 coefficient in the polynomial of eq 16 l t 2 b k k 1 j 1 recursive coefficient defined in eq 42 l c slope of the rising limb of triangular rainfall depicted in fig 3 l t 2 c effective cohesion of the slope soil kpa c ss suspended sediment concentration l 3 sediment l 3 water d runoff depth l d 0 j runoff depth at node k 0 and time j δ t l d k j q runoff depth at node k 0 and time j q δ t when runoff begins l d k j runoff depth at node k and time j δ t l d k j 1 runoff depth at node k and time j 1 δ t l d k 1 j 1 runoff depth at node k 1 at time j 1 δ t l d average depth of runoff l d r duration of rainfall t d s specific water capacity l 1 e 0 slope of the antecedent volumetric water content deficit with depth shown in fig 15 l 1 f s z equation describing the geometry of a boundary condition f k k 1 j 1 recursive coefficient defined in eq 44 l fs factor of safety dimensionless fs o factor of safety prior to slope wetting antecedent factor of safety dimensionless g infiltration rate l t 1 g the acceleration of gravity l t 2 g infiltration or infiltration depth l g t derivative of infiltration with respect to time it equals the infiltration rate l t 1 g 0 j the infiltration at node k 0 and time j δ t l g k j infiltration at node k and time j δ t l g k j q the infiltration at node k and time j q δ t when runoff begins l g k j 1 infiltration at node k and time j 1 δ t g k 1 j 1 infiltration depth at node k 1 and time step j 1 δ t l g k k 1 j 1 recursive coefficient defined in eq 41 l t 1 h hydraulic head l h p soil water tension positive it is equal to the negative of the pressure head l h pf soil water tension at the wetting front l h po initial soil water tension at time 0 l h k k 1 j 1 recursive coefficient defined in eq 47 dimensionless j time index 1 2 t dimensionless j q time index describing the initiation of runoff at time j q δ t dimensionless k index for computational node 1 2 m dimensionless k unsaturated hydraulic conductivity l t 1 k o saturated hydraulic conductivity l t 1 n f k h p the derivative of the unsaturated hydraulic conductivity with respect to the soil water tension t 1 l slope length l m exponent in the kinematic wave runoff equation 5 3 n porosity of the soil forming the slope dimensionless n f porosity of the sediment fraction that is detached to become suspended load dimensionless n manning s or hydraulic roughness coefficient of the slope surface seconds meter 1 3 to produce velocity in meter s 1 r rainfall rate l t 1 r o constant rainfall rate l t 1 r d discrete value of rain depth occurring over a computational time step δ t l r k j rainfall depth falling on node k during time step δ t beginning at time j δ t and ending at time j 1 δ t l r cumulative rainfall l s o slope of the terrain change in vertical elevation per unit horizontal distance dimensionless q runoff rate l 3 t 1 q s darcian flux specific discharge along the coordinate s l3 t 1 q z darcian flux specific discharge along the coordinate z l t 1 q ss suspended sediment discharge l 3 sediment t 1 s coordinate parallel to the slope surface increasing downslope l t time t q time at which runoff begins v o volumetric water content prior to rainfall antecedent volumetric water content dimensionless v volumetric water content dimensionless v vb volume of soil eroded that becomes bed load l 3 v vd volume of soil eroded that equals the volume of bed load plus the volume of suspended load l 3 v vs volume of soil eroded that becomes suspended load l 3 w o antecedent volumetric water content deficit n v o dimensionless x k k 1 j 1 recursive coefficient defined in eq 45 l z coordinate perpendicular to the slope surface increasing downwards from the surface l z v vertical coordinate increasing downwards from a datum l z vb thickness of soil eroded to become bed load l z vd the thickness of soil eroded that becomes bed load plus the thickness of soil eroded that becomes suspended load z vb z vs l z vf depth of the wetting front along the coordinate z v l z vs thickness of soil eroded that becomes suspended load l β hydraulic coefficient defined by eq 20 l 1 3 t 1 γ unit weight of soil or sediment prior to external wetting kn l 3 γ o unit weight of saturated soil or sediment kn l 3 γ w unit weight of water kn l 3 δ s distance increment along the coordinate s also the inter nodal distance or computational distance step l δ t computational time step θ slope angle ϕ effective friction angle acknowledgments the computational software and facilities of the department of geography at the university of california santa barbara were instrumental to carry out the numerical simulations of this work this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors the authors declare there are no conflicts of interests pursuant to the contents of this paper appendix a the exact mathematical statement of the infiltration problem in sloping terrain an eulerian volumetric balance of water can be written for the rev of fig 2 that leads to the following 2d partial differential equation when the dimensions of the rev tend to zero a1 q s s q z z v t in which v denotes the volumetric water content the following steps are taken to transform eq a1 into a partial differential equation written in terms of the soil s properties obtained from its characteristic curves that express the water content and the hydraulic conductivity as functions of the soil water tension see e g van genuchten 1980 lu et al 2010 i substitute eqs 4 and 5 into eq a1 ii introduce the rate of change of the hydraulic conductivity with respect to the soil water tension k h p dk dh p iii introduce the time derivative of the volumetric water content with respect to the water tension in terms of the specific water capacity d s dv dh p hillel 1982 eq a1 is transformed into the following expression once steps i ii and iii are implemented a2 k h p s s k h p z z k h p sin θ h p s k h p cos θ h p z d s h p t eq a2 is the 2d partial differential equation describing the variation of the soil water tension it relies on a system of rotated coordinates aligned with axes parallel and perpendicular to the slope surface on the slope plane eq a2 reduces to the classic 2d richards equation when the slope angle θ 0 and the coordinate axes are rotated clockwise 180 see e g hillel 1982 for a statement of the classic 2d richards equation the initial condition associated with eq a1 is given by a3 h p s z t 0 h po s z in which h po s z expresses the initial distribution of soil water tension within the domain of soil under study the boundary condition on the slope surface z 0 is given by the following formula up to the time of runoff initiation a4 q z r cos θ k cos θ k h p s 0 t z 0 s l 0 t t q or by the following equation after runoff begins a5 h p s 0 t d cos θ 0 s l t t q the time when runoff begins t q occurs when the component of rainfall along the z coordinate r cos θ exceeds for the first time the component of the infiltration rate expressed by the right hand side of eq a4 this time must be obtained by simulating the change in soil water tension and the hydraulic gradient of pressure head on the surface z 0 additionally boundary conditions are necessary below the slope surface for full specification of the mathematical problem describing the variation of the soil water tension within the slope soil caused by water application on the slope surface one possible approach to achieve such specification is to define by educated guessing a geometric boundary described by a function f s z on which the soil water tension is specified another possible approach is to define a boundary f s z describing the position of a phreatic surface on which the soil water tension equals zero if such phreatic surface exists the models hydrus 1d and hydrus 2d 3d simulate the movement of water heat and solutes in variably saturated media and have several options for setting boundary conditions see a review by šimůnek et al 2016 evidently realistic subsurface boundary conditions must be assumed for any solution of eq a2 to be meaningful field data may be available to assist in the formulation of proper values for the subsurface boundary conditions it is evident thus that a numerical solution of the mathematically exact formulation of the infiltration problem on sloping terrain with surficial water input requires specifying the subsurface boundary conditions and the determination of the time of initiation of runoff these specifications introduce uncertainty not present when employing the modified g a infiltration model introduced in this work 
7295,a modified green and ampt model is formulated to quantify infiltration on sloping terrain underlain by homogeneous soil wetted by surficial water application this paper s theory for quantifying infiltration relies on the mathematical statement of the coupled partial differential equations pdes governing infiltration and runoff these pdes are solved by employing an explicit finite difference numerical method that yields the infiltration the infiltration rate the depth to the wetting front the rate of runoff and the depth of runoff everywhere on the slope during external wetting data inputs consist of a water application rate or the rainfall hyetograph of a storm of arbitrary duration soil hydraulic characteristics and antecedent moisture and the slope s hydraulic and geometric characteristics the presented theory predicts the effect an advancing wetting front has on slope stability with respect to translational sliding this paper s theory also develops the 1d pde governing suspended sediment transport and slope degradation caused by runoff influenced by infiltration three examples illustrate the application of the developed theory to calculate infiltration and runoff on a slope and their role on the stability of cohesive and cohesionless soils forming sloping terrain keywords infiltration kinematic wave runoff factor of safety landslides rainfall 1 introduction this paper develops and tests a numerical model for the prediction of infiltration runoff and soil stability in slopes subjected to water application by rainfall or other forms of surficial water application e g irrigation our work also develops the 1d pde governing suspended sediment transport and slope degradation caused by runoff influenced by infiltration fig 1 depicts the geometry considered in this work showing a slope with angle θ length l and width b perpendicular to the plane of the figure a water application rate or rainfall rate r t wets the slope the rate of water application could be caused by artificial means such as irrigation the water application rate may cause runoff on the slope if it exceeds the infiltration rate g in that case the variable depth of runoff is denoted by d in fig 1 the water pressure exerted by a water depth d equals d cos θ γ w as shown in fig 1 with γ w denoting the unit weight of water 9 81 kn m3 the equations governing runoff and infiltration on sloping terrain are derived relying on cartesian coordinates s and z shown in fig 1 the axis of the s coordinate is parallel to the slope surface and s increases downslope the axis of the coordinate z is normal to the axis s and increases downwards from the slope surface the runoff on the slope varies with distance s and with time and is denoted by q s t it is seen in fig 1 that the infiltration rate has components equal to g cos θ and g sin θ along the coordinates z and s respectively the slope s soil has a volumetric water content deficit equal to w o n v o prior to the onset of infiltration in which n denotes the porosity of the soil and v o represents the antecedent volumetric water content the depth to the wetting front varies along the slope and is represented by two variables z vf and z f the former variable is measured vertically downward from the slope surface and the latter is measured downward from the slope surface along the coordinate axis z as depicted in fig 1 the infiltration is denoted by g units of length whose time derivative equals the infiltration rate i e g t g units of length over time the volume of water entering the soil fills the available pore space n v o as it moves vertically downward on a per unit area of slope such volume of water equals the infiltration g which in turn equals the depth of water penetration times the available pore space that fills with entering water this reasoning in conjunction with the geometry of the coordinates aligned with the vertical axis and with the axis normal to the slope surface leads to eqs 1 and 2 expressing respectively the depths z vf and z f in terms of the infiltration and the volumetric water content deficit as follows 1 z vf g n v o 2 z f g n v o cos θ the soil water tension along the wetting front is denoted by h pf units of length in fig 1 the soil water tension equals the negative of the pore pressure head along the wetting front and thus is a positively valued variable given that the pore pressure in unsaturated soil is negative i e less than atmospheric the soil water tension on the wetting front h pf is a hydraulic characteristic that varies with soil texture see e g rawls and brakensiek 1983 rawls et al 1992 this work introduces a modified version of the classic green and ampt infiltration model see green and ampt 1911 applicable to sloping terrain subjected to time variable surficial wetting a review of the green and ampt model the g a model henceforth and its underlying assumptions can be found in dingman 2015 among others this work s modified g a model calculates coupled infiltration and runoff on sloping terrain and resolves the effect of infiltration depth on slope stability furthermore this paper presents the 1d pde describing the combined erosive power of slope runoff and infiltration the erosion rate is expressed as function of the runoff rate infiltration rate and suspended sediment concentration under approximate steady state conditions the simultaneous calculation of slope wetting infiltration runoff and erosion constitutes this paper s theoretical novelty the numerical algorithms for the calculation of slope infiltration runoff and slope stability constitute the practical result of this paper s theory the original g a infiltration model estimates the infiltration in a homogeneous and isotropic soil underlying level ground the classic g a model has been implemented by several authors see e g mein and larson 1973 morel seytoux 1980 hydrologic engineering center 2000 chen and young 2006 reported a model for g a infiltration in sloping surfaces the latter work did not address the effect of infiltration on slope stability and slope degradation as this paper does the g a model has been shown to comply well with the richards equation results under the model assumptions salvucci and entekhabi 1995 loáiciga 2005 reported calculation of groundwater recharge to sloping aquifers loáiciga and huang 2007 presented a g a infiltration model that accounted for temporally variable rainfall with interspersed dry periods in which the ponding depth was depleted by infiltration and evaporation several authors have reported simulations of surface flow affected by infiltration on sloping terrain relying on models other than the g a formulation strelkoff and clemmens 1994 for example calculated surface flow in sloping border irrigation by solving the saint venant equations with infiltration described by kostiakov s formula bradford and katopodes 2001 presented a finite volume model for unsteady two dimensional shallow water flow to simulate the advance and infiltration of an irrigation wave in non level basins wöhling et al 2004 reported a surface subsurface flow model for furrow irrigation employing the hydrus 2d model for subsurface simulation of water flow zerihun et al 2005 developed a hydraulic model coupled to a surface model hydrus 1d for flow and solute transport in irrigation borders and basins the four latter publications on irrigation models did not address slope stability by soil wetting weill et al 2009 reported a numerical model for coupled surface and subsurface flow simulation with the objective of elucidating water dynamics in catchments with consideration to the surface subsurface interface employing a generalized richards equation their model was not concerned with the analysis of slope stability or erosion caused by slope wetting morbidelli et al 2018 presented a review of research dealing with infiltration on sloping terrain this paper s contribution is the development of the g a model for infiltration on sloping ground coupled with kinematic wave modeling of runoff the infiltration runoff model solves the coupled equations of runoff and infiltration driven by time variable water input on sloping terrain this paper generalizes the work of johnson and loáiciga 2017 by considering the existence of lateral subsurface flow downslope by applying a time variable upstream boundary condition at s 0 for infiltration that accounts for the temporal evolution of soil wetting at the slope crown and by elucidating the effect of infiltration on slope erosion centrally this paper resolves the effect an advancing wetting front has on reducing the factor of safety fs against translational sliding in sloping terrain formed by cohesive or cohesionless soils our work generalizes the slope sliding model by iverson 2000 by jointly simulating infiltration and slope runoff and accounting for their combined effect on translational slope stability this paper s analytical and numerical methods complement experimental research of infiltration in sloping terrain morbidelli et al 2015 2016 lastly this work develops the pde governing suspended sediment continuity and submerged slope degradation caused by external wetting and influenced by infiltration section 2 presents the geometric setting hydrologic methods and numerical algorithms employed in this paper section 3 summarizes this paper s results section 4 outlines extensions to the theory presented in section 2 the extensions cover linearly variable antecedent water content and the development of the partial differential equations governing suspended sediment concentration runoff infiltration and slope degradation section 5 conclusion summarizes this paper s key findings the appendix a develops the 2d richards equation for unsaturated soil in arbitrarily rotated cartesian coordinates all the symbols employed in this paper are listed in section 6 symbology a list of bibliographic references is found in the section 2 theory and methods 2 1 the g a infiltration equation in sloping terrain this section develops a g a infiltration model for sloping terrain prior to the initiation of runoff at time t q infiltration equals the cumulative water input r 3 g s t r t 0 t t q 0 s l once runoff begins a positive pressure head d cos θ in fig 1 forms on the slope surface z 0 which gives rise to simultaneous and coupled infiltration and runoff fig 2 depicts a representative elementary volume abcd rev whose sides are oriented parallel to the axes s and z introduced in fig 1 the third dimension of the rev shown in fig 2 is unitary and perpendicular to the s and z axes the hydraulic head h within the rev is defined with respect to a datum on which the elevation head z v 0 and z v increases in magnitude in a downward direction as shown in fig 2 the pressure head within the rev is negative given that it is partially saturated the pressure head within the rev is denoted by h p in which h p represents the soil water tension positive in m the hydraulic head within the rev equals h z v h p this choice of variables and the geometry of fig 2 imply that δ z v δ z cos θ and δ z v δ s sin θ it follows that in the limit as δ s δ z and δ z v 0 the darcian fluxes q s and q z along the axes s and z respectively are given by the following equations 4 q s k h s k sin θ k h p s 5 q z k h z k cos θ k h p z in which k denotes the soil s hydraulic conductivity the unsaturated hydraulic conductivity can be expressed in terms of the volumetric water content according to the soil s moisture conductivity curve alternatively the unsaturated hydraulic conductivity is expressible as a function of the soil water tension relying on the soil s moisture characteristic curve brooks and corey 1964 campbell 1974 van genuchten 1980 the modified g a infiltration model expresses eq 5 for the subsurface water flux perpendicular to the slope in discrete form between the slope surface where z 0 and the wetting front where z z f the pressure head equals d cos θ on the slope surface and h pf on the wetting front therefore letting k o denote the saturated hydraulic conductivity the darcian flux along coordinate z is given by 6 q z k o cos θ k o d cos θ h pf z f the infiltration rate along the z coordinate equals g cos θ which equals the darcian flux given by eq 6 furthermore the infiltration rate equals the time derivative of the infiltration g eq 6 is valid after the time t q when runoff begins and generates a positive pressure head on the slope surface the g a formulation of the darcian flux in eq 6 assumes a piston like advance of the wetting front with the pressure head varying between d cos θ on the slope surface and h pf at the wetting front the homogeneous soil layer of thickness z f between the slope surface and the wetting front is saturated these conditions render the g a model of infiltration quite tractable compared to a formulation based on the exact equation of unsaturated flow i e the 2d richards equation the exact formulation of infiltration on sloping terrain raises several complex issues concerning the calculation of the time to runoff initiation and the formulation of boundary conditions of the subsurface flow domain that do not arise with the g a model the appendix a presents an analysis of the 2d richards equation of unsaturated flow in rotated coordinates and explains the complexities that arise in solving simultaneously the runoff and infiltration equations with the exact formulation eq 6 is rewritten in terms of the infiltration g employing eq 2 to express z f and leveraging the fact that q z equals g cos θ g t cos θ 7 g s t t cos θ k o cos θ k o d s t cos θ h pf g s t n v o cos θ eq 7 is rewritten as a conventional partial differential equation 8 g g t k o g a o d a 1 0 t t q 0 s l where 9 a o k o n v 0 cos θ 10 a 1 k o n v 0 h pf cos 2 θ the initial condition for infiltration is that infiltration equals the cumulative rainfall or cumulative water input r t q at the time when runoff begins t q 11 g s t q r t q 0 s l the infiltration increment over a time step equals the amount of rain falling during that period whenever the runoff ceases and rainfall continues to fall the upstream boundary condition for infiltration takes into account that at s 0 the runoff depth d equals zero therefore setting d 0 in eq 8 permits writing the infiltration boundary condition in the following form that is useful for its numerical integration 12 g 0 t t k o a 1 g 0 t t t q eq 12 expressing the boundary condition for infiltration is integrated by separation of variables to yield the following implicit relation between time and infiltration 13 t t q g 0 t r t q k 0 a 1 k o 2 ln k o g 0 t a 1 k o r t q a 1 t t q eq 12 is the preferred formulation of the boundary condition for the purpose of numerical solution of the infiltration problem it is worthy of mention that the g a formulation of infiltration with water application on a slope involves simple flow domain geometry depicted in fig 1 and mathematical description of the boundary condition no assumption is necessary for a phreatic surface beneath the wetting front eqs 8 12 summarize the mathematical statement for infiltration on sloping terrain eq 8 involves the unknown runoff depth a second equation is needed for the runoff depth which is derived employing kinematic wave theory in the kinematic wave runoff section a key variable for slope stability analysis is the depth to the wetting front which is calculated with either eqs 1 or 2 once the infiltration is resolved 2 2 the time to the initiation of slope runoff t q the time required to initiate slope runoff t q is defined by the instant in which the component of the rainfall rate or water input rate in general along the coordinate z first equals the infiltration rate along that same coordinate employing eq 7 with d 0 we have 14 r t q cos θ k o cos θ k o h pf r t q n v o cos θ in which r t q denotes the cumulative rainfall at time t q eq 14 must be solved numerically for most instances of variable water input the case of constant water input r o leads to a closed form solution for t q 15 t q 1 r o k o h pf n v o r o k o cos 2 θ where the constant water input r o must exceed the saturated hydraulic conductivity k o to obtain physically meaningful results another case of interest in this work is that of a symmetric triangular water input rate over a duration d as shown in fig 3 in fig 3 the rising limb of the water input rate is expressed as r c t in this case the time t q is the smallest root positive and real valued of the following third order polynomial 16 b o t 3 b 1 t 2 b 2 0 where b o c 2 cos 2 θ b 1 ck 0 cos 2 θ b 2 2 k o h pf n v o determining the time t q for rainfall rates specified as a time series of discrete values of rain depth r d each occurring over a computational time period δ t requires a numerical solution of eq 14 fig 4 depicts the united states department of agricultural s natural resources conservation service nrcs 24 h type i rainfall hyetograph in this case scaled to produce a depth of rain equal to 0 400 m notice the high intensity of rainfall near half the duration of the storm letting the index j denote the counter for time intervals j 1 2 t the cumulative rain at time j δ t is calculated as follows 17 r j δ t l 1 j r d l δ t the discrete form of eq 14 applied to estimate the time t q takes the form 18 r d j δ t δ t k o k o h pf r j δ t n v o cos 2 θ the value j that satisfies eq 18 for the first time is denoted by j q and the time of runoff initiation is given by t q j q δ t 2 3 kinematic wave runoff runoff on a slope surface is wide and shallow resulting in a hydraulic radius approximately equal to the depth of runoff d this permits the application of the kinematic wave approximation to the flow equation on a slope runoff is herein modeled with the kinematic wave approximation to the equation of 1 d of overland flow on a slope with accretion by rainfall and depletion by infiltration the kinematic flow approximation expresses the flow rate as a function of the depth of flow see e g chow 1959 cunge et al 1980 chaudry 1993 johnson and loáiciga 2017 singh 2017 the kinematic wave flow equation is as follows 19 β m d m 1 d s d t r g r g t in which d denotes the depth of runoff g and r denote respectively the infiltration rate and rainfall rate and the derivative of the infiltration g with respect to time is represented by g t g the coefficient m 5 3 and β is defined as 20 β 1 n s 0 where n and s 0 denote the manning s roughness coefficient and the slope of the terrain respectively the initial condition of eq 19 is defined as follows 21 d s t t q 0 0 s l in which t q denotes the time when runoff emerges on the slope the depth of runoff equals zero prior to the time t q the boundary condition of eq 19 at the upstream end is given by 22 d s 0 t 0 t t q the overland flow q s t in m3 s at location s and time t is given by manning s equation 23 q s t 1 n s 0 b d s t 5 3 the following section introduces a numerical method for the joint solution of the infiltration and runoff equations outlined above 2 4 numerical solution of the infiltration and runoff equations 2 4 1 explicit finite difference formulation of the infiltration equation the flow domain has m 1 nodes with an inter nodal separation equal to δ s as shown in fig 1 the nodal index equals k 0 1 2 3 m the node at k 0 corresponds to the upstream boundary where the value of runoff depth equals zero the time domain is divided into a computational time step δ t with time index j 1 2 t the finite difference explicit numerical discretization of the infiltration eq 8 applied in this work is given by the following expression 24 g k j 1 g k 1 j 1 2 g k j g k j 1 δ t k o g k j 1 g k 1 j 1 2 a 0 d k j d k j 1 2 a 1 0 k 1 2 3 m and j j q 1 j q 2 j q 3 where t q j q δ t represents the time of runoff initiation the indexed notation applied in eq 24 is such that 25 g k 1 j 1 g k 1 δ s j 1 δ t 26 g k j 1 g k δ s j 1 δ t 27 g k j g k δ s j δ t 28 d k j d k δ s j δ t 29 d k j 1 d k δ s j 1 δ t the initial condition associated with eq 24 is given by the following formula 30 g k j q r t q k 0 1 2 3 m the boundary condition of eq 24 is the discretized form of eq 12 at k 0 31 g 0 j g 0 j 1 k o δ t a 1 δ t g o j 1 in which j j q 1 j q 2 j q 3 2 4 2 explicit finite difference formulation of the kinematic wave runoff the kinematic wave pde 19 is a nonlinear hyperbolic pde smith 1984 this paper implements a modified lax wendroff explicit finite difference method for its solution see lax 1954 and smith 1984 for an exposition of the lax wendroff method the explicit numerical scheme for kinematic wave runoff must meet the following numerical courant friedrichs lewy cfl stability condition courant et al 1928 cunge et al 1980 smith 1984 hydrologic engineering center 2000 johnson and loáiciga 2017 32 δ t δ s g d in which g equals 981 cm s2 and represents the acceleration of gravity and d denotes an average depth of runoff the selection of δ t and δ s must be made judiciously to satisfy eq 32 thus for example δ s may be set equal to 100 cm 1 m to calculate runoff depth and infiltration with adequate spatial resolution in which case by virtue of eq 32 δ t may not exceed 1 4 s for an average runoff depth d 5 cm the explicit finite difference formulation of the kinematic wave runoff equation is relatively simple and it is stable and accurate when the condition 32 is met and a suitable inter nodal computational step is chosen it is obtained by discretizing eq 19 the node at k 0 corresponds to the upstream boundary where the value of runoff depth equals zero 33 d k j d k j 1 δ t β m d k j 1 d k 1 j 1 2 m 1 d k j 1 d k 1 j 1 δ s r k j g k j g k j 1 δ t k 1 2 3 m and j j q 1 j q 2 j q 3 the following indexed notation applies to d k 1 j 1 and to the water application rate r in eq 33 34 d k 1 j 1 d k 1 δ s j 1 δ t 35 r k j r j δ t the initial condition associated with eq 33 is 36 d k j q 0 k 0 1 2 3 m the upstream boundary condition associated with eq 33 specifies zero depth at the slope s crown implying a dirichlet boundary value problem whose upstream boundary condition is 37 d 0 j 0 j j q 1 j q 2 j q 3 the kinematic wave runoff rate is calculated with the following equation 38 q k j 1 n s 0 b d k j 5 3 k 1 2 3 m and j j q 1 j q 2 j q 3 2 4 3 explicit finite difference solution of the infiltration and kinematic wave runoff equations eqs 24 and 33 constitute a set of coupled nonlinear finite difference equations involving the unknowns d k j and g k j the discretized infiltration eq 24 is rewritten in explicit form for the infiltration in the current time step 39 g k j g k j 1 a k k 1 j 1 d k j b k k 1 j 1 k 1 2 3 m and j j q 1 j q 2 j q 3 in which 40 a k k 1 j 1 a 0 2 g k k 1 j 1 41 g k k 1 j 1 g k j 1 g k 1 j 1 2 δ t 42 b k k 1 j 1 k o δ t a 1 g k k 1 j 1 a 0 g k k 1 j 1 d k j 1 2 the runoff depth eq 33 is rewritten in explicit form for the current time step 43 d k j d k j 1 g k j f k k 1 j 1 in which 44 f k k 1 j 1 x k k 1 j 1 r d k j g k j 1 where r d k j r k j δ t denotes the depth of water application in time step j δ t at node k 45 x k k 1 j 1 δ t β m d k j 1 d k 1 j 1 2 m 1 d k j 1 d k 1 j 1 δ s eq 39 for g k j is substituted into eq 43 to produce an explicit equation for the runoff depth in the j th computational time step 46 d k j h k k 1 j 1 d k j 1 h k k 1 j 1 g k j 1 h k k 1 j 1 b k k 1 j 1 h k k 1 j 1 f k k 1 j 1 k 1 2 3 m and j j q 1 j q 2 j q 3 with boundary condition d 0 j 0 in which 47 h k k 1 j 1 1 1 a k k 1 j 1 the runoff depth calculated with eq 46 must be non negative for physical feasibility the solution algorithm for coupled runoff and infiltration starts by solving eq 46 at time step j q 1 δ t once the runoff depth has been calculated it is used in eq 39 to solve for the infiltration at time step j q 1 δ t the time index is then increased to j q 2 and the consecutive solutions for runoff depth and infiltration are calculated at all active nodes the solution algorithm is advanced to the third and higher time steps by increasing the time index j by one unit consecutively solving for infiltration and runoff depth in each time step until reaching the end of the simulation the ratio input output input 100 constitutes the percentage error in mass balance associated with the calculated runoff and infiltration with input cumulative rainfall and output cumulative runoff volume infiltration the percentage error measures the accuracy of the numerical solution scheme in preserving balance of inputs and outputs see e g mcdonald and harbaugh 1988 the accuracy of the numerical algorithm is evaluated by checking the percentage error in mass balance approaches zero upon termination of the numerical simulation as shown in the results section this paper s simulation algorithm for solving eqs 39 and 46 was written in the public domain software r the program is accessible at https github com mikejohnson51 rainslope for free download 2 4 4 the depth to the wetting front the depth to the wetting front is a key factor controlling slope stability it is calculated at any node k and time step j δ t with the following equation 48 z vf k j g k j n v 0 in which k 0 1 2 m j 1 2 3 notice that for j 1 2 3 t q the infiltration g k j equals the cumulative rainfall r j δ t 2 5 slope infiltration and translational slope stability the classic model for translational slope stability proposes that subsurface water perches over a surface of hydraulic conductivity lower than that of the overlying slope s soil the surface of hydraulic conductivity discontinuity is the slip surface along which overlying soil may move downslope causing landslides the rising thickness of saturation above the slip surface reduces the frictional effective stress on that surface and may cause sliding along the slip surface descriptions of the classic infinite read long slope translational stability model can be found in duncan et al 2014 and loáiciga 2015 among others however empirical evidence indicates slopes wetted by rainfall commonly do not feature such zones of conductivity discontinuity in fact many translational landslides occur in relatively homogeneous soils driven by the downward advance of saturation as depicted in fig 5 and not by the rise of perched saturation above the slip surface as proposed by the classic model of translational slope stability it is possible air may be entrapped along the wetting front when there is rapid infiltration thus hindering the advance of the wetting front and creating positive pore water pressure through the zone of saturation it might possible also that a reduction in hydraulic conductivity produce a profile of positive pore water pressure through the zone of saturation these condition is propitious for shallow sliding wherever the advance of the wetting front is retarded this work introduces a method for evaluating translational slope stability considering coupled runoff and infiltration soil characteristics and slope geometry the soil saturated unit weight and the antecedent unit weight prior to external wetting are denoted by γ o and γ respectively as shown in fig 5 let c and ϕ denote respectively the effective cohesion and the effective angle of friction of the slope s soil the ratio of the resisting stress along the slip surface shown in fig 5 to the driving stress that often destabilizes the slope along that surface is called the factor of safety fs the slope is stable when the factor of safety exceeds 1 is unstable when the factor of safety is less than 1 and is in limiting equilibrium when the factor of safety equals 1 the factor of safety fs o at a depth z vf is determined by force equilibrium and geometric analyses of the soil block depicted in figure prior to infiltration the factor of safety is given by the following expression in which the pressure head at depth z vf prior to saturation is denoted by h p 0 h pf 49 fs o c z vf γ cos θ sin θ 1 h po z vf γ w γ 1 cos 2 θ tan ϕ tan θ as water infiltrates it changes the water content of the slope s soil at the advancing wetting front the soil water tension at depth z vf equals h pf and the factor safety equals 50 fs c z vf γ o cos θ sin θ 1 h pf z vf γ w γ o 1 cos 2 θ tan ϕ tan θ eq 50 demonstrates the factor of safety decreases with increasing depth of the wetting front z vf therefore the deeper a wetting front driven by infiltration advances the greater the reduction of the factor of safety would be with concomitant reduction of slope stability a comparison of eqs 49 and 50 demonstrates the factor of safety with infiltration eq 50 is less than that without infiltration for the same depth z vf because eq 50 features a larger unit weight saturated unit weight γ o and a smaller soil water tension h pf rapid infiltration may trap air in the soil along the wetting front which may slow down or impede further infiltration in this instance the water pressure would equal d cos θ γ w on the slope surface see fig 1 and d cos θ z vf cos 2 θ γ w along the wetting front this situation may also arise if the hydraulic conductivity is reduced at depth z vf yet it would be caused by induced saturation from the slope surface downward rather than by perching of soil water over a soil discontinuity as assumed in the classic model of slope stability loáiciga 2015 either one of these two situations is associated with a factor of safety given by 51 fs c z vf γ o cos θ sin θ γ o γ w γ o tan ϕ tan θ from eq 51 follows the maximum angle a slope of cohesionless soil c 0 may have and be stable 52 θ tan 1 γ o γ w γ o tan ϕ eq 52 states the maximum angle natural or constructed slopes may have when induced soil saturation produces air trapping along the wetting front or a reduction of hydraulic conductivity occurs at any depth the results section offers examples of the effect of infiltration on translational slope stability 3 results 3 1 cohesive soil the first example illustrates this paper s theory with a cohesive soil with negligible friction strength whose factor of safety against sliding is given by the first term of the right hand side of eq 50 two 24 h storms were employed in separate applications of this paper s runoff infiltration method and slope stability analysis table 1 lists the slope geometry and hydraulic parameters applied in this example the spatial computation step was set to δ s 1 m and the time step δ t 1 s numerical calculations were also conducted with combinations of δ s and δ t that satisfied the cfl stability condition 32 while keeping δ s less than 2 m the numerical simulation produced identical results with all chosen combinations of δ s and δ t two distinct rainfall distributions were employed one of the storms had a constant intensity yielding a total depth of 0 400 m over 24 h see diagram in fig 3 with the rainfall rate r 0 4 63 10 6 m s the other storm features a symmetric triangular rainfall rate as depicted in fig 3 with the slope coefficient in fig 3 having magnitude 2 14335 10 10 m s2 in the rising and recession limbs respectively also yielding 0 400 m of rain over 24 h table 2 lists the cohesive soil s characteristics used in this example which in this case are the porosity n volumetric water content v 0 water tension at the wetting front h pf hydraulic conductivity k 0 effective cohesion c and saturated unit weight γ o fig 6 illustrates the determination of the time of runoff initiation t q corresponding to the constant rainfall rate t q equals 3610 s in this case which is the time when the rainfall rate equals the infiltration rate notice the relatively high rate of infiltration at early time fig 7 displays the diagram illustrating the determination of the time of runoff initiation associated with the triangular rainfall rate in which case t q 15 858 s it is seen in fig 7 the constant rainfall rate generates runoff at a much earlier time t q 3610 s than the symmetric triangular rainfall rate it is seen in fig 7 the relatively high value of the infiltration rate at early time fig 8 displays the variation of the runoff depth calculated for various times since the beginning of constant rainfall that delivers 0 400 m of water in 24 h the graphs shown in fig 8 demonstrate the runoff depth converges to a steady state after 1365 min of uniform rainfall and so does the runoff rate because it is a function of the depth in the kinematic wave formulation see eq 23 the infiltration rate corresponding to the runoff depth that approaches steady state is derived from eq 8 to yield the following expression when d s t d s 53 g s t k o a o d s a 1 g s t fig 9 displays the calculated runoff depth d associated with the constant and triangular symmetric rainfall rates the runoff depth was calculated at the toe of the slope s l 300 m where it reaches its maximum magnitude it is seen in fig 9 the earlier appearance of runoff produced by the constant rainfall rate the runoff depth produced by constant rainfall increases rapidly until the time when the entire slope is contributing to runoff at the toe of slope which happens at about 9000 s when the runoff depth is about 7 mm thereafter the runoff depth increases slowly from about 7 mm to about 9 mm of depth at the end of the rainfall event 24 h 86 400 s the graph of runoff depth corresponding to the triangular rainfall indicates the rate of increase of the runoff depth is largest between 0 and 20 600 s peaking at the latter time when the runoff depth equals 5 7 mm at this time the entire slope is contributing runoff to the slope s toe the runoff depth caused by the triangular rainfall increases until reaching a maximum at about 44 000 s when it equals about 15 5 mm at the slope s toe thereafter it decreases to a nil value at 82 400 s the overall shapes of the runoff depth diagrams associated with the constant and triangular rainfalls at all other locations along the slope 0 s l are similar to those depicted in fig 9 but with the depth d progressively scaled down as each approaches the upstream boundary where d 0 for all times fig 10 displays the calculated depth to the wetting front associated with the constant and triangular rainfalls the depths to the wetting front were calculated at the times of initiation of runoff t q corresponding to the constant and triangular rainfalls which were 3610 and 15 858 s respectively and at the end of rainfall 86 400 s the depth to the wetting front at the end of rainfall is of special importance because it represents the critical condition for slope stability as shown below fig 10 indicates the depth to the wetting front is fairly uniform along the slope reaching its largest magnitude at the slope toe the depths to the wetting fronts associated with constant rainfall and triangular rainfall at the slope toe equal 1 30 and 1 13 respectively evidently infiltration is more effective when the water application rate is constant all other factors being equal therefore the constant rainfall poses a greater hazard to slope stability than the triangular rainfall due to its deeper penetration depth the percentage error in mass balance was less than 0 1 in this example which demonstrates the accuracy of the calculated infiltration and cumulative runoff the factor of safety shown in fig 11 was calculated with the first term on the right hand side of eq 50 for a soil exhibiting cohesive strength only which as listed in table 2 is typical of a very soft cohesive soil c 10 kn m2 in this example nevertheless the results of fig 11 indicate this slope would remain stable when the wetting front reaches its maximum value equal to 1 30 m which has a corresponding factor of safety equal to 2 the factor of safety was extrapolated to a depth of the wetting front equal to 2 60 m in fig 11 which is the depth the wetting front would need to penetrate to cause a translational slide the results from this example establish that translational slides are unlikely to occur even in soft cohesive soils by external wetting unless the soil is sensitive and its structure collapses under wetting cohesive homogeneous soils are more prone to fail along circular or logarithmic spiraled deep seated slip surfaces lambe and whitman 1969 griffiths and marquez 2007 duncan et al 2014 loáiciga 2015 3 2 cohesionless soil cohesionless soils effective cohesion c 0 are known to be prone to translational sliding by rainfall wetting cedegren 1989 loáiciga 2015 and they cause substantial loss of life and property annually the world over see e g schuster et al 2002 the factor of safety against sliding of a cohesionless soil is given by the second term on the right hand side of eq 50 the calculation of coupled runoff and infiltration and their effect on slope stability is illustrated in this second example relying on the nrcs 24 h type i rainfall hyetograph scaled to a total depth of rainfall equal to 0 400 m shown in fig 4 table 3 lists the hydraulic and geometric properties applied in this second example in which the computational steps δ s and δ t were set to 10 m and 10 s respectively numerical calculations were also conducted with combinations of δ s and δ t that satisfied the cfl stability condition 32 while keeping δ s less than 10 m numerical simulations produced identical results with all chosen combinations of δ s and δ t the slope used in this second example is steeper than in the first example table 4 lists the cohesionless soil s properties applied in this example which in this case are the porosity n volumetric water content v 0 water tension at the wetting front h pf hydraulic conductivity k 0 effective friction angle ϕ and saturated unit weight γ o one remarkable feature of the cohesionless soil employed in this example is that it is ten times more permeable than the cohesive soil of the first example compare the k 0 values in tables 2 and 4 the friction angle of the cohesionless soil 35 is less than the slope angle 39 81 meaning the cohesionless soil is stable so long as the friction stress induced by soil water tension is sufficient to overcome the deficit of frictional strength that would occur on the same dry slope with the given geometric characteristics fig 12 displays the time history of the rainfall rate infiltration rate the time of initiation of runoff t q 34 740 s and the infiltration g at the slope toe it is evident the duration of excess rainfall generating runoff is short lived starting at the time of initiation of runoff t q 34 740 s the infiltration at the slope toe equals 0 326 m at the end of rainfall meaning 0 074 m of the total rainfall 0 400 m drains from the slope as runoff at that location fig 13 displays the calculated runoff depth d and the depth to the wetting front at the toe of the slope z vf runoff begins at time 34 740 s and ends at 46 630 s at this location this is the time interval when rainfall is most intense which causes the wetting front to advance at its fastest rate during the 24 h period of rainfall the depth to the wetting front reached a maximum equal to 2 17 m the calculated percentage error in mass balance was less than 0 1 in this example proving the accuracy of the numerical algorithm fig 14 depicts the factor of safety fs calculated for the cohesionless soil with properties listed in table 4 the factor of safety graphed in fig 14 was calculated with the second term on the right hand side the frictional term of eq 50 it is evident from fig 14 the slope would fail in this case when the depth to the wetting front reaches 0 65 m which corresponds to 0 0975 m of infiltration 0 65 0 15 where 0 15 equals the water content deficit n v 0 this shows permeable soil receiving rainfall depth on the order of 0 0975 m could experience sliding eq 52 can be employed to calculate the maximum slope angle for which slope stability is maintained when the advance of the wetting front is impeded by compressed air or a reduction of hydraulic conductivity at any depth thus causing positive pressure from the slope surface through the wetting front using a saturated unit weight equal to 20 kn m3 and angle of effective friction equal to 35 as before it is determined the maximum angle the slope may have to be stable equals 19 6 4 extensions of this paper s theory 4 1 linearly variable antecedent volumetric water content the theory presented in this work assumes a constant antecedent volumetric water content v o this section describes an extension of this paper s theory to include an antecedent water content that varies linearly with depth as shown in fig 15 the antecedent volumetric water content v o is given by the following expression 54 v o z a e 0 z in which the coefficients a and e 0 describe the variation of the antecedent water content with depth as depicted in fig 15 the antecedent water content v o increases or decreases with increasing depth z when the coefficient e 0 is positive or negative the component of infiltration along the axes equals the integral of the water content deficit from the slope surface to the depth of the wetting front z f 55 g cos θ z 0 z f n v 0 z dz n a z f e 2 z f 2 substituting eq 54 into eq 7 produces the following partial differential equation for the depth to the wetting front 56 n a e z f z f z f t k o cos θ z f k o d s t cos θ h pf 0 by solving eq 56 numerically for z f s t one can obtain the infiltration from eq 55 57 g s t 1 cos θ n a z f e 2 z f 2 eq 56 involves the runoff depth d s t the numerical solution of eqs 56 and 57 for infiltration and of eq 19 for the runoff depth proceeds similarly to the explicit finite difference algorithm described in this paper for the case when e 0 i e constant antecedent water content deficit n v o the calculation of the time to the initiation of runoff t q when the antecedent water content varies linearly with depth is needed to solve the runoff and infiltration equations recall slope runoff begins when the rainfall rate first equals the infiltration rate and exceeds it immediately thereafter this condition is determined resorting to eq 6 to yield the following equality 58 r t q k o k o h pf z f s t q cos θ in which z f s t q must be written in terms of the infiltration at time t q or g s t q which in turn equals the cumulative rainfall at time t q i e g s t q r t q the formula expressing z f s t q in terms of the cumulative rainfall r t q is obtained by solving the quadratic eq 57 to yield the following result in this instance 59 z f s t q n a n a 2 2 er t q cos θ e where the following condition must be met for eq 59 to produce a real valued answer when the coefficient e is positive 60 n a 2 2 e r t q cos θ if e 0 eq 60 for z f s t q must be substituted in eq 56 and subsequently the time t q is that which achieves equality of the right hand and left hand sides of eq 58 the depth z f s t q represents the initial boundary condition of the pde 56 the upstream boundary condition of eq 56 for time t t q is derived by setting the runoff depth to zero in eq 56 at s 0 such that 61 n a e z f 0 t z f 0 t z f 0 t t k o cos θ z f 0 t k o h pf the upstream boundary condition for infiltration is derived from eq 57 once the depth to the wetting front at that location z f 0 t is solved for numerically 62 g 0 t 1 cos θ n a z f 0 t e 2 z f 0 t 2 the set of equations derived in this section plus those presented governing runoff can be solved to quantify infiltration runoff and translational slope stability when the antecedent water content varies linearly with increasing depth 4 2 continuity of suspended sediment and slope degradation the role of infiltration water moving on the surface of the earth is a key agent of landform change the processes of erosion sediment transport and sedimentation or deposition control how the land surface undergoes aggradation rise of its elevation or degradation lowering of its elevation the factors and processes governing erosion sediment transport and sedimentation by moving water are complex renard et al 1997 julien 2010 this paper has shown infiltration influences slope runoff and vice versa this section develops the advective pde of 1d suspended sediment continuity involving slope degradation driven by runoff and infiltration fig 16 depicts the variables and geometry that control the continuity or conservation of suspended sediment and slope degradation fig 16 displays the vertically averaged concentration of suspended sediment c ss s t and the thickness of slope degradation z vd s t the concentration of suspended sediment is herein defined as the volume of sediment detached from the slope surface per unit volume of water in the water column of depth d as shown in fig 16 the suspended sediment discharge q ss advected by runoff equals the runoff rate multiplied by the sediment concentration or q ss qc ss it has units of volume of suspended sediment per unit time slope degradation results from the detachment of sediment or soil from the slope surface that undergoes two types of downslope transport processes one process produces the motion of detached sediment that remains in contact with the eroding surface as it rolls and slides downslope the volume of sediment transported in this manner is called the bed load the bed load does not contribute to suspended sediment in the water column the second process transports detached sediment in suspension the volume of sediment transported in this manner is called the suspended load sediment detachment occurs when the shear stress on the slope surface exerted by moving water exceeds the critical shear stress necessary to mobilize soil particles the transport of detached sediment particles depends on the specific runoff and particle characteristics the critical shear stress of cohesive soils is commonly too large to be exceeded by the tractive shear exerted by shallow slope runoff smerdon and beasley 1961 moody and smith 2005 shan et al 2015 the impact of raindrops however can exert stresses that break up the bonds between cohesive soil particles prior to the initiation of runoff those particles may be transported by runoff thereafter as either bed load or suspended load depending on runoff and particle characteristics let z vb and z vs denote respectively the thicknesses of slope degradation caused by bed load and suspended load transport the corresponding volume of transported sediment are denoted respectively by v vb and v vs the total slope degradation is the sum of the degradations caused by bed load and suspended load transport z vd z vb z vs with a corresponding volume of transported sediment denoted by v vd the time rate of change of the total volume of sediment transport equals the sum of the time rate of change of the volume of sediment that is transported as bed load plus the time rate of change of the volume of sediment transported as suspended load expressed by the following formula 63 v vd t v vb t v vs t z vb t z vs t cos θ δ s b 1 n in which n denotes the porosity of the slope soil the equation of continuity of suspended load or suspended sediment developed in this section considers i the sediment load advected with runoff ii the sediment load carried onto the slope surface by infiltration and iii the volume of sediment eroded from the slope surface that becomes suspended load in the overlying water column v vs the balance of the rates of sediment in and out of the fluid control volume abcd shown in fig 16 determines the rate of change of the concentration of suspended load in the control volume the control body of water abcd encompasses a volume equal to b d δ s in which δ s denotes its dimension along the coordinate axis s the pde describing the continuity of suspended sediment is given by the following expression 64 1 b qc ss s c ss cos θ g t cos θ 1 n f z vs t c ss d t where n f represents the porosity of the sediment fraction that becomes suspended the initial condition associated with eq 64 prescribes zero sediment concentration at time t q when slope runoff begins the upstream boundary condition of eq 64 specifies the sediment concentration at s 0 is equal to zero for all time following the initiation of runoff the runoff depth d see the pde 19 and the infiltration rate see the pde 8 are coupled with the sediment concentration c ss governed by the pde 64 this constitutes a set of three coupled nonlinear pdes the rate of slope degradation by suspension and transport of detached sediment z vs t must be specified to solve the runoff infiltration and sediment continuity equations that rate must be expressed as a function of the runoff regime and sediment characteristics including its resistance to shear detachment see e g simons et al 1981 schiettecatte et al 2008 in general the rate of slope degradation introduces a fourth equation that must be coupled with the pdes for sediment transport runoff and infiltration to yield a tetrad of nonlinear equations their solution remains an unresolved research problem the rate of slope degradation can be solved for from eq 64 if steady state conditions are approached see figs 8 and 9 setting the runoff rate equal to its steady state value q s t q s in eq 64 and assuming the suspended sediment concentration converges to a steady state condition after sustained external constant wetting we have the following result 65 z vs t 1 b cos θ 1 n f q s c ss s s c ss s 1 n f g eq 65 states the rate of slope degradation is proportional to the sum of the change of suspended sediment with respect to slope location plus the deposition of suspended sediment induced by infiltration 5 conclusions this paper presented a theory for the calculation of slope runoff and infiltration and for the assessment of translational slope stability based on a generalization of the g a model to the case of sloping terrain several examples involving external water application by rainfall with different temporal distributions and relying on soil and hydraulic characteristics demonstrated the solution capacity of this paper s solution algorithm the solution algorithm was found numerically stable and accurate and its execution for several runs involving constant triangular or nrcs rainfall patterns required processing times of less than 10 min each in a standard laptop computer this paper s results demonstrated long and sustained water application produces larger infiltration than triangular or nrcs type rainfall distributions of the same duration and the same total depth of precipitation evidently infiltration is more effective when the water application rate is constant all other factors being equal therefore the constant rainfall or water application poses a greater hazard to slope stability than the other rainfall types or water applications this paper introduced a novel interpretation of and solution method for the long slope stability problem it was shown by quantitative analysis that cohesionless and unsaturated soils forming sloping terrain are prone to translational sliding as the wetting front descends through the soil profile this work demonstrated the stability of long slopes formed by cohesionless soils depends on basic factors such as slope geometry the water application rate the depth of penetration of the wetting front and the soil hydraulic and strength characteristics there is no requirement in this paper s slope stability theory for discontinuities of hydraulic conductivity within the wetted soil profile or the formation of a perched groundwater flow system to explain slope stability it was demonstrated however that compressed air or reduction of the hydraulic conductivity at any depth imposes a limiting slope angle to preserve stability on the other hand this paper has shown long slopes formed by cohesive soils are not likely to undergo shallow sliding by a penetrating wetting front the pde relating the continuity of suspended sediment to the rate of slope degradation caused by slope runoff and influenced by infiltration was developed in this work the pde governing suspended sediment concentration must be coupled with the pdes governing infiltration and runoff to form a system of three nonlinear pdes from which to calculate sediment concentration runoff and infiltration provided the rate of slope degradation is unknown or is formulated in terms of runoff and soil resistance characteristics the joint solution of the runoff infiltration sediment transport and slope degradation equations for sloping terrain remains an unresolved research problem 6 symbology the symbols l and t denote units of length and time respectively kn and kpa denote kilo newtons and kilo pascals respectively a antecedent volumetric water content at the slope surface depicted in fig 15 dimensionless a o coefficient defined in eq 9 l t 1 a 1 coefficient defined in eq 10 l 2 t 1 a k k 1 j 1 recursive equation defined in eq 40 dimensionless b slope width l b o coefficient in the polynomial of eq 16 l 2 t 4 b 1 coefficient in the polynomial of eq 16 l 2 t 3 b 2 coefficient in the polynomial of eq 16 l t 2 b k k 1 j 1 recursive coefficient defined in eq 42 l c slope of the rising limb of triangular rainfall depicted in fig 3 l t 2 c effective cohesion of the slope soil kpa c ss suspended sediment concentration l 3 sediment l 3 water d runoff depth l d 0 j runoff depth at node k 0 and time j δ t l d k j q runoff depth at node k 0 and time j q δ t when runoff begins l d k j runoff depth at node k and time j δ t l d k j 1 runoff depth at node k and time j 1 δ t l d k 1 j 1 runoff depth at node k 1 at time j 1 δ t l d average depth of runoff l d r duration of rainfall t d s specific water capacity l 1 e 0 slope of the antecedent volumetric water content deficit with depth shown in fig 15 l 1 f s z equation describing the geometry of a boundary condition f k k 1 j 1 recursive coefficient defined in eq 44 l fs factor of safety dimensionless fs o factor of safety prior to slope wetting antecedent factor of safety dimensionless g infiltration rate l t 1 g the acceleration of gravity l t 2 g infiltration or infiltration depth l g t derivative of infiltration with respect to time it equals the infiltration rate l t 1 g 0 j the infiltration at node k 0 and time j δ t l g k j infiltration at node k and time j δ t l g k j q the infiltration at node k and time j q δ t when runoff begins l g k j 1 infiltration at node k and time j 1 δ t g k 1 j 1 infiltration depth at node k 1 and time step j 1 δ t l g k k 1 j 1 recursive coefficient defined in eq 41 l t 1 h hydraulic head l h p soil water tension positive it is equal to the negative of the pressure head l h pf soil water tension at the wetting front l h po initial soil water tension at time 0 l h k k 1 j 1 recursive coefficient defined in eq 47 dimensionless j time index 1 2 t dimensionless j q time index describing the initiation of runoff at time j q δ t dimensionless k index for computational node 1 2 m dimensionless k unsaturated hydraulic conductivity l t 1 k o saturated hydraulic conductivity l t 1 n f k h p the derivative of the unsaturated hydraulic conductivity with respect to the soil water tension t 1 l slope length l m exponent in the kinematic wave runoff equation 5 3 n porosity of the soil forming the slope dimensionless n f porosity of the sediment fraction that is detached to become suspended load dimensionless n manning s or hydraulic roughness coefficient of the slope surface seconds meter 1 3 to produce velocity in meter s 1 r rainfall rate l t 1 r o constant rainfall rate l t 1 r d discrete value of rain depth occurring over a computational time step δ t l r k j rainfall depth falling on node k during time step δ t beginning at time j δ t and ending at time j 1 δ t l r cumulative rainfall l s o slope of the terrain change in vertical elevation per unit horizontal distance dimensionless q runoff rate l 3 t 1 q s darcian flux specific discharge along the coordinate s l3 t 1 q z darcian flux specific discharge along the coordinate z l t 1 q ss suspended sediment discharge l 3 sediment t 1 s coordinate parallel to the slope surface increasing downslope l t time t q time at which runoff begins v o volumetric water content prior to rainfall antecedent volumetric water content dimensionless v volumetric water content dimensionless v vb volume of soil eroded that becomes bed load l 3 v vd volume of soil eroded that equals the volume of bed load plus the volume of suspended load l 3 v vs volume of soil eroded that becomes suspended load l 3 w o antecedent volumetric water content deficit n v o dimensionless x k k 1 j 1 recursive coefficient defined in eq 45 l z coordinate perpendicular to the slope surface increasing downwards from the surface l z v vertical coordinate increasing downwards from a datum l z vb thickness of soil eroded to become bed load l z vd the thickness of soil eroded that becomes bed load plus the thickness of soil eroded that becomes suspended load z vb z vs l z vf depth of the wetting front along the coordinate z v l z vs thickness of soil eroded that becomes suspended load l β hydraulic coefficient defined by eq 20 l 1 3 t 1 γ unit weight of soil or sediment prior to external wetting kn l 3 γ o unit weight of saturated soil or sediment kn l 3 γ w unit weight of water kn l 3 δ s distance increment along the coordinate s also the inter nodal distance or computational distance step l δ t computational time step θ slope angle ϕ effective friction angle acknowledgments the computational software and facilities of the department of geography at the university of california santa barbara were instrumental to carry out the numerical simulations of this work this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors the authors declare there are no conflicts of interests pursuant to the contents of this paper appendix a the exact mathematical statement of the infiltration problem in sloping terrain an eulerian volumetric balance of water can be written for the rev of fig 2 that leads to the following 2d partial differential equation when the dimensions of the rev tend to zero a1 q s s q z z v t in which v denotes the volumetric water content the following steps are taken to transform eq a1 into a partial differential equation written in terms of the soil s properties obtained from its characteristic curves that express the water content and the hydraulic conductivity as functions of the soil water tension see e g van genuchten 1980 lu et al 2010 i substitute eqs 4 and 5 into eq a1 ii introduce the rate of change of the hydraulic conductivity with respect to the soil water tension k h p dk dh p iii introduce the time derivative of the volumetric water content with respect to the water tension in terms of the specific water capacity d s dv dh p hillel 1982 eq a1 is transformed into the following expression once steps i ii and iii are implemented a2 k h p s s k h p z z k h p sin θ h p s k h p cos θ h p z d s h p t eq a2 is the 2d partial differential equation describing the variation of the soil water tension it relies on a system of rotated coordinates aligned with axes parallel and perpendicular to the slope surface on the slope plane eq a2 reduces to the classic 2d richards equation when the slope angle θ 0 and the coordinate axes are rotated clockwise 180 see e g hillel 1982 for a statement of the classic 2d richards equation the initial condition associated with eq a1 is given by a3 h p s z t 0 h po s z in which h po s z expresses the initial distribution of soil water tension within the domain of soil under study the boundary condition on the slope surface z 0 is given by the following formula up to the time of runoff initiation a4 q z r cos θ k cos θ k h p s 0 t z 0 s l 0 t t q or by the following equation after runoff begins a5 h p s 0 t d cos θ 0 s l t t q the time when runoff begins t q occurs when the component of rainfall along the z coordinate r cos θ exceeds for the first time the component of the infiltration rate expressed by the right hand side of eq a4 this time must be obtained by simulating the change in soil water tension and the hydraulic gradient of pressure head on the surface z 0 additionally boundary conditions are necessary below the slope surface for full specification of the mathematical problem describing the variation of the soil water tension within the slope soil caused by water application on the slope surface one possible approach to achieve such specification is to define by educated guessing a geometric boundary described by a function f s z on which the soil water tension is specified another possible approach is to define a boundary f s z describing the position of a phreatic surface on which the soil water tension equals zero if such phreatic surface exists the models hydrus 1d and hydrus 2d 3d simulate the movement of water heat and solutes in variably saturated media and have several options for setting boundary conditions see a review by šimůnek et al 2016 evidently realistic subsurface boundary conditions must be assumed for any solution of eq a2 to be meaningful field data may be available to assist in the formulation of proper values for the subsurface boundary conditions it is evident thus that a numerical solution of the mathematically exact formulation of the infiltration problem on sloping terrain with surficial water input requires specifying the subsurface boundary conditions and the determination of the time of initiation of runoff these specifications introduce uncertainty not present when employing the modified g a infiltration model introduced in this work 
7296,the hyporheic zone hz plays an important role in stream ecology previous studies have mainly focused on the factors influencing the hz in the steady state however the exchange between surface water and groundwater in the hz can become transient during a storm this study investigates the impacts of different rainfall patterns varying in intensity and duration on the hz under transient conditions a two dimensional numerical model of a 10 m long and 2 m deep domain is developed in which the streambed consists of a series of dunes brinkman darcy and navier stokes equations are respectively solved for groundwater and surface water and velocity and pressure are coupled at the interface i e the streambed surface to compare the results under different transient conditions this study proposes two indicators i e the influential time it the time required for the hz to return to its initial state once it starts to change and the influential depth id the maximum increment in the hz depth to detect the extent to which the hz undergoes significant spatial changes moving split window and inflection point tests are conducted the results indicate that rainfall intensity ri and rainfall duration rd both display logarithmic relationships with the it and id with high coefficients of determination but only between certain lower and upper thresholds of the ri and rd moreover the distributions of the it and id as a function of the ri and rd are mapped using the surface spline and kriging interpolation methods to facilitate future prediction of the it and id in addition it is observed that the it has a linear negative correlation with the groundwater response while the id is not affected by different groundwater responses all of the derived relationships can be used to predict the impacts of a future rainfall event on the hz keywords hyporheic zone transient responses rainfall patterns influential time influential depth 1 introduction the hyporheic zone hz which is the region beneath or alongside a streambed and is characterized by the active mixing of shallow groundwater and surface water plays an important role in stream ecology brunke and gonser 1997 peterson et al 2008 hester and gooseff 2010 liu and chui 2017 a number of previous studies have investigated the impacts on the hz of different characteristics of the stream and the streambed i e the geomorphic features of the stream such as stream meanders riffles and dunes e g tonina and buffington 2007 buffington and tonina 2009 stonedahl et al 2010 2013 huang and chui accepted and the hydrogeological properties of the streambed such as heterogeneity and anisotropy cardenas et al 2004 salehin et al 2004 sawyer and cardenas 2009 liu and chui 2017 in these studies the hz was only examined under steady state conditions however the exchange between surface water and groundwater in the hz can change during a transient event e g a storm event wondzell and swanson 1996a 1996b shibata et al 2004 ward et al 2013 larsen et al 2014 malzone et al 2016 and it also displays diel fluctuations hoehn and cirpka 2006 loheide and lundquist 2009 wondzell et al 2010 graham et al 2013 and seasonal variations wondzell and swanson 1996a 1996b wroblicky et al 1998 feris et al 2003 soulsby et al 2009 larsen et al 2014 some studies that did account for transient events focused on biogeochemical and ecological changes in the hz hendricks 1993 triska et al 1993 franken et al 2001 for example dissolved oxygen is vital to a variety of biogeochemical and ecological processes such as spawning and survival e g montgomery et al 1996 rubin 1998 soulsby et al 2001 and surface water is the main source of dissolved oxygen during transient events such as storms more surface water enters into the streambed leading to a change of the spatial extent of the hz and increased active mixing of groundwater and surface water thus producing more dissolved oxygen recently several studies e g bhaskar et al 2012 malzone et al 2016 mccallum and shanafield 2016 schmadel et al 2016 trauth and fleckenstein 2017 have also discussed the temporal changes of water flux and residence time in the hz for example through analyzing the ratio between groundwater flux and hyporheic flux bhaskar et al 2012 found the threshold ratio at which the two fluxes become independent trauth and fleckenstein 2017 found that the hz flux and the solute transport sometimes increased during single discharge events which could increase the reactive efficiency of aerobic respiration and denitrification mccallum and shanafield 2016 pointed out that both diel variations in stream stage and storm flow events could affect the residence time and its distribution in the hz their results also indicated that the stream bank exchanges were temporally dynamic and the residence time distributions of the return flows could have a significant tailing schmadel et al 2016 concluded that the hyporheic flow path lengths and residence times could span orders of magnitude due to diel fluctuations moreover hyporheic flow path lengths and residence times in a transient event can be predicted from the timing and magnitude of diel fluctuations and valley slope schmadel et al 2016 indicated that larger amplitudes of stream stage fluctuations could cause longer hyporheic flow path lengths and residence times malzone et al 2016 discussed the responses of the hz to transient groundwater fluctuations on both annual and storm event time scales and examined groundwater responses that are either in phase or 14 h out of phase other than the well studied residence time and flow paths of the hz its spatial extent which can undergo significant changes during a transient event is also key to understanding the spatial boulton et al 1998 and temporal soulsby et al 2001 2009 dynamics of the hz for example boulton et al 1998 pointed out that water quality in the hz which is related to the ratio of surface water and groundwater governs a variety of in stream ecological processes because this ratio varies with depth and with the spatial extent of the hz during a transient event wondzell and swanson 1999 all of these variations must be studied experimentally to understand the water quality in the hz as another example the hz is an important environment for various species e g salmon and can act as their spawning and hatching grounds e g boulton et al 1998 geist et al 2002 malcolm et al 2004 those species can be sensitive to changes of environmental factors such as the amount of dissolved oxygen and spatial extent of the hz therefore monitoring this spatial extent which is particularly changeable during transient events would help to elucidate the influences of such events on those species one method to delineate the spatial extent of the hz is to calculate the ratio of groundwater and surface water white 1993 triska et al 1989 because the active mixing of these is a defining feature of the hz and gives rise to many of its unique characteristics in the context of storm events several previous studies have evaluated the response of certain characteristics of the hz e g residence time and reaction efficiency however the influence of storm events on the spatial extent of the hz has not been fully explored the relationships quantifying the magnitude and duration of the changes in response to different patterns of storm events are not yet known in previous steady state studies the discharge and depth of the hz are two widely used indicators to describe the characteristics of the hz e g wroblicky et al 1998 fellows et al 2001 hester and doyle 2008 tonina and buffington 2011 harvey et al 2013 kim et al 2014 the hz discharge is commonly used in real case studies and is especially important for obtaining detailed information about specific species living in the streambed e g specific salmon spawning areas geist 2000 or information regarding the interaction between groundwater and surface water in specific sites wondzell 2006 another important indicator of the spatial extent of the hz can be its depth e g when estimating the subsurface storage zone for biogeochemical reactions in the hz harvey and fuller 1998 harvey et al 2013 proposed an effective depth for analyzing the denitrification in the hz based on the hz depth furthermore boano et al 2008 found that the maximum value of the hz depth can be used to infer the extent of groundwater discharge through the streambed and thus the level of surface water groundwater interaction besides discussing its relationship with other processes researchers have also proposed methods for estimating the hz depth for example kim et al 2014 adopted a heat transfer method to estimate the hz depth in the field using temperature data overall these studies have shown that the hz depth as an indicator of the spatial extent of the hz reflects the characteristics of the surface water groundwater interaction and biogeochemical reactions therefore in this study we propose the concept of influential depth id which is dependent on the hz depth to describe the changing spatial extent of the hz under transient conditions moreover we note that it is important to analyze the duration for which the hz undergoes the influence of these conditions however to the best of the authors knowledge no explicit parameter exists to describe the processes in the hz from the temporal perspective to fill this gap we propose another indicator the influential time it in this study therefore the main objectives of this study are as follows first two indicators the it and id are proposed to quantify the changes of the hz under transient conditions moreover their relationships with different rainfall patterns varying in intensity and duration are also analyzed second two methods the moving split window msw ludwig and cornelius 1987 and the inflection point test ipt methods bronshtein et al 2004 are used to identify the extent to which the hz undergoes significant spatial changes through rainfall events third the impacts of groundwater response timing on the hz are discussed overall the proposed methods and the obtained results enhance our understanding of the changes of the hz caused by different rainfall patterns and groundwater responses which could have important biogeochemical and ecological implications for the improved understanding and management of the hz 2 methodology 2 1 numerical model the hz under the conditions of a transient event is simulated through comsol multiphysics and the numerical model is principally based on the studies of shen et al 1990 and malzone et al 2016 the laboratory experiment of shen et al 1990 investigated the resistance of the bed form in open channel flow in a steady state and measured the relative hydraulic head at the streambed in open channel flow which is important information for simulation of the hz therefore the model of this study uses the same basic configurations i e the same properties of the streambed sediment average flow depth over the dune and flow velocity as that laboratory experiment next referring to the numerical model used by malzone et al 2016 this study establishes a two dimensional groundwater stream model with a domain 10 m long and 2 m deep fig 1 the streambed consists of a series of dunes that induce hyporheic exchanges to analyze the transient changes in the hz in detail the results from three observation cross sections are extracted which intersect the middle highest and lowest points of a dune as shown in fig 1 the middle cross section represents the average hz change over this dune while the other two capture the hz changes towards the peak and the bottom of the dune respectively 2 1 1 governing equations and assumptions the governing equations in this numerical model include the navier stokes equation and the brinkman darcy equation which are used for the simulation of surface water and groundwater respectively under most simulation scenarios in this study the flow state of the surface water remains laminar and therefore the navier stokes equation eq 1 is adopted tritton 1988 however for the porous media domain the brinkman darcy equation eq 2 is used brinkman 1949 1 ρ u t u u p μ 2 u 0 ρ u 0 2 ρ 1 ε u t 1 ε 2 u u p μ e 2 u μ k u 0 where ρ is the density of the fluid kg m3 u is the velocity m s t is the time s p is the pressure pa μ is the dynamic viscosity pa s μe is the effective viscosity pa s k is the intrinsic permeability m2 ε is the brinkman porosity and μu k is the darcy term pa m it is worth noting that at the interface of the streambed and stream these two equations are coupled through the pressure and velocity 2 1 2 boundary conditions the relevant boundary conditions are chosen to reproduce those typically used in other similar studies e g cardenas et al 2008 the upstream and downstream boundary conditions are defined by the periodic condition of the pressure difference this value corresponds to the difference in stream stage in the range of 0 0 05 m derived from the rainfall runoff simulation of the storm event the upper boundary is defined as the slip boundary condition while the lower boundary is based on the groundwater influx from malzone et al 2016 which provided a reasonable range of groundwater velocity for the hz during annual storm events this study in fact uses the same method as malzone et al 2016 to generate the rainfall events making it appropriate to use the same approach to generate the groundwater response 2 1 3 modeling scenarios to examine the impacts of different rainfall patterns varying in intensity and duration on the hz various modeling scenarios are adopted as listed in table 1 in this study the baseline scenario is a storm event with rainfall intensity ri of 30 mm h and rainfall duration rd of 6 h in one set of storm events the baseline value of rd is used in each case 6 h while the ris in the different scenarios vary from 10 mm h to 50 mm h with equal intervals of 10 mm h conversely in the other set of storm events the baseline ri is used 30 mm h while the rds vary from 1 h to 12 h with unequal intervals as listed in table 1 moreover as demonstrated by malzone et al 2015 2016 the nature of the groundwater response may affect the maximum peak and tailing behavior of the hz responses consequently five modeling scenarios with different groundwater responses to the same storm event i e the baseline scenario are considered in this study to ensure that only one variable changes between the different modeling scenarios the total groundwater runoffs are assumed to be the same under all five scenarios but the peaks are either in phase 2 5 10 or 14 h out of phase with the surface runoff respectively see table 1 the lags in the groundwater responses are selected based on the conclusions of malzone et al 2015 2016 who regarded the maximum lag as 14 h for each storm event with the designated ri rd values the unit hydrographs showing groundwater and surface water responses to the particular storm event are first calculated the pressures at the inlet and outlet of the domain see fig 1 are defined using the unit hydrographs and the results from a simple box rainfall runoff model and the groundwater velocity at the bottom of the domain is then defined accordingly malzone et al 2016 finally the navier stokes and the brinkman darcy equations are solved and coupled through the pressure and velocity at the interface of the streambed and stream 2 2 variables used to characterize hz to accurately characterize the hz under transient conditions a number of variables are used first the spatial extent of the hz should be defined previous studies have used different methods and criteria to determine the spatial extent the two most common ways to define the spatial extent of the hz are based on the specific mixing ratio of groundwater and surface water hill et al 1998 triska et al 1989 and the proportion of surface water that returns to the stream within a certain time lautz and siegel 2006 however those definitions assume a steady state and are tailored to the specific purposes of their studies and therefore cannot be directly adopted in this study to define both the spatial extent of the hz and its change under transient conditions in this study two indicators i e the it and id of the hz are proposed to quantify this change the it is the time required for the hz to return to its initial state once it starts to change while the id is the maximum increment in the depth of the hz fig 2 to determine the it two time points are recorded from the simulation results i e the moment when the hz starts to change due to a transient event and the moment when the hz returns to the initial state after the transient event and the it is calculated as the duration between the two time points similarly the id is calculated as the difference between the maximum depth of the hz caused by a transient event and the initial depth of the hz before the transient event these two variables describe the transient characteristics of the hz temporally and spatially during rainfall events respectively following the study of malzone et al 2016 this study uses a conservative tracer and links the advection diffusion equation for solute transport to the flow equations the initial solution concentrations of 1 and 0 mol m3 are respectively assigned to surface water and groundwater inflows so that the solution concentrations within the streambed indicate the percentage of surface water throughout the modeled domain the spatial extent in which surface water is present i e having a certain threshold of concentration is defined as the hz based on a large number of simulations the contour line with the solution concentration of 0 0001 mol m3 can be regarded as the boundary of the hz i e the red line in fig 2 moreover it is worth noting that the contour line i e the hz boundary only changes minimally when the concentration threshold increases or decreases by 10 i e the two green lines in fig 2 2 3 detection of extent to which hz undergoes significant spatial changes to determine under which conditions the spatial extent of the hz undergoes the most significant change the msw method ludwig and cornelius 1987 is adopted this procedure analyzes the solution concentrations at different depths which indicate the mixing of groundwater and surface water from comsol and can be summarized as follows first the width of the split window δc in fig 3 is assigned as mentioned in section 2 2 the initial solution concentrations in surface water and groundwater are set to be 1 and 0 mol m3 respectively therefore the solution concentrations at all depths of the hz will be between 0 and 1 mol m3 with the limiting values of 1 and 0 mol m3 at the streambed surface and deep into the streambed respectively as a result the value of the split window width will be the percentage of the concentration change that is accounted for by the significant changes to the spatial extent of the hz for example if the split window width is set to be 0 5 the spatial extent of the hz that gives 0 5 i e 50 of the concentration change will be detected fig 3 second the designated split window moves from 0 to 1 mol m3 stepwise and the step size and the number of steps are the same as those of the model output for each step the two depths corresponding to the upper and lower boundaries of the split window are detected and the difference between these two depths δd in fig 3 is calculated as a result a series of δd can be obtained third the depth dependent rate of concentration change at each depth can be computed as δc δd when these depth dependent rates are plotted over time the most significant changes to the spatial extent of the hz can be identified by the occurrence of the maximum δc δd to evaluate the validity of the msw method it is compared with the ipt method bronshtein et al 2004 which is an alternative approach to detect the spatial region of the hz with the most significant change the two inflection points of the concentration profile in fig 3 indicate the locations at which the curve changes from concave to convex in this study first the depth dependent rate of concentration change for every step is calculated second the differences of the depth dependent rates between every two adjacent steps are obtained third the two inflection points can be identified by selecting the maximum and minimum values from the series of differences of the depth dependent rates the first and second inflection points respectively denote the lower and upper bounds of the spatial region of the hz with the most significant change the difference in concentration between these two points has the same meaning as the split window width in the msw method in addition these two inflection points can be regarded as the demarcation points between the different regions of the hz influenced mostly by surface water by surface water and groundwater jointly and mostly by groundwater respectively 2 4 spatial interpolation methods to map the distributions of the it and id values as a function of the rd and ri spatial interpolation is used the many available interpolation methods include the thiessen polygon inverse distance weighting surface spline and kriging e g thiessen and alter 1911 shepard 1968 harder and desmarais 1972 cressie 1990 the surface spline is a useful mathematical tool for interpolating a function of two variables its main advantages are that the coordinates of the known points need not be located in a rectangular array and the function may be differentiated harder and desmarais 1972 shi and li 2017 therefore surface spline is chosen in this study as a representative mathematical interpolation method kriging a geostatistical interpolation method provides better results than mathematical interpolation methods in some cases e g tabios and salas 1985 shiode and shiode 2011 shahbeik et al 2014 but not others e g dirks et al 1998 gong et al 2014 shi et al 2014 2016 2017 the performance of this method depends on whether it is used under correct assumptions and with sufficient data samples in hz related studies kriging has been successfully used to describe the spatial variability of water table elevations desbarats et al 2002 rivest et al 2008 in this study both mathematical interpolation i e surface spline and geostatistical interpolation i e kriging are adopted to map the distributions of the it and id values as a function of the rd and ri the performances of these two methods in estimating the it and id values are evaluated and compared using the taylor diagram taylor 2001 3 results and discussion the performance of the numerical model has been verified through comparing the simulation results of this study with the laboratory results from fehlman 1985 and shen et al 1990 regarding the pressure distribution along the interface between surface water and streambed fig 4 compares the simulation results with the data of shen et al 1990 and shows a generally good match confirming that the model accurately simulates the pressure distribution on the interface of surface water and streambed over the dune as mentioned in section 2 1 the analysis is based on the results extracted from three cross sections in some cases the hz processes can depend on the nature of the dune e g stonedahl et al 2013 however in this study only the magnitudes of the changes in the hz e g the absolute values of the it and id are dune dependent while the trends in variation of these variables are nearly identical in all three cross sections therefore only the results from the middle of the dune are discussed below as a representative case 3 1 spatial extents of hz with designated amount of change using the msw method the spatial extents of the hz accounting for various designated percentages of the concentration change can be detected taking the baseline scenario as the example fig 5 shows the spatial extents of the hz that account for the concentration changes of 50 and 90 as well as the changes of the spatial extents in response to the rainfall event the detected spatial extents are shown together with the rate of change with depth δc δd confirming that the msw method proposed in this study can accurately identify the extent to which the hz undergoes significant spatial change as can be observed the range between the yellow lines in fig 5 effectively captures the entire spatial extent of the hz with significant change as this region accounts for 90 of the concentration change as a function of depth in the hz the concentration change beyond the yellow lines is mostly limited to values less than 1 mol m3 m the spatial extent of the hz with significant change is also detected by the ipt method and the results are compared against those detected by the msw method with the split window width of 90 for four scenarios see fig 6 and table 2 the spatial extents detected by these two methods mostly overlap specifically in the right hand plots of fig 6 the spatial extent detected by the msw method is fully contained within that from the ipt method to quantify the overlap the spatial extent of the hz between the upper and lower bounds in fig 6 is integrated over time for both methods the computed results i e the cumulative spatial extents of the hz are listed in table 2 it is observed that over 80 of the cumulative spatial extent of the hz from either method is included within the overlap which indicates the consistency between the msw and ipt methods the msw method however has the additional advantage that the range of concentration to be detected can be varied e g 50 versus 90 to serve different purposes its results may therefore be more informative and more useful in practical scenarios the spatial extents of the hz that are jointly influenced by surface water and groundwater are those within the upper and lower bounds in fig 6 and account for very significant portions of the hz especially during non rainy periods in response to the rainfall events during the first day the spatial extents of the hz influenced by surface water alone i e the range above the upper bound increase significantly these surface water influenced spatial extents and their changes in response to rainfall are nearly the same under all four selected scenarios however the jointly influenced spatial extents i e the range between the upper and lower bounds differ among the four scenarios defined by different ri and rd 3 2 impacts of ri and rd on hz 3 2 1 relationships of ri with it and id in this study five ri values of 10 20 30 40 and 50 mm h are simulated using the same rd value 6 h and the same groundwater response in phase table 1 this variation in the ri results in changes of the it and id generally the relationships of the ri with both the it the red solid line in fig 7 a and id the blue dash line in fig 7a can be fitted to logarithmic curves with high coefficients of determination but only between certain lower and upper thresholds of the ri when the ri is below the lower threshold 20 mm h in this case or above the upper threshold 50 mm h in this case both the it and id change only minimally as a function of the ri therefore the it and id can be estimated by the following regression equations 3 it 6 4 ri 20 2 65 ln ri 1 17 20 ri 50 r 2 0 96 9 0 ri 50 4 id 0 19 ri 20 0 44 ln ri 1 06 20 ri 50 r 2 0 90 0 60 ri 50 the r 2 values of these equations are both high which indicates that the it and id can be accurately estimated from the ri therefore the derived relationships can be used to predict the impact of the ri on the hz in a future rainfall event as indicated by the logarithmic curves in fig 7a the dependence of the it and id on the ri becomes weaker as the ri becomes larger this indicates that the impact of the ri on the hz decreases at higher ri values when it reaches the upper threshold the additional impact induced by increasing the ri is minimal the existence of a lower threshold however indicates that certain minimum values of the ri are required to exert any change on the hz as reflected by the it and id the upper threshold may be related to the interaction between the groundwater and surface water bhaskar et al 2012 also pointed out a similar lower threshold in the ratio of groundwater to hyporheic flux only if the ratio between groundwater flux and hyporheic flux exceeds 1000 in a gaining stream does the hyporheic flux decrease when the groundwater flux increases if the ratio is below 1000 the hyporheic flux is independent and only changes minimally with the groundwater flux we propose that during a rainfall event the hz first responds to surface water processes and then later to groundwater processes which are intrinsically slower at high ri the hz tends to remain in the state at which the interaction between groundwater and surface water is established in the transient situation therefore the results of this study suggest that in the range between the lower and upper thresholds the it and id are mainly determined by the characteristics of the storm e g the ri however when the ri is above the upper threshold the changes in the hz may be related to both surface water and groundwater responses 3 2 2 relationships of rd with it and id in this study eight rd values of 1 3 4 4 5 5 6 9 and 12 h are simulated using the same ri value 30 mm h and the same groundwater response in phase table 1 again the it and id generally show positive relationships with the rd but only between certain lower and upper thresholds of the rd fig 7b if the rd is shorter than the lower threshold 4 h in this case or longer than the upper threshold 9 h in this case the it and id change only minimally with the rd the it and id can be estimated by the following regression equations 5 it 6 5 rd 4 2 81 ln rd 2 74 4 rd 9 r 2 0 98 9 0 rd 9 6 id 0 19 rd 4 0 42 ln rd 0 32 4 rd 9 r 2 0 86 0 55 rd 9 for rd values between the lower and upper thresholds the relationships of the rd with the it the red solid line in fig 7b and id the blue dash line in fig 7b are also logarithmic the r 2 values of these two equations are generally high especially for eq 5 which indicates that the it and id can be accurately estimated from the rd value using the above equations the lower and upper thresholds of the rd carry practical implications especially for ecological conservation namely that the changes in the hz may be safely ignored if the rd is sufficiently short and may tend to a limiting value if the rd is sufficiently long for any study or restoration project related to the hz the thresholds can be pre determined through numerical simulations then it can be predicted whether a particular rainfall event would influence the hz cardenas and wilson 2007 concluded that the depth of the hz is sensitive to the reynolds number when the groundwater and hyporheic flows are slow which may be related to the change of the id between the two thresholds observed in this study here the id is found to have logarithmic relationships with the ri and rd within certain ranges of those two quantities it therefore changes significantly when the ri and rd and thus the hyporheic flow are relatively small this is in line with the high sensitivity of the hz depth at slow hyporheic flow demonstrated by cardenas and wilson 2007 the present study further provides the logarithmic relationships among those factors which may help to predict and evaluate the it and id in other cases 3 2 3 mapping it and id with ri and rd to further investigate the combined impacts of the ri and rd on the hz the distributions of the it and id as a function of the ri and rd are mapped using both the surface spline and kriging interpolation methods and the results are shown in fig 8 the upper and lower pairs of subplots correspond to the surface spline and kriging interpolation methods respectively generally the distributions of the it and id are similar between the two methods with both presenting increasing trends in response to the increases of the rd and ri furthermore five different storm events indicated by the black stars in fig 8 are randomly selected to evaluate the performances of the two interpolation methods the rd and ri of these five events and also the corresponding it and id derived from model simulation and from the surface spline and kriging interpolation methods are all listed in table 3 through comparing the values estimated by the two interpolation methods against those simulated by the model the relative errors are obtained and are shown in parentheses overall the performances of the two interpolation methods are about the same however the relative errors in it are much smaller than those in id for both methods moreover it is worth noting that the id of the verification points is best estimated for those points located between the lower and upper thresholds of the rd i e 4 h rd 9 h and the ri i e 20 mm h ri 50 mm h which are the latter three verification points in table 3 in addition taylor diagrams taylor 2001 are plotted to further evaluate the performances of the two interpolation methods fig 9 it is clear that kriging outperforms the surface spline interpolation method because the former has higher coefficients of correlation smaller root mean square errors and smaller standard deviations 3 3 impacts of different groundwater responses on the hz in this study five different groundwater responses to the same storm event are considered i e in phase 2 5 10 and 14 h out of phase table 1 as mentioned in section 2 1 3 the total groundwater runoffs are set to be the same under all five modeling scenarios as a consequence of which all of the groundwater curves in fig 10 a have the same area under the curve thus the peak of the groundwater curve becomes smaller as the time lag is prolonged fig 10b shows the changes of the it and id under these five modeling scenarios as can be observed the time lags show very different relationships with the it and with the id the it shows a linear negative correlation with the time lag and the coefficient of determination reaches 0 98 however the overall percentage change of the it is not large in contrast the id does not change with the increase of the time lag mainly because the total groundwater runoffs are the same under all five modeling scenarios 3 4 limitations in this study the surface flow is assumed to remain laminar at all times the justification for this is that the flow is indeed laminar for most of the time according to the reynolds number and becomes turbulent only for very limited periods even under the scenario most influenced by rainfall events compared with both the total rainfall duration and the it of the hz such short periods of turbulence can be ignored for example in the two scenarios that have the largest rainfall intensity or the longest rainfall duration i e ri 60 mm h rd 6 h and ri 30 mm h rd 12 h the periods for which the reynolds number exceeds 4000 i e turbulent flow are 6 5 h and 11 75 h respectively these are much shorter than the it values under the two scenarios which are 214 9 h and 216 0 h respectively however future work may consider turbulent flow to further improve the accuracy of the results in this study the numerical model is built under several assumptions which may not be realistic specifically the streambed is assumed to be homogeneous but in reality the heterogeneity of the streambed would directly alter the flow pattern and residence time for example with the same mean value of the hydraulic conductivities the mean and median residence times are shorter in a heterogeneous than in a homogeneous streambed liu and chui 2017 heterogeneity may therefore also shorten the it in this study the other limitation of this study is the use of a two dimensional model unlike a three dimensional model the two dimensional model ignores the flow outside the simulated vertical profile of the streambed this may therefore result in a larger id than that of a real case moreover the differences in hydraulic head between the surface water and groundwater are not the same in the different profiles of the streambed thus simulating only one profile and regarding it to be representative of the whole streambed may introduce errors furthermore the hz discharge is not selected as an indicator in this study for the following reason the hz discharge under the baseline scenario was calculated and compared with the hz depth it was observed that the response of the hz discharge was more significant i e the percentage change was larger and occurred earlier than that of the hz depth however the hz discharge also returned to its initial state very quickly around 6 h after the rainfall ceased in contrast the change of the hz depth was much longer lasting as this study aims to investigate the impacts of rainfall events on the hz in terms of the change in spatial extent and the time needed for recovery the it and id are selected as the most appropriate indicators nevertheless as the hz discharge can indeed be significantly influenced by a rainfall event it may be considered in future work together with the it and id proposed in this study to evaluate the hz response to a rainfall event 4 conclusion this study investigated the impacts of different rainfall patterns on the hz under transient conditions based on a two dimensional numerical model with a variety of modeling scenarios the major findings can be summarized as follows first the msw method can be used to accurately detect the extent to which the hz undergoes significant spatial changes under different transient conditions in this respect it outperforms the ipt method second two indicators i e the it and id of the hz are proposed to quantify the change of the hz under different rainfall patterns logarithmic relationships are found to link both the ri and rd with both the it and id but only when the ri and rd are between certain lower and upper threshold values the derived relationships can be used to predict the influence of a future rainfall event on the hz third two spatial interpolation methods have been used to predict the different hz characteristics given various ri and rd their predictive performance is satisfactory demonstrating that the spatial interpolation methods and the interpolated results can be used to preliminarily evaluate the characteristics of the hz given different ri and rd values lastly the id and it are discussed in the context of different groundwater responses to the same rainfall event the nature of the groundwater response influences the it but not the id suggesting that given the same total volume of groundwater variations in the temporal pattern would only affect the response rate but not the spatial extent of the hz overall the proposed methods and the conclusions enhance our understanding and will facilitate future studies regarding the transient nature of the hz which could have numerous biogeochemical and ecological implications acknowledgements this study is supported by a grant from the research grants council of the hong kong special administrative region china project no hku17203815 we are also grateful to dr jonathan malzone from department of geosciences eastern kentucky university united states who has advised us on the development of the numerical model 
7296,the hyporheic zone hz plays an important role in stream ecology previous studies have mainly focused on the factors influencing the hz in the steady state however the exchange between surface water and groundwater in the hz can become transient during a storm this study investigates the impacts of different rainfall patterns varying in intensity and duration on the hz under transient conditions a two dimensional numerical model of a 10 m long and 2 m deep domain is developed in which the streambed consists of a series of dunes brinkman darcy and navier stokes equations are respectively solved for groundwater and surface water and velocity and pressure are coupled at the interface i e the streambed surface to compare the results under different transient conditions this study proposes two indicators i e the influential time it the time required for the hz to return to its initial state once it starts to change and the influential depth id the maximum increment in the hz depth to detect the extent to which the hz undergoes significant spatial changes moving split window and inflection point tests are conducted the results indicate that rainfall intensity ri and rainfall duration rd both display logarithmic relationships with the it and id with high coefficients of determination but only between certain lower and upper thresholds of the ri and rd moreover the distributions of the it and id as a function of the ri and rd are mapped using the surface spline and kriging interpolation methods to facilitate future prediction of the it and id in addition it is observed that the it has a linear negative correlation with the groundwater response while the id is not affected by different groundwater responses all of the derived relationships can be used to predict the impacts of a future rainfall event on the hz keywords hyporheic zone transient responses rainfall patterns influential time influential depth 1 introduction the hyporheic zone hz which is the region beneath or alongside a streambed and is characterized by the active mixing of shallow groundwater and surface water plays an important role in stream ecology brunke and gonser 1997 peterson et al 2008 hester and gooseff 2010 liu and chui 2017 a number of previous studies have investigated the impacts on the hz of different characteristics of the stream and the streambed i e the geomorphic features of the stream such as stream meanders riffles and dunes e g tonina and buffington 2007 buffington and tonina 2009 stonedahl et al 2010 2013 huang and chui accepted and the hydrogeological properties of the streambed such as heterogeneity and anisotropy cardenas et al 2004 salehin et al 2004 sawyer and cardenas 2009 liu and chui 2017 in these studies the hz was only examined under steady state conditions however the exchange between surface water and groundwater in the hz can change during a transient event e g a storm event wondzell and swanson 1996a 1996b shibata et al 2004 ward et al 2013 larsen et al 2014 malzone et al 2016 and it also displays diel fluctuations hoehn and cirpka 2006 loheide and lundquist 2009 wondzell et al 2010 graham et al 2013 and seasonal variations wondzell and swanson 1996a 1996b wroblicky et al 1998 feris et al 2003 soulsby et al 2009 larsen et al 2014 some studies that did account for transient events focused on biogeochemical and ecological changes in the hz hendricks 1993 triska et al 1993 franken et al 2001 for example dissolved oxygen is vital to a variety of biogeochemical and ecological processes such as spawning and survival e g montgomery et al 1996 rubin 1998 soulsby et al 2001 and surface water is the main source of dissolved oxygen during transient events such as storms more surface water enters into the streambed leading to a change of the spatial extent of the hz and increased active mixing of groundwater and surface water thus producing more dissolved oxygen recently several studies e g bhaskar et al 2012 malzone et al 2016 mccallum and shanafield 2016 schmadel et al 2016 trauth and fleckenstein 2017 have also discussed the temporal changes of water flux and residence time in the hz for example through analyzing the ratio between groundwater flux and hyporheic flux bhaskar et al 2012 found the threshold ratio at which the two fluxes become independent trauth and fleckenstein 2017 found that the hz flux and the solute transport sometimes increased during single discharge events which could increase the reactive efficiency of aerobic respiration and denitrification mccallum and shanafield 2016 pointed out that both diel variations in stream stage and storm flow events could affect the residence time and its distribution in the hz their results also indicated that the stream bank exchanges were temporally dynamic and the residence time distributions of the return flows could have a significant tailing schmadel et al 2016 concluded that the hyporheic flow path lengths and residence times could span orders of magnitude due to diel fluctuations moreover hyporheic flow path lengths and residence times in a transient event can be predicted from the timing and magnitude of diel fluctuations and valley slope schmadel et al 2016 indicated that larger amplitudes of stream stage fluctuations could cause longer hyporheic flow path lengths and residence times malzone et al 2016 discussed the responses of the hz to transient groundwater fluctuations on both annual and storm event time scales and examined groundwater responses that are either in phase or 14 h out of phase other than the well studied residence time and flow paths of the hz its spatial extent which can undergo significant changes during a transient event is also key to understanding the spatial boulton et al 1998 and temporal soulsby et al 2001 2009 dynamics of the hz for example boulton et al 1998 pointed out that water quality in the hz which is related to the ratio of surface water and groundwater governs a variety of in stream ecological processes because this ratio varies with depth and with the spatial extent of the hz during a transient event wondzell and swanson 1999 all of these variations must be studied experimentally to understand the water quality in the hz as another example the hz is an important environment for various species e g salmon and can act as their spawning and hatching grounds e g boulton et al 1998 geist et al 2002 malcolm et al 2004 those species can be sensitive to changes of environmental factors such as the amount of dissolved oxygen and spatial extent of the hz therefore monitoring this spatial extent which is particularly changeable during transient events would help to elucidate the influences of such events on those species one method to delineate the spatial extent of the hz is to calculate the ratio of groundwater and surface water white 1993 triska et al 1989 because the active mixing of these is a defining feature of the hz and gives rise to many of its unique characteristics in the context of storm events several previous studies have evaluated the response of certain characteristics of the hz e g residence time and reaction efficiency however the influence of storm events on the spatial extent of the hz has not been fully explored the relationships quantifying the magnitude and duration of the changes in response to different patterns of storm events are not yet known in previous steady state studies the discharge and depth of the hz are two widely used indicators to describe the characteristics of the hz e g wroblicky et al 1998 fellows et al 2001 hester and doyle 2008 tonina and buffington 2011 harvey et al 2013 kim et al 2014 the hz discharge is commonly used in real case studies and is especially important for obtaining detailed information about specific species living in the streambed e g specific salmon spawning areas geist 2000 or information regarding the interaction between groundwater and surface water in specific sites wondzell 2006 another important indicator of the spatial extent of the hz can be its depth e g when estimating the subsurface storage zone for biogeochemical reactions in the hz harvey and fuller 1998 harvey et al 2013 proposed an effective depth for analyzing the denitrification in the hz based on the hz depth furthermore boano et al 2008 found that the maximum value of the hz depth can be used to infer the extent of groundwater discharge through the streambed and thus the level of surface water groundwater interaction besides discussing its relationship with other processes researchers have also proposed methods for estimating the hz depth for example kim et al 2014 adopted a heat transfer method to estimate the hz depth in the field using temperature data overall these studies have shown that the hz depth as an indicator of the spatial extent of the hz reflects the characteristics of the surface water groundwater interaction and biogeochemical reactions therefore in this study we propose the concept of influential depth id which is dependent on the hz depth to describe the changing spatial extent of the hz under transient conditions moreover we note that it is important to analyze the duration for which the hz undergoes the influence of these conditions however to the best of the authors knowledge no explicit parameter exists to describe the processes in the hz from the temporal perspective to fill this gap we propose another indicator the influential time it in this study therefore the main objectives of this study are as follows first two indicators the it and id are proposed to quantify the changes of the hz under transient conditions moreover their relationships with different rainfall patterns varying in intensity and duration are also analyzed second two methods the moving split window msw ludwig and cornelius 1987 and the inflection point test ipt methods bronshtein et al 2004 are used to identify the extent to which the hz undergoes significant spatial changes through rainfall events third the impacts of groundwater response timing on the hz are discussed overall the proposed methods and the obtained results enhance our understanding of the changes of the hz caused by different rainfall patterns and groundwater responses which could have important biogeochemical and ecological implications for the improved understanding and management of the hz 2 methodology 2 1 numerical model the hz under the conditions of a transient event is simulated through comsol multiphysics and the numerical model is principally based on the studies of shen et al 1990 and malzone et al 2016 the laboratory experiment of shen et al 1990 investigated the resistance of the bed form in open channel flow in a steady state and measured the relative hydraulic head at the streambed in open channel flow which is important information for simulation of the hz therefore the model of this study uses the same basic configurations i e the same properties of the streambed sediment average flow depth over the dune and flow velocity as that laboratory experiment next referring to the numerical model used by malzone et al 2016 this study establishes a two dimensional groundwater stream model with a domain 10 m long and 2 m deep fig 1 the streambed consists of a series of dunes that induce hyporheic exchanges to analyze the transient changes in the hz in detail the results from three observation cross sections are extracted which intersect the middle highest and lowest points of a dune as shown in fig 1 the middle cross section represents the average hz change over this dune while the other two capture the hz changes towards the peak and the bottom of the dune respectively 2 1 1 governing equations and assumptions the governing equations in this numerical model include the navier stokes equation and the brinkman darcy equation which are used for the simulation of surface water and groundwater respectively under most simulation scenarios in this study the flow state of the surface water remains laminar and therefore the navier stokes equation eq 1 is adopted tritton 1988 however for the porous media domain the brinkman darcy equation eq 2 is used brinkman 1949 1 ρ u t u u p μ 2 u 0 ρ u 0 2 ρ 1 ε u t 1 ε 2 u u p μ e 2 u μ k u 0 where ρ is the density of the fluid kg m3 u is the velocity m s t is the time s p is the pressure pa μ is the dynamic viscosity pa s μe is the effective viscosity pa s k is the intrinsic permeability m2 ε is the brinkman porosity and μu k is the darcy term pa m it is worth noting that at the interface of the streambed and stream these two equations are coupled through the pressure and velocity 2 1 2 boundary conditions the relevant boundary conditions are chosen to reproduce those typically used in other similar studies e g cardenas et al 2008 the upstream and downstream boundary conditions are defined by the periodic condition of the pressure difference this value corresponds to the difference in stream stage in the range of 0 0 05 m derived from the rainfall runoff simulation of the storm event the upper boundary is defined as the slip boundary condition while the lower boundary is based on the groundwater influx from malzone et al 2016 which provided a reasonable range of groundwater velocity for the hz during annual storm events this study in fact uses the same method as malzone et al 2016 to generate the rainfall events making it appropriate to use the same approach to generate the groundwater response 2 1 3 modeling scenarios to examine the impacts of different rainfall patterns varying in intensity and duration on the hz various modeling scenarios are adopted as listed in table 1 in this study the baseline scenario is a storm event with rainfall intensity ri of 30 mm h and rainfall duration rd of 6 h in one set of storm events the baseline value of rd is used in each case 6 h while the ris in the different scenarios vary from 10 mm h to 50 mm h with equal intervals of 10 mm h conversely in the other set of storm events the baseline ri is used 30 mm h while the rds vary from 1 h to 12 h with unequal intervals as listed in table 1 moreover as demonstrated by malzone et al 2015 2016 the nature of the groundwater response may affect the maximum peak and tailing behavior of the hz responses consequently five modeling scenarios with different groundwater responses to the same storm event i e the baseline scenario are considered in this study to ensure that only one variable changes between the different modeling scenarios the total groundwater runoffs are assumed to be the same under all five scenarios but the peaks are either in phase 2 5 10 or 14 h out of phase with the surface runoff respectively see table 1 the lags in the groundwater responses are selected based on the conclusions of malzone et al 2015 2016 who regarded the maximum lag as 14 h for each storm event with the designated ri rd values the unit hydrographs showing groundwater and surface water responses to the particular storm event are first calculated the pressures at the inlet and outlet of the domain see fig 1 are defined using the unit hydrographs and the results from a simple box rainfall runoff model and the groundwater velocity at the bottom of the domain is then defined accordingly malzone et al 2016 finally the navier stokes and the brinkman darcy equations are solved and coupled through the pressure and velocity at the interface of the streambed and stream 2 2 variables used to characterize hz to accurately characterize the hz under transient conditions a number of variables are used first the spatial extent of the hz should be defined previous studies have used different methods and criteria to determine the spatial extent the two most common ways to define the spatial extent of the hz are based on the specific mixing ratio of groundwater and surface water hill et al 1998 triska et al 1989 and the proportion of surface water that returns to the stream within a certain time lautz and siegel 2006 however those definitions assume a steady state and are tailored to the specific purposes of their studies and therefore cannot be directly adopted in this study to define both the spatial extent of the hz and its change under transient conditions in this study two indicators i e the it and id of the hz are proposed to quantify this change the it is the time required for the hz to return to its initial state once it starts to change while the id is the maximum increment in the depth of the hz fig 2 to determine the it two time points are recorded from the simulation results i e the moment when the hz starts to change due to a transient event and the moment when the hz returns to the initial state after the transient event and the it is calculated as the duration between the two time points similarly the id is calculated as the difference between the maximum depth of the hz caused by a transient event and the initial depth of the hz before the transient event these two variables describe the transient characteristics of the hz temporally and spatially during rainfall events respectively following the study of malzone et al 2016 this study uses a conservative tracer and links the advection diffusion equation for solute transport to the flow equations the initial solution concentrations of 1 and 0 mol m3 are respectively assigned to surface water and groundwater inflows so that the solution concentrations within the streambed indicate the percentage of surface water throughout the modeled domain the spatial extent in which surface water is present i e having a certain threshold of concentration is defined as the hz based on a large number of simulations the contour line with the solution concentration of 0 0001 mol m3 can be regarded as the boundary of the hz i e the red line in fig 2 moreover it is worth noting that the contour line i e the hz boundary only changes minimally when the concentration threshold increases or decreases by 10 i e the two green lines in fig 2 2 3 detection of extent to which hz undergoes significant spatial changes to determine under which conditions the spatial extent of the hz undergoes the most significant change the msw method ludwig and cornelius 1987 is adopted this procedure analyzes the solution concentrations at different depths which indicate the mixing of groundwater and surface water from comsol and can be summarized as follows first the width of the split window δc in fig 3 is assigned as mentioned in section 2 2 the initial solution concentrations in surface water and groundwater are set to be 1 and 0 mol m3 respectively therefore the solution concentrations at all depths of the hz will be between 0 and 1 mol m3 with the limiting values of 1 and 0 mol m3 at the streambed surface and deep into the streambed respectively as a result the value of the split window width will be the percentage of the concentration change that is accounted for by the significant changes to the spatial extent of the hz for example if the split window width is set to be 0 5 the spatial extent of the hz that gives 0 5 i e 50 of the concentration change will be detected fig 3 second the designated split window moves from 0 to 1 mol m3 stepwise and the step size and the number of steps are the same as those of the model output for each step the two depths corresponding to the upper and lower boundaries of the split window are detected and the difference between these two depths δd in fig 3 is calculated as a result a series of δd can be obtained third the depth dependent rate of concentration change at each depth can be computed as δc δd when these depth dependent rates are plotted over time the most significant changes to the spatial extent of the hz can be identified by the occurrence of the maximum δc δd to evaluate the validity of the msw method it is compared with the ipt method bronshtein et al 2004 which is an alternative approach to detect the spatial region of the hz with the most significant change the two inflection points of the concentration profile in fig 3 indicate the locations at which the curve changes from concave to convex in this study first the depth dependent rate of concentration change for every step is calculated second the differences of the depth dependent rates between every two adjacent steps are obtained third the two inflection points can be identified by selecting the maximum and minimum values from the series of differences of the depth dependent rates the first and second inflection points respectively denote the lower and upper bounds of the spatial region of the hz with the most significant change the difference in concentration between these two points has the same meaning as the split window width in the msw method in addition these two inflection points can be regarded as the demarcation points between the different regions of the hz influenced mostly by surface water by surface water and groundwater jointly and mostly by groundwater respectively 2 4 spatial interpolation methods to map the distributions of the it and id values as a function of the rd and ri spatial interpolation is used the many available interpolation methods include the thiessen polygon inverse distance weighting surface spline and kriging e g thiessen and alter 1911 shepard 1968 harder and desmarais 1972 cressie 1990 the surface spline is a useful mathematical tool for interpolating a function of two variables its main advantages are that the coordinates of the known points need not be located in a rectangular array and the function may be differentiated harder and desmarais 1972 shi and li 2017 therefore surface spline is chosen in this study as a representative mathematical interpolation method kriging a geostatistical interpolation method provides better results than mathematical interpolation methods in some cases e g tabios and salas 1985 shiode and shiode 2011 shahbeik et al 2014 but not others e g dirks et al 1998 gong et al 2014 shi et al 2014 2016 2017 the performance of this method depends on whether it is used under correct assumptions and with sufficient data samples in hz related studies kriging has been successfully used to describe the spatial variability of water table elevations desbarats et al 2002 rivest et al 2008 in this study both mathematical interpolation i e surface spline and geostatistical interpolation i e kriging are adopted to map the distributions of the it and id values as a function of the rd and ri the performances of these two methods in estimating the it and id values are evaluated and compared using the taylor diagram taylor 2001 3 results and discussion the performance of the numerical model has been verified through comparing the simulation results of this study with the laboratory results from fehlman 1985 and shen et al 1990 regarding the pressure distribution along the interface between surface water and streambed fig 4 compares the simulation results with the data of shen et al 1990 and shows a generally good match confirming that the model accurately simulates the pressure distribution on the interface of surface water and streambed over the dune as mentioned in section 2 1 the analysis is based on the results extracted from three cross sections in some cases the hz processes can depend on the nature of the dune e g stonedahl et al 2013 however in this study only the magnitudes of the changes in the hz e g the absolute values of the it and id are dune dependent while the trends in variation of these variables are nearly identical in all three cross sections therefore only the results from the middle of the dune are discussed below as a representative case 3 1 spatial extents of hz with designated amount of change using the msw method the spatial extents of the hz accounting for various designated percentages of the concentration change can be detected taking the baseline scenario as the example fig 5 shows the spatial extents of the hz that account for the concentration changes of 50 and 90 as well as the changes of the spatial extents in response to the rainfall event the detected spatial extents are shown together with the rate of change with depth δc δd confirming that the msw method proposed in this study can accurately identify the extent to which the hz undergoes significant spatial change as can be observed the range between the yellow lines in fig 5 effectively captures the entire spatial extent of the hz with significant change as this region accounts for 90 of the concentration change as a function of depth in the hz the concentration change beyond the yellow lines is mostly limited to values less than 1 mol m3 m the spatial extent of the hz with significant change is also detected by the ipt method and the results are compared against those detected by the msw method with the split window width of 90 for four scenarios see fig 6 and table 2 the spatial extents detected by these two methods mostly overlap specifically in the right hand plots of fig 6 the spatial extent detected by the msw method is fully contained within that from the ipt method to quantify the overlap the spatial extent of the hz between the upper and lower bounds in fig 6 is integrated over time for both methods the computed results i e the cumulative spatial extents of the hz are listed in table 2 it is observed that over 80 of the cumulative spatial extent of the hz from either method is included within the overlap which indicates the consistency between the msw and ipt methods the msw method however has the additional advantage that the range of concentration to be detected can be varied e g 50 versus 90 to serve different purposes its results may therefore be more informative and more useful in practical scenarios the spatial extents of the hz that are jointly influenced by surface water and groundwater are those within the upper and lower bounds in fig 6 and account for very significant portions of the hz especially during non rainy periods in response to the rainfall events during the first day the spatial extents of the hz influenced by surface water alone i e the range above the upper bound increase significantly these surface water influenced spatial extents and their changes in response to rainfall are nearly the same under all four selected scenarios however the jointly influenced spatial extents i e the range between the upper and lower bounds differ among the four scenarios defined by different ri and rd 3 2 impacts of ri and rd on hz 3 2 1 relationships of ri with it and id in this study five ri values of 10 20 30 40 and 50 mm h are simulated using the same rd value 6 h and the same groundwater response in phase table 1 this variation in the ri results in changes of the it and id generally the relationships of the ri with both the it the red solid line in fig 7 a and id the blue dash line in fig 7a can be fitted to logarithmic curves with high coefficients of determination but only between certain lower and upper thresholds of the ri when the ri is below the lower threshold 20 mm h in this case or above the upper threshold 50 mm h in this case both the it and id change only minimally as a function of the ri therefore the it and id can be estimated by the following regression equations 3 it 6 4 ri 20 2 65 ln ri 1 17 20 ri 50 r 2 0 96 9 0 ri 50 4 id 0 19 ri 20 0 44 ln ri 1 06 20 ri 50 r 2 0 90 0 60 ri 50 the r 2 values of these equations are both high which indicates that the it and id can be accurately estimated from the ri therefore the derived relationships can be used to predict the impact of the ri on the hz in a future rainfall event as indicated by the logarithmic curves in fig 7a the dependence of the it and id on the ri becomes weaker as the ri becomes larger this indicates that the impact of the ri on the hz decreases at higher ri values when it reaches the upper threshold the additional impact induced by increasing the ri is minimal the existence of a lower threshold however indicates that certain minimum values of the ri are required to exert any change on the hz as reflected by the it and id the upper threshold may be related to the interaction between the groundwater and surface water bhaskar et al 2012 also pointed out a similar lower threshold in the ratio of groundwater to hyporheic flux only if the ratio between groundwater flux and hyporheic flux exceeds 1000 in a gaining stream does the hyporheic flux decrease when the groundwater flux increases if the ratio is below 1000 the hyporheic flux is independent and only changes minimally with the groundwater flux we propose that during a rainfall event the hz first responds to surface water processes and then later to groundwater processes which are intrinsically slower at high ri the hz tends to remain in the state at which the interaction between groundwater and surface water is established in the transient situation therefore the results of this study suggest that in the range between the lower and upper thresholds the it and id are mainly determined by the characteristics of the storm e g the ri however when the ri is above the upper threshold the changes in the hz may be related to both surface water and groundwater responses 3 2 2 relationships of rd with it and id in this study eight rd values of 1 3 4 4 5 5 6 9 and 12 h are simulated using the same ri value 30 mm h and the same groundwater response in phase table 1 again the it and id generally show positive relationships with the rd but only between certain lower and upper thresholds of the rd fig 7b if the rd is shorter than the lower threshold 4 h in this case or longer than the upper threshold 9 h in this case the it and id change only minimally with the rd the it and id can be estimated by the following regression equations 5 it 6 5 rd 4 2 81 ln rd 2 74 4 rd 9 r 2 0 98 9 0 rd 9 6 id 0 19 rd 4 0 42 ln rd 0 32 4 rd 9 r 2 0 86 0 55 rd 9 for rd values between the lower and upper thresholds the relationships of the rd with the it the red solid line in fig 7b and id the blue dash line in fig 7b are also logarithmic the r 2 values of these two equations are generally high especially for eq 5 which indicates that the it and id can be accurately estimated from the rd value using the above equations the lower and upper thresholds of the rd carry practical implications especially for ecological conservation namely that the changes in the hz may be safely ignored if the rd is sufficiently short and may tend to a limiting value if the rd is sufficiently long for any study or restoration project related to the hz the thresholds can be pre determined through numerical simulations then it can be predicted whether a particular rainfall event would influence the hz cardenas and wilson 2007 concluded that the depth of the hz is sensitive to the reynolds number when the groundwater and hyporheic flows are slow which may be related to the change of the id between the two thresholds observed in this study here the id is found to have logarithmic relationships with the ri and rd within certain ranges of those two quantities it therefore changes significantly when the ri and rd and thus the hyporheic flow are relatively small this is in line with the high sensitivity of the hz depth at slow hyporheic flow demonstrated by cardenas and wilson 2007 the present study further provides the logarithmic relationships among those factors which may help to predict and evaluate the it and id in other cases 3 2 3 mapping it and id with ri and rd to further investigate the combined impacts of the ri and rd on the hz the distributions of the it and id as a function of the ri and rd are mapped using both the surface spline and kriging interpolation methods and the results are shown in fig 8 the upper and lower pairs of subplots correspond to the surface spline and kriging interpolation methods respectively generally the distributions of the it and id are similar between the two methods with both presenting increasing trends in response to the increases of the rd and ri furthermore five different storm events indicated by the black stars in fig 8 are randomly selected to evaluate the performances of the two interpolation methods the rd and ri of these five events and also the corresponding it and id derived from model simulation and from the surface spline and kriging interpolation methods are all listed in table 3 through comparing the values estimated by the two interpolation methods against those simulated by the model the relative errors are obtained and are shown in parentheses overall the performances of the two interpolation methods are about the same however the relative errors in it are much smaller than those in id for both methods moreover it is worth noting that the id of the verification points is best estimated for those points located between the lower and upper thresholds of the rd i e 4 h rd 9 h and the ri i e 20 mm h ri 50 mm h which are the latter three verification points in table 3 in addition taylor diagrams taylor 2001 are plotted to further evaluate the performances of the two interpolation methods fig 9 it is clear that kriging outperforms the surface spline interpolation method because the former has higher coefficients of correlation smaller root mean square errors and smaller standard deviations 3 3 impacts of different groundwater responses on the hz in this study five different groundwater responses to the same storm event are considered i e in phase 2 5 10 and 14 h out of phase table 1 as mentioned in section 2 1 3 the total groundwater runoffs are set to be the same under all five modeling scenarios as a consequence of which all of the groundwater curves in fig 10 a have the same area under the curve thus the peak of the groundwater curve becomes smaller as the time lag is prolonged fig 10b shows the changes of the it and id under these five modeling scenarios as can be observed the time lags show very different relationships with the it and with the id the it shows a linear negative correlation with the time lag and the coefficient of determination reaches 0 98 however the overall percentage change of the it is not large in contrast the id does not change with the increase of the time lag mainly because the total groundwater runoffs are the same under all five modeling scenarios 3 4 limitations in this study the surface flow is assumed to remain laminar at all times the justification for this is that the flow is indeed laminar for most of the time according to the reynolds number and becomes turbulent only for very limited periods even under the scenario most influenced by rainfall events compared with both the total rainfall duration and the it of the hz such short periods of turbulence can be ignored for example in the two scenarios that have the largest rainfall intensity or the longest rainfall duration i e ri 60 mm h rd 6 h and ri 30 mm h rd 12 h the periods for which the reynolds number exceeds 4000 i e turbulent flow are 6 5 h and 11 75 h respectively these are much shorter than the it values under the two scenarios which are 214 9 h and 216 0 h respectively however future work may consider turbulent flow to further improve the accuracy of the results in this study the numerical model is built under several assumptions which may not be realistic specifically the streambed is assumed to be homogeneous but in reality the heterogeneity of the streambed would directly alter the flow pattern and residence time for example with the same mean value of the hydraulic conductivities the mean and median residence times are shorter in a heterogeneous than in a homogeneous streambed liu and chui 2017 heterogeneity may therefore also shorten the it in this study the other limitation of this study is the use of a two dimensional model unlike a three dimensional model the two dimensional model ignores the flow outside the simulated vertical profile of the streambed this may therefore result in a larger id than that of a real case moreover the differences in hydraulic head between the surface water and groundwater are not the same in the different profiles of the streambed thus simulating only one profile and regarding it to be representative of the whole streambed may introduce errors furthermore the hz discharge is not selected as an indicator in this study for the following reason the hz discharge under the baseline scenario was calculated and compared with the hz depth it was observed that the response of the hz discharge was more significant i e the percentage change was larger and occurred earlier than that of the hz depth however the hz discharge also returned to its initial state very quickly around 6 h after the rainfall ceased in contrast the change of the hz depth was much longer lasting as this study aims to investigate the impacts of rainfall events on the hz in terms of the change in spatial extent and the time needed for recovery the it and id are selected as the most appropriate indicators nevertheless as the hz discharge can indeed be significantly influenced by a rainfall event it may be considered in future work together with the it and id proposed in this study to evaluate the hz response to a rainfall event 4 conclusion this study investigated the impacts of different rainfall patterns on the hz under transient conditions based on a two dimensional numerical model with a variety of modeling scenarios the major findings can be summarized as follows first the msw method can be used to accurately detect the extent to which the hz undergoes significant spatial changes under different transient conditions in this respect it outperforms the ipt method second two indicators i e the it and id of the hz are proposed to quantify the change of the hz under different rainfall patterns logarithmic relationships are found to link both the ri and rd with both the it and id but only when the ri and rd are between certain lower and upper threshold values the derived relationships can be used to predict the influence of a future rainfall event on the hz third two spatial interpolation methods have been used to predict the different hz characteristics given various ri and rd their predictive performance is satisfactory demonstrating that the spatial interpolation methods and the interpolated results can be used to preliminarily evaluate the characteristics of the hz given different ri and rd values lastly the id and it are discussed in the context of different groundwater responses to the same rainfall event the nature of the groundwater response influences the it but not the id suggesting that given the same total volume of groundwater variations in the temporal pattern would only affect the response rate but not the spatial extent of the hz overall the proposed methods and the conclusions enhance our understanding and will facilitate future studies regarding the transient nature of the hz which could have numerous biogeochemical and ecological implications acknowledgements this study is supported by a grant from the research grants council of the hong kong special administrative region china project no hku17203815 we are also grateful to dr jonathan malzone from department of geosciences eastern kentucky university united states who has advised us on the development of the numerical model 
7297,effective modelling and prediction of smaller time step rainfall is reported to be very difficult owing to its highly erratic nature accurate forecast of daily rainfall for longer duration multi time step may be exceptionally helpful in the efficient planning and management of water resources systems identification of inherent patterns in a rainfall time series is also important for an effective water resources planning and management system in the present study singular spectrum analysis ssa is utilized to forecast the daily rainfall time series pertaining to koyna watershed in maharashtra india for 365 days after extracting various components of the rainfall time series such as trend periodic component noise and cyclic component in order to forecast the time series for longer time step 365 days one window length the signal and noise components of the time series are forecasted separately and then added together the results of the study show that the method of ssa could extract the various components of the time series effectively and could also forecast the daily rainfall time series for longer duration such as one year in a single run with reasonable accuracy keywords singular spectrum analysis non linear trend periodic component cyclic component noise longer duration forecasting 1 introduction effective and accurate time series analysis and modelling remains a challenging task to researchers due to the influence of stochastic and chaotic nature of the time series especially when it is a time series of a natural process such as rainfall accurate forecast of daily rainfall which can help in crop planning agricultural water allocation etc especially in an agricultural based economy like india has been a research interest of hydrologists since a very long time the time series models that are most commonly being used for hydrologic forecasting are stochastic models and artificial intelligence ai based data mining techniques earlier stochastic models have gained wide attention in hydrologic time series modelling however stochastic models such as auto regressive ar moving average ma auto regressive moving average arma and auto regressive integrated moving average arima are computationally extensive sang 2013 momani 2009 developed arima model by including seasonal arima parameters to forecast monthly rainfall data it is reported that the model could not accurately predict the peak values and it is suggested that an intervention time series analysis could be used to forecast peak values of rainfall data when the model is simple and does not involve large amounts of data the stochastic models will work well and if the model is of a polynomial type of high order then the computation becomes complicated wang et al 2014 also stochastic models assume that the time series is stationary and follows normal distribution real time hydrologic time series are mostly non stationary and non linear hence it is very difficult to predict peak values these disadvantages of stochastic models have paved the way for immense utilization of ai based data driven techniques in the field of hydrologic time series analysis artificial intelligence ai based models are popularly used nowadays to predict the future values of a system these models are based on the relationship between input and output variables with only a few assumptions regarding the physical process underlying the system solomatine and ostfeld 2008 most widely used ai based models include artificial neural network ann genetic programing gp fuzzy logic models and model tree mt among which ann has gained an overwhelming response from researchers of various fields ann is having the advantage of availability of a number of algorithms and one can use any combination of different algorithms according to the complexity of the data with less supervision however the major disadvantage of ann modelling is that it is a black box model and outliers in the data can pose adverse effect in the modelling process it is reported by many researchers that data pre processing is essential prior to ann modelling of climatic time series farzad and el shafie 2017 ramírez et al 2006 wu et al 2009 it is also reported that there is a serious lag effect in the prediction of daily rainfall using ai based techniques and peak values are under predicted dawson and wilby 2001 de vos and rientjes 2005 many researchers have used ann to predict single and multi time step ahead rainfall data deo and sahin 2015 unnikrishnan and jothiprakash 2017 it is found that the number of multi time step ahead prediction varies from 3 days to 7 days for daily rainfall prediction after which the ann models perform poorly in case of daily rainfall prediction unnikrishnan and jothiprakash 2017 even though ann models are good in predicting multi time step values they couldn t accurately predict hydrologic variables for very longer duration such as 365 days in single run thus there is a need of a better hydrologic time series model that can predict smaller time step rainfall data for longer duration at a single step with reasonable accuracy a time series model that will work within the internal structure of the time series by analyzing the pattern of the time series and then predicting the time series would be a better prediction model of hydrological time series pattern recognition of a time series becomes more important when there is a need to study the influence of other factors in the time series hence decomposing the time series into a number of interpretable components like trend periodicity cyclic component and irregular fluctuations can help in modelling of the time series in a better way the analysis extraction and prediction of components from a hydrologic time series is difficult with existing conventional algorithms a single algorithm is not available in time series modelling scenario that can analyze and extract all the time series components and to predict those components generally time series analysis is being carried out by using separate methods for studying different components and prediction is being carried out by a separate prediction model if both the time series analysis and forecasting can be carried out by the same time series model it would help in reducing the complexity of time series modelling process ssa decomposes a time series into various small component matrices hence appropriate selection of matrices will reconstruct the various components of the time series accurately hence there is a scope in using ssa to extract various components of hydrological processes ssa is a data adaptive non parametric method of time series modelling which is an extension of principal component analysis pca ssa decomposes a given time series into smaller components based on singular value decomposition svd ssa has proved to be a successful data pre processing algorithm for time series modelling rodrigues and de carvalho 2013 vitanov et al 2008 zhang et al 2011 there is a potential in ssa to extract various components of a time series alexandrov and golyandina 2006 unnikrishnan and jothiprakash 2015 ghil et al 2002 applied ssa to the southern oscillation index for extracting important information and prediction it is reported that ssa helped in extracting important information of the system and in prediction marques et al 2006 applied ssa to hydrological time series and the trend component was extracted from the annual precipitation series trend and periodic component was extracted from monthly runoff series and the whole signal was extracted from the hourly temperature series it reported that ssa can be a powerful method of forecasting and extraction of various components alexandrov 2009 proposed a method of trend extraction using ssa and reported that ssa is a very successful approach for trend extraction as there is no requirement of prior knowledge of either the time series or trend it is also reported that ssa can extract a component like trend periodic component etc individually even in the presence of other components alexandrov 2009 golyandina 2010 studied the various aspects of applying the methods related to ssa in signal processing and reported that in detecting signal in presence of noise using ssa the error in detection will mostly depend on the type of the residual whether deterministic or stochastic and also whether white or red noise rangelova et al 2012 studied the capabilities of ssa to extract periodic signals from the gravity recovery and climate experiment grace gravity field solutions it is reported that ssa can identify modulated oscillations in the presence of noise wang et al 2014 utilized ssa to analyze the precipitation of poyang lake region in order to find periodic and quasi periodic oscillations visual analysis of principal component curve has been utilized the study is reported with presence of quasi 4 5 year 8 11 year and 20 year periodicity the present study has been carried out to develop a hydrologic model that can successfully forecast the daily rainfall time series for longer period such as a year and extract the various components of the rainfall series so that one model can be successfully used to analyze the time series in terms of its pattern and variations and to forecast for longer time period with reasonable accuracy ssa is a data adaptive model that can decompose the time series into smaller components and has proven to be an effective data pre processing technique thus ssa can be used as a single algorithm to extract the various components of the time series and to forecast them for longer period of time as it reduces the dimension of the system by converting the time series into number of small interpretable components the present study utilizes ssa to extract the components of rainfall such as trend periodic component noise and cyclic component and to forecast the daily rainfall time series using ssa from the study it was observed that the proposed method of ssa can be successfully used as a hydrologic model which predicts the daily rainfall for very long duration in one single run with accurate peak rainfall prediction without any lag effect unlike ann models and can extract the various components of rainfall time series the method of ssa coupled with periodogram analysis have been utilized by unnikrishnan and jothiprakash 2015 to extract non linear trend of koyna daily rainfall series from 1961 to 2009 the proposed trend detection method of ssa by unnikrishnan and jothiprakash 2015 have been utilized in the present study to extract the non linear trend component of koyna daily rainfall series from 1961 to 2012 in order to forecast the daily rainfall series for 1 year 1st january 2013 to 31st december 2013 the various signal components such as trend periodic cyclic components are grouped together as signal component and forecasted for 365 days in a single run using ssa the noise component was also forecasted separately for 365 days using ssa and both the signal forecast and noise forecast was added together to get the predicted daily rainfall of koyna catchment for the year 2013 and compared with observed data the data set of 2013 has not been used in any of the above mentioned time series analysis procedures such as extraction of trend periodicity noise and cyclic components 2 singular spectrum analysis ssa ssa is a non parametric method of time series analysis which utilizes svd for decomposing the time series into sum of eigen triples which include eigen function principal component and square root of eigen values ssa has become an efficient time series analysis technique since broomhead and king 1986 developed the method the mathematical explanation of the method can be seen in various literature such as elsner and tsonis 1996 golyandina et al 2001 golyandina and zhigljavsky 2013 the two main stages in ssa are a decomposition and b reconstruction the decomposition has two steps i embedding and ii svd the reconstruction phase of ssa involves two steps i grouping and ii diagonal averaging the time series upon consideration is converted into a trajectory matrix based on the chosen window length l upon which svd is carried out window length is the time step in which data is further divided for extracting the components the end product of svd are eigen triples the number of which is equal to the selected window length thus small component matrices are obtained by decomposing the trajectory matrix the theoretical background of ssa is as follows if x x1 x2 x3 xn be the time series under study let y be the trajectory matrix and can be expressed as 1 y x 1 x 2 x 3 x 2 x 3 x 4 x k x k 1 x k 2 x l x l 1 x n where l window length k lag parameter and can be calculated using the relationship k n l 1 as given in elsner and tsonis 1996 n is the time series length this step of converting the time series into a matrix is called embedding svd is carried on the trajectory matrix thus decomposing it into sum of svd components also called as eigen triples et 2 y i 1 d y i where 3 y i u i χ i v i χ eigen value of yyt u and v are eigen functions and principal components of the matrix yyt i varies from 1 to d where d is number of positive eigen values the eigen functions principal components and eigen values are collectively called as eigen triples et grouping is the first step in the reconstruction phase of ssa upon grouping the useful components are selected from the svd components in order to reconstruct the time series there is no hard and fast rule in the way of grouping based on the properties of the time series to be reconstructed the method of grouping differs thus after grouping the required time series can be reconstructed from m disjoint subsets yi1 yi2 yim diagonal averaging is the second stage in the reconstruction of the time series at this stage each matrix yik from the grouping stage is transformed into a new series of length n let z be an l x k matrix with elements zij 1 i l 1 j k set l min l k k max l k and n l k 1 let zij zij if l k and zij zji otherwise by the diagonal averaging procedure the matrix z is transferred into the series z1 z2 zn using the following formula 4 z k 1 k m 1 k z m k m 1 for 1 k l 1 l m 1 l z m k m 1 for l k k 1 n k 1 m k k 1 n k 1 z m k m 1 for k k n this corresponds to averaging the matrix elements over the anti diagonals i j k 1 the choice k 1 gives y 1 y 1 1 for k 2 y 2 y 1 2 y 2 1 2 and so on golyandina and zhigljavsky 2013 when diagonal averaging is applied to the resultant matrices of grouping y ik a reconstructed series is formed 5 y k y l k y n k therefore initial series x x1 x2 xn is decomposed into a sum of m reconstructed series 6 x k 1 m x n k where n 1 2 n this reconstructed series can be then compared with observed series to find their contribution in the time series 2 1 extraction of non linear trend using ssa trend can be defined as the direction of the process over a longer period of time helsel and hirsch 2002 woodward et al 2012 trend is one of the important internal characteristics of the rainfall time series it helps to understand whether there is increase or decrease in the amount of rainfall over longer period of time statistical tests such as mann kendall test and sens s slope test are currently being used extensively in order to detect the presence of trend in hydrological time series burn and elnur 2002 kahya and kalayci 2004 shi et al 2017a b however all the statistical tests can detect the presence of positive or negative trend at a significance level but cannot explain the small scale changes in trend yue and pilon 2004 ssa can define the small scale variations within trend along with its shape unnikrishnan and jothiprakash 2015 the analysis of median of each of the periodogram based on the criteria stipulated in unnikrishnan and jothiprakash 2015 have been utilized in the present study to extract the non linear trend component the basic mathematical relation used for trend extraction is given below the fourier representation of a time series x x1 x2 xn can be written as 7 x n c 0 1 k n 1 2 c k cos 2 π nk n sin 2 π nk n 1 n c n 2 where k n 0 n n 1 and cn 2 0 if n is an odd number the periodogram of x at the frequencies ω k n can be defined as 8 i x n k n n 2 2 c 0 2 k 0 c k 2 s k 2 0 k n 2 2 c n 2 2 k n 2 for the given ω0 0 0 5 the contribution of low frequencies from the interval 0 ω0 can be defined as 9 c x ω 0 π x n ω 0 π x n 0 5 where π x n ω k 0 k n ω i x n k n ω 0 0 5 can be defined as the cumulative contribution of the frequencies 0 ω then the eigen vectors which satisfy the following condition can be selected for the extraction of trend such that eigen functions corresponding to low frequency fluctuations are selected 10 c uj ω 0 c 0 where c0 and ω0 are two parameters ω0 0 0 5 and c0 0 1 and uj is the corresponding eigen vector 11 ω 0 max k n 0 k n 2 k n i x n 0 i x n k n m x n where x is the time series under consideration of length n and m x n is the median of the values of periodogram of x the optimal value of low frequency contribution c0 can be determined using the following equation 12 c 0 r min c 0 0 1 r x ω 0 c 0 δ c r x ω 0 c 0 δ r 13 where r x ω 0 c 0 c x t ω 0 c 0 ω 0 c x ω 0 1 c is defined in eq 9 t ω0 c0 is the trend component that can be extracted from parameters c0 and ω0 δc is the search step and δr is the threshold the mathematical proof for the equations for determining the parameters are explained in alexandrov 2009 and in unnikrishnan and jothiprakash 2015 the eigen functions of which the periodogram satisfied the criteria of contribution of low frequencies in the periodogram greater than the optimal value of contribution of low frequencies are selected as trend component 2 2 extraction of periodicity component using ssa periodic component seasonal variation is another component of time series which are periodic swings of the variable with respect to the trend component most probably within a year woodward et al 2012 detection of periodic component of natural processes is vitally more important because they can help in understanding the relationships between different processes vlachos et al 2005 yaseen et al 2016 also the presence of periodicity makes it difficult in the efficient modelling of the time series by stochastic modelling techniques zhu et al 2014 the presence of noise in the data makes it extremely difficult to detect periodicity component elfeky et al 2005 ssa is more efficient than fourier analysis in detecting periodic feature in a time series wilks 2011 a periodic or quasi periodic feature in a time series is represented in ssa by pairs of eigen functions and corresponding principal components because of its data adaptive nature ssa can extract periodicities that may be intermittent or non sinusoidal in nature wilks 2011 a periodogram can be used to identify the dominant periods or frequencies of a time series the periodogram gives an estimate of the connective significance of probable frequencies that might elucidate the oscillation pattern of the data but direct application of periodogram method in a noisy time series is less effective in identifying periodicities li 2012 since svd components are also time series that contain specific characteristics of the time series periodogram analysis of each of the eigen functions of the time series can be used as the method of grouping that will select the svd components having periodic features ssa decomposes the vector space of the trajectory matrix of the time series into a signal subspace and a noise subspace if proper grouping is not done the signal subspace can still contain noise in the case of periodicity extraction those svd components containing the periodic feature are to be selected in order to select the svd components containing periodic feature grouping based on analysis of peak of periodogram of eigen functions has been proposed a time series with a strong sinusoidal component will show a recognizable peak in its periodogram at that particular period of the sinusoidal signal if there is a strong non sinusoidal signal in the data its periodogram will show a peak at that particular period along with multiple small peaks nearby thus pair of eigen functions having recognizable single peaks at certain periods is taken as components to be grouped for periodicity extraction 2 3 extraction of noise using ssa noise in the time series are irregular fluctuations in the time series a noise can be white noise or red noise auto correlated noise when the noise present is stationary and is independent of the signal content then the noise is called white noise woodward et al 2012 when the noise in a particular observation is related to the noise in nearby observation it is said to be an auto correlated noise or red noise which is more likely to be present in a natural phenomenon elsner and tsonis 1996 thus a red noise can be called as a noise with memory red noise arises from the interaction of white noise with slow response components of a signal mann and lees 1996 noise is mostly non deterministic in nature and presence of it can distort accurate time series modelling process it is advantageous in time series modelling to know the extent to which the data is noise contaminated if at all a noise is present in the data cellucci et al 1997 it is often difficult to determine the exact level of noise in a data sometimes signal can be misunderstood as a noise and some significant components in the time series can get lost even though a number of noise reduction algorithms have been proposed in literature hammel 1990 schreiber and grassberger 1991 most of them fail to detect noise when noise variances are larger than 2 of signal variances cellucci et al 1997 also most of the noise detection models assumes a predefined form of noise chen et al 2013 however in a real time data it is highly unlikely that the noise is actually of the assumed form it is reported that it is extremely difficult to find even a rough estimation of level of noise present in a signal if the signal is non stationary hu et al 2004 the most important fact in the detection of noise in a time series is to remove the noise without losing a significant portion of the signal this can be accomplished by utilizing ssa to extract noise as the method is data adaptive in nature elsner and tsonis 1996 thus the extraction of noise from a daily rainfall data using ssa is having a wide scope in the field of hydrology in the present study in order to select the components eigen triples corresponding to noise w correlation matrix of the eigen functions has been proposed w correlation matrix between two series is the weighted correlation with appropriate weights consider f 1 and f 2 as two time series with length n l is the window length and k is the factor vector which is equal to n l 1 let l min l k and k max l k weights can be defined as below golyandina et al 2001 14 w i i 1 0 i l 1 l l i k n i k i n 1 the inner product of series f 1 and f 2 of length n as 15 f 1 f 2 w i 0 n 1 w i f i 1 f i 2 where fi 1 and fi 2 are the elements of the series f 1 and f 2 the weighted correlation of the two series can be defined as below 16 ρ 12 w f 1 f 2 w f 1 w f 2 w 17 where f i w f i f i w i 1 2 the w correlation gives the measure of the separation between the two series as w correlation to be equal to zero implies that the two time series are separable golyandina et al 2001 big values of w correlations between reconstructed components say that they belong to one group and correspond to the same component in ssa decomposition the group of highly inter correlated group that are inseparable which implies mixing up of random components in order to validate the results of noise component extraction acf plot box plot and power spectrum of the noise component was made use of in the present study power spectrum is a tool in spectral analysis of a time series in order to measure the frequency content of the time series it can be said as the fourier transform of autocorrelation of a time series let x t be a continuous infinite time series the power spectrum of the time series px f can be defined as below 18 p x f e 2 π ifh γ h dh where γ h is the auto covariance function of the time series stoica and moses 2005 if the time series is measured over a finite interval of time with n values of x the power spectrum px f can be defined as below stoica and moses 2005 19 p x f lim n e 1 n t 1 n y t e 2 π ift 2 by means of power spectrum one can discover fundamental cyclical behaviour that is present in a complex data woodward et al 2012 the examination of underlying periodicities in a time series is called spectral analysis and power spectrum is a tool that can be used to measure the frequency content 2 4 extraction of cyclic component using ssa cyclic component represents the rise and fall of the time series pattern over a longer period of time woodward et al 2012 unlike periodic component it is not necessary that the period of repetition of the cyclic component should be exactly the same cyclic component in a rainfall time series usually occurs over years detection of a cyclic component is extremely difficult due to its non strict regular pattern and need of large scale of data for identification owing to the difficulty in extracting the cyclic component there is a practice among researchers to include cyclic component in the periodic component mhamdi et al 2010 in order to extract the cyclic component present in the koyna daily rainfall time series grouping based on periods of the eigen functions have been used the eigen functions that are having periods as a multiple of 365 1 year have been grouped as a separate group as related to cyclic component 2 5 ssa forecasting procedure in order to forecast a time series it is necessary for the time series to have a pattern structure a forecast can be made only if a model is built the model should be either derived from the data or at least checked against the data in ssa forecasting these models can be described through the linear recurrence relations lrr golyandina and zhigljavsky 2013 linear recurrence means that each term of a sequence is a linear function of earlier terms in the sequence a linear homogenous recurrence relation of degree k with constant coefficients is a recurrence relation of the form 20 a n c 1 a n 1 c 2 a n 2 c k a n k where c1 c2 ck are real numbers and ck 0 an is expressed in terms of the previous k terms of the sequence so its degree is k ssa forecasting is based on the underlying lrr the estimated lrr is applied on the last points of the ssa approximation of the series there are two algorithms described for ssa forecasting recurrent forecasting and vector forecasting both of which are based on the lrr in recurrent forecasting procedure direct use of lrr is performed on the time series obtained after diagonal averaging of the svd components whereas in ssa vector forecasting the trajectory matrix after reconstruction is continued for m forecast steps ssa vector forecasting procedure has been adopted in the current study and has been explained below 2 5 1 vector forecasting v forecasting in this method of forecasting the trajectory matrix after reconstruction is continued for m steps so that the matrix y m y i y k z k 1 z k m is approximately hankel then the forecasted series is obtained by the diagonal averaging of the matrix 21 where z i π y for i 1 k ρ vec z i 1 for i k 1 k m 22 ρ vec y π y r t y 23 π vv t 1 ν 2 rr t 24 vv t p 1 p 2 p r 25 r 1 1 ν 2 i 1 r π i p i 26 ν 2 π 1 2 π r 2 where p 1 pr are the principal components in the selected eigen triples on grouping in ssa πi is the last component of the vector pi y is the vector consisting of last l 1 components of y in the study the forecast step m is taken equal to the window length i e 365 days thus the daily rainfall for next 365 days is predicted based on the previous year s daily rainfall data using ssa vector forecasting algorithm the extracted components such as trend periodicity cyclic component and noise can better explain the hidden pattern and characteristics of the time series ssa forecasting procedure is based on the internal structure of the time series if the components can be forecasted separately and then added together the pattern of the time series can be better preserved in the present study ssa forecasting procedure as explained in the earlier sections has been applied to the signal and noise components and then added together for this purpose all the signal components such as trend periodic and cyclic components have been grouped together and forecasted in addition to the noise component forecast by ssa the forecasted signal and noise components have been added together to get the predicted daily rainfall values 3 study area the study area of the present study is koyna catchment in maharashtra india india lies in the tropical zone and hence the climate is majorly influenced by the monsoons latitude 17 0 n to 17 59 n and longitude 73 02 e to 73 35 e defines the position of koyna watershed with an area of 891 78 km2 central design office 1992 jothiprakash and magar 2012 south west monsoon is the major contributor of rainfall in the area and it accounts for almost 99 of annual rainfall in the koyna watershed jothiprakash and magar 2012 unnikrishnan and jothiprakash 2015 the observed rainfall data of nine rain gauge stations including koyna dam as one rain gauge station in the catchment area for 53 years from 1961 to 2013 were collected from koyna irrigation division office government of maharashtra india the spatially averaged daily rainfall data of the catchment had been estimated using thiessen polygon method from the observed rainfall data of all the nine rain gauge stations it is observed that koyna watershed is monsoon fed with zero rainfall during non monsoon period and non zero rainfall during south west monsoon from june to october correlogram of koyna rainfall series is given in fig 1 there is a repetition in the pattern of correlogram for every 365 lags and indicates the presence of a prevailing periodic component with period of 365 days present in the koyna daily rainfall series 4 results and discussions the above explained method of ssa is applied to the rainfall series of koyna from 1st january 1961 to 31st december 2013 in order to forecast the daily rainfall for one year the extraction of various components have been carried out using ssa for a period of 52 years from 1961 to 2012 and the signal and noise components have been forecasted separately for one year 1st january 2013 to 31st december 2013 using ssa and added together from the correlogram fig 1 of koyna series it is seen that a prevailing periodic component of period 365 days is present in the data window length is the major parameter in ssa and it decides the form of decomposition of the time series and the order of the trajectory matrix upon which svd is done thus appropriate selection of window length is very important in accurate decomposition of the time series if there is a prevailing periodic component with known period present in the time series it is advantageous to select any multiple of that period as window length unnikrishnan and jothiprakash 2015 unnikrishnan and jothiprakash 2015 selected a window length of 365 days for the koyna daily rainfall time series and sensitivity analysis for the window length has also been done and is reported that the appropriate selection of window length is crucial in accurate time series modelling using ssa unnikrishnan and jothiprakash 2016 thus window length of 365 days is used in the present study based on this window length 365 eigen functions principal components and eigen values are obtained as per the svd criterion based on the share of each eigen triple with respect to the others the eigen triples are numbered sequentially from 1 to 365 share of the eigen triple denotes the relative importance of the eigen triple in the original time series share of an eigen triple is the percentage of the ratio of the corresponding eigen value to the sum of all the eigen values of the svd components periodogram for each of the eigen functions have been developed which can reflect the spectral density of the data under consideration 4 1 extraction of trend component in order to extract the trend component periodogram analysis as explained in the section 2 1 has been used the first eigen function alone is only found to be satisfying the criteria of trend component mentioned in eq 10 and has been utilized to reconstruct the non linear trend component the trend component was reconstructed by diagonally averaging the first eigen function the extracted trend component of the koyna daily rainfall series from 1961 to 2012 has been given in fig 2 the figure shows that the trend of the koyna daily rainfall series is very small and thus it can be concluded that there is no major long term shift in the magnitude of rainfall in the catchment over years 4 2 extraction of periodic component in order to extract periodic component peak of periodogram analysis has been used in the study as explained previously in section 2 2 when plotted with period as base periodogram of some eigen functions corresponding to the ssa decomposition of koyna series showed recognizable peaks at certain period values the periodogram of eigen functions from 2 to 7 showed recognizable single peaks whereas the other eigen functions are having either no recognizable peak or multiple peak values in the periodogram the periodogram with period as independent variable of eigen functions from 2 to 7 is shown in fig 3 it is observed that periodograms of these eigen functions are having single peaks at periods 365 182 121 and 90 which is equivalent to 1 year 6 months 4 months and 3 months when considered in terms of daily rainfall data thus the eigen triples from 2 to 7 are taken for reconstructing the periodicity component the eigen triples 2 7 have been taken for periodicity reconstruction and the selected eigen triples are diagonally averaged as explained in eq 4 to get the periodic component the periodicity extracted from observed rainfall data is shown in fig 4 a it is reported that the addition of the extracted trend and periodicity together contributes to most of the non stationary component of a time series sheel et al 1981 the time series after removing the trend and periodicity component should comply with the stationary conditions for a time series to prove the stationarity of the residual time series a pictorial representation of stationarity called correlogram of the observed and residual time series and a statistical test of stationarity called kwiatkowski phillips schmidt shin kpss test have been utilized in the present study correlogram of observed koyna daily rainfall series for a lag of 1000 days has been shown in fig 1 a repeating correlogram indicates a strong periodic component in the time series it is evident from the correlogram of the observed daily rainfall series that it is a non stationary series with a prevailing periodic component of 365 days the correlogram of the periodic component fig 4 b showed that it contains a prevailing periodicity with period 365 days similar to that of the original correlogram of koyna series given in fig 1 correlogram of the residual koyna series after removing non linear trend and periodicity is given in fig 4 c the difference between the three correlogram can be clearly noticed the correlogram of the residual time series fig 4 c dies out rapidly which is an indication of stationary series in the correlogram of residual series no periodicity is shown and also it dies out to zero rapidly which indicate that the periodicity component has been successfully removed and the residual series represents a stationary time series kpss test kwiatkowski et al 1992 is a statistical test for checking whether time series is stationary or not it checks for the null hypothesis that a time series is stationary against an alternative of a unit root in the time series the detailed mathematical description of the test can be seen in kwiatkowski et al 1992 at 5 significant level the results of kpss test showed that the observed rainfall series with a test statistic of 0 2009 critical value is non stationary rejects the null hypothesis of stationary and accepts the alternative of presence of a unit root in the time series whereas the residual series after removing the trend and periodic component with a test statistic of 0 0017 critical value proves to be stationary accepts the null hypothesis where the critical value for 5 significance level is 0 149 thus kpss test confirms that the removal of extracted trend and periodicity components could transform the time series into a stationary time series both the tests of stationarity acf representation and statistical test confirms the extracted trend and periodic components to be responsible for the non stationarity of the observed time series as trend and periodicity components are the major non stationary components of a time series it implies that the extracted components correspond to trend and periodicity of the time series 4 3 extraction of noise in order to extract noise component w correlation matrix analysis has been used as explained in the section 2 3 the w correlation matrix of the eigen functions corresponding to the ssa decomposition of the koyna rainfall series is given in fig 5 in the figure w correlation has been shown as colour variation which is given in the colour index black red yellow and white and its variations have been taken to differentiate between different correlation values white represents a w correlation of one and black represents a w correlation of zero magnitude yellow represents a high value of w correlation in the range of 0 7 1 and red represents medium range of w correlation in the range of 0 3 0 6 the fig 5 shows that there is a random correlation among the 70 365 eigen functions indicated by the increase in the spread of the presence of mixture of red and yellow colours from the 70 to 365 eigen functions thus 1 to 69 eigen functions are having a non zero w correlation only to themselves and between the very nearby eigen functions however in the case of eigen functions from 70 to 365 there is a high random correlation between the eigen functions thus the fig 5 shows that the first 69 eigen functions are having correlation only within themselves and the nearby components but after that there is group of highly inter correlated group that are inseparable which implies mixing up of random components these randomly inter correlated group of eigen functions from 70 to 365 can be grouped as noise the noise component has been reconstructed using these eigen functions and is given in fig 6 a in order to validate the results basic statistics correlogram and power spectrum of the extracted time series has been utilized the basic statistics mentioned above include mean and variance of the noise by theory the mean of a noise should be near to zero and should have a constant variance priestly 1981 the box plot of the extracted noise is given in fig 6 b the plot shows that mean of the noise is zero which is the very basic essential condition for noise the box plot also shows that variation of the noise component is constant the variance of noise component extracted is estimated to be 16 of the signal variance thus the proposed method of ssa coupled with w correlation matrix can be adopted for noise detection even if the noise variance is more than 2 of the signal variance the acf of a white noise will typically be close to but not equal to zero acf for a white noise drops rapidly with increasing lag and for a red noise acf drops gradually to near zero values elsner and tsonis 1996 priestly 1981 earlier studies have much debated on does the weather parameters will exhibit the presence of red noise or auto correlated noise the acf plot of the extracted noise component has been given in fig 6 c and it shows a drop in acf to zero for increasing lag which is a property of noise comparing the acf of the koyna rainfall series fig 1 and that of noise fig 6 c it is found that there is a significant difference between these two plots where the acf of observed rainfall shows periodic property the acf of noise doesn t show any property of signal the acf plot of the residual series after removing the extracted noise from the observed series is given in fig 6 d on comparing the acf plots of the observed fig 1 and residual series fig 6 d it can be noticed that extraction of noise hasn t affected the signal component of the time series the observed koyna rainfall series is proved to be a non stationary series with the presence of trend and periodic component and by the kpss test results carried out on the koyna observed rainfall series unnikrishnan and jothiprakash 2015 thus the proposed method of ssa can be utilized to extract noise from a non stationary time series which is reported as extremely difficult in literature hu et al 2004 the white noise has a flat spectrum priestly 1981 that s why the name same response to all frequency as white light but a non flat spectrum will not imply that it is not noise because red noise will have a biased power spectrum toward low frequencies which is most likely present in a climatic time series chen et al 2013 the power spectrum of the extracted noise is given in fig 6 e it shows high powers at lower frequency and then dropping to near zero which is a property of red noise this shows that the noise extracted from koyna daily rainfall series is red noise 4 4 extraction of cyclic component in order to extract the cyclic component grouping based on periods of eigen functions as explained in section 2 4 has been used the eigen triples having periods as multiple of 365 days has been selected to reconstruct cyclic component the selected components were diagonally averaged to get the cyclic component the extracted cyclic component is given in fig 7 a the figure shows that there is a cyclic component with a cycle of nearly 11 12 years in order to understand better about the cyclic pattern shown in the cyclic component a plot of the range of the cyclic component in each year has been shown in fig 7 b this range of cyclic component has been estimated as the difference of the maximum and minimum values in the cyclic component each year the fig 7 b shows that there is a cyclic pattern in the component with a cycle of approximately 10 12 years it can be seen that there are some local troughs in the fig 7 b in order to differentiate the local troughs with the global troughs moving average of the range of the cyclic component has been taken and plotted against each year the moving average with various lags such as 2 3 and 4 years has been taken and are plotted against year in fig 7 c d e it can be noticed that the effect of the local troughs and variations are eliminated by taking moving average and cyclic pattern is clearly noticeable there is a half cycle of 6 years from 1962 to 1968 complete cycles of 12 years 1969 1981 and 10 years 2003 2013 and one combined cycle of 20 22 years are noticed 1982 2002 these observed cycles can be averaged to an 11 year cycle which can be linked to the sunspot cycle of 11 years which is found to be affecting the indian monsoon rainfall by researchers ananthakrishnan and parthasarathy 1984 loon and meehl 2012 the relationship between the sunspot cycle and the monsoon rainfall need to be further explored on the basis of more data points that can explore the variation of cycles of rainfall appropriately it is also reported that the major climate change happened approximately by the year 1980 81 and this regime shift represented a major shift in the earth s biophysical systems from atmosphere to lithosphere ipcc 2001 1996 reid et al 2016 it can be observed that before 1981 there was a 12 year rainfall cycle one half cycle and one complete cycle can be seen after 1980 81 the cycle was reduced to a period of 11 10 years this change of cycle may be due to the global shift in the climatic regime the relationship between the observed cycle of rainfall sunspot cycle and global climatic change need to be studied further based on a larger set of daily rainfall data in this region thus ssa method is very much useful to understand the natural cycles and components in a time series and could be further explored much to relate to the natural behavior of planetary positions and movement this may lead to better understanding of the nature of rainfall over a longer period of time 4 5 forecasting the daily rainfall using ssa the daily rainfall of one complete year has been forecasted using ssa based on the previous years rainfall data i e the daily rainfall of the year 2013 has been forecasted using the rainfall values from 1961 to 2012 in a single time step the two ssa forecasting algorithms such as recurrent forecast and vector forecast have been tried to predict the koyna daily rainfall series for one year and it is found that the vector forecasting procedure is more effective and reliable as far as longer time step prediction is concerned various combinations of the components have also been tried in forecasting the time series finally a combination of all signal components with noise component forecasted separately using vector forecasting algorithm emerged out as the best model both the signal and noise forecast were added together to get the one year prediction of koyna daily rainfall series for the year 2013 it is to be mentioned here that these values are predicted based on the components extracted using the data from the year 1961 to 2012 since the observed rainfall in the year 2013 is known the various components for the year 2013 was also extracted using ssa the sum of all extracted signal components such as trend periodic and cyclic components for the year 2013 were estimated and presented in fig 8 a along with the predicted signal components to check the efficiency of ssa in predicting the signal components the scatter plot of predicted and actual signal components of koyna daily rainfall of 2013 is also given in fig 8 b the fig 8 a and b shows that the proposed method of ssa has predicted the signal components with good accuracy the predicted and actual extracted signal components are well correlated with an r2 value of 0 84 which is remarkable for a one year prediction of daily rainfall data in a single run the predicted and extracted noise component of koyna daily rainfall from 1st january 2013 to 31st december 2013 has been given in fig 8 c the scatter plot of the predicted and extracted noise component is given in fig 8 d it is observed that ssa could predict the noise component with reasonable accuracy with an r2 value of 0 62 but the initial and final values of the noise are not predicted well this may be due to the chaotic behavior of the noise it is to be noticed that the performance of ssa in prediction of noise component is behind the performance in prediction of signal components the random nature of noise component may be the reason for the comparatively lower performance in prediction of noise component however prediction of noise can also be considered as with reliable accuracy as the forecast horizon is of very long duration one year the predicted signal as well as noise components for the year 2013 have been added together to get the predicted daily rainfall of koyna watershed for the year 2013 the time series plot of predicted and observed rainfall in koyna watershed for the year 2013 has been given in fig 8 e the scatter plot of the predicted and observed koyna daily rainfall given in fig 8 f shows that there is good correlation between observed and predicted rainfall especially for a daily rainfall for such a longer time step prediction as one year the performance measures of the ssa model in predicting the daily rainfall for the year 2013 have been shown in table 1 the details of the statistical performance measures adopted in the study has been given in appendix a the performance measures also indicate a good performance by the model for one year ahead daily rainfall prediction the r2 value and efficiency e are in good agreement with a value of 0 78 and 0 74 indicating that there is good correlation between predicted and observed rainfall the errors such as root mean squared error rmse mean absolute error mae mean negative error mne and mean positive error mpe are also less when a one year daily rainfall prediction model is considered in order to reassure the reliability of the model in predicting daily rainfall for one year the daily rainfall of the year 2012 was also forecasted using the model by making use of the daily rainfall data from 1961 to 2011 the same methodology as explained for 2013 year forecast was used to forecast the daily rainfall of koyna catchment for the year 2012 the various components of the rainfall for the time period of 1961 to 2011 was extracted and the signal and noise components were forecasted separately for one year using vector forecasting algorithm the observed and predicted rainfall for the year 2012 is given in fig 9 it can be observed from the figure that the model could predict the daily rainfall accurately the various performance measures of the model in predicting daily rainfall for the year 2012 has been given in table 1 all the performance measures of the model show a good performance of the model in predicting the daily rainfall of the year 2012 with very high r2 value of 0 8 and very low values of errors such as rmse mae mpe and mne it can also be observed that the error in peak rainfall value prediction is also very less with a mp value of 12 87 it can be noticed that the ssa model predicted both the 2012 and 2013 year daily rainfall with reasonable accuracy it can be now concluded that the major advantages of utilizing ssa in daily rainfall prediction over conventional models such as stochastic and ann models are i longer duration forecast can be successfully carried out in a single run ii peak rainfall values can be predicted with reasonable accuracy iii no lag effect in prediction unlike ann models iv all the components can be successfully extracted in order to compare the results of the present methodology with other methods methods that forecast for same forecast horizon of one year is required however in literature no studies have been found that reported to forecast daily rainfall for such a longer duration however a comparison has been carried out with the study of unnikrishnan and jothiprakash 2017 in which the same daily rainfall data have been forecasted for seven days using ann and ssa ann it is observed that the performance of ann and ssa ann models retards when the time step of prediction increases from one to seven day thus the proposed method of ssa to predict daily rainfall for one year performs better than ann and ssa ann that predicts seven day ahead rainfall it can be concluded that the extraction of various components and utilization of those components for prediction by ssa has enhanced the forecasting capability of ssa model the results also indicate that the noise component also has a particular degree of influence in the accuracy of forecast of the time series thus noise also have some pattern of the time series which is a property of red noise 5 conclusions forecasting daily rainfall time series for longer time duration at a single step along with extraction of significant rainfall components using ssa is the primary aim of this study the components such as nonlinear trend periodic component noise and cyclic component was extracted from the daily rainfall series using ssa it was noticed that the noise component extracted was having 16 of signal variance thus the proposed method of ssa can extract noise even if the noise variance is more than 2 of the signal variance which was reported to be difficult by previous researchers it has also been noticed that there is a cyclic component with a cycle of 11 years in the rainfall time series this 11 year cycle in the rainfall can be linked to the 11 year sunspot cycle and some researchers have reported a relation between indian monsoon and sunspot cycle the observed change of rainfall cycle from 12 years to 11 10 year may be due to the global shift in the climatic regime thus ssa method is very much useful to understand the natural cycles and components in a time series and could be further explored much to relate to the natural behavior of planetary positions and movement the forecasting of the daily rainfall has been carried out for 365 days 1 year in a single step of forecasting using ssa vector forecasting in order to forecast the rainfall time series the signal and noise components were forecasted separately for a prediction time step of 365 days for the years 2013 and 2012 thereafter the predictions of signal and noise components were added together to get the predicted rainfall for the year 2013 and 2012 the results showed that the ssa model could forecast the rainfall with reasonable accuracy for a longer duration daily rainfall forecast such as one year it can be now concluded that by utilizing ssa in daily rainfall prediction i longer duration forecast can be successfully carried out in a single run ii peak rainfall values can be predicted with reasonable accuracy iii there is no lag effect in prediction unlike ann models iv all the rainfall components can be successfully extracted prior to prediction acknowledgments the authors greatly acknowledge the koyna dam authorities executive engineer of koyna dam for providing necessary data for this research we also acknowledge the editor associate editor and unanimous reviewers whose comments and suggestions helped us to improve the readability of the manuscript appendix a model performance measure performance criteria equation mean absolute error mae mae 1 n t 1 n f t y t ramirez et al 2005 mean positive error mpe mpe 1 x i 1 x f t y t i where i 1 2 x for all positive ft yt unnikrishnan and jothiprakash 2017 mean negative error mne mne 1 y i 1 y f t y t i where i 1 2 y for all negative ft yt unnikrishnan and jothiprakash 2017 root mean squared error rmse rmse 1 n t 1 n f t y t 2 ramirez et al 2005 wang et al 2009 the coefficient of determination r2 r2 r 2 n i 1 n y t f t t 1 n y t t 1 n f t n t 1 n y t 2 t 1 n y t 2 n t 1 n f t 2 t 1 n f t 2 wang et al 2009 nash sutcliffe efficiency coefficient e e 1 t 1 n y t f t 2 t 1 n y t y 2 nash and sutcliffe 1970 percentage mean error in predicting peak rainfall mp mp f t max y t max f t max 100 jothiprakash and magar 2012 where yt and ft are observed and forecasted rainfall values respectively during the time period t n is the total number of rainfall observations y is the arithmetic mean of observed values ft max and yt max are maximum values of forecasted and observed values respectively 
7297,effective modelling and prediction of smaller time step rainfall is reported to be very difficult owing to its highly erratic nature accurate forecast of daily rainfall for longer duration multi time step may be exceptionally helpful in the efficient planning and management of water resources systems identification of inherent patterns in a rainfall time series is also important for an effective water resources planning and management system in the present study singular spectrum analysis ssa is utilized to forecast the daily rainfall time series pertaining to koyna watershed in maharashtra india for 365 days after extracting various components of the rainfall time series such as trend periodic component noise and cyclic component in order to forecast the time series for longer time step 365 days one window length the signal and noise components of the time series are forecasted separately and then added together the results of the study show that the method of ssa could extract the various components of the time series effectively and could also forecast the daily rainfall time series for longer duration such as one year in a single run with reasonable accuracy keywords singular spectrum analysis non linear trend periodic component cyclic component noise longer duration forecasting 1 introduction effective and accurate time series analysis and modelling remains a challenging task to researchers due to the influence of stochastic and chaotic nature of the time series especially when it is a time series of a natural process such as rainfall accurate forecast of daily rainfall which can help in crop planning agricultural water allocation etc especially in an agricultural based economy like india has been a research interest of hydrologists since a very long time the time series models that are most commonly being used for hydrologic forecasting are stochastic models and artificial intelligence ai based data mining techniques earlier stochastic models have gained wide attention in hydrologic time series modelling however stochastic models such as auto regressive ar moving average ma auto regressive moving average arma and auto regressive integrated moving average arima are computationally extensive sang 2013 momani 2009 developed arima model by including seasonal arima parameters to forecast monthly rainfall data it is reported that the model could not accurately predict the peak values and it is suggested that an intervention time series analysis could be used to forecast peak values of rainfall data when the model is simple and does not involve large amounts of data the stochastic models will work well and if the model is of a polynomial type of high order then the computation becomes complicated wang et al 2014 also stochastic models assume that the time series is stationary and follows normal distribution real time hydrologic time series are mostly non stationary and non linear hence it is very difficult to predict peak values these disadvantages of stochastic models have paved the way for immense utilization of ai based data driven techniques in the field of hydrologic time series analysis artificial intelligence ai based models are popularly used nowadays to predict the future values of a system these models are based on the relationship between input and output variables with only a few assumptions regarding the physical process underlying the system solomatine and ostfeld 2008 most widely used ai based models include artificial neural network ann genetic programing gp fuzzy logic models and model tree mt among which ann has gained an overwhelming response from researchers of various fields ann is having the advantage of availability of a number of algorithms and one can use any combination of different algorithms according to the complexity of the data with less supervision however the major disadvantage of ann modelling is that it is a black box model and outliers in the data can pose adverse effect in the modelling process it is reported by many researchers that data pre processing is essential prior to ann modelling of climatic time series farzad and el shafie 2017 ramírez et al 2006 wu et al 2009 it is also reported that there is a serious lag effect in the prediction of daily rainfall using ai based techniques and peak values are under predicted dawson and wilby 2001 de vos and rientjes 2005 many researchers have used ann to predict single and multi time step ahead rainfall data deo and sahin 2015 unnikrishnan and jothiprakash 2017 it is found that the number of multi time step ahead prediction varies from 3 days to 7 days for daily rainfall prediction after which the ann models perform poorly in case of daily rainfall prediction unnikrishnan and jothiprakash 2017 even though ann models are good in predicting multi time step values they couldn t accurately predict hydrologic variables for very longer duration such as 365 days in single run thus there is a need of a better hydrologic time series model that can predict smaller time step rainfall data for longer duration at a single step with reasonable accuracy a time series model that will work within the internal structure of the time series by analyzing the pattern of the time series and then predicting the time series would be a better prediction model of hydrological time series pattern recognition of a time series becomes more important when there is a need to study the influence of other factors in the time series hence decomposing the time series into a number of interpretable components like trend periodicity cyclic component and irregular fluctuations can help in modelling of the time series in a better way the analysis extraction and prediction of components from a hydrologic time series is difficult with existing conventional algorithms a single algorithm is not available in time series modelling scenario that can analyze and extract all the time series components and to predict those components generally time series analysis is being carried out by using separate methods for studying different components and prediction is being carried out by a separate prediction model if both the time series analysis and forecasting can be carried out by the same time series model it would help in reducing the complexity of time series modelling process ssa decomposes a time series into various small component matrices hence appropriate selection of matrices will reconstruct the various components of the time series accurately hence there is a scope in using ssa to extract various components of hydrological processes ssa is a data adaptive non parametric method of time series modelling which is an extension of principal component analysis pca ssa decomposes a given time series into smaller components based on singular value decomposition svd ssa has proved to be a successful data pre processing algorithm for time series modelling rodrigues and de carvalho 2013 vitanov et al 2008 zhang et al 2011 there is a potential in ssa to extract various components of a time series alexandrov and golyandina 2006 unnikrishnan and jothiprakash 2015 ghil et al 2002 applied ssa to the southern oscillation index for extracting important information and prediction it is reported that ssa helped in extracting important information of the system and in prediction marques et al 2006 applied ssa to hydrological time series and the trend component was extracted from the annual precipitation series trend and periodic component was extracted from monthly runoff series and the whole signal was extracted from the hourly temperature series it reported that ssa can be a powerful method of forecasting and extraction of various components alexandrov 2009 proposed a method of trend extraction using ssa and reported that ssa is a very successful approach for trend extraction as there is no requirement of prior knowledge of either the time series or trend it is also reported that ssa can extract a component like trend periodic component etc individually even in the presence of other components alexandrov 2009 golyandina 2010 studied the various aspects of applying the methods related to ssa in signal processing and reported that in detecting signal in presence of noise using ssa the error in detection will mostly depend on the type of the residual whether deterministic or stochastic and also whether white or red noise rangelova et al 2012 studied the capabilities of ssa to extract periodic signals from the gravity recovery and climate experiment grace gravity field solutions it is reported that ssa can identify modulated oscillations in the presence of noise wang et al 2014 utilized ssa to analyze the precipitation of poyang lake region in order to find periodic and quasi periodic oscillations visual analysis of principal component curve has been utilized the study is reported with presence of quasi 4 5 year 8 11 year and 20 year periodicity the present study has been carried out to develop a hydrologic model that can successfully forecast the daily rainfall time series for longer period such as a year and extract the various components of the rainfall series so that one model can be successfully used to analyze the time series in terms of its pattern and variations and to forecast for longer time period with reasonable accuracy ssa is a data adaptive model that can decompose the time series into smaller components and has proven to be an effective data pre processing technique thus ssa can be used as a single algorithm to extract the various components of the time series and to forecast them for longer period of time as it reduces the dimension of the system by converting the time series into number of small interpretable components the present study utilizes ssa to extract the components of rainfall such as trend periodic component noise and cyclic component and to forecast the daily rainfall time series using ssa from the study it was observed that the proposed method of ssa can be successfully used as a hydrologic model which predicts the daily rainfall for very long duration in one single run with accurate peak rainfall prediction without any lag effect unlike ann models and can extract the various components of rainfall time series the method of ssa coupled with periodogram analysis have been utilized by unnikrishnan and jothiprakash 2015 to extract non linear trend of koyna daily rainfall series from 1961 to 2009 the proposed trend detection method of ssa by unnikrishnan and jothiprakash 2015 have been utilized in the present study to extract the non linear trend component of koyna daily rainfall series from 1961 to 2012 in order to forecast the daily rainfall series for 1 year 1st january 2013 to 31st december 2013 the various signal components such as trend periodic cyclic components are grouped together as signal component and forecasted for 365 days in a single run using ssa the noise component was also forecasted separately for 365 days using ssa and both the signal forecast and noise forecast was added together to get the predicted daily rainfall of koyna catchment for the year 2013 and compared with observed data the data set of 2013 has not been used in any of the above mentioned time series analysis procedures such as extraction of trend periodicity noise and cyclic components 2 singular spectrum analysis ssa ssa is a non parametric method of time series analysis which utilizes svd for decomposing the time series into sum of eigen triples which include eigen function principal component and square root of eigen values ssa has become an efficient time series analysis technique since broomhead and king 1986 developed the method the mathematical explanation of the method can be seen in various literature such as elsner and tsonis 1996 golyandina et al 2001 golyandina and zhigljavsky 2013 the two main stages in ssa are a decomposition and b reconstruction the decomposition has two steps i embedding and ii svd the reconstruction phase of ssa involves two steps i grouping and ii diagonal averaging the time series upon consideration is converted into a trajectory matrix based on the chosen window length l upon which svd is carried out window length is the time step in which data is further divided for extracting the components the end product of svd are eigen triples the number of which is equal to the selected window length thus small component matrices are obtained by decomposing the trajectory matrix the theoretical background of ssa is as follows if x x1 x2 x3 xn be the time series under study let y be the trajectory matrix and can be expressed as 1 y x 1 x 2 x 3 x 2 x 3 x 4 x k x k 1 x k 2 x l x l 1 x n where l window length k lag parameter and can be calculated using the relationship k n l 1 as given in elsner and tsonis 1996 n is the time series length this step of converting the time series into a matrix is called embedding svd is carried on the trajectory matrix thus decomposing it into sum of svd components also called as eigen triples et 2 y i 1 d y i where 3 y i u i χ i v i χ eigen value of yyt u and v are eigen functions and principal components of the matrix yyt i varies from 1 to d where d is number of positive eigen values the eigen functions principal components and eigen values are collectively called as eigen triples et grouping is the first step in the reconstruction phase of ssa upon grouping the useful components are selected from the svd components in order to reconstruct the time series there is no hard and fast rule in the way of grouping based on the properties of the time series to be reconstructed the method of grouping differs thus after grouping the required time series can be reconstructed from m disjoint subsets yi1 yi2 yim diagonal averaging is the second stage in the reconstruction of the time series at this stage each matrix yik from the grouping stage is transformed into a new series of length n let z be an l x k matrix with elements zij 1 i l 1 j k set l min l k k max l k and n l k 1 let zij zij if l k and zij zji otherwise by the diagonal averaging procedure the matrix z is transferred into the series z1 z2 zn using the following formula 4 z k 1 k m 1 k z m k m 1 for 1 k l 1 l m 1 l z m k m 1 for l k k 1 n k 1 m k k 1 n k 1 z m k m 1 for k k n this corresponds to averaging the matrix elements over the anti diagonals i j k 1 the choice k 1 gives y 1 y 1 1 for k 2 y 2 y 1 2 y 2 1 2 and so on golyandina and zhigljavsky 2013 when diagonal averaging is applied to the resultant matrices of grouping y ik a reconstructed series is formed 5 y k y l k y n k therefore initial series x x1 x2 xn is decomposed into a sum of m reconstructed series 6 x k 1 m x n k where n 1 2 n this reconstructed series can be then compared with observed series to find their contribution in the time series 2 1 extraction of non linear trend using ssa trend can be defined as the direction of the process over a longer period of time helsel and hirsch 2002 woodward et al 2012 trend is one of the important internal characteristics of the rainfall time series it helps to understand whether there is increase or decrease in the amount of rainfall over longer period of time statistical tests such as mann kendall test and sens s slope test are currently being used extensively in order to detect the presence of trend in hydrological time series burn and elnur 2002 kahya and kalayci 2004 shi et al 2017a b however all the statistical tests can detect the presence of positive or negative trend at a significance level but cannot explain the small scale changes in trend yue and pilon 2004 ssa can define the small scale variations within trend along with its shape unnikrishnan and jothiprakash 2015 the analysis of median of each of the periodogram based on the criteria stipulated in unnikrishnan and jothiprakash 2015 have been utilized in the present study to extract the non linear trend component the basic mathematical relation used for trend extraction is given below the fourier representation of a time series x x1 x2 xn can be written as 7 x n c 0 1 k n 1 2 c k cos 2 π nk n sin 2 π nk n 1 n c n 2 where k n 0 n n 1 and cn 2 0 if n is an odd number the periodogram of x at the frequencies ω k n can be defined as 8 i x n k n n 2 2 c 0 2 k 0 c k 2 s k 2 0 k n 2 2 c n 2 2 k n 2 for the given ω0 0 0 5 the contribution of low frequencies from the interval 0 ω0 can be defined as 9 c x ω 0 π x n ω 0 π x n 0 5 where π x n ω k 0 k n ω i x n k n ω 0 0 5 can be defined as the cumulative contribution of the frequencies 0 ω then the eigen vectors which satisfy the following condition can be selected for the extraction of trend such that eigen functions corresponding to low frequency fluctuations are selected 10 c uj ω 0 c 0 where c0 and ω0 are two parameters ω0 0 0 5 and c0 0 1 and uj is the corresponding eigen vector 11 ω 0 max k n 0 k n 2 k n i x n 0 i x n k n m x n where x is the time series under consideration of length n and m x n is the median of the values of periodogram of x the optimal value of low frequency contribution c0 can be determined using the following equation 12 c 0 r min c 0 0 1 r x ω 0 c 0 δ c r x ω 0 c 0 δ r 13 where r x ω 0 c 0 c x t ω 0 c 0 ω 0 c x ω 0 1 c is defined in eq 9 t ω0 c0 is the trend component that can be extracted from parameters c0 and ω0 δc is the search step and δr is the threshold the mathematical proof for the equations for determining the parameters are explained in alexandrov 2009 and in unnikrishnan and jothiprakash 2015 the eigen functions of which the periodogram satisfied the criteria of contribution of low frequencies in the periodogram greater than the optimal value of contribution of low frequencies are selected as trend component 2 2 extraction of periodicity component using ssa periodic component seasonal variation is another component of time series which are periodic swings of the variable with respect to the trend component most probably within a year woodward et al 2012 detection of periodic component of natural processes is vitally more important because they can help in understanding the relationships between different processes vlachos et al 2005 yaseen et al 2016 also the presence of periodicity makes it difficult in the efficient modelling of the time series by stochastic modelling techniques zhu et al 2014 the presence of noise in the data makes it extremely difficult to detect periodicity component elfeky et al 2005 ssa is more efficient than fourier analysis in detecting periodic feature in a time series wilks 2011 a periodic or quasi periodic feature in a time series is represented in ssa by pairs of eigen functions and corresponding principal components because of its data adaptive nature ssa can extract periodicities that may be intermittent or non sinusoidal in nature wilks 2011 a periodogram can be used to identify the dominant periods or frequencies of a time series the periodogram gives an estimate of the connective significance of probable frequencies that might elucidate the oscillation pattern of the data but direct application of periodogram method in a noisy time series is less effective in identifying periodicities li 2012 since svd components are also time series that contain specific characteristics of the time series periodogram analysis of each of the eigen functions of the time series can be used as the method of grouping that will select the svd components having periodic features ssa decomposes the vector space of the trajectory matrix of the time series into a signal subspace and a noise subspace if proper grouping is not done the signal subspace can still contain noise in the case of periodicity extraction those svd components containing the periodic feature are to be selected in order to select the svd components containing periodic feature grouping based on analysis of peak of periodogram of eigen functions has been proposed a time series with a strong sinusoidal component will show a recognizable peak in its periodogram at that particular period of the sinusoidal signal if there is a strong non sinusoidal signal in the data its periodogram will show a peak at that particular period along with multiple small peaks nearby thus pair of eigen functions having recognizable single peaks at certain periods is taken as components to be grouped for periodicity extraction 2 3 extraction of noise using ssa noise in the time series are irregular fluctuations in the time series a noise can be white noise or red noise auto correlated noise when the noise present is stationary and is independent of the signal content then the noise is called white noise woodward et al 2012 when the noise in a particular observation is related to the noise in nearby observation it is said to be an auto correlated noise or red noise which is more likely to be present in a natural phenomenon elsner and tsonis 1996 thus a red noise can be called as a noise with memory red noise arises from the interaction of white noise with slow response components of a signal mann and lees 1996 noise is mostly non deterministic in nature and presence of it can distort accurate time series modelling process it is advantageous in time series modelling to know the extent to which the data is noise contaminated if at all a noise is present in the data cellucci et al 1997 it is often difficult to determine the exact level of noise in a data sometimes signal can be misunderstood as a noise and some significant components in the time series can get lost even though a number of noise reduction algorithms have been proposed in literature hammel 1990 schreiber and grassberger 1991 most of them fail to detect noise when noise variances are larger than 2 of signal variances cellucci et al 1997 also most of the noise detection models assumes a predefined form of noise chen et al 2013 however in a real time data it is highly unlikely that the noise is actually of the assumed form it is reported that it is extremely difficult to find even a rough estimation of level of noise present in a signal if the signal is non stationary hu et al 2004 the most important fact in the detection of noise in a time series is to remove the noise without losing a significant portion of the signal this can be accomplished by utilizing ssa to extract noise as the method is data adaptive in nature elsner and tsonis 1996 thus the extraction of noise from a daily rainfall data using ssa is having a wide scope in the field of hydrology in the present study in order to select the components eigen triples corresponding to noise w correlation matrix of the eigen functions has been proposed w correlation matrix between two series is the weighted correlation with appropriate weights consider f 1 and f 2 as two time series with length n l is the window length and k is the factor vector which is equal to n l 1 let l min l k and k max l k weights can be defined as below golyandina et al 2001 14 w i i 1 0 i l 1 l l i k n i k i n 1 the inner product of series f 1 and f 2 of length n as 15 f 1 f 2 w i 0 n 1 w i f i 1 f i 2 where fi 1 and fi 2 are the elements of the series f 1 and f 2 the weighted correlation of the two series can be defined as below 16 ρ 12 w f 1 f 2 w f 1 w f 2 w 17 where f i w f i f i w i 1 2 the w correlation gives the measure of the separation between the two series as w correlation to be equal to zero implies that the two time series are separable golyandina et al 2001 big values of w correlations between reconstructed components say that they belong to one group and correspond to the same component in ssa decomposition the group of highly inter correlated group that are inseparable which implies mixing up of random components in order to validate the results of noise component extraction acf plot box plot and power spectrum of the noise component was made use of in the present study power spectrum is a tool in spectral analysis of a time series in order to measure the frequency content of the time series it can be said as the fourier transform of autocorrelation of a time series let x t be a continuous infinite time series the power spectrum of the time series px f can be defined as below 18 p x f e 2 π ifh γ h dh where γ h is the auto covariance function of the time series stoica and moses 2005 if the time series is measured over a finite interval of time with n values of x the power spectrum px f can be defined as below stoica and moses 2005 19 p x f lim n e 1 n t 1 n y t e 2 π ift 2 by means of power spectrum one can discover fundamental cyclical behaviour that is present in a complex data woodward et al 2012 the examination of underlying periodicities in a time series is called spectral analysis and power spectrum is a tool that can be used to measure the frequency content 2 4 extraction of cyclic component using ssa cyclic component represents the rise and fall of the time series pattern over a longer period of time woodward et al 2012 unlike periodic component it is not necessary that the period of repetition of the cyclic component should be exactly the same cyclic component in a rainfall time series usually occurs over years detection of a cyclic component is extremely difficult due to its non strict regular pattern and need of large scale of data for identification owing to the difficulty in extracting the cyclic component there is a practice among researchers to include cyclic component in the periodic component mhamdi et al 2010 in order to extract the cyclic component present in the koyna daily rainfall time series grouping based on periods of the eigen functions have been used the eigen functions that are having periods as a multiple of 365 1 year have been grouped as a separate group as related to cyclic component 2 5 ssa forecasting procedure in order to forecast a time series it is necessary for the time series to have a pattern structure a forecast can be made only if a model is built the model should be either derived from the data or at least checked against the data in ssa forecasting these models can be described through the linear recurrence relations lrr golyandina and zhigljavsky 2013 linear recurrence means that each term of a sequence is a linear function of earlier terms in the sequence a linear homogenous recurrence relation of degree k with constant coefficients is a recurrence relation of the form 20 a n c 1 a n 1 c 2 a n 2 c k a n k where c1 c2 ck are real numbers and ck 0 an is expressed in terms of the previous k terms of the sequence so its degree is k ssa forecasting is based on the underlying lrr the estimated lrr is applied on the last points of the ssa approximation of the series there are two algorithms described for ssa forecasting recurrent forecasting and vector forecasting both of which are based on the lrr in recurrent forecasting procedure direct use of lrr is performed on the time series obtained after diagonal averaging of the svd components whereas in ssa vector forecasting the trajectory matrix after reconstruction is continued for m forecast steps ssa vector forecasting procedure has been adopted in the current study and has been explained below 2 5 1 vector forecasting v forecasting in this method of forecasting the trajectory matrix after reconstruction is continued for m steps so that the matrix y m y i y k z k 1 z k m is approximately hankel then the forecasted series is obtained by the diagonal averaging of the matrix 21 where z i π y for i 1 k ρ vec z i 1 for i k 1 k m 22 ρ vec y π y r t y 23 π vv t 1 ν 2 rr t 24 vv t p 1 p 2 p r 25 r 1 1 ν 2 i 1 r π i p i 26 ν 2 π 1 2 π r 2 where p 1 pr are the principal components in the selected eigen triples on grouping in ssa πi is the last component of the vector pi y is the vector consisting of last l 1 components of y in the study the forecast step m is taken equal to the window length i e 365 days thus the daily rainfall for next 365 days is predicted based on the previous year s daily rainfall data using ssa vector forecasting algorithm the extracted components such as trend periodicity cyclic component and noise can better explain the hidden pattern and characteristics of the time series ssa forecasting procedure is based on the internal structure of the time series if the components can be forecasted separately and then added together the pattern of the time series can be better preserved in the present study ssa forecasting procedure as explained in the earlier sections has been applied to the signal and noise components and then added together for this purpose all the signal components such as trend periodic and cyclic components have been grouped together and forecasted in addition to the noise component forecast by ssa the forecasted signal and noise components have been added together to get the predicted daily rainfall values 3 study area the study area of the present study is koyna catchment in maharashtra india india lies in the tropical zone and hence the climate is majorly influenced by the monsoons latitude 17 0 n to 17 59 n and longitude 73 02 e to 73 35 e defines the position of koyna watershed with an area of 891 78 km2 central design office 1992 jothiprakash and magar 2012 south west monsoon is the major contributor of rainfall in the area and it accounts for almost 99 of annual rainfall in the koyna watershed jothiprakash and magar 2012 unnikrishnan and jothiprakash 2015 the observed rainfall data of nine rain gauge stations including koyna dam as one rain gauge station in the catchment area for 53 years from 1961 to 2013 were collected from koyna irrigation division office government of maharashtra india the spatially averaged daily rainfall data of the catchment had been estimated using thiessen polygon method from the observed rainfall data of all the nine rain gauge stations it is observed that koyna watershed is monsoon fed with zero rainfall during non monsoon period and non zero rainfall during south west monsoon from june to october correlogram of koyna rainfall series is given in fig 1 there is a repetition in the pattern of correlogram for every 365 lags and indicates the presence of a prevailing periodic component with period of 365 days present in the koyna daily rainfall series 4 results and discussions the above explained method of ssa is applied to the rainfall series of koyna from 1st january 1961 to 31st december 2013 in order to forecast the daily rainfall for one year the extraction of various components have been carried out using ssa for a period of 52 years from 1961 to 2012 and the signal and noise components have been forecasted separately for one year 1st january 2013 to 31st december 2013 using ssa and added together from the correlogram fig 1 of koyna series it is seen that a prevailing periodic component of period 365 days is present in the data window length is the major parameter in ssa and it decides the form of decomposition of the time series and the order of the trajectory matrix upon which svd is done thus appropriate selection of window length is very important in accurate decomposition of the time series if there is a prevailing periodic component with known period present in the time series it is advantageous to select any multiple of that period as window length unnikrishnan and jothiprakash 2015 unnikrishnan and jothiprakash 2015 selected a window length of 365 days for the koyna daily rainfall time series and sensitivity analysis for the window length has also been done and is reported that the appropriate selection of window length is crucial in accurate time series modelling using ssa unnikrishnan and jothiprakash 2016 thus window length of 365 days is used in the present study based on this window length 365 eigen functions principal components and eigen values are obtained as per the svd criterion based on the share of each eigen triple with respect to the others the eigen triples are numbered sequentially from 1 to 365 share of the eigen triple denotes the relative importance of the eigen triple in the original time series share of an eigen triple is the percentage of the ratio of the corresponding eigen value to the sum of all the eigen values of the svd components periodogram for each of the eigen functions have been developed which can reflect the spectral density of the data under consideration 4 1 extraction of trend component in order to extract the trend component periodogram analysis as explained in the section 2 1 has been used the first eigen function alone is only found to be satisfying the criteria of trend component mentioned in eq 10 and has been utilized to reconstruct the non linear trend component the trend component was reconstructed by diagonally averaging the first eigen function the extracted trend component of the koyna daily rainfall series from 1961 to 2012 has been given in fig 2 the figure shows that the trend of the koyna daily rainfall series is very small and thus it can be concluded that there is no major long term shift in the magnitude of rainfall in the catchment over years 4 2 extraction of periodic component in order to extract periodic component peak of periodogram analysis has been used in the study as explained previously in section 2 2 when plotted with period as base periodogram of some eigen functions corresponding to the ssa decomposition of koyna series showed recognizable peaks at certain period values the periodogram of eigen functions from 2 to 7 showed recognizable single peaks whereas the other eigen functions are having either no recognizable peak or multiple peak values in the periodogram the periodogram with period as independent variable of eigen functions from 2 to 7 is shown in fig 3 it is observed that periodograms of these eigen functions are having single peaks at periods 365 182 121 and 90 which is equivalent to 1 year 6 months 4 months and 3 months when considered in terms of daily rainfall data thus the eigen triples from 2 to 7 are taken for reconstructing the periodicity component the eigen triples 2 7 have been taken for periodicity reconstruction and the selected eigen triples are diagonally averaged as explained in eq 4 to get the periodic component the periodicity extracted from observed rainfall data is shown in fig 4 a it is reported that the addition of the extracted trend and periodicity together contributes to most of the non stationary component of a time series sheel et al 1981 the time series after removing the trend and periodicity component should comply with the stationary conditions for a time series to prove the stationarity of the residual time series a pictorial representation of stationarity called correlogram of the observed and residual time series and a statistical test of stationarity called kwiatkowski phillips schmidt shin kpss test have been utilized in the present study correlogram of observed koyna daily rainfall series for a lag of 1000 days has been shown in fig 1 a repeating correlogram indicates a strong periodic component in the time series it is evident from the correlogram of the observed daily rainfall series that it is a non stationary series with a prevailing periodic component of 365 days the correlogram of the periodic component fig 4 b showed that it contains a prevailing periodicity with period 365 days similar to that of the original correlogram of koyna series given in fig 1 correlogram of the residual koyna series after removing non linear trend and periodicity is given in fig 4 c the difference between the three correlogram can be clearly noticed the correlogram of the residual time series fig 4 c dies out rapidly which is an indication of stationary series in the correlogram of residual series no periodicity is shown and also it dies out to zero rapidly which indicate that the periodicity component has been successfully removed and the residual series represents a stationary time series kpss test kwiatkowski et al 1992 is a statistical test for checking whether time series is stationary or not it checks for the null hypothesis that a time series is stationary against an alternative of a unit root in the time series the detailed mathematical description of the test can be seen in kwiatkowski et al 1992 at 5 significant level the results of kpss test showed that the observed rainfall series with a test statistic of 0 2009 critical value is non stationary rejects the null hypothesis of stationary and accepts the alternative of presence of a unit root in the time series whereas the residual series after removing the trend and periodic component with a test statistic of 0 0017 critical value proves to be stationary accepts the null hypothesis where the critical value for 5 significance level is 0 149 thus kpss test confirms that the removal of extracted trend and periodicity components could transform the time series into a stationary time series both the tests of stationarity acf representation and statistical test confirms the extracted trend and periodic components to be responsible for the non stationarity of the observed time series as trend and periodicity components are the major non stationary components of a time series it implies that the extracted components correspond to trend and periodicity of the time series 4 3 extraction of noise in order to extract noise component w correlation matrix analysis has been used as explained in the section 2 3 the w correlation matrix of the eigen functions corresponding to the ssa decomposition of the koyna rainfall series is given in fig 5 in the figure w correlation has been shown as colour variation which is given in the colour index black red yellow and white and its variations have been taken to differentiate between different correlation values white represents a w correlation of one and black represents a w correlation of zero magnitude yellow represents a high value of w correlation in the range of 0 7 1 and red represents medium range of w correlation in the range of 0 3 0 6 the fig 5 shows that there is a random correlation among the 70 365 eigen functions indicated by the increase in the spread of the presence of mixture of red and yellow colours from the 70 to 365 eigen functions thus 1 to 69 eigen functions are having a non zero w correlation only to themselves and between the very nearby eigen functions however in the case of eigen functions from 70 to 365 there is a high random correlation between the eigen functions thus the fig 5 shows that the first 69 eigen functions are having correlation only within themselves and the nearby components but after that there is group of highly inter correlated group that are inseparable which implies mixing up of random components these randomly inter correlated group of eigen functions from 70 to 365 can be grouped as noise the noise component has been reconstructed using these eigen functions and is given in fig 6 a in order to validate the results basic statistics correlogram and power spectrum of the extracted time series has been utilized the basic statistics mentioned above include mean and variance of the noise by theory the mean of a noise should be near to zero and should have a constant variance priestly 1981 the box plot of the extracted noise is given in fig 6 b the plot shows that mean of the noise is zero which is the very basic essential condition for noise the box plot also shows that variation of the noise component is constant the variance of noise component extracted is estimated to be 16 of the signal variance thus the proposed method of ssa coupled with w correlation matrix can be adopted for noise detection even if the noise variance is more than 2 of the signal variance the acf of a white noise will typically be close to but not equal to zero acf for a white noise drops rapidly with increasing lag and for a red noise acf drops gradually to near zero values elsner and tsonis 1996 priestly 1981 earlier studies have much debated on does the weather parameters will exhibit the presence of red noise or auto correlated noise the acf plot of the extracted noise component has been given in fig 6 c and it shows a drop in acf to zero for increasing lag which is a property of noise comparing the acf of the koyna rainfall series fig 1 and that of noise fig 6 c it is found that there is a significant difference between these two plots where the acf of observed rainfall shows periodic property the acf of noise doesn t show any property of signal the acf plot of the residual series after removing the extracted noise from the observed series is given in fig 6 d on comparing the acf plots of the observed fig 1 and residual series fig 6 d it can be noticed that extraction of noise hasn t affected the signal component of the time series the observed koyna rainfall series is proved to be a non stationary series with the presence of trend and periodic component and by the kpss test results carried out on the koyna observed rainfall series unnikrishnan and jothiprakash 2015 thus the proposed method of ssa can be utilized to extract noise from a non stationary time series which is reported as extremely difficult in literature hu et al 2004 the white noise has a flat spectrum priestly 1981 that s why the name same response to all frequency as white light but a non flat spectrum will not imply that it is not noise because red noise will have a biased power spectrum toward low frequencies which is most likely present in a climatic time series chen et al 2013 the power spectrum of the extracted noise is given in fig 6 e it shows high powers at lower frequency and then dropping to near zero which is a property of red noise this shows that the noise extracted from koyna daily rainfall series is red noise 4 4 extraction of cyclic component in order to extract the cyclic component grouping based on periods of eigen functions as explained in section 2 4 has been used the eigen triples having periods as multiple of 365 days has been selected to reconstruct cyclic component the selected components were diagonally averaged to get the cyclic component the extracted cyclic component is given in fig 7 a the figure shows that there is a cyclic component with a cycle of nearly 11 12 years in order to understand better about the cyclic pattern shown in the cyclic component a plot of the range of the cyclic component in each year has been shown in fig 7 b this range of cyclic component has been estimated as the difference of the maximum and minimum values in the cyclic component each year the fig 7 b shows that there is a cyclic pattern in the component with a cycle of approximately 10 12 years it can be seen that there are some local troughs in the fig 7 b in order to differentiate the local troughs with the global troughs moving average of the range of the cyclic component has been taken and plotted against each year the moving average with various lags such as 2 3 and 4 years has been taken and are plotted against year in fig 7 c d e it can be noticed that the effect of the local troughs and variations are eliminated by taking moving average and cyclic pattern is clearly noticeable there is a half cycle of 6 years from 1962 to 1968 complete cycles of 12 years 1969 1981 and 10 years 2003 2013 and one combined cycle of 20 22 years are noticed 1982 2002 these observed cycles can be averaged to an 11 year cycle which can be linked to the sunspot cycle of 11 years which is found to be affecting the indian monsoon rainfall by researchers ananthakrishnan and parthasarathy 1984 loon and meehl 2012 the relationship between the sunspot cycle and the monsoon rainfall need to be further explored on the basis of more data points that can explore the variation of cycles of rainfall appropriately it is also reported that the major climate change happened approximately by the year 1980 81 and this regime shift represented a major shift in the earth s biophysical systems from atmosphere to lithosphere ipcc 2001 1996 reid et al 2016 it can be observed that before 1981 there was a 12 year rainfall cycle one half cycle and one complete cycle can be seen after 1980 81 the cycle was reduced to a period of 11 10 years this change of cycle may be due to the global shift in the climatic regime the relationship between the observed cycle of rainfall sunspot cycle and global climatic change need to be studied further based on a larger set of daily rainfall data in this region thus ssa method is very much useful to understand the natural cycles and components in a time series and could be further explored much to relate to the natural behavior of planetary positions and movement this may lead to better understanding of the nature of rainfall over a longer period of time 4 5 forecasting the daily rainfall using ssa the daily rainfall of one complete year has been forecasted using ssa based on the previous years rainfall data i e the daily rainfall of the year 2013 has been forecasted using the rainfall values from 1961 to 2012 in a single time step the two ssa forecasting algorithms such as recurrent forecast and vector forecast have been tried to predict the koyna daily rainfall series for one year and it is found that the vector forecasting procedure is more effective and reliable as far as longer time step prediction is concerned various combinations of the components have also been tried in forecasting the time series finally a combination of all signal components with noise component forecasted separately using vector forecasting algorithm emerged out as the best model both the signal and noise forecast were added together to get the one year prediction of koyna daily rainfall series for the year 2013 it is to be mentioned here that these values are predicted based on the components extracted using the data from the year 1961 to 2012 since the observed rainfall in the year 2013 is known the various components for the year 2013 was also extracted using ssa the sum of all extracted signal components such as trend periodic and cyclic components for the year 2013 were estimated and presented in fig 8 a along with the predicted signal components to check the efficiency of ssa in predicting the signal components the scatter plot of predicted and actual signal components of koyna daily rainfall of 2013 is also given in fig 8 b the fig 8 a and b shows that the proposed method of ssa has predicted the signal components with good accuracy the predicted and actual extracted signal components are well correlated with an r2 value of 0 84 which is remarkable for a one year prediction of daily rainfall data in a single run the predicted and extracted noise component of koyna daily rainfall from 1st january 2013 to 31st december 2013 has been given in fig 8 c the scatter plot of the predicted and extracted noise component is given in fig 8 d it is observed that ssa could predict the noise component with reasonable accuracy with an r2 value of 0 62 but the initial and final values of the noise are not predicted well this may be due to the chaotic behavior of the noise it is to be noticed that the performance of ssa in prediction of noise component is behind the performance in prediction of signal components the random nature of noise component may be the reason for the comparatively lower performance in prediction of noise component however prediction of noise can also be considered as with reliable accuracy as the forecast horizon is of very long duration one year the predicted signal as well as noise components for the year 2013 have been added together to get the predicted daily rainfall of koyna watershed for the year 2013 the time series plot of predicted and observed rainfall in koyna watershed for the year 2013 has been given in fig 8 e the scatter plot of the predicted and observed koyna daily rainfall given in fig 8 f shows that there is good correlation between observed and predicted rainfall especially for a daily rainfall for such a longer time step prediction as one year the performance measures of the ssa model in predicting the daily rainfall for the year 2013 have been shown in table 1 the details of the statistical performance measures adopted in the study has been given in appendix a the performance measures also indicate a good performance by the model for one year ahead daily rainfall prediction the r2 value and efficiency e are in good agreement with a value of 0 78 and 0 74 indicating that there is good correlation between predicted and observed rainfall the errors such as root mean squared error rmse mean absolute error mae mean negative error mne and mean positive error mpe are also less when a one year daily rainfall prediction model is considered in order to reassure the reliability of the model in predicting daily rainfall for one year the daily rainfall of the year 2012 was also forecasted using the model by making use of the daily rainfall data from 1961 to 2011 the same methodology as explained for 2013 year forecast was used to forecast the daily rainfall of koyna catchment for the year 2012 the various components of the rainfall for the time period of 1961 to 2011 was extracted and the signal and noise components were forecasted separately for one year using vector forecasting algorithm the observed and predicted rainfall for the year 2012 is given in fig 9 it can be observed from the figure that the model could predict the daily rainfall accurately the various performance measures of the model in predicting daily rainfall for the year 2012 has been given in table 1 all the performance measures of the model show a good performance of the model in predicting the daily rainfall of the year 2012 with very high r2 value of 0 8 and very low values of errors such as rmse mae mpe and mne it can also be observed that the error in peak rainfall value prediction is also very less with a mp value of 12 87 it can be noticed that the ssa model predicted both the 2012 and 2013 year daily rainfall with reasonable accuracy it can be now concluded that the major advantages of utilizing ssa in daily rainfall prediction over conventional models such as stochastic and ann models are i longer duration forecast can be successfully carried out in a single run ii peak rainfall values can be predicted with reasonable accuracy iii no lag effect in prediction unlike ann models iv all the components can be successfully extracted in order to compare the results of the present methodology with other methods methods that forecast for same forecast horizon of one year is required however in literature no studies have been found that reported to forecast daily rainfall for such a longer duration however a comparison has been carried out with the study of unnikrishnan and jothiprakash 2017 in which the same daily rainfall data have been forecasted for seven days using ann and ssa ann it is observed that the performance of ann and ssa ann models retards when the time step of prediction increases from one to seven day thus the proposed method of ssa to predict daily rainfall for one year performs better than ann and ssa ann that predicts seven day ahead rainfall it can be concluded that the extraction of various components and utilization of those components for prediction by ssa has enhanced the forecasting capability of ssa model the results also indicate that the noise component also has a particular degree of influence in the accuracy of forecast of the time series thus noise also have some pattern of the time series which is a property of red noise 5 conclusions forecasting daily rainfall time series for longer time duration at a single step along with extraction of significant rainfall components using ssa is the primary aim of this study the components such as nonlinear trend periodic component noise and cyclic component was extracted from the daily rainfall series using ssa it was noticed that the noise component extracted was having 16 of signal variance thus the proposed method of ssa can extract noise even if the noise variance is more than 2 of the signal variance which was reported to be difficult by previous researchers it has also been noticed that there is a cyclic component with a cycle of 11 years in the rainfall time series this 11 year cycle in the rainfall can be linked to the 11 year sunspot cycle and some researchers have reported a relation between indian monsoon and sunspot cycle the observed change of rainfall cycle from 12 years to 11 10 year may be due to the global shift in the climatic regime thus ssa method is very much useful to understand the natural cycles and components in a time series and could be further explored much to relate to the natural behavior of planetary positions and movement the forecasting of the daily rainfall has been carried out for 365 days 1 year in a single step of forecasting using ssa vector forecasting in order to forecast the rainfall time series the signal and noise components were forecasted separately for a prediction time step of 365 days for the years 2013 and 2012 thereafter the predictions of signal and noise components were added together to get the predicted rainfall for the year 2013 and 2012 the results showed that the ssa model could forecast the rainfall with reasonable accuracy for a longer duration daily rainfall forecast such as one year it can be now concluded that by utilizing ssa in daily rainfall prediction i longer duration forecast can be successfully carried out in a single run ii peak rainfall values can be predicted with reasonable accuracy iii there is no lag effect in prediction unlike ann models iv all the rainfall components can be successfully extracted prior to prediction acknowledgments the authors greatly acknowledge the koyna dam authorities executive engineer of koyna dam for providing necessary data for this research we also acknowledge the editor associate editor and unanimous reviewers whose comments and suggestions helped us to improve the readability of the manuscript appendix a model performance measure performance criteria equation mean absolute error mae mae 1 n t 1 n f t y t ramirez et al 2005 mean positive error mpe mpe 1 x i 1 x f t y t i where i 1 2 x for all positive ft yt unnikrishnan and jothiprakash 2017 mean negative error mne mne 1 y i 1 y f t y t i where i 1 2 y for all negative ft yt unnikrishnan and jothiprakash 2017 root mean squared error rmse rmse 1 n t 1 n f t y t 2 ramirez et al 2005 wang et al 2009 the coefficient of determination r2 r2 r 2 n i 1 n y t f t t 1 n y t t 1 n f t n t 1 n y t 2 t 1 n y t 2 n t 1 n f t 2 t 1 n f t 2 wang et al 2009 nash sutcliffe efficiency coefficient e e 1 t 1 n y t f t 2 t 1 n y t y 2 nash and sutcliffe 1970 percentage mean error in predicting peak rainfall mp mp f t max y t max f t max 100 jothiprakash and magar 2012 where yt and ft are observed and forecasted rainfall values respectively during the time period t n is the total number of rainfall observations y is the arithmetic mean of observed values ft max and yt max are maximum values of forecasted and observed values respectively 
7298,hyperconcentrated sediment laden floods often occur in a braided reach of the lower yellow river usually leading to significant channel evolution a one dimensional 1d morphodynamic model using a dynamically coupled solution approach is developed to simulate hyperconcentrated flood and channel evolution in the braided reach with an extremely irregular cross sectional geometry in the model the improved equations for hydrodynamics account for the effects of sediment concentration and bed evolution which are coupled with the equations of non equilibrium sediment transport and bed evolution the model was validated using measurements from the 1977 and 2004 hyperconcentrated floods furthermore the effects were investigated of different cross sectional spacings and allocation modes of channel deformation area on the model results it was found that a suitable cross sectional distance of less than 3 km should be adopted when simulating hyperconcentrated floods and the results using the uniform allocation mode can agree better with measurements than other two allocation modes keywords hyperconcentrated flood morphodynamic model coupled solution cross sectional spacing allocation mode of bed deformation area braided reach 1 introduction flood flows often carry very high concentration sediment during rainy seasons with the maximum sediment concentrations ranging from 200 to 800 kg m3 in the lower yellow river lyr with the characteristic diameter of suspended load d90 varying from 0 09 to 0 12 mm at the hydrometric station of huayuankou zhao et al 1998 where d90 is the sediment size for which 90 by weight of the material is finer these floods are also called hyperconcentrated sediment laden floods if the maximum sediment concentration exceeds 200 300 kg m3 zhang and xie 1993 wan and wang 1994 wang et al 2009 significant channel evolution in alluvial rivers associated with hyperconcentrated floods can give rise to many problems such as the hazard to various flood control infrastructure furthermore hyperconcentrated floods can cause unique fluvial processes in the braided reach of the lyr which has attracted the concern of scientists and engineers in the contexts of river dynamics and geomorphology wan and wang 1994 cao et al 2006 wang et al 2009 chien 1989 summarized the main results for the flocculation rheology properties fluvial hydraulics of hyperconcentrated flows and wan and wang 1994 described the detailed features of hyperconcentrated flows with the knowledge of mechanics of sediment transport being enriched in this field according to field measurements 16 hyperconcentrated flood events occurred in the lyr during the period from 1969 to 1989 and the sedimentation volume caused by these floods accounted for 82 of the total deposition volume in the lyr during the same period zhao et al 1998 xia et al 2010a these measurements also indicate that the deposition amount for the coarse sediment particles with the diameter greater than 0 10 mm accounted for 80 of the incoming sediment load and mainly occurred in the braided reach upstream of gaocun zhao et al 1998 therefore hyperconcentrated floods are one of main reasons that caused severe sedimentation in the lyr in addition extremely high water levels usually occur during hyperconcentrated floods which influence the safety of various river training works the flood water volume entering the lyr generally tends to decrease significantly owing to the development and utilization of water resources in the yellow river basin and the construction of large reservoirs in the upper yellow river the sediment load during a flood season also decreases because of strong human activities such as soil and water conservation with the extent of reduction in sediment amount being greater than that of water volume however the occurrence probability of hyperconcentrated sediment laden floods tends to increase during flood seasons in the lyr yao and xu 2013 fei and wu 2015 in terms of flood risk management it is essential to fully understand the characteristics of flood routing and the associated channel evolution during hyperconcentrated floods with physical and mathematical river models being two key approaches for such an investigation physical river models were used widely in the 1980s and 1990s to investigate the fluvial processes which played an important role in solving the sediment related problems in the lyr zhang and xie 1993 wan and wang 1994 with the rapid development of computer performance during the past four decades mathematical river models or morphodynamic models have become more popular due to their low cost flexibility in evaluating different effects of river training works and capability of delivering detailed predictions cao and carling 2002 van maren et al 2011 li et al 2014 one dimensional 1d and two dimensional 2d morphodynamic models have been increasingly developed to simulate hyperconcentrated floods as well as the fluvial processes involved zhang et al 2001 cao and carling 2002 zeng and beck 2003 ni et al 2004 cao et al 2006 wu and wang 2007 guo et al 2008 van maren et al 2011 he et al 2012 li et al 2014 2d morphodynamic models are widely used to simulate morphological changes in a local reach over a short period wu et al 2004 xia et al 2010b van maren et al 2011 in terms of modeling of bed deformation for a long reach over a long period 1d morphodynamic models are prevalent in practical engineering zhang et al 2001 guo et al 2008 he et al 2012 li et al 2014 two solution approaches are currently used in numerical models to simulate morphodynamic processes in alluvial rivers covering uncoupled and coupled solutions zhang and xie 1993 cao and carling 2002 xia et al 2010b in order to simulate morphodynamic processes caused by hyperconcentrated floods the second method may be more appropriate cao et al 2006 li et al 2014 although the first method is still used widely in practice for example zhang et al 2001 proposed a 1d model for simulating the morphodynamic processes in the lyr using the approach of uncoupled solution and special treatments were presented to calculate the sediment transport capacity and movable bed roughness coefficient ni et al 2004 guo et al 2008 proposed a 1d steady model to simulate the processes of sediment transport and bed deformation for both ordinary and hyperconcentrated flows in the lyr and the calculation of non equilibrium transport of graded suspended sediments was based on the theory proposed by han 1979 with the uncoupled solution also being used however the majority of previous models adopt an uncoupled solution for simulating hyperconcentrated floods without the effects of sediment concentration and bed evolution being included in the hydrodynamic governing equations zhang et al 2001 zeng and beck 2003 ni et al 2004 guo et al 2008 the uncoupled solution for morphodynamic models only applies to low rates of bed deformation in alluvial rivers which means that the variation in bed level within a time step is much less than the change of water level or depth with the term of bed evolution rate being neglected in the shallow water equations zhang and xie 1993 cao and carling 2002 wu 2007 in terms of modeling of rapid channel evolution caused by dam break flows or hyperconcentrated floods a fully coupled solution is often adopted in morphodynamic models for example cao et al 2004 and wu and wang 2007 respectively proposed 1d morphodynamic models to simulate dam break flood routing using the coupled solution cao et al 2006 also developed a 1d morphodynamic model to reveal new insights into the phenomena of bed tearing scour and river blockage during hyperconcentrated floods in the yellow river recently li et al 2014 adopted a fully coupled 1d morphodynamic model to investigate the phenomenon of peak discharge increase over hyperconcentrated floods occurring in a sketched erodible channel with a constant width and uniform bed material composition and it was found that the downstream discharge increase must be mainly due to a reduction in bed friction during peak discharge periods for most cases however the application of these coupled models is usually restricted to 1d water sediment mixtures in an idealised channel with rectangular cross sections it should be noted that the coupling interaction between flow sediment transport and bed evolution during hyperconcentrated floods is more complicated in natural alluvial rivers with irregular bed topography in this study a coupled 1d morphodynamic model has been developed to simulate the fluvial processes caused by hyperconcentrated floods in the braided reach of the lyr with irregular cross sectional geometry in the model the improved 1d hydrodynamic module is coupled with the modules of sediment transport and bed evolution to predict simultaneously the hydrodynamics sediment concentrations and morphological changes the developed model was applied to simulate the morphodynamic processes caused by two typical hyperconcentrated floods occurring in the braided reach and the model predictions were generally compared well with the observed data including the hydrographs of discharge and graded suspended sediment concentrations at several hydrometric sections and the cumulative volume of bed deformation in addition the effects were investigated of different cross sectional spacings and allocation modes of bed evolution area on the model results 2 coupled 1d morphodynamic model measurements of hyperconcentrated flows occurring in the lyr zhao et al 1998 indicate that i the percentage of coarse particles increases obviously with the total sediment concentration varying from 200 to 900 kg m3 and however the percentage of fine particles with the diameter less than 0 01 mm increases slightly ranging between 30 and 60 kg m3 and ii the non newtonian hyperconcentrated flows can not occur in the lyr because of coarse sediment composition and low flow velocity although the maximum sediment concentration can vary from 800 to 900 kg m3 during a hyperconcentrated flood occurring in the lyr the flow pattern of such a floodwater still belongs to a kind of intensively turbulent flow in newtonian fluid instead of a kind of bingham fluid based on the observed data in the majority of hyperconcentrated floods the magnitude of bingham yield stress generally approaches to zero without the structure of flocculation owing to intensively turbulent characteristics in the lyr fei and zhu 1991 zhao et al 1998 therefore the common continuum equation is used to describe the transport of suspended load during hyperconcentrated floods a coupled 1d morphodynamic model is proposed herein to simulate the fluvial processes caused by hyperconcentrated floods in the braided reach with complex topography which consists of 1d unsteady hydrodynamic governing equations the non equilibrium transport equation for non uniform suspended load and the equation of bed evolution the standard saint venant equations for hydrodynamics were modified with the term of bed evolution rate and the term of spatial variation in sediment concentration being included it should be noted that sediment is often assumed to be a kind of continuous medium because the stochastically averaged properties of a group of sediment particles are mainly concerned in river dynamics wu 2007 two kinds of models two fluid model and diffusion model can be used to describe the water and sediment two phase flow based on this assumption however the two fluid model is not widely used in practice owing to its complexity therefore the sediment transport equation adopted herein is based on the diffusion model that considers the movement of sediment particles as a phenomenon of diffusion in a kind of continuous medium wu 2007 2 1 governing equations and numerical solution 2 1 1 modified 1d hydrodynamic equations the modified 1d hydrodynamic equations for the water sediment mixture in an alluvial river with an irregular cross sectional geometry can be written in the following form zhang and xie 1993 wu 2007 1 q x b z t q l a b t add 2 q t ga α f b q 2 a 2 z x 2 α f q a q x q 2 a 2 a x z gaj f ρ l q l u l ρ m 1 ρ m δ ρ ρ s q s t 1 ρ m δ ρ ρ s q 2 a gah c s x add where q discharge z water level a wetted cross sectional area b width of water surface s suspended load concentration a b cross sectional area of the bed above a reference datum g gravitational acceleration α f correction coefficient for flow momentum j f friction slope q l lateral inflow discharge per unit length of channel ρ l density of the lateral inflow u l velocity component of lateral inflow along the main flow direction δρ ρ s ρ f in which ρ f clear water density and ρ s sediment density ρ m density of water sediment mixture and h c submerged depth of the section centroid x longitudinal distance and t time main flow and morphodynamic variables are illustrated in fig 1 the additional term in eq 1 accounts for the effect of bed deformation on flow continuity which can also be interpreted as the contribution of sediment exchange between flow and bed to the mass conservation of the water phase the additional terms in eq 2 include the influence of the streamwise pressure gradient due to the varying sediment concentration and the momentum transfer from the sediment phase both of which can be regarded as the effects of sediment transport without these additional terms the above governing equations can be simplified to the standard saint venant equations widely used in the computational hydrodynamics 2 1 2 transport equation of suspended load in the current model the non equilibrium transport process of non uniform suspended load is described by the following equation 3 t as k x aus k b ω k α k s k s k s lk q l where sk s k concentration and transport capacity for the kth fractional sediment slk lateral inflow sediment concentration αk non equilibrium adaption coefficient and ωk effective settling velocity the formula of effective settling velocity ω k in muddy water proposed by zhang et al 2001 is used in this model and it can be expressed by ω k ω 0 k 1 s v 2 25 d 50 3 5 1 1 25 s v where ω 0 k settling velocity for the kth sediment fraction in clear water sv volumetric total sediment concentration for all fractions and d50 median diameter of the suspended sediment in mm ω 0 k can be calculated by the unified formula for three settling regions of natural sediment particles zhang and xie 1993 the sediment settling velocity decreases with an increase in sediment concentration because of hindered settling the coefficient αk is an important parameter in morphodynamic models and the value for erosion is larger than that for deposition han and chen 2008 however it becomes a type of comprehensive coefficient which needs to be calibrated by observed data several empirical methods were proposed in the literature for determining the value of αk with a significant difference existing among these methods zhou and lin 1998 cao et al 2004 guo et al 2008 it is found that if the same αk value is used for all the size fractions then the amount of coarser sediment eroded from the bed is greater than that of the finer fraction during the process of bed degradation this causes the composition of bed material to become finer rather than getting coarser which is physically incorrect xia et al 2010b in order to avoid this different values of αk are usually set for different fractions in the present study the following empirical relation is used to determine αk wang and xia 2001 xia et al 2010b 4 α k β ω k 0 3 s k s k β ω k 0 7 s k s k where β is a case dependent coefficient which is usually set at 0 001 xia et al 2010b in the calculation of sediment transport the proposed module does not include the simulation of bed load transport because the transport of suspended load in the lyr is fairly dominant according to the analysis of observed data by long and zhang 2002 the average ratio of bed load to total load of sediment in the lyr is only about 0 5 therefore the transport of bed load is often ignored and only the transport of suspended load is considered in the model 2 1 3 equation of bed evolution the equation for the area of bed evolution can be written as 5 ρ δ a b δ t k 1 n b ω k α k s k s k in which δa b total area of bed deformation at a section in one time step of δ t ρ dry density of bed material and n total number of graded sediments 2 1 4 setup for boundary and initial conditions the boundary conditions used in this model include two types i e inlet upstream and outlet downstream boundaries at the inlet boundary the observed time series of discharge and graded sediment concentrations are usually specified at the outlet boundary the rating curve between stage and discharge or the observed time series of water level is often adopted cross sectional profiles at a number of sites measured before a flood season are used to represent the initial topography in a study reach the numerical model is usually required to be run for a sufficiently long time or a spin up period without topography updating to achieve a steady state under the given inflow discharge and graded sediment concentrations at the upstream boundary and the given water level at the downstream boundary these steady state results are then specified as the initial conditions of flow and sediment transport in the study reach 2 1 5 numerical solution in a 1d numerical model a study reach usually covers a limited number of cross sections and the section averaged variables of flow and sediment need to be obtained through solving the corresponding governing equations if the sediment concentration in an alluvial river is relatively low and the rate of bed evolution is very slow as compared with the rate of flow variation the right side two terms in eqs 1 and 2 can be neglected the hydrodynamic governing equations for the water sediment mixture can be simplified into the common saint venant equations however significant bed evolution usually occurs during hyperconcentrated floods and the additional terms in eqs 1 and 2 need to be considered in the governing equations the classical preissmann scheme is widely used in river dynamics although nowadays the godunov type scheme becomes more popular for its capability of shock capturing and dealing with transcritical flows toro 1998 the preissmann scheme still has its superiority in practice this implicit finite difference scheme is unconditionally stable and extremely robust in the situation where no transcritical flow appears the accuracy of preissmann type is not lower than that of the godunov type scheme savic and holly 1993 most flood flows in alluvial plain rivers are subcritical and the use of the preissmann scheme is fairly enough to achieve successful simulations in this study the hydrodynamic governing equations for the water sediment mixture are solved using the preissmann implicit scheme in this scheme the weighting factor is set at 0 65 for the temporal derivative wu 2007 and it is set at 0 5 for the spatial derivative in order to satisfy the requirement of numerical stability suggested by venutelli 2002 the resulting nonlinear equations are solved using the double sweep algorithm with more solution details being presented in julien 2002 or wu 2007 in terms of the calculation of sediment transport for each fraction the scheme of explicit upwind difference is adopted for eq 3 however this scheme is highly diffusive and it can be refined in the future using the ultimate quickest scheme lin and falconer 1997 the equation of bed evolution is solved using the scheme of explicit difference 2 2 treatments of key parameters and problems 2 2 1 sediment transport capacity the model uses an empirical formula for calculating sediment transport capacity based on the gravitational energy concept proposed by zhang and zhang 1992 this formula is widely used to compute the sediment transport capacity in the lyr zhang et al 2001 ni et al 2004 which can be expressed by 6 s 2 5 0 0022 s v u 3 κ gh ω m γ s γ m γ m ln h 6 d 50 0 62 where γs and γm denote the specific weights of sediment and turbid water respectively κ von karman coefficient in muddy water expressed by a function of sv with κ 0 4 1 68 s v 0 365 s v ωm group settling velocity of non uniform suspended load which can be written as k 1 n δ p k ω k where δp k percentage of the sediment transport capacity for the kth grain size fraction and d 50 median diameter of the bed material the accuracy of this formula has been validated through a series of field and laboratory data and fig 2 a shows that the results calculated by eq 6 can agree closely with the observed data these observed data were mainly from the measurements at various hydrometric stations in the lyr wu et al 2008a with the flow velocities ranging from 0 3 to 3 1 m s and with the water depths ranging from 0 6 to 11 3 m the percentage of the sediment transport capacity for the kth size fraction δ p k also needs to be determined in this study the approach by li 1987 is used to calculate δ p k this formula directly adopts flow parameters and the gradation of bed material to determine the fractional sediment transport capacity and its detailed description can be found in zhang and xie 1993 fig 2b d indicate comparisons between the graded sediment transport capacity calculated by eq 6 and the corresponding measured concentrations for three fractions the calculated concentrations are greatly underpredicted for the size fraction of d 0 025 mm fig 2b while they are significantly overestimated for the fraction of d 0 050 mm fig 2d for the size fraction of d 0 025 0 050 mm the calculated concentrations generally agree well with the observed data as shown in fig 2c the large difference between the calculated and measured concentrations for the fine or coarse fraction fig 2b or 2d can be explained as follows firstly measured suspended sediment concentrations used to validate eq 6 were selected under a rough equilibrium transport state of the total sediment and it could not guarantee that the graded sediment transport was in equilibrium state secondly the method to calculate the gradation of sediment transport capacity can not account for the effect of inflow sediment composition therefore it is necessary to enhance the accuracy of the formula for the graded sediment transport capacity in the future study the variation of sediment transport capacity caused by the adjustment in bed material composition is considered by a computation procedure that updates the size distribution of bed material after each time step wang et al 2008 2 2 2 selection of bed roughness coefficient the magnitude of the manning roughness coefficient is found to be quite large during low discharges with the highest value of more than 0 045 being measured in the lyr chien and wan 1999 following an increase in discharge the coefficient gradually decreases and approaches a minimum value of 0 007 0 010 chien and wan 1999 pointed out that the variation in manning roughness coefficient is closely related to the development of bedforms in the lyr however 1d morphodynamic models can output the cross section averaged variables of flow and sediment and the lumped area in bed evolution at each section and can not provide the details of bedform development therefore it is impossible to present an accurate estimation of bed roughness coefficients using the 1d model predictions in practice bed roughness coefficients at a hydrometric section are usually back calculated under different discharges according to the observed discharge processes guo et al 2008 he et al 2012 the discharge roughness curves at other cross sections can be interpolated according to these measured curves at hydrometric sections the lyr is famous for the secondary perched reach occurring in some local regions which means that the mean bed level of the river channel is higher than that of the floodplain and the latter is higher than the elevation of levee back side xia et al 2010a fig 3 shows a cross sectional profile in such a typical reach in the late 1990s represented by the profile at chanfang measured at the end of the 1999 flood season it is found that the main channel zone of this section was closely restricted by local farm dikes and the mean level of the river channel 72 3 m was higher than that of the floodplain 71 1 m it should be noted that bed roughness coefficients in the main channel zone and on the floodplain zone should be treated separately at some cross sections in the secondary perched reach the former can be calculated using the calibrated discharge roughness curves and the latter can be regarded as constant values with the manning roughness coefficients ranging from 0 035 to 0 045 for the floodplain zone the zone of the main channel is distinguished from that of the floodplain by visual identification of the floodplain lip at a cross section in the perched reach and it is assumed to be flooded preferentially in the computation moreover the roughness coefficients under different discharges at a section can be adjusted slightly if the degree of bed evolution is relatively large 2 2 3 lateral allocation of channel evolution area 1d morphodynamic models are usually used to simulate the flow and sediment transport in the streamwise direction of an alluvial river without solving the details over the cross section wu 2007 as shown in eq 5 the 1d model provides only the lumped area in bed deformation δa b at each section over a given time step and δa b needs to be allocated approximately to the local variation in bed level at each node δz bj along the cross section in order to acquire a reasonable prediction for the long term morphological evolution in a study reach the obtained δz bj is then used to update the cross sectional geometry wu 2007 the proposed model can account for several methods to allocate laterally the area of channel evolution the first allocation method adopted in this model is the uniform distribution of bed evolution area along the cross section which is widely used in 1d modeling of bed deformation caused by the non equilibrium transport of suspended load the detailed allocation mode depends on the scenario of deposition or erosion wu 2007 guo et al 2008 he et al 2012 for the case of bed deposition the deposition material is uniformly allocated to the wetted perimeter of a cross section because the suspended load concentration tends to be relatively uniform along the cross section for the case of bed erosion it is assumed that erosion occurs only in the main channel zone because bed scour can not occur on the floodplain zone owing to large bed roughness and low flow velocity and the bed levels are lowered uniformly at submerged nodes of the main channel zone the second allocation method distributes the area of deposition and erosion along the section based on a power function of the difference between the sediment concentration and sediment transport capacity and the third method allocates the area of bed evolution by a power function of excess shear stress the details for these allocation methods are given in wu 2007 these three allocation modes are specified as md1 md2 and md3 in the following analysis cross sections in the braided river are generally very wide and shallow in geometry and however a suitable identification method is available to determine the bankfull level and main channel zone the level of the lip top of an active floodplain is usually defined as the bankfull level at a section in terms of flood control and the main passage between the two lips of the active floodplains on both sides is often defined as the zone of the main channel xia et al 2010a 2014 therefore the allocation methods presented in this study can be used to the braided reach with the physical fundamentals being included 3 model validation using two hyperconcentrated flood events in this section a description of the study reach is outlined briefly the measurements obtained from two hyperconcentrated sediment laden floods in 1977 and 2004 in the lyr were used to validate the coupled 1d morphodynamic model proposed herein 3 1 description of study reach the yellow river is the second longest river in china with a drainage area of 795 000 km2 fig 4 a the average annual natural runoff of the yellow river is normally 58 billion m3 and the average annual suspended sediment load is 1 6 billion tonnes ranking it first of all the world s rivers in terms of sediment load li 2003 wu et al 2008b the average suspended sediment concentration was 30 kg m3 measured at the station of xiaolangdi from 1951 to 1970 with the maximum concentration of 941 kg m3 being measured on 8 august 1977 the majority of the sediment load comes from flood flows in summer and the particle sizes vary from silt to fine sand with a median diameter of about 0 030 mm the lower yellow river has a length of about 786 km as it flows from mengjin toward the sea passing ne across the north china plain as shown in fig 4b the lyr is usually divided into three geomorphologically distinct reaches the upper reach from mengjin to gaocun has a typical braided channel pattern the lower reach from taochengpu to lijin is a well restricted and stable meandering river reach the river reach lying between gaocun and taochengpu has a transitional channel pattern from braided to meandering the lyr is a naturally aggrading river because of the high suspended load it carries however significant channel degradation occurs in the lyr owing to the operation of the xiaolangdi reservoir after 1999 according to the observed data the total deposition volume in the lyr reached about 5 52 billion m3 during the period from 1950 to 1999 of which 60 was deposited in the braided reach upstream of gaocun the braided reach has a wide and shallow channel geometry based on the measurements conducted in 1999 with an average main channel width of 580 3380 m and a relatively steep longitudinal channel slope of 1 9 104 and with numerous central bars and complex branches exposed during low discharges in a narrow subreach with a short stream length the natural clay spurs or artificial bank protection works constrain the channel shifting which causes a narrow channel to be formed during a flood season significant bed deformation and shifting of the main stream often occur in the braided reach therefore it is necessary to predict accurately the processes of hyperconcentrated flood routing and the associated morphological changes in the braided reach in terms of flood risk management in order to save the computer time various efforts were made to introduce simplifications in the numerical solution of the governing equations for the 1d morphodynamic models one of the major simplifications is that a coupled solution could be approximated by an uncoupled solution which means that the effects of bed evolution and sediment transport are not considered in the hydrodynamic governing equations zhang et al 2001 ni et al 2004 such a simplification is appropriate generally for floods with low sediment concentrations and slight bed deformation rates zhang and xie 1993 previous observed data indicate that rapid rates of bed evolution usually occur during hyperconcentrated floods in the lyr and the approximation of an uncoupled solution is not applicable to these cases table 1 shows the observed discharge processes at huayuankou during two hyperconcentrated floods from the published hydrological yearbooks through analysing these observed data the difference can be revealed between the rates of water level change and bed level variation case i represents a scenario where serious bed deposition occurred during the 1977 hyperconcentrated flood the time interval δt between two consecutive measurements was relatively short the observed water level decreased from 91 53 to 91 46 m over less than one day with a slight decrease magnitude of water level δz of 0 07 m during the same period the mean bed level increased from 88 96 to 89 42 m with an increase in bed level δz b of 0 46 m therefore the rate of bed evolution during the short period can be calculated by δ z b δ t while the rate of water level change can be obtained by δ z δ t it is obvious that the value of δ z b δ t was much greater than that of δ z δ t for the case of bed deposition during the flood event case ii represents another scenario where serious bed scour occurred during the 2004 hyperconcentrated flood it can be obtained from this table that the increase magnitude of water level δz was 0 14 m over about one day with the corresponding decrease magnitude of bed evolution being 0 51 m the rate of bed evolution was much higher than that of water level change for the case of bed scour the investigation into observed discharge processes confirms that the approach of uncoupled solution is not satisfactory for simulating hyperconcentrated floods in the braided reach of the lyr 3 2 modelling of the 1977 hyperconcentrated flood 3 2 1 model setup for the 1977 hyperconcentrated flood the regime of the flow and sediment entering the lyr in 1977 was characterized by a hydrological sequence of middle water flows and high sediment concentrations with two hyperconcentrated flood events occurring in july and august observed data show that the flood runoff in july was mainly from the rainfall zone of the tributaries of the wei river the north luo river and the yanshui river as shown in fig 4a the maximum discharge was 8100 m3 s at the hydrometric station of huayuankou in the lyr with a maximum sediment concentration of 546 kg m3 the flood runoff in august was mainly from the rainfall region between the pianguan river and the tuwei river and the maximum discharge reached 10800 m3 s at huayuankou with a maximum sediment concentration being 809 kg m3 the coarsest diameter of the suspended load was 0 070 mm in these two flood events the 1977 hyperconcentrated flood events led to the occurrence of deposition on the floodplain and scour in the main channel in the braided reach but the total volume of deposition on the floodplain was greater than that of scour in the main channel the simulation zone covered the total braided reach of the lyr with a length of about 284 km between tiexie and gaocun including 28 sedimentation sections the cross sectional profiles at 28 sections measured before the 1977 flood season were taken as the initial topography the hydrographs of discharge and sediment concentration at xiaolangdi measured during the 1977 flood events were used as the upstream boundary condition fig 5 a and the measured hydrograph of water level at gaocun was used to specify the downstream boundary condition in addition the flow and sediment regimes were treated as the lateral inflow conditions from two tributaries of the yiluo and qin rivers located downstream of the xiaolangdi dam as compared with the water volume entering this reach the volume of water diversion during the period was negligible in this reach and therefore the process of water diversion was not accounted for the simulation period was from 14 june to 15 september 1977 with a total simulation time of 2232 h in the current case the time step used was 20 s fig 5b shows a mean size distribution of the suspended load at xiaolangdi over the study period with the mean median diameter of 0 028 mm at this section the gradation of incoming suspended load was used to determine the fractional sediment concentrations at the upstream boundary the data for the bed material composition in this reach observed in april 1977 were available at only 4 cross sections and the size distributions of bed material at other sections were obtained by linear interpolation of these known bed material gradations at these sections fig 5b also indicates a mean size distribution of the bed material in this reach at the initial time it can be seen from fig 5b that the size distributions for both suspended load and bed material were non uniform with the particle sizes ranging from 0 002 to 0 500 mm in this study eight size fractions were used to represent the non uniform sediment mixture with the corresponding representative diameters ranging from 3 7 to 353 6 μm at the initial time the mean median diameter of the bed material was 0 116 mm in this reach which was coarser than that of the suspended load at xiaolangdi 3 2 2 model results for the 1977 hyperconcentrated flood in this study the proposed coupled 1d model was used to reproduce the processes of floodwave propagation and bed deformation during the july and august hyperconcentrated flood events in 1977 calculated results for the 1977 flood events indicate that the value of the additional right side term in eq 2 was much less than the friction term gajf and the effect of this additional term was very limited in terms of a specified flood event however the magnitude of the additional right side term ab t was equivalent to the value of b z t in eq 1 with the former being greater than the latter at specified times in general the additional right side terms in the governing equations for the water sediment mixture in an alluvial river had a definite influence on the model results for these hyperconcentrated floods fig 6 shows comparisons between the model predicted and field observed discharge hydrographs at two sections of huayuankou and gaocun with the corresponding correlation degrees between these hydrographs of 0 83 and 0 64 at huayuankou the calculated maximum discharge was 7544 m3 s in july fig 6a about 7 less than the measured value 8100 m3 s and the model underestimated the second peak discharge in august with the predicted maximum discharge of 8490 m3 s being lower than that observed 10800 m3 s at gaocun the calculated discharge hydrograph generally agreed with the measured value especially during the august flood event fig 6b however the predicted discharges during the period 660 720 h were generally less than the corresponding measurements and it was regarded that improper selection of bed roughness coefficients led to this big difference especially with large roughness values being used during this period the model predicted time of floodwave propagation between tiexie and gaocun was 26 h during the july flood event which was slightly greater than the measured time 23 h the discharge hydrograph during the second flood peak calculated using the coupled solution agrees better with the measured discharges at gaocun as compared with the results obtained using the uncoupled solution fig 7 a therefore it is concluded that the proposed coupled model can simulate accurately the hyperconcentrated flood routing in the braided reach with complex topography as shown in fig 8 there is close agreement between the calculated and measured concentrations of suspended load at huayuankou and gaocun with the corresponding correlation degrees of 0 91 and 0 49 the calculated maximum sediment concentration at huayuankou was 458 kg m3 about 16 less than the measured value 546 kg m3 in july fig 8a while the calculated maximum concentration 510 kg m3 was higher than the measured value 437 kg m3 in august the maximum sediment concentration at gaocun reduced owing to the downstream sedimentation during the hyperconcentrated flood events as shown in fig 8b fig 7b shows a comparison between the measured concentration hydrograph at gaocun during the first flood peak and the corresponding calculated hydrographs using the coupled and uncoupled solution approaches the model predicted maximum concentration s 400 kg m3 at gaocun based on the coupled approach agreed better with the measurement s 405 kg m3 as compared with the calculation s 358 kg m3 based on the uncoupled approach however the model predicted occurrence times of peak concentration based on the coupled and uncoupled approaches delayed slightly for about 26 32 h as compared with the measured occurrence time in the lyr the non uniform suspended sediment is usually divided into three size fractions covering fine sediment with the diameter d less than 0 025 mm medium sediment with d 0 025 0 050 mm and coarse sediment with d 0 050 mm fig 9 shows comparisons between the calculated and measured graded sediment concentrations at jiahetan as an example it can be seen from this figure that the suspended sediment concentrations for the fine or coarse fraction fig 9a and c were higher than the values for the medium fraction fig 9b the maximum sediment concentrations for different fractions agreed well with the corresponding measurements during the july flood although the predicted peak concentrations slightly lagged behind the measured values and the calculated maximum concentrations for the fine and medium sediments in august were slightly greater than the corresponding measurements however the calculated maximum concentration for the coarse fraction 130 kg m3 closely agreed with the measured value 141 kg m3 therefore the model predicted concentration hydrographs of graded suspended sediments generally agreed well with the measurements especially for the coarse fraction a comparison between the observed maximum water levels and the corresponding values calculated based on the coupled approach is shown in fig 10 with close agreement between the levels being obtained it can be verified indirectly that the predicted channel evolution accorded with the actual evolution because the variation in water level was closely associated with the channel deformation in the study reach observed data indicate that significant channel deposition occurred during the 1977 flood caused by high sediment concentrations with the cumulative deposition amount of 7 30 108 tonnes using the calculation method of sediment discharge the model predicted deposition amount was 7 12 108 tonnes based on the coupled method which was in close agreement with the measurement 3 3 modelling of the 2004 hyperconcentrated flood 3 3 1 model setup for the 2004 hyperconcentrated flood the developed model was also used to simulate the morphodynamic processes in the braided reach during the august 2004 flood with high sediment concentrations the simulation period was 408 h starting from 20 august 2004 the hydrographs of discharge and sediment released from the xiaolangdi reservoir were used to specify the upstream boundary condition fig 11 a and a hydrograph of water level at gaocun was used to specify the downstream boundary condition it can be seen from this figure that the maximum discharge released from the xiaolangdi reservoir was less than 3000 m3 s with the maximum sediment concentration of 343 kg m3 fig 11b shows the mean size distribution of suspended load released from the reservoir with the median diameter of 0 008 mm during the flood event the study area covered the total braided reach of the lyr including 156 sedimentation sections between tiexie and gaocun the cross sectional profiles at these sections measured in july 2004 were taken as the initial topography statistic results of the channel geometry in the study reach show that the bankfull channel width ranged between 0 3 and 3 3 km with a mean bed level difference of 2 70 m between the main channel and the floodplain the size distributions of bed material were available at only 42 cross sections in this reach observed in july 2004 and the gradations of bed material at other sections were obtained by linear interpolation of these known bed material gradations at these sections fig 11b also indicates a mean size distribution of the bed material at the initial time 3 3 2 model results for the 2004 flood fig 12 indicates the calculated and measured discharge hydrographs at huayuankou and gaocun it can be seen from this figure that the floodwave propagation time between tiexie and gaocun predicted by the model was 47 4 h slightly greater than the measured value of 46 4 h and the simulated discharge hydrograph generally agreed with the measured process with the exception of the flood peak stage at huayuankou the calculated maximum discharge was 2816 m3 s during the hyperconcentrated flood 29 4 less than the measured value of 3990 m3 s fig 12a at gaocun the calculated maximum discharge 2637 m3 s was also less than the measured value of 3840 m3 s fig 12b there are lots of explanations to be presented for the reasons of peak discharge increase for such a case which mainly attributes the responsible mechanisms to changes in channel morphology or bed friction or to bed erosion related increasing water volume jiang et al 2006 li 2008 li et al 2014 for example jiang et al 2006 presented that the peak discharge increase was mainly due to a reduction in the bed roughness in the propagation of the hyperconcentrated flood carrying extra fine sediment particles released from the reservoir and this explanation was verified further by detailed numerical tests using a fully coupled morphodynamic model li et al 2014 however the proposed model in this study can not account for the effects of sediment concentration and bed material composition on the adjustment in bed roughness during the hyperconcentrated flood propagation and suitable bed roughness prediction formulae are required for further studies on the issue of peak discharge increase in the braided reach comparisons between the calculated and measured sediment concentration hydrographs at huayuankou and gaocun are shown in fig 13 it can be seen from fig 13a that the calculated concentration hydrograph closely agreed with the measured process at huayuankou and the calculated maximum sediment concentration was 349 kg m3 slightly less than the measured value of 353 kg m3 at gaocun the predicted concentration hydrograph generally agreed with the measured hydrograph fig 13b with the calculated maximum sediment concentration 288 kg m3 being greater than the corresponding measured value 199 kg m3 this large difference between the calculated and measured maximum concentrations was due to the fact that the calculated volume of channel scour was relatively high while the deposition process actually occurred in the subreach between huayuankou and jiahetan fig 14 a shows comparisons between the calculated and measured graded suspended concentrations at huayuankou during the august 2004 flood the mean concentration for the fine suspended sediment was relatively high as compared with the mean concentration for the medium or coarse fraction the calculated concentration hydrograph for each fraction agreed well with the corresponding observed process with the correlation degrees between them of 0 93 0 66 and 0 93 for the fine medium and coarse sediment fractions respectively the calculated maximum concentrations for these three fractions were 217 35 and 80 kg m3 respectively and these results were in close agreement with the corresponding measured values of 237 39 and 77 kg m3 in addition the calculated occurrence time for the peak concentration agreed well with the measured time for each sediment fraction fig 14b shows comparisons between the calculated and measured graded suspended concentrations at gaocun and the peak concentration was over predicted for each sediment fraction it should be noted that the division method for the fine medium and coarse sediment fractions is slightly different from the approach in the 1977 hyperconcentrated flood because of a change in field instruments used for measuring sediment gradation hydrological measurements indicate that the 2004 hyperconcentrated flood mainly propagated along the main channel of the braided reach which caused a considerable scour process especially in the reach upstream of huayuankou based on the method of sediment discharge the calculated cumulative scour amount was 11 0 million tonnes mt in the braided reach greater than the measured value of 7 0 mt in the subreach upstream of huayuankou the calculated cumulative scour amount of 17 2 mt generally agreed with the measured value of 13 2 mt in the subreach between jiahetan and gaocun the calculated cumulative deposition amount 3 0 mt was in close agreement with the measurement 3 1 mt however there was a significant difference between the calculated and measured channel evolution amount in the subreach between huayuankou and jiahetan and the calculated channel scour amount was 1 3 mt while the measured deposition amount was 7 2 mt based on the calculation method of sediment discharge 4 discussion 4 1 effect of different cross sectional spacings selection of a suitable set of cross sections for the representation of channel topography of an alluvial river is important for the accuracy of 1d morphodynamic models castellarin et al 2009 and hudson et al 2012 respectively investigated the effects of different cross section spacings on the model predictions using 1d hydrodynamic models previous 1d morphodynamic models mainly focus on detailed numerical solution schemes and treatments of empirical relationships that describe resistance to flow and turbulence julien 2002 however there are few guidelines for selecting the most suitable distance between two cross sections therefore the effect of different cross sectional spacings was investigated herein on the process of flow and sediment transport and the associated process of channel evolution based on various numerical tests of the 2004 flood event in the braided reach profiles at sedimentation sections are surveyed regularly to calculate the volume of channel evolution in the lyr xia et al 2010a since the early 1950s repeated profile surveys of sedimentation sections in the lyr have been conducted twice a year prior to and after the flood season from july to october wu et al 2008b the total number of sedimentation sections in the braided river varied during different periods and it was initially about 28 before the operation of the xiaolangdi reservoir with a mean distance of about 10 4 km between two consecutive sections after the reservoir operation in 1999 the number of sedimentation sections was refined for monitoring accurately the process of channel evolution and the total number of surveyed sections increased gradually with the final number of sections reaching 156 before the 2004 flood season and with a mean cross sectional distance of about 2 2 km in order to investigate the effect of different cross sectional spacings on the model results various numerical tests of the 2004 flood event were conducted based on different cross section numbers of 156 132 98 72 42 and 28 to represent the channel topography in the braided reach with the average cross sectional spacing ranging between 2 0 and 10 4 km labeled as the cases of from t 156cs to t 28cs the selection of cross section number for each case followed such a rule that the spacing between two consecutive sections changed little along the reach various model predictions were then compared with the corresponding measurements and the foregoing model results based on the 156 cross sections it is noted that the same empirical coefficients and relations were used in these numerical tests covering the non equilibrium adaption coefficient the sediment transport capacity and the manning roughness coefficients for the main channel and floodplain zones table 2 shows the maximum discharges water levels and concentrations at three hydrometric sections of huayuankou jiahetan and gaocun as well as the cumulative volumes of channel evolution in different subreaches under various numerical tests the effect of different cross sectional spacings on the simulated peak discharge is relatively limited as shown in table 2 and the errors between the maximum discharges obtained from the cases of t 28cs and t 156cs are 3 76 6 84 and 9 00 at these hydrometric sections respectively with the corresponding errors in the maximum water levels being 0 30 m 0 05 m and 0 00 m different cross sectional spacings can lead to a considerable effect on the simulated hydrograph of sediment concentration and the calculated maximum concentration at these hydrometric sections can increase with a refined cross sectional distance for example the calculated maximum concentration at huayuankou was 322 kg m3 for the t 156cs case 34 higher than the value for the t 28cs case table 2 also shows that different cross sectional spacings had a significant effect on the calculated cumulative amount of channel evolution in each subreach the total cumulative amount of channel evolution in the study reach shows channel aggradation for the t 28cs or t 72cs case which can not agree with the measured results of channel degradation in terms of this case suitable cross sectional spacing of less than 3 0 km or cross section number greater than 98 can guarantee the accuracy of the calculated cumulative volume of channel evolution the above analysis shows that various cross sectional spacings can produce different model predictions in this case study an increase or reduction in the number of cross sections for the representation of channel topography leads to a limited variation in the simulated peak discharges or maximum water levels however various cross sectional spacings can influence significantly the processes of sediment transport and channel deformation when simulating hyperconcentrated floods in the braided reach using the proposed morphodynamic model 4 2 effect of different allocation modes for the area of channel evolution different lateral allocation modes for the area of channel evolution update the bed levels at nodes of a cross section based on the specified allocation methods and influence further the calculated section average flow and sediment variables as well as the cumulative volume of channel evolution in order to investigate the effect of different lateral allocation modes on the calculated morphodynamic processes numerical tests of the 1977 hyperconcentrated flood occurring in the braided reach were conducted based on the aforementioned three allocation modes table 3 indicates the maximum discharges water levels and concentrations at three hydrometric sections under three modes of lateral allocation in terms of the maximum water level the effect of different allocation modes was negligible with the maximum difference in the calculated maximum levels being 0 01 m however three different modes of lateral allocation for the area of channel evolution could cause a significant influence on the calculated peak discharges at the hydrometric station of gaocun as an example the peak discharge calculated using md1 was 2982 m3 s higher than the value calculated using md2 or md3 as compared with the measured peak discharges at these hydrometric sections the calculated results using md1 generally agree better with the measurements than using md2 or md3 in terms of the calculated maximum sediment concentrations the effect of different allocation modes was considerable the maximum concentrations at three hydrometric sections were over predicted using md2 or md3 with the calculated maximum concentration at gaocun 301 or 268 kg m3 being greater than the corresponding measured value 160 kg m3 in general the maximum concentrations calculated using md1 agree better with the measurements as compared with the model results using md2 or md3 table 3 also indicates the cumulative amounts of channel evolution in different subreaches under different allocation modes of channel evolution area the cumulative amounts of channel evolution calculated using md3 were 4 97 1 93 and 0 66 108 tonnes in three sub reaches which were much greater than the corresponding measurements of 2 23 1 91 and 1 23 108 tonnes the cumulative amount of channel evolution in the braided reach calculated using md2 was 5 95 108 tonnes about 10 80 higher than the measured channel evolution amount 5 37 108 tonnes therefore different allocation modes of channel evolution area can influence greatly the cumulative amount of channel evolution in the study reach with the results calculated using md1 agreeing better with the measurements 5 conclusions hyperconcentrated sediment laden floods often occur during flood seasons in the braided reach of the lyr during these floods extreme high water levels and strong channel evolution often occur in local regions which may endanger the safety of flood control infrastructure a one dimensional morphodynamic model based on a coupled solution approach was used to simulate the processes of floodwave propagation and channel deformation caused by two hyperconcentrated floods occurring in the braided reach the conclusions obtained from this study are as follows i a coupled 1d morphodynamic model was developed to simulate hyperconcentrated flood and channel evolution in a braided reach with an extremely irregular cross sectional geometry in this model the governing equations for the hydrodynamics are modified with the terms of sediment concentration and bed evolution being directly included in the hydrodynamic equations these equations are coupled with the non equilibrium transport equation for graded suspended sediments and the equation of bed evolution with the hydrodynamic sediment transport and morphological variables being obtained simultaneously the model was first applied to simulate the 1977 hyperconcentrated flood occurring in the braided reach with field measured data for discharge and total and graded sediment concentrations at hydrometric sections being used to calibrate the model it was then used to reproduce the hydrographs of discharge and sediment concentration in the 2004 hyperconcentrated flood again using field measured data to verify the model close agreement was generally obtained between the observed data and model predictions using the coupled solution ii the validated model was used to simulate the 2004 hyperconcentrated flood for six scenarios with different cross sectional spacings with the effect of different space increments on the model results being investigated it was found that different space increments would influence the predicative accuracy of the morphodynamic model and the effect of different cross sectional spacings was relatively low in terms of predicting the discharges and water levels as compared with the effect on the calculated concentrations and channel evolution amounts it is suggested that a suitable cross sectional distance of less than 3 km should be adopted to simulate hyperconcentrated floods occurring in a braided reach using the coupled 1d morphodynamic model iii the proposed model was also used to simulate the 1977 hyperconcentrated flood in the braided reach based on different distribution modes of channel evolution area and the effect was investigated of different distribution modes on the model results it was found that the model results using the mode of uniform distribution of bed evolution area agreed better with the measurements as compared with the results obtained using two other allocation modes and the effect of different allocation modes was relatively small on the model predicted maximum water levels as compared with the effect on the calculated discharges concentrations and channel evolution amounts especially in the braided reach undergoing severe sediment deposition acknowledgements the study reported herein was supported partly by the program of the national key research and development plan grant no 2017yfc0405501 and it was also supported partly by supported by the national natural science foundation of china grant nos 51725902 51579186 and 51379156 the constructive suggestions of the anonymous reviewers are gratefully acknowledged 
7298,hyperconcentrated sediment laden floods often occur in a braided reach of the lower yellow river usually leading to significant channel evolution a one dimensional 1d morphodynamic model using a dynamically coupled solution approach is developed to simulate hyperconcentrated flood and channel evolution in the braided reach with an extremely irregular cross sectional geometry in the model the improved equations for hydrodynamics account for the effects of sediment concentration and bed evolution which are coupled with the equations of non equilibrium sediment transport and bed evolution the model was validated using measurements from the 1977 and 2004 hyperconcentrated floods furthermore the effects were investigated of different cross sectional spacings and allocation modes of channel deformation area on the model results it was found that a suitable cross sectional distance of less than 3 km should be adopted when simulating hyperconcentrated floods and the results using the uniform allocation mode can agree better with measurements than other two allocation modes keywords hyperconcentrated flood morphodynamic model coupled solution cross sectional spacing allocation mode of bed deformation area braided reach 1 introduction flood flows often carry very high concentration sediment during rainy seasons with the maximum sediment concentrations ranging from 200 to 800 kg m3 in the lower yellow river lyr with the characteristic diameter of suspended load d90 varying from 0 09 to 0 12 mm at the hydrometric station of huayuankou zhao et al 1998 where d90 is the sediment size for which 90 by weight of the material is finer these floods are also called hyperconcentrated sediment laden floods if the maximum sediment concentration exceeds 200 300 kg m3 zhang and xie 1993 wan and wang 1994 wang et al 2009 significant channel evolution in alluvial rivers associated with hyperconcentrated floods can give rise to many problems such as the hazard to various flood control infrastructure furthermore hyperconcentrated floods can cause unique fluvial processes in the braided reach of the lyr which has attracted the concern of scientists and engineers in the contexts of river dynamics and geomorphology wan and wang 1994 cao et al 2006 wang et al 2009 chien 1989 summarized the main results for the flocculation rheology properties fluvial hydraulics of hyperconcentrated flows and wan and wang 1994 described the detailed features of hyperconcentrated flows with the knowledge of mechanics of sediment transport being enriched in this field according to field measurements 16 hyperconcentrated flood events occurred in the lyr during the period from 1969 to 1989 and the sedimentation volume caused by these floods accounted for 82 of the total deposition volume in the lyr during the same period zhao et al 1998 xia et al 2010a these measurements also indicate that the deposition amount for the coarse sediment particles with the diameter greater than 0 10 mm accounted for 80 of the incoming sediment load and mainly occurred in the braided reach upstream of gaocun zhao et al 1998 therefore hyperconcentrated floods are one of main reasons that caused severe sedimentation in the lyr in addition extremely high water levels usually occur during hyperconcentrated floods which influence the safety of various river training works the flood water volume entering the lyr generally tends to decrease significantly owing to the development and utilization of water resources in the yellow river basin and the construction of large reservoirs in the upper yellow river the sediment load during a flood season also decreases because of strong human activities such as soil and water conservation with the extent of reduction in sediment amount being greater than that of water volume however the occurrence probability of hyperconcentrated sediment laden floods tends to increase during flood seasons in the lyr yao and xu 2013 fei and wu 2015 in terms of flood risk management it is essential to fully understand the characteristics of flood routing and the associated channel evolution during hyperconcentrated floods with physical and mathematical river models being two key approaches for such an investigation physical river models were used widely in the 1980s and 1990s to investigate the fluvial processes which played an important role in solving the sediment related problems in the lyr zhang and xie 1993 wan and wang 1994 with the rapid development of computer performance during the past four decades mathematical river models or morphodynamic models have become more popular due to their low cost flexibility in evaluating different effects of river training works and capability of delivering detailed predictions cao and carling 2002 van maren et al 2011 li et al 2014 one dimensional 1d and two dimensional 2d morphodynamic models have been increasingly developed to simulate hyperconcentrated floods as well as the fluvial processes involved zhang et al 2001 cao and carling 2002 zeng and beck 2003 ni et al 2004 cao et al 2006 wu and wang 2007 guo et al 2008 van maren et al 2011 he et al 2012 li et al 2014 2d morphodynamic models are widely used to simulate morphological changes in a local reach over a short period wu et al 2004 xia et al 2010b van maren et al 2011 in terms of modeling of bed deformation for a long reach over a long period 1d morphodynamic models are prevalent in practical engineering zhang et al 2001 guo et al 2008 he et al 2012 li et al 2014 two solution approaches are currently used in numerical models to simulate morphodynamic processes in alluvial rivers covering uncoupled and coupled solutions zhang and xie 1993 cao and carling 2002 xia et al 2010b in order to simulate morphodynamic processes caused by hyperconcentrated floods the second method may be more appropriate cao et al 2006 li et al 2014 although the first method is still used widely in practice for example zhang et al 2001 proposed a 1d model for simulating the morphodynamic processes in the lyr using the approach of uncoupled solution and special treatments were presented to calculate the sediment transport capacity and movable bed roughness coefficient ni et al 2004 guo et al 2008 proposed a 1d steady model to simulate the processes of sediment transport and bed deformation for both ordinary and hyperconcentrated flows in the lyr and the calculation of non equilibrium transport of graded suspended sediments was based on the theory proposed by han 1979 with the uncoupled solution also being used however the majority of previous models adopt an uncoupled solution for simulating hyperconcentrated floods without the effects of sediment concentration and bed evolution being included in the hydrodynamic governing equations zhang et al 2001 zeng and beck 2003 ni et al 2004 guo et al 2008 the uncoupled solution for morphodynamic models only applies to low rates of bed deformation in alluvial rivers which means that the variation in bed level within a time step is much less than the change of water level or depth with the term of bed evolution rate being neglected in the shallow water equations zhang and xie 1993 cao and carling 2002 wu 2007 in terms of modeling of rapid channel evolution caused by dam break flows or hyperconcentrated floods a fully coupled solution is often adopted in morphodynamic models for example cao et al 2004 and wu and wang 2007 respectively proposed 1d morphodynamic models to simulate dam break flood routing using the coupled solution cao et al 2006 also developed a 1d morphodynamic model to reveal new insights into the phenomena of bed tearing scour and river blockage during hyperconcentrated floods in the yellow river recently li et al 2014 adopted a fully coupled 1d morphodynamic model to investigate the phenomenon of peak discharge increase over hyperconcentrated floods occurring in a sketched erodible channel with a constant width and uniform bed material composition and it was found that the downstream discharge increase must be mainly due to a reduction in bed friction during peak discharge periods for most cases however the application of these coupled models is usually restricted to 1d water sediment mixtures in an idealised channel with rectangular cross sections it should be noted that the coupling interaction between flow sediment transport and bed evolution during hyperconcentrated floods is more complicated in natural alluvial rivers with irregular bed topography in this study a coupled 1d morphodynamic model has been developed to simulate the fluvial processes caused by hyperconcentrated floods in the braided reach of the lyr with irregular cross sectional geometry in the model the improved 1d hydrodynamic module is coupled with the modules of sediment transport and bed evolution to predict simultaneously the hydrodynamics sediment concentrations and morphological changes the developed model was applied to simulate the morphodynamic processes caused by two typical hyperconcentrated floods occurring in the braided reach and the model predictions were generally compared well with the observed data including the hydrographs of discharge and graded suspended sediment concentrations at several hydrometric sections and the cumulative volume of bed deformation in addition the effects were investigated of different cross sectional spacings and allocation modes of bed evolution area on the model results 2 coupled 1d morphodynamic model measurements of hyperconcentrated flows occurring in the lyr zhao et al 1998 indicate that i the percentage of coarse particles increases obviously with the total sediment concentration varying from 200 to 900 kg m3 and however the percentage of fine particles with the diameter less than 0 01 mm increases slightly ranging between 30 and 60 kg m3 and ii the non newtonian hyperconcentrated flows can not occur in the lyr because of coarse sediment composition and low flow velocity although the maximum sediment concentration can vary from 800 to 900 kg m3 during a hyperconcentrated flood occurring in the lyr the flow pattern of such a floodwater still belongs to a kind of intensively turbulent flow in newtonian fluid instead of a kind of bingham fluid based on the observed data in the majority of hyperconcentrated floods the magnitude of bingham yield stress generally approaches to zero without the structure of flocculation owing to intensively turbulent characteristics in the lyr fei and zhu 1991 zhao et al 1998 therefore the common continuum equation is used to describe the transport of suspended load during hyperconcentrated floods a coupled 1d morphodynamic model is proposed herein to simulate the fluvial processes caused by hyperconcentrated floods in the braided reach with complex topography which consists of 1d unsteady hydrodynamic governing equations the non equilibrium transport equation for non uniform suspended load and the equation of bed evolution the standard saint venant equations for hydrodynamics were modified with the term of bed evolution rate and the term of spatial variation in sediment concentration being included it should be noted that sediment is often assumed to be a kind of continuous medium because the stochastically averaged properties of a group of sediment particles are mainly concerned in river dynamics wu 2007 two kinds of models two fluid model and diffusion model can be used to describe the water and sediment two phase flow based on this assumption however the two fluid model is not widely used in practice owing to its complexity therefore the sediment transport equation adopted herein is based on the diffusion model that considers the movement of sediment particles as a phenomenon of diffusion in a kind of continuous medium wu 2007 2 1 governing equations and numerical solution 2 1 1 modified 1d hydrodynamic equations the modified 1d hydrodynamic equations for the water sediment mixture in an alluvial river with an irregular cross sectional geometry can be written in the following form zhang and xie 1993 wu 2007 1 q x b z t q l a b t add 2 q t ga α f b q 2 a 2 z x 2 α f q a q x q 2 a 2 a x z gaj f ρ l q l u l ρ m 1 ρ m δ ρ ρ s q s t 1 ρ m δ ρ ρ s q 2 a gah c s x add where q discharge z water level a wetted cross sectional area b width of water surface s suspended load concentration a b cross sectional area of the bed above a reference datum g gravitational acceleration α f correction coefficient for flow momentum j f friction slope q l lateral inflow discharge per unit length of channel ρ l density of the lateral inflow u l velocity component of lateral inflow along the main flow direction δρ ρ s ρ f in which ρ f clear water density and ρ s sediment density ρ m density of water sediment mixture and h c submerged depth of the section centroid x longitudinal distance and t time main flow and morphodynamic variables are illustrated in fig 1 the additional term in eq 1 accounts for the effect of bed deformation on flow continuity which can also be interpreted as the contribution of sediment exchange between flow and bed to the mass conservation of the water phase the additional terms in eq 2 include the influence of the streamwise pressure gradient due to the varying sediment concentration and the momentum transfer from the sediment phase both of which can be regarded as the effects of sediment transport without these additional terms the above governing equations can be simplified to the standard saint venant equations widely used in the computational hydrodynamics 2 1 2 transport equation of suspended load in the current model the non equilibrium transport process of non uniform suspended load is described by the following equation 3 t as k x aus k b ω k α k s k s k s lk q l where sk s k concentration and transport capacity for the kth fractional sediment slk lateral inflow sediment concentration αk non equilibrium adaption coefficient and ωk effective settling velocity the formula of effective settling velocity ω k in muddy water proposed by zhang et al 2001 is used in this model and it can be expressed by ω k ω 0 k 1 s v 2 25 d 50 3 5 1 1 25 s v where ω 0 k settling velocity for the kth sediment fraction in clear water sv volumetric total sediment concentration for all fractions and d50 median diameter of the suspended sediment in mm ω 0 k can be calculated by the unified formula for three settling regions of natural sediment particles zhang and xie 1993 the sediment settling velocity decreases with an increase in sediment concentration because of hindered settling the coefficient αk is an important parameter in morphodynamic models and the value for erosion is larger than that for deposition han and chen 2008 however it becomes a type of comprehensive coefficient which needs to be calibrated by observed data several empirical methods were proposed in the literature for determining the value of αk with a significant difference existing among these methods zhou and lin 1998 cao et al 2004 guo et al 2008 it is found that if the same αk value is used for all the size fractions then the amount of coarser sediment eroded from the bed is greater than that of the finer fraction during the process of bed degradation this causes the composition of bed material to become finer rather than getting coarser which is physically incorrect xia et al 2010b in order to avoid this different values of αk are usually set for different fractions in the present study the following empirical relation is used to determine αk wang and xia 2001 xia et al 2010b 4 α k β ω k 0 3 s k s k β ω k 0 7 s k s k where β is a case dependent coefficient which is usually set at 0 001 xia et al 2010b in the calculation of sediment transport the proposed module does not include the simulation of bed load transport because the transport of suspended load in the lyr is fairly dominant according to the analysis of observed data by long and zhang 2002 the average ratio of bed load to total load of sediment in the lyr is only about 0 5 therefore the transport of bed load is often ignored and only the transport of suspended load is considered in the model 2 1 3 equation of bed evolution the equation for the area of bed evolution can be written as 5 ρ δ a b δ t k 1 n b ω k α k s k s k in which δa b total area of bed deformation at a section in one time step of δ t ρ dry density of bed material and n total number of graded sediments 2 1 4 setup for boundary and initial conditions the boundary conditions used in this model include two types i e inlet upstream and outlet downstream boundaries at the inlet boundary the observed time series of discharge and graded sediment concentrations are usually specified at the outlet boundary the rating curve between stage and discharge or the observed time series of water level is often adopted cross sectional profiles at a number of sites measured before a flood season are used to represent the initial topography in a study reach the numerical model is usually required to be run for a sufficiently long time or a spin up period without topography updating to achieve a steady state under the given inflow discharge and graded sediment concentrations at the upstream boundary and the given water level at the downstream boundary these steady state results are then specified as the initial conditions of flow and sediment transport in the study reach 2 1 5 numerical solution in a 1d numerical model a study reach usually covers a limited number of cross sections and the section averaged variables of flow and sediment need to be obtained through solving the corresponding governing equations if the sediment concentration in an alluvial river is relatively low and the rate of bed evolution is very slow as compared with the rate of flow variation the right side two terms in eqs 1 and 2 can be neglected the hydrodynamic governing equations for the water sediment mixture can be simplified into the common saint venant equations however significant bed evolution usually occurs during hyperconcentrated floods and the additional terms in eqs 1 and 2 need to be considered in the governing equations the classical preissmann scheme is widely used in river dynamics although nowadays the godunov type scheme becomes more popular for its capability of shock capturing and dealing with transcritical flows toro 1998 the preissmann scheme still has its superiority in practice this implicit finite difference scheme is unconditionally stable and extremely robust in the situation where no transcritical flow appears the accuracy of preissmann type is not lower than that of the godunov type scheme savic and holly 1993 most flood flows in alluvial plain rivers are subcritical and the use of the preissmann scheme is fairly enough to achieve successful simulations in this study the hydrodynamic governing equations for the water sediment mixture are solved using the preissmann implicit scheme in this scheme the weighting factor is set at 0 65 for the temporal derivative wu 2007 and it is set at 0 5 for the spatial derivative in order to satisfy the requirement of numerical stability suggested by venutelli 2002 the resulting nonlinear equations are solved using the double sweep algorithm with more solution details being presented in julien 2002 or wu 2007 in terms of the calculation of sediment transport for each fraction the scheme of explicit upwind difference is adopted for eq 3 however this scheme is highly diffusive and it can be refined in the future using the ultimate quickest scheme lin and falconer 1997 the equation of bed evolution is solved using the scheme of explicit difference 2 2 treatments of key parameters and problems 2 2 1 sediment transport capacity the model uses an empirical formula for calculating sediment transport capacity based on the gravitational energy concept proposed by zhang and zhang 1992 this formula is widely used to compute the sediment transport capacity in the lyr zhang et al 2001 ni et al 2004 which can be expressed by 6 s 2 5 0 0022 s v u 3 κ gh ω m γ s γ m γ m ln h 6 d 50 0 62 where γs and γm denote the specific weights of sediment and turbid water respectively κ von karman coefficient in muddy water expressed by a function of sv with κ 0 4 1 68 s v 0 365 s v ωm group settling velocity of non uniform suspended load which can be written as k 1 n δ p k ω k where δp k percentage of the sediment transport capacity for the kth grain size fraction and d 50 median diameter of the bed material the accuracy of this formula has been validated through a series of field and laboratory data and fig 2 a shows that the results calculated by eq 6 can agree closely with the observed data these observed data were mainly from the measurements at various hydrometric stations in the lyr wu et al 2008a with the flow velocities ranging from 0 3 to 3 1 m s and with the water depths ranging from 0 6 to 11 3 m the percentage of the sediment transport capacity for the kth size fraction δ p k also needs to be determined in this study the approach by li 1987 is used to calculate δ p k this formula directly adopts flow parameters and the gradation of bed material to determine the fractional sediment transport capacity and its detailed description can be found in zhang and xie 1993 fig 2b d indicate comparisons between the graded sediment transport capacity calculated by eq 6 and the corresponding measured concentrations for three fractions the calculated concentrations are greatly underpredicted for the size fraction of d 0 025 mm fig 2b while they are significantly overestimated for the fraction of d 0 050 mm fig 2d for the size fraction of d 0 025 0 050 mm the calculated concentrations generally agree well with the observed data as shown in fig 2c the large difference between the calculated and measured concentrations for the fine or coarse fraction fig 2b or 2d can be explained as follows firstly measured suspended sediment concentrations used to validate eq 6 were selected under a rough equilibrium transport state of the total sediment and it could not guarantee that the graded sediment transport was in equilibrium state secondly the method to calculate the gradation of sediment transport capacity can not account for the effect of inflow sediment composition therefore it is necessary to enhance the accuracy of the formula for the graded sediment transport capacity in the future study the variation of sediment transport capacity caused by the adjustment in bed material composition is considered by a computation procedure that updates the size distribution of bed material after each time step wang et al 2008 2 2 2 selection of bed roughness coefficient the magnitude of the manning roughness coefficient is found to be quite large during low discharges with the highest value of more than 0 045 being measured in the lyr chien and wan 1999 following an increase in discharge the coefficient gradually decreases and approaches a minimum value of 0 007 0 010 chien and wan 1999 pointed out that the variation in manning roughness coefficient is closely related to the development of bedforms in the lyr however 1d morphodynamic models can output the cross section averaged variables of flow and sediment and the lumped area in bed evolution at each section and can not provide the details of bedform development therefore it is impossible to present an accurate estimation of bed roughness coefficients using the 1d model predictions in practice bed roughness coefficients at a hydrometric section are usually back calculated under different discharges according to the observed discharge processes guo et al 2008 he et al 2012 the discharge roughness curves at other cross sections can be interpolated according to these measured curves at hydrometric sections the lyr is famous for the secondary perched reach occurring in some local regions which means that the mean bed level of the river channel is higher than that of the floodplain and the latter is higher than the elevation of levee back side xia et al 2010a fig 3 shows a cross sectional profile in such a typical reach in the late 1990s represented by the profile at chanfang measured at the end of the 1999 flood season it is found that the main channel zone of this section was closely restricted by local farm dikes and the mean level of the river channel 72 3 m was higher than that of the floodplain 71 1 m it should be noted that bed roughness coefficients in the main channel zone and on the floodplain zone should be treated separately at some cross sections in the secondary perched reach the former can be calculated using the calibrated discharge roughness curves and the latter can be regarded as constant values with the manning roughness coefficients ranging from 0 035 to 0 045 for the floodplain zone the zone of the main channel is distinguished from that of the floodplain by visual identification of the floodplain lip at a cross section in the perched reach and it is assumed to be flooded preferentially in the computation moreover the roughness coefficients under different discharges at a section can be adjusted slightly if the degree of bed evolution is relatively large 2 2 3 lateral allocation of channel evolution area 1d morphodynamic models are usually used to simulate the flow and sediment transport in the streamwise direction of an alluvial river without solving the details over the cross section wu 2007 as shown in eq 5 the 1d model provides only the lumped area in bed deformation δa b at each section over a given time step and δa b needs to be allocated approximately to the local variation in bed level at each node δz bj along the cross section in order to acquire a reasonable prediction for the long term morphological evolution in a study reach the obtained δz bj is then used to update the cross sectional geometry wu 2007 the proposed model can account for several methods to allocate laterally the area of channel evolution the first allocation method adopted in this model is the uniform distribution of bed evolution area along the cross section which is widely used in 1d modeling of bed deformation caused by the non equilibrium transport of suspended load the detailed allocation mode depends on the scenario of deposition or erosion wu 2007 guo et al 2008 he et al 2012 for the case of bed deposition the deposition material is uniformly allocated to the wetted perimeter of a cross section because the suspended load concentration tends to be relatively uniform along the cross section for the case of bed erosion it is assumed that erosion occurs only in the main channel zone because bed scour can not occur on the floodplain zone owing to large bed roughness and low flow velocity and the bed levels are lowered uniformly at submerged nodes of the main channel zone the second allocation method distributes the area of deposition and erosion along the section based on a power function of the difference between the sediment concentration and sediment transport capacity and the third method allocates the area of bed evolution by a power function of excess shear stress the details for these allocation methods are given in wu 2007 these three allocation modes are specified as md1 md2 and md3 in the following analysis cross sections in the braided river are generally very wide and shallow in geometry and however a suitable identification method is available to determine the bankfull level and main channel zone the level of the lip top of an active floodplain is usually defined as the bankfull level at a section in terms of flood control and the main passage between the two lips of the active floodplains on both sides is often defined as the zone of the main channel xia et al 2010a 2014 therefore the allocation methods presented in this study can be used to the braided reach with the physical fundamentals being included 3 model validation using two hyperconcentrated flood events in this section a description of the study reach is outlined briefly the measurements obtained from two hyperconcentrated sediment laden floods in 1977 and 2004 in the lyr were used to validate the coupled 1d morphodynamic model proposed herein 3 1 description of study reach the yellow river is the second longest river in china with a drainage area of 795 000 km2 fig 4 a the average annual natural runoff of the yellow river is normally 58 billion m3 and the average annual suspended sediment load is 1 6 billion tonnes ranking it first of all the world s rivers in terms of sediment load li 2003 wu et al 2008b the average suspended sediment concentration was 30 kg m3 measured at the station of xiaolangdi from 1951 to 1970 with the maximum concentration of 941 kg m3 being measured on 8 august 1977 the majority of the sediment load comes from flood flows in summer and the particle sizes vary from silt to fine sand with a median diameter of about 0 030 mm the lower yellow river has a length of about 786 km as it flows from mengjin toward the sea passing ne across the north china plain as shown in fig 4b the lyr is usually divided into three geomorphologically distinct reaches the upper reach from mengjin to gaocun has a typical braided channel pattern the lower reach from taochengpu to lijin is a well restricted and stable meandering river reach the river reach lying between gaocun and taochengpu has a transitional channel pattern from braided to meandering the lyr is a naturally aggrading river because of the high suspended load it carries however significant channel degradation occurs in the lyr owing to the operation of the xiaolangdi reservoir after 1999 according to the observed data the total deposition volume in the lyr reached about 5 52 billion m3 during the period from 1950 to 1999 of which 60 was deposited in the braided reach upstream of gaocun the braided reach has a wide and shallow channel geometry based on the measurements conducted in 1999 with an average main channel width of 580 3380 m and a relatively steep longitudinal channel slope of 1 9 104 and with numerous central bars and complex branches exposed during low discharges in a narrow subreach with a short stream length the natural clay spurs or artificial bank protection works constrain the channel shifting which causes a narrow channel to be formed during a flood season significant bed deformation and shifting of the main stream often occur in the braided reach therefore it is necessary to predict accurately the processes of hyperconcentrated flood routing and the associated morphological changes in the braided reach in terms of flood risk management in order to save the computer time various efforts were made to introduce simplifications in the numerical solution of the governing equations for the 1d morphodynamic models one of the major simplifications is that a coupled solution could be approximated by an uncoupled solution which means that the effects of bed evolution and sediment transport are not considered in the hydrodynamic governing equations zhang et al 2001 ni et al 2004 such a simplification is appropriate generally for floods with low sediment concentrations and slight bed deformation rates zhang and xie 1993 previous observed data indicate that rapid rates of bed evolution usually occur during hyperconcentrated floods in the lyr and the approximation of an uncoupled solution is not applicable to these cases table 1 shows the observed discharge processes at huayuankou during two hyperconcentrated floods from the published hydrological yearbooks through analysing these observed data the difference can be revealed between the rates of water level change and bed level variation case i represents a scenario where serious bed deposition occurred during the 1977 hyperconcentrated flood the time interval δt between two consecutive measurements was relatively short the observed water level decreased from 91 53 to 91 46 m over less than one day with a slight decrease magnitude of water level δz of 0 07 m during the same period the mean bed level increased from 88 96 to 89 42 m with an increase in bed level δz b of 0 46 m therefore the rate of bed evolution during the short period can be calculated by δ z b δ t while the rate of water level change can be obtained by δ z δ t it is obvious that the value of δ z b δ t was much greater than that of δ z δ t for the case of bed deposition during the flood event case ii represents another scenario where serious bed scour occurred during the 2004 hyperconcentrated flood it can be obtained from this table that the increase magnitude of water level δz was 0 14 m over about one day with the corresponding decrease magnitude of bed evolution being 0 51 m the rate of bed evolution was much higher than that of water level change for the case of bed scour the investigation into observed discharge processes confirms that the approach of uncoupled solution is not satisfactory for simulating hyperconcentrated floods in the braided reach of the lyr 3 2 modelling of the 1977 hyperconcentrated flood 3 2 1 model setup for the 1977 hyperconcentrated flood the regime of the flow and sediment entering the lyr in 1977 was characterized by a hydrological sequence of middle water flows and high sediment concentrations with two hyperconcentrated flood events occurring in july and august observed data show that the flood runoff in july was mainly from the rainfall zone of the tributaries of the wei river the north luo river and the yanshui river as shown in fig 4a the maximum discharge was 8100 m3 s at the hydrometric station of huayuankou in the lyr with a maximum sediment concentration of 546 kg m3 the flood runoff in august was mainly from the rainfall region between the pianguan river and the tuwei river and the maximum discharge reached 10800 m3 s at huayuankou with a maximum sediment concentration being 809 kg m3 the coarsest diameter of the suspended load was 0 070 mm in these two flood events the 1977 hyperconcentrated flood events led to the occurrence of deposition on the floodplain and scour in the main channel in the braided reach but the total volume of deposition on the floodplain was greater than that of scour in the main channel the simulation zone covered the total braided reach of the lyr with a length of about 284 km between tiexie and gaocun including 28 sedimentation sections the cross sectional profiles at 28 sections measured before the 1977 flood season were taken as the initial topography the hydrographs of discharge and sediment concentration at xiaolangdi measured during the 1977 flood events were used as the upstream boundary condition fig 5 a and the measured hydrograph of water level at gaocun was used to specify the downstream boundary condition in addition the flow and sediment regimes were treated as the lateral inflow conditions from two tributaries of the yiluo and qin rivers located downstream of the xiaolangdi dam as compared with the water volume entering this reach the volume of water diversion during the period was negligible in this reach and therefore the process of water diversion was not accounted for the simulation period was from 14 june to 15 september 1977 with a total simulation time of 2232 h in the current case the time step used was 20 s fig 5b shows a mean size distribution of the suspended load at xiaolangdi over the study period with the mean median diameter of 0 028 mm at this section the gradation of incoming suspended load was used to determine the fractional sediment concentrations at the upstream boundary the data for the bed material composition in this reach observed in april 1977 were available at only 4 cross sections and the size distributions of bed material at other sections were obtained by linear interpolation of these known bed material gradations at these sections fig 5b also indicates a mean size distribution of the bed material in this reach at the initial time it can be seen from fig 5b that the size distributions for both suspended load and bed material were non uniform with the particle sizes ranging from 0 002 to 0 500 mm in this study eight size fractions were used to represent the non uniform sediment mixture with the corresponding representative diameters ranging from 3 7 to 353 6 μm at the initial time the mean median diameter of the bed material was 0 116 mm in this reach which was coarser than that of the suspended load at xiaolangdi 3 2 2 model results for the 1977 hyperconcentrated flood in this study the proposed coupled 1d model was used to reproduce the processes of floodwave propagation and bed deformation during the july and august hyperconcentrated flood events in 1977 calculated results for the 1977 flood events indicate that the value of the additional right side term in eq 2 was much less than the friction term gajf and the effect of this additional term was very limited in terms of a specified flood event however the magnitude of the additional right side term ab t was equivalent to the value of b z t in eq 1 with the former being greater than the latter at specified times in general the additional right side terms in the governing equations for the water sediment mixture in an alluvial river had a definite influence on the model results for these hyperconcentrated floods fig 6 shows comparisons between the model predicted and field observed discharge hydrographs at two sections of huayuankou and gaocun with the corresponding correlation degrees between these hydrographs of 0 83 and 0 64 at huayuankou the calculated maximum discharge was 7544 m3 s in july fig 6a about 7 less than the measured value 8100 m3 s and the model underestimated the second peak discharge in august with the predicted maximum discharge of 8490 m3 s being lower than that observed 10800 m3 s at gaocun the calculated discharge hydrograph generally agreed with the measured value especially during the august flood event fig 6b however the predicted discharges during the period 660 720 h were generally less than the corresponding measurements and it was regarded that improper selection of bed roughness coefficients led to this big difference especially with large roughness values being used during this period the model predicted time of floodwave propagation between tiexie and gaocun was 26 h during the july flood event which was slightly greater than the measured time 23 h the discharge hydrograph during the second flood peak calculated using the coupled solution agrees better with the measured discharges at gaocun as compared with the results obtained using the uncoupled solution fig 7 a therefore it is concluded that the proposed coupled model can simulate accurately the hyperconcentrated flood routing in the braided reach with complex topography as shown in fig 8 there is close agreement between the calculated and measured concentrations of suspended load at huayuankou and gaocun with the corresponding correlation degrees of 0 91 and 0 49 the calculated maximum sediment concentration at huayuankou was 458 kg m3 about 16 less than the measured value 546 kg m3 in july fig 8a while the calculated maximum concentration 510 kg m3 was higher than the measured value 437 kg m3 in august the maximum sediment concentration at gaocun reduced owing to the downstream sedimentation during the hyperconcentrated flood events as shown in fig 8b fig 7b shows a comparison between the measured concentration hydrograph at gaocun during the first flood peak and the corresponding calculated hydrographs using the coupled and uncoupled solution approaches the model predicted maximum concentration s 400 kg m3 at gaocun based on the coupled approach agreed better with the measurement s 405 kg m3 as compared with the calculation s 358 kg m3 based on the uncoupled approach however the model predicted occurrence times of peak concentration based on the coupled and uncoupled approaches delayed slightly for about 26 32 h as compared with the measured occurrence time in the lyr the non uniform suspended sediment is usually divided into three size fractions covering fine sediment with the diameter d less than 0 025 mm medium sediment with d 0 025 0 050 mm and coarse sediment with d 0 050 mm fig 9 shows comparisons between the calculated and measured graded sediment concentrations at jiahetan as an example it can be seen from this figure that the suspended sediment concentrations for the fine or coarse fraction fig 9a and c were higher than the values for the medium fraction fig 9b the maximum sediment concentrations for different fractions agreed well with the corresponding measurements during the july flood although the predicted peak concentrations slightly lagged behind the measured values and the calculated maximum concentrations for the fine and medium sediments in august were slightly greater than the corresponding measurements however the calculated maximum concentration for the coarse fraction 130 kg m3 closely agreed with the measured value 141 kg m3 therefore the model predicted concentration hydrographs of graded suspended sediments generally agreed well with the measurements especially for the coarse fraction a comparison between the observed maximum water levels and the corresponding values calculated based on the coupled approach is shown in fig 10 with close agreement between the levels being obtained it can be verified indirectly that the predicted channel evolution accorded with the actual evolution because the variation in water level was closely associated with the channel deformation in the study reach observed data indicate that significant channel deposition occurred during the 1977 flood caused by high sediment concentrations with the cumulative deposition amount of 7 30 108 tonnes using the calculation method of sediment discharge the model predicted deposition amount was 7 12 108 tonnes based on the coupled method which was in close agreement with the measurement 3 3 modelling of the 2004 hyperconcentrated flood 3 3 1 model setup for the 2004 hyperconcentrated flood the developed model was also used to simulate the morphodynamic processes in the braided reach during the august 2004 flood with high sediment concentrations the simulation period was 408 h starting from 20 august 2004 the hydrographs of discharge and sediment released from the xiaolangdi reservoir were used to specify the upstream boundary condition fig 11 a and a hydrograph of water level at gaocun was used to specify the downstream boundary condition it can be seen from this figure that the maximum discharge released from the xiaolangdi reservoir was less than 3000 m3 s with the maximum sediment concentration of 343 kg m3 fig 11b shows the mean size distribution of suspended load released from the reservoir with the median diameter of 0 008 mm during the flood event the study area covered the total braided reach of the lyr including 156 sedimentation sections between tiexie and gaocun the cross sectional profiles at these sections measured in july 2004 were taken as the initial topography statistic results of the channel geometry in the study reach show that the bankfull channel width ranged between 0 3 and 3 3 km with a mean bed level difference of 2 70 m between the main channel and the floodplain the size distributions of bed material were available at only 42 cross sections in this reach observed in july 2004 and the gradations of bed material at other sections were obtained by linear interpolation of these known bed material gradations at these sections fig 11b also indicates a mean size distribution of the bed material at the initial time 3 3 2 model results for the 2004 flood fig 12 indicates the calculated and measured discharge hydrographs at huayuankou and gaocun it can be seen from this figure that the floodwave propagation time between tiexie and gaocun predicted by the model was 47 4 h slightly greater than the measured value of 46 4 h and the simulated discharge hydrograph generally agreed with the measured process with the exception of the flood peak stage at huayuankou the calculated maximum discharge was 2816 m3 s during the hyperconcentrated flood 29 4 less than the measured value of 3990 m3 s fig 12a at gaocun the calculated maximum discharge 2637 m3 s was also less than the measured value of 3840 m3 s fig 12b there are lots of explanations to be presented for the reasons of peak discharge increase for such a case which mainly attributes the responsible mechanisms to changes in channel morphology or bed friction or to bed erosion related increasing water volume jiang et al 2006 li 2008 li et al 2014 for example jiang et al 2006 presented that the peak discharge increase was mainly due to a reduction in the bed roughness in the propagation of the hyperconcentrated flood carrying extra fine sediment particles released from the reservoir and this explanation was verified further by detailed numerical tests using a fully coupled morphodynamic model li et al 2014 however the proposed model in this study can not account for the effects of sediment concentration and bed material composition on the adjustment in bed roughness during the hyperconcentrated flood propagation and suitable bed roughness prediction formulae are required for further studies on the issue of peak discharge increase in the braided reach comparisons between the calculated and measured sediment concentration hydrographs at huayuankou and gaocun are shown in fig 13 it can be seen from fig 13a that the calculated concentration hydrograph closely agreed with the measured process at huayuankou and the calculated maximum sediment concentration was 349 kg m3 slightly less than the measured value of 353 kg m3 at gaocun the predicted concentration hydrograph generally agreed with the measured hydrograph fig 13b with the calculated maximum sediment concentration 288 kg m3 being greater than the corresponding measured value 199 kg m3 this large difference between the calculated and measured maximum concentrations was due to the fact that the calculated volume of channel scour was relatively high while the deposition process actually occurred in the subreach between huayuankou and jiahetan fig 14 a shows comparisons between the calculated and measured graded suspended concentrations at huayuankou during the august 2004 flood the mean concentration for the fine suspended sediment was relatively high as compared with the mean concentration for the medium or coarse fraction the calculated concentration hydrograph for each fraction agreed well with the corresponding observed process with the correlation degrees between them of 0 93 0 66 and 0 93 for the fine medium and coarse sediment fractions respectively the calculated maximum concentrations for these three fractions were 217 35 and 80 kg m3 respectively and these results were in close agreement with the corresponding measured values of 237 39 and 77 kg m3 in addition the calculated occurrence time for the peak concentration agreed well with the measured time for each sediment fraction fig 14b shows comparisons between the calculated and measured graded suspended concentrations at gaocun and the peak concentration was over predicted for each sediment fraction it should be noted that the division method for the fine medium and coarse sediment fractions is slightly different from the approach in the 1977 hyperconcentrated flood because of a change in field instruments used for measuring sediment gradation hydrological measurements indicate that the 2004 hyperconcentrated flood mainly propagated along the main channel of the braided reach which caused a considerable scour process especially in the reach upstream of huayuankou based on the method of sediment discharge the calculated cumulative scour amount was 11 0 million tonnes mt in the braided reach greater than the measured value of 7 0 mt in the subreach upstream of huayuankou the calculated cumulative scour amount of 17 2 mt generally agreed with the measured value of 13 2 mt in the subreach between jiahetan and gaocun the calculated cumulative deposition amount 3 0 mt was in close agreement with the measurement 3 1 mt however there was a significant difference between the calculated and measured channel evolution amount in the subreach between huayuankou and jiahetan and the calculated channel scour amount was 1 3 mt while the measured deposition amount was 7 2 mt based on the calculation method of sediment discharge 4 discussion 4 1 effect of different cross sectional spacings selection of a suitable set of cross sections for the representation of channel topography of an alluvial river is important for the accuracy of 1d morphodynamic models castellarin et al 2009 and hudson et al 2012 respectively investigated the effects of different cross section spacings on the model predictions using 1d hydrodynamic models previous 1d morphodynamic models mainly focus on detailed numerical solution schemes and treatments of empirical relationships that describe resistance to flow and turbulence julien 2002 however there are few guidelines for selecting the most suitable distance between two cross sections therefore the effect of different cross sectional spacings was investigated herein on the process of flow and sediment transport and the associated process of channel evolution based on various numerical tests of the 2004 flood event in the braided reach profiles at sedimentation sections are surveyed regularly to calculate the volume of channel evolution in the lyr xia et al 2010a since the early 1950s repeated profile surveys of sedimentation sections in the lyr have been conducted twice a year prior to and after the flood season from july to october wu et al 2008b the total number of sedimentation sections in the braided river varied during different periods and it was initially about 28 before the operation of the xiaolangdi reservoir with a mean distance of about 10 4 km between two consecutive sections after the reservoir operation in 1999 the number of sedimentation sections was refined for monitoring accurately the process of channel evolution and the total number of surveyed sections increased gradually with the final number of sections reaching 156 before the 2004 flood season and with a mean cross sectional distance of about 2 2 km in order to investigate the effect of different cross sectional spacings on the model results various numerical tests of the 2004 flood event were conducted based on different cross section numbers of 156 132 98 72 42 and 28 to represent the channel topography in the braided reach with the average cross sectional spacing ranging between 2 0 and 10 4 km labeled as the cases of from t 156cs to t 28cs the selection of cross section number for each case followed such a rule that the spacing between two consecutive sections changed little along the reach various model predictions were then compared with the corresponding measurements and the foregoing model results based on the 156 cross sections it is noted that the same empirical coefficients and relations were used in these numerical tests covering the non equilibrium adaption coefficient the sediment transport capacity and the manning roughness coefficients for the main channel and floodplain zones table 2 shows the maximum discharges water levels and concentrations at three hydrometric sections of huayuankou jiahetan and gaocun as well as the cumulative volumes of channel evolution in different subreaches under various numerical tests the effect of different cross sectional spacings on the simulated peak discharge is relatively limited as shown in table 2 and the errors between the maximum discharges obtained from the cases of t 28cs and t 156cs are 3 76 6 84 and 9 00 at these hydrometric sections respectively with the corresponding errors in the maximum water levels being 0 30 m 0 05 m and 0 00 m different cross sectional spacings can lead to a considerable effect on the simulated hydrograph of sediment concentration and the calculated maximum concentration at these hydrometric sections can increase with a refined cross sectional distance for example the calculated maximum concentration at huayuankou was 322 kg m3 for the t 156cs case 34 higher than the value for the t 28cs case table 2 also shows that different cross sectional spacings had a significant effect on the calculated cumulative amount of channel evolution in each subreach the total cumulative amount of channel evolution in the study reach shows channel aggradation for the t 28cs or t 72cs case which can not agree with the measured results of channel degradation in terms of this case suitable cross sectional spacing of less than 3 0 km or cross section number greater than 98 can guarantee the accuracy of the calculated cumulative volume of channel evolution the above analysis shows that various cross sectional spacings can produce different model predictions in this case study an increase or reduction in the number of cross sections for the representation of channel topography leads to a limited variation in the simulated peak discharges or maximum water levels however various cross sectional spacings can influence significantly the processes of sediment transport and channel deformation when simulating hyperconcentrated floods in the braided reach using the proposed morphodynamic model 4 2 effect of different allocation modes for the area of channel evolution different lateral allocation modes for the area of channel evolution update the bed levels at nodes of a cross section based on the specified allocation methods and influence further the calculated section average flow and sediment variables as well as the cumulative volume of channel evolution in order to investigate the effect of different lateral allocation modes on the calculated morphodynamic processes numerical tests of the 1977 hyperconcentrated flood occurring in the braided reach were conducted based on the aforementioned three allocation modes table 3 indicates the maximum discharges water levels and concentrations at three hydrometric sections under three modes of lateral allocation in terms of the maximum water level the effect of different allocation modes was negligible with the maximum difference in the calculated maximum levels being 0 01 m however three different modes of lateral allocation for the area of channel evolution could cause a significant influence on the calculated peak discharges at the hydrometric station of gaocun as an example the peak discharge calculated using md1 was 2982 m3 s higher than the value calculated using md2 or md3 as compared with the measured peak discharges at these hydrometric sections the calculated results using md1 generally agree better with the measurements than using md2 or md3 in terms of the calculated maximum sediment concentrations the effect of different allocation modes was considerable the maximum concentrations at three hydrometric sections were over predicted using md2 or md3 with the calculated maximum concentration at gaocun 301 or 268 kg m3 being greater than the corresponding measured value 160 kg m3 in general the maximum concentrations calculated using md1 agree better with the measurements as compared with the model results using md2 or md3 table 3 also indicates the cumulative amounts of channel evolution in different subreaches under different allocation modes of channel evolution area the cumulative amounts of channel evolution calculated using md3 were 4 97 1 93 and 0 66 108 tonnes in three sub reaches which were much greater than the corresponding measurements of 2 23 1 91 and 1 23 108 tonnes the cumulative amount of channel evolution in the braided reach calculated using md2 was 5 95 108 tonnes about 10 80 higher than the measured channel evolution amount 5 37 108 tonnes therefore different allocation modes of channel evolution area can influence greatly the cumulative amount of channel evolution in the study reach with the results calculated using md1 agreeing better with the measurements 5 conclusions hyperconcentrated sediment laden floods often occur during flood seasons in the braided reach of the lyr during these floods extreme high water levels and strong channel evolution often occur in local regions which may endanger the safety of flood control infrastructure a one dimensional morphodynamic model based on a coupled solution approach was used to simulate the processes of floodwave propagation and channel deformation caused by two hyperconcentrated floods occurring in the braided reach the conclusions obtained from this study are as follows i a coupled 1d morphodynamic model was developed to simulate hyperconcentrated flood and channel evolution in a braided reach with an extremely irregular cross sectional geometry in this model the governing equations for the hydrodynamics are modified with the terms of sediment concentration and bed evolution being directly included in the hydrodynamic equations these equations are coupled with the non equilibrium transport equation for graded suspended sediments and the equation of bed evolution with the hydrodynamic sediment transport and morphological variables being obtained simultaneously the model was first applied to simulate the 1977 hyperconcentrated flood occurring in the braided reach with field measured data for discharge and total and graded sediment concentrations at hydrometric sections being used to calibrate the model it was then used to reproduce the hydrographs of discharge and sediment concentration in the 2004 hyperconcentrated flood again using field measured data to verify the model close agreement was generally obtained between the observed data and model predictions using the coupled solution ii the validated model was used to simulate the 2004 hyperconcentrated flood for six scenarios with different cross sectional spacings with the effect of different space increments on the model results being investigated it was found that different space increments would influence the predicative accuracy of the morphodynamic model and the effect of different cross sectional spacings was relatively low in terms of predicting the discharges and water levels as compared with the effect on the calculated concentrations and channel evolution amounts it is suggested that a suitable cross sectional distance of less than 3 km should be adopted to simulate hyperconcentrated floods occurring in a braided reach using the coupled 1d morphodynamic model iii the proposed model was also used to simulate the 1977 hyperconcentrated flood in the braided reach based on different distribution modes of channel evolution area and the effect was investigated of different distribution modes on the model results it was found that the model results using the mode of uniform distribution of bed evolution area agreed better with the measurements as compared with the results obtained using two other allocation modes and the effect of different allocation modes was relatively small on the model predicted maximum water levels as compared with the effect on the calculated discharges concentrations and channel evolution amounts especially in the braided reach undergoing severe sediment deposition acknowledgements the study reported herein was supported partly by the program of the national key research and development plan grant no 2017yfc0405501 and it was also supported partly by supported by the national natural science foundation of china grant nos 51725902 51579186 and 51379156 the constructive suggestions of the anonymous reviewers are gratefully acknowledged 
7299,river ice breakup dates bds are not merely a proxy indicator of climate variability and change but a direct concern in the management of local ice caused flooding a framework of stacking ensemble learning for annual river ice bds was developed which included two level components member and combining models the member models described the relations between bd and their affecting indicators the combining models linked the predicted bd by each member models with the observed bd especially bayesian regularization back propagation artificial neural network brann and adaptive neuro fuzzy inference systems anfis were employed as both member and combining models the candidate combining models also included the simple average methods sam the input variables for member models were selected by a hybrid filter and wrapper method the performances of these models were examined using the leave one out cross validation as the largest unregulated river in alberta canada with ice jams frequently occurring in the vicinity of fort mcmurray the athabasca river at fort mcmurray was selected as the study area the breakup dates and candidate affecting indicators in 1980 2015 were collected the results showed that the brann member models generally outperformed the anfis member models in terms of better performances and simpler structures the difference between the r and mi rankings of inputs in the optimal member models may imply that the linear correlation based filter method would be feasible to generate a range of candidate inputs for further screening through other wrapper or embedded ivs methods the sam and brann combining models generally outperformed all member models the optimal sam combining model combined two brann member models and improved upon them in terms of average squared errors by 14 6 and 18 1 respectively in this study for the first time the stacking ensemble learning was applied to forecasting of river ice breakup dates which appeared promising for other river ice forecasting problems keywords river ice breakup date anfis bayesian regularization machine learning mutual information 1 introduction the long term trends of river ice breakup dates bds have been demonstrated as good proxy indicators of climate variability and change cooley and pavelsky 2016 de rham et al 2008a b debeer et al 2016 fu and yao 2015 lesack et al 2013 2014 magnuson et al 2000 pavelsky and smith 2004 shi et al 2015 yang et al 2015 however as an indicator of an annual event at high latitude regions the river ice bds are a direct input to the management of local ice caused flooding beltaos and prowse 2001 beltaos et al 2006 nafziger et al 2016 prowse et al 2010 wang et al 2013 zhao et al 2012 2015 since breakup may cause water level increases of several metres in minutes a long lead accurate forecasting of breakup dates is valuable earlier forecasts can provide greater preparedness time for the local emergency response authorities which is thus helpful for mitigating potential economic losses and protection of the public it is evident that many factors affecting river ice breakup dates include spring surface air temperatures and downstream upstream river ice conditions beltaos and burrell 2015 bieniek et al 2011 cooley and pavelsky 2016 thus development of powerful forecasting tools is crucial in river ice caused flood management warren et al 2017 previously data driven and hydraulic models were applied to breakup prediction however most of these models focus on predicting breakup severity mahabir et al 2005 mahabir et al 2006a 2007 2003 2006b 2008 mahabir 2007 a limited number of studies on the prediction of breakup dates have been reported for instance an artificial neural network ann model was proposed to forecast ice run freeze up and breakup dates in the inner mongolia reach of the yellow river tao et al 2008 an ann model coupling particle swarm optimization and back propagation was developed for ice breakup date forecast in the top reach of the yellow river china hu et al 2008 a support vector machine optimized by a multi objective shuffled complex evolution metropolis algorithm was developed for prediction of ice breakup dates in the inner mongolia section of the yellow river zhou et al 2009 a three layer feed forward ann model was proposed for predicting the onset of breakup using the hay river in northern canada zhao et al 2012 besides due to the complicated breakup mechanism and the site specific characteristics prediction of breakup dates is a challenge to further improve the performance of prediction models one possible solution is application of more advanced prediction methods to river ice breakup timing effectiveness of these new methods needs to be demonstrated through their comparisons with other conventional methods alvisi et al 2006 sun and trevor 2015 instead of selecting the best model an alternative solution is to combine the current prediction models in a manner that each advantage can be merged within an integrated framework sun and trevor 2017a b stacking ensemble learning is such a type of method which uses combining models to combine member models various ensemble learning methods have been applied to various fields of hydrological and meteorological modeling such as satellite precipitation estimation hong et al 2006 daily streamflow prediction dhanya and kumar 2011 urban water demand forecasting tiwari and adamowski 2013 soil moisture estimation kornelsen and coulibaly 2014 groundwater level prediction sun 2013 salinity intrusion in coastal aquifers sreekanth and datta 2011 flood frequency analysis ouarda and shu 2009 shu and ouarda 2007 and irrigation demands perera et al 2016 among them the advantages of stacking learning lie in the performance improvement due to possible variance reduction of forecast errors or correction of biases however its application to river ice breakup timing has limited reporting to this end the objective of this study is to develop a stacking ensemble learning framework self of annual river ice breakup dates and to apply it to the community of fort mcmurray on the athabasca river canada this will entail 1 the development of member prediction models for river ice breakup dates including bayesian regulated back propagation artificial neural network brann and adaptive neuro fuzzy inference system anfis 2 the selection of input variables for member models by a hybrid filter and wrapper method 3 the use of outputs of certain combinations of member models as further inputs for combining models verifying the roles of brpann anfis and simple average methods sam as combining models within the self and 4 the application of the proposed self to a representative unregulated river in alberta canada where frequent ice caused floods are a concern 2 methods 2 1 stacking ensemble learning the stacking ensemble learning framework self for annual river ice breakup dates has a two level structure which includes member and combining models fig 1 in terms of its functions the member models link the bds with their affecting indicators the combining models quantify the relations between the predicted bds by each member models and the observed bds in this study the brann and anfis are tested in terms of their performances as not only member models but also combining models the sam is selected only for the combining model as a comparison basis 2 2 input variable selection ivs input variable selection ivs is one of the most important steps for building the member models there are three basic types of ivs methods which are filter wrapper and embedded methods may et al 2011 vergara and estévez 2014 for the member model of annual river ice forecasting the data sample number is relatively small as the period of monitored historical record is typically short it has been reported that when the ratio of the sample number to the input variable number is less than 5 it may affect the performance of more advanced ivs methods galelli et al 2014 considering the relatively small river ice data set a hybrid filter wrapper method was proposed firstly the linear correlation coefficients r and the mutual information mi indices were calculated to evaluate the separate ranking of all input variables a certain number of inputs variables with higher rankings were reserved as candidate ones this filter method is merely to narrow down the range of candidate input variables furthermore in the wrapper step a greedy search based leave one out cross validation loocv method is employed to evaluate the performances of each type of models under all possible combinations of filtered input variables and inherent parameters the calculation load of this wrapper method is acceptable this is because the number of all candidate input variables is reduced to a reasonable level by the filter method meanwhile the data sample number is small which constrains the maximum of input variable number employed in the models the detailed equations for r and mi can be referred to the reference guyon and elisseeff 2003 2 3 bayesian regularization back propagation artificial neural network brann the bayesian regularization back propagation artificial neural network brann is proposed as one of the member or combining models within the self although conventional back propagation ann is demonstrated as universal approximators it often suffers from the over fitting problems abrahart et al 2012 anctil and lauzon 2004 hsu et al 1995 maier et al 2010 zhang et al 2009 brann uses the bayesian theory to balance the structure size and prediction accuracy foresee and hagan 1997 brann follows a typical three layer structure with logistic and linear transfer functions in hidden and output layers respectively especially the number of either factors affecting bds or member models determines the number of neurons in the input layer the number of neurons in the hidden layer needs to be adjusted by trial and error to maximize the model s performance and the number of neurons in output layer is usually one which is same as the number of predicted bds during the calibration process the objective function is as follows 1 min α e w β e d where e w is the sum of squares of the network weights e d is the sum of squares error between the network response and target and α and β are objective function parameters regularization parameters the relative size of α and β indicates that the emphasis for training is decreasing the errors or reducing weight size bayes rule is capable of guiding the selection process of these parameters if we assume that both α and β are random variables then according to bayes rule we have 2 p w d α β m p d w β m p w α m p d α β m where d is the data set and m represents the neural network model used if both α and β have uniform prior density the likelihood function p d α β m should be maximized to maximize p α β d m in eq 2 the errors of the data set and weights w are also assumed to be random variables according to bayes rule we have 3 p w d α β m p d w β m p w α m p d α β m if the prior distribution for both errors and weights are gaussian and p d α β m in eq 3 is a normalization factor then we have 4 p d w β m exp β e d z d β p w α m exp α e w z w α and p w d α β m exp f w z f α β substituting eq 4 into eq 3 yields 5 p d α β m z f α β z w α z d β where z f α β 2 π n 2 det 1 2 h exp f w mp z w α π α n 2 z d β π β n 2 and h β 2 e d α 2 e w h is the hessian matrix of f expanding z f α β into a taylor series then taking the derivative of the logarithm of eq 5 with respect to α and β and setting them equal to zero yields the expression of both α and β when p α β d m is maximized and the posterior density of weights reaches the minimum point wmp 6 α mp γ 2 e w w mp β mp n γ 2 e d w mp and γ n α mp trace 1 h mp where n is the sample number n is the total number of parameters in the network and γ is the number of parameters in the network that are effectively used in reducing the error function the training of the bayesian regularized neural network is an iterative process when α and β are initialized the minimum of f w is reached using the levenberg marquardt algorithm both α and β are updated by eq 6 to obtain the optimums in the sense of maximizing the posterior distribution the minimum of the renewed f w is then repeatedly calculated until convergence foresee and hagan 1997 xu et al 2006 2005 2 4 adaptive neuro fuzzy inference systems anfis another member or combining model within the self is the anfis chau et al 2005 kant et al 2013 nayak et al 2005a b 2004 wang et al 2009 its structure is similar to that of a five layered feed forward ann the five layers usually consist of fuzzification of inputs multiplier normalization defuzzification of each rule s output and aggregation of all rules outputs jang 1993 jang and sun 1995 without loss of generality if two inputs with two membership functions of each are supposed the anfis can be expressed as follows 7 y i 1 4 w i f i i 1 4 w i f i i 1 4 w i i 1 2 3 4 8 f i α i 1 x 1 α i 2 x 2 β i x 1 u 1 1 or u 1 2 x 2 u 2 1 or u 2 2 i 1 2 3 4 9 w i u 1 j x 1 u 2 k x 2 i 1 4 j 1 2 k 1 2 10 u l j x l 1 1 x l c l j a l j 2 b l j l 1 2 j 1 2 where y is the output w k and w k are normalized and original firing strengths f i is outputs of each rule i 1 2 3 4 x l is the input l 1 2 u l j and u l j are linguistic labels and related membership functions corresponding to x l α i j and β i are consequent parameters in each rule and a i j c i j and b i j are premise parameters i 1 2 j 1 2 in each membership function the learning training algorithm of anfis usually includes both least squares estimation and back propagation based on these algorithms the parameters associated with the membership functions of inputs and fuzzy rules are adjusted to minimize the error measure between predicted and observed outputs the back propagation algorithm is especially used to adjust parameters in membership functions of inputs i e the premise parameters in each membership function and then least squares estimation is used to calibrate the defuzzification parameters i e consequent parameters of fuzzy rules compared with common fuzzy logic models the advantages of anfis are that the rule base and inherent parameters can be calibrated the calibration calculation time of anfis is relatively faster than that of ann chang and chang 2006 2001 2 5 simple average methods sam the simple average method sam is employed as merely a combining model for prediction of river ice breakup dates the output of sam is the mean value of each member model s output as the simplest combining model the advantage of sam is its ability to be at least better than the worst member model jeong and kim 2009 2005 shamseldin et al 1997 xiong et al 2001 11 y c 1 n c k 1 n c y k 12 σ c 2 var y c y o 1 n c σ k avg 2 n c 1 n c σ k j avg 13 σ k avg 2 1 n c k 1 n c var y k y o 14 σ kj avg 1 n c n c 1 k 1 n c j 1 j k n c cov y k y o y j y o where y c is the output of sam model y k or y j is output of member model k or j y o is the observed values n c is the number of member models σ c 2 is variance of forecasting errors for sam σ k avg 2 is the average of the error variances of member models and σ kj avg is the average of the covariance between each pair of forecasts σ kj based on eq 12 σ c 2 is simply equal to σ k avg 2 n whenever the forecast errors of member models are uncorrelated i e σ k j avg 0 2 6 cross validation and performance indices to evaluate the performance of the proposed self for river ice breakup dates the loocv is employed to evaluate the generality of the calibrated models through fully usage of the limited data m samples in each run of loocv the model is calibrated with m 1 samples and validated with 1 sample reserved for that run all samples are selected once in the validation sets after all m runs are finished the averages of performance indices for training and validation sets are calculated generally the better model is the one with better average validation performance two performance indices correlation coefficient r and root mean squared error rmse are selected the model s performance becomes better with higher r closer to one and lower rmse closer to zero the evaluation indices are expressed as follows 15 r j 1 n y sj y s y j y j 1 n y sj y s 2 j 1 n y j y 2 16 rmse j 1 n y j y sj 2 n s where n s is the number of samples in the training or test set yj and ysj are the observed and predicted values for the bd of the jth sample respectively and y and y s are the mean of the observed and predicted bd values in the loocv method the performance indicators for the training sets are calculated using r avg and rmse avg the averages of r i and rmse i for the training set in run i the validation sets are evaluated by rse avg root of average squared errors sei for the validation set in each run the corresponding definitions are as follows 17 r avg r i m 18 rmse avg rmse i m 19 se i y i y si 2 20 rse avg se i m where m is the total sample number of the dataset i is the number for each run i 1 2 m and yi and ysi are the observed and predicted values for the bd of the single sample in the validation set for run i it is noted that rse avg has a similar calculation manner to rmse however the former is based on each validation set of a single sample and the latter is based on a single training set of multiple samples 3 case study 3 1 study area alberta environment and parks has a multiple year river ice monitoring and observation program for the athabasca river at fort mcmurray kowalczyk and hicks 2003 sun et al 2015 the athabasca river is the largest unregulated northward flowing river in alberta canada and it experiences frequent ice jams during spring breakup andrishak and hicks 2011 she et al 2009 in the vicinity of fort mcmurray one of the largest communities along the athabasca river the river s slope decreases by an order of magnitude many sand bars and islands exist in a widened channel and the clearwater river discharges into the athabasca river at this location she et al 2009 due to the availability of collected historical data complicated river channel conditions and the frequent potential of ice related breakup flooding hazard the athabasca river at fort mcmurray was selected as the study area fig 2 as the temperatures rise and the ice thaws in the spring river breakup initially occurs in the southern portion of the athabasca river and progresses northwards the breakup process is normally dynamic and characterized by ice accumulations at the upstream rapids these accumulations can release and ice cover can be lifted in a cascading manner due to surges and ice runs from river ice breakup upstream kowalczyk and hicks 2003 due to the abrupt change of river character at fort mcmurray ice jams frequently occur in the nearby reaches such ice jams form not only in the nearby reaches upstream and downstream of the confluence but also into the channel of the clearwater river which causes back water and related flooding problems 3 2 dataset to facilitate the models comparison within the proposed self the historical bds for the athabasca river at fort mcmurray for the past 36 years 1980 2015 were downloaded from the official website of regional municipality of wood buffalo http www rmwb ca fig 3 shows the variation of these historical bds which ranges from early april julian day 100 to early may 123 these declared bds are the output of member and combining models it is noted that these bds are usually defined as the last date on which the breakup process is observed river channel is open at fort mcmurray in fact there are various kinds of definitions for bds such as the first significant movement of ice cover i e first date of breakup processes zhao et al 2010 however the public is aware of the lasting flooding potential near to and during breakup the municipality also deploys monitoring staff and can issue evacuation plans once flooding occurs the last breakup date would be most important in the viewpoint of emergency management since it indicates that the community is no longer at ice related flooding risk thus the last breakup date is the target date in this study the input variables were selected based on both correlation between inputs and bd and the availability of inputs prior to the bd for breakup date prediction these inputs should be available before april 1 each year since the earliest breakup date in the historical record is april 6 mahabir 2007 the potential indicators related to breakup dates were categorized as weather e g air temperature antecedent precipitation snow water equivalent swe and river ice e g river flow water level and ice thickness conditions the indicators for weather conditions were calculated based on the daily maximum minimum and average temperatures and daily accumulated precipitations of two environment and climate change canada stations at fort mcmurray wmo id 71689 and 71585 the missing data gap at the station 71689 were filled in by the data from the other station 71585 the river flows and levels were mainly based on the water survey of canada gauge athabasca river below mcmurray station number 07da001 these indicators were pre screened as the candidate inputs independent variables of the models based on two criteria availability before river ice breakup and correlation with bds a total of 36 samples of the whole dataset were collected to examine the models performances due to the limited data the loocv method with total 36 runs was employed 4 results analysis 4 1 selection of input variables affecting bds to illustrate the pre screening function of the filter step of the proposed ivs method the rankings of temperature and river flow indicators are displayed in figs 4 and 5 in total 17 candidate input variables were selected tables 1 and 2 temperatures at fort mcmurray are assumed as driving factors affecting the breakup timing while the river flows near fort mcmurray are closely corresponding to changes in river ice breakup conditions however accurate indicator selection for the modeling purpose is a challenge the linear and nonlinear correlation coefficients r and mi between the breakup dates and 72 weather condition indicators monthly maximum minimum and average of the daily maximum minimum and average temperatures from the previous september to the current april are listed in fig 4 fig 4 shows that most of the temperatures in march and april before and during breakup have significant negative linear correlations with breakup dates blue grids while those in previous september before freeze up have significant weak positive linear correlations yellow grids based on the rankings 9 temperature indicators with higher absolute values of either r or mi were chosen as candidate inputs for member models the statistics of these input variables in 1980 2015 are listed in table 1 similarly the linear and nonlinear correlation coefficients r and mi between the breakup dates and 24 river flow indicators monthly maximum minimum and average flows from the previous september to the current april are listed in fig 5 the monthly minimum and average river flows in previous november and current march and april have significant negative linear correlations with breakup dates in comparison all the river flow indicators have higher mi values fig 5b than temperature indicators fig 4b based on the rankings 8 river flow indicators with higher absolute values of either r or mi were chosen as candidate inputs for member models as well the statistics of these input variables in 1980 2015 are listed in table 2 it is noted that the temperature and water flows in april which have the most significant correlation coefficients cannot be directly used as inputs in the models since breakup at fort mcmurray may happen in early april most of these linear correlation coefficients are negative which implies that higher daily temperatures and larger river flow volumes would bring about earlier breakup dates especially in terms of the linear correlation x4 average of daily min temperatures in march and x 17 minimum of daily water flow in last november have the highest absolute value of r 0 5060 and 0 4568 as for the nonlinear correlation x13 maximum of daily water flow in march and x 14 maximum of daily water flow in last september have the highest absolute value of mi 3 8429 and 3 8429 4 2 structure and performance of member model 1 brann in the wrapper step of the proposed ivs method multiple combinations of inputs random seeds and internal configuration parameters were searched to identify the structure of the brann models with optimal performances especially the model s parameter number should be at least less than the sample number to constrain the calibration since the sample number in the training sets are 35 in the loocv method the 2 to 7 input brann models should have a maximum of 8 6 5 4 4 and 3 nodes in the hidden layer respectively table 3 lists the representative structures and performances of developed brann member models all of the representative brann member models with certain inputs have 2 nodes in the hidden layer which implies the input may have more effect on their performance than the node number in the hidden layer meanwhile the brann with 6 or 7 inputs have better performance in terms of lower rseavg for validation as well as higher ravg and lower rmseavg for training thus brann5 y1 brann6 y2 and brann7 y3 were chosen as the representative ann member models for further combination in the ensemble framework due to their better performances among them brann6 with 6 inputs has the best validation performance 3 22 for rseavg and the second best training performance 0 9157 for ravg and 2 05 for rmse brann5 has a very similar performance to brann6 since the difference between their structures is input x2 or x4 brann7 with 7 inputs has the third best validation performance 3 36 for rseavg and the best training performance 0 9366 for ravg and 1 82 for rmse due to the best validation performance among brann models brann6 is considered the optimal model among this type of member models 4 3 structure and performance of member model 2 anfis the anfis usually has 4 hidden layers which are larger than the single hidden layer of brann due to the larger hidden layer number of anfis limited number of inputs should be selected to constrain the model s structure and avoid over fitting based on equations 7 to 10 due to the 35 training samples in loocv the anfis can have a maximum of 2 inputs which corresponds to 24 internal parameters thus in the wrapper ivs method for anfis member models multiple combinations of inputs were selected by discarding one or two independent variables from all candidate ones to evaluate the predictive performance of the anfis in table 3 the anfis member modes with the top 4 highest performance are listed all of these anfis models have only two selected input variables this might be because more or less inputs would cause over fitting or under fitting which is especially true in river ice modeling when the scale of available dataset is relatively small among the representative anfis member models anfis1 y4 anfis2 y5 and anfis3 y6 have better training and validation performance and are chosen as candidate member models in the ensemble framework anfis1 has the optimal training and validation performance in its type in terms of the lowest rseavg 3 92 the highest ravg 0 8423 and the lowest rmse 2 78 respectively therefore anfis3 is considered the optimal anfis member model to further enhance the diversity of member models anfis2 and anfis3 with slightly worse performance than anfis1 are also selected 4 4 comparisons for candidate member models since the prediction performance of unknown samples is of most concern validation performance for the candidate brann and anfis member models are further compared in fig 6 it can be seen that the scattered points for brann models are generally more aggregated than those for anfis models which indicates that the performance of the former is generally better than those of the latter especially both brann5 and brann6 can predict bds well in the middle levels but slightly over estimate and under estimate bds for the earliest and latest levels respectively in comparison the differences between the predicted bds by the anfis models and the observed bds are relatively large at different levels the worse performance of anfis may be due to the fact that its structure complexity is constrained by the small sample number the two limited inputs of anfis models indicate that useful input information is not fully considered in addition the structure complexity of brann member models is simpler than that of anfis models both brann5 and brann6 have the 6 2 1 structure if the bias nodes in input and hidden layers are considered they have in total 11 nodes including 7 3 and 1 node s in input hidden and output layers respectively the brann7 has one more inputs with the structure of 7 2 1 all the anfis models have a 5 layer structure with 4 nodes in each layer and therefore a total of 23 nodes thus the brann member models generally outperform the anfis member models in this study in terms of better performance and simpler structure 4 5 input variable comparisons of optimal member models it is worthy to exam the linear and nonlinear rankings of the inputs included in the optimal member models so that the effect of the filter method on the member model s performance can be revealed fig 7 shows the input comparisons of the optimal member models according to their rankings based on the r and the mi indices it can be found that the top 6 or 7 linearly or nonlinearly correlated inputs with higher absolute r or mi values are not included in the optimal brann models similarly the x1 and x6 of anfis1 are not the top 2 ranked inputs based on the r and the mi indices either it may indicate that these inputs have interactive correlations with the output or can be more beneficial in constructing the features used for member models in addition the lowest r rankings of inputs for brann5 brann6 brann7 and anfis1 are 12 15 15 and 12 respectively it means if the top 12 linearly correlated inputs are included in the filter method the optimal brann6 and anfis1 can also be obtained through the following loocv method in comparison the lowest mi rankings of inputs for brann5 brann6 brann7 and anfis1 are all 17 the difference between the r and mi rankings for inputs in the optimal member models may imply that the filter method merely based on linear correlation ranking appears more efficient for initial selection of candidate inputs than that based on nonlinear correlation ranking meanwhile some inputs e g x12 with higher linear correlation rankings also have higher nonlinear correlation rankings although the linear correlation based ivs method is usually criticized for its limited ability in handling nonlinearity maier et al 2010 this method would be feasible to generate a range of candidate inputs which can be further screened through other wrapper or embedded ivs methods 4 6 structure and performance of ensemble learning combining models the combining models were calibrated based on the outputs of 6 member models y1 to y6 with optimal performance which were calibrated individually in nature selection of member models is also an ivs problem in the viewpoint of inputs of combining models due to the limited number of optimal member models a greedy searching method was employed to evaluate the performance of combining models with all possible combinations of 6 member models table 4 shows the structure and performance of representative ensemble combining models in each type with higher performance under different combinations of inputs among the sam models ensam3 has the best validation performance in terms of the lowest rseavg 2 72 however the differences of validation performance among these sam models are very small the ensam1 has the simplest structure two member models y2 and y3 while the ensam3 combines 5 member models among the brann combining models enbrann3 has the lowest rseavg 2 83 but very similar performance to other brann models among the anfis combining models enanfis3 has the best validation performance 3 38 for rseavg the optimal ensemble combining models in each type were selected as ensam1 ensam3 enbrann3 and enanfis3 respectively to further compare the optimal ensemble models in each type fig 8 shows a validation performance comparison the closer distance between the data dots and the equal value line for these combining models clearly indicates improved performance for these optimal combining models 4 7 the optimal ensemble learning combining models to further compare member and combining models fig 9 shows the distributions of the performance indices for the optimal 6 member and 4 combining models in training the r distributions of combining models are generally higher than those of optimal member models the rmse distributions of the former are basically lower than those of the latter in validation the se distributions for the combining models except for enanfis3 are generally lower than those of member models the se distributions of ensam and enann between the 25th and 75th percentiles are narrower than those of these member models as well the comparison of these distributions further indicates that the combining models have better performance ranking than the member models among the combining models the extreme values of se for ensam1 are lower than those of ensam3 the se distributions of ensam1 between the 25th and 75th percentiles are slightly wider and higher than those of ensam3 due to the simpler structure of ensam1 and the similar performances between two ensam models ensam1 is considered the optimal ensemble learning combining models the ensam1 combines two outputs from two brann member models brann6 and brann7 which have 6 and 7 inputs and also share 3 inputs x1 x6 and x12 the structure of ensam1 is illustrated in fig 10 in terms of seavg values the ensam1 improves upon brann6 and brann7 by 14 6 and 18 1 respectively 5 discussion the proposed framework of stacking ensemble prediction for annual river ice breakup dates is promising since its improvement over each optimal member model is demonstrated in fact the combining manner also exists in all member models themselves especially for brann and anfis since they have the multiple layer structure in terms of the optimal combining type although the sam is the best combining model in this study other combining models may outperform for other forecasting problems it is noted that inclusion of all candidate member models cannot guarantee better performance from the ensemble perspective the proposed framework can be categorized as either a deterministic stacking ensemble learning or as a hybrid modeling manner so called multi model data combinations or fusion abrahart and see 2002 there are many types of ensemble frameworks including boosting and bagging anctil and lauzon 2004 zaier et al 2010 which can be further applied to river ice forecasting problems in the future when a large number of member models are employed uncertain forecasts with confidence intervals can be generated for the ensemble framework which would help forecasters to analyze the uncertainties involved in the forecasting results different modellers forecasters or managers may evaluate the varying performance of each tested model based on their own preferences and criteria in comparison among some optimal combining models the differences in rmseavg and ravg for training sets and rseavg for validation sets appear to be small however these indices are based on an average of 36 years using the loocv method so that the absolute differences should not be neglected for example the forecast difference for certain years using the developed models may be a few days it is always desirous of improving the model s prediction capability so that more preparation time can be reserved for managers to mobilize resources for emerging ice related flood events the indicators and observed bds are the basic information for calibrating and validating the models their quality may directly affect the performance of the models uncertainty in the bds may originate from its various theoretical definitions and practical observation difficulties in some reaches for example the long term historical records of breakup dates are collected by observers in different organizations with different experience the definitions employed by these observers affect the reported values of the breakup date when breakup happens in the early morning or late at night without confirmed observation differences may exist between the claimed breakup date and the real one if aerial observation is not implemented to ascertain the river ice conditions limitations of ground observation may also bring out some errors in determining the breakup date breakup dates are the culmination of the annual river ice breakup event as long as the breakup date is forecast well ahead of breakup it can provide timely and feasible information for supporting the decision making required to mobilize resources from local provincial or federal agencies in our study the historical breakup dates at the confluence between the athabasca and clearwater rivers are between april 9 and may 9 all inputs required for the developed models can be obtained before april 1st so that the forecast can be calculated at least 1 week ahead of the known earliest breakup date it is noted that timely bd forecasting models are different from near real time hydrological models which are usually developed to obtain daily or hourly river flows or levels during events in open water conditions to make these forecasting models operational the inputs should be available well ahead of breakup the selected candidate indicators in this study are mainly monthly average temperatures and river flows downstream of the investigated site some different inputs have been used in previous studies on breakup date prediction such as accumulated air temperature ice thickness discharges at an upstream station tao et al 2008 in addition although river flow may not be as accurate as river level it is still employed as one type of indicator since there are more readily available records of river flow from water survey of canada than river level if there are more correlated candidate indicators available at other study sites search algorithms e g the advanced wrapper method or genetic algorithm can be utilized to select the optimal combination of inputs durand et al 2007 hejazi and cai 2009 may et al 2008 river ice breakup is usually a site specific problem although the first last b dates and river levels flows are available for most gauges operated by water survey of canada it is difficult to identify the breakup dates merely based on these data without years of on site observation or acquaintance with the local river ice conditions meanwhile identification of the corresponding indicators correlated to breakup dates is based on not only multiple input variable selection procedures but also the forecasters understanding and experience regarding the ice regime of the study river for these reasons the current data driven based river ice study is focused on a single site along the river mahabir et al 2005 zhao et al 2012 application of the proposed method to new sites on the athabasca river and other northern rivers is worthy of further investigation 6 conclusions a framework of stacking ensemble prediction for annual river ice breakup dates bd was developed the historical breakup dates for the athabasca river at fort mcmurray and the candidate indicators weather and flow conditions in 1980 2015 were collected to facilitate the comparison of member and combining models within the proposed ensemble framework the input variables for member models were selected by a hybrid filter and wrapper method the performance of these models was examined using the loocv the major findings are as follows 1 temperatures at fort mcmurray are assumed as the driving factors affecting the breakup timing while the river flows near fort mcmurray correspond closely to changes in the river ice conditions especially temperatures in march and april have significant negative linear correlations with breakup dates 2 two types of member models are able to build nonlinear relationships between indicators and bd with different performance the brann member models generally outperform the anfis member models in this study in terms of better performance and simpler structure 3 the sam and brann combining models generally outperform all types of member models while the anfis combining models cannot outperform the brann member models the optimal sam combining model ensam1 combines two outputs from two brann member models and improves upon them in terms of seavg values by 14 6 and 18 1 respectively 4 the difference between the r and the mi rankings of inputs in the optimal member models may imply that the filter method based merely on linear correlation ranking appears more efficient than that based on nonlinear correlation rankings the linear correlation based filter method would be feasible to generate a range of candidate inputs for further screening through other wrapper or embedded ivs methods and 5 this study for the first time applies the ensemble methods to forecasting of river ice breakup dates combining the diverse abilities of various river ice forecasting models through the ensemble technology appears promising for other river ice forecasting problems acknowledgements this study is financially supported by alberta environment and parks the authors would like to acknowledge the support of the current and previous river ice forecasting team members at alberta environment and parks nadia kovachis watson stefan emmer patricia stevenson evan friesenhan andun jevne and chandra mahabir the first author is grateful for the support from the hundred talents program of sun yat sen university we are deeply grateful to the reviewers for their insightful and careful comments and suggestions which have helped to improve the paper greatly 
7299,river ice breakup dates bds are not merely a proxy indicator of climate variability and change but a direct concern in the management of local ice caused flooding a framework of stacking ensemble learning for annual river ice bds was developed which included two level components member and combining models the member models described the relations between bd and their affecting indicators the combining models linked the predicted bd by each member models with the observed bd especially bayesian regularization back propagation artificial neural network brann and adaptive neuro fuzzy inference systems anfis were employed as both member and combining models the candidate combining models also included the simple average methods sam the input variables for member models were selected by a hybrid filter and wrapper method the performances of these models were examined using the leave one out cross validation as the largest unregulated river in alberta canada with ice jams frequently occurring in the vicinity of fort mcmurray the athabasca river at fort mcmurray was selected as the study area the breakup dates and candidate affecting indicators in 1980 2015 were collected the results showed that the brann member models generally outperformed the anfis member models in terms of better performances and simpler structures the difference between the r and mi rankings of inputs in the optimal member models may imply that the linear correlation based filter method would be feasible to generate a range of candidate inputs for further screening through other wrapper or embedded ivs methods the sam and brann combining models generally outperformed all member models the optimal sam combining model combined two brann member models and improved upon them in terms of average squared errors by 14 6 and 18 1 respectively in this study for the first time the stacking ensemble learning was applied to forecasting of river ice breakup dates which appeared promising for other river ice forecasting problems keywords river ice breakup date anfis bayesian regularization machine learning mutual information 1 introduction the long term trends of river ice breakup dates bds have been demonstrated as good proxy indicators of climate variability and change cooley and pavelsky 2016 de rham et al 2008a b debeer et al 2016 fu and yao 2015 lesack et al 2013 2014 magnuson et al 2000 pavelsky and smith 2004 shi et al 2015 yang et al 2015 however as an indicator of an annual event at high latitude regions the river ice bds are a direct input to the management of local ice caused flooding beltaos and prowse 2001 beltaos et al 2006 nafziger et al 2016 prowse et al 2010 wang et al 2013 zhao et al 2012 2015 since breakup may cause water level increases of several metres in minutes a long lead accurate forecasting of breakup dates is valuable earlier forecasts can provide greater preparedness time for the local emergency response authorities which is thus helpful for mitigating potential economic losses and protection of the public it is evident that many factors affecting river ice breakup dates include spring surface air temperatures and downstream upstream river ice conditions beltaos and burrell 2015 bieniek et al 2011 cooley and pavelsky 2016 thus development of powerful forecasting tools is crucial in river ice caused flood management warren et al 2017 previously data driven and hydraulic models were applied to breakup prediction however most of these models focus on predicting breakup severity mahabir et al 2005 mahabir et al 2006a 2007 2003 2006b 2008 mahabir 2007 a limited number of studies on the prediction of breakup dates have been reported for instance an artificial neural network ann model was proposed to forecast ice run freeze up and breakup dates in the inner mongolia reach of the yellow river tao et al 2008 an ann model coupling particle swarm optimization and back propagation was developed for ice breakup date forecast in the top reach of the yellow river china hu et al 2008 a support vector machine optimized by a multi objective shuffled complex evolution metropolis algorithm was developed for prediction of ice breakup dates in the inner mongolia section of the yellow river zhou et al 2009 a three layer feed forward ann model was proposed for predicting the onset of breakup using the hay river in northern canada zhao et al 2012 besides due to the complicated breakup mechanism and the site specific characteristics prediction of breakup dates is a challenge to further improve the performance of prediction models one possible solution is application of more advanced prediction methods to river ice breakup timing effectiveness of these new methods needs to be demonstrated through their comparisons with other conventional methods alvisi et al 2006 sun and trevor 2015 instead of selecting the best model an alternative solution is to combine the current prediction models in a manner that each advantage can be merged within an integrated framework sun and trevor 2017a b stacking ensemble learning is such a type of method which uses combining models to combine member models various ensemble learning methods have been applied to various fields of hydrological and meteorological modeling such as satellite precipitation estimation hong et al 2006 daily streamflow prediction dhanya and kumar 2011 urban water demand forecasting tiwari and adamowski 2013 soil moisture estimation kornelsen and coulibaly 2014 groundwater level prediction sun 2013 salinity intrusion in coastal aquifers sreekanth and datta 2011 flood frequency analysis ouarda and shu 2009 shu and ouarda 2007 and irrigation demands perera et al 2016 among them the advantages of stacking learning lie in the performance improvement due to possible variance reduction of forecast errors or correction of biases however its application to river ice breakup timing has limited reporting to this end the objective of this study is to develop a stacking ensemble learning framework self of annual river ice breakup dates and to apply it to the community of fort mcmurray on the athabasca river canada this will entail 1 the development of member prediction models for river ice breakup dates including bayesian regulated back propagation artificial neural network brann and adaptive neuro fuzzy inference system anfis 2 the selection of input variables for member models by a hybrid filter and wrapper method 3 the use of outputs of certain combinations of member models as further inputs for combining models verifying the roles of brpann anfis and simple average methods sam as combining models within the self and 4 the application of the proposed self to a representative unregulated river in alberta canada where frequent ice caused floods are a concern 2 methods 2 1 stacking ensemble learning the stacking ensemble learning framework self for annual river ice breakup dates has a two level structure which includes member and combining models fig 1 in terms of its functions the member models link the bds with their affecting indicators the combining models quantify the relations between the predicted bds by each member models and the observed bds in this study the brann and anfis are tested in terms of their performances as not only member models but also combining models the sam is selected only for the combining model as a comparison basis 2 2 input variable selection ivs input variable selection ivs is one of the most important steps for building the member models there are three basic types of ivs methods which are filter wrapper and embedded methods may et al 2011 vergara and estévez 2014 for the member model of annual river ice forecasting the data sample number is relatively small as the period of monitored historical record is typically short it has been reported that when the ratio of the sample number to the input variable number is less than 5 it may affect the performance of more advanced ivs methods galelli et al 2014 considering the relatively small river ice data set a hybrid filter wrapper method was proposed firstly the linear correlation coefficients r and the mutual information mi indices were calculated to evaluate the separate ranking of all input variables a certain number of inputs variables with higher rankings were reserved as candidate ones this filter method is merely to narrow down the range of candidate input variables furthermore in the wrapper step a greedy search based leave one out cross validation loocv method is employed to evaluate the performances of each type of models under all possible combinations of filtered input variables and inherent parameters the calculation load of this wrapper method is acceptable this is because the number of all candidate input variables is reduced to a reasonable level by the filter method meanwhile the data sample number is small which constrains the maximum of input variable number employed in the models the detailed equations for r and mi can be referred to the reference guyon and elisseeff 2003 2 3 bayesian regularization back propagation artificial neural network brann the bayesian regularization back propagation artificial neural network brann is proposed as one of the member or combining models within the self although conventional back propagation ann is demonstrated as universal approximators it often suffers from the over fitting problems abrahart et al 2012 anctil and lauzon 2004 hsu et al 1995 maier et al 2010 zhang et al 2009 brann uses the bayesian theory to balance the structure size and prediction accuracy foresee and hagan 1997 brann follows a typical three layer structure with logistic and linear transfer functions in hidden and output layers respectively especially the number of either factors affecting bds or member models determines the number of neurons in the input layer the number of neurons in the hidden layer needs to be adjusted by trial and error to maximize the model s performance and the number of neurons in output layer is usually one which is same as the number of predicted bds during the calibration process the objective function is as follows 1 min α e w β e d where e w is the sum of squares of the network weights e d is the sum of squares error between the network response and target and α and β are objective function parameters regularization parameters the relative size of α and β indicates that the emphasis for training is decreasing the errors or reducing weight size bayes rule is capable of guiding the selection process of these parameters if we assume that both α and β are random variables then according to bayes rule we have 2 p w d α β m p d w β m p w α m p d α β m where d is the data set and m represents the neural network model used if both α and β have uniform prior density the likelihood function p d α β m should be maximized to maximize p α β d m in eq 2 the errors of the data set and weights w are also assumed to be random variables according to bayes rule we have 3 p w d α β m p d w β m p w α m p d α β m if the prior distribution for both errors and weights are gaussian and p d α β m in eq 3 is a normalization factor then we have 4 p d w β m exp β e d z d β p w α m exp α e w z w α and p w d α β m exp f w z f α β substituting eq 4 into eq 3 yields 5 p d α β m z f α β z w α z d β where z f α β 2 π n 2 det 1 2 h exp f w mp z w α π α n 2 z d β π β n 2 and h β 2 e d α 2 e w h is the hessian matrix of f expanding z f α β into a taylor series then taking the derivative of the logarithm of eq 5 with respect to α and β and setting them equal to zero yields the expression of both α and β when p α β d m is maximized and the posterior density of weights reaches the minimum point wmp 6 α mp γ 2 e w w mp β mp n γ 2 e d w mp and γ n α mp trace 1 h mp where n is the sample number n is the total number of parameters in the network and γ is the number of parameters in the network that are effectively used in reducing the error function the training of the bayesian regularized neural network is an iterative process when α and β are initialized the minimum of f w is reached using the levenberg marquardt algorithm both α and β are updated by eq 6 to obtain the optimums in the sense of maximizing the posterior distribution the minimum of the renewed f w is then repeatedly calculated until convergence foresee and hagan 1997 xu et al 2006 2005 2 4 adaptive neuro fuzzy inference systems anfis another member or combining model within the self is the anfis chau et al 2005 kant et al 2013 nayak et al 2005a b 2004 wang et al 2009 its structure is similar to that of a five layered feed forward ann the five layers usually consist of fuzzification of inputs multiplier normalization defuzzification of each rule s output and aggregation of all rules outputs jang 1993 jang and sun 1995 without loss of generality if two inputs with two membership functions of each are supposed the anfis can be expressed as follows 7 y i 1 4 w i f i i 1 4 w i f i i 1 4 w i i 1 2 3 4 8 f i α i 1 x 1 α i 2 x 2 β i x 1 u 1 1 or u 1 2 x 2 u 2 1 or u 2 2 i 1 2 3 4 9 w i u 1 j x 1 u 2 k x 2 i 1 4 j 1 2 k 1 2 10 u l j x l 1 1 x l c l j a l j 2 b l j l 1 2 j 1 2 where y is the output w k and w k are normalized and original firing strengths f i is outputs of each rule i 1 2 3 4 x l is the input l 1 2 u l j and u l j are linguistic labels and related membership functions corresponding to x l α i j and β i are consequent parameters in each rule and a i j c i j and b i j are premise parameters i 1 2 j 1 2 in each membership function the learning training algorithm of anfis usually includes both least squares estimation and back propagation based on these algorithms the parameters associated with the membership functions of inputs and fuzzy rules are adjusted to minimize the error measure between predicted and observed outputs the back propagation algorithm is especially used to adjust parameters in membership functions of inputs i e the premise parameters in each membership function and then least squares estimation is used to calibrate the defuzzification parameters i e consequent parameters of fuzzy rules compared with common fuzzy logic models the advantages of anfis are that the rule base and inherent parameters can be calibrated the calibration calculation time of anfis is relatively faster than that of ann chang and chang 2006 2001 2 5 simple average methods sam the simple average method sam is employed as merely a combining model for prediction of river ice breakup dates the output of sam is the mean value of each member model s output as the simplest combining model the advantage of sam is its ability to be at least better than the worst member model jeong and kim 2009 2005 shamseldin et al 1997 xiong et al 2001 11 y c 1 n c k 1 n c y k 12 σ c 2 var y c y o 1 n c σ k avg 2 n c 1 n c σ k j avg 13 σ k avg 2 1 n c k 1 n c var y k y o 14 σ kj avg 1 n c n c 1 k 1 n c j 1 j k n c cov y k y o y j y o where y c is the output of sam model y k or y j is output of member model k or j y o is the observed values n c is the number of member models σ c 2 is variance of forecasting errors for sam σ k avg 2 is the average of the error variances of member models and σ kj avg is the average of the covariance between each pair of forecasts σ kj based on eq 12 σ c 2 is simply equal to σ k avg 2 n whenever the forecast errors of member models are uncorrelated i e σ k j avg 0 2 6 cross validation and performance indices to evaluate the performance of the proposed self for river ice breakup dates the loocv is employed to evaluate the generality of the calibrated models through fully usage of the limited data m samples in each run of loocv the model is calibrated with m 1 samples and validated with 1 sample reserved for that run all samples are selected once in the validation sets after all m runs are finished the averages of performance indices for training and validation sets are calculated generally the better model is the one with better average validation performance two performance indices correlation coefficient r and root mean squared error rmse are selected the model s performance becomes better with higher r closer to one and lower rmse closer to zero the evaluation indices are expressed as follows 15 r j 1 n y sj y s y j y j 1 n y sj y s 2 j 1 n y j y 2 16 rmse j 1 n y j y sj 2 n s where n s is the number of samples in the training or test set yj and ysj are the observed and predicted values for the bd of the jth sample respectively and y and y s are the mean of the observed and predicted bd values in the loocv method the performance indicators for the training sets are calculated using r avg and rmse avg the averages of r i and rmse i for the training set in run i the validation sets are evaluated by rse avg root of average squared errors sei for the validation set in each run the corresponding definitions are as follows 17 r avg r i m 18 rmse avg rmse i m 19 se i y i y si 2 20 rse avg se i m where m is the total sample number of the dataset i is the number for each run i 1 2 m and yi and ysi are the observed and predicted values for the bd of the single sample in the validation set for run i it is noted that rse avg has a similar calculation manner to rmse however the former is based on each validation set of a single sample and the latter is based on a single training set of multiple samples 3 case study 3 1 study area alberta environment and parks has a multiple year river ice monitoring and observation program for the athabasca river at fort mcmurray kowalczyk and hicks 2003 sun et al 2015 the athabasca river is the largest unregulated northward flowing river in alberta canada and it experiences frequent ice jams during spring breakup andrishak and hicks 2011 she et al 2009 in the vicinity of fort mcmurray one of the largest communities along the athabasca river the river s slope decreases by an order of magnitude many sand bars and islands exist in a widened channel and the clearwater river discharges into the athabasca river at this location she et al 2009 due to the availability of collected historical data complicated river channel conditions and the frequent potential of ice related breakup flooding hazard the athabasca river at fort mcmurray was selected as the study area fig 2 as the temperatures rise and the ice thaws in the spring river breakup initially occurs in the southern portion of the athabasca river and progresses northwards the breakup process is normally dynamic and characterized by ice accumulations at the upstream rapids these accumulations can release and ice cover can be lifted in a cascading manner due to surges and ice runs from river ice breakup upstream kowalczyk and hicks 2003 due to the abrupt change of river character at fort mcmurray ice jams frequently occur in the nearby reaches such ice jams form not only in the nearby reaches upstream and downstream of the confluence but also into the channel of the clearwater river which causes back water and related flooding problems 3 2 dataset to facilitate the models comparison within the proposed self the historical bds for the athabasca river at fort mcmurray for the past 36 years 1980 2015 were downloaded from the official website of regional municipality of wood buffalo http www rmwb ca fig 3 shows the variation of these historical bds which ranges from early april julian day 100 to early may 123 these declared bds are the output of member and combining models it is noted that these bds are usually defined as the last date on which the breakup process is observed river channel is open at fort mcmurray in fact there are various kinds of definitions for bds such as the first significant movement of ice cover i e first date of breakup processes zhao et al 2010 however the public is aware of the lasting flooding potential near to and during breakup the municipality also deploys monitoring staff and can issue evacuation plans once flooding occurs the last breakup date would be most important in the viewpoint of emergency management since it indicates that the community is no longer at ice related flooding risk thus the last breakup date is the target date in this study the input variables were selected based on both correlation between inputs and bd and the availability of inputs prior to the bd for breakup date prediction these inputs should be available before april 1 each year since the earliest breakup date in the historical record is april 6 mahabir 2007 the potential indicators related to breakup dates were categorized as weather e g air temperature antecedent precipitation snow water equivalent swe and river ice e g river flow water level and ice thickness conditions the indicators for weather conditions were calculated based on the daily maximum minimum and average temperatures and daily accumulated precipitations of two environment and climate change canada stations at fort mcmurray wmo id 71689 and 71585 the missing data gap at the station 71689 were filled in by the data from the other station 71585 the river flows and levels were mainly based on the water survey of canada gauge athabasca river below mcmurray station number 07da001 these indicators were pre screened as the candidate inputs independent variables of the models based on two criteria availability before river ice breakup and correlation with bds a total of 36 samples of the whole dataset were collected to examine the models performances due to the limited data the loocv method with total 36 runs was employed 4 results analysis 4 1 selection of input variables affecting bds to illustrate the pre screening function of the filter step of the proposed ivs method the rankings of temperature and river flow indicators are displayed in figs 4 and 5 in total 17 candidate input variables were selected tables 1 and 2 temperatures at fort mcmurray are assumed as driving factors affecting the breakup timing while the river flows near fort mcmurray are closely corresponding to changes in river ice breakup conditions however accurate indicator selection for the modeling purpose is a challenge the linear and nonlinear correlation coefficients r and mi between the breakup dates and 72 weather condition indicators monthly maximum minimum and average of the daily maximum minimum and average temperatures from the previous september to the current april are listed in fig 4 fig 4 shows that most of the temperatures in march and april before and during breakup have significant negative linear correlations with breakup dates blue grids while those in previous september before freeze up have significant weak positive linear correlations yellow grids based on the rankings 9 temperature indicators with higher absolute values of either r or mi were chosen as candidate inputs for member models the statistics of these input variables in 1980 2015 are listed in table 1 similarly the linear and nonlinear correlation coefficients r and mi between the breakup dates and 24 river flow indicators monthly maximum minimum and average flows from the previous september to the current april are listed in fig 5 the monthly minimum and average river flows in previous november and current march and april have significant negative linear correlations with breakup dates in comparison all the river flow indicators have higher mi values fig 5b than temperature indicators fig 4b based on the rankings 8 river flow indicators with higher absolute values of either r or mi were chosen as candidate inputs for member models as well the statistics of these input variables in 1980 2015 are listed in table 2 it is noted that the temperature and water flows in april which have the most significant correlation coefficients cannot be directly used as inputs in the models since breakup at fort mcmurray may happen in early april most of these linear correlation coefficients are negative which implies that higher daily temperatures and larger river flow volumes would bring about earlier breakup dates especially in terms of the linear correlation x4 average of daily min temperatures in march and x 17 minimum of daily water flow in last november have the highest absolute value of r 0 5060 and 0 4568 as for the nonlinear correlation x13 maximum of daily water flow in march and x 14 maximum of daily water flow in last september have the highest absolute value of mi 3 8429 and 3 8429 4 2 structure and performance of member model 1 brann in the wrapper step of the proposed ivs method multiple combinations of inputs random seeds and internal configuration parameters were searched to identify the structure of the brann models with optimal performances especially the model s parameter number should be at least less than the sample number to constrain the calibration since the sample number in the training sets are 35 in the loocv method the 2 to 7 input brann models should have a maximum of 8 6 5 4 4 and 3 nodes in the hidden layer respectively table 3 lists the representative structures and performances of developed brann member models all of the representative brann member models with certain inputs have 2 nodes in the hidden layer which implies the input may have more effect on their performance than the node number in the hidden layer meanwhile the brann with 6 or 7 inputs have better performance in terms of lower rseavg for validation as well as higher ravg and lower rmseavg for training thus brann5 y1 brann6 y2 and brann7 y3 were chosen as the representative ann member models for further combination in the ensemble framework due to their better performances among them brann6 with 6 inputs has the best validation performance 3 22 for rseavg and the second best training performance 0 9157 for ravg and 2 05 for rmse brann5 has a very similar performance to brann6 since the difference between their structures is input x2 or x4 brann7 with 7 inputs has the third best validation performance 3 36 for rseavg and the best training performance 0 9366 for ravg and 1 82 for rmse due to the best validation performance among brann models brann6 is considered the optimal model among this type of member models 4 3 structure and performance of member model 2 anfis the anfis usually has 4 hidden layers which are larger than the single hidden layer of brann due to the larger hidden layer number of anfis limited number of inputs should be selected to constrain the model s structure and avoid over fitting based on equations 7 to 10 due to the 35 training samples in loocv the anfis can have a maximum of 2 inputs which corresponds to 24 internal parameters thus in the wrapper ivs method for anfis member models multiple combinations of inputs were selected by discarding one or two independent variables from all candidate ones to evaluate the predictive performance of the anfis in table 3 the anfis member modes with the top 4 highest performance are listed all of these anfis models have only two selected input variables this might be because more or less inputs would cause over fitting or under fitting which is especially true in river ice modeling when the scale of available dataset is relatively small among the representative anfis member models anfis1 y4 anfis2 y5 and anfis3 y6 have better training and validation performance and are chosen as candidate member models in the ensemble framework anfis1 has the optimal training and validation performance in its type in terms of the lowest rseavg 3 92 the highest ravg 0 8423 and the lowest rmse 2 78 respectively therefore anfis3 is considered the optimal anfis member model to further enhance the diversity of member models anfis2 and anfis3 with slightly worse performance than anfis1 are also selected 4 4 comparisons for candidate member models since the prediction performance of unknown samples is of most concern validation performance for the candidate brann and anfis member models are further compared in fig 6 it can be seen that the scattered points for brann models are generally more aggregated than those for anfis models which indicates that the performance of the former is generally better than those of the latter especially both brann5 and brann6 can predict bds well in the middle levels but slightly over estimate and under estimate bds for the earliest and latest levels respectively in comparison the differences between the predicted bds by the anfis models and the observed bds are relatively large at different levels the worse performance of anfis may be due to the fact that its structure complexity is constrained by the small sample number the two limited inputs of anfis models indicate that useful input information is not fully considered in addition the structure complexity of brann member models is simpler than that of anfis models both brann5 and brann6 have the 6 2 1 structure if the bias nodes in input and hidden layers are considered they have in total 11 nodes including 7 3 and 1 node s in input hidden and output layers respectively the brann7 has one more inputs with the structure of 7 2 1 all the anfis models have a 5 layer structure with 4 nodes in each layer and therefore a total of 23 nodes thus the brann member models generally outperform the anfis member models in this study in terms of better performance and simpler structure 4 5 input variable comparisons of optimal member models it is worthy to exam the linear and nonlinear rankings of the inputs included in the optimal member models so that the effect of the filter method on the member model s performance can be revealed fig 7 shows the input comparisons of the optimal member models according to their rankings based on the r and the mi indices it can be found that the top 6 or 7 linearly or nonlinearly correlated inputs with higher absolute r or mi values are not included in the optimal brann models similarly the x1 and x6 of anfis1 are not the top 2 ranked inputs based on the r and the mi indices either it may indicate that these inputs have interactive correlations with the output or can be more beneficial in constructing the features used for member models in addition the lowest r rankings of inputs for brann5 brann6 brann7 and anfis1 are 12 15 15 and 12 respectively it means if the top 12 linearly correlated inputs are included in the filter method the optimal brann6 and anfis1 can also be obtained through the following loocv method in comparison the lowest mi rankings of inputs for brann5 brann6 brann7 and anfis1 are all 17 the difference between the r and mi rankings for inputs in the optimal member models may imply that the filter method merely based on linear correlation ranking appears more efficient for initial selection of candidate inputs than that based on nonlinear correlation ranking meanwhile some inputs e g x12 with higher linear correlation rankings also have higher nonlinear correlation rankings although the linear correlation based ivs method is usually criticized for its limited ability in handling nonlinearity maier et al 2010 this method would be feasible to generate a range of candidate inputs which can be further screened through other wrapper or embedded ivs methods 4 6 structure and performance of ensemble learning combining models the combining models were calibrated based on the outputs of 6 member models y1 to y6 with optimal performance which were calibrated individually in nature selection of member models is also an ivs problem in the viewpoint of inputs of combining models due to the limited number of optimal member models a greedy searching method was employed to evaluate the performance of combining models with all possible combinations of 6 member models table 4 shows the structure and performance of representative ensemble combining models in each type with higher performance under different combinations of inputs among the sam models ensam3 has the best validation performance in terms of the lowest rseavg 2 72 however the differences of validation performance among these sam models are very small the ensam1 has the simplest structure two member models y2 and y3 while the ensam3 combines 5 member models among the brann combining models enbrann3 has the lowest rseavg 2 83 but very similar performance to other brann models among the anfis combining models enanfis3 has the best validation performance 3 38 for rseavg the optimal ensemble combining models in each type were selected as ensam1 ensam3 enbrann3 and enanfis3 respectively to further compare the optimal ensemble models in each type fig 8 shows a validation performance comparison the closer distance between the data dots and the equal value line for these combining models clearly indicates improved performance for these optimal combining models 4 7 the optimal ensemble learning combining models to further compare member and combining models fig 9 shows the distributions of the performance indices for the optimal 6 member and 4 combining models in training the r distributions of combining models are generally higher than those of optimal member models the rmse distributions of the former are basically lower than those of the latter in validation the se distributions for the combining models except for enanfis3 are generally lower than those of member models the se distributions of ensam and enann between the 25th and 75th percentiles are narrower than those of these member models as well the comparison of these distributions further indicates that the combining models have better performance ranking than the member models among the combining models the extreme values of se for ensam1 are lower than those of ensam3 the se distributions of ensam1 between the 25th and 75th percentiles are slightly wider and higher than those of ensam3 due to the simpler structure of ensam1 and the similar performances between two ensam models ensam1 is considered the optimal ensemble learning combining models the ensam1 combines two outputs from two brann member models brann6 and brann7 which have 6 and 7 inputs and also share 3 inputs x1 x6 and x12 the structure of ensam1 is illustrated in fig 10 in terms of seavg values the ensam1 improves upon brann6 and brann7 by 14 6 and 18 1 respectively 5 discussion the proposed framework of stacking ensemble prediction for annual river ice breakup dates is promising since its improvement over each optimal member model is demonstrated in fact the combining manner also exists in all member models themselves especially for brann and anfis since they have the multiple layer structure in terms of the optimal combining type although the sam is the best combining model in this study other combining models may outperform for other forecasting problems it is noted that inclusion of all candidate member models cannot guarantee better performance from the ensemble perspective the proposed framework can be categorized as either a deterministic stacking ensemble learning or as a hybrid modeling manner so called multi model data combinations or fusion abrahart and see 2002 there are many types of ensemble frameworks including boosting and bagging anctil and lauzon 2004 zaier et al 2010 which can be further applied to river ice forecasting problems in the future when a large number of member models are employed uncertain forecasts with confidence intervals can be generated for the ensemble framework which would help forecasters to analyze the uncertainties involved in the forecasting results different modellers forecasters or managers may evaluate the varying performance of each tested model based on their own preferences and criteria in comparison among some optimal combining models the differences in rmseavg and ravg for training sets and rseavg for validation sets appear to be small however these indices are based on an average of 36 years using the loocv method so that the absolute differences should not be neglected for example the forecast difference for certain years using the developed models may be a few days it is always desirous of improving the model s prediction capability so that more preparation time can be reserved for managers to mobilize resources for emerging ice related flood events the indicators and observed bds are the basic information for calibrating and validating the models their quality may directly affect the performance of the models uncertainty in the bds may originate from its various theoretical definitions and practical observation difficulties in some reaches for example the long term historical records of breakup dates are collected by observers in different organizations with different experience the definitions employed by these observers affect the reported values of the breakup date when breakup happens in the early morning or late at night without confirmed observation differences may exist between the claimed breakup date and the real one if aerial observation is not implemented to ascertain the river ice conditions limitations of ground observation may also bring out some errors in determining the breakup date breakup dates are the culmination of the annual river ice breakup event as long as the breakup date is forecast well ahead of breakup it can provide timely and feasible information for supporting the decision making required to mobilize resources from local provincial or federal agencies in our study the historical breakup dates at the confluence between the athabasca and clearwater rivers are between april 9 and may 9 all inputs required for the developed models can be obtained before april 1st so that the forecast can be calculated at least 1 week ahead of the known earliest breakup date it is noted that timely bd forecasting models are different from near real time hydrological models which are usually developed to obtain daily or hourly river flows or levels during events in open water conditions to make these forecasting models operational the inputs should be available well ahead of breakup the selected candidate indicators in this study are mainly monthly average temperatures and river flows downstream of the investigated site some different inputs have been used in previous studies on breakup date prediction such as accumulated air temperature ice thickness discharges at an upstream station tao et al 2008 in addition although river flow may not be as accurate as river level it is still employed as one type of indicator since there are more readily available records of river flow from water survey of canada than river level if there are more correlated candidate indicators available at other study sites search algorithms e g the advanced wrapper method or genetic algorithm can be utilized to select the optimal combination of inputs durand et al 2007 hejazi and cai 2009 may et al 2008 river ice breakup is usually a site specific problem although the first last b dates and river levels flows are available for most gauges operated by water survey of canada it is difficult to identify the breakup dates merely based on these data without years of on site observation or acquaintance with the local river ice conditions meanwhile identification of the corresponding indicators correlated to breakup dates is based on not only multiple input variable selection procedures but also the forecasters understanding and experience regarding the ice regime of the study river for these reasons the current data driven based river ice study is focused on a single site along the river mahabir et al 2005 zhao et al 2012 application of the proposed method to new sites on the athabasca river and other northern rivers is worthy of further investigation 6 conclusions a framework of stacking ensemble prediction for annual river ice breakup dates bd was developed the historical breakup dates for the athabasca river at fort mcmurray and the candidate indicators weather and flow conditions in 1980 2015 were collected to facilitate the comparison of member and combining models within the proposed ensemble framework the input variables for member models were selected by a hybrid filter and wrapper method the performance of these models was examined using the loocv the major findings are as follows 1 temperatures at fort mcmurray are assumed as the driving factors affecting the breakup timing while the river flows near fort mcmurray correspond closely to changes in the river ice conditions especially temperatures in march and april have significant negative linear correlations with breakup dates 2 two types of member models are able to build nonlinear relationships between indicators and bd with different performance the brann member models generally outperform the anfis member models in this study in terms of better performance and simpler structure 3 the sam and brann combining models generally outperform all types of member models while the anfis combining models cannot outperform the brann member models the optimal sam combining model ensam1 combines two outputs from two brann member models and improves upon them in terms of seavg values by 14 6 and 18 1 respectively 4 the difference between the r and the mi rankings of inputs in the optimal member models may imply that the filter method based merely on linear correlation ranking appears more efficient than that based on nonlinear correlation rankings the linear correlation based filter method would be feasible to generate a range of candidate inputs for further screening through other wrapper or embedded ivs methods and 5 this study for the first time applies the ensemble methods to forecasting of river ice breakup dates combining the diverse abilities of various river ice forecasting models through the ensemble technology appears promising for other river ice forecasting problems acknowledgements this study is financially supported by alberta environment and parks the authors would like to acknowledge the support of the current and previous river ice forecasting team members at alberta environment and parks nadia kovachis watson stefan emmer patricia stevenson evan friesenhan andun jevne and chandra mahabir the first author is grateful for the support from the hundred talents program of sun yat sen university we are deeply grateful to the reviewers for their insightful and careful comments and suggestions which have helped to improve the paper greatly 
