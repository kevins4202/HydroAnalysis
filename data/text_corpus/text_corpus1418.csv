index,text
7090,for large contaminant plumes in groundwater pump and treat pt is usually applied not only to remediate the aquifer but also to control the spreading of the plume the aquifer structure as well as the spatial distribution of the contaminant plume are typically subject to uncertainty this uncertainty can highly effect the remediation predictions geostatistical tools combined with monte carlo simulations can be used to quantify those uncertainties and to provide a more established basis for decision makers regarding the remediation strategy here we focus on a case study of a polluted aquifer and inspect its response to remediation by a pt scheme using two pumping wells the aquifer structure is combined of 4 lithological units and indicator realizations were generated using a modified sequential indicator simulation sis approach then the initial plume prior to remediation was estimated by a forward predictive model as a result each realization had a unique spatial distribution of the contaminant at the onset of the remediation spatio temporal measurements of head and contaminant concentration were used to screen inappropriate realizations our results have shown that conditioning the realizations to the head alone has a minor effect upon the uncertainty regarding the remediation efficiency re on the other hand by conditioning the realizations to both head and concentrations the uncertainty was reduced by more than 35 in terms of the standard deviation of re risk analysis for the migration of the plume showed that the ability of the current configuration of the remediation wells to control the plume is limited to the top layers of the aquifer thus with the present monitoring network there is a significant risk that the plume will migrate downstream towards production wells without being noticed 1 introduction and background reliable predictions of pollutant transport in aquifers have a major rule in the management and protection of the aquifer based on predictions we can perform risk analysis and manage production wells e g hobbs et al 1988 li et al 2007 maxwell et al 1998 and make decisions regarding a suitable remediation strategy for the contaminated aquifer e g guo and brusseau 2017 wagner and gorelick 1989 zheng and wang 2002 however the complex processes of sediments deposition and erosion that generates the aquifer s geological structure may result in a highly heterogeneous spatial distribution of hydrogeological parameters huysmans and dassargues 2009 klingbeil et al 1999 ritzi and allen king 2007 among those parameters the most drastic changes are typically of the hydraulic conductivity whose values can vary by several orders of magnitudes over a relatively small spatial scale e g bohling et al 2012 due to the scarcity of data the hydraulic conductivity spatial variability which has a dominant effect upon pollutant transport is subject to uncertainty dagan 1989 gelhar 1993 rubin 2003 in typical contaminated sites the decision to perform remediation is usually based on an extensive survey of the site generally such a survey aims to delineate the extent of the plume and the location and magnitude of the source a key component of this survey is concentration data obtained from monitoring wells which are installed in typical setups mostly near the contamination source in addition due to the cost of drilling deep monitoring wells it is typical to use shallow monitoring wells except when dense non aqueous phase contaminant is involved this is not the case here therefore for most polluted sites the limited spatial coverage beyond the source location and in the deep layers of the aquifer results in an additional uncertainty regarding the initial conditions i e the spatial distribution of the plume prior to remediation quantifying those uncertainties is crucial for making rational decisions regarding the remediation strategy in this work we focus on a specific contaminated site in the eastern part of the israeli coastal plain aquifer icpa the site is heavily polluted by a nearby industrial facility and the contaminant plume poses a risk to the water quality of nearby production wells thus remediation via pump and treat is planned for the site by the israel water authority further details are provided in section 2 the question that arises is what would be the expected efficiency of such remediation another important question is how the uncertainties in flow and transport affect the uncertainty in the remediation efficiency a conventional approach to answer the first question is to use a deterministic model where the hydraulic parameters are obtained by a parameter estimation i e calibration process via solving an inverse problem usually by using the flow equation and measured heads e g ala aho et al 2015 nocchi and salleolini 2013 pool et al 2015 in some cases additional data is used for the calibration process such as the measured concentrations e g barlebo et al 2004 or the bulk electrical resistivity e g moreno et al 2015 however this inverse problem is ill posed and is non unique in nature ebel and loague 2006 sun 2013 yeh 1986 besides deterministic models consider only one possible structure of the aquifer hence they do not quantify in a systematic manner the uncertainty neither of flow nor of transport geostatistical tools combined with monte carlo simulations are a useful method to quantify the uncertainty regarding the pollutant fate in heterogeneous aquifers the main purpose of these tools is to construct high resolution models of the relevant random variables see e g reviews by deutsch 2007 kitanidis 1997 pyrcz and deutsch 2014 the random parameter can be either discrete e g lithological facies or continuous e g porosity hydraulic conductivity etc first a large set of such realizations is constructed and then each realization forms the basis for a numerical simulation of flow and transport the uncertainty regarding the pollutant fate is estimated from the statistics of the results obtained by these simulations in this study a discrete approach i e lithological facies was adopted to generate different realizations of the aquifer structure the facies approach is commonly used in hydrogeology e g dell arciprete et al 2012 fogg et al 1998 zhang et al 2013 and several methods were developed in order to construct facies based realizations among those methods the most commonly used are sequential indicator simulations sis deutsch and journel 1998 goovaerts 1997 transition probability t progs carle and fogg 1996 carle 1999 ritzi 2000 and multiple point simulation mps liu et al 2005 strebelle 2002 while the first two i e sis and t progs are based on random function models and rely on available quantitative data derived directly from boreholes mps relies on a training image there are multiple works in the literature where the plume shape in heterogeneous environment was reproduced by combining monte carlo simulations and geostatistical tools e g bianchi and zheng 2016 dogan et al 2014 ptak et al 2004 several studies examined the remediation of a polluted aquifer in a heterogeneous environment guo and brusseau 2017 maxwell et al 2008 moreno and paster 2017 rivett et al 2006 schäfer and kinzelbach 1992 zheng and wang 2002 pedretti et al 2017 however to the best of our knowledge a combination of reproducing the plume shape and predicting remediation was never considered for a real contaminant site works that predicted remediation have assumed the plume shape is given and neglected its associated uncertainty upon remediation both schäfer and kinzelbach 1992 and guo and brusseau 2017 have assumed constant spatial concentration of the pollutant moreno and paster 2017 have assumed a gaussian shaped plume zheng and wang 2002 have used spatial interpolation based on field samples and although maxwell et al 2008 and rivett et al 2006 have applied forward modeling to reproduce the initial plume shape they used it either for a hypothetical case maxwell et al 2008 or assuming a homogenous aquifer rivett et al 2006 the aim of this study is to estimate the remediation efficiency re in this site and to quantify its uncertainty in this work the remediation efficiency is defined as the fraction of the pollutant that was removed from the aquifer during remediation relative to the total amount of contaminant in the aquifer before starting the remediation this uncertainty in re is associated with the spatial variability of the aquifer hydraulic conductivity and with the spatial distribution of the plume concentration at the inception of the remediation process in contrast with previous works that assumed a given shape of the plume the initial condition for the spatial distribution of the contaminant at the commencement of the remediation is obtained here by a forward predictive model hence each realization is distinctly different from the rest of the ensemble in terms of the initial conditions for the remediation note that those differences stem solely from the uncertainty in the geological structure since we assume the source boundary condition to be known nevertheless the present concertation data are accounted for indirectly by conditioning the structure on the measured values the paper is organized as follows the site description section contains a brief description of the polluted site the methods section provides details on the numerical model and geostatistical properties of the aquifer the results and discussion section presents the results obtained by the forward predictive model as well as the predicted remediation efficiency and uncertainty this section also includes an analysis of the risk for migration towards production wells the work is summarized in the summary and conclusions section 2 site description the site under consideration in this study is located at a distance of 12 km from the mediterranean coast in the central part of the icpa the water table in the site is found at a depth of 40 m below ground level and the aquifer has a thickness of 30 m the contaminant can be regarded as a passive tracer and does not occur in groundwater naturally the source of the contaminant is seepage from drainage pits in a classified industrial facility at the site during the period of 1960 2006 significant concentrations at the order of 100 ppm were found in the vicinity of the site and smaller concentrations at the range of 10 s 100 s ppb were found at a distance of 2 km downstream from the source see fig 1 the recommended standard for the contaminant in drinking water is 15 ppb additional details on the site were given in moreno and paster 2017 the migrating plume is expected to pose a risk to downstream production wells hence the israel water authority decided to perform an in situ remediation by two remediation wells 1 an existing but currently disabled production well at the western edge of the plume and 2 an additional shallow pumping well yet to be drilled close to the source where peak concentrations were measured the wells are planned to pump at rates of 50 and 100 m3 h and will be referred here as deep well and shallow well respectively see fig 1 as can be seen in fig 1 between the source and the downstream front of the plume there are only 2 monitoring wells located 1 km west of the site in addition the concentration measured values vary by 3 orders of magnitude from measurements at the industrial site to those measured at these two wells downstream from the source thus it is expected that the sparsity of monitoring wells and variability in the measured concentrations away from the source and in between the two remediation wells will result in a significant uncertainty in the prediction of the plume migration and the remediation efficiency 3 methods 3 1 construction of aquifer realizations the aquifer structure is modeled by facies decomposition the 4 facies sand clayey sand clay and gravel are characterized statistically by their volume fraction and indicator variograms which were identified by analysis of drilling logs of the 37 wells in the vicinity of the site data from those wells including spatial location was presented by moreno and paster 2017 the spatial auto correlations of the different formations were fitted to a theoretical model which assumes an exponential variogram with nugget kitanidis 1997 1 γ i h ϕ σ i 2 1 d ϕ i e h ϕ l ϕ i where ϕ is the direction h is the lag distance and i is the lithological unit index since the variance is given by σ i 2 p i 1 p i where p i is the known global proportion of the lithological unit i ritzi 2000 rubin 1995 the fitted parameters were the correlation length scale l i and the correlated weight 0 d i 1 for d i 1 1 becomes an exponential variogram while for d i 0 it becomes a pure nugget fig 2 shows the fitted variograms in both directions i e horizontal continuous lines and circles and vertical dashed lines and crosses since the horizontal distances are greater by more than an order of magnitude than the vertical ones and σ sand 2 3 σ gravel 2 the variograms are presented on a log log scale to present both directions and all facies on the same plot an arithmic scale of the variograms is provided in apendix a the fitted parameters of 1 are given in table 1 as can be seen from fig 2 the experimental variograms are in a good agreement with the theoretical model i e 1 this is also evident by the r 2 value of the fit which varies between 0 93 and 0 98 see table 1 a monte carlo approach was adopted and n 1 1300 various realizations of the 3d structure were generated by using the sis method the realizations were conditioned on the known facies vertical distributions along the wells the algorithm used to generate realizations was based on the methodology of the sisim code a part of gslib deutsch and journel 1998 with some slight modifications to obtain more reliable structure of the aquifer in less computational time for the applied modifications to the sisim code the reader is referred to appendix a after constructing the realization each facies was assigned with a specific hydraulic conductivity k which was adopted from an existing preliminary investigation of the aquifer hydrogeology of the site conducted by yakirevich 2015 personal communication using modflow harbaugh et al 2000 with the pest package doherty et al 2011 and using measurements of the groundwater levels during 1976 1985 from 50 monitoring wells values of k for each facies and the corresponding relative sensitivity are presented in table 1 where the relative sensitivity was calculated as s i k i j 1 n d h j k i 2 n d 0 5 where h j is the calculated value of the hydraulic head at observation point j and k i is the hydraulic conductivity of facies i yakirevich 2015 personal communication showed a good agreement between the observed and simulated groundwater levels where the standard error was 0 9 m 3 2 modeling of flow and transport flow and transport for each realization were solved numerically using modflow harbaugh et al 2000 for flow and mt3dms zheng and wang 1999 for transport using the hybrid method of characteristics hmoc package for advection due to its suitability to model sharp concentration fronts and to provide an accurate solution to the transport problem over the entire range of peclet numbers with virtually no numerical dispersion zheng and wang 1999 transport was assumed to be purely advective i e diffusion and dispersion were neglected pore scale dispersion was neglected due to its minor effect upon longitudinal spreading in heterogeneous formations e g fiori and dagan 1999 for weakly variable formations to test this assumption we compared the results of few realizations with and without diffusion and dispersion these results which are provided in appendix b figs b 2 and b 3 show that diffusion and dispersion can be neglected in this work those findings are also supported by jankovic et al 2017 which demonstrated that local dispersion has a minor effect on the breakthrough curve for highly heterogeneous aquifers and in riva et al 2006 and riva et al 2008 who study the transport mechanism adopted for the numerical simulations advection advection dispersion and or mass transfer impact on the solute breakthrough curve at lauswiesen experimental site and came to the same conclusion i e that dispersion has a minor effect on the breakthrough curve in heterogeneous medium in addition when considering diffusion the obtained peclet number is significantly large i e pe 1 rolle et al 2013 showed that when the peclet number is high the plume shape is determined mostly from the variability in the velocity field therefore the minor effect of diffusion in our case was expected due to previous findings the numerical solution was carried out in two stages time periods 1 a forward model simulating the plume spreading from the beginning of contamination seepage until remediation begins between the years 2000 and 2020 will be referred to as stage i and 2 future prediction of remediation between the years 2020 and 2050 will be referred to as stage ii stage i was used to condition the realizations on the hydraulic head and pollutant concentration measurements note that the term conditioning is associated here with the removal screening of realizations that deviate significantly from the measurements head and concentration stage ii provides the remediation efficiency of each realization a full description of the numerical domain boundary and initial conditions along with the grid size for both stages is provided in appendix b herein only the general features are presented in stage i 3d flow and transport were solved for each one of the n 1 1300 realizations in order to determine the pollutant distribution 20 years after the inception of the pollution process spatiotemporal uncertainty regarding the source was neglected in this work instead the boundary conditions for the pollutant were treated as constant concentration recharge at fixed 5 areal locations identified by yakirevich 2015 personal communication full details are provided in appendix b concentration recharge values during the stage i period 2000 2020 were estimated from vadose zone investigations and spill history surveys and provide the average recharge of contaminant the adopted pollutant influx rates were assumed to be accurate 3 3 conditioning the realizations to measurements the solutions of stage i provide the hydraulic heads and concentrations prior to remediation conditioning the realizations to the measurements is achieved in two steps first the realizations were screened based on the measured hydraulic head in 13 monitoring wells at the proximity of the site the head data from these wells was considered to be reliable the root mean square error rmse of the measured head relative to the modeled head was calculated see details in appendix c the screening criterion was defined as rmse 1 m the realizations which pass this screening criterion were defined as the n 2 population additional screening of realizations was based on conditioning on concentration measurements here the screening criterion was defined differently by using the ratio between modeled and measured concentrations this ratio was allowed to be at the range of 0 1 to 10 and realizations which did not follow this criterion were removed from the population details are provided in appendix c this additional screening led to the reduction of the number of admissible realizations to n 3 n 2 it is important to note that contaminant concertation measurements in the industrial facility i e within the shaded polygon in fig 1 were not accounted for with an exception of 1 deep monitoring well well 15 therefore only 4 monitoring wells were used their locations in the numerical domain along with the measured values of the hydraulic head and pollutant concentration are provided in fig c 1 and table c 1 located in appendix c the concentration measurements in the shallow monitoring wells within the industrial facility were not used in the conditioning process due to the simplified boundary conditions that were applied the steady state flow along with constant concentration recharge at fixed locations cannot produce the large variability that was observed in concentration measurements inside the industrial facility i e close to the source in general the filtering criterions for both the hydraulic head and concentrations result from a balance between the need to remove unrealistic realizations on one hand and the need to keep a statistically significant number of valid realizations on the other hand this balance takes into account the fact that both the data and the modeling assumptions are not accurate the inaccuracies stem from multiple factors of which the main ones are 1 the assumption of steady flow 2 the specified boundary conditions of the model 3 the geostatistical model used to construct the facies structure 4 the use of a yearly mean value for the measurements and 5 the smearing of concentrations over the numerical cells the screening criterions that were used can also account for measurements errors since the later are significantly smaller than the first the overall effect of the model inaccuracies can be roughly estimated and used as a guideline in setting the screening criteria 1 m for head rmse and a factor of 10 for concentration the sensitivity of the results to the screening criteria was examined thus the final product i e remediation efficiency and uncertainty was evaluated with different screening intervals for the head and concentration it was found that mild changes in the screening intervals hardly affect the ensemble results these results and further details are provided in appendix c to summarize conditioning the realizations to the measurements was conducted by a forward modeling approach in principle one can use stochastic inversion methods to generate realizations conditioned to the head and concentration measurements see e g the thorough review by zhou et al 2014 however as will be shown in the results section the forward modeling approach was sufficient in our case to obtain reliable results within a reasonable computational effort it is worth mentioning that the technique used here bears similarities with the acceptance rejection methods used in stochastic inversion methods e g markov chain monte carlo oliver et al 1997 zhou et al 2014 3 4 remediation efficiency and uncertainty stage ii of the numerical simulations represents the remediation phase in this stage the 2 remediation wells pump at constant rates and flow and transport are solved for 30 years for the complete set of n 1 realizations the concentrations of the pollutant at the end of stage i serve as initial condition for stage ii stage ii solution provides the remediation efficiency re which is defined by the ratio of the pumped mass by the two remediation wells and the initial mass of the contaminant 2 re t m pumped t m in where 3 m in j 1 m t 0 t 20 years a j c j rdt here j indicates the source index m 5 is the total number of sources at the site a j is the areal size of source j c j is the source concentration and r is the natural recharge rate note that m in is fixed for all realizations as the boundary conditions for all the realizations are similar details on the sources are provided in appendix b due to the randomness of both the initial conditions of the plume resulting from stage i and the heterogeneous structure of the aquifer i e k x y z re is a random variable a flowchart that summarizes the procedures is provided in fig 3 4 results and discussion 4 1 initial plume shape and uncertainty stage i solution the initial set of realizations contained n 1 1300 individual realizations as mentioned above the first screening of realizations was based on measured heads this screening led to a reduction of the total number of realizations to n 2 600 thus 46 of the n 1 population was accepted the acceptance rate of realizations based on the measured head can be considered as having a limited impact on screening which can be explained by the relative insensitivity of the hydraulic head levels to the structure of the aquifer in addition we would like to note that those results are not unique to our case and were also reported in previous works e g dogan et al 2014 the ensemble mean and std of the head for the n 1 and n 2 populations is shown in fig 4 note that at the assumed constant head boundaries where the head is set by the model the std is zero also note that although this filtering reduced the population significantly the mean head value was only slightly affected fig 4a b in contrast the screening had reduced the variability where the standard deviation decreased by a factor of 2 in the entire model domain fig 4c d the second screening step based on comparing the modeled concentrations with measured values resulted in n 3 115 accepted realizations 19 of the n 2 population in fig 5 the distributions of simulated log concentration at the monitoring wells for both n 2 and n 3 populations are shown the corresponding distributions for the n 1 population were similar to the ones derived for the n 2 population hence they are not shown in this figure as observed in this figure the distributions of the simulated log concentrations of the n 3 population are significantly narrower relative to the n 2 population thus the n 3 population presumably provides a more accurate initial condition for the plume and is expected to yield a more accurate prediction of the remediation fig 5 also shows the ensemble means of the log concentrations of the n 2 and n 3 populations we observe that while distributions were significantly different the means are similar and match the measured log concentrations in locations where the concentrations are relatively high boreholes 18 and 19 fig 5a d an exception to this observation is in borehole 23 fig 5e where screening based on concentration significantly improved the agreement between the ensemble mean of realizations and the measured value in contrast in borehole 15 where the measured concentration is the lowest value of all measurements 6 ppb see fig 5f the model shows a significant mismatch of the measurement note however that this deviation is 5 ppb and is expected to have a negligible effect upon remediation efficiency here it is also worth mentioning that previous works bianchi and zheng 2016 dogan et al 2014 ptak et al 2004 refer to the match between the measured concentrations and the mean or median of the simulated concentrations as an indication of a satisfactory representation of the aquifer structure in the numerical simulations fig 6 shows the initial concentrations for the remediation simulation of 2 randomly chosen realizations from the n 3 set this figure is a good illustration of the significant differences between realizations in terms of the initial conditions of stage ii indeed the limited available data regarding the pollutant concentrations results in a significant uncertainty in the initial plume shape the vertical variations of concentrations may explain these deviations while measured concentrations at monitoring wells were provided as a single value they actually represent a flux weighted average of vertically distributed concentrations over the screen of the well note that the monitoring wells screen extend over several vertical integral scales see appendix c for further details hence concentrations in distinct realizations can vary greatly within the vertical profile of the well s screen and yet produce a similar average value see e g tonina and bellin 2008 who report a similar effect however it is worth noting that in our case the variation of concentration close to the source is rather limited due to the relatively dense amount of available borehole data near the source 4 2 remediation efficiency and uncertainty stage ii solution to examine the impact of each level of conditioning on re simulations of stage ii were carried for the entire n 1 population i e for the entire 1300 realizations fig 7 a shows the ensemble mean value re t as a function of time for the n 1 n 2 and n 3 populations the uncertainty in re t is quantified by the probability density function pdf of re at t 3 10 16 and 24 years the histogram of re at the end of the remediation simulation i e after 30 years of remediation for each population is depicted in fig 7b d as shown in fig 7 both screening levels have a notable effect upon the predictions of remediation throughout the entire simulation period the mean standard deviation and the shape of the distribution change between the populations the first screening i e conditioning to the hydraulic head alone n 2 led to an increase in the predicted mean by 15 at the end of the remediation simulation from 0 54 in n 1 to 0 62 in n 2 at the same time the standard deviation reduced from 0 14 to 0 12 i e by a similar factor the second screening level by concentrations had a mild effect on the mean re an increase of 6 from re 0 62 to re 0 66 between n 2 and n 3 populations this slight change in mean re can be attributed to the good match for both populations between the ensemble mean of realizations and the measurements as shown in fig 5 in contrast to the slight change in the mean the uncertainty was considerably reduced as the standard deviation decreased by 25 from 0 12 to 0 09 this significant reduction can be attributed to the notable effect of conditioning the realizations to the measured concentrations which limits the possible distributions of the initial plume moreover it is important to note that although the mean efficiency and uncertainty were estimated from the entire population size i e 1300 realizations for the n 1 population and 115 realizations for the n 3 population convergence tests shown in appendix d indicated that for the n 3 population convergence was achieved after 55 realizations as opposed to 316 realizations for the n 1 population this fast convergence shortens the computational time for prediction by a factor of 3 this significant saving is due to the fact that most of the computational effort is devoted to the simulation of transport in stage ii and this effort is conducted over a notably smaller population size 55 for n 3 as opposed to 316 for n 1 for example for a pc with intel core i7 4510u processor and 8 gb ram the computational time for stage i is 4 min and for stage ii is 40 min thus for the 55 realizations of the n 3 population the computational effort is roughly 78 h as opposed to a total 232 h for the n 1 population which includes 316 realizations 4 3 risk assessment in addition to remediation the risk involved with contamination was evaluated before and after the remediation stage the risk is defined here as the probability that the concentrations in a certain location will exceed the standard for the contaminant 15 ppb to this end only the n 3 population is considered and for each realization in this population we define the indicator 4 i x y z t 0 c x y z t 15 ppb 1 c x y z t 15 ppb then the risk was evaluated by performing an ensemble mean over the values of i fig 8 shows the computed risk at 2 elevations 28 and 0 m with respect to sea level at two different times before remediation had started i e t 0 and at the end of the remediation simulation i e t 30 years note that fig 8 does not represent concentrations but the probability of the concentration to exceed the standard the risk analysis shows that at shallow depths the spatial extent of high risks reduces due to remediation fig 8a and b in addition the risk that the pollutant will migrate northwest during the remediation stage is close to zero fig 8b thus remediation at this current configuration shallow well close to the source and deep well far from it controls the spreading of the plume close to the aquifer top however a different behavior can be noticed at the deeper layer of the aquifer from fig 8c it can be seen that the risk of contamination prior to remediation was below 60 at the end of the remediation stage fig 8d the risk for contamination was above 80 and in contrast to the shallow layer the contaminant is migrating seaward northwest and escapes the well s capture zone if additional monitoring wells will be drilled in the downstream side of the well care must be taken w r t their depth as we have observed shallow monitoring wells are susceptible to be blind to the migration of the contaminant towards production wells this may raise questions about their ability to identify this risk in a timely manner 5 summary and conclusions in this work the response of a contaminant plume to a pump and treat remediation scheme was studied the main focus of this work was to quantify the remediation efficiency and its uncertainty and to assess the different conditioning levels head and concentration measurements impact upon it different realizations of the aquifer structure conditioned on facies measurements were generated based on a common indicator approach sis with slight modifications as opposed to previous similar works the pre remediation plume distribution was evaluated here by solving the direct problem of transport from the source to the remediation wells i e forward predictive modeling rather than assuming an initial distribution of the pollutant realizations were compared with spatial measurements of the hydraulic head and concentration measurements the ensemble mean of the simulated head and concentrations for both conditioning levels i e n 2 and n 3 populations had a good agreement with the measurements at the monitoring wells indicating a satisfactory representation of the aquifer structure still simulated concentrations of the pollutant for the final level of conditioning i e the n 3 population revealed a significant variability in the spatial concentrations prior to remediation each level of conditioning effected the remediation efficiency projection the first conditioning level i e hydraulic head mostly affected the mean value of re which increased by 15 on the other hand the uncertainty remained practically the same in terms of standard deviation and distribution shape the second conditioning level to the hydraulic head and concentration measurements had a little effect on the mean an increase of 6 and led to a significant reduction in the uncertainty of re as the standard deviation of re reduced by 25 our results have shown that the proposed configuration of the remediation wells i e a shallow well close to the source and a deep well at a distance of 1 km from the shallow well does not completely control the plume which will migrate downstream towards production wells this migration is likely to occur close to aquifer base due to the cost of deep drilling and the limited amount of deep monitoring wells chances of monitoring the contaminant plume migration are low consequentially it may pose a risk to downstream production wells hence further work is needed to search for a better remediation setup for the site such work shall address the problem of optimization of the remediation wells spatial locations and discharge rate in order to obtain a more efficient remediation of lower uncertainty and risk to production wells the forward predictive modeling of the initial plume distribution allowed the quantification of the mean remediation efficiency and uncertainty along with the risk involved for the plume migration in a physically reliable manner an alternative to our approach is to assume some simplified shape of the pollutant plume or to use spatial interpolations as is commonly done such approaches are controversial as they may lead to the assignment of high concentrations in low permeable zones where transport is dominated by diffusion this is especially likely when spatial measurements of the contaminant used for the interpolation are sparsely scattered clearly such assumptions can cause the numerical predictions of the remediation to display a stagnation of high concentrations and strong tailing effect and may lead to a questionable decision making the forward predictive model eliminates those artifacts since the transport of pollutant into low permeable zones is restricted to our knowledge this issue has not received proper attention in the literature even though this study is conducted on a particular site in the icpa it shares many features with other contaminated sites geological data is typically limited and mostly relies on lithology moreover in many cases the monitoring of the contaminant is mostly shallow and sparsely located away from the contaminant source this may lead to significant uncertainty in terms of the present concentration distribution thus the results and the conclusions drawn here may be applicable with proper adjustments at other similar sites acknowledgments we thank the editor the two anonymous reviewers and prof alberto guadagnini for their comments on an early version of this manuscript which helped to improve it considerably we are also grateful to prof gedeon dagan for fruitful discussions and comments regarding the manuscript we thank prof alexander yakirevich for providing useful information regarding the site we are also grateful to the israeli water authority for the financial support of this research a p acknowledges the support of tau s vp of r d appendix a modifications applied to sisim and variograms on an arithmetic scale fig a 1 shows the fitted variograms in both directions i e vertical a and horizontal b on an arithmetic scale the following modifications were applied in the sisim code used here 1 in sisim nugget is equal in all directions the fitted parameters of the auto variograms fig 2 and table 1 indicate that the formations are fully correlated in the vertical direction i e d i 1 on the other hand sand and gravel show a small discontinuity in the horizontal direction where d i is 0 96 for sand and 0 84 for gravel thus the theoretical variograms were calculated as 5 γ i σ i 2 1 d i exp h v l vi 2 h h l hi 2 h h 0 σ i 2 1 exp h v l vi h h 0 where h v and h h are the vertical and horizontal lag distances correspondingly 2 previous studies have shown that sequential simulations are less likely to generate connected bodies in the horizontal direction than the vertical one bianchi et al 2011 he et al 2009 lee et al 2007 sisim uses a limited number of the nearby informed nodes to evaluate probability of each formation we assume that the cause of a less connective body in the horizontal direction is due to the low amount of informed nodes in the horizontal direction compare to the vertical one since horizontal distances are larger by more than an order of magnitude than vertical distances thus to generate more connected bodies in the horizontal direction we gave more weight to horizontal distances where an anisotropy ratio of 10 was applied for the search of the informed nodes 3 to reduce the computational time when the nearest informed node is located at a distance 3 times the correlation length scale l the lithological unit was determined randomly according to the global proportions appendix b numerical model domain and boundary conditions an aerial view of the model s domain grid and boundary conditions for both stages is provided in fig b 1 the model domain was chosen based on the contaminant measurements and the 2 suggested remediation wells location exact locations of the remediation wells on the numerical grid are provided in table b 1 and fig b 1 the horizontal extent of the domain was chosen such that the domain boundaries are far enough from the remediation wells and such that the domain included the entire pollutant plume prior to remediation in the vertical direction the top of the domain coincides with the phreatic water table and the bottom of the domain is the impervious bottom of the aquifer the thickness of the domain varies between 39 and 70 m in the horizontal direction the domain is a rectangle rotated by 12 5 to match the direction of the average groundwater flow according to the hydraulic head measurements the grid was composed of 69 49 31 cells in the x y z directions respectively horizontal cell sizes increase from 20 to 40 m with increasing distance from the shallow remediation well location in the vertical direction cell sizes increased with depth from 1 5 to 4 m a grid independence test was carried out in order to verify that the results are not sensitive to the grid size for both stages steady state flow was assumed this was justified by the small variation of measured hydraulic heads in monitoring wells namely a typical variation of 0 6 m during the period of 2010 2017 and the fast convergence to steady state within days when remediation wells start pumping the adoption of the steady state assumption led to significant saving in computational time transport was assumed to be purely advective this assumption was tested by comparing the estimated remediation efficiencies of a single realization with and without diffusion and dispersion diffusion coefficient was taken from the literature as d diff 9 5 10 10 m 2 s dispersivity values were assumed to be α l 1 m α t 10 cm α v 1 cm for longitudinal transverse and vertical dispersivities respectively these values were adopted following zech et al 2015 which surveyed dispersivity values in field data and found similar values and the lack of a scaling law relationship simulations were carried out for three case 1 pure advection 2 advection and dispersion without diffusion and 3 advection dispersion and diffusion the results in terms of the remediation efficiency as a function of time are provided in fig b 2 in addition a comparison of the simulated concentrations at the monitoring wells for the pure advection advection dispersion and advection diffusion cases is shown in fig b 3 monitoring wells locations and times when measurements were taken are provided in appendix c fig c 1 and table c 1 as can be seen in this figure the remediation efficiencies for the three cases are very similar the same can be noticed for the simulated concentrations at the monitoring wells the effect of dispersion is small and the effect of diffusion is even smaller moreover the computation of the purely advective case was twice as faster relative to the two other cases hence diffusion and dispersion were neglected in this work note however that neglecting diffusion and dispersion is specific to our case for a mature plume and different flow regime diffusion may play an important role in late time breakthrough curves in addition rolle et al 2013 showed the strong role of the diffusion coefficient on the plume shape however for a low diffusion coefficient and high advectative flow high peclet number such as in our case rolle et al 2013 showed that the plume shape has steep concentration gradients and is determined mainly by the variability in the velocity field hence we suggest that one must always examine the effect of diffusion before neglecting it the following sections will describe the boundary and initial conditions as well as the duration of each stage b 1 stage i initial conditions of the pollutant concentrations for the flow model the boundary conditions are 1 no flow at the boundaries perpendicular to the z y axes and at the bottom 2 constant head at the boundaries perpendicular to the z x axes to represent the natural flow 44 6 and 27 5 m for the east and west boundaries respectively 3 a constant flux at the top boundary that represents an average natural recharge rate r 2 10 4 m d of the past 20 years for the transport model the boundary conditions are 1 a constant concentration recharge at the top boundary applied at 5 locations in each location the recharge was applied to a square shape of 40 m 40 m in the x y plane this boundary condition represents the contamination sources at each square the concentration was different values are provided at table b 2 for this stage the initial conditions for the pollutant concentrations were taken as c stagei x y z t 0 0 transport was solved in a transient mode for 20 years the boundary conditions for transport in stage i were chosen based on historical surveys and vadose zone investigations yakirevich 2015 personal communication b 2 stage ii remediation this stage simulates the period of remediation in the site by pump and treat approach using 2 remediation wells discharge rate for each well was weighted for each layer in the numerical domain according to its transmissivity table b 1 summarizes the parameters of the remediation wells boundary conditions for the water flow remained the same as in stage i transport was solved in a transient mode with a total duration of 30 years initial conditions for the pollutant concentrations were taken from the final concentrations of the transport model of stage i i e c stageii x y z t 0 c stagei x y z t 20 yr hence the initial concentrations of the pollutant at the onset of the remediation were different at each realization influx of the contaminant was neglected during this stage appendix c conditioning on the hydraulic head and concentration measurements the n 2 population was generated by conditioning the n 1 population on the hydraulic head measured in 13 monitoring wells located within the model domain see fig c 1 for the spatial location and values of the measurements screening was based on the rmse of each realization 6 rmse i 1 n h h i h i 2 n where h is the simulated head h is the measured value and n h 13 is the number of observations simulations that led to rmse 1 m were filtered out the choice of the head screening criteria i e rmse x where x 1 m was tested with different values for x and was found that smaller values of x does not lead to significant changes in the re statistical results i e mean and variance fig c 2 a and b shows the rmse of each realization and the typical fit of accepted realizations respectively the n 3 population was generated by conditioning the n 2 population on the spatio temporal measurements of the pollutant since the monitoring wells screen extend over several vertical layers in the numerical grid the simulated concentrations were taken as a weighted average based on the transmissivity of each layer along the screen 7 c i w st i w sb i k i z w c i z w δ z w w st i w sb i k i z w δ z w where c i is the simulated concentration at monitoring well i st and sb are the top and bottom layers elevations of the screen respectively k i z w is the hydraulic conductivity at elevation z w c i z w is the simulated concentration at elevation z w and δ z w is the thickness of the layer to account for measurements errors as well as model assumptions i e the simplified boundary conditions of constant concentration recharge at five locations only measurements outside the industrial facility were used with an exception of 1 deep monitoring well 15 the spatial locations of boreholes with measured concentrations that were used are presented in fig c 1 moreover the concentrations in the monitoring wells vary greatly throughout the year over several orders of magnitude such variations cannot be matched by the simplified model based on the assumptions of steady state flow and constant contaminant recharge during stage i these variations may be attributed to unsteady effects in the flow and to unsteady contaminant fluxes at the source to overcome this deficiency of the model we used the annually averaged values of the concentration measurements instead of the actual measurements to smooth out these variations table c 1 presents the yearly averaged values of the measured concentrations that were used in the screening process the screening criteria were based on a range of 1 order of magnitude i e realizations were accepted if max log c i log c i 1 where c i is the yearly average of the measured concentrations shown in table c 1 an exception to this rule was adopted in borehole 15 where the measured value was close to the detection limit 4 ppb in this case only the upper limit was applied i e accept if log c 15 log c 15 1 the screening interval criteria effect on the final product ensemble mean of the re and std was tested results are shown in fig c 3 as can be seen reducing the screening interval below 1 2 does not affect the final outcome however the number of valid realizations reduces dramatically from 333 to 82 valid realizations when reducing the screening interval from 1 8 to 0 9 respectively thus while decreasing the screening interval leads to the generation of a more accurate initial plume prior to remediation it has a negligible effect on the statistics of the remediation efficiency appendix d convergence of monte carlo simulations convergence test was developed to determine the number of realizations needed for a reliable prediction of the remediation efficiency convergence coefficient was defined as the ratio between the ensemble mean of re when considering j realizations and the entire population i e n realizations 8 cc mean j re j re n where j 1 n and re j is the mean re from the ensemble of the first j realizations similarly the convergence coefficient for std was defined as 9 cc std j std re j std re n where std re j is the standard deviation of re for the ensemble of the first j realizations simulation convergence was assessed with a tolerance of 5 as follows if 0 95 cc mean j 1 05 and 0 95 cc std j 1 05 for all j i i 1 n then i is considered as the amount of realizations needed for convergence to illustrate this convergence coefficient for the n 1 and the n 3 populations are provided in fig d 1 it can be seen that the mean re converged after merely 8 realizations for the n 3 population and after 52 realizations for the n 1 population in contrast the std required many more realizations to reach convergence 55 realizations were needed for the population to converge whereas 316 realizations are needed for the n 1 population to complete the picture fig d 2 shows the pdf of re at t 30 years for 20 50 80 and 115 realizations of the n 3 population as can be seen a reasonable convergence of the shape of the pdf is achieved after approximately 80 realizations 
7090,for large contaminant plumes in groundwater pump and treat pt is usually applied not only to remediate the aquifer but also to control the spreading of the plume the aquifer structure as well as the spatial distribution of the contaminant plume are typically subject to uncertainty this uncertainty can highly effect the remediation predictions geostatistical tools combined with monte carlo simulations can be used to quantify those uncertainties and to provide a more established basis for decision makers regarding the remediation strategy here we focus on a case study of a polluted aquifer and inspect its response to remediation by a pt scheme using two pumping wells the aquifer structure is combined of 4 lithological units and indicator realizations were generated using a modified sequential indicator simulation sis approach then the initial plume prior to remediation was estimated by a forward predictive model as a result each realization had a unique spatial distribution of the contaminant at the onset of the remediation spatio temporal measurements of head and contaminant concentration were used to screen inappropriate realizations our results have shown that conditioning the realizations to the head alone has a minor effect upon the uncertainty regarding the remediation efficiency re on the other hand by conditioning the realizations to both head and concentrations the uncertainty was reduced by more than 35 in terms of the standard deviation of re risk analysis for the migration of the plume showed that the ability of the current configuration of the remediation wells to control the plume is limited to the top layers of the aquifer thus with the present monitoring network there is a significant risk that the plume will migrate downstream towards production wells without being noticed 1 introduction and background reliable predictions of pollutant transport in aquifers have a major rule in the management and protection of the aquifer based on predictions we can perform risk analysis and manage production wells e g hobbs et al 1988 li et al 2007 maxwell et al 1998 and make decisions regarding a suitable remediation strategy for the contaminated aquifer e g guo and brusseau 2017 wagner and gorelick 1989 zheng and wang 2002 however the complex processes of sediments deposition and erosion that generates the aquifer s geological structure may result in a highly heterogeneous spatial distribution of hydrogeological parameters huysmans and dassargues 2009 klingbeil et al 1999 ritzi and allen king 2007 among those parameters the most drastic changes are typically of the hydraulic conductivity whose values can vary by several orders of magnitudes over a relatively small spatial scale e g bohling et al 2012 due to the scarcity of data the hydraulic conductivity spatial variability which has a dominant effect upon pollutant transport is subject to uncertainty dagan 1989 gelhar 1993 rubin 2003 in typical contaminated sites the decision to perform remediation is usually based on an extensive survey of the site generally such a survey aims to delineate the extent of the plume and the location and magnitude of the source a key component of this survey is concentration data obtained from monitoring wells which are installed in typical setups mostly near the contamination source in addition due to the cost of drilling deep monitoring wells it is typical to use shallow monitoring wells except when dense non aqueous phase contaminant is involved this is not the case here therefore for most polluted sites the limited spatial coverage beyond the source location and in the deep layers of the aquifer results in an additional uncertainty regarding the initial conditions i e the spatial distribution of the plume prior to remediation quantifying those uncertainties is crucial for making rational decisions regarding the remediation strategy in this work we focus on a specific contaminated site in the eastern part of the israeli coastal plain aquifer icpa the site is heavily polluted by a nearby industrial facility and the contaminant plume poses a risk to the water quality of nearby production wells thus remediation via pump and treat is planned for the site by the israel water authority further details are provided in section 2 the question that arises is what would be the expected efficiency of such remediation another important question is how the uncertainties in flow and transport affect the uncertainty in the remediation efficiency a conventional approach to answer the first question is to use a deterministic model where the hydraulic parameters are obtained by a parameter estimation i e calibration process via solving an inverse problem usually by using the flow equation and measured heads e g ala aho et al 2015 nocchi and salleolini 2013 pool et al 2015 in some cases additional data is used for the calibration process such as the measured concentrations e g barlebo et al 2004 or the bulk electrical resistivity e g moreno et al 2015 however this inverse problem is ill posed and is non unique in nature ebel and loague 2006 sun 2013 yeh 1986 besides deterministic models consider only one possible structure of the aquifer hence they do not quantify in a systematic manner the uncertainty neither of flow nor of transport geostatistical tools combined with monte carlo simulations are a useful method to quantify the uncertainty regarding the pollutant fate in heterogeneous aquifers the main purpose of these tools is to construct high resolution models of the relevant random variables see e g reviews by deutsch 2007 kitanidis 1997 pyrcz and deutsch 2014 the random parameter can be either discrete e g lithological facies or continuous e g porosity hydraulic conductivity etc first a large set of such realizations is constructed and then each realization forms the basis for a numerical simulation of flow and transport the uncertainty regarding the pollutant fate is estimated from the statistics of the results obtained by these simulations in this study a discrete approach i e lithological facies was adopted to generate different realizations of the aquifer structure the facies approach is commonly used in hydrogeology e g dell arciprete et al 2012 fogg et al 1998 zhang et al 2013 and several methods were developed in order to construct facies based realizations among those methods the most commonly used are sequential indicator simulations sis deutsch and journel 1998 goovaerts 1997 transition probability t progs carle and fogg 1996 carle 1999 ritzi 2000 and multiple point simulation mps liu et al 2005 strebelle 2002 while the first two i e sis and t progs are based on random function models and rely on available quantitative data derived directly from boreholes mps relies on a training image there are multiple works in the literature where the plume shape in heterogeneous environment was reproduced by combining monte carlo simulations and geostatistical tools e g bianchi and zheng 2016 dogan et al 2014 ptak et al 2004 several studies examined the remediation of a polluted aquifer in a heterogeneous environment guo and brusseau 2017 maxwell et al 2008 moreno and paster 2017 rivett et al 2006 schäfer and kinzelbach 1992 zheng and wang 2002 pedretti et al 2017 however to the best of our knowledge a combination of reproducing the plume shape and predicting remediation was never considered for a real contaminant site works that predicted remediation have assumed the plume shape is given and neglected its associated uncertainty upon remediation both schäfer and kinzelbach 1992 and guo and brusseau 2017 have assumed constant spatial concentration of the pollutant moreno and paster 2017 have assumed a gaussian shaped plume zheng and wang 2002 have used spatial interpolation based on field samples and although maxwell et al 2008 and rivett et al 2006 have applied forward modeling to reproduce the initial plume shape they used it either for a hypothetical case maxwell et al 2008 or assuming a homogenous aquifer rivett et al 2006 the aim of this study is to estimate the remediation efficiency re in this site and to quantify its uncertainty in this work the remediation efficiency is defined as the fraction of the pollutant that was removed from the aquifer during remediation relative to the total amount of contaminant in the aquifer before starting the remediation this uncertainty in re is associated with the spatial variability of the aquifer hydraulic conductivity and with the spatial distribution of the plume concentration at the inception of the remediation process in contrast with previous works that assumed a given shape of the plume the initial condition for the spatial distribution of the contaminant at the commencement of the remediation is obtained here by a forward predictive model hence each realization is distinctly different from the rest of the ensemble in terms of the initial conditions for the remediation note that those differences stem solely from the uncertainty in the geological structure since we assume the source boundary condition to be known nevertheless the present concertation data are accounted for indirectly by conditioning the structure on the measured values the paper is organized as follows the site description section contains a brief description of the polluted site the methods section provides details on the numerical model and geostatistical properties of the aquifer the results and discussion section presents the results obtained by the forward predictive model as well as the predicted remediation efficiency and uncertainty this section also includes an analysis of the risk for migration towards production wells the work is summarized in the summary and conclusions section 2 site description the site under consideration in this study is located at a distance of 12 km from the mediterranean coast in the central part of the icpa the water table in the site is found at a depth of 40 m below ground level and the aquifer has a thickness of 30 m the contaminant can be regarded as a passive tracer and does not occur in groundwater naturally the source of the contaminant is seepage from drainage pits in a classified industrial facility at the site during the period of 1960 2006 significant concentrations at the order of 100 ppm were found in the vicinity of the site and smaller concentrations at the range of 10 s 100 s ppb were found at a distance of 2 km downstream from the source see fig 1 the recommended standard for the contaminant in drinking water is 15 ppb additional details on the site were given in moreno and paster 2017 the migrating plume is expected to pose a risk to downstream production wells hence the israel water authority decided to perform an in situ remediation by two remediation wells 1 an existing but currently disabled production well at the western edge of the plume and 2 an additional shallow pumping well yet to be drilled close to the source where peak concentrations were measured the wells are planned to pump at rates of 50 and 100 m3 h and will be referred here as deep well and shallow well respectively see fig 1 as can be seen in fig 1 between the source and the downstream front of the plume there are only 2 monitoring wells located 1 km west of the site in addition the concentration measured values vary by 3 orders of magnitude from measurements at the industrial site to those measured at these two wells downstream from the source thus it is expected that the sparsity of monitoring wells and variability in the measured concentrations away from the source and in between the two remediation wells will result in a significant uncertainty in the prediction of the plume migration and the remediation efficiency 3 methods 3 1 construction of aquifer realizations the aquifer structure is modeled by facies decomposition the 4 facies sand clayey sand clay and gravel are characterized statistically by their volume fraction and indicator variograms which were identified by analysis of drilling logs of the 37 wells in the vicinity of the site data from those wells including spatial location was presented by moreno and paster 2017 the spatial auto correlations of the different formations were fitted to a theoretical model which assumes an exponential variogram with nugget kitanidis 1997 1 γ i h ϕ σ i 2 1 d ϕ i e h ϕ l ϕ i where ϕ is the direction h is the lag distance and i is the lithological unit index since the variance is given by σ i 2 p i 1 p i where p i is the known global proportion of the lithological unit i ritzi 2000 rubin 1995 the fitted parameters were the correlation length scale l i and the correlated weight 0 d i 1 for d i 1 1 becomes an exponential variogram while for d i 0 it becomes a pure nugget fig 2 shows the fitted variograms in both directions i e horizontal continuous lines and circles and vertical dashed lines and crosses since the horizontal distances are greater by more than an order of magnitude than the vertical ones and σ sand 2 3 σ gravel 2 the variograms are presented on a log log scale to present both directions and all facies on the same plot an arithmic scale of the variograms is provided in apendix a the fitted parameters of 1 are given in table 1 as can be seen from fig 2 the experimental variograms are in a good agreement with the theoretical model i e 1 this is also evident by the r 2 value of the fit which varies between 0 93 and 0 98 see table 1 a monte carlo approach was adopted and n 1 1300 various realizations of the 3d structure were generated by using the sis method the realizations were conditioned on the known facies vertical distributions along the wells the algorithm used to generate realizations was based on the methodology of the sisim code a part of gslib deutsch and journel 1998 with some slight modifications to obtain more reliable structure of the aquifer in less computational time for the applied modifications to the sisim code the reader is referred to appendix a after constructing the realization each facies was assigned with a specific hydraulic conductivity k which was adopted from an existing preliminary investigation of the aquifer hydrogeology of the site conducted by yakirevich 2015 personal communication using modflow harbaugh et al 2000 with the pest package doherty et al 2011 and using measurements of the groundwater levels during 1976 1985 from 50 monitoring wells values of k for each facies and the corresponding relative sensitivity are presented in table 1 where the relative sensitivity was calculated as s i k i j 1 n d h j k i 2 n d 0 5 where h j is the calculated value of the hydraulic head at observation point j and k i is the hydraulic conductivity of facies i yakirevich 2015 personal communication showed a good agreement between the observed and simulated groundwater levels where the standard error was 0 9 m 3 2 modeling of flow and transport flow and transport for each realization were solved numerically using modflow harbaugh et al 2000 for flow and mt3dms zheng and wang 1999 for transport using the hybrid method of characteristics hmoc package for advection due to its suitability to model sharp concentration fronts and to provide an accurate solution to the transport problem over the entire range of peclet numbers with virtually no numerical dispersion zheng and wang 1999 transport was assumed to be purely advective i e diffusion and dispersion were neglected pore scale dispersion was neglected due to its minor effect upon longitudinal spreading in heterogeneous formations e g fiori and dagan 1999 for weakly variable formations to test this assumption we compared the results of few realizations with and without diffusion and dispersion these results which are provided in appendix b figs b 2 and b 3 show that diffusion and dispersion can be neglected in this work those findings are also supported by jankovic et al 2017 which demonstrated that local dispersion has a minor effect on the breakthrough curve for highly heterogeneous aquifers and in riva et al 2006 and riva et al 2008 who study the transport mechanism adopted for the numerical simulations advection advection dispersion and or mass transfer impact on the solute breakthrough curve at lauswiesen experimental site and came to the same conclusion i e that dispersion has a minor effect on the breakthrough curve in heterogeneous medium in addition when considering diffusion the obtained peclet number is significantly large i e pe 1 rolle et al 2013 showed that when the peclet number is high the plume shape is determined mostly from the variability in the velocity field therefore the minor effect of diffusion in our case was expected due to previous findings the numerical solution was carried out in two stages time periods 1 a forward model simulating the plume spreading from the beginning of contamination seepage until remediation begins between the years 2000 and 2020 will be referred to as stage i and 2 future prediction of remediation between the years 2020 and 2050 will be referred to as stage ii stage i was used to condition the realizations on the hydraulic head and pollutant concentration measurements note that the term conditioning is associated here with the removal screening of realizations that deviate significantly from the measurements head and concentration stage ii provides the remediation efficiency of each realization a full description of the numerical domain boundary and initial conditions along with the grid size for both stages is provided in appendix b herein only the general features are presented in stage i 3d flow and transport were solved for each one of the n 1 1300 realizations in order to determine the pollutant distribution 20 years after the inception of the pollution process spatiotemporal uncertainty regarding the source was neglected in this work instead the boundary conditions for the pollutant were treated as constant concentration recharge at fixed 5 areal locations identified by yakirevich 2015 personal communication full details are provided in appendix b concentration recharge values during the stage i period 2000 2020 were estimated from vadose zone investigations and spill history surveys and provide the average recharge of contaminant the adopted pollutant influx rates were assumed to be accurate 3 3 conditioning the realizations to measurements the solutions of stage i provide the hydraulic heads and concentrations prior to remediation conditioning the realizations to the measurements is achieved in two steps first the realizations were screened based on the measured hydraulic head in 13 monitoring wells at the proximity of the site the head data from these wells was considered to be reliable the root mean square error rmse of the measured head relative to the modeled head was calculated see details in appendix c the screening criterion was defined as rmse 1 m the realizations which pass this screening criterion were defined as the n 2 population additional screening of realizations was based on conditioning on concentration measurements here the screening criterion was defined differently by using the ratio between modeled and measured concentrations this ratio was allowed to be at the range of 0 1 to 10 and realizations which did not follow this criterion were removed from the population details are provided in appendix c this additional screening led to the reduction of the number of admissible realizations to n 3 n 2 it is important to note that contaminant concertation measurements in the industrial facility i e within the shaded polygon in fig 1 were not accounted for with an exception of 1 deep monitoring well well 15 therefore only 4 monitoring wells were used their locations in the numerical domain along with the measured values of the hydraulic head and pollutant concentration are provided in fig c 1 and table c 1 located in appendix c the concentration measurements in the shallow monitoring wells within the industrial facility were not used in the conditioning process due to the simplified boundary conditions that were applied the steady state flow along with constant concentration recharge at fixed locations cannot produce the large variability that was observed in concentration measurements inside the industrial facility i e close to the source in general the filtering criterions for both the hydraulic head and concentrations result from a balance between the need to remove unrealistic realizations on one hand and the need to keep a statistically significant number of valid realizations on the other hand this balance takes into account the fact that both the data and the modeling assumptions are not accurate the inaccuracies stem from multiple factors of which the main ones are 1 the assumption of steady flow 2 the specified boundary conditions of the model 3 the geostatistical model used to construct the facies structure 4 the use of a yearly mean value for the measurements and 5 the smearing of concentrations over the numerical cells the screening criterions that were used can also account for measurements errors since the later are significantly smaller than the first the overall effect of the model inaccuracies can be roughly estimated and used as a guideline in setting the screening criteria 1 m for head rmse and a factor of 10 for concentration the sensitivity of the results to the screening criteria was examined thus the final product i e remediation efficiency and uncertainty was evaluated with different screening intervals for the head and concentration it was found that mild changes in the screening intervals hardly affect the ensemble results these results and further details are provided in appendix c to summarize conditioning the realizations to the measurements was conducted by a forward modeling approach in principle one can use stochastic inversion methods to generate realizations conditioned to the head and concentration measurements see e g the thorough review by zhou et al 2014 however as will be shown in the results section the forward modeling approach was sufficient in our case to obtain reliable results within a reasonable computational effort it is worth mentioning that the technique used here bears similarities with the acceptance rejection methods used in stochastic inversion methods e g markov chain monte carlo oliver et al 1997 zhou et al 2014 3 4 remediation efficiency and uncertainty stage ii of the numerical simulations represents the remediation phase in this stage the 2 remediation wells pump at constant rates and flow and transport are solved for 30 years for the complete set of n 1 realizations the concentrations of the pollutant at the end of stage i serve as initial condition for stage ii stage ii solution provides the remediation efficiency re which is defined by the ratio of the pumped mass by the two remediation wells and the initial mass of the contaminant 2 re t m pumped t m in where 3 m in j 1 m t 0 t 20 years a j c j rdt here j indicates the source index m 5 is the total number of sources at the site a j is the areal size of source j c j is the source concentration and r is the natural recharge rate note that m in is fixed for all realizations as the boundary conditions for all the realizations are similar details on the sources are provided in appendix b due to the randomness of both the initial conditions of the plume resulting from stage i and the heterogeneous structure of the aquifer i e k x y z re is a random variable a flowchart that summarizes the procedures is provided in fig 3 4 results and discussion 4 1 initial plume shape and uncertainty stage i solution the initial set of realizations contained n 1 1300 individual realizations as mentioned above the first screening of realizations was based on measured heads this screening led to a reduction of the total number of realizations to n 2 600 thus 46 of the n 1 population was accepted the acceptance rate of realizations based on the measured head can be considered as having a limited impact on screening which can be explained by the relative insensitivity of the hydraulic head levels to the structure of the aquifer in addition we would like to note that those results are not unique to our case and were also reported in previous works e g dogan et al 2014 the ensemble mean and std of the head for the n 1 and n 2 populations is shown in fig 4 note that at the assumed constant head boundaries where the head is set by the model the std is zero also note that although this filtering reduced the population significantly the mean head value was only slightly affected fig 4a b in contrast the screening had reduced the variability where the standard deviation decreased by a factor of 2 in the entire model domain fig 4c d the second screening step based on comparing the modeled concentrations with measured values resulted in n 3 115 accepted realizations 19 of the n 2 population in fig 5 the distributions of simulated log concentration at the monitoring wells for both n 2 and n 3 populations are shown the corresponding distributions for the n 1 population were similar to the ones derived for the n 2 population hence they are not shown in this figure as observed in this figure the distributions of the simulated log concentrations of the n 3 population are significantly narrower relative to the n 2 population thus the n 3 population presumably provides a more accurate initial condition for the plume and is expected to yield a more accurate prediction of the remediation fig 5 also shows the ensemble means of the log concentrations of the n 2 and n 3 populations we observe that while distributions were significantly different the means are similar and match the measured log concentrations in locations where the concentrations are relatively high boreholes 18 and 19 fig 5a d an exception to this observation is in borehole 23 fig 5e where screening based on concentration significantly improved the agreement between the ensemble mean of realizations and the measured value in contrast in borehole 15 where the measured concentration is the lowest value of all measurements 6 ppb see fig 5f the model shows a significant mismatch of the measurement note however that this deviation is 5 ppb and is expected to have a negligible effect upon remediation efficiency here it is also worth mentioning that previous works bianchi and zheng 2016 dogan et al 2014 ptak et al 2004 refer to the match between the measured concentrations and the mean or median of the simulated concentrations as an indication of a satisfactory representation of the aquifer structure in the numerical simulations fig 6 shows the initial concentrations for the remediation simulation of 2 randomly chosen realizations from the n 3 set this figure is a good illustration of the significant differences between realizations in terms of the initial conditions of stage ii indeed the limited available data regarding the pollutant concentrations results in a significant uncertainty in the initial plume shape the vertical variations of concentrations may explain these deviations while measured concentrations at monitoring wells were provided as a single value they actually represent a flux weighted average of vertically distributed concentrations over the screen of the well note that the monitoring wells screen extend over several vertical integral scales see appendix c for further details hence concentrations in distinct realizations can vary greatly within the vertical profile of the well s screen and yet produce a similar average value see e g tonina and bellin 2008 who report a similar effect however it is worth noting that in our case the variation of concentration close to the source is rather limited due to the relatively dense amount of available borehole data near the source 4 2 remediation efficiency and uncertainty stage ii solution to examine the impact of each level of conditioning on re simulations of stage ii were carried for the entire n 1 population i e for the entire 1300 realizations fig 7 a shows the ensemble mean value re t as a function of time for the n 1 n 2 and n 3 populations the uncertainty in re t is quantified by the probability density function pdf of re at t 3 10 16 and 24 years the histogram of re at the end of the remediation simulation i e after 30 years of remediation for each population is depicted in fig 7b d as shown in fig 7 both screening levels have a notable effect upon the predictions of remediation throughout the entire simulation period the mean standard deviation and the shape of the distribution change between the populations the first screening i e conditioning to the hydraulic head alone n 2 led to an increase in the predicted mean by 15 at the end of the remediation simulation from 0 54 in n 1 to 0 62 in n 2 at the same time the standard deviation reduced from 0 14 to 0 12 i e by a similar factor the second screening level by concentrations had a mild effect on the mean re an increase of 6 from re 0 62 to re 0 66 between n 2 and n 3 populations this slight change in mean re can be attributed to the good match for both populations between the ensemble mean of realizations and the measurements as shown in fig 5 in contrast to the slight change in the mean the uncertainty was considerably reduced as the standard deviation decreased by 25 from 0 12 to 0 09 this significant reduction can be attributed to the notable effect of conditioning the realizations to the measured concentrations which limits the possible distributions of the initial plume moreover it is important to note that although the mean efficiency and uncertainty were estimated from the entire population size i e 1300 realizations for the n 1 population and 115 realizations for the n 3 population convergence tests shown in appendix d indicated that for the n 3 population convergence was achieved after 55 realizations as opposed to 316 realizations for the n 1 population this fast convergence shortens the computational time for prediction by a factor of 3 this significant saving is due to the fact that most of the computational effort is devoted to the simulation of transport in stage ii and this effort is conducted over a notably smaller population size 55 for n 3 as opposed to 316 for n 1 for example for a pc with intel core i7 4510u processor and 8 gb ram the computational time for stage i is 4 min and for stage ii is 40 min thus for the 55 realizations of the n 3 population the computational effort is roughly 78 h as opposed to a total 232 h for the n 1 population which includes 316 realizations 4 3 risk assessment in addition to remediation the risk involved with contamination was evaluated before and after the remediation stage the risk is defined here as the probability that the concentrations in a certain location will exceed the standard for the contaminant 15 ppb to this end only the n 3 population is considered and for each realization in this population we define the indicator 4 i x y z t 0 c x y z t 15 ppb 1 c x y z t 15 ppb then the risk was evaluated by performing an ensemble mean over the values of i fig 8 shows the computed risk at 2 elevations 28 and 0 m with respect to sea level at two different times before remediation had started i e t 0 and at the end of the remediation simulation i e t 30 years note that fig 8 does not represent concentrations but the probability of the concentration to exceed the standard the risk analysis shows that at shallow depths the spatial extent of high risks reduces due to remediation fig 8a and b in addition the risk that the pollutant will migrate northwest during the remediation stage is close to zero fig 8b thus remediation at this current configuration shallow well close to the source and deep well far from it controls the spreading of the plume close to the aquifer top however a different behavior can be noticed at the deeper layer of the aquifer from fig 8c it can be seen that the risk of contamination prior to remediation was below 60 at the end of the remediation stage fig 8d the risk for contamination was above 80 and in contrast to the shallow layer the contaminant is migrating seaward northwest and escapes the well s capture zone if additional monitoring wells will be drilled in the downstream side of the well care must be taken w r t their depth as we have observed shallow monitoring wells are susceptible to be blind to the migration of the contaminant towards production wells this may raise questions about their ability to identify this risk in a timely manner 5 summary and conclusions in this work the response of a contaminant plume to a pump and treat remediation scheme was studied the main focus of this work was to quantify the remediation efficiency and its uncertainty and to assess the different conditioning levels head and concentration measurements impact upon it different realizations of the aquifer structure conditioned on facies measurements were generated based on a common indicator approach sis with slight modifications as opposed to previous similar works the pre remediation plume distribution was evaluated here by solving the direct problem of transport from the source to the remediation wells i e forward predictive modeling rather than assuming an initial distribution of the pollutant realizations were compared with spatial measurements of the hydraulic head and concentration measurements the ensemble mean of the simulated head and concentrations for both conditioning levels i e n 2 and n 3 populations had a good agreement with the measurements at the monitoring wells indicating a satisfactory representation of the aquifer structure still simulated concentrations of the pollutant for the final level of conditioning i e the n 3 population revealed a significant variability in the spatial concentrations prior to remediation each level of conditioning effected the remediation efficiency projection the first conditioning level i e hydraulic head mostly affected the mean value of re which increased by 15 on the other hand the uncertainty remained practically the same in terms of standard deviation and distribution shape the second conditioning level to the hydraulic head and concentration measurements had a little effect on the mean an increase of 6 and led to a significant reduction in the uncertainty of re as the standard deviation of re reduced by 25 our results have shown that the proposed configuration of the remediation wells i e a shallow well close to the source and a deep well at a distance of 1 km from the shallow well does not completely control the plume which will migrate downstream towards production wells this migration is likely to occur close to aquifer base due to the cost of deep drilling and the limited amount of deep monitoring wells chances of monitoring the contaminant plume migration are low consequentially it may pose a risk to downstream production wells hence further work is needed to search for a better remediation setup for the site such work shall address the problem of optimization of the remediation wells spatial locations and discharge rate in order to obtain a more efficient remediation of lower uncertainty and risk to production wells the forward predictive modeling of the initial plume distribution allowed the quantification of the mean remediation efficiency and uncertainty along with the risk involved for the plume migration in a physically reliable manner an alternative to our approach is to assume some simplified shape of the pollutant plume or to use spatial interpolations as is commonly done such approaches are controversial as they may lead to the assignment of high concentrations in low permeable zones where transport is dominated by diffusion this is especially likely when spatial measurements of the contaminant used for the interpolation are sparsely scattered clearly such assumptions can cause the numerical predictions of the remediation to display a stagnation of high concentrations and strong tailing effect and may lead to a questionable decision making the forward predictive model eliminates those artifacts since the transport of pollutant into low permeable zones is restricted to our knowledge this issue has not received proper attention in the literature even though this study is conducted on a particular site in the icpa it shares many features with other contaminated sites geological data is typically limited and mostly relies on lithology moreover in many cases the monitoring of the contaminant is mostly shallow and sparsely located away from the contaminant source this may lead to significant uncertainty in terms of the present concentration distribution thus the results and the conclusions drawn here may be applicable with proper adjustments at other similar sites acknowledgments we thank the editor the two anonymous reviewers and prof alberto guadagnini for their comments on an early version of this manuscript which helped to improve it considerably we are also grateful to prof gedeon dagan for fruitful discussions and comments regarding the manuscript we thank prof alexander yakirevich for providing useful information regarding the site we are also grateful to the israeli water authority for the financial support of this research a p acknowledges the support of tau s vp of r d appendix a modifications applied to sisim and variograms on an arithmetic scale fig a 1 shows the fitted variograms in both directions i e vertical a and horizontal b on an arithmetic scale the following modifications were applied in the sisim code used here 1 in sisim nugget is equal in all directions the fitted parameters of the auto variograms fig 2 and table 1 indicate that the formations are fully correlated in the vertical direction i e d i 1 on the other hand sand and gravel show a small discontinuity in the horizontal direction where d i is 0 96 for sand and 0 84 for gravel thus the theoretical variograms were calculated as 5 γ i σ i 2 1 d i exp h v l vi 2 h h l hi 2 h h 0 σ i 2 1 exp h v l vi h h 0 where h v and h h are the vertical and horizontal lag distances correspondingly 2 previous studies have shown that sequential simulations are less likely to generate connected bodies in the horizontal direction than the vertical one bianchi et al 2011 he et al 2009 lee et al 2007 sisim uses a limited number of the nearby informed nodes to evaluate probability of each formation we assume that the cause of a less connective body in the horizontal direction is due to the low amount of informed nodes in the horizontal direction compare to the vertical one since horizontal distances are larger by more than an order of magnitude than vertical distances thus to generate more connected bodies in the horizontal direction we gave more weight to horizontal distances where an anisotropy ratio of 10 was applied for the search of the informed nodes 3 to reduce the computational time when the nearest informed node is located at a distance 3 times the correlation length scale l the lithological unit was determined randomly according to the global proportions appendix b numerical model domain and boundary conditions an aerial view of the model s domain grid and boundary conditions for both stages is provided in fig b 1 the model domain was chosen based on the contaminant measurements and the 2 suggested remediation wells location exact locations of the remediation wells on the numerical grid are provided in table b 1 and fig b 1 the horizontal extent of the domain was chosen such that the domain boundaries are far enough from the remediation wells and such that the domain included the entire pollutant plume prior to remediation in the vertical direction the top of the domain coincides with the phreatic water table and the bottom of the domain is the impervious bottom of the aquifer the thickness of the domain varies between 39 and 70 m in the horizontal direction the domain is a rectangle rotated by 12 5 to match the direction of the average groundwater flow according to the hydraulic head measurements the grid was composed of 69 49 31 cells in the x y z directions respectively horizontal cell sizes increase from 20 to 40 m with increasing distance from the shallow remediation well location in the vertical direction cell sizes increased with depth from 1 5 to 4 m a grid independence test was carried out in order to verify that the results are not sensitive to the grid size for both stages steady state flow was assumed this was justified by the small variation of measured hydraulic heads in monitoring wells namely a typical variation of 0 6 m during the period of 2010 2017 and the fast convergence to steady state within days when remediation wells start pumping the adoption of the steady state assumption led to significant saving in computational time transport was assumed to be purely advective this assumption was tested by comparing the estimated remediation efficiencies of a single realization with and without diffusion and dispersion diffusion coefficient was taken from the literature as d diff 9 5 10 10 m 2 s dispersivity values were assumed to be α l 1 m α t 10 cm α v 1 cm for longitudinal transverse and vertical dispersivities respectively these values were adopted following zech et al 2015 which surveyed dispersivity values in field data and found similar values and the lack of a scaling law relationship simulations were carried out for three case 1 pure advection 2 advection and dispersion without diffusion and 3 advection dispersion and diffusion the results in terms of the remediation efficiency as a function of time are provided in fig b 2 in addition a comparison of the simulated concentrations at the monitoring wells for the pure advection advection dispersion and advection diffusion cases is shown in fig b 3 monitoring wells locations and times when measurements were taken are provided in appendix c fig c 1 and table c 1 as can be seen in this figure the remediation efficiencies for the three cases are very similar the same can be noticed for the simulated concentrations at the monitoring wells the effect of dispersion is small and the effect of diffusion is even smaller moreover the computation of the purely advective case was twice as faster relative to the two other cases hence diffusion and dispersion were neglected in this work note however that neglecting diffusion and dispersion is specific to our case for a mature plume and different flow regime diffusion may play an important role in late time breakthrough curves in addition rolle et al 2013 showed the strong role of the diffusion coefficient on the plume shape however for a low diffusion coefficient and high advectative flow high peclet number such as in our case rolle et al 2013 showed that the plume shape has steep concentration gradients and is determined mainly by the variability in the velocity field hence we suggest that one must always examine the effect of diffusion before neglecting it the following sections will describe the boundary and initial conditions as well as the duration of each stage b 1 stage i initial conditions of the pollutant concentrations for the flow model the boundary conditions are 1 no flow at the boundaries perpendicular to the z y axes and at the bottom 2 constant head at the boundaries perpendicular to the z x axes to represent the natural flow 44 6 and 27 5 m for the east and west boundaries respectively 3 a constant flux at the top boundary that represents an average natural recharge rate r 2 10 4 m d of the past 20 years for the transport model the boundary conditions are 1 a constant concentration recharge at the top boundary applied at 5 locations in each location the recharge was applied to a square shape of 40 m 40 m in the x y plane this boundary condition represents the contamination sources at each square the concentration was different values are provided at table b 2 for this stage the initial conditions for the pollutant concentrations were taken as c stagei x y z t 0 0 transport was solved in a transient mode for 20 years the boundary conditions for transport in stage i were chosen based on historical surveys and vadose zone investigations yakirevich 2015 personal communication b 2 stage ii remediation this stage simulates the period of remediation in the site by pump and treat approach using 2 remediation wells discharge rate for each well was weighted for each layer in the numerical domain according to its transmissivity table b 1 summarizes the parameters of the remediation wells boundary conditions for the water flow remained the same as in stage i transport was solved in a transient mode with a total duration of 30 years initial conditions for the pollutant concentrations were taken from the final concentrations of the transport model of stage i i e c stageii x y z t 0 c stagei x y z t 20 yr hence the initial concentrations of the pollutant at the onset of the remediation were different at each realization influx of the contaminant was neglected during this stage appendix c conditioning on the hydraulic head and concentration measurements the n 2 population was generated by conditioning the n 1 population on the hydraulic head measured in 13 monitoring wells located within the model domain see fig c 1 for the spatial location and values of the measurements screening was based on the rmse of each realization 6 rmse i 1 n h h i h i 2 n where h is the simulated head h is the measured value and n h 13 is the number of observations simulations that led to rmse 1 m were filtered out the choice of the head screening criteria i e rmse x where x 1 m was tested with different values for x and was found that smaller values of x does not lead to significant changes in the re statistical results i e mean and variance fig c 2 a and b shows the rmse of each realization and the typical fit of accepted realizations respectively the n 3 population was generated by conditioning the n 2 population on the spatio temporal measurements of the pollutant since the monitoring wells screen extend over several vertical layers in the numerical grid the simulated concentrations were taken as a weighted average based on the transmissivity of each layer along the screen 7 c i w st i w sb i k i z w c i z w δ z w w st i w sb i k i z w δ z w where c i is the simulated concentration at monitoring well i st and sb are the top and bottom layers elevations of the screen respectively k i z w is the hydraulic conductivity at elevation z w c i z w is the simulated concentration at elevation z w and δ z w is the thickness of the layer to account for measurements errors as well as model assumptions i e the simplified boundary conditions of constant concentration recharge at five locations only measurements outside the industrial facility were used with an exception of 1 deep monitoring well 15 the spatial locations of boreholes with measured concentrations that were used are presented in fig c 1 moreover the concentrations in the monitoring wells vary greatly throughout the year over several orders of magnitude such variations cannot be matched by the simplified model based on the assumptions of steady state flow and constant contaminant recharge during stage i these variations may be attributed to unsteady effects in the flow and to unsteady contaminant fluxes at the source to overcome this deficiency of the model we used the annually averaged values of the concentration measurements instead of the actual measurements to smooth out these variations table c 1 presents the yearly averaged values of the measured concentrations that were used in the screening process the screening criteria were based on a range of 1 order of magnitude i e realizations were accepted if max log c i log c i 1 where c i is the yearly average of the measured concentrations shown in table c 1 an exception to this rule was adopted in borehole 15 where the measured value was close to the detection limit 4 ppb in this case only the upper limit was applied i e accept if log c 15 log c 15 1 the screening interval criteria effect on the final product ensemble mean of the re and std was tested results are shown in fig c 3 as can be seen reducing the screening interval below 1 2 does not affect the final outcome however the number of valid realizations reduces dramatically from 333 to 82 valid realizations when reducing the screening interval from 1 8 to 0 9 respectively thus while decreasing the screening interval leads to the generation of a more accurate initial plume prior to remediation it has a negligible effect on the statistics of the remediation efficiency appendix d convergence of monte carlo simulations convergence test was developed to determine the number of realizations needed for a reliable prediction of the remediation efficiency convergence coefficient was defined as the ratio between the ensemble mean of re when considering j realizations and the entire population i e n realizations 8 cc mean j re j re n where j 1 n and re j is the mean re from the ensemble of the first j realizations similarly the convergence coefficient for std was defined as 9 cc std j std re j std re n where std re j is the standard deviation of re for the ensemble of the first j realizations simulation convergence was assessed with a tolerance of 5 as follows if 0 95 cc mean j 1 05 and 0 95 cc std j 1 05 for all j i i 1 n then i is considered as the amount of realizations needed for convergence to illustrate this convergence coefficient for the n 1 and the n 3 populations are provided in fig d 1 it can be seen that the mean re converged after merely 8 realizations for the n 3 population and after 52 realizations for the n 1 population in contrast the std required many more realizations to reach convergence 55 realizations were needed for the population to converge whereas 316 realizations are needed for the n 1 population to complete the picture fig d 2 shows the pdf of re at t 30 years for 20 50 80 and 115 realizations of the n 3 population as can be seen a reasonable convergence of the shape of the pdf is achieved after approximately 80 realizations 
7091,plastic mulching has been widely used in arid regions because it can decrease soil water evaporation and raise soil temperature previous studies however treated soil water evaporation under plastic mulch to be negligible assuming that the plastic mulch can prevent water exchange between soil and atmosphere completely in order to demonstrate validity of this assumption experiments were conducted from 2014 to 2016 under irrigated maize zea mays field in northwest china comparison experiments of soil water evaporation between mulched soil and the bare soil between mulches were carried out in two seed maize fields with different irrigation method i e border irrigation under mulch site bm and drip irrigation under mulch site dm with micro lysimeters placed under the plastic mulched soil and the bare soil between mulches to evaluate soil water evaporation of each experiment maize field our observations indicated that the soil water evaporation under plastic mulch ems was about 4 04 7 07 of the total evapotranspiration among which ems in the daytime accounted for 3 58 5 37 of the total evapotranspiration and 0 99 2 10 of the total evapotranspiration in the nighttime thus ems was considered not to be negligible for two experiment sites soil water evaporation under bare soil between mulches ebs was obviously higher than the soil water evaporation under plastic mulch ems in daytime but the former was lower than the latter in the nighttime at night the mean soil temperature in the mulched soil was higher than that in the bare soil because of the warming effect of the plastic mulch a soil mulch canopy atmosphere model is used to consider the effects of the mulch and the modeling results further support this finding these results provide a new insight for understanding the effect of plastic mulch on water use efficiency keywords eddy covariance maize micro lysimeter plastic mulch soil water evaporation 1 introduction plastic mulching is a critical technology for saving water in arid regions owing to its function in warming the soil preserving soil moisture and increasing crop yield as such it has been extensively used in crop production such as wheat maize cotton soybean and other crops in the world in contrast with the traditional cultivation methods plastic mulching changes the ground surface reflectance and water vapor transfer resistance thereby altering surface water balance energy balance and plant growth processes however the mechanism of plastic mulch water saving effect remains uncertain thus it is of great value to explore the influence from plastic mulching on soil water evaporation in order to optimize agricultural water resource management until recently numerous studies have been conducted to evaluate the effects of plastic mulching on water and energy transfer in farmland such studies have come to the following main conclusions 1 plastic mulching can reduce soil water evaporation and increase water use efficiency wang et al 2001 xie et al 2005 ramakrishna et al 2006 shen et al 2012 tiwari et al 2016 2 plastic mulching enhances the surface radiation reflectance thereby changing the water and energy balance in farmlands liakatas et al 1986 wilson et al 2002 heusinkveld et al 2004 bonachela et al 2012 yang et al 2012 jafari et al 2012 3 plastic mulching can increase water vapor transfer resistance so that the soil water evaporation under plastic mulching can be assumed to be negligible in the model calculation yang et al 2012 li et al 2013b wang et al 2016 4 the open hole ratio on the plastic mulch has a vital impact on soil water evaporation under plastic mulching the larger the ratio is the smaller the water vapor transfer resistance will be so that the water vapor will be easier to cross through plastic mulch to atmosphere li et al 2003 2005 shi et al 2013 however these previous studies mainly focused on the effect of plastic mulch on evapotranspiration and crop growth but paid little attention to the diurnal dynamic soil water evaporations of mulched and bare soils the measurements of soil water evaporation under the mulched layer are seldom reported also there are only few studies that compared the mulched soil water evaporation and the bare soil water evaporation in some research conducted in mulched crop field the researchers just ignored the soil water evaporation under mulch but adopted the soil water evaporation of bare soil between mulches as the all soil water evaporation throughout the crop field ding et al 2013 jiang et al 2016 moreover no investigation has been made on the effect of plastic mulch on soil water evaporation during daytime or nighttime in arid croplands the micro lysimeter weighing method is a direct method of measuring soil water evaporation and has been widely used in evaluating soil water evaporation under bare soil and canopy due to its small disturbance to surrounding soil simple principle handiness and cost effectiveness liu et al 2002 mitchell et al 2009 cavanaugh et al 2011 zhao et al 2015 previous studies indicated that soil water evaporation measured by the micro lysimeter weighing method obtained results consistent with those measured with other instruments matthias et al 1986 plauborg 1995 and modeling methods li et al 2013a zhao et al 2015 to explore the effect of plastic mulch on soil water evaporation during daytime or nighttime in arid croplands micro lysimeter weighing method was employed to evaluate evaporation under the mulched layer and bare soil layers under two typical irrigated seed maize field in arid regions the border irrigation under mulched field and the drip irrigation under mulched field the former is a traditional irrigation technology which has been widely applied in previous practical agricultural production while the latter is a new irrigation technology combined drip irrigation and plastic mulch technology and has been widely applied in current practical agricultural production thus exploration of mechanism of the water and energy transfer process in the two croplands is of vital important in improving water use efficiency in arid regions on this basis the effect of plastic mulch on soil water evaporation was analyzed as well as the water saving effect and control mechanism of plastic mulching were evaluated 2 materials and method 2 1 experimental site and description three year continuous experiments were conducted at shiyanghe experimental station of china agricultural university located in wuwei city gansu province of northwest china n 37 52 e 102 50 elevation 1581 m the experimental site is located in a typical continental temperate climate zone with mean annual temperature of 8 c annual accumulated temperature 0 c of 3550 c mean annual pan evaporation of approximately 2000 mm annual precipitation of 164 mm the average annual sunshine duration of 3000 h the groundwater table at the station is 40 50 m below the ground surface li et al 2015 2016a qin et al 2016 the comparison experiments were conducted at both border irrigation under mulch seed maize field site bm and drip irrigation under mulch seed maize field site dm seeds of seeding maize field are divide into male maize seeds and female maize seeds the two have minor difference from the point of genetic breeding male maize seeds are more conducive to the development of stamens in maize plants while female maize seeds are more conducive to the growth of maize plants reproductive function professional semi automated machines were applied to lay out plastic mulch open holes and sow in the holes in both seed maize experiment fields male maize seeds and female maize seeds were sow in different holes with one line for male plants and several lines for female plants however both male maize seeds and female maize seeds were sown fixed distance apart within each row during the three years one or two seeds were sow in one open hole while germination rates were different from each year and in turn cause different planting density besides when the professional semi automatic machines open holes above the plastic mulch the area of open hole would have minor difference due to influence of artificial work the plastic transparent mulch applied in both treatments was 8 μm thick with a shortwave transmissivity reflectivity and absorptivity of 0 85 0 10 and 0 05 respectively and a longwave transmissivity of 0 74 the optical properties of the plastic mulch mentioned above were measured by spectrophotometer and the plastic mulches were laid out along east to west with width of 1 2 m and there is bare soil with width of 0 4 m between the two plastic mulches thus the ratio of the area of mulched soil and bare soil was 3 1 specifically the border irrigation under mulch technology is a widely applied traditional agricultural irrigation technology which built ridges in the field and the field is split into many narrow and long plots irrigation water from sub lateral canals flow into the plots along the long side of the plots infiltration and wetting soil layer site bm is irrigated seed maize field under plastic mulch with an area of 400 m 200 m during 2014 2016 the field were sown in one line male plants and four line female plants in 2014 2015 while one line male plants and seven line female plants in 2016 respectively five seed rows were covered under one plastic mulch both female and male seeds were sown 0 3 m apart within each row and the distance between seed rows under the same mulch was 0 25 m site bm see in fig 1 germination ratios were approximately 87 87 and 93 during 2014 2015 and 2016 respectively the average hole size was approximately 10 2 10 8 cm2 and ratios of the total area of holes opened for seeding to the total plastic mulch area were 1 63 1 69 and 1 73 in 2014 2015 2016 respectively overall planting density was 108 000 plants ha 1 during 2014 2015 and 116 176 plants ha 1 in 2016 the soil at 1 m depth in the site is silty loam with an average soil dry bulk density of 1 52 g cm 3 and volumetric soil water content at a field capacity θfc of 0 29 cm3 cm 3 during 2014 2016 the drip irrigation under mulch technology is a widely applied new agricultural irrigation technology which combined drip irrigation and plastic mulch technologies site dm is irrigated seed maize field under plastic mulch with an area of 2000 m 1000 m during 2014 2015 and 400 m 200 m in 2016 the field were sown in one line male plants and seven line female plants in 2014 2015 and one line male plants and six line female plants in 2016 respectively four seed rows were covered under one plastic mulch both female and male seeds were sown 0 22 m apart within each row and the distance between seed rows under the same mulch was 0 30 m site dm see in fig 1 germination ratios were approximately 90 90 and 91 during 2014 2015 and 2016 respectively the average hole size was approximately 10 6 11 8 cm2 ratios of the total area of holes opened for seeding and the total plastic mulch area were 2 14 2 23 and 2 01 in 2014 2015 2016 respectively overall planting density was 112 500 plants ha 1 during 2014 2015 and 109 474 plants ha 1 in 2016 the soil texture at 0 0 8 m depth is silty loam and that at 0 8 1 0 m depth is silt during 2014 2016 with an average soil dry bulk density of 1 52 g cm 3 averaged θfc of 0 30 cm3 cm 3 in 2014 while the average soil dry bulk density and θfc is 1 46 g cm 3 and 0 29 cm3 cm 3 in 2015 and 2016 respectively qin et al 2016 the total irrigation amount in bm experiment site was 360 mm 442 mm 480 mm in 2014 2015 and 2016 respectively and 350 mm 449 mm 388 mm under dm treatment in 2014 2015 and 2016 respectively detailed description of irrigation and precipitation events has been reported in qin et al 2016 2 2 measurements and data collection 2 2 1 soil evaporation in our experiment micro lysimeters made of pvc tubes were applied to monitor soil water evaporation with the weighing method every day the micro lysimeter composed of inner and outer tubes with the diameter of 11 cm for the outer tube and 10 cm for inner tube the height of both tubes was 20 cm the bottom of the inner tube was covered with nylon wire which was convenient for water vapor transfer in vertical direction when installing the micro lysimeters in the bare soil the inner tube was firstly drilled into the undisturbed soil in the installation location to ensure the homogeneity of soil water then the inner tube was dig out as carefully as possible to minimize disturbance to surrounding soil and then a piece of filter paper was placed inside the bottom of the inner tube and a piece of wire mesh was placed outside the tube to ensure the water and energy transfer in the vertical direction of soil and finally both outer tube and inner tube were put into the soil and try to recover the soil when installing the micro lysimeter in plastic mulch the first step was to uncover the plastic mulch and installed the micro lysimeter then recovered the plastic mulch and trepanned in the plastic mulch with the same area as the bottom of micro lysimeter finally sealed the hole with another small piece of plastic mulch to sustain original micro meteorology under the mulch the comparison experiments between soil water evaporation under mulch and that under bare soil were carried out in both bm and dm sites during 2014 2016 the micro lysimeter was installed between crops under the mulch and bare soil between mulches of the two sites fig 1 with each site having 6 replications the soil water evaporation at each micro lysimeter was evaluated with the weighing method by an electronic scale mettler toledo pl6001 l usa with accuracy of 0 1 g at 7 30 am and 19 30 pm every day respectively with the difference being the soil water evaporation of the daytime or nighttime the micro lysimeter under plastic mulch was placed to the original place after each weight measurement and a scotch tape was used to seal the plastic mulch to ensure integrity of the hydrothermal environment before each weight measurement the adhesive tape was torn off to take out the micro lysimeter from the tank regular reinstallation of the micro lysimeter was adopted to minimize the difference between soil moisture inside and outside the tubes yunusa et al 2004 and comparison experiments of soil water evaporation under mulch between site bm open hole ratios were 1 63 1 69 and 1 73 in 2014 2015 and 2016 respectively and site dm open hole ratios were 2 14 2 23 and 2 01 in 2014 2015 and 2016 respectively before planting maize period were also carried out during 2015 2016 in order to investigate minor difference of open hole ratios on soil water evaporation measurement results indicated that the differences of soil water evaporation under mulch between the two open hole ratios were smaller 2015 ems1 69 1 01ems2 23 0 02 r2 0 93 10 observations 2016 ems1 73 0 99ems2 01 0 01 r2 0 96 9 observations thus the minor difference between the open hole ratios has little effect on our soil water evaporation measurements besides soil water evaporation in irrigation or precipitation events were not observed becausethe data during these period is inaccurate therefore the averaged soil water evaporation values were computed using the measured values of observed dates during each growth period 2 2 2 meteorological data and eddy covariance system all climatic parameters listed in table 1 needed to calculate evaporation by the msw model and evapotranspiration were measured with eddy covariance system which located in central of each experiment site during 2014 2016 the eddy covariance ec system consisted of a sonic anemometer thermometer model csat3 a krypton hygrometer model kh20 a radiation meter model nr lite and a soil moisture meter model em50 in bm experiment site in 2014 while in dm experiment site in 2014 2015 and 2016 and in bm experiment site in 2015 and 2016 the eddy covariance ec system consisted of a sonic anemometer thermometer model csat3 a co2 h2o open path gas analyzer model ec150 a radiation meter model cnr4 a surface temperature meter model si 111 a hygrothermograph model hmp45c and a soil moisture meter model cs616 the sonic anemometer thermometer the krypton hygrometer the co2 h2o open path gas analyser and the surface temperature meter sensors were installed at 4 0 m height above the ground level during 2014 2015 and 3 5 in 2016 and the radiation meter was installed at a 4 0 m height above the ground level during 2014 2015 and one meter above the canopy height in 2016 the soil moisture meters were installed distributed underground 0 1 m depth in 2014 and 2016 and 0 0 8 m depth in 2015 soil heat flux gs was measured at two points bare soil between mulches and soil under mulch by heat flux plates model hfp01 installed at 5 cm below the ground surface all the probes were connected to the data logger with a sampling frequency of 20 hz and sampling interval of 30 min specific observation indicators and methods are shown in table 1 then ec flux data was disposed with eddy pro 4 0 software the software has powerful function which provides almost all the essential correction procedures followed as 1 detection and elimination of raw peaks 2 the double coordinate rotation method finnigan et al 2003 paw et al 2000 3 the frequency loss correction 4 air density correction webb et al 1980 then the software evaluated the quality of ec data and the un reliable data can be deleted based on the assessment of eddy pro 4 0 additionally the footprint of ec measurement was estimated by the software the data which was out of the experimental area should be deleted as for the missing data the linear interpolation method was used for data gap filling when less than 4 observations missed while the mdv mean diurnal variation method was adopted when five or more missed falge et al 2001 and the detailed meteorological biological and agronomic measurements were reported in qin et al 2016 2 3 the adjusted shuttleworth wallace model msw after considering the mulching effect on soil water evaporation the shuttleworth wallace model shuttleworth and wallace 1985 considers two layers for the surface energy and water budget i e the soil water evaporation from the soil surface layer and the transpiration from the canopy height to the reference height layer however the mulching effect on soil water evaporation is not accounted for in the model li et al 2013a adjusted the original two layer shuttleworth wallace sw model after considering the mulching effect on soil water evaporation and developed a three transfer pathway shuttleworth wallace msw model and achieved high consistency when evaluating against the eddy covariance system measured evapotranspiration the first pathway of the msw model is between the canopy and the mulched soil surface the second pathway between the canopy and the bare soil surface and the third pathway is from the reference height above the crop to the canopy height with the msw model the net radiation rn is distributed into sensible heat h latent height λet and soil heat flux g through the soil mulch canopy system the total net radiation rn is divided into the net radiation absorbed by the canopy rnc and the soil rns under the three transfer pathway model the total latent heat λet is distributed into the latent heat from the canopy λt the bare soil λebs and the mulched soil λems and the sensible heat h is distributed into the sensible heat from the canopy hc the bare soil hbs and the mulched soil hms the model diagram is shown in fig 2 so the energy flux from the soil mulch canopy system can be given as follows 1 r n r nc r ns 2 λ e t λ t 1 f m λ e bs f m λ e ms 3 h h c 1 f m h bs f m h ms 4 a r n 1 f m g bs f m g ms for the canopy layer 5 r nc λ t h c 6 h c ρ c p t c t r r a c r a a 7 λ t ρ c p e t cm e r γ r a c r a a r s c 8 λ t h c a c 9 e t c e r δ t c t r v p d r 10 a c r n r n e x p c l a i for the bare soil layer 11 r ns λ e bs h bs g bs 12 h bs ρ c p t bs t r r a s r a a 13 λ e bs ρ c p e t bs e r γ r a c r a a r s s 14 λ e bs h bs a bs 15 e t bs e r δ t bs t r v p d r 16 a bs r ns g bs r n e x p c l a i g bs for the mulched soil layer 17 r ns λ e ms h ms g ms 18 h ms ρ c p t ms t r r a s r a a 19 λ e ms ρ c p e t ms e r γ r a c r a a r s s r s m 20 λ e ms h ms a ms 21 e t ms e r δ t ms t r v p d r 22 a m r ns g ms r n e x p c l a i g ms where e t c e t bs and e t ms are the saturated water vapor pressure kpa at temperature t c t bs and t ms respectively then tbs tms ebs ems and et can be calculated according to eqs 1 22 23 t bs r n e x p c l a i g bs ρ c p vpd r r r a c r a a r s s ρ c p r a s r a a ρ c p δ r r a c r a a r s s t r 24 t ms r n e x p c l a i g ms ρ c p vpd r r r a c r a a r s s r s m ρ c p r a s r a a ρ c p δ r r a c r a a r s s r s m t r 25 e bs ρ c p δ t bs t r vpd r r r a c r a a r s s λ 26 e ms ρ c p δ t ms t r vpd r r r a c r a a r s s r s m λ 27 t ρ c p t c t r r a c r a a λ 28 e t t 1 f m e bs f m e ms aerodynamic resistances r a a and r a s can be calculated from the vertical wind profile in the field and are represented by the eddy diffusion coefficient k shuttleworth and wallace 1985 29 k k u z d z h c k h e x p n 1 z n 0 z h c where n is the extinction coefficient of the eddy diffusion and can be calculated as follows brutsaert 1982 30 n 2 5 h c 1 4 25 h c 10 and n can be determined by the liner interpolation when h c is between 1 and 10 in this study k h can be calculated as follows brtsaert 1982 31 k h k u h c d then the aerodynamic resistances r a a and r a s are expressed as shuttleworth and wallace 1985 32 r a a 1 k u ln z d h c d h c n k h e x p n 1 z 0 d h c 1 33 r a s h c e x p n n k h exp n z 0 h c exp n z 0 d h c here z 0 and d are functions of crop height and leaf area index and can be determined as follows brenner and incoll 1997 d 1 1 h c ln 1 x 0 25 34 35 z 0 0 01 0 3 h c x 0 5 0 x 0 2 0 3 h c 1 d h c 0 2 x 1 5 36 x 0 07 l a i the aerodynamic resistances of the canopy to in canopy flow r a c can be calculated as follows shuttleworth and wallace 1985 37 r a c r b 2 l a i in the study r b was set as 50 s m 1 brisson et al 1998 soil surface resistance r s s can be determined as follows anadranistakis et al 2000 38 r s s r s s min f θ where r s s min is assumed to approximately equal 100 s m 1 camillo and gurney 1986 thompson et al 1981 θ is the mean soil water moisture at 0 100 cm cm3 cm 3 under continuous observation and f θ can be expressed as thompson et al 1981 39 f θ 2 5 θ f θ 1 5 where θ f is the mean filed capacity at 0 100 cm depth with a value of 0 29 cm3 cm 3 in the study canopy resistance r s c can be determined as follows shuttleworth and wallace 1985 40 r s c r st 2 l a i where r st is the mean stomatal resistance of the leaf and was set as 400 s m 1 here shuttleworth and wallace 1985 and when the soil was completely covered with the canopy r s c was assumed to approximately equal 50 s m 1 r s m is the resistance of the film mulch which can be obtained when the simulated daily evapotranspiration etmsw has a good agreement with the measured daily evapotranspiration etec and the value was 1280 s m 1 2 4 evaluation of model performance the performance of the adjusted shuttleworth wallace model msw model was assessed according to the liner regression between estimated e i and observed o i values of et ebs and ems respectively in the study mean bias error mbe root mean square error rmse and index of agreement ia were used to evaluate the performance of msw model eberbach and pala 2005 and these statistical parameters are described as follows poblete echeverría and ortega farias 2009 41 m b e 1 n i 1 n e i o i 42 r m s e 1 n i 1 n e i o i 2 43 i a 1 i 1 n e i o i 2 i 1 n e i o e i o 2 3 results 3 1 comparison of daily ems and ebs under the two sites the daily variation of soil water evaporation under the plastic mulch ems and the bare soil between mulches ebs under the two sites during 2014 2016 are shown in fig 3 in order to reduce the influence of external interference on seed germination and increase the germination rate regular soil water evaporation measurements were carried out after the seeds germination and the germination period lasted for about one week thereby the soil water evaporation values at the beginning one week were unobserved besides there are some gaps in the graphics which were because soil water evaporation during irrigation or precipitation events were not observed therefore the averaged soil water evaporation values were computed using the measured values of observed dates during each growth period table 3 in the early growing stage canopy coverage degree was extremely small so both ems and ebs were high especially after irrigation or rainfall in the middle growing stage the maize grew rapidly and the leaf area index increased rapidly as such both ems and ebs were lower than that at the beginning period except for several days right after irrigation or rainfall events at the end of the growing stage ems and ebs were reduced due to less radiation at the surface soil from leaf interception decreased air temperature irrigation and rainfall for the whole growth season the daily ebs under border irrigation and drip irrigation experiment sites were averagely higher than ems by 45 and 42 in 2014 37 and 47 in 2015 and 54 and 47 in 2016 respectively table 2 evapotranspiration under bm and dm experiment sites were 420 56 mm and 374 95 mm in 2014 472 20 mm and 449 16 mm in 2015 and 513 84 mm and 449 94 mm in 2016 respectively and the proportion of daily ebs to etec is about 10 66 12 04 under site bm and 7 96 10 80 under site dm during 2014 2016 while the proportion of daily ems to etec is about 6 34 7 07 under site bm and 4 4 6 20 under site dm during 2014 2016 table 3 meanwhile the data were separated into two groups to investigate the difference of the mulching effect on the soil water evaporation during the daytime and nighttime 3 2 comparison of daytime ems and ebs under the two treatments the seasonal variations of daytime ems and ebs under the border and drip irrigation experiment sites during 2014 2016 are shown in fig 4 with greater difference in evaporation rate the daytime ebs under the both experiment sites were averagely higher than ems by 55 and 52 in 2014 45 and 56 in 2015 and 61 and 54 in 2016 respectively table 2 the proportion of daytime ebs to etec is about 9 65 10 60 under site bm and 7 25 9 52 under site dm during 2014 2016 whereas the proportion of daytime ems to etec is about 5 02 5 57 under site bm and 2 72 4 10 under site dm during 2014 2016 ebs accounts for most part of daytime soil water evaporation table 3 in bm experiment site the average daytime bare soil temperature simulated by msw model was 17 8 c compared to 25 7 c of average daytime mulched soil temperature in 2014 and the two figures were 17 1 c 26 7 c in 2015 and 16 9 c and 25 3 c in 2016 respectively while in dm experiment site the average daytime bare soil temperature and daytime mulched soil temperature were 17 6 c and 26 2 c in 2014 18 7 c and 26 0 c in 2015 16 9 c and 25 2 c in 2016 respectively on the soil under mulch in the early growing stage of the maize the soil was not covered by the crop canopy completely so the mulch played an important role due to the high reflection of radiation while with the growth of maize the soil was covered by the canopy completely so that the maize grew with a thicker canopy on the soil under mulch and crop canopy intercepted more radiation resulting in lower soil heat flux into the mulched soil gms than soil heat flux into the bare soil between mulches gbs fig 5 furthermore in daytime more soil heat flux into the bare soil between mulches and the bare soil temperature increased rapidly but the average bare soil temperature was lower than that of mulched soil temperature however without the preservation from the transparent plastic mulch substantive soil moisture of the bare soil layer evaporated causing the daytime mean values of ebs to be apparently higher than ems the results indicated that the plastic mulch decreased the soil water evaporation by remarkably increasing the soil resistance simultaneously over the whole growth stage the ebs and ems with drip irrigation was slightly higher than border irrigation table 3 which was due to higher surface soil water content as a result of frequently irrigation events in drip irrigation under mulch experiment site 3 3 comparison of nighttime ems and ebs under the two treatments the nighttime ems and ebs under the two experiment sites during 2014 2016 are shown in fig 6 in the whole growing stage the mean value of nighttime evaporation under border irrigation ranged 0 05 0 35 mm d 1 in 2014 0 2 0 26 mm d 1 in 2015 and 0 1 0 4 mm d 1 in 2016 fig 6 a c and e compared to the border irrigation the nighttime evaporation under the drip irrigation ranged 0 1 0 4 1 mm d 1 in 2014 0 06 0 4 mm d 1 in 2015 and 0 06 0 4 mm d 1 in 2016 fig 6 b d and f the nighttime mean value of ems under border irrigation and drip irrigation was averagely 31 and 25 higher than ebs in 2014 10 and 19 higher in 2015 5 and 19 higher in 2016 respectively table 2 which was significantly different from the daytime evaporation of the mulched layer and the bare soil layer the proportion of nighttime ebs to etec is about 0 93 1 44 under site bm and 0 71 1 28 under site dm during 2014 2016 while the proportion of daily ems to etec is about 0 99 1 94 under site bm and 1 32 2 10 under site dm during 2014 2016 although compared to daytime soil water evaporation nighttime soil water evaporation seems smaller ems accounts for most part of nighttime soil water evaporation table 3 in the bm experiment site the average nighttime bare soil temperature simulated by msw model was 11 7 c compared to 13 7 c of average mulched soil temperature in 2014 and the two figures were 11 8 c 13 6 c in 2015 and 12 1 c and 13 8 c in 2016 respectively while in the dm experiment site the average nighttime bare soil temperature and nighttime mulched soil temperature were 10 8 c 13 1 c in 2014 11 8 c and 13 9 c in 2015 11 9 c and 13 2 c in 2016 respectively this was mainly due to the fact that the soil started to release of heat to atmosphere under the effect of thermal gradient between the soil and the atmosphere during the nighttime during this period the soil heat flux under both bare soil between mulches and mulched soil decreased to negative value as the heat of bare soil between mulches released even faster because of lacking preservation by the plastic mulch the soil heat flux under bare soil surface between mulches gbs was lower than that under mulched soil gms fig 7 therefore the bare soil temperature decreased more rapidly the crop canopy above the soil become thicker with the crop growth then the micrometeorology factors between the plastic mulch and the crop mulch is dynamically verifying with the crop growth on this condition the dynamic variation of micrometeorology factors between plastic mulch and the crop canopy produce influence on water and energy transfer process and finally influence the crop growth this influence was defined as coating effect in this study during the nighttime the longwave radiation released from the crop canopy would increase the effect of plastic mulch resulting in the soil temperature under bare soil tbs lower than that under mulch soil tms by 2 3 c moreover the higher soil moisture under the mulch could also promoted the soil water evaporation through the open holes of the mulch therefore all above led to ems higher than ebs during the nighttime due to the drip irrigation is conducive to the crop growth and the canopy coverage degree increase rapidly the coating effect between the crop canopy and the mulched soil enhanced so that the ebs and ems under drip irrigation was slightly higher than border irrigation tables 2 and 3 3 4 msw simulated bare soil water evaporation and mulched soil water evaporation in order to understand the mechanism underlying these results a sensitivity analysis was conducted though there are many input variables for the msw model most of them were determined by accurate measurement with only aerodynamic resistances from the reference height to in canopy heat exchange plane height r a a aerodynamic resistances from the reference height to soil surface r a s aerodynamic resistances of the canopy to in canopy flow r a c the canopy resistance r s c soil surface resistance r s s and the mulching resistance of the film mulch r s m these six resistance parameters estimated so we only focused on the sensitivity of model towards these six resistance parameters table 4 results indicate that the model was very sensitive to the variation in aerodynamic resistances from the reference height to soil surface r a s the canopy resistance r s c and soil surface resistance r s s when applied to calculation of evapotranspiration et bare soil water evaporation ebs and mulched soil water evaporation ems during both daytime and nighttime while the model was more sensitive to the variation in aerodynamic resistances from the reference height to in canopy heat exchange plane height r a a when computing the nighttime et ebs and ems compared to the daytime et ebs and ems the model was also sensitive to the mulching resistance of the film mulch r s m when simulating the daytime et and ems evapotranspiration measured by eddy covariance system etec was adopted to validate the modified shuttleworth wallace model msw table 5 the results indicated that during the daytime the bare soil water evaporation was higher than mulched soil but lower than the mulched soil during the nighttime which was consistent with the measured results figs 8 9 the results could be attributed to the following two factors 1 thermal driving during the daytime the crop canopy intercepted more net radiation and the plastic mulch reflected more net radiation compared to the bare soil so that the heat flux into the bare soil was more than the mulched soil while during the nighttime the longwave radiation released from the crop canopy above the mulched soil would increase the warming effect of the plastic mulch the thicker the crop canopy is the more remarkable coating effect on plastic mulch 2 moisture driving soil moisture under the plastic mulch was obviously higher than the bare soil but during the daytime the atmosphere evaporation capacity is strong and bare soil between mulches would have higher evaporation potential than the mulched soil because the bare soil between mulches directly exposure to the atmosphere without the protection of plastic mulch under sufficient irrigation conditions there will be upper migration when the surface bare soil layer moisture decreases while during the nighttime the atmosphere evaporation capacity decreases the higher soil moisture and temperature under the plastic mulch promote the soil water evaporation through the open hole of the plastic mulch 4 discussions 4 1 why ems was lower than ebs during daytime in the maize field results indicate that the mulched soil water evaporation ems was significantly lower than the bare soil water evaporation ebs during daytime under either bm or dm experiment sites from 2014 to 2016 fig 4 table 3 the main reason was that plastic mulch significantly increased the water transfer resistance and severely limited the water vapor exchange between the mulched soil and atmosphere yang et al 2012 furthermore the transparent plastic mulch increased the surface reflectance ham and kluitenberg 1994 tarara and ham 1999 wang et al 2011 and lowered the ground net radiation fan et al 2017 compared to the non mulched soil in daytime during early growing stages when the soil was not covered completely thus plastic mulch remarkably restricted the soil water evaporation and saved water during daytime which is in line with previous studies ramakrishna et al 2006 dahiya et al 2007 wang et al 2009 4 2 why ems was higher than ebs during nighttime in the maize field in contrast to previous studies three year continuous experiment results indicate that the ems was higher than ebs during nighttime in the maize field under the both experiment sites fig 6 table 3 these implicated that the plastic mulch promoted the soil water evaporation during the nighttime and more soil water evaporated from the mulched soil these were mainly caused by the coating effect between the crop canopy and the mulched soil in the nighttime air temperature dropped sharply while the long wave radiation from mulched soil to atmosphere was retarded by the plastic mulch besides the crop canopy above the soil was just like a coat which enhanced the warming effect of plastic mulch and the enhanced effect increased with develop of the crop canopy as the crop canopy developing the bare soil between mulches would be covered by the crop canopy even so the crop canopy above the mulched soil is thicker than that above the bare soil between mulches during the whole crop growth period therefore the enhanced effect from the crop canopy on mulched soil is stronger than that on bare soil between mulches as a result the mulched soil heat reserve was higher than the bare soil which is consistent with previous studies tarara 2000 el shaikh and fouda 2008 cao et al 2012 li et al 2016b previous studies confirmed the water saving effect of plastic mulch but did not quantify the time scale of such effect in this study the data were separated into two groups to investigate the difference of the mulching effect on soil water evaporation during the daytime and nighttime during the daytime the proportion of ebs to etec was about 7 25 10 60 during 2014 2016 while the proportion of ems to etec was about 2 72 5 57 during 2014 2016 however during the nighttime the proportion of ebs to etec was about 0 71 1 44 during 2014 2016 while the proportion of ems to etec was about 0 99 2 10 during 2014 2016 ebs accounts for most part of daytime soil water evaporation while ems accounts for most part of nighttime soil water evaporation table 3 we confirmed that the water saving effect of plastic mulch occurred mainly during daytime and the warming effect occurred mainly during nighttime this finding is helpful for understanding the effect of plastic mulch on water use efficiency 5 conclusion previous studies have demonstrated that plastic mulch can reduce soil water evaporation but rarely consider the mulching effect on soil water evaporation and energy transfer process in this study three year continuous field experiments were conducted to contrast soil water evaporation between mulched soil and bare soil using micro lysimeters during daytime and nighttime on this basis we expected to reveal the effect of plastic mulch on soil water evaporation and energy transfer process based on the long term measured data we found that daytime ebs was averagely higher than ems by 45 61 while the nighttime ems was averagely 5 31 higher than ebs during 2014 2016 also a soil mulch canopy atmosphere model was used to consider the effects of the mulch and the model results further support this finding therefore the plastic mulch decreased the soil water evaporation in the daytime but promoted the soil water evaporation in the nighttime our study indicated that water saving effect of the plastic mulch mainly occurred in the daytime while the plastic mulch promoted the soil water evaporation in the nighttime furthermore we found that the crop canopy plays an important role in water and energy transfer process between the soil and the atmosphere therefore the coating effect was proposed for which could enhance the effect of plastic mulch such as increasing water transfer resistance in the daytime and promoting warming effect in the nighttime these provided a new insight for understanding the effect of plastic mulch on soil water evaporation however the energy transfer process between the plastic mulch and the crop canopy and the interactive relationship between coating effect and crop growth still need to be further studied acknowledgements this work was financially supported by the special fund for research in the public interest provided by the chinese ministry of water resources 201501016 chinese national natural science fund 51622907 51379206 51321001 and 91425302 
7091,plastic mulching has been widely used in arid regions because it can decrease soil water evaporation and raise soil temperature previous studies however treated soil water evaporation under plastic mulch to be negligible assuming that the plastic mulch can prevent water exchange between soil and atmosphere completely in order to demonstrate validity of this assumption experiments were conducted from 2014 to 2016 under irrigated maize zea mays field in northwest china comparison experiments of soil water evaporation between mulched soil and the bare soil between mulches were carried out in two seed maize fields with different irrigation method i e border irrigation under mulch site bm and drip irrigation under mulch site dm with micro lysimeters placed under the plastic mulched soil and the bare soil between mulches to evaluate soil water evaporation of each experiment maize field our observations indicated that the soil water evaporation under plastic mulch ems was about 4 04 7 07 of the total evapotranspiration among which ems in the daytime accounted for 3 58 5 37 of the total evapotranspiration and 0 99 2 10 of the total evapotranspiration in the nighttime thus ems was considered not to be negligible for two experiment sites soil water evaporation under bare soil between mulches ebs was obviously higher than the soil water evaporation under plastic mulch ems in daytime but the former was lower than the latter in the nighttime at night the mean soil temperature in the mulched soil was higher than that in the bare soil because of the warming effect of the plastic mulch a soil mulch canopy atmosphere model is used to consider the effects of the mulch and the modeling results further support this finding these results provide a new insight for understanding the effect of plastic mulch on water use efficiency keywords eddy covariance maize micro lysimeter plastic mulch soil water evaporation 1 introduction plastic mulching is a critical technology for saving water in arid regions owing to its function in warming the soil preserving soil moisture and increasing crop yield as such it has been extensively used in crop production such as wheat maize cotton soybean and other crops in the world in contrast with the traditional cultivation methods plastic mulching changes the ground surface reflectance and water vapor transfer resistance thereby altering surface water balance energy balance and plant growth processes however the mechanism of plastic mulch water saving effect remains uncertain thus it is of great value to explore the influence from plastic mulching on soil water evaporation in order to optimize agricultural water resource management until recently numerous studies have been conducted to evaluate the effects of plastic mulching on water and energy transfer in farmland such studies have come to the following main conclusions 1 plastic mulching can reduce soil water evaporation and increase water use efficiency wang et al 2001 xie et al 2005 ramakrishna et al 2006 shen et al 2012 tiwari et al 2016 2 plastic mulching enhances the surface radiation reflectance thereby changing the water and energy balance in farmlands liakatas et al 1986 wilson et al 2002 heusinkveld et al 2004 bonachela et al 2012 yang et al 2012 jafari et al 2012 3 plastic mulching can increase water vapor transfer resistance so that the soil water evaporation under plastic mulching can be assumed to be negligible in the model calculation yang et al 2012 li et al 2013b wang et al 2016 4 the open hole ratio on the plastic mulch has a vital impact on soil water evaporation under plastic mulching the larger the ratio is the smaller the water vapor transfer resistance will be so that the water vapor will be easier to cross through plastic mulch to atmosphere li et al 2003 2005 shi et al 2013 however these previous studies mainly focused on the effect of plastic mulch on evapotranspiration and crop growth but paid little attention to the diurnal dynamic soil water evaporations of mulched and bare soils the measurements of soil water evaporation under the mulched layer are seldom reported also there are only few studies that compared the mulched soil water evaporation and the bare soil water evaporation in some research conducted in mulched crop field the researchers just ignored the soil water evaporation under mulch but adopted the soil water evaporation of bare soil between mulches as the all soil water evaporation throughout the crop field ding et al 2013 jiang et al 2016 moreover no investigation has been made on the effect of plastic mulch on soil water evaporation during daytime or nighttime in arid croplands the micro lysimeter weighing method is a direct method of measuring soil water evaporation and has been widely used in evaluating soil water evaporation under bare soil and canopy due to its small disturbance to surrounding soil simple principle handiness and cost effectiveness liu et al 2002 mitchell et al 2009 cavanaugh et al 2011 zhao et al 2015 previous studies indicated that soil water evaporation measured by the micro lysimeter weighing method obtained results consistent with those measured with other instruments matthias et al 1986 plauborg 1995 and modeling methods li et al 2013a zhao et al 2015 to explore the effect of plastic mulch on soil water evaporation during daytime or nighttime in arid croplands micro lysimeter weighing method was employed to evaluate evaporation under the mulched layer and bare soil layers under two typical irrigated seed maize field in arid regions the border irrigation under mulched field and the drip irrigation under mulched field the former is a traditional irrigation technology which has been widely applied in previous practical agricultural production while the latter is a new irrigation technology combined drip irrigation and plastic mulch technology and has been widely applied in current practical agricultural production thus exploration of mechanism of the water and energy transfer process in the two croplands is of vital important in improving water use efficiency in arid regions on this basis the effect of plastic mulch on soil water evaporation was analyzed as well as the water saving effect and control mechanism of plastic mulching were evaluated 2 materials and method 2 1 experimental site and description three year continuous experiments were conducted at shiyanghe experimental station of china agricultural university located in wuwei city gansu province of northwest china n 37 52 e 102 50 elevation 1581 m the experimental site is located in a typical continental temperate climate zone with mean annual temperature of 8 c annual accumulated temperature 0 c of 3550 c mean annual pan evaporation of approximately 2000 mm annual precipitation of 164 mm the average annual sunshine duration of 3000 h the groundwater table at the station is 40 50 m below the ground surface li et al 2015 2016a qin et al 2016 the comparison experiments were conducted at both border irrigation under mulch seed maize field site bm and drip irrigation under mulch seed maize field site dm seeds of seeding maize field are divide into male maize seeds and female maize seeds the two have minor difference from the point of genetic breeding male maize seeds are more conducive to the development of stamens in maize plants while female maize seeds are more conducive to the growth of maize plants reproductive function professional semi automated machines were applied to lay out plastic mulch open holes and sow in the holes in both seed maize experiment fields male maize seeds and female maize seeds were sow in different holes with one line for male plants and several lines for female plants however both male maize seeds and female maize seeds were sown fixed distance apart within each row during the three years one or two seeds were sow in one open hole while germination rates were different from each year and in turn cause different planting density besides when the professional semi automatic machines open holes above the plastic mulch the area of open hole would have minor difference due to influence of artificial work the plastic transparent mulch applied in both treatments was 8 μm thick with a shortwave transmissivity reflectivity and absorptivity of 0 85 0 10 and 0 05 respectively and a longwave transmissivity of 0 74 the optical properties of the plastic mulch mentioned above were measured by spectrophotometer and the plastic mulches were laid out along east to west with width of 1 2 m and there is bare soil with width of 0 4 m between the two plastic mulches thus the ratio of the area of mulched soil and bare soil was 3 1 specifically the border irrigation under mulch technology is a widely applied traditional agricultural irrigation technology which built ridges in the field and the field is split into many narrow and long plots irrigation water from sub lateral canals flow into the plots along the long side of the plots infiltration and wetting soil layer site bm is irrigated seed maize field under plastic mulch with an area of 400 m 200 m during 2014 2016 the field were sown in one line male plants and four line female plants in 2014 2015 while one line male plants and seven line female plants in 2016 respectively five seed rows were covered under one plastic mulch both female and male seeds were sown 0 3 m apart within each row and the distance between seed rows under the same mulch was 0 25 m site bm see in fig 1 germination ratios were approximately 87 87 and 93 during 2014 2015 and 2016 respectively the average hole size was approximately 10 2 10 8 cm2 and ratios of the total area of holes opened for seeding to the total plastic mulch area were 1 63 1 69 and 1 73 in 2014 2015 2016 respectively overall planting density was 108 000 plants ha 1 during 2014 2015 and 116 176 plants ha 1 in 2016 the soil at 1 m depth in the site is silty loam with an average soil dry bulk density of 1 52 g cm 3 and volumetric soil water content at a field capacity θfc of 0 29 cm3 cm 3 during 2014 2016 the drip irrigation under mulch technology is a widely applied new agricultural irrigation technology which combined drip irrigation and plastic mulch technologies site dm is irrigated seed maize field under plastic mulch with an area of 2000 m 1000 m during 2014 2015 and 400 m 200 m in 2016 the field were sown in one line male plants and seven line female plants in 2014 2015 and one line male plants and six line female plants in 2016 respectively four seed rows were covered under one plastic mulch both female and male seeds were sown 0 22 m apart within each row and the distance between seed rows under the same mulch was 0 30 m site dm see in fig 1 germination ratios were approximately 90 90 and 91 during 2014 2015 and 2016 respectively the average hole size was approximately 10 6 11 8 cm2 ratios of the total area of holes opened for seeding and the total plastic mulch area were 2 14 2 23 and 2 01 in 2014 2015 2016 respectively overall planting density was 112 500 plants ha 1 during 2014 2015 and 109 474 plants ha 1 in 2016 the soil texture at 0 0 8 m depth is silty loam and that at 0 8 1 0 m depth is silt during 2014 2016 with an average soil dry bulk density of 1 52 g cm 3 averaged θfc of 0 30 cm3 cm 3 in 2014 while the average soil dry bulk density and θfc is 1 46 g cm 3 and 0 29 cm3 cm 3 in 2015 and 2016 respectively qin et al 2016 the total irrigation amount in bm experiment site was 360 mm 442 mm 480 mm in 2014 2015 and 2016 respectively and 350 mm 449 mm 388 mm under dm treatment in 2014 2015 and 2016 respectively detailed description of irrigation and precipitation events has been reported in qin et al 2016 2 2 measurements and data collection 2 2 1 soil evaporation in our experiment micro lysimeters made of pvc tubes were applied to monitor soil water evaporation with the weighing method every day the micro lysimeter composed of inner and outer tubes with the diameter of 11 cm for the outer tube and 10 cm for inner tube the height of both tubes was 20 cm the bottom of the inner tube was covered with nylon wire which was convenient for water vapor transfer in vertical direction when installing the micro lysimeters in the bare soil the inner tube was firstly drilled into the undisturbed soil in the installation location to ensure the homogeneity of soil water then the inner tube was dig out as carefully as possible to minimize disturbance to surrounding soil and then a piece of filter paper was placed inside the bottom of the inner tube and a piece of wire mesh was placed outside the tube to ensure the water and energy transfer in the vertical direction of soil and finally both outer tube and inner tube were put into the soil and try to recover the soil when installing the micro lysimeter in plastic mulch the first step was to uncover the plastic mulch and installed the micro lysimeter then recovered the plastic mulch and trepanned in the plastic mulch with the same area as the bottom of micro lysimeter finally sealed the hole with another small piece of plastic mulch to sustain original micro meteorology under the mulch the comparison experiments between soil water evaporation under mulch and that under bare soil were carried out in both bm and dm sites during 2014 2016 the micro lysimeter was installed between crops under the mulch and bare soil between mulches of the two sites fig 1 with each site having 6 replications the soil water evaporation at each micro lysimeter was evaluated with the weighing method by an electronic scale mettler toledo pl6001 l usa with accuracy of 0 1 g at 7 30 am and 19 30 pm every day respectively with the difference being the soil water evaporation of the daytime or nighttime the micro lysimeter under plastic mulch was placed to the original place after each weight measurement and a scotch tape was used to seal the plastic mulch to ensure integrity of the hydrothermal environment before each weight measurement the adhesive tape was torn off to take out the micro lysimeter from the tank regular reinstallation of the micro lysimeter was adopted to minimize the difference between soil moisture inside and outside the tubes yunusa et al 2004 and comparison experiments of soil water evaporation under mulch between site bm open hole ratios were 1 63 1 69 and 1 73 in 2014 2015 and 2016 respectively and site dm open hole ratios were 2 14 2 23 and 2 01 in 2014 2015 and 2016 respectively before planting maize period were also carried out during 2015 2016 in order to investigate minor difference of open hole ratios on soil water evaporation measurement results indicated that the differences of soil water evaporation under mulch between the two open hole ratios were smaller 2015 ems1 69 1 01ems2 23 0 02 r2 0 93 10 observations 2016 ems1 73 0 99ems2 01 0 01 r2 0 96 9 observations thus the minor difference between the open hole ratios has little effect on our soil water evaporation measurements besides soil water evaporation in irrigation or precipitation events were not observed becausethe data during these period is inaccurate therefore the averaged soil water evaporation values were computed using the measured values of observed dates during each growth period 2 2 2 meteorological data and eddy covariance system all climatic parameters listed in table 1 needed to calculate evaporation by the msw model and evapotranspiration were measured with eddy covariance system which located in central of each experiment site during 2014 2016 the eddy covariance ec system consisted of a sonic anemometer thermometer model csat3 a krypton hygrometer model kh20 a radiation meter model nr lite and a soil moisture meter model em50 in bm experiment site in 2014 while in dm experiment site in 2014 2015 and 2016 and in bm experiment site in 2015 and 2016 the eddy covariance ec system consisted of a sonic anemometer thermometer model csat3 a co2 h2o open path gas analyzer model ec150 a radiation meter model cnr4 a surface temperature meter model si 111 a hygrothermograph model hmp45c and a soil moisture meter model cs616 the sonic anemometer thermometer the krypton hygrometer the co2 h2o open path gas analyser and the surface temperature meter sensors were installed at 4 0 m height above the ground level during 2014 2015 and 3 5 in 2016 and the radiation meter was installed at a 4 0 m height above the ground level during 2014 2015 and one meter above the canopy height in 2016 the soil moisture meters were installed distributed underground 0 1 m depth in 2014 and 2016 and 0 0 8 m depth in 2015 soil heat flux gs was measured at two points bare soil between mulches and soil under mulch by heat flux plates model hfp01 installed at 5 cm below the ground surface all the probes were connected to the data logger with a sampling frequency of 20 hz and sampling interval of 30 min specific observation indicators and methods are shown in table 1 then ec flux data was disposed with eddy pro 4 0 software the software has powerful function which provides almost all the essential correction procedures followed as 1 detection and elimination of raw peaks 2 the double coordinate rotation method finnigan et al 2003 paw et al 2000 3 the frequency loss correction 4 air density correction webb et al 1980 then the software evaluated the quality of ec data and the un reliable data can be deleted based on the assessment of eddy pro 4 0 additionally the footprint of ec measurement was estimated by the software the data which was out of the experimental area should be deleted as for the missing data the linear interpolation method was used for data gap filling when less than 4 observations missed while the mdv mean diurnal variation method was adopted when five or more missed falge et al 2001 and the detailed meteorological biological and agronomic measurements were reported in qin et al 2016 2 3 the adjusted shuttleworth wallace model msw after considering the mulching effect on soil water evaporation the shuttleworth wallace model shuttleworth and wallace 1985 considers two layers for the surface energy and water budget i e the soil water evaporation from the soil surface layer and the transpiration from the canopy height to the reference height layer however the mulching effect on soil water evaporation is not accounted for in the model li et al 2013a adjusted the original two layer shuttleworth wallace sw model after considering the mulching effect on soil water evaporation and developed a three transfer pathway shuttleworth wallace msw model and achieved high consistency when evaluating against the eddy covariance system measured evapotranspiration the first pathway of the msw model is between the canopy and the mulched soil surface the second pathway between the canopy and the bare soil surface and the third pathway is from the reference height above the crop to the canopy height with the msw model the net radiation rn is distributed into sensible heat h latent height λet and soil heat flux g through the soil mulch canopy system the total net radiation rn is divided into the net radiation absorbed by the canopy rnc and the soil rns under the three transfer pathway model the total latent heat λet is distributed into the latent heat from the canopy λt the bare soil λebs and the mulched soil λems and the sensible heat h is distributed into the sensible heat from the canopy hc the bare soil hbs and the mulched soil hms the model diagram is shown in fig 2 so the energy flux from the soil mulch canopy system can be given as follows 1 r n r nc r ns 2 λ e t λ t 1 f m λ e bs f m λ e ms 3 h h c 1 f m h bs f m h ms 4 a r n 1 f m g bs f m g ms for the canopy layer 5 r nc λ t h c 6 h c ρ c p t c t r r a c r a a 7 λ t ρ c p e t cm e r γ r a c r a a r s c 8 λ t h c a c 9 e t c e r δ t c t r v p d r 10 a c r n r n e x p c l a i for the bare soil layer 11 r ns λ e bs h bs g bs 12 h bs ρ c p t bs t r r a s r a a 13 λ e bs ρ c p e t bs e r γ r a c r a a r s s 14 λ e bs h bs a bs 15 e t bs e r δ t bs t r v p d r 16 a bs r ns g bs r n e x p c l a i g bs for the mulched soil layer 17 r ns λ e ms h ms g ms 18 h ms ρ c p t ms t r r a s r a a 19 λ e ms ρ c p e t ms e r γ r a c r a a r s s r s m 20 λ e ms h ms a ms 21 e t ms e r δ t ms t r v p d r 22 a m r ns g ms r n e x p c l a i g ms where e t c e t bs and e t ms are the saturated water vapor pressure kpa at temperature t c t bs and t ms respectively then tbs tms ebs ems and et can be calculated according to eqs 1 22 23 t bs r n e x p c l a i g bs ρ c p vpd r r r a c r a a r s s ρ c p r a s r a a ρ c p δ r r a c r a a r s s t r 24 t ms r n e x p c l a i g ms ρ c p vpd r r r a c r a a r s s r s m ρ c p r a s r a a ρ c p δ r r a c r a a r s s r s m t r 25 e bs ρ c p δ t bs t r vpd r r r a c r a a r s s λ 26 e ms ρ c p δ t ms t r vpd r r r a c r a a r s s r s m λ 27 t ρ c p t c t r r a c r a a λ 28 e t t 1 f m e bs f m e ms aerodynamic resistances r a a and r a s can be calculated from the vertical wind profile in the field and are represented by the eddy diffusion coefficient k shuttleworth and wallace 1985 29 k k u z d z h c k h e x p n 1 z n 0 z h c where n is the extinction coefficient of the eddy diffusion and can be calculated as follows brutsaert 1982 30 n 2 5 h c 1 4 25 h c 10 and n can be determined by the liner interpolation when h c is between 1 and 10 in this study k h can be calculated as follows brtsaert 1982 31 k h k u h c d then the aerodynamic resistances r a a and r a s are expressed as shuttleworth and wallace 1985 32 r a a 1 k u ln z d h c d h c n k h e x p n 1 z 0 d h c 1 33 r a s h c e x p n n k h exp n z 0 h c exp n z 0 d h c here z 0 and d are functions of crop height and leaf area index and can be determined as follows brenner and incoll 1997 d 1 1 h c ln 1 x 0 25 34 35 z 0 0 01 0 3 h c x 0 5 0 x 0 2 0 3 h c 1 d h c 0 2 x 1 5 36 x 0 07 l a i the aerodynamic resistances of the canopy to in canopy flow r a c can be calculated as follows shuttleworth and wallace 1985 37 r a c r b 2 l a i in the study r b was set as 50 s m 1 brisson et al 1998 soil surface resistance r s s can be determined as follows anadranistakis et al 2000 38 r s s r s s min f θ where r s s min is assumed to approximately equal 100 s m 1 camillo and gurney 1986 thompson et al 1981 θ is the mean soil water moisture at 0 100 cm cm3 cm 3 under continuous observation and f θ can be expressed as thompson et al 1981 39 f θ 2 5 θ f θ 1 5 where θ f is the mean filed capacity at 0 100 cm depth with a value of 0 29 cm3 cm 3 in the study canopy resistance r s c can be determined as follows shuttleworth and wallace 1985 40 r s c r st 2 l a i where r st is the mean stomatal resistance of the leaf and was set as 400 s m 1 here shuttleworth and wallace 1985 and when the soil was completely covered with the canopy r s c was assumed to approximately equal 50 s m 1 r s m is the resistance of the film mulch which can be obtained when the simulated daily evapotranspiration etmsw has a good agreement with the measured daily evapotranspiration etec and the value was 1280 s m 1 2 4 evaluation of model performance the performance of the adjusted shuttleworth wallace model msw model was assessed according to the liner regression between estimated e i and observed o i values of et ebs and ems respectively in the study mean bias error mbe root mean square error rmse and index of agreement ia were used to evaluate the performance of msw model eberbach and pala 2005 and these statistical parameters are described as follows poblete echeverría and ortega farias 2009 41 m b e 1 n i 1 n e i o i 42 r m s e 1 n i 1 n e i o i 2 43 i a 1 i 1 n e i o i 2 i 1 n e i o e i o 2 3 results 3 1 comparison of daily ems and ebs under the two sites the daily variation of soil water evaporation under the plastic mulch ems and the bare soil between mulches ebs under the two sites during 2014 2016 are shown in fig 3 in order to reduce the influence of external interference on seed germination and increase the germination rate regular soil water evaporation measurements were carried out after the seeds germination and the germination period lasted for about one week thereby the soil water evaporation values at the beginning one week were unobserved besides there are some gaps in the graphics which were because soil water evaporation during irrigation or precipitation events were not observed therefore the averaged soil water evaporation values were computed using the measured values of observed dates during each growth period table 3 in the early growing stage canopy coverage degree was extremely small so both ems and ebs were high especially after irrigation or rainfall in the middle growing stage the maize grew rapidly and the leaf area index increased rapidly as such both ems and ebs were lower than that at the beginning period except for several days right after irrigation or rainfall events at the end of the growing stage ems and ebs were reduced due to less radiation at the surface soil from leaf interception decreased air temperature irrigation and rainfall for the whole growth season the daily ebs under border irrigation and drip irrigation experiment sites were averagely higher than ems by 45 and 42 in 2014 37 and 47 in 2015 and 54 and 47 in 2016 respectively table 2 evapotranspiration under bm and dm experiment sites were 420 56 mm and 374 95 mm in 2014 472 20 mm and 449 16 mm in 2015 and 513 84 mm and 449 94 mm in 2016 respectively and the proportion of daily ebs to etec is about 10 66 12 04 under site bm and 7 96 10 80 under site dm during 2014 2016 while the proportion of daily ems to etec is about 6 34 7 07 under site bm and 4 4 6 20 under site dm during 2014 2016 table 3 meanwhile the data were separated into two groups to investigate the difference of the mulching effect on the soil water evaporation during the daytime and nighttime 3 2 comparison of daytime ems and ebs under the two treatments the seasonal variations of daytime ems and ebs under the border and drip irrigation experiment sites during 2014 2016 are shown in fig 4 with greater difference in evaporation rate the daytime ebs under the both experiment sites were averagely higher than ems by 55 and 52 in 2014 45 and 56 in 2015 and 61 and 54 in 2016 respectively table 2 the proportion of daytime ebs to etec is about 9 65 10 60 under site bm and 7 25 9 52 under site dm during 2014 2016 whereas the proportion of daytime ems to etec is about 5 02 5 57 under site bm and 2 72 4 10 under site dm during 2014 2016 ebs accounts for most part of daytime soil water evaporation table 3 in bm experiment site the average daytime bare soil temperature simulated by msw model was 17 8 c compared to 25 7 c of average daytime mulched soil temperature in 2014 and the two figures were 17 1 c 26 7 c in 2015 and 16 9 c and 25 3 c in 2016 respectively while in dm experiment site the average daytime bare soil temperature and daytime mulched soil temperature were 17 6 c and 26 2 c in 2014 18 7 c and 26 0 c in 2015 16 9 c and 25 2 c in 2016 respectively on the soil under mulch in the early growing stage of the maize the soil was not covered by the crop canopy completely so the mulch played an important role due to the high reflection of radiation while with the growth of maize the soil was covered by the canopy completely so that the maize grew with a thicker canopy on the soil under mulch and crop canopy intercepted more radiation resulting in lower soil heat flux into the mulched soil gms than soil heat flux into the bare soil between mulches gbs fig 5 furthermore in daytime more soil heat flux into the bare soil between mulches and the bare soil temperature increased rapidly but the average bare soil temperature was lower than that of mulched soil temperature however without the preservation from the transparent plastic mulch substantive soil moisture of the bare soil layer evaporated causing the daytime mean values of ebs to be apparently higher than ems the results indicated that the plastic mulch decreased the soil water evaporation by remarkably increasing the soil resistance simultaneously over the whole growth stage the ebs and ems with drip irrigation was slightly higher than border irrigation table 3 which was due to higher surface soil water content as a result of frequently irrigation events in drip irrigation under mulch experiment site 3 3 comparison of nighttime ems and ebs under the two treatments the nighttime ems and ebs under the two experiment sites during 2014 2016 are shown in fig 6 in the whole growing stage the mean value of nighttime evaporation under border irrigation ranged 0 05 0 35 mm d 1 in 2014 0 2 0 26 mm d 1 in 2015 and 0 1 0 4 mm d 1 in 2016 fig 6 a c and e compared to the border irrigation the nighttime evaporation under the drip irrigation ranged 0 1 0 4 1 mm d 1 in 2014 0 06 0 4 mm d 1 in 2015 and 0 06 0 4 mm d 1 in 2016 fig 6 b d and f the nighttime mean value of ems under border irrigation and drip irrigation was averagely 31 and 25 higher than ebs in 2014 10 and 19 higher in 2015 5 and 19 higher in 2016 respectively table 2 which was significantly different from the daytime evaporation of the mulched layer and the bare soil layer the proportion of nighttime ebs to etec is about 0 93 1 44 under site bm and 0 71 1 28 under site dm during 2014 2016 while the proportion of daily ems to etec is about 0 99 1 94 under site bm and 1 32 2 10 under site dm during 2014 2016 although compared to daytime soil water evaporation nighttime soil water evaporation seems smaller ems accounts for most part of nighttime soil water evaporation table 3 in the bm experiment site the average nighttime bare soil temperature simulated by msw model was 11 7 c compared to 13 7 c of average mulched soil temperature in 2014 and the two figures were 11 8 c 13 6 c in 2015 and 12 1 c and 13 8 c in 2016 respectively while in the dm experiment site the average nighttime bare soil temperature and nighttime mulched soil temperature were 10 8 c 13 1 c in 2014 11 8 c and 13 9 c in 2015 11 9 c and 13 2 c in 2016 respectively this was mainly due to the fact that the soil started to release of heat to atmosphere under the effect of thermal gradient between the soil and the atmosphere during the nighttime during this period the soil heat flux under both bare soil between mulches and mulched soil decreased to negative value as the heat of bare soil between mulches released even faster because of lacking preservation by the plastic mulch the soil heat flux under bare soil surface between mulches gbs was lower than that under mulched soil gms fig 7 therefore the bare soil temperature decreased more rapidly the crop canopy above the soil become thicker with the crop growth then the micrometeorology factors between the plastic mulch and the crop mulch is dynamically verifying with the crop growth on this condition the dynamic variation of micrometeorology factors between plastic mulch and the crop canopy produce influence on water and energy transfer process and finally influence the crop growth this influence was defined as coating effect in this study during the nighttime the longwave radiation released from the crop canopy would increase the effect of plastic mulch resulting in the soil temperature under bare soil tbs lower than that under mulch soil tms by 2 3 c moreover the higher soil moisture under the mulch could also promoted the soil water evaporation through the open holes of the mulch therefore all above led to ems higher than ebs during the nighttime due to the drip irrigation is conducive to the crop growth and the canopy coverage degree increase rapidly the coating effect between the crop canopy and the mulched soil enhanced so that the ebs and ems under drip irrigation was slightly higher than border irrigation tables 2 and 3 3 4 msw simulated bare soil water evaporation and mulched soil water evaporation in order to understand the mechanism underlying these results a sensitivity analysis was conducted though there are many input variables for the msw model most of them were determined by accurate measurement with only aerodynamic resistances from the reference height to in canopy heat exchange plane height r a a aerodynamic resistances from the reference height to soil surface r a s aerodynamic resistances of the canopy to in canopy flow r a c the canopy resistance r s c soil surface resistance r s s and the mulching resistance of the film mulch r s m these six resistance parameters estimated so we only focused on the sensitivity of model towards these six resistance parameters table 4 results indicate that the model was very sensitive to the variation in aerodynamic resistances from the reference height to soil surface r a s the canopy resistance r s c and soil surface resistance r s s when applied to calculation of evapotranspiration et bare soil water evaporation ebs and mulched soil water evaporation ems during both daytime and nighttime while the model was more sensitive to the variation in aerodynamic resistances from the reference height to in canopy heat exchange plane height r a a when computing the nighttime et ebs and ems compared to the daytime et ebs and ems the model was also sensitive to the mulching resistance of the film mulch r s m when simulating the daytime et and ems evapotranspiration measured by eddy covariance system etec was adopted to validate the modified shuttleworth wallace model msw table 5 the results indicated that during the daytime the bare soil water evaporation was higher than mulched soil but lower than the mulched soil during the nighttime which was consistent with the measured results figs 8 9 the results could be attributed to the following two factors 1 thermal driving during the daytime the crop canopy intercepted more net radiation and the plastic mulch reflected more net radiation compared to the bare soil so that the heat flux into the bare soil was more than the mulched soil while during the nighttime the longwave radiation released from the crop canopy above the mulched soil would increase the warming effect of the plastic mulch the thicker the crop canopy is the more remarkable coating effect on plastic mulch 2 moisture driving soil moisture under the plastic mulch was obviously higher than the bare soil but during the daytime the atmosphere evaporation capacity is strong and bare soil between mulches would have higher evaporation potential than the mulched soil because the bare soil between mulches directly exposure to the atmosphere without the protection of plastic mulch under sufficient irrigation conditions there will be upper migration when the surface bare soil layer moisture decreases while during the nighttime the atmosphere evaporation capacity decreases the higher soil moisture and temperature under the plastic mulch promote the soil water evaporation through the open hole of the plastic mulch 4 discussions 4 1 why ems was lower than ebs during daytime in the maize field results indicate that the mulched soil water evaporation ems was significantly lower than the bare soil water evaporation ebs during daytime under either bm or dm experiment sites from 2014 to 2016 fig 4 table 3 the main reason was that plastic mulch significantly increased the water transfer resistance and severely limited the water vapor exchange between the mulched soil and atmosphere yang et al 2012 furthermore the transparent plastic mulch increased the surface reflectance ham and kluitenberg 1994 tarara and ham 1999 wang et al 2011 and lowered the ground net radiation fan et al 2017 compared to the non mulched soil in daytime during early growing stages when the soil was not covered completely thus plastic mulch remarkably restricted the soil water evaporation and saved water during daytime which is in line with previous studies ramakrishna et al 2006 dahiya et al 2007 wang et al 2009 4 2 why ems was higher than ebs during nighttime in the maize field in contrast to previous studies three year continuous experiment results indicate that the ems was higher than ebs during nighttime in the maize field under the both experiment sites fig 6 table 3 these implicated that the plastic mulch promoted the soil water evaporation during the nighttime and more soil water evaporated from the mulched soil these were mainly caused by the coating effect between the crop canopy and the mulched soil in the nighttime air temperature dropped sharply while the long wave radiation from mulched soil to atmosphere was retarded by the plastic mulch besides the crop canopy above the soil was just like a coat which enhanced the warming effect of plastic mulch and the enhanced effect increased with develop of the crop canopy as the crop canopy developing the bare soil between mulches would be covered by the crop canopy even so the crop canopy above the mulched soil is thicker than that above the bare soil between mulches during the whole crop growth period therefore the enhanced effect from the crop canopy on mulched soil is stronger than that on bare soil between mulches as a result the mulched soil heat reserve was higher than the bare soil which is consistent with previous studies tarara 2000 el shaikh and fouda 2008 cao et al 2012 li et al 2016b previous studies confirmed the water saving effect of plastic mulch but did not quantify the time scale of such effect in this study the data were separated into two groups to investigate the difference of the mulching effect on soil water evaporation during the daytime and nighttime during the daytime the proportion of ebs to etec was about 7 25 10 60 during 2014 2016 while the proportion of ems to etec was about 2 72 5 57 during 2014 2016 however during the nighttime the proportion of ebs to etec was about 0 71 1 44 during 2014 2016 while the proportion of ems to etec was about 0 99 2 10 during 2014 2016 ebs accounts for most part of daytime soil water evaporation while ems accounts for most part of nighttime soil water evaporation table 3 we confirmed that the water saving effect of plastic mulch occurred mainly during daytime and the warming effect occurred mainly during nighttime this finding is helpful for understanding the effect of plastic mulch on water use efficiency 5 conclusion previous studies have demonstrated that plastic mulch can reduce soil water evaporation but rarely consider the mulching effect on soil water evaporation and energy transfer process in this study three year continuous field experiments were conducted to contrast soil water evaporation between mulched soil and bare soil using micro lysimeters during daytime and nighttime on this basis we expected to reveal the effect of plastic mulch on soil water evaporation and energy transfer process based on the long term measured data we found that daytime ebs was averagely higher than ems by 45 61 while the nighttime ems was averagely 5 31 higher than ebs during 2014 2016 also a soil mulch canopy atmosphere model was used to consider the effects of the mulch and the model results further support this finding therefore the plastic mulch decreased the soil water evaporation in the daytime but promoted the soil water evaporation in the nighttime our study indicated that water saving effect of the plastic mulch mainly occurred in the daytime while the plastic mulch promoted the soil water evaporation in the nighttime furthermore we found that the crop canopy plays an important role in water and energy transfer process between the soil and the atmosphere therefore the coating effect was proposed for which could enhance the effect of plastic mulch such as increasing water transfer resistance in the daytime and promoting warming effect in the nighttime these provided a new insight for understanding the effect of plastic mulch on soil water evaporation however the energy transfer process between the plastic mulch and the crop canopy and the interactive relationship between coating effect and crop growth still need to be further studied acknowledgements this work was financially supported by the special fund for research in the public interest provided by the chinese ministry of water resources 201501016 chinese national natural science fund 51622907 51379206 51321001 and 91425302 
7092,brinkman s model is one of the common mathematical formulations used in modeling fluid flow in karst aquifers the brinkman s model is a hybrid formulation that allows the use of a single transport equation to model fluid flow in both the free flow and porous regions of a karst aquifer by transitioning between the stokes equation and the darcy s law however the brinkman s model is computationally expensive requiring the solution of four different equations to obtain the pressures and velocities in a three dimensional aquifer darcy s model provides a cheaper alternative because it allows the substitution of the darcy s equation into the mass conservation equation and thus requires the solution of only one parabolic equation however while the darcy s model produces accurate results within the porous medium it fails to provide satisfactory results in the free flow regions of the karst aquifers we propose a sector modeling approach to model fluid flow in karst aquifers the sector modeling approach takes advantage of both the computational inexpensiveness of the darcy s model and the accuracy of brinkman s model in the caves this method was compared to the brinkman s model and the darcy s model three examples are presented to study the effectiveness of the sector modeling technique the first example is a simple model consisting of a straight conduit surrounded by porous regimes on either side while the second and third examples are more complicated structures consisting of complex geometrical caves embedded in a highly heterogeneous porous medium results show that the sector modeling approach provides an excellent match to the brinkman s model and with much faster computations specifically sector modeling was 4 6 times faster than the brinkman s model in the first example 13 times faster in the second and 25 times faster in the third example we also observed negligible deterioration in accuracy of results from sector modeling when the size of the extracted sector relative to the full field is reduced keywords sector modeling technique brinkman s model karst aquifers tracer transport 1 introduction karst aquifers cover 12 of the terrestrial land and provide a source of drinking water to almost a quarter of the world s population ford and williams 2007 andreo et al 2010 hartmann et al 2014 therefore it is essential to accurately model the flow of water within these aquifers the uniqueness of karst reservoirs is that the karst topography is characterized by the presence of highly porous and permeable caverns and channels formed by karstification jackson 1997 the karst caves provide pathways that facilitate the movement of fluids and contaminants within such aquifers huntoon 1999 advection diffusion and adsorption are the main physical processes responsible for the transport of contaminants solutes and tracers with advection being the primary process responsible for movement of these substances in caves field and pinsky 2000 several numerical studies have been conducted on modeling the transport of chemicals within karst aquifers göppert and goldscheider 2007 kincaid et al 2002 maloszewski et al 1999 morales juberías et al 1997 rivard and delay 2004 numerical modelling of groundwater flow within karst aquifers is challenging the complexity in modelling arises due to the presence of non darcian flow elements in the transport equations mainly due to the presence of fractures vugs and caves having varying sizes connectivity and distribution depending on the depositional environment and the diagenetic processes involved the presence of these geomorphological features introduces two major uncertainties which adversely affect the accuracy of the model 1 the lack of knowledge of the exact position of the interface between porous medium and vugs caves complicates the accurate modelling of flow in such features popov et al 2009 and 2 uncertainties related to the physical properties of the different geomorphological features such as their sizes connectivities and distributions directly affect the rate and direction of fluid flow in the aquifer kossack and gurpinar 2001 different approaches have been developed to model the flow of groundwater in karst aquifers the simplest is the lumped parameter model or the black box model scanlon et al 2003 wanakule and anaya 1993 zhang et al 1996 the main advantage of this model is that it requires limited information to produce results as it neglects the spatial dimensions of the aquifer however this omission of spatial dimensions is undesirable because it leads to a lack of information on the direction and rates of groundwater flow the other method of modelling flow within karst aquifers is the distributed parameter model which requires the discretization of the whole system into grid blocks thus this method uses information on the spatial variability of the system generally modeling fluid flow using the distributed parameter model involves combining the continuity equation with an appropriate transport equation the continuity equation ensures that all mass flows in and out of the flow domain are accounted for the transport equation describes the manner in which fluid mass is moved from one point to the other within the flow domain under the distributed parameter model many approaches are currently used to model flow of fluid in karstic aquifers one of these methods is the equivalent porous media epm approach in which the fractures vugs caves and the porous matrix are treated as one single equivalent porous medium with a single hydraulic conductivity ghasemizadeh et al 2015 long et al 1982 pankow et al 1986 scanlon et al 2003 the disadvantage of this method is that it oversimplifies the complex flow patterns and may not be accurate another limitation of the epm model is that it cannot accurately predict the direction of the flow the discontinuum approach also known as darcy stokes model uses the navier stokes equation to model flow in the free flow region and the darcy s equation in the porous region arbogast and brunson 2007 arbogast and gomez 2009 arbogast and lehr 2006 peng et al 2009 a slip velocity was introduced at the interface between the two regions using appropriate boundary conditions beavers et al 1970 beavers and joseph 1967 the darcy stokes equation along with the interface condition models a slip velocity at the interface between the cave and the porous media this yields a sharp change to darcy s velocity in the porous region this is not accurate because as the fluid transitions from the free flow region to the porous media the fluid velocity should gradually decreases inside the porous media until it becomes equal to the darcy velocity neale and nader 1974 brinkman s equation brinkman 1949 models flow in karst aquifers using a single equation that yields a simplified navier stokes equation in the caves and breaks down into the darcy s equation in the porous region hence in the brinkman s model the whole system is treated as a single continuous domain yao and huang 2016 several successful studies have been carried out to simulate the flow of single phase fluids in fractured vuggy microkarstic aquifers and reservoirs bi et al 2009 he et al 2015 krotkiewski et al 2011 ligaarden et al 2010 mohamed et al 2015 popov et al 2009 2007b the brinkman s model attempts to model flow within karst aquifers by simultaneously solving the mass continuity equation and the momentum equation brinkman s equation for the pressures and velocity distribution within the karst aquifer because the brinkman s model solves one continuity equation and up to three momentum balance equation per grid block the method is very expensive particularly for large aquifers the darcy s model offers a cheaper alternative to the brinkman s model because it does not require the solution of multiple equations per grid block a simplification is made by replacing the velocity term in the mass continuity equation by the darcy s equation this allows solving for only the pressure distribution at the new time step in the aquifer and then computing the velocities using these pressures while the darcy s model gives reliable estimates of pressure and velocity distributions in the porous media it gives an inaccurate velocity profile in the caves field 1997 we propose a sector modeling approach for fluid flow in karst aquifers this approach consists of three stages at every simulation time step the first stage involves solving the cheap darcy s model on the entire aquifer full field model while the second stage involves solving the more expensive brinkman s model on much smaller sectors extracted from the reservoir sector models the third stage involves updating the result from the full field model with those from the sector models thus the sector modeling approach takes advantage of both the computational inexpensiveness of the darcy s model and the accuracy of brinkman s model in the caves to avoid confusion we define some terminologies introduced in this paper cave is synonymous with free flow region while full field is synonymous with entire aquifer a full field model involves solving the darcy s model on the entire aquifer a sector consists of a cave and a small porous region surrounding it a sector is extracted from the full field a sector model involves solving the brinkman s model on a sector while imposing dynamic flux boundary conditions obtained from the full field model on the sector in addition to fluid flow modeling tracer transport in the karst aquifer is implemented to enable us to compare the performance of sector modeling with those of the darcy s and brinkman s models three examples are presented to show the effectiveness of this method the first example involves a simple aquifer model consisting of a cave surrounded on two sides by porous media the second and third examples are more complex heterogeneous geological structures consisting of more realistic caves with randomly placed wells the results from the sector modeling approach were compared with results from the darcy s and brinkman s models the results show excellent match between the sector modeling approach and the brinkman s model in addition the sector modeling approach was much faster than the brinkman s approach 2 mathematical models of flow this section describes the differential equations governing the flow of a single phase fluid in a complex karst aquifer 2 1 the brinkman s model brinkman 1949 developed an equation that could model the coupled flow in an aquifer consisting of free flow and porous regions the brinkman s equation is given by 1 p μ k 1 u μ eff 2 u 0 in eq 1 p is the pressure m l 1 t 2 µ is the fluid viscosity m l 1 t 1 k is the permeability tensor l 2 u is the velocity vector l t 1 and μ eff is the effective fluid viscosity a pseudo parameter introduced by brinkman whose value changes depending on the region of interest an advantage of using the brinkman s equation is that it yields a simplified form of navier stokes equation in the free flow region and the darcy s equation in the porous media this is achieved by adjusting the values of k and μ eff when μ eff μ and k eq 1 becomes the stokes equation 2 p μ 2 u 0 the stokes equation in eq 2 is a simplification of navier stokes equation when steady state flow is assumed bird et al 2002 eq 2 is used to model viscous flow in the free flow region consisting of vugs fractures and caves when μ eff 0 and k k is much less than eq 1 becomes darcy s equation 3 p μ k 1 u 0 which is used to model flow of fluids in porous media darcy 1856 when μ eff μ and k k is much less than eq 1 is used to model the brinkman s region which starts just at the interface between the two regions and extends some distance into the porous region until the effect of the viscous shear term becomes negligible several studies have been conducted to find an appropriate value of the effective viscosity parameter in the transition zone adler 1979 belhaj et al 2003 durlofsky and brady 1987 happel and brenner 1981 howells 2006 koplik 1983 russel and sangtae 1985 in this work we set the value of effective viscosity in the transition zone to the true value of fluid viscosity this value has been shown to give good results in field scale modeling popov et al 2009 the brinkman s model for a single phase flow is a combination of the brinkman equation eq 1 and the continuity equation given by 4 ϕ ρ t ρ u ρ q w v b where ϕ is the porosity of the rock ρ is the fluid density m l 3 q w is the sink source term l 3 t 1 v b is the block volume l 3 and t is the time the discretization of eqs 1 and 4 are provided in appendix a 2 2 the darcy s model based on experimental observations darcy 1856 developed a simple correlation to model flow across porous media the darcy s equation shown in eq 3 can be rearranged as 5 u μ 1 k p similar to brinkman s equation darcy s equation for flow has to be combined with the continuity equation eq 4 to model flow in karst aquifers in the darcy s model eq 5 is substituted into eq 4 to produce one parabolic equation 6 ϕ ρ t ρ k μ p ρ q w v b which can be solved for pressure this means that only one equation is solved per grid block and the size of the linear system of equations remains m m where m is the number of grid blocks in the discretized system once the pressures are obtained the velocities can be calculated using eq 9 wherever required this method is well documented chen 2007 ertekin et al 2001 we note that in general in the darcy s model the permeability in the cave is set to a very high value much greater than the permeability in the porous media krotkiewski et al 2011 the discretization of darcy s model is provided in appendix b 3 mathematical model for tracer transport the transport of tracers in the karst aquifer is modeled using the advection diffusion adsorption equation advection is responsible for controlling majority of tracer contaminant transport within the caves in the karst aquifer adsorption mainly occurs in the porous media and on the surface of the caves the differential equation for tracer transport is given by 7 ϕ d c u c c s ϕ c t 1 ϕ ρ r c a t where d is the dispersion coefficient tensor l 2 t 1 c is the concentration of the tracer m l 3 c s is the sink source term of the tracer the specific mass rate with dimension m l 3 t 1 ρ r is the density of the rock m l 3 and c a is the adsorption of tracer on the surface of the rock dimensionless for modeling the tracer adsorption we used a linear isotherm eq 8 because the tracer concentration levels in most interwell tracer tests are low and linear isotherms can provide an adequate model for tracer adsorption effects in this case zemel 1995 the linear isotherm is given by 8 c a k d c where k d is the adsorption coefficient also cesium was used as a tracer substituting eq 8 into eq 7 gives 9 ϕ d c u c c s ϕ c t 1 ϕ ρ r k d c t introducing the retardation factor r given by 10 r 1 1 ϕ ϕ ρ r k d into eq 9 and assuming a constant porosity we obtain 11 x ϕ d x c x y ϕ d y c y u x c x u y c y c s ϕ r c t 4 sector modeling approach the numerical solution of the brinkman s model is a computationally expensive but gives accurate fluid velocity profiles in both the porous media and the free flow regions on the other hand the numerical solution to the darcy s model is very cheap but gives an inaccurate fluid velocity profile in the free flow region consequently we introduce a sector modeling approach that exploits the computational inexpensiveness of the darcy s model and the accuracy of the brinkman s model in the caves in the sector modeling approach sectors are carefully chosen to consist of only the caves and small areas of the porous region surrounding the caves the darcy s model is first solved in the entire aquifer to obtain the pressure and velocity distributions the brinkman s model is then used to solve for pressure and velocity in the identified sectors because the sectors are much smaller than the aquifer solving the brinkman s model in these sectors is much faster than solving it in the entire aquifer in doing so dynamic flux boundary conditions obtained from the solution of the darcy s model on the entire aquifer are imposed on the sectors and the results obtained from solving the brinkman s model on the small sectors are used to update the results from the full field model a description of the sector modeling approach is as follows 1 simulate the pressure distribution in the entire aquifer by solving the darcy s model eq 6 this is the full field model 2 compute the velocities u x u y and u z at all grid block interfaces using darcy s law eq 5 3 extract a small region surrounding each distinct cavern 4 set the velocities obtained at the grid block interfaces forming the boundary of each sector as the dynamic flux boundary condition for that sector 5 solve for pressure and velocity distributions in each sector using the brinkman s model eqs 1 and 4 this is the sector model 6 update the full field model with the results from the sector models 7 model tracer transport using the velocity distribution in the updated full field model fig 1 illustrates the procedure used in sector modeling three distinct caves are present in the karst aquifer shown in fig 1a in sector modeling a sector surrounding each of these caves would be extracted to obtain three sectors as shown in fig 1b then the brinkman s model is run on each of these small sectors to obtain reasonably accurate pressure and velocity distributions in the caves 5 computational complexity of the model one way to roughly compare the computational performances of the different modeling approaches is to analyze the complexity of problem solved in each approach a method with a higher complexity requires larger simulation time it is basically a theoretical estimate for the resources needed by an algorithm to solve a particular computational problem the three different models brinkman s darcy s and the sector modeling techniques discussed in this paper will generate a system of linear equations given by a x b where a is a coefficient matrix of the size n n x is a solution vector of size n 1 and b is a vector of size n 1 the set of linear equations given by a x b can be solved using the lu factorization method to facilitate efficient solution of the system of linear equations lu factorizes the coefficient matrix into the product of a lower triangular matrix l and an upper triangular matrix u the computational complexity or the cost of computation of lu is given as boyd and vandenberghe 2004 12 cost 2 3 n 3 2 n 2 where n is the size of the problem or the number of unknowns size of the solution vector x for large values of n the leading term becomes dominant so that the second term 2 n 2 becomes negligible and thus can be neglected therefore in calculating the cost of running the brinkman s model and the darcy s model we have used 13 cost 2 3 n 3 because there are two stages of simulation in the sector modeling approach the computational complexity of this approach is computed from 14 cost 2 3 n f 3 j 1 j n j 3 where n f is the size of the problem solved in the first stage running the darcy s model on the entire aquifer and n j is the size of the problem solved by brinkman s model on each sector j j is the total number of sectors extracted eq 14 assumes that the solutions to the problems in the sectors are obtained sequentially if parallel computing is used then the second term in the bracket on the right hand side of eq 14 should be replaced with max n 1 3 n 2 3 n j 3 for the single phase flow considered in this work n f is exactly the same as the number of grid blocks in the full field because the brinkman s model has three equations per grid blok in the two dimensional single phase problem each n j is larger than the number of grid blocks in the corresponding sector j however because the number of grids in each sector is typically much smaller than the number of grids in the full field solving the brinkman s model on each sector is faster than solving the darcy s model on the full field and much faster than solving the brinkman s model on the full field 6 example applications results and discussions three examples are presented to evaluate the accuracy and computational performance of the sector modeling technique the first example is a simple two dimensional linear aquifer model consisting of a cave surrounded on both sides in the y direction by porous media the second and third examples are complex heterogeneous aquifers consisting of more realistic cave like structures embedded in porous media the transport of a tracer is used to quantify the results 6 1 example 1 the first example consists of a simple linear flow in a two dimensional aquifer model being flooded from the left side at a velocity of 3 26 m day the aquifer of dimensions 1220 m 61 m 1 5 m was discretized into 40 61 1 grid blocks fig 2 the aquifer is bounded at the top and bottom by impermeable layers in fig 2a the region with 100 porosity red portion is the cave the width of this cave is 11 m this region is surrounded by a porous medium whose porosity is 25 blue portions the initial aquifer pressure was 1 38 mpa the aquifer rock and fluid properties are listed in table 1 initially the concentration of tracer in the aquifer was set to zero then 30 g l of tracer was injected from the left boundary the numerical simulation was run under transient conditions for 20 days using a time step of 0 1 days up to 1 day and then a time step of 1 day till the end of the simulation to apply the sector modeling approach the full field fig 2a is reduced to a sector fig 2b the sector consists of the cave and 11 m of porous medium on either side of the cave the number of grid blocks was reduced from 2440 in the full field to 1320 in the sector darcy s model was run on the full field to obtain the aquifer pressure distribution the velocity distributions in the full field are then computed from the pressure distribution using eq 9 the velocities at the locations where the sector is extracted from the full field are used as the flux boundary conditions of the sector because these velocities change with time the boundary conditions imposed on the sector is dynamic and will vary from one time to another the brinkman s model is subsequently run on the sector to obtain the pressure and velocity distributions in the sector results from the portion of the full field model corresponding to where the sector was carved out are then replaced by the results from the sector model to evaluate the accuracy and performance of the sector modeling approach the brinkman s model and darcy s model approaches were equally solved to obtain the pressure velocity and concentration distributions in the aquifer results from the three approaches darcy brinkman and sector modeling are shown in fig 3 as shown in fig 3 the concentration distributions obtained from the sector modeling approach and the brinkman s model are similar to each other but different from the darcy s model the velocity profiles within the sector from the three approaches are displayed in fig 4 we observe an excellent match between the profiles from the sector modeling and brinkman s model the darcy s model however gave a very poor match to the brinkman s model thus the sector modeling approach is more accurate than the darcy s model with the accuracy of the sector modeling approach reasonably close to that of the brinkman s model fig 5 shows a plot of instantaneous tracer concentration at two different observation stations the first observation station observation station 1 is located in grid block 10 21 which is 305 m from the inlet the second observation station observation station 2 is located in grid block 20 21 which is 610 m from the inlet the locations of the wells are shown in fig 2 we observe that the sector modeling technique gives a very close match to the brinkman s model darcy s model however gives inaccurate and much lower concentration values when compared to the other two approaches table 2 displays the sizes of the linear equations solved in the three approaches their complexities and the runtime taken to solve the problem by those approaches also displayed in the table are the ratios of runtimes from the methods to the runtime from the darcy s model as shown on the table the brinkman s model has the largest complexity while the darcy s model has the lowest complexity darcy s model was the fastest of the three methods with a coefficient matrix size of 2440 2440 and a runtime of 6 285 s 17 5 times faster than brinkman s model this is because the darcy s model solves for only pressure and hence solves only one equation per grid block the sector modeling technique is the second fastest 4 6 times faster than the brinkman s model the brinkman s model is the slowest with a runtime of 110 124 s due to its high computational complexity 6 2 example 2 the second example consists of a complex more realistic heterogeneous two dimensional aquifer fig 6 a the aquifer dimensions are 304 8 m 304 8 m 7 62 m 1000 ft 1000 ft 25 ft the aquifer is discretized into 200 200 1 grid blocks the initial aquifer pressure is 2 41 mpa the cave is about 7 62 m wide the aquifer is closed on all sides and the flow and transport of tracers within the model is due to five randomly placed injectors and six randomly placed producers the injector wells are responsible for injecting cesium at a concentration of 30 g l the rock and fluid properties used in this example is the same as those used in example 1 and is given on table 1 the porous region is heterogeneous and the permeability within this region is log normally distributed with an average value of 3 95 10 15 m 2 40 m d there are 6 producers each producing at a rate of 63 59 m 3 day 400bbls day and 5 injectors each injecting at a rate of 31 79 m 3 day 200bbls day the numerical simulation was run under transient conditions for 50 days using a time step of 0 1 day fig 6b shows the sector extracted from the aquifer the extracted sector consists of the caves and 7 62 m of porous medium surrounding the caves on each side the number of grid blocks in this sector is 7491 while that in the full field is 40 000 the brinkman s model darcy s model and sector modeling approach were used to solve for the pressure and velocity distributions in the aquifer and the results from these methods were used to solve for the tracer concentration in the aquifer table 3 lists the number of unknowns the sizes of the coefficient matrices the computational complexities and the runtimes associated with the three approaches the table shows that the brinkman s model approach has the highest complexity while the darcy s approach has the lowest complexity the table also shows that in this particular example the sector modeling approach is about 13 times faster than the brinkman s model approach while the darcy s model is about 27 times faster than the brinkman s model approach fig 7 shows the concentration distribution within the aquifer at different times obtained from the sector modeling technique it is evident from the figure that tracer transport within the caves is much faster than that in the porous medium the transport in porous medium is slower due to the lower permeability of porous medium and the adsorption of tracer on the surfaces of the rocks in fig 8 we compare the instantaneous tracer concentration observed at different production wells located within the aquifer all the producers except well p6 are located within the caves the producer p6 is located in the porous region it is evident from the figure that the darcy s model gave wrong concentration values at the wells located in the caves in fact the darcy s model underestimated the tracer concentration at the wells located in the caves on the other hand the sector modeling technique gave an excellent match to the brinkman s model in well p6 all the three methods gave similar results because in the porous medium the brinkman s model is equivalent to the darcy s model 6 3 example 3 the third example fig 9 a consists of a large aquifer of dimension 609 m 609 m 609 m 2000 ft 2000 ft 2000 ft this aquifer is discretized into 400 400 1 grid blocks similar to the second example the aquifer consists of geometrically complex caves inside a heterogeneous porous medium the caves are approximately 10 7 m wide the aquifer model is bounded on the top and right side by impermeable barriers the bottom and left boundaries are partially open such that contaminant laden water enters the aquifer from the bottom left corner of the aquifer at a velocity of 2 57 m day there are five randomly placed producers in the aquifer producing at the rate of 15 9 m3 day 100 bbls day the rock and fluid properties are provided in table 1 the simulation was run under transient conditions for 50 days using a time step of 0 1 days fig 9b shows the sectors extracted from the aquifer since there are two independent caves we extract two independent sectors and solve them separately each extracted sector consists of the cave and 10 7 m of porous medium surrounding the cave the number of grid blocks in sector 1 is 13 741 and the number of grid blocks in sector 2 is 17 736 the total number of grid blocks in the full field model is 160 000 in the sector modeling approach we adopt both sequential and parallel computations to solve the sector models first we solve the two sector models sequentially in this case once the darcy s model is solved on the entire full field brinkman s model is solved on sector 1 and then on sector 2 in the second case we solved both sector models simultaneously using parallel computation in this case it is the time taken by the large sector sector 2 that matters in computing the total simulation time table 4 lists the number of unknowns the sizes of the coefficient matrices the computational complexities and the runtimes associated with the three approaches the table shows that the brinkman s model approach has the highest complexity while the darcy s approach has the lowest complexity the table also shows that in this particular example the sector modeling approach with the sector models solved sequentially is about 21 times faster than the brinkman s model approach and about 25 times faster when the sector models are solved in parallel the darcy s model is about 38 5 times faster than the brinkman s model approach fig 10 shows the contaminant concentration in the aquifer after 50 days similar to the previous examples the contaminant transport is faster within the caves the instantaneous contaminant concentration at the producers obtained from the sector modeling approach were compared to the results obtained from the brinkman s model and the darcy s model fig 11 all the producers are located in the caves except well p3 which is located in the porous region we observe that the darcy s model although the fastest underestimates the contaminant concentration inside the caves the sector modeling approach gives excellent match to the brinkman s model and is computationally more efficient no visible differences in results were observed in well p3 located in the porous medium 7 effect of the size of porous medium around the caves in the extracted sector in sector modeling a sector consists of the cave and a small portion of porous medium surrounding the cave this small portion of porous medium can vary in width and the width would determine the accuracy of the solution and the time required to solve the sector model in the examples presented in section 5 we made the width of the porous medium surrounding each cave to be the same as the width of the cave for instance in example 2 the width of the cave is 7 62 m and the width of the porous media on each side of that cave is also 7 62 m in this section we studied the effect of reducing the width of the porous medium surrounding any cave in an extracted sector on the accuracy and speed of computation this was done by reducing the size of the porous medium surrounding the cave in example 2 first from 7 62 m to 4 57 m and then to 1 52 m thus there are three cases to compare each with a different sector size to measure the accuracy of solution from these cases we compare the concentrations of tracers at the producers in each of these cases to the concentrations obtained from the brinkman s model comparison is made by calculating an error at each producer given by 15 ξ p 1 κ c be c s 2 where ξ p is the error calculated at a single producer κ is the total number of time steps c be is a vector consisting of the instantaneous concentrations observed at that particular producer obtained from the brinkman s model and c s is the instantaneous concentrations observed at that particular producer obtained from the sector modeling technique only producers located inside the cave are considered in computing the error table 5 lists the errors obtained at each producer from the three cases involving different sector sizes it also lists the run time for each of the three cases we observe that as the size of the porous medium surrounding the cave is reduced the error increases while the simulation run time decreases the decrease in simulation run time with reduction in width of porous medium is due to the corresponding decrease in the number of grid blocks which leads to a decrease in the number of unknowns we observe that the decrease in run time associated with a reduction in size of the porous media is substantial for instance when the porous medium was reduced from 7 62 m to 1 52 m the run time reduced by almost 1 5 times although we observed an increase in error when the size of the porous medium surrounding the cave was reduced this increase is negligible thus we conclude that the size of the porous medium surrounding the cave in a sector has an effect on the accuracy of the solution and on the speed of solving of the sector model however the gain in computational speed associated with reducing the size of the porous media may offset the corresponding small increase in error 8 conclusion a sector modeling approach was proposed to model fluid transport in karst aquifers the approach involves first solving the darcy s model on the entire aquifer full field model then solving the brinkman s model on small sectors extracted from the aquifer sector model and finally updating the results from the full field model with those from the sector model each sector is extracted from a region surrounding a distinct cave in the aquifer the method exploits the fast computation associated with the darcy s model and the accuracy of modeling flow in the caves associated with the brinkman s model thus the method runs much faster than the brinkman s model without compromising the accuracy of results obtained in the caves three examples were presented to illustrate the effectiveness of the sector modeling approach the first example consisted of a simple cave surrounded by porous regions in two dimensions while the other two examples involved flow in larger and more complex heterogeneous aquifers with realistic cave structures all the examples clearly show that the sector modeling approach is computationally more efficient than the brinkman s model and gives results that matche those from the brinkman s model the darcy s model although runs faster than both the brinkman s model and the sector modeling approach gave inaccurate results within the free flow regions furthermore the third example has two separate sectors which could be run in either sequentially or in parallel we observed a further reduction in simulation run time when the two sectors were run in parallel we also noticed that the computational speed up realized from the sector modeling approach is higher when the size of the extracted sector relative to the full field is smaller however such decrease in size of the porous medium surrounding a cave leads to a negligible increase in error from the sector modeling approach appendix a discretization of the brinkman s model when the brinkman s equation is discretized the perturbation is done such that the pressures are at the center of the grid blocks while the velocities are at the grid interfaces eq 4 can be written for slightly compressible flow as chen 2007 a 1 ϕ ρ c t p t ρ u ρ q w v b where c t is the total compressibility of the system in a slightly compressible flow it is assumed that the pressure has small effects on the porosity of the rock and density of the flowing fluid in two dimensions al eq a 1 can be discretized as a 2 ρ ϕ c t δ t p h i n 1 ρ δ y u y h i 1 2 n 1 ρ δ y u y h i 1 2 n 1 ρ δ x u x h 1 2 i n 1 ρ δ x u x h 1 2 i n 1 ρ q w v b ρ ϕ c t δ t p h i n where h and i are the indices of the grid blocks in the x and y directions respectively and n is the time index also in two dimensions the discretization of eq 1 will result in two discrete equations representing the x and y directions these equations are a 3 1 x p h 1 i n 1 1 x p h i n 1 μ eff δ x 2 u x h 3 2 i n 1 μ eff δ x 2 u x h 1 2 i n 1 μ eff δ y 2 u x h 1 2 i 1 n 1 μ eff δ y 2 u x h 1 2 i 1 n 1 μ k x 2 μ eff δ x 2 2 μ eff δ y 2 u x h 1 2 i n 1 0 and a 4 1 δ y p h i 1 n 1 1 δ y p h i n 1 μ eff δ x 2 u y h 1 i 1 2 n 1 μ eff δ x 2 u y h 1 i 1 2 n 1 μ eff δ y 2 u y h i 3 2 n 1 μ eff δ y 2 u y h i 1 2 n 1 μ k y 2 μ eff δ x 2 2 μ eff δ y 2 u y h i 1 2 n 1 0 for the x and y directions respectively this means that for every grid block there would be one pressure equation and two velocity equations to be solved in a two dimensional problem in 3d there would be one pressure equation and three velocity equations to solve per grid this makes the brinkman s model computationally very expensive b discretization of the darcy s model eq 6 can be written for slightly compressible flow as chen 2007 b 1 ρ k μ p ρ q w v b ϕ ρ c t p t eq b 1 for a 2d aquifer can be expanded as b 2 x ρ k x μ p x y ρ k y μ p y ρ q w v b ϕ ρ c t p t the discretized form of eq b 2 is given as b 3 ρ k y μ h i 1 2 p h i 1 n 1 ρ k x μ h 1 2 i p h 1 i n 1 ρ k y μ h i 1 2 ρ k x μ h 1 2 i ρ k x μ h 1 2 i ρ k y μ h i 1 2 ϕ ρ c t δ t p h i n 1 ρ k x μ h 1 2 i p h 1 i n 1 ρ k y μ h i 1 2 p h i 1 n 1 ϕ ρ c t δ t p h i n ρ q w v b where h and i are the indices of the grid blocks in the x and y directions respectively and n is the index of the time the above equation is then solved for pressures across the aquifer at different time steps there is only one pressure equation per grid and the solution can be computed in much less time the pressure obtained from solving eq b 3 is used to compute the velocity distribution in the aquifer the computation of velocities in this case is very cheap c discretization of equations for tracer transport in discretizing eq 15 tracer concentrations are located at grid centers while velocities are located at grid interfaces thus eq 15 can be discretized as c 1 ϕ d y δ y 2 h i 1 2 n 1 c h i 1 n 1 ϕ d x δ x 2 h 1 2 i n 1 c h 1 i n 1 ϕ d x δ x 2 h 1 2 i n 1 ϕ d x δ x 2 h 1 2 i n 1 ϕ d y δ y 2 h i 1 2 n 1 ϕ d y δ y 2 h i 1 2 n 1 ϕ h i r h i δ t c h i n 1 ϕ d x δ x 2 h 1 2 i n 1 c h 1 i n 1 ϕ d y δ y 2 h i 1 2 n 1 c h i 1 n 1 u x h 1 2 i n 1 δ x c h 1 2 i n 1 u x h 1 2 i n 1 δ x c h 1 2 i n 1 u y h i 1 2 n 1 δ y c h i 1 2 n 1 u y h i 1 2 n 1 δ y c h i 1 2 n 1 ϕ h i r h i δ t c h i n c s in eq c 1 c is set using the upwinding technique the discretized advection diffusion adsorption equations in c 1 are solved only after the equations for pressures and the velocities have been solved at the new time this decoupling of the tracer transport equations from the flow equations ensures that two separate smaller sized problems are solved instead of a larger system of equations 
7092,brinkman s model is one of the common mathematical formulations used in modeling fluid flow in karst aquifers the brinkman s model is a hybrid formulation that allows the use of a single transport equation to model fluid flow in both the free flow and porous regions of a karst aquifer by transitioning between the stokes equation and the darcy s law however the brinkman s model is computationally expensive requiring the solution of four different equations to obtain the pressures and velocities in a three dimensional aquifer darcy s model provides a cheaper alternative because it allows the substitution of the darcy s equation into the mass conservation equation and thus requires the solution of only one parabolic equation however while the darcy s model produces accurate results within the porous medium it fails to provide satisfactory results in the free flow regions of the karst aquifers we propose a sector modeling approach to model fluid flow in karst aquifers the sector modeling approach takes advantage of both the computational inexpensiveness of the darcy s model and the accuracy of brinkman s model in the caves this method was compared to the brinkman s model and the darcy s model three examples are presented to study the effectiveness of the sector modeling technique the first example is a simple model consisting of a straight conduit surrounded by porous regimes on either side while the second and third examples are more complicated structures consisting of complex geometrical caves embedded in a highly heterogeneous porous medium results show that the sector modeling approach provides an excellent match to the brinkman s model and with much faster computations specifically sector modeling was 4 6 times faster than the brinkman s model in the first example 13 times faster in the second and 25 times faster in the third example we also observed negligible deterioration in accuracy of results from sector modeling when the size of the extracted sector relative to the full field is reduced keywords sector modeling technique brinkman s model karst aquifers tracer transport 1 introduction karst aquifers cover 12 of the terrestrial land and provide a source of drinking water to almost a quarter of the world s population ford and williams 2007 andreo et al 2010 hartmann et al 2014 therefore it is essential to accurately model the flow of water within these aquifers the uniqueness of karst reservoirs is that the karst topography is characterized by the presence of highly porous and permeable caverns and channels formed by karstification jackson 1997 the karst caves provide pathways that facilitate the movement of fluids and contaminants within such aquifers huntoon 1999 advection diffusion and adsorption are the main physical processes responsible for the transport of contaminants solutes and tracers with advection being the primary process responsible for movement of these substances in caves field and pinsky 2000 several numerical studies have been conducted on modeling the transport of chemicals within karst aquifers göppert and goldscheider 2007 kincaid et al 2002 maloszewski et al 1999 morales juberías et al 1997 rivard and delay 2004 numerical modelling of groundwater flow within karst aquifers is challenging the complexity in modelling arises due to the presence of non darcian flow elements in the transport equations mainly due to the presence of fractures vugs and caves having varying sizes connectivity and distribution depending on the depositional environment and the diagenetic processes involved the presence of these geomorphological features introduces two major uncertainties which adversely affect the accuracy of the model 1 the lack of knowledge of the exact position of the interface between porous medium and vugs caves complicates the accurate modelling of flow in such features popov et al 2009 and 2 uncertainties related to the physical properties of the different geomorphological features such as their sizes connectivities and distributions directly affect the rate and direction of fluid flow in the aquifer kossack and gurpinar 2001 different approaches have been developed to model the flow of groundwater in karst aquifers the simplest is the lumped parameter model or the black box model scanlon et al 2003 wanakule and anaya 1993 zhang et al 1996 the main advantage of this model is that it requires limited information to produce results as it neglects the spatial dimensions of the aquifer however this omission of spatial dimensions is undesirable because it leads to a lack of information on the direction and rates of groundwater flow the other method of modelling flow within karst aquifers is the distributed parameter model which requires the discretization of the whole system into grid blocks thus this method uses information on the spatial variability of the system generally modeling fluid flow using the distributed parameter model involves combining the continuity equation with an appropriate transport equation the continuity equation ensures that all mass flows in and out of the flow domain are accounted for the transport equation describes the manner in which fluid mass is moved from one point to the other within the flow domain under the distributed parameter model many approaches are currently used to model flow of fluid in karstic aquifers one of these methods is the equivalent porous media epm approach in which the fractures vugs caves and the porous matrix are treated as one single equivalent porous medium with a single hydraulic conductivity ghasemizadeh et al 2015 long et al 1982 pankow et al 1986 scanlon et al 2003 the disadvantage of this method is that it oversimplifies the complex flow patterns and may not be accurate another limitation of the epm model is that it cannot accurately predict the direction of the flow the discontinuum approach also known as darcy stokes model uses the navier stokes equation to model flow in the free flow region and the darcy s equation in the porous region arbogast and brunson 2007 arbogast and gomez 2009 arbogast and lehr 2006 peng et al 2009 a slip velocity was introduced at the interface between the two regions using appropriate boundary conditions beavers et al 1970 beavers and joseph 1967 the darcy stokes equation along with the interface condition models a slip velocity at the interface between the cave and the porous media this yields a sharp change to darcy s velocity in the porous region this is not accurate because as the fluid transitions from the free flow region to the porous media the fluid velocity should gradually decreases inside the porous media until it becomes equal to the darcy velocity neale and nader 1974 brinkman s equation brinkman 1949 models flow in karst aquifers using a single equation that yields a simplified navier stokes equation in the caves and breaks down into the darcy s equation in the porous region hence in the brinkman s model the whole system is treated as a single continuous domain yao and huang 2016 several successful studies have been carried out to simulate the flow of single phase fluids in fractured vuggy microkarstic aquifers and reservoirs bi et al 2009 he et al 2015 krotkiewski et al 2011 ligaarden et al 2010 mohamed et al 2015 popov et al 2009 2007b the brinkman s model attempts to model flow within karst aquifers by simultaneously solving the mass continuity equation and the momentum equation brinkman s equation for the pressures and velocity distribution within the karst aquifer because the brinkman s model solves one continuity equation and up to three momentum balance equation per grid block the method is very expensive particularly for large aquifers the darcy s model offers a cheaper alternative to the brinkman s model because it does not require the solution of multiple equations per grid block a simplification is made by replacing the velocity term in the mass continuity equation by the darcy s equation this allows solving for only the pressure distribution at the new time step in the aquifer and then computing the velocities using these pressures while the darcy s model gives reliable estimates of pressure and velocity distributions in the porous media it gives an inaccurate velocity profile in the caves field 1997 we propose a sector modeling approach for fluid flow in karst aquifers this approach consists of three stages at every simulation time step the first stage involves solving the cheap darcy s model on the entire aquifer full field model while the second stage involves solving the more expensive brinkman s model on much smaller sectors extracted from the reservoir sector models the third stage involves updating the result from the full field model with those from the sector models thus the sector modeling approach takes advantage of both the computational inexpensiveness of the darcy s model and the accuracy of brinkman s model in the caves to avoid confusion we define some terminologies introduced in this paper cave is synonymous with free flow region while full field is synonymous with entire aquifer a full field model involves solving the darcy s model on the entire aquifer a sector consists of a cave and a small porous region surrounding it a sector is extracted from the full field a sector model involves solving the brinkman s model on a sector while imposing dynamic flux boundary conditions obtained from the full field model on the sector in addition to fluid flow modeling tracer transport in the karst aquifer is implemented to enable us to compare the performance of sector modeling with those of the darcy s and brinkman s models three examples are presented to show the effectiveness of this method the first example involves a simple aquifer model consisting of a cave surrounded on two sides by porous media the second and third examples are more complex heterogeneous geological structures consisting of more realistic caves with randomly placed wells the results from the sector modeling approach were compared with results from the darcy s and brinkman s models the results show excellent match between the sector modeling approach and the brinkman s model in addition the sector modeling approach was much faster than the brinkman s approach 2 mathematical models of flow this section describes the differential equations governing the flow of a single phase fluid in a complex karst aquifer 2 1 the brinkman s model brinkman 1949 developed an equation that could model the coupled flow in an aquifer consisting of free flow and porous regions the brinkman s equation is given by 1 p μ k 1 u μ eff 2 u 0 in eq 1 p is the pressure m l 1 t 2 µ is the fluid viscosity m l 1 t 1 k is the permeability tensor l 2 u is the velocity vector l t 1 and μ eff is the effective fluid viscosity a pseudo parameter introduced by brinkman whose value changes depending on the region of interest an advantage of using the brinkman s equation is that it yields a simplified form of navier stokes equation in the free flow region and the darcy s equation in the porous media this is achieved by adjusting the values of k and μ eff when μ eff μ and k eq 1 becomes the stokes equation 2 p μ 2 u 0 the stokes equation in eq 2 is a simplification of navier stokes equation when steady state flow is assumed bird et al 2002 eq 2 is used to model viscous flow in the free flow region consisting of vugs fractures and caves when μ eff 0 and k k is much less than eq 1 becomes darcy s equation 3 p μ k 1 u 0 which is used to model flow of fluids in porous media darcy 1856 when μ eff μ and k k is much less than eq 1 is used to model the brinkman s region which starts just at the interface between the two regions and extends some distance into the porous region until the effect of the viscous shear term becomes negligible several studies have been conducted to find an appropriate value of the effective viscosity parameter in the transition zone adler 1979 belhaj et al 2003 durlofsky and brady 1987 happel and brenner 1981 howells 2006 koplik 1983 russel and sangtae 1985 in this work we set the value of effective viscosity in the transition zone to the true value of fluid viscosity this value has been shown to give good results in field scale modeling popov et al 2009 the brinkman s model for a single phase flow is a combination of the brinkman equation eq 1 and the continuity equation given by 4 ϕ ρ t ρ u ρ q w v b where ϕ is the porosity of the rock ρ is the fluid density m l 3 q w is the sink source term l 3 t 1 v b is the block volume l 3 and t is the time the discretization of eqs 1 and 4 are provided in appendix a 2 2 the darcy s model based on experimental observations darcy 1856 developed a simple correlation to model flow across porous media the darcy s equation shown in eq 3 can be rearranged as 5 u μ 1 k p similar to brinkman s equation darcy s equation for flow has to be combined with the continuity equation eq 4 to model flow in karst aquifers in the darcy s model eq 5 is substituted into eq 4 to produce one parabolic equation 6 ϕ ρ t ρ k μ p ρ q w v b which can be solved for pressure this means that only one equation is solved per grid block and the size of the linear system of equations remains m m where m is the number of grid blocks in the discretized system once the pressures are obtained the velocities can be calculated using eq 9 wherever required this method is well documented chen 2007 ertekin et al 2001 we note that in general in the darcy s model the permeability in the cave is set to a very high value much greater than the permeability in the porous media krotkiewski et al 2011 the discretization of darcy s model is provided in appendix b 3 mathematical model for tracer transport the transport of tracers in the karst aquifer is modeled using the advection diffusion adsorption equation advection is responsible for controlling majority of tracer contaminant transport within the caves in the karst aquifer adsorption mainly occurs in the porous media and on the surface of the caves the differential equation for tracer transport is given by 7 ϕ d c u c c s ϕ c t 1 ϕ ρ r c a t where d is the dispersion coefficient tensor l 2 t 1 c is the concentration of the tracer m l 3 c s is the sink source term of the tracer the specific mass rate with dimension m l 3 t 1 ρ r is the density of the rock m l 3 and c a is the adsorption of tracer on the surface of the rock dimensionless for modeling the tracer adsorption we used a linear isotherm eq 8 because the tracer concentration levels in most interwell tracer tests are low and linear isotherms can provide an adequate model for tracer adsorption effects in this case zemel 1995 the linear isotherm is given by 8 c a k d c where k d is the adsorption coefficient also cesium was used as a tracer substituting eq 8 into eq 7 gives 9 ϕ d c u c c s ϕ c t 1 ϕ ρ r k d c t introducing the retardation factor r given by 10 r 1 1 ϕ ϕ ρ r k d into eq 9 and assuming a constant porosity we obtain 11 x ϕ d x c x y ϕ d y c y u x c x u y c y c s ϕ r c t 4 sector modeling approach the numerical solution of the brinkman s model is a computationally expensive but gives accurate fluid velocity profiles in both the porous media and the free flow regions on the other hand the numerical solution to the darcy s model is very cheap but gives an inaccurate fluid velocity profile in the free flow region consequently we introduce a sector modeling approach that exploits the computational inexpensiveness of the darcy s model and the accuracy of the brinkman s model in the caves in the sector modeling approach sectors are carefully chosen to consist of only the caves and small areas of the porous region surrounding the caves the darcy s model is first solved in the entire aquifer to obtain the pressure and velocity distributions the brinkman s model is then used to solve for pressure and velocity in the identified sectors because the sectors are much smaller than the aquifer solving the brinkman s model in these sectors is much faster than solving it in the entire aquifer in doing so dynamic flux boundary conditions obtained from the solution of the darcy s model on the entire aquifer are imposed on the sectors and the results obtained from solving the brinkman s model on the small sectors are used to update the results from the full field model a description of the sector modeling approach is as follows 1 simulate the pressure distribution in the entire aquifer by solving the darcy s model eq 6 this is the full field model 2 compute the velocities u x u y and u z at all grid block interfaces using darcy s law eq 5 3 extract a small region surrounding each distinct cavern 4 set the velocities obtained at the grid block interfaces forming the boundary of each sector as the dynamic flux boundary condition for that sector 5 solve for pressure and velocity distributions in each sector using the brinkman s model eqs 1 and 4 this is the sector model 6 update the full field model with the results from the sector models 7 model tracer transport using the velocity distribution in the updated full field model fig 1 illustrates the procedure used in sector modeling three distinct caves are present in the karst aquifer shown in fig 1a in sector modeling a sector surrounding each of these caves would be extracted to obtain three sectors as shown in fig 1b then the brinkman s model is run on each of these small sectors to obtain reasonably accurate pressure and velocity distributions in the caves 5 computational complexity of the model one way to roughly compare the computational performances of the different modeling approaches is to analyze the complexity of problem solved in each approach a method with a higher complexity requires larger simulation time it is basically a theoretical estimate for the resources needed by an algorithm to solve a particular computational problem the three different models brinkman s darcy s and the sector modeling techniques discussed in this paper will generate a system of linear equations given by a x b where a is a coefficient matrix of the size n n x is a solution vector of size n 1 and b is a vector of size n 1 the set of linear equations given by a x b can be solved using the lu factorization method to facilitate efficient solution of the system of linear equations lu factorizes the coefficient matrix into the product of a lower triangular matrix l and an upper triangular matrix u the computational complexity or the cost of computation of lu is given as boyd and vandenberghe 2004 12 cost 2 3 n 3 2 n 2 where n is the size of the problem or the number of unknowns size of the solution vector x for large values of n the leading term becomes dominant so that the second term 2 n 2 becomes negligible and thus can be neglected therefore in calculating the cost of running the brinkman s model and the darcy s model we have used 13 cost 2 3 n 3 because there are two stages of simulation in the sector modeling approach the computational complexity of this approach is computed from 14 cost 2 3 n f 3 j 1 j n j 3 where n f is the size of the problem solved in the first stage running the darcy s model on the entire aquifer and n j is the size of the problem solved by brinkman s model on each sector j j is the total number of sectors extracted eq 14 assumes that the solutions to the problems in the sectors are obtained sequentially if parallel computing is used then the second term in the bracket on the right hand side of eq 14 should be replaced with max n 1 3 n 2 3 n j 3 for the single phase flow considered in this work n f is exactly the same as the number of grid blocks in the full field because the brinkman s model has three equations per grid blok in the two dimensional single phase problem each n j is larger than the number of grid blocks in the corresponding sector j however because the number of grids in each sector is typically much smaller than the number of grids in the full field solving the brinkman s model on each sector is faster than solving the darcy s model on the full field and much faster than solving the brinkman s model on the full field 6 example applications results and discussions three examples are presented to evaluate the accuracy and computational performance of the sector modeling technique the first example is a simple two dimensional linear aquifer model consisting of a cave surrounded on both sides in the y direction by porous media the second and third examples are complex heterogeneous aquifers consisting of more realistic cave like structures embedded in porous media the transport of a tracer is used to quantify the results 6 1 example 1 the first example consists of a simple linear flow in a two dimensional aquifer model being flooded from the left side at a velocity of 3 26 m day the aquifer of dimensions 1220 m 61 m 1 5 m was discretized into 40 61 1 grid blocks fig 2 the aquifer is bounded at the top and bottom by impermeable layers in fig 2a the region with 100 porosity red portion is the cave the width of this cave is 11 m this region is surrounded by a porous medium whose porosity is 25 blue portions the initial aquifer pressure was 1 38 mpa the aquifer rock and fluid properties are listed in table 1 initially the concentration of tracer in the aquifer was set to zero then 30 g l of tracer was injected from the left boundary the numerical simulation was run under transient conditions for 20 days using a time step of 0 1 days up to 1 day and then a time step of 1 day till the end of the simulation to apply the sector modeling approach the full field fig 2a is reduced to a sector fig 2b the sector consists of the cave and 11 m of porous medium on either side of the cave the number of grid blocks was reduced from 2440 in the full field to 1320 in the sector darcy s model was run on the full field to obtain the aquifer pressure distribution the velocity distributions in the full field are then computed from the pressure distribution using eq 9 the velocities at the locations where the sector is extracted from the full field are used as the flux boundary conditions of the sector because these velocities change with time the boundary conditions imposed on the sector is dynamic and will vary from one time to another the brinkman s model is subsequently run on the sector to obtain the pressure and velocity distributions in the sector results from the portion of the full field model corresponding to where the sector was carved out are then replaced by the results from the sector model to evaluate the accuracy and performance of the sector modeling approach the brinkman s model and darcy s model approaches were equally solved to obtain the pressure velocity and concentration distributions in the aquifer results from the three approaches darcy brinkman and sector modeling are shown in fig 3 as shown in fig 3 the concentration distributions obtained from the sector modeling approach and the brinkman s model are similar to each other but different from the darcy s model the velocity profiles within the sector from the three approaches are displayed in fig 4 we observe an excellent match between the profiles from the sector modeling and brinkman s model the darcy s model however gave a very poor match to the brinkman s model thus the sector modeling approach is more accurate than the darcy s model with the accuracy of the sector modeling approach reasonably close to that of the brinkman s model fig 5 shows a plot of instantaneous tracer concentration at two different observation stations the first observation station observation station 1 is located in grid block 10 21 which is 305 m from the inlet the second observation station observation station 2 is located in grid block 20 21 which is 610 m from the inlet the locations of the wells are shown in fig 2 we observe that the sector modeling technique gives a very close match to the brinkman s model darcy s model however gives inaccurate and much lower concentration values when compared to the other two approaches table 2 displays the sizes of the linear equations solved in the three approaches their complexities and the runtime taken to solve the problem by those approaches also displayed in the table are the ratios of runtimes from the methods to the runtime from the darcy s model as shown on the table the brinkman s model has the largest complexity while the darcy s model has the lowest complexity darcy s model was the fastest of the three methods with a coefficient matrix size of 2440 2440 and a runtime of 6 285 s 17 5 times faster than brinkman s model this is because the darcy s model solves for only pressure and hence solves only one equation per grid block the sector modeling technique is the second fastest 4 6 times faster than the brinkman s model the brinkman s model is the slowest with a runtime of 110 124 s due to its high computational complexity 6 2 example 2 the second example consists of a complex more realistic heterogeneous two dimensional aquifer fig 6 a the aquifer dimensions are 304 8 m 304 8 m 7 62 m 1000 ft 1000 ft 25 ft the aquifer is discretized into 200 200 1 grid blocks the initial aquifer pressure is 2 41 mpa the cave is about 7 62 m wide the aquifer is closed on all sides and the flow and transport of tracers within the model is due to five randomly placed injectors and six randomly placed producers the injector wells are responsible for injecting cesium at a concentration of 30 g l the rock and fluid properties used in this example is the same as those used in example 1 and is given on table 1 the porous region is heterogeneous and the permeability within this region is log normally distributed with an average value of 3 95 10 15 m 2 40 m d there are 6 producers each producing at a rate of 63 59 m 3 day 400bbls day and 5 injectors each injecting at a rate of 31 79 m 3 day 200bbls day the numerical simulation was run under transient conditions for 50 days using a time step of 0 1 day fig 6b shows the sector extracted from the aquifer the extracted sector consists of the caves and 7 62 m of porous medium surrounding the caves on each side the number of grid blocks in this sector is 7491 while that in the full field is 40 000 the brinkman s model darcy s model and sector modeling approach were used to solve for the pressure and velocity distributions in the aquifer and the results from these methods were used to solve for the tracer concentration in the aquifer table 3 lists the number of unknowns the sizes of the coefficient matrices the computational complexities and the runtimes associated with the three approaches the table shows that the brinkman s model approach has the highest complexity while the darcy s approach has the lowest complexity the table also shows that in this particular example the sector modeling approach is about 13 times faster than the brinkman s model approach while the darcy s model is about 27 times faster than the brinkman s model approach fig 7 shows the concentration distribution within the aquifer at different times obtained from the sector modeling technique it is evident from the figure that tracer transport within the caves is much faster than that in the porous medium the transport in porous medium is slower due to the lower permeability of porous medium and the adsorption of tracer on the surfaces of the rocks in fig 8 we compare the instantaneous tracer concentration observed at different production wells located within the aquifer all the producers except well p6 are located within the caves the producer p6 is located in the porous region it is evident from the figure that the darcy s model gave wrong concentration values at the wells located in the caves in fact the darcy s model underestimated the tracer concentration at the wells located in the caves on the other hand the sector modeling technique gave an excellent match to the brinkman s model in well p6 all the three methods gave similar results because in the porous medium the brinkman s model is equivalent to the darcy s model 6 3 example 3 the third example fig 9 a consists of a large aquifer of dimension 609 m 609 m 609 m 2000 ft 2000 ft 2000 ft this aquifer is discretized into 400 400 1 grid blocks similar to the second example the aquifer consists of geometrically complex caves inside a heterogeneous porous medium the caves are approximately 10 7 m wide the aquifer model is bounded on the top and right side by impermeable barriers the bottom and left boundaries are partially open such that contaminant laden water enters the aquifer from the bottom left corner of the aquifer at a velocity of 2 57 m day there are five randomly placed producers in the aquifer producing at the rate of 15 9 m3 day 100 bbls day the rock and fluid properties are provided in table 1 the simulation was run under transient conditions for 50 days using a time step of 0 1 days fig 9b shows the sectors extracted from the aquifer since there are two independent caves we extract two independent sectors and solve them separately each extracted sector consists of the cave and 10 7 m of porous medium surrounding the cave the number of grid blocks in sector 1 is 13 741 and the number of grid blocks in sector 2 is 17 736 the total number of grid blocks in the full field model is 160 000 in the sector modeling approach we adopt both sequential and parallel computations to solve the sector models first we solve the two sector models sequentially in this case once the darcy s model is solved on the entire full field brinkman s model is solved on sector 1 and then on sector 2 in the second case we solved both sector models simultaneously using parallel computation in this case it is the time taken by the large sector sector 2 that matters in computing the total simulation time table 4 lists the number of unknowns the sizes of the coefficient matrices the computational complexities and the runtimes associated with the three approaches the table shows that the brinkman s model approach has the highest complexity while the darcy s approach has the lowest complexity the table also shows that in this particular example the sector modeling approach with the sector models solved sequentially is about 21 times faster than the brinkman s model approach and about 25 times faster when the sector models are solved in parallel the darcy s model is about 38 5 times faster than the brinkman s model approach fig 10 shows the contaminant concentration in the aquifer after 50 days similar to the previous examples the contaminant transport is faster within the caves the instantaneous contaminant concentration at the producers obtained from the sector modeling approach were compared to the results obtained from the brinkman s model and the darcy s model fig 11 all the producers are located in the caves except well p3 which is located in the porous region we observe that the darcy s model although the fastest underestimates the contaminant concentration inside the caves the sector modeling approach gives excellent match to the brinkman s model and is computationally more efficient no visible differences in results were observed in well p3 located in the porous medium 7 effect of the size of porous medium around the caves in the extracted sector in sector modeling a sector consists of the cave and a small portion of porous medium surrounding the cave this small portion of porous medium can vary in width and the width would determine the accuracy of the solution and the time required to solve the sector model in the examples presented in section 5 we made the width of the porous medium surrounding each cave to be the same as the width of the cave for instance in example 2 the width of the cave is 7 62 m and the width of the porous media on each side of that cave is also 7 62 m in this section we studied the effect of reducing the width of the porous medium surrounding any cave in an extracted sector on the accuracy and speed of computation this was done by reducing the size of the porous medium surrounding the cave in example 2 first from 7 62 m to 4 57 m and then to 1 52 m thus there are three cases to compare each with a different sector size to measure the accuracy of solution from these cases we compare the concentrations of tracers at the producers in each of these cases to the concentrations obtained from the brinkman s model comparison is made by calculating an error at each producer given by 15 ξ p 1 κ c be c s 2 where ξ p is the error calculated at a single producer κ is the total number of time steps c be is a vector consisting of the instantaneous concentrations observed at that particular producer obtained from the brinkman s model and c s is the instantaneous concentrations observed at that particular producer obtained from the sector modeling technique only producers located inside the cave are considered in computing the error table 5 lists the errors obtained at each producer from the three cases involving different sector sizes it also lists the run time for each of the three cases we observe that as the size of the porous medium surrounding the cave is reduced the error increases while the simulation run time decreases the decrease in simulation run time with reduction in width of porous medium is due to the corresponding decrease in the number of grid blocks which leads to a decrease in the number of unknowns we observe that the decrease in run time associated with a reduction in size of the porous media is substantial for instance when the porous medium was reduced from 7 62 m to 1 52 m the run time reduced by almost 1 5 times although we observed an increase in error when the size of the porous medium surrounding the cave was reduced this increase is negligible thus we conclude that the size of the porous medium surrounding the cave in a sector has an effect on the accuracy of the solution and on the speed of solving of the sector model however the gain in computational speed associated with reducing the size of the porous media may offset the corresponding small increase in error 8 conclusion a sector modeling approach was proposed to model fluid transport in karst aquifers the approach involves first solving the darcy s model on the entire aquifer full field model then solving the brinkman s model on small sectors extracted from the aquifer sector model and finally updating the results from the full field model with those from the sector model each sector is extracted from a region surrounding a distinct cave in the aquifer the method exploits the fast computation associated with the darcy s model and the accuracy of modeling flow in the caves associated with the brinkman s model thus the method runs much faster than the brinkman s model without compromising the accuracy of results obtained in the caves three examples were presented to illustrate the effectiveness of the sector modeling approach the first example consisted of a simple cave surrounded by porous regions in two dimensions while the other two examples involved flow in larger and more complex heterogeneous aquifers with realistic cave structures all the examples clearly show that the sector modeling approach is computationally more efficient than the brinkman s model and gives results that matche those from the brinkman s model the darcy s model although runs faster than both the brinkman s model and the sector modeling approach gave inaccurate results within the free flow regions furthermore the third example has two separate sectors which could be run in either sequentially or in parallel we observed a further reduction in simulation run time when the two sectors were run in parallel we also noticed that the computational speed up realized from the sector modeling approach is higher when the size of the extracted sector relative to the full field is smaller however such decrease in size of the porous medium surrounding a cave leads to a negligible increase in error from the sector modeling approach appendix a discretization of the brinkman s model when the brinkman s equation is discretized the perturbation is done such that the pressures are at the center of the grid blocks while the velocities are at the grid interfaces eq 4 can be written for slightly compressible flow as chen 2007 a 1 ϕ ρ c t p t ρ u ρ q w v b where c t is the total compressibility of the system in a slightly compressible flow it is assumed that the pressure has small effects on the porosity of the rock and density of the flowing fluid in two dimensions al eq a 1 can be discretized as a 2 ρ ϕ c t δ t p h i n 1 ρ δ y u y h i 1 2 n 1 ρ δ y u y h i 1 2 n 1 ρ δ x u x h 1 2 i n 1 ρ δ x u x h 1 2 i n 1 ρ q w v b ρ ϕ c t δ t p h i n where h and i are the indices of the grid blocks in the x and y directions respectively and n is the time index also in two dimensions the discretization of eq 1 will result in two discrete equations representing the x and y directions these equations are a 3 1 x p h 1 i n 1 1 x p h i n 1 μ eff δ x 2 u x h 3 2 i n 1 μ eff δ x 2 u x h 1 2 i n 1 μ eff δ y 2 u x h 1 2 i 1 n 1 μ eff δ y 2 u x h 1 2 i 1 n 1 μ k x 2 μ eff δ x 2 2 μ eff δ y 2 u x h 1 2 i n 1 0 and a 4 1 δ y p h i 1 n 1 1 δ y p h i n 1 μ eff δ x 2 u y h 1 i 1 2 n 1 μ eff δ x 2 u y h 1 i 1 2 n 1 μ eff δ y 2 u y h i 3 2 n 1 μ eff δ y 2 u y h i 1 2 n 1 μ k y 2 μ eff δ x 2 2 μ eff δ y 2 u y h i 1 2 n 1 0 for the x and y directions respectively this means that for every grid block there would be one pressure equation and two velocity equations to be solved in a two dimensional problem in 3d there would be one pressure equation and three velocity equations to solve per grid this makes the brinkman s model computationally very expensive b discretization of the darcy s model eq 6 can be written for slightly compressible flow as chen 2007 b 1 ρ k μ p ρ q w v b ϕ ρ c t p t eq b 1 for a 2d aquifer can be expanded as b 2 x ρ k x μ p x y ρ k y μ p y ρ q w v b ϕ ρ c t p t the discretized form of eq b 2 is given as b 3 ρ k y μ h i 1 2 p h i 1 n 1 ρ k x μ h 1 2 i p h 1 i n 1 ρ k y μ h i 1 2 ρ k x μ h 1 2 i ρ k x μ h 1 2 i ρ k y μ h i 1 2 ϕ ρ c t δ t p h i n 1 ρ k x μ h 1 2 i p h 1 i n 1 ρ k y μ h i 1 2 p h i 1 n 1 ϕ ρ c t δ t p h i n ρ q w v b where h and i are the indices of the grid blocks in the x and y directions respectively and n is the index of the time the above equation is then solved for pressures across the aquifer at different time steps there is only one pressure equation per grid and the solution can be computed in much less time the pressure obtained from solving eq b 3 is used to compute the velocity distribution in the aquifer the computation of velocities in this case is very cheap c discretization of equations for tracer transport in discretizing eq 15 tracer concentrations are located at grid centers while velocities are located at grid interfaces thus eq 15 can be discretized as c 1 ϕ d y δ y 2 h i 1 2 n 1 c h i 1 n 1 ϕ d x δ x 2 h 1 2 i n 1 c h 1 i n 1 ϕ d x δ x 2 h 1 2 i n 1 ϕ d x δ x 2 h 1 2 i n 1 ϕ d y δ y 2 h i 1 2 n 1 ϕ d y δ y 2 h i 1 2 n 1 ϕ h i r h i δ t c h i n 1 ϕ d x δ x 2 h 1 2 i n 1 c h 1 i n 1 ϕ d y δ y 2 h i 1 2 n 1 c h i 1 n 1 u x h 1 2 i n 1 δ x c h 1 2 i n 1 u x h 1 2 i n 1 δ x c h 1 2 i n 1 u y h i 1 2 n 1 δ y c h i 1 2 n 1 u y h i 1 2 n 1 δ y c h i 1 2 n 1 ϕ h i r h i δ t c h i n c s in eq c 1 c is set using the upwinding technique the discretized advection diffusion adsorption equations in c 1 are solved only after the equations for pressures and the velocities have been solved at the new time this decoupling of the tracer transport equations from the flow equations ensures that two separate smaller sized problems are solved instead of a larger system of equations 
7093,quantifying and reducing uncertainties in physics based hydrological model parameters will improve model reliability for hydrological forecasting we present an uncertainty quantification framework that combines the strengths of stepwise sensitivity analysis and adaptive surrogate based multi objective optimization to facilitate practical assessment and reduction of model parametric uncertainties framework performance was tested using the distributed hydrological model coupled routing and excess storage crest for daily streamflow simulation over ten watersheds by identifying sensitive parameters stepwisely we reduced the number of parameters requiring calibration from twelve to seven thus limiting the dimensionality of calibration problem by updating surrogate models adaptively we found the optimal sets of sensitive parameters with the surrogate based multi objective optimization the calibrated crest was able to satisfactorily simulate observed streamflow for all watersheds improving one minus nash sutcliffe efficiency 1 nse by 65 90 and percentage absolute relative bias rb by 60 95 compared to the default the validation result demonstrated that the calibrated crest was also able to reproduce observed streamflow outside the calibration period improving 1 nse by 40 85 and rb by 35 90 compared to the default overall this uncertainty quantification framework is effective for assessment and reduction of model parametric uncertainties the results of which improve model simulations and enhance understanding of model behaviors keywords hydrological modeling uncertainty quantification sensitivity analysis surrogate model parameter optimization 1 introduction hydrological models have become indispensable tools for both operational applications such as flood forecasting and water resource management decision support and scientific research to understand hydrological processes kavetski and clark 2010 the accuracy of model predictions is greatly influenced by uncertainties such as data errors and model deficiencies renard et al 2010 prediction uncertainties are mainly due to model parameters if model structures are supposed to be correct and input data and observed data are assumed to be error free gupta et al 2005 gourley and vieux 2006 matonse and kroll 2013 appropriate calibration could reduce these parametric uncertainties to enable the models to better represent the real systems and thus provide faithful predictions vrugt et al 2003 duan et al 2017 sikorska and renard 2017 model parameters are calibrated by tuning parameter values to minimize differences between simulated and observed variables duan et al 1992 practical experience suggests that since model calibration problem is inherently multi objective a set of non commensurate criteria measuring different aspects of the system should be considered simultaneously gupta et al 1998 khu and madsen 2005 moussa and chahinian 2009 the multi objective calibration of hydrological models is often time consuming and requires many model runs to determine optimal sets efstratiadis and koutsoyiannis 2010 the computational burden is further increased by the growing complexity of hydrological models which include more sub physical processes and represent spatial heterogeneities of various hydrological processes fatichi et al 2016 in addition complex models include more parameters but still are calibrated on limited observational data which has led to an over parameterization problem jakeman and hornberger 1993 furthermore the highly nonlinear and complex interactions of the hydrological processes result in many acceptable parameter sets that produce equal model performances known as equifinality beven 2006 stedinger et al 2008 which also increases the difficulty of finding the optimal sets therefore the efficient calibration of computationally intensive distributed hydrological models under a multi objective framework is a difficult exercise with great uncertainty zhang et al 2009a shi et al 2014 one way to alleviate the computational burden and uncertainty associated with model calibration is to reduce parameter dimensionality before calibration sensitivity analyses can identify parameters that dominate model behavior gan et al 2014 which allows models to be simplified without affecting the reliability of simulation by setting insensitive parameters at fixed values within their feasible ranges saltelli et al 2008 sensitivity analysis methods can be qualitative or quantitative the qualitative methods assess parameter sensitivity by visualization tools such as scatter plots showing the parameter response relationships or by relative simple measures such as the screening methods whereas the quantitative methods quantify each parameter s contribution to the response variance using variance based measures pianosi et al 2016 a comprehensive evaluation of various qualitative and quantitative sensitivity analysis methods can be found in gan et al 2014 their comparisons show that the latter are more accurate and robust but less efficient than the former another way to ease the computational burden is to use surrogate models to approximate the more expensive hydrological models for quantitative sensitivity analysis and model calibration the surrogate model is constructed based on parameter response relationships obtained from simulations with the hydrological model marie and simioni 2014 the way of using surrogate modeling methods can be sequential or adaptive recursive the sequential framework uses the globally fitted surrogate model for a fully substitution of the original model whereas the adaptive recursive framework adaptively update the globally locally fitted surrogate model and recursively use the newly build surrogate model for substitution of the original model razavi et al 2012 the former is more appropriate for quantitative sensitivity analysis while the latter is more efficient for parameter optimization a variety of surrogate modeling methods are reviewed and compared in villa vialaneix et al 2012 and razavi et al 2012 most previous studies have used either sensitivity analyses or surrogate models to facilitate model calibration for example muleta and nicklow 2005 foglia et al 2009 and van werkhoven et al 2009 conducted sensitivity analyses to reduce parameter dimensionality before model calibration wang et al 2014 gong et al 2015 and chen et al 2017 adopted surrogate based optimization methods to improve computational efficiency for model calibration some studies have used both sensitivity analyses and surrogate models in the way of surrogate based sensitivity analyses shahsavani and grimvall 2011 borgonovo et al 2012 daneshkhah and bedford 2013 we combined the strengths of the state of the art methods for multi objective calibration in a systematic stepwise way 1 qualitative sensitivity analysis for parameter screening of a high dimensional model 2 sequential surrogate based quantitative sensitivity analysis for identifying the most sensitive parameters of the dimension reduced model and 3 adaptive surrogate based optimization for calibrating the most sensitive parameters this stepwise way would save considerable computational budget for assessment and reduction of parametric uncertainties we conducted hydrological simulation experiments to construct surrogate models that can be used both to facilitate quantitative sensitivity analysis for parameter reduction and to provide reliable information for promising regions of the global optimum this reuse of the hydrological simulation experiments would greatly reduce computational cost since the majority of the computational budget for surrogate modeling is the original simulation model run the main objective of this study is to assess and reduce parametric uncertainties for the distributed hydrological model coupled routing and excess storage crest wang et al 2011 with a systematic uncertainty quantification framework using this framework we demonstrate a method to improve daily streamflow simulation effectively in the presence of parametric uncertainties for the crest over ten representative watersheds with varying hydroclimatic soil and vegetation conditions during this process we also try to understand model behaviors for heterogeneous spatial domain across these watersheds 2 model experimental data and setup 2 1 crest model crest was jointly developed by the university of oklahoma http hydro ou edu and national aeronautics and space administration nasa servir named for the spanish verb to serve project team http www servir net to simulate the spatiotemporal variation of land surface and subsurface water fluxes and storages wang et al 2011 its main features include 1 coupling between distributed rainfall runoff generation and cell to cell routing processes via three feedback mechanisms and 2 scalability by a representation of subgrid soil moisture variability and routing processes further model details can be found in wang et al 2011 crest has been successfully implemented in a variety of multiscale hydrological studies khan et al 2011 wu et al 2012 xue et al 2013 tang et al 2016 and several flood warning systems including the flooded locations and simulated hydrographs project flash http blog nssl noaa gov flash and the global flood monitoring system gfms http eos ou edu although crest has been widely used its parametric uncertainties have not yet been analyzed and its model behaviors across watersheds have not been fully understood previous works on the calibration of crest are often performed for all parameters which takes a high computational cost for this distributed hydrological model khan et al 2011 wu et al 2012 xue et al 2013 consequently we would like to identify the most important parameters of crest and simplify it for future use moreover almost all calibration works of crest are performed with single objective for the watersheds outside of china experiences from which are insufficient and nontransferable for its use in china domain therefore we would also like to make a systematic multi objective calibration of the most important parameters for representative watersheds in china the latest version crest v2 1 was used in this study to evaluate the impact of model parameters on streamflow simulation across watersheds over the china domain at a 0 125 degree latitude longitude grid 2 2 experimental data 2 2 1 study area and evaluation data sets we selected one representative watershed for each of the ten large river basins in china which span different hydroclimatic soil and vegetation conditions fig 1 shows the geographic location elevation and streamflow gauging station of each representative watershed at these stations observed daily streamflow discharge data from 1 january 2008 to 31 december 2012 were acquired from the hydrological yearbooks published by the ministry of water resources of china table 1 summarizes the station and watershed characteristics as well as watershed averaged mean daily precipitation p potential evapotranspiration pet and station mean daily streamflow discharge sd for the observation period 2 2 2 hydrography data the digital elevation model dem was obtained from the 30 arc second hydrosheds hydrological data and map based on shuttle elevation derivatives at multiple scales product available at http hydrosheds cr usgs gov lehner et al 2008 the raw data were aggregated by neighborhood averaging onto a 0 125 degree grid and then corrected by algorithms such as stream burning and sink filling based on the corrected dem data a drainage direction map followed by a flow accumulation map were generated using the eight direction d8 flow model jenson and domingue 1988 a river network map was extracted by considering the grids with flow accumulation values in number of grids greater than or equal to 50 using the raster calculator tool 2 2 3 forcing data a gauge satellite merged precipitation product with a daily 0 25 deg 0 25 deg resolution was used to drive crest available at http data cma cn it was generated using hourly rain gauge data at more than 30 000 automatic weather stations in china in conjunction with the climate precipitation center morphing cmorph precipitation product shen et al 2014 the daily 1 deg 1 deg global pet product was acquired from the famine early warning systems network fews net available at http earlywarning usgs gov fews it was estimated by the penman monteith equation using climate data extracted from global data assimilation system gdas both precipitation and pet data covering the period from 1 january 2007 to 31 december 2012 were remapped onto the 0 125 deg 0 125 deg study domain by bilinear interpolation 2 3 experimental setup the control version crest with default parameter values was run for a spin up period of six years 2007 2012 at a daily time step to achieve an equilibrium state all subsequent experiments were initialized from this state at the end of the spin up the experiments for qualitative and quantitative sensitivity analysis as well as parameter optimization were run from 1 january 2007 to 31 december 2010 while those for validation were run from 1 january 2010 to 31 december 2012 to minimize the influence of initial conditions the first year s outputs of all experiments were excluded from subsequent analyses 3 uncertainty quantification framework an uncertainty quantification framework that combines the strengths of stepwise sensitivity analysis and adaptive surrogate based optimization was designed to assess and reduce parametric uncertainties of crest at low computational cost fig 2 breaks down the four key steps of the uncertainty quantification framework more detailed information regarding the qualitative sensitivity analysis and surrogate based quantitative sensitivity analysis can be found in gan et al 2015 a detailed description of the adaptive surrogate based optimization is presented in wang et al 2014 3 1 problem specification the first step of the uncertainty quantification framework is to specify the uncertainty quantification problem including the choice of model parameters and objective functions table 2 lists the twelve crest parameters whose ranges were determined according to physical meanings and previous literature xue et al 2013 xue et al 2015 all parameters were assumed to follow a uniform distribution following mccuen et al 2006 two objective functions relative bias rb and nash sutcliffe efficiency nse nash and sutcliffe 1970 were used to evaluate the goodness of fit for streamflow simulation the former metric is the model bias normalized with respect to the observed mean while the latter is the root mean square error normalized with respect to the observed variance the equations of both statistics are given in appendix a 3 2 qualitative sensitivity analysis qualitative sensitivity analysis methods reflect the relative importance of model parameters and aim to screen out insensitive parameters using a small number of model evaluations we adopted the latin hypercube based one at a time lh oat method van griensven et al 2006 for qualitative sensitivity analysis it combines the robustness of latin hypercube sampling which ensures that the parameter space has been fully explored with the precision of one at a time sampling assuring that changes in the response in each model run can be unambiguously attributed to the parameter that was changed overall and interaction effects of each parameter can be represented respectively by the mean and standard deviation of its elementary effects the former is the overall influence of the parameter on the response while the latter is the ensemble of the parameter s higher order effects campolongo et al 2007 3 3 surrogate based quantitative sensitivity analysis quantitative sensitivity analysis methods estimate the percentage of response variance each parameter is responsible for due to the parameter s first order effect and interaction effects with other parameters we used the sobol 1993 2001 method which performs anova analysis of variance like decomposition of model response variance and measures the specific order sensitivity index of a parameter by attributing all relevant variances the total sensitivity index can be estimated by adding up all the sensitivity indices containing the parameter sobol s method is model independent and can be used for nonlinear and non monotonic models its main drawback is that calculating higher order terms is prohibitive especially when parameter dimensionality is large we adopted the total sensitivity index proposed by homma and saltelli 1996 as a measure of the total effect of a given parameter at reasonable cost by subtracting all sensitivity indices not related to this parameter from 1 even though the calculation of total sensitivity indices is practical a large number of samples are still needed to get reliable results we employed multivariate adaptive regression splines mars friedman 1991 to construct a surrogate model for computing sobol first order sobol 1 and total sobol t sensitivity indices several other methods such as gaussian process radial basis functions and support vector machines can also be considered the selection of surrogate modeling methods depends on the purpose of the research the applicability of the method and the complexity of the simulation model we chose mars because we need a globally accurate surrogate model that can be used not only for sensitivity analysis but also for providing reliable information for the promising regions of the global optimum and mars is particularly competitive in accuracy and efficiency jin et al 2001 chen et al 2013 gan et al 2014 quasi random lpτ lptau sequence sampling sobol 1967 was adopted to generate deterministic and uniformly distributed samples because it allows the addition of more points to the initial samples with the same uniformity characteristics tong 2005 the idea of lptau is to generate uniformly distributed quasi random sequence within the n dimensional hypercube i n 0 1 n unlike random sequence the position of sample points of the quasi random sequence is deterministic a finite sequence of points in i n is called a pτ net if it contains n 2 k points and every dyadic box of volume 2 τ k contains exactly 2 τ points of the sequence where k and τ are integers and k τ niederreiter 1978 other sampling methods such as monte carlo latin hypercube and orthogonal array based latin hypercube can also be considered a comparison of different sampling methods and surrogate modeling methods for surrogate based sensitivity analysis can be found in gan et al 2014 we employed the k fold cross validation strategy meckesheimer et al 2002 to assess the fidelity of mars namely n parameter response pairs x j y j for j 1 2 n were split into k subsets of approximately equal size and the mars was fitted k times each time leaving out one of the subsets from training and using the omitted subset to compute the coefficient of determination r2 see appendix b a tenfold cross validation scheme as suggested by zhang et al 2009b was employed to obtain the average r2 values assessing the accuracy of mars additional model runs were made to increase the accuracy of mars when r2 is less than a predefined value e g 0 85 and the refitted mars was assessed again using the enlarged parameter response pairs this trail and error process was repeated until we trained a reliable surrogate model 3 4 adaptive surrogate based multi objective optimization the multi objective optimization seeks a compromise solution from a set of pareto solutions that represent the tradeoffs among different objectives we employed the adaptive surrogate based optimization framework presented in wang et al 2014 for multi objective optimization of the most sensitive parameters and used the lptau sampling mars surrogate modeling and sce ua optimization methods for corresponding processes the entire adaptive surrogate based multi objective optimization procedure is as follows 1 objective function transformation to make the two objective functions of streamflow discharge comparable in variability range and direction we took the transformations f 1 x rb and f 2 x 1 n s e and expressed the multi objective optimization problem as 1 min y min f x min f 1 x f 2 x min rb 1 n s e the two objective functions were then transformed into a euclidian distance function following madsen 2000 2 f agg x j 1 2 f j x a j 2 where f j x is the j th objective function and a j is the transformation constant to make f j x a j have the same distance to the origin a j can be determined through lptau experiments inherited from surrogate based quantitative sensitivity analysis by 3 a j max f 1 min f 2 min f j min j 1 2 if f 1 min f 2 min a 1 0 and a 2 f 1 min f 2 min or else a 1 f 2 min f 1 min and a 2 0 2 surrogate model reconstruction to improve the optimization search efficiency mars was reconstructed to approximate the relationship between the sensitive parameters and the aggregated objective function f agg using the parameter response pairs of the simulation model i e crest we took the lptau experiments inherited from surrogate based quantitative sensitivity analysis as the initial samples to construct a globally accurate surrogate model which can provide reliable information for promising regions of the global optimum in the parameter space it is unlikely however that the surrogate would be sufficiently accurate in the region of the optimum a succession of infill samples at the predicted optimum were therefore added to enhance the accuracy of the surrogate in the promising region to find the optimum efficiently 3 surrogate based optimization we employed the global optimization method shuffled complex evolution sce ua duan et al 1992 to search the minimum f agg value and corresponding optimal parameter set of the surrogate model for effectiveness and efficiency the sce ua method must properly specify a few algorithmic parameters in particular the number of complexes p is primarily determined by the dimensionality of the calibration problem i e the number of model parameters to be optimized and a value equal to two or larger is sufficient for a six dimension problem duan et al 1994 we set p to four since the dimensionality of our calibration problem would be smaller than twelve after the parameter reduction other algorithmic parameters and the stop criteria were assigned to the default values as suggested by duan et al 1994 4 simulation model evaluation and stop criteria check the simulation model crest was run using the optimal parameter set of the surrogate model to find the corresponding f agg value the optimal parameter set and corresponding f agg value were used to update the parameter response pairs and steps 2 4 were continued until the f agg value of the simulation model converged to a constant 4 results and discussion 4 1 lh oat based parameter screening the range for each of the 12 crest parameters was evenly divided into 20 levels thus 260 20 12 1 lh oat samples were generated from the 12 dimensional parameter space fig 3 shows the relative parameter sensitivities to overall effects and interaction effects of the ten watersheds for two objective functions rb and nse parameter rankings varied among watersheds as well as among objective functions even for the same sensitivity index however certain dominant patterns were evident overall p2 p3 p4 and p5 can be regarded as insensitive parameters while the other eight parameters can be classified as sensitive all the insensitive parameters are physically based and related to specific subprocesses of runoff generation and routing while the sensitive parameters are conceptually based and related to a collection of aggregated hydrological processes madsen 2003 wagener et al 2003 the former can be determined from the physical characteristics of watersheds while the latter cannot madsen 2003 the two objective functions find similar parameter sensitivities across watersheds with a few exceptions the most obvious difference is that in watershed w4 rb identifies p1 with a low overall effect top row of fig 3a while nse identifies it with a high overall effect top row of fig 3b another distinct difference is that in watershed w8 rb identifies p11 with a high interaction effect bottom row of fig 3a while nse identifies it with a low interaction effect bottom row of fig 3b this variance of parameter sensitivities between objective functions was also found in several previous studies tang et al 2007 van werkhoven et al 2008 gan et al 2015 since different objective functions measure different aspects of model behaviors the number of sensitive parameters per watershed varies from two w9 and w10 to eight w1 for rb and from two w9 and w10 to seven w1 for nse these sensitive parameters may be explained by characteristics of the specific watersheds for example watersheds w9 and w10 have very similar hydroclimatic soil and vegetation conditions and both are sensitive only to p7 and p8 which influence the overland flow velocity in these sparsely vegetated small semi arid watersheds infiltration excess overland flow contributes most to the total runoff variation of overland flow velocity leads to alterations in the timing of runoff delivery from slopes to streams holden et al 2008 meanwhile humid watershed w7 is also sensitive to p7 and or p8 because saturation excess overland flow constitutes a major part of the total runoff watersheds w1 w2 and w3 have similar hydroclimatic conditions and are sensitive to p1 p6 p8 p10 and p12 the first three parameters reflect the influence of vegetation type resulting in different throughfall evapotranspiration and overland flow velocity respectively the latter two parameters reflect the influence of soil texture and control the flow speed and discharge of interflow respectively for humid watersheds w1 w2 w3 w5 w6 and w8 p10 and p12 show strong overall effects suggesting the importance of interflow and p9 yields a significant sensitivity indicating the importance of channel flow in some cases a parameter with a low overall effect e g p7 in watershed w4 for rb may have a significant interaction effect and thus should also be regarded as a sensitive parameter gan et al 2014 4 2 construction and validation of mars model four parameters p2 p3 p4 and p5 identified as insensitive by lh oat screening were set to their default values as shown in table 2 and the other eight parameters that govern the hydrological response of crest were selected for further analysis we designed five sets of lptau samples equally spaced between 200 and 1000 with an increment of 200 to investigate the effect of training sample size on the performance of mars in approximating crest fig 4 shows that mars s performance is substantially affected by the training sample size it can well approximate crest at a low sample size for most of the watersheds for example the r2 values are greater than 0 80 for all watersheds except w4 w6 and w8 when the sample size equals to 200 the surrogate model trained with more samples tended to perform better but had higher computational cost although the ranges of r2 values varied across watersheds and objective functions the overall performance of mars with 1000 samples was sufficient in all cases indicating that the surrogate model mimics the performance of crest fairly well the r2 values with 1000 training samples range from 0 884 to 0 997 which are close to those reported in previous studies obtained by support vector machine and artificial neural network johnson and rogers 2000 zhang et al 2009b we then used the mars trained with 1000 samples as a pseudo simulator of crest to ensure that it is globally accurate not only for sensitivity analysis but also for providing reliable information for the promising regions of the global optimum for the purpose of efficient sensitivity analysis mars trained with a small sample size e g 200 can even be used for most of the watersheds moreover other efficient methods such as the gaussian process based probability sensitivity analysis oakley and o hagan 2004 daneshkhah and bedford 2013 could also be considered however the surrogate model trained with much less samples for surrogate based sensitivity analysis may easily miss the global optimum when it is reused for surrogate based optimization razavi et al 2012 the efficiency of the surrogate model could be better improved by comparing different surrogate modeling methods and sampling methods against the research purpose gan et al 2014 wang et al 2014 4 3 mars based sobol sensitivity indices the eight parameters p1 p6 p7 p8 p9 p10 p11 and p12 that play important roles in explaining the uncertainty of streamflow simulation were tested for their sensitivities using the pseudo simulator we designed 100 000 lptau samples to estimate sobol sensitivity indices for each objective function in each watershed fig 5 presents sobol first order and total sensitivity indices of ten watersheds for rb and nse of streamflow discharge the residual between sobol total and first order sensitivity indices represents the interaction of a specific parameter with other parameters at all orders parameter sensitivities vary across objective functions and watersheds and are mainly dominated by interactions the significant parameter interactions indicate that crest may be overparameterized or its model structures are incorrect bastidas et al 2006 saltelli et al 2008 rosero et al 2010 in addition all watersheds exhibit higher parameter interaction for nse than for rb suggesting that the functional relationship is more complex for the former than for the latter it should be noted that the surrogate based sensitivity indices especially the interactions we obtained may differ from the true indices that would have been obtained had we been able to carry out the sensitivity analysis on the simulation model o hagan 2006 the gaussian process based probability sensitivity analysis method provides us a way of presenting variance based sensitivity indices with uncertainty ranges at low computational cost oakley and o hagan 2004 daneshkhah and bedford 2013 this method is especially attractive when the simulation model is computationally expensive and its response surface is smooth the uncertainty ranges of the sensitivity indices decrease as more samples are used to approximate corresponding sensitivity indices daneshkhah and bedford 2013 although no uncertainty ranges are given here along with the mars based sobol sensitivity indices the sensitivity categories based on the total sensitivity indices should be reliable since the accuracy of the surrogate model has validated to be acceptable shahsavani and grimvall 2011 in general all parameters are sensitive in at least one watershed except that parameter p11 overland reservoir discharge parameter is insensitive in all watersheds for all objective functions in most watersheds the most sensitive parameters are p6 multiplier on potential evapotranspiration p8 overland flow velocity exponent and p12 interflow reservoir discharge parameter for rb and p1 multiplier on the precipitation field p6 and p12 for nse p1 and p6 are the major driving parameters in runoff generation and thus are expected to be highly sensitive the high sensitivity of p12 indicates the important role of interflow to the total runoff in crest meanwhile the low p11 sensitivity and the high p8 sensitivity suggest that the velocity of overland flow influences the streamflow situation more than its amount 4 4 adaptive mars based multi objective optimization 4 4 1 feasibility of calibration we systemically checked the feasibility of calibration to determine whether the actual observations could be captured by the ensemble ranges of the 1000 lptau experiments hou et al 2012 huang et al 2013 which were inherited from the surrogate based quantitative sensitivity analysis and would be used to construct surrogate models for adaptive surrogate based optimization fig 6 depicts boxplots of mean daily streamflow discharge for the ensemble experiments in ten watersheds the boxplots present the streamflow simulation uncertainties by five number summaries i e the minimum first quartile 25 median 50 third quartile 75 and the maximum of the ensemble experiments generally the control experiment underestimates discharges particularly for the summer months whereas the ensemble ranges contain the observations the result suggests that the parameter space is adequately represented by the samples of model parameters with reasonable physical bounds it also indicates the necessity and possibility of calibrating parameters using observations 4 4 2 model calibration seven sensitive parameters p1 p6 p7 p8 p9 p10 and p12 were selected as the calibration parameters while other insensitive parameters were set to their default values the 1000 lptau experiments used in constructing mars for quantitative sensitivity analysis were taken to obtain the transformation constants a 1 and a 2 for rb and 1 nse respectively the parameter response pairs of these experiments were used to reconstruct mars to approximate crest for searching for the optimal solution the newly found optimal parameter response pair was appended to the parameter response pool to adaptively update mars this adaptive surrogate based optimization procedure was continued until the best compromise solution was found sample sizes needed to find such solutions for watersheds w1 to w10 were 240 310 340 280 265 289 210 236 198 and 180 respectively fig 7 presents the searching route in the objective function space across different watersheds including the initial intermediate and final optimal solutions a significant tradeoff between rb and 1 nse is observed in all watersheds except watershed w10 indicating that a parameter set that gives small percentage volume bias results in a poor hydrograph shape and vice versa this result is in line with the findings of madsen 2003 and bekele and nicklow 2007 who have conducted automatic calibration of hydrological models involving multiple objectives the significant tradeoff between different criteria may be due to unresolved errors in the model structure fenicia et al 2007 pokhrel et al 2008 and or measurement errors in the model data the relatively nonobvious tradeoff between rb and 1 nse for watershed w10 means both percentage volume bias and hydrograph shape can be improved simultaneously the absence of significant tradeoff indicates that the model structure is generally well conceptualized and the most relevant hydrological processes are taken into consideration for this watershed schoups et al 2005 the disassociation of the final optimal solutions from clusters of the intermediate solutions for w1 w7 and w9 indicates that the response surfaces for these watersheds are pretty rough and the adaptive mars based sce ua successfully found the global optimal solutions but spent many experiments on the local optimum regions the final optimal solutions which compromise the pareto outcomes perform significantly better than those of the initial solutions reducing 1 nse by 5 50 and rb by 20 95 fig 8 shows variations in the parameter sets which have been normalized to the feasible bounds in table 2 so that all range from 0 to 1 the parametric uncertainties have been significantly reduced by the adaptive surrogate based multi objective optimization in particular in watersheds w6 and w8 most parameters have variation ranges smaller than 30 so they were very precisely determined on the other hand in watersheds w1 and w5 most parameters have larger variability ranges and indistinct trends so parameter sets with high variability could give equally good simulations some parameters show obvious trends when moving along the searching route of the optimal solutions for example p1 values are small in watershed w3 but large in watersheds w6 and w8 whereas p6 values are large in watershed w3 but small in watersheds w6 and w8 this is because increases in p1 result in increased precipitation and thus greater streamflow discharge while increases in p6 result in increased evapotranspiration and thus smaller streamflow discharge that is larger p1 and smaller p6 lead to larger streamflow discharge which is consistent with the observation that the peak flows are much higher in watersheds w6 and w8 than in watershed w3 during the calibration period fig 9 compares simulated and observed streamflow discharge at different watershed outlets the uncertainty intervals show that crest produces a range of simulated hydrographs corresponding to the equally good parameter sets along the pareto front the final optimal solutions not only closely reproduce the timing and magnitude of the peak flows but also well represent the shape of the recession curves the simulation results of the default solutions tend to underestimate streamflow by about 70 100 in all watersheds while the optimal solutions show significant improvement reducing 1 nse by 65 90 and rb by 60 95 for watersheds w3 w6 and w8 where streamflow data contain many extended periods of low flow values or extreme high peaks it is relatively more difficult to obtain a reliable calibration the relatively poor ability for the model to simulate the recession curve e g watersheds w1 w6 and w8 indicates that the groundwater module could be better improved the tendency for the model to underestimate spring peaks e g watersheds w1 w2 and w3 could be attributed to the lack of a snowmelt module in crest it should also be noted that human activities such as reservoir regulation and water diversion can affect the observed streamflow discharge which inevitably lead to disagreement between simulated and observed streamflow 4 4 3 model validation we validated the calibrated model for streamflow simulation outside the calibration period fig 10 presents the validation results for streamflow simulations over the ten watersheds the calibrated model simulation showed a large improvement over the default simulation reducing 1 nse by 40 85 and rb by 35 90 although some performance indices remain unsatisfactory since the parameters were calibrated to simulate intense flood events the model performance decreases during the validation period when rainfall rates are lower and vice versa moussa et al 2007 zhang et al 2009a for example the calibration period for the watershed w3 is characterized by three dry years which causes low peak flows less than 150 m3 s while the validation period is characterized by high rainfall rates during the year 2012 which causes high peak flows more than 3000 m3 s in addition the relatively short duration three years of the observational data used in calibration could also lead to unsatisfactory validation results sorooshian and gupta 1995 muleta and nicklow 2005 furthermore the model limitations in representing the spatial heterogeneity of watershed may cause unstable model performance bekele and nicklow 2007 5 summary and conclusions we presented an uncertainty quantification framework that combines the strengths of stepwise sensitivity analysis and adaptive surrogate based multi objective optimization to facilitate practical assessment and reduction of model parametric uncertainties the framework was tested over ten watersheds using the distributed hydrological model crest for daily streamflow simulation during the period 2008 2010 this generated optimal sets of sensitive parameters which were used to improve crest with validation against the daily streamflow simulation during the period 2011 2012 parameter sensitivities vary across watersheds and objective functions but clearly demonstrate dominant patterns of the twelve parameters tested we identified four that had little effect on streamflow simulation in any watershed they were physically based and determined by the physical mechanisms of runoff generation and routing processes and thus the physical characteristics of the watersheds the remaining eight parameters were all conceptually based and related to aggregated hydrological processes and thus generally cannot be determined from the physical characteristics of the watersheds but need to be calibrated madsen 2003 of these we identified that the contribution of the overland reservoir discharge parameter to the response variances is also negligible indicating that more accurate quantitative evaluation of parameter sensitivities is needed after a qualitative parameter screening generally the stepwise sensitivity analysis efficiently reduced the number of parameters needing calibration from twelve to seven and thus constrained the dimensionality of calibration problem and enhanced the efficiency of parameter calibration the calibration exercise satisfactorily reproduced observed streamflow for all watersheds the optimal solutions significantly improved streamflow simulation over the default reducing 1 nse by 65 90 and rb by 60 95 the validation exercise also indicated a large improvement of the optimal simulation over the default reducing 1 nse by 40 85 and rb by 35 90 although some performance indices were still not satisfactory as noted in other distributed hydrological models muleta and nicklow 2005 zhang et al 2009a sun et al 2017 even after calibration there are potentially large uncertainties because no simulation model is capable of representing all physical processes and observational data are likely incomplete additionally the optimal parameter sets are realistic only for the same watershed under similar meteorological conditions a comprehensive evaluation is necessary to transfer the optimal parameter sets from one watershed to another with similar watershed properties and hydroclimatic conditions zhang et al 2009a kumar et al 2013 gan et al 2015 or even to the same watershed with greatly different meteorological conditions overall our uncertainty quantification framework is effective for multi watershed multi objective parametric uncertainty quantification and provides useful information to understand the model behaviors and improve the model simulations the framework designs various simulation experiments to reduce parameter dimensionality and thus is well suited for calibrating high dimensionality problems requiring systematic quantification of parametric uncertainties the qualitative or even quantitative sensitivity analysis could be discarded for the calibration of low dimensionality problems we considered only streamflow simulation due to the lack of observational data for other variables in addition the duration of the observed streamflow data is relatively short the capability of this framework as well as the behavior of crest could be more effectively tested with more observational data for multiple variables in multiple watersheds further improvements of the framework and its application to some of the more sophisticated models such as the conjunctive surface subsurface process cssp choi et al 2013 and noah multiparameterization noah mp niu et al 2011 land surface models are still ongoing the results of these works will be reported in due course acknowledgments this research was supported by the national natural science foundation of china 41505092 national key research and development program of china 2017yfc1404000 open research fund of the state key laboratory of severe weather 2015lasw a05 and national natural science foundation of china 41605073 liang was partially supported by the beijige open research fund of the nanjing meteorological joint research center njcar2016zd03 we thank jennifer a kennedy for her careful revision of the manuscript we thank the editors and three anonymous reviewers for their insightful comments and suggestions that helped improve the manuscript the forcing data and hydrography data can be accessed through the links given in the text the observed streamflow discharge data are available upon request by contacting the first author appendix a objective functions relative bias rb and nash sutcliffe efficiency nse are defined as follows to measure the overall water balance and the overall shape of the hydrograph respectively a1 rb 1 n i 1 n s i o i o a2 nse 1 i 1 n o i s i 2 i 1 n o i o 2 where s i and o i are simulated and observed values at time i respectively o is the mean of observations and n is the total number of observations or simulations rb ranges from minus infinity to plus infinity with lower absolute value indicating better agreement while nse ranges from minus infinity to 1 0 with higher value indicating better agreement appendix b k fold cross validation measure the k fold cross validation measure used in this study is the coefficient of determination r2 which is calculated as b1 r 2 1 k p 1 k j 1 n k y p j y y p j y j 1 n k y p j y 2 j 1 n k y p j y 2 2 where y p j and y p j are the predicted and actual response values of the jth sample point of the pth subset respectively y and y are mean values of y p j and y p j respectively 
7093,quantifying and reducing uncertainties in physics based hydrological model parameters will improve model reliability for hydrological forecasting we present an uncertainty quantification framework that combines the strengths of stepwise sensitivity analysis and adaptive surrogate based multi objective optimization to facilitate practical assessment and reduction of model parametric uncertainties framework performance was tested using the distributed hydrological model coupled routing and excess storage crest for daily streamflow simulation over ten watersheds by identifying sensitive parameters stepwisely we reduced the number of parameters requiring calibration from twelve to seven thus limiting the dimensionality of calibration problem by updating surrogate models adaptively we found the optimal sets of sensitive parameters with the surrogate based multi objective optimization the calibrated crest was able to satisfactorily simulate observed streamflow for all watersheds improving one minus nash sutcliffe efficiency 1 nse by 65 90 and percentage absolute relative bias rb by 60 95 compared to the default the validation result demonstrated that the calibrated crest was also able to reproduce observed streamflow outside the calibration period improving 1 nse by 40 85 and rb by 35 90 compared to the default overall this uncertainty quantification framework is effective for assessment and reduction of model parametric uncertainties the results of which improve model simulations and enhance understanding of model behaviors keywords hydrological modeling uncertainty quantification sensitivity analysis surrogate model parameter optimization 1 introduction hydrological models have become indispensable tools for both operational applications such as flood forecasting and water resource management decision support and scientific research to understand hydrological processes kavetski and clark 2010 the accuracy of model predictions is greatly influenced by uncertainties such as data errors and model deficiencies renard et al 2010 prediction uncertainties are mainly due to model parameters if model structures are supposed to be correct and input data and observed data are assumed to be error free gupta et al 2005 gourley and vieux 2006 matonse and kroll 2013 appropriate calibration could reduce these parametric uncertainties to enable the models to better represent the real systems and thus provide faithful predictions vrugt et al 2003 duan et al 2017 sikorska and renard 2017 model parameters are calibrated by tuning parameter values to minimize differences between simulated and observed variables duan et al 1992 practical experience suggests that since model calibration problem is inherently multi objective a set of non commensurate criteria measuring different aspects of the system should be considered simultaneously gupta et al 1998 khu and madsen 2005 moussa and chahinian 2009 the multi objective calibration of hydrological models is often time consuming and requires many model runs to determine optimal sets efstratiadis and koutsoyiannis 2010 the computational burden is further increased by the growing complexity of hydrological models which include more sub physical processes and represent spatial heterogeneities of various hydrological processes fatichi et al 2016 in addition complex models include more parameters but still are calibrated on limited observational data which has led to an over parameterization problem jakeman and hornberger 1993 furthermore the highly nonlinear and complex interactions of the hydrological processes result in many acceptable parameter sets that produce equal model performances known as equifinality beven 2006 stedinger et al 2008 which also increases the difficulty of finding the optimal sets therefore the efficient calibration of computationally intensive distributed hydrological models under a multi objective framework is a difficult exercise with great uncertainty zhang et al 2009a shi et al 2014 one way to alleviate the computational burden and uncertainty associated with model calibration is to reduce parameter dimensionality before calibration sensitivity analyses can identify parameters that dominate model behavior gan et al 2014 which allows models to be simplified without affecting the reliability of simulation by setting insensitive parameters at fixed values within their feasible ranges saltelli et al 2008 sensitivity analysis methods can be qualitative or quantitative the qualitative methods assess parameter sensitivity by visualization tools such as scatter plots showing the parameter response relationships or by relative simple measures such as the screening methods whereas the quantitative methods quantify each parameter s contribution to the response variance using variance based measures pianosi et al 2016 a comprehensive evaluation of various qualitative and quantitative sensitivity analysis methods can be found in gan et al 2014 their comparisons show that the latter are more accurate and robust but less efficient than the former another way to ease the computational burden is to use surrogate models to approximate the more expensive hydrological models for quantitative sensitivity analysis and model calibration the surrogate model is constructed based on parameter response relationships obtained from simulations with the hydrological model marie and simioni 2014 the way of using surrogate modeling methods can be sequential or adaptive recursive the sequential framework uses the globally fitted surrogate model for a fully substitution of the original model whereas the adaptive recursive framework adaptively update the globally locally fitted surrogate model and recursively use the newly build surrogate model for substitution of the original model razavi et al 2012 the former is more appropriate for quantitative sensitivity analysis while the latter is more efficient for parameter optimization a variety of surrogate modeling methods are reviewed and compared in villa vialaneix et al 2012 and razavi et al 2012 most previous studies have used either sensitivity analyses or surrogate models to facilitate model calibration for example muleta and nicklow 2005 foglia et al 2009 and van werkhoven et al 2009 conducted sensitivity analyses to reduce parameter dimensionality before model calibration wang et al 2014 gong et al 2015 and chen et al 2017 adopted surrogate based optimization methods to improve computational efficiency for model calibration some studies have used both sensitivity analyses and surrogate models in the way of surrogate based sensitivity analyses shahsavani and grimvall 2011 borgonovo et al 2012 daneshkhah and bedford 2013 we combined the strengths of the state of the art methods for multi objective calibration in a systematic stepwise way 1 qualitative sensitivity analysis for parameter screening of a high dimensional model 2 sequential surrogate based quantitative sensitivity analysis for identifying the most sensitive parameters of the dimension reduced model and 3 adaptive surrogate based optimization for calibrating the most sensitive parameters this stepwise way would save considerable computational budget for assessment and reduction of parametric uncertainties we conducted hydrological simulation experiments to construct surrogate models that can be used both to facilitate quantitative sensitivity analysis for parameter reduction and to provide reliable information for promising regions of the global optimum this reuse of the hydrological simulation experiments would greatly reduce computational cost since the majority of the computational budget for surrogate modeling is the original simulation model run the main objective of this study is to assess and reduce parametric uncertainties for the distributed hydrological model coupled routing and excess storage crest wang et al 2011 with a systematic uncertainty quantification framework using this framework we demonstrate a method to improve daily streamflow simulation effectively in the presence of parametric uncertainties for the crest over ten representative watersheds with varying hydroclimatic soil and vegetation conditions during this process we also try to understand model behaviors for heterogeneous spatial domain across these watersheds 2 model experimental data and setup 2 1 crest model crest was jointly developed by the university of oklahoma http hydro ou edu and national aeronautics and space administration nasa servir named for the spanish verb to serve project team http www servir net to simulate the spatiotemporal variation of land surface and subsurface water fluxes and storages wang et al 2011 its main features include 1 coupling between distributed rainfall runoff generation and cell to cell routing processes via three feedback mechanisms and 2 scalability by a representation of subgrid soil moisture variability and routing processes further model details can be found in wang et al 2011 crest has been successfully implemented in a variety of multiscale hydrological studies khan et al 2011 wu et al 2012 xue et al 2013 tang et al 2016 and several flood warning systems including the flooded locations and simulated hydrographs project flash http blog nssl noaa gov flash and the global flood monitoring system gfms http eos ou edu although crest has been widely used its parametric uncertainties have not yet been analyzed and its model behaviors across watersheds have not been fully understood previous works on the calibration of crest are often performed for all parameters which takes a high computational cost for this distributed hydrological model khan et al 2011 wu et al 2012 xue et al 2013 consequently we would like to identify the most important parameters of crest and simplify it for future use moreover almost all calibration works of crest are performed with single objective for the watersheds outside of china experiences from which are insufficient and nontransferable for its use in china domain therefore we would also like to make a systematic multi objective calibration of the most important parameters for representative watersheds in china the latest version crest v2 1 was used in this study to evaluate the impact of model parameters on streamflow simulation across watersheds over the china domain at a 0 125 degree latitude longitude grid 2 2 experimental data 2 2 1 study area and evaluation data sets we selected one representative watershed for each of the ten large river basins in china which span different hydroclimatic soil and vegetation conditions fig 1 shows the geographic location elevation and streamflow gauging station of each representative watershed at these stations observed daily streamflow discharge data from 1 january 2008 to 31 december 2012 were acquired from the hydrological yearbooks published by the ministry of water resources of china table 1 summarizes the station and watershed characteristics as well as watershed averaged mean daily precipitation p potential evapotranspiration pet and station mean daily streamflow discharge sd for the observation period 2 2 2 hydrography data the digital elevation model dem was obtained from the 30 arc second hydrosheds hydrological data and map based on shuttle elevation derivatives at multiple scales product available at http hydrosheds cr usgs gov lehner et al 2008 the raw data were aggregated by neighborhood averaging onto a 0 125 degree grid and then corrected by algorithms such as stream burning and sink filling based on the corrected dem data a drainage direction map followed by a flow accumulation map were generated using the eight direction d8 flow model jenson and domingue 1988 a river network map was extracted by considering the grids with flow accumulation values in number of grids greater than or equal to 50 using the raster calculator tool 2 2 3 forcing data a gauge satellite merged precipitation product with a daily 0 25 deg 0 25 deg resolution was used to drive crest available at http data cma cn it was generated using hourly rain gauge data at more than 30 000 automatic weather stations in china in conjunction with the climate precipitation center morphing cmorph precipitation product shen et al 2014 the daily 1 deg 1 deg global pet product was acquired from the famine early warning systems network fews net available at http earlywarning usgs gov fews it was estimated by the penman monteith equation using climate data extracted from global data assimilation system gdas both precipitation and pet data covering the period from 1 january 2007 to 31 december 2012 were remapped onto the 0 125 deg 0 125 deg study domain by bilinear interpolation 2 3 experimental setup the control version crest with default parameter values was run for a spin up period of six years 2007 2012 at a daily time step to achieve an equilibrium state all subsequent experiments were initialized from this state at the end of the spin up the experiments for qualitative and quantitative sensitivity analysis as well as parameter optimization were run from 1 january 2007 to 31 december 2010 while those for validation were run from 1 january 2010 to 31 december 2012 to minimize the influence of initial conditions the first year s outputs of all experiments were excluded from subsequent analyses 3 uncertainty quantification framework an uncertainty quantification framework that combines the strengths of stepwise sensitivity analysis and adaptive surrogate based optimization was designed to assess and reduce parametric uncertainties of crest at low computational cost fig 2 breaks down the four key steps of the uncertainty quantification framework more detailed information regarding the qualitative sensitivity analysis and surrogate based quantitative sensitivity analysis can be found in gan et al 2015 a detailed description of the adaptive surrogate based optimization is presented in wang et al 2014 3 1 problem specification the first step of the uncertainty quantification framework is to specify the uncertainty quantification problem including the choice of model parameters and objective functions table 2 lists the twelve crest parameters whose ranges were determined according to physical meanings and previous literature xue et al 2013 xue et al 2015 all parameters were assumed to follow a uniform distribution following mccuen et al 2006 two objective functions relative bias rb and nash sutcliffe efficiency nse nash and sutcliffe 1970 were used to evaluate the goodness of fit for streamflow simulation the former metric is the model bias normalized with respect to the observed mean while the latter is the root mean square error normalized with respect to the observed variance the equations of both statistics are given in appendix a 3 2 qualitative sensitivity analysis qualitative sensitivity analysis methods reflect the relative importance of model parameters and aim to screen out insensitive parameters using a small number of model evaluations we adopted the latin hypercube based one at a time lh oat method van griensven et al 2006 for qualitative sensitivity analysis it combines the robustness of latin hypercube sampling which ensures that the parameter space has been fully explored with the precision of one at a time sampling assuring that changes in the response in each model run can be unambiguously attributed to the parameter that was changed overall and interaction effects of each parameter can be represented respectively by the mean and standard deviation of its elementary effects the former is the overall influence of the parameter on the response while the latter is the ensemble of the parameter s higher order effects campolongo et al 2007 3 3 surrogate based quantitative sensitivity analysis quantitative sensitivity analysis methods estimate the percentage of response variance each parameter is responsible for due to the parameter s first order effect and interaction effects with other parameters we used the sobol 1993 2001 method which performs anova analysis of variance like decomposition of model response variance and measures the specific order sensitivity index of a parameter by attributing all relevant variances the total sensitivity index can be estimated by adding up all the sensitivity indices containing the parameter sobol s method is model independent and can be used for nonlinear and non monotonic models its main drawback is that calculating higher order terms is prohibitive especially when parameter dimensionality is large we adopted the total sensitivity index proposed by homma and saltelli 1996 as a measure of the total effect of a given parameter at reasonable cost by subtracting all sensitivity indices not related to this parameter from 1 even though the calculation of total sensitivity indices is practical a large number of samples are still needed to get reliable results we employed multivariate adaptive regression splines mars friedman 1991 to construct a surrogate model for computing sobol first order sobol 1 and total sobol t sensitivity indices several other methods such as gaussian process radial basis functions and support vector machines can also be considered the selection of surrogate modeling methods depends on the purpose of the research the applicability of the method and the complexity of the simulation model we chose mars because we need a globally accurate surrogate model that can be used not only for sensitivity analysis but also for providing reliable information for the promising regions of the global optimum and mars is particularly competitive in accuracy and efficiency jin et al 2001 chen et al 2013 gan et al 2014 quasi random lpτ lptau sequence sampling sobol 1967 was adopted to generate deterministic and uniformly distributed samples because it allows the addition of more points to the initial samples with the same uniformity characteristics tong 2005 the idea of lptau is to generate uniformly distributed quasi random sequence within the n dimensional hypercube i n 0 1 n unlike random sequence the position of sample points of the quasi random sequence is deterministic a finite sequence of points in i n is called a pτ net if it contains n 2 k points and every dyadic box of volume 2 τ k contains exactly 2 τ points of the sequence where k and τ are integers and k τ niederreiter 1978 other sampling methods such as monte carlo latin hypercube and orthogonal array based latin hypercube can also be considered a comparison of different sampling methods and surrogate modeling methods for surrogate based sensitivity analysis can be found in gan et al 2014 we employed the k fold cross validation strategy meckesheimer et al 2002 to assess the fidelity of mars namely n parameter response pairs x j y j for j 1 2 n were split into k subsets of approximately equal size and the mars was fitted k times each time leaving out one of the subsets from training and using the omitted subset to compute the coefficient of determination r2 see appendix b a tenfold cross validation scheme as suggested by zhang et al 2009b was employed to obtain the average r2 values assessing the accuracy of mars additional model runs were made to increase the accuracy of mars when r2 is less than a predefined value e g 0 85 and the refitted mars was assessed again using the enlarged parameter response pairs this trail and error process was repeated until we trained a reliable surrogate model 3 4 adaptive surrogate based multi objective optimization the multi objective optimization seeks a compromise solution from a set of pareto solutions that represent the tradeoffs among different objectives we employed the adaptive surrogate based optimization framework presented in wang et al 2014 for multi objective optimization of the most sensitive parameters and used the lptau sampling mars surrogate modeling and sce ua optimization methods for corresponding processes the entire adaptive surrogate based multi objective optimization procedure is as follows 1 objective function transformation to make the two objective functions of streamflow discharge comparable in variability range and direction we took the transformations f 1 x rb and f 2 x 1 n s e and expressed the multi objective optimization problem as 1 min y min f x min f 1 x f 2 x min rb 1 n s e the two objective functions were then transformed into a euclidian distance function following madsen 2000 2 f agg x j 1 2 f j x a j 2 where f j x is the j th objective function and a j is the transformation constant to make f j x a j have the same distance to the origin a j can be determined through lptau experiments inherited from surrogate based quantitative sensitivity analysis by 3 a j max f 1 min f 2 min f j min j 1 2 if f 1 min f 2 min a 1 0 and a 2 f 1 min f 2 min or else a 1 f 2 min f 1 min and a 2 0 2 surrogate model reconstruction to improve the optimization search efficiency mars was reconstructed to approximate the relationship between the sensitive parameters and the aggregated objective function f agg using the parameter response pairs of the simulation model i e crest we took the lptau experiments inherited from surrogate based quantitative sensitivity analysis as the initial samples to construct a globally accurate surrogate model which can provide reliable information for promising regions of the global optimum in the parameter space it is unlikely however that the surrogate would be sufficiently accurate in the region of the optimum a succession of infill samples at the predicted optimum were therefore added to enhance the accuracy of the surrogate in the promising region to find the optimum efficiently 3 surrogate based optimization we employed the global optimization method shuffled complex evolution sce ua duan et al 1992 to search the minimum f agg value and corresponding optimal parameter set of the surrogate model for effectiveness and efficiency the sce ua method must properly specify a few algorithmic parameters in particular the number of complexes p is primarily determined by the dimensionality of the calibration problem i e the number of model parameters to be optimized and a value equal to two or larger is sufficient for a six dimension problem duan et al 1994 we set p to four since the dimensionality of our calibration problem would be smaller than twelve after the parameter reduction other algorithmic parameters and the stop criteria were assigned to the default values as suggested by duan et al 1994 4 simulation model evaluation and stop criteria check the simulation model crest was run using the optimal parameter set of the surrogate model to find the corresponding f agg value the optimal parameter set and corresponding f agg value were used to update the parameter response pairs and steps 2 4 were continued until the f agg value of the simulation model converged to a constant 4 results and discussion 4 1 lh oat based parameter screening the range for each of the 12 crest parameters was evenly divided into 20 levels thus 260 20 12 1 lh oat samples were generated from the 12 dimensional parameter space fig 3 shows the relative parameter sensitivities to overall effects and interaction effects of the ten watersheds for two objective functions rb and nse parameter rankings varied among watersheds as well as among objective functions even for the same sensitivity index however certain dominant patterns were evident overall p2 p3 p4 and p5 can be regarded as insensitive parameters while the other eight parameters can be classified as sensitive all the insensitive parameters are physically based and related to specific subprocesses of runoff generation and routing while the sensitive parameters are conceptually based and related to a collection of aggregated hydrological processes madsen 2003 wagener et al 2003 the former can be determined from the physical characteristics of watersheds while the latter cannot madsen 2003 the two objective functions find similar parameter sensitivities across watersheds with a few exceptions the most obvious difference is that in watershed w4 rb identifies p1 with a low overall effect top row of fig 3a while nse identifies it with a high overall effect top row of fig 3b another distinct difference is that in watershed w8 rb identifies p11 with a high interaction effect bottom row of fig 3a while nse identifies it with a low interaction effect bottom row of fig 3b this variance of parameter sensitivities between objective functions was also found in several previous studies tang et al 2007 van werkhoven et al 2008 gan et al 2015 since different objective functions measure different aspects of model behaviors the number of sensitive parameters per watershed varies from two w9 and w10 to eight w1 for rb and from two w9 and w10 to seven w1 for nse these sensitive parameters may be explained by characteristics of the specific watersheds for example watersheds w9 and w10 have very similar hydroclimatic soil and vegetation conditions and both are sensitive only to p7 and p8 which influence the overland flow velocity in these sparsely vegetated small semi arid watersheds infiltration excess overland flow contributes most to the total runoff variation of overland flow velocity leads to alterations in the timing of runoff delivery from slopes to streams holden et al 2008 meanwhile humid watershed w7 is also sensitive to p7 and or p8 because saturation excess overland flow constitutes a major part of the total runoff watersheds w1 w2 and w3 have similar hydroclimatic conditions and are sensitive to p1 p6 p8 p10 and p12 the first three parameters reflect the influence of vegetation type resulting in different throughfall evapotranspiration and overland flow velocity respectively the latter two parameters reflect the influence of soil texture and control the flow speed and discharge of interflow respectively for humid watersheds w1 w2 w3 w5 w6 and w8 p10 and p12 show strong overall effects suggesting the importance of interflow and p9 yields a significant sensitivity indicating the importance of channel flow in some cases a parameter with a low overall effect e g p7 in watershed w4 for rb may have a significant interaction effect and thus should also be regarded as a sensitive parameter gan et al 2014 4 2 construction and validation of mars model four parameters p2 p3 p4 and p5 identified as insensitive by lh oat screening were set to their default values as shown in table 2 and the other eight parameters that govern the hydrological response of crest were selected for further analysis we designed five sets of lptau samples equally spaced between 200 and 1000 with an increment of 200 to investigate the effect of training sample size on the performance of mars in approximating crest fig 4 shows that mars s performance is substantially affected by the training sample size it can well approximate crest at a low sample size for most of the watersheds for example the r2 values are greater than 0 80 for all watersheds except w4 w6 and w8 when the sample size equals to 200 the surrogate model trained with more samples tended to perform better but had higher computational cost although the ranges of r2 values varied across watersheds and objective functions the overall performance of mars with 1000 samples was sufficient in all cases indicating that the surrogate model mimics the performance of crest fairly well the r2 values with 1000 training samples range from 0 884 to 0 997 which are close to those reported in previous studies obtained by support vector machine and artificial neural network johnson and rogers 2000 zhang et al 2009b we then used the mars trained with 1000 samples as a pseudo simulator of crest to ensure that it is globally accurate not only for sensitivity analysis but also for providing reliable information for the promising regions of the global optimum for the purpose of efficient sensitivity analysis mars trained with a small sample size e g 200 can even be used for most of the watersheds moreover other efficient methods such as the gaussian process based probability sensitivity analysis oakley and o hagan 2004 daneshkhah and bedford 2013 could also be considered however the surrogate model trained with much less samples for surrogate based sensitivity analysis may easily miss the global optimum when it is reused for surrogate based optimization razavi et al 2012 the efficiency of the surrogate model could be better improved by comparing different surrogate modeling methods and sampling methods against the research purpose gan et al 2014 wang et al 2014 4 3 mars based sobol sensitivity indices the eight parameters p1 p6 p7 p8 p9 p10 p11 and p12 that play important roles in explaining the uncertainty of streamflow simulation were tested for their sensitivities using the pseudo simulator we designed 100 000 lptau samples to estimate sobol sensitivity indices for each objective function in each watershed fig 5 presents sobol first order and total sensitivity indices of ten watersheds for rb and nse of streamflow discharge the residual between sobol total and first order sensitivity indices represents the interaction of a specific parameter with other parameters at all orders parameter sensitivities vary across objective functions and watersheds and are mainly dominated by interactions the significant parameter interactions indicate that crest may be overparameterized or its model structures are incorrect bastidas et al 2006 saltelli et al 2008 rosero et al 2010 in addition all watersheds exhibit higher parameter interaction for nse than for rb suggesting that the functional relationship is more complex for the former than for the latter it should be noted that the surrogate based sensitivity indices especially the interactions we obtained may differ from the true indices that would have been obtained had we been able to carry out the sensitivity analysis on the simulation model o hagan 2006 the gaussian process based probability sensitivity analysis method provides us a way of presenting variance based sensitivity indices with uncertainty ranges at low computational cost oakley and o hagan 2004 daneshkhah and bedford 2013 this method is especially attractive when the simulation model is computationally expensive and its response surface is smooth the uncertainty ranges of the sensitivity indices decrease as more samples are used to approximate corresponding sensitivity indices daneshkhah and bedford 2013 although no uncertainty ranges are given here along with the mars based sobol sensitivity indices the sensitivity categories based on the total sensitivity indices should be reliable since the accuracy of the surrogate model has validated to be acceptable shahsavani and grimvall 2011 in general all parameters are sensitive in at least one watershed except that parameter p11 overland reservoir discharge parameter is insensitive in all watersheds for all objective functions in most watersheds the most sensitive parameters are p6 multiplier on potential evapotranspiration p8 overland flow velocity exponent and p12 interflow reservoir discharge parameter for rb and p1 multiplier on the precipitation field p6 and p12 for nse p1 and p6 are the major driving parameters in runoff generation and thus are expected to be highly sensitive the high sensitivity of p12 indicates the important role of interflow to the total runoff in crest meanwhile the low p11 sensitivity and the high p8 sensitivity suggest that the velocity of overland flow influences the streamflow situation more than its amount 4 4 adaptive mars based multi objective optimization 4 4 1 feasibility of calibration we systemically checked the feasibility of calibration to determine whether the actual observations could be captured by the ensemble ranges of the 1000 lptau experiments hou et al 2012 huang et al 2013 which were inherited from the surrogate based quantitative sensitivity analysis and would be used to construct surrogate models for adaptive surrogate based optimization fig 6 depicts boxplots of mean daily streamflow discharge for the ensemble experiments in ten watersheds the boxplots present the streamflow simulation uncertainties by five number summaries i e the minimum first quartile 25 median 50 third quartile 75 and the maximum of the ensemble experiments generally the control experiment underestimates discharges particularly for the summer months whereas the ensemble ranges contain the observations the result suggests that the parameter space is adequately represented by the samples of model parameters with reasonable physical bounds it also indicates the necessity and possibility of calibrating parameters using observations 4 4 2 model calibration seven sensitive parameters p1 p6 p7 p8 p9 p10 and p12 were selected as the calibration parameters while other insensitive parameters were set to their default values the 1000 lptau experiments used in constructing mars for quantitative sensitivity analysis were taken to obtain the transformation constants a 1 and a 2 for rb and 1 nse respectively the parameter response pairs of these experiments were used to reconstruct mars to approximate crest for searching for the optimal solution the newly found optimal parameter response pair was appended to the parameter response pool to adaptively update mars this adaptive surrogate based optimization procedure was continued until the best compromise solution was found sample sizes needed to find such solutions for watersheds w1 to w10 were 240 310 340 280 265 289 210 236 198 and 180 respectively fig 7 presents the searching route in the objective function space across different watersheds including the initial intermediate and final optimal solutions a significant tradeoff between rb and 1 nse is observed in all watersheds except watershed w10 indicating that a parameter set that gives small percentage volume bias results in a poor hydrograph shape and vice versa this result is in line with the findings of madsen 2003 and bekele and nicklow 2007 who have conducted automatic calibration of hydrological models involving multiple objectives the significant tradeoff between different criteria may be due to unresolved errors in the model structure fenicia et al 2007 pokhrel et al 2008 and or measurement errors in the model data the relatively nonobvious tradeoff between rb and 1 nse for watershed w10 means both percentage volume bias and hydrograph shape can be improved simultaneously the absence of significant tradeoff indicates that the model structure is generally well conceptualized and the most relevant hydrological processes are taken into consideration for this watershed schoups et al 2005 the disassociation of the final optimal solutions from clusters of the intermediate solutions for w1 w7 and w9 indicates that the response surfaces for these watersheds are pretty rough and the adaptive mars based sce ua successfully found the global optimal solutions but spent many experiments on the local optimum regions the final optimal solutions which compromise the pareto outcomes perform significantly better than those of the initial solutions reducing 1 nse by 5 50 and rb by 20 95 fig 8 shows variations in the parameter sets which have been normalized to the feasible bounds in table 2 so that all range from 0 to 1 the parametric uncertainties have been significantly reduced by the adaptive surrogate based multi objective optimization in particular in watersheds w6 and w8 most parameters have variation ranges smaller than 30 so they were very precisely determined on the other hand in watersheds w1 and w5 most parameters have larger variability ranges and indistinct trends so parameter sets with high variability could give equally good simulations some parameters show obvious trends when moving along the searching route of the optimal solutions for example p1 values are small in watershed w3 but large in watersheds w6 and w8 whereas p6 values are large in watershed w3 but small in watersheds w6 and w8 this is because increases in p1 result in increased precipitation and thus greater streamflow discharge while increases in p6 result in increased evapotranspiration and thus smaller streamflow discharge that is larger p1 and smaller p6 lead to larger streamflow discharge which is consistent with the observation that the peak flows are much higher in watersheds w6 and w8 than in watershed w3 during the calibration period fig 9 compares simulated and observed streamflow discharge at different watershed outlets the uncertainty intervals show that crest produces a range of simulated hydrographs corresponding to the equally good parameter sets along the pareto front the final optimal solutions not only closely reproduce the timing and magnitude of the peak flows but also well represent the shape of the recession curves the simulation results of the default solutions tend to underestimate streamflow by about 70 100 in all watersheds while the optimal solutions show significant improvement reducing 1 nse by 65 90 and rb by 60 95 for watersheds w3 w6 and w8 where streamflow data contain many extended periods of low flow values or extreme high peaks it is relatively more difficult to obtain a reliable calibration the relatively poor ability for the model to simulate the recession curve e g watersheds w1 w6 and w8 indicates that the groundwater module could be better improved the tendency for the model to underestimate spring peaks e g watersheds w1 w2 and w3 could be attributed to the lack of a snowmelt module in crest it should also be noted that human activities such as reservoir regulation and water diversion can affect the observed streamflow discharge which inevitably lead to disagreement between simulated and observed streamflow 4 4 3 model validation we validated the calibrated model for streamflow simulation outside the calibration period fig 10 presents the validation results for streamflow simulations over the ten watersheds the calibrated model simulation showed a large improvement over the default simulation reducing 1 nse by 40 85 and rb by 35 90 although some performance indices remain unsatisfactory since the parameters were calibrated to simulate intense flood events the model performance decreases during the validation period when rainfall rates are lower and vice versa moussa et al 2007 zhang et al 2009a for example the calibration period for the watershed w3 is characterized by three dry years which causes low peak flows less than 150 m3 s while the validation period is characterized by high rainfall rates during the year 2012 which causes high peak flows more than 3000 m3 s in addition the relatively short duration three years of the observational data used in calibration could also lead to unsatisfactory validation results sorooshian and gupta 1995 muleta and nicklow 2005 furthermore the model limitations in representing the spatial heterogeneity of watershed may cause unstable model performance bekele and nicklow 2007 5 summary and conclusions we presented an uncertainty quantification framework that combines the strengths of stepwise sensitivity analysis and adaptive surrogate based multi objective optimization to facilitate practical assessment and reduction of model parametric uncertainties the framework was tested over ten watersheds using the distributed hydrological model crest for daily streamflow simulation during the period 2008 2010 this generated optimal sets of sensitive parameters which were used to improve crest with validation against the daily streamflow simulation during the period 2011 2012 parameter sensitivities vary across watersheds and objective functions but clearly demonstrate dominant patterns of the twelve parameters tested we identified four that had little effect on streamflow simulation in any watershed they were physically based and determined by the physical mechanisms of runoff generation and routing processes and thus the physical characteristics of the watersheds the remaining eight parameters were all conceptually based and related to aggregated hydrological processes and thus generally cannot be determined from the physical characteristics of the watersheds but need to be calibrated madsen 2003 of these we identified that the contribution of the overland reservoir discharge parameter to the response variances is also negligible indicating that more accurate quantitative evaluation of parameter sensitivities is needed after a qualitative parameter screening generally the stepwise sensitivity analysis efficiently reduced the number of parameters needing calibration from twelve to seven and thus constrained the dimensionality of calibration problem and enhanced the efficiency of parameter calibration the calibration exercise satisfactorily reproduced observed streamflow for all watersheds the optimal solutions significantly improved streamflow simulation over the default reducing 1 nse by 65 90 and rb by 60 95 the validation exercise also indicated a large improvement of the optimal simulation over the default reducing 1 nse by 40 85 and rb by 35 90 although some performance indices were still not satisfactory as noted in other distributed hydrological models muleta and nicklow 2005 zhang et al 2009a sun et al 2017 even after calibration there are potentially large uncertainties because no simulation model is capable of representing all physical processes and observational data are likely incomplete additionally the optimal parameter sets are realistic only for the same watershed under similar meteorological conditions a comprehensive evaluation is necessary to transfer the optimal parameter sets from one watershed to another with similar watershed properties and hydroclimatic conditions zhang et al 2009a kumar et al 2013 gan et al 2015 or even to the same watershed with greatly different meteorological conditions overall our uncertainty quantification framework is effective for multi watershed multi objective parametric uncertainty quantification and provides useful information to understand the model behaviors and improve the model simulations the framework designs various simulation experiments to reduce parameter dimensionality and thus is well suited for calibrating high dimensionality problems requiring systematic quantification of parametric uncertainties the qualitative or even quantitative sensitivity analysis could be discarded for the calibration of low dimensionality problems we considered only streamflow simulation due to the lack of observational data for other variables in addition the duration of the observed streamflow data is relatively short the capability of this framework as well as the behavior of crest could be more effectively tested with more observational data for multiple variables in multiple watersheds further improvements of the framework and its application to some of the more sophisticated models such as the conjunctive surface subsurface process cssp choi et al 2013 and noah multiparameterization noah mp niu et al 2011 land surface models are still ongoing the results of these works will be reported in due course acknowledgments this research was supported by the national natural science foundation of china 41505092 national key research and development program of china 2017yfc1404000 open research fund of the state key laboratory of severe weather 2015lasw a05 and national natural science foundation of china 41605073 liang was partially supported by the beijige open research fund of the nanjing meteorological joint research center njcar2016zd03 we thank jennifer a kennedy for her careful revision of the manuscript we thank the editors and three anonymous reviewers for their insightful comments and suggestions that helped improve the manuscript the forcing data and hydrography data can be accessed through the links given in the text the observed streamflow discharge data are available upon request by contacting the first author appendix a objective functions relative bias rb and nash sutcliffe efficiency nse are defined as follows to measure the overall water balance and the overall shape of the hydrograph respectively a1 rb 1 n i 1 n s i o i o a2 nse 1 i 1 n o i s i 2 i 1 n o i o 2 where s i and o i are simulated and observed values at time i respectively o is the mean of observations and n is the total number of observations or simulations rb ranges from minus infinity to plus infinity with lower absolute value indicating better agreement while nse ranges from minus infinity to 1 0 with higher value indicating better agreement appendix b k fold cross validation measure the k fold cross validation measure used in this study is the coefficient of determination r2 which is calculated as b1 r 2 1 k p 1 k j 1 n k y p j y y p j y j 1 n k y p j y 2 j 1 n k y p j y 2 2 where y p j and y p j are the predicted and actual response values of the jth sample point of the pth subset respectively y and y are mean values of y p j and y p j respectively 
7094,multiple optima seriously confine the solution accuracy of stochastic dynamic programming sdp for non concave maximization models of reservoir operation to address the problem a two stage optimization algorithm combining traversing and search is proposed to obtain an optimal decision at each state combination single or multiple promising regions where a local optimal solution may exist are identified through coarse traversing in the whole feasible region and a local search algorithm is used to local optimization in each promising region energy maximization model is used to analyze the multiple optima problem and test the method in the model quadratic and concave penalty functions are used to address the total power constraint for smaller shortages and fewer shortage periods respectively the total power constraint increases the probability of multiple local optima existence and intensifies the difficulty in finding optimal decisions the proposed model and method are applied to the cascaded reservoir system on middle lower lancang river in china numerical results show that the total power constraint is well addressed the computing time can be reduced by more than 50 using the two stage algorithm in getting operating rules with similar performance comparing to only traversing and the multi point search algorithm is superior to traversing and single point search in solving the proposed model keywords cascaded reservoir operating rule sdp global optimization 1 introduction stochastic dynamic programming loucks et al 1981 is one of the most popular methods for reservoir operations sdp can explicitly consider stream flow uncertainty in its recursive equation by solving the dynamic programming dp recursive relations adapted to stochastic problems particularly markov decision processes and derive operating policies for different reservoir system states sdp solutions have more computational demands than deterministic dp bai et al 2015 as computation grows with the number of states decisions and inflow scenario of reservoirs some amended or simplified methods to alleviate dimension problem were studied such as the aggregation disaggregation approaches turgeon and charbonneau 1998 archibald et al 1997 sampling sdp ssdp kelman et al 1990 faber and stedinger 2001 and stochastic dual dynamic programming sddp pereira and pinto 1985 pereira 1989 marques and tilmant 2013 macian sorribes et al 2017 yeh 1985 and labadie 2004 reviewed state of the art of mathematical models for reservoir operations although many improvements have been made to sdp it is still hard for sdp to solve large scale reservoir operation problems other approaches for reservoir operations include operating rule development applying deterministic optimization lund and ferreira 1996 simulation based optimization approaches koutsoyiannis and economou 2003 chang et al 2010 liu et al 2014 giuliani et al 2016 optimal reservoir trajectory turgeon 2007 wang 2010 and reinforcement learning busoniu et al 2010 castelletti et al 2010 profit maximization discounted weiner and ben zvi 1982 or undiscounted stedinger et al 1984 tejada guibert et al 1993 1995 is a common objective for reservoir systems some constraints can be easily addressed in sdp except the soft constraints such as lower bounds on reservoir release or power generation reliability or chance constrained model is a way to address the soft constraints askew 1974 proposed a chance constrained dynamic programing ccdp in which the iterative search of a penalty for failure and a precise evaluation of system response were used within the dynamic program rossman 1977 presented an sdp model for determining reservoir release rules subjected to reliability constraints on system performance within the framework of lagrangian duality theory sniedovich 1979 developed a dynamic programing solution for a class of reliability constrained reservoir control problems with constraints defined over the entire life of the reservoir another way to deal with soft constraints is the penalty based methods stedinger et al 1984 used quadratic penalty functions for monthly losses due to failure to meet flood control irrigation and power generation targets of a single reservoir in sdp model using best inflow forecasting as a hydrologic state variable tejada guibert et al 1993 1995 used linear penalty function for water shortage and system power shortage in sdp models deriving multireservoir operating policies in hydropower reservoir operation models the lower bound on reservoir release is a linear constraint and affects the solution slightly while the total power constraint on a cascaded system with two or more reservoirs may lead to non convex feasible regions even multiple local optima and make the model much more difficult to solve a common solution approach for sdp is to test all the discretized decision points and find the best among them at each state which is called traversing in this paper the method does not require gradient evaluation and is robust but slow piccardi and soncini sessa 1991 and zhang et al 2015 used parallel computation to improve solving efficiency of multi dimensional dp for objective functions with continuous second derivatives more efficient methods such as quasi newton can be applied tejada guibert et al 1993 foufoula georgiou 1991 addressed interpolating nodal values and derivatives of a one dimensional convex function with a convex interpolant so that potential computational difficulties from approximation induced nonconvexity are avoided and an efficient convergence to global instead of local optimal controls is guaranteed at each single stage optimization johnson et al 1993 demonstrated that the computational effort required to develop numerical solutions to continuous state dynamic programs can be reduced significantly when cubic piecewise polynomial functions rather than tensor product linear interpolants are used to approximate the value function for problems with concave objective functions zhao et al 2012 derived a monotonic relationship between reservoir storage and optimal release decision under both deterministic and stochastic conditions and proposes an algorithm to improve the computational efficiency of both deterministic dp and sdp for reservoir operation the algorithm is used to solve water supply model using objective of minimization of period accumulated squares of the ratios of water shortage to water demand although formulating the reservoir operations as continues or even concave models can significantly reduce solution time and applicable for large scale reservoir systems the state and decision discretizing based methods are still widely used for it has no confines on objective functions and feasible regions and need no approximation of the models as long as the system scales are within the limits of solvable dimensionality the state and decision discretizing based methods can be used to most of long term reservoir operations most existing solution methods are coarse global optimization or local optimization assuming only one optimum for each system state some researchers notice that there are near optimal reservoir storage trajectories in dp models liu et al 2011 examined the near shortest paths method the genetic algorithm and the markov chain monte carlo mcmc method to explore multiple near optimal solutions to reservoir operation problems the literature show that even only the constraints of bounds on single reservoir storage and release are used there are still possible multiple near optimal solutions for the energy maximization model and the methods more complex than standard dp or sdp are necessary to get near optimal solutions rougé and tilmant 2016 explored the consequences of and proposes a solution to the existence of multiple near optimal solutions when using sddp for mid or long term river basin management that there can be multiple local optima at a single state for non concave maximization models may seriously confines the solution accuracy and causes unreasonable decisions the multiple local optima problem was seldom emphasized in existing sdp models when deriving operating rules possibly because that standard discretized dp is a global optimization method and is seldom restricted by objective function and feasible region characters of the reservoir operation models while whether explicitly consider the multiple local optima problem or not in solving algorithms may affect the solution efficiency and quality and this brings the demand of a new way to improve solution methods cascaded hydropower reservoir operations must consider both water volume and water head for economic value maximization lund and guzman 1999 power system demands can be formulated as constraints on power of single reservoirs or cascaded systems this paper concerns the sdp model for energy maximization of cascaded reservoir operation in which the total power constraints intensified the non concave characteristic and multiple local optima problem both quadratic and concave penalty functions are used to address the total power constraints to improve solution accuracy a two stage solution algorithm combining traversing and search is proposed for quasi global optimization starting from traversing over the feasible region one or multiple promising points near local optima are identified then a local search algorithm is used to obtain local optimizations near the points the proposed methods are applied to cascaded reservoir system on middle lower lancang river operating rule surfaces and simulation results are obtained and compared for both kinds of penalty functions and for different algorithms including traversing and two stage algorithms of single point search and multiple point search 2 deterministic energy maximization model for cascaded reservoirs a real world reservoir operation can be very complex it has to meet various demands without violating the constraints of the system with the system wide total power constraints deterministic energy maximization model in a finite time horizon is formulated as follows 1 objective function max e t 1 t m 1 m p m t δ t constraints 2 water balance s m t 1 s m t 3600 δ t i m t i 1 u m r u m i t r m t 3 r m t q m t d m t relationship among reservoir storage turbine flow and power generation 4 p m t η m q m t z m s m t z m s m t 1 2 z d m 5 initial and ending storage s m 1 s i m 6 s m t 1 s e m 7 storage bounds s m t s m t s m t 8 maximum power and turbine flow p m t p m t 9 q m t q m t 10 minimum total power p m 1 m p m t 11 minimum reservoir release r m t r m t where e is the objective of energy generation in operating horizon m t are sequence number of reservoirs and periods respectively 1 m m and 1 t t m is the number of reservoirs t is the number of periods in operating horizon p m t p m t are the power generation and its upper bound of reservoir m in period t δ t is the hour number in period t η m is power generation coefficient of reservoir m q m t q m t are the rate of turbine flow and its upper bound of reservoir m in period t s m t s m t s m t are the storage and its lower and upper bounds of reservoir m in period t z m s m t is the reservoir level of reservoir m in period t a function of s m t z d m is the average downstream level of reservoir m i m t is the rate of local inflow of reservoir m in period t u m is the number of immediate upper stream reservoirs of reservoir m and u m i is the sequence number of the ith immediate upper stream reservoir r m t r m t are the rates of release flow and its lower constraint of reservoir m in period t d m t is the rate of spill flow of reservoir m in period t in long term operation constraint of its upper bound can be omitted s i m s e m are the initial and ending storage setting for reservoir m p is the minimum total power and is often set for power system demands in most cases z m s m t can be fitted using polynomial functions for some reservoirs with almost no storage capacity and nearly fixed water head madani et al 2014 the degree of polynomial is 0 and e is a linear function of q m t according to eqs 1 4 when the degree of polynomial is 1 z m s m t is linear and e is a quadratic function of q m t for many reservoirs the degrees of polynomial are integer number no less than 2 and e is non concave function of q m t moreover the feasible region considering total power constraint of eq 10 may be a non convex set taking a two reservoir problem at one no spill stage as an example temporarily supposing linear reservoir level storage curves as z m s m t a m s m t b m here the upstream reservoir is numbered 1 and the downstream reservoir is numbered 2 so the constraint of eq 10 can be formulated as eq 12 12 p η 1 q 1 t a 1 s 1 t b 1 a 1 s 1 t 3600 δ t i 1 t q 1 t b 1 2 z d 1 η 2 q 2 t a 2 s 2 t b 2 a 2 s 2 t 3600 δ t i 2 t q 1 t q 2 t b 2 2 z d 2 replacing q 1 t as x and q 2 t as y in eq 12 the boundary of feasible region is α x 2 β y 2 β x y γ x λ y 0 x 0 y 0 here α η 1 a 1 3600 δ t 2 β η 2 a 2 3600 δ t 2 γ η 1 a 1 s 1 t b 1 a 1 s 1 t 3600 δ t i 1 t b 1 2 z d 1 and λ η 2 a 2 s 2 t b 2 a 2 s 2 t 3600 δ t i 2 t b 2 2 z d 2 relationship of eq 13 can be obtained through deriving the second derivative of eq 12 13 2 β y β x λ 2 α d 2 y d x 2 β α dy dx 1 2 β α 2 1 β 4 α the condition of the feasible region is non convex is d 2 y d x 2 0 and it can be satisfied in many circumstances for example where the product of generation coefficient and reservoir level storage incremental rate of the downstream reservoir is less than 4 times of that of the upstream reservoir then β 4 α 1 and the right side of eq 13 is always positive for α 0 the non convex feasible region condition is 2 β q 2 t β q 1 t λ 0 the condition may be satisfied when the optimal decision is in the region where q 1 t is greater than 2 times of q 2 t given small λ value that often happens at dry season when the storage rate of the upstream reservoir is much more than the downstream reservoir local solutions exist in both regions of a and b in fig 1 given a non convex feasible region even for a concave objective function the nonlinear z m s m t can cause much more complex feasible region and either the z m s m t is formulated as piecewise linear or high degree polynomial curve the non convex feasible regions cannot be avoided so even the deterministic model may have multiple optima due to the non convex feasible region caused by total power constraints and can be intensified by non concave objective function 3 sdp model with soft constraints for cascaded reservoirs 3 1 formulation in order to derive operating rules for cascaded reservoirs considering uncertain inflow infinite horizon sdp models are often used to obtained rule tables to interpolate releases from reservoir states the recursive function of sdp model for expected benefit maximization is eq 14 and the constraints in the deterministic model except initial and ending storage remain for each inflow scenario common state variables include reservoir storage previous inflow and inflow forecasts stedinger et al 1984 kim and palmer 1997 in this paper the reservoir storage is set to be state variables for easier comparison between different solution algorithms and the conclusions can be extended to models with more state variables such as pre inflow or inflow forecasting with eq 14 the state transition function is same to eq 2 under each inflow scenarios 14 f t s k t max f s k t t r k t max r k t n 1 n pr q n t b t r k t q n t s k t f t 1 s t 1 r k t q n t s k t where f t and f t 1 are the objective of period t and t 1 or future value function at the beginning of period t and t 1 respectively s k t is the state variable kth vector of discretized storages of reservoirs r k t is the decision variable vector of reservoir releases at kth state f s k t t r k t is the objective function of r k t at period t given state s k t b t is the benefit function at period t n is the number of combinations of discretized reservoir local inflows q n t is the vector of nth discretized local inflow of reservoirs and pr q n t is the probability of it s t 1 is the ending storage vector at period t a function of the initial state decision and inflow due to uncertain inflows the constraints on total power cannot be satisfied at all states under all inflows so the constraint of minimum total power in the deterministic model eq 10 becomes a soft constraint and p is often called the firm power in stochastic operation models denoted as p f the firm power and minimum release constraints are addressed using penalty functions in this paper for the benefit lost from firm power failure is not accurately evaluated the penalty function forms depend on willingness to accept different forms of shortage continuous smaller shortage or a shorter period of greater shortage this willingness can be decided by operators or managers knowing relations between shortage and system benefit or social aversion rossman 1977 to shortage the penalty augmented benefit function is formulated as eq 15 15 b t r k t q n t s k t e t r k t q n t s k t g 1 t r k t q n t s k t g 2 t r k t q n t s k t in eq 15 e t is the energy generation at period t given storage and inflow vectors of s k t and q n t following release decision of r k t g 1 t is the penalty function for firm power shortage g 2 t is the penalty function for minimum release shortage for non power requirements shawwash et al 2000 or social well beings chang and wang 2013 the penalty terms are formulated as eqs 16 and 17 16 g 1 t r k t q n t s k t σ max p f δ t m 1 m p m t δ t 0 μ 17 g 2 t r k t q n t s k t m 1 m θ max 3600 δ t r m t r m t 0 2 in eqs 16 and 17 σ 0 θ 0 μ 0 are coefficients when μ 2 eq 16 is a quadratic function and when μ 1 eq 16 is a concave function if the system is expected to be operated for smaller extreme shortage of firm power meaning that the unavoidable power shortages are allocated to several periods to make the largest single period shortage as small as possible the quadratic function is used if the system is expected to be operated for fewer shortage periods the constraint of firm power can be replaced by a constraint of failing chance the demand can be formulated as the explicit chance constraint of eq 18 18 pr m 1 m p m t p f c where c is the chance constraint on firm power under this circumstance an extreme minimum power constraint are needed to control the shortage extent so there are two levels of total power constraints firm power for normal periods and the extreme minimum power for extreme dry periods the chance constrained model can be solved using reliability constrained dp rossman 1977 and also can be approximately addressed using a concave penalty function for firm power failure with exponent less than 1 in eq 16 the extreme minimum power constraint can be addressed using a similar quadratic penalty function for firm power the sdp recursive function is the same as eq 14 using the benefit function of eq 19 19 b t r k t q n t s k t e t r k t q n t s k t g 1 t r k t q n t s k t g 2 t r k t q n t s k t g 3 t r k t q n t s k t where g 3 t is the penalty function for the extreme minimum power constraint and is formulated as eq 20 and σ in g 1 is changed to a value between 0 and 1 in eq 20 φ 0 is a coefficient p e is the constrained value of the extreme minimum power p e p f 20 g 3 t r k t q n t s k t φ max p e δ t m 1 m p m t δ t 0 2 the concave penalty function tends to obtain results with fewer shortage periods comparing to the quadratic penalty function while the extreme shortage can be larger the quadratic penalty on extreme minimum power is used to confine the extreme shortage after addressing the constraints using penalty terms in objective function the constraints remain at each state are only the upper bounds of turbine flows and the feasible region of release is 0 q m t for each reservoirs the non concave characteristic of the model is intensified using penalty functions for the energy generation is linear function of period power generation while the penalty terms are power functions of period generation 3 2 multiple local optima problem of sdp for cascaded reservoir operations eq 14 defines a recursive computation of periodic markov processes in an infinite horizon of which one cycle corresponds to a year and each period is defined as one month su and deininger 1972 show that the model converges to a steady release policy that maximizes the system s average annual benefit over an infinite horizon the sdp solution needs to obtain optimal decision at each state from the last period t to the first period 1 backward in a year this process is repeated iteratively until decisions converge at all periods and all states at the beginning of each iteration the future value function for period t is replaced by that of period 1 of the last iteration the remaining problem is how to solve the sub optimization models for optimal decisions at each state to maximize objective function of f s k t t r k t a traditional solution method for the sub optimization is to simply traverse discretized decision combinations of reservoirs in the feasible region the traversing method is a global optimization method because discretized decisions distributed in whole feasible region are tested but the solution accuracy and computation effort depends on how dense the decisions are discretized for the sub optimization models besides the reasons of non concave objective function and non convex unpunished region similar to those for the deterministic model another aspect that may enhance non concavity and even intensify multiple optima is the summation of piecewise functions due to different inflow scenario as the example shown by fig 2 for one reservoir r 1 r 2 and r 3 are the release values that can emptying the reservoir for inflow scenarios 1 2 and 3 respectively the objective functions for scenario 1 and 2 are concave where r is less than r 1 and r 2 and are non concave in region of 0 r 3 due to value unchanged regions of r 1 r 3 and r 2 r 3 the average value function is also non concave fig 2 a and may have multiple optima fig 2 b even the objective function f s 1 t t r 1 t is not concave the sdp model for energy maximization of a single reservoir has only one local optimum in most cases the f s 1 t t r 1 t curves may have segments where the function value does not change with decision when the ending storage reaches its bounds this will not cause serious problems in solving but confines the solving algorithm of steepest ascent from any point although the following presented analysis and methods are suitable for larger scale problems a two reservoir problem is used to describe the details for simplification at some storage combinations even the decision for a reservoir has a single local optimum given the other reservoir s decision the decision combination may still have more than one local optima an example surface of f s t k t r t k is shown as fig 3 for unconstrained model and models with firm power constraint addressed using quadratic and concave penalty functions for low storages of two cascaded reservoirs at the second last period t 1 in the first round of yearly backward recursion for the unconstrained model the f s t k t r t k surfaces can have more than one near concave areas but the optimum can hardly be missed and the solution is often easy for the model with a total firm power constraint addressed using the quadratic penalty function peak value surface of fig 3 b demonstrates that there are two local optima at the two peak areas and the two peak areas are separated by a gap caused by the crossing of two sub surfaces the small gap can affect the solution because the peaks may be missed in traversing and the local search cannot move from one side of the gap to the other if the peak area on the right side is missed in traversing while the left side peak area is caught the optimal solution can be considered to be on the left side even further search is executed from the optimal point identified the real global optimum in right side can still be missed for the concave penalty function fig 3 c case there are three local optima and the global optimum is easier to be missed than the quadratic penalty function a straightforward performance of the missing global optima is that there are some unreasonable protrusions and sunken points in the resulting rule surfaces with the backward recursion of sdp the shape and space distribution of local optimal points are changed and more complex if the solving accuracy is low many poor solutions may be obtained for the multiple optima model a poor solution will affect not only the current period decision but also the future values of backward periods accumulated error on future values may cause ill derived operating policies and even fail in solution so it is necessary to solve the cascaded reservoir operation models using more effective global optimization algorithms 4 two stage solving algorithm with local search strategy global optimization for multi peak objective functions is an important and hard problem in engineering fields there is not a universal method to obtain global optima for large scale multi peak problems effectively although the dp algorithm has no restriction on the objective function and can solve both concave and non concave maximization problems formulating the reservoir operation as a concave or near concave model is advantageous computationally to find global optima when the problem can hardly be formulated as near concave models finding an local optimum is relatively straightforward using local optimization methods while finding the global optimization is far more difficult analytical methods are frequently unavailable and numerical solutions are often computationally challenging analyzing the solution of traversing it can be noticed that when an optimal solution is obtained better solution can also be expected nearby and can be obtained through local search apparently search the region near the optimal traversed solution using smaller steps will increase the accuracy with less additional computation effort than dense discretization over whole feasible region so the solution algorithm used in this paper at a storage combination includes two steps traversing and search for two cascaded reservoirs the discretized storage point with sequence number of x y is taken as an example in the traversing stage l l evenly discretized points of release decisions in the feasible region are tested and objective function values are obtained let i 1 l j 1 l are the sequence numbers of discretized decision points for reservoir 1 and 2 in the search stage there can be two strategies one is to search only the neighborhood of the optimal solution after traversing called single point search the other is to search all promising regions found based on the results of traversing called multi point search as fig 4 shows for the multi point search the discretized points near which local optima may exist are firstly found as initial search points the initial search points are generated through three ways 1 the region near optimal point in traversing stage is obviously promising and the point can be an initial search point 2 other discretized decision points with objective function values no less than all neighboring points and at least larger than one neighboring point can also be initial search points for point with sequence number i j the neighboring points include points with sequence numbers of i m j n m 1 0 1 and n 1 0 1 and m and n are not 0 at the same time 3 even the points found through 1 and 2 are saved it cannot be ensured that all potential region having local optima are found for the traversing points may not be dense enough to catch all the shape changing of the objective value surface so some important points can also be set as initial search points considering that decision for neighboring discretized storage points may be close to each other in most cases and a local optimum for a storage combination may exist near the solution of neighboring storage combinations the optimal decisions of storage combinations with sequence numbers of x 1 y x y 1 and x 1 y 1 if exist can be initial search points for there are platforms and crest lines on the objective value surface to avoid too much redundant initial search points the set of the initial search points is refined for all initial search points that are neighboring one by one and have a same objective value only one of them is retained for each initial search point a local optimum is found by search the search algorithm is important for it is called for thousands of times in one stage and very little error may lead to an incorrect final solution set the ith initial search point as a 1 i a 2 i the area of the rectangle with vertexes of a 1 i a 1 max l 1 a 2 i a 2 max l 1 is defined as the control area of a 1 i a 2 i setting initial search steps as δ m m 1 2 the search algorithm is to find optimal point in the points of a 1 i j δ 1 a 2 i k δ 2 j 1 0 1 and k 1 0 1 the search is repeated until no better solution is found then set δ m δ m 2 and repeat the search for several times until preset minimum search steps for reservoirs are reached the search algorithm from one promising point is shown in fig 5 the search algorithm can find a neighboring local optimum with very high precision and can obtain solution outside the control area of the initial search point in some cases fig 5 b after the local searches optima near all initial search points have been found and the best of them is set to be the solution in solution the interpolation on f t 1 can be obtained by fitting the surface near point of s 1 t 1 s 2 t 1 to a s 1 t 1 b s 2 t 1 c s 1 t 1 s 2 t 1 d using four points around it although the multidimensional linear interpolation or spline interpolation methods are more often used the 4 variable 4 coefficient function used here can ensure that all points used in fitting obtain the real value on the fitted surface and can fit both concave and convex surfaces with very small error fig 6 shows the computing flow of the algorithm of multi point search and the computing flows of the other two algorithms of only traversing and single point search are similar to it except that the solution at each state are simpler the two stage solution methods consume more computing time than traversing but the complexity and computing effort are not much increased so the extreme solvable reservoir number is close to common sdp 5 case study 5 1 experimental setting the lancang river is an international river known outside china as the mekong river the lancang mekong river is about 4900 km long and flows through china myanmar laos thailand cambodia and vietnam before discharging into the south china sea the hydropower system studied in this paper consists 5 cascaded reservoirs on middle lower lancang river in yunnan province the characteristics of the studied hydropower reservoirs are shown in table 1 the hydropower system has installed capacity of 14820 mw and more than 221 1 0 8 m 3 effective storage capacity making it the important seasonal regulation power resources of its service regions in the service regions there are many other hydropower reservoirs have no long term regulation ability and the energy generation of them in flood season is much larger than in dry season the seasonal regulation of the studied system can avoid further increasing of quantity gap of hydroelectricity between flood season and dry season achieved through the firm power constraints in the operation model to move the flood season energy to dry season storage capacities of xiaowan and nuozhadu reservoirs are much greater than the others of the system so the storage of the other reservoirs can be neglected and their reservoir levels are set near the upper bounds of different months the percentages of extreme power generating head falling to maximum generating head of xiaowan and nuozhadu reservoirs are near 30 and 23 respectively so the long term head variations play an important role in operation monthly inflows data used are from year 1953 to year 2008 the solution algorithms are programmed in the java language the sdp models with 51 discretized storage points are tested local inflows of xiaowan and nuozhadu reservoirs are correlated to each other and 5 local inflow intervals for each reservoir are used to get discretized joint probability distributions at each period local inflows to manwan reservoir and dachaoshan reservoir are supposed to be frequency synchronous to xiaowan reservoir inflows and local inflows to jinghong reservoir are supposed to be frequency synchronous to nuozhadu reservoir inflows the minimum releases of xiaowan nuozhadu and jinghong reservoirs are set as 470 m 3 s 500 m 3 s and 504 m 3 s respectively parameters of the model using quadratic penalty function for firm power failure are p f 6800 mw μ 2 σ 10 2 24 31 2 θ 10 4 24 31 3600 2 10 2 and 10 4 penalty levels are used to reflect priority for different constraints and other constants are used to normalize the hour numbers in different periods parameters of the model using the concave penalty function for firm power failure are p f 6800 mw p e 3000 mw μ 0 9 σ 10 5 24 31 μ φ 10 2 24 31 2 θ 10 4 24 31 3600 2 the models are solved by methods of traversing single point search and multi point search using different numbers of traversing points respectively in search the two dimension search method is used with initial search step as half of the traversing intervals and reduced by half for 8 times 5 2 numerical results fig 7 compares the results of objective function and rule surfaces obtained using quadratic and concave penalty functions for firm power failure multi point search and 21 discretized release decision points in traversing for each reservoir the major difference between the two operating rule sets is the shape in the dry season when the penalty for firm power failure affects the results significantly the rule surfaces using the quadratic penalty function are gradually changed from where the current period firm power demand can be fully satisfied to where failure may happen the gradual changes cause nearly average shortage distribution among several periods if shortage cannot be avoided with a concave penalty function there are rapid changes in both reservoir rule surfaces the rapid changes often mean the switches from satisfying firm power to satisfying extreme minimum power or minimum release in both penalty functions the upstream xiaowan reservoir takes major task of regulation for total power and downstream flow and the downstream nuozhadu reservoir tends to stay high level unless storage of xiaowan reservoir is lower than certain levels in different months in most period of flood season operating rule surfaces are similar using different penalty functions for the constraints on firm power can be fully satisfied and the reservoirs try raise water head and avoid spill fig 8 shows the simulation performances of the rules using quadratic and concave penalties table 2 shows the results using different types of penalty functions and solution algorithms although in different cases the iteration times on time horizon of sdp are different when stable decision obtained the results after 5 times iteration are used here to compare the objective function values in iterations after 5 times the rule surfaces changed very little the computing time is estimated for the computations with different settings are performed in different computers and the time consuming need to be prolonged or reduced according to the computer configurations in order to comparing the operating rule using the quadratic penalty function on firm power failure obtains larger minimum total power and greater failure chance than using the concave penalty the minimum power is confined by p e using concave penalty function on firm power failure and the simulated minimum total power is near p e in both penalty functions the multi point search algorithm obtained the best results while the results obtained using only traversing are the worst evaluated using the average objective values of january or the average future values at the beginning of january the combined traversing and search method can confirm the solving accuracy achieved by only traversing using very dense discretized points even 101 101 decision points are traversed consuming 30 times more time the average objective value still cannot achieve that of the simplest two stage solving method single point search using 11 11 initial decision points using the multi point search algorithm with 21 21 initial decision points the computing time is about 50 and 12 of that using only traversing algorithm for 51 51 and 101 101 points respectively so to obtain operating rules with similar performances the two stage algorithms can save at least 50 computing time comparing to only traversing using only traversing the average objective values increase by 3 5 and 31 3 comparing using 11 discretized release decision points to using 21 discretized release decision points for quadratic and concave penalties respectively that indicates the density of traversed points affects the concave penalty function model more seriously than the quadratic penalty function model for the quadratic penalty the single point and multi point searches increase the average objective value by 1 3 comparing to only traversing using 21 discretized decisions in concave penalty cases the increasing percentages are 13 0 and 13 3 for two stage algorithms the increasing percentage using concave penalty is larger illustrating that the concave penalty function models are influenced by multiple local optima more seriously than that of quadratic penalty and need higher solving accuracy the average objective values of two stage algorithms change very little with traversing point density illustrating the two stage algorithms are more robust to the traversing point density when a simple operating rule is used in which the cascade tries to generate the firm power of 6800 mw by operation of xiaowan and nuozhadu reservoirs for same ratios of ending storages to the maximum storage constraints at all periods 3812 9twh energy generation and 3016 mw minimum total power are obtained so the sdp models increase energy generation by 0 5 0 9 comparing to the simple operating rule most part of the rule surfaces should be smooth or near smooth for small changes of states often leading to small decision variation all the rapid changes in the surfaces should represent a certain operating intention without an explicit operating intention the rapid changing especially the sunken or protruding points are unreasonable and very possible caused by numerical problems although the final average objective function and the performance of multi point and single point search are close to each other the obtained rule surfaces can be quite different in some states fig 9 show the differences of rule surfaces of february for both penalty types using different solution methods the difference of the release decisions for both reservoirs can be easily found there are more sunken points in the decision surfaces of xiaowan reservoir and accordingly protrusions in decision surfaces of nuozhadu reservoir comparing the result using traversing and single point search to multi point search the sunken or protruding points cannot be explained by operating demands but solving accuracy especially as better solutions are missed in traversing and single point search even the unreasonable decision points did not cause considerable differences in both the average objective value and the simulation performance using observed data they may influence application of the rule and result in hardly explained decisions using more inflow scenarios in future multi point search can avoid most such circumstances and obtain rule surfaces with more accuracy and acceptability but with larger computation effort than the other two algorithms in fact the more the discretized number of states is the more precise the result can be while the computing time will increased exponentially with discretized numbers the discretized numbers used are enough to this problem which can be reflected by numerical results in that the simulating performances are good and can only be very slightly improved through increasing discretized numbers the penalty coefficients are not optimized and used to show the effect of the solution methods in fact the coefficients need to be optimized to find values that can best balance the energy generation and the constraint on total power and reservoir release but that is very time consuming solution time may be several hours to several days depending on the solution algorithm and traversing density when larger coefficients are tested the simulation results show no significant improvements in reliability which indicates that the coefficients used are large enough for this case study like other sdps the proposed method can be extended to three reservoirs but the inflow correlations need to be simplified and the discretized state and decision numbers cannot be too large to avoid too much computing effort there are many cascaded hydropower reservoirs that consist no more than 3 large reservoirs having long term regulation ability and more small reservoirs can be seen as run of river stations for multiple cascaded hydropower reservoir systems the near optimal operation decision can be made through two step allocating cross basin constraints such as the firm power for whole system to each cascade and making single cascade operation decisions so even having dimensionality confines the proposed model can still be widely used also the methods can be integrated into aggregation based sdp algorithms or ssdp solution for models having more reservoirs and more complex time and space inflow correlations 6 conclusions the multi optima problem of reservoir operations are often caused by non concave objective functions and non convex feasible region and can be enhanced by summation of piecewise functions due to different inflow scenario in sdp to illustrate this problem both deterministic and stochastic energy maximization models are proposed in the stochastic model quadratic or concave penalty functions are used to address total power demands to solve the sdp models for cascaded systems with multiple local optima to obtain the optimal decision at each discretized storage state combination a two stage global optimization algorithm combining traversing and search is proposed in which a local search algorithm is applied to single or multiple promising regions found through coarse traversing case study for reservoirs on middle lower lancang river in china shows that 1 the quadratic and concave penalty can reflect preferences for smaller shortage and fewer shortage periods respectively 2 local search after traversing is much more effective than dense discretizing and can obtain improved solutions with both better objective values and simulated performance in much shorter computing time 3 although the results of multi point search has no significant improvement on average objective values and simulation results it is superior to single point search for more reasonable and acceptable rule surfaces with fewer strange decision points 4 the number of discretized point of decisions in one step can significantly affect the results of traversing but have smaller impacts on the two stage solution algorithms 5 the proposed method obtain joint operating rules of cascaded hydropower reservoir system with two large reservoirs and additional smaller reservoirs in acceptable computing time running on pcs and can be combined with reservoir aggregation based methods and inflow sampling methods for larger scale and more complex problems acknowledgments the research work described in this paper is supported by the national nature science foundation of china 91647113 51679027 and 91547201 
7094,multiple optima seriously confine the solution accuracy of stochastic dynamic programming sdp for non concave maximization models of reservoir operation to address the problem a two stage optimization algorithm combining traversing and search is proposed to obtain an optimal decision at each state combination single or multiple promising regions where a local optimal solution may exist are identified through coarse traversing in the whole feasible region and a local search algorithm is used to local optimization in each promising region energy maximization model is used to analyze the multiple optima problem and test the method in the model quadratic and concave penalty functions are used to address the total power constraint for smaller shortages and fewer shortage periods respectively the total power constraint increases the probability of multiple local optima existence and intensifies the difficulty in finding optimal decisions the proposed model and method are applied to the cascaded reservoir system on middle lower lancang river in china numerical results show that the total power constraint is well addressed the computing time can be reduced by more than 50 using the two stage algorithm in getting operating rules with similar performance comparing to only traversing and the multi point search algorithm is superior to traversing and single point search in solving the proposed model keywords cascaded reservoir operating rule sdp global optimization 1 introduction stochastic dynamic programming loucks et al 1981 is one of the most popular methods for reservoir operations sdp can explicitly consider stream flow uncertainty in its recursive equation by solving the dynamic programming dp recursive relations adapted to stochastic problems particularly markov decision processes and derive operating policies for different reservoir system states sdp solutions have more computational demands than deterministic dp bai et al 2015 as computation grows with the number of states decisions and inflow scenario of reservoirs some amended or simplified methods to alleviate dimension problem were studied such as the aggregation disaggregation approaches turgeon and charbonneau 1998 archibald et al 1997 sampling sdp ssdp kelman et al 1990 faber and stedinger 2001 and stochastic dual dynamic programming sddp pereira and pinto 1985 pereira 1989 marques and tilmant 2013 macian sorribes et al 2017 yeh 1985 and labadie 2004 reviewed state of the art of mathematical models for reservoir operations although many improvements have been made to sdp it is still hard for sdp to solve large scale reservoir operation problems other approaches for reservoir operations include operating rule development applying deterministic optimization lund and ferreira 1996 simulation based optimization approaches koutsoyiannis and economou 2003 chang et al 2010 liu et al 2014 giuliani et al 2016 optimal reservoir trajectory turgeon 2007 wang 2010 and reinforcement learning busoniu et al 2010 castelletti et al 2010 profit maximization discounted weiner and ben zvi 1982 or undiscounted stedinger et al 1984 tejada guibert et al 1993 1995 is a common objective for reservoir systems some constraints can be easily addressed in sdp except the soft constraints such as lower bounds on reservoir release or power generation reliability or chance constrained model is a way to address the soft constraints askew 1974 proposed a chance constrained dynamic programing ccdp in which the iterative search of a penalty for failure and a precise evaluation of system response were used within the dynamic program rossman 1977 presented an sdp model for determining reservoir release rules subjected to reliability constraints on system performance within the framework of lagrangian duality theory sniedovich 1979 developed a dynamic programing solution for a class of reliability constrained reservoir control problems with constraints defined over the entire life of the reservoir another way to deal with soft constraints is the penalty based methods stedinger et al 1984 used quadratic penalty functions for monthly losses due to failure to meet flood control irrigation and power generation targets of a single reservoir in sdp model using best inflow forecasting as a hydrologic state variable tejada guibert et al 1993 1995 used linear penalty function for water shortage and system power shortage in sdp models deriving multireservoir operating policies in hydropower reservoir operation models the lower bound on reservoir release is a linear constraint and affects the solution slightly while the total power constraint on a cascaded system with two or more reservoirs may lead to non convex feasible regions even multiple local optima and make the model much more difficult to solve a common solution approach for sdp is to test all the discretized decision points and find the best among them at each state which is called traversing in this paper the method does not require gradient evaluation and is robust but slow piccardi and soncini sessa 1991 and zhang et al 2015 used parallel computation to improve solving efficiency of multi dimensional dp for objective functions with continuous second derivatives more efficient methods such as quasi newton can be applied tejada guibert et al 1993 foufoula georgiou 1991 addressed interpolating nodal values and derivatives of a one dimensional convex function with a convex interpolant so that potential computational difficulties from approximation induced nonconvexity are avoided and an efficient convergence to global instead of local optimal controls is guaranteed at each single stage optimization johnson et al 1993 demonstrated that the computational effort required to develop numerical solutions to continuous state dynamic programs can be reduced significantly when cubic piecewise polynomial functions rather than tensor product linear interpolants are used to approximate the value function for problems with concave objective functions zhao et al 2012 derived a monotonic relationship between reservoir storage and optimal release decision under both deterministic and stochastic conditions and proposes an algorithm to improve the computational efficiency of both deterministic dp and sdp for reservoir operation the algorithm is used to solve water supply model using objective of minimization of period accumulated squares of the ratios of water shortage to water demand although formulating the reservoir operations as continues or even concave models can significantly reduce solution time and applicable for large scale reservoir systems the state and decision discretizing based methods are still widely used for it has no confines on objective functions and feasible regions and need no approximation of the models as long as the system scales are within the limits of solvable dimensionality the state and decision discretizing based methods can be used to most of long term reservoir operations most existing solution methods are coarse global optimization or local optimization assuming only one optimum for each system state some researchers notice that there are near optimal reservoir storage trajectories in dp models liu et al 2011 examined the near shortest paths method the genetic algorithm and the markov chain monte carlo mcmc method to explore multiple near optimal solutions to reservoir operation problems the literature show that even only the constraints of bounds on single reservoir storage and release are used there are still possible multiple near optimal solutions for the energy maximization model and the methods more complex than standard dp or sdp are necessary to get near optimal solutions rougé and tilmant 2016 explored the consequences of and proposes a solution to the existence of multiple near optimal solutions when using sddp for mid or long term river basin management that there can be multiple local optima at a single state for non concave maximization models may seriously confines the solution accuracy and causes unreasonable decisions the multiple local optima problem was seldom emphasized in existing sdp models when deriving operating rules possibly because that standard discretized dp is a global optimization method and is seldom restricted by objective function and feasible region characters of the reservoir operation models while whether explicitly consider the multiple local optima problem or not in solving algorithms may affect the solution efficiency and quality and this brings the demand of a new way to improve solution methods cascaded hydropower reservoir operations must consider both water volume and water head for economic value maximization lund and guzman 1999 power system demands can be formulated as constraints on power of single reservoirs or cascaded systems this paper concerns the sdp model for energy maximization of cascaded reservoir operation in which the total power constraints intensified the non concave characteristic and multiple local optima problem both quadratic and concave penalty functions are used to address the total power constraints to improve solution accuracy a two stage solution algorithm combining traversing and search is proposed for quasi global optimization starting from traversing over the feasible region one or multiple promising points near local optima are identified then a local search algorithm is used to obtain local optimizations near the points the proposed methods are applied to cascaded reservoir system on middle lower lancang river operating rule surfaces and simulation results are obtained and compared for both kinds of penalty functions and for different algorithms including traversing and two stage algorithms of single point search and multiple point search 2 deterministic energy maximization model for cascaded reservoirs a real world reservoir operation can be very complex it has to meet various demands without violating the constraints of the system with the system wide total power constraints deterministic energy maximization model in a finite time horizon is formulated as follows 1 objective function max e t 1 t m 1 m p m t δ t constraints 2 water balance s m t 1 s m t 3600 δ t i m t i 1 u m r u m i t r m t 3 r m t q m t d m t relationship among reservoir storage turbine flow and power generation 4 p m t η m q m t z m s m t z m s m t 1 2 z d m 5 initial and ending storage s m 1 s i m 6 s m t 1 s e m 7 storage bounds s m t s m t s m t 8 maximum power and turbine flow p m t p m t 9 q m t q m t 10 minimum total power p m 1 m p m t 11 minimum reservoir release r m t r m t where e is the objective of energy generation in operating horizon m t are sequence number of reservoirs and periods respectively 1 m m and 1 t t m is the number of reservoirs t is the number of periods in operating horizon p m t p m t are the power generation and its upper bound of reservoir m in period t δ t is the hour number in period t η m is power generation coefficient of reservoir m q m t q m t are the rate of turbine flow and its upper bound of reservoir m in period t s m t s m t s m t are the storage and its lower and upper bounds of reservoir m in period t z m s m t is the reservoir level of reservoir m in period t a function of s m t z d m is the average downstream level of reservoir m i m t is the rate of local inflow of reservoir m in period t u m is the number of immediate upper stream reservoirs of reservoir m and u m i is the sequence number of the ith immediate upper stream reservoir r m t r m t are the rates of release flow and its lower constraint of reservoir m in period t d m t is the rate of spill flow of reservoir m in period t in long term operation constraint of its upper bound can be omitted s i m s e m are the initial and ending storage setting for reservoir m p is the minimum total power and is often set for power system demands in most cases z m s m t can be fitted using polynomial functions for some reservoirs with almost no storage capacity and nearly fixed water head madani et al 2014 the degree of polynomial is 0 and e is a linear function of q m t according to eqs 1 4 when the degree of polynomial is 1 z m s m t is linear and e is a quadratic function of q m t for many reservoirs the degrees of polynomial are integer number no less than 2 and e is non concave function of q m t moreover the feasible region considering total power constraint of eq 10 may be a non convex set taking a two reservoir problem at one no spill stage as an example temporarily supposing linear reservoir level storage curves as z m s m t a m s m t b m here the upstream reservoir is numbered 1 and the downstream reservoir is numbered 2 so the constraint of eq 10 can be formulated as eq 12 12 p η 1 q 1 t a 1 s 1 t b 1 a 1 s 1 t 3600 δ t i 1 t q 1 t b 1 2 z d 1 η 2 q 2 t a 2 s 2 t b 2 a 2 s 2 t 3600 δ t i 2 t q 1 t q 2 t b 2 2 z d 2 replacing q 1 t as x and q 2 t as y in eq 12 the boundary of feasible region is α x 2 β y 2 β x y γ x λ y 0 x 0 y 0 here α η 1 a 1 3600 δ t 2 β η 2 a 2 3600 δ t 2 γ η 1 a 1 s 1 t b 1 a 1 s 1 t 3600 δ t i 1 t b 1 2 z d 1 and λ η 2 a 2 s 2 t b 2 a 2 s 2 t 3600 δ t i 2 t b 2 2 z d 2 relationship of eq 13 can be obtained through deriving the second derivative of eq 12 13 2 β y β x λ 2 α d 2 y d x 2 β α dy dx 1 2 β α 2 1 β 4 α the condition of the feasible region is non convex is d 2 y d x 2 0 and it can be satisfied in many circumstances for example where the product of generation coefficient and reservoir level storage incremental rate of the downstream reservoir is less than 4 times of that of the upstream reservoir then β 4 α 1 and the right side of eq 13 is always positive for α 0 the non convex feasible region condition is 2 β q 2 t β q 1 t λ 0 the condition may be satisfied when the optimal decision is in the region where q 1 t is greater than 2 times of q 2 t given small λ value that often happens at dry season when the storage rate of the upstream reservoir is much more than the downstream reservoir local solutions exist in both regions of a and b in fig 1 given a non convex feasible region even for a concave objective function the nonlinear z m s m t can cause much more complex feasible region and either the z m s m t is formulated as piecewise linear or high degree polynomial curve the non convex feasible regions cannot be avoided so even the deterministic model may have multiple optima due to the non convex feasible region caused by total power constraints and can be intensified by non concave objective function 3 sdp model with soft constraints for cascaded reservoirs 3 1 formulation in order to derive operating rules for cascaded reservoirs considering uncertain inflow infinite horizon sdp models are often used to obtained rule tables to interpolate releases from reservoir states the recursive function of sdp model for expected benefit maximization is eq 14 and the constraints in the deterministic model except initial and ending storage remain for each inflow scenario common state variables include reservoir storage previous inflow and inflow forecasts stedinger et al 1984 kim and palmer 1997 in this paper the reservoir storage is set to be state variables for easier comparison between different solution algorithms and the conclusions can be extended to models with more state variables such as pre inflow or inflow forecasting with eq 14 the state transition function is same to eq 2 under each inflow scenarios 14 f t s k t max f s k t t r k t max r k t n 1 n pr q n t b t r k t q n t s k t f t 1 s t 1 r k t q n t s k t where f t and f t 1 are the objective of period t and t 1 or future value function at the beginning of period t and t 1 respectively s k t is the state variable kth vector of discretized storages of reservoirs r k t is the decision variable vector of reservoir releases at kth state f s k t t r k t is the objective function of r k t at period t given state s k t b t is the benefit function at period t n is the number of combinations of discretized reservoir local inflows q n t is the vector of nth discretized local inflow of reservoirs and pr q n t is the probability of it s t 1 is the ending storage vector at period t a function of the initial state decision and inflow due to uncertain inflows the constraints on total power cannot be satisfied at all states under all inflows so the constraint of minimum total power in the deterministic model eq 10 becomes a soft constraint and p is often called the firm power in stochastic operation models denoted as p f the firm power and minimum release constraints are addressed using penalty functions in this paper for the benefit lost from firm power failure is not accurately evaluated the penalty function forms depend on willingness to accept different forms of shortage continuous smaller shortage or a shorter period of greater shortage this willingness can be decided by operators or managers knowing relations between shortage and system benefit or social aversion rossman 1977 to shortage the penalty augmented benefit function is formulated as eq 15 15 b t r k t q n t s k t e t r k t q n t s k t g 1 t r k t q n t s k t g 2 t r k t q n t s k t in eq 15 e t is the energy generation at period t given storage and inflow vectors of s k t and q n t following release decision of r k t g 1 t is the penalty function for firm power shortage g 2 t is the penalty function for minimum release shortage for non power requirements shawwash et al 2000 or social well beings chang and wang 2013 the penalty terms are formulated as eqs 16 and 17 16 g 1 t r k t q n t s k t σ max p f δ t m 1 m p m t δ t 0 μ 17 g 2 t r k t q n t s k t m 1 m θ max 3600 δ t r m t r m t 0 2 in eqs 16 and 17 σ 0 θ 0 μ 0 are coefficients when μ 2 eq 16 is a quadratic function and when μ 1 eq 16 is a concave function if the system is expected to be operated for smaller extreme shortage of firm power meaning that the unavoidable power shortages are allocated to several periods to make the largest single period shortage as small as possible the quadratic function is used if the system is expected to be operated for fewer shortage periods the constraint of firm power can be replaced by a constraint of failing chance the demand can be formulated as the explicit chance constraint of eq 18 18 pr m 1 m p m t p f c where c is the chance constraint on firm power under this circumstance an extreme minimum power constraint are needed to control the shortage extent so there are two levels of total power constraints firm power for normal periods and the extreme minimum power for extreme dry periods the chance constrained model can be solved using reliability constrained dp rossman 1977 and also can be approximately addressed using a concave penalty function for firm power failure with exponent less than 1 in eq 16 the extreme minimum power constraint can be addressed using a similar quadratic penalty function for firm power the sdp recursive function is the same as eq 14 using the benefit function of eq 19 19 b t r k t q n t s k t e t r k t q n t s k t g 1 t r k t q n t s k t g 2 t r k t q n t s k t g 3 t r k t q n t s k t where g 3 t is the penalty function for the extreme minimum power constraint and is formulated as eq 20 and σ in g 1 is changed to a value between 0 and 1 in eq 20 φ 0 is a coefficient p e is the constrained value of the extreme minimum power p e p f 20 g 3 t r k t q n t s k t φ max p e δ t m 1 m p m t δ t 0 2 the concave penalty function tends to obtain results with fewer shortage periods comparing to the quadratic penalty function while the extreme shortage can be larger the quadratic penalty on extreme minimum power is used to confine the extreme shortage after addressing the constraints using penalty terms in objective function the constraints remain at each state are only the upper bounds of turbine flows and the feasible region of release is 0 q m t for each reservoirs the non concave characteristic of the model is intensified using penalty functions for the energy generation is linear function of period power generation while the penalty terms are power functions of period generation 3 2 multiple local optima problem of sdp for cascaded reservoir operations eq 14 defines a recursive computation of periodic markov processes in an infinite horizon of which one cycle corresponds to a year and each period is defined as one month su and deininger 1972 show that the model converges to a steady release policy that maximizes the system s average annual benefit over an infinite horizon the sdp solution needs to obtain optimal decision at each state from the last period t to the first period 1 backward in a year this process is repeated iteratively until decisions converge at all periods and all states at the beginning of each iteration the future value function for period t is replaced by that of period 1 of the last iteration the remaining problem is how to solve the sub optimization models for optimal decisions at each state to maximize objective function of f s k t t r k t a traditional solution method for the sub optimization is to simply traverse discretized decision combinations of reservoirs in the feasible region the traversing method is a global optimization method because discretized decisions distributed in whole feasible region are tested but the solution accuracy and computation effort depends on how dense the decisions are discretized for the sub optimization models besides the reasons of non concave objective function and non convex unpunished region similar to those for the deterministic model another aspect that may enhance non concavity and even intensify multiple optima is the summation of piecewise functions due to different inflow scenario as the example shown by fig 2 for one reservoir r 1 r 2 and r 3 are the release values that can emptying the reservoir for inflow scenarios 1 2 and 3 respectively the objective functions for scenario 1 and 2 are concave where r is less than r 1 and r 2 and are non concave in region of 0 r 3 due to value unchanged regions of r 1 r 3 and r 2 r 3 the average value function is also non concave fig 2 a and may have multiple optima fig 2 b even the objective function f s 1 t t r 1 t is not concave the sdp model for energy maximization of a single reservoir has only one local optimum in most cases the f s 1 t t r 1 t curves may have segments where the function value does not change with decision when the ending storage reaches its bounds this will not cause serious problems in solving but confines the solving algorithm of steepest ascent from any point although the following presented analysis and methods are suitable for larger scale problems a two reservoir problem is used to describe the details for simplification at some storage combinations even the decision for a reservoir has a single local optimum given the other reservoir s decision the decision combination may still have more than one local optima an example surface of f s t k t r t k is shown as fig 3 for unconstrained model and models with firm power constraint addressed using quadratic and concave penalty functions for low storages of two cascaded reservoirs at the second last period t 1 in the first round of yearly backward recursion for the unconstrained model the f s t k t r t k surfaces can have more than one near concave areas but the optimum can hardly be missed and the solution is often easy for the model with a total firm power constraint addressed using the quadratic penalty function peak value surface of fig 3 b demonstrates that there are two local optima at the two peak areas and the two peak areas are separated by a gap caused by the crossing of two sub surfaces the small gap can affect the solution because the peaks may be missed in traversing and the local search cannot move from one side of the gap to the other if the peak area on the right side is missed in traversing while the left side peak area is caught the optimal solution can be considered to be on the left side even further search is executed from the optimal point identified the real global optimum in right side can still be missed for the concave penalty function fig 3 c case there are three local optima and the global optimum is easier to be missed than the quadratic penalty function a straightforward performance of the missing global optima is that there are some unreasonable protrusions and sunken points in the resulting rule surfaces with the backward recursion of sdp the shape and space distribution of local optimal points are changed and more complex if the solving accuracy is low many poor solutions may be obtained for the multiple optima model a poor solution will affect not only the current period decision but also the future values of backward periods accumulated error on future values may cause ill derived operating policies and even fail in solution so it is necessary to solve the cascaded reservoir operation models using more effective global optimization algorithms 4 two stage solving algorithm with local search strategy global optimization for multi peak objective functions is an important and hard problem in engineering fields there is not a universal method to obtain global optima for large scale multi peak problems effectively although the dp algorithm has no restriction on the objective function and can solve both concave and non concave maximization problems formulating the reservoir operation as a concave or near concave model is advantageous computationally to find global optima when the problem can hardly be formulated as near concave models finding an local optimum is relatively straightforward using local optimization methods while finding the global optimization is far more difficult analytical methods are frequently unavailable and numerical solutions are often computationally challenging analyzing the solution of traversing it can be noticed that when an optimal solution is obtained better solution can also be expected nearby and can be obtained through local search apparently search the region near the optimal traversed solution using smaller steps will increase the accuracy with less additional computation effort than dense discretization over whole feasible region so the solution algorithm used in this paper at a storage combination includes two steps traversing and search for two cascaded reservoirs the discretized storage point with sequence number of x y is taken as an example in the traversing stage l l evenly discretized points of release decisions in the feasible region are tested and objective function values are obtained let i 1 l j 1 l are the sequence numbers of discretized decision points for reservoir 1 and 2 in the search stage there can be two strategies one is to search only the neighborhood of the optimal solution after traversing called single point search the other is to search all promising regions found based on the results of traversing called multi point search as fig 4 shows for the multi point search the discretized points near which local optima may exist are firstly found as initial search points the initial search points are generated through three ways 1 the region near optimal point in traversing stage is obviously promising and the point can be an initial search point 2 other discretized decision points with objective function values no less than all neighboring points and at least larger than one neighboring point can also be initial search points for point with sequence number i j the neighboring points include points with sequence numbers of i m j n m 1 0 1 and n 1 0 1 and m and n are not 0 at the same time 3 even the points found through 1 and 2 are saved it cannot be ensured that all potential region having local optima are found for the traversing points may not be dense enough to catch all the shape changing of the objective value surface so some important points can also be set as initial search points considering that decision for neighboring discretized storage points may be close to each other in most cases and a local optimum for a storage combination may exist near the solution of neighboring storage combinations the optimal decisions of storage combinations with sequence numbers of x 1 y x y 1 and x 1 y 1 if exist can be initial search points for there are platforms and crest lines on the objective value surface to avoid too much redundant initial search points the set of the initial search points is refined for all initial search points that are neighboring one by one and have a same objective value only one of them is retained for each initial search point a local optimum is found by search the search algorithm is important for it is called for thousands of times in one stage and very little error may lead to an incorrect final solution set the ith initial search point as a 1 i a 2 i the area of the rectangle with vertexes of a 1 i a 1 max l 1 a 2 i a 2 max l 1 is defined as the control area of a 1 i a 2 i setting initial search steps as δ m m 1 2 the search algorithm is to find optimal point in the points of a 1 i j δ 1 a 2 i k δ 2 j 1 0 1 and k 1 0 1 the search is repeated until no better solution is found then set δ m δ m 2 and repeat the search for several times until preset minimum search steps for reservoirs are reached the search algorithm from one promising point is shown in fig 5 the search algorithm can find a neighboring local optimum with very high precision and can obtain solution outside the control area of the initial search point in some cases fig 5 b after the local searches optima near all initial search points have been found and the best of them is set to be the solution in solution the interpolation on f t 1 can be obtained by fitting the surface near point of s 1 t 1 s 2 t 1 to a s 1 t 1 b s 2 t 1 c s 1 t 1 s 2 t 1 d using four points around it although the multidimensional linear interpolation or spline interpolation methods are more often used the 4 variable 4 coefficient function used here can ensure that all points used in fitting obtain the real value on the fitted surface and can fit both concave and convex surfaces with very small error fig 6 shows the computing flow of the algorithm of multi point search and the computing flows of the other two algorithms of only traversing and single point search are similar to it except that the solution at each state are simpler the two stage solution methods consume more computing time than traversing but the complexity and computing effort are not much increased so the extreme solvable reservoir number is close to common sdp 5 case study 5 1 experimental setting the lancang river is an international river known outside china as the mekong river the lancang mekong river is about 4900 km long and flows through china myanmar laos thailand cambodia and vietnam before discharging into the south china sea the hydropower system studied in this paper consists 5 cascaded reservoirs on middle lower lancang river in yunnan province the characteristics of the studied hydropower reservoirs are shown in table 1 the hydropower system has installed capacity of 14820 mw and more than 221 1 0 8 m 3 effective storage capacity making it the important seasonal regulation power resources of its service regions in the service regions there are many other hydropower reservoirs have no long term regulation ability and the energy generation of them in flood season is much larger than in dry season the seasonal regulation of the studied system can avoid further increasing of quantity gap of hydroelectricity between flood season and dry season achieved through the firm power constraints in the operation model to move the flood season energy to dry season storage capacities of xiaowan and nuozhadu reservoirs are much greater than the others of the system so the storage of the other reservoirs can be neglected and their reservoir levels are set near the upper bounds of different months the percentages of extreme power generating head falling to maximum generating head of xiaowan and nuozhadu reservoirs are near 30 and 23 respectively so the long term head variations play an important role in operation monthly inflows data used are from year 1953 to year 2008 the solution algorithms are programmed in the java language the sdp models with 51 discretized storage points are tested local inflows of xiaowan and nuozhadu reservoirs are correlated to each other and 5 local inflow intervals for each reservoir are used to get discretized joint probability distributions at each period local inflows to manwan reservoir and dachaoshan reservoir are supposed to be frequency synchronous to xiaowan reservoir inflows and local inflows to jinghong reservoir are supposed to be frequency synchronous to nuozhadu reservoir inflows the minimum releases of xiaowan nuozhadu and jinghong reservoirs are set as 470 m 3 s 500 m 3 s and 504 m 3 s respectively parameters of the model using quadratic penalty function for firm power failure are p f 6800 mw μ 2 σ 10 2 24 31 2 θ 10 4 24 31 3600 2 10 2 and 10 4 penalty levels are used to reflect priority for different constraints and other constants are used to normalize the hour numbers in different periods parameters of the model using the concave penalty function for firm power failure are p f 6800 mw p e 3000 mw μ 0 9 σ 10 5 24 31 μ φ 10 2 24 31 2 θ 10 4 24 31 3600 2 the models are solved by methods of traversing single point search and multi point search using different numbers of traversing points respectively in search the two dimension search method is used with initial search step as half of the traversing intervals and reduced by half for 8 times 5 2 numerical results fig 7 compares the results of objective function and rule surfaces obtained using quadratic and concave penalty functions for firm power failure multi point search and 21 discretized release decision points in traversing for each reservoir the major difference between the two operating rule sets is the shape in the dry season when the penalty for firm power failure affects the results significantly the rule surfaces using the quadratic penalty function are gradually changed from where the current period firm power demand can be fully satisfied to where failure may happen the gradual changes cause nearly average shortage distribution among several periods if shortage cannot be avoided with a concave penalty function there are rapid changes in both reservoir rule surfaces the rapid changes often mean the switches from satisfying firm power to satisfying extreme minimum power or minimum release in both penalty functions the upstream xiaowan reservoir takes major task of regulation for total power and downstream flow and the downstream nuozhadu reservoir tends to stay high level unless storage of xiaowan reservoir is lower than certain levels in different months in most period of flood season operating rule surfaces are similar using different penalty functions for the constraints on firm power can be fully satisfied and the reservoirs try raise water head and avoid spill fig 8 shows the simulation performances of the rules using quadratic and concave penalties table 2 shows the results using different types of penalty functions and solution algorithms although in different cases the iteration times on time horizon of sdp are different when stable decision obtained the results after 5 times iteration are used here to compare the objective function values in iterations after 5 times the rule surfaces changed very little the computing time is estimated for the computations with different settings are performed in different computers and the time consuming need to be prolonged or reduced according to the computer configurations in order to comparing the operating rule using the quadratic penalty function on firm power failure obtains larger minimum total power and greater failure chance than using the concave penalty the minimum power is confined by p e using concave penalty function on firm power failure and the simulated minimum total power is near p e in both penalty functions the multi point search algorithm obtained the best results while the results obtained using only traversing are the worst evaluated using the average objective values of january or the average future values at the beginning of january the combined traversing and search method can confirm the solving accuracy achieved by only traversing using very dense discretized points even 101 101 decision points are traversed consuming 30 times more time the average objective value still cannot achieve that of the simplest two stage solving method single point search using 11 11 initial decision points using the multi point search algorithm with 21 21 initial decision points the computing time is about 50 and 12 of that using only traversing algorithm for 51 51 and 101 101 points respectively so to obtain operating rules with similar performances the two stage algorithms can save at least 50 computing time comparing to only traversing using only traversing the average objective values increase by 3 5 and 31 3 comparing using 11 discretized release decision points to using 21 discretized release decision points for quadratic and concave penalties respectively that indicates the density of traversed points affects the concave penalty function model more seriously than the quadratic penalty function model for the quadratic penalty the single point and multi point searches increase the average objective value by 1 3 comparing to only traversing using 21 discretized decisions in concave penalty cases the increasing percentages are 13 0 and 13 3 for two stage algorithms the increasing percentage using concave penalty is larger illustrating that the concave penalty function models are influenced by multiple local optima more seriously than that of quadratic penalty and need higher solving accuracy the average objective values of two stage algorithms change very little with traversing point density illustrating the two stage algorithms are more robust to the traversing point density when a simple operating rule is used in which the cascade tries to generate the firm power of 6800 mw by operation of xiaowan and nuozhadu reservoirs for same ratios of ending storages to the maximum storage constraints at all periods 3812 9twh energy generation and 3016 mw minimum total power are obtained so the sdp models increase energy generation by 0 5 0 9 comparing to the simple operating rule most part of the rule surfaces should be smooth or near smooth for small changes of states often leading to small decision variation all the rapid changes in the surfaces should represent a certain operating intention without an explicit operating intention the rapid changing especially the sunken or protruding points are unreasonable and very possible caused by numerical problems although the final average objective function and the performance of multi point and single point search are close to each other the obtained rule surfaces can be quite different in some states fig 9 show the differences of rule surfaces of february for both penalty types using different solution methods the difference of the release decisions for both reservoirs can be easily found there are more sunken points in the decision surfaces of xiaowan reservoir and accordingly protrusions in decision surfaces of nuozhadu reservoir comparing the result using traversing and single point search to multi point search the sunken or protruding points cannot be explained by operating demands but solving accuracy especially as better solutions are missed in traversing and single point search even the unreasonable decision points did not cause considerable differences in both the average objective value and the simulation performance using observed data they may influence application of the rule and result in hardly explained decisions using more inflow scenarios in future multi point search can avoid most such circumstances and obtain rule surfaces with more accuracy and acceptability but with larger computation effort than the other two algorithms in fact the more the discretized number of states is the more precise the result can be while the computing time will increased exponentially with discretized numbers the discretized numbers used are enough to this problem which can be reflected by numerical results in that the simulating performances are good and can only be very slightly improved through increasing discretized numbers the penalty coefficients are not optimized and used to show the effect of the solution methods in fact the coefficients need to be optimized to find values that can best balance the energy generation and the constraint on total power and reservoir release but that is very time consuming solution time may be several hours to several days depending on the solution algorithm and traversing density when larger coefficients are tested the simulation results show no significant improvements in reliability which indicates that the coefficients used are large enough for this case study like other sdps the proposed method can be extended to three reservoirs but the inflow correlations need to be simplified and the discretized state and decision numbers cannot be too large to avoid too much computing effort there are many cascaded hydropower reservoirs that consist no more than 3 large reservoirs having long term regulation ability and more small reservoirs can be seen as run of river stations for multiple cascaded hydropower reservoir systems the near optimal operation decision can be made through two step allocating cross basin constraints such as the firm power for whole system to each cascade and making single cascade operation decisions so even having dimensionality confines the proposed model can still be widely used also the methods can be integrated into aggregation based sdp algorithms or ssdp solution for models having more reservoirs and more complex time and space inflow correlations 6 conclusions the multi optima problem of reservoir operations are often caused by non concave objective functions and non convex feasible region and can be enhanced by summation of piecewise functions due to different inflow scenario in sdp to illustrate this problem both deterministic and stochastic energy maximization models are proposed in the stochastic model quadratic or concave penalty functions are used to address total power demands to solve the sdp models for cascaded systems with multiple local optima to obtain the optimal decision at each discretized storage state combination a two stage global optimization algorithm combining traversing and search is proposed in which a local search algorithm is applied to single or multiple promising regions found through coarse traversing case study for reservoirs on middle lower lancang river in china shows that 1 the quadratic and concave penalty can reflect preferences for smaller shortage and fewer shortage periods respectively 2 local search after traversing is much more effective than dense discretizing and can obtain improved solutions with both better objective values and simulated performance in much shorter computing time 3 although the results of multi point search has no significant improvement on average objective values and simulation results it is superior to single point search for more reasonable and acceptable rule surfaces with fewer strange decision points 4 the number of discretized point of decisions in one step can significantly affect the results of traversing but have smaller impacts on the two stage solution algorithms 5 the proposed method obtain joint operating rules of cascaded hydropower reservoir system with two large reservoirs and additional smaller reservoirs in acceptable computing time running on pcs and can be combined with reservoir aggregation based methods and inflow sampling methods for larger scale and more complex problems acknowledgments the research work described in this paper is supported by the national nature science foundation of china 91647113 51679027 and 91547201 
