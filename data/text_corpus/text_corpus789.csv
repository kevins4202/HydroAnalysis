index,text
3945,due to climate change and human disturbances rainfall spatial and temporal variabilities at the watershed have become increasingly prominent significantly impacting the patterns of runoff generation and pollutant transportation originally rainfall variabilities in space and time were frequently neglected or idealized in the traditional applications of hydrology and water quality models this research attempted to investigate the responses of runoff quality and quantity simulation to rainfall spatial and temporal variabilities we used rainfall hazard modeling system rainyday model combined with trmm tropical rainfall measuring mission rainfall products to generate rainfall events for 500 return periods such events were resampled into eight rainfall scenarios with multiple levels of spatial and temporal variabilities they were used to drive the soil and water assessment tool swat to simulate runoff quality tp as the index and quantity under multiple watershed scales and return periods at the dongjiang river watershed analysis of variance was employed to analyze the relative contributions of rainfall spatial and temporal variabilities to the total variabilities of runoff quality and quantity the results highlighted that rainfall spatial and temporal variabilities would have notable impacts on runoff quality and quantity under multiple watershed scales and event magnitudes for headwater at small watershed scales rainfall spatial variability would have a relatively significant impact on runoff quality and quantity for relatively larger watershed scales rainfall temporal variability showed an increasingly important impact than spatial variability for smaller return periods whereas the opposite results can be obtained for relatively larger return periods the results can be caused by the following reasons 1 rainfall was concentrated in the middle and lower reaches of the watershed 2 it was based on the daily scale our research suggested that attention should be paid to spatial and temporal variabilities of rainfall inputs in hydrological and water quality models keywords runoff quality and quantity spatial and temporal variabilities swat rainyday dongjiang river watershed 1 introduction due to the combined effects of climate change and human disturbances spatial and temporal variabilities of rainfall have become increasingly prominent in many watersheds significantly affecting runoff generation and confluence patterns and the associated pollutant migration processes cai et al 2018 gebrechorkos et al 2020 grusson et al 2021 miralha et al 2021 verma et al 2015 for example frequencies of record breaking rainfall and flood events have increased globally kendon et al 2014 mann et al 2017 sabine 2014 particularly even a small scale rainfall event may drive large scale runoff and pollutant loading that may cause flooding and water deterioration risks baker and showers 2019 xie et al 2019 the impacts of rainfall spatial and temporal variabilities on runoff quality and quantity are complex and significantly affected by multiple factors such as watershed scales and rainfall event magnitudes chen et al 2017 along with the development and improvement in hydrological and water quality modeling a large number of studies employed them to analyze responses of rainfall and runoff abbaspour et al 2015 tuo et al 2016 wu et al 2012 yang et al 2020 however due to the limits in spatio temporal structure and the length of time series for rainfall data many previous studies frequently neglected or might idealize the spatial and temporal distribution characteristics of rainfall to simulate the responses of runoff for a number of watersheds shen et al 2014 zhu et al 2018 for example the soil and water assessment tool swat which is a widely used tool for runoff quality and quantity simulation automatically allocates one rain gauge for each sub watershed the closest to its centroid multiple sub watersheds may use the same rain gauge as rainfall input in the areas with scarce rain gauge which lead to the simplification of rainfall spatial and temporal distribution kim et al 2011 rong et al 2016 2017 shen et al 2012 wagner et al 2011 neglecting or idealizing spatial and temporal variabilities of rainfall may lead to great uncertainties in runoff simulation through hydrological and water quality models therefore it is necessary to understand the responses of runoff to rainfall spatial and temporal variabilities which is extremely desired for facilitating the formulation of flood control and water quality management strategies the previous researchers discussed the importance of rainfall spatial and temporal distributions in runoff quantity and quality meselhe et al 2009 reported that spatial and temporal variabilities of rainfall had important impacts on physically based models than those on conceptual ones tan and yang 2020 pointed out that temporal variability of rainfall caused a strong impact on simulated runoff based on the swat sucozhañay and célleri 2018 and chaplot 2014 concluded that rainfall spatial variability could significantly affect the simulated runoff results through setting scenarios of multiple rain gauge densities within a small watershed fu et al 2011 stated that the effects of spatial rainfall variability on runoff simulation could be reduced along with increasing watershed area and could even be ignored for a watershed with area over 1 000 km2 shen et al 2012 highlighted that rainfall data with huge spatial variability could greatly affect the simulated results of the hydrologic and water quality model at a large and complex watershed 4 426 km2 it was found that there have been conflicting conclusions probably because most of these studies were based on the watersheds with different rainfall spatio temporal distribution characteristics or limited numbers of rainfall events a few studies found that the effect of rainfall variability could be transferred from runoff quantity to quality alnahit et al 2020 chen et al 2019 shen et al 2012 chen et al 2019 found that total phosphorus tp simulation was more sensitive to the variabilities of rainfall inputs than that of flow simulation cho et al 2009 also demonstrated that the impact of rainfall spatial variability was larger on the simulated tp than that on flow simulation based on swat many studies indicated that rainfall spatial and temporal variabilities played an extremely important role which had profound impacts on runoff quality and quantity simulation however there are fewer studies on comparison and quantification of the runoff quality and quantity responses that might be forced by multiple levels of rainfall temporal and spatial variabilities therefore understanding and quantifying the impacts of rainfall spatial and temporal variabilities on runoff quality and quantity are desired especially for the runoff quality rainfall data from a gauge is a fundamental source for runoff quality and quantity analyses based on hydrologic and water quality modeling tan and yang 2020 there would be a lack of rain gauges in a large scale watershed due to the costs and difficulties in on site monitoring with the development of satellite and radar technologies a number of rainfall products have been continuously developed and improved which could well capture spatial and temporal variabilities of regional rainfall li et al 2018 lintern et al 2018 ma et al 2019 peng et al 2021 terink et al 2018 wedajo et al 2021 and provide new and complementary data sources for exploring the responses of rainfall runoff and runoff quality tobin and bennett 2013 used five rainfall products to drive swat models and evaluated the differences in runoff simulation under multiple time scales alnahit et al 2020 employed multiple rainfall products as inputs to the swat model and found the uncertainties of rainfall products further impacted runoff quality and quantity simulation the related studies combined high resolution rainfall products with stochastic rainfall generators which can not only overcome the shortcoming of ignoring rainfall spatial and temporal variabilities but also effectively expand the sequence of rainfall data peleg et al 2017 combined radar rainfall data with a stochastic rainfall generator and concluded that spatial rainfall variability affected runoff simulation increasing with return periods rainfall products with multiple levels of spatial and temporal variabilities have great disparities it is still unclear how these disparities affect the simulation of runoff quality and quantity for multiple watershed scales and event magnitudes the main objective of this research is to investigate how runoff quality and quantity be affected by rainfall spatial and temporal variabilities under multiple watershed scales and event magnitudes through the adoption of numerical simulation the developed approach in this research is to combine the rainfall product and the stochastic rainfall generator with hydrologic and water quality modeling to simulate large samples of runoff quality and quantity under multiple watershed scales and event magnitudes multiple rainfall scenarios with multiple levels of rainfall spatial and temporal variabilities will be reflected and considered the simulated results are then analyzed through the employment of statistic methods in detail 1 the main purpose of this research is not to obtain more realisticrunoff quality and quantity simulation rather to understand how runoff quality and quantity are impacted by rainfall spatial and temporal variabilities and 2 relatively coarse rainfall temporal scenarios in this research will be used to match the accuracy of runoff data this research could facilitate the understanding of the responses of runoff quality and quantity to rainfall spatial and temporal variabilities further how the responses vary with watershed scale and event magnitude will be investigated 2 study area and data 2 1 overview of the study area the dongjiang river 22 20 34 to 25 12 n 113 24 to 115 52 e is one of the most important watersheds in south china fig 1 the mainstream flows from northeast to southwest with a length of 562 km the main hydrological station named boluo controls a drainage area of 25 325 km2 the terrain with large fluctuation is generally higher in the northeast but lower in the southwest major land use types of the watershed are forest urban and agriculture the watershed has the typical subtropical monsoon climate and receives an abundant annual rainfall ranging from 1 500 to 2 400 mm year lai et al 2020 on account of the terrain and monsoon cycle the spatio temporal distribution of rainfall is considerably non uniform at the watershed the rainfall accounts for over 80 of the total annual rainfall during the flood season from april to october in terms of rainfall space it is usually concentrated in the middle and lower reaches of the watershed gradually decreasing from south to north the dongjiang river watershed is extremely vital to the guangdong hong kong macau greater bay ghmb area which is a world class urban agglomeration li et al 2020 it is one of the major freshwater sources shouldering production domestic and ecological water for nearly 40 million people in several megacities such as guangzhou shenzhen and hong kong however with the rapid social and economic development the watershed is strongly disturbed by intensive human activities there are many sources of non point source pollution and the pollutants can be discharged into a river along with rainfall runoff resulting in increased deterioration of runoff quality and serious water safety issues ongley et al 2010 according to the monitoring and tracking results of pollutants over the years tp pollution is prominent among many pollutants at the dongjiang river watershed wu and chen 2013 thus tp is set as the representative indicator of runoff quality in this research responses of runoff quality and quantity to rainfall spatial and temporal variabilities can be performed 2 2 data the basic data to build the hydrological and water quality model for the dongjiang river watershed include data of digital elevation model dem land use soil meteorological and hydrological conditions as well as water quality information specifically dem was obtained from the computer network information center chinese academy of sciences http www gscloud cn land use data were obtained from the data center for resources and environmental sciences of the chinese academy of sciences http www resdc cn soil data included the soil map and the related soil physical properties were collected from the harmonized world soil database developed by the food and agriculture organization of the united nations http www fao org daily rainfall data from21 rain gauges in the watershed were provided by the water conservancy and electric power bureau in guangdong province in china daily maximum and minimum temperatures wind speed relative humidity solar radiation were collected from the china national climatic data share center v3 0 which originates from the national meteorological information center china meteorological administration http data cma cn daily measured runoff quantity data 2002 2015 at the boluo hydrological gauge and monthly measured runoff quantity data 2004 2010 at the lingxia hydrological gauge were provided by the water conservancy and electric power bureau in guangdong province in china monthly measured runoff quality data 2004 2010 at the huizhou runoff quality monitoring gauge were provided by the environment monitoring center of guangdong province in china at the same time the tropical rainfall measuring mission trmm rainfall product is selected as the basic data and coupled with the rainfall hazard modeling system rainyday model described in section 3 1 to generate a large number of rainfall events the rainfall product has a 3 h temporal resolution and a 0 25 0 25 spatial resolution trmm rainfall product had good applications in precipitation measurement hydrologic and water quality modeling khatakho et al 2021 musie et al 2019 prakash 2019 chen et al 2011 indicated that trmm had a good correlation with the observed rainfall from rain gauges at the dongjiang river watershed 3 methodology to investigate the impacts of rainfall spatial and temporal variabilities on runoff quality and quantity at the watershed the rainyday model with trmm rainfall product were coupled to generate 12 day i e 288 hour rainfall events with the same spatio temporal distribution as trmm under multiple rainfall intensity levels these rainfall events were then resampled into eight scenarios with multiple levels of spatial and temporal variabilities they were employed as rainfall input to the hydrological and water quality model for the watershed based on the nested watershed theory and the relationships between the tributaries and the mainstream the watershed was divided into nine levels of nest watersheds to reveal the variations in runoff quality and quantity for multiple watershed scales analysis of variance anova was adopted to quantitatively identify the relative contributions of rainfall spatial and temporal variabilities to the total variabilities of runoff quality and quantity under multiple watershed scales and event magnitudes the framework for the methodology in this research was shown in fig 2 3 1 rainy event generation rainfall hazard modeling system rainyday model is an open source python based software developed by wright et al 2017 the model takes the stochastic storm transposition technology as the core and uses reanalysis measured or other remote sensing grid rainfall datasets as the basic data it expands rainfall records of the watershed by transposing the spatial positions of observed rainfall events from the surrounding region that has similar meteorological features to the study watershed the procedure merely alters rainfall locations but does not change its spatial and temporal distribution characteristics which could overcome the defect of the traditional methods based on the idealized spatial and temporal distribution of rainfall such as spatial interpolation and adjacent rain gauge substitution to facilitate the understanding of the model we sketched the transposition procedure for a single rainfall event fig 3 a detailed description could be found in wright et al 2017 wright et al 2020 yu et al 2019 zhou et al 2019 and zhu et al 2018 the following five steps briefly describe how the model generates new rainfall events step 1 identify a transposition domain according to the spatial probability distribution characteristics of regional rainfall a transposition domain needs to be identified with similar rainfall pattern and intensity to the interested watershed the domain the grey area in fig 3 needs to encompass the watershed step 2 define parent rainfall event catalog a number of rainfall events m and a duration t need to be defined firstly rainyday model selects the m largest rainfall events that occur within the transposition domain at the duration of t hour from the n year rainfall dataset the m rainfall events are regarded as parent rainfall event catalog in this study we define m 200 rainfall events and the duration of t 288 h step 3 transpose rainfall events a maximum rainfall return period tmax needs to be defined rainyday model selects k rainfall events k follows a poisson distribution with a rate parameter λ λ m n from the parent rainfall event catalog at random each rainfall event is transposed by moving an east west distance δ x and a north south distance δ y δ x and δ y are picked from the distribution functions d x x and d y y which are decided by combining the spatial probability distribution of regional rainfall with the two dimensional probability density function eq 1 rainyday model calculates the t hour accumulated rainfall depths that occur within the watershed under different transposition distances respectively the maximum accumulated rainfall depth among the rainfall events is extracted and can be deemed as the maximum annual rainfall for the corresponding year 1 g 2 d x y σ 1 2 π σ 2 exp x 2 y 2 2 σ 2 where σ is the gaussian kernel width step 4 generate tmax annual rainfall maxima rainyday repeats step3 tmax times to create tmax of t hour annual rainfall maximas they are then ranked from smallest to largest according to their accumulated rainfall depths and further assigned a rank i i 1 2 t m a x on this basis annual exceedance probability p e i i t m a x and the return period t i 1 p e i for each of these ranks are computed step 5 uncertainty simulation of rainfall datasets rainyday repeats steps 3 and 4 n times to generate n tmax annual rainfall maximas in other words n intensity duration frequency curves i e each return period comprises n realizations can be built by rainyday it reflects the uncertainty of rainfall datasets for the watershed to improve the reliability of the results in this study we used 18 realizations of tmax 500 annual rainfall maximas for a sum of 9 000 rainfall events 3 2 runoff quality and quantity simulation 3 2 1 model description in this research swat was employed to simulate runoff quality and quantity for the study watershed it is a process based continuous time based all inclusive and quasi distributed hydrological and water quality model with the capabilities to simulate and predict discharge and nutrient transport at a watershed arnold et al 2012 it has been widely used to simulate and predict the impacts of climate change and human activities on hydrology and water quality especially for large scale and complex watersheds chen et al 2018 shen et al 2012 yang et al 2016 it has the advantages of high calculation efficiency good visualization and a wide range of applicative watersheds swat can simulate surface runoff by the soil conservation service scs curve method eq 2 in rainfall events dissolved and adsorbed phosphorus migrate with runoff and finally enter the river due to the fact that rainfall runoff can flush phosphorus in the soil in swat phosphorus carried into the river can be divided into two parts dissolved p and absorbed p attached to soil particles they are calculated by eqs 3 and 4 respectively more detailed documentation of the model can be found in neitsch et al 2011 2 q surf r day i a 2 r day i a s where q surf is the surface runoff on a given day r day is the rainfall depth on a given day i a is initial rainfall loss s is the retention parameter 3 p surf p solution s u r f â q surf ρ b â depth surf â k d s u r f where p surf is the amount of dissolved p in surface runoff p solution s u r f is the amount of dissolved p in the top 10 mm of soil q surf is the surface runoff generated on a given day ρ b is the soil density of the top 10 mm of soil depth surf is the depth of soil and k d s u r f is the soil separation coefficient 4 sedp surf 0 001 c orgp â q sed a hru â ε p â s e d where sed p surf is the amount of absorbed p attached to soil particles and c orgp is the concentration of organic p in the top 10 mm of soil and ε p â s e d is the p enrichment ratio and a hru is the area of hru and q sed is the amount of soil loss on a given day 3 2 2 modeling setup to reflect the spatial non uniformity of the watershed the dongjiang river watershed was delineated into 23 sub watersheds with a threshold area of 65 000 ha based on dem and the steam network to simulate more precisely the percentage thresholds of the land use soil class and soil class were set equal to 0 the sub watersheds were further subdivided into 1 288 hydrological response units hrus considering multiple factors such as land use soil type and slope map hru is the basic simulation unit with a unique combination of land use type soil property and slope it is assumed that hrus be independent units without interaction water yield and non point pollution were simulated and calculated at the hru level and then summed at the outlet of the sub watershed based on the channel network the simulation results were further calculated at the sub watershed level to obtain results of different river sections or the outlet of the watershed rainfall data was a key element that could significantly affect the simulation and prediction results of the hydrology water quality process within swat chen et al 2018 galván et al 2014 shen et al 2014 zhang et al 2021 swat automatically allocates one rain gauge for each sub watershed the closest to its centroid multiple sub watersheds may use the same rain gauge as rainfall input at the same time since the number of rainfall station is comparatively scarce in the upstream of the dongjiang river watershed fig 1 trmm was combined with rainyday model to generate the rainfall dataset which could fully reflect rainfall spatial and temporal variabilities of the watershed at the same time swat cannot directly take gridded rainfall as inputs all effective 0 25 rainfall grids within the sub watershed were set as the average values to create a virtual rain gauge for each sub watershed in space and then aggregated to the daily rainfall data in time duan et al 2019 ye et al 2016 as mentioned above the dongjiang river watershed was divided into 23 sub watersheds based on the dem and the steam network to understand the responses of runoff quality and quantity to rainfall spatial and temporal variabilities under multiple watershed scales 9 levels of nested watersheds i e grades 1 to 9 were further defined from upstream to downstream fig 4 based on the nested watershed theory and the relationships between tributaries and the mainstream chen et al 2019 zhu et al 2019 from grades 1 to 9 the drainage area gradually increased from 4 568 to 25 325 km2 thus nine river sections were selected and the dongjiang river watershed was divided into nine levels the model could be performed at multiple watershed scales 3 3 rainfall scenarios eight rainfall scenarios with multiple levels of spatial and temporal variabilities were defined to investigate the responses of runoff quality and quantity to rainfall spatial and temporal variabilities firstly we used rainyday model combined trmm to generate a large number of rainfall events for return periods ranging from 1 to 500 years each return period has 18 realizations these rainfall events with the same spatio temporal distribution characteristic as trmm were further processed by the method mentioned in the section 3 2 since the rainfall events varied from each day and each sub watershed they were regarded as the rainfall scenario with the highest level of spatial and temporal variabilities named 1dn in this research based on the 1dn rainfall scenario the rainfall events were resampled into eight rainfall scenarios through combining four temporal variability levels of 1 2 4 and 6 day fig 5 a d with two spatial variability levels of non uniformity and uniformity fig 5e f the characteristics of these eight rainfall scenarios were shown in table 1 the 72 000 i e 8 rainfall scenarios 500 return periods 18 realizations rainfall events were adopted to drive swat to simulate runoff quality and quantity the simulation results were obtained at the outlets of the nested watersheds i e sub watershed 3 7 8 11 13 16 17 18 and 19 to make the study conclusions comparable and eliminate random errors to the maximum extent possible the averages from the 18 realizations of runoff quality and quantity simulation results were considered for each watershed scale and each return period under an individual scenario the research mainly analyzed the impacts of the rainfall spatial and temporal variabilities on runoff quality and quantity rather than simulating the real runoff quantity quality process in the watershed therefore the comparative analysis of the difference between simulated and observed values was not the emphasis 3 4 two way anova to further quantitatively analyze the impacts of multiple factors two way analysis of variance anova was used to partition the total variabilities of runoff quality and quantity into different contributors anova which has a well established statistical basis and has been widely used concentrates on searching for a full explanation of different factors of the total variability gao et al 2020 qi et al 2016 vetter et al 2016 yip et al 2011 for example peleg et al 2017 used anova to identify the contributions of climate change and rainfall spatial variability to flood peak variability in this research the relative contributions of rainfall spatial and temporal variabilities were quantified separately employing anova for multiple watershed scales and return periods the total variability represented by the total sum of squares ss t in two way anova could be partitioned into three components respectively 5 s s t s s time s s space s s ts the terms on the right hand side represent the contributions of rainfall temporal variability ss time rainfall spatial variability ss space and their interaction effect ss t s 4 results and discussions 4 1 calibration and validation in this research swat was selected to build a model that can reflect the relationship among rainfall runoff and runoff quality tp as the runoff quality indicator for the dongjiang river watershed the observed runoff quantity data of the boluo station and the runoff quality monitoring data of the huizhou section fig 1c were obtained to calibrate and validate the model monthly tp concentrations were multiplied through monthly runoff quantification to estimate their monthly loads yang et al 2016 due to the lack of hydrological data at this monitoring station the monthly runoff quantity data came from the nearby lingxia hydrological station fig 1c nash efficiency coefficient ens certainty coefficient r2 and percent bias pbias were used to measure the applicability of the model moriasi 2007 the criteria for satisfactory simulation results of the swat model were ens 0 5 r2 0 6 and pbias 15 moriasi et al 2015 the soil and water assessment tool calibration and uncertainty procedure swat cup program was employed to firstly calibrate the parameters related to the runoff quantity and then the parameters impacting the associated migration processes of tp more details regarding the sensitivity parameters could be found in table s1 in the supplementary material the warming up period was two year i e from 2000 to 2001 and the simulation period was from 2002 to 2015 for runoff quantity the modeling was calibrated from 2002 to 2008 and validated from 2009 to 2015 at the daily scale fig 6 a the ens values during the calibration 2002 2008 and validation periods 2009 2015 were 0 79 and 0 65 respectively the r2 values during the calibration and validation periods were 0 79 and 0 68 respectively the absolute values of the pbias during the calibration and validation periods were 1 7 and 13 2 respectively owing to the lack of daily monitoring data for runoff quality i e tp the daily simulation results of runoff quality were accumulated and then compared with monthly monitoring data fig 6b as for tp the values of ens r2 and pbias were 0 72 0 72 and 5 4 in the calibration period 2004 2007 and 0 87 0 91 and 6 4 in the validation period 2008 2010 these results indicated that swat performed well at the dongjiang river watershed 4 2 runoff responses to rainfall spatial and temporal variabilities the main attention of the research was how runoff quality tp as the index and quantity are affected by rainfall spatial and or temporal variability rather than the realistic simulation the parameters and other conditions remained the same in the calibrated and validated model except for the rainfall spatial and or temporal distribution in this section we investigated how rainfall spatial variability and rainfall temporal variability individually considered affect the responses of runoff quality and quantity 4 2 1 impacts of rainfall spatial variability to investigate how rainfall spatial variability impacted runoff quantity and tp clearly and visually the simulation results of runoff quantity and tp were analyzed for multiple watershed scales and event magnitudes under the scenarios of rainfall spatial non uniformity and uniformity for visualization 1dn vs 1du and 4dn vs 4du were used as examples the rest of the simulated results were shown in figs s1 and s2 in the supporting material the simulation results of runoff quantity were compared for multiple watershed scales and discharge return periods under the four rainfall scenarios in fig 7 it could be seen that rainfall spatial variability had a notable impact on runoff quantity simulation and there were apparent differences at multiple watershed scales as illustrated in fig 7a c for headwater small watershed scales i e grade1 3 the simulation results of runoff quantity were overall higher under the 1du 4du rainfall scenario than those under the 1dn 4dn rainfall scenario as the watershed scale increases the opposite results appeared as shown in fig 7d f for grades 4 to 6 the simulation results of runoff quantity were generally higher under the scenario of rainfall spatial non uniformity i e 1dn or 4dn than those under the spatial uniformity scenario i e 1du or 4du despite the converse behaviors occurred when discharge return periods were relatively small in terms of grades 7 to 9 fig 7g i the simulation results of runoff quantity were higher under the scenario of rainfall spatial non uniformity rather than the scenario of spatial uniformity the difference overall increased with return periods at the grade 9 and the 5 return period for example simulated runoff quantity results declined from 2614 74 m3 s for the 1dn rainfall scenario to 2 462 55 m3 s for the 1du rainfall scenario we investigated the potential explanation of the above results at multiple watershed scales these were related to many factors such as the rainfall spatial distribution characteristic of the watershed watershed scales and certain physical phenomena the rainfall probability at the upstream area was much less than that at the midstream and downstream area fig 4f by means of averaging rainfall for the entire watershed rainfall would increase significantly at grades 1 to 3 resulting in a greater proportion of the rainfall contributing to runoff and larger surface runoff generation on the other hand the relatively small watershed scales had a relatively rapid and direct response to rainfall and were more likely to increase in runoff magnitude do et al 2017 zhu et al 2019 as for larger watershed scales i e grades 4 to 9 the results obtained could also be explained based on certain physical phenomena under the scenario of rainfall spatial non uniformity rainfall would be mainly concentrated in certain areas i e some sub watersheds resulting in obvious differences in the runoff quantity of different sub watersheds at least a number of areas had higher runoff coefficient and larger runoff quantity on the contrary when fine scale spatial distribution was eliminated through averaging rainfall over the entire watershed more rainfall would infiltrate and the runoff coefficient was comparatively lower resulting in less runoff quantity at grades 4 to 9 darras et al 2015 zhu et al 2018 fig 8 compared the simulation results of tp for multiple watershed scales and discharge return periods under the four rainfall scenarios rainfall spatial variability had a notable effect on tp and the performance also varies with watershed scale as showed in fig 8a c the values of tp were higher under the scenario of rainfall spatial uniformity than those under the scenario of rainfall spatial non uniformity at the relatively small watershed scales i e grades 1 3 as shown in fig 8d i the values of tp were generally higher under the scenario of rainfall spatial non uniformity rather than the scenario of rainfall spatial uniformity with respect to the larger watershed scales i e grades 4 9 the difference had an increasing trend with the increasing return periods for example simulated tp results ranged from 248 20 32 14 t for the 1dn rainfall scenario to 232 85 34 03 t for the 1du rainfall scenario at the 5 return period and the grade9 grade3 as a result rainfall spatial variability notably affected tp at multiple watershed scales the response of tp to rainfall spatial variability was similar to that of runoff quantity cho et al 2009 rainfall especially storms runoff is generally regarded as a vital factor that washes the soil drives pollutant migration and further carries the most pollutants from soil into the receiving water the previous studies indicated that rainfall intension had strong effects on tp load ockenden et al 2016 qiu et al 2019 by means of the numerical simulation our findings showed that rainfall spatial distribution also affected tp transport at the watershed the rainfall spatial variability would affect the characteristics of runoff generation and confluence which might further change pollutant transport larger runoff quantity had the ability to transport more tp from land to water it could also enhance erosive power and washing effect which could mobilize more adsorbed tp at the watershed drewry et al 2006 lintern et al 2018 4 2 2 impact of rainfall temporal variability to investigate how rainfall temporal variability impacts runoff quality and quantity explicitly and intuitively the simulation results of runoff quality and quantity were analyzed under four temporal variability levels i e 1 2 4 and 6 day of rainfall while maintaining the same spatial distribution under the scenario of rainfall spatial non uniformity the differences among the simulation results of runoff quantity and tp driven by four rainfall scenarios i e 1dn vs 2dn vs 4dn vs 6dn under multiple watershed scales and discharge return periods are presented in figs 9 and 10 it was clear that rainfall temporal variability could have a notable impact on tp and runoff quantity for a given return period the values of tp and runoff quantity ranked generally from high to low as 1dn 2dn 4dn and 6dn for instance at the grade 9 and the return period of 5 years the simulated tp runoff quantity results for the rainfall scenarios of 1dn 2dn 4dn and 6dn were 248 20 t 237 24 t 232 02 t and 207 43 t 2 614 74 m3 s 2 501 95 m3 s 2 438 50 m3 s and 2 222 25 m3 s respectively under the scenario of rainfall spatial uniformity the similar regularity was showed in figs 11 and 12 the highest values of tp and runoff quantity were generally obtained under the 1du rainfall scenario whereas the lowest values were generally obtained under the 6du rainfall scenario the rainfall temporal variability also had notable effects on the runoff generation and confluence which further affected the pollutant transport at the watershed the results indicated that the higher the temporal variability level was the larger the simulated result was likely since larger instantaneous runoff responded to higher rain rate variability the temporal variability of rainfall decreased by time aggregation as shown in fig 5a d during the rainfall event rainfall tended to equalization which might increase the rainfall infiltration decline the generation of surface runoff and the transport of tp accordingly debele et al 2008 merz et al 2006 the results indicated that the values of tp and runoff quantity generally increased along with the levels of rainfall temporal variability at all watershed scales whether rainfall space was uniform or not however the differences caused by rainfall temporal variability were more apparent with the increasing watershed scales under the scenario of rainfall spatial non uniformity than those under the scenario of rainfall spatial uniformity figs 9 12 this might be related to the similar runoff loss rate when spatial variability is eliminated by averaging rainfall at the entire watershed under the scenario of non uniform rainfall space rainfall was concentrated in the middle and lower reaches of the watershed fig 4f and the runoff coefficients at multiple watershed scales could have relatively obvious differences the areas with comparatively high runoff coefficient might be more susceptible to rainfall temporal variabilities 4 2 3 difference between runoff quality and quantity variabilities the above results indicated that the responses of tp to rainfall spatial and temporal variabilities were similar to those of runoff quantity however there was a certain degree of difference between them for further comparison the relative differences rd i t of the simulation results of runoff quantity and tp were calculated 6 rd i t y i t x i t y i t where y i t was the average tp or runoff quantity of the 18 realizations at grade i and discharge return period t under a relatively higher level of rainfall spatial or temporal variability e g 1dn while x i t was the corresponding value under a relatively lower level of spatial or rainfall temporal variability e g 1du for simplicity and representativeness 1dn vs 1du 1dn vs 4dn and 1du vs 4du were used as examples the rest of the results were shown in fig s3 in the supporting material the overall distribution of the relative differences of tp and runoff quantity were shown in fig 13 a c according to the positions of box components i e the 1st 3rd quartiles and median line the relative differences of tp were overall greater than those of runoff quantity at multiple watershed scales it was obvious that rainfall spatial and temporal variabilities under multiple watershed scales had greater impacts on tp than runoff quantity to certain extent shen et al 2012 and alnahit et al 2020 also drew similar conclusions the variation associated with rainfall spatial and temporal variabilities might be transferred and magnified into tp simulation within swat it could be explained by the fact that the mechanism of the pollutant migration and transformation was complicated which was controlled by the rainfall hydrology process and watershed characteristics shen et al 2014 4 3 relative contributions of rainfall spatial and temporal variabilities the above results indicated that tp and runoff quantity were notably affected by rainfall spatial and temporal variabilities to further quantitatively and qualitatively analyze the relative contributions of rainfall spatial and temporal variabilities to the total variabilities of tp and runoff quantity under multiple watershed scales and discharge return periods two way anova was employed in this section figs 14 and 15 presented the relative contributions of rainfall spatial variability rainfall temporal variability and their interaction effect to the total variabilities of runoff quantity and tp respectively the contribution of each factor varied apparently with discharge return periods and watershed scales at the smaller watershed scales i e grades 1 3 rainfall spatial variability was the dominant factor to the total variabilities of tp and runoff quantity as the scale increases the results were significantly disparate at the larger watershed scales i e grades 4 9 the relative contribution of rainfall temporal variability was greater than that of rainfall spatial variability for relatively small return periods approximately from 1 to 41 year the relative contribution of rainfall spatial variability increased with return periods which was greater than that of temporal variability for larger return periods approximately from 41 to 500 year the contribution of the interaction effect was generally lower than 15 in conclusion rainfall spatial variability could have a relatively significant impact on runoff quality tp as the index and quantity for headwater relatively small watershed scales i e grades 1 3 for relatively large watershed scales i e grades 4 9 rainfall temporal variability was more important than rainfall spatial variability for small return periods whereas the opposite results were obtained for relatively large return periods these results were different from the conclusions of the research by zhu et al 2018 who found that temporal spatial rainfall variability was relatively important at small large watersheds for turkey river this was due to the fact that apart from different watershed areas and watershed characteristics zhu et al 2018 was based on the hourly scale while this study was based on the daily scale small watershed scales would have the relatively small time for runoff confluence and pollutant migration the daily scale of rainfall input might be larger than the runoff confluence time and travel time of tp at grades 1 to 3 which diminished the relative contribution of rainfall temporal variability at the small watershed scales to certain extent jin et al 2020 as for larger watershed scales the contribution of rainfall spatial variability was relatively inconspicuous for small return periods due to the fact that the rainfall spatial scale that we selected was still relatively coarse as the return period increases the heavy rain might localize at some sub watersheds and the rainfall spatial variability would become more significant this might significantly enhance the impacts of rainfall spatial variability while the contribution of temporal variability decreased accordingly for relatively larger return periods the results implied the complex relationship among rainfall spatial and temporal variabilities runoff quantity and runoff quality in conjunction with watershed scales and event magnitudes accurate runoff quality and quantity analyses using hydrological and water quality models demand to pay attention to rainfall spatial and temporal variabilities of the watershed 5 conclusions in this research the impacts of rainfall spatial and temporal variabilities on runoff quality regard tp as the indicator and quantity were investigated under multiple watershed scales and event magnitudes rainfall hazard modeling system rainyday model was combined with the tropical rainfall measuring mission trmm rainfall product to generate quantities of rainfall events these rainfall events were resampled into eight rainfall scenarios with multiple levels of spatial and temporal variabilities these rainfall scenarios were used as input to the soil and water assessment tool swat to simulate runoff quality and quantity for multiple watershed scales and return periods from 1 to 500 years at the dongjiang river watershed in china analysis of variance anova was used to evaluate the relative importance of rainfall spatial and temporal variabilities the main conclusions were as follows a at the headwater small watershed scales runoff quality and quantity were higher under the rainfall spatial uniformity scenario rather than the rainfall spatial non uniformity scenario at the larger watershed scales the opposite results appeared the spatial non uniformity scenario had higher runoff quality and quantity than the spatial uniformity scenario the values of runoff quality and quantity increased along with the levels of rainfall temporal variability for a given return period and watershed scale moreover the responses of runoff quality to rainfall spatial and temporal variabilities were similar to those of runoff quantity whereas runoff quality was more sensitive than runoff quantity and b on the whole the impact of rainfall spatial variability on runoff quality and quantity was greater than that of rainfall temporal variability for small watershed scales for larger watershed scales rainfall temporal variability had a more important impact than spatial variability for small return periods whereas the opposite results were observed for relatively large return periods the results might be mainly caused by the following reasons 1 rainfall was concentrated in the middle and lower reaches of the watershed 2 the study was based on the daily scale the research found that runoff quality and quantity analyses based on a hydrological and water quality model were sensitive to the level of rainfall spatial and temporal variabilities it provided recommendations for modelers to select appropriate rainfall data and highlighted that spatial and temporal variabilities of rainfall input should be taken into account when using a hydrological and water quality model to analyze the variations of runoff quality and quantity due to the limitations of data and other objective conditions in this research we merely focused on a typical watershed i e dongjiang river watershed and a typical runoff quality index i e tp it was not clear how generalizable our results were similar to other watersheds or runoff quality indexes the regulations of other runoff quality indicators or other watersheds still need to be studied on the other hand spatial and temporal distributions of rainfall were still relatively coarse in this research further studies are required to refine rainfall spatial and temporal distributions to investigate the mechanism in depth in addition further studies are needed to expand the capabilities of the rainyday satellite rainfall data hydrological and water quality model framework for improving the accuracy of design rainfall and hydrological and water quality simulation another future research is needed to comprehensively consider both spatio temporal variability of rainfall and the optimal design of rain gauges network such as the locations of rain gauges and sample intervals in order to capture the reasonable spatial and temporal distribution of rainfall for hydrological and water quality modeling credit authorship contribution statement wenjie zhou software validation formal analysis data curation visualization writing original draft writing review editing supervision zhihua zhu conceptualization methodology writing review editing supervision yulei xie writing review editing yanpeng cai data curation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the key area research and development program of guangdong province 2020b1111380003 the program for guangdong introducing innovative and enterpreneurial teams 2019zt08l213 and the national natural science foundation of china 51879007 u20a20117 and 52009021 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127057 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3945,due to climate change and human disturbances rainfall spatial and temporal variabilities at the watershed have become increasingly prominent significantly impacting the patterns of runoff generation and pollutant transportation originally rainfall variabilities in space and time were frequently neglected or idealized in the traditional applications of hydrology and water quality models this research attempted to investigate the responses of runoff quality and quantity simulation to rainfall spatial and temporal variabilities we used rainfall hazard modeling system rainyday model combined with trmm tropical rainfall measuring mission rainfall products to generate rainfall events for 500 return periods such events were resampled into eight rainfall scenarios with multiple levels of spatial and temporal variabilities they were used to drive the soil and water assessment tool swat to simulate runoff quality tp as the index and quantity under multiple watershed scales and return periods at the dongjiang river watershed analysis of variance was employed to analyze the relative contributions of rainfall spatial and temporal variabilities to the total variabilities of runoff quality and quantity the results highlighted that rainfall spatial and temporal variabilities would have notable impacts on runoff quality and quantity under multiple watershed scales and event magnitudes for headwater at small watershed scales rainfall spatial variability would have a relatively significant impact on runoff quality and quantity for relatively larger watershed scales rainfall temporal variability showed an increasingly important impact than spatial variability for smaller return periods whereas the opposite results can be obtained for relatively larger return periods the results can be caused by the following reasons 1 rainfall was concentrated in the middle and lower reaches of the watershed 2 it was based on the daily scale our research suggested that attention should be paid to spatial and temporal variabilities of rainfall inputs in hydrological and water quality models keywords runoff quality and quantity spatial and temporal variabilities swat rainyday dongjiang river watershed 1 introduction due to the combined effects of climate change and human disturbances spatial and temporal variabilities of rainfall have become increasingly prominent in many watersheds significantly affecting runoff generation and confluence patterns and the associated pollutant migration processes cai et al 2018 gebrechorkos et al 2020 grusson et al 2021 miralha et al 2021 verma et al 2015 for example frequencies of record breaking rainfall and flood events have increased globally kendon et al 2014 mann et al 2017 sabine 2014 particularly even a small scale rainfall event may drive large scale runoff and pollutant loading that may cause flooding and water deterioration risks baker and showers 2019 xie et al 2019 the impacts of rainfall spatial and temporal variabilities on runoff quality and quantity are complex and significantly affected by multiple factors such as watershed scales and rainfall event magnitudes chen et al 2017 along with the development and improvement in hydrological and water quality modeling a large number of studies employed them to analyze responses of rainfall and runoff abbaspour et al 2015 tuo et al 2016 wu et al 2012 yang et al 2020 however due to the limits in spatio temporal structure and the length of time series for rainfall data many previous studies frequently neglected or might idealize the spatial and temporal distribution characteristics of rainfall to simulate the responses of runoff for a number of watersheds shen et al 2014 zhu et al 2018 for example the soil and water assessment tool swat which is a widely used tool for runoff quality and quantity simulation automatically allocates one rain gauge for each sub watershed the closest to its centroid multiple sub watersheds may use the same rain gauge as rainfall input in the areas with scarce rain gauge which lead to the simplification of rainfall spatial and temporal distribution kim et al 2011 rong et al 2016 2017 shen et al 2012 wagner et al 2011 neglecting or idealizing spatial and temporal variabilities of rainfall may lead to great uncertainties in runoff simulation through hydrological and water quality models therefore it is necessary to understand the responses of runoff to rainfall spatial and temporal variabilities which is extremely desired for facilitating the formulation of flood control and water quality management strategies the previous researchers discussed the importance of rainfall spatial and temporal distributions in runoff quantity and quality meselhe et al 2009 reported that spatial and temporal variabilities of rainfall had important impacts on physically based models than those on conceptual ones tan and yang 2020 pointed out that temporal variability of rainfall caused a strong impact on simulated runoff based on the swat sucozhañay and célleri 2018 and chaplot 2014 concluded that rainfall spatial variability could significantly affect the simulated runoff results through setting scenarios of multiple rain gauge densities within a small watershed fu et al 2011 stated that the effects of spatial rainfall variability on runoff simulation could be reduced along with increasing watershed area and could even be ignored for a watershed with area over 1 000 km2 shen et al 2012 highlighted that rainfall data with huge spatial variability could greatly affect the simulated results of the hydrologic and water quality model at a large and complex watershed 4 426 km2 it was found that there have been conflicting conclusions probably because most of these studies were based on the watersheds with different rainfall spatio temporal distribution characteristics or limited numbers of rainfall events a few studies found that the effect of rainfall variability could be transferred from runoff quantity to quality alnahit et al 2020 chen et al 2019 shen et al 2012 chen et al 2019 found that total phosphorus tp simulation was more sensitive to the variabilities of rainfall inputs than that of flow simulation cho et al 2009 also demonstrated that the impact of rainfall spatial variability was larger on the simulated tp than that on flow simulation based on swat many studies indicated that rainfall spatial and temporal variabilities played an extremely important role which had profound impacts on runoff quality and quantity simulation however there are fewer studies on comparison and quantification of the runoff quality and quantity responses that might be forced by multiple levels of rainfall temporal and spatial variabilities therefore understanding and quantifying the impacts of rainfall spatial and temporal variabilities on runoff quality and quantity are desired especially for the runoff quality rainfall data from a gauge is a fundamental source for runoff quality and quantity analyses based on hydrologic and water quality modeling tan and yang 2020 there would be a lack of rain gauges in a large scale watershed due to the costs and difficulties in on site monitoring with the development of satellite and radar technologies a number of rainfall products have been continuously developed and improved which could well capture spatial and temporal variabilities of regional rainfall li et al 2018 lintern et al 2018 ma et al 2019 peng et al 2021 terink et al 2018 wedajo et al 2021 and provide new and complementary data sources for exploring the responses of rainfall runoff and runoff quality tobin and bennett 2013 used five rainfall products to drive swat models and evaluated the differences in runoff simulation under multiple time scales alnahit et al 2020 employed multiple rainfall products as inputs to the swat model and found the uncertainties of rainfall products further impacted runoff quality and quantity simulation the related studies combined high resolution rainfall products with stochastic rainfall generators which can not only overcome the shortcoming of ignoring rainfall spatial and temporal variabilities but also effectively expand the sequence of rainfall data peleg et al 2017 combined radar rainfall data with a stochastic rainfall generator and concluded that spatial rainfall variability affected runoff simulation increasing with return periods rainfall products with multiple levels of spatial and temporal variabilities have great disparities it is still unclear how these disparities affect the simulation of runoff quality and quantity for multiple watershed scales and event magnitudes the main objective of this research is to investigate how runoff quality and quantity be affected by rainfall spatial and temporal variabilities under multiple watershed scales and event magnitudes through the adoption of numerical simulation the developed approach in this research is to combine the rainfall product and the stochastic rainfall generator with hydrologic and water quality modeling to simulate large samples of runoff quality and quantity under multiple watershed scales and event magnitudes multiple rainfall scenarios with multiple levels of rainfall spatial and temporal variabilities will be reflected and considered the simulated results are then analyzed through the employment of statistic methods in detail 1 the main purpose of this research is not to obtain more realisticrunoff quality and quantity simulation rather to understand how runoff quality and quantity are impacted by rainfall spatial and temporal variabilities and 2 relatively coarse rainfall temporal scenarios in this research will be used to match the accuracy of runoff data this research could facilitate the understanding of the responses of runoff quality and quantity to rainfall spatial and temporal variabilities further how the responses vary with watershed scale and event magnitude will be investigated 2 study area and data 2 1 overview of the study area the dongjiang river 22 20 34 to 25 12 n 113 24 to 115 52 e is one of the most important watersheds in south china fig 1 the mainstream flows from northeast to southwest with a length of 562 km the main hydrological station named boluo controls a drainage area of 25 325 km2 the terrain with large fluctuation is generally higher in the northeast but lower in the southwest major land use types of the watershed are forest urban and agriculture the watershed has the typical subtropical monsoon climate and receives an abundant annual rainfall ranging from 1 500 to 2 400 mm year lai et al 2020 on account of the terrain and monsoon cycle the spatio temporal distribution of rainfall is considerably non uniform at the watershed the rainfall accounts for over 80 of the total annual rainfall during the flood season from april to october in terms of rainfall space it is usually concentrated in the middle and lower reaches of the watershed gradually decreasing from south to north the dongjiang river watershed is extremely vital to the guangdong hong kong macau greater bay ghmb area which is a world class urban agglomeration li et al 2020 it is one of the major freshwater sources shouldering production domestic and ecological water for nearly 40 million people in several megacities such as guangzhou shenzhen and hong kong however with the rapid social and economic development the watershed is strongly disturbed by intensive human activities there are many sources of non point source pollution and the pollutants can be discharged into a river along with rainfall runoff resulting in increased deterioration of runoff quality and serious water safety issues ongley et al 2010 according to the monitoring and tracking results of pollutants over the years tp pollution is prominent among many pollutants at the dongjiang river watershed wu and chen 2013 thus tp is set as the representative indicator of runoff quality in this research responses of runoff quality and quantity to rainfall spatial and temporal variabilities can be performed 2 2 data the basic data to build the hydrological and water quality model for the dongjiang river watershed include data of digital elevation model dem land use soil meteorological and hydrological conditions as well as water quality information specifically dem was obtained from the computer network information center chinese academy of sciences http www gscloud cn land use data were obtained from the data center for resources and environmental sciences of the chinese academy of sciences http www resdc cn soil data included the soil map and the related soil physical properties were collected from the harmonized world soil database developed by the food and agriculture organization of the united nations http www fao org daily rainfall data from21 rain gauges in the watershed were provided by the water conservancy and electric power bureau in guangdong province in china daily maximum and minimum temperatures wind speed relative humidity solar radiation were collected from the china national climatic data share center v3 0 which originates from the national meteorological information center china meteorological administration http data cma cn daily measured runoff quantity data 2002 2015 at the boluo hydrological gauge and monthly measured runoff quantity data 2004 2010 at the lingxia hydrological gauge were provided by the water conservancy and electric power bureau in guangdong province in china monthly measured runoff quality data 2004 2010 at the huizhou runoff quality monitoring gauge were provided by the environment monitoring center of guangdong province in china at the same time the tropical rainfall measuring mission trmm rainfall product is selected as the basic data and coupled with the rainfall hazard modeling system rainyday model described in section 3 1 to generate a large number of rainfall events the rainfall product has a 3 h temporal resolution and a 0 25 0 25 spatial resolution trmm rainfall product had good applications in precipitation measurement hydrologic and water quality modeling khatakho et al 2021 musie et al 2019 prakash 2019 chen et al 2011 indicated that trmm had a good correlation with the observed rainfall from rain gauges at the dongjiang river watershed 3 methodology to investigate the impacts of rainfall spatial and temporal variabilities on runoff quality and quantity at the watershed the rainyday model with trmm rainfall product were coupled to generate 12 day i e 288 hour rainfall events with the same spatio temporal distribution as trmm under multiple rainfall intensity levels these rainfall events were then resampled into eight scenarios with multiple levels of spatial and temporal variabilities they were employed as rainfall input to the hydrological and water quality model for the watershed based on the nested watershed theory and the relationships between the tributaries and the mainstream the watershed was divided into nine levels of nest watersheds to reveal the variations in runoff quality and quantity for multiple watershed scales analysis of variance anova was adopted to quantitatively identify the relative contributions of rainfall spatial and temporal variabilities to the total variabilities of runoff quality and quantity under multiple watershed scales and event magnitudes the framework for the methodology in this research was shown in fig 2 3 1 rainy event generation rainfall hazard modeling system rainyday model is an open source python based software developed by wright et al 2017 the model takes the stochastic storm transposition technology as the core and uses reanalysis measured or other remote sensing grid rainfall datasets as the basic data it expands rainfall records of the watershed by transposing the spatial positions of observed rainfall events from the surrounding region that has similar meteorological features to the study watershed the procedure merely alters rainfall locations but does not change its spatial and temporal distribution characteristics which could overcome the defect of the traditional methods based on the idealized spatial and temporal distribution of rainfall such as spatial interpolation and adjacent rain gauge substitution to facilitate the understanding of the model we sketched the transposition procedure for a single rainfall event fig 3 a detailed description could be found in wright et al 2017 wright et al 2020 yu et al 2019 zhou et al 2019 and zhu et al 2018 the following five steps briefly describe how the model generates new rainfall events step 1 identify a transposition domain according to the spatial probability distribution characteristics of regional rainfall a transposition domain needs to be identified with similar rainfall pattern and intensity to the interested watershed the domain the grey area in fig 3 needs to encompass the watershed step 2 define parent rainfall event catalog a number of rainfall events m and a duration t need to be defined firstly rainyday model selects the m largest rainfall events that occur within the transposition domain at the duration of t hour from the n year rainfall dataset the m rainfall events are regarded as parent rainfall event catalog in this study we define m 200 rainfall events and the duration of t 288 h step 3 transpose rainfall events a maximum rainfall return period tmax needs to be defined rainyday model selects k rainfall events k follows a poisson distribution with a rate parameter λ λ m n from the parent rainfall event catalog at random each rainfall event is transposed by moving an east west distance δ x and a north south distance δ y δ x and δ y are picked from the distribution functions d x x and d y y which are decided by combining the spatial probability distribution of regional rainfall with the two dimensional probability density function eq 1 rainyday model calculates the t hour accumulated rainfall depths that occur within the watershed under different transposition distances respectively the maximum accumulated rainfall depth among the rainfall events is extracted and can be deemed as the maximum annual rainfall for the corresponding year 1 g 2 d x y σ 1 2 π σ 2 exp x 2 y 2 2 σ 2 where σ is the gaussian kernel width step 4 generate tmax annual rainfall maxima rainyday repeats step3 tmax times to create tmax of t hour annual rainfall maximas they are then ranked from smallest to largest according to their accumulated rainfall depths and further assigned a rank i i 1 2 t m a x on this basis annual exceedance probability p e i i t m a x and the return period t i 1 p e i for each of these ranks are computed step 5 uncertainty simulation of rainfall datasets rainyday repeats steps 3 and 4 n times to generate n tmax annual rainfall maximas in other words n intensity duration frequency curves i e each return period comprises n realizations can be built by rainyday it reflects the uncertainty of rainfall datasets for the watershed to improve the reliability of the results in this study we used 18 realizations of tmax 500 annual rainfall maximas for a sum of 9 000 rainfall events 3 2 runoff quality and quantity simulation 3 2 1 model description in this research swat was employed to simulate runoff quality and quantity for the study watershed it is a process based continuous time based all inclusive and quasi distributed hydrological and water quality model with the capabilities to simulate and predict discharge and nutrient transport at a watershed arnold et al 2012 it has been widely used to simulate and predict the impacts of climate change and human activities on hydrology and water quality especially for large scale and complex watersheds chen et al 2018 shen et al 2012 yang et al 2016 it has the advantages of high calculation efficiency good visualization and a wide range of applicative watersheds swat can simulate surface runoff by the soil conservation service scs curve method eq 2 in rainfall events dissolved and adsorbed phosphorus migrate with runoff and finally enter the river due to the fact that rainfall runoff can flush phosphorus in the soil in swat phosphorus carried into the river can be divided into two parts dissolved p and absorbed p attached to soil particles they are calculated by eqs 3 and 4 respectively more detailed documentation of the model can be found in neitsch et al 2011 2 q surf r day i a 2 r day i a s where q surf is the surface runoff on a given day r day is the rainfall depth on a given day i a is initial rainfall loss s is the retention parameter 3 p surf p solution s u r f â q surf ρ b â depth surf â k d s u r f where p surf is the amount of dissolved p in surface runoff p solution s u r f is the amount of dissolved p in the top 10 mm of soil q surf is the surface runoff generated on a given day ρ b is the soil density of the top 10 mm of soil depth surf is the depth of soil and k d s u r f is the soil separation coefficient 4 sedp surf 0 001 c orgp â q sed a hru â ε p â s e d where sed p surf is the amount of absorbed p attached to soil particles and c orgp is the concentration of organic p in the top 10 mm of soil and ε p â s e d is the p enrichment ratio and a hru is the area of hru and q sed is the amount of soil loss on a given day 3 2 2 modeling setup to reflect the spatial non uniformity of the watershed the dongjiang river watershed was delineated into 23 sub watersheds with a threshold area of 65 000 ha based on dem and the steam network to simulate more precisely the percentage thresholds of the land use soil class and soil class were set equal to 0 the sub watersheds were further subdivided into 1 288 hydrological response units hrus considering multiple factors such as land use soil type and slope map hru is the basic simulation unit with a unique combination of land use type soil property and slope it is assumed that hrus be independent units without interaction water yield and non point pollution were simulated and calculated at the hru level and then summed at the outlet of the sub watershed based on the channel network the simulation results were further calculated at the sub watershed level to obtain results of different river sections or the outlet of the watershed rainfall data was a key element that could significantly affect the simulation and prediction results of the hydrology water quality process within swat chen et al 2018 galván et al 2014 shen et al 2014 zhang et al 2021 swat automatically allocates one rain gauge for each sub watershed the closest to its centroid multiple sub watersheds may use the same rain gauge as rainfall input at the same time since the number of rainfall station is comparatively scarce in the upstream of the dongjiang river watershed fig 1 trmm was combined with rainyday model to generate the rainfall dataset which could fully reflect rainfall spatial and temporal variabilities of the watershed at the same time swat cannot directly take gridded rainfall as inputs all effective 0 25 rainfall grids within the sub watershed were set as the average values to create a virtual rain gauge for each sub watershed in space and then aggregated to the daily rainfall data in time duan et al 2019 ye et al 2016 as mentioned above the dongjiang river watershed was divided into 23 sub watersheds based on the dem and the steam network to understand the responses of runoff quality and quantity to rainfall spatial and temporal variabilities under multiple watershed scales 9 levels of nested watersheds i e grades 1 to 9 were further defined from upstream to downstream fig 4 based on the nested watershed theory and the relationships between tributaries and the mainstream chen et al 2019 zhu et al 2019 from grades 1 to 9 the drainage area gradually increased from 4 568 to 25 325 km2 thus nine river sections were selected and the dongjiang river watershed was divided into nine levels the model could be performed at multiple watershed scales 3 3 rainfall scenarios eight rainfall scenarios with multiple levels of spatial and temporal variabilities were defined to investigate the responses of runoff quality and quantity to rainfall spatial and temporal variabilities firstly we used rainyday model combined trmm to generate a large number of rainfall events for return periods ranging from 1 to 500 years each return period has 18 realizations these rainfall events with the same spatio temporal distribution characteristic as trmm were further processed by the method mentioned in the section 3 2 since the rainfall events varied from each day and each sub watershed they were regarded as the rainfall scenario with the highest level of spatial and temporal variabilities named 1dn in this research based on the 1dn rainfall scenario the rainfall events were resampled into eight rainfall scenarios through combining four temporal variability levels of 1 2 4 and 6 day fig 5 a d with two spatial variability levels of non uniformity and uniformity fig 5e f the characteristics of these eight rainfall scenarios were shown in table 1 the 72 000 i e 8 rainfall scenarios 500 return periods 18 realizations rainfall events were adopted to drive swat to simulate runoff quality and quantity the simulation results were obtained at the outlets of the nested watersheds i e sub watershed 3 7 8 11 13 16 17 18 and 19 to make the study conclusions comparable and eliminate random errors to the maximum extent possible the averages from the 18 realizations of runoff quality and quantity simulation results were considered for each watershed scale and each return period under an individual scenario the research mainly analyzed the impacts of the rainfall spatial and temporal variabilities on runoff quality and quantity rather than simulating the real runoff quantity quality process in the watershed therefore the comparative analysis of the difference between simulated and observed values was not the emphasis 3 4 two way anova to further quantitatively analyze the impacts of multiple factors two way analysis of variance anova was used to partition the total variabilities of runoff quality and quantity into different contributors anova which has a well established statistical basis and has been widely used concentrates on searching for a full explanation of different factors of the total variability gao et al 2020 qi et al 2016 vetter et al 2016 yip et al 2011 for example peleg et al 2017 used anova to identify the contributions of climate change and rainfall spatial variability to flood peak variability in this research the relative contributions of rainfall spatial and temporal variabilities were quantified separately employing anova for multiple watershed scales and return periods the total variability represented by the total sum of squares ss t in two way anova could be partitioned into three components respectively 5 s s t s s time s s space s s ts the terms on the right hand side represent the contributions of rainfall temporal variability ss time rainfall spatial variability ss space and their interaction effect ss t s 4 results and discussions 4 1 calibration and validation in this research swat was selected to build a model that can reflect the relationship among rainfall runoff and runoff quality tp as the runoff quality indicator for the dongjiang river watershed the observed runoff quantity data of the boluo station and the runoff quality monitoring data of the huizhou section fig 1c were obtained to calibrate and validate the model monthly tp concentrations were multiplied through monthly runoff quantification to estimate their monthly loads yang et al 2016 due to the lack of hydrological data at this monitoring station the monthly runoff quantity data came from the nearby lingxia hydrological station fig 1c nash efficiency coefficient ens certainty coefficient r2 and percent bias pbias were used to measure the applicability of the model moriasi 2007 the criteria for satisfactory simulation results of the swat model were ens 0 5 r2 0 6 and pbias 15 moriasi et al 2015 the soil and water assessment tool calibration and uncertainty procedure swat cup program was employed to firstly calibrate the parameters related to the runoff quantity and then the parameters impacting the associated migration processes of tp more details regarding the sensitivity parameters could be found in table s1 in the supplementary material the warming up period was two year i e from 2000 to 2001 and the simulation period was from 2002 to 2015 for runoff quantity the modeling was calibrated from 2002 to 2008 and validated from 2009 to 2015 at the daily scale fig 6 a the ens values during the calibration 2002 2008 and validation periods 2009 2015 were 0 79 and 0 65 respectively the r2 values during the calibration and validation periods were 0 79 and 0 68 respectively the absolute values of the pbias during the calibration and validation periods were 1 7 and 13 2 respectively owing to the lack of daily monitoring data for runoff quality i e tp the daily simulation results of runoff quality were accumulated and then compared with monthly monitoring data fig 6b as for tp the values of ens r2 and pbias were 0 72 0 72 and 5 4 in the calibration period 2004 2007 and 0 87 0 91 and 6 4 in the validation period 2008 2010 these results indicated that swat performed well at the dongjiang river watershed 4 2 runoff responses to rainfall spatial and temporal variabilities the main attention of the research was how runoff quality tp as the index and quantity are affected by rainfall spatial and or temporal variability rather than the realistic simulation the parameters and other conditions remained the same in the calibrated and validated model except for the rainfall spatial and or temporal distribution in this section we investigated how rainfall spatial variability and rainfall temporal variability individually considered affect the responses of runoff quality and quantity 4 2 1 impacts of rainfall spatial variability to investigate how rainfall spatial variability impacted runoff quantity and tp clearly and visually the simulation results of runoff quantity and tp were analyzed for multiple watershed scales and event magnitudes under the scenarios of rainfall spatial non uniformity and uniformity for visualization 1dn vs 1du and 4dn vs 4du were used as examples the rest of the simulated results were shown in figs s1 and s2 in the supporting material the simulation results of runoff quantity were compared for multiple watershed scales and discharge return periods under the four rainfall scenarios in fig 7 it could be seen that rainfall spatial variability had a notable impact on runoff quantity simulation and there were apparent differences at multiple watershed scales as illustrated in fig 7a c for headwater small watershed scales i e grade1 3 the simulation results of runoff quantity were overall higher under the 1du 4du rainfall scenario than those under the 1dn 4dn rainfall scenario as the watershed scale increases the opposite results appeared as shown in fig 7d f for grades 4 to 6 the simulation results of runoff quantity were generally higher under the scenario of rainfall spatial non uniformity i e 1dn or 4dn than those under the spatial uniformity scenario i e 1du or 4du despite the converse behaviors occurred when discharge return periods were relatively small in terms of grades 7 to 9 fig 7g i the simulation results of runoff quantity were higher under the scenario of rainfall spatial non uniformity rather than the scenario of spatial uniformity the difference overall increased with return periods at the grade 9 and the 5 return period for example simulated runoff quantity results declined from 2614 74 m3 s for the 1dn rainfall scenario to 2 462 55 m3 s for the 1du rainfall scenario we investigated the potential explanation of the above results at multiple watershed scales these were related to many factors such as the rainfall spatial distribution characteristic of the watershed watershed scales and certain physical phenomena the rainfall probability at the upstream area was much less than that at the midstream and downstream area fig 4f by means of averaging rainfall for the entire watershed rainfall would increase significantly at grades 1 to 3 resulting in a greater proportion of the rainfall contributing to runoff and larger surface runoff generation on the other hand the relatively small watershed scales had a relatively rapid and direct response to rainfall and were more likely to increase in runoff magnitude do et al 2017 zhu et al 2019 as for larger watershed scales i e grades 4 to 9 the results obtained could also be explained based on certain physical phenomena under the scenario of rainfall spatial non uniformity rainfall would be mainly concentrated in certain areas i e some sub watersheds resulting in obvious differences in the runoff quantity of different sub watersheds at least a number of areas had higher runoff coefficient and larger runoff quantity on the contrary when fine scale spatial distribution was eliminated through averaging rainfall over the entire watershed more rainfall would infiltrate and the runoff coefficient was comparatively lower resulting in less runoff quantity at grades 4 to 9 darras et al 2015 zhu et al 2018 fig 8 compared the simulation results of tp for multiple watershed scales and discharge return periods under the four rainfall scenarios rainfall spatial variability had a notable effect on tp and the performance also varies with watershed scale as showed in fig 8a c the values of tp were higher under the scenario of rainfall spatial uniformity than those under the scenario of rainfall spatial non uniformity at the relatively small watershed scales i e grades 1 3 as shown in fig 8d i the values of tp were generally higher under the scenario of rainfall spatial non uniformity rather than the scenario of rainfall spatial uniformity with respect to the larger watershed scales i e grades 4 9 the difference had an increasing trend with the increasing return periods for example simulated tp results ranged from 248 20 32 14 t for the 1dn rainfall scenario to 232 85 34 03 t for the 1du rainfall scenario at the 5 return period and the grade9 grade3 as a result rainfall spatial variability notably affected tp at multiple watershed scales the response of tp to rainfall spatial variability was similar to that of runoff quantity cho et al 2009 rainfall especially storms runoff is generally regarded as a vital factor that washes the soil drives pollutant migration and further carries the most pollutants from soil into the receiving water the previous studies indicated that rainfall intension had strong effects on tp load ockenden et al 2016 qiu et al 2019 by means of the numerical simulation our findings showed that rainfall spatial distribution also affected tp transport at the watershed the rainfall spatial variability would affect the characteristics of runoff generation and confluence which might further change pollutant transport larger runoff quantity had the ability to transport more tp from land to water it could also enhance erosive power and washing effect which could mobilize more adsorbed tp at the watershed drewry et al 2006 lintern et al 2018 4 2 2 impact of rainfall temporal variability to investigate how rainfall temporal variability impacts runoff quality and quantity explicitly and intuitively the simulation results of runoff quality and quantity were analyzed under four temporal variability levels i e 1 2 4 and 6 day of rainfall while maintaining the same spatial distribution under the scenario of rainfall spatial non uniformity the differences among the simulation results of runoff quantity and tp driven by four rainfall scenarios i e 1dn vs 2dn vs 4dn vs 6dn under multiple watershed scales and discharge return periods are presented in figs 9 and 10 it was clear that rainfall temporal variability could have a notable impact on tp and runoff quantity for a given return period the values of tp and runoff quantity ranked generally from high to low as 1dn 2dn 4dn and 6dn for instance at the grade 9 and the return period of 5 years the simulated tp runoff quantity results for the rainfall scenarios of 1dn 2dn 4dn and 6dn were 248 20 t 237 24 t 232 02 t and 207 43 t 2 614 74 m3 s 2 501 95 m3 s 2 438 50 m3 s and 2 222 25 m3 s respectively under the scenario of rainfall spatial uniformity the similar regularity was showed in figs 11 and 12 the highest values of tp and runoff quantity were generally obtained under the 1du rainfall scenario whereas the lowest values were generally obtained under the 6du rainfall scenario the rainfall temporal variability also had notable effects on the runoff generation and confluence which further affected the pollutant transport at the watershed the results indicated that the higher the temporal variability level was the larger the simulated result was likely since larger instantaneous runoff responded to higher rain rate variability the temporal variability of rainfall decreased by time aggregation as shown in fig 5a d during the rainfall event rainfall tended to equalization which might increase the rainfall infiltration decline the generation of surface runoff and the transport of tp accordingly debele et al 2008 merz et al 2006 the results indicated that the values of tp and runoff quantity generally increased along with the levels of rainfall temporal variability at all watershed scales whether rainfall space was uniform or not however the differences caused by rainfall temporal variability were more apparent with the increasing watershed scales under the scenario of rainfall spatial non uniformity than those under the scenario of rainfall spatial uniformity figs 9 12 this might be related to the similar runoff loss rate when spatial variability is eliminated by averaging rainfall at the entire watershed under the scenario of non uniform rainfall space rainfall was concentrated in the middle and lower reaches of the watershed fig 4f and the runoff coefficients at multiple watershed scales could have relatively obvious differences the areas with comparatively high runoff coefficient might be more susceptible to rainfall temporal variabilities 4 2 3 difference between runoff quality and quantity variabilities the above results indicated that the responses of tp to rainfall spatial and temporal variabilities were similar to those of runoff quantity however there was a certain degree of difference between them for further comparison the relative differences rd i t of the simulation results of runoff quantity and tp were calculated 6 rd i t y i t x i t y i t where y i t was the average tp or runoff quantity of the 18 realizations at grade i and discharge return period t under a relatively higher level of rainfall spatial or temporal variability e g 1dn while x i t was the corresponding value under a relatively lower level of spatial or rainfall temporal variability e g 1du for simplicity and representativeness 1dn vs 1du 1dn vs 4dn and 1du vs 4du were used as examples the rest of the results were shown in fig s3 in the supporting material the overall distribution of the relative differences of tp and runoff quantity were shown in fig 13 a c according to the positions of box components i e the 1st 3rd quartiles and median line the relative differences of tp were overall greater than those of runoff quantity at multiple watershed scales it was obvious that rainfall spatial and temporal variabilities under multiple watershed scales had greater impacts on tp than runoff quantity to certain extent shen et al 2012 and alnahit et al 2020 also drew similar conclusions the variation associated with rainfall spatial and temporal variabilities might be transferred and magnified into tp simulation within swat it could be explained by the fact that the mechanism of the pollutant migration and transformation was complicated which was controlled by the rainfall hydrology process and watershed characteristics shen et al 2014 4 3 relative contributions of rainfall spatial and temporal variabilities the above results indicated that tp and runoff quantity were notably affected by rainfall spatial and temporal variabilities to further quantitatively and qualitatively analyze the relative contributions of rainfall spatial and temporal variabilities to the total variabilities of tp and runoff quantity under multiple watershed scales and discharge return periods two way anova was employed in this section figs 14 and 15 presented the relative contributions of rainfall spatial variability rainfall temporal variability and their interaction effect to the total variabilities of runoff quantity and tp respectively the contribution of each factor varied apparently with discharge return periods and watershed scales at the smaller watershed scales i e grades 1 3 rainfall spatial variability was the dominant factor to the total variabilities of tp and runoff quantity as the scale increases the results were significantly disparate at the larger watershed scales i e grades 4 9 the relative contribution of rainfall temporal variability was greater than that of rainfall spatial variability for relatively small return periods approximately from 1 to 41 year the relative contribution of rainfall spatial variability increased with return periods which was greater than that of temporal variability for larger return periods approximately from 41 to 500 year the contribution of the interaction effect was generally lower than 15 in conclusion rainfall spatial variability could have a relatively significant impact on runoff quality tp as the index and quantity for headwater relatively small watershed scales i e grades 1 3 for relatively large watershed scales i e grades 4 9 rainfall temporal variability was more important than rainfall spatial variability for small return periods whereas the opposite results were obtained for relatively large return periods these results were different from the conclusions of the research by zhu et al 2018 who found that temporal spatial rainfall variability was relatively important at small large watersheds for turkey river this was due to the fact that apart from different watershed areas and watershed characteristics zhu et al 2018 was based on the hourly scale while this study was based on the daily scale small watershed scales would have the relatively small time for runoff confluence and pollutant migration the daily scale of rainfall input might be larger than the runoff confluence time and travel time of tp at grades 1 to 3 which diminished the relative contribution of rainfall temporal variability at the small watershed scales to certain extent jin et al 2020 as for larger watershed scales the contribution of rainfall spatial variability was relatively inconspicuous for small return periods due to the fact that the rainfall spatial scale that we selected was still relatively coarse as the return period increases the heavy rain might localize at some sub watersheds and the rainfall spatial variability would become more significant this might significantly enhance the impacts of rainfall spatial variability while the contribution of temporal variability decreased accordingly for relatively larger return periods the results implied the complex relationship among rainfall spatial and temporal variabilities runoff quantity and runoff quality in conjunction with watershed scales and event magnitudes accurate runoff quality and quantity analyses using hydrological and water quality models demand to pay attention to rainfall spatial and temporal variabilities of the watershed 5 conclusions in this research the impacts of rainfall spatial and temporal variabilities on runoff quality regard tp as the indicator and quantity were investigated under multiple watershed scales and event magnitudes rainfall hazard modeling system rainyday model was combined with the tropical rainfall measuring mission trmm rainfall product to generate quantities of rainfall events these rainfall events were resampled into eight rainfall scenarios with multiple levels of spatial and temporal variabilities these rainfall scenarios were used as input to the soil and water assessment tool swat to simulate runoff quality and quantity for multiple watershed scales and return periods from 1 to 500 years at the dongjiang river watershed in china analysis of variance anova was used to evaluate the relative importance of rainfall spatial and temporal variabilities the main conclusions were as follows a at the headwater small watershed scales runoff quality and quantity were higher under the rainfall spatial uniformity scenario rather than the rainfall spatial non uniformity scenario at the larger watershed scales the opposite results appeared the spatial non uniformity scenario had higher runoff quality and quantity than the spatial uniformity scenario the values of runoff quality and quantity increased along with the levels of rainfall temporal variability for a given return period and watershed scale moreover the responses of runoff quality to rainfall spatial and temporal variabilities were similar to those of runoff quantity whereas runoff quality was more sensitive than runoff quantity and b on the whole the impact of rainfall spatial variability on runoff quality and quantity was greater than that of rainfall temporal variability for small watershed scales for larger watershed scales rainfall temporal variability had a more important impact than spatial variability for small return periods whereas the opposite results were observed for relatively large return periods the results might be mainly caused by the following reasons 1 rainfall was concentrated in the middle and lower reaches of the watershed 2 the study was based on the daily scale the research found that runoff quality and quantity analyses based on a hydrological and water quality model were sensitive to the level of rainfall spatial and temporal variabilities it provided recommendations for modelers to select appropriate rainfall data and highlighted that spatial and temporal variabilities of rainfall input should be taken into account when using a hydrological and water quality model to analyze the variations of runoff quality and quantity due to the limitations of data and other objective conditions in this research we merely focused on a typical watershed i e dongjiang river watershed and a typical runoff quality index i e tp it was not clear how generalizable our results were similar to other watersheds or runoff quality indexes the regulations of other runoff quality indicators or other watersheds still need to be studied on the other hand spatial and temporal distributions of rainfall were still relatively coarse in this research further studies are required to refine rainfall spatial and temporal distributions to investigate the mechanism in depth in addition further studies are needed to expand the capabilities of the rainyday satellite rainfall data hydrological and water quality model framework for improving the accuracy of design rainfall and hydrological and water quality simulation another future research is needed to comprehensively consider both spatio temporal variability of rainfall and the optimal design of rain gauges network such as the locations of rain gauges and sample intervals in order to capture the reasonable spatial and temporal distribution of rainfall for hydrological and water quality modeling credit authorship contribution statement wenjie zhou software validation formal analysis data curation visualization writing original draft writing review editing supervision zhihua zhu conceptualization methodology writing review editing supervision yulei xie writing review editing yanpeng cai data curation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the key area research and development program of guangdong province 2020b1111380003 the program for guangdong introducing innovative and enterpreneurial teams 2019zt08l213 and the national natural science foundation of china 51879007 u20a20117 and 52009021 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127057 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3946,modelling tools are widely used to analyse the urban drainage systems and to simulate the effects of future urban development and stormwater control measures usually these tools use only one mathematical model predetermined by the modeller at a time to describe a single hydrological process within the urban catchment when there are alternative mathematical models for describing the same hydrological process their suitability needs to be investigated separately which makes the modelling task even more complex time consuming and open for human errors furthermore models have to be calibrated to achieve a better fit between measured and simulated runoff calibration can be performed either manually by using a trial and error approach or by employing search techniques and parameter optimization tools to overcome the drawbacks associated with manual selection and calibration of models automated modelling based on equation discovery was used in this study to a find the most suitable mathematical model among multiple alternatives for describing every environmental process modelled and b to calibrate the model parameters against measured data first knowledge on urban runoff modelling was formalized into a new library of modelling components compliant with the equation discovery tool probmot process based modelling tool next a conceptual model of the experimental urban sub catchment within the city of ljubljana slovenia was defined probmot was used to find the structure and parameters values of alternative rainfall runoff models according to the defined conceptual model that provide optimal fit against pipe flow measurements three alternative methods were used to describe infiltration the scs cn method the variable uk runoff equation and the uk water industry research equation the proposed automated model discovery approach for finding the optimal rainfall runoff model proved to be very efficient nine rainfall runoff models were created with very good performance the best performance was achieved by the models that used a combination of two different infiltration methods i e the scs cn infiltration method for the pervious area and one of the other two infiltration methods for the impervious area keywords urban runoff rainfall runoff model automated modelling domain knowledge equation discovery process based modelling 1 introduction growing urbanization combined with climate change bringing more frequent and intensive rain events is putting additional pressure on existing urban drainage ud systems zhou 2014 consequently these systems frequently fail to effectively perform their function therefore modelling and decision support tools can be of great assistance for analysing the current state of ud systems and for selecting the most suitable stormwater control measure s scms e g štajdohar et al 2016 zhu et al 2019 li et al 2020 in this context one of the most widely used hydrological hydraulic models of urban catchments is the open source stormwater management model swmm rossman 2015 which supports a wide range of modelling functionalities namely water quantity water quality sustainable drainage devices and spatial planning zoppou 2001 zhou 2014 however swmm does not provide a geographic information system gis functionalities such as catchment discretization b detailed overland routing simulations and c parameter calibration thus in recent years researchers have tried to overcome these limitations by proposing solutions that would to some extent automate or formalize the model development process within swmm allende prieto et al 2018 and radinja et al 2019 have developed urban hydrological hydraulic models by using the open source software giswater giswater association 2015 which enables integration of geospatial data i e sewer system network dem etc into the model development process furthermore dongquan et al 2009 have successfully applied automatic gis based catchment discretization on a macau case study area of 13 65 ha similarly warsta et al 2017 have developed an automated subcatchment generator for swmm using open data which significantly accelerates project setup the generator was applied to two subcatchments in helsinki with an area of 13 9 ha and 33 5 ha respectively younis et al 2017 have employed automated processing of satellite images for land use classification to improve the calibration of a wastewater network to improve overland routing simulations swmm has been recently coupled with a two dimensional overland flow model based on the cellular automata approach for providing reliable urban nonpoint source pollution data dai et al 2020 a similar approach has been used to simulate interactions between surface runoff and ud systems abbasizadeh et al 2018 swmm like any other mechanistic model uses one mathematical model predetermined by the modeller at a time to describe a single hydrological process within the urban catchment after initial simulation models are calibrated to achieve a better fit between the measured and simulated runoff calibration can be performed either manually iteratively by using a trial and error approach or by employing search techniques e g genetic algorithms neural networks regression trees etc niazi et al 2017 hu et al 2018 and parameter optimization tools e g pest ostrich perin et al 2020 shahed behrouz et al 2020 optimization can be formulated either as a single objective problem that minimizes the aggregate difference between measurements and model simulations or a multi objective problem that considers multiple trade offs e g water quantity quality costs and biodiversity di pierro et al 2006 gamerith et al 2011 macro et al 2019 in case there are alternative mathematical models for describing the same e g hydrological process their suitability needs to be investigated separately which makes the modelling task even more complex time consuming and open for human errors to overcome the drawbacks associated with manual calibration and manual selection of models automated modelling am based on equation discovery can be used to a find the most suitable mathematical model among multiple alternatives for describing every environmental process modelled and b to calibrate the model parameters against measured data equation discovery is an area of machine learning that develops methods for automated discovery of mathematical models expressed in the form of equations from collections of measured data džeroski and todorovski 2008 automated modelling using knowledge libraries of model components has been already successfully applied for modelling aquatic ecosystems atanasova et al 2006 watersheds škerjanec et al 2014 dynamic biological systems tanevski et al 2016 and water tank dynamics simidjievski et al 2020 to the best of our knowledge no such attempts have yet been made in the field of urban surface runoff modelling this paper provides integration of automated equation model discovery and domain specific knowledge in the field of surface runoff modelling more specifically the main aims of the paper are to a develop a library of components formalizing the knowledge on urban runoff modelling compliant with the equation discovery tool probmot process based modelling tool džeroski et al 2020 b define a conceptual model of the experimental urban sub catchment within the city of ljubljana slovenia c apply the proposed automated model discovery approach to find the optimal rainfall runoff model for the above mentioned case study area that best fits the available pipe flow measurements 2 case study area the case study area is located in the western part of the city of ljubljana slovenia and covers about 30 ha the predominant land use in this area is family houses with gardens fig 1 the typical climate for the area is a temperate continental climate the mean long term 1986 2016 annual rainfall is about 1380 mm and the average annual temperature is 11 c ranging from 3 c in winter to 24 c in summer slovenian environment agency 2018 the largest part of the area is serviced by a mixed sewer system with a length of approx 5 4 km 3 data and methods 3 1 data precipitation data were provided by the slovenian forestry institute for a rain gauge station located on the north side of the case study area location 46 03 06 82 n 14 28 47 58 e 306 m a s l slovenian forestry insitute 2019 the measurements were performed with a davis 0 2 mm rain gauge smart sensor onset computer corporation 2016 the local public utility company jp vodovod kanalizacija snaga d o o provided the information on the combined sewer network and the flow measurement data the flow measurements were performed between 1 march 2019 and 30 september 2020 in a pipe of the combined sewer system collecting all contributing water from the case study area location 46 02 44 56 n 14 29 01 82 e 295 m a s l fig 1 the flow rate was calculated based on the combination of non contact radar velocity measurements and ultrasonic water level measurements raven eye 2020 as the focus was only on surface runoff stormwater modelling and the measurements were conducted in a combined sewer system the dry weather flow which was measured before each rain event 8 20 l s was deducted from the total measured flow for the preparation of precipitation and flow data a 5 minute time step was used within the flow measurement period four rainfall periods were selected for model calibration c1 c4 and four rainfall periods were selected for model validation v1 v4 table 1 based on their duration the rainfall periods can in general be divided into two groups shorter approx 1 day and longer approx 6 days hence two short c1 and c2 and two long c3 and c4 rainfall periods were selected for model calibration the longer calibration periods include multiple rainfall events of different intensities and durations so that the probmot tool could learn from different surface runoff responses of the catchment the validation periods were selected based on the following criteria a duration with shorter v1 and v2 and longer v3 and v4 periods b seasonal distribution c similarity in peak flows d stability of measured flows and e antecedent dry weather period the rainfall periods are presented in consecutive order based on the modelling phase either calibration c or validation v and duration of the modelled rainfall period e g 1d one day table 1 3 2 rainfall runoff model our rainfall runoff model is based on the principles and equations used by the epa storm water management model swmm rossman 2015 the catchment is represented as a nonlinear reservoir governed by surface storage mass balance i e conservation of mass 1 d t i f q where d is the surface storage m i is the rate of rainfall m s f is the infiltration rate m s and q is the runoff rate m s evaporation was not included in the model due to its limited potential to significantly influence the water cycle within the modelled rainfall periods the runoff flow rate per unit of the surface area is based on manning s equation rossman 2015 2 q w s 0 5 an d d s 5 3 where q is the runoff flow rate per unit of the surface area m s w is the sub catchment width m s is the average slope of the sub catchment m m a is the surface area of the sub catchment m2 n is the surface roughness coefficient s m1 3 d is the ponded water m and d s is the depression storage depth m afterwards the total runoff flow from the catchment l s is calculated by multiplying the catchment surface area m2 and q m s there are several well known alternative methods for modelling the infiltration process three alternatives were considered in this study the scs cn method the variable runoff equation and the uk water industry research runoff equation thus the complete rainfall runoff model can have different structures based on which infiltration method is selected in addition different infiltration methods can be applied in different sub catchments resulting in many plausible model structures for a given catchment 3 2 1 scs cn method this method assumes that the total infiltration capacity of a soil is related to the soil s tabulated curve number cn the cn value is determined based on the hydrologic soil group land use and hydrologic condition cn values range from 30 to 98 the latter value is assigned to paved roadways roofs and other impervious surfaces at higher cn values precipitation is mainly translated into a runoff on the other hand at lower cn values rainfall is mainly infiltrated and is thus not translated into runoff nrcs 1986 a modified version of the scs cn equation was used as described in the swmm reference manual hydrology rossman 2015 in the modified version the initial abstraction i a is not included as it is already included in the depression storage d s see eq 2 the following three equations eq 3 5 are used to calculate the infiltration rate 3 f f 2 f 1 δ t where f is the infiltration rate m s f 2 is the cumulative infiltration at the end of a time step δt m f 1 is the cumulative infiltration at the beginning of a time step δt m and δt is the time step s 4 f p p 2 p s max where f is the cumulative infiltration mm p is the cumulative precipitation mm and s max is the maximum storage capacity of a soil mm 5 s max 1000 cn 10 25 4 where s max is the maximum storage capacity of soil mm and cn is the tabulated coefficient that varies with the land use and soil type 3 2 2 variable uk runoff equation the variable uk runoff equation varuk has three components runoff from impervious areas runoff from pervious areas and initial losses butler et al 2018 it is based on data from 11 uk catchments and 112 rain events the varuk equation is as follows packman 1990 6 pr i f p i m p 100 i f p i m p napi pf where pr is the percentage runoff if is the effective impervious area factor pimp is the percentage of imperviousness napi is the antecedent precipitation index mm and pf is the porosity factor mm the rainfall can be converted into infiltration by using the following equation 7 f i 1 pr 100 3 2 3 uk water industry research runoff equation the uk water industry research runoff equation ukwir kellagher 2014 was developed to overcome some of the limitations of varuk woods ballard et al 2015 which are described in detail in the report development of the ukwir runoff model 2014 as varuk it has a fixed runoff component for paved surfaces if n pimp n it was upgraded with a variable runoff component for paved surfaces 1 if n pimp n additionally a component for pervious surfaces was added 1 pimp total which enables differentiation between winter and summer runoff i e negative napi the ukwir equation is then as follows 8 pr n 1 n if n pimp n 1 if n pimp n pi pv β pf pv 1 pimp total napi s pi s cr s p r pf s where pr is the percentage runoff for the model if n is the effective impermeability factor for a particular paved surface type pi pv is the precipitation index for paved surfaces with a rapid decay coefficient β is the power coefficient for paved surface pf pv is the soil store depth for paved surface mm napi s is the antecedent precipitation index for a particular pervious surface type pi s is the precipitation index for pervious surface with a decay coefficient cr is the power coefficient for pervious surface spr is the standard percentage runoff and pf s is the soil storage depth for a particular pervious surface type mm 3 3 equation discovery and process based modelling the proposed automated modelling approach is based on the process based modelling tool probmot developed by čerepnalkoski et al 2012 probmot allows for the integration of domain knowledge e g urban hydrology formalized as template components for the construction of the process based models into equation discovery from measured data it automatically identifies both the structure and parameter values of an appropriate process based model given a a knowledge library i e a mathematical formulation of the selected domain in the form of model components or more specifically template entities and processes b a conceptual model of the observed system and c measurements fig 2 candidate model structures are generated from the knowledge library and a user specified conceptual model of an observed system the candidate models are transformed into equations calibrated against measurements and ranked according to their errors the latter are calculated as the root mean squared error rmse i e discrepancy between the model simulation and measured data to use probmot for rainfall runoff modelling in the presented case study the following steps were taken 1 the rainfall runoff methods were encoded in a modelling library 2 a conceptual model of the case study was elaborated and 3 probmot was set to discover the best model structure and parameters following the conceptual model of the case study radinja et al 2021 3 3 1 library of components for modelling rainfall runoff the library consists of entity templates process templates and compartment templates each template captures general knowledge that applies to different cases and can be reused when dealing with a specific task the dynamic system to be modelled i e the catchment can be structured by using compartments compartments are organized in a nested tree like structure each compartment contains entities and processes and can also contain other sub compartments e g sub catchments or functional units škerjanec et al 2014 moreover entities represent the actors of the observed system these actors are involved in processes that explain how entities interact as well as what is the influence of the interactions on the involved entities themselves in the urban runoff modelling domain entities correspond to different pools within the urban water cycle climate variables and various types of constituents finally processes provide quantitative descriptions of the relations among entities in terms of one or more equations in the urban runoff modelling domain examples of processes include water fluxes i e transfer processes that are involved in the water cycle e g surface runoff infiltration fig 3 thus processes calculate the change of water fluxes e g surface storage within a time step and entities aggregate these changes over the simulated time the equations presented in section 3 2 were encoded in the knowledge library as template processes named hydrological processes these include outflow surfacestorage surfacerunoff and infiltration with three alternative methods infiltrationscs infiltrationukwir and infiltrationvaruk additionally the intercompartmental process totaloutflow was introduced to sum the outflow from both sub compartments i e sub1 and sub2 see radinja et al 2021 the time step in the presented equations is 1 s thus probmot is calculating the infiltration rate in m s and flow in l s however the actual time step of the input data e g precipitation measured flow is 5 min thus this is also the reporting time step 3 3 2 conceptual model of the case study area the conceptual model of the case study area fig 1 was structured as a single compartment i e catchment divided into two sub compartments i e sub1 and sub2 sub1 represents the impervious part of the catchment and sub2 the pervious part of the catchment fig 3 first the parameters that appear in the equations presented in section 3 2 were listed as constants within the template entity surface in the knowledge library together with their expected ranges and units afterwards this template was reused within the conceptual model see radinja et al 2021 where the values and ranges of the constants were adjusted based on the im perviousness of the sub catchment table 2 following the values proposed in the literature nrcs 1986 kellagher 2014 rossman 2015 3 4 assessment and comparison of model performance once the potentially viable model structures are composed by the probmot algorithm their parameters are fitted to the provided measurements and the resulting models are assessed according to their goodness of fit two measures are used to assess model performance the nash sutcliffe efficiency coefficient nse nash and sutcliffe 1970 and rmse observations standard deviation ratio rsr moriasi et al 2007 nse is commonly used to evaluate the goodness of fit of hydrological models it can range from minus infinity to one where one represents a perfect match between the observed and the modelled discharge a value of 0 indicates that the observed mean is as good predictor as the model while the negative values indicate that the observed mean is a better predictor than the model wilcox et al 1990 legates and mccabe 1999 rsr is standardizing the rmse root mean square error by using the standard deviation of observations it can range from the optimal value of 0 which indicates a perfect model to a large positive value indicating a corresponding error the lower the rsr the better the model performance to rate model performance based on nse and rsr the categorization proposed by moriasi 2007 was used table 3 to find similarities differences between the models based on their scored nse and rsr values the method of hierarchical clustering as implemented by the orange software demšar et al 2013 was applied to the models it forms a dendrogram for arbitrary types of objects in this case models based on a matrix of distances distances were calculated using the euclidian metric which is the ordinary straight line distance between two points in euclidean space the points to cluster are the models represented by their nse and rsr values over all events calibration and validation for a better presentation of the hierarchical clustering so called heat maps were used to visualize the errors of the models with coloured spots 4 results 4 1 calibration given the conceptual model and the modelling library probmot explored 9 alternative structures m1 m9 table 5 each of which was calibrated and validated against the measured data all models were calibrated by simultaneously using data from two short time periods of measured flow with a duration of approximately one day c1 and c2 fig 4 and two long time periods of measured flow with a duration of approximately one week c3 and c4 fig 5 after calibration all models generally had very good performance in terms of comparison between the simulated and measured flow table 4 for the first calibration period c1 the models scored the following average grades average nse value of 0 85 and average rsr value of 0 38 however the models that use the scs cn infiltration method for the pervious area m1 m3 average nse value of 0 80 underpredicted the flow when compared to the rest of the models m4 m9 average nse value of 0 88 for the second calibration period c2 the models scored an average nse value of 0 76 and an average rsr value of 0 49 however the models that use the scs cn infiltration method for the impervious area m1 m4 m7 average nse value of 0 72 underpredicted the flow when compared to the rest of the models average nse value of 0 78 to improve the readability only four models are presented on the hydrograph for longer calibration periods c3 c4 fig 5 for the third calibration period c3 the models scored an average nse value of 0 74 and an average rsr value of 0 51 almost fulfilling the criteria for very good model performance in comparison to the first calibration period c1 the models that use the scs cn infiltration method for the pervious area m1 m3 average nse value of 0 78 performed better than the rest of the models m4 m9 average nse value of 0 73 for the fourth calibration period c4 the models scored the average grades of 0 79 for nse and 0 46 for rsr in comparison to the first three calibrations periods no clear differences in model performance can be observed 4 2 validation the calibrated models were validated on four different rainfall periods table 4 that vary in rainfall duration and intensity table 1 fig 6 presents the shorter two periods namely v1 and v2 the validation period v1 lasted 23 h i e 31 august 2020 12 00 1 september 2020 11 00 with an average measured flow of 39 l s for this validation period the models scored an average nse value of 0 89 and an average rsr value of 0 32 however the model that only includes the scs cn infiltration method m1 performed worse than the rest of the models i e its nse is 0 07 lower it underestimated the flow values for the beginning of the first rain event for both short validation periods v1 and v2 the validation period v2 lasted for 54 h 2 days i e from 21 december 2019 08 00 23 december 2019 14 00 with two rainfall events causing the first and the second highest peak flows among all validation events q1 429 l s and q2 340 l s no clear differences in model performance can be observed across the different models for this validation period to improve the readability only four models are presented on the hydrograph for the longer validation periods v3 and v4 fig 7 namely the three models that use the same infiltration method for the pervious and impervious area m1 m5 m9 and model m3 which had the best performance for these validation periods fig 7 the validation period v3 lasted for 109 h 5 days i e from 28 september 2019 12 00 3 october 2019 01 00 with two individual rainfall events in this case the models that use the scs cn infiltration method for the pervious area performed better than the other models with an average nse value of 0 86 the models that use the varuk or ukwir infiltration method for the pervious area scored lower nse values ranging between 0 76 and 0 81 the first rainfall event is very dynamic and consists of three sub peaks q1 185 l s q2 227 l s q3 260 l s within a period of 2 h with clear breaks low values in between q1 51 l s q2 15 l s as for the previous validation periods m1 underestimates flow at the beginning of the first event however it already fits the third sub peak well on the other hand the models m3 m5 and m9 fit sub peaks better however they do not fit the low values in between as well the second rainfall event also consists of three sub peaks here all models follow the shape of the measured hydrograph more consistently the validation event v4 lasted for 128 h 5 days i e from 1 march 2020 07 00 6 march 2020 15 00 with three individual rainfall events fig 7 for this validation period the models scored an average nse value of 0 80 and an average rsr value of 0 45 in general all models overestimated the flow values however the model that only includes the scs cn infiltration method m1 performed worse than the rest of the models i e its nse is 0 05 lower in comparison to the rest of the models it least overestimated flow values for the beginning of the first rain event yet for the next rain events it overestimated flow the most using hierarchical clustering we clustered the models into groups according to their performance profiles in terms of nse and rsr coefficients across all calibration and validation periods fig 8 one can notice that for both coefficients models are clustered similarly models m1 m2 and m3 form the first group g1 they all use the scs cn infiltration method for the sub2 i e pervious area the rest of the models m4 m9 form the second group g2 furthermore one can notice that the models in the first group g1 are generally more heterogeneous than models in the second group g2 if we compare these groups based on the nse and rsr values one can notice that for the shorter calibration periods c1 and c2 models from the second group g2 generally performed slightly better i e average nse 0 82 average rsr 0 42 than models from the first group g1 i e average nse 0 79 average rsr 0 46 however due to the very different model performance between m1 i e nse 0 83 and m3 i e nse 0 94 for v1 this observation is not confirmed for the short validation periods on the other hand models from g1 performed better for longer calibration periods c3 and c4 i e average nse 0 78 average rsr 0 47 and validation periods v3 and v4 i e average nse 0 82 average rsr 0 42 than models from g2 i e for c3 and c4 average nse 0 76 and average rsr 0 49 for v3 and v4 average nse 0 79 and average rsr 0 45 5 discussion 5 1 model analysis the derived rainfall runoff models can be classified as lumped regarding spatial resolution and continuous regarding temporal resolution fletcher et al 2013 the proposed tool enabled a systematic comparison of three alternative infiltration methods i e scs cn varuk and ukwir allowing also combinations of these methods this is a unique and novel approach as normally only one infiltration method is used within one rainfall runoff model the developed knowledge library compliant with the probmot tool enabled the automatic generation and calibration of these models based on the criteria for assessing models goodness of fit proposed by moriasi et al 2007 and presented in table 3 the models on average had very good performance for the calibration periods c1 c2 and c4 and good performance for the calibration period c3 in the validation process all models had very good performance for all validation periods confirming the usefulness and efficiency of the proposed approach for calibration of model parameters in general the best performance was achieved by model m3 with an average nse value of 0 80 for the calibration periods and an average nse value of 0 88 for the validation periods the second best performance was achieved by model m2 with an average nse value of 0 78 for the calibration periods and an average nse value of 0 87 for the validation periods however some of the other models performed better for individual rainfall periods or achieved similar performance this highlights the fact that no general conclusion can be made on which model is better since model performance results are greatly influenced by the characteristics of calibration and validation periods e g rainfall intensity number of sub rainfall events furthermore this was also not the intention of this research the true value and contribution of this research is the discovery of new knowledge in the urban runoff modelling domain by automated modelling namely the best performance was achieved by models that used a combination of two different infiltration methods in contrast to the usual approach of using a single infiltration method 5 2 automated approach advantages and limitations urban runoff models can be either mechanistic i e based on mathematical formulations of physical phenomena or data driven also known as black box models learning from the relationship between the measured input and output data with no description of the internal functioning of the system frequently artificial neural networks are employed to develop data driven rainfall runoff models troutman et al 2017 compared to these types of automated modelling approaches i e neural networks our approach provides more transparency i e it is an automated way for constructing mechanistic model structures the automation is used for composing viable model structures and calibration the two most time consuming processes in the commonly followed modelling procedure in addition the search through the space of models is automated i e systematic and avoids human errors in order to build fully distributed models hydraulic processes i e pipe flow should be included due to some limitations of the probmot tool only hydrological processes were included firstly based on the required structure of the conceptual model each pipe and manhole within the system would have to be presented as a separate compartment thus significantly increasing model complexity and prolonging computation secondly probmot does not support the encoding of difference equations and conditional statements e g if then rules additionally all the equations included in the library must use the same time resolution hydraulic pipe flow modelling is crucial when modelling complex and large sewer systems in our case the case study area and the adjacent sewer system were relatively small thus the hydraulic pipe flow modelling would not significantly affect the outflow dynamics the three alternative infiltration methods i e scs cn varuk and ukwir were selected and integrated into the knowledge library as they were not affected by the above mentioned limitations of the probmot on the other hand some other frequently used infiltration methods e g horton green ampt were not integrated due to the current probmot limitations in the future we plan to overcome some of these probmot limitations this would allow us to upgrade the knowledge library with hydraulic processes and to include additional infiltration methods 6 conclusions in this study an automated equation model discovery approach was applied to the field of urban runoff modelling first a new library of model components compliant with the equation discovery tool probmot was developed formalizing the knowledge on urban runoff modelling next a conceptual model of the experimental urban sub catchment within the city of ljubljana slovenia was defined the proposed methodology enabled the discovery of optimal structure and parameters values of the rainfall runoff models based on the pipe flow measurements including combination of infiltration methods within a single model structure which represents a novelty in urban hydrological research the main findings of the study are as follows a the proposed automated model discovery approach for finding the optimal rainfall runoff models proved to be very efficient nine rainfall runoff models were created that generally had good or very good performance b the models performed better for validation events with a more stable constant flow scoring higher nse coefficient values and lower rsr coefficient values c based on the model performance evaluation two groups of models could be identified based on whether the scs cn infiltration method was assigned to the pervious area of the catchment d the best performance was achieved by models that used a combination of two different infiltration methods i e the scs cn infiltration method for the pervious area in combination with one of the other two infiltration methods for the impervious area e finally this approach is transferable to any catchment and enables the discovery of viable rainfall runoff models best fitted to local specific conditions on one hand and facilitates the validation and revision of established rainfall runoff models on the other hand credit authorship contribution statement matej radinja conceptualization methodology software formal analysis investigation writing original draft visualization mateja škerjanec methodology software validation writing review editing mojca šraj methodology validation writing review editing sašo džeroski methodology software validation writing review editing ljupčo todorovski methodology software validation writing review editing nataša atanasova conceptualization methodology software validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the slovenian research agency research core funding no p2 0180 no p2 0103 no p5 0093 and project no n2 0128 the authors would like to thank the company jp voka snaga for providing the sewer system data and to the slovenian forestry institute for providing the precipitation data appendix a 
3946,modelling tools are widely used to analyse the urban drainage systems and to simulate the effects of future urban development and stormwater control measures usually these tools use only one mathematical model predetermined by the modeller at a time to describe a single hydrological process within the urban catchment when there are alternative mathematical models for describing the same hydrological process their suitability needs to be investigated separately which makes the modelling task even more complex time consuming and open for human errors furthermore models have to be calibrated to achieve a better fit between measured and simulated runoff calibration can be performed either manually by using a trial and error approach or by employing search techniques and parameter optimization tools to overcome the drawbacks associated with manual selection and calibration of models automated modelling based on equation discovery was used in this study to a find the most suitable mathematical model among multiple alternatives for describing every environmental process modelled and b to calibrate the model parameters against measured data first knowledge on urban runoff modelling was formalized into a new library of modelling components compliant with the equation discovery tool probmot process based modelling tool next a conceptual model of the experimental urban sub catchment within the city of ljubljana slovenia was defined probmot was used to find the structure and parameters values of alternative rainfall runoff models according to the defined conceptual model that provide optimal fit against pipe flow measurements three alternative methods were used to describe infiltration the scs cn method the variable uk runoff equation and the uk water industry research equation the proposed automated model discovery approach for finding the optimal rainfall runoff model proved to be very efficient nine rainfall runoff models were created with very good performance the best performance was achieved by the models that used a combination of two different infiltration methods i e the scs cn infiltration method for the pervious area and one of the other two infiltration methods for the impervious area keywords urban runoff rainfall runoff model automated modelling domain knowledge equation discovery process based modelling 1 introduction growing urbanization combined with climate change bringing more frequent and intensive rain events is putting additional pressure on existing urban drainage ud systems zhou 2014 consequently these systems frequently fail to effectively perform their function therefore modelling and decision support tools can be of great assistance for analysing the current state of ud systems and for selecting the most suitable stormwater control measure s scms e g štajdohar et al 2016 zhu et al 2019 li et al 2020 in this context one of the most widely used hydrological hydraulic models of urban catchments is the open source stormwater management model swmm rossman 2015 which supports a wide range of modelling functionalities namely water quantity water quality sustainable drainage devices and spatial planning zoppou 2001 zhou 2014 however swmm does not provide a geographic information system gis functionalities such as catchment discretization b detailed overland routing simulations and c parameter calibration thus in recent years researchers have tried to overcome these limitations by proposing solutions that would to some extent automate or formalize the model development process within swmm allende prieto et al 2018 and radinja et al 2019 have developed urban hydrological hydraulic models by using the open source software giswater giswater association 2015 which enables integration of geospatial data i e sewer system network dem etc into the model development process furthermore dongquan et al 2009 have successfully applied automatic gis based catchment discretization on a macau case study area of 13 65 ha similarly warsta et al 2017 have developed an automated subcatchment generator for swmm using open data which significantly accelerates project setup the generator was applied to two subcatchments in helsinki with an area of 13 9 ha and 33 5 ha respectively younis et al 2017 have employed automated processing of satellite images for land use classification to improve the calibration of a wastewater network to improve overland routing simulations swmm has been recently coupled with a two dimensional overland flow model based on the cellular automata approach for providing reliable urban nonpoint source pollution data dai et al 2020 a similar approach has been used to simulate interactions between surface runoff and ud systems abbasizadeh et al 2018 swmm like any other mechanistic model uses one mathematical model predetermined by the modeller at a time to describe a single hydrological process within the urban catchment after initial simulation models are calibrated to achieve a better fit between the measured and simulated runoff calibration can be performed either manually iteratively by using a trial and error approach or by employing search techniques e g genetic algorithms neural networks regression trees etc niazi et al 2017 hu et al 2018 and parameter optimization tools e g pest ostrich perin et al 2020 shahed behrouz et al 2020 optimization can be formulated either as a single objective problem that minimizes the aggregate difference between measurements and model simulations or a multi objective problem that considers multiple trade offs e g water quantity quality costs and biodiversity di pierro et al 2006 gamerith et al 2011 macro et al 2019 in case there are alternative mathematical models for describing the same e g hydrological process their suitability needs to be investigated separately which makes the modelling task even more complex time consuming and open for human errors to overcome the drawbacks associated with manual calibration and manual selection of models automated modelling am based on equation discovery can be used to a find the most suitable mathematical model among multiple alternatives for describing every environmental process modelled and b to calibrate the model parameters against measured data equation discovery is an area of machine learning that develops methods for automated discovery of mathematical models expressed in the form of equations from collections of measured data džeroski and todorovski 2008 automated modelling using knowledge libraries of model components has been already successfully applied for modelling aquatic ecosystems atanasova et al 2006 watersheds škerjanec et al 2014 dynamic biological systems tanevski et al 2016 and water tank dynamics simidjievski et al 2020 to the best of our knowledge no such attempts have yet been made in the field of urban surface runoff modelling this paper provides integration of automated equation model discovery and domain specific knowledge in the field of surface runoff modelling more specifically the main aims of the paper are to a develop a library of components formalizing the knowledge on urban runoff modelling compliant with the equation discovery tool probmot process based modelling tool džeroski et al 2020 b define a conceptual model of the experimental urban sub catchment within the city of ljubljana slovenia c apply the proposed automated model discovery approach to find the optimal rainfall runoff model for the above mentioned case study area that best fits the available pipe flow measurements 2 case study area the case study area is located in the western part of the city of ljubljana slovenia and covers about 30 ha the predominant land use in this area is family houses with gardens fig 1 the typical climate for the area is a temperate continental climate the mean long term 1986 2016 annual rainfall is about 1380 mm and the average annual temperature is 11 c ranging from 3 c in winter to 24 c in summer slovenian environment agency 2018 the largest part of the area is serviced by a mixed sewer system with a length of approx 5 4 km 3 data and methods 3 1 data precipitation data were provided by the slovenian forestry institute for a rain gauge station located on the north side of the case study area location 46 03 06 82 n 14 28 47 58 e 306 m a s l slovenian forestry insitute 2019 the measurements were performed with a davis 0 2 mm rain gauge smart sensor onset computer corporation 2016 the local public utility company jp vodovod kanalizacija snaga d o o provided the information on the combined sewer network and the flow measurement data the flow measurements were performed between 1 march 2019 and 30 september 2020 in a pipe of the combined sewer system collecting all contributing water from the case study area location 46 02 44 56 n 14 29 01 82 e 295 m a s l fig 1 the flow rate was calculated based on the combination of non contact radar velocity measurements and ultrasonic water level measurements raven eye 2020 as the focus was only on surface runoff stormwater modelling and the measurements were conducted in a combined sewer system the dry weather flow which was measured before each rain event 8 20 l s was deducted from the total measured flow for the preparation of precipitation and flow data a 5 minute time step was used within the flow measurement period four rainfall periods were selected for model calibration c1 c4 and four rainfall periods were selected for model validation v1 v4 table 1 based on their duration the rainfall periods can in general be divided into two groups shorter approx 1 day and longer approx 6 days hence two short c1 and c2 and two long c3 and c4 rainfall periods were selected for model calibration the longer calibration periods include multiple rainfall events of different intensities and durations so that the probmot tool could learn from different surface runoff responses of the catchment the validation periods were selected based on the following criteria a duration with shorter v1 and v2 and longer v3 and v4 periods b seasonal distribution c similarity in peak flows d stability of measured flows and e antecedent dry weather period the rainfall periods are presented in consecutive order based on the modelling phase either calibration c or validation v and duration of the modelled rainfall period e g 1d one day table 1 3 2 rainfall runoff model our rainfall runoff model is based on the principles and equations used by the epa storm water management model swmm rossman 2015 the catchment is represented as a nonlinear reservoir governed by surface storage mass balance i e conservation of mass 1 d t i f q where d is the surface storage m i is the rate of rainfall m s f is the infiltration rate m s and q is the runoff rate m s evaporation was not included in the model due to its limited potential to significantly influence the water cycle within the modelled rainfall periods the runoff flow rate per unit of the surface area is based on manning s equation rossman 2015 2 q w s 0 5 an d d s 5 3 where q is the runoff flow rate per unit of the surface area m s w is the sub catchment width m s is the average slope of the sub catchment m m a is the surface area of the sub catchment m2 n is the surface roughness coefficient s m1 3 d is the ponded water m and d s is the depression storage depth m afterwards the total runoff flow from the catchment l s is calculated by multiplying the catchment surface area m2 and q m s there are several well known alternative methods for modelling the infiltration process three alternatives were considered in this study the scs cn method the variable runoff equation and the uk water industry research runoff equation thus the complete rainfall runoff model can have different structures based on which infiltration method is selected in addition different infiltration methods can be applied in different sub catchments resulting in many plausible model structures for a given catchment 3 2 1 scs cn method this method assumes that the total infiltration capacity of a soil is related to the soil s tabulated curve number cn the cn value is determined based on the hydrologic soil group land use and hydrologic condition cn values range from 30 to 98 the latter value is assigned to paved roadways roofs and other impervious surfaces at higher cn values precipitation is mainly translated into a runoff on the other hand at lower cn values rainfall is mainly infiltrated and is thus not translated into runoff nrcs 1986 a modified version of the scs cn equation was used as described in the swmm reference manual hydrology rossman 2015 in the modified version the initial abstraction i a is not included as it is already included in the depression storage d s see eq 2 the following three equations eq 3 5 are used to calculate the infiltration rate 3 f f 2 f 1 δ t where f is the infiltration rate m s f 2 is the cumulative infiltration at the end of a time step δt m f 1 is the cumulative infiltration at the beginning of a time step δt m and δt is the time step s 4 f p p 2 p s max where f is the cumulative infiltration mm p is the cumulative precipitation mm and s max is the maximum storage capacity of a soil mm 5 s max 1000 cn 10 25 4 where s max is the maximum storage capacity of soil mm and cn is the tabulated coefficient that varies with the land use and soil type 3 2 2 variable uk runoff equation the variable uk runoff equation varuk has three components runoff from impervious areas runoff from pervious areas and initial losses butler et al 2018 it is based on data from 11 uk catchments and 112 rain events the varuk equation is as follows packman 1990 6 pr i f p i m p 100 i f p i m p napi pf where pr is the percentage runoff if is the effective impervious area factor pimp is the percentage of imperviousness napi is the antecedent precipitation index mm and pf is the porosity factor mm the rainfall can be converted into infiltration by using the following equation 7 f i 1 pr 100 3 2 3 uk water industry research runoff equation the uk water industry research runoff equation ukwir kellagher 2014 was developed to overcome some of the limitations of varuk woods ballard et al 2015 which are described in detail in the report development of the ukwir runoff model 2014 as varuk it has a fixed runoff component for paved surfaces if n pimp n it was upgraded with a variable runoff component for paved surfaces 1 if n pimp n additionally a component for pervious surfaces was added 1 pimp total which enables differentiation between winter and summer runoff i e negative napi the ukwir equation is then as follows 8 pr n 1 n if n pimp n 1 if n pimp n pi pv β pf pv 1 pimp total napi s pi s cr s p r pf s where pr is the percentage runoff for the model if n is the effective impermeability factor for a particular paved surface type pi pv is the precipitation index for paved surfaces with a rapid decay coefficient β is the power coefficient for paved surface pf pv is the soil store depth for paved surface mm napi s is the antecedent precipitation index for a particular pervious surface type pi s is the precipitation index for pervious surface with a decay coefficient cr is the power coefficient for pervious surface spr is the standard percentage runoff and pf s is the soil storage depth for a particular pervious surface type mm 3 3 equation discovery and process based modelling the proposed automated modelling approach is based on the process based modelling tool probmot developed by čerepnalkoski et al 2012 probmot allows for the integration of domain knowledge e g urban hydrology formalized as template components for the construction of the process based models into equation discovery from measured data it automatically identifies both the structure and parameter values of an appropriate process based model given a a knowledge library i e a mathematical formulation of the selected domain in the form of model components or more specifically template entities and processes b a conceptual model of the observed system and c measurements fig 2 candidate model structures are generated from the knowledge library and a user specified conceptual model of an observed system the candidate models are transformed into equations calibrated against measurements and ranked according to their errors the latter are calculated as the root mean squared error rmse i e discrepancy between the model simulation and measured data to use probmot for rainfall runoff modelling in the presented case study the following steps were taken 1 the rainfall runoff methods were encoded in a modelling library 2 a conceptual model of the case study was elaborated and 3 probmot was set to discover the best model structure and parameters following the conceptual model of the case study radinja et al 2021 3 3 1 library of components for modelling rainfall runoff the library consists of entity templates process templates and compartment templates each template captures general knowledge that applies to different cases and can be reused when dealing with a specific task the dynamic system to be modelled i e the catchment can be structured by using compartments compartments are organized in a nested tree like structure each compartment contains entities and processes and can also contain other sub compartments e g sub catchments or functional units škerjanec et al 2014 moreover entities represent the actors of the observed system these actors are involved in processes that explain how entities interact as well as what is the influence of the interactions on the involved entities themselves in the urban runoff modelling domain entities correspond to different pools within the urban water cycle climate variables and various types of constituents finally processes provide quantitative descriptions of the relations among entities in terms of one or more equations in the urban runoff modelling domain examples of processes include water fluxes i e transfer processes that are involved in the water cycle e g surface runoff infiltration fig 3 thus processes calculate the change of water fluxes e g surface storage within a time step and entities aggregate these changes over the simulated time the equations presented in section 3 2 were encoded in the knowledge library as template processes named hydrological processes these include outflow surfacestorage surfacerunoff and infiltration with three alternative methods infiltrationscs infiltrationukwir and infiltrationvaruk additionally the intercompartmental process totaloutflow was introduced to sum the outflow from both sub compartments i e sub1 and sub2 see radinja et al 2021 the time step in the presented equations is 1 s thus probmot is calculating the infiltration rate in m s and flow in l s however the actual time step of the input data e g precipitation measured flow is 5 min thus this is also the reporting time step 3 3 2 conceptual model of the case study area the conceptual model of the case study area fig 1 was structured as a single compartment i e catchment divided into two sub compartments i e sub1 and sub2 sub1 represents the impervious part of the catchment and sub2 the pervious part of the catchment fig 3 first the parameters that appear in the equations presented in section 3 2 were listed as constants within the template entity surface in the knowledge library together with their expected ranges and units afterwards this template was reused within the conceptual model see radinja et al 2021 where the values and ranges of the constants were adjusted based on the im perviousness of the sub catchment table 2 following the values proposed in the literature nrcs 1986 kellagher 2014 rossman 2015 3 4 assessment and comparison of model performance once the potentially viable model structures are composed by the probmot algorithm their parameters are fitted to the provided measurements and the resulting models are assessed according to their goodness of fit two measures are used to assess model performance the nash sutcliffe efficiency coefficient nse nash and sutcliffe 1970 and rmse observations standard deviation ratio rsr moriasi et al 2007 nse is commonly used to evaluate the goodness of fit of hydrological models it can range from minus infinity to one where one represents a perfect match between the observed and the modelled discharge a value of 0 indicates that the observed mean is as good predictor as the model while the negative values indicate that the observed mean is a better predictor than the model wilcox et al 1990 legates and mccabe 1999 rsr is standardizing the rmse root mean square error by using the standard deviation of observations it can range from the optimal value of 0 which indicates a perfect model to a large positive value indicating a corresponding error the lower the rsr the better the model performance to rate model performance based on nse and rsr the categorization proposed by moriasi 2007 was used table 3 to find similarities differences between the models based on their scored nse and rsr values the method of hierarchical clustering as implemented by the orange software demšar et al 2013 was applied to the models it forms a dendrogram for arbitrary types of objects in this case models based on a matrix of distances distances were calculated using the euclidian metric which is the ordinary straight line distance between two points in euclidean space the points to cluster are the models represented by their nse and rsr values over all events calibration and validation for a better presentation of the hierarchical clustering so called heat maps were used to visualize the errors of the models with coloured spots 4 results 4 1 calibration given the conceptual model and the modelling library probmot explored 9 alternative structures m1 m9 table 5 each of which was calibrated and validated against the measured data all models were calibrated by simultaneously using data from two short time periods of measured flow with a duration of approximately one day c1 and c2 fig 4 and two long time periods of measured flow with a duration of approximately one week c3 and c4 fig 5 after calibration all models generally had very good performance in terms of comparison between the simulated and measured flow table 4 for the first calibration period c1 the models scored the following average grades average nse value of 0 85 and average rsr value of 0 38 however the models that use the scs cn infiltration method for the pervious area m1 m3 average nse value of 0 80 underpredicted the flow when compared to the rest of the models m4 m9 average nse value of 0 88 for the second calibration period c2 the models scored an average nse value of 0 76 and an average rsr value of 0 49 however the models that use the scs cn infiltration method for the impervious area m1 m4 m7 average nse value of 0 72 underpredicted the flow when compared to the rest of the models average nse value of 0 78 to improve the readability only four models are presented on the hydrograph for longer calibration periods c3 c4 fig 5 for the third calibration period c3 the models scored an average nse value of 0 74 and an average rsr value of 0 51 almost fulfilling the criteria for very good model performance in comparison to the first calibration period c1 the models that use the scs cn infiltration method for the pervious area m1 m3 average nse value of 0 78 performed better than the rest of the models m4 m9 average nse value of 0 73 for the fourth calibration period c4 the models scored the average grades of 0 79 for nse and 0 46 for rsr in comparison to the first three calibrations periods no clear differences in model performance can be observed 4 2 validation the calibrated models were validated on four different rainfall periods table 4 that vary in rainfall duration and intensity table 1 fig 6 presents the shorter two periods namely v1 and v2 the validation period v1 lasted 23 h i e 31 august 2020 12 00 1 september 2020 11 00 with an average measured flow of 39 l s for this validation period the models scored an average nse value of 0 89 and an average rsr value of 0 32 however the model that only includes the scs cn infiltration method m1 performed worse than the rest of the models i e its nse is 0 07 lower it underestimated the flow values for the beginning of the first rain event for both short validation periods v1 and v2 the validation period v2 lasted for 54 h 2 days i e from 21 december 2019 08 00 23 december 2019 14 00 with two rainfall events causing the first and the second highest peak flows among all validation events q1 429 l s and q2 340 l s no clear differences in model performance can be observed across the different models for this validation period to improve the readability only four models are presented on the hydrograph for the longer validation periods v3 and v4 fig 7 namely the three models that use the same infiltration method for the pervious and impervious area m1 m5 m9 and model m3 which had the best performance for these validation periods fig 7 the validation period v3 lasted for 109 h 5 days i e from 28 september 2019 12 00 3 october 2019 01 00 with two individual rainfall events in this case the models that use the scs cn infiltration method for the pervious area performed better than the other models with an average nse value of 0 86 the models that use the varuk or ukwir infiltration method for the pervious area scored lower nse values ranging between 0 76 and 0 81 the first rainfall event is very dynamic and consists of three sub peaks q1 185 l s q2 227 l s q3 260 l s within a period of 2 h with clear breaks low values in between q1 51 l s q2 15 l s as for the previous validation periods m1 underestimates flow at the beginning of the first event however it already fits the third sub peak well on the other hand the models m3 m5 and m9 fit sub peaks better however they do not fit the low values in between as well the second rainfall event also consists of three sub peaks here all models follow the shape of the measured hydrograph more consistently the validation event v4 lasted for 128 h 5 days i e from 1 march 2020 07 00 6 march 2020 15 00 with three individual rainfall events fig 7 for this validation period the models scored an average nse value of 0 80 and an average rsr value of 0 45 in general all models overestimated the flow values however the model that only includes the scs cn infiltration method m1 performed worse than the rest of the models i e its nse is 0 05 lower in comparison to the rest of the models it least overestimated flow values for the beginning of the first rain event yet for the next rain events it overestimated flow the most using hierarchical clustering we clustered the models into groups according to their performance profiles in terms of nse and rsr coefficients across all calibration and validation periods fig 8 one can notice that for both coefficients models are clustered similarly models m1 m2 and m3 form the first group g1 they all use the scs cn infiltration method for the sub2 i e pervious area the rest of the models m4 m9 form the second group g2 furthermore one can notice that the models in the first group g1 are generally more heterogeneous than models in the second group g2 if we compare these groups based on the nse and rsr values one can notice that for the shorter calibration periods c1 and c2 models from the second group g2 generally performed slightly better i e average nse 0 82 average rsr 0 42 than models from the first group g1 i e average nse 0 79 average rsr 0 46 however due to the very different model performance between m1 i e nse 0 83 and m3 i e nse 0 94 for v1 this observation is not confirmed for the short validation periods on the other hand models from g1 performed better for longer calibration periods c3 and c4 i e average nse 0 78 average rsr 0 47 and validation periods v3 and v4 i e average nse 0 82 average rsr 0 42 than models from g2 i e for c3 and c4 average nse 0 76 and average rsr 0 49 for v3 and v4 average nse 0 79 and average rsr 0 45 5 discussion 5 1 model analysis the derived rainfall runoff models can be classified as lumped regarding spatial resolution and continuous regarding temporal resolution fletcher et al 2013 the proposed tool enabled a systematic comparison of three alternative infiltration methods i e scs cn varuk and ukwir allowing also combinations of these methods this is a unique and novel approach as normally only one infiltration method is used within one rainfall runoff model the developed knowledge library compliant with the probmot tool enabled the automatic generation and calibration of these models based on the criteria for assessing models goodness of fit proposed by moriasi et al 2007 and presented in table 3 the models on average had very good performance for the calibration periods c1 c2 and c4 and good performance for the calibration period c3 in the validation process all models had very good performance for all validation periods confirming the usefulness and efficiency of the proposed approach for calibration of model parameters in general the best performance was achieved by model m3 with an average nse value of 0 80 for the calibration periods and an average nse value of 0 88 for the validation periods the second best performance was achieved by model m2 with an average nse value of 0 78 for the calibration periods and an average nse value of 0 87 for the validation periods however some of the other models performed better for individual rainfall periods or achieved similar performance this highlights the fact that no general conclusion can be made on which model is better since model performance results are greatly influenced by the characteristics of calibration and validation periods e g rainfall intensity number of sub rainfall events furthermore this was also not the intention of this research the true value and contribution of this research is the discovery of new knowledge in the urban runoff modelling domain by automated modelling namely the best performance was achieved by models that used a combination of two different infiltration methods in contrast to the usual approach of using a single infiltration method 5 2 automated approach advantages and limitations urban runoff models can be either mechanistic i e based on mathematical formulations of physical phenomena or data driven also known as black box models learning from the relationship between the measured input and output data with no description of the internal functioning of the system frequently artificial neural networks are employed to develop data driven rainfall runoff models troutman et al 2017 compared to these types of automated modelling approaches i e neural networks our approach provides more transparency i e it is an automated way for constructing mechanistic model structures the automation is used for composing viable model structures and calibration the two most time consuming processes in the commonly followed modelling procedure in addition the search through the space of models is automated i e systematic and avoids human errors in order to build fully distributed models hydraulic processes i e pipe flow should be included due to some limitations of the probmot tool only hydrological processes were included firstly based on the required structure of the conceptual model each pipe and manhole within the system would have to be presented as a separate compartment thus significantly increasing model complexity and prolonging computation secondly probmot does not support the encoding of difference equations and conditional statements e g if then rules additionally all the equations included in the library must use the same time resolution hydraulic pipe flow modelling is crucial when modelling complex and large sewer systems in our case the case study area and the adjacent sewer system were relatively small thus the hydraulic pipe flow modelling would not significantly affect the outflow dynamics the three alternative infiltration methods i e scs cn varuk and ukwir were selected and integrated into the knowledge library as they were not affected by the above mentioned limitations of the probmot on the other hand some other frequently used infiltration methods e g horton green ampt were not integrated due to the current probmot limitations in the future we plan to overcome some of these probmot limitations this would allow us to upgrade the knowledge library with hydraulic processes and to include additional infiltration methods 6 conclusions in this study an automated equation model discovery approach was applied to the field of urban runoff modelling first a new library of model components compliant with the equation discovery tool probmot was developed formalizing the knowledge on urban runoff modelling next a conceptual model of the experimental urban sub catchment within the city of ljubljana slovenia was defined the proposed methodology enabled the discovery of optimal structure and parameters values of the rainfall runoff models based on the pipe flow measurements including combination of infiltration methods within a single model structure which represents a novelty in urban hydrological research the main findings of the study are as follows a the proposed automated model discovery approach for finding the optimal rainfall runoff models proved to be very efficient nine rainfall runoff models were created that generally had good or very good performance b the models performed better for validation events with a more stable constant flow scoring higher nse coefficient values and lower rsr coefficient values c based on the model performance evaluation two groups of models could be identified based on whether the scs cn infiltration method was assigned to the pervious area of the catchment d the best performance was achieved by models that used a combination of two different infiltration methods i e the scs cn infiltration method for the pervious area in combination with one of the other two infiltration methods for the impervious area e finally this approach is transferable to any catchment and enables the discovery of viable rainfall runoff models best fitted to local specific conditions on one hand and facilitates the validation and revision of established rainfall runoff models on the other hand credit authorship contribution statement matej radinja conceptualization methodology software formal analysis investigation writing original draft visualization mateja škerjanec methodology software validation writing review editing mojca šraj methodology validation writing review editing sašo džeroski methodology software validation writing review editing ljupčo todorovski methodology software validation writing review editing nataša atanasova conceptualization methodology software validation writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the slovenian research agency research core funding no p2 0180 no p2 0103 no p5 0093 and project no n2 0128 the authors would like to thank the company jp voka snaga for providing the sewer system data and to the slovenian forestry institute for providing the precipitation data appendix a 
3947,nitrate leaching losses from arable lands into groundwater were a main driver in designating nitrate vulnerable zones nvzs according to the nitrates directive with a view to enhancing their water quality despite this developing common strategies for effective water quality control in these areas remains a challenge in the european union this paper evaluates the performance of the random forest rf machine learning algorithm combined with feature selection fs techniques in predicting nitrate pollution in nvzs groundwater bodies in different periods and using updated environmental features in andalusia spain a set of forty four features extrinsic to groundwater bodies were used as environmental predictors with an aim to make this methodology exportable to other regions phenological features obtained through remote sensing techniques were included to measure the dynamics of agricultural activity in addition other dynamic features derived from weather and livestock effluents were included to analyse seasonal and interannual changes in nitrate pollution three feature stacks and two nitrate databases were used in the predictive modelling period 1 2009 with 321 nitrate samples for training period 2 2010 with 282 nitrate samples for validation and initial spatial prediction and period 3 2017 to assess the changes in the probability of groundwater nitrate content exceeding 50 mg l random forest as a wrapper with four sequential search methods was considered sequential backward selection sbs sequential forward selection sfs sequential forward floating selection sffs and sequential backward floating selection sbfs from among all the feature selection methods applied random forest with sfs had the best performance overall accuracy 0 891 and six predictor features and linked the highest probability of nitrate pollution with three dynamic features the normalized difference vegetation index ndvi base level ndvi value for the end of the growing season and accumulated manure production of livestock farms and three static features slope sediment depositional areas and valley depth keywords nitrates machine learning feature selection groundwater nitrate vulnerable zones 1 introduction protecting strategic resources such as water is currently a major challenge not only in the field of environmental research but also at all levels of government changes in water resource quality significantly affect society and the economy especially in the production of basic resources such as food who 2017 the application of nitrogen fertilisers and pesticides to crops in recent decades coupled with the diffuse pollution that these generate is one of the main causes behind the failure to achieve a good chemical status for groundwater in the european union eu european environmental agency 2018 the surplus of chemical and organic nitrogen fertilisers from agricultural activity can leach to groundwater as nitrate babiker et al 2004 juntakut et al 2019 and from the action of other sources such as livestock farming cho et al 2000 tullo et al 2019 high concentrations of nitrate in drinking water can be a serious threat to human health and can cause illnesses with long term exposure including methemoglobinemia and thyroid cancer fewtrell 2004 ward et al 2010 groundwater is a major source of drinking water in the eu where 24 5 of freshwater extracted for drinking purposes was groundwater in 2017 european environmental agency 2020 to address the problem of water pollution the water framework directive wfd 2000 60 ec aimed to protect and improve water quality in the eu establishing monitoring controls to evaluate impacts and control long term trends together with the wfd the nitrates directive nd 91 676 eec had a huge impact on controlling pollution caused by agricultural nitrates in ground and surface waters oenema et al 2011 this directive required that all member states designate areas within their territories that drain into waters which could be affected by nitrate pollution or that could be affected if action is not taken to decrease nitrate leaching as nitrate vulnerable zones nvzs goodchild 1998 velthof et al 2014 the report on the implementation of the nitrates directive between 2012 and 2015 revealed that 13 2 of the groundwater stations in the eu recorded nitrate concentrations exceeding the legal limit of 50 mg l european commission 2018 approximately 21 5 of measuring stations in spain registered averages higher than 50 mg l in the same period european commission 2018 the same situation occurred in andalusia the most highly populated nuts2 region in spain where 51 of the 176 groundwater bodies had a poor chemical status due to high nitrate concentrations in 2015 according to the hydrological plans confederación hidrográfica del guadalquivir 2015 determining nitrate concentration in groundwater enables the identification and delimitation of areas at spatial risk of pollution a narrowed focus in terms of resource management and compliance with the wfd and nd usual methods based on time series forecasting for the evaluation of nitrate concentrations consist of trend analysis ducci et al 2019 hansen et al 2012 theoretical gross nitrogen balance wick et al 2012 and numerical modelling of fate and transport of contaminants akbariyeh et al 2018 esmaeili et al 2014 these methods are applied at various scales principally at the farm regional and national agency levels and possess inherent uncertainties due to weather variability soil conditions manure management crop cultivation practices and socio economic circumstances kawagoshi et al 2019 mendes et al 2012 mendes ribeiro 2010 wick et al 2012 the selection of these methods is also based on the availability of data i e input parameters the spatial and temporal representativity of monitoring networks and underlying assumptions recently hydrology studies on nitrate pollution have benefited from the development of machine learning algorithms mla that learn from examples and thus do not require pre established rules based on expert criteria buduma locascio 2017 mlas have been used both alone dixon 2005 knoll et al 2020 nolan et al 2014 rodriguez galiano et al 2014 tesoriero et al 2017 wagh et al 2018 and as part of ensembles barzegar et al 2018 khosravi et al 2018 knoll et al 2019 motevalli et al 2019 rodriguez galiano et al 2018 sajedi hosseini et al 2018 singh et al 2014 wheeler et al 2015 to predict the spatial distribution of nitrate concentrations in groundwater generally these studies have been applied primarily at local and regional scales although others have been applied at a national scale such as knoll et al 2020 in germany and at a continental scale such as ouedraogo et al 2019 in africa one of the most widely used mlas for predicting nitrate concentrations in groundwater is random forest rf with examples such as knoll et al 2020 nolan et al 2014 ouedraogo et al 2019 rodriguez galiano et al 2014 and wheeler et al 2015 random forest has multiple advantages as a non parametric method that allows different data sets to be handled and is very effective for non linear relationships between features and for outlier values breiman 2001a biau and scornet 2016 in addition random forest allows assessment of the relative importance of predictive features within the prediction thus providing an understanding of how each predictive feature influences the model in order to select the best features for modelling ghimire et al 2010 rodriguez galiano et al 2012 the performance of random forest has been evaluated with other machine learning algorithms in several nitrate pollution studies band et al 2020 knoll et al 2019 messier et al 2019 and it was the mla with the best predictive performance the use of random forest can be improved by using feature selection fs algorithms which allow a subset of original attributes to be selected and to optimally reduce the feature space according to a specific criterion blum langley 1997 dash liu 1997 zhang bao ho 2006 the aim of feature selection is to select a subset of relevant features to build robust learning models thus reducing the number of features used in the prediction blum langley 1997 rodriguez galiano et al 2018 saeys et al 2007 and contributing to a better understanding of the processes feature selection allows for increased model accuracy reducing the effect of the curse of dimensionality bellman 2003 obtaining more generalisable models accelerating the learning process and increasing their interpretability guyon and elisseeff 2003 different feature selection statistical methods are available filters embedded and wrappers filters are usually applied in a pre processing stage and do not need a machine learning algorithm for feature selection kohavi john 1997 embedded methods perform feature selection during the training process and are generally specific to given learning machines guyon and elisseeff 2003 likewise wrapper based methods combine a machine learning algorithm with a feature search method selecting the subset of features with the best predictive performance guyon and elisseeff 2003 the ability to select the most relevant features has allowed the use of feature selection in predicting nitrate concentrations in groundwater using either the wrapper method dixon 2005 khalil et al 2005 wheeler et al 2015 or the embedded method rodriguez galiano et al 2014 tesoriero et al 2017 with several feature selection methods available studies such as rodriguez galiano et al 2018 and effrosynidis arampatzis 2021 assessed the performance of different feature selection methods and concluded that wrapper based feature selection methods had higher predictive performance than other methods although the use of mla has been a huge step forwards in the study of nitrate pollution regularly updating these studies to monitor particularly vulnerable groundwater bodies remains challenging many studies include intrinsic properties of groundwater bodies which influence the direction and migration rate of nitrates within groundwater bodies some commonly used features include groundwater recharge rate hydraulic conductivity transmissivity and depth to groundwater motevalli et al 2019 ransom et al 2017 wheeler et al 2015 nevertheless the hydraulic properties evaluated by pumping tests are usually few and have limited spatial representation not representing the anisotropic behaviour of the groundwater bodies the exclusive use of features extrinsic to groundwater bodies for nitrate prediction allows these studies to be easily upgraded and does not require measurements in a specific environment or at great expense thus previous studies such as wells et al 2021 used static and dynamic extrinsic features of groundwater bodies to predict vadose and saturated zone transport rates and lag times using random forest studies based on predicting the spatial distribution of nitrates in groundwater commonly use land cover images as a proxy to measure the impact that agriculture has on groundwater pollution rodriguez galiano et al 2014 used images from vegetation indices obtained through remote sensing techniques for a specific date to measure the importance of agriculture in making predictions however the use of a land cover image or a single image from a vegetation index normalized difference vegetation index ndvi to measure agricultural activity and its impact on nitrate pollution lacks fundamental information such as agricultural seasonality interannual crop variability and productivity due to the fact that it is not representative of the entire growing season the inclusion of ndvi time series adds more information by including all stages of the growing season in addition they can serve as an indicator of vegetation biomass and crop type and may be related to crop yields duncan et al 2015 sakamoto et al 2005 this study develops a method based on random forest and feature selection to predict the probability of nitrate concentrations above 50 mg l in groundwater bodies located in nitrate vulnerable zones in andalusia spain in the present period 3 2017 using models trained with past environmental conditions period 1 2009 validated at an intermediate time point period 2 2010 the main novelties of this study are based on the ability to export the applied methodological procedures to other geographical areas using only features extrinsic to groundwater bodies available from national and international public agencies an easily updatable free data source and operational method for identifying potential nitrate pollution of groundwater from agricultural activities is proposed that can help to establish nitrate vulnerable zones where nitrate monitoring data and hydrogeological parameters for aquifers are scarce to determine the impact that agriculture has on nitrate pollution of nitrate vulnerable zones a set of phenological metrics were included that were derived from the functional analysis of vegetation indices obtained via remote sensing techniques other features used were weather data terrain features soil properties and livestock effluents the main objectives of this study were 1 to map zones of high nitrate concentration in groundwater bodies at different time periods 2 to identify the most important features in nitrate pollution of nitrate vulnerable zones 3 to evaluate the effectiveness of different feature selection approaches and 4 to evaluate the probability of exceeding the 50 mg l nitrate threshold in nitrate vulnerable zones for different types of groundwater bodies 2 materials and methods 2 1 case study andalusia is the southernmost spanish administrative region nuts2 on the iberian peninsula it is located in southwestern europe and has a land area of 87 000 km2 its terrain consists of various mountainous systems separated by alluvial depressions the region is characterised by a mediterranean climate with a dry period in the summer that separates two rainfall peaks in spring and autumn average annual rainfall ranges between 300 and 2000 mm and the average temperature is 17 c with maximum values in july august and minimum values in january the climate promotes agricultural use in the alluvial river basins primarily through intensive agriculture the main arable land areas are irrigated and dry farming olive groves orchards and greenhouses besides the baetic depression which is the main region for agricultural production other production regions of note include vega de granada and campo de dalías fig 1 groundwater in andalusia comprises approximately 27 of the water used for irrigation of arable crops ine 2021 large agricultural areas in andalusia are located in the river basins of its main rivers such as the guadalquivir and genil rivers fig 1 most of the detrital aquifers are located in these river basins and receive the excess nitrogen pollutants from fertilisers andalusia is the region in spain that saw the greatest use of nitrogen fertilisers between 2009 and 2017 with an average of 240 57 thousand tonnes per year fertiliser application has been generally trending upwards between 2009 210 3 thousand tonnes and 2017 309 5 thousand tonnes first fertiliser inputs were decreasing until 2014 when fertiliser application reached its minimum level 285 6 thousand tons of nitrogen the trend reversed the following years reaching the maximum fertiliser application in 2017 ministerio de agricultura pesca y alimentación 2021 the nitrates directive 91 676 eec required that eu countries identify surface waters and groundwaters with nitrate concentrations above 50 mg l or those at risk of being polluted by agricultural nitrates the identification of polluted waters or waters at risk of being polluted was the first step towards the designation of nitrate vulnerable zones regional governments in spain designated nitrate vulnerable zones using bodies of water that had been identified as polluted or at risk of being polluted and the identification of intensive agricultural and livestock plots whose seepage affected bodies of water due to nitrate input junta de andalucía 2008 the hydrogeological properties of groundwater bodies in andalusia are diverse carbonate aquifers are mainly located in the east and north of andalusia and are composed of limestones and dolomites detrital and mixed bodies of water are located in alluvial river basins and areas with low relief complexity and are primarily composed of materials such as sands gravels silts and sandstones the main recharge method for all groundwater bodies is infiltration by rainwater but to a lesser extent also by infiltration of agricultural irrigation surpluses lateral inputs from other aquifers and surface runoff as the upper layers are usually composed of permeable materials lópez geta 1998 this study uses the groundwater bodies identified in fig 1 to predict the distribution of nitrate concentrations and the area of nitrate vulnerable zones within the groundwater bodies to assess their susceptibility to nitrate pollution 2 2 data groundwater nitrate data was obtained from a national scale water quality monitoring network database ministerio para la transición ecológica y el reto demográfico 2021 nitrate samples were obtained from open interval at varying depths thus the final sample is a mixture of the water collected from the borehole throughout the open interval at an average depth of 10 60 m depending on the groundwater body the initial database was filtered to collect groundwater samples from andalusia and to remove erroneous data and sampling problems the final database consisted of 1 312 samples from 451 different measurement sites with an average temporal frequency of six months i e two sampling campaigns per year nitrate samples were obtained considering the months and years that had the highest number of samples between june and october of 2002 2010 fig 2 these two periods in the year coincided with the period before and after the fertilisation process the years 2002 2006 and 2008 had fewer samples and showed higher seasonal and interannual variability with greater dispersion june samples showed a tendency to accumulate higher amounts of nitrates with a lower number of samples whereas october samples showed lower amounts of nitrates when the number of samples increased the 2009 and 2010 campaigns were selected for predictive modelling as they had a higher number of samples and a more balanced distribution between the pre and post fertilisation period june and october the mean and median nitrate values for 2009 were lower than those for 2010 43 8 mg l and 14 mg l in 2009 and 59 mg l and 19 5 mg l in 2010 the maximum and minimum values were 356 mg l and 1 mg l for 2009 and 420 mg l and 0 mg l lod mg l for 2010 two data subsets were generated i 321 samples from the june and october campaigns in 2009 used for model training and ii 282 samples from the june and october campaigns in 2010 used as an independent test for model validation see section 2 3 predictive modelling all available samples from each campaign were used for model training applying a 10 fold cross validation to obtain an independent test of all samples 248 41 1 were obtained in detrital groundwater bodies 196 32 5 in carbonate groundwater bodies and 159 26 4 in mixed groundwater bodies a set of 44 independent features related to driving forces activities that may affect the environment and nitrate infiltration was used for prediction only features for which data could be easily obtained on a large scale were selected a requirement in this study was to use data available from public agencies with a view to making this methodology exportable to other regions or a national level in a simple and straightforward way the features that were selected were related to i crop phenology ii livestock effluents iii digital terrain models dtms iv weather and v soil textures table 1 shows the independent features included data sources and extraction methodology features were resampled to a grid with common coordinate origin and spatial resolution 250 m 250 m phenological observations are essential in many aspects of agricultural practice such as defining the growing season length for crops in a specific region or the timing of irrigation and fertilisation caparros santiago et al 2021 chmielewski 2013 in this study phenology was considered as a proxy to identify agricultural areas and separate them from natural vegetation and urban areas phenological features provide more information than a static land cover image as they not only record a measure of which agricultural areas are in production but can also be used to predict the degree of agricultural production their use allows identification of the date on which the growing season begins sprouting of the plant and the date of harvest enabling distinctions between different types of crops and their phenological stages phenology also allows distinguishing between irrigated and rainfed crops with the former typically being more demanding in terms of nitrogen fertilisation and with better soil conditions for nitrate leaching occur dzurella et al 2015 merchán et al 2020 thirteen phenological features were extracted from the analysis of ndvi time series calculated from weekly surface reflectance composites of the modis mod09q1 product livestock effluent features were obtained from the livestock farms census in andalusia which identifies each livestock farm livestock quantity and species the excretion coefficient was obtained for each type of livestock using those available for spain unfccc 2021 livestock effluents were quantified by considering their cumulative and average impact to this end three search radii 1 3 and 5 km were specified yielding 6 features livestock effluents were calculated using the methodology proposed by eurostat 2013 n excretion was predicted by multiplying the excretion coefficients per head and type of livestock n c by the average annual population aapi of that livestock species 1 n excretion t o n n e s n i a a p i 1000 h e a d s n c k g n p e r h e a d p a a set of eighteen terrain model related features and six weather related features was included in the study terrain features were extracted from the digital terrain model dtm for spain obtained from the airborne lidar point cloud at a resolution of 25 m on the website of the spanish national geographic institute ign which was then resampled to 250 m the terrain features included in the study were i basic topography metrics i e elevation ii morphometry through roughness concavity and convexity measurements i e slope terrain ruggedness index multiresolution ridge top flatness index mrrtf and multiresolution valley bottom flatness index mrvbf and iii hydrological analysis including measurements of channel network identification and flow catchment area i e channel network base level and total catchment area weather was included with two features precipitation and temperature the monthly average for the three months and the month before the nitrate samples were used taking into account the time it might take for nitrogen pollutants to leach into the groundwater bodies under different meteorological conditions and after precipitation events as well as the flow and transport mechanisms in the unsaturated zone of the aquifers al jaf et al 2021 kawagoshi et al 2019 menció et al 2011 mendes ribeiro 2010 high temperatures are associated with higher plant evapotranspiration which may have an impact on lower nitrate leaching wick et al 2012 in contrast high average temperatures may lead to higher rates of soil mineralisation which could increase nitrate concentration in groundwater schweigert et al 2004 meanwhile heavy precipitation is associated with increased leaching of pollutants such as nitrates that have previously been stored in the soil wageningen university research 2011 features with different temporal amplitudes for precipitation and temperature were included to train the model for spatio temporal variability of pollutant infiltration into groundwater both precipitation and temperature features were obtained as final products from the andalusian environmental information network rediam laboratoriorediam cica es temperature and precipitation data was obtained from the meteorological stations of the spanish meteorological agency aemet in both cases likewise the textural fractions sand silt and clay were estimated using predictive models built with the random forest algorithm cañero rodríguez galiano 2019 also using predictor features derived from land surface phenology terrain attributes and meteorology the soil samples for the textural fractions were obtained from the spanish national soil erosion inventory ines which has surface soil samples for the whole of spain obtained at a depth of approximately 10 30 cm 2 3 predictive modelling the aim of the study was to take a three phase methodology that is commonly used for land use change modelling and adapt it for predicting nitrate pollution in groundwater figure 3 shows the flowchart for methodology that was applied three stacks of 44 features with a common spatial resolution 250 m 250 m were generated for predictive modelling including static features terrain features and textures and dynamic features phenology livestock effluents and weather it should be noted that the dtm and texture derived features are static and therefore identical for 2009 2010 and 2017 the models were trained using two different campaigns of 321 nitrate concentration samples both for the period 1 june and october 2009 and a stack of predictor features for 2009 the predictive performance of the models trained in period 1 was evaluated internally using a 10 fold cross validation cv the use of cv allows the algorithm to learn from the totality of the data and is an unbiased and iterative procedure which is useful for cases where there is a low number of training samples once evaluated by cv the models were applied to perform a spatial prediction of the probability of nitrate concentrations in the groundwater bodies identified in fig 1 exceeding 50 mg l for the period 2 2010 by using a new feature stack for 2010 two nitrate maps were obtained corresponding to june and october to assess the prediction differences associated with the dynamic features the spatial predictions made for period 2 were used to perform a statistical analysis of nitrate concentrations in the area of groundwater bodies in the nitrate vulnerable zones nvzs see fig 1 by model and groundwater body type detrital carbonate and mixed in order to find out which bodies of water have a higher probability of nitrate pollution 50 mg l nitrate the spatial predictions for period 2 were also applied to perform an additional test on a different dataset to the training dataset this test of 282 nitrate samples from june and october 2010 enabled assessment of the generalisation capacity and uncertainty associated with applying models trained in an earlier period period 1 2009 to the dynamic features of period 2 2010 in addition a third feature stack corresponding to period 3 2017 was used to perform a new spatial prediction where it was assumed that the associated accuracy or uncertainty would be similar to those of the independent test performed on the 282 nitrate samples from period 2 2010 as the features in both cases were different to those from period 1 2009 thus changes in the probability of nitrate concentrations above 50 mg l in groundwater bodies were quantified for the period 2010 2017 all models were built in r 3 5 3 software using the mlr package bischl et al 2016 for training and validation random forest alone and in combination with feature selection approaches were employed to identify the drivers of high nitrate concentrations random forest for classification was used in the study because of its successful results in predicting nitrate pollution in groundwater knoll et al 2019 tesoriero et al 2017 as this is a probability analysis the response feature was binarised prior to model training samples of nitrate concentrations below 50 mg l were reclassified as 0 not polluted and those above were reclassified as 1 polluted random forest only needs two parameters to be defined to generate the predictive models the number of trees generated in the classification k and the number of predictor features m used in each tree breiman 2001 for classification each tree provides a unit vote for the most popular class in each input instance so that the final result is determined by the majority vote of all trees guo et al 2011 rodriguez galiano et al 2012 the hyperparameters were tuned to obtain more robust and generalisable models establishing parameter combinations that optimise the predictive performance of the models probst et al 2019 the k parameter used values of 100 200 300 400 500 600 700 800 900 and 1000 and the m parameter used a value of 1 30 running 300 different models in order to avoid creating very complex and uninterpretable models with features that provide redundant information a feature selection process was applied to the models trained in period 1 2009 different feature selection approaches based on the random forest wrapper method were applied in this study due to the better performance compared to other feature selection methods effrosynidis arampatzis 2021 rodriguez galiano et al 2018 different search strategies can be used in feature selection such as exhaustive search genetic algorithms random search and forward and or backward deterministic search the last search method was selected because it has the best ratio balance between performance and computational cost guyon and elisseeff 2003 four sequential feature search strategies were used sequential backward selection sbs sequential forward selection sfs sequential forward floating selection sffs and sequential backward floating selection sbfs the evaluation of the predictive performance of all models generated in period 1 with cv and in period 2 with the additional fixed test was performed using an objective function such as the mean misclassification error mmce the mmce is the average misclassification error expressed as a proportion and is commonly used as a measure of classifier accuracy ferri et al 2002 in terms of predicting nitrate pollution in groundwater the mmce has been used to analyse misclassified cases rodriguez galiano et al 2018 likewise the importance of features in predicting random forest and feature selection models was measured with mean decrease in gini which is the average of a feature s total decrease in node impurity weighted by the proportion of samples reaching that node in each individual decision tree in the random forest breiman 1998 the greater the value of the mean decrease gini score the greater the importance of the feature in the model the kappa coefficient k was employed as a complementary measure to assess the suitability of applying a model trained using the driving forces of period 1 2009 to the period 2 2010 feature stack the k coefficient is a measure of the overall agreement of an error matrix after discounting for matches that may be due to chance cohen 1960 it is calculated by comparing the proportion observed along the diagonal p0 minus the proportion expected to be obtained by chance pe divided by the maximum chance of agreement that can be expected for the marginal totals 1 pe k p 0 p e 1 p e likewise the evaluation of the model accuracy obtained by feature selection was performed by estimating the true positive rate tpr and the false positive rate fpr tpr indicates the percentage of nitrate samples correctly classified in polluted areas conversely fpr indicates the percentage of misclassified samples in polluted areas each threshold results in a tpr fpr pair and a series of such pairs are used to plot the receiver operating characteristic roc curve these are also known as the sensitivity tpr and specificity 1 fpr rodriguez galiano et al 2014 the sensitivity is the probability of predicting nitrate pollution given that the true state is polluted the specificity is the probability of predicting no nitrate pollution given that the true state is unpolluted hastie et al 2009 the area under the roc curve statistic auc was used as a measure of a classifier s performance an auc value of 1 is considered perfect and an auc value of 0 5 is considered to be random guessing bradley 1997 3 results 3 1 feature importance figure 4 shows the 15 most important predictor features included in the models in general terrain features were the most important followed by phenological features the models trained in random forest rf alone and those in random forest with feature selection using sequential backward search rf sbs and rf sbfs used more features in the prediction than the random forest models with feature selection using sequential forward search rf sfs and rf sffs resulting in large differences in importance values in rf sfs only 6 features were used in the prediction slope mrrtf end season val ndvi valley depth base level ndvi and lstock sum 1 making it the simplest model in comparison rf rf sbs and rf sbfs used 44 41 and 36 predictor features respectively while rf sffs used 7 features slope mrtrf altitude silt convexity start season ndvi and mean temp 1 month 3 2 modelling assessment table 2 shows the evaluation of the models in cross validation cv with nitrate samples from period 1 and in the fixed test with nitrate samples from period 2 in cross validation the models trained in rf sfs and rf sffs achieved better performance mmce 0 101 than random forest rf alone mmce 0 133 and the remaining random forest models with feature selection the results show that the random forest models with feature selection outperformed random forest alone the models based on sequential backward searches rf sbs and rf sbfs had greater accuracy mmce 0 102 than those based on sequential forward search mmce 0 109 however rf sfs and rf sffs prediction used fewer features achieving models with a lower computational cost k showed a good degree of agreement across all models although certain differences existed and rf sbs was the model that obtained the greatest degree of agreement k 0 766 random forest alone achieved the lowest degree of agreement in this metric k 0 731 using the complete set of features for model building figure 5 shows the results of an roc curve analysis considering the true positive rate and false positive rate according to different thresholds for the possibility of being classified as zones with high probability of nitrate pollution both rf sfs rf sffs auc 0 958 and rf sbs rf sbfs auc 0 961 achieved identical accuracies showing that nearly all groundwater samples with high nitrate levels 50 mg l were classified correctly therefore the accuracy of the models trained in rf sfs rf sffs was very similar to that of the models trained in rf sbs rf sbfs despite using a set with a lower number of driving forces confirming the results obtained in the fixed test for period 2 see table 2 3 3 spatial prediction for period 2 and groundwater typology analysis the model used for spatial prediction was the one obtained with all predictor features random forest rf alone the simplest model random forest with sequential forward selection rf sfs and the model with the lowest mmce random forest with sequential backward selection rf sbs figure 6 represents the probability of identifying nitrate concentrations above 50 mg l in the groundwater bodies in andalusia for period 2 2010 the spatial prediction analysis shows the same nitrate distribution pattern for all models with differences existing mainly at the local level and particularly in rf sfs in general the probability of identifying high nitrate concentrations increased in areas with larger arable land extensions the highest probabilities were primarily found in the alluvial depressions of rivers and depositional zones where sedimentation is the dominant process the results obtained for random forest alone and rf sbs were spatially similar which may be due to the use of a set of similar features in the prediction however the small difference between the features used for random forest alone and rf sbs made this latter model the one with the highest accuracy figure 7 shows the box plots for predictions generated by the models rf sfs obtained more dispersed probability values than random forest alone and rf sbs which mainly predicted intermediate probability values between 0 3 and 0 6 rf sfs showed a lower probability of identifying large quantities of nitrates overall with 34 of the area of the nitrate vulnerable zones having a probability of 0 5 for october compared with random forest alone 44 and rf sbs 45 the larger number of dynamic features used in the random forest alone and rf sbs models favoured seasonal variability in making predictions thus the difference in average probability between campaigns was not significant for both models with and without feature selection with higher probability values in october 0 45 in rf alone and 0 46 in rf sbs than in june 0 43 in rf alone and 0 44 in rf sbs rf sfs did not use any dynamic features in the prediction e g temperature or precipitation thus the spatial predictions for june and october were identical with an average probability of 0 38 figure 8 shows the box plots for the probability of nitrate concentrations above 50 mg l in the nitrate vulnerable zones nvzs in andalusia by learning model and groundwater body typology detrital carbonate and mixed for period 2 2010 box plots were created to assess the probability of nitrate pollution 50 mg l nitrate in the different groundwater body types in andalusia detrital carbonate and mixed in june and october overall the prediction results show that detrital and mixed groundwater bodies are more likely to have nitrate concentrations above 50 mg l than carbonate groundwater bodies model analysis shows how rf sfs predicted lower mean probability of nitrate pollution in detrital and mixed groundwater bodies detrital 0 38 in june and october mixed 0 40 in june and october compared to random forest alone detrital 0 45 in june and 0 48 in october mixed 0 42 in june and october and rf sbs detrital 0 46 in june and 0 48 in october mixed 0 43 in june and october for carbonate groundwater bodies a similar probability was predicted by the models for random forest alone carbonate 0 29 in june and 0 30 in october rf sfs carbonate 0 25 in june and 0 25 in october and rf sbs carbonate 0 31 in june and october the analysis by models and groundwater body typologies shows that rf sfs dispersed the values more than the other models which is reflected in the spatial prediction as an absence of central values yellow tones see fig 6 3 4 spatial prediction for period 3 and change analysis the model built in random forest with sequential forward selection rf sfs was used to perform a new spatial prediction using the period 3 2017 feature stack this model had the best predictive performance of all the trained models and was computationally more efficient as it had a similar predictive performance with a much smaller number of features than the other trained models figure 9 shows the spatial prediction of the probability of nitrate concentrations above 50 mg l in groundwater bodies for june and october of period 3 2017 as well as the changes in the spatial prediction made by the learning model between 2017 and 2010 it should be noted that since rf sfs did not use any seasonal dynamic features i e temperature or precipitation the prediction was identical for june and october the map displays changes in probabilities of nitrate concentrations exceeding 50 mg l as the areas where the probability of nitrates increased in 2017 in brown and areas where it decreased in blue the areas that show no change in yellow range from 0 05 to 0 05 overall the probability remained stable at 0 38 although according to the prediction the area affected by the highest probability of nitrate pollution 50 mg l nitrate decreased in 2017 to 33 slightly lower than the period 2 value 34 feature selection has the advantage of improving the interpretability of the models by selecting the most relevant feature set for classification the model built in rf sfs used three dynamic features end season val ndvi base level ndvi and lstock sum 1 the dynamic features enabled detection of changes at the local scale thus the probability was reduced in those areas where the end season val ndvi ndvi value for the end of the growing season eos and base level ndvi bl were higher compared to period 2 in other areas where ndvi was slightly lower lstock sum 1 accumulation of livestock effluent within 1 km was found to have increased significantly compared to period2 thus livestock effluent may also have influenced the increase in the probability of nitrate pollution in specific regions 4 discussion 4 1 use of extrinsic features of groundwater bodies and their effect on nitrate pollution the probability of nitrate concentrations exceeding the thresholds established in wfd 50 mg l nitrates can be predicted using environmental features extrinsic to groundwater bodies to this end features were used that are easily updatable on a spatio temporal scale and can be adapted to the complex and dynamic interplay between the hydrological cycle and diffuse pollutant transport kumar et al 2020 existing predictive modelling of nitrate pollution in the literature uses hydrogeological features as part of subsets of aquifer scale predictive features i e boy roura et al 2013 motevalli et al 2019 rahmati et al 2019 tesoriero et al 2017 the complex measurement of hydrogeological parameters or the lack of large scale measurements of these parameters in many regions hampers the ability to replicate the methodology of these studies in larger settings knoll et al 2020 and ouedraogo et al 2019 performed predictions of nitrate concentrations at national and continental scales using mla that overcome the limitations of obtaining hydrogeological information for several bodies of water however its applicability in the continuous analysis of nitrate may be limited by the need for updated hydrogeological information in areas where in the case of countries such as spain said information is not provided by government administrative bodies this study attempted to avoid the limitations associated with producing updated hydrogeological information by using dynamic environmental features to train multi temporal predictive models sensitive to seasonal changes in nitrate concentration in groundwater random forest with sequential forward selection rf sfs was the model that had the best predictive performance in relation to the number of features and used both dynamic and static features in the prediction the three dynamic features were end season val ndvi and base level ndvi which are related to phenology and lstock sum 1 which is related to livestock farming the phenological features were base level ndvi and the ndvi value of the eos base level ndvi is the mean between the minimum values at the beginning and at the end of the growing season eklundh jönsson 2017 and both base level ndvi and the ndvi value of the eos are associated with the period with less photosynthetic activity of vegetation i e the period where the ndvi value is lower the results show that the probability of higher nitrate concentrations in the nitrate vulnerable zones is linked to the zones where the base level ndvi and the ndvi value of eos are lower this coincides with zhao et al 2020 who identified a negative relationship between nitrate leaching and the increase in the vegetation index value in autumn and winter months in such a way that nitrate leaching is reduced in zones with increased above ground biomass and plant nitrogen as was also shown in macdonald et al 2005 zhao et al 2020 also linked a decrease in soil water nitrate concentration with an increase in the ndvi value and greater plant nitrogen storage higher nitrate concentrations in nitrate vulnerable zones also showed a positive relationship with high density manure production areas the accumulation of livestock effluents within a 1 km radius lstock sum 1 was the feature included in the model indicating that the greatest effluent impact would be in areas closest to farms this positive relationship has been analysed in studies such as de notaris et al 2018 and could be explained by the leaching of livestock effluents deposited in and around buildings oenema et al 2007 or used as fertilisers the static features included in sfs and with the greatest importance in all models were terrain features see fig 4 terrain features were also the most important in sffs although this model additionally included soil textural features such as silt a controversial aspect of feature selection is the multiplicity of good models which is also common in statistical algorithms such as multiple regression or logistic regression different feature subsets might share good and similar accuracy thus resulting in a non unique solution or physical model explaining a phenomenon rashomon effect breiman 2001b slope was the most important in sfs and sffs the zones with the shallowest slope favoured infiltration processes affecting groundwater bodies antonakos lambrakis 2007 the average surface terrain slope over groundwater bodies in andalusia is 8 16 while this slope decreases to 3 52 in nitrate vulnerable zones this is because nitrate vulnerable zones usually occur within the alluvial zones of large rivers which are more suitable for agricultural activities in fact features such as slope altitude or ruggedness are linked in the literature to the groundwater potential zones naghibi et al 2017 rahmati et al 2018 as well as to the higher nitrate pollution in groundwater mfumu kihumba et al 2016 motevalli et al 2019 ouedraogo et al 2016 other features included in the models such as mrrtf and mrvbf identified the summits of ridges and the bottoms of valleys respectively gallant dowling 2003 the importance of these features which are related to the morphological conditions of the terrain might be linked to the accumulation of run off surpluses and the infiltration process affecting the vadose zone mendes ribeiro 2014 thus parra suárez et al 2019 and zhu et al 2009 observed that nitrate leaching processes in hillside agroforestry environments increased in lower area of the hillsides and sediment deposition areas which might be related to slope mrrtf and mrvbf due to nitrate transport by soil water young briggs 2005 the results also showed that areas of lower elevation in nitrate vulnerable zones are more susceptible to nitrate pollution creed band 1998 found a positive relationship between lower elevation and nitrate leaching stating that lower elevation might be related to areas that receive less precipitation rahmati et al 2019 reported the highest concentration of nitrates in the groundwater of valleys which tend to have greater agricultural activity and are more susceptible to soil water retention in the case of andalusia agricultural areas are spread over the catchments of the main rivers where the average elevation does not exceed 350 m thus the highest nitrate concentrations might be related to agricultural areas 4 2 comparison of feature selection approaches the application of feature selection algorithms enabled the selection of subsets of explanatory environmental features obtaining simple methodological procedures that could be exported to other nitrate vulnerable zones with similar properties in the eu the sequential backward search sbs and sbfs strategies obtained a lower mmce compared to the sequential forward search sfs and sffs strategies with success rates of 89 8 and 89 1 respectively see table 2 mmce period 2 these results stood in contrast to those of rodriguez galiano et al 2018 who obtained better results with models trained with sequential forward selection sfs and sequential forward floating selection sffs likewise random forest alone was the model with the worst performance correctly classifying 88 7 of cases see table 2 mmce period 2 however the prediction obtained from random forest alone showed better performance than other probability based studies such as tesoriero et al 2017 who obtained a success rate of 77 for probabilities of nitrate concentrations above 5 mg l in wisconsin usa and rodriguez galiano et al 2014 who had a success rate of 80 46 for probabilities of nitrate concentrations above 50 mg l in a region of southern spain this is an advance in nitrate prediction in large scale areas generating highly accurate spatial predictions for groundwater bodies with different hydrogeological properties without requiring nitrate sampling campaigns for each nitrate vulnerable zone to this end different innovative aspects have been included using dynamic e g phenology and static e g soil attributes features that are extrinsic to groundwater bodies in addition a novel three step methodology has been applied to select representative drivers of nitrate pollution and their seasonal variability among all the models generated rf sfs was considered the model that performed best obtaining an mmce similar to the most accurate models with only six features the difference in the number of features confirms the idea proposed by guyon and elisseeff 2003 and verified by rodriguez galiano et al 2018 that wrappers built using forward sequential search were computationally more efficient identifying a smaller feature subset at a similar error rate nitrate samples from period 2 2010 were used for model validation in this sense nitrate samples were not available for validation purposes at period 3 2017 as the idea behind this methodology is to predict the current status of groundwater bodies for operative and early diagnosis see section 2 3 predictive modelling it should be noted that this is a standard approach in certain areas of science such as land use change modelling camacho olmedo et al 2015 msofe et al 2020 but has never been applied to groundwater pollution additionally the usefulness of this approach is not only to have spatial predictions of the probability of nitrate pollution using nitrate measurements from previous years but also to have a prediction for groundwater bodies at a regional level the proposed methodology allows for assessment of the probability of pollution in all groundwater bodies including those for which the wfd quality network does not obtain measurements exemplified in an agricultural region with complex orography such as andalusia 4 3 spatial probability of nitrate pollution in nitrate vulnerable zones the probability of nitrate pollution had a similar spatial pattern across all models showing differences in specific regions in general the irrigated agricultural zones in the nitrate vulnerable zones over detrital groundwater bodies showed a strong relationship with the highest nitrate concentrations especially in the guadalquivir and guadalete basins in south western andalusia see fig 1 this trend is shown in similar studies for other agricultural regions located on detrital groundwater bodies e g boy roura et al 2013 knoll et al 2019 in these zones the interaction of groundwater bodies with surface flow the permeability of alluvial deposits and agricultural practices are associated with a greater vulnerability to diffuse nitrate pollution arauzo et al 2011 kazakis voudouris 2015 other flat areas with significant livestock farming activity also seemed to be especially linked to nitrates e g los pedroches in the north of andalusia nitrate vulnerable zones over carbonate aquifers had a lower probability of nitrate pollution which can be observed in the east of andalusia these zones are characterised by having few valley bottoms and are zones with greater ruggedness favouring infiltration processes through the dissolution of carbonates however soil cover in these karstic regions is usually thin or absent leibungut 1998 which may hinder large scale agricultural practices and explains the reason why the majority of nitrate vulnerable zones were delimited in detrital aquifers see fig 1 thus ducci et al 2019 related low nitrate levels in carbonate aquifers to mountainous areas with less agricultural activity and anthropogenic pressure the analysis of changes between 2010 and 2017 see fig 9 showed a slight decrease in the probability of nitrate pollution in nitrate vulnerable zones especially in irrigated areas the decrease in the probability was mainly in the nitrate vulnerable zones while increases occurred mostly in the remaining bodies of water these results are in line with the monitoring report on directive 91 676 eec for the period 2016 2019 for spain ministerio para la transición ecológica y el reto demográfico 2020 which shows a strong decrease in most of the measurement stations in the nitrate vulnerable zones in andalusia at the same time the report warned of the increase in nitrate concentrations in groundwater bodies outside the nitrate vulnerable zones especially in areas such as los pedroches see section 2 1 case study although the unavailability of predictions for other years made it impossible to identify clear trends the decrease in the probability in nitrate vulnerable zones might be related to the constraints and measures on agricultural practices imposed by the wfd and nitrates directive oenema et al 2011 thus the decrease in probability in the modelling was related to the increase in base level ndvi and ndvi value at the end of the season in 2017 the impact of the nitrates directive on agriculture has been examined in studies such as velthof et al 2014 who linked the decrease in n losses in the 2000 2008 period with the reduced use of fertilisers and manure in the eu despite the improvement in water quality in the nitrate vulnerable zones the development of tools and control mechanisms for monitoring the nitrate vulnerable zones was identified as one of the main challenges for the eu european commission 2018 considering that spain does not have a unified water quality data system a different approach was taken that considers the good performance of a trained model for an intermediate year period2 2010 this is because most of the nitrate campaigns are carried out by regional and supra regional agencies using different sampling frequencies methodologies and databases hindering the possibility of training models with larger input data and assessing the interannual variability of the nitrate content of groundwater bodies in a more comprehensive way nevertheless the results obtained in this study could serve as a starting point to enhance operational nitrate monitoring in nitrate vulnerable zones 5 conclusion this study assessed the application of machine learning and feature selection algorithms for the predicting nitrate pollution in nitrate vulnerable zones using spatial features extrinsic to groundwater bodies predictive modelling based on extrinsic features such as those derived from remote sensing made it possible to identify the area of groundwater bodies identified as nitrate vulnerable zones that might be most susceptible to pollution without the need to carry out specific analysis of each groundwater body phenology and terrain features were selected as the most important in the predictive modelling phenology enabled the incorporation of fundamental knowledge about the effects of productivity area and the agricultural calendar and their possible relationship to nitrogen fertilisers application thus features such as the ndvi value for the end of the season or base level ndvi might be an important source of information in measuring the impact that agriculture has on nitrate pollution in nitrate vulnerable zones the creation of highly accurate spatial predictions for a period beyond the model learning period may be useful in establishing mitigation measures and it would also help to provide complete and reliable information on the state of groundwater bodies in the nitrate vulnerable zones in accordance with the requirements of the nitrates directive feature selection methods allowed for optimisation of random forest performance generating more accurate models and achieving a reduction in the dimensionality of the feature space wrapper based random forest with sequential forward selection rf sfs was the model with the best performance in relation to the number of features used mmce 0 109 auc 0 958 and six predictor features this model predicted that 34 of the area of the nitrate vulnerable zones was susceptible to having nitrate concentrations above 50 mg l in period 2 the application of the model to period 3 resulted in a 1 reduction in the area of the nitrate vulnerable zones susceptible to nitrate pollution down to 33 the applicability of this methodology to other regions of the eu might serve as the basis for periodic prediction of the state of nitrate vulnerable zones groundwater bodies and the establishment of new criteria for identifying trends that require the application of control and protection measures credit authorship contribution statement aaron cardenas martinez writing original draft preparation investigation methodology software data curation writing review editing visualization victor rodriguez galiano writing review editing methodology software data curation supervision conceptualization juan antonio luque espinar visualization resources formal analysis maria paula mendes supervision formal analysis conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author is a fpu grant holder funded by the spanish ministerio de universidades reference fpu19 00384 the authors would like to express their gratitude for the financial support provided by the projects rti2018 096561 a i00 and us 1262552 funded by the ministry of science and innovation ministerio de ciencia e innovación the state research agency agencia estatal de investigación and the european regional development fund fondo europeo de desarrollo regional feder and the junta de andalucía and feder respectively 
3947,nitrate leaching losses from arable lands into groundwater were a main driver in designating nitrate vulnerable zones nvzs according to the nitrates directive with a view to enhancing their water quality despite this developing common strategies for effective water quality control in these areas remains a challenge in the european union this paper evaluates the performance of the random forest rf machine learning algorithm combined with feature selection fs techniques in predicting nitrate pollution in nvzs groundwater bodies in different periods and using updated environmental features in andalusia spain a set of forty four features extrinsic to groundwater bodies were used as environmental predictors with an aim to make this methodology exportable to other regions phenological features obtained through remote sensing techniques were included to measure the dynamics of agricultural activity in addition other dynamic features derived from weather and livestock effluents were included to analyse seasonal and interannual changes in nitrate pollution three feature stacks and two nitrate databases were used in the predictive modelling period 1 2009 with 321 nitrate samples for training period 2 2010 with 282 nitrate samples for validation and initial spatial prediction and period 3 2017 to assess the changes in the probability of groundwater nitrate content exceeding 50 mg l random forest as a wrapper with four sequential search methods was considered sequential backward selection sbs sequential forward selection sfs sequential forward floating selection sffs and sequential backward floating selection sbfs from among all the feature selection methods applied random forest with sfs had the best performance overall accuracy 0 891 and six predictor features and linked the highest probability of nitrate pollution with three dynamic features the normalized difference vegetation index ndvi base level ndvi value for the end of the growing season and accumulated manure production of livestock farms and three static features slope sediment depositional areas and valley depth keywords nitrates machine learning feature selection groundwater nitrate vulnerable zones 1 introduction protecting strategic resources such as water is currently a major challenge not only in the field of environmental research but also at all levels of government changes in water resource quality significantly affect society and the economy especially in the production of basic resources such as food who 2017 the application of nitrogen fertilisers and pesticides to crops in recent decades coupled with the diffuse pollution that these generate is one of the main causes behind the failure to achieve a good chemical status for groundwater in the european union eu european environmental agency 2018 the surplus of chemical and organic nitrogen fertilisers from agricultural activity can leach to groundwater as nitrate babiker et al 2004 juntakut et al 2019 and from the action of other sources such as livestock farming cho et al 2000 tullo et al 2019 high concentrations of nitrate in drinking water can be a serious threat to human health and can cause illnesses with long term exposure including methemoglobinemia and thyroid cancer fewtrell 2004 ward et al 2010 groundwater is a major source of drinking water in the eu where 24 5 of freshwater extracted for drinking purposes was groundwater in 2017 european environmental agency 2020 to address the problem of water pollution the water framework directive wfd 2000 60 ec aimed to protect and improve water quality in the eu establishing monitoring controls to evaluate impacts and control long term trends together with the wfd the nitrates directive nd 91 676 eec had a huge impact on controlling pollution caused by agricultural nitrates in ground and surface waters oenema et al 2011 this directive required that all member states designate areas within their territories that drain into waters which could be affected by nitrate pollution or that could be affected if action is not taken to decrease nitrate leaching as nitrate vulnerable zones nvzs goodchild 1998 velthof et al 2014 the report on the implementation of the nitrates directive between 2012 and 2015 revealed that 13 2 of the groundwater stations in the eu recorded nitrate concentrations exceeding the legal limit of 50 mg l european commission 2018 approximately 21 5 of measuring stations in spain registered averages higher than 50 mg l in the same period european commission 2018 the same situation occurred in andalusia the most highly populated nuts2 region in spain where 51 of the 176 groundwater bodies had a poor chemical status due to high nitrate concentrations in 2015 according to the hydrological plans confederación hidrográfica del guadalquivir 2015 determining nitrate concentration in groundwater enables the identification and delimitation of areas at spatial risk of pollution a narrowed focus in terms of resource management and compliance with the wfd and nd usual methods based on time series forecasting for the evaluation of nitrate concentrations consist of trend analysis ducci et al 2019 hansen et al 2012 theoretical gross nitrogen balance wick et al 2012 and numerical modelling of fate and transport of contaminants akbariyeh et al 2018 esmaeili et al 2014 these methods are applied at various scales principally at the farm regional and national agency levels and possess inherent uncertainties due to weather variability soil conditions manure management crop cultivation practices and socio economic circumstances kawagoshi et al 2019 mendes et al 2012 mendes ribeiro 2010 wick et al 2012 the selection of these methods is also based on the availability of data i e input parameters the spatial and temporal representativity of monitoring networks and underlying assumptions recently hydrology studies on nitrate pollution have benefited from the development of machine learning algorithms mla that learn from examples and thus do not require pre established rules based on expert criteria buduma locascio 2017 mlas have been used both alone dixon 2005 knoll et al 2020 nolan et al 2014 rodriguez galiano et al 2014 tesoriero et al 2017 wagh et al 2018 and as part of ensembles barzegar et al 2018 khosravi et al 2018 knoll et al 2019 motevalli et al 2019 rodriguez galiano et al 2018 sajedi hosseini et al 2018 singh et al 2014 wheeler et al 2015 to predict the spatial distribution of nitrate concentrations in groundwater generally these studies have been applied primarily at local and regional scales although others have been applied at a national scale such as knoll et al 2020 in germany and at a continental scale such as ouedraogo et al 2019 in africa one of the most widely used mlas for predicting nitrate concentrations in groundwater is random forest rf with examples such as knoll et al 2020 nolan et al 2014 ouedraogo et al 2019 rodriguez galiano et al 2014 and wheeler et al 2015 random forest has multiple advantages as a non parametric method that allows different data sets to be handled and is very effective for non linear relationships between features and for outlier values breiman 2001a biau and scornet 2016 in addition random forest allows assessment of the relative importance of predictive features within the prediction thus providing an understanding of how each predictive feature influences the model in order to select the best features for modelling ghimire et al 2010 rodriguez galiano et al 2012 the performance of random forest has been evaluated with other machine learning algorithms in several nitrate pollution studies band et al 2020 knoll et al 2019 messier et al 2019 and it was the mla with the best predictive performance the use of random forest can be improved by using feature selection fs algorithms which allow a subset of original attributes to be selected and to optimally reduce the feature space according to a specific criterion blum langley 1997 dash liu 1997 zhang bao ho 2006 the aim of feature selection is to select a subset of relevant features to build robust learning models thus reducing the number of features used in the prediction blum langley 1997 rodriguez galiano et al 2018 saeys et al 2007 and contributing to a better understanding of the processes feature selection allows for increased model accuracy reducing the effect of the curse of dimensionality bellman 2003 obtaining more generalisable models accelerating the learning process and increasing their interpretability guyon and elisseeff 2003 different feature selection statistical methods are available filters embedded and wrappers filters are usually applied in a pre processing stage and do not need a machine learning algorithm for feature selection kohavi john 1997 embedded methods perform feature selection during the training process and are generally specific to given learning machines guyon and elisseeff 2003 likewise wrapper based methods combine a machine learning algorithm with a feature search method selecting the subset of features with the best predictive performance guyon and elisseeff 2003 the ability to select the most relevant features has allowed the use of feature selection in predicting nitrate concentrations in groundwater using either the wrapper method dixon 2005 khalil et al 2005 wheeler et al 2015 or the embedded method rodriguez galiano et al 2014 tesoriero et al 2017 with several feature selection methods available studies such as rodriguez galiano et al 2018 and effrosynidis arampatzis 2021 assessed the performance of different feature selection methods and concluded that wrapper based feature selection methods had higher predictive performance than other methods although the use of mla has been a huge step forwards in the study of nitrate pollution regularly updating these studies to monitor particularly vulnerable groundwater bodies remains challenging many studies include intrinsic properties of groundwater bodies which influence the direction and migration rate of nitrates within groundwater bodies some commonly used features include groundwater recharge rate hydraulic conductivity transmissivity and depth to groundwater motevalli et al 2019 ransom et al 2017 wheeler et al 2015 nevertheless the hydraulic properties evaluated by pumping tests are usually few and have limited spatial representation not representing the anisotropic behaviour of the groundwater bodies the exclusive use of features extrinsic to groundwater bodies for nitrate prediction allows these studies to be easily upgraded and does not require measurements in a specific environment or at great expense thus previous studies such as wells et al 2021 used static and dynamic extrinsic features of groundwater bodies to predict vadose and saturated zone transport rates and lag times using random forest studies based on predicting the spatial distribution of nitrates in groundwater commonly use land cover images as a proxy to measure the impact that agriculture has on groundwater pollution rodriguez galiano et al 2014 used images from vegetation indices obtained through remote sensing techniques for a specific date to measure the importance of agriculture in making predictions however the use of a land cover image or a single image from a vegetation index normalized difference vegetation index ndvi to measure agricultural activity and its impact on nitrate pollution lacks fundamental information such as agricultural seasonality interannual crop variability and productivity due to the fact that it is not representative of the entire growing season the inclusion of ndvi time series adds more information by including all stages of the growing season in addition they can serve as an indicator of vegetation biomass and crop type and may be related to crop yields duncan et al 2015 sakamoto et al 2005 this study develops a method based on random forest and feature selection to predict the probability of nitrate concentrations above 50 mg l in groundwater bodies located in nitrate vulnerable zones in andalusia spain in the present period 3 2017 using models trained with past environmental conditions period 1 2009 validated at an intermediate time point period 2 2010 the main novelties of this study are based on the ability to export the applied methodological procedures to other geographical areas using only features extrinsic to groundwater bodies available from national and international public agencies an easily updatable free data source and operational method for identifying potential nitrate pollution of groundwater from agricultural activities is proposed that can help to establish nitrate vulnerable zones where nitrate monitoring data and hydrogeological parameters for aquifers are scarce to determine the impact that agriculture has on nitrate pollution of nitrate vulnerable zones a set of phenological metrics were included that were derived from the functional analysis of vegetation indices obtained via remote sensing techniques other features used were weather data terrain features soil properties and livestock effluents the main objectives of this study were 1 to map zones of high nitrate concentration in groundwater bodies at different time periods 2 to identify the most important features in nitrate pollution of nitrate vulnerable zones 3 to evaluate the effectiveness of different feature selection approaches and 4 to evaluate the probability of exceeding the 50 mg l nitrate threshold in nitrate vulnerable zones for different types of groundwater bodies 2 materials and methods 2 1 case study andalusia is the southernmost spanish administrative region nuts2 on the iberian peninsula it is located in southwestern europe and has a land area of 87 000 km2 its terrain consists of various mountainous systems separated by alluvial depressions the region is characterised by a mediterranean climate with a dry period in the summer that separates two rainfall peaks in spring and autumn average annual rainfall ranges between 300 and 2000 mm and the average temperature is 17 c with maximum values in july august and minimum values in january the climate promotes agricultural use in the alluvial river basins primarily through intensive agriculture the main arable land areas are irrigated and dry farming olive groves orchards and greenhouses besides the baetic depression which is the main region for agricultural production other production regions of note include vega de granada and campo de dalías fig 1 groundwater in andalusia comprises approximately 27 of the water used for irrigation of arable crops ine 2021 large agricultural areas in andalusia are located in the river basins of its main rivers such as the guadalquivir and genil rivers fig 1 most of the detrital aquifers are located in these river basins and receive the excess nitrogen pollutants from fertilisers andalusia is the region in spain that saw the greatest use of nitrogen fertilisers between 2009 and 2017 with an average of 240 57 thousand tonnes per year fertiliser application has been generally trending upwards between 2009 210 3 thousand tonnes and 2017 309 5 thousand tonnes first fertiliser inputs were decreasing until 2014 when fertiliser application reached its minimum level 285 6 thousand tons of nitrogen the trend reversed the following years reaching the maximum fertiliser application in 2017 ministerio de agricultura pesca y alimentación 2021 the nitrates directive 91 676 eec required that eu countries identify surface waters and groundwaters with nitrate concentrations above 50 mg l or those at risk of being polluted by agricultural nitrates the identification of polluted waters or waters at risk of being polluted was the first step towards the designation of nitrate vulnerable zones regional governments in spain designated nitrate vulnerable zones using bodies of water that had been identified as polluted or at risk of being polluted and the identification of intensive agricultural and livestock plots whose seepage affected bodies of water due to nitrate input junta de andalucía 2008 the hydrogeological properties of groundwater bodies in andalusia are diverse carbonate aquifers are mainly located in the east and north of andalusia and are composed of limestones and dolomites detrital and mixed bodies of water are located in alluvial river basins and areas with low relief complexity and are primarily composed of materials such as sands gravels silts and sandstones the main recharge method for all groundwater bodies is infiltration by rainwater but to a lesser extent also by infiltration of agricultural irrigation surpluses lateral inputs from other aquifers and surface runoff as the upper layers are usually composed of permeable materials lópez geta 1998 this study uses the groundwater bodies identified in fig 1 to predict the distribution of nitrate concentrations and the area of nitrate vulnerable zones within the groundwater bodies to assess their susceptibility to nitrate pollution 2 2 data groundwater nitrate data was obtained from a national scale water quality monitoring network database ministerio para la transición ecológica y el reto demográfico 2021 nitrate samples were obtained from open interval at varying depths thus the final sample is a mixture of the water collected from the borehole throughout the open interval at an average depth of 10 60 m depending on the groundwater body the initial database was filtered to collect groundwater samples from andalusia and to remove erroneous data and sampling problems the final database consisted of 1 312 samples from 451 different measurement sites with an average temporal frequency of six months i e two sampling campaigns per year nitrate samples were obtained considering the months and years that had the highest number of samples between june and october of 2002 2010 fig 2 these two periods in the year coincided with the period before and after the fertilisation process the years 2002 2006 and 2008 had fewer samples and showed higher seasonal and interannual variability with greater dispersion june samples showed a tendency to accumulate higher amounts of nitrates with a lower number of samples whereas october samples showed lower amounts of nitrates when the number of samples increased the 2009 and 2010 campaigns were selected for predictive modelling as they had a higher number of samples and a more balanced distribution between the pre and post fertilisation period june and october the mean and median nitrate values for 2009 were lower than those for 2010 43 8 mg l and 14 mg l in 2009 and 59 mg l and 19 5 mg l in 2010 the maximum and minimum values were 356 mg l and 1 mg l for 2009 and 420 mg l and 0 mg l lod mg l for 2010 two data subsets were generated i 321 samples from the june and october campaigns in 2009 used for model training and ii 282 samples from the june and october campaigns in 2010 used as an independent test for model validation see section 2 3 predictive modelling all available samples from each campaign were used for model training applying a 10 fold cross validation to obtain an independent test of all samples 248 41 1 were obtained in detrital groundwater bodies 196 32 5 in carbonate groundwater bodies and 159 26 4 in mixed groundwater bodies a set of 44 independent features related to driving forces activities that may affect the environment and nitrate infiltration was used for prediction only features for which data could be easily obtained on a large scale were selected a requirement in this study was to use data available from public agencies with a view to making this methodology exportable to other regions or a national level in a simple and straightforward way the features that were selected were related to i crop phenology ii livestock effluents iii digital terrain models dtms iv weather and v soil textures table 1 shows the independent features included data sources and extraction methodology features were resampled to a grid with common coordinate origin and spatial resolution 250 m 250 m phenological observations are essential in many aspects of agricultural practice such as defining the growing season length for crops in a specific region or the timing of irrigation and fertilisation caparros santiago et al 2021 chmielewski 2013 in this study phenology was considered as a proxy to identify agricultural areas and separate them from natural vegetation and urban areas phenological features provide more information than a static land cover image as they not only record a measure of which agricultural areas are in production but can also be used to predict the degree of agricultural production their use allows identification of the date on which the growing season begins sprouting of the plant and the date of harvest enabling distinctions between different types of crops and their phenological stages phenology also allows distinguishing between irrigated and rainfed crops with the former typically being more demanding in terms of nitrogen fertilisation and with better soil conditions for nitrate leaching occur dzurella et al 2015 merchán et al 2020 thirteen phenological features were extracted from the analysis of ndvi time series calculated from weekly surface reflectance composites of the modis mod09q1 product livestock effluent features were obtained from the livestock farms census in andalusia which identifies each livestock farm livestock quantity and species the excretion coefficient was obtained for each type of livestock using those available for spain unfccc 2021 livestock effluents were quantified by considering their cumulative and average impact to this end three search radii 1 3 and 5 km were specified yielding 6 features livestock effluents were calculated using the methodology proposed by eurostat 2013 n excretion was predicted by multiplying the excretion coefficients per head and type of livestock n c by the average annual population aapi of that livestock species 1 n excretion t o n n e s n i a a p i 1000 h e a d s n c k g n p e r h e a d p a a set of eighteen terrain model related features and six weather related features was included in the study terrain features were extracted from the digital terrain model dtm for spain obtained from the airborne lidar point cloud at a resolution of 25 m on the website of the spanish national geographic institute ign which was then resampled to 250 m the terrain features included in the study were i basic topography metrics i e elevation ii morphometry through roughness concavity and convexity measurements i e slope terrain ruggedness index multiresolution ridge top flatness index mrrtf and multiresolution valley bottom flatness index mrvbf and iii hydrological analysis including measurements of channel network identification and flow catchment area i e channel network base level and total catchment area weather was included with two features precipitation and temperature the monthly average for the three months and the month before the nitrate samples were used taking into account the time it might take for nitrogen pollutants to leach into the groundwater bodies under different meteorological conditions and after precipitation events as well as the flow and transport mechanisms in the unsaturated zone of the aquifers al jaf et al 2021 kawagoshi et al 2019 menció et al 2011 mendes ribeiro 2010 high temperatures are associated with higher plant evapotranspiration which may have an impact on lower nitrate leaching wick et al 2012 in contrast high average temperatures may lead to higher rates of soil mineralisation which could increase nitrate concentration in groundwater schweigert et al 2004 meanwhile heavy precipitation is associated with increased leaching of pollutants such as nitrates that have previously been stored in the soil wageningen university research 2011 features with different temporal amplitudes for precipitation and temperature were included to train the model for spatio temporal variability of pollutant infiltration into groundwater both precipitation and temperature features were obtained as final products from the andalusian environmental information network rediam laboratoriorediam cica es temperature and precipitation data was obtained from the meteorological stations of the spanish meteorological agency aemet in both cases likewise the textural fractions sand silt and clay were estimated using predictive models built with the random forest algorithm cañero rodríguez galiano 2019 also using predictor features derived from land surface phenology terrain attributes and meteorology the soil samples for the textural fractions were obtained from the spanish national soil erosion inventory ines which has surface soil samples for the whole of spain obtained at a depth of approximately 10 30 cm 2 3 predictive modelling the aim of the study was to take a three phase methodology that is commonly used for land use change modelling and adapt it for predicting nitrate pollution in groundwater figure 3 shows the flowchart for methodology that was applied three stacks of 44 features with a common spatial resolution 250 m 250 m were generated for predictive modelling including static features terrain features and textures and dynamic features phenology livestock effluents and weather it should be noted that the dtm and texture derived features are static and therefore identical for 2009 2010 and 2017 the models were trained using two different campaigns of 321 nitrate concentration samples both for the period 1 june and october 2009 and a stack of predictor features for 2009 the predictive performance of the models trained in period 1 was evaluated internally using a 10 fold cross validation cv the use of cv allows the algorithm to learn from the totality of the data and is an unbiased and iterative procedure which is useful for cases where there is a low number of training samples once evaluated by cv the models were applied to perform a spatial prediction of the probability of nitrate concentrations in the groundwater bodies identified in fig 1 exceeding 50 mg l for the period 2 2010 by using a new feature stack for 2010 two nitrate maps were obtained corresponding to june and october to assess the prediction differences associated with the dynamic features the spatial predictions made for period 2 were used to perform a statistical analysis of nitrate concentrations in the area of groundwater bodies in the nitrate vulnerable zones nvzs see fig 1 by model and groundwater body type detrital carbonate and mixed in order to find out which bodies of water have a higher probability of nitrate pollution 50 mg l nitrate the spatial predictions for period 2 were also applied to perform an additional test on a different dataset to the training dataset this test of 282 nitrate samples from june and october 2010 enabled assessment of the generalisation capacity and uncertainty associated with applying models trained in an earlier period period 1 2009 to the dynamic features of period 2 2010 in addition a third feature stack corresponding to period 3 2017 was used to perform a new spatial prediction where it was assumed that the associated accuracy or uncertainty would be similar to those of the independent test performed on the 282 nitrate samples from period 2 2010 as the features in both cases were different to those from period 1 2009 thus changes in the probability of nitrate concentrations above 50 mg l in groundwater bodies were quantified for the period 2010 2017 all models were built in r 3 5 3 software using the mlr package bischl et al 2016 for training and validation random forest alone and in combination with feature selection approaches were employed to identify the drivers of high nitrate concentrations random forest for classification was used in the study because of its successful results in predicting nitrate pollution in groundwater knoll et al 2019 tesoriero et al 2017 as this is a probability analysis the response feature was binarised prior to model training samples of nitrate concentrations below 50 mg l were reclassified as 0 not polluted and those above were reclassified as 1 polluted random forest only needs two parameters to be defined to generate the predictive models the number of trees generated in the classification k and the number of predictor features m used in each tree breiman 2001 for classification each tree provides a unit vote for the most popular class in each input instance so that the final result is determined by the majority vote of all trees guo et al 2011 rodriguez galiano et al 2012 the hyperparameters were tuned to obtain more robust and generalisable models establishing parameter combinations that optimise the predictive performance of the models probst et al 2019 the k parameter used values of 100 200 300 400 500 600 700 800 900 and 1000 and the m parameter used a value of 1 30 running 300 different models in order to avoid creating very complex and uninterpretable models with features that provide redundant information a feature selection process was applied to the models trained in period 1 2009 different feature selection approaches based on the random forest wrapper method were applied in this study due to the better performance compared to other feature selection methods effrosynidis arampatzis 2021 rodriguez galiano et al 2018 different search strategies can be used in feature selection such as exhaustive search genetic algorithms random search and forward and or backward deterministic search the last search method was selected because it has the best ratio balance between performance and computational cost guyon and elisseeff 2003 four sequential feature search strategies were used sequential backward selection sbs sequential forward selection sfs sequential forward floating selection sffs and sequential backward floating selection sbfs the evaluation of the predictive performance of all models generated in period 1 with cv and in period 2 with the additional fixed test was performed using an objective function such as the mean misclassification error mmce the mmce is the average misclassification error expressed as a proportion and is commonly used as a measure of classifier accuracy ferri et al 2002 in terms of predicting nitrate pollution in groundwater the mmce has been used to analyse misclassified cases rodriguez galiano et al 2018 likewise the importance of features in predicting random forest and feature selection models was measured with mean decrease in gini which is the average of a feature s total decrease in node impurity weighted by the proportion of samples reaching that node in each individual decision tree in the random forest breiman 1998 the greater the value of the mean decrease gini score the greater the importance of the feature in the model the kappa coefficient k was employed as a complementary measure to assess the suitability of applying a model trained using the driving forces of period 1 2009 to the period 2 2010 feature stack the k coefficient is a measure of the overall agreement of an error matrix after discounting for matches that may be due to chance cohen 1960 it is calculated by comparing the proportion observed along the diagonal p0 minus the proportion expected to be obtained by chance pe divided by the maximum chance of agreement that can be expected for the marginal totals 1 pe k p 0 p e 1 p e likewise the evaluation of the model accuracy obtained by feature selection was performed by estimating the true positive rate tpr and the false positive rate fpr tpr indicates the percentage of nitrate samples correctly classified in polluted areas conversely fpr indicates the percentage of misclassified samples in polluted areas each threshold results in a tpr fpr pair and a series of such pairs are used to plot the receiver operating characteristic roc curve these are also known as the sensitivity tpr and specificity 1 fpr rodriguez galiano et al 2014 the sensitivity is the probability of predicting nitrate pollution given that the true state is polluted the specificity is the probability of predicting no nitrate pollution given that the true state is unpolluted hastie et al 2009 the area under the roc curve statistic auc was used as a measure of a classifier s performance an auc value of 1 is considered perfect and an auc value of 0 5 is considered to be random guessing bradley 1997 3 results 3 1 feature importance figure 4 shows the 15 most important predictor features included in the models in general terrain features were the most important followed by phenological features the models trained in random forest rf alone and those in random forest with feature selection using sequential backward search rf sbs and rf sbfs used more features in the prediction than the random forest models with feature selection using sequential forward search rf sfs and rf sffs resulting in large differences in importance values in rf sfs only 6 features were used in the prediction slope mrrtf end season val ndvi valley depth base level ndvi and lstock sum 1 making it the simplest model in comparison rf rf sbs and rf sbfs used 44 41 and 36 predictor features respectively while rf sffs used 7 features slope mrtrf altitude silt convexity start season ndvi and mean temp 1 month 3 2 modelling assessment table 2 shows the evaluation of the models in cross validation cv with nitrate samples from period 1 and in the fixed test with nitrate samples from period 2 in cross validation the models trained in rf sfs and rf sffs achieved better performance mmce 0 101 than random forest rf alone mmce 0 133 and the remaining random forest models with feature selection the results show that the random forest models with feature selection outperformed random forest alone the models based on sequential backward searches rf sbs and rf sbfs had greater accuracy mmce 0 102 than those based on sequential forward search mmce 0 109 however rf sfs and rf sffs prediction used fewer features achieving models with a lower computational cost k showed a good degree of agreement across all models although certain differences existed and rf sbs was the model that obtained the greatest degree of agreement k 0 766 random forest alone achieved the lowest degree of agreement in this metric k 0 731 using the complete set of features for model building figure 5 shows the results of an roc curve analysis considering the true positive rate and false positive rate according to different thresholds for the possibility of being classified as zones with high probability of nitrate pollution both rf sfs rf sffs auc 0 958 and rf sbs rf sbfs auc 0 961 achieved identical accuracies showing that nearly all groundwater samples with high nitrate levels 50 mg l were classified correctly therefore the accuracy of the models trained in rf sfs rf sffs was very similar to that of the models trained in rf sbs rf sbfs despite using a set with a lower number of driving forces confirming the results obtained in the fixed test for period 2 see table 2 3 3 spatial prediction for period 2 and groundwater typology analysis the model used for spatial prediction was the one obtained with all predictor features random forest rf alone the simplest model random forest with sequential forward selection rf sfs and the model with the lowest mmce random forest with sequential backward selection rf sbs figure 6 represents the probability of identifying nitrate concentrations above 50 mg l in the groundwater bodies in andalusia for period 2 2010 the spatial prediction analysis shows the same nitrate distribution pattern for all models with differences existing mainly at the local level and particularly in rf sfs in general the probability of identifying high nitrate concentrations increased in areas with larger arable land extensions the highest probabilities were primarily found in the alluvial depressions of rivers and depositional zones where sedimentation is the dominant process the results obtained for random forest alone and rf sbs were spatially similar which may be due to the use of a set of similar features in the prediction however the small difference between the features used for random forest alone and rf sbs made this latter model the one with the highest accuracy figure 7 shows the box plots for predictions generated by the models rf sfs obtained more dispersed probability values than random forest alone and rf sbs which mainly predicted intermediate probability values between 0 3 and 0 6 rf sfs showed a lower probability of identifying large quantities of nitrates overall with 34 of the area of the nitrate vulnerable zones having a probability of 0 5 for october compared with random forest alone 44 and rf sbs 45 the larger number of dynamic features used in the random forest alone and rf sbs models favoured seasonal variability in making predictions thus the difference in average probability between campaigns was not significant for both models with and without feature selection with higher probability values in october 0 45 in rf alone and 0 46 in rf sbs than in june 0 43 in rf alone and 0 44 in rf sbs rf sfs did not use any dynamic features in the prediction e g temperature or precipitation thus the spatial predictions for june and october were identical with an average probability of 0 38 figure 8 shows the box plots for the probability of nitrate concentrations above 50 mg l in the nitrate vulnerable zones nvzs in andalusia by learning model and groundwater body typology detrital carbonate and mixed for period 2 2010 box plots were created to assess the probability of nitrate pollution 50 mg l nitrate in the different groundwater body types in andalusia detrital carbonate and mixed in june and october overall the prediction results show that detrital and mixed groundwater bodies are more likely to have nitrate concentrations above 50 mg l than carbonate groundwater bodies model analysis shows how rf sfs predicted lower mean probability of nitrate pollution in detrital and mixed groundwater bodies detrital 0 38 in june and october mixed 0 40 in june and october compared to random forest alone detrital 0 45 in june and 0 48 in october mixed 0 42 in june and october and rf sbs detrital 0 46 in june and 0 48 in october mixed 0 43 in june and october for carbonate groundwater bodies a similar probability was predicted by the models for random forest alone carbonate 0 29 in june and 0 30 in october rf sfs carbonate 0 25 in june and 0 25 in october and rf sbs carbonate 0 31 in june and october the analysis by models and groundwater body typologies shows that rf sfs dispersed the values more than the other models which is reflected in the spatial prediction as an absence of central values yellow tones see fig 6 3 4 spatial prediction for period 3 and change analysis the model built in random forest with sequential forward selection rf sfs was used to perform a new spatial prediction using the period 3 2017 feature stack this model had the best predictive performance of all the trained models and was computationally more efficient as it had a similar predictive performance with a much smaller number of features than the other trained models figure 9 shows the spatial prediction of the probability of nitrate concentrations above 50 mg l in groundwater bodies for june and october of period 3 2017 as well as the changes in the spatial prediction made by the learning model between 2017 and 2010 it should be noted that since rf sfs did not use any seasonal dynamic features i e temperature or precipitation the prediction was identical for june and october the map displays changes in probabilities of nitrate concentrations exceeding 50 mg l as the areas where the probability of nitrates increased in 2017 in brown and areas where it decreased in blue the areas that show no change in yellow range from 0 05 to 0 05 overall the probability remained stable at 0 38 although according to the prediction the area affected by the highest probability of nitrate pollution 50 mg l nitrate decreased in 2017 to 33 slightly lower than the period 2 value 34 feature selection has the advantage of improving the interpretability of the models by selecting the most relevant feature set for classification the model built in rf sfs used three dynamic features end season val ndvi base level ndvi and lstock sum 1 the dynamic features enabled detection of changes at the local scale thus the probability was reduced in those areas where the end season val ndvi ndvi value for the end of the growing season eos and base level ndvi bl were higher compared to period 2 in other areas where ndvi was slightly lower lstock sum 1 accumulation of livestock effluent within 1 km was found to have increased significantly compared to period2 thus livestock effluent may also have influenced the increase in the probability of nitrate pollution in specific regions 4 discussion 4 1 use of extrinsic features of groundwater bodies and their effect on nitrate pollution the probability of nitrate concentrations exceeding the thresholds established in wfd 50 mg l nitrates can be predicted using environmental features extrinsic to groundwater bodies to this end features were used that are easily updatable on a spatio temporal scale and can be adapted to the complex and dynamic interplay between the hydrological cycle and diffuse pollutant transport kumar et al 2020 existing predictive modelling of nitrate pollution in the literature uses hydrogeological features as part of subsets of aquifer scale predictive features i e boy roura et al 2013 motevalli et al 2019 rahmati et al 2019 tesoriero et al 2017 the complex measurement of hydrogeological parameters or the lack of large scale measurements of these parameters in many regions hampers the ability to replicate the methodology of these studies in larger settings knoll et al 2020 and ouedraogo et al 2019 performed predictions of nitrate concentrations at national and continental scales using mla that overcome the limitations of obtaining hydrogeological information for several bodies of water however its applicability in the continuous analysis of nitrate may be limited by the need for updated hydrogeological information in areas where in the case of countries such as spain said information is not provided by government administrative bodies this study attempted to avoid the limitations associated with producing updated hydrogeological information by using dynamic environmental features to train multi temporal predictive models sensitive to seasonal changes in nitrate concentration in groundwater random forest with sequential forward selection rf sfs was the model that had the best predictive performance in relation to the number of features and used both dynamic and static features in the prediction the three dynamic features were end season val ndvi and base level ndvi which are related to phenology and lstock sum 1 which is related to livestock farming the phenological features were base level ndvi and the ndvi value of the eos base level ndvi is the mean between the minimum values at the beginning and at the end of the growing season eklundh jönsson 2017 and both base level ndvi and the ndvi value of the eos are associated with the period with less photosynthetic activity of vegetation i e the period where the ndvi value is lower the results show that the probability of higher nitrate concentrations in the nitrate vulnerable zones is linked to the zones where the base level ndvi and the ndvi value of eos are lower this coincides with zhao et al 2020 who identified a negative relationship between nitrate leaching and the increase in the vegetation index value in autumn and winter months in such a way that nitrate leaching is reduced in zones with increased above ground biomass and plant nitrogen as was also shown in macdonald et al 2005 zhao et al 2020 also linked a decrease in soil water nitrate concentration with an increase in the ndvi value and greater plant nitrogen storage higher nitrate concentrations in nitrate vulnerable zones also showed a positive relationship with high density manure production areas the accumulation of livestock effluents within a 1 km radius lstock sum 1 was the feature included in the model indicating that the greatest effluent impact would be in areas closest to farms this positive relationship has been analysed in studies such as de notaris et al 2018 and could be explained by the leaching of livestock effluents deposited in and around buildings oenema et al 2007 or used as fertilisers the static features included in sfs and with the greatest importance in all models were terrain features see fig 4 terrain features were also the most important in sffs although this model additionally included soil textural features such as silt a controversial aspect of feature selection is the multiplicity of good models which is also common in statistical algorithms such as multiple regression or logistic regression different feature subsets might share good and similar accuracy thus resulting in a non unique solution or physical model explaining a phenomenon rashomon effect breiman 2001b slope was the most important in sfs and sffs the zones with the shallowest slope favoured infiltration processes affecting groundwater bodies antonakos lambrakis 2007 the average surface terrain slope over groundwater bodies in andalusia is 8 16 while this slope decreases to 3 52 in nitrate vulnerable zones this is because nitrate vulnerable zones usually occur within the alluvial zones of large rivers which are more suitable for agricultural activities in fact features such as slope altitude or ruggedness are linked in the literature to the groundwater potential zones naghibi et al 2017 rahmati et al 2018 as well as to the higher nitrate pollution in groundwater mfumu kihumba et al 2016 motevalli et al 2019 ouedraogo et al 2016 other features included in the models such as mrrtf and mrvbf identified the summits of ridges and the bottoms of valleys respectively gallant dowling 2003 the importance of these features which are related to the morphological conditions of the terrain might be linked to the accumulation of run off surpluses and the infiltration process affecting the vadose zone mendes ribeiro 2014 thus parra suárez et al 2019 and zhu et al 2009 observed that nitrate leaching processes in hillside agroforestry environments increased in lower area of the hillsides and sediment deposition areas which might be related to slope mrrtf and mrvbf due to nitrate transport by soil water young briggs 2005 the results also showed that areas of lower elevation in nitrate vulnerable zones are more susceptible to nitrate pollution creed band 1998 found a positive relationship between lower elevation and nitrate leaching stating that lower elevation might be related to areas that receive less precipitation rahmati et al 2019 reported the highest concentration of nitrates in the groundwater of valleys which tend to have greater agricultural activity and are more susceptible to soil water retention in the case of andalusia agricultural areas are spread over the catchments of the main rivers where the average elevation does not exceed 350 m thus the highest nitrate concentrations might be related to agricultural areas 4 2 comparison of feature selection approaches the application of feature selection algorithms enabled the selection of subsets of explanatory environmental features obtaining simple methodological procedures that could be exported to other nitrate vulnerable zones with similar properties in the eu the sequential backward search sbs and sbfs strategies obtained a lower mmce compared to the sequential forward search sfs and sffs strategies with success rates of 89 8 and 89 1 respectively see table 2 mmce period 2 these results stood in contrast to those of rodriguez galiano et al 2018 who obtained better results with models trained with sequential forward selection sfs and sequential forward floating selection sffs likewise random forest alone was the model with the worst performance correctly classifying 88 7 of cases see table 2 mmce period 2 however the prediction obtained from random forest alone showed better performance than other probability based studies such as tesoriero et al 2017 who obtained a success rate of 77 for probabilities of nitrate concentrations above 5 mg l in wisconsin usa and rodriguez galiano et al 2014 who had a success rate of 80 46 for probabilities of nitrate concentrations above 50 mg l in a region of southern spain this is an advance in nitrate prediction in large scale areas generating highly accurate spatial predictions for groundwater bodies with different hydrogeological properties without requiring nitrate sampling campaigns for each nitrate vulnerable zone to this end different innovative aspects have been included using dynamic e g phenology and static e g soil attributes features that are extrinsic to groundwater bodies in addition a novel three step methodology has been applied to select representative drivers of nitrate pollution and their seasonal variability among all the models generated rf sfs was considered the model that performed best obtaining an mmce similar to the most accurate models with only six features the difference in the number of features confirms the idea proposed by guyon and elisseeff 2003 and verified by rodriguez galiano et al 2018 that wrappers built using forward sequential search were computationally more efficient identifying a smaller feature subset at a similar error rate nitrate samples from period 2 2010 were used for model validation in this sense nitrate samples were not available for validation purposes at period 3 2017 as the idea behind this methodology is to predict the current status of groundwater bodies for operative and early diagnosis see section 2 3 predictive modelling it should be noted that this is a standard approach in certain areas of science such as land use change modelling camacho olmedo et al 2015 msofe et al 2020 but has never been applied to groundwater pollution additionally the usefulness of this approach is not only to have spatial predictions of the probability of nitrate pollution using nitrate measurements from previous years but also to have a prediction for groundwater bodies at a regional level the proposed methodology allows for assessment of the probability of pollution in all groundwater bodies including those for which the wfd quality network does not obtain measurements exemplified in an agricultural region with complex orography such as andalusia 4 3 spatial probability of nitrate pollution in nitrate vulnerable zones the probability of nitrate pollution had a similar spatial pattern across all models showing differences in specific regions in general the irrigated agricultural zones in the nitrate vulnerable zones over detrital groundwater bodies showed a strong relationship with the highest nitrate concentrations especially in the guadalquivir and guadalete basins in south western andalusia see fig 1 this trend is shown in similar studies for other agricultural regions located on detrital groundwater bodies e g boy roura et al 2013 knoll et al 2019 in these zones the interaction of groundwater bodies with surface flow the permeability of alluvial deposits and agricultural practices are associated with a greater vulnerability to diffuse nitrate pollution arauzo et al 2011 kazakis voudouris 2015 other flat areas with significant livestock farming activity also seemed to be especially linked to nitrates e g los pedroches in the north of andalusia nitrate vulnerable zones over carbonate aquifers had a lower probability of nitrate pollution which can be observed in the east of andalusia these zones are characterised by having few valley bottoms and are zones with greater ruggedness favouring infiltration processes through the dissolution of carbonates however soil cover in these karstic regions is usually thin or absent leibungut 1998 which may hinder large scale agricultural practices and explains the reason why the majority of nitrate vulnerable zones were delimited in detrital aquifers see fig 1 thus ducci et al 2019 related low nitrate levels in carbonate aquifers to mountainous areas with less agricultural activity and anthropogenic pressure the analysis of changes between 2010 and 2017 see fig 9 showed a slight decrease in the probability of nitrate pollution in nitrate vulnerable zones especially in irrigated areas the decrease in the probability was mainly in the nitrate vulnerable zones while increases occurred mostly in the remaining bodies of water these results are in line with the monitoring report on directive 91 676 eec for the period 2016 2019 for spain ministerio para la transición ecológica y el reto demográfico 2020 which shows a strong decrease in most of the measurement stations in the nitrate vulnerable zones in andalusia at the same time the report warned of the increase in nitrate concentrations in groundwater bodies outside the nitrate vulnerable zones especially in areas such as los pedroches see section 2 1 case study although the unavailability of predictions for other years made it impossible to identify clear trends the decrease in the probability in nitrate vulnerable zones might be related to the constraints and measures on agricultural practices imposed by the wfd and nitrates directive oenema et al 2011 thus the decrease in probability in the modelling was related to the increase in base level ndvi and ndvi value at the end of the season in 2017 the impact of the nitrates directive on agriculture has been examined in studies such as velthof et al 2014 who linked the decrease in n losses in the 2000 2008 period with the reduced use of fertilisers and manure in the eu despite the improvement in water quality in the nitrate vulnerable zones the development of tools and control mechanisms for monitoring the nitrate vulnerable zones was identified as one of the main challenges for the eu european commission 2018 considering that spain does not have a unified water quality data system a different approach was taken that considers the good performance of a trained model for an intermediate year period2 2010 this is because most of the nitrate campaigns are carried out by regional and supra regional agencies using different sampling frequencies methodologies and databases hindering the possibility of training models with larger input data and assessing the interannual variability of the nitrate content of groundwater bodies in a more comprehensive way nevertheless the results obtained in this study could serve as a starting point to enhance operational nitrate monitoring in nitrate vulnerable zones 5 conclusion this study assessed the application of machine learning and feature selection algorithms for the predicting nitrate pollution in nitrate vulnerable zones using spatial features extrinsic to groundwater bodies predictive modelling based on extrinsic features such as those derived from remote sensing made it possible to identify the area of groundwater bodies identified as nitrate vulnerable zones that might be most susceptible to pollution without the need to carry out specific analysis of each groundwater body phenology and terrain features were selected as the most important in the predictive modelling phenology enabled the incorporation of fundamental knowledge about the effects of productivity area and the agricultural calendar and their possible relationship to nitrogen fertilisers application thus features such as the ndvi value for the end of the season or base level ndvi might be an important source of information in measuring the impact that agriculture has on nitrate pollution in nitrate vulnerable zones the creation of highly accurate spatial predictions for a period beyond the model learning period may be useful in establishing mitigation measures and it would also help to provide complete and reliable information on the state of groundwater bodies in the nitrate vulnerable zones in accordance with the requirements of the nitrates directive feature selection methods allowed for optimisation of random forest performance generating more accurate models and achieving a reduction in the dimensionality of the feature space wrapper based random forest with sequential forward selection rf sfs was the model with the best performance in relation to the number of features used mmce 0 109 auc 0 958 and six predictor features this model predicted that 34 of the area of the nitrate vulnerable zones was susceptible to having nitrate concentrations above 50 mg l in period 2 the application of the model to period 3 resulted in a 1 reduction in the area of the nitrate vulnerable zones susceptible to nitrate pollution down to 33 the applicability of this methodology to other regions of the eu might serve as the basis for periodic prediction of the state of nitrate vulnerable zones groundwater bodies and the establishment of new criteria for identifying trends that require the application of control and protection measures credit authorship contribution statement aaron cardenas martinez writing original draft preparation investigation methodology software data curation writing review editing visualization victor rodriguez galiano writing review editing methodology software data curation supervision conceptualization juan antonio luque espinar visualization resources formal analysis maria paula mendes supervision formal analysis conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author is a fpu grant holder funded by the spanish ministerio de universidades reference fpu19 00384 the authors would like to express their gratitude for the financial support provided by the projects rti2018 096561 a i00 and us 1262552 funded by the ministry of science and innovation ministerio de ciencia e innovación the state research agency agencia estatal de investigación and the european regional development fund fondo europeo de desarrollo regional feder and the junta de andalucía and feder respectively 
3948,water supply contributed by glacier and snow melt is of particular significance and play a key role for social stability in the karakoram region of upper indus basin uibkk based on the srtm dem terrasar x tandem x images and zy3 02 stereo images the spatiotemporal pattern of glacier mass budgets in the uibkk have been estimated for the early 21st century 2000 2019 period in this study a comparison of the total area in 2000 with that in 2019 shows that glacier area remained stable in the early 21st century with a slight expansion of 56 3 km2 0 4 glaciers in the uibkk experienced a balanced or slight negative mass budget of 0 08 0 07 m w e a 1 in the early 21st century the spatial variability of mass budget in the uibkk showed that glacier mass budgets shifted from negative to positive from west to east respectively along longitude glacier mass loss decelerated from 0 12 0 16 m w e a 1 in 2000 2013 to 0 03 0 21 m w e a 1 in 2013 2019 no significant differences were observed in thinning rates on debris covered glaciers 19 area covered by debris and clean ice glaciers 19 area covered by debris in the early 21st century 0 06 m a 1 vs 0 04 m a 1 the overall homogeneous mass budgets for surge and non surge glaciers indicated that glacier surges seem not have a notable impact on glacier wide mass budget over short time scales the spatiotemporal variability of glacier mass budgets in the uibkk are consistent with the tendencies of winter precipitation and summer temperature climate warming may play more important role in glacier changes in the uibkk keywords upper indus basin terrasar x tandem x mass balance glacier surge climate warming 1 introduction the high mountain asia hma as the roof of the world developed a lot of valley glaciers rgi consortium 2017 meltwater of glacier and snow from hma provides water for drinking agricultural irrigation and electricity generation armstrong et al 2018 huss and hock 2018 immerzeel et al 2010 milner et al 2017 pritchard 2019 under the influence of climate warming glaciers in hma experienced pronounced recession widely in recent decades brun et al 2017 miles et al 2021 shean et al 2020 this has aroused wide concerns such as the availability of water resource immerzeel et al 2020 and impact on global sea level rise gardner et al 2013 jacob et al 2012 zemp et al 2019 contrary to other parts of hma stable or even positive glacier mass budgets have been found in the pamir karakoram west kunlun range in the past decades bolch et al 2017 farinotti et al 2020 gardelle et al 2013 lin et al 2017 wu et al 2020a zhou et al 2017 this anomalous behavior has exerted an important effect on regional water cycles and glacial hazards bhambri et al 2020 bolch et al 2017 while it remains unclear that whether the anomalous behavior will continue to exist in the coming decades farinotti et al 2020 owing to this background estimation of glacier mass budget over longer time period in this region is of great significance anomalous behaviour of glaciers in the karakoram was suspected since the nineteenth century godwin austen 1864 hayden 1907 balanced glacier mass budgets in the karakoram were estimated in the past decades brun et al 2017 gardelle et al 2012b kääb et al 2012 shean et al 2020 however the changes of glacier mass budget in the karakoram in the early 21st century are rare previous study indicated that glacier melt in the karakoram is driven by regional atmospheric circulation variability forsythe et al 2017 meanwhile the weakening indian monsoon and the strengthening westerlies had been found in recent decades yao et al 2012 hence it may be assumed that karakoram glaciers are in different mass budget conditions in the early twenty first century in order to clarify the response of glacier mass balance to climate change in the karakoram region of upper indus river basin uibkk the changes of glacier mass budget over the early twenty first century 2000 2019 20 years was estimated from geodetic methods on the ziyuan3 02 zy3 02 stereo images terrasar x tandem x tsx tdx images and shuttle radar topography mission srtm digital elevation model dem in this study the results provide insight into the change processes of regional glaciers and will help to understand the contribution of glacier meltwater on runoff in the future 2 study site the study site is located in the karakoram region of upper indus river basin uibkk between 34 to 37 n latitude and 72 to 78 e longitude which include three sub regions i e the west karakoram the central karakoram and the east karakoram fig 1 the typical characteristic of the region is extremely steep and high topography contains several high peaks and the greatest area of perennial glacial ice in hma farinotti et al 2020 hewitt 2007 the upper indus river basin uib is exposed to the westerlies resulting in a lot of precipitation in the winter and spring kapnick et al 2014 the effect of the monsoon in the region weakens north westward as a result of the barrier effect of high mountains forsythe et al 2017 annual precipitation in the uib increases with altitude ranging from 100 to 200 mm at northern valley floors and 600 800 mm at 4400 m a s l and 1500 2000 mm at 5500 m a s l sharif et al 2013 mean monthly temperatures in the uib are below freezing above 3000 m in the period of october to march archer 2004 streamflows dependent on glacial meltwater are strongly positively correlated with karakoram summer air temperatures which show recent anomalous cooling forsythe et al 2017 previous studies found that low temperature sensitivities of glaciers and an increase in snowfall for a large part caused by increases in evapotranspiration from irrigated agriculture result in positive mass balances in the karakoram de kok et al 2020 de kok et al 2018 on the basis of the rgi 6 0 4729 glaciers developed in the uibkk with glacier area of 14438 5 km2 21 glaciers are larger than 100 km2 even one glacier is larger than 1000 km2 the siachen glacier rgi consortium 2017 frequent glacier surges were reported in recent decades such as shispare khurdopin and virjerab glaciers bhambri et al 2020 quincey et al 2011 quincey et al 2015 rashid et al 2018 steiner et al 2018 3 data and methods 3 1 data for glacier mass budget calculations dems and glacier outlines covering the glacierized area of the uibkk were used in our study three dems were employed to estimate the changes of glacier surface elevation in the uibkk table 1 fig s1 the srtm c band dem with a resolution of 30 m in wgs84 egm96 were provided by u s geological survey usgs http glovis usgs gov farr et al 2007 the dem for the early 2010 s was extracted from fifteen pairs of tsx tdx images table s1 which acquired in bistatic synthetic aperture radar interferometry insar stripmap mode from the german aerospace center dlr krieger et al 2007 the resolutions of tsx tdx image in azimuth and range directions are both 3 m the recent dem was extracted from zy3 02 stereo images which acquired from august 2019 to february 2020 table s2 being the first chinese surveying and mapping satellite equipped with three panchromatic cameras for linear push broom imaging in three directions of forward backward and nadir the resolutions of the image is 2 5 m wang et al 2014 based on a tri epipolar method the zy3 02 dems were generated through dense tri stereo matching by the space data processor software tang et al 2018 the original rational polynomial coefficients rpcs of zy3 02 images modified though bundle adjustment oriented by srtm were used for absolute orientation to analyse the mass budget glacier outlines in investigated periods must be acquired especially many advanced glaciers exist in the uibkk the rgi 6 0 delineated from landsat tm images in 1998 2002 can be used to identify the glacierized area of the uibkk in 2000 to match with the tsx tdx images and zy3 02 images glacier outlines were delineated from landsat oli images of years 2013 and 2019 in this study landsat oli imageries were acquired from usgs data portal in order to reduce the impact of seasonal snow cover landsat imageries acquired during the ablation season from july to october were selected table s3 to estimate the tendency of glacier surface velocity the its live data product a set of annual glacier surface velocity were employed in our study gardner et al 2019 based on the auto rift feature tracking its live data product was derived from landsat images gardner et al 2019 to match with the glacier mass budget calculations in the early 21st century surface velocity in the uibkk from 2000 to 2019 were used in our study to analyse the relationship between glacier mass budget and climate change in the uibkk relevant air temperature and precipitation datasets were taken from the climatic research unit gridded time series v4 04 cru ts v4 04 based on the climate anomaly method the cru ts v4 04 were constructed from observations with a spatial resolution of 0 5 0 5 harris et al 2020 3 2 glacier outlines a semi automated method the normalized difference snow index ndsi was employed to identify glacier outlines in 2013 and 2019 which was then verified manually first ice snow body was distinguished from other objects by the ndsi formula band3 band6 band3 band6 and threshold value at the google earth engine gee cloud computing platform scherler et al 2018 to eliminate seasonal snow water bodies and shadows the glacier mask was filtered and checked manually in addition the outlines of debris cover cannot be identified by ndsi therefore the outlines of debris cover were delineated manually with the pan sharpened band images the error of glacier outlines includes the positional and processing errors of the input data previous study indicated that there has no distinct horizontal shift in landsat imageries guo et al 2015 even though the high quality of landsat imageries were selected as input data the automatically digitized glacier outlines need to be checked manually the uncertainty of glacier outlines acquired automatically and manually ranges from 2 to 5 paul et al 2013 in addition the error of glacier outlines also results from the spatial resolution of the input data the uncertainties of 10 and 30 m for clean ice and debris covered ice were estimated for landsat delineated glacier outlines guo et al 2015 according to these average uncertainties the uncertainties of 4 3 and 6 7 were calculated for glacier areas in 2013 and 2019 3 3 glacier height changes based on the method of differential insar dinsar glacier height changes in the periods of 2000 2013 and 2013 2019 were derived from tsx tdx images and reference dems here zy3 02 and srtm dem first by means of insar method the bistatic interferogram was generated from tsx tdx image and reference dems the bistatic interferogram contain topographic phase topographic residual phase and flat earth next the topographic phase and flat earth simulated by the orbital information from tsx tdx image and reference dems were removed from the bistatic interferogram thus the topographic residual phase induced by the glacier height change was converted to a differential interferogram finally the map of glacier height changes was generated from unwrapped differential interferogram li et al 2018 neckel et al 2013 wu et al 2018 to minimize the error of phase unwrapping precise horizontal offset registration between tsx tdx image and reference dems need to be performed before generating the differential interferogram based on the relation between tsx tdx image and reference dems a refinement of the look up table was calculated and some error regions caused by radar shadows and layover were masked out the horizontal offset was eliminated by the precise orbit information of tsx tdx image and the refinement of the look up table then the tsx tdx interferogram and the co registered reference dems were employed to generate a differential interferogram finally unwrapped by the minimum cost flow algorithm the differential interferogram was converted to glacier height changes wu et al 2018 glacier height changes from 2000 to 2019 were acquired by dem differencing with srtm dem and zy3 02 dem nuth and kääb 2011 pieczonka et al 2013 according to the cosinusoidal relationship between elevation difference terrain slope and terrain aspect in non glaciated regions relative horizontal and vertical shift between srtm dem and zy3 02 dem were corrected nuth and kääb 2011 in the process of co registration all terrain in non glaciated regions with slope between 5 and 75 were selected to calculate the parameters of co registration the final shift vectors of zy3 02dem are listed in table s4 the biases resulted from multiple spatial resolutions between srtm dem and zy3 02 dem were adjusted by the terrain parameter of maximum curvatures gardelle et al 2012a after the adjustments outliers of elevation difference in the entire glacier area were removed by the threshold of 5 and 95 quantiles based on statistics of elevation difference in the entire glacier area pieczonka et al 2013 finally the mean elevation difference in non glaciated regions decreased from 8 76 m to 0 76 m fig 2 it is concluded that elevation difference in non glaciated regions have stabilized and that the pre processed dems were suitable for the estimation of glacier height changes the penetration depth of the c band and x band dem should be considered when assessing glacier height changes comparing insar based elevations with optical laser gnss elevations obtained at a similar time provides us with an efficient way of quantifying the bias of insar based elevation dehecq et al 2016 lambrecht et al 2018 li et al 2021 an average penetration depth of 1 8 m for the x band tandem found in the pamir and west kunlun lambrecht et al 2018 li et al 2021 was applied in this study for the penetration depth of the c band srtn dem elevation difference between c band and x band srtm dems was estimated from the method of common dem differencing first average difference of 1 6 0 05 m fig s2 and then the penetration depth of the c band srtm dem was calculated from the penetration depth of x band dem and the elevation difference between c band and x band dem finally the penetration depth of the c band srtm and x band tandem were removed on glaciers in addition the inter annual and seasonal variance of glacier heights need be considered gardelle et al 2012b lin et al 2017 because the bistatic tsx tdx and zy3 02 were obtained at different points in time we normalized the height changes into a decadal scale by presuming a linear height change rate lin et al 2017 the tsx tdx images were mainly acquired in january february and march and zy3 02 images were mainly acquired in october november december january and february to avoid the effects of seasonal variances glacier mass budgets estimated from tsx tdx and zy3 02 images should be adjusted according to the acquired time of srtm i e february due to the lack of in situ measurements in the uibkk glacier mass budget within one year is difficult to establish based on monthly mass balances over a short period and least square adjustment lin et al 2017 obtained a monthly trend of 0 06 m w e a 1 from october to next march hence a glacier mass balance correction of 0 018 m w e a 1 november 0 12 m w e a 1 december 0 06 m w e a 1 january 0 m w e a 1 february 0 06 m w e a 1 march 0 12 m w e a 1 april was selected in this study by keeping the february srtm dem acquisition month as reference month the data voids in difference maps should be filled when computing the volume change of regional and individual glaciers an efficient method named local mean hypsometric method was used to fill in data voids mcnabb et al 2019 except data voids the height changes of glaciers which uncovered by tsx tdx and zy3 02 images need be calculated the uncovered glacier area account for 24 and 9 of the total glacierized area for tsx tdx and zy3 02 images respectively after performing the necessary bias correction for each glacier frame or sub region we calculated the height changes of glaciers which uncovered by tsx tdx and zy3 02 images in each 50 m elevation bin according to the glacier height distribution by presuming that the glacier height changes were the same at the same elevation in the same sub region or sub group after all adjustments finally the elevation difference maps during the investigated periods were generated the final elevation differences in non glaciated area were employed to estimate the error of glacier height changes table 2 fig s3 the mean elevation differences δ mea and the standard deviation of elevation differences δ stdv in non glaciated area were calculated in three sub regions i e the west karakoram wkk central karakoram ckk and east karakoram ekk while the δ stdv would overestimate the uncertainty the standard error of the mean δ se in non glaciated regions could be calculated using eq 1 to estimate the uncertainty 1 δ se δ stdv n where n is the amount of pixels nuth and kääb 2011 to minimize the effect of autocorrelation a decorrelation length based on the spatial resolution is recommended for dems with a spatial resolution of 5 m a decorrelation length of 100 m is suitable koblet et al 2010 berthier et al 2010 chose 500 m as the decorrelation length for dems with the resolution of 40 m and bolch et al 2011 used 600 m and 400 m for spatial resolutions of 30 m and 10 20 m respectively in this study decorrelation of 400 m was employed for the difference between the srtm dem and the tsx tdx srtm tsx tdx 100 m was employed for the srtm zy3 02 and tsx tdx zy3 02 finally the uncertainty of glacier height changes δ dh can be calculated from δ mea and δ se using eq 2 2 δ dh δ mea 2 δ se 2 the uncertainties of all three sub regions and the whole study area were calculated for different investigated periods table 2 the uncertainties between the final difference maps ranging from 0 27 to 1 39 m table 2 indicated that the results of glacier height change are acceptable 3 4 glacier mass budget the total volume changes δ v for the respective survey period was calculated using eq 3 3 δ v δ d h a max where δ d h is the average glacier height change a max is the maximum glacier area in respective survey period after acquiring total volume changes glacier mass budget mb was estimated from the ice snow density ρ g 850 kg m 3 huss 2013 and total volume changes using eq 4 4 mb δ v ρ g a t ρ water where ρ water is the density of water 1000 kg m 3 a is the average glacier area in respective survey period and t is the time interval in years finally the uncertainty of overall glacier mass budget δ mb was calculated using eq 5 from the uncertainties of glacier area changes δ ac the square root of the sum of the squares of the glacier area uncertainties in respective survey period glacier height changes δ dh and ice snow density δ ρ 60 kg m 3 5 δ mb δ d h δ ρ 2 δ d h ρ g δ ac 2 δ dh ρ g 2 ρ water due to the large glacier area in the study area the second term in eq 5 is so small that could be negligible and then the final uncertainty of glacier mass budget was calculated by using eq 6 6 δ mb δ d h δ ρ 2 δ dh ρ g 2 ρ water 4 results 4 1 glacier area change according to the latest inventory the uibkk contains 4713 glaciers with an area of 14494 8 971 2 km2 in 2019 the mean glacier size is 3 08 km2 and the median glacier elevation is around 5286 m only 7 1 333 of all glaciers are larger than 5 km2 but cover over 80 of the glacierized area on the other hand 73 9 3482 of all glaciers are smaller than 1 km2 but cover only 6 3 of the total area a comparison of the total area in 2000 with that in 2019 shows that glacier area remained stable in the early 21st century with a slight expansion of 56 3 km2 0 4 while a shifted glacier area change from expansion to shrinkage were found in the periods of 2000 2013 and 2013 2019 glacier area increased by 202 0 km2 from 14438 5 km2 1 4 between 2000 and 2013 then it decreased by 145 7 km2 1 0 from 2013 to 2019 4 2 glacier mass budget in total no significant mass changes were found in the uibkk the average change of glacier height for the study area was 1 70 0 34 m in the early 21st century glaciers in the uibkk experienced a slight thinning of 0 09 0 08 m a 1 or a mass budget of 0 08 0 07 m w e a 1 fig 3 table 3 the average changes of glacier surface elevation varied from 5 03 to 4 41 m a 1 in the uibkk while more than 90 of the glaciers fall in the elevation change category of 1 to 1 m a 1 although a small rate of glacier mass loss has been found in the early 21st century it has decreased slightly during two sub periods of 2000 2013 and 2013 2019 glaciers experienced an average thinning of 0 14 0 18 m a 1 or a mass loss of 0 12 0 16 m w e a 1 during 2000 2013 then it decreased to 0 03 0 23 m a 1 or 0 03 0 21 m w e a 1 during 2013 2019 glacier mass budgets have been heterogeneous over the study area in the early 21st century figs 4 6 table 3 the most negative mass budget of 0 23 0 08 m w e a 1 was measured in the west karakoram from 2000 to 2019 and an accelerated mass loss was found from 0 09 0 07 m w e a 1 in 2000 2013 to 0 60 0 17 m w e a 1 in 2013 2019 glaciers in the central uibkk experienced a moderate mass loss with 0 06 0 09 m w e a 1 from 2000 to 2019 and homogeneous mass losses were found in the periods of 2000 2013 and 2013 2019 glaciers in the east uibkk experienced a slight mass gain or balanced mass budget with 0 04 0 19 m w e a 1 from 2000 to 2019 while a shifted glacier mass budgets from negative to positive were found in the periods of 2000 2013 and 2013 2019 with means of 0 14 0 14 m w e a 1 and 0 37 0 29 m w e a 1 respectively glacier mass budgets varied significantly between different sub regions and between different time intervals even within the same sub region mass budgets can be highly variable between individual glaciers for example in the central karakoram two large glaciers 300 km2 experienced significantly different mass budget with 0 47 0 09 m w e a 1 for chogo glacier and 0 16 0 09 m w e a 1 for panmah glacier from 2000 to 2019 4 3 glacier surges based on glacier elevation changes surface velocity or morphology many glaciers in karakoram were identified as surge glaciers bhambri et al 2017 gardelle et al 2012b heid and kääb 2012 hewitt 2007 quincey et al 2011 in this study glaciers in the uibkk were separated into surge glaciers and non surge glaciers from the surface elevation difference maps surge glaciers experienced a slight mass loss of 0 06 0 07 m w e a 1 in the early 21st century and homogeneous mass loss were estimated for non surge glaciers 0 04 0 07 m w e a 1 the overall homogeneous mass budgets for surge and non surge glaciers indicated that glacier surges seem not have a notable impact on glacier wide mass budget over short time scales 4 4 comparison of clean ice and debris covered glaciers it is generally believed that debris cover plays a key role on glacier mass budget excluding the surge glaciers all other glaciers non surge in the uibkk were separated into two categories i e debris covered glaciers 19 area covered by debris and clean ice glaciers 19 area covered by debris brun et al 2019 to estimate the mass budgets for these two different glacier types in this study results showed that no significant differences were observed in thinning rates on debris covered glaciers and clean ice glaciers in the early 21st century 0 06 m a 1 vs 0 04 m a 1 fig 7 which agrees with brun et al 2019 who found no significant correlation between mass balance and debris cover in the karakoram in order to compare the mass budgets between clean and debris covered ice with similar altitude distributions elevation changes with altitude in all non surging glaciers were calculated for each sub region figs 4d 5d 6d on average thinning rates have a significant difference in the early 21st century such as 0 37 0 07 m a 1 on debris covered ice and 0 01 0 07 m a 1 on clean ice while the debris have different influences in each sub region in the west and central karakoram the thinning rates are similar on debris covered ice and clean ice at a similar altitude figs 4d 5d however a larger thinning rate was found on debris covered ice than that on clean ice in the east karakoram fig 6d it seems to be a special behaviour of east karakoram 5 discussion 5 1 uncertainty for glacier mass budget the penetrations of the srtm c band and tandem x band are the major sources of uncertainty gardelle et al 2012a the penetration depth can range from 0 to 10 m depending on a variety of parameters such as snow temperature density and water content berthier et al 2006 as revealed by in situ radar measurements made in the antarctic the phase centre depth of the x band can reach 4 m in a dry snowpack rott et al 1993 the average penetration depth of 1 8 m for the x band tandem and 3 4 m for the c band srtm was applied in this study the uibkk mass budget without considering penetration depth is 0 03 m w e a 1 in 2000 2013 and 0 07 m w e a 1 in 2000 2019 another uncertainty results from the data voids in difference maps to evaluate the influence of data voids the glacier surface elevation changes in the uibkk during 2000 2019 was calculated i by filling the voids with the local mean hypsometric method result 1 90 m or 0 09 m w e a 1 and ii without void filling 2 76 m or 0 12 m w e a 1 the results indicated that void filling or not seem not have a significant influence on average elevation change rates in addition height changes of glaciers which uncovered by tsx tdx and zy3 02 images is one of the sources of uncertainty according to the glacier height distribution by presuming that the glacier height changes were the same at the same elevation in the same sub region or sub group the height changes of glaciers which uncovered by tsx tdx and zy3 02 images were calculated in each elevation bin these uncovered glacier height changes have almost no impact on glacier height changes in the whole study area for the investigated periods apart from penetration depth data voids and uncovered glacier height changes the inter annual and seasonal variance of glacier heights are other uncertainties the height changes were normalized into a decadal scale by presuming a linear height change rate for the adjustments of inter annual variance and a glacier height correction of 0 07 m per month was used to adjust the seasonal variance of glacier mass budget these seasonal corrections result in a slight variance of 0 01 m w e a 1 in glacier mass budget in the uibkk for the investigated periods 5 2 glacier mass budget karakoram anomaly has been one of the research hotspots in recent years which has raised a lot of research results farinotti et al 2020 gardelle et al 2012 gardelle et al 2013 quincey et al 2015 however due to the differences in data sources and the glacier area measured mass budgets in the karakoram differed from each other slightly in total balanced to slightly positive mass budget was measured for karakoram glaciers over the past decade farinotti et al 2020 employed tandem and srtm dems glaciers in the uib experienced a mean thinning of 0 35 0 33 m a 1 from 2000 to 2012 abdullah et al 2020 while glacier mass budget in the sub region of karakoram in the uib was 0 09 0 27 m w e a 1 abdullah et al 2020 which is consistent with our result of 0 12 0 16 m w e a 1 from 2000 to 2013 employed aster scenes and srtm a glacier mass budget of 0 08 0 21 m w e a 1 was found in the hunza basin from 2000 to 2009 bolch et al 2017 which agreed with the result of 0 09 0 07 m w e a 1 in the sub region of west karakoram from 2000 to 2013 in addition mean glacier mass balances of 0 10 0 13 2003 2009 gardner et al 2013 0 09 0 12 2003 2008 kääb et al 2015 0 03 0 07 2000 2016 brun et al 2017 and 0 04 0 04 m w e a 1 2000 2018 shean et al 2020 were found in the karakoram which agreed with our results in different periods these comparisons suggested that our results were reliable the spatial distribution pattern of glacier mass budget in the uibkk showed that mass budget shifted from negative to positive from west to east respectively along longitude fig 3 due to the steep mountains and deep valleys in our study area the distribution of precipitation is extremely complicated at high altitude anders et al 2015 while comparing the mean median elevations of glaciers along longitude a clear orographic control appears on mass budget the mean median elevations of glaciers increased gradually from 4990 m to 5700 m along longitude from 74 e to 78 e west to east in the study area respectively which agrees with previous study mölg et al 2018 although the relationship between mass balance and topography is complex we suggest that glaciers located at higher elevations have generally been able to capture more solid precipitation than those at lower elevations and have subsequently lost less to sublimation and melt stigter et al 2018 apart from orographic control debris cover also play an important role in glacier melt due to the steep rock walls and intense avalanche activity glaciers in the uibkk are covered by debris heavily in glacier tongue in theory a thin debris cover will aggravate ice melt by decreasing albedo while a thick debris cover will weaken ice melt by the effect of heat insulation benn et al 2012 in this study debris cover has a positive influence on ice melt overall thinning rate on debris covered ice was slight larger than that on clean ice however the elevation changes in debris covered tongues includes the change of glacier thickness and the possible evolution of debris thickness previous study showed that the total area of debris cover expanded by 8 1 21 3 in the hunza basin from 1990 to 2019 xie et al 2020 based on the debris discharges a thickening of the debris ranges from 2 7 to 5 5 mm a 1 was estimated in batura glacier the west karakoram gardelle et al 2013 considered the magnitude of the glacier thickness changes the value of debris thickening could be negligible but debris thickening would have a critical feedback effect on glacier melt and need more detailed investigations 5 3 glacier surges glacier surge is a periodic glacier activity lasting from months to a few years that is unrelated to changes in mass budget hooke 2005 each period includes two phases i e surge or active phase and quiescent phase during a surge a huge volume of ice is transferred from the reservoir zone usually the accumulation area to the receiving zone the terminus region accordingly remarkable thickening and thinning can be observed in the receiving zone and reservoir zone respectively after surging glacier enter a period of quiescence which can last on the order of decades conversely the surface elevation in the receiving zone is drawn down with a high and uniform intensity and the reservoir zone thickens during the quiescent phase xie and liu 2010 surges and quiescent phases can be clearly observed in several glaciers in the uibkk two surge events were captured in hispar glacier which has been confirmed by recent researches guo et al 2020 paul et al 2017 rashid et al 2018 the first surge event of hispar occurred in the north branch before 2013 with the thickening in the receiving zone more than 80 m the second occurred in the main branch after 2013 and the maximum thickening in the receiving zone is more than 140 m besides hispar glacier khurdopin virjerab biafo baltoro rimo chong kumdan kichik kumdan and chamshing glaciers experienced one surge event during the investigated period in general the timescale of glacier mass budget estimated from geodetic methods is a few years or decades glacier elevation change can be used to identify surge event but it cannot be used to determine exactly when the surge occurred another characteristic of surge glaciers is the large flow acceleration after extended quiescent phases of slow movement hooke 2005 many surge glaciers were observed by the large flow acceleration in pamir west kunlun karakoram and inner tibetan plateau kääb et al 2018 lv et al 2019 quincey et al 2011 round et al 2017 yasuda and furuya 2013 in this study surge glaciers were identified just for mass budget calculation and we do not intend to observe all surge events in the uibkk the surges of khurdopin virjerab and rimo glaciers initiated in recent years this indicated that these glaciers have entered active phase from quiescent phase during 2013 2019 while these glaciers experienced significant mass loss 0 74 0 17 m w e a 1 for khurdopin 0 43 0 17 m w e a 1 for virjerab and 0 18 0 29 m w e a 1 for rimo in 2013 2019 in contrast kichik kumdan and chamshing glaciers had entered quiescent phase in 2000 2013 and 2013 2019 respectively from active phase however heterogeneous mass budgets were found for these two glaciers with mass loss of 0 24 0 14 m w e a 1 in 2000 2013 and significant mass gain of 1 19 0 29 m w e a 1 in 2013 2019 the main reason is probably the different precipitation in 2000 2013 and 2013 2019 a remarkable thickening was found in the reservoir zone of chamshing glacier during 2013 2019 and the maximum thickening is more than 50 m therefore the surge itself does not have a significant effect on glacier wide mass budget however it transfers a huge volume of ice to dangerous places and results in significant mass loss with temperature rising li et al 2017 meanwhile an ideal area for mass accumulation was established in the reservoir zone and glacier would experience mass gain with precipitation increasing over a short time period 5 4 response for the heterogeneous mass budget a slight mass loss of 0 08 0 07 m w e a 1 was measured in the uibkk but changes are heterogeneous over the study area in the early 21st century this heterogeneous mass budget seems to be related to the climatic changes the uibkk is influenced by the westerlies in winter and glacier mass budgets are slight negative or balanced which have significant differences with the mass budgets in indian monsoon affected south eastern tibetan plateau ke et al 2020 wu et al 2020b previous studies showed that the increased precipitation has a significant influence in the balanced pattern of mass budget in the uibkk gardelle et al 2012b an increased winter precipitation and decreased mean summer temperature had been reported in the uibkk since 1961 fowler and archer 2006 yao et al 2012 which could result in great accumulation and slight ablation these changes agree with the positive trend of glacier mass budget in the uibkk in the early 21st century in this study in order to analyse the response of glaciers to climate change in the uibkk in the early 21st century climatic data sets precipitation and temperature from cru ts v4 04 were used in our study fig 8 the precipitation decreased and the temperature increased slightly in the uib from 2000 to 2019 fig 8a e based on cru ts v4 04 data while the winter precipitation increased slightly and the mean summer temperature increased moderately fig 8b f glacier mass supply by increased winter precipitation mostly in the form of snow compensated glacier melting caused by rising summer temperatures to some extent as a result glaciers in the uibkk experienced a balanced or slight negative mass budget in addition the winter precipitations have slight variations in 2000 2013 and 2013 2019 however a decreasing tendency of climate warming was found between 2000 and 2013 and 2013 2019 fig 8c d g h the weakening climate warming may be responsible for the decreased glacier mass loss in the early 21st century furthermore glaciers in the wkk ckk and ekk experienced homogeneous mass budgets in 2000 2013 which resulted from the similar tendencies of winter precipitation and summer temperature in each sub region in 2000 2013 fig 8c g however heterogeneous mass budgets were found in the wkk 0 60 0 17 m w e a 1 and ekk 0 22 0 29 m w e a 1 during 2013 2019 which agree with the different tendencies of climate warming in the wkk and ekk in 2013 2019 fig 8h thus climate warming may play more important role in glacier changes in the uibkk 6 conclusions in our study the spatiotemporal variability of glacier mass budgets in the karakoram region of upper indus basin uibkk have been estimated by employing the zy3 02 stereo images terrasar x tandem x images srtm dem and for the early 21st century 2000 2019 a balanced or slight negative mass budget was estimated for the uibkk glaciers and heterogeneous mass budget were found between different sub regions and between different time intervals the spatial distribution pattern of glacier mass budget in the uibkk showed that mass budgets shifted from negative to positive respectively along longitude glacier mass loss in the uibkk was decreasing from 0 12 0 16 m w e a 1 in 2000 2013 to 0 03 0 21 m w e a 1 in 2013 2019 geodetic mass budget estimations showed that debris cover has a positive influence on ice melt overall thinning rate on debris covered ice was significantly greater than that on clean ice based on glacier elevation changes and surface velocities many surge events in the uibkk were identified the overall homogeneous mass budgets for surge and non surge glaciers indicated that glacier surges seem not have a notable impact on glacier wide mass budget over short time scales the spatiotemporal patterns of glacier mass budgets in the uibkk were consistent with the tendencies of winter precipitation and summer temperature climate warming may play more important role in glacier changes in the uibkk credit authorship contribution statement k w conceptualization data curation and writing original draft s l conceptualization and supervision z j methodology q l writing review editing y z data curation and methodology y y methodology f x data curation a a t and m s writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the fundamental programme of the national natural science foundation of china grant no 41801031 41761144075 a grant of the second tibetan plateau scientific expedtion and research program step 2019qzkk0208 a project of the state key laboratory of cryospheric science grant no sklcs op 2019 07 a grant for talent introduction of yunnan university yjrc3201702 the fundamental programme of the national natural science foundation of yunnan province the landsat images and srtm c band data can be freely downloaded from http glovis usgs gov last access may 10 2020 we thank the usgs for free access to landsat and srtm c band data randolph glacier inventory is available from glims https www glims org its live data is available from jet propulsion laboratory nasa https its live jpl nasa gov 
3948,water supply contributed by glacier and snow melt is of particular significance and play a key role for social stability in the karakoram region of upper indus basin uibkk based on the srtm dem terrasar x tandem x images and zy3 02 stereo images the spatiotemporal pattern of glacier mass budgets in the uibkk have been estimated for the early 21st century 2000 2019 period in this study a comparison of the total area in 2000 with that in 2019 shows that glacier area remained stable in the early 21st century with a slight expansion of 56 3 km2 0 4 glaciers in the uibkk experienced a balanced or slight negative mass budget of 0 08 0 07 m w e a 1 in the early 21st century the spatial variability of mass budget in the uibkk showed that glacier mass budgets shifted from negative to positive from west to east respectively along longitude glacier mass loss decelerated from 0 12 0 16 m w e a 1 in 2000 2013 to 0 03 0 21 m w e a 1 in 2013 2019 no significant differences were observed in thinning rates on debris covered glaciers 19 area covered by debris and clean ice glaciers 19 area covered by debris in the early 21st century 0 06 m a 1 vs 0 04 m a 1 the overall homogeneous mass budgets for surge and non surge glaciers indicated that glacier surges seem not have a notable impact on glacier wide mass budget over short time scales the spatiotemporal variability of glacier mass budgets in the uibkk are consistent with the tendencies of winter precipitation and summer temperature climate warming may play more important role in glacier changes in the uibkk keywords upper indus basin terrasar x tandem x mass balance glacier surge climate warming 1 introduction the high mountain asia hma as the roof of the world developed a lot of valley glaciers rgi consortium 2017 meltwater of glacier and snow from hma provides water for drinking agricultural irrigation and electricity generation armstrong et al 2018 huss and hock 2018 immerzeel et al 2010 milner et al 2017 pritchard 2019 under the influence of climate warming glaciers in hma experienced pronounced recession widely in recent decades brun et al 2017 miles et al 2021 shean et al 2020 this has aroused wide concerns such as the availability of water resource immerzeel et al 2020 and impact on global sea level rise gardner et al 2013 jacob et al 2012 zemp et al 2019 contrary to other parts of hma stable or even positive glacier mass budgets have been found in the pamir karakoram west kunlun range in the past decades bolch et al 2017 farinotti et al 2020 gardelle et al 2013 lin et al 2017 wu et al 2020a zhou et al 2017 this anomalous behavior has exerted an important effect on regional water cycles and glacial hazards bhambri et al 2020 bolch et al 2017 while it remains unclear that whether the anomalous behavior will continue to exist in the coming decades farinotti et al 2020 owing to this background estimation of glacier mass budget over longer time period in this region is of great significance anomalous behaviour of glaciers in the karakoram was suspected since the nineteenth century godwin austen 1864 hayden 1907 balanced glacier mass budgets in the karakoram were estimated in the past decades brun et al 2017 gardelle et al 2012b kääb et al 2012 shean et al 2020 however the changes of glacier mass budget in the karakoram in the early 21st century are rare previous study indicated that glacier melt in the karakoram is driven by regional atmospheric circulation variability forsythe et al 2017 meanwhile the weakening indian monsoon and the strengthening westerlies had been found in recent decades yao et al 2012 hence it may be assumed that karakoram glaciers are in different mass budget conditions in the early twenty first century in order to clarify the response of glacier mass balance to climate change in the karakoram region of upper indus river basin uibkk the changes of glacier mass budget over the early twenty first century 2000 2019 20 years was estimated from geodetic methods on the ziyuan3 02 zy3 02 stereo images terrasar x tandem x tsx tdx images and shuttle radar topography mission srtm digital elevation model dem in this study the results provide insight into the change processes of regional glaciers and will help to understand the contribution of glacier meltwater on runoff in the future 2 study site the study site is located in the karakoram region of upper indus river basin uibkk between 34 to 37 n latitude and 72 to 78 e longitude which include three sub regions i e the west karakoram the central karakoram and the east karakoram fig 1 the typical characteristic of the region is extremely steep and high topography contains several high peaks and the greatest area of perennial glacial ice in hma farinotti et al 2020 hewitt 2007 the upper indus river basin uib is exposed to the westerlies resulting in a lot of precipitation in the winter and spring kapnick et al 2014 the effect of the monsoon in the region weakens north westward as a result of the barrier effect of high mountains forsythe et al 2017 annual precipitation in the uib increases with altitude ranging from 100 to 200 mm at northern valley floors and 600 800 mm at 4400 m a s l and 1500 2000 mm at 5500 m a s l sharif et al 2013 mean monthly temperatures in the uib are below freezing above 3000 m in the period of october to march archer 2004 streamflows dependent on glacial meltwater are strongly positively correlated with karakoram summer air temperatures which show recent anomalous cooling forsythe et al 2017 previous studies found that low temperature sensitivities of glaciers and an increase in snowfall for a large part caused by increases in evapotranspiration from irrigated agriculture result in positive mass balances in the karakoram de kok et al 2020 de kok et al 2018 on the basis of the rgi 6 0 4729 glaciers developed in the uibkk with glacier area of 14438 5 km2 21 glaciers are larger than 100 km2 even one glacier is larger than 1000 km2 the siachen glacier rgi consortium 2017 frequent glacier surges were reported in recent decades such as shispare khurdopin and virjerab glaciers bhambri et al 2020 quincey et al 2011 quincey et al 2015 rashid et al 2018 steiner et al 2018 3 data and methods 3 1 data for glacier mass budget calculations dems and glacier outlines covering the glacierized area of the uibkk were used in our study three dems were employed to estimate the changes of glacier surface elevation in the uibkk table 1 fig s1 the srtm c band dem with a resolution of 30 m in wgs84 egm96 were provided by u s geological survey usgs http glovis usgs gov farr et al 2007 the dem for the early 2010 s was extracted from fifteen pairs of tsx tdx images table s1 which acquired in bistatic synthetic aperture radar interferometry insar stripmap mode from the german aerospace center dlr krieger et al 2007 the resolutions of tsx tdx image in azimuth and range directions are both 3 m the recent dem was extracted from zy3 02 stereo images which acquired from august 2019 to february 2020 table s2 being the first chinese surveying and mapping satellite equipped with three panchromatic cameras for linear push broom imaging in three directions of forward backward and nadir the resolutions of the image is 2 5 m wang et al 2014 based on a tri epipolar method the zy3 02 dems were generated through dense tri stereo matching by the space data processor software tang et al 2018 the original rational polynomial coefficients rpcs of zy3 02 images modified though bundle adjustment oriented by srtm were used for absolute orientation to analyse the mass budget glacier outlines in investigated periods must be acquired especially many advanced glaciers exist in the uibkk the rgi 6 0 delineated from landsat tm images in 1998 2002 can be used to identify the glacierized area of the uibkk in 2000 to match with the tsx tdx images and zy3 02 images glacier outlines were delineated from landsat oli images of years 2013 and 2019 in this study landsat oli imageries were acquired from usgs data portal in order to reduce the impact of seasonal snow cover landsat imageries acquired during the ablation season from july to october were selected table s3 to estimate the tendency of glacier surface velocity the its live data product a set of annual glacier surface velocity were employed in our study gardner et al 2019 based on the auto rift feature tracking its live data product was derived from landsat images gardner et al 2019 to match with the glacier mass budget calculations in the early 21st century surface velocity in the uibkk from 2000 to 2019 were used in our study to analyse the relationship between glacier mass budget and climate change in the uibkk relevant air temperature and precipitation datasets were taken from the climatic research unit gridded time series v4 04 cru ts v4 04 based on the climate anomaly method the cru ts v4 04 were constructed from observations with a spatial resolution of 0 5 0 5 harris et al 2020 3 2 glacier outlines a semi automated method the normalized difference snow index ndsi was employed to identify glacier outlines in 2013 and 2019 which was then verified manually first ice snow body was distinguished from other objects by the ndsi formula band3 band6 band3 band6 and threshold value at the google earth engine gee cloud computing platform scherler et al 2018 to eliminate seasonal snow water bodies and shadows the glacier mask was filtered and checked manually in addition the outlines of debris cover cannot be identified by ndsi therefore the outlines of debris cover were delineated manually with the pan sharpened band images the error of glacier outlines includes the positional and processing errors of the input data previous study indicated that there has no distinct horizontal shift in landsat imageries guo et al 2015 even though the high quality of landsat imageries were selected as input data the automatically digitized glacier outlines need to be checked manually the uncertainty of glacier outlines acquired automatically and manually ranges from 2 to 5 paul et al 2013 in addition the error of glacier outlines also results from the spatial resolution of the input data the uncertainties of 10 and 30 m for clean ice and debris covered ice were estimated for landsat delineated glacier outlines guo et al 2015 according to these average uncertainties the uncertainties of 4 3 and 6 7 were calculated for glacier areas in 2013 and 2019 3 3 glacier height changes based on the method of differential insar dinsar glacier height changes in the periods of 2000 2013 and 2013 2019 were derived from tsx tdx images and reference dems here zy3 02 and srtm dem first by means of insar method the bistatic interferogram was generated from tsx tdx image and reference dems the bistatic interferogram contain topographic phase topographic residual phase and flat earth next the topographic phase and flat earth simulated by the orbital information from tsx tdx image and reference dems were removed from the bistatic interferogram thus the topographic residual phase induced by the glacier height change was converted to a differential interferogram finally the map of glacier height changes was generated from unwrapped differential interferogram li et al 2018 neckel et al 2013 wu et al 2018 to minimize the error of phase unwrapping precise horizontal offset registration between tsx tdx image and reference dems need to be performed before generating the differential interferogram based on the relation between tsx tdx image and reference dems a refinement of the look up table was calculated and some error regions caused by radar shadows and layover were masked out the horizontal offset was eliminated by the precise orbit information of tsx tdx image and the refinement of the look up table then the tsx tdx interferogram and the co registered reference dems were employed to generate a differential interferogram finally unwrapped by the minimum cost flow algorithm the differential interferogram was converted to glacier height changes wu et al 2018 glacier height changes from 2000 to 2019 were acquired by dem differencing with srtm dem and zy3 02 dem nuth and kääb 2011 pieczonka et al 2013 according to the cosinusoidal relationship between elevation difference terrain slope and terrain aspect in non glaciated regions relative horizontal and vertical shift between srtm dem and zy3 02 dem were corrected nuth and kääb 2011 in the process of co registration all terrain in non glaciated regions with slope between 5 and 75 were selected to calculate the parameters of co registration the final shift vectors of zy3 02dem are listed in table s4 the biases resulted from multiple spatial resolutions between srtm dem and zy3 02 dem were adjusted by the terrain parameter of maximum curvatures gardelle et al 2012a after the adjustments outliers of elevation difference in the entire glacier area were removed by the threshold of 5 and 95 quantiles based on statistics of elevation difference in the entire glacier area pieczonka et al 2013 finally the mean elevation difference in non glaciated regions decreased from 8 76 m to 0 76 m fig 2 it is concluded that elevation difference in non glaciated regions have stabilized and that the pre processed dems were suitable for the estimation of glacier height changes the penetration depth of the c band and x band dem should be considered when assessing glacier height changes comparing insar based elevations with optical laser gnss elevations obtained at a similar time provides us with an efficient way of quantifying the bias of insar based elevation dehecq et al 2016 lambrecht et al 2018 li et al 2021 an average penetration depth of 1 8 m for the x band tandem found in the pamir and west kunlun lambrecht et al 2018 li et al 2021 was applied in this study for the penetration depth of the c band srtn dem elevation difference between c band and x band srtm dems was estimated from the method of common dem differencing first average difference of 1 6 0 05 m fig s2 and then the penetration depth of the c band srtm dem was calculated from the penetration depth of x band dem and the elevation difference between c band and x band dem finally the penetration depth of the c band srtm and x band tandem were removed on glaciers in addition the inter annual and seasonal variance of glacier heights need be considered gardelle et al 2012b lin et al 2017 because the bistatic tsx tdx and zy3 02 were obtained at different points in time we normalized the height changes into a decadal scale by presuming a linear height change rate lin et al 2017 the tsx tdx images were mainly acquired in january february and march and zy3 02 images were mainly acquired in october november december january and february to avoid the effects of seasonal variances glacier mass budgets estimated from tsx tdx and zy3 02 images should be adjusted according to the acquired time of srtm i e february due to the lack of in situ measurements in the uibkk glacier mass budget within one year is difficult to establish based on monthly mass balances over a short period and least square adjustment lin et al 2017 obtained a monthly trend of 0 06 m w e a 1 from october to next march hence a glacier mass balance correction of 0 018 m w e a 1 november 0 12 m w e a 1 december 0 06 m w e a 1 january 0 m w e a 1 february 0 06 m w e a 1 march 0 12 m w e a 1 april was selected in this study by keeping the february srtm dem acquisition month as reference month the data voids in difference maps should be filled when computing the volume change of regional and individual glaciers an efficient method named local mean hypsometric method was used to fill in data voids mcnabb et al 2019 except data voids the height changes of glaciers which uncovered by tsx tdx and zy3 02 images need be calculated the uncovered glacier area account for 24 and 9 of the total glacierized area for tsx tdx and zy3 02 images respectively after performing the necessary bias correction for each glacier frame or sub region we calculated the height changes of glaciers which uncovered by tsx tdx and zy3 02 images in each 50 m elevation bin according to the glacier height distribution by presuming that the glacier height changes were the same at the same elevation in the same sub region or sub group after all adjustments finally the elevation difference maps during the investigated periods were generated the final elevation differences in non glaciated area were employed to estimate the error of glacier height changes table 2 fig s3 the mean elevation differences δ mea and the standard deviation of elevation differences δ stdv in non glaciated area were calculated in three sub regions i e the west karakoram wkk central karakoram ckk and east karakoram ekk while the δ stdv would overestimate the uncertainty the standard error of the mean δ se in non glaciated regions could be calculated using eq 1 to estimate the uncertainty 1 δ se δ stdv n where n is the amount of pixels nuth and kääb 2011 to minimize the effect of autocorrelation a decorrelation length based on the spatial resolution is recommended for dems with a spatial resolution of 5 m a decorrelation length of 100 m is suitable koblet et al 2010 berthier et al 2010 chose 500 m as the decorrelation length for dems with the resolution of 40 m and bolch et al 2011 used 600 m and 400 m for spatial resolutions of 30 m and 10 20 m respectively in this study decorrelation of 400 m was employed for the difference between the srtm dem and the tsx tdx srtm tsx tdx 100 m was employed for the srtm zy3 02 and tsx tdx zy3 02 finally the uncertainty of glacier height changes δ dh can be calculated from δ mea and δ se using eq 2 2 δ dh δ mea 2 δ se 2 the uncertainties of all three sub regions and the whole study area were calculated for different investigated periods table 2 the uncertainties between the final difference maps ranging from 0 27 to 1 39 m table 2 indicated that the results of glacier height change are acceptable 3 4 glacier mass budget the total volume changes δ v for the respective survey period was calculated using eq 3 3 δ v δ d h a max where δ d h is the average glacier height change a max is the maximum glacier area in respective survey period after acquiring total volume changes glacier mass budget mb was estimated from the ice snow density ρ g 850 kg m 3 huss 2013 and total volume changes using eq 4 4 mb δ v ρ g a t ρ water where ρ water is the density of water 1000 kg m 3 a is the average glacier area in respective survey period and t is the time interval in years finally the uncertainty of overall glacier mass budget δ mb was calculated using eq 5 from the uncertainties of glacier area changes δ ac the square root of the sum of the squares of the glacier area uncertainties in respective survey period glacier height changes δ dh and ice snow density δ ρ 60 kg m 3 5 δ mb δ d h δ ρ 2 δ d h ρ g δ ac 2 δ dh ρ g 2 ρ water due to the large glacier area in the study area the second term in eq 5 is so small that could be negligible and then the final uncertainty of glacier mass budget was calculated by using eq 6 6 δ mb δ d h δ ρ 2 δ dh ρ g 2 ρ water 4 results 4 1 glacier area change according to the latest inventory the uibkk contains 4713 glaciers with an area of 14494 8 971 2 km2 in 2019 the mean glacier size is 3 08 km2 and the median glacier elevation is around 5286 m only 7 1 333 of all glaciers are larger than 5 km2 but cover over 80 of the glacierized area on the other hand 73 9 3482 of all glaciers are smaller than 1 km2 but cover only 6 3 of the total area a comparison of the total area in 2000 with that in 2019 shows that glacier area remained stable in the early 21st century with a slight expansion of 56 3 km2 0 4 while a shifted glacier area change from expansion to shrinkage were found in the periods of 2000 2013 and 2013 2019 glacier area increased by 202 0 km2 from 14438 5 km2 1 4 between 2000 and 2013 then it decreased by 145 7 km2 1 0 from 2013 to 2019 4 2 glacier mass budget in total no significant mass changes were found in the uibkk the average change of glacier height for the study area was 1 70 0 34 m in the early 21st century glaciers in the uibkk experienced a slight thinning of 0 09 0 08 m a 1 or a mass budget of 0 08 0 07 m w e a 1 fig 3 table 3 the average changes of glacier surface elevation varied from 5 03 to 4 41 m a 1 in the uibkk while more than 90 of the glaciers fall in the elevation change category of 1 to 1 m a 1 although a small rate of glacier mass loss has been found in the early 21st century it has decreased slightly during two sub periods of 2000 2013 and 2013 2019 glaciers experienced an average thinning of 0 14 0 18 m a 1 or a mass loss of 0 12 0 16 m w e a 1 during 2000 2013 then it decreased to 0 03 0 23 m a 1 or 0 03 0 21 m w e a 1 during 2013 2019 glacier mass budgets have been heterogeneous over the study area in the early 21st century figs 4 6 table 3 the most negative mass budget of 0 23 0 08 m w e a 1 was measured in the west karakoram from 2000 to 2019 and an accelerated mass loss was found from 0 09 0 07 m w e a 1 in 2000 2013 to 0 60 0 17 m w e a 1 in 2013 2019 glaciers in the central uibkk experienced a moderate mass loss with 0 06 0 09 m w e a 1 from 2000 to 2019 and homogeneous mass losses were found in the periods of 2000 2013 and 2013 2019 glaciers in the east uibkk experienced a slight mass gain or balanced mass budget with 0 04 0 19 m w e a 1 from 2000 to 2019 while a shifted glacier mass budgets from negative to positive were found in the periods of 2000 2013 and 2013 2019 with means of 0 14 0 14 m w e a 1 and 0 37 0 29 m w e a 1 respectively glacier mass budgets varied significantly between different sub regions and between different time intervals even within the same sub region mass budgets can be highly variable between individual glaciers for example in the central karakoram two large glaciers 300 km2 experienced significantly different mass budget with 0 47 0 09 m w e a 1 for chogo glacier and 0 16 0 09 m w e a 1 for panmah glacier from 2000 to 2019 4 3 glacier surges based on glacier elevation changes surface velocity or morphology many glaciers in karakoram were identified as surge glaciers bhambri et al 2017 gardelle et al 2012b heid and kääb 2012 hewitt 2007 quincey et al 2011 in this study glaciers in the uibkk were separated into surge glaciers and non surge glaciers from the surface elevation difference maps surge glaciers experienced a slight mass loss of 0 06 0 07 m w e a 1 in the early 21st century and homogeneous mass loss were estimated for non surge glaciers 0 04 0 07 m w e a 1 the overall homogeneous mass budgets for surge and non surge glaciers indicated that glacier surges seem not have a notable impact on glacier wide mass budget over short time scales 4 4 comparison of clean ice and debris covered glaciers it is generally believed that debris cover plays a key role on glacier mass budget excluding the surge glaciers all other glaciers non surge in the uibkk were separated into two categories i e debris covered glaciers 19 area covered by debris and clean ice glaciers 19 area covered by debris brun et al 2019 to estimate the mass budgets for these two different glacier types in this study results showed that no significant differences were observed in thinning rates on debris covered glaciers and clean ice glaciers in the early 21st century 0 06 m a 1 vs 0 04 m a 1 fig 7 which agrees with brun et al 2019 who found no significant correlation between mass balance and debris cover in the karakoram in order to compare the mass budgets between clean and debris covered ice with similar altitude distributions elevation changes with altitude in all non surging glaciers were calculated for each sub region figs 4d 5d 6d on average thinning rates have a significant difference in the early 21st century such as 0 37 0 07 m a 1 on debris covered ice and 0 01 0 07 m a 1 on clean ice while the debris have different influences in each sub region in the west and central karakoram the thinning rates are similar on debris covered ice and clean ice at a similar altitude figs 4d 5d however a larger thinning rate was found on debris covered ice than that on clean ice in the east karakoram fig 6d it seems to be a special behaviour of east karakoram 5 discussion 5 1 uncertainty for glacier mass budget the penetrations of the srtm c band and tandem x band are the major sources of uncertainty gardelle et al 2012a the penetration depth can range from 0 to 10 m depending on a variety of parameters such as snow temperature density and water content berthier et al 2006 as revealed by in situ radar measurements made in the antarctic the phase centre depth of the x band can reach 4 m in a dry snowpack rott et al 1993 the average penetration depth of 1 8 m for the x band tandem and 3 4 m for the c band srtm was applied in this study the uibkk mass budget without considering penetration depth is 0 03 m w e a 1 in 2000 2013 and 0 07 m w e a 1 in 2000 2019 another uncertainty results from the data voids in difference maps to evaluate the influence of data voids the glacier surface elevation changes in the uibkk during 2000 2019 was calculated i by filling the voids with the local mean hypsometric method result 1 90 m or 0 09 m w e a 1 and ii without void filling 2 76 m or 0 12 m w e a 1 the results indicated that void filling or not seem not have a significant influence on average elevation change rates in addition height changes of glaciers which uncovered by tsx tdx and zy3 02 images is one of the sources of uncertainty according to the glacier height distribution by presuming that the glacier height changes were the same at the same elevation in the same sub region or sub group the height changes of glaciers which uncovered by tsx tdx and zy3 02 images were calculated in each elevation bin these uncovered glacier height changes have almost no impact on glacier height changes in the whole study area for the investigated periods apart from penetration depth data voids and uncovered glacier height changes the inter annual and seasonal variance of glacier heights are other uncertainties the height changes were normalized into a decadal scale by presuming a linear height change rate for the adjustments of inter annual variance and a glacier height correction of 0 07 m per month was used to adjust the seasonal variance of glacier mass budget these seasonal corrections result in a slight variance of 0 01 m w e a 1 in glacier mass budget in the uibkk for the investigated periods 5 2 glacier mass budget karakoram anomaly has been one of the research hotspots in recent years which has raised a lot of research results farinotti et al 2020 gardelle et al 2012 gardelle et al 2013 quincey et al 2015 however due to the differences in data sources and the glacier area measured mass budgets in the karakoram differed from each other slightly in total balanced to slightly positive mass budget was measured for karakoram glaciers over the past decade farinotti et al 2020 employed tandem and srtm dems glaciers in the uib experienced a mean thinning of 0 35 0 33 m a 1 from 2000 to 2012 abdullah et al 2020 while glacier mass budget in the sub region of karakoram in the uib was 0 09 0 27 m w e a 1 abdullah et al 2020 which is consistent with our result of 0 12 0 16 m w e a 1 from 2000 to 2013 employed aster scenes and srtm a glacier mass budget of 0 08 0 21 m w e a 1 was found in the hunza basin from 2000 to 2009 bolch et al 2017 which agreed with the result of 0 09 0 07 m w e a 1 in the sub region of west karakoram from 2000 to 2013 in addition mean glacier mass balances of 0 10 0 13 2003 2009 gardner et al 2013 0 09 0 12 2003 2008 kääb et al 2015 0 03 0 07 2000 2016 brun et al 2017 and 0 04 0 04 m w e a 1 2000 2018 shean et al 2020 were found in the karakoram which agreed with our results in different periods these comparisons suggested that our results were reliable the spatial distribution pattern of glacier mass budget in the uibkk showed that mass budget shifted from negative to positive from west to east respectively along longitude fig 3 due to the steep mountains and deep valleys in our study area the distribution of precipitation is extremely complicated at high altitude anders et al 2015 while comparing the mean median elevations of glaciers along longitude a clear orographic control appears on mass budget the mean median elevations of glaciers increased gradually from 4990 m to 5700 m along longitude from 74 e to 78 e west to east in the study area respectively which agrees with previous study mölg et al 2018 although the relationship between mass balance and topography is complex we suggest that glaciers located at higher elevations have generally been able to capture more solid precipitation than those at lower elevations and have subsequently lost less to sublimation and melt stigter et al 2018 apart from orographic control debris cover also play an important role in glacier melt due to the steep rock walls and intense avalanche activity glaciers in the uibkk are covered by debris heavily in glacier tongue in theory a thin debris cover will aggravate ice melt by decreasing albedo while a thick debris cover will weaken ice melt by the effect of heat insulation benn et al 2012 in this study debris cover has a positive influence on ice melt overall thinning rate on debris covered ice was slight larger than that on clean ice however the elevation changes in debris covered tongues includes the change of glacier thickness and the possible evolution of debris thickness previous study showed that the total area of debris cover expanded by 8 1 21 3 in the hunza basin from 1990 to 2019 xie et al 2020 based on the debris discharges a thickening of the debris ranges from 2 7 to 5 5 mm a 1 was estimated in batura glacier the west karakoram gardelle et al 2013 considered the magnitude of the glacier thickness changes the value of debris thickening could be negligible but debris thickening would have a critical feedback effect on glacier melt and need more detailed investigations 5 3 glacier surges glacier surge is a periodic glacier activity lasting from months to a few years that is unrelated to changes in mass budget hooke 2005 each period includes two phases i e surge or active phase and quiescent phase during a surge a huge volume of ice is transferred from the reservoir zone usually the accumulation area to the receiving zone the terminus region accordingly remarkable thickening and thinning can be observed in the receiving zone and reservoir zone respectively after surging glacier enter a period of quiescence which can last on the order of decades conversely the surface elevation in the receiving zone is drawn down with a high and uniform intensity and the reservoir zone thickens during the quiescent phase xie and liu 2010 surges and quiescent phases can be clearly observed in several glaciers in the uibkk two surge events were captured in hispar glacier which has been confirmed by recent researches guo et al 2020 paul et al 2017 rashid et al 2018 the first surge event of hispar occurred in the north branch before 2013 with the thickening in the receiving zone more than 80 m the second occurred in the main branch after 2013 and the maximum thickening in the receiving zone is more than 140 m besides hispar glacier khurdopin virjerab biafo baltoro rimo chong kumdan kichik kumdan and chamshing glaciers experienced one surge event during the investigated period in general the timescale of glacier mass budget estimated from geodetic methods is a few years or decades glacier elevation change can be used to identify surge event but it cannot be used to determine exactly when the surge occurred another characteristic of surge glaciers is the large flow acceleration after extended quiescent phases of slow movement hooke 2005 many surge glaciers were observed by the large flow acceleration in pamir west kunlun karakoram and inner tibetan plateau kääb et al 2018 lv et al 2019 quincey et al 2011 round et al 2017 yasuda and furuya 2013 in this study surge glaciers were identified just for mass budget calculation and we do not intend to observe all surge events in the uibkk the surges of khurdopin virjerab and rimo glaciers initiated in recent years this indicated that these glaciers have entered active phase from quiescent phase during 2013 2019 while these glaciers experienced significant mass loss 0 74 0 17 m w e a 1 for khurdopin 0 43 0 17 m w e a 1 for virjerab and 0 18 0 29 m w e a 1 for rimo in 2013 2019 in contrast kichik kumdan and chamshing glaciers had entered quiescent phase in 2000 2013 and 2013 2019 respectively from active phase however heterogeneous mass budgets were found for these two glaciers with mass loss of 0 24 0 14 m w e a 1 in 2000 2013 and significant mass gain of 1 19 0 29 m w e a 1 in 2013 2019 the main reason is probably the different precipitation in 2000 2013 and 2013 2019 a remarkable thickening was found in the reservoir zone of chamshing glacier during 2013 2019 and the maximum thickening is more than 50 m therefore the surge itself does not have a significant effect on glacier wide mass budget however it transfers a huge volume of ice to dangerous places and results in significant mass loss with temperature rising li et al 2017 meanwhile an ideal area for mass accumulation was established in the reservoir zone and glacier would experience mass gain with precipitation increasing over a short time period 5 4 response for the heterogeneous mass budget a slight mass loss of 0 08 0 07 m w e a 1 was measured in the uibkk but changes are heterogeneous over the study area in the early 21st century this heterogeneous mass budget seems to be related to the climatic changes the uibkk is influenced by the westerlies in winter and glacier mass budgets are slight negative or balanced which have significant differences with the mass budgets in indian monsoon affected south eastern tibetan plateau ke et al 2020 wu et al 2020b previous studies showed that the increased precipitation has a significant influence in the balanced pattern of mass budget in the uibkk gardelle et al 2012b an increased winter precipitation and decreased mean summer temperature had been reported in the uibkk since 1961 fowler and archer 2006 yao et al 2012 which could result in great accumulation and slight ablation these changes agree with the positive trend of glacier mass budget in the uibkk in the early 21st century in this study in order to analyse the response of glaciers to climate change in the uibkk in the early 21st century climatic data sets precipitation and temperature from cru ts v4 04 were used in our study fig 8 the precipitation decreased and the temperature increased slightly in the uib from 2000 to 2019 fig 8a e based on cru ts v4 04 data while the winter precipitation increased slightly and the mean summer temperature increased moderately fig 8b f glacier mass supply by increased winter precipitation mostly in the form of snow compensated glacier melting caused by rising summer temperatures to some extent as a result glaciers in the uibkk experienced a balanced or slight negative mass budget in addition the winter precipitations have slight variations in 2000 2013 and 2013 2019 however a decreasing tendency of climate warming was found between 2000 and 2013 and 2013 2019 fig 8c d g h the weakening climate warming may be responsible for the decreased glacier mass loss in the early 21st century furthermore glaciers in the wkk ckk and ekk experienced homogeneous mass budgets in 2000 2013 which resulted from the similar tendencies of winter precipitation and summer temperature in each sub region in 2000 2013 fig 8c g however heterogeneous mass budgets were found in the wkk 0 60 0 17 m w e a 1 and ekk 0 22 0 29 m w e a 1 during 2013 2019 which agree with the different tendencies of climate warming in the wkk and ekk in 2013 2019 fig 8h thus climate warming may play more important role in glacier changes in the uibkk 6 conclusions in our study the spatiotemporal variability of glacier mass budgets in the karakoram region of upper indus basin uibkk have been estimated by employing the zy3 02 stereo images terrasar x tandem x images srtm dem and for the early 21st century 2000 2019 a balanced or slight negative mass budget was estimated for the uibkk glaciers and heterogeneous mass budget were found between different sub regions and between different time intervals the spatial distribution pattern of glacier mass budget in the uibkk showed that mass budgets shifted from negative to positive respectively along longitude glacier mass loss in the uibkk was decreasing from 0 12 0 16 m w e a 1 in 2000 2013 to 0 03 0 21 m w e a 1 in 2013 2019 geodetic mass budget estimations showed that debris cover has a positive influence on ice melt overall thinning rate on debris covered ice was significantly greater than that on clean ice based on glacier elevation changes and surface velocities many surge events in the uibkk were identified the overall homogeneous mass budgets for surge and non surge glaciers indicated that glacier surges seem not have a notable impact on glacier wide mass budget over short time scales the spatiotemporal patterns of glacier mass budgets in the uibkk were consistent with the tendencies of winter precipitation and summer temperature climate warming may play more important role in glacier changes in the uibkk credit authorship contribution statement k w conceptualization data curation and writing original draft s l conceptualization and supervision z j methodology q l writing review editing y z data curation and methodology y y methodology f x data curation a a t and m s writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the fundamental programme of the national natural science foundation of china grant no 41801031 41761144075 a grant of the second tibetan plateau scientific expedtion and research program step 2019qzkk0208 a project of the state key laboratory of cryospheric science grant no sklcs op 2019 07 a grant for talent introduction of yunnan university yjrc3201702 the fundamental programme of the national natural science foundation of yunnan province the landsat images and srtm c band data can be freely downloaded from http glovis usgs gov last access may 10 2020 we thank the usgs for free access to landsat and srtm c band data randolph glacier inventory is available from glims https www glims org its live data is available from jet propulsion laboratory nasa https its live jpl nasa gov 
3949,satellite based precipitation products spp have been the focus of much attention for their potential utility of drought monitoring and analysis assessing the accuracy and drought performance of the spps for ungauged areas is urgent and also challenging this study comprehensively investigated the performance of the triple collocation tc approach an assessment approach requiring no benchmark data the accuracy and drought utility assessment of the spps furthermore we applied the tc approach experimentally to the spps throughout mainland china the china monthly precipitation analysis product cpap a gridded gauge based precipitation dataset was employed to validate the tc approach results demonstrate the effectiveness of the tc approach in retrieving spatial patterns in the accuracy and drought performance via short timescale drought indices of the spps but systematic bias was observed moreover the tc approach exhibits a weak performance in assessing the long timescale drought indices by comparing the assessment results the tc approach reveals the potential underestimation of the spp accuracy by the traditional assessment approach for some ungauged regions in general the proposed tc outperforms the traditional approach in qualitatively assessing the performance pattern of spps over ungauged and poorly gauged areas but the systematic bias of tc needs attention when quantitatively determining spp performance keywords satellite based precipitation product accuracy assessment drought utility triple collocation approach standardized precipitation index mainland china 1 introduction drought is a critical natural disaster that can cause considerable socioeconomic losses dai 2013 wang et al 2018 li et al 2020 under the influence of climate change and global warming the severity and frequency of drought hazards have been intensified in the past decades ipcc 2013 wang et al 2018 therefore the development of comprehensive drought monitoring framework has been the focal point of many researchers drought indices such as the standardized precipitation index spi are fundamental for the quantification of drought conditions bai et al 2020 guo et al 2016 sahoo et al 2015 precipitation is a key input for most drought indices with data conventionally derived from ground based observations however due to the restriction of local terrain and the environment gauge based precipitation data are sparsely distributed and even unavailable in some remote and undeveloped regions wang et al 2017 the accurate estimation of precipitation via interpolation in these regions is difficult due to the high heterogeneity of precipitation bai et al 2019 wu et al 2018 researchers have also pointed out that sparse gauge density can influence the spatial representativeness of precipitation resulting in lower reliability of drought index bai et al 2019 trenberth et al 2014 satellite based precipitation data products generally have a wide coverage and consistent spatial resolution compared to gauge data and have thus proven effective in drought monitoring widely used satellite based precipitation products spps include the precipitation estimation from remotely sensed information using artificial neural networks persiann hsu et al 1997 the persiann climate data records persiann cdr ashouri et al 2014 and the climate hazards group infrared precipitation with stations chirps funk et al 2015 which are principally based on infrared ir data the climate prediction center cpc morphing technique cmorph joyce et al 2004 and the global satellite mapping of precipitation gsmap kubota et al 2020 which are mainly based on passive microwave pmw data and the tropical rainfall measuring mission multi satellite precipitation analysis tmpa huffman et al 2007 and integrated multi satellite retrievals for global precipitation measurement imerg huffman et al 2019 which incorporate ir pmw and active precipitation radar data with their wide spatial coverage and high spatial resolution these spps have provided precipitation estimations for many ungauged areas and are widely applied in the field of hydrology and water resources including drought analysis and monitoring gao et al 2017 guo et al 2016 lai et al 2019 sahoo et al 2015 tang et al 2018 wang et al 2017 zambrano et al 2017 zhong et al 2019 at present the key bottlenecks of spps for drought monitoring are the relatively lower accuracy and the greater uncertainty of spps than in situ observations bai et al 2019 therefore assessing the quality of spps before applying is crucial many studies have been performed in the past decades in order to directly assess the spps accuracy spps performance in hydrological modeling and the ability to reveal extreme precipitation events etc tang et al 2018 tang et al 2020 tang et al 2016 wang et al 2017 yong et al 2014 zambrano et al 2017 in these studies the gauge based data are commonly used as benchmarks to assess spps and thus the results largely depend on the density and quality of the used gauge data tang et al 2018 most researches were focused on areas with dense gauge networks while spps performances in the areas with sparse gauges or ungauged areas remain unclear li et al 2018 the triple collocation tc approach stoffelen 1998 is based on the statistical relationships between the errors of multiple independent estimates and can objectively estimate the accuracy of three independent data products when the true values are unavailable this approach can assess the accuracy of spps over ungauged areas tc are widely adopted for the assessments of some multi source geophysical data such as wind speed soil moisture and total water storage chen et al 2018 mccoll et al 2014 van dijk et al 2014 yilmaz and crow 2014 yuan et al 2020 recently this approach has also been applied to evaluate several gridded precipitation products e g weather radar data and spps across the globe li et al 2018 roebeling et al 2012 wu et al 2019 considering that a multiplicative error model is more suitable for precipitation data compared to an additive one alemohammad et al 2015 proposed the multiplicative tc mtc approach to evaluate several gridded precipitation estimation products in the united states they found mtc to be more suitable for the assessment of precipitation products than the additive tc atc approach li et al 2018a evaluated the capability of tc for assessing spps over the mainland china using a dense gauge network and concluded the mtc to be more suitable than atc over the region massari et al 2017 evaluated tc in assessing three spps over the continental united states but found that mtc does not necessarily outperform atc tang et al 2020 firstly used tc to assess snowfall estimation of the spps reanalysis and gauge based datasets chen et al 2021 evaluated the error cross correlation ecc between spps and reanalysis using the quadruple collocation an approach developed based on tc however the aforementioned studies did not investigate the use of tc in assessing the drought utility of spps this is particularly meaningful for ungauged areas in this context by taking mainland china as the study area the objectives of this study are 1 to validate the capability of tc in assessing the accuracy of spps 2 to validate the capability of tc in assessing the drought utility of the spps 3 to assess the accuracy of two selected long term spps using tc and 4 to assess the drought utility of the spps using tc the persiann cdr and chirps products were selected as the spps both of which have long term records of over 30 years and are thus suitable for drought analysis and monitoring a soil moisture based spp with different estimation mechanism namely sm2rain ascat and the latest reanalysis product of the european center for medium range weather forecast ecmwf namely era5 were selected as the remaining triplets along with the spps for tc this study is expected to advance the understanding of the applicability of tc and to provide reference for assessing the drought utility of precipitation data products and drought monitoring by using spps for ungauged regions 2 study area and data 2 1 study area the study area mainland china fig 1 is located in the east of eurasia and exhibits various topography and climate conditions the eastern and southeastern regions of mainland china with generally flat and hilly terrain are adjacent to northwestern pacific and are dominated by the humid subtropical and temperate monsoon climates the northwest of mainland china which features alpine plateau and basin terrain is dominated by the arid and semi arid temperate continental climate the southwestern region of mainland china is primarily located in the tibetan plateau the highest plateau in the world and thus is mainly dominated by a cold and arid plateau climate the precipitation in mainland china is high in the southeast up to 2 000 mm per year and low in the northwest below 200 mm per year according to relevant studies bai et al 2019 zhong et al 2019 mainland china can be divided into nine subregions northeast china nec the huang huai hai region hhh the inner mongolia im the loess plateau lp the middle and lower regions of the yangtze river yr southwest china swc south china sc the gansu xinjiang region gxr and the tibetan plateau tp these subregions are divided according to the local terrain land cover and climate 2 2 persiann cdr the persiann cdr hereafter referred to as pcdr ashouri et al 2014 is a long term spp developed by the center for hydrometeorology and remote sensing university of california irvine the product has long term records that started from 1983 total of 36 years until 2018 a wide spatial coverage from 60 s to 60 n and a high spatial resolution of 0 25 pcdr is designed to provide long term high resolution precipitation data to meet the requirements of global climate studies pcdr is generated from the multi source gridded satellite ir dataset gridsat b1 processed by an artificial neural network trained by the stage iv radar based precipitation data the low resolution 2 5 2 5 long term monthly gridded precipitation data product called global precipitation climatology project gpcp adler et al 2003 is subsequently applied to correct the bias of the raw pcdr data the pcdr product used in this study was downloaded from the data portal of the center for hydrometeorology and remote sensing http chrsdata eng uci edu 2 3 chirps the chirps product funk et al 2015 is developed by the climate hazards group for drought analysis and monitoring this product employs long term precipitation records since 1981 with a spatial coverage among 50 s to 50 n land only and a high spatial resolution of 0 05 the chirps precipitation data is initially estimated via the cold cloud duration data from two global geosynchronous thermal infrared archives the globally gridded satellite grisat archive from the national climate data center and the climate prediction center thermal infrared dataset the raw precipitation estimates are then bias corrected using the pentadal monthly climate hazards group precipitation climatology chpclim data and subsequently merged with ground based observations to form the chirps dataset funk et al 2015 in this study the monthly chirps dataset was obtained from the climate hazards group website http chg geog ucsb edu data chirps 2 4 additional datasets for tc tc requires three independent estimates of precipitation therefore in addition to individual spps two additional datasets are required following massari et al 2017 this study adopted the sm2rain a bottom up spp from soil moisture remote sensing and a model based reanalysis dataset as the other two triplets 2 4 1 sm2rain ascat sm2rain ascat brocca et al 2019 is a high resolution semi global scale spp that is based on a bottom up approach sm2rain ascat is based on the sm2rain algorithm brocca et al 2014 which retrieves precipitation inversely from the soil moisture data from satellite remote sensing via a soil water balance equation therefore the sm2rain ascat product has relatively independent mechanism to the conventional spps and is suitable to be considered as a tc triplet the adopted soil moisture data for sm2rain ascat is retrieved from the advanced scatterometer ascat a real aperture radar instrument onboard the metop satellite which presently is rarely used for other precipitation datasets sm2rain ascat also has been used as tc triplet to assess other spps for its independent data source and mechanism chen et al 2021 brocca et al 2019 massari et al 2017 the sm2rain ascat data has a spatial resolution of about 12 5 km and a temporal resolution of 1 day and provides precipitation data from june 2007 to present in this study the sm2rain ascat data over mainland china from 2007 to 2018 12 years are used to keep concise hereafter the sm2rain ascat is represented by the abbreviation sm2rain 2 4 2 reanalysis precipitation product era5 fifth generation ecmwf reanalysis is the latest generation of the global atmospheric reanalysis product developed by the ecmwf hersbach et al 2020 the era5 product provides various meteorological assimilation data including precipitation from 1979 to present this product is based on the four dimensional variational analysis on the latest version of the ecmwf integrated forecasting system ifs cycle 41r2 which has several added features specifically for reanalysis the era5 has many improvements relative to its predecessor the era interim including a higher spatiotemporal resolution 0 25 and 1 hourly and an improved variational bias scheme hersbach et al 2020 the reliability of era5 precipitation data has also been verified in some studies tang et al 2020 the monthly era5 precipitation data was obtained from the copernicus climate change service website https doi org 10 24381 cds f17050d7 2 5 precipitation observation for validations and comparisons the china monthly precipitation analysis product cpap produced by the china meteorological administration cma is a gauge based interpolated precipitation product over mainland china with a spatial resolution of 0 5 the cpap was used as the reference dataset for evaluating tc the cpap is interpolated by monthly precipitation observations from more than 2 400 gauges in mainland china by using a terrain based thin plate spline interpolation approach this product is of high quality and reliability over areas with dense gauge networks e g eastern mainland china and has been widely used to evaluate the accuracy and drought utility of different spps bai et al 2020 bai et al 2019 guo et al 2016 however the cpap gauge networks are highly sparse in western china fig 2 b particularly for northwestern tp which largely hinders the evaluation of spps over these areas the two key roles of the cpap dataset in this study are described as follows 1 validating tc performance i e the capability and reliability of tc in assessing the accuracy and drought performance of spps for this purpose the cpap data were used to represent the true value to assess the spps directly by extending the error function of gauge observations established by tang et al 2018 we found that for monthly precipitation data at least two gauges are necessary for the 0 5 gridcell to ensure that the assessed correlation coefficients have a small error level about 5 therefore only the 0 5 gridcells containing at least two gauges were selected a total of 480 cpap gridcells were ultimately selected and were designated as validation gridcells to validate tc fig 2a shows the locations of validation gridcells and the observation rates ratios between number of valid gauge records to all time steps of all gauges of the validation gridcells during 1983 to 2018 the months with valid gauge records occupy over 99 of the entire period for all validation gridcells hence the gauge number has little temporal variation and should have little influence on the validations via cpap 2 acting as the traditional spp assessment approach i e directly calculating the accuracy metrics between cpap and spps for the purpose of comparing with tc all cpap gridcells were adopted for this purpose following previous studies bai et al 2020 guo et al 2016 zhong et al 2019 both of the spps and the era5 data were spatially averaged to 0 5 spatial resolution to match with the cpap data considering the temporal extent of the adopted precipitation datasets the validation and application of tc were performed across the period of 2007 to 2018 12 years 3 methods 3 1 standardized precipitation index spi as a widely applied and affirmed drought index spi mckee et al 1993 is employed for the assessment of spp drought utility the spi calculation is simple and only requires monthly precipitation data as input in particular the monthly precipitation records are initially fitted by a given skewed distribution e g log normal gamma or log logistic distribution for each calendar month followed by the determination of the corresponding frequencies based on the fitted distribution the frequencies are then converted to the corresponding quantiles of standard normal distribution which are just the spi values the spi can be calculated across several timescales by applying a moving average to the precipitation records and is thus able to reveal the accumulative effect of various drought types with different timescales according to zhong et al 2019 for drought monitoring in mainland china negative spi values indicate dry conditions spi values below 1 generally indicate drought disaster and the magnitudes of spi values reveal drought intensity this study selects the gamma distribution for spi calculation for all precipitation products because the gamma distribution is most widely used in the relevant studies on drought utility of spps alijanian et al 2019 brito et al 2021 sahoo et al 2015 santos et al 2021 zambrano et al 2017 the commonly used 1 3 6 and 12 month timescales of spi abbreviated as spi 1 spi 3 spi 6 and spi 12 are employed in this study in this study spis of pcdr chirps era5 and cpap were calculated for the complete period of 1983 to 2018 to include the long term records of pcdr and chirps restricted by the record length spis of sm2rain are calculated for the period of 2007 through 2018 this is expected to have no substantial influence on our results because the sm2rain is only used as a triplet to help assessing the pcdr and chirps and sahoo et al 2015 have found that the spis from short term records 10 years of recent years have little discrepancies with those from long term records over 30 years 3 2 the triple collocation approach tc stoffelen 1998 estimates the unbiased root mean square error ubrmse and correlation coefficient extended by mccoll et al 2014 based on an affine error model of geophysical variable measurements as follows 1 r i α i β i t ε i where r i denotes the measurements or estimates from triplet i i 1 2 3 t is the true value α i and β i are the linear regression coefficients representing the systematic error and ε i is the random error the covariance between each two triplets q ij can be determined as 2 q ij c o v r i r j β i β j σ t 2 β i c o v ε j t β j c o v ε i t α i e ε j α j e ε i c o v ε i ε j where c o v denotes the calculation of covariance e denotes the calculation of expectation tc relies on the following three mathematical assumptions 1 the random errors of each triplet have zero expectation e ε i 0 2 the random errors of each triplet are independent of the true value c o v ε j t 0 and 3 the random errors of each triplet are independent of each other c o v ε i ε j 0 when i j i e zero error cross correlation assumption by applying these assumptions eq 2 can be written as 3 q ij β i β i σ 2 t σ 2 ε i i j β i β j σ 2 t i j where σ 2 denotes the calculation of variance β i β j σ 2 t can be abbreviated by θ i θ j in which θ i is the internal variables that θ i β i σ 2 t the ubrmse of each triplet can be thus derived by solving eq 3 4 σ 2 ε 1 q 11 q 12 q 13 q 23 σ 2 ε 2 q 22 q 12 q 23 q 13 σ 2 ε 3 q 33 q 13 q 23 q 12 note that these ubrmse values do not follow the conventional ubrmse model they are the standardized deviation of the linear regression residuals between the estimated and true values mccoll et al 2014 extended the results of tc from the ubrmse to the correlation coefficient cc by deducing the mathematical relationship between the cc and the internal variables of tc 5 c c r i t c o v r i t σ 2 r i σ 2 t β i σ 2 t q ii σ 2 t β i σ 2 t q ii θ i q ii thus the cc equations are derived as 6 c c 1 q 12 q 13 q 11 q 23 c c 2 q 12 q 23 q 22 q 13 c c 3 q 13 q 23 q 33 q 12 where q ij 0 several studies have concluded the multiplicative error model to be more suitable for representing the error characteristics of precipitation estimates compared to the additive error model chen et al 2013 hossain and anagnostou 2006 based on this alemohammad et al 2015 proposed the mtc approach specifically for assessing precipitation products and demonstrated its superior performance compared to atc the multiplicative error model can be expressed as 7 r i a i t b i e i where a i and b i are the coefficients representing systematic bias and e i represents the random error let r i ln r i α i ln a i β i ln b i t i ln t i and ε i ln e i then eq 7 can be expressed in a similar form to eq 1 as 8 r i α i β i t ε i the procedure of conventional tc is applied on eq 8 therefore for the mtc the covariance between two triplets is calculated as 9 q ij c o v r i r j c o v ln r i ln r j as the ubrmse of mtc approach is expressed in the logarithmic scale and thus may be difficult to be interpreted alemohammad et al 2015 also provided an approach to convert approximately the log transformed ubrmses back to the linear scale 10 ubrmse r i r i u b r m s e r i where ubrmse r i is the converted ubrmse ubrms e r i is the log transformed ubrmse and r i is the mean value of the original data considering that li et al 2018a and massari et al 2017 draw different conclusions on whether mtc is superior to atc both mtc and atc are tested in the current study when assessing the accuracy of the precipitation datasets when assessing drought utility of spps only the atc is employed as the spis are normally distributed and contain negative values note that in the assessment of precipitation data zero precipitation can affect the application of mtc because it requires the log transformation of precipitation considering that zero precipitation is less common on a monthly scale in the assessment of precipitation data we removed the time steps individual months that exhibited at least one precipitation product with a zero precipitation record for each gridcell the gridcells with more than half of the time steps with zero precipitation mainly distributed in the nwc were eliminated from the assessment of monthly precipitation 19 5 of overall records and 94 gridcells 2 3 of all gridcells which are mainly distributed in northwest of china were removed two groups of triplets are carried out to assess the pcdr and chirps respectively group i consist of era5 sm2rain and pcdr group ii consist of era5 sm2rain and chirps 3 3 error metrics for the traditional assessment approach the cc and ubrmse are also employed as error metrics for the traditional assessment approach which is then compared with tc the cc for the traditional approach cc trad is determined as 11 cc trad c o v r i o i σ r i 2 σ o i 2 where r i and o i are the precipitation data series to be assessed and the precipitation observations series used as reference respectively note that the ubrmse of tc is based on the error model of eq 1 or eq 8 which can be expressed like the following form 12 ub rmse tc σ 2 ε i σ 2 r i α i β i t therefore the ub rmse tc is related to the residuals of the linear regression between r i and t instead of the conventional concept of ubrmse in order to ensure the consistency between the ubrmses of tc and the traditional approach the ubrmse for the traditional approach ub rmse trad is calculated in a similar form of eq 12 as follows 13 ub rmse trad σ 2 r i a b o i here a and b are the regression coefficients of the linear regression model of r i and o i 14 r i a b o i ε they are derived by fitting the linear regression model via the least square method 15 b r i r i o i o i o i o i 2 a r i b o i when comparing mtc with the traditional approach to ensure the comparability the input precipitation data were also processed by log transformation before calculating the cc trad and ubrmse trad note that here the ubrmse trad is firstly calculated from the logarithm of precipitation data via eq 13 and then transformed back to the linear scale via eq 10 so that maintain the comparability with the mtc results 4 results 4 1 validation of tc for monthly precipitation assessments we firstly validated tc for assessing the accuracy of the monthly precipitation estimation of the pcdr and chirps tc was executed for the 480 validation gridcells using each of the spps sm2rain and era5 as the triplets the ccs and ubrmses of pcdr and chirps were also calculated for these gridcells via the traditional approach with reference to the cpap data both atc and mtc were validated fig 3 compared the ccs and ubrmses derived from the tc and the traditional approach to evaluate the fitness quantitatively between results of tc and the traditional approach the mean values of the metrics and the spatial ccs between the metrics from both approaches were also calculated over the validation gridcells tables 1 and 2 the assessment results ccs and ubrmses derived from tc exhibit a high spatial consistency with the traditional approach over the validation gridcells with spatial ccs generally greater than 0 75 this indicates that tc can reveal the spatial pattern of spps accuracy consistent with the findings of massari et al 2017 mtc did not outperforms atc in revealing the cc patterns of spps accuracy for example for pcdr the spatial cc derived for mtc ccs is about 0 84 which does not show significant superiority to the atc one about 0 8 for chirps the mtc ccs even shows lower spatial correlation than the atc one fig 3 also demonstrates the similar performance of mtc with atc for assessing pcdr and lower performance of mtc than atc for assessing chirps these findings are different from li et al 2018 who suggested that mtc is more suitable for mainland china probably because they take the gauge data as input for tc and as the benchmark to validate tc as well which might cause less reliable validation results note that both the atc and mtc approaches tend to overestimate the accuracy of the spps relative to the traditional approach more specifically the mean ccs for pcdr and chirps are overestimated by about 0 02 0 07 while the ubrmses are overestimated on average by nearly 6 15 mm month relative to traditional approach additionally mtc shows severer overestimation of spps accuracy than atc these overestimations are evident in fig 3 as the scatter points present deviations from the 1 1 line the deviations of the tc results to the traditional approach over gauged gridcells also appeared in massari et al 2017 biased tc results due to non zero eccs between the triplets and the poor reliability of traditional approach due to low quality of reference data are the two main reasons causing the deviations since the validation of tc was performed for the validation gridcells containing multiple gauges fig 2 the cpap should have acceptable high quality to close to true precipitation for these gridcells thus the results of traditional approach should be reliable hence the biased tc results caused by eccs between the triplets massari et al 2017 li et al 2018 might be the primary reason of these deviations instead of the quality of the reference data these results indicate that although tc can retrieve the spatial pattern of spps accuracy the bias of tc might need attentions in quantitative estimation of the spps accuracy magnitude to further investigate the performance of tc in estimating the spp accuracy pattern the spatial distribution of the ccs and ubrmses from the traditional approach and tc for the 480 validation gridcells are presented in figs 4 and 5 respectively with the left and middle columns showing the accuracy metrics of the traditional approach and tc respectively while the right column showing the differences between the traditional and tc based accuracy metrics it can be found that tc generally demonstrates an overestimated accuracy relative to the traditional approach and even shows abnormal cc values 1 but even so the ccs and ubrmses derived from tc exhibit similar spatial patterns with those based on the traditional approach for atc the ccs and ubrmses of tc generally show overall deviations from the traditional approach but the deviations are generally distributed evenly with low spatial variation while for mtc the deviations between tc and the traditional approach show apparent spatial variation affecting the spatial correlation between tc results and traditional approach results above all the atc approach presents more acceptable reliability in assessing the accuracy of spps over mainland china and can retrieve the spatial relationship of the spps accuracy based on the observed greater reliability of the atc compared with the mtc the atc approach is used to assess the spp monthly precipitation estimations in this study 4 2 spp accuracy assessment using tc figure 6 presents the assessment results of the two spps including the ccs and the ubrmses based on the traditional left column and tc right column approaches respectively white areas in fig 6 denote the gridcells excluded from the assessment due to more than half of the time steps with zero precipitation see section 3 2 note that here the traditional approach is employed for all gridcells over mainland china including the ungauged gridcells and the cpap data would not necessarily exhibit a high reliability over the ungauged gridcells hence the traditional approach is employed just for comparison despite the general overestimation of spps accuracy and the abnormal cc values 1 by tc tc results exhibit a similar spatial trend in terms of the cc and ubrmse values for both pcdr and chirps with the traditional approach over eastern china where cpap has denser gauge networks both spps demonstrate high ccs over 0 9 in most areas note that due to greater precipitation amount the spps exhibit high ubrmses in southeastern china via tc this further highlights the significance of including cc for tc mccoll et al 2014 in spp assessments as using only the ubrmse is not effective in describing the spatial characteristics of the spps the relatively abundant precipitation in the monsoon area less complicated terrain and the denser in situ observations used for correcting the spps are generally considered as the principal reasons of the high accuracy of pcdr and chirps in eastern china bai et al 2020 bai et al 2019 guo et al 2016 zhong et al 2019 in western china where cpap gauges are sparse thereareapparentdiscrepanciesbetween tc and the traditionalapproach tc demonstrates high ccs for both pcdr and chirps in several western china boundary regions such as west tp and north gxr on the contrary the traditional approach shows much poorer accuracy of the spps in these regions the cpap data as the reference for the traditional approach contain very sparse gauges and even no gauges in these regions as a result the cpap data exhibit large interpolation errors and less reliability and thus underestimate the accuracy of spps for these regions therefore the tc would be relatively more reliable to assess spps both approaches demonstrate poor performance of the two spps over the kunlun mountain northwestern boundary of tp a remote area with very complex terrains where spps are generally associated with low accuracies li et al 2018 above all both pcdr and chirps can accurately estimate monthly precipitation over eastern china the two spps also depict an acceptable accuracy over many regions in western china which may be underestimated in previous studies bai et al 2020 zhong et al 2019 due to the sparse gauges of the reference data for assessment 4 3 validation of tc for drought utility assessments the spis with timescales of 1 3 6 and 12 months were calculated by using the pcdr chirps as well as the sm2rain and era5 the time series of the spis are illustrated in figs s1 to s4 in the supplementary information by using spatial averaging for the nine subregions of mainland china tc was then applied to estimate the cc values of the spis based on the two spps for each validation gridcell and the ccs represent the drought utility of the spps similarly the spis were also calculated by using cpap data and the ccs between the spis of spps and cpap on each validation gridcell were employed as the references to validate the ccs from tc results are shown in table 3 table 4 and fig 7 results show that tc can reflect the pattern of drought utility of spps but not as good as in the assessment of precipitation estimations for spi 1 the spatial ccs between the ccs from tc and the traditional approach are acceptable approximately 0 71 for pcdr and 0 59 for chirps for short timescale spis tc is still able to capture the spatial pattern of spp drought utility however for longer timescales spis the spatial correlations of the ccs based on tc and the traditional approach are lower particularly for the spi 12 with a spatial cc of just 0 53 to 0 45 therefore tc may be less suitable for the assessment of drought indices at longer timescales fig 7 also illustrates the weak correlation between tc and the traditional approach for assessments of spi 12 additionally tc also overestimated the drought utility of the spps systematically as the tc based ccs exhibit higher mean values than those of the traditional approach for all spis and even shows abnormal high cc values over 1 not shown in the range of fig 7 figures 8 and 9 present the differences in the spp drought utility determined by tc and the traditional approach for spi 1 and spi 3 the two approaches exhibit similar spatial patterns for the spp drought utility the pcdr and chirps perform better in most regions of eastern china but a poorer performance in the midwest particularly the sichuan basin in middle swc the discrepancies between tc and the traditional approach are larger for areas associated with poorer performance than areas with better performance since the gauge networks have higher density in eastern china fig 2b the cpap should have more reliable quality to represent the true spi values and serve as validation reference for eastern china thus the discrepancies between the two approaches might be also related to the influence of non zero ecc on tc the more frequent abnormal high cc values over 1 produced by tc also support this this may indicate that tc is relatively weak in evaluating drought utility of spps moreover figs 8 and 9 also reveal that for spis with longer timescales particularly spi 12 both tc and the traditional approach exhibit high spatial heterogeneity in the spatial pattern of spp drought utility consequently increasing the difficulty for tc to capture the spatial pattern of spp drought utility thereby resulting in the poorer spatial correlation of the tc results with the traditional approach to investigate the reason causing the different performance of tc in assessing precipitation data and calculated spis in different timescales a quantitative analysis was performed for the magnitude of ecc term represented by c o v ε i ε j in eq 2 relative to the covariance between the triplets q ij in this analysis we calculated the c o v ε i ε j by assuming the cpap data is the precipitation truth results are shown in fig s5 in the supplementary information along with the details of calculation for the monthly precipitation inputs the analysis shows that the c o v ε i ε j is relatively low as the ratio with q ij is generally below 0 3 but for the calculated spis ecc shows much higher magnitude with the ratio of c o v ε i ε j and q ij up to 0 8 as the result tc performs better in assessing the precipitation data than assessing the spis of spps this might be due to that the seasonal variation of the precipitation is smoothed out in spi subsequently the random errors in the spps might appear relatively larger magnitude compared with the reduced variation of precipitation and thereby the ecc becomes more apparent relative to the covariation between triplets ultimately causing the less reliable assessment results of tc for the spis with longer timescales spi 6 and spi 12 besides the increased magnitude of ecc the ratio of c o v ε i ε j and q ij also shows apparently higher spatial heterogeneity causing the more complicated spatial pattern of differences between results of tc and the traditional approach figs 8 and 9 which might consequently cause the much lower spatial correlation between the ccs of the two approaches for the spis of longer timescale likewise the corresponding ecc among the spps represented by c o v ε i ε j in eq 2 might present larger magnitude relative to the reduced variation of the precipitation inputs ultimately increasing the deviation between tc and traditional approach although systematic bias is observed in the tc results it is still able to retrieve the spatial relationship of the spp drought performance qualitatively for spi 1 and spi 3 as tc exhibits a relatively weak performance in assessing the drought utility of long term spis the tc assessment results of spi 6 and spi 12 are not the focus of the subsequent analyses 4 4 spp based drought utility assessments using tc figures 10 and 11 present the assessment results of tc for the drought utility of pcdr and chirps respectively the traditional approach was also employed by using the cpap as assessment reference for comparisons with tc the pcdr based spi 1 and spi 3 are associated with similar spatial patterns via tc for both spp drought performances compared to the traditional approach over dense gauge network areas both approaches exhibited higher ccs for pcdr across most areas in eastern china and poorer drought utility for areas surrounding the sichuan basin where the topography varies drastically similar spatial patterns are also observed by related studies bai et al 2020 guo et al 2016 zhong et al 2019 however tc still systematically overestimates the results and the abnormal high cc values 1 are also shown likewise we suggest that these deviations of tc results in eastern china is primarily caused by ecc between triplets while in western china where cpap covers gauges sparsely distributed like tp tc and the traditional approach show apparent discrepancies in spps drought utility different from eastern china this phenomenon in western china is more likely due to the poor quality of cpap resulted from the sparse local gauge network fig 2b as the result the cpap based spis have larger deviation from the tc suggested truth over these areas since tc provides the performance with respect to the truth tc is expected to obtain better scores than what the results showed thus is more reliable when the reference is affected by severe error this phenomenon is particularly evident for areas where gauge based precipitation data are less representative e g tp with highly complex terrain and sparse gauges above all our results demonstrate the spatial trends in drought utility of the two spps over mainland china including tp where gauges are sparse by using tc we also identify a potential factor that might influence the quantitative assessment ability of tc for spps drought utility i e the systematic bias in the tc assessment results which might need attention in the practices of tc 5 discussion 5 1 uncertainties in tc among different triplets several studies have demonstrated that the different combination of triplets for tc may influence the results of each triplet alemohammad et al 2015 li et al 2018 mccoll et al 2014 massari et al 2017 therefore we compared the results of tc for the sm2rain and era5 datasets under different triplet combinations to evaluate the corresponding uncertainties fig 12 depicts the ccs of the monthly precipitation and spi 1 derived via sm2rain and era5 we employed the triplets i left column triplets ii middle column as well as the results of the traditional approach using cpap data right column for reference purposes the spatial patterns in ccs between the different triplets determined by sm2rain and era5 are qualitatively similar revealing that the uncertainty among different triplets does not have a substantial effect on our results which is similar to the findings of sun et al 2021 like the results of pcdr and chirps the tc also systematically overestimates the accuracy of both sm2rain and era5 for eastern china with dense gauge networks yet the accuracy patterns of the both products for the two triplets are also consistent with the traditional approach for densely gauge areas except the pattern of era5 precipitation for northeastern china these results reveal the stability of the tc regardless of which spp is selected as the triplets 5 2 limitation of tc numerous studies have demonstrated the application of tc for variables which are difficult to be in situ measured such as precipitation and soil moisture chen et al 2021 li et al 2018 van dijk et al 2014 wu et al 2019 yilmaz and crow 2014 compared with the former studies this study further evaluated the reliability of tc in assessing the drought utility of the spps by using spi although our results reveal the superiority of tc for ungauged areas we identified some disadvantages of tc to apply the results to regions beyond china it is necessary to interpret the meanings of tc results based on our findings our results indicate the ability of tc in retrieving spatial pattern in the accuracy of precipitation data of spps moreover tc is less reliable but still acceptable for short timescale drought indices however tc is unable to assess the long timescale drought indices effectively similar to the findings of massari et al 2017 tc demonstrates apparent systematic deviations for assessing spps accuracy comparing with the results of cpap based traditional approach for western china where cpap gauges are sparse these deviations might be primarily caused by the underestimation of spps accuracy by the traditional approach due to the poor quality of the reference data chen et al 2021 li et al 2018 since tc provides the accuracy with respect to the truth the performance of tc would be underestimated when the reference data are less reliable however for eastern china this finding also appears even though the reference gauge networks of cpap are dense and the number of observations is stable over time in eastern china fig 2 moreover abnormal high cc values 1 also shown in many cases of tc results this indicates the systematic bias in tc results which is an important disadvantage of tc the non zero ecc might be the primary cause which is widely observed and regarded as the main bottleneck of tc chen et al 2021 li et al 2018 yilmaz and crow 2014 zhang et al 2021 it should be noted that the cpap data cannot perfectly represent the truth of precipitation because the density of 2 gauges for a 0 5 gridcell is still inadequate to eliminate the potential error in the assessment even for monthly timescale therefore the bias of tc based assessment shown in our results might be potentially overestimated even so the potential error of cpap data under the current gauge density and monthly timescale might be limited tang et al 2018 thus the deviation between tc and the traditional approach is less likely to be entirely caused by the error of cpap therefore cpap should be still adequate to reveal the inherent systematic bias of tc based assessment together with the phenomenon of abnormal high cc values over 1 for tc results we suggest that attention should be paid to the inherent systematic bias of tc caused by the non zero ecc to reduce the potential influence of ecc this study introduced the sm2rain as a tc triplet for assessing the spps which is mainly based on independent mechanism and data source soil moisture from ascat this avoids the potential problem of taking gauge data as a triplet as it might cause ecc due to the overlapping gauges for correcting the spps nevertheless sm2rain also introduced several auxiliary datasets such as the era5 rainfall products used for calibrating the sm2rain algorithm brocca et al 2019 which might cause potential ecc with era5 thereby affect the tc results moreover era5 also used several satellite based microwave bright temperature data as input although pcdr and chirps are mainly based on ir data the microwave bright temperature data adopted by era5 might be also involved in the two spps e g in the gpcp that used for correcting pcdr as the results potential ecc between era5 and the spps is also not negligible for tc especially when assessing the spps mainly based on pmw data chen et al 2021 have evaluated the eccs between sm2rain era5 and a pmw based spp and pointed out the non negligible eccs between sm2rain and era5 further systematic analyses for the eccs might be conducted in future works when data from the adequately dense gauge network are available potential of tc in assessing the spps has been investigated in previous former studies li et al 2018 massari et al 2017 nevertheless these studies are generally inclined to apply tc directly while the disadvantages of tc are seldom mentioned in this study we not only point out the advantages of tc as an observation free approach but also identified the systematic bias in tc results which might need attention in the quantitative assessment by tc by comparing with the previous studies our findings also reveal the potential risk of solely using tc in assessing the accuracy and drought utility of spps and indicate that tc cannot fully replace the traditional approach in practical applications taking tc as a supplement for the traditional approach might be also a feasible scheme for some cases the correlation between the tc and traditional gauge assessed approaches is high indicating the potentiality to correct the tc results with the help of traditional approach over the gauged gridcells this might improve the ability of tc to assess datasets quantitatively and is therefore a potential solution for areas with sparse but reliable gauge observations in addition restricted by the limited functions of tc which currently can only estimate the cc and ubrmse more comprehensive assessment on drought utility of spps such as the ability of drought condition classification is not performed further development of tc such as the categorical tc mccoll et al 2016 might extend the assessment of spps drought utility for this aspect nevertheless we suggest that our assessment results of ccs of spp based spis are valuable and representative as we can find from former studies jiang et al 2021 zhong et al 2019 that the patterns of other aspects of drought utility such as the drought event classification ability are close to the cc patterns of drought indices 6 conclusions the potential of spp in drought monitoring over ungauged areas is difficult to be assessed in conventional way in this study we investigated the reliability of tc in assessing the accuracy and drought utility for two long term spps using spi furthermore tc was employed experimentally to evaluate the spps over mainland china the following key conclusions were reached tc is effective in retrieving the spatial pattern of the spp accuracy and drought utility for short timescale drought indices over mainland china however the tc results also exhibit a systematic bias relative to the gauge assessed results and even show abnormal high cc values 1 moreover tc is difficult to assess long timescale drought indices effectively the tc results reveal the potential underestimation of spp accuracy by the traditional approach in some ungauged areas furthermore tc exhibits a similar spatial pattern in spp drought performance to the traditional approach over densely gauged areas however large discrepancies are found between the tc and the traditional gauge assessed approaches over some gauged areas with complex terrain this may indicate the relatively poor ability of tc in assessing drought indices for these areas in summary tc demonstrates superiority in qualitatively assessing the accuracy and drought utility of spps over ungauged and poorly gauged areas however the systematic bias in tc results is also apparent although the cpap might overestimate the systematic bias of tc results to some extent attention is suggested to paid to the bias of tc in practices moreover as only cc and ubrmse can be estimated this study only examines tc in assessing the correlation of spis potential future research may be focused on how to improve tc by reducing the impact of restricting factors as well as how to expand tc for assessing additional metrics and drought utility of spps declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was financially supported by the natural science foundation of guangdong province china grant no 2021a1515010558 the national key r d program of china 2017yfc0405900 the national natural science foundation of china grant nos 51509040 5171101598 51979043 and 51709127 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127098 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3949,satellite based precipitation products spp have been the focus of much attention for their potential utility of drought monitoring and analysis assessing the accuracy and drought performance of the spps for ungauged areas is urgent and also challenging this study comprehensively investigated the performance of the triple collocation tc approach an assessment approach requiring no benchmark data the accuracy and drought utility assessment of the spps furthermore we applied the tc approach experimentally to the spps throughout mainland china the china monthly precipitation analysis product cpap a gridded gauge based precipitation dataset was employed to validate the tc approach results demonstrate the effectiveness of the tc approach in retrieving spatial patterns in the accuracy and drought performance via short timescale drought indices of the spps but systematic bias was observed moreover the tc approach exhibits a weak performance in assessing the long timescale drought indices by comparing the assessment results the tc approach reveals the potential underestimation of the spp accuracy by the traditional assessment approach for some ungauged regions in general the proposed tc outperforms the traditional approach in qualitatively assessing the performance pattern of spps over ungauged and poorly gauged areas but the systematic bias of tc needs attention when quantitatively determining spp performance keywords satellite based precipitation product accuracy assessment drought utility triple collocation approach standardized precipitation index mainland china 1 introduction drought is a critical natural disaster that can cause considerable socioeconomic losses dai 2013 wang et al 2018 li et al 2020 under the influence of climate change and global warming the severity and frequency of drought hazards have been intensified in the past decades ipcc 2013 wang et al 2018 therefore the development of comprehensive drought monitoring framework has been the focal point of many researchers drought indices such as the standardized precipitation index spi are fundamental for the quantification of drought conditions bai et al 2020 guo et al 2016 sahoo et al 2015 precipitation is a key input for most drought indices with data conventionally derived from ground based observations however due to the restriction of local terrain and the environment gauge based precipitation data are sparsely distributed and even unavailable in some remote and undeveloped regions wang et al 2017 the accurate estimation of precipitation via interpolation in these regions is difficult due to the high heterogeneity of precipitation bai et al 2019 wu et al 2018 researchers have also pointed out that sparse gauge density can influence the spatial representativeness of precipitation resulting in lower reliability of drought index bai et al 2019 trenberth et al 2014 satellite based precipitation data products generally have a wide coverage and consistent spatial resolution compared to gauge data and have thus proven effective in drought monitoring widely used satellite based precipitation products spps include the precipitation estimation from remotely sensed information using artificial neural networks persiann hsu et al 1997 the persiann climate data records persiann cdr ashouri et al 2014 and the climate hazards group infrared precipitation with stations chirps funk et al 2015 which are principally based on infrared ir data the climate prediction center cpc morphing technique cmorph joyce et al 2004 and the global satellite mapping of precipitation gsmap kubota et al 2020 which are mainly based on passive microwave pmw data and the tropical rainfall measuring mission multi satellite precipitation analysis tmpa huffman et al 2007 and integrated multi satellite retrievals for global precipitation measurement imerg huffman et al 2019 which incorporate ir pmw and active precipitation radar data with their wide spatial coverage and high spatial resolution these spps have provided precipitation estimations for many ungauged areas and are widely applied in the field of hydrology and water resources including drought analysis and monitoring gao et al 2017 guo et al 2016 lai et al 2019 sahoo et al 2015 tang et al 2018 wang et al 2017 zambrano et al 2017 zhong et al 2019 at present the key bottlenecks of spps for drought monitoring are the relatively lower accuracy and the greater uncertainty of spps than in situ observations bai et al 2019 therefore assessing the quality of spps before applying is crucial many studies have been performed in the past decades in order to directly assess the spps accuracy spps performance in hydrological modeling and the ability to reveal extreme precipitation events etc tang et al 2018 tang et al 2020 tang et al 2016 wang et al 2017 yong et al 2014 zambrano et al 2017 in these studies the gauge based data are commonly used as benchmarks to assess spps and thus the results largely depend on the density and quality of the used gauge data tang et al 2018 most researches were focused on areas with dense gauge networks while spps performances in the areas with sparse gauges or ungauged areas remain unclear li et al 2018 the triple collocation tc approach stoffelen 1998 is based on the statistical relationships between the errors of multiple independent estimates and can objectively estimate the accuracy of three independent data products when the true values are unavailable this approach can assess the accuracy of spps over ungauged areas tc are widely adopted for the assessments of some multi source geophysical data such as wind speed soil moisture and total water storage chen et al 2018 mccoll et al 2014 van dijk et al 2014 yilmaz and crow 2014 yuan et al 2020 recently this approach has also been applied to evaluate several gridded precipitation products e g weather radar data and spps across the globe li et al 2018 roebeling et al 2012 wu et al 2019 considering that a multiplicative error model is more suitable for precipitation data compared to an additive one alemohammad et al 2015 proposed the multiplicative tc mtc approach to evaluate several gridded precipitation estimation products in the united states they found mtc to be more suitable for the assessment of precipitation products than the additive tc atc approach li et al 2018a evaluated the capability of tc for assessing spps over the mainland china using a dense gauge network and concluded the mtc to be more suitable than atc over the region massari et al 2017 evaluated tc in assessing three spps over the continental united states but found that mtc does not necessarily outperform atc tang et al 2020 firstly used tc to assess snowfall estimation of the spps reanalysis and gauge based datasets chen et al 2021 evaluated the error cross correlation ecc between spps and reanalysis using the quadruple collocation an approach developed based on tc however the aforementioned studies did not investigate the use of tc in assessing the drought utility of spps this is particularly meaningful for ungauged areas in this context by taking mainland china as the study area the objectives of this study are 1 to validate the capability of tc in assessing the accuracy of spps 2 to validate the capability of tc in assessing the drought utility of the spps 3 to assess the accuracy of two selected long term spps using tc and 4 to assess the drought utility of the spps using tc the persiann cdr and chirps products were selected as the spps both of which have long term records of over 30 years and are thus suitable for drought analysis and monitoring a soil moisture based spp with different estimation mechanism namely sm2rain ascat and the latest reanalysis product of the european center for medium range weather forecast ecmwf namely era5 were selected as the remaining triplets along with the spps for tc this study is expected to advance the understanding of the applicability of tc and to provide reference for assessing the drought utility of precipitation data products and drought monitoring by using spps for ungauged regions 2 study area and data 2 1 study area the study area mainland china fig 1 is located in the east of eurasia and exhibits various topography and climate conditions the eastern and southeastern regions of mainland china with generally flat and hilly terrain are adjacent to northwestern pacific and are dominated by the humid subtropical and temperate monsoon climates the northwest of mainland china which features alpine plateau and basin terrain is dominated by the arid and semi arid temperate continental climate the southwestern region of mainland china is primarily located in the tibetan plateau the highest plateau in the world and thus is mainly dominated by a cold and arid plateau climate the precipitation in mainland china is high in the southeast up to 2 000 mm per year and low in the northwest below 200 mm per year according to relevant studies bai et al 2019 zhong et al 2019 mainland china can be divided into nine subregions northeast china nec the huang huai hai region hhh the inner mongolia im the loess plateau lp the middle and lower regions of the yangtze river yr southwest china swc south china sc the gansu xinjiang region gxr and the tibetan plateau tp these subregions are divided according to the local terrain land cover and climate 2 2 persiann cdr the persiann cdr hereafter referred to as pcdr ashouri et al 2014 is a long term spp developed by the center for hydrometeorology and remote sensing university of california irvine the product has long term records that started from 1983 total of 36 years until 2018 a wide spatial coverage from 60 s to 60 n and a high spatial resolution of 0 25 pcdr is designed to provide long term high resolution precipitation data to meet the requirements of global climate studies pcdr is generated from the multi source gridded satellite ir dataset gridsat b1 processed by an artificial neural network trained by the stage iv radar based precipitation data the low resolution 2 5 2 5 long term monthly gridded precipitation data product called global precipitation climatology project gpcp adler et al 2003 is subsequently applied to correct the bias of the raw pcdr data the pcdr product used in this study was downloaded from the data portal of the center for hydrometeorology and remote sensing http chrsdata eng uci edu 2 3 chirps the chirps product funk et al 2015 is developed by the climate hazards group for drought analysis and monitoring this product employs long term precipitation records since 1981 with a spatial coverage among 50 s to 50 n land only and a high spatial resolution of 0 05 the chirps precipitation data is initially estimated via the cold cloud duration data from two global geosynchronous thermal infrared archives the globally gridded satellite grisat archive from the national climate data center and the climate prediction center thermal infrared dataset the raw precipitation estimates are then bias corrected using the pentadal monthly climate hazards group precipitation climatology chpclim data and subsequently merged with ground based observations to form the chirps dataset funk et al 2015 in this study the monthly chirps dataset was obtained from the climate hazards group website http chg geog ucsb edu data chirps 2 4 additional datasets for tc tc requires three independent estimates of precipitation therefore in addition to individual spps two additional datasets are required following massari et al 2017 this study adopted the sm2rain a bottom up spp from soil moisture remote sensing and a model based reanalysis dataset as the other two triplets 2 4 1 sm2rain ascat sm2rain ascat brocca et al 2019 is a high resolution semi global scale spp that is based on a bottom up approach sm2rain ascat is based on the sm2rain algorithm brocca et al 2014 which retrieves precipitation inversely from the soil moisture data from satellite remote sensing via a soil water balance equation therefore the sm2rain ascat product has relatively independent mechanism to the conventional spps and is suitable to be considered as a tc triplet the adopted soil moisture data for sm2rain ascat is retrieved from the advanced scatterometer ascat a real aperture radar instrument onboard the metop satellite which presently is rarely used for other precipitation datasets sm2rain ascat also has been used as tc triplet to assess other spps for its independent data source and mechanism chen et al 2021 brocca et al 2019 massari et al 2017 the sm2rain ascat data has a spatial resolution of about 12 5 km and a temporal resolution of 1 day and provides precipitation data from june 2007 to present in this study the sm2rain ascat data over mainland china from 2007 to 2018 12 years are used to keep concise hereafter the sm2rain ascat is represented by the abbreviation sm2rain 2 4 2 reanalysis precipitation product era5 fifth generation ecmwf reanalysis is the latest generation of the global atmospheric reanalysis product developed by the ecmwf hersbach et al 2020 the era5 product provides various meteorological assimilation data including precipitation from 1979 to present this product is based on the four dimensional variational analysis on the latest version of the ecmwf integrated forecasting system ifs cycle 41r2 which has several added features specifically for reanalysis the era5 has many improvements relative to its predecessor the era interim including a higher spatiotemporal resolution 0 25 and 1 hourly and an improved variational bias scheme hersbach et al 2020 the reliability of era5 precipitation data has also been verified in some studies tang et al 2020 the monthly era5 precipitation data was obtained from the copernicus climate change service website https doi org 10 24381 cds f17050d7 2 5 precipitation observation for validations and comparisons the china monthly precipitation analysis product cpap produced by the china meteorological administration cma is a gauge based interpolated precipitation product over mainland china with a spatial resolution of 0 5 the cpap was used as the reference dataset for evaluating tc the cpap is interpolated by monthly precipitation observations from more than 2 400 gauges in mainland china by using a terrain based thin plate spline interpolation approach this product is of high quality and reliability over areas with dense gauge networks e g eastern mainland china and has been widely used to evaluate the accuracy and drought utility of different spps bai et al 2020 bai et al 2019 guo et al 2016 however the cpap gauge networks are highly sparse in western china fig 2 b particularly for northwestern tp which largely hinders the evaluation of spps over these areas the two key roles of the cpap dataset in this study are described as follows 1 validating tc performance i e the capability and reliability of tc in assessing the accuracy and drought performance of spps for this purpose the cpap data were used to represent the true value to assess the spps directly by extending the error function of gauge observations established by tang et al 2018 we found that for monthly precipitation data at least two gauges are necessary for the 0 5 gridcell to ensure that the assessed correlation coefficients have a small error level about 5 therefore only the 0 5 gridcells containing at least two gauges were selected a total of 480 cpap gridcells were ultimately selected and were designated as validation gridcells to validate tc fig 2a shows the locations of validation gridcells and the observation rates ratios between number of valid gauge records to all time steps of all gauges of the validation gridcells during 1983 to 2018 the months with valid gauge records occupy over 99 of the entire period for all validation gridcells hence the gauge number has little temporal variation and should have little influence on the validations via cpap 2 acting as the traditional spp assessment approach i e directly calculating the accuracy metrics between cpap and spps for the purpose of comparing with tc all cpap gridcells were adopted for this purpose following previous studies bai et al 2020 guo et al 2016 zhong et al 2019 both of the spps and the era5 data were spatially averaged to 0 5 spatial resolution to match with the cpap data considering the temporal extent of the adopted precipitation datasets the validation and application of tc were performed across the period of 2007 to 2018 12 years 3 methods 3 1 standardized precipitation index spi as a widely applied and affirmed drought index spi mckee et al 1993 is employed for the assessment of spp drought utility the spi calculation is simple and only requires monthly precipitation data as input in particular the monthly precipitation records are initially fitted by a given skewed distribution e g log normal gamma or log logistic distribution for each calendar month followed by the determination of the corresponding frequencies based on the fitted distribution the frequencies are then converted to the corresponding quantiles of standard normal distribution which are just the spi values the spi can be calculated across several timescales by applying a moving average to the precipitation records and is thus able to reveal the accumulative effect of various drought types with different timescales according to zhong et al 2019 for drought monitoring in mainland china negative spi values indicate dry conditions spi values below 1 generally indicate drought disaster and the magnitudes of spi values reveal drought intensity this study selects the gamma distribution for spi calculation for all precipitation products because the gamma distribution is most widely used in the relevant studies on drought utility of spps alijanian et al 2019 brito et al 2021 sahoo et al 2015 santos et al 2021 zambrano et al 2017 the commonly used 1 3 6 and 12 month timescales of spi abbreviated as spi 1 spi 3 spi 6 and spi 12 are employed in this study in this study spis of pcdr chirps era5 and cpap were calculated for the complete period of 1983 to 2018 to include the long term records of pcdr and chirps restricted by the record length spis of sm2rain are calculated for the period of 2007 through 2018 this is expected to have no substantial influence on our results because the sm2rain is only used as a triplet to help assessing the pcdr and chirps and sahoo et al 2015 have found that the spis from short term records 10 years of recent years have little discrepancies with those from long term records over 30 years 3 2 the triple collocation approach tc stoffelen 1998 estimates the unbiased root mean square error ubrmse and correlation coefficient extended by mccoll et al 2014 based on an affine error model of geophysical variable measurements as follows 1 r i α i β i t ε i where r i denotes the measurements or estimates from triplet i i 1 2 3 t is the true value α i and β i are the linear regression coefficients representing the systematic error and ε i is the random error the covariance between each two triplets q ij can be determined as 2 q ij c o v r i r j β i β j σ t 2 β i c o v ε j t β j c o v ε i t α i e ε j α j e ε i c o v ε i ε j where c o v denotes the calculation of covariance e denotes the calculation of expectation tc relies on the following three mathematical assumptions 1 the random errors of each triplet have zero expectation e ε i 0 2 the random errors of each triplet are independent of the true value c o v ε j t 0 and 3 the random errors of each triplet are independent of each other c o v ε i ε j 0 when i j i e zero error cross correlation assumption by applying these assumptions eq 2 can be written as 3 q ij β i β i σ 2 t σ 2 ε i i j β i β j σ 2 t i j where σ 2 denotes the calculation of variance β i β j σ 2 t can be abbreviated by θ i θ j in which θ i is the internal variables that θ i β i σ 2 t the ubrmse of each triplet can be thus derived by solving eq 3 4 σ 2 ε 1 q 11 q 12 q 13 q 23 σ 2 ε 2 q 22 q 12 q 23 q 13 σ 2 ε 3 q 33 q 13 q 23 q 12 note that these ubrmse values do not follow the conventional ubrmse model they are the standardized deviation of the linear regression residuals between the estimated and true values mccoll et al 2014 extended the results of tc from the ubrmse to the correlation coefficient cc by deducing the mathematical relationship between the cc and the internal variables of tc 5 c c r i t c o v r i t σ 2 r i σ 2 t β i σ 2 t q ii σ 2 t β i σ 2 t q ii θ i q ii thus the cc equations are derived as 6 c c 1 q 12 q 13 q 11 q 23 c c 2 q 12 q 23 q 22 q 13 c c 3 q 13 q 23 q 33 q 12 where q ij 0 several studies have concluded the multiplicative error model to be more suitable for representing the error characteristics of precipitation estimates compared to the additive error model chen et al 2013 hossain and anagnostou 2006 based on this alemohammad et al 2015 proposed the mtc approach specifically for assessing precipitation products and demonstrated its superior performance compared to atc the multiplicative error model can be expressed as 7 r i a i t b i e i where a i and b i are the coefficients representing systematic bias and e i represents the random error let r i ln r i α i ln a i β i ln b i t i ln t i and ε i ln e i then eq 7 can be expressed in a similar form to eq 1 as 8 r i α i β i t ε i the procedure of conventional tc is applied on eq 8 therefore for the mtc the covariance between two triplets is calculated as 9 q ij c o v r i r j c o v ln r i ln r j as the ubrmse of mtc approach is expressed in the logarithmic scale and thus may be difficult to be interpreted alemohammad et al 2015 also provided an approach to convert approximately the log transformed ubrmses back to the linear scale 10 ubrmse r i r i u b r m s e r i where ubrmse r i is the converted ubrmse ubrms e r i is the log transformed ubrmse and r i is the mean value of the original data considering that li et al 2018a and massari et al 2017 draw different conclusions on whether mtc is superior to atc both mtc and atc are tested in the current study when assessing the accuracy of the precipitation datasets when assessing drought utility of spps only the atc is employed as the spis are normally distributed and contain negative values note that in the assessment of precipitation data zero precipitation can affect the application of mtc because it requires the log transformation of precipitation considering that zero precipitation is less common on a monthly scale in the assessment of precipitation data we removed the time steps individual months that exhibited at least one precipitation product with a zero precipitation record for each gridcell the gridcells with more than half of the time steps with zero precipitation mainly distributed in the nwc were eliminated from the assessment of monthly precipitation 19 5 of overall records and 94 gridcells 2 3 of all gridcells which are mainly distributed in northwest of china were removed two groups of triplets are carried out to assess the pcdr and chirps respectively group i consist of era5 sm2rain and pcdr group ii consist of era5 sm2rain and chirps 3 3 error metrics for the traditional assessment approach the cc and ubrmse are also employed as error metrics for the traditional assessment approach which is then compared with tc the cc for the traditional approach cc trad is determined as 11 cc trad c o v r i o i σ r i 2 σ o i 2 where r i and o i are the precipitation data series to be assessed and the precipitation observations series used as reference respectively note that the ubrmse of tc is based on the error model of eq 1 or eq 8 which can be expressed like the following form 12 ub rmse tc σ 2 ε i σ 2 r i α i β i t therefore the ub rmse tc is related to the residuals of the linear regression between r i and t instead of the conventional concept of ubrmse in order to ensure the consistency between the ubrmses of tc and the traditional approach the ubrmse for the traditional approach ub rmse trad is calculated in a similar form of eq 12 as follows 13 ub rmse trad σ 2 r i a b o i here a and b are the regression coefficients of the linear regression model of r i and o i 14 r i a b o i ε they are derived by fitting the linear regression model via the least square method 15 b r i r i o i o i o i o i 2 a r i b o i when comparing mtc with the traditional approach to ensure the comparability the input precipitation data were also processed by log transformation before calculating the cc trad and ubrmse trad note that here the ubrmse trad is firstly calculated from the logarithm of precipitation data via eq 13 and then transformed back to the linear scale via eq 10 so that maintain the comparability with the mtc results 4 results 4 1 validation of tc for monthly precipitation assessments we firstly validated tc for assessing the accuracy of the monthly precipitation estimation of the pcdr and chirps tc was executed for the 480 validation gridcells using each of the spps sm2rain and era5 as the triplets the ccs and ubrmses of pcdr and chirps were also calculated for these gridcells via the traditional approach with reference to the cpap data both atc and mtc were validated fig 3 compared the ccs and ubrmses derived from the tc and the traditional approach to evaluate the fitness quantitatively between results of tc and the traditional approach the mean values of the metrics and the spatial ccs between the metrics from both approaches were also calculated over the validation gridcells tables 1 and 2 the assessment results ccs and ubrmses derived from tc exhibit a high spatial consistency with the traditional approach over the validation gridcells with spatial ccs generally greater than 0 75 this indicates that tc can reveal the spatial pattern of spps accuracy consistent with the findings of massari et al 2017 mtc did not outperforms atc in revealing the cc patterns of spps accuracy for example for pcdr the spatial cc derived for mtc ccs is about 0 84 which does not show significant superiority to the atc one about 0 8 for chirps the mtc ccs even shows lower spatial correlation than the atc one fig 3 also demonstrates the similar performance of mtc with atc for assessing pcdr and lower performance of mtc than atc for assessing chirps these findings are different from li et al 2018 who suggested that mtc is more suitable for mainland china probably because they take the gauge data as input for tc and as the benchmark to validate tc as well which might cause less reliable validation results note that both the atc and mtc approaches tend to overestimate the accuracy of the spps relative to the traditional approach more specifically the mean ccs for pcdr and chirps are overestimated by about 0 02 0 07 while the ubrmses are overestimated on average by nearly 6 15 mm month relative to traditional approach additionally mtc shows severer overestimation of spps accuracy than atc these overestimations are evident in fig 3 as the scatter points present deviations from the 1 1 line the deviations of the tc results to the traditional approach over gauged gridcells also appeared in massari et al 2017 biased tc results due to non zero eccs between the triplets and the poor reliability of traditional approach due to low quality of reference data are the two main reasons causing the deviations since the validation of tc was performed for the validation gridcells containing multiple gauges fig 2 the cpap should have acceptable high quality to close to true precipitation for these gridcells thus the results of traditional approach should be reliable hence the biased tc results caused by eccs between the triplets massari et al 2017 li et al 2018 might be the primary reason of these deviations instead of the quality of the reference data these results indicate that although tc can retrieve the spatial pattern of spps accuracy the bias of tc might need attentions in quantitative estimation of the spps accuracy magnitude to further investigate the performance of tc in estimating the spp accuracy pattern the spatial distribution of the ccs and ubrmses from the traditional approach and tc for the 480 validation gridcells are presented in figs 4 and 5 respectively with the left and middle columns showing the accuracy metrics of the traditional approach and tc respectively while the right column showing the differences between the traditional and tc based accuracy metrics it can be found that tc generally demonstrates an overestimated accuracy relative to the traditional approach and even shows abnormal cc values 1 but even so the ccs and ubrmses derived from tc exhibit similar spatial patterns with those based on the traditional approach for atc the ccs and ubrmses of tc generally show overall deviations from the traditional approach but the deviations are generally distributed evenly with low spatial variation while for mtc the deviations between tc and the traditional approach show apparent spatial variation affecting the spatial correlation between tc results and traditional approach results above all the atc approach presents more acceptable reliability in assessing the accuracy of spps over mainland china and can retrieve the spatial relationship of the spps accuracy based on the observed greater reliability of the atc compared with the mtc the atc approach is used to assess the spp monthly precipitation estimations in this study 4 2 spp accuracy assessment using tc figure 6 presents the assessment results of the two spps including the ccs and the ubrmses based on the traditional left column and tc right column approaches respectively white areas in fig 6 denote the gridcells excluded from the assessment due to more than half of the time steps with zero precipitation see section 3 2 note that here the traditional approach is employed for all gridcells over mainland china including the ungauged gridcells and the cpap data would not necessarily exhibit a high reliability over the ungauged gridcells hence the traditional approach is employed just for comparison despite the general overestimation of spps accuracy and the abnormal cc values 1 by tc tc results exhibit a similar spatial trend in terms of the cc and ubrmse values for both pcdr and chirps with the traditional approach over eastern china where cpap has denser gauge networks both spps demonstrate high ccs over 0 9 in most areas note that due to greater precipitation amount the spps exhibit high ubrmses in southeastern china via tc this further highlights the significance of including cc for tc mccoll et al 2014 in spp assessments as using only the ubrmse is not effective in describing the spatial characteristics of the spps the relatively abundant precipitation in the monsoon area less complicated terrain and the denser in situ observations used for correcting the spps are generally considered as the principal reasons of the high accuracy of pcdr and chirps in eastern china bai et al 2020 bai et al 2019 guo et al 2016 zhong et al 2019 in western china where cpap gauges are sparse thereareapparentdiscrepanciesbetween tc and the traditionalapproach tc demonstrates high ccs for both pcdr and chirps in several western china boundary regions such as west tp and north gxr on the contrary the traditional approach shows much poorer accuracy of the spps in these regions the cpap data as the reference for the traditional approach contain very sparse gauges and even no gauges in these regions as a result the cpap data exhibit large interpolation errors and less reliability and thus underestimate the accuracy of spps for these regions therefore the tc would be relatively more reliable to assess spps both approaches demonstrate poor performance of the two spps over the kunlun mountain northwestern boundary of tp a remote area with very complex terrains where spps are generally associated with low accuracies li et al 2018 above all both pcdr and chirps can accurately estimate monthly precipitation over eastern china the two spps also depict an acceptable accuracy over many regions in western china which may be underestimated in previous studies bai et al 2020 zhong et al 2019 due to the sparse gauges of the reference data for assessment 4 3 validation of tc for drought utility assessments the spis with timescales of 1 3 6 and 12 months were calculated by using the pcdr chirps as well as the sm2rain and era5 the time series of the spis are illustrated in figs s1 to s4 in the supplementary information by using spatial averaging for the nine subregions of mainland china tc was then applied to estimate the cc values of the spis based on the two spps for each validation gridcell and the ccs represent the drought utility of the spps similarly the spis were also calculated by using cpap data and the ccs between the spis of spps and cpap on each validation gridcell were employed as the references to validate the ccs from tc results are shown in table 3 table 4 and fig 7 results show that tc can reflect the pattern of drought utility of spps but not as good as in the assessment of precipitation estimations for spi 1 the spatial ccs between the ccs from tc and the traditional approach are acceptable approximately 0 71 for pcdr and 0 59 for chirps for short timescale spis tc is still able to capture the spatial pattern of spp drought utility however for longer timescales spis the spatial correlations of the ccs based on tc and the traditional approach are lower particularly for the spi 12 with a spatial cc of just 0 53 to 0 45 therefore tc may be less suitable for the assessment of drought indices at longer timescales fig 7 also illustrates the weak correlation between tc and the traditional approach for assessments of spi 12 additionally tc also overestimated the drought utility of the spps systematically as the tc based ccs exhibit higher mean values than those of the traditional approach for all spis and even shows abnormal high cc values over 1 not shown in the range of fig 7 figures 8 and 9 present the differences in the spp drought utility determined by tc and the traditional approach for spi 1 and spi 3 the two approaches exhibit similar spatial patterns for the spp drought utility the pcdr and chirps perform better in most regions of eastern china but a poorer performance in the midwest particularly the sichuan basin in middle swc the discrepancies between tc and the traditional approach are larger for areas associated with poorer performance than areas with better performance since the gauge networks have higher density in eastern china fig 2b the cpap should have more reliable quality to represent the true spi values and serve as validation reference for eastern china thus the discrepancies between the two approaches might be also related to the influence of non zero ecc on tc the more frequent abnormal high cc values over 1 produced by tc also support this this may indicate that tc is relatively weak in evaluating drought utility of spps moreover figs 8 and 9 also reveal that for spis with longer timescales particularly spi 12 both tc and the traditional approach exhibit high spatial heterogeneity in the spatial pattern of spp drought utility consequently increasing the difficulty for tc to capture the spatial pattern of spp drought utility thereby resulting in the poorer spatial correlation of the tc results with the traditional approach to investigate the reason causing the different performance of tc in assessing precipitation data and calculated spis in different timescales a quantitative analysis was performed for the magnitude of ecc term represented by c o v ε i ε j in eq 2 relative to the covariance between the triplets q ij in this analysis we calculated the c o v ε i ε j by assuming the cpap data is the precipitation truth results are shown in fig s5 in the supplementary information along with the details of calculation for the monthly precipitation inputs the analysis shows that the c o v ε i ε j is relatively low as the ratio with q ij is generally below 0 3 but for the calculated spis ecc shows much higher magnitude with the ratio of c o v ε i ε j and q ij up to 0 8 as the result tc performs better in assessing the precipitation data than assessing the spis of spps this might be due to that the seasonal variation of the precipitation is smoothed out in spi subsequently the random errors in the spps might appear relatively larger magnitude compared with the reduced variation of precipitation and thereby the ecc becomes more apparent relative to the covariation between triplets ultimately causing the less reliable assessment results of tc for the spis with longer timescales spi 6 and spi 12 besides the increased magnitude of ecc the ratio of c o v ε i ε j and q ij also shows apparently higher spatial heterogeneity causing the more complicated spatial pattern of differences between results of tc and the traditional approach figs 8 and 9 which might consequently cause the much lower spatial correlation between the ccs of the two approaches for the spis of longer timescale likewise the corresponding ecc among the spps represented by c o v ε i ε j in eq 2 might present larger magnitude relative to the reduced variation of the precipitation inputs ultimately increasing the deviation between tc and traditional approach although systematic bias is observed in the tc results it is still able to retrieve the spatial relationship of the spp drought performance qualitatively for spi 1 and spi 3 as tc exhibits a relatively weak performance in assessing the drought utility of long term spis the tc assessment results of spi 6 and spi 12 are not the focus of the subsequent analyses 4 4 spp based drought utility assessments using tc figures 10 and 11 present the assessment results of tc for the drought utility of pcdr and chirps respectively the traditional approach was also employed by using the cpap as assessment reference for comparisons with tc the pcdr based spi 1 and spi 3 are associated with similar spatial patterns via tc for both spp drought performances compared to the traditional approach over dense gauge network areas both approaches exhibited higher ccs for pcdr across most areas in eastern china and poorer drought utility for areas surrounding the sichuan basin where the topography varies drastically similar spatial patterns are also observed by related studies bai et al 2020 guo et al 2016 zhong et al 2019 however tc still systematically overestimates the results and the abnormal high cc values 1 are also shown likewise we suggest that these deviations of tc results in eastern china is primarily caused by ecc between triplets while in western china where cpap covers gauges sparsely distributed like tp tc and the traditional approach show apparent discrepancies in spps drought utility different from eastern china this phenomenon in western china is more likely due to the poor quality of cpap resulted from the sparse local gauge network fig 2b as the result the cpap based spis have larger deviation from the tc suggested truth over these areas since tc provides the performance with respect to the truth tc is expected to obtain better scores than what the results showed thus is more reliable when the reference is affected by severe error this phenomenon is particularly evident for areas where gauge based precipitation data are less representative e g tp with highly complex terrain and sparse gauges above all our results demonstrate the spatial trends in drought utility of the two spps over mainland china including tp where gauges are sparse by using tc we also identify a potential factor that might influence the quantitative assessment ability of tc for spps drought utility i e the systematic bias in the tc assessment results which might need attention in the practices of tc 5 discussion 5 1 uncertainties in tc among different triplets several studies have demonstrated that the different combination of triplets for tc may influence the results of each triplet alemohammad et al 2015 li et al 2018 mccoll et al 2014 massari et al 2017 therefore we compared the results of tc for the sm2rain and era5 datasets under different triplet combinations to evaluate the corresponding uncertainties fig 12 depicts the ccs of the monthly precipitation and spi 1 derived via sm2rain and era5 we employed the triplets i left column triplets ii middle column as well as the results of the traditional approach using cpap data right column for reference purposes the spatial patterns in ccs between the different triplets determined by sm2rain and era5 are qualitatively similar revealing that the uncertainty among different triplets does not have a substantial effect on our results which is similar to the findings of sun et al 2021 like the results of pcdr and chirps the tc also systematically overestimates the accuracy of both sm2rain and era5 for eastern china with dense gauge networks yet the accuracy patterns of the both products for the two triplets are also consistent with the traditional approach for densely gauge areas except the pattern of era5 precipitation for northeastern china these results reveal the stability of the tc regardless of which spp is selected as the triplets 5 2 limitation of tc numerous studies have demonstrated the application of tc for variables which are difficult to be in situ measured such as precipitation and soil moisture chen et al 2021 li et al 2018 van dijk et al 2014 wu et al 2019 yilmaz and crow 2014 compared with the former studies this study further evaluated the reliability of tc in assessing the drought utility of the spps by using spi although our results reveal the superiority of tc for ungauged areas we identified some disadvantages of tc to apply the results to regions beyond china it is necessary to interpret the meanings of tc results based on our findings our results indicate the ability of tc in retrieving spatial pattern in the accuracy of precipitation data of spps moreover tc is less reliable but still acceptable for short timescale drought indices however tc is unable to assess the long timescale drought indices effectively similar to the findings of massari et al 2017 tc demonstrates apparent systematic deviations for assessing spps accuracy comparing with the results of cpap based traditional approach for western china where cpap gauges are sparse these deviations might be primarily caused by the underestimation of spps accuracy by the traditional approach due to the poor quality of the reference data chen et al 2021 li et al 2018 since tc provides the accuracy with respect to the truth the performance of tc would be underestimated when the reference data are less reliable however for eastern china this finding also appears even though the reference gauge networks of cpap are dense and the number of observations is stable over time in eastern china fig 2 moreover abnormal high cc values 1 also shown in many cases of tc results this indicates the systematic bias in tc results which is an important disadvantage of tc the non zero ecc might be the primary cause which is widely observed and regarded as the main bottleneck of tc chen et al 2021 li et al 2018 yilmaz and crow 2014 zhang et al 2021 it should be noted that the cpap data cannot perfectly represent the truth of precipitation because the density of 2 gauges for a 0 5 gridcell is still inadequate to eliminate the potential error in the assessment even for monthly timescale therefore the bias of tc based assessment shown in our results might be potentially overestimated even so the potential error of cpap data under the current gauge density and monthly timescale might be limited tang et al 2018 thus the deviation between tc and the traditional approach is less likely to be entirely caused by the error of cpap therefore cpap should be still adequate to reveal the inherent systematic bias of tc based assessment together with the phenomenon of abnormal high cc values over 1 for tc results we suggest that attention should be paid to the inherent systematic bias of tc caused by the non zero ecc to reduce the potential influence of ecc this study introduced the sm2rain as a tc triplet for assessing the spps which is mainly based on independent mechanism and data source soil moisture from ascat this avoids the potential problem of taking gauge data as a triplet as it might cause ecc due to the overlapping gauges for correcting the spps nevertheless sm2rain also introduced several auxiliary datasets such as the era5 rainfall products used for calibrating the sm2rain algorithm brocca et al 2019 which might cause potential ecc with era5 thereby affect the tc results moreover era5 also used several satellite based microwave bright temperature data as input although pcdr and chirps are mainly based on ir data the microwave bright temperature data adopted by era5 might be also involved in the two spps e g in the gpcp that used for correcting pcdr as the results potential ecc between era5 and the spps is also not negligible for tc especially when assessing the spps mainly based on pmw data chen et al 2021 have evaluated the eccs between sm2rain era5 and a pmw based spp and pointed out the non negligible eccs between sm2rain and era5 further systematic analyses for the eccs might be conducted in future works when data from the adequately dense gauge network are available potential of tc in assessing the spps has been investigated in previous former studies li et al 2018 massari et al 2017 nevertheless these studies are generally inclined to apply tc directly while the disadvantages of tc are seldom mentioned in this study we not only point out the advantages of tc as an observation free approach but also identified the systematic bias in tc results which might need attention in the quantitative assessment by tc by comparing with the previous studies our findings also reveal the potential risk of solely using tc in assessing the accuracy and drought utility of spps and indicate that tc cannot fully replace the traditional approach in practical applications taking tc as a supplement for the traditional approach might be also a feasible scheme for some cases the correlation between the tc and traditional gauge assessed approaches is high indicating the potentiality to correct the tc results with the help of traditional approach over the gauged gridcells this might improve the ability of tc to assess datasets quantitatively and is therefore a potential solution for areas with sparse but reliable gauge observations in addition restricted by the limited functions of tc which currently can only estimate the cc and ubrmse more comprehensive assessment on drought utility of spps such as the ability of drought condition classification is not performed further development of tc such as the categorical tc mccoll et al 2016 might extend the assessment of spps drought utility for this aspect nevertheless we suggest that our assessment results of ccs of spp based spis are valuable and representative as we can find from former studies jiang et al 2021 zhong et al 2019 that the patterns of other aspects of drought utility such as the drought event classification ability are close to the cc patterns of drought indices 6 conclusions the potential of spp in drought monitoring over ungauged areas is difficult to be assessed in conventional way in this study we investigated the reliability of tc in assessing the accuracy and drought utility for two long term spps using spi furthermore tc was employed experimentally to evaluate the spps over mainland china the following key conclusions were reached tc is effective in retrieving the spatial pattern of the spp accuracy and drought utility for short timescale drought indices over mainland china however the tc results also exhibit a systematic bias relative to the gauge assessed results and even show abnormal high cc values 1 moreover tc is difficult to assess long timescale drought indices effectively the tc results reveal the potential underestimation of spp accuracy by the traditional approach in some ungauged areas furthermore tc exhibits a similar spatial pattern in spp drought performance to the traditional approach over densely gauged areas however large discrepancies are found between the tc and the traditional gauge assessed approaches over some gauged areas with complex terrain this may indicate the relatively poor ability of tc in assessing drought indices for these areas in summary tc demonstrates superiority in qualitatively assessing the accuracy and drought utility of spps over ungauged and poorly gauged areas however the systematic bias in tc results is also apparent although the cpap might overestimate the systematic bias of tc results to some extent attention is suggested to paid to the bias of tc in practices moreover as only cc and ubrmse can be estimated this study only examines tc in assessing the correlation of spis potential future research may be focused on how to improve tc by reducing the impact of restricting factors as well as how to expand tc for assessing additional metrics and drought utility of spps declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was financially supported by the natural science foundation of guangdong province china grant no 2021a1515010558 the national key r d program of china 2017yfc0405900 the national natural science foundation of china grant nos 51509040 5171101598 51979043 and 51709127 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 127098 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
