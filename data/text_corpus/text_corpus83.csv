index,text
415,a series of micro scale core flooding experiments were conducted in a miniature water wet berea sandstone sample to examine how changes in the desaturation water displacing oil protocol impact the non wetting phase recovery and to provide to the best of our knowledge the first pore scale evidences of the associated displacement subtleties we studied i the continuous displacement mode cdm which consisted of a series of imbibition tests with increasing capillary numbers and similar initially connected oil and ii the discontinuous displacement mode ddm which included a drainage followed by a multi rate imbibition test during all experiments a cutting edge imaging platform was employed to visualize the fluid occupancies in the pore space the in situ saturation measurements showed that at a given capillary number the non wetting phase recovery was more efficient under the continuous mode during which the oil phase was connected prior to each imbibition this is attributed to the changes in the order by which the pore scale displacement events take place before entrapment for the ddm however the entrainment of oil clusters is the governing recovery mechanism and the desaturation process was observed only when a threshold capillary number was reached these findings are supported by pore scale fluid occupancy maps demonstrating piston like and snap off events during the capillary driven flow processes as well as trapped cluster entrainment during the viscous dominated flow tests moreover this investigation presents previously unidentified pore scale displacement events in natural porous media such as fragmentation and coalescence of trapped non wetting phase globules prior to entrainment these mechanisms took place at intermediate capillary numbers and mostly under the discontinuous displacement mode before the threshold of mobilization was reached the capillary desaturation process under cdm was found to be gradual and more pronounced compared to that under the ddm mode it is also demonstrated that even though the pore scale displacement mechanisms responsible for oil recovery are different for cdm and ddm the viscous dominated imbibition tests produce similar distributions of trapped oil clusters under both cases keywords core flooding experiment micro computed tomography imaging capillary desaturation process desaturation protocols pore scale displacement mechanisms 1 introduction capillary and viscous forces are two of the key factors that control the trapping and mobilization of non wetting phase during immiscible imbibition processes in porous media as an imbibition process occurs and the wetting phase advances through the pore space under either unsteady state or steady state flow scenarios capillary forces entrap the non wetting phase in a single pore element or a cluster of pores which in turn leads to the loss of non wetting phase hydraulic conductivity abrams 1975 aghaei and piri 2015 anton and hilfer 1999 lake 1989 mohanty et al 1987 roof 1970 the trapped non wetting phase may later be mobilized by reducing the capillary forces or increasing the viscous forces larson et al 1981 jamaloei et al 2010 the relative strength of these factors is typically quantified through capillary number nca the common definitions of nca at the micro scale are presented in eq 1 and 2 abrams 1975 chatzis and morrow 1984 hilfer and øren 1996 leal 2007 morrow et al 1988 saffman and taylor 1958 1 n ca micro v w μ w σ nww 2 n ca micro v w μ w ϕ σ nww cos θ nww μ w μ nw 0 4 where vw is the darcy velocity of the invading phase in m s µw and µnw stand for the viscosities of the wetting and non wetting phases respectively in pa s σnww denotes the fluid fluid interfacial tension in n m and θnww is the contact angle between the wetting and non wetting phases on the rock surface eq 2 is a general form of eq 1 that takes into account additional parameters such as wettability viscosity ratio of the fluids and porosity of the sample ϕ the amount of residual non wetting phase saturation for a specific pore space topology and wettability condition is believed to be dependent on the fluid fluid interfacial properties invading fluid velocity and viscosities of the displacing and displaced fluids all of these factors are included in the above mentioned definitions of the capillary number the relationship between the residual non wetting saturation snwr and capillary number is demonstrated through capillary desaturation curves cdcs and for decades was thought to be unique for a given rock fluids system blunt 2017 sahimi 2011 satter et al 2008 however recent studies have shown that the snwr nca relationship is also dependent on the initial fluid configuration and the sequence of flow processes i e the manner in which the desaturation is established chatzis and morrow 1984 hilfer et al 2015 morrow et al 1988 xu et al 2018 these various sequences of flow experiments are referred to as displacement modes a capillary desaturation curve can be generated under either continuous or discontinuous displacement mode the continuous displacement mode cdm includes multiple cycles of drainage imbibition processes with increasing capillary numbers for the imbibition tests the imbibition tests are followed by identical drainage events to establish similar initial saturation conditions i e to create initially connected non wetting phase clusters prior to each imbibition the discontinuous displacement mode cdm however refers to displacement of the non wetting phase ganglia that had been hydraulically disconnected trapped due to a preceding imbibition process in the discontinuous mode a core sample at initial wetting phase saturation i e post primary drainage is subjected to a single multi rate imbibition process with stepwise increases in the wetting phase flow rate or capillary number while the residual non wetting phase saturation is measured at the end of each stage the governing recovery mechanisms during a capillary desaturation process strongly depend on the flow protocol the cdm and ddm displacement scenarios are governed by two types of distinct pore level displacement mechanisms reduction in oil saturation during the ddm tests is controlled by mobilization of trapped globules due to drag forces whereas in the case of cdm experiments where the non wetting phase is connected prior to each imbibition test changes in the order of displacements govern saturation changes with variations in flow rate anton and hilfer 1999 chatzis and morrow 1984 however the impacts of the aforementioned differences in displacement physics on non wetting phase saturation in natural porous media are poorly understood hence experimental investigations of the process dependency of capillary desaturation in such media are warranted the majority of experimental investigations on cdc have been dedicated to the study of the displacement physics governing flow behavior under the discontinuous mode armstrong et al 2014 chatzis et al 1988 chevalier et al 2015 georgiadis et al 2013 herring et al 2013 joekar niasar et al 2013 khishvand et al 2016 rodríguez de castro et al 2015 rücker et al 2015 schlüter et al 2016 youssef et al 2015 wardlaw and mckellar 1985 nonetheless a few investigations have probed the process dependent desaturation experimentally in these studies porous media with widely different transport properties were used to examine the entrapment and mobilization of residual oil they have found that displacing connected non wetting clusters i e desaturation under the continuous mode is considerably easier than the mobilization of trapped globules i e desaturation under the discontinuous mode chatzis and morrow 1984 morrow et al 1988 these studies however have failed to provide direct pore scale evidence of the underpinning displacement mechanisms responsible for oil recovery this is primarily due to the absence of appropriate experimental technologies during the past few decades the advent of imaging technologies e g micro computed tomography and their integration with flow instruments has made it possible to investigate fluid flow in natural porous media at the pore level where phenomenological processes are explicitly resolved motivated by the aforementioned narrative in the course of this study we investigated the capillary desaturation process as a function of displacement protocol we present the results of a series of unsteady state miniature core flooding experiments under capillary and viscus dominated flow regimes the tests were performed to generate cdcs under continuous and discontinuous displacement modes the experiments were conducted in a fired berea sandstone at elevated pressure and using a state of the art miniature core flooding setup integrated with a high resolution micro computed tomography µ ct scanner pore scale fluid occupancy maps as well as in situ saturation data are analyzed to shed light on subtle details of how desaturation protocols impact the pore scale displacement mechanisms and fluids spatial distributions in the following sections we first present the materials and the experimental setup and procedures that are employed to carry out the tests this is then followed by the results and discussion of the observations and finally a set of concluding remarks 2 porous medium and fluids the flow experiments were performed on a fired berea sandstone ss sample 4 93 mm in diameter and 68 17 mm in length drilled from a parent core plug with a diameter of 38 mm the miniature core sample was fired at 500 c 932 f for two hours to stabilize clay minerals and minimize clay swelling and fines migration we used berea sandstone due to its wide polydisperse pore size distribution psd that provides a broad range of trapped clusters sizes the average porosity of the rock specimen was calculated from the segmented µ ct images of the dry sample and found to be 17 6 this value was similar to the porosity of the parent core plug measured using an automated ap 608 helium porosimeter i e 19 7 the absolute permeability to brine for the miniature core sample was measured to be 620 12 md the aqueous phase brine was prepared by mixing 0 99 wt nacl with 0 01 wt nan3 in distilled water the oil phase was a mixture of 90 vol purified viscous white mineral oil gloria courtesy of sonneborm and 10 vol iodooctane the iodooctane was used as a dopant to enhance the contrast between the two fluid phases in the µ ct images the dynamic viscosities of the aqueous and oil phases were measured using an anton paar viscometer at 21 c and were found to be 1 05 0 05 and 70 1 04 mpa s respectively the oil brine interfacial tension measured using the rising bubble technique was 24 1 0 76 mn m the aqueous and oil phases hereafter are referred to as the wetting and non wetting phases respectively 3 experimental setup the experiments were carried out utilizing a unique open loop core flooding apparatus see fig 1 integrated with a µ ct scanner used to image the pore space during various flow processes the core flooding setup consisted of a custom built miniature core holder six dual cylinder pumps quizix q5000 ametek and an array of rosemount high precision differential pressure transducers the pumps were used to deliver pulse free flow of fluids at specific flow rates to the inlet of the core sample receive effluent from the outlet at a desired constant pressure and maintain a constant radial overburden stress on the sleeve surrounding the core sample the core flooding setup was coupled with a cutting edge true helical cone beam high cone angle 100 micro ct scanner heliscan thermofisher scientific that enabled us to generate three dimensional fluid occupancy maps at the pore level while the flow of fluid phases was maintained additional details of the core flooding system can be found elsewhere alizadeh et al 2014 4 experimental procedure the flooding sequences to generate the cdcs under different desaturation protocols are depicted in fig 2 the berea ss sample was first placed in the vertically oriented miniature core holder and subsequently a low confining pressure 1 39 mpa was applied this step was followed by injecting gaseous co2 to remove the bulk air from the pore space the sample was then imaged at a resolution of 2 29 µm to obtain the reference dry scan for accurately mapping the pore space and generating porosity distribution along the field of view fov the fov as indicated by the red squares in fig 2 was 5 89 mm 5 89 mm 3 22 mm afterward the core was vacuum saturated with the wetting phase and the pore and confining pressures were simultaneously increased to 4 14 and 5 52 mpa 600 and 800 psi respectively at 21 c at this point another scan was performed to ensure that the sample was fully saturated with the wetting phase subsequently the absolute permeability of the rock was measured based on the steady state pressure drop data acquired at five different constant flow rates the sample was then subjected to a primary drainage process by injecting the non wetting and wetting phases at flow rates of 0 003 and 0 01 cm3 min respectively after injecting five pore volumes of the non wetting phase its flow rate was gradually reduced to 0 001 cm3 min while the wetting fluid flow was ceased this procedure was particularly employed to establish an initial wetting phase saturation of approximately 20 using displacement by the viscous non wetting phase the core sample with the pre established initial oil saturation was then subjected to two categories of imbibition tests i e continuous and discontinuous displacement modes cdm and ddm respectively each imbibition set included multiple increasing flow rates in order to generate the respective capillary desaturation curve under the cdm mode each imbibition was followed by a drainage process to generate similar initial oil saturations for all cases whereas the ddm mode was one multi stage imbibition process with stepwise increases in the injection flow rate it should be noted that all experiments were conducted on the same rock specimen hence the pore size distribution topology and wettability were identical for all flow experiments for each stage of the flow experiments when the pressure drop and fluid configuration examined by consecutive scans became stable the mid section of the core i e the fov was imaged at a resolution of 2 29 µm the flow was maintained during image acquisition periods to prevent the relaxation of the fluid fluid interfaces the acquired µ ct images were processed and analyzed using avizo fire 9 4 developed by thermofisher scientific usa the processing step included image cropping filtering non local means and median filters and registration of the wet flooded images with the dry reference image the registered wet images were then combined with the pore map generated from the dry reference image and segmented to obtain the wetting and non wetting phase distributions the detailed description of this method is available elsewhere khishvand et al 2016 5 results and discussion in this section we present the result of the capillary desaturation experiments performed on the core sample when the non wetting oil phase was continuous or discontinuous prior to the imbibition tests we first provide saturation distributions and exhibit pore scale fluid occupancy maps to explain the observed saturation trends this is then followed by the discussion of the cdcs generated for the two displacement protocols and a comparison with the data available in the literature finally a detailed analysis of the frequency distributions of trapped oil globules is presented it is important to emphasize that the temporal resolutions of laboratory micro ct scanners are typically not sufficiently high to resolve the dynamic events e g instantaneous pore filling or snap off taking place during the flow tests therefore in this study the displacements were inferred from the comparison between pore space images at the end of various stages of the experiments the physics of these events have been theoretically predicted cieplak and robbins 1988 mohanty et al 1987 rose and witherspoon 1956 and experimentally observed using fast synchrotron x ray micro tomography techniques singh et al 2017 youssef et al 2014 5 1 pore scale fluid occupancy maps and in situ saturations fig 3 a and b show the distributions of in situ saturations along the fovs for the drainage and imbibition experiments when the non wetting phase was discontinuous and continuous respectively slight perturbations in the saturation data were associated with local flow fields and porosity variations it should be emphasized that the bond number i e the ratio of buoyancy to capillary forces morrow and songkran 1981 for this experiment was approximately 5 40e 11 this value was sufficiently small to assume that the impact of gravity could be neglected compared to those of viscous and capillary forces moreover the contact angle measurements obtained at the end of the primary drainage and the imbibition for both cdm and ddm tests showed average values of approximately 50 and 55 respectively the distributions of contact angles are presented in figure s1 these observations confirm that wettability of the rock sample stayed unchanged during the course of this study which was expected because polar components and impurities were removed from the mineral oil prior to use in the experiments since the wettability and pore space morphology were similar in all experiments it was plausible to consider the interplay of capillary and viscous forces as the only factor that governed the variations in fluid saturations table 1 summarizes the residual oil saturations at different stages of the experiments the saturation data was further augmented with examples of fluid occupancy maps see figs 4 6 to help interpret the changes from one case to another the variations in non wetting phase saturation can be categorized under three different regions including capillary dominated capillary viscous i e transient and viscous dominated flow regimes the capillary numbers for the various flow regimes can be determined based on the saturation trends as well as the pore scale observations a range of capillary numbers over which the displacements are considered capillary driven and the residual non wetting phase saturation stays fairly constant is referred to as the capillary dominated flow regime the viscous dominated flow regime on the other hand is when the saturation reduces considerably with increases in flow rate and consequently pressure drop due to significant changes in the order of displacements or the entrainment of oil clusters 5 1 1 capillary dominated flow regime i e approximately nca 1e 6 the drainage with oil led to an initial oil saturation of approximately 0 83 for both sets of experiments after each drainage process oil formed a connected network spanning over the porous medium while brine resided in small pore elements and crevices the first waterflood experiment no 2 was then deployed at a low flow rate of 0 004 cm3 min i e nca 1 52e 7 to subject the porous medium to a capillary dominated forced imbibition this stage was conducted once and the results were interpreted and used for both the cdm and ddm protocols the introduction of brine into the inflow end of the sample changed the local capillary pressures as a result brine invaded into the oil filled pores elements with an order of the smallest to largest and displaced oil through connected oil ganglia e g piston like displacement toward the outflow end meanwhile in the corner of pore elements and throats oil brine contact angles hinged toward their advancing values while the interfaces arc menisci were pinned in their locations when the advancing contact angles were reached the interfaces moved toward the center of pores due to rises in local water pressures while the contact angles stayed constant once these menisci met each other in a pore throat to the entrance of which water had no access the corresponding pore throat was instantaneously filled with the brine this process is known as snap off and traps a significant amount of the oil phase in the pore space behind the waterflooding front rose and witherspoon 1956 roof 1970 pore scale evidence of this phenomenon is observed when area 1 of fig 4 b is compared to the same site in fig 4 a in addition to the piston like and snap off evets cooperative pore body filling mechanism had also played a pivotal role in the displacement and trapping of oil ganglia in this porous system nonetheless as discussed earlier the dynamic changes during this event could not be visualized due to the limited temporal resolution of the micro ct images 5 1 2 capillary viscousflow regime i e approximately 1e 6 nca 4e 6 the capillary dominated imbibition was then continued by two waterfloods under the discontinuous mode at capillary numbers of 7 62e 7 experiment no 3 and 3 81e 6 experiments no 4 for the continuous mode however an imbibition process experiment no 8 at a capillary number of 3 81e 6 was carried out once the initial water saturation was re established through experiment no 7 the in situ saturation data for the discontinuous case i e when the oil was mostly trapped due to the preceding capillary dominated waterflood illustrate negligible changes in oil saturation with increases in waterflooding flow rate as opposed to the discontinuous system when the oil was continuous prior to the higher capillary number waterflood changes in saturation with the increase in capillary number were significant compare the black and red curves in fig 3 b as it is demonstrated in the selected areas of fig 4 changes in capillary number slightly mobilized and re arranged the oil clusters under the discontinuous mode compare fig 4 b and c whereas in the case of the continuous system the oil cluster configuration was significantly impacted by the increase in capillary number compare fig 4 c and d this difference in behavior can be explained using the governing displacement mechanisms 1 changes in the order of pore scale displacements when the oil clusters are not trapped prior to the imbibition i e the cdm rises in wetting phase flow rate increases its viscous pressure drop that changes the overall threshold pressures of the water to oil displacements which are affected by the pressure drops due to capillarity viscous and gravitational forces this consequently alters the order by which such displacement events take place as a result the displacement of oil from larger pores and the pore elements closer to the inlet would be favored over those in smaller pores or the pore elements located at farther distances from the inlet this in turn suppresses snap off events providing further opportunities for the wetting phase to displace more oil through piston like and cooperative pore body filling processes and reduce residual oil saturation this phenomenon was responsible for the significant change in oil saturation under the continuous mode at intermediate capillary numbers compared to the capillary dominated flow regime this can be realized when one compares designated areas 2 to 5 in fig 4 b and d conducting waterflood at an intermediate capillary number fig 4 d displaced oil from some large elements while fewer small pore elements were invaded compared to the displacement under the capillary dominated flow regime fig 4 b 2 mobilization of trapped oil globules the oil clusters trapped in the pore space are subjected to drag force exerted by the wetting phase for a given trapped globule once this exceeds certain threshold value which depends on fluid properties the diameter of the most constricted regions of the pores and the size of the cluster the wetting fluid can mobilize it the dislodged globules can subsequently be fragmented or coalesce with other globules the coalesced blobs will later be relocated and or produced we believe these mechanisms contributed to the slight changes in saturation seen under the discontinuous mode these become evident when the selected areas 1 and 2 blob coalescence and 3 and 4 blob fragmentation of fig 5 b are compared to those in fig 5 a it should be noted that the coalescence and mobilization might have also taken place under the continuous mode after the oil globules were trapped as it is evident from the saturation trends and fluid occupancy maps oil saturation was only slightly reduced under the discontinuous mode meaning that the mobilization thresholds were not surpassed for majority of the oil globules under the continuous mode however the changes were more pronounced due to changes in the order of the displacements it should be noted that in addition to the above mentioned displacement mechanisms increases in local water pressures at higher capillary numbers always slightly changes the curvature of the oil brine interfaces and also trigger snap off displacement events which in turn break up the large oil clusters into smaller ones as depicted in fig 6 5 1 3 viscous dominated flow regime i e approximately nca 4e 6 fig 3 shows notable changes in oil saturations for both ddm and cdm modes when the injection flow rate was increased to 0 5 cm3 min i e nca 1 90e 5 the displacement mechanisms governing flow behavior under high and intermediate capillary numbers are similar however the displacement of oil from larger pore elements particularly under the ddm case was more pronounced compared to that observed in the capillary viscous flow regimes fig 7 compares examples of fluid occupancy produced under viscous and capillary dominated displacement regimes the significantly higher brine flow rate strongly impacted the pressure fields and order of displacements for the continuous system moreover under both ddm and cdm modes the viscous forces exerted due to the dynamic effect created a massive mobilization front across the sample which displaced trapped oil globules from their original sites compare selected areas 1 3 in fig 7 a b and c and caused notable reductions in residual oil saturations it should be noted that as fig 3 demonstrates capillary desaturation under ddm was considerable and observed only when the mobilization threshold was satisfied whereas in the cdm saturation changes were greater and more gradual we observed additional recovery of 21 46 and 28 3 for the viscous dominated ddm and cdm respectively compared to the imbibition under the capillary dominated flow regime to further investigate the possibility of oil globule mobilization during the imbibition tests under different flow conditions the corresponding drag ratios i e the ratio of viscous to capillary forces were calculated using eq 3 taber et al 1973 3 d r a g r a t i o δ p l σ n w w where δp l is the pressure gradient along the core in psi ft and σnww is the oil brine interfacial tension in dyne cm the calculated drag ratios are compared against the macro scale mobilization threshold in table 2 the threshold drag ratio for the viscous oil used in this study was calculated using an empirical correlation developed for a similar rock sample taber et al 1973 the drag ratios indicate that the mobilization threshold was not exceeded for the majority of the imbibition stages meaning that the possibility of mobilization due to drag forces is insignificant except for the last two imbibition tests under ddm and the last imbibition under cdm the higher drag ratios observed during the ddm tests are related to a significantly greater jamin effect in these cases as we discussed earlier the residual oil saturations were greater in the ddm processes compared to the cdm counterparts and the oil clusters would occupy a greater number of large and intermediate sized pore elements in the former case this in turn would lead to a greater resistance to flow wright 1933 at any given flow rate the pressure drop along the core and hence the likelihood of mobilization were greater under the ddm waterflooding experiments nevertheless the oil recovery was more efficient under the continuous displacement mode this is attributed to the fact that before each cdm test the non wetting phase was connected therefore increases in capillary number boosted the oil recovery mostly through changes in the order of displacement events and the displacement mechanisms were more likely to be piston like and cooperative pore body filling in the case of the ddm experiments however the majority of the incremental recovery was the result of mobilization of the previously trapped oil globules to further demonstrate the higher degree of connectivity of oil clusters prior to the cdm tests we generated the non wetting phase percolation maps of the entire remaining residual oil i e the oil clusters disconnected gray and connected red to the inlet of the fov as shown in fig 8 before various waterflood experiments we have also calculated the normalized euler number of the entire remaining residual oil i e the euler number of oil divided by the euler number of the pore space the details of the image analysis are presented in the supplementary materials the euler number euler poincaré characteristic is a topological invariant that is commonly used in the digital rock physics to characterize the connectivity of fluids within the pore space feali et al 2012 vogel 2002 a maximum normalized euler number of 1 0 is attributed to the most connected phase configuration while the negative values are indicative of more disconnected phase configurations herring et al 2013 schlüter et al 2016 the non wetting phase percolation maps as well as the euler numbers presented in fig 8 both demonstrate higher degree of non wetting phase connectivity prior to the cdm x n w of approximately 0 037 experiments compared to those of their ddm counterparts e g x n w 0 271 the impact of such fluid configurations on displacements were discussed earlier in this study 5 2 mobilization versus entrapment fig 9 presents the capillary number saturation trends cdcs for the imbibition processes conducted under continuous and discontinuous modes the non wetting phase saturations sor were normalized to that of the first imbibition i e sorw at nca 1 52e 7 and plotted as a function of capillary number nca in region i under the discontinuous mode a negligible change in oil saturation occurred with increase in capillary number under the capillary viscous flow regime i e region ii a gradual decrease in non wetting phase saturation was observed when the capillary number exceeded a threshold value and entered the viscous dominated zone i e region iii the residual oil saturation was reduced remarkably due to mobilization of the trapped clusters under the continuous displacement however the above mentioned reductions in oil saturation were gradual since the desaturation was not dependent on the mobilization process moreover at any given capillary number the residual oil saturation was lower during the continuous mode for instance at the capillary number of 1 9e 5 the incremental oil recovery compared to that of the capillary dominated imbibition was 19 and 29 under ddm and cdm respectively this was associated with the fact that the pressure required to displace the connected non wetting phase clusters was notably lower than that needed to fragment relocate and mobilize the trapped non wetting phase globules i e ganglions dynamics as discussed earlier the generated cdcs are also compared against the data obtained from experiments performed on a water wet fired berea sandstone chatzis and morrow 1984 and an unconsolidated glass bead pack morrow et al 1988 one should note that the above mentioned studies used various formulas of the classic definitions i e the micro scale equations of the capillary numbers therefore we have plotted the desaturation data versus capillary numbers calculated either using eq 1 or a formula based on the pressure drop i e nca micro kδp lσnww i e eq 4 where δp l is the pressure gradient along the length of the core in pa m and k is the absolute permeability in m2 both formulas capture the macro scale desaturation behavior and enable us to compare the results with the literature data fig 9 a demonstrates that the critical capillary numbers of oil mobilization for the ddm test in our study are similar to those reported by chatzis and morrow 1984 in berea sandstone this figure also illustrates that the cdcs generated under both displacement modes are comparable for both studies the higher oil recoveries obtained by chatzis and morrow particularly beyond the critical capillary number i e region iii are mainly associated with a lower oil viscosity used in their experiments approximately 2 05 compared to 70 mpa s in our case this would facilitate the mobilization of trapped oil clusters and hence reduce the residual oil saturation the aforementioned discrepancy was less pronounced under the cdm since the displacements were not dominated by the mobilization furthermore fig 9 b shows that critical capillary numbers of mobilization were significantly greater for the glass bead pack compared to those of the berea sandstone the exceedingly higher capillary numbers reported for oil mobilization in the glass bead packs are attributed to the pore space topology of the medium artificially made porous media are usually well sorted and have more uniform pore size distributions and lower aspect ratios compared to natural porous media this means that in the former group of porous systems the non wetting phase is trapped in the form of single globules the drag ratio required for mobilization increases and the globules become less prone to mobilization under a given capillary number morrow et al 1988 wardlaw and mckellar 1985 it is imperative to mention that the micro scale equations e g eq 1 and 4 assume that the capillary and viscous forces act over identical length scales and overlook the topology of non wetting phase clusters which can span over numbers of pore elements hence the threshold nca micro of mobilization varies from one rock fluid system to another and ranges from 1e 4 to 1e 5 dullien 2012 morrow et al 1988 instead of the theoretically expected value of 1 this shortcoming has been addressed by introducing macro scale cluster based capillary numbers such as eq 5 defined by hilfer and øren 1996 or its modifications armstrong et al 2014 5 n c a m a c r o v w μ w l p b k where l is the non wetting phase cluster length in m and pb is the capillary pressure at the breakthrough in pa some of these macro scale equations were utilized to plot the capillary number saturation curves for experimental data sets and in some cases indicated a threshold nca macro of approximately 1 for the mobilization process under the continuous displacement protocol for the discontinuous systems however the use of these equations was found to be invalid anton and hifler 1999 moreover the average number of clusters per unit volume in a scanned fov may not be representative of that in the core sample see khisvand et al 2016 hence the cluster based capillary numbers may not correctly reflect the core scale desaturation behavior in addition to the concerns mentioned above we intended to compare our observations against data reported in the literature which mostly have been presented using eq 1 and 4 abrams a 1975 chatzis and morrow 1984 jamaloei et al 2010 khishvand et al 2019 larson et al 1981 morrow et al 1988 hence as discussed earlier we used eq 1 and 4 in the capillary number calculations 5 3 oil cluster analysis fig 10 a and b demonstrate the normalized frequency distributions of oil blobs trapped by the imbibition tests for systems with initially continuous and discontinuous oil respectively in each case the trapped globules were separated and categorized in several bins based on their volumes the frequency of the globules within each bin was then divided by the total number of globules for that specific imbibition test to calculate the relative frequency values as seen in fig 10 a for the continuous system conducting imbibition under both capillary viscous and viscous dominated flow regimes not only resulted in greater oil recoveries but also generated oil blob distributions with narrower ranges and increased contributions of the intermediate sized oil globules 1e 3 µm3 volume 1e 8 µm3 compared to those of the capillary dominated imbibition such alterations were believed to be associated with i changes in the order of displacements which prevented oil from being trapped in a large network of pores and ii fragmentation process which divided the large oil globules into smaller ones for the discontinuous system however the capillary viscous and viscous dominated flow regimes behaved differently the viscous dominated imbibition as we discussed previously mobilized a significant amount of trapped oil clusters and hence led to a globules distribution similar to what we observed in the continuous system the capillary viscous imbibition on the other hand only slightly reconfigured the intermediate sized globules and fragmented and or partially produced the largest ones this was in line with the fact that the capillary viscous flow did not significantly affect the saturation when the oil globules were mostly trapped 6 summary and conclusion in this study a large group of experiments were carried out to systematically examine how changes in the desaturation water displacing oil protocol affect the residual non wetting phase saturation and topology of its trapped clusters we performed ten two phase unsteady state flow experiments on a miniature water wet berea sandstone at elevated pressure under flow regimes with vastly different capillary numbers this included three drainage imbibition cycles for the continuous mode and one drainage imbibition cycle one drainage and five imbibition tests in the case of discontinuous displacement mode we used the established pore scale displacement mechanisms and the observed pore scale fluid occupancy maps to explain the differences in the capillary desaturation curves the following conclusions are made based on the results of the flow experiments 1 the in situ saturation data show that at a given capillary number waterflood oil recovery under cdm is greater than that under ddm due to initially more connected non wetting phase clusters that can be displaced by changes in the order of pore scale displacement events 2 the recovery under continuous mode improved gradually with increases in capillary number however when the oil was mostly trapped due to a preceding imbibition i e ddm mode the oil clusters could only be produced by mobilization and hence there was no significant improvement in recovery by increasing the capillary number unless the critical mobilization capillary number was reached 3 direct evidences of entrapment mobilization and changes in pore scale displacement mechanisms by increasing viscous pressure drop under different capillary desaturation modes were presented and discussed 4 we observed previously unreported pore scale displacement events such as fragmentation and coalescence of trapped non wetting phase globules at intermediate capillary numbers i e during capillary viscous imbibition tests some of the fragmented oil blobs were believed to be entrained and produced this phenomenon was responsible for the slight reduction in the non wetting phase saturation during the capillary viscous imbibition tests under the ddm protocol 5 the cdc was found to be dependent on the protocol by which the desaturation was established cdm desaturation process was gradual and occurred at any flow rate whereas ddm desaturation possessed a sharper trend and took place only when a sufficient drag force was exerted to the trapped oil clusters 6 the statistical analysis of the trapped oil clusters revealed that viscous dominated imbibition under both cdm and ddm protocols generated similar frequency distributions that were significantly different from those of the capillary dominated imbibition tests credit authorship contribution statement abdelhalim i a mohamed conceptualization investigation visualization writing original draft formal analysis mahdi khishvand conceptualization writing review editing formal analysis mohammad piri conceptualization supervision writing review editing funding acquisition formal analysis declaration of competing interest none acknowledgments we gratefully acknowledge the financial support of hess corporation halliburton and the school of energy resources at the university of wyoming we also extend our gratitude to dr masakazu gesho of the piri research group for his help in generating the percolation maps of the non wetting phase supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103702 appendix supplementary materials image application 1 image application 2 
415,a series of micro scale core flooding experiments were conducted in a miniature water wet berea sandstone sample to examine how changes in the desaturation water displacing oil protocol impact the non wetting phase recovery and to provide to the best of our knowledge the first pore scale evidences of the associated displacement subtleties we studied i the continuous displacement mode cdm which consisted of a series of imbibition tests with increasing capillary numbers and similar initially connected oil and ii the discontinuous displacement mode ddm which included a drainage followed by a multi rate imbibition test during all experiments a cutting edge imaging platform was employed to visualize the fluid occupancies in the pore space the in situ saturation measurements showed that at a given capillary number the non wetting phase recovery was more efficient under the continuous mode during which the oil phase was connected prior to each imbibition this is attributed to the changes in the order by which the pore scale displacement events take place before entrapment for the ddm however the entrainment of oil clusters is the governing recovery mechanism and the desaturation process was observed only when a threshold capillary number was reached these findings are supported by pore scale fluid occupancy maps demonstrating piston like and snap off events during the capillary driven flow processes as well as trapped cluster entrainment during the viscous dominated flow tests moreover this investigation presents previously unidentified pore scale displacement events in natural porous media such as fragmentation and coalescence of trapped non wetting phase globules prior to entrainment these mechanisms took place at intermediate capillary numbers and mostly under the discontinuous displacement mode before the threshold of mobilization was reached the capillary desaturation process under cdm was found to be gradual and more pronounced compared to that under the ddm mode it is also demonstrated that even though the pore scale displacement mechanisms responsible for oil recovery are different for cdm and ddm the viscous dominated imbibition tests produce similar distributions of trapped oil clusters under both cases keywords core flooding experiment micro computed tomography imaging capillary desaturation process desaturation protocols pore scale displacement mechanisms 1 introduction capillary and viscous forces are two of the key factors that control the trapping and mobilization of non wetting phase during immiscible imbibition processes in porous media as an imbibition process occurs and the wetting phase advances through the pore space under either unsteady state or steady state flow scenarios capillary forces entrap the non wetting phase in a single pore element or a cluster of pores which in turn leads to the loss of non wetting phase hydraulic conductivity abrams 1975 aghaei and piri 2015 anton and hilfer 1999 lake 1989 mohanty et al 1987 roof 1970 the trapped non wetting phase may later be mobilized by reducing the capillary forces or increasing the viscous forces larson et al 1981 jamaloei et al 2010 the relative strength of these factors is typically quantified through capillary number nca the common definitions of nca at the micro scale are presented in eq 1 and 2 abrams 1975 chatzis and morrow 1984 hilfer and øren 1996 leal 2007 morrow et al 1988 saffman and taylor 1958 1 n ca micro v w μ w σ nww 2 n ca micro v w μ w ϕ σ nww cos θ nww μ w μ nw 0 4 where vw is the darcy velocity of the invading phase in m s µw and µnw stand for the viscosities of the wetting and non wetting phases respectively in pa s σnww denotes the fluid fluid interfacial tension in n m and θnww is the contact angle between the wetting and non wetting phases on the rock surface eq 2 is a general form of eq 1 that takes into account additional parameters such as wettability viscosity ratio of the fluids and porosity of the sample ϕ the amount of residual non wetting phase saturation for a specific pore space topology and wettability condition is believed to be dependent on the fluid fluid interfacial properties invading fluid velocity and viscosities of the displacing and displaced fluids all of these factors are included in the above mentioned definitions of the capillary number the relationship between the residual non wetting saturation snwr and capillary number is demonstrated through capillary desaturation curves cdcs and for decades was thought to be unique for a given rock fluids system blunt 2017 sahimi 2011 satter et al 2008 however recent studies have shown that the snwr nca relationship is also dependent on the initial fluid configuration and the sequence of flow processes i e the manner in which the desaturation is established chatzis and morrow 1984 hilfer et al 2015 morrow et al 1988 xu et al 2018 these various sequences of flow experiments are referred to as displacement modes a capillary desaturation curve can be generated under either continuous or discontinuous displacement mode the continuous displacement mode cdm includes multiple cycles of drainage imbibition processes with increasing capillary numbers for the imbibition tests the imbibition tests are followed by identical drainage events to establish similar initial saturation conditions i e to create initially connected non wetting phase clusters prior to each imbibition the discontinuous displacement mode cdm however refers to displacement of the non wetting phase ganglia that had been hydraulically disconnected trapped due to a preceding imbibition process in the discontinuous mode a core sample at initial wetting phase saturation i e post primary drainage is subjected to a single multi rate imbibition process with stepwise increases in the wetting phase flow rate or capillary number while the residual non wetting phase saturation is measured at the end of each stage the governing recovery mechanisms during a capillary desaturation process strongly depend on the flow protocol the cdm and ddm displacement scenarios are governed by two types of distinct pore level displacement mechanisms reduction in oil saturation during the ddm tests is controlled by mobilization of trapped globules due to drag forces whereas in the case of cdm experiments where the non wetting phase is connected prior to each imbibition test changes in the order of displacements govern saturation changes with variations in flow rate anton and hilfer 1999 chatzis and morrow 1984 however the impacts of the aforementioned differences in displacement physics on non wetting phase saturation in natural porous media are poorly understood hence experimental investigations of the process dependency of capillary desaturation in such media are warranted the majority of experimental investigations on cdc have been dedicated to the study of the displacement physics governing flow behavior under the discontinuous mode armstrong et al 2014 chatzis et al 1988 chevalier et al 2015 georgiadis et al 2013 herring et al 2013 joekar niasar et al 2013 khishvand et al 2016 rodríguez de castro et al 2015 rücker et al 2015 schlüter et al 2016 youssef et al 2015 wardlaw and mckellar 1985 nonetheless a few investigations have probed the process dependent desaturation experimentally in these studies porous media with widely different transport properties were used to examine the entrapment and mobilization of residual oil they have found that displacing connected non wetting clusters i e desaturation under the continuous mode is considerably easier than the mobilization of trapped globules i e desaturation under the discontinuous mode chatzis and morrow 1984 morrow et al 1988 these studies however have failed to provide direct pore scale evidence of the underpinning displacement mechanisms responsible for oil recovery this is primarily due to the absence of appropriate experimental technologies during the past few decades the advent of imaging technologies e g micro computed tomography and their integration with flow instruments has made it possible to investigate fluid flow in natural porous media at the pore level where phenomenological processes are explicitly resolved motivated by the aforementioned narrative in the course of this study we investigated the capillary desaturation process as a function of displacement protocol we present the results of a series of unsteady state miniature core flooding experiments under capillary and viscus dominated flow regimes the tests were performed to generate cdcs under continuous and discontinuous displacement modes the experiments were conducted in a fired berea sandstone at elevated pressure and using a state of the art miniature core flooding setup integrated with a high resolution micro computed tomography µ ct scanner pore scale fluid occupancy maps as well as in situ saturation data are analyzed to shed light on subtle details of how desaturation protocols impact the pore scale displacement mechanisms and fluids spatial distributions in the following sections we first present the materials and the experimental setup and procedures that are employed to carry out the tests this is then followed by the results and discussion of the observations and finally a set of concluding remarks 2 porous medium and fluids the flow experiments were performed on a fired berea sandstone ss sample 4 93 mm in diameter and 68 17 mm in length drilled from a parent core plug with a diameter of 38 mm the miniature core sample was fired at 500 c 932 f for two hours to stabilize clay minerals and minimize clay swelling and fines migration we used berea sandstone due to its wide polydisperse pore size distribution psd that provides a broad range of trapped clusters sizes the average porosity of the rock specimen was calculated from the segmented µ ct images of the dry sample and found to be 17 6 this value was similar to the porosity of the parent core plug measured using an automated ap 608 helium porosimeter i e 19 7 the absolute permeability to brine for the miniature core sample was measured to be 620 12 md the aqueous phase brine was prepared by mixing 0 99 wt nacl with 0 01 wt nan3 in distilled water the oil phase was a mixture of 90 vol purified viscous white mineral oil gloria courtesy of sonneborm and 10 vol iodooctane the iodooctane was used as a dopant to enhance the contrast between the two fluid phases in the µ ct images the dynamic viscosities of the aqueous and oil phases were measured using an anton paar viscometer at 21 c and were found to be 1 05 0 05 and 70 1 04 mpa s respectively the oil brine interfacial tension measured using the rising bubble technique was 24 1 0 76 mn m the aqueous and oil phases hereafter are referred to as the wetting and non wetting phases respectively 3 experimental setup the experiments were carried out utilizing a unique open loop core flooding apparatus see fig 1 integrated with a µ ct scanner used to image the pore space during various flow processes the core flooding setup consisted of a custom built miniature core holder six dual cylinder pumps quizix q5000 ametek and an array of rosemount high precision differential pressure transducers the pumps were used to deliver pulse free flow of fluids at specific flow rates to the inlet of the core sample receive effluent from the outlet at a desired constant pressure and maintain a constant radial overburden stress on the sleeve surrounding the core sample the core flooding setup was coupled with a cutting edge true helical cone beam high cone angle 100 micro ct scanner heliscan thermofisher scientific that enabled us to generate three dimensional fluid occupancy maps at the pore level while the flow of fluid phases was maintained additional details of the core flooding system can be found elsewhere alizadeh et al 2014 4 experimental procedure the flooding sequences to generate the cdcs under different desaturation protocols are depicted in fig 2 the berea ss sample was first placed in the vertically oriented miniature core holder and subsequently a low confining pressure 1 39 mpa was applied this step was followed by injecting gaseous co2 to remove the bulk air from the pore space the sample was then imaged at a resolution of 2 29 µm to obtain the reference dry scan for accurately mapping the pore space and generating porosity distribution along the field of view fov the fov as indicated by the red squares in fig 2 was 5 89 mm 5 89 mm 3 22 mm afterward the core was vacuum saturated with the wetting phase and the pore and confining pressures were simultaneously increased to 4 14 and 5 52 mpa 600 and 800 psi respectively at 21 c at this point another scan was performed to ensure that the sample was fully saturated with the wetting phase subsequently the absolute permeability of the rock was measured based on the steady state pressure drop data acquired at five different constant flow rates the sample was then subjected to a primary drainage process by injecting the non wetting and wetting phases at flow rates of 0 003 and 0 01 cm3 min respectively after injecting five pore volumes of the non wetting phase its flow rate was gradually reduced to 0 001 cm3 min while the wetting fluid flow was ceased this procedure was particularly employed to establish an initial wetting phase saturation of approximately 20 using displacement by the viscous non wetting phase the core sample with the pre established initial oil saturation was then subjected to two categories of imbibition tests i e continuous and discontinuous displacement modes cdm and ddm respectively each imbibition set included multiple increasing flow rates in order to generate the respective capillary desaturation curve under the cdm mode each imbibition was followed by a drainage process to generate similar initial oil saturations for all cases whereas the ddm mode was one multi stage imbibition process with stepwise increases in the injection flow rate it should be noted that all experiments were conducted on the same rock specimen hence the pore size distribution topology and wettability were identical for all flow experiments for each stage of the flow experiments when the pressure drop and fluid configuration examined by consecutive scans became stable the mid section of the core i e the fov was imaged at a resolution of 2 29 µm the flow was maintained during image acquisition periods to prevent the relaxation of the fluid fluid interfaces the acquired µ ct images were processed and analyzed using avizo fire 9 4 developed by thermofisher scientific usa the processing step included image cropping filtering non local means and median filters and registration of the wet flooded images with the dry reference image the registered wet images were then combined with the pore map generated from the dry reference image and segmented to obtain the wetting and non wetting phase distributions the detailed description of this method is available elsewhere khishvand et al 2016 5 results and discussion in this section we present the result of the capillary desaturation experiments performed on the core sample when the non wetting oil phase was continuous or discontinuous prior to the imbibition tests we first provide saturation distributions and exhibit pore scale fluid occupancy maps to explain the observed saturation trends this is then followed by the discussion of the cdcs generated for the two displacement protocols and a comparison with the data available in the literature finally a detailed analysis of the frequency distributions of trapped oil globules is presented it is important to emphasize that the temporal resolutions of laboratory micro ct scanners are typically not sufficiently high to resolve the dynamic events e g instantaneous pore filling or snap off taking place during the flow tests therefore in this study the displacements were inferred from the comparison between pore space images at the end of various stages of the experiments the physics of these events have been theoretically predicted cieplak and robbins 1988 mohanty et al 1987 rose and witherspoon 1956 and experimentally observed using fast synchrotron x ray micro tomography techniques singh et al 2017 youssef et al 2014 5 1 pore scale fluid occupancy maps and in situ saturations fig 3 a and b show the distributions of in situ saturations along the fovs for the drainage and imbibition experiments when the non wetting phase was discontinuous and continuous respectively slight perturbations in the saturation data were associated with local flow fields and porosity variations it should be emphasized that the bond number i e the ratio of buoyancy to capillary forces morrow and songkran 1981 for this experiment was approximately 5 40e 11 this value was sufficiently small to assume that the impact of gravity could be neglected compared to those of viscous and capillary forces moreover the contact angle measurements obtained at the end of the primary drainage and the imbibition for both cdm and ddm tests showed average values of approximately 50 and 55 respectively the distributions of contact angles are presented in figure s1 these observations confirm that wettability of the rock sample stayed unchanged during the course of this study which was expected because polar components and impurities were removed from the mineral oil prior to use in the experiments since the wettability and pore space morphology were similar in all experiments it was plausible to consider the interplay of capillary and viscous forces as the only factor that governed the variations in fluid saturations table 1 summarizes the residual oil saturations at different stages of the experiments the saturation data was further augmented with examples of fluid occupancy maps see figs 4 6 to help interpret the changes from one case to another the variations in non wetting phase saturation can be categorized under three different regions including capillary dominated capillary viscous i e transient and viscous dominated flow regimes the capillary numbers for the various flow regimes can be determined based on the saturation trends as well as the pore scale observations a range of capillary numbers over which the displacements are considered capillary driven and the residual non wetting phase saturation stays fairly constant is referred to as the capillary dominated flow regime the viscous dominated flow regime on the other hand is when the saturation reduces considerably with increases in flow rate and consequently pressure drop due to significant changes in the order of displacements or the entrainment of oil clusters 5 1 1 capillary dominated flow regime i e approximately nca 1e 6 the drainage with oil led to an initial oil saturation of approximately 0 83 for both sets of experiments after each drainage process oil formed a connected network spanning over the porous medium while brine resided in small pore elements and crevices the first waterflood experiment no 2 was then deployed at a low flow rate of 0 004 cm3 min i e nca 1 52e 7 to subject the porous medium to a capillary dominated forced imbibition this stage was conducted once and the results were interpreted and used for both the cdm and ddm protocols the introduction of brine into the inflow end of the sample changed the local capillary pressures as a result brine invaded into the oil filled pores elements with an order of the smallest to largest and displaced oil through connected oil ganglia e g piston like displacement toward the outflow end meanwhile in the corner of pore elements and throats oil brine contact angles hinged toward their advancing values while the interfaces arc menisci were pinned in their locations when the advancing contact angles were reached the interfaces moved toward the center of pores due to rises in local water pressures while the contact angles stayed constant once these menisci met each other in a pore throat to the entrance of which water had no access the corresponding pore throat was instantaneously filled with the brine this process is known as snap off and traps a significant amount of the oil phase in the pore space behind the waterflooding front rose and witherspoon 1956 roof 1970 pore scale evidence of this phenomenon is observed when area 1 of fig 4 b is compared to the same site in fig 4 a in addition to the piston like and snap off evets cooperative pore body filling mechanism had also played a pivotal role in the displacement and trapping of oil ganglia in this porous system nonetheless as discussed earlier the dynamic changes during this event could not be visualized due to the limited temporal resolution of the micro ct images 5 1 2 capillary viscousflow regime i e approximately 1e 6 nca 4e 6 the capillary dominated imbibition was then continued by two waterfloods under the discontinuous mode at capillary numbers of 7 62e 7 experiment no 3 and 3 81e 6 experiments no 4 for the continuous mode however an imbibition process experiment no 8 at a capillary number of 3 81e 6 was carried out once the initial water saturation was re established through experiment no 7 the in situ saturation data for the discontinuous case i e when the oil was mostly trapped due to the preceding capillary dominated waterflood illustrate negligible changes in oil saturation with increases in waterflooding flow rate as opposed to the discontinuous system when the oil was continuous prior to the higher capillary number waterflood changes in saturation with the increase in capillary number were significant compare the black and red curves in fig 3 b as it is demonstrated in the selected areas of fig 4 changes in capillary number slightly mobilized and re arranged the oil clusters under the discontinuous mode compare fig 4 b and c whereas in the case of the continuous system the oil cluster configuration was significantly impacted by the increase in capillary number compare fig 4 c and d this difference in behavior can be explained using the governing displacement mechanisms 1 changes in the order of pore scale displacements when the oil clusters are not trapped prior to the imbibition i e the cdm rises in wetting phase flow rate increases its viscous pressure drop that changes the overall threshold pressures of the water to oil displacements which are affected by the pressure drops due to capillarity viscous and gravitational forces this consequently alters the order by which such displacement events take place as a result the displacement of oil from larger pores and the pore elements closer to the inlet would be favored over those in smaller pores or the pore elements located at farther distances from the inlet this in turn suppresses snap off events providing further opportunities for the wetting phase to displace more oil through piston like and cooperative pore body filling processes and reduce residual oil saturation this phenomenon was responsible for the significant change in oil saturation under the continuous mode at intermediate capillary numbers compared to the capillary dominated flow regime this can be realized when one compares designated areas 2 to 5 in fig 4 b and d conducting waterflood at an intermediate capillary number fig 4 d displaced oil from some large elements while fewer small pore elements were invaded compared to the displacement under the capillary dominated flow regime fig 4 b 2 mobilization of trapped oil globules the oil clusters trapped in the pore space are subjected to drag force exerted by the wetting phase for a given trapped globule once this exceeds certain threshold value which depends on fluid properties the diameter of the most constricted regions of the pores and the size of the cluster the wetting fluid can mobilize it the dislodged globules can subsequently be fragmented or coalesce with other globules the coalesced blobs will later be relocated and or produced we believe these mechanisms contributed to the slight changes in saturation seen under the discontinuous mode these become evident when the selected areas 1 and 2 blob coalescence and 3 and 4 blob fragmentation of fig 5 b are compared to those in fig 5 a it should be noted that the coalescence and mobilization might have also taken place under the continuous mode after the oil globules were trapped as it is evident from the saturation trends and fluid occupancy maps oil saturation was only slightly reduced under the discontinuous mode meaning that the mobilization thresholds were not surpassed for majority of the oil globules under the continuous mode however the changes were more pronounced due to changes in the order of the displacements it should be noted that in addition to the above mentioned displacement mechanisms increases in local water pressures at higher capillary numbers always slightly changes the curvature of the oil brine interfaces and also trigger snap off displacement events which in turn break up the large oil clusters into smaller ones as depicted in fig 6 5 1 3 viscous dominated flow regime i e approximately nca 4e 6 fig 3 shows notable changes in oil saturations for both ddm and cdm modes when the injection flow rate was increased to 0 5 cm3 min i e nca 1 90e 5 the displacement mechanisms governing flow behavior under high and intermediate capillary numbers are similar however the displacement of oil from larger pore elements particularly under the ddm case was more pronounced compared to that observed in the capillary viscous flow regimes fig 7 compares examples of fluid occupancy produced under viscous and capillary dominated displacement regimes the significantly higher brine flow rate strongly impacted the pressure fields and order of displacements for the continuous system moreover under both ddm and cdm modes the viscous forces exerted due to the dynamic effect created a massive mobilization front across the sample which displaced trapped oil globules from their original sites compare selected areas 1 3 in fig 7 a b and c and caused notable reductions in residual oil saturations it should be noted that as fig 3 demonstrates capillary desaturation under ddm was considerable and observed only when the mobilization threshold was satisfied whereas in the cdm saturation changes were greater and more gradual we observed additional recovery of 21 46 and 28 3 for the viscous dominated ddm and cdm respectively compared to the imbibition under the capillary dominated flow regime to further investigate the possibility of oil globule mobilization during the imbibition tests under different flow conditions the corresponding drag ratios i e the ratio of viscous to capillary forces were calculated using eq 3 taber et al 1973 3 d r a g r a t i o δ p l σ n w w where δp l is the pressure gradient along the core in psi ft and σnww is the oil brine interfacial tension in dyne cm the calculated drag ratios are compared against the macro scale mobilization threshold in table 2 the threshold drag ratio for the viscous oil used in this study was calculated using an empirical correlation developed for a similar rock sample taber et al 1973 the drag ratios indicate that the mobilization threshold was not exceeded for the majority of the imbibition stages meaning that the possibility of mobilization due to drag forces is insignificant except for the last two imbibition tests under ddm and the last imbibition under cdm the higher drag ratios observed during the ddm tests are related to a significantly greater jamin effect in these cases as we discussed earlier the residual oil saturations were greater in the ddm processes compared to the cdm counterparts and the oil clusters would occupy a greater number of large and intermediate sized pore elements in the former case this in turn would lead to a greater resistance to flow wright 1933 at any given flow rate the pressure drop along the core and hence the likelihood of mobilization were greater under the ddm waterflooding experiments nevertheless the oil recovery was more efficient under the continuous displacement mode this is attributed to the fact that before each cdm test the non wetting phase was connected therefore increases in capillary number boosted the oil recovery mostly through changes in the order of displacement events and the displacement mechanisms were more likely to be piston like and cooperative pore body filling in the case of the ddm experiments however the majority of the incremental recovery was the result of mobilization of the previously trapped oil globules to further demonstrate the higher degree of connectivity of oil clusters prior to the cdm tests we generated the non wetting phase percolation maps of the entire remaining residual oil i e the oil clusters disconnected gray and connected red to the inlet of the fov as shown in fig 8 before various waterflood experiments we have also calculated the normalized euler number of the entire remaining residual oil i e the euler number of oil divided by the euler number of the pore space the details of the image analysis are presented in the supplementary materials the euler number euler poincaré characteristic is a topological invariant that is commonly used in the digital rock physics to characterize the connectivity of fluids within the pore space feali et al 2012 vogel 2002 a maximum normalized euler number of 1 0 is attributed to the most connected phase configuration while the negative values are indicative of more disconnected phase configurations herring et al 2013 schlüter et al 2016 the non wetting phase percolation maps as well as the euler numbers presented in fig 8 both demonstrate higher degree of non wetting phase connectivity prior to the cdm x n w of approximately 0 037 experiments compared to those of their ddm counterparts e g x n w 0 271 the impact of such fluid configurations on displacements were discussed earlier in this study 5 2 mobilization versus entrapment fig 9 presents the capillary number saturation trends cdcs for the imbibition processes conducted under continuous and discontinuous modes the non wetting phase saturations sor were normalized to that of the first imbibition i e sorw at nca 1 52e 7 and plotted as a function of capillary number nca in region i under the discontinuous mode a negligible change in oil saturation occurred with increase in capillary number under the capillary viscous flow regime i e region ii a gradual decrease in non wetting phase saturation was observed when the capillary number exceeded a threshold value and entered the viscous dominated zone i e region iii the residual oil saturation was reduced remarkably due to mobilization of the trapped clusters under the continuous displacement however the above mentioned reductions in oil saturation were gradual since the desaturation was not dependent on the mobilization process moreover at any given capillary number the residual oil saturation was lower during the continuous mode for instance at the capillary number of 1 9e 5 the incremental oil recovery compared to that of the capillary dominated imbibition was 19 and 29 under ddm and cdm respectively this was associated with the fact that the pressure required to displace the connected non wetting phase clusters was notably lower than that needed to fragment relocate and mobilize the trapped non wetting phase globules i e ganglions dynamics as discussed earlier the generated cdcs are also compared against the data obtained from experiments performed on a water wet fired berea sandstone chatzis and morrow 1984 and an unconsolidated glass bead pack morrow et al 1988 one should note that the above mentioned studies used various formulas of the classic definitions i e the micro scale equations of the capillary numbers therefore we have plotted the desaturation data versus capillary numbers calculated either using eq 1 or a formula based on the pressure drop i e nca micro kδp lσnww i e eq 4 where δp l is the pressure gradient along the length of the core in pa m and k is the absolute permeability in m2 both formulas capture the macro scale desaturation behavior and enable us to compare the results with the literature data fig 9 a demonstrates that the critical capillary numbers of oil mobilization for the ddm test in our study are similar to those reported by chatzis and morrow 1984 in berea sandstone this figure also illustrates that the cdcs generated under both displacement modes are comparable for both studies the higher oil recoveries obtained by chatzis and morrow particularly beyond the critical capillary number i e region iii are mainly associated with a lower oil viscosity used in their experiments approximately 2 05 compared to 70 mpa s in our case this would facilitate the mobilization of trapped oil clusters and hence reduce the residual oil saturation the aforementioned discrepancy was less pronounced under the cdm since the displacements were not dominated by the mobilization furthermore fig 9 b shows that critical capillary numbers of mobilization were significantly greater for the glass bead pack compared to those of the berea sandstone the exceedingly higher capillary numbers reported for oil mobilization in the glass bead packs are attributed to the pore space topology of the medium artificially made porous media are usually well sorted and have more uniform pore size distributions and lower aspect ratios compared to natural porous media this means that in the former group of porous systems the non wetting phase is trapped in the form of single globules the drag ratio required for mobilization increases and the globules become less prone to mobilization under a given capillary number morrow et al 1988 wardlaw and mckellar 1985 it is imperative to mention that the micro scale equations e g eq 1 and 4 assume that the capillary and viscous forces act over identical length scales and overlook the topology of non wetting phase clusters which can span over numbers of pore elements hence the threshold nca micro of mobilization varies from one rock fluid system to another and ranges from 1e 4 to 1e 5 dullien 2012 morrow et al 1988 instead of the theoretically expected value of 1 this shortcoming has been addressed by introducing macro scale cluster based capillary numbers such as eq 5 defined by hilfer and øren 1996 or its modifications armstrong et al 2014 5 n c a m a c r o v w μ w l p b k where l is the non wetting phase cluster length in m and pb is the capillary pressure at the breakthrough in pa some of these macro scale equations were utilized to plot the capillary number saturation curves for experimental data sets and in some cases indicated a threshold nca macro of approximately 1 for the mobilization process under the continuous displacement protocol for the discontinuous systems however the use of these equations was found to be invalid anton and hifler 1999 moreover the average number of clusters per unit volume in a scanned fov may not be representative of that in the core sample see khisvand et al 2016 hence the cluster based capillary numbers may not correctly reflect the core scale desaturation behavior in addition to the concerns mentioned above we intended to compare our observations against data reported in the literature which mostly have been presented using eq 1 and 4 abrams a 1975 chatzis and morrow 1984 jamaloei et al 2010 khishvand et al 2019 larson et al 1981 morrow et al 1988 hence as discussed earlier we used eq 1 and 4 in the capillary number calculations 5 3 oil cluster analysis fig 10 a and b demonstrate the normalized frequency distributions of oil blobs trapped by the imbibition tests for systems with initially continuous and discontinuous oil respectively in each case the trapped globules were separated and categorized in several bins based on their volumes the frequency of the globules within each bin was then divided by the total number of globules for that specific imbibition test to calculate the relative frequency values as seen in fig 10 a for the continuous system conducting imbibition under both capillary viscous and viscous dominated flow regimes not only resulted in greater oil recoveries but also generated oil blob distributions with narrower ranges and increased contributions of the intermediate sized oil globules 1e 3 µm3 volume 1e 8 µm3 compared to those of the capillary dominated imbibition such alterations were believed to be associated with i changes in the order of displacements which prevented oil from being trapped in a large network of pores and ii fragmentation process which divided the large oil globules into smaller ones for the discontinuous system however the capillary viscous and viscous dominated flow regimes behaved differently the viscous dominated imbibition as we discussed previously mobilized a significant amount of trapped oil clusters and hence led to a globules distribution similar to what we observed in the continuous system the capillary viscous imbibition on the other hand only slightly reconfigured the intermediate sized globules and fragmented and or partially produced the largest ones this was in line with the fact that the capillary viscous flow did not significantly affect the saturation when the oil globules were mostly trapped 6 summary and conclusion in this study a large group of experiments were carried out to systematically examine how changes in the desaturation water displacing oil protocol affect the residual non wetting phase saturation and topology of its trapped clusters we performed ten two phase unsteady state flow experiments on a miniature water wet berea sandstone at elevated pressure under flow regimes with vastly different capillary numbers this included three drainage imbibition cycles for the continuous mode and one drainage imbibition cycle one drainage and five imbibition tests in the case of discontinuous displacement mode we used the established pore scale displacement mechanisms and the observed pore scale fluid occupancy maps to explain the differences in the capillary desaturation curves the following conclusions are made based on the results of the flow experiments 1 the in situ saturation data show that at a given capillary number waterflood oil recovery under cdm is greater than that under ddm due to initially more connected non wetting phase clusters that can be displaced by changes in the order of pore scale displacement events 2 the recovery under continuous mode improved gradually with increases in capillary number however when the oil was mostly trapped due to a preceding imbibition i e ddm mode the oil clusters could only be produced by mobilization and hence there was no significant improvement in recovery by increasing the capillary number unless the critical mobilization capillary number was reached 3 direct evidences of entrapment mobilization and changes in pore scale displacement mechanisms by increasing viscous pressure drop under different capillary desaturation modes were presented and discussed 4 we observed previously unreported pore scale displacement events such as fragmentation and coalescence of trapped non wetting phase globules at intermediate capillary numbers i e during capillary viscous imbibition tests some of the fragmented oil blobs were believed to be entrained and produced this phenomenon was responsible for the slight reduction in the non wetting phase saturation during the capillary viscous imbibition tests under the ddm protocol 5 the cdc was found to be dependent on the protocol by which the desaturation was established cdm desaturation process was gradual and occurred at any flow rate whereas ddm desaturation possessed a sharper trend and took place only when a sufficient drag force was exerted to the trapped oil clusters 6 the statistical analysis of the trapped oil clusters revealed that viscous dominated imbibition under both cdm and ddm protocols generated similar frequency distributions that were significantly different from those of the capillary dominated imbibition tests credit authorship contribution statement abdelhalim i a mohamed conceptualization investigation visualization writing original draft formal analysis mahdi khishvand conceptualization writing review editing formal analysis mohammad piri conceptualization supervision writing review editing funding acquisition formal analysis declaration of competing interest none acknowledgments we gratefully acknowledge the financial support of hess corporation halliburton and the school of energy resources at the university of wyoming we also extend our gratitude to dr masakazu gesho of the piri research group for his help in generating the percolation maps of the non wetting phase supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103702 appendix supplementary materials image application 1 image application 2 
416,we explore the coupling of surface and subsurface flows on fully unstructured meshes that conform to complex soil structures to accommodate the distorted meshes that inevitably result from explicit representation of complex soil structures we leverage the structure of the mimetic finite difference mfd spatial discretization scheme to couple surface and subsurface flows the mfd method achieves second order accuracy and maintains local mass conservation on distorted meshes we couple the diffusion wave approximation for surface flows to the richards equation for subsurface flow ensuring continuity of both pressure and flux between the surface and subsurface the mfd method is particularly convenient for this coupling because it uses face based constraints in the subsurface system that can be expressed as face pressure unknowns those unknowns are coincident with surface cell based unknowns thus allowing the discrete surface system to be directly substituted into the subsurface system and solved implicitly as a global system robust representation of the transition between wet and dry surface conditions requires upwinding of the relative permeability and is facilitated by globalization in the nonlinear solver the approach and its implementation in the advanced terrestrial simulator ats are evaluated by comparison to previously published benchmarks using runoff from soils with patchy groundcover duff as an example we show that the new method converges significantly faster in mesh convergence tests than the commonly used two point flux approximation keywords mimetic finite differences integrated hydrology complex stratigraphy 1 introduction scientists and decision makers need ever improving quantitative tools to help understand a spectrum of persistent water security challenges vörösmarty et al 2010 including drought groundwater depletion flooding nutrient loading and contaminant transport among the tools available are physically based distributed parameter models that couple three dimensional subsurface representations with surface process models at high spatial resolution traditionally used for site and catchment scale applications physically based integrated models have more recently been used successfully at larger scales to advance our fundamental understanding of components in the terrestrial water cycle maxwell and condon 2016 those initial successes combined with improved data sources and growing computational resources have fueled interest in so called hyper resolution integrated models with sub 100 m resolution over entire river basins wood et al 2011 bierkens et al 2015 regardless of the scale of the application physically based integrated models are most valuable when they are faithful to our best understanding of subsurface properties and capable of exploring sensitivity of results to those properties understanding the sensitivity of hydrologic processes including both flow and transport of chemical species to shallow subsurface structures is a key consideration variable bedrock topography has been shown through both empirical freer et al 2002 and integrated hydrologic model sensitivity studies camporese et al 2019 to control runoff and transient groundwater flow also soil textural contrasts and the spatial organization of surface cover such as litter and duff play a key role in explaining runoff timing and magnitude ebel et al 2012 furthermore soil structure data is increasing available at site scales either directly through geophysics or indirectly through inverse modeling and at larger scales from increasingly detailed online data sources accommodating these examples of geometric complexity where soil horizons and bedrock topography are not parallel to the surface topography leads naturally to unstructured meshes that geometric complexity combined with the need to solve nonlinear equations for both surface and subsurface flow and couple them accurately and efficiently places significant demands on integrated distributed hydrologic codes a large and diverse body of work on integrated surface subsurface hydrology has been developed throughout computational hydrology s history as documented by both review papers singh and woolhiser 2002 kampf and burges 2007 paniconi and putti 2015 and model intercomparisons maxwell et al 2014 kollet et al 2017 we note that the wide variety of methods is a strength of the hydrologic modeling community each method has its advantages in different contexts and the best method and code for a given application requires weighing considerations of physical process representation accuracy and computational efficiency including both scaling and performance while nearly all models use a variably saturated richards equation to model subsurface flow approaches to simplifying the navier stokes equations for surface flow vary most surface water efforts simplify the st venant equations to kinematic wave lighthill and whitham 1955 smith and woolhiser 1971 kollet and maxwell 2006 or diffusion wave morris and woolhiser 1980 restrepo et al 1998 vanderkwaak and loague 2001 camporese et al 2010 weill et al 2009 approximations to solve these equations different approaches exist for methods of coupling surface and subsurface flow spatial discretization and numerical solution those computational considerations are not entirely independent an effective comprehensive strategy must also consider their interactions coupling the surface and subsurface flow equations may be done at the continuous or discrete level and may be implemented as independent solves or solved as an coupled system methods for doing so have been the subject of a variety of classification efforts kampf and burges 2007 furman 2008 which we summarize here the first order exchange coefficient foec approach vanderkwaak and loague 2001 panday and huyakorn 2004 ebel et al 2009 introduces an additional parameter for surface subsurface conductivity while it is an extremely robust approach this coefficient may be difficult to constrain physically continuous pressure approaches whether through sequential iterated or fully implicit coupling enforce continuity of pressure between the surface and subsurface s top boundary these approaches include standard schwarz domain decomposition strategies such as subdomain solves with appropriate boundary conditions from the other domain gandolfi and savi 2000 iterated subdomain solves abbott et al 1986 and globally implicit solutions the latter include approaches such as enforcing the surface flow equations through the use of a nonlinear boundary condition kollet and maxwell 2006 introducing an extra layer of cells to the subsurface domain on which to hold surface pressures weill et al 2009 kumar et al 2009 and leveraging face unknowns inherent in the subsurface discretization to discretely enforce continuity dawson 2008 continuous pressure approaches can be less robust than foec methods morita and yen 2002 and are likely either subject to large errors in the case of sequential coupling panday and huyakorn 2004 or are computationally demanding requiring custom preconditioners and solver globalization lipnikov et al 2016b osei kuffuor et al 2014 hybrid approaches have also been derived including those based on boundary condition switching camporese et al 2010 dagès et al 2012 or regularization penalty methods de maet et al 2015 the implications of coupling method and time integration strategies are discussed in morita and yen 2002 and furman 2008 and have been observed to affect the resulting spatially temporally converged solution sulis et al 2010 maxwell et al 2014 kollet et al 2017 the accuracy of approximations of that solution huang and yeh 2009 and likely the computational performance independently of the work on coupling surface and subsurface flow systems the reservoir modeling and mathematics communities have collaborated closely to lead in the development of discretization methods for subsurface flow here we focus on spatial discretization methods that are both locally conservative and capable of accommodating distorted unstructured meshes that conform to complex subsurface structures with discontinuous permeability parameters locally conservative spatial discretization methods are critical for applications involving transport of chemical species the most well known locally conservative discretization is the finite volume method with a two point flux approximation fv tpfa which has advantages of local conservation monotonicity and simplicity of implementation but has known accuracy issues under non voronoi meshes and can even be non convergent in some cases zyvoloski and vesselinov 2006 lipnikov et al 2014 limiting the generality of meshes that can be used methods built on multi point flux methods mixed forms i e including face based flux unknowns in addition to cell centered pressure unknowns mixed hybrid forms i e mixed forms that additionally introduce face centered constraints discontinuous galerkin methods and mimetic finite difference methods were each developed for general elliptic problems improving accuracy and generality of meshes that are acceptable for simulation and have been widely adopted in the reservoir simulation community see klausen and russell 2004 for an excellent comparison of the tradeoffs of these methods those methods are not as widely used in integrated distributed hydrologic models with the notable exception of hydrogeosphere brunner and simmons 2012 which uses the control volume finite element method and cast3m weill et al 2009 which uses the mixed hybrid finite element method other papers demonstrating these methods on integrated hydrology problems include inhm vanderkwaak 1999 dawson 2008 and kumar et al 2009 who use the control volume finite element method a discontinuous galerkin method and a second order finite volume method respectively the mimetic finite difference mfd method lipnikov et al 2014 da veiga et al 2014 is a family of discretizations that mimic properties of the continuous equations by choosing discrete representations of operators i e divergence and gradient that satisfy discrete analogues of important properties of the continuous operator like the other methods described above the mfd method is locally conservative and second order accurate but relative to these methods increases the flexibility of unstructured meshes on which it can be defined therefore improving the ability of the method to represent complex geometry without resorting to overly refined meshes the mfd method maintains both accuracy and local mass conservation on arbitrary polyhedra and has been used previously to solve richards type equations on distorted grids lipnikov et al 2016a with its ability to accept arbitrary polyhedra including star convex polyhedra hanging nodes or coplanar faces pinch outs and other complex structures while maintaining second order accuracy da veiga et al 2014 this class of methods has been recognized as having great potential for hydrologic simulation paniconi and putti 2015 here we extend the mfd approach to add surface flows on unstructured grids coupled to unstructured and distorted subsurface grids describe and verify its implementation in the advanced terrestrial simulator ats painter et al 2016 coon et al 2016 and compare the mesh convergence to the two point flux approximation on a realistic example with patchy surface cover note that we do not here try to make the case that mfd is the best second order conservative discretization for integrated hydrology in fact we believe that the best method is problem dependent while mfd s geometric flexibility may be critical for some problems it may or may not be less appropriate for simpler meshes instead here we look to demonstrate three things first we demonstrate the application of the mfd method to integrated hydrology while this is not the first of these methods for unstructured meshes to be applied to integrated hydrology this combination is novel to use the mfd method for integrated hydrology requires upwinding the relative permeability and a coupling strategy to ensure continuity and conservation between the surface and subsurface second we derive a novel approach to discretely couple surface and subsurface hydrology this coupling approach based on kollet and maxwell 2006 but leveraging the face unknowns in a way similar to that of dawson 2008 is a continuous pressure method without boundary condition switching which solves the two equations globally implicitly the resulting method is capable of accurately solving problems with realistic subsurface structures while ensuring pressure continuity between surface and subsurface and local mass conservation we compare solutions using this method to others previously published for benchmark problems from sulis et al 2010 and maxwell et al 2014 this is in support of previous benchmark intercomparisons in which this method was already used kollet et al 2017 this demonstrates the correctness of the method and implementation third we compare mfd and fv tpfa in an integrated hydrology application involving patchy ground cover to demonstrate the importance of using a discretization scheme that is second order accurate on distorted meshes although limitations of fv tpfa on distorted meshes in subsurface only applications are well known the fv tpfa is still a commonly used method in integrated hydrology applications and the consequences of this choice on runoff generation have not been explored patchy surface cover which can be caused for example by the removal of litter and duff and deposition of ash by fire is a key factor in hydrologic change in response to wildfire ebel et al 2012 it is also a demanding test case for discretizations in that it includes pinch outs that require distorted meshes with three different element types near the land surface where the potential is greatest for unanticipated interactions between the discretization and coupling scheme 2 mathematical model for surface and subsurface hydrology conservation of water is integrated across surface and subsurface domains we take care to describe the surface domain since an unstructured mesh is used for the subsurface domain and so the top surface boundary of the subsurface is not a two dimensional plane 2 1 subsurface flow equations we look to solve the richards equation for variably saturated flow in a hybrid pressure and water content form celia et al 1990 while a head formulation is more common within the near surface hydrology community the pressure form more straightforwardly allows variable density and phase change painter et al 2016 under the assumptions that density and viscosity are constant the two are equivalent and these are assumed for this paper in this form the richards equation is solved on a domain ω of which the top surface boundary is denoted γ and the remaining belowground boundaries are denoted ω 1a t ϕ s q 0 1b ϕ ϕ 0 β h p p a t m p p a t m 1c q 1 μ k r κ p ρ g 1d q n γ g where ϕ the effective soil matrix porosity s the saturation of water q the darcy flux m s 1 kr the relative permeability κ the absolute permeability m2 μ the dynamic viscosity pa s p the water pressure pa ρ the mass density of water kg m 3 and g the vector of gravity m s 2 the boundary condition on the top surface boundary γ is a flux neumann condition given by g this will be discussed in detail below this is augmented with pressure dirichlet and or flux neumann boundary data on the belowground boundaries we note that 1a is valid under both saturated and unsaturated conditions specific storage may be included as a compressibility of the matrix β pa 1 which alters the effective porosity under saturated conditions through the use of the heaviside function h here ϕ 0 κ μ ρ g and β are constant as specified in problem descriptions therefore only saturation and relative permeability curves remain to close the system the standard van genuchten mualem approach van genuchten 1980 is used 2a s e s s r 1 s r 1 α p p a t m n m 2b k r s e 1 1 s e 1 m m 2 where se is the effective reduced saturation given a residual saturation sr patm is atmospheric pressure and n and α pa 1 are van genuchten parameters with m 1 1 n 2 2 surface flow equations on the surface a diffusion wave approximation to overland flow is made following the approach of lal 1998 first γ the surface of the subsurface domain is identified this surface a topologically two dimensional submanifold in three dimensional space is projected into a plane perpendicular to z to form a truly two dimensional surface γ see fig 1 on this surface flow is governed by an equation for conservation of water 3a h t s h q s q e q s s 3b q s h 2 3 n m a n n max ϵ s z s s h z s where h is the depth of ponded water on the surface m s is the two dimensional surface gradient m 1 q s the two dimensional flux field m s 1 qe is all external source terms such as rainfall or evaporation m s 1 qss exfiltration infiltration fluxes from the subsurface m s 1 nmann is manning s coefficient s m 1 3 zs the elevation of the surface γ m and ϵ a small positive regularization to keep the equations non singular in regions with zero slope m note that this differs slightly from lal 1998 and others in that it uses the friction slope or slope of the free surface in the numerator and the bed slope or slope of the underlying soil in the denominator unlike the typical kinematic wave equation which uses the bed slope in both or the diffusion wave equation in lal which uses the friction slope in both this approximation gains some advantages over both it is less nonlinear than the typical diffusion wave equation but it is still able to capture flow in regions with little to no bed slope unlike the kinematic wave equation ponded depth dirichlet and or flux neumann data on the surface domain s boundaries are required the ponded depth h is related to pressure via 4 h h p p a t m p p a t m ρ g note that the heaviside function h is used to ensure that ponded depth is non negative 2 3 coupling of surface and subsurface coupling of the two domains is physically implied by continuity of both flux of water and pressure between the subsurface and surface domains to achieve continuity of pressure we require ponded depth on the surface h p as given by eq 4 is evaluated from the subsurface pressure field evaluated on the surface p γ to ensure continuity of flux and therefore overall water conservation of the coupled system we include explicitly a source term in the surface equation qss which is the flux of water from the subsurface to the surface then the boundary condition 5 g q s s n z is imposed on the subsurface domain note that the additional term n z deals with the flattening of the submanifold surface and ensures that the spatially integrated fluxes are equal and mass is conserved this flux is unknown but the system is well posed with the requirement of both continuity of flux and pressure this approach requires no switching of boundary condition type in the transition from surface ponding to a dry surface in the dry case p γ patm h 0 and eq 3a reduces to q s s q e in the continuous form equations this approach is analogous to the boundary condition approach of kollet and maxwell 2006 but takes into consideration the effects of unstructured meshes 3 solution methodology the subsurface and surface flow equations developed in sections 2 1 and 2 2 respectively form a coupled set of nonlinear parabolic equations through the continuity of pressure and flux described in section 2 3 we next use the mimetic finite difference mfd method to discretize the subsurface equations as described below the mfd method introduces lagrange multipliers on faces of the mesh which are equivalent to a face averaged pressure this pressure on the surface boundary consists of faces of the subsurface mesh surface pressure is then given discretely as piece wise constant on the coincident surface cells this makes surface subsurface coupling simple pressure continuity is a de facto result of the choice of discretization and flux continuity is ensured by imposing a neumann boundary condition for the exchange flux which here is solved implicitly as a single system of equations the coupling method described here takes its motivation from the method of kollet and maxwell 2006 in which pressure continuity is enforced discretely and flux continuity is enforced through the use of the surface equation as a nonlinear boundary condition and the system is solved implicitly unlike that method which equates the surface unknowns with the pressure in the top cell thereby introducing order h error mfd s face unknowns allow this to be done with no loss of accuracy of the subsurface solution this approach of leveraging the coincidence of the discretization s unknowns is similar to that of dawson 2008 which coupled shallow water equations to the subsurface in that method the surface and subsurface systems were solved independently and continuity was enforced through a non iterative boundary condition switching as opposed to the globally implicit approach here the coupling approach used here is applicable to any other mixed hybrid form method e g the mixed hybrid finite element method babuska et al 1977 mosé et al 1994 or the support operator method shashkov and steinberg 1995 in this section we first describe the mfd method then apply it to richards equation we do not rigorously derive each of the discrete forms this has been done by lipnikov et al 2014 for darcy s equation instead we look to give a flavor of how they are derived and then rigorously show how they are changed for integrated hydrology the surface is discretized using the finite volume method as for most applications it is possible to construct a 2d projected surface mesh that is voronoi without resorting to over resolved triangles and using mfd on the surface system would introduce a new set of unknowns on edges of the surface mesh that add even more degrees of freedom to the system then we show how the continuity of pressure and flux between surface and subsurface leads to the discrete nonlinear system of equations for the fully coupled model finally we describe how this nonlinear system is solved 3 1 spatial discretization via mimetic finite differences a typical subsurface domain and mesh with its relationship to the surface mesh and projected surface mesh is shown in fig 1 to discretize the subsurface flow equation in physical space we let ω h be a partition of the domain ω into shape regular polyhedral cells ω i a central goal in the mfd methodology is to ensure that the discrete first order operators namely the divergence and gradient are not only accurate but satisfy discrete versions of certain integral identities locally on each polyhedral cell in this way the discretization will be accurate on general meshes while mimicking important properties of the continuum model such as local mass conservation this goal is achieved by selecting a set of unknowns that naturally yield a direct discretization of one of the first order operators for example the divergence this operator is referred to as the primary operator then the desired integral identity is used with definition of the primary operator to derive the other operator hence in this case the discrete gradient is referred to as the derived operator the unknowns used in the mfd method are shown on fig 2 first for each cell ω i the pressure unknown pi is defined as the average pressure and the vector of all cell pressures is denoted p thus the length of p is simply the number of cells second for each face fj of the polyhedral cell ω i we define one unknown q i f j which represents the average outward normal component of the darcy flux through the face a scalar to simplify the discussion we refer to q i f j as the flux unknown and we define q as the vector of all subsurface flux unknowns thus the length of q is twice the number of internal faces plus the number of boundary faces in the subsurface mesh this choice of subsurface flux unknowns establishes the divergence as the primary operator as it naturally discretizes the integral of the mass balance equation over the cell ω i the continuity of the normal darcy flux through a face fj that is common to elements ω i and ωℓ is written as q i f j q ℓ f j often this constraint is viewed as being enforced through a corresponding lagrange multiplier on the face λ f j however critically the development of the derived gradient operator shows that this lagrange multiplier is also the average pressure on the face the vector of all face pressures is denoted λ and its length is the number of faces in the subsurface mesh central to mfd methods is the construction of discrete inner products on the scalar and vector spaces as this is sufficient to develop a discrete calculus the construction and properties of the weighting matrices that define these inner products is presented in detail by da veiga et al 2014 and lipnikov et al 2014 and is essential in proving stability and consistency of the discretizations here we note that the key component of the derived gradient operator is the mass matrix m associated with the approximation of the continuous inner product 6 u t m q d 1 q u ω d 1 q u d ω where d is the coefficient of the gradient operator associated with the flux and u is any function from hdiv ω the set of integrable vector functions with integrable divergence the accuracy of the approximation is given by the accuracy of the quadrature used to approximate this integral 3 1 1 discretization of richards equation to discretize richards equation we first ignore the time derivative and consider the associated boundary value problem at time t t n then using the mfd approach described above we set d k r s x t n κ x μ in the inner product 6 and name the resulting mass matrix m to obtain 7 m b t c t b 0 0 c 0 0 q p λ 0 0 g n here the first row approximates the darcy flux defined in eq 1c while the conservation of mass expressed in eq 1a excluding the accumulation term is described by the middle row each of these equations is local to a single cell of the mesh these local equations are coupled to neighboring cells through the continuity of the normal flux which is enforced in the third row through the lagrange multiplier recall that the lagrange multiplier is the face averaged pressure here the superscript n is used on discrete operators and vectors to indicate that these are evaluated at time t t n on external faces this third equation is the natural place to enforce the boundary condition in 7 including neumann data discretized here as g we have ignored the dirichlet boundary condition as it is complicates notation and is not used in the examples below however it is straightforward to implement at this point by replacing rows of the λ equations with identity rows subtracting off the corresponding column from the right hand side and placing the boundary data on the appropriate row of the right hand side in the richards equation we assume that the absolute permeability is given by a symmetric positive definite tensor κ 0 and that the relative permeability kr is a positive scalar bounded above zero unfortunately the relative permeability is very small in dry soils and nonlinearity is strong in the water retention models and relative permeability curves upwinding approaches have been used to achieve reasonable results within acceptable computational resources for these problems despite the introduction of first order error to upwind the cell based value of the relative permeability is mapped to a face based value with the mapping governed by the direction of the potential gradient 8 q κ x p ρ g this quantity is discretized as q and we consider the mass matrix m that would be obtained with d κ x and the diagonal scaling d n d q n k r n μ associated with the upwinded relative permeability to write the linear system in the form 9 m d n 1 b t c t b 0 0 c 0 0 q p λ 0 0 g n the mass matrix m is block diagonal with each block corresponding to a single element in the mesh to eliminate the flux we form the schur complement defining the inverse mass matrix w m 1 and note that in the mfd method w can be computed directly to avoid costly inversion then the schur complement for p λ may be written 10 s p λ t n s p λ n a p p a p λ a λ p a λ λ n b d w b t b d w c t c d w b t c d w c t n and the reduced system for the richards boundary value problem at tn without the accumulation term is 11 s p λ n p λ n 0 g n next we discretize the time derivative using backward euler a first order implicit method in this case the accumulation term on a cell ω i is approximated by 12 ω i t ϕ s t n ϕ s p i n ω i ϕ s p i n 1 ω i δ t n θ p i n θ p i n 1 δ t n where the time step δ t n t n t n 1 may vary during the simulation and we have used the definition of the discrete extensive water content θ p i n ϕ s p i n ω i we note that this discrete water content depends nonlinearly upon the discrete pressure through the water retention model finally collecting the discrete equations for the boundary value problem and the accumulation term leads to the complete discrete nonlinear system describing richards equation at time t t n 13 θ p n δ t n 0 s p λ p n p λ n θ p n 1 δ t n g n where it is assumed the primary variables are known at the previous time t n 1 3 1 2 discretization of overland flow the surface water flow equations are posed and discretized on the projected mesh shown in fig 1 the projected surface domain γ is partitioned into polygonal cells γ i which correspond exactly to faces of the subsurface mesh we note that in practice meshes are generated in the reverse direction with a constrained delaunay triangulation performed on the surface mesh then extruded into the subsurface to respect soil horizons surface flow is discretized using the two point flux finite volume method with upwinding to handle the case of zero ponded depth accuracy of this method requires a voronoi mesh as shown by many including zyvoloski and vesselinov 2006 voronoi meshes conforming to external and internal boundaries are are relatively simple to construct in two dimensions in contrast to three dimensional meshes that includes internal surfaces the discrete form of the overland flow 3a and 3b are then formed in the usual way as a function of a single vector of pressures on surface faces h s we denote them as 14 θ s h n δ t n a h h h n h n q e n q s s n θ s h n 1 δ t n where θ s h i n γ i h i n is the integrated surface water content and a h h n is the elliptic discrete surface water flux operator and q e n and q s s n are the integrated source terms each evaluated at time n 3 1 3 coupling surface and subsurface pressure continuity is imposed discretely by noting that the λ constraints on subsurface faces correspond to a pressure on faces therefore we split the discrete subsurface vector of faces λ into two sets λ the set of pressures on surface faces and λ the set of pressures on all other belowground faces then using eq 4 the vector of cell based ponded depths on the surface can be written in terms of these constraints 15 h h λ h λ p a t m λ p a t m ρ g splitting this vector of face unknowns allows the subsurface flow eq 11 to be rewritten as 16 θ n δ t n 0 0 a p p a p λ a p λ a λ p a λ λ a λ λ a λ p a λ λ a λ λ n p λ λ n θ n 1 δ t n 0 g n now we alter the surface equations to use these surface pressures λ to do this we introduce a diagonal surface cell centered matrix d h p s n d i a g h λ n p a t m ρ g and perform the change of variables in the surface eq 14 17 θ s d h p s λ n δ t n a h h h λ n λ n p a t m q e n q s s n θ s d h p s λ n 1 δ t n given this change of variables we can now impose continuity of flux using eq 5 and the definition of the discrete flux we see that g q s s 18 g j γ j g g γ j g n z γ i q s s γ i γ i q s s q s s i for a given face j on the surface corresponding to the projected mesh s cell i we can then combine eqs 16 and 17 to eliminate the unknown flux between the surface and subsurface domains resulting in the final coupled discrete equations 19 θ n δ t n 0 θ s n δ t n a p p a p λ a p λ a λ p a λ λ a λ λ a λ p a λ λ a λ λ a h h d h p s p λ λ θ n 1 δ t n 0 q e a h h d h p s p a t m θ s n 1 δ t n this discrete nonlinear problem integrates surface and subsurface hydrology into a single set of equations we note that a pp is diagonal and therefore it is trivial to invert and form a schur complement system for λ alone reducing the number of unknowns to the number of faces 3 2 time integration and nonlinear solution although the focus on this paper is on spatial discretization using mfd implementation also requires a time integration scheme and method for nonlinear solution for completeness we thus briefly summarize the implementation in the advanced terrestrial simulator amanzi ats code as configured for the below examples it is important to note that the time integration and nonlinear solution method can significantly affect performance but the choice of those algorithms does not affect any of the conclusions reached here regarding spatial discretization amanzi ats solves the resulting nonlinear problem using a preconditioned nonlinear krylov acceleration or preconditioned nka carlson and miller 1998a 1998b preconditioned nka accelerates convergence of fixed point iterations by using jacobian information gained over successive iterations as demonstrated by calef et al 2013 and lipnikov et al 2016b nka can outperform the jacobian free newton krylov method as a nonlinear solver since it requires significantly fewer evaluations of the nonlinear residual critical to the efficiency of the method is the construction and subsequent inversion of an approximate jacobian as the true jacobian is both difficult to form for the mfd case and potentially not positive definite an approximate jacobian which alleviates both of these issues is desired we use the mfd analogue of the approach by jones and woodward 2001 plus an approximate representation of the derivatives of relative permeability with respect to pressure described in lipnikov et al 2016b this approximate preconditioner for the subsurface equations are further modified to incorporate contributions from the surface equations leveraging the coincidence of surface cell and subsurface face unknowns the resulting system of equations has a complex sparsity structure and is inverted using algebraic multigrid using boomer amg falgout and yang 2002 the nonlinear solution of this problem is difficult near the transition from zero to nonzero ponded depth this is due to a discontinuity in the true jacobian at this transition for surface pressures below atmospheric pressure all surface contributions to the jacobian are zero while for nonzero ponded depth there are nonzero contributions this results in large overshoots in pressure corrections when the pressure at the surface is increasing and near but just below atmospheric pressure to enable convergence corrections which take the solution from zero ponded depth to nonzero ponded depth are limited if a correction takes the surface pressures λ from below atmospheric pressure to above it the correction is decreased so that the next iterate is p a t m ε for a small pressure change ε for a fixed time step size this locally applied physics based limiting greatly decreases the number of iterations to solution we note that the nka algorithm is changed slightly to allow user prescribed globalization when building the space that approximates the linearized system the algorithm must use the modified correction not the correction calculated in the previous iterate time is integrated using an adaptive time step size which adjusts to keep the number of nonlinear iterations within a specified range furthermore a solution is limited to a maximum saturation change taking the largest time step that a solver can calculate is not always advisable for temporal accuracy 4 benchmark comparisons to evaluate the correction of this method and implementation we compare solutions with an established model intercomparison effort in maxwell et al 2014 seven coupled surface subsurface hydrology codes were compared on a series of problems based on the original comparison of sulis et al 2010 which did a more detailed comparison between two codes parflow kollet and maxwell 2006 and cathy camporese et al 2010 the problems consist of cases of saturation and infiltration excess on a homogeneous hillslope and a case with heterogenous soil properties we demonstrate amanzi ats s solutions of these problems and compare to the published model intercomparison results in each of the following plots gray lines indicate solutions from the other seven codes in maxwell et al 2014 we do not present the tilted v catchment comparison problem here it was a surface flow only problem and therefore does not test this method additionally amanzi ats participated in the second model intercomparison as a further demonstration of the method kollet et al 2017 4 1 runoff under saturation and infiltration excess conditions in the first suite of benchmark problems a hillslope domain 400 m 320 m in horizontal extent and 2 m in depth is rained on at a rate of 33 mm min for 200 min and then the simulation is continued for another 100 min the hillslope is sloped from 5 m down in the positive x direction at a slope of 0 05 material properties including van genuchten curves manning coefficients specific storage and domain setup are described extensively in sulis et al 2010 and maxwell et al 2014 in each of these problems the spatial resolution is 5 4 m in the horizontal and 0 2 m in the vertical to match the results of maxwell et al 2014 runoff is measured as the outflow through one of the down slope surface faces i e a face of length 80 m in all runs boundary conditions in the subsurface are no flux boundary conditions on the surface are no flux with the exception of the down slope edge which is a zero head gradient condition i e s h n γ 0 4 1 1 infiltration excess to test the method under conditions resulting in infiltration excess hortonian runoff the permeability of the subsurface is set to 6 94 10 5 and 6 94 10 6 m min approximately 1 05 10 13 and 1 05 10 14 m2 in this case surface runoff is highly dependent upon accurate resolution of the subsurface as infiltration excess means that water ponds immediately accurate runoff requires accurate infiltration rates outflow rates are plotted at two permeabilities in fig 3 this figure is comparable to that of maxwell et al 2014 fig 4 ats falls within the suite of existing results 4 1 2 saturation excess for the next test conditions ensure saturation excess dunne runoff by setting hydraulic conductivity in the subsurface to be 6 94 10 4 m min equivalent to an absolute permeability of 1 05 10 12 m2 two runs with different initial water tables of 1 m and 0 5 m from the surface are shown in fig 4 as compared to all other codes compared in maxwell et al 2014 fig 5 close agreement to the intercomparison results is seen in ponding time maximum ponding depth and the ponded depth at which runoff equals the rainfall rate 4 2 runoff over a heterogeneous subsurface to test the simulations in a more challenging problem a low permeability slab is introduced in the top layer of cells 0 05m in vertical extent along x 150 250 for all y this slab is infiltration limited while the remainder of the domain is saturation limited in this problem water ponds on the surface of the slab runs off the slab and infiltrates downslope of the slab the subsurface saturation and surface ponded depth are shown in fig 5 the a and b panels in fig 5 use meshes that are sheared sloping but with vertical faces with 10 m and 1 m horizontal resolution respectively these results are best compared to sulis et al 2010 fig 6 they may also be compared to maxwell et al 2014 fig 8 which shows the 10m resolution case albeit with a shifted z axis z 5 in maxwell et al 2014 fig 8 corresponds to z 0 in sulis et al 2010 fig 6 and our fig 5 as shown by sulis et al 2010 weakly coupled operator split approaches can result in re infiltration of water from the slab on the upslope side of the slab caused by error in passing surface to subsurface nodes like the other codes that use a consistent discretization between the surface and subsurface domains and globally implicit coupling in the sulis et al 2010 comparison we do not see this unphysical behavior additionally sulis et al 2010 noted differences between codes in the width of the re infiltration front downstream of the slab specifically the cathy code produced a wider infiltration front than parflow sulis et al 2010 attributed this difference to the coupling scheme operator split for cathy and strong globally implicit for parflow however we also observe a wider re infiltration front much closer to that of cathy than that of parflow despite not seeing differences with parflow up slope of the slab we attribute the differences not to the coupling scheme but to the overland flow approximation like cathy ats uses a diffusion wave approximation while parflow used a kinematic wave approximation in the sulis et al 2010 intercomparison the difference between the two models is in the surface flow potential in a diffusion wave approximation flow is driven by h z while in a kinematic wave approximation flow is driven by z by looking at the ponded depth in fig 5 we see that the ponded depth h serves to steepen the potential relative to the kinematic wave approximation and therefore results in larger fluxes down the surface slope this increase in potential for surface flow drives the wider re infiltration front in the two diffusion wave approximation codes cathy and ats relative to the kinematic wave code parflow 5 comparison with two point flux on meshes following complex soil structure although mfd performs similarly to other discretizations on the relatively orthogonal meshes used in the above benchmark problems this is not expected to be the case for more distorted meshes to compare solutions of the mfd and fv tpfa methods on realistic meshes conforming to more complex soil structures we modify the well known v catchment or open book catchment configuration to include patchy groundcover fig 6 specifically we add discontinuous patches of duff partially decayed plant material common on the forest floor on top of an otherwise homogeneous soil duff has higher porosity and stronger capillary retention properties compared to the underlying soil and is an important control on runoff ebel et al 2012 atchley et al 2018 although other types of groundcover for example litter is often represented as part of the surface vegetation layer in integrated codes duff is a porous medium and naturally represented as part of the subsurface system duff is the part of the subsurface that is perhaps the most susceptible to disturbances particularly the ones caused by wildfires it is also a relatively thin layer which typically results in it having a patchy structure and non uniform depth this also implies that there can be multiple areas with exposed soil and the duff layer itself can be discontinuous with multiple pinchouts and complex geometry the sides of this v catchment have a 5 slope in x direction and the channel has a 3 slope in y direction the soil layer is uniform and 2m deep and duff patches have a maximum thickness of 4cm hydraulic properties for soil and duff are shown in fig 1 the sides of the v catchment are 100m by 200m and the channel is 20m by 200m the mesh is constructed by first partitioning the surface of the domain into squares then partitioning every such square into four triangles using its center the resulting surface mesh is then vertically extruded with pinching out mesh layers in duff and uniform mesh layers in soil we consider three mesh resolutions in the horizontal with maximum edge length of triangles in the surface mesh of 20m coarse 10 m base and 5m fine we also consider three mesh resolutions in the vertical with maximum thickness of duff cells of 4 cm 2 cm and 1 cm and variable vertical resolution in soil as shown in table 2 the structure of duff patches for different mesh resolutions is shown on fig 6 our numerical experiments are driven by precipitation for a hypothetical storm event fig 7 precipitation intensity exceeds the hydraulic conductivity of the soil resulting in infiltration limited runoff we monitor the hydrograph the surface water discharge from the catchment for the nine combinations of vertical and horizontal mesh resolution and for mfd and for the finite volume method with two point flux approximation fv tpfa note that the fv tpfa method is implemented as a simplification of the mfd method while the a λλ block in eq 10 is dense for the mfd method lumping it into a diagonal matrix is discretely equivalent to the two point flux approximation therefore while we cannot recover the performance advantages of the fv tpfa method we can recover to solver tolerance the fv tpfa solution results for all 18 cases are shown in fig 8 the three upper panels are for the fv tpfa and the bottom three panels are for mfd from left to right the three columns correspond to coarse base and fine vertical resolution each plot has results for the three horizontal resolutions for fixed vertical resolution fv tpfa and mfd results appear to be converging to the same hydrograph as the horizontal resolution increases for coarse and base horizontal meshes mfd is remarkably close to the fine scale result indicating rapid mesh convergence fv tpfa by contrast is overestimating the hydrograph by almost a factor of two for the coarse mesh the rapid mesh convergence of mfd compared to fv tpfa confirms that the accuracy of mfd on distorted meshes which has previously been demonstrated on subsurface only models extends to include the coupled surface subsurface system with horizontal resolution fixed increasing the vertical resolution increases the peak of the hydrograph for both mfd and fv tpfa mfd has no advantage over fv tpfa in vertical mesh convergence because we are in the infiltration limited situation where coarse vertical resolution is known and expected to overestimate infiltration and as a result underestimate the hydrograph peak 6 discussion and conclusions as physically based integrated surface subsurface models grow in complexity to address ever more demanding site specific applications the transition to fully unstructured meshes is a natural development soil and geologic layers may vary in vertical thickness along their extent including allowing for layers which pinch out at the surface depth to bedrock is spatially variable and accurately portraying that layer is important for accurate predictions of discharge camporese et al 2019 mfd and other second order conservative methods for unstructured meshes come with advantages which make them well suited for challenges in integrated hydrology such as these these methods mostly coming from the reservoir modeling community have a long history of success in similar subsurface problems here we leveraged the structure of the mimetic finite difference mfd method to include the diffusion wave equation coupled to richards equation for the subsurface coupling is naturally expressed as a de facto result of the choice of mfd as the subsurface discretization and proper choice of unknowns and boundary conditions the combined system is solved simultaneously using a globally implicit strategy in our implementation in amanzi ats we also include a physics motivated limiter in the nonlinear solution method to improve robustness when water disappears or reappears on the surface here we presented the theory of the method and compared the method to a set of model intercomparison problems in the published literature we find excellent agreement with other codes in all tests in particular a heterogeneous test highlights several key factors in comparing to previously published methods and solutions in that case implicit coupling proved critical for correctly capturing near slab effects while differences were identified in down slab re infiltration as compared to simulators implementing a kinematic wave approximation using a three dimensional v catchment with patchy groundcover duff for mesh convergence studies we confirmed that our mfd extension converges much more rapidly as the horizontal resolution is increased compared to the commonly used finite volume method with two point flux approximation fv tpfa in particular the highly distorted meshes associated with duff patches caused the fv tpfa to be inaccurate unless the mesh is highly refined whereas the coarsest mesh considered was accurate for the mfd method in general we find that the mfd method significantly reduces the discretization error on coarser grids enabling more accurate and efficient simulation this reduction is most pronounced in the horizontal direction the column structured meshes and gravity driven flows lead to similar vertical error while all second order conservative methods for unstructured meshes are a great improvement in terms of the types of structures they can represent accurately most are still limited to simplicial triangular prism and or hexahedral meshes and cannot easily deal with pinch outs hanging nodes non convex cells or other mesh degeneracies mfd has been shown to be capable of maintaining accuracy on star convex elements admits meshes with hanging nodes and is simply generalized to polyhedra with an arbitrary number of faces da veiga et al 2014 we have not exercised all of this versatility here more research is needed to explore the sensitivity of hydrologic flow and transport to the accurate resolution of these complex structures the disadvantage of mfd is the change in sparsity structure which both introduces more unknowns face based pressures and requires more expensive preconditioners here we used algebraic multigrid unfortunately it is not possible to directly compare computational cost here because the coupling scheme is derived assuming the existence of face based unknowns credit authorship contribution statement ethan t coon conceptualization methodology software validation writing review editing visualization j david moulton conceptualization methodology evgeny kikinzon software validation markus berndt software gianmarco manzini methodology rao garimella software konstantin lipnikov methodology software writing review editing scott l painter conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to especially thank reed maxwell and the participants of the first intercomparison of integrated hydrology codes for developing test problems and sharing their solutions these efforts take a lot of work but provide a true community service the ats software is open source and may be downloaded from https github amanzi ats input and output files are available by contacting the corresponding author this work was supported by ornl ldrd 8872 lanl ldrd 20150397dr and ldrd201200068dr the interoperable design of extreme scale application software ideas project and the next generation ecosystem experiment ngee arctic project ideas and ngee arctic are supported by the office of biological and environmental research in the doe office of science 
416,we explore the coupling of surface and subsurface flows on fully unstructured meshes that conform to complex soil structures to accommodate the distorted meshes that inevitably result from explicit representation of complex soil structures we leverage the structure of the mimetic finite difference mfd spatial discretization scheme to couple surface and subsurface flows the mfd method achieves second order accuracy and maintains local mass conservation on distorted meshes we couple the diffusion wave approximation for surface flows to the richards equation for subsurface flow ensuring continuity of both pressure and flux between the surface and subsurface the mfd method is particularly convenient for this coupling because it uses face based constraints in the subsurface system that can be expressed as face pressure unknowns those unknowns are coincident with surface cell based unknowns thus allowing the discrete surface system to be directly substituted into the subsurface system and solved implicitly as a global system robust representation of the transition between wet and dry surface conditions requires upwinding of the relative permeability and is facilitated by globalization in the nonlinear solver the approach and its implementation in the advanced terrestrial simulator ats are evaluated by comparison to previously published benchmarks using runoff from soils with patchy groundcover duff as an example we show that the new method converges significantly faster in mesh convergence tests than the commonly used two point flux approximation keywords mimetic finite differences integrated hydrology complex stratigraphy 1 introduction scientists and decision makers need ever improving quantitative tools to help understand a spectrum of persistent water security challenges vörösmarty et al 2010 including drought groundwater depletion flooding nutrient loading and contaminant transport among the tools available are physically based distributed parameter models that couple three dimensional subsurface representations with surface process models at high spatial resolution traditionally used for site and catchment scale applications physically based integrated models have more recently been used successfully at larger scales to advance our fundamental understanding of components in the terrestrial water cycle maxwell and condon 2016 those initial successes combined with improved data sources and growing computational resources have fueled interest in so called hyper resolution integrated models with sub 100 m resolution over entire river basins wood et al 2011 bierkens et al 2015 regardless of the scale of the application physically based integrated models are most valuable when they are faithful to our best understanding of subsurface properties and capable of exploring sensitivity of results to those properties understanding the sensitivity of hydrologic processes including both flow and transport of chemical species to shallow subsurface structures is a key consideration variable bedrock topography has been shown through both empirical freer et al 2002 and integrated hydrologic model sensitivity studies camporese et al 2019 to control runoff and transient groundwater flow also soil textural contrasts and the spatial organization of surface cover such as litter and duff play a key role in explaining runoff timing and magnitude ebel et al 2012 furthermore soil structure data is increasing available at site scales either directly through geophysics or indirectly through inverse modeling and at larger scales from increasingly detailed online data sources accommodating these examples of geometric complexity where soil horizons and bedrock topography are not parallel to the surface topography leads naturally to unstructured meshes that geometric complexity combined with the need to solve nonlinear equations for both surface and subsurface flow and couple them accurately and efficiently places significant demands on integrated distributed hydrologic codes a large and diverse body of work on integrated surface subsurface hydrology has been developed throughout computational hydrology s history as documented by both review papers singh and woolhiser 2002 kampf and burges 2007 paniconi and putti 2015 and model intercomparisons maxwell et al 2014 kollet et al 2017 we note that the wide variety of methods is a strength of the hydrologic modeling community each method has its advantages in different contexts and the best method and code for a given application requires weighing considerations of physical process representation accuracy and computational efficiency including both scaling and performance while nearly all models use a variably saturated richards equation to model subsurface flow approaches to simplifying the navier stokes equations for surface flow vary most surface water efforts simplify the st venant equations to kinematic wave lighthill and whitham 1955 smith and woolhiser 1971 kollet and maxwell 2006 or diffusion wave morris and woolhiser 1980 restrepo et al 1998 vanderkwaak and loague 2001 camporese et al 2010 weill et al 2009 approximations to solve these equations different approaches exist for methods of coupling surface and subsurface flow spatial discretization and numerical solution those computational considerations are not entirely independent an effective comprehensive strategy must also consider their interactions coupling the surface and subsurface flow equations may be done at the continuous or discrete level and may be implemented as independent solves or solved as an coupled system methods for doing so have been the subject of a variety of classification efforts kampf and burges 2007 furman 2008 which we summarize here the first order exchange coefficient foec approach vanderkwaak and loague 2001 panday and huyakorn 2004 ebel et al 2009 introduces an additional parameter for surface subsurface conductivity while it is an extremely robust approach this coefficient may be difficult to constrain physically continuous pressure approaches whether through sequential iterated or fully implicit coupling enforce continuity of pressure between the surface and subsurface s top boundary these approaches include standard schwarz domain decomposition strategies such as subdomain solves with appropriate boundary conditions from the other domain gandolfi and savi 2000 iterated subdomain solves abbott et al 1986 and globally implicit solutions the latter include approaches such as enforcing the surface flow equations through the use of a nonlinear boundary condition kollet and maxwell 2006 introducing an extra layer of cells to the subsurface domain on which to hold surface pressures weill et al 2009 kumar et al 2009 and leveraging face unknowns inherent in the subsurface discretization to discretely enforce continuity dawson 2008 continuous pressure approaches can be less robust than foec methods morita and yen 2002 and are likely either subject to large errors in the case of sequential coupling panday and huyakorn 2004 or are computationally demanding requiring custom preconditioners and solver globalization lipnikov et al 2016b osei kuffuor et al 2014 hybrid approaches have also been derived including those based on boundary condition switching camporese et al 2010 dagès et al 2012 or regularization penalty methods de maet et al 2015 the implications of coupling method and time integration strategies are discussed in morita and yen 2002 and furman 2008 and have been observed to affect the resulting spatially temporally converged solution sulis et al 2010 maxwell et al 2014 kollet et al 2017 the accuracy of approximations of that solution huang and yeh 2009 and likely the computational performance independently of the work on coupling surface and subsurface flow systems the reservoir modeling and mathematics communities have collaborated closely to lead in the development of discretization methods for subsurface flow here we focus on spatial discretization methods that are both locally conservative and capable of accommodating distorted unstructured meshes that conform to complex subsurface structures with discontinuous permeability parameters locally conservative spatial discretization methods are critical for applications involving transport of chemical species the most well known locally conservative discretization is the finite volume method with a two point flux approximation fv tpfa which has advantages of local conservation monotonicity and simplicity of implementation but has known accuracy issues under non voronoi meshes and can even be non convergent in some cases zyvoloski and vesselinov 2006 lipnikov et al 2014 limiting the generality of meshes that can be used methods built on multi point flux methods mixed forms i e including face based flux unknowns in addition to cell centered pressure unknowns mixed hybrid forms i e mixed forms that additionally introduce face centered constraints discontinuous galerkin methods and mimetic finite difference methods were each developed for general elliptic problems improving accuracy and generality of meshes that are acceptable for simulation and have been widely adopted in the reservoir simulation community see klausen and russell 2004 for an excellent comparison of the tradeoffs of these methods those methods are not as widely used in integrated distributed hydrologic models with the notable exception of hydrogeosphere brunner and simmons 2012 which uses the control volume finite element method and cast3m weill et al 2009 which uses the mixed hybrid finite element method other papers demonstrating these methods on integrated hydrology problems include inhm vanderkwaak 1999 dawson 2008 and kumar et al 2009 who use the control volume finite element method a discontinuous galerkin method and a second order finite volume method respectively the mimetic finite difference mfd method lipnikov et al 2014 da veiga et al 2014 is a family of discretizations that mimic properties of the continuous equations by choosing discrete representations of operators i e divergence and gradient that satisfy discrete analogues of important properties of the continuous operator like the other methods described above the mfd method is locally conservative and second order accurate but relative to these methods increases the flexibility of unstructured meshes on which it can be defined therefore improving the ability of the method to represent complex geometry without resorting to overly refined meshes the mfd method maintains both accuracy and local mass conservation on arbitrary polyhedra and has been used previously to solve richards type equations on distorted grids lipnikov et al 2016a with its ability to accept arbitrary polyhedra including star convex polyhedra hanging nodes or coplanar faces pinch outs and other complex structures while maintaining second order accuracy da veiga et al 2014 this class of methods has been recognized as having great potential for hydrologic simulation paniconi and putti 2015 here we extend the mfd approach to add surface flows on unstructured grids coupled to unstructured and distorted subsurface grids describe and verify its implementation in the advanced terrestrial simulator ats painter et al 2016 coon et al 2016 and compare the mesh convergence to the two point flux approximation on a realistic example with patchy surface cover note that we do not here try to make the case that mfd is the best second order conservative discretization for integrated hydrology in fact we believe that the best method is problem dependent while mfd s geometric flexibility may be critical for some problems it may or may not be less appropriate for simpler meshes instead here we look to demonstrate three things first we demonstrate the application of the mfd method to integrated hydrology while this is not the first of these methods for unstructured meshes to be applied to integrated hydrology this combination is novel to use the mfd method for integrated hydrology requires upwinding the relative permeability and a coupling strategy to ensure continuity and conservation between the surface and subsurface second we derive a novel approach to discretely couple surface and subsurface hydrology this coupling approach based on kollet and maxwell 2006 but leveraging the face unknowns in a way similar to that of dawson 2008 is a continuous pressure method without boundary condition switching which solves the two equations globally implicitly the resulting method is capable of accurately solving problems with realistic subsurface structures while ensuring pressure continuity between surface and subsurface and local mass conservation we compare solutions using this method to others previously published for benchmark problems from sulis et al 2010 and maxwell et al 2014 this is in support of previous benchmark intercomparisons in which this method was already used kollet et al 2017 this demonstrates the correctness of the method and implementation third we compare mfd and fv tpfa in an integrated hydrology application involving patchy ground cover to demonstrate the importance of using a discretization scheme that is second order accurate on distorted meshes although limitations of fv tpfa on distorted meshes in subsurface only applications are well known the fv tpfa is still a commonly used method in integrated hydrology applications and the consequences of this choice on runoff generation have not been explored patchy surface cover which can be caused for example by the removal of litter and duff and deposition of ash by fire is a key factor in hydrologic change in response to wildfire ebel et al 2012 it is also a demanding test case for discretizations in that it includes pinch outs that require distorted meshes with three different element types near the land surface where the potential is greatest for unanticipated interactions between the discretization and coupling scheme 2 mathematical model for surface and subsurface hydrology conservation of water is integrated across surface and subsurface domains we take care to describe the surface domain since an unstructured mesh is used for the subsurface domain and so the top surface boundary of the subsurface is not a two dimensional plane 2 1 subsurface flow equations we look to solve the richards equation for variably saturated flow in a hybrid pressure and water content form celia et al 1990 while a head formulation is more common within the near surface hydrology community the pressure form more straightforwardly allows variable density and phase change painter et al 2016 under the assumptions that density and viscosity are constant the two are equivalent and these are assumed for this paper in this form the richards equation is solved on a domain ω of which the top surface boundary is denoted γ and the remaining belowground boundaries are denoted ω 1a t ϕ s q 0 1b ϕ ϕ 0 β h p p a t m p p a t m 1c q 1 μ k r κ p ρ g 1d q n γ g where ϕ the effective soil matrix porosity s the saturation of water q the darcy flux m s 1 kr the relative permeability κ the absolute permeability m2 μ the dynamic viscosity pa s p the water pressure pa ρ the mass density of water kg m 3 and g the vector of gravity m s 2 the boundary condition on the top surface boundary γ is a flux neumann condition given by g this will be discussed in detail below this is augmented with pressure dirichlet and or flux neumann boundary data on the belowground boundaries we note that 1a is valid under both saturated and unsaturated conditions specific storage may be included as a compressibility of the matrix β pa 1 which alters the effective porosity under saturated conditions through the use of the heaviside function h here ϕ 0 κ μ ρ g and β are constant as specified in problem descriptions therefore only saturation and relative permeability curves remain to close the system the standard van genuchten mualem approach van genuchten 1980 is used 2a s e s s r 1 s r 1 α p p a t m n m 2b k r s e 1 1 s e 1 m m 2 where se is the effective reduced saturation given a residual saturation sr patm is atmospheric pressure and n and α pa 1 are van genuchten parameters with m 1 1 n 2 2 surface flow equations on the surface a diffusion wave approximation to overland flow is made following the approach of lal 1998 first γ the surface of the subsurface domain is identified this surface a topologically two dimensional submanifold in three dimensional space is projected into a plane perpendicular to z to form a truly two dimensional surface γ see fig 1 on this surface flow is governed by an equation for conservation of water 3a h t s h q s q e q s s 3b q s h 2 3 n m a n n max ϵ s z s s h z s where h is the depth of ponded water on the surface m s is the two dimensional surface gradient m 1 q s the two dimensional flux field m s 1 qe is all external source terms such as rainfall or evaporation m s 1 qss exfiltration infiltration fluxes from the subsurface m s 1 nmann is manning s coefficient s m 1 3 zs the elevation of the surface γ m and ϵ a small positive regularization to keep the equations non singular in regions with zero slope m note that this differs slightly from lal 1998 and others in that it uses the friction slope or slope of the free surface in the numerator and the bed slope or slope of the underlying soil in the denominator unlike the typical kinematic wave equation which uses the bed slope in both or the diffusion wave equation in lal which uses the friction slope in both this approximation gains some advantages over both it is less nonlinear than the typical diffusion wave equation but it is still able to capture flow in regions with little to no bed slope unlike the kinematic wave equation ponded depth dirichlet and or flux neumann data on the surface domain s boundaries are required the ponded depth h is related to pressure via 4 h h p p a t m p p a t m ρ g note that the heaviside function h is used to ensure that ponded depth is non negative 2 3 coupling of surface and subsurface coupling of the two domains is physically implied by continuity of both flux of water and pressure between the subsurface and surface domains to achieve continuity of pressure we require ponded depth on the surface h p as given by eq 4 is evaluated from the subsurface pressure field evaluated on the surface p γ to ensure continuity of flux and therefore overall water conservation of the coupled system we include explicitly a source term in the surface equation qss which is the flux of water from the subsurface to the surface then the boundary condition 5 g q s s n z is imposed on the subsurface domain note that the additional term n z deals with the flattening of the submanifold surface and ensures that the spatially integrated fluxes are equal and mass is conserved this flux is unknown but the system is well posed with the requirement of both continuity of flux and pressure this approach requires no switching of boundary condition type in the transition from surface ponding to a dry surface in the dry case p γ patm h 0 and eq 3a reduces to q s s q e in the continuous form equations this approach is analogous to the boundary condition approach of kollet and maxwell 2006 but takes into consideration the effects of unstructured meshes 3 solution methodology the subsurface and surface flow equations developed in sections 2 1 and 2 2 respectively form a coupled set of nonlinear parabolic equations through the continuity of pressure and flux described in section 2 3 we next use the mimetic finite difference mfd method to discretize the subsurface equations as described below the mfd method introduces lagrange multipliers on faces of the mesh which are equivalent to a face averaged pressure this pressure on the surface boundary consists of faces of the subsurface mesh surface pressure is then given discretely as piece wise constant on the coincident surface cells this makes surface subsurface coupling simple pressure continuity is a de facto result of the choice of discretization and flux continuity is ensured by imposing a neumann boundary condition for the exchange flux which here is solved implicitly as a single system of equations the coupling method described here takes its motivation from the method of kollet and maxwell 2006 in which pressure continuity is enforced discretely and flux continuity is enforced through the use of the surface equation as a nonlinear boundary condition and the system is solved implicitly unlike that method which equates the surface unknowns with the pressure in the top cell thereby introducing order h error mfd s face unknowns allow this to be done with no loss of accuracy of the subsurface solution this approach of leveraging the coincidence of the discretization s unknowns is similar to that of dawson 2008 which coupled shallow water equations to the subsurface in that method the surface and subsurface systems were solved independently and continuity was enforced through a non iterative boundary condition switching as opposed to the globally implicit approach here the coupling approach used here is applicable to any other mixed hybrid form method e g the mixed hybrid finite element method babuska et al 1977 mosé et al 1994 or the support operator method shashkov and steinberg 1995 in this section we first describe the mfd method then apply it to richards equation we do not rigorously derive each of the discrete forms this has been done by lipnikov et al 2014 for darcy s equation instead we look to give a flavor of how they are derived and then rigorously show how they are changed for integrated hydrology the surface is discretized using the finite volume method as for most applications it is possible to construct a 2d projected surface mesh that is voronoi without resorting to over resolved triangles and using mfd on the surface system would introduce a new set of unknowns on edges of the surface mesh that add even more degrees of freedom to the system then we show how the continuity of pressure and flux between surface and subsurface leads to the discrete nonlinear system of equations for the fully coupled model finally we describe how this nonlinear system is solved 3 1 spatial discretization via mimetic finite differences a typical subsurface domain and mesh with its relationship to the surface mesh and projected surface mesh is shown in fig 1 to discretize the subsurface flow equation in physical space we let ω h be a partition of the domain ω into shape regular polyhedral cells ω i a central goal in the mfd methodology is to ensure that the discrete first order operators namely the divergence and gradient are not only accurate but satisfy discrete versions of certain integral identities locally on each polyhedral cell in this way the discretization will be accurate on general meshes while mimicking important properties of the continuum model such as local mass conservation this goal is achieved by selecting a set of unknowns that naturally yield a direct discretization of one of the first order operators for example the divergence this operator is referred to as the primary operator then the desired integral identity is used with definition of the primary operator to derive the other operator hence in this case the discrete gradient is referred to as the derived operator the unknowns used in the mfd method are shown on fig 2 first for each cell ω i the pressure unknown pi is defined as the average pressure and the vector of all cell pressures is denoted p thus the length of p is simply the number of cells second for each face fj of the polyhedral cell ω i we define one unknown q i f j which represents the average outward normal component of the darcy flux through the face a scalar to simplify the discussion we refer to q i f j as the flux unknown and we define q as the vector of all subsurface flux unknowns thus the length of q is twice the number of internal faces plus the number of boundary faces in the subsurface mesh this choice of subsurface flux unknowns establishes the divergence as the primary operator as it naturally discretizes the integral of the mass balance equation over the cell ω i the continuity of the normal darcy flux through a face fj that is common to elements ω i and ωℓ is written as q i f j q ℓ f j often this constraint is viewed as being enforced through a corresponding lagrange multiplier on the face λ f j however critically the development of the derived gradient operator shows that this lagrange multiplier is also the average pressure on the face the vector of all face pressures is denoted λ and its length is the number of faces in the subsurface mesh central to mfd methods is the construction of discrete inner products on the scalar and vector spaces as this is sufficient to develop a discrete calculus the construction and properties of the weighting matrices that define these inner products is presented in detail by da veiga et al 2014 and lipnikov et al 2014 and is essential in proving stability and consistency of the discretizations here we note that the key component of the derived gradient operator is the mass matrix m associated with the approximation of the continuous inner product 6 u t m q d 1 q u ω d 1 q u d ω where d is the coefficient of the gradient operator associated with the flux and u is any function from hdiv ω the set of integrable vector functions with integrable divergence the accuracy of the approximation is given by the accuracy of the quadrature used to approximate this integral 3 1 1 discretization of richards equation to discretize richards equation we first ignore the time derivative and consider the associated boundary value problem at time t t n then using the mfd approach described above we set d k r s x t n κ x μ in the inner product 6 and name the resulting mass matrix m to obtain 7 m b t c t b 0 0 c 0 0 q p λ 0 0 g n here the first row approximates the darcy flux defined in eq 1c while the conservation of mass expressed in eq 1a excluding the accumulation term is described by the middle row each of these equations is local to a single cell of the mesh these local equations are coupled to neighboring cells through the continuity of the normal flux which is enforced in the third row through the lagrange multiplier recall that the lagrange multiplier is the face averaged pressure here the superscript n is used on discrete operators and vectors to indicate that these are evaluated at time t t n on external faces this third equation is the natural place to enforce the boundary condition in 7 including neumann data discretized here as g we have ignored the dirichlet boundary condition as it is complicates notation and is not used in the examples below however it is straightforward to implement at this point by replacing rows of the λ equations with identity rows subtracting off the corresponding column from the right hand side and placing the boundary data on the appropriate row of the right hand side in the richards equation we assume that the absolute permeability is given by a symmetric positive definite tensor κ 0 and that the relative permeability kr is a positive scalar bounded above zero unfortunately the relative permeability is very small in dry soils and nonlinearity is strong in the water retention models and relative permeability curves upwinding approaches have been used to achieve reasonable results within acceptable computational resources for these problems despite the introduction of first order error to upwind the cell based value of the relative permeability is mapped to a face based value with the mapping governed by the direction of the potential gradient 8 q κ x p ρ g this quantity is discretized as q and we consider the mass matrix m that would be obtained with d κ x and the diagonal scaling d n d q n k r n μ associated with the upwinded relative permeability to write the linear system in the form 9 m d n 1 b t c t b 0 0 c 0 0 q p λ 0 0 g n the mass matrix m is block diagonal with each block corresponding to a single element in the mesh to eliminate the flux we form the schur complement defining the inverse mass matrix w m 1 and note that in the mfd method w can be computed directly to avoid costly inversion then the schur complement for p λ may be written 10 s p λ t n s p λ n a p p a p λ a λ p a λ λ n b d w b t b d w c t c d w b t c d w c t n and the reduced system for the richards boundary value problem at tn without the accumulation term is 11 s p λ n p λ n 0 g n next we discretize the time derivative using backward euler a first order implicit method in this case the accumulation term on a cell ω i is approximated by 12 ω i t ϕ s t n ϕ s p i n ω i ϕ s p i n 1 ω i δ t n θ p i n θ p i n 1 δ t n where the time step δ t n t n t n 1 may vary during the simulation and we have used the definition of the discrete extensive water content θ p i n ϕ s p i n ω i we note that this discrete water content depends nonlinearly upon the discrete pressure through the water retention model finally collecting the discrete equations for the boundary value problem and the accumulation term leads to the complete discrete nonlinear system describing richards equation at time t t n 13 θ p n δ t n 0 s p λ p n p λ n θ p n 1 δ t n g n where it is assumed the primary variables are known at the previous time t n 1 3 1 2 discretization of overland flow the surface water flow equations are posed and discretized on the projected mesh shown in fig 1 the projected surface domain γ is partitioned into polygonal cells γ i which correspond exactly to faces of the subsurface mesh we note that in practice meshes are generated in the reverse direction with a constrained delaunay triangulation performed on the surface mesh then extruded into the subsurface to respect soil horizons surface flow is discretized using the two point flux finite volume method with upwinding to handle the case of zero ponded depth accuracy of this method requires a voronoi mesh as shown by many including zyvoloski and vesselinov 2006 voronoi meshes conforming to external and internal boundaries are are relatively simple to construct in two dimensions in contrast to three dimensional meshes that includes internal surfaces the discrete form of the overland flow 3a and 3b are then formed in the usual way as a function of a single vector of pressures on surface faces h s we denote them as 14 θ s h n δ t n a h h h n h n q e n q s s n θ s h n 1 δ t n where θ s h i n γ i h i n is the integrated surface water content and a h h n is the elliptic discrete surface water flux operator and q e n and q s s n are the integrated source terms each evaluated at time n 3 1 3 coupling surface and subsurface pressure continuity is imposed discretely by noting that the λ constraints on subsurface faces correspond to a pressure on faces therefore we split the discrete subsurface vector of faces λ into two sets λ the set of pressures on surface faces and λ the set of pressures on all other belowground faces then using eq 4 the vector of cell based ponded depths on the surface can be written in terms of these constraints 15 h h λ h λ p a t m λ p a t m ρ g splitting this vector of face unknowns allows the subsurface flow eq 11 to be rewritten as 16 θ n δ t n 0 0 a p p a p λ a p λ a λ p a λ λ a λ λ a λ p a λ λ a λ λ n p λ λ n θ n 1 δ t n 0 g n now we alter the surface equations to use these surface pressures λ to do this we introduce a diagonal surface cell centered matrix d h p s n d i a g h λ n p a t m ρ g and perform the change of variables in the surface eq 14 17 θ s d h p s λ n δ t n a h h h λ n λ n p a t m q e n q s s n θ s d h p s λ n 1 δ t n given this change of variables we can now impose continuity of flux using eq 5 and the definition of the discrete flux we see that g q s s 18 g j γ j g g γ j g n z γ i q s s γ i γ i q s s q s s i for a given face j on the surface corresponding to the projected mesh s cell i we can then combine eqs 16 and 17 to eliminate the unknown flux between the surface and subsurface domains resulting in the final coupled discrete equations 19 θ n δ t n 0 θ s n δ t n a p p a p λ a p λ a λ p a λ λ a λ λ a λ p a λ λ a λ λ a h h d h p s p λ λ θ n 1 δ t n 0 q e a h h d h p s p a t m θ s n 1 δ t n this discrete nonlinear problem integrates surface and subsurface hydrology into a single set of equations we note that a pp is diagonal and therefore it is trivial to invert and form a schur complement system for λ alone reducing the number of unknowns to the number of faces 3 2 time integration and nonlinear solution although the focus on this paper is on spatial discretization using mfd implementation also requires a time integration scheme and method for nonlinear solution for completeness we thus briefly summarize the implementation in the advanced terrestrial simulator amanzi ats code as configured for the below examples it is important to note that the time integration and nonlinear solution method can significantly affect performance but the choice of those algorithms does not affect any of the conclusions reached here regarding spatial discretization amanzi ats solves the resulting nonlinear problem using a preconditioned nonlinear krylov acceleration or preconditioned nka carlson and miller 1998a 1998b preconditioned nka accelerates convergence of fixed point iterations by using jacobian information gained over successive iterations as demonstrated by calef et al 2013 and lipnikov et al 2016b nka can outperform the jacobian free newton krylov method as a nonlinear solver since it requires significantly fewer evaluations of the nonlinear residual critical to the efficiency of the method is the construction and subsequent inversion of an approximate jacobian as the true jacobian is both difficult to form for the mfd case and potentially not positive definite an approximate jacobian which alleviates both of these issues is desired we use the mfd analogue of the approach by jones and woodward 2001 plus an approximate representation of the derivatives of relative permeability with respect to pressure described in lipnikov et al 2016b this approximate preconditioner for the subsurface equations are further modified to incorporate contributions from the surface equations leveraging the coincidence of surface cell and subsurface face unknowns the resulting system of equations has a complex sparsity structure and is inverted using algebraic multigrid using boomer amg falgout and yang 2002 the nonlinear solution of this problem is difficult near the transition from zero to nonzero ponded depth this is due to a discontinuity in the true jacobian at this transition for surface pressures below atmospheric pressure all surface contributions to the jacobian are zero while for nonzero ponded depth there are nonzero contributions this results in large overshoots in pressure corrections when the pressure at the surface is increasing and near but just below atmospheric pressure to enable convergence corrections which take the solution from zero ponded depth to nonzero ponded depth are limited if a correction takes the surface pressures λ from below atmospheric pressure to above it the correction is decreased so that the next iterate is p a t m ε for a small pressure change ε for a fixed time step size this locally applied physics based limiting greatly decreases the number of iterations to solution we note that the nka algorithm is changed slightly to allow user prescribed globalization when building the space that approximates the linearized system the algorithm must use the modified correction not the correction calculated in the previous iterate time is integrated using an adaptive time step size which adjusts to keep the number of nonlinear iterations within a specified range furthermore a solution is limited to a maximum saturation change taking the largest time step that a solver can calculate is not always advisable for temporal accuracy 4 benchmark comparisons to evaluate the correction of this method and implementation we compare solutions with an established model intercomparison effort in maxwell et al 2014 seven coupled surface subsurface hydrology codes were compared on a series of problems based on the original comparison of sulis et al 2010 which did a more detailed comparison between two codes parflow kollet and maxwell 2006 and cathy camporese et al 2010 the problems consist of cases of saturation and infiltration excess on a homogeneous hillslope and a case with heterogenous soil properties we demonstrate amanzi ats s solutions of these problems and compare to the published model intercomparison results in each of the following plots gray lines indicate solutions from the other seven codes in maxwell et al 2014 we do not present the tilted v catchment comparison problem here it was a surface flow only problem and therefore does not test this method additionally amanzi ats participated in the second model intercomparison as a further demonstration of the method kollet et al 2017 4 1 runoff under saturation and infiltration excess conditions in the first suite of benchmark problems a hillslope domain 400 m 320 m in horizontal extent and 2 m in depth is rained on at a rate of 33 mm min for 200 min and then the simulation is continued for another 100 min the hillslope is sloped from 5 m down in the positive x direction at a slope of 0 05 material properties including van genuchten curves manning coefficients specific storage and domain setup are described extensively in sulis et al 2010 and maxwell et al 2014 in each of these problems the spatial resolution is 5 4 m in the horizontal and 0 2 m in the vertical to match the results of maxwell et al 2014 runoff is measured as the outflow through one of the down slope surface faces i e a face of length 80 m in all runs boundary conditions in the subsurface are no flux boundary conditions on the surface are no flux with the exception of the down slope edge which is a zero head gradient condition i e s h n γ 0 4 1 1 infiltration excess to test the method under conditions resulting in infiltration excess hortonian runoff the permeability of the subsurface is set to 6 94 10 5 and 6 94 10 6 m min approximately 1 05 10 13 and 1 05 10 14 m2 in this case surface runoff is highly dependent upon accurate resolution of the subsurface as infiltration excess means that water ponds immediately accurate runoff requires accurate infiltration rates outflow rates are plotted at two permeabilities in fig 3 this figure is comparable to that of maxwell et al 2014 fig 4 ats falls within the suite of existing results 4 1 2 saturation excess for the next test conditions ensure saturation excess dunne runoff by setting hydraulic conductivity in the subsurface to be 6 94 10 4 m min equivalent to an absolute permeability of 1 05 10 12 m2 two runs with different initial water tables of 1 m and 0 5 m from the surface are shown in fig 4 as compared to all other codes compared in maxwell et al 2014 fig 5 close agreement to the intercomparison results is seen in ponding time maximum ponding depth and the ponded depth at which runoff equals the rainfall rate 4 2 runoff over a heterogeneous subsurface to test the simulations in a more challenging problem a low permeability slab is introduced in the top layer of cells 0 05m in vertical extent along x 150 250 for all y this slab is infiltration limited while the remainder of the domain is saturation limited in this problem water ponds on the surface of the slab runs off the slab and infiltrates downslope of the slab the subsurface saturation and surface ponded depth are shown in fig 5 the a and b panels in fig 5 use meshes that are sheared sloping but with vertical faces with 10 m and 1 m horizontal resolution respectively these results are best compared to sulis et al 2010 fig 6 they may also be compared to maxwell et al 2014 fig 8 which shows the 10m resolution case albeit with a shifted z axis z 5 in maxwell et al 2014 fig 8 corresponds to z 0 in sulis et al 2010 fig 6 and our fig 5 as shown by sulis et al 2010 weakly coupled operator split approaches can result in re infiltration of water from the slab on the upslope side of the slab caused by error in passing surface to subsurface nodes like the other codes that use a consistent discretization between the surface and subsurface domains and globally implicit coupling in the sulis et al 2010 comparison we do not see this unphysical behavior additionally sulis et al 2010 noted differences between codes in the width of the re infiltration front downstream of the slab specifically the cathy code produced a wider infiltration front than parflow sulis et al 2010 attributed this difference to the coupling scheme operator split for cathy and strong globally implicit for parflow however we also observe a wider re infiltration front much closer to that of cathy than that of parflow despite not seeing differences with parflow up slope of the slab we attribute the differences not to the coupling scheme but to the overland flow approximation like cathy ats uses a diffusion wave approximation while parflow used a kinematic wave approximation in the sulis et al 2010 intercomparison the difference between the two models is in the surface flow potential in a diffusion wave approximation flow is driven by h z while in a kinematic wave approximation flow is driven by z by looking at the ponded depth in fig 5 we see that the ponded depth h serves to steepen the potential relative to the kinematic wave approximation and therefore results in larger fluxes down the surface slope this increase in potential for surface flow drives the wider re infiltration front in the two diffusion wave approximation codes cathy and ats relative to the kinematic wave code parflow 5 comparison with two point flux on meshes following complex soil structure although mfd performs similarly to other discretizations on the relatively orthogonal meshes used in the above benchmark problems this is not expected to be the case for more distorted meshes to compare solutions of the mfd and fv tpfa methods on realistic meshes conforming to more complex soil structures we modify the well known v catchment or open book catchment configuration to include patchy groundcover fig 6 specifically we add discontinuous patches of duff partially decayed plant material common on the forest floor on top of an otherwise homogeneous soil duff has higher porosity and stronger capillary retention properties compared to the underlying soil and is an important control on runoff ebel et al 2012 atchley et al 2018 although other types of groundcover for example litter is often represented as part of the surface vegetation layer in integrated codes duff is a porous medium and naturally represented as part of the subsurface system duff is the part of the subsurface that is perhaps the most susceptible to disturbances particularly the ones caused by wildfires it is also a relatively thin layer which typically results in it having a patchy structure and non uniform depth this also implies that there can be multiple areas with exposed soil and the duff layer itself can be discontinuous with multiple pinchouts and complex geometry the sides of this v catchment have a 5 slope in x direction and the channel has a 3 slope in y direction the soil layer is uniform and 2m deep and duff patches have a maximum thickness of 4cm hydraulic properties for soil and duff are shown in fig 1 the sides of the v catchment are 100m by 200m and the channel is 20m by 200m the mesh is constructed by first partitioning the surface of the domain into squares then partitioning every such square into four triangles using its center the resulting surface mesh is then vertically extruded with pinching out mesh layers in duff and uniform mesh layers in soil we consider three mesh resolutions in the horizontal with maximum edge length of triangles in the surface mesh of 20m coarse 10 m base and 5m fine we also consider three mesh resolutions in the vertical with maximum thickness of duff cells of 4 cm 2 cm and 1 cm and variable vertical resolution in soil as shown in table 2 the structure of duff patches for different mesh resolutions is shown on fig 6 our numerical experiments are driven by precipitation for a hypothetical storm event fig 7 precipitation intensity exceeds the hydraulic conductivity of the soil resulting in infiltration limited runoff we monitor the hydrograph the surface water discharge from the catchment for the nine combinations of vertical and horizontal mesh resolution and for mfd and for the finite volume method with two point flux approximation fv tpfa note that the fv tpfa method is implemented as a simplification of the mfd method while the a λλ block in eq 10 is dense for the mfd method lumping it into a diagonal matrix is discretely equivalent to the two point flux approximation therefore while we cannot recover the performance advantages of the fv tpfa method we can recover to solver tolerance the fv tpfa solution results for all 18 cases are shown in fig 8 the three upper panels are for the fv tpfa and the bottom three panels are for mfd from left to right the three columns correspond to coarse base and fine vertical resolution each plot has results for the three horizontal resolutions for fixed vertical resolution fv tpfa and mfd results appear to be converging to the same hydrograph as the horizontal resolution increases for coarse and base horizontal meshes mfd is remarkably close to the fine scale result indicating rapid mesh convergence fv tpfa by contrast is overestimating the hydrograph by almost a factor of two for the coarse mesh the rapid mesh convergence of mfd compared to fv tpfa confirms that the accuracy of mfd on distorted meshes which has previously been demonstrated on subsurface only models extends to include the coupled surface subsurface system with horizontal resolution fixed increasing the vertical resolution increases the peak of the hydrograph for both mfd and fv tpfa mfd has no advantage over fv tpfa in vertical mesh convergence because we are in the infiltration limited situation where coarse vertical resolution is known and expected to overestimate infiltration and as a result underestimate the hydrograph peak 6 discussion and conclusions as physically based integrated surface subsurface models grow in complexity to address ever more demanding site specific applications the transition to fully unstructured meshes is a natural development soil and geologic layers may vary in vertical thickness along their extent including allowing for layers which pinch out at the surface depth to bedrock is spatially variable and accurately portraying that layer is important for accurate predictions of discharge camporese et al 2019 mfd and other second order conservative methods for unstructured meshes come with advantages which make them well suited for challenges in integrated hydrology such as these these methods mostly coming from the reservoir modeling community have a long history of success in similar subsurface problems here we leveraged the structure of the mimetic finite difference mfd method to include the diffusion wave equation coupled to richards equation for the subsurface coupling is naturally expressed as a de facto result of the choice of mfd as the subsurface discretization and proper choice of unknowns and boundary conditions the combined system is solved simultaneously using a globally implicit strategy in our implementation in amanzi ats we also include a physics motivated limiter in the nonlinear solution method to improve robustness when water disappears or reappears on the surface here we presented the theory of the method and compared the method to a set of model intercomparison problems in the published literature we find excellent agreement with other codes in all tests in particular a heterogeneous test highlights several key factors in comparing to previously published methods and solutions in that case implicit coupling proved critical for correctly capturing near slab effects while differences were identified in down slab re infiltration as compared to simulators implementing a kinematic wave approximation using a three dimensional v catchment with patchy groundcover duff for mesh convergence studies we confirmed that our mfd extension converges much more rapidly as the horizontal resolution is increased compared to the commonly used finite volume method with two point flux approximation fv tpfa in particular the highly distorted meshes associated with duff patches caused the fv tpfa to be inaccurate unless the mesh is highly refined whereas the coarsest mesh considered was accurate for the mfd method in general we find that the mfd method significantly reduces the discretization error on coarser grids enabling more accurate and efficient simulation this reduction is most pronounced in the horizontal direction the column structured meshes and gravity driven flows lead to similar vertical error while all second order conservative methods for unstructured meshes are a great improvement in terms of the types of structures they can represent accurately most are still limited to simplicial triangular prism and or hexahedral meshes and cannot easily deal with pinch outs hanging nodes non convex cells or other mesh degeneracies mfd has been shown to be capable of maintaining accuracy on star convex elements admits meshes with hanging nodes and is simply generalized to polyhedra with an arbitrary number of faces da veiga et al 2014 we have not exercised all of this versatility here more research is needed to explore the sensitivity of hydrologic flow and transport to the accurate resolution of these complex structures the disadvantage of mfd is the change in sparsity structure which both introduces more unknowns face based pressures and requires more expensive preconditioners here we used algebraic multigrid unfortunately it is not possible to directly compare computational cost here because the coupling scheme is derived assuming the existence of face based unknowns credit authorship contribution statement ethan t coon conceptualization methodology software validation writing review editing visualization j david moulton conceptualization methodology evgeny kikinzon software validation markus berndt software gianmarco manzini methodology rao garimella software konstantin lipnikov methodology software writing review editing scott l painter conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to especially thank reed maxwell and the participants of the first intercomparison of integrated hydrology codes for developing test problems and sharing their solutions these efforts take a lot of work but provide a true community service the ats software is open source and may be downloaded from https github amanzi ats input and output files are available by contacting the corresponding author this work was supported by ornl ldrd 8872 lanl ldrd 20150397dr and ldrd201200068dr the interoperable design of extreme scale application software ideas project and the next generation ecosystem experiment ngee arctic project ideas and ngee arctic are supported by the office of biological and environmental research in the doe office of science 
417,in this work we develop a multiscale model for flow and transport problem in co2 enhanced coalbed methane recovery the coalbed methane reservoir is characterized by two levels of porosity associated with nanopores in the matrix and cleat network mass conservation equations for fluid mixture ch4 and co2 in the matrix at the microscale are rigorously derived by using the formal homogenization technique taking into account the gas mixture adsorption in the nanopores the density functional theory dft is used to compute the gas adsorption isotherms and the solvation force acting on the nanopore wall showing a much more pronounced adsorption capacity of co2 compared to ch4 the average transport equations in the matrix together with the multiphase flow problem in fracture network gas mixture and water are homogenized giving rise to a macroscopic model ruled by the effective conductivities partition and transfer coefficients the cleat permeability evolution due to deformation is taken into account through a three scale poromechanical model reported in a previous work computational simulations illustrate the macroscopic laws underlying the gas pressure distributions cleat closure phenomena and ch4 production curve enhanced by co2 injection keywords multiscale model dual porosity multiphase flow homogenization gas adsorption enhanced coalbed methane recovery 1 introduction co2 enhanced coalbed methane recovery consists of an unconventional gas resource and environmentally sustainable procedure which combines methane production with co2 sequestration in order to successfully apply this enhanced recovery procedure one needs to describe accurately the coupled phenomena which occur at disparate length scales in this scenario describing the anomalous behavior of the gas mixture in the nanopores and developing efficient upscaling procedure capable of propagating the local description to obtain the macroscopic response is a crucial issue coal seams are composed of a coal matrix containing pores of several nanometers filled by adsorbed ch4 before exploration along with a fracture network cleats see fig 1 with much higher permeability and partially saturated with water gray 1987 ayoub et al 1991 laubach et al 1998 seidle 2011 the classical primary gas exploration simply consists of decreasing the pore pressure leading to water production from the cleats and subsequently gas desorption from the matrix ayoub et al 1991 seidle 2011 the enhanced coalbed methane recovery consists of a co2 injection process which takes advantage of the preferential co2 adsorption compared to ch4 seidle 2011 moore 2012 ross et al 2009 in spite of its advantage this enhancement technique exhibits some drawbacks which stem from the matrix swelling inducing cleat closure and decrease in permeability moore 2012 karacan 2007 such a mechanism is induced by the solvation force in the nanopores which is much more significant than the bulk pressure le et al 2019 in this paper we aim at clarifying this issue by developing a new multiscale model for flow and transport in dual porosity coalbed methane reservoir which is coupled with the three scale poromechanical model reported in a previous work le et al 2019 modeling of the coupling between transport and poromechanics problems in coal seam is well reported in the literature and classically described by dual porosity type models combined with langmuir isotherm to compute gas adsorption in the coal matrix yi et al 2009 wu et al 2010 wang et al 2018 fan et al 2018 zhang et al 2019 moreover modeling of co2 enhanced coalbed methane recovery has showed important improvement of methane production curve and matrix swelling phenomena inducing cleat closure wu et al 2010 wang et al 2018 fan et al 2018 kumar et al 2014 these models have proposed empiric macroscopic models in which no closure for effective conductivities has been provided beyond the langmuir approach molecular dynamics and stochastic modeling have been explored in order to construct accurately the adsorption isotherms and study its influence on poromechanics le et al 2019 nikoosokhan et al 2014 vandamme et al 2010 dual porosity models taking into account anomalous behavior of adsorbed fluid in the nanopores treated by statistical mechanics and its influence on the macroscopic constitutive laws through the homogenization method have been reported for applications to swelling clay and shale gas murad and moyne 2008 le et al 2015 2017 le and murad 2018 these approaches allow to construct precisely the macroscopic model with a closure for effective coefficients by propagating rigorously the information from the pore scale to the macroscale despite the above mentioned advances in coalbed methane modeling a still open issue stems from the necessity of constructing a rigorous upscaling procedure capable of capturing the local anomalous behavior of the gas mixture in the nanopores of the coal matrix and propagating this information in order to derive the poromechanical and transport problems at the macroscale in this paper we aim at filling this gap the density functional theory dft is applied to compute precisely the gas mixture adsorption quantities and the solvation force in the nanopores within the matrix gas transport in the matrix is ruled by knudsen diffusion type which is upscaled to the microscale in order to obtain the average mass conservation equations for gases in the matrix characterized by the partition coefficients and effective diffusion coefficients at the microscale gas and water transport equations in the cleats are constructed along with mass conservation equations in the matrix a second homogenization procedure is then applied to obtain a macroscopic reservoir scale model for gas and water transport the change in cleat porosity is taken into account by coupling this transport model with the three scale poromechanical model reported in le et al 2019 the paper is organized as follows in section 2 the three scale poromechanics modeling developed by the authors in le et al 2019 is briefly recalled in section 3 the gas transport in the coal matrix is homogenized to obtain average mass transport equations section 4 is devoted to the development of macroscopic constitutive laws for the transport of gas and water in the cleats coupled with gas diffusion in the matrix using a dual porosity approach numerical simulations are performed in section 5 to illustrate the potential of the multiscale model the conclusions are drawn in section 6 2 recall of the three scale poromechanical model in this section the three scale poromechanical model developed by le et al 2019 is briefly recalled this mechanical part taking into account the deformation of a dual porosity porous medium will be coupled with the flow and transport multiscale model in order to study the matrix swelling shrinkage phenomena during gas injection production in coalbed methane reservoir 2 1 adsorption phenomena in nanopores the density functional theory dft is applied to describe precisely the gas mixture adsorption phenomena in nanopores le et al 2019 kierlik and rosinberg 1991 roth 2010 rosenfeld 1989 the gas adsorption quantities and solvation force have been numerically computed for a spherical geometry by the authors le et al 2019 due to the gas confinement the pressure exerted by the gas on the solid wall of the nanopores p m π is very different from the total bulk pressure in the matrix pm the solvation force π which is much larger than pm is the dominant force in fig 2 the dependence of π on the partial bulk pressures here p ch 4 b and p co 2 b correspond to the partial bulk pressures in the matrix p m i with i 1 ch 4 2 co 2 is illustrated for a fixed pore diameter d 5 d where d is the molecule diameter the both gas molecules are assumed to have the same diameter we can observe that the absolute value of the solvation force is much higher than the bulk pressure with a fixed ch4 pressure the absolute value of the solvation force increases with the co2 bulk pressure at small co2 bulk pressure and then decreases at high co2 bulk pressure it should be noted that the solvation force reported in le et al 2019 does not keep the carbon molecule number at the solid surface constant in this paper the derivative of the external wall potential acting on the fluid molecules is made at fixed solid carbon molecule number the solvation force is now negative however a similar result as the one obtained in le et al 2019 is that the derivative of the solvation force with respect to the co2 bulk pressure is positive at high co2 bulk pressure this point is of utmost importance for the development of the poromechanics described in the following subsections it was also discussed in le et al 2019 that the adsorption potential of co2 is much more significant than ch4 so that co2 injection can provide more methane from the matrix this enhanced coalbed methane recovery technique will be discussed in details in section 5 2 2 coal matrix the matrix is assumed poroelastic with an elasticity tensor c and a biot willis coefficient α the effective stress principle for the matrix including the contribution from the solvation force reads as le et al 2019 murad and moyne 2008 le et al 2015 1 σ m c e u α p m π i in ω m where i denotes the identity tensor and e u u u t 2 the symmetric gradient of the deformation field u the fluid pressure acting on the wall of the nanopores is the sum of the bulk matrix pressure pm and the solvation force π for spherical pores the disjoining stress reduces to a scalar component π which acts to expand the matrix and therefore to close the cleats linearizing the solvation force near a reference point leads to a new form of the effective stress principle for the matrix 2 σ m σ m r e f c e u u r e f i α i p m i p m i r e f i with the modified poromechanical coefficients c and α i given by 3 c c α 2 1 β π ϕ m π ϕ m i i α i α 1 β π ϕ m 1 π p m i where π ϕm π p m i are the derivatives of π with respect to the matrix porosity ϕm and the partial pressures p m i in the reference configuration fig 3 shows the dependence of the modified biot willis parameters α i for each gas component on the partial pressures it is important to note that α i can be higher than one in contrast to the classical biot willis parameter due to the solvation force effects 2 3 macroscopic model the homogenization procedure of a three scale poromechanics problem has been examined rigorously in murad and moyne 2008 and applied to coalbed methane reservoir in le et al 2019 the total stress tensor satisfies the equilibrium condition 4 σ t 0 the displacement is the sum of three terms an elastic contribution a pressure component and a last contribution stemming from the solvation force for the sake of simplicity a quasi steady version is considered under the assumption that the local equilibrium for each fluid component is quickly obtained between the matrix and the cleats in this scenario we have p m i p f i and the pressure dependent term in the displacement is neglected the steady representations of the macroscopic stress tensor and the lagrangian cleat porosity i e the fluid volume relative to the initial total volume coussy 2004 written in an incremental form read as le et al 2019 5 δ σ t c e δ u α i i α i 1 δ p f i δ p f i 6 δ ϕ f α e δ u β i α i 1 δ p f i where c is the macroscopic elasticity tensor corresponding to a solid phase with an elastic tensor c and holes of porosity ϕ f for any variable x δ x x t δ t x t where c α β and α i are constant over the time interval δt and then updated to compute the next time interval in the isotropic case the biot s coefficients α α α i and β are given by 7 α 1 k k 8 β α ϕ f k where k and k denote the bulk modulus of the matrix and of the three scale matrix including the cleats respectively corresponding to c and c as β 0 the most intriguing point in eq 6 is that when α i 1 see fig 3 increasing the gas pressure in the cleats leads to a decrease of the cleats porosity ϕ f and to cleat closure 3 mass conservation of a fluid mixture in the matrix we begin by constructing the average mass conservation equations for a gas mixture in the matrix the matrix is composed of highly permeable disconnected inclusions nanopores locally in thermodynamic equilibrium with a virtual bulk and a solid phase occupying the sub domains ω n and ω s respectively with an interface γ ns fig 4 the gas transport in the matrix is assumed to be a knudsen diffusion mechanism in the solid phase whereas the nanopores play the role of gas storage sites for a spherical geometry the gas density profile within the nanopore was numerically computed by the authors le et al 2019 showing a highly inhomogeneous gas distribution let c s i be the gas concentration in the solid phase i ch4 co2 by neglecting the storage capacity within the solid phase the mass conservation equation reads as 9 d s i c s i 0 in ω s where d s i denotes the diffusion coefficient in the solid phase in a consistent manner the transport in the nanopores is assumed to be ruled by a diffusion mechanism in response to a virtual bulk concentration c b i in addition we will show later through the homogenization procedure that c b i is nearly uniform in each pore to describe the storage term in the nanopores we introduce the partition coefficient gi so that gic b i represents the gas quantity stored per unit volume in a nanopore in equilibrium with a bulk at concentration c b i the transport in the nanopores is given as 10 g i c b i t d n i c b i in ω n where d n i is the diffusion coefficient in the nanopores it should be kept in mind that the nanopores are supposed to be in thermodynamic equilibrium with a virtual bulk so that the diffusion coefficient in the nanopores d n i is assumed to be much larger than the diffusion coefficient in the solid phase d s i the accurate computation of gi can be achieved by the density functional theory dft le et al 2019 numerical results for gi will be presented in section 5 in addition the boundary conditions at the nanopores solid phase interface γ ns are given by 11 c b i c s i d n i c b i n d s i c s i n the set of equations 9 10 and 11 forms the pore scale model for fluid transport in the matrix our aim now is to upscale this model in order to construct the average mass conservation equations for the matrix to accomplish this task we proceed within the framework of the formal homogenization procedure with a spatially periodic structure for the matrix two length scales are introduced a nanoscopic length lz of the size of the nanopores and a microscopic characteristic length ly the ratio between the two length scales ε l z l y is the perturbation parameter assumed to be small the perturbed models are now designated as ε models the periodic domain is reconstructed from a spatially repeated cell z ε congruent to a standard cell z composed of the union of adjacent cell sub domains zn and zs occupied by the nanopores and solid phase respectively with boundaries zns the outer cell boundary where the periodic condition is applied is designated by zse the problem consists in investigating the asymptotics of this problem as ε 0 and obtaining the homogenized limit as the scale of the heterogeneity tends to zero within the current framework introduce two coordinate systems y at the microscale slow coordinate and z at the nanoscale fast coordinate together with its translation z y ε the usual procedure consists in inserting matched asymptotic expansions in the governing equations and boundary conditions at each level and collecting the successive powers of ε thus postulate the ansatz 12 f ε y z k 0 ε k f k y z with the functions f i f i y z i 0 1 2 z periodic by adopting the macroscopic point of view in the sense of auriault 1991 the differential operator is replaced by 13 f ε y z y f ε y z ε 1 z f ε y z to homogenize the preceding problem the diffusion coefficient in the nanopores d n i is supposed to be an order of magnitude larger o ϵ 1 than the diffusion coefficient of the solid matrix d s i lewandowska et al 2005 levy 1990 this assumption is based on the fact that the adsorbed gas in the nanopore is in thermodynamic equilibrium leading to an instantaneous diffusion whereas the gas transport mechanism within the solid phase is ruled by a knudsen type diffusion after a scaling analysis the problem at the pore scale is written on a unit cell z z n z s as 14 g i c b i t 1 ϵ d n i c b i in z n 0 d s i c s i in z s c b i c s i on z n s 1 ϵ d n i c b i n d s i c s i n on z n s from the above scaling analysis the averaged transport equation in the matrix can be obtained by collecting the successive powers of ϵ the details of this procedure are presented in appendix b 15 ϕ m g i c m i 0 t y d e q i y c m i 0 with the effective diffusion coefficient defined as 16 d e q i 1 z z s e d s i z n s i z χ d s where χ is the periodic vector in the unit cell satisfying the closure problem of c s i 1 in b 8 it is important to note that this homogenization procedure is not classical since the diffusion coefficient in the nanopores is an order of magnitude higher than the one in the solid phase the homogenization result shows that the nanopores play the role of storage sites whereas the diffusion mechanism occurs only in the solid phase 4 macroscopic laws in what follows the multiphase flow equations for gas and water in the cleats at the pore scale will be constructed together with the preceding average diffusion equations of gas mixture in the matrix forming the microscopic model this model will be upscaled to the macroscale to build up the macroscopic constitutive laws at the reservoir scale 4 1 microscopic model we consider the gas and water transport in the cleat system at the microscale the cleat is filled by an immiscible mixture of gas and water phases let ω m and ω f be the volumes occupied by the matrix and the cleats in addition denote γ fm the cleat matrix interface with assumption of incompressible water phase transport of gas and water in the cleats is ruled by darcy s law 17 t 1 s ρ g i ρ g i k f k r g μ g p g d ρ g ω i 0 s t k f k r w μ w p w 0 p g i p g i ρ g i ρ g i ω i ρ g i ρ g in ω f where s and ρ g i designate the water saturation and the gas density of component i in the cleats pg and pw are the total gas and water pressures whereas kf krg and krw are respectively the intrinsic permeability the gas and water relative permeabilities d the gas binary diffusion coefficient of co2 and ch4 μg and μw the gas and water dynamic viscosity the capillary pressure introduced as p c p g p w is only function of water saturation s the gas and water fluxes are defined as 18 j g i ρ g i k f k r g μ g p g d ρ g ω i j w k f k r w μ w p w omitting the superscript 0 and the subscript y and rephrasing 15 in terms of mass flux the mass conservation for gas transport in the matrix is rewritten as 19 ϕ m g i ρ m i t j g i 0 in ω m where j g i d e q i ρ m i ρ m i m g i c m i and m g i are respectively the gas flux the mass density and the molar mass of species i in the matrix the boundary condition at the cleat matrix interface γ fm is given by the continuity of flux and pressure 20 j g i n f m j g i n f m p m i p g i on γ f m where p m i denotes the partial bulk matrix pressure of component i constructed from the equation of state with given ρ m i here the pressure is assumed to be continuous at the interface rather than the concentration used in the previous section in order to simplify the upscaling of the darcy equations in the cleats in which the pressure is used 4 2 upscaling to macroscale in the same way as the homogenization procedure used in section 3 for the matrix we now upscale the preceding microscopic model to obtain the macroscopic constitutive laws for transport in the coal reservoir the periodic cell y ε is given by the union of adjacent cell sub domains y m ε and y f ε occupied by matrix and cleat respectively each cell is congruent to a standard unitary cell y composed of sub domains ym and yf with boundaries yfm the two coordinates x and y represent now micro and macroscale or fast and slow coordinates respectively so that we have y x ε we postulate the ansatz similar to 12 with the same derivation rule as 13 the ε microscopic model for the transport problem in the cleats reads as 21 t 1 s ε ρ g i ε j g i ε 0 in y f t s ε j w ε 0 in y f p c ε p g ε p w ε with 22 j g i ε ρ g i ε k f k r g μ g p g ε d ρ g ε ω i ε j w ε k f k r w μ w p g ε k f k r w μ w p c ε the ε model for gas transport in the matrix is given by 23 ϕ m g i ε ρ m i ε t j g i ε 0 in y m in the matrix gas diffusion mechanism is a knudsen diffusion type while a molecular diffusion is considered in the cleats therefore the diffusion coefficient in the matrix d e q i is much lower than the one in the cleats d as shown in table 1 in the context of dual porosity model and based on an order of magnitude estimate it is relevant to consider that d e q i ε 2 d consequently the first non zero order of j g i ε is j g i 1 so that we have j g i ε ε 2 d e q i ρ m i ε murad and moyne 2008 le et al 2015 2017 the boundary conditions read as 24 j g i ε n f m j g i ε n f m p m i ε p f i ε on y f m we now collect the successive powers of ε in the above system slow variables by invoking 21 at the order o ε 2 and the order 24 at o ε 1 we obtain 25 y ρ g i 0 k f k r g μ g y p g 0 d ρ g 0 y ω i 0 0 y k f k r w μ w y p g 0 y k f k r w μ w y p c 0 0 in y f and 26 ρ g i 0 k f k r g μ g y p g 0 d ρ g 0 y ω i 0 n 0 on γ f m the non oscillating variables are therefore 27 p g i 0 x y t p g i 0 x t ω i 0 x y t ω i 0 x t p c 0 x y t p c 0 x t in addition p c 0 is nothing else than a saturation dependent variable so that s 0 x y t s 0 x t fluctuation terms by invoking eq 21 at the order o ε 1 and eq 24 at the order o ε 0 we obtain 28 y ρ g i 0 k f k r g μ g y p g 1 d ρ g 0 y ω i 1 0 y k f k r w μ w y p g 1 y k f k r w μ w y p c 1 0 in y f and 29 ρ g i 0 k f k r g μ g x p g 0 y p g 1 d ρ g 0 x ω i 0 y ω i 1 n 0 k f k r g μ g x p g 0 y p g 1 k f k r w μ w x p c 0 y p c 1 n 0 on γ f m by definition i ω i 1 hence we obtain i ω i 1 0 by summing 28 a and 29 a with respect to i together with 29 b we obtain 30 y ρ g 0 k f k r g μ g y p g 1 0 y ρ g 0 d y ω i 1 0 in y f and 31 x p g 0 y p g 1 n 0 x ω i 0 y ω i 1 n 0 x p c 0 y p c 1 n 0 on γ f m by invoking linearity and periodicity on the outer boundary of the unit cell the classical closures for p g 1 ω i 1 and p c 1 are given by 32 p g 1 ς y x p g 0 x g x ω i 1 ς y x ω i 0 ω i x p c 1 ς y x p c 0 x c x where ς y periodic satisfies 33 y y ς 0 in y f n y ς i 0 on y f m averaged equations we now construct the macroscopic constitutive laws for gas and water transport in the coal reservoir by invoking 21 and 23 at the order o ε 0 we obtain 34 t 1 s 0 ρ g i 0 x ρ g i 0 k f k r g μ g x p g 0 y p g 1 d ρ g 0 x ω i 0 y ω i 1 y j g i 1 0 t s 0 x k f k r w μ w x p g 0 y p g 1 x k f k r w μ w x p c 0 y p c 1 y j w 1 0 and 35 ϕ m g i 0 ρ m i 0 t y j g i 1 0 with j g i 1 d e q i y ρ m i 0 the boundary conditions are given by 36 ρ m i 1 ρ g i 1 j g i 1 n f m j g i 1 n f m j w 1 n f m 0 on y f m by averaging mass conservation 34 on the unit cell combined with boundary condition 36 the transport equation for the species i of the gas phase is written as 37 t ϕ f 1 s 0 ρ g i 0 x ρ g i 0 k f k r g μ g ς i x p g 0 ρ g 0 d ς i x ω i 0 y j g i 1 1 y y f m j g i 1 n f m d γ 1 y y f m j g i 1 n m f d γ y j g i 1 ϕ m g i 0 ρ m i 0 t 1 ϕ f ϕ m g i 0 ρ m i 0 m t and for the water phase inside the cleats 38 t ϕ f s 0 x k f k r w μ w ς i x p g 0 x k f k r w μ w ς i x p c 0 0 in the context of dual porosity model the cell problem for the mass transport inside the matrix given by 15 with the dirichlet boundary condition ρ m 0 ρ f 0 on yfm has to be solved at each point a good approximation can be obtained by replacing this source term by a constant mass transfer coefficient between the matrix and the cleats see appendix a 39 1 ϕ f ϕ m g i 0 ρ m i 0 m t α t i ρ g i 0 ρ m i 0 m where α t i represents a transfer coefficient depending on the local geometry the gas mass conservation in the cleats is finally given by 40 t ϕ f 1 s 0 ρ g i 0 x ρ g i 0 k e x p g 0 ρ g 0 d e x ω i 0 α t i ρ m i 0 m ρ g i 0 with macroscopic effective coefficients k e k f k r g μ g and d e d ς i where k f k f ς i is the apparent cleat permeability 5 numerical simulation results in this section numerical simulations are carried out by solving the macroscopic equations in comsol multiphysics software for a 2d coalbed reservoir geometry of dimension 150 m 150 m as given in fig 5 co2 can be injected in the injection well at the lower left corner of the reservoir in order to enhance ch4 production we assume that the co2 injection proceeds after the water depletion procedure therefore the water saturation is taken as constant and close to the water residual saturation value in addition it should be noted that the multiscale model can also be used to simulate the water depletion phase by solving eq 38 the parameters used in the simulations are given in table 1 we consider a particular configuration in which the initial conditions satisfy α i 1 in order to observe the cleat closure phenomena for initial conditions the ch4 and co2 pressures in the reservoir are uniform at 2 mpa and 2 mpa respectively at the edges of the reservoir no flux condition is imposed and the displacement is taken to be zero i e the overall reservoir volume is constant at the injection well co2 is injected at 5 mpa whereas zero methane flux is applied at the production well dirichlet boundary conditions for ch4 and co2 pressures are taken at 0 1 mpa and 2 mpa respectively the transfer coefficients α t i are given by lim and aziz 1995 41 α t i 2 π 2 s 2 d e q i where s is the spacing of cleats the characteristic diffusion time in the matrix can be estimated from eq 39 as 42 t d 1 ϕ f ϕ m g i α t i for d e q 1 10 11 m 2 s 1 and d e q 2 6 10 12 m 2 s 1 the characteristic time for the two gases is several days so that very small pressure differences are observed between the matrix and the cleats firstly in fig 6 the partition coefficients g 1 and g 2 relative to ch4 and co2 depending on the partial pressures are computed by using the dft for a spherical geometry we may observe that the partition coefficient values for co2 g 2 are much higher than the those for ch4 g 1 showing an adsorption potential of co2 significantly higher compared to ch4 moreover the partition coefficients decrease with the increase in partial pressures in fig 7 the methane pressure distributions in the cleats for four different times 1 12 24 and 36 months are displayed we can observe the depletion with time of the methane pressure and a much more pronounced decrease near the production well due to co2 injection ch4 is replaced by co2 leading to a significant pressure decrease near the injection well fig 8 depicts the co2 pressure distributions in the reservoir for four different times the co2 pressure increases in the vicinity of the production well whereas the injected co2 does not yet reach the production well after 36 months of injection the cleat porosity change is taken into account by coupling the transport model with the three scale poromechanical model the cleat permeability is related to the cleat porosity by the cubic relationship 43 k f k f 0 ϕ f ϕ f 0 3 the cleat porosity for different times is represented in fig 9 highlighting an important decrease in porosity near the injection well and this decrease propagates to the production well during the injection period on the other hand near the production well the total pressure decrease leads to a matrix shrinkage and to an increase of the cleat porosity moreover the ratio between the cleat permeability and its initial value is illustrated in fig 10 near the injection well the cleat permeability decreases significantly due to a strong matrix swelling induced by co2 adsorption as observed at the nanoscale by the dft approach the adsorption potential of co2 is higher than ch4 therefore co2 can replace ch4 in the nanopores inducing a less attractive solvation force which swells the matrix particular attention must be paid to the injection pressure to avoid closing totally the cleats near the injection well finally the methane production curves are plotted in fig 11 for both cases without and with injection the numerical results show a very promising technique of enhanced coalbed methane recovery in this configuration the injection of co2 allows 16 more methane to be recovered than in the scenario without injection 6 conclusion in this work a three scale model for flow and transport in coalbed methane reservoir enhanced by co2 injection has been developed the coalbed methane reservoir is characterized by a matrix composed of solid and nanopores saturated by adsorbed gas and a cleat network the dft approach allows to compute precisely the gas mixture quantities adsorbed in the matrix and the solvation force acting on the nanopores surface a first homogenization procedure was used to obtain the average mass conservation equations for the two gases ch4 and co2 in the matrix taking into account the adsorption phenomena characterized by a partition coefficient and an effective knudsen type diffusion special attention was paid to upscale the problem of disconnected highly permeable nanopores immersed in a low permeable matrix incorporating adsorption phenomena effects a second homogenization procedure was applied to obtain macroscopic averaged equations for gas diffusion in the matrix and gas water transport in the cleats a dual porosity model of warren and root type approximates the mass exchange between matrix and cleats through a matrix fracture transfer shape factor the current model for flow and transport in coalbed methane reservoir is coupled with the three scale poromechanical model developed in a previous work to construct a full model which accurately describes the simultaneous mechanics and transport multiscale problems in a coalbed methane reservoir with co2 injection such a model is capable of explaining the improvement of the methane production curve and also the counter intuitive and experimentally observed cleats closure phenomena simulations showed that the cleat permeability decrease is significant near the injection well due to high injection pressure and can close the cleats if special attention is not paid to the injection pressure of co2 the important result of this work is to illustrate the potential of the proposed multiscale approach to couple complex adsorption phenomena at the nanoscale with mechanics and transport problem at the reservoir scale credit authorship contribution statement t d le conceptualization methodology software writing original draft writing review editing q d ha writing review editing i panfilov writing review editing c moyne conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a warren and root approximation in this appendix an approximation for the mass transfer term in the matrix in the sense of warren and root 1963 is developed in the isotropic case the effective diffusion coefficient d e q i reduces to d eq i so that from 23 the mass conservation equation for species i in the matrix is given as a 1 ϕ m g i ρ m i t d e q i ρ m i in y m ρ m i ρ f i on y f m ρ m i ρ m i i n i at t 0 on the interface yfm between the cleats and the matrix the mass density is imposed by the value in the cleats and an uniform initial condition is assumed in addition ρ m i is a y periodic function the mass exchange term for species i from the matrix to the cleats is given by a 2 q m f i 1 y y f m d e q i ρ m i n m f d γ where n m f is the normal outside the matrix at the matrix cleats interface using the periodic condition at the outer boundary yme of the unit cell y and considering the divergence theorem and eqs a 1 we have a 3 q m f i 1 y y f m y m e d e q i ρ m i n m f d γ 1 y y m d e q i ρ m i d v 1 y y m ϕ m g i ρ m i t d v t 1 ϕ f ϕ m g i ρ m i m neglecting the slow variation of ϕm and gi with time relative to the diffusion time eqs a 1 become a 4 ϕ m g i ρ m i t d e q i ρ m i in y m ρ m i ρ f i t on y f m ρ m i ρ m i i n i at t 0 the above problem can be solved using the following auxiliary problem a 5 u m i t d e q i 2 u m i in y m u m i 1 on y f m u m i 0 at t 0 where d e q i d e q i ϕ m g i is the apparent diffusion coefficient the problem a 5 is now written in the laplace space in time with the laplace variable p and u m i l u m i designating the laplace transform of u m i it yields a 6 p u m i d e q i 2 u m i in y m u m i 1 p on y f m the solution of the problem a 4 for ρ m i is easily obtained using the auxiliary problem a 5 in the laplace domain the exact solution is given by a 7 ρ m i p ρ f i u m i where ρ m i l ρ m i ρ m i i n i and ρ f i l ρ f i ρ m i i n i averaging over the unit cell y leads to a 8 ρ m i m p ρ f i u m i m the exchange term a 3 is given in the laplace space by a 9 q m f i 1 ϕ f ϕ m g i p ρ m i m 1 ϕ f ϕ m g i p 2 ρ f i u m i m by using relation a 8 a 10 ρ m i m ρ f i ρ f i p u m i m 1 the exchange term q m f i can be expressed in function of the gases density difference between the matrix and the cleats a 11 q m f i 1 ϕ f ϕ m g i p 2 u m i m p u m i m 1 ρ m i m ρ f i p α i ρ m i m ρ f i where p α i 1 ϕ f ϕ m g i p 2 u m i m p u m i m 1 the inverse laplace transform allows to write the exact solution of problem a 4 in the form of a time convolution where α i t l 1 α i p a 12 q m f i τ 0 t α i t τ τ ρ m i m ρ f i τ d τ rather than using the exact preceding expression warren and root s approximation consists in replacing it with a simple product introducing the so called matrix fracture transfer shape factor α t i warren and root 1963 a 13 q m f i α t i ρ m i m ρ f i there are several ways to determine this shape factor one way is to compute the limit of the exact expression for large time values α t i lim p 0 p α i if the matrix is a set of rectangular parallelepipeds of size lx ly lz α t i 12 d i 1 l x 2 1 l y 2 1 l z 2 other values are available in the literature warren and root 1963 lim and aziz 1995 kazemi et al 1976 heinemann and mittermeir 2012 appendix b upscaling of the nanoscopic model in this appendix the homogenization procedure to upscale the nanoscopic model presented in the section 3 is developed from the scaling eqs 14 we now collect the successive power of ϵ slow variables the problem in c b i 0 periodic in z is written as b 1 z d n i z c b i 0 0 in z n d n i z c b i 0 n 0 on z n s whose solution is c b i 0 t y z c b i 0 t y in a similar way the problem in c s i 0 is written in the solid phase b 2 z d n i z c s i 0 0 in z s c s i 0 c b i 0 on z n s with periodic boundary conditions on the external frontier of the unit cell zse the solution is obvious c s i 0 t y z c s i 0 t y c b i 0 t y c m i 0 t y here c m i 0 t y represents the zero order of the gas concentration in the matrix which depends only on y fluctuation terms the problem in c b i 1 is given as b 3 z d n i z c b i 1 0 in z n d n i z c b i 1 y c m i 0 n 0 on z n s whose solution is b 4 c b i 1 c b 1 t y z y c m i 0 where c b 1 t y plays the role of an integration constant from eq b 4 we obtain immediately the flux in the nanopores at the order o ϵ 1 given by b 5 j n i 1 d n i z c b i 1 y c m i 0 0 considering the taylor development of cb t y z one obtains b 6 c b i t y z c m i 0 t y z y c m i 0 t y c b i 1 t y z o ϵ 2 c m i 0 t y z y c m i 0 t y c b 1 t y z y c m i 0 t y o ϵ 2 c m i 0 t y c b 1 t y o ϵ 2 we remark that in the unit cell z the concentration c b i in the nanopores is constant at the order o ϵ 2 the problem in c s i 1 is written in the solid matrix b 7 z j s i 0 z d s i z c s i 1 y c m i 0 z d s i z c s i 1 0 in z s c s i 1 c b i 1 t y z y c m i 0 on z n s with periodic boundary conditions on the external frontiers of the unit cell zse the solution is searched in the form b 8 c s i 1 t y z c b 1 t y χ z y c m i 0 t y where the vector χ periodic in the unit cell is solution of b 9 z d s i z χ 0 in z s χ z on z n s averaged equations taking into account relation b 5 the problem in c b i 2 is given as b 10 z d n i z c b i 2 y c b i 1 0 in z n d n i z c b i 2 y c b i 1 n d s i z c s i 1 y c m i 0 n on z n s finally the problems in c b i 3 and c s i 2 as well as the flux condition on the interface zns are written as b 11 g i c m i 0 t z d n i z c b i 3 y c b i 2 y d n i z c b i 2 y c b i 1 in z n 0 z d s i z c s i 2 y c s i 1 y d s i z c s i 1 y c m i 0 in z s d n i z c b i 3 y c b i 2 n d s i z c s i 2 y c s i 1 n on z n s given the boundary condition on the interface zns and periodicity conditions on the boundary of the cell zse averaging the previous equations over the unit cell leads to b 12 ϕ m g i c m i 0 t 1 z y z n j n i 0 d v z s j s i 0 d v y j i 0 with b 13 j s i 0 d s i z c s i 1 y c m i 0 b 14 j n i 0 d n i z c b i 2 y c b i 1 where ϕ m z n z is the volume fraction of nanopores in the matrix it should be noted that in the case of different pore diameters with different volumes vk we obtain b 15 g i k g i k v k k v k recall relations b 7 a and b 10 b 16 z j s i 0 0 in z s z j n i 0 0 in z n j s i 0 n j n i 0 n on z n s for a divergence free flux j i e j 0 in z we have b 17 j z j z j j integrating the above relation in z leads to b 18 z j d v z j z d v z n j z d s z z j n d s where n is the outward normal to z on the boundary z of the domain applying this relation to the two fluxes j n i 0 and j n i 0 gives b 19 z n j n i 0 d v z n s z j n i 0 n n d s b 20 z s j s i 0 d v z n s z j s i 0 n s d s z s e z j s i 0 n s d s adding both relations with n n n s on zns taking into account the closure relation for c s i 1 leads to the average total flux b 21 j i 0 1 z z s e z j s i 0 n s d s 1 z z s e z d s i z c s i 1 y c m i 0 n s d s 1 z z s e d s i z n s i z χ d s y c m i 0 d e q i y c m i 0 with the effective diffusion coefficient defined as b 22 d e q i 1 z z s e d s i z n s i z χ d s if the unit cell is a rectangular parallelepiped ℓ1 ℓ2 ℓ3 with σ j designating the facet relative to the normal n j by using periodic condition the averaged diffusion coefficient is given by b 23 d e q i j k 1 σ j σ j d s i δ j k χ k z j d s the averaged transport equation in the matrix b 12 can be obtained b 24 ϕ m g i c m i 0 t y d e q i y c m i 0 
417,in this work we develop a multiscale model for flow and transport problem in co2 enhanced coalbed methane recovery the coalbed methane reservoir is characterized by two levels of porosity associated with nanopores in the matrix and cleat network mass conservation equations for fluid mixture ch4 and co2 in the matrix at the microscale are rigorously derived by using the formal homogenization technique taking into account the gas mixture adsorption in the nanopores the density functional theory dft is used to compute the gas adsorption isotherms and the solvation force acting on the nanopore wall showing a much more pronounced adsorption capacity of co2 compared to ch4 the average transport equations in the matrix together with the multiphase flow problem in fracture network gas mixture and water are homogenized giving rise to a macroscopic model ruled by the effective conductivities partition and transfer coefficients the cleat permeability evolution due to deformation is taken into account through a three scale poromechanical model reported in a previous work computational simulations illustrate the macroscopic laws underlying the gas pressure distributions cleat closure phenomena and ch4 production curve enhanced by co2 injection keywords multiscale model dual porosity multiphase flow homogenization gas adsorption enhanced coalbed methane recovery 1 introduction co2 enhanced coalbed methane recovery consists of an unconventional gas resource and environmentally sustainable procedure which combines methane production with co2 sequestration in order to successfully apply this enhanced recovery procedure one needs to describe accurately the coupled phenomena which occur at disparate length scales in this scenario describing the anomalous behavior of the gas mixture in the nanopores and developing efficient upscaling procedure capable of propagating the local description to obtain the macroscopic response is a crucial issue coal seams are composed of a coal matrix containing pores of several nanometers filled by adsorbed ch4 before exploration along with a fracture network cleats see fig 1 with much higher permeability and partially saturated with water gray 1987 ayoub et al 1991 laubach et al 1998 seidle 2011 the classical primary gas exploration simply consists of decreasing the pore pressure leading to water production from the cleats and subsequently gas desorption from the matrix ayoub et al 1991 seidle 2011 the enhanced coalbed methane recovery consists of a co2 injection process which takes advantage of the preferential co2 adsorption compared to ch4 seidle 2011 moore 2012 ross et al 2009 in spite of its advantage this enhancement technique exhibits some drawbacks which stem from the matrix swelling inducing cleat closure and decrease in permeability moore 2012 karacan 2007 such a mechanism is induced by the solvation force in the nanopores which is much more significant than the bulk pressure le et al 2019 in this paper we aim at clarifying this issue by developing a new multiscale model for flow and transport in dual porosity coalbed methane reservoir which is coupled with the three scale poromechanical model reported in a previous work le et al 2019 modeling of the coupling between transport and poromechanics problems in coal seam is well reported in the literature and classically described by dual porosity type models combined with langmuir isotherm to compute gas adsorption in the coal matrix yi et al 2009 wu et al 2010 wang et al 2018 fan et al 2018 zhang et al 2019 moreover modeling of co2 enhanced coalbed methane recovery has showed important improvement of methane production curve and matrix swelling phenomena inducing cleat closure wu et al 2010 wang et al 2018 fan et al 2018 kumar et al 2014 these models have proposed empiric macroscopic models in which no closure for effective conductivities has been provided beyond the langmuir approach molecular dynamics and stochastic modeling have been explored in order to construct accurately the adsorption isotherms and study its influence on poromechanics le et al 2019 nikoosokhan et al 2014 vandamme et al 2010 dual porosity models taking into account anomalous behavior of adsorbed fluid in the nanopores treated by statistical mechanics and its influence on the macroscopic constitutive laws through the homogenization method have been reported for applications to swelling clay and shale gas murad and moyne 2008 le et al 2015 2017 le and murad 2018 these approaches allow to construct precisely the macroscopic model with a closure for effective coefficients by propagating rigorously the information from the pore scale to the macroscale despite the above mentioned advances in coalbed methane modeling a still open issue stems from the necessity of constructing a rigorous upscaling procedure capable of capturing the local anomalous behavior of the gas mixture in the nanopores of the coal matrix and propagating this information in order to derive the poromechanical and transport problems at the macroscale in this paper we aim at filling this gap the density functional theory dft is applied to compute precisely the gas mixture adsorption quantities and the solvation force in the nanopores within the matrix gas transport in the matrix is ruled by knudsen diffusion type which is upscaled to the microscale in order to obtain the average mass conservation equations for gases in the matrix characterized by the partition coefficients and effective diffusion coefficients at the microscale gas and water transport equations in the cleats are constructed along with mass conservation equations in the matrix a second homogenization procedure is then applied to obtain a macroscopic reservoir scale model for gas and water transport the change in cleat porosity is taken into account by coupling this transport model with the three scale poromechanical model reported in le et al 2019 the paper is organized as follows in section 2 the three scale poromechanics modeling developed by the authors in le et al 2019 is briefly recalled in section 3 the gas transport in the coal matrix is homogenized to obtain average mass transport equations section 4 is devoted to the development of macroscopic constitutive laws for the transport of gas and water in the cleats coupled with gas diffusion in the matrix using a dual porosity approach numerical simulations are performed in section 5 to illustrate the potential of the multiscale model the conclusions are drawn in section 6 2 recall of the three scale poromechanical model in this section the three scale poromechanical model developed by le et al 2019 is briefly recalled this mechanical part taking into account the deformation of a dual porosity porous medium will be coupled with the flow and transport multiscale model in order to study the matrix swelling shrinkage phenomena during gas injection production in coalbed methane reservoir 2 1 adsorption phenomena in nanopores the density functional theory dft is applied to describe precisely the gas mixture adsorption phenomena in nanopores le et al 2019 kierlik and rosinberg 1991 roth 2010 rosenfeld 1989 the gas adsorption quantities and solvation force have been numerically computed for a spherical geometry by the authors le et al 2019 due to the gas confinement the pressure exerted by the gas on the solid wall of the nanopores p m π is very different from the total bulk pressure in the matrix pm the solvation force π which is much larger than pm is the dominant force in fig 2 the dependence of π on the partial bulk pressures here p ch 4 b and p co 2 b correspond to the partial bulk pressures in the matrix p m i with i 1 ch 4 2 co 2 is illustrated for a fixed pore diameter d 5 d where d is the molecule diameter the both gas molecules are assumed to have the same diameter we can observe that the absolute value of the solvation force is much higher than the bulk pressure with a fixed ch4 pressure the absolute value of the solvation force increases with the co2 bulk pressure at small co2 bulk pressure and then decreases at high co2 bulk pressure it should be noted that the solvation force reported in le et al 2019 does not keep the carbon molecule number at the solid surface constant in this paper the derivative of the external wall potential acting on the fluid molecules is made at fixed solid carbon molecule number the solvation force is now negative however a similar result as the one obtained in le et al 2019 is that the derivative of the solvation force with respect to the co2 bulk pressure is positive at high co2 bulk pressure this point is of utmost importance for the development of the poromechanics described in the following subsections it was also discussed in le et al 2019 that the adsorption potential of co2 is much more significant than ch4 so that co2 injection can provide more methane from the matrix this enhanced coalbed methane recovery technique will be discussed in details in section 5 2 2 coal matrix the matrix is assumed poroelastic with an elasticity tensor c and a biot willis coefficient α the effective stress principle for the matrix including the contribution from the solvation force reads as le et al 2019 murad and moyne 2008 le et al 2015 1 σ m c e u α p m π i in ω m where i denotes the identity tensor and e u u u t 2 the symmetric gradient of the deformation field u the fluid pressure acting on the wall of the nanopores is the sum of the bulk matrix pressure pm and the solvation force π for spherical pores the disjoining stress reduces to a scalar component π which acts to expand the matrix and therefore to close the cleats linearizing the solvation force near a reference point leads to a new form of the effective stress principle for the matrix 2 σ m σ m r e f c e u u r e f i α i p m i p m i r e f i with the modified poromechanical coefficients c and α i given by 3 c c α 2 1 β π ϕ m π ϕ m i i α i α 1 β π ϕ m 1 π p m i where π ϕm π p m i are the derivatives of π with respect to the matrix porosity ϕm and the partial pressures p m i in the reference configuration fig 3 shows the dependence of the modified biot willis parameters α i for each gas component on the partial pressures it is important to note that α i can be higher than one in contrast to the classical biot willis parameter due to the solvation force effects 2 3 macroscopic model the homogenization procedure of a three scale poromechanics problem has been examined rigorously in murad and moyne 2008 and applied to coalbed methane reservoir in le et al 2019 the total stress tensor satisfies the equilibrium condition 4 σ t 0 the displacement is the sum of three terms an elastic contribution a pressure component and a last contribution stemming from the solvation force for the sake of simplicity a quasi steady version is considered under the assumption that the local equilibrium for each fluid component is quickly obtained between the matrix and the cleats in this scenario we have p m i p f i and the pressure dependent term in the displacement is neglected the steady representations of the macroscopic stress tensor and the lagrangian cleat porosity i e the fluid volume relative to the initial total volume coussy 2004 written in an incremental form read as le et al 2019 5 δ σ t c e δ u α i i α i 1 δ p f i δ p f i 6 δ ϕ f α e δ u β i α i 1 δ p f i where c is the macroscopic elasticity tensor corresponding to a solid phase with an elastic tensor c and holes of porosity ϕ f for any variable x δ x x t δ t x t where c α β and α i are constant over the time interval δt and then updated to compute the next time interval in the isotropic case the biot s coefficients α α α i and β are given by 7 α 1 k k 8 β α ϕ f k where k and k denote the bulk modulus of the matrix and of the three scale matrix including the cleats respectively corresponding to c and c as β 0 the most intriguing point in eq 6 is that when α i 1 see fig 3 increasing the gas pressure in the cleats leads to a decrease of the cleats porosity ϕ f and to cleat closure 3 mass conservation of a fluid mixture in the matrix we begin by constructing the average mass conservation equations for a gas mixture in the matrix the matrix is composed of highly permeable disconnected inclusions nanopores locally in thermodynamic equilibrium with a virtual bulk and a solid phase occupying the sub domains ω n and ω s respectively with an interface γ ns fig 4 the gas transport in the matrix is assumed to be a knudsen diffusion mechanism in the solid phase whereas the nanopores play the role of gas storage sites for a spherical geometry the gas density profile within the nanopore was numerically computed by the authors le et al 2019 showing a highly inhomogeneous gas distribution let c s i be the gas concentration in the solid phase i ch4 co2 by neglecting the storage capacity within the solid phase the mass conservation equation reads as 9 d s i c s i 0 in ω s where d s i denotes the diffusion coefficient in the solid phase in a consistent manner the transport in the nanopores is assumed to be ruled by a diffusion mechanism in response to a virtual bulk concentration c b i in addition we will show later through the homogenization procedure that c b i is nearly uniform in each pore to describe the storage term in the nanopores we introduce the partition coefficient gi so that gic b i represents the gas quantity stored per unit volume in a nanopore in equilibrium with a bulk at concentration c b i the transport in the nanopores is given as 10 g i c b i t d n i c b i in ω n where d n i is the diffusion coefficient in the nanopores it should be kept in mind that the nanopores are supposed to be in thermodynamic equilibrium with a virtual bulk so that the diffusion coefficient in the nanopores d n i is assumed to be much larger than the diffusion coefficient in the solid phase d s i the accurate computation of gi can be achieved by the density functional theory dft le et al 2019 numerical results for gi will be presented in section 5 in addition the boundary conditions at the nanopores solid phase interface γ ns are given by 11 c b i c s i d n i c b i n d s i c s i n the set of equations 9 10 and 11 forms the pore scale model for fluid transport in the matrix our aim now is to upscale this model in order to construct the average mass conservation equations for the matrix to accomplish this task we proceed within the framework of the formal homogenization procedure with a spatially periodic structure for the matrix two length scales are introduced a nanoscopic length lz of the size of the nanopores and a microscopic characteristic length ly the ratio between the two length scales ε l z l y is the perturbation parameter assumed to be small the perturbed models are now designated as ε models the periodic domain is reconstructed from a spatially repeated cell z ε congruent to a standard cell z composed of the union of adjacent cell sub domains zn and zs occupied by the nanopores and solid phase respectively with boundaries zns the outer cell boundary where the periodic condition is applied is designated by zse the problem consists in investigating the asymptotics of this problem as ε 0 and obtaining the homogenized limit as the scale of the heterogeneity tends to zero within the current framework introduce two coordinate systems y at the microscale slow coordinate and z at the nanoscale fast coordinate together with its translation z y ε the usual procedure consists in inserting matched asymptotic expansions in the governing equations and boundary conditions at each level and collecting the successive powers of ε thus postulate the ansatz 12 f ε y z k 0 ε k f k y z with the functions f i f i y z i 0 1 2 z periodic by adopting the macroscopic point of view in the sense of auriault 1991 the differential operator is replaced by 13 f ε y z y f ε y z ε 1 z f ε y z to homogenize the preceding problem the diffusion coefficient in the nanopores d n i is supposed to be an order of magnitude larger o ϵ 1 than the diffusion coefficient of the solid matrix d s i lewandowska et al 2005 levy 1990 this assumption is based on the fact that the adsorbed gas in the nanopore is in thermodynamic equilibrium leading to an instantaneous diffusion whereas the gas transport mechanism within the solid phase is ruled by a knudsen type diffusion after a scaling analysis the problem at the pore scale is written on a unit cell z z n z s as 14 g i c b i t 1 ϵ d n i c b i in z n 0 d s i c s i in z s c b i c s i on z n s 1 ϵ d n i c b i n d s i c s i n on z n s from the above scaling analysis the averaged transport equation in the matrix can be obtained by collecting the successive powers of ϵ the details of this procedure are presented in appendix b 15 ϕ m g i c m i 0 t y d e q i y c m i 0 with the effective diffusion coefficient defined as 16 d e q i 1 z z s e d s i z n s i z χ d s where χ is the periodic vector in the unit cell satisfying the closure problem of c s i 1 in b 8 it is important to note that this homogenization procedure is not classical since the diffusion coefficient in the nanopores is an order of magnitude higher than the one in the solid phase the homogenization result shows that the nanopores play the role of storage sites whereas the diffusion mechanism occurs only in the solid phase 4 macroscopic laws in what follows the multiphase flow equations for gas and water in the cleats at the pore scale will be constructed together with the preceding average diffusion equations of gas mixture in the matrix forming the microscopic model this model will be upscaled to the macroscale to build up the macroscopic constitutive laws at the reservoir scale 4 1 microscopic model we consider the gas and water transport in the cleat system at the microscale the cleat is filled by an immiscible mixture of gas and water phases let ω m and ω f be the volumes occupied by the matrix and the cleats in addition denote γ fm the cleat matrix interface with assumption of incompressible water phase transport of gas and water in the cleats is ruled by darcy s law 17 t 1 s ρ g i ρ g i k f k r g μ g p g d ρ g ω i 0 s t k f k r w μ w p w 0 p g i p g i ρ g i ρ g i ω i ρ g i ρ g in ω f where s and ρ g i designate the water saturation and the gas density of component i in the cleats pg and pw are the total gas and water pressures whereas kf krg and krw are respectively the intrinsic permeability the gas and water relative permeabilities d the gas binary diffusion coefficient of co2 and ch4 μg and μw the gas and water dynamic viscosity the capillary pressure introduced as p c p g p w is only function of water saturation s the gas and water fluxes are defined as 18 j g i ρ g i k f k r g μ g p g d ρ g ω i j w k f k r w μ w p w omitting the superscript 0 and the subscript y and rephrasing 15 in terms of mass flux the mass conservation for gas transport in the matrix is rewritten as 19 ϕ m g i ρ m i t j g i 0 in ω m where j g i d e q i ρ m i ρ m i m g i c m i and m g i are respectively the gas flux the mass density and the molar mass of species i in the matrix the boundary condition at the cleat matrix interface γ fm is given by the continuity of flux and pressure 20 j g i n f m j g i n f m p m i p g i on γ f m where p m i denotes the partial bulk matrix pressure of component i constructed from the equation of state with given ρ m i here the pressure is assumed to be continuous at the interface rather than the concentration used in the previous section in order to simplify the upscaling of the darcy equations in the cleats in which the pressure is used 4 2 upscaling to macroscale in the same way as the homogenization procedure used in section 3 for the matrix we now upscale the preceding microscopic model to obtain the macroscopic constitutive laws for transport in the coal reservoir the periodic cell y ε is given by the union of adjacent cell sub domains y m ε and y f ε occupied by matrix and cleat respectively each cell is congruent to a standard unitary cell y composed of sub domains ym and yf with boundaries yfm the two coordinates x and y represent now micro and macroscale or fast and slow coordinates respectively so that we have y x ε we postulate the ansatz similar to 12 with the same derivation rule as 13 the ε microscopic model for the transport problem in the cleats reads as 21 t 1 s ε ρ g i ε j g i ε 0 in y f t s ε j w ε 0 in y f p c ε p g ε p w ε with 22 j g i ε ρ g i ε k f k r g μ g p g ε d ρ g ε ω i ε j w ε k f k r w μ w p g ε k f k r w μ w p c ε the ε model for gas transport in the matrix is given by 23 ϕ m g i ε ρ m i ε t j g i ε 0 in y m in the matrix gas diffusion mechanism is a knudsen diffusion type while a molecular diffusion is considered in the cleats therefore the diffusion coefficient in the matrix d e q i is much lower than the one in the cleats d as shown in table 1 in the context of dual porosity model and based on an order of magnitude estimate it is relevant to consider that d e q i ε 2 d consequently the first non zero order of j g i ε is j g i 1 so that we have j g i ε ε 2 d e q i ρ m i ε murad and moyne 2008 le et al 2015 2017 the boundary conditions read as 24 j g i ε n f m j g i ε n f m p m i ε p f i ε on y f m we now collect the successive powers of ε in the above system slow variables by invoking 21 at the order o ε 2 and the order 24 at o ε 1 we obtain 25 y ρ g i 0 k f k r g μ g y p g 0 d ρ g 0 y ω i 0 0 y k f k r w μ w y p g 0 y k f k r w μ w y p c 0 0 in y f and 26 ρ g i 0 k f k r g μ g y p g 0 d ρ g 0 y ω i 0 n 0 on γ f m the non oscillating variables are therefore 27 p g i 0 x y t p g i 0 x t ω i 0 x y t ω i 0 x t p c 0 x y t p c 0 x t in addition p c 0 is nothing else than a saturation dependent variable so that s 0 x y t s 0 x t fluctuation terms by invoking eq 21 at the order o ε 1 and eq 24 at the order o ε 0 we obtain 28 y ρ g i 0 k f k r g μ g y p g 1 d ρ g 0 y ω i 1 0 y k f k r w μ w y p g 1 y k f k r w μ w y p c 1 0 in y f and 29 ρ g i 0 k f k r g μ g x p g 0 y p g 1 d ρ g 0 x ω i 0 y ω i 1 n 0 k f k r g μ g x p g 0 y p g 1 k f k r w μ w x p c 0 y p c 1 n 0 on γ f m by definition i ω i 1 hence we obtain i ω i 1 0 by summing 28 a and 29 a with respect to i together with 29 b we obtain 30 y ρ g 0 k f k r g μ g y p g 1 0 y ρ g 0 d y ω i 1 0 in y f and 31 x p g 0 y p g 1 n 0 x ω i 0 y ω i 1 n 0 x p c 0 y p c 1 n 0 on γ f m by invoking linearity and periodicity on the outer boundary of the unit cell the classical closures for p g 1 ω i 1 and p c 1 are given by 32 p g 1 ς y x p g 0 x g x ω i 1 ς y x ω i 0 ω i x p c 1 ς y x p c 0 x c x where ς y periodic satisfies 33 y y ς 0 in y f n y ς i 0 on y f m averaged equations we now construct the macroscopic constitutive laws for gas and water transport in the coal reservoir by invoking 21 and 23 at the order o ε 0 we obtain 34 t 1 s 0 ρ g i 0 x ρ g i 0 k f k r g μ g x p g 0 y p g 1 d ρ g 0 x ω i 0 y ω i 1 y j g i 1 0 t s 0 x k f k r w μ w x p g 0 y p g 1 x k f k r w μ w x p c 0 y p c 1 y j w 1 0 and 35 ϕ m g i 0 ρ m i 0 t y j g i 1 0 with j g i 1 d e q i y ρ m i 0 the boundary conditions are given by 36 ρ m i 1 ρ g i 1 j g i 1 n f m j g i 1 n f m j w 1 n f m 0 on y f m by averaging mass conservation 34 on the unit cell combined with boundary condition 36 the transport equation for the species i of the gas phase is written as 37 t ϕ f 1 s 0 ρ g i 0 x ρ g i 0 k f k r g μ g ς i x p g 0 ρ g 0 d ς i x ω i 0 y j g i 1 1 y y f m j g i 1 n f m d γ 1 y y f m j g i 1 n m f d γ y j g i 1 ϕ m g i 0 ρ m i 0 t 1 ϕ f ϕ m g i 0 ρ m i 0 m t and for the water phase inside the cleats 38 t ϕ f s 0 x k f k r w μ w ς i x p g 0 x k f k r w μ w ς i x p c 0 0 in the context of dual porosity model the cell problem for the mass transport inside the matrix given by 15 with the dirichlet boundary condition ρ m 0 ρ f 0 on yfm has to be solved at each point a good approximation can be obtained by replacing this source term by a constant mass transfer coefficient between the matrix and the cleats see appendix a 39 1 ϕ f ϕ m g i 0 ρ m i 0 m t α t i ρ g i 0 ρ m i 0 m where α t i represents a transfer coefficient depending on the local geometry the gas mass conservation in the cleats is finally given by 40 t ϕ f 1 s 0 ρ g i 0 x ρ g i 0 k e x p g 0 ρ g 0 d e x ω i 0 α t i ρ m i 0 m ρ g i 0 with macroscopic effective coefficients k e k f k r g μ g and d e d ς i where k f k f ς i is the apparent cleat permeability 5 numerical simulation results in this section numerical simulations are carried out by solving the macroscopic equations in comsol multiphysics software for a 2d coalbed reservoir geometry of dimension 150 m 150 m as given in fig 5 co2 can be injected in the injection well at the lower left corner of the reservoir in order to enhance ch4 production we assume that the co2 injection proceeds after the water depletion procedure therefore the water saturation is taken as constant and close to the water residual saturation value in addition it should be noted that the multiscale model can also be used to simulate the water depletion phase by solving eq 38 the parameters used in the simulations are given in table 1 we consider a particular configuration in which the initial conditions satisfy α i 1 in order to observe the cleat closure phenomena for initial conditions the ch4 and co2 pressures in the reservoir are uniform at 2 mpa and 2 mpa respectively at the edges of the reservoir no flux condition is imposed and the displacement is taken to be zero i e the overall reservoir volume is constant at the injection well co2 is injected at 5 mpa whereas zero methane flux is applied at the production well dirichlet boundary conditions for ch4 and co2 pressures are taken at 0 1 mpa and 2 mpa respectively the transfer coefficients α t i are given by lim and aziz 1995 41 α t i 2 π 2 s 2 d e q i where s is the spacing of cleats the characteristic diffusion time in the matrix can be estimated from eq 39 as 42 t d 1 ϕ f ϕ m g i α t i for d e q 1 10 11 m 2 s 1 and d e q 2 6 10 12 m 2 s 1 the characteristic time for the two gases is several days so that very small pressure differences are observed between the matrix and the cleats firstly in fig 6 the partition coefficients g 1 and g 2 relative to ch4 and co2 depending on the partial pressures are computed by using the dft for a spherical geometry we may observe that the partition coefficient values for co2 g 2 are much higher than the those for ch4 g 1 showing an adsorption potential of co2 significantly higher compared to ch4 moreover the partition coefficients decrease with the increase in partial pressures in fig 7 the methane pressure distributions in the cleats for four different times 1 12 24 and 36 months are displayed we can observe the depletion with time of the methane pressure and a much more pronounced decrease near the production well due to co2 injection ch4 is replaced by co2 leading to a significant pressure decrease near the injection well fig 8 depicts the co2 pressure distributions in the reservoir for four different times the co2 pressure increases in the vicinity of the production well whereas the injected co2 does not yet reach the production well after 36 months of injection the cleat porosity change is taken into account by coupling the transport model with the three scale poromechanical model the cleat permeability is related to the cleat porosity by the cubic relationship 43 k f k f 0 ϕ f ϕ f 0 3 the cleat porosity for different times is represented in fig 9 highlighting an important decrease in porosity near the injection well and this decrease propagates to the production well during the injection period on the other hand near the production well the total pressure decrease leads to a matrix shrinkage and to an increase of the cleat porosity moreover the ratio between the cleat permeability and its initial value is illustrated in fig 10 near the injection well the cleat permeability decreases significantly due to a strong matrix swelling induced by co2 adsorption as observed at the nanoscale by the dft approach the adsorption potential of co2 is higher than ch4 therefore co2 can replace ch4 in the nanopores inducing a less attractive solvation force which swells the matrix particular attention must be paid to the injection pressure to avoid closing totally the cleats near the injection well finally the methane production curves are plotted in fig 11 for both cases without and with injection the numerical results show a very promising technique of enhanced coalbed methane recovery in this configuration the injection of co2 allows 16 more methane to be recovered than in the scenario without injection 6 conclusion in this work a three scale model for flow and transport in coalbed methane reservoir enhanced by co2 injection has been developed the coalbed methane reservoir is characterized by a matrix composed of solid and nanopores saturated by adsorbed gas and a cleat network the dft approach allows to compute precisely the gas mixture quantities adsorbed in the matrix and the solvation force acting on the nanopores surface a first homogenization procedure was used to obtain the average mass conservation equations for the two gases ch4 and co2 in the matrix taking into account the adsorption phenomena characterized by a partition coefficient and an effective knudsen type diffusion special attention was paid to upscale the problem of disconnected highly permeable nanopores immersed in a low permeable matrix incorporating adsorption phenomena effects a second homogenization procedure was applied to obtain macroscopic averaged equations for gas diffusion in the matrix and gas water transport in the cleats a dual porosity model of warren and root type approximates the mass exchange between matrix and cleats through a matrix fracture transfer shape factor the current model for flow and transport in coalbed methane reservoir is coupled with the three scale poromechanical model developed in a previous work to construct a full model which accurately describes the simultaneous mechanics and transport multiscale problems in a coalbed methane reservoir with co2 injection such a model is capable of explaining the improvement of the methane production curve and also the counter intuitive and experimentally observed cleats closure phenomena simulations showed that the cleat permeability decrease is significant near the injection well due to high injection pressure and can close the cleats if special attention is not paid to the injection pressure of co2 the important result of this work is to illustrate the potential of the proposed multiscale approach to couple complex adsorption phenomena at the nanoscale with mechanics and transport problem at the reservoir scale credit authorship contribution statement t d le conceptualization methodology software writing original draft writing review editing q d ha writing review editing i panfilov writing review editing c moyne conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a warren and root approximation in this appendix an approximation for the mass transfer term in the matrix in the sense of warren and root 1963 is developed in the isotropic case the effective diffusion coefficient d e q i reduces to d eq i so that from 23 the mass conservation equation for species i in the matrix is given as a 1 ϕ m g i ρ m i t d e q i ρ m i in y m ρ m i ρ f i on y f m ρ m i ρ m i i n i at t 0 on the interface yfm between the cleats and the matrix the mass density is imposed by the value in the cleats and an uniform initial condition is assumed in addition ρ m i is a y periodic function the mass exchange term for species i from the matrix to the cleats is given by a 2 q m f i 1 y y f m d e q i ρ m i n m f d γ where n m f is the normal outside the matrix at the matrix cleats interface using the periodic condition at the outer boundary yme of the unit cell y and considering the divergence theorem and eqs a 1 we have a 3 q m f i 1 y y f m y m e d e q i ρ m i n m f d γ 1 y y m d e q i ρ m i d v 1 y y m ϕ m g i ρ m i t d v t 1 ϕ f ϕ m g i ρ m i m neglecting the slow variation of ϕm and gi with time relative to the diffusion time eqs a 1 become a 4 ϕ m g i ρ m i t d e q i ρ m i in y m ρ m i ρ f i t on y f m ρ m i ρ m i i n i at t 0 the above problem can be solved using the following auxiliary problem a 5 u m i t d e q i 2 u m i in y m u m i 1 on y f m u m i 0 at t 0 where d e q i d e q i ϕ m g i is the apparent diffusion coefficient the problem a 5 is now written in the laplace space in time with the laplace variable p and u m i l u m i designating the laplace transform of u m i it yields a 6 p u m i d e q i 2 u m i in y m u m i 1 p on y f m the solution of the problem a 4 for ρ m i is easily obtained using the auxiliary problem a 5 in the laplace domain the exact solution is given by a 7 ρ m i p ρ f i u m i where ρ m i l ρ m i ρ m i i n i and ρ f i l ρ f i ρ m i i n i averaging over the unit cell y leads to a 8 ρ m i m p ρ f i u m i m the exchange term a 3 is given in the laplace space by a 9 q m f i 1 ϕ f ϕ m g i p ρ m i m 1 ϕ f ϕ m g i p 2 ρ f i u m i m by using relation a 8 a 10 ρ m i m ρ f i ρ f i p u m i m 1 the exchange term q m f i can be expressed in function of the gases density difference between the matrix and the cleats a 11 q m f i 1 ϕ f ϕ m g i p 2 u m i m p u m i m 1 ρ m i m ρ f i p α i ρ m i m ρ f i where p α i 1 ϕ f ϕ m g i p 2 u m i m p u m i m 1 the inverse laplace transform allows to write the exact solution of problem a 4 in the form of a time convolution where α i t l 1 α i p a 12 q m f i τ 0 t α i t τ τ ρ m i m ρ f i τ d τ rather than using the exact preceding expression warren and root s approximation consists in replacing it with a simple product introducing the so called matrix fracture transfer shape factor α t i warren and root 1963 a 13 q m f i α t i ρ m i m ρ f i there are several ways to determine this shape factor one way is to compute the limit of the exact expression for large time values α t i lim p 0 p α i if the matrix is a set of rectangular parallelepipeds of size lx ly lz α t i 12 d i 1 l x 2 1 l y 2 1 l z 2 other values are available in the literature warren and root 1963 lim and aziz 1995 kazemi et al 1976 heinemann and mittermeir 2012 appendix b upscaling of the nanoscopic model in this appendix the homogenization procedure to upscale the nanoscopic model presented in the section 3 is developed from the scaling eqs 14 we now collect the successive power of ϵ slow variables the problem in c b i 0 periodic in z is written as b 1 z d n i z c b i 0 0 in z n d n i z c b i 0 n 0 on z n s whose solution is c b i 0 t y z c b i 0 t y in a similar way the problem in c s i 0 is written in the solid phase b 2 z d n i z c s i 0 0 in z s c s i 0 c b i 0 on z n s with periodic boundary conditions on the external frontier of the unit cell zse the solution is obvious c s i 0 t y z c s i 0 t y c b i 0 t y c m i 0 t y here c m i 0 t y represents the zero order of the gas concentration in the matrix which depends only on y fluctuation terms the problem in c b i 1 is given as b 3 z d n i z c b i 1 0 in z n d n i z c b i 1 y c m i 0 n 0 on z n s whose solution is b 4 c b i 1 c b 1 t y z y c m i 0 where c b 1 t y plays the role of an integration constant from eq b 4 we obtain immediately the flux in the nanopores at the order o ϵ 1 given by b 5 j n i 1 d n i z c b i 1 y c m i 0 0 considering the taylor development of cb t y z one obtains b 6 c b i t y z c m i 0 t y z y c m i 0 t y c b i 1 t y z o ϵ 2 c m i 0 t y z y c m i 0 t y c b 1 t y z y c m i 0 t y o ϵ 2 c m i 0 t y c b 1 t y o ϵ 2 we remark that in the unit cell z the concentration c b i in the nanopores is constant at the order o ϵ 2 the problem in c s i 1 is written in the solid matrix b 7 z j s i 0 z d s i z c s i 1 y c m i 0 z d s i z c s i 1 0 in z s c s i 1 c b i 1 t y z y c m i 0 on z n s with periodic boundary conditions on the external frontiers of the unit cell zse the solution is searched in the form b 8 c s i 1 t y z c b 1 t y χ z y c m i 0 t y where the vector χ periodic in the unit cell is solution of b 9 z d s i z χ 0 in z s χ z on z n s averaged equations taking into account relation b 5 the problem in c b i 2 is given as b 10 z d n i z c b i 2 y c b i 1 0 in z n d n i z c b i 2 y c b i 1 n d s i z c s i 1 y c m i 0 n on z n s finally the problems in c b i 3 and c s i 2 as well as the flux condition on the interface zns are written as b 11 g i c m i 0 t z d n i z c b i 3 y c b i 2 y d n i z c b i 2 y c b i 1 in z n 0 z d s i z c s i 2 y c s i 1 y d s i z c s i 1 y c m i 0 in z s d n i z c b i 3 y c b i 2 n d s i z c s i 2 y c s i 1 n on z n s given the boundary condition on the interface zns and periodicity conditions on the boundary of the cell zse averaging the previous equations over the unit cell leads to b 12 ϕ m g i c m i 0 t 1 z y z n j n i 0 d v z s j s i 0 d v y j i 0 with b 13 j s i 0 d s i z c s i 1 y c m i 0 b 14 j n i 0 d n i z c b i 2 y c b i 1 where ϕ m z n z is the volume fraction of nanopores in the matrix it should be noted that in the case of different pore diameters with different volumes vk we obtain b 15 g i k g i k v k k v k recall relations b 7 a and b 10 b 16 z j s i 0 0 in z s z j n i 0 0 in z n j s i 0 n j n i 0 n on z n s for a divergence free flux j i e j 0 in z we have b 17 j z j z j j integrating the above relation in z leads to b 18 z j d v z j z d v z n j z d s z z j n d s where n is the outward normal to z on the boundary z of the domain applying this relation to the two fluxes j n i 0 and j n i 0 gives b 19 z n j n i 0 d v z n s z j n i 0 n n d s b 20 z s j s i 0 d v z n s z j s i 0 n s d s z s e z j s i 0 n s d s adding both relations with n n n s on zns taking into account the closure relation for c s i 1 leads to the average total flux b 21 j i 0 1 z z s e z j s i 0 n s d s 1 z z s e z d s i z c s i 1 y c m i 0 n s d s 1 z z s e d s i z n s i z χ d s y c m i 0 d e q i y c m i 0 with the effective diffusion coefficient defined as b 22 d e q i 1 z z s e d s i z n s i z χ d s if the unit cell is a rectangular parallelepiped ℓ1 ℓ2 ℓ3 with σ j designating the facet relative to the normal n j by using periodic condition the averaged diffusion coefficient is given by b 23 d e q i j k 1 σ j σ j d s i δ j k χ k z j d s the averaged transport equation in the matrix b 12 can be obtained b 24 ϕ m g i c m i 0 t y d e q i y c m i 0 
418,hydraulic barriers using either two or three injection wells are studied analytically to evaluate their performance on improving groundwater extraction in a coastal aquifer under the threat of seawater intrusion the multiple well system is operated by extracting fresh groundwater through a landward well and partially reinjecting into the aquifer through two or three wells located parallel to the coastline and between the interface toe and the extraction well we found that with appropriate well locations and pumping rates the multiple well system could outperform a single extraction well in terms of net extraction rate which is up to 90 higher for an aquifer with a thickness of 20 m hydraulic conductivity of 10 m d and freshwater influx of 0 24 m2 d sensitivity analyses reveal that the monotonicity of the maximum net extraction rate is determined by the total injection rate in specific when the total injection rate is fixed the maximum net extraction rate is a non monotonic function of the distance between the injection well and the coastline and the distance between two injection wells resulting in a global maximum when the total injection rate is not fixed by contrast the maximum net extraction rate depends on the total injection rate and a larger total injection rate leads to a larger maximum net extraction rate by using different injection rates for side and middle injection wells of the three injection well hydraulic barrier the maximum net extraction rate could be further improved depending on the distance between the two injection wells analytical analyses can provide initial guidance for the design of a multiple well system in coastal aquifers with the purpose of obtaining enhanced extraction under the threats of seawater intrusion keywords seawater intrusion injection well analytical method maximum net extraction 1 introduction groundwater stored in coastal aquifers represents a precious resource and supports the rapid development of economy and the increasing growth of population in many countries michael et al 2017 however groundwater overexploitation from a coastal aquifer can cause the natural equilibrium between freshwater and seawater to be disturbed and result in seawater intrusion into inland aquifers a well known groundwater contamination issue in coastal regions werner et al 2013 since aquifer salinization in coastal areas can lead to various consequences in terms of environment ecology and economy effective management strategies are required to prevent coastal aquifers from being contaminated by saltwater bear et al 1999 custodio 2010 werner 2010 shi and jiao 2014 various measures for controlling seawater intrusion have been introduced in past decades optimization methods have been used to address various practical questions in relation to pumping operation well placement and design of artificial recharge schemes e g cheng et al 2000 park et al 2004 abarca et al 2006 song et al 2018 christelis and mantoglou 2019 where groundwater needs to be exploited from an aquifer containing saltwater at the bottom the application of horizontal wells skimming wells and surface drains is a simple and effective engineering measure to avoid saltwater upconing yin and tsai 2019 other engineering strategies mainly include the use of recharge wells to create a hydraulic barrier near the interface toe mahesha 1996 lu et al 2013 the application of negative hydraulic barriers i e extraction of saltwater to reduce the saltwater volume sherif and hamza 2001 kacimov et al 2009 masciopinto 2013 pool and carrera 2010 kaleris and ziogas 2013 ebeling et al 2019 the construction of subsurface physical barriers luyun et al 2009 2011 strack et al 2016 lu et al 2019 wu et al 2020 and the injection of compressed air to reduce hydraulic conductivity sun and semprich 2013 among these recharging an aquifer to increase the hydraulic head may be the most popular strategy and has been widely adopted in the field e g land et al 2004 vandenbohede et al 2009 abd elhamid et al 2011 el rawy et al 2019 the traditional aquifer recharge method adopting either injection or infiltration usually depends on external freshwater resources sheahan 1977 to combat with such a shortage lu et al 2013 proposed a novel injection extraction well pair system that extracts fresh groundwater from a landward well and reinjects a proportion of this back into the coastal aquifer through an injection well located between the interface toe and the extraction well in addition to the benefit of not requiring surface freshwater resources for the injection well this system could alleviate the impact of aquifer recharge on groundwater quality and subsurface geochemical environments the authors found that with appropriate well placement and operation parameters the well pair system could significantly outperform a single extraction well in terms of the net extraction rate namely the difference between the extraction rate and injection rate for the well pair system more recently lu et al 2016 compared the performance of the well pair system with that of the pond well system on seawater intrusion and groundwater extraction where the pond is assumed elliptic their analytical analysis indicated that the shape of the elliptic pond highly controlled the maximum net extraction rate of the pond well system obtained under the condition that the stagnation points are located on the interface toe when the major axis of the elliptic pond is parallel to the coastline the pond well system could be capable of obtaining a higher net extraction rate than that of a well pair system under otherwise the same hydrogeological condition through the comparison of the performance between the well pair system and the pond well system it is suggested that given the same recharge rate the developed hydraulic barrier across a longer lateral distance parallel to the coastline would lead to more enhanced extraction this finding inspires us to test the performance of a multiple injection well hydraulic barrier on improving groundwater net extraction where the injection wells are placed parallel to the coastline to develop a hydraulic barrier across a wide extent in the lateral direction in this study we aim to show how double injection well diw and triple injection well tiw hydraulic barriers can be solutions for local seawater intrusion prevention the performance of these two systems will be compared each other and with those of a single extraction well and an injection extraction well pair the employment of the diw and tiw system result in an additional parameter the distance between two injection wells which is expected to have a significant effect on the performance of the multiple well system in fact the multiple injection well system in a coastal aquifer has been analytically explored in previous studies sheahan 1977 explored a multiple injection extraction well pair system where the injection wells are located between the coastline and the extraction wells in that study a hydraulic barrier is created by injecting reclaimed waste water which is different from the design in our study hunt 1985 derived closed form solutions for the steady state interface toe location and stagnation points when a line of recharge wells was used to inject freshwater into a coastal aquifer park et al 2009 developed explicit algebraic equations for approximating minimum injection rates to control seawater intrusion to a specified location however these studies failed to investigate the effects of injection on the enhancing groundwater extraction of a well located landward of the injection wells this study aimed to analytically evaluate the performance of multiple injection well hydraulic barriers on enhancing groundwater extraction in a coastal aquifer by assuming a steady state sharp interface the potential theory introduced by strack 1976 and 1989 is adopted to derive analytical solutions of the interface toe location stagnation points and recirculation ratios strack s 1976 and 1989 potential theory has been widely employed to tackle a variety of coastal interface flow problems with wells e g lu et al 2012 lu and luo 2014 the potential theory has also been employed by lu et al 2013 and 2016 to derive the analytical solutions for the well pair system despite these studies the configuration of the multiple well systems designed in the current study has not been analytically investigated in previous studies our analytical study is expected to provide a useful tool for the assessment and design of a multiple injection well hydraulic barrier system in a coastal aquifer 2 conceptual model we consider respectively a conceptual model with two injection wells and one extraction well i e the diw system and a conceptual model with three injection wells and one extraction well i e the tiw system located in a homogeneous isotropic confined coastal aquifer with the inflow rate per unit aquifer width of qf l2 t from inland all wells are fully penetrating fig 1 shows the plan view of the conceptual models with x axis and y axis perpendicular to and along the coastline respectively as shown in fig 1 a the two injection wells with the same injection rate are parallel to the coastline and the extraction well is located at the centerline between the two injection wells the x axis pointing inland coincides with the centerline between the two injection wells fig 1 b shows the tiw system where three injection wells are parallel to the coastline and the x axis pointing inland coincides with the middle injection well and the extraction well the origin of the coordinate system in the two conceptual models is located at the intersection of the x axis and the coastline note that qf is negative because of opposite directions of the x axis and the inflow fig 1 c shows the cross section of the multiple well system located in a confined coastal aquifer for both diw and tiw systems the injection well and extraction well are located at a distance a l and b l from the coastline respectively and the distance between the two injection wells is l l for the diw system the injection rate of each injection well is qi l3 t negative and the extraction rate of the extraction well is qe l3 t positive for the tiw system the injection rates of the middle injection well and the side injection well are q i1 l3 t and q i2 l3 t respectively and the extraction rate of the extraction well is qe l3 t the net extraction rate qn l3 t of the multiple well system is equal to the extraction rate plus the total injection rate qti l3 t qti 2qi for the diw system and qti qi1 2 q i2 for the tiw system we chose the aquifer base as the reference level the confined aquifer thickness is b l note that physical limits to drawdown at the extraction well are not considered in the current study lu et al 2013 in other words the confined aquifer is assumed to remain confined under the extraction condition to apply strack s theory of comprehensive discharge potential we assume that the entire aquifer system is under the steady state condition and separated by a sharp freshwater seawater interface e g strack 1976 lu et al 2012 2013 and 2016 and the flow in the vertical direction is neglected i e the dupuit forchheimer assumption is adopted in addition the ghyben herzberg relation is employed 3 mathematical derivation 3 1 complex potential function we adopt the complex potential theory to express the flow system and to derive analytical solutions as it provides a convenient tool for solving two dimensional groundwater flow problems the spatial coordinates x and y are combined to generate a complex variable z in the horizontal planes in which x and y represent respectively the real and imaginary parts the complex potential for the model assumed in this study is then expressed as strack 1989 1 ω z ϕ z i ψ z q f z j 1 n q j 2 π ln z z j 2 z x i y where ω l3 t is the complex potential ϕ l3 t is strack s comprehensive discharge potential ψ l3 t is the stream function i 1 qj l3 t is the flow rate of jth well qj 0 for the extraction well and qj 0 for the injection well n is the total number of mathematical singularities i e real and imaginary wells and zj is the location in the complex plane of the jth well note that imaginary wells are included in eq 1 to satisfy the assumption of the constant head coastal boundary therefore when considering the diw system n 6 and zj is expressed by 3 z 1 a l 2 i z 2 a l 2 i z 3 a l 2 i z 4 a l 2 i z 5 b and z 6 b where a and b are respectively the x coordinates of the injection well and extraction well when considering the tiw system n 8 and zj is expressed by 4 z 1 a z 2 a z 3 a l i z 4 a l i z 5 a l i z 6 a l i z 7 b and z 8 b in particular when we consider an injection extraction well pair system as that described in lu et al 2013 n 4 and zj is expressed by 5 z 1 a z 2 a z 3 b and z 4 b the complex potential ω is separated into a real discharge potential ϕ christ and goltz 2002 6 ϕ q f x j 1 n q j 4 π ln x x j 2 y y j 2 and an imaginary stream function 7 ψ q f y j 1 n q j 2 π tan 1 y y j x x j in which xj and yj are the x and y coordinates of the jth well respectively 3 2 stagnation points stagnation points are locations in the flow field where the flow discharge is zero generally each well has a stagnation point associated with it as indicated above due to the constant head coastal boundary the same number of the imaginary wells as that of the real wells occur in the complex potential discharge potential and stream function equations therefore the diw and tiw systems result in respectively six and eight stagnation points to locate the stagnation points the derivative of the complex potential ω with respective to z should equal to zero 8 d ω d z q f 1 2 π j 1 n q j z z j 0 by letting a 2πqf we obtain 9 j 1 n q j z z j a 0 eq 9 represents a polynomial of order n allowing us to derive the stagnation points by simply finding the roots of this polynomial it is well known that for n 4 the roots of the polynomial can be found analytically while the numerical root finding methods are required for n 4 in this study we use a matlab built in solver solve to numerically solve eq 9 3 3 release capture and recirculation zones with the locations of stagnation points the capture and release zones can be plotted through the method proposed by fienen et al 2005 fig 2 shows various scenarios of capture and release zones of the diw and tiw systems comparing with the injection extraction well pair the capture and release zones of the diw and tiw systems are more complicated however three scenarios of capture and release zones can be generally identified as well scenario 1 when the total injection rate is sufficiently low or and the distance between the injection and extraction wells is sufficiently long there could be no recirculation zone between the injection and extraction wells see fig 2 a1 and b1 in this case the incident fresh groundwater is squeezed between the neighbouring plumes of the injection wells scenario 2 a recirculation zone is formed between injection and extraction wells and injected water is partially captured by the extraction well i e partial hydraulic shortcut this scenario is associated with intermediate extraction rates relative to injection rates and well distances as shown in fig 2 a2 and b2 scenario 3 all injected water is pumped out by the extraction well i e full hydraulic shortcut see fig 2 a3 and b3 due to that the extraction rate is sufficiently high relative to the injection rate or and the distance between the injection and extraction wells is significantly short as shown the streamline passing through the stagnation point of the extraction well separates water flowing into the extraction well from water flowing into the sea 3 4 calculation of recirculation ratio it is of practical interest to understand how much injected water is re extracted particularly for those scenarios adopting reclaimed waste water as an injectant sheahan 1977 the recirculation ratio of the multiple well system is defined as 10 r q r q t i where r is the recirculation ratio ranging between 0 and 1 the limiting cases of r 0 and r 1 represent respectively scenarios 1 and 3 in fig 2 qr l3 t is the discharge in the recirculation zone qr 0 the definition of the recirculation ratio in our study is similar to those in previous studies investigating the injection extraction well pair system luo and kitanidis 2004 luo et al 2006 lu et al 2013 for the well pair system that contains two stagnation points the recirculation zone is enclosed by the stream tube between the two streamlines passing stagnation points similarly the discharge in the circulation zone for the diw system can be expressed as 11 q r q ti 2 ψ s 1 for x s 1 a 12 q r 2 ψ s 1 for x s 1 a where x s1 l is the x coordinate of the stagnation point which is not located on the x axis and ψ s1 l3 t is the value of the stream function of that stagnation point note that since we assume that the locations of the two injection wells are symmetric with respect to the x axis and the two injection rates are identical the middle stagnation point is located on the x axis the recirculation ratio is then given as 13 r 1 2 ψ s 1 q ti for x s 1 a 14 r 2 ψ s 1 q ti for x s 1 a the tiw system has four stagnation points in the real domain i e the flow domain resulting in three stream tubes at the most since two adjacent stagnation points could generate one stream tube as mentioned above we assume that the injection rates may be different for the middle injection well and two side injection wells therefore one may expect to derive an overall recirculation ratio for the tiw system as well as the recirculation ratio for each injection well the overall recirculation ratio of the tiw system can be derived by 15 r 1 2 ψ s 2 q ti for x s 2 a 16 r 2 ψ s 2 q ti for x s 2 a where x s2 is the x coordinate of the stagnation point which is located farther from the x axis i e the stagnation point with a lager absolute value of the y coordinate and ψ s2 is the value of the stream function of that stagnation point the recirculation ratio of the middle injection well can be calculated by 17 r 1 1 2 ψ s 1 q i 1 for x s 1 a 18 r 1 2 ψ s 1 q i 1 for x s 1 a where x s1 is the x coordinate of the stagnation point which is located closer to the x axis i e the stagnation point with a smaller absolute value of the y coordinate and ψ s1 is the value of the stream function of that stagnation point the recirculation ratio of the side injection well can be derived simply by 19 r 2 r q ti r 1 q i 1 2 q i 2 if we assume that q i1 q i2 we can obtain 20 r 2 3 2 r 1 2 r 1 3 5 interface toe location locating the freshwater seawater interface toe requires the continuity condition of the discharge potential across the interface toe between the freshwater only zone and the interface zone the discharge potential at the interface toe for a confined aquifer is expressed as strack 1976 21 ϕ t α 1 2 k b 2 where α is the ratio of the seawater density relative to the freshwater density and k l t is the hydraulic conductivity note that eq 21 is derived by the discharge potential expression of the interface zone strack 1976 the location of the interface toe can be evaluated by using eq 6 and replacing ϕ in eq 6 by ϕ t in eq 21 note that the performance of the multiple well system in an unconfined coastal aquifer can be assessed by simply using the toe potential of an unconfined aquifer lu et al 2013 3 6 maximum extraction rate the procedures of deriving the maximum extraction rate for given injection rates have been described in detail in lu et al 2013 main steps include 1 assigning an initial value to the extraction rate 2 deriving stagnation points using eq 9 3 calculating the discharge potential at the critical stagnation point i e the stagnation point where the interface toe first meets with increasing extraction rate using eq 6 4 calculating the discharge potential at the interface toe using eq 21 5 checking if the difference of the discharge potential of the interface toe and at the critical stagnation point is less than a given threshold 0 1 m3 d is adopted in the current study and 6 adjusting the extraction rate until step 5 is achieved the obtained extraction rate is the maximum extraction rate the maximum net extraction rate q n m of the multiple well system is simply the summation of the maximum extraction rate and the total injection rate because of negative values of the injection rate in step 3 the critical stagnation point of the diw and tiw systems can be searched by the following method normally the critical stagnation point is the one with the lowest value of the discharge potential for the diw system under some special conditions all injected water could be extracted namely r 1 under the maximum net extraction condition these scenarios could occur when the injection rate is too small or the injection wells are located too close to the extraction well the stagnation point located on the x axis is the critical stagnation point rather than the one with the lowest discharge potential for the tiw system special conditions occur when all injected water of the middle injection well is extracted namely r 1 1 under such a situation two stagnation points are located on the x axis and the one located more landward must not be the critical stagnation point therefore for the remaining three stagnation points the critical stagnation point is the one with the lowest discharge potential when r 1 in the tiw system the stagnation point located on the x axis with the lowest x coordinate is the critical stagnation point 3 7 dimensionless parameters to facilitate the analysis we define the following dimensionless parameters 22 x x b y y b a a b l l b q i q i 2 π b q f q i 1 q i 1 2 π b q f q i 2 q i 2 2 π b q f q e q e 2 π b q f q t i q t i 2 π b q f q n q e q t i 2 π b q f q n m q n m 2 π b q f and ϕ t ϕ t b q f 3 8 parameter values the parameter values of the aquifer used in the current study are similar to those adopted in lu et al 2013 the aquifer thickness b the inland freshwater flux qf the hydraulic conductivity k the ratio of the seawater density relative to the freshwater density α and the distance between the extraction well and the coastline b are 20 m 0 24 m2 d 10 m d 1 025 and 500 m respectively and fixed for all cases to examine the sensitivity of various parameters to the performance of the multiple injection well hydraulic barrier system on enhancing the maximum net extraction rate the distances between the injection well and the coastline a are varied between 300 m and 490 m the injection rates of each well qi q i1 and qi2 are varied between 0 m3 d and 2000 m3 d and the distances between two injection wells l are varied between 10 and 1000 m the values of these parameters are listed in table 1 4 results 4 1 comparison of a single extraction well system and multiple well systems fig 3 shows the interface toe positions stagnation points and release and capture zones created respectively by a single extraction well an injection extraction well pair a diw system and a tiw system where the locations of the extraction well a 0 8 and the distances between two injection wells l 0 2 in all multiple well cases are the same fig 3 a and b indicate that the interface toe reaches the stagnation point in cases of a single extraction well and an injection extraction well pair representing that the critical extraction condition is obtained i e the condition under maximum extraction by trial and error it is found that q e 0 174 for the single extraction well and q n 0 240 for the injection extraction well pair suggesting a 38 increase in the maximum net extraction rate by using an injection well located between the extraction well and the coastline with q i 0 252 these results are consistent with those in our previous study lu et al 2013 fig 3 c shows that there remains a significant gap between the interface toe and the stagnation point if the same net extraction rate of the well pair is applied as a net extraction rate i e q n 0 240 for the diw system where q i 0 252 is taken for each injection well in other words the diw system does not reach the critical condition under such a pumping condition and the extraction rate could be larger fig 3 d shows that the maximum net extraction rate is achieved for the given injection rate with q n 0 278 representing a 60 increase in comparison to that obtained for a single extraction well fig 3 e shows that the tiw system does not reach the critical condition when q n 0 278 and q i 0 252 is adopted for each injection well indicating that the tiw could extract more fresh groundwater than the diw system the critical condition of the tiw system is shown in fig 3 f with q n 0 322 an 85 increase compared to the single well situation as shown in these figures the number of stagnation points is identical to the number of wells in addition for all multiple well systems in fig 3 the capture and release zones are identified as scenario 2 which means that a recirculation zone is formed between injection and extraction wells and part of injected water is captured by the extraction well 4 2 diw system to focus on the effect of locations and operation parameters of injection wells we explore the sensitivity of q t i a and l to the maximum net extraction rate recirculation ratio and stagnation point locations and fix the value of ϕ t 0 417 when investigating the sensitivity of one parameter values of other two parameters are kept constant 4 2 1 sensitivity of q t i fig 4 shows the maximum net extraction rates with varying total injection rates q t i together with corresponding recirculation ratios and stagnation point locations where a 0 8 and l 0 2 when q t i 0 the system reduces to the case of a single extraction well and the resulting q n m 0 174 is consistent with the value obtained in fig 3 a fig 4 a indicates that the influence of q t i on q n m is non monotonic similar to that found in the injection extraction well pair system lu et al 2013 q n m initially increases and then decreases with increasing total injection rate i e q t i producing an optimal q n m 0 299 at q t i 1 273 this optimal value is about 72 higher than that of the corresponding single extraction well case it is also shown in fig 4 a that large injection rates when q t i 4 032 could cause the performance of the multiple well system to be less effective than a single extraction well furthermore extremely large total injection rates would lead to the maximum allowable pumping rate less than the total injection rate i e a negative net extraction rate fig 4 b shows that the recirculation ratios r under the condition of maximum net extraction are larger than 0 545 and asymptotes to 0 870 with increasing q t i indicating that less than half of injected water is re extracted and the remaining injected water flows to the sea to prevent seawater intrusion the asymptotical phenomenon of r of the diw system has also been found in the injection extraction well pair system lu et al 2013 because of symmetry as mentioned above one stagnation point is located on the x axis and the other two stagnation points are located symmetric with respect to the x axis we only show the x coordinates of two stagnation points in fig 4 c one located on the x axis and the other not on the x axis because the two stagnation points not on the x axis share the same x coordinates we only show non negative y coordinates of stagnation points in fig 4 d in figs 4 c and 4 d the curves in red represent the coordinates of the critical stagnation points with which the freshwater seawater interface toe meets under the condition of maximum net extraction it is clearly shown that with increasing q t i the critical stagnation point is first the one on the x axis when q t i 0 212 and then not on the x axis when q t i 0 212 to demonstrate this we show in fig 5 the interface toes and flow systems created by scenarios of q t i 0 133 and 1 194 respectively moreover x s of all stagnation points under the condition of maximum net extraction are not monotonic functions of q t i while the positive y s increases monotonically with increasing q t i 4 2 2 sensitivity of a fig 6 shows the maximum net extraction rates with varying distances between the injection well and the coastline a together with corresponding recirculation ratios and stagnation point locations where q t i 0 265 and l 0 2 similar to q t i q n m is a non monotonic function of a in specific q t i first increases and then decreases with increasing a resulting in an optimal q n m 0 256 at a 0 816 as shown in fig 6 a it is interesting that when a is less than the critical value namely 0 816 r almost linearly increases with increasing a while this linear relationship does not exist when a 0 816 see fig 6 b as a 0 948 r 1 indicating that all injected water is re extracted moreover a 0 816 is also a critical value for the locations of the critical stagnation point it can be found from figs 6 c and 6 d that when a 0 816 the critical stagnation point is not located on the x axis by contrast the stagnation point located on the x axis is the critical one when a 0 816 4 2 3 sensitivity of l fig 7 shows the maximum net extraction rates with varying distances between two injection wells l together with corresponding recirculation ratios and stagnation point locations where q t i 0 265 and a 0 8 as shown in fig 7 a as l increases from 0 02 to 0 22 q n m increases slightly from 0 242 to 0 255 however a further increase of l from 0 22 to 2 results in the decrease of q n m from 0 255 to 0 0112 the negative values of q n m indicate that the extraction rate is less than the total injection rate with increasing l r experiences three variation patterns see fig 7 b as l increases from 0 02 to 0 22 i e the step when q n m increases from 0 242 to 0 255 r increases slightly from 0 777 to 0 799 then r decreases approximately linearly with increasing l from 0 22 to 1 3 resulting in a minimum r almost equal to zero during the last step r is equal to zero with increasing l from 1 3 to 2 representing that no injected water is re extracted because the distance between the injection well and extraction well is too far fig 8 shows the flow system when r is almost equal to zero where l 1 3 and q n m 0 0378 it is interesting that the separation streamlines of the extraction well and two injection wells are almost overlapped leading to almost all extracted water coming from the original aquifer instead of water recharged by two injection wells fig 7 c and 7 d show that the critical stagnation point is initially not located on the x axis when l 0 2 and then located on the x axis when l 0 2 for large l the two plumes developed by two injection wells are too far from the x axis to form an effective hydraulic barrier for the extraction well resulting in low net extraction rates 4 2 4 joint effects of q t i a and l fig 9 shows the joint effects of q t i a and l on q n m fig 9 a demonstrates the sensitivity of q n m to q t i and l in which a 0 8 as indicated negative values are obtained for large values of q t i and l for a fixed value of q t i q n m is a non monotonic function of l resulting in a maximum value of q n m this maximum q n m increases with increasing q t i for example when q t i 0 106 and 2 653 q n m 0 217 and 0 399 respectively fig 9 b shows the sensitivity of q n m to a and l in which q t i 0 265 it is found that q n m is a non monotonic function of a and l when the value of the other one parameter is fixed resulting a global optimum q t i 0 257 when a 0 68 and l 0 48 fig 9 c shows the sensitivity of q n m to a and q t i in which l 0 2 for a fixed value of q t i q n m is a non monotonic function of a resulting in a maximum value of q n m similar to the sensitivity of q n m to l this maximum q n m increases with increasing q t i for example when q t i 0 106 and 2 653 q n m 0 219 and 0 357 respectively 4 3 tiw system we conduct the similar sensitivity analysis for the tiw system as described above the injection rate of the side well q i 1 could be different from that of the injection well located on the x axis q i 2 in the following we first conduct the sensitivity analysis by assuming q i 1 q i 2 and then the scenarios of q i 1 q i 2 are studied 4 3 1 sensitivity of q t i fig 10 shows the maximum net extraction rates with varying total injection rates q t i together with corresponding recirculation ratios and stagnation point locations where q i 1 q i 2 q t i 0 398 and a 0 8 similarly q n m is not a monotonic function of q t i and the optimal q n m 0 337 occurs when q t i 1 512 also large q t i 4 974 could lead to the performance of the multiple well system worse than a single extraction well in terms of the maximum net extraction rate see fig 10 a fig 10 b shows the variation of the overall recirculation ratio of the well system r and recirculation ratios of the middle r1 and side r2 wells with increasing q t i r and r2 increase sharply when q t i increases to 0 855 and then asymptotes to 0 878 by contrast r1 first quickly increases to its maximum value r1 0 947 and then decreases to approach the curve of r fig 10 c and d show varying stagnation points with increasing q t i as shown when q t i is low i e q t i 0 637 the stagnation points located closer to the x axis are critical while the critical stagnation points are located farther from the x axis when q t i 0 637 see fig 10 d to explain the variation of critical stagnation points with increasing q t i we plot the interface toes stagnation points and capture zone under the conditions of maximum extraction for two scenario with q t i 0 478 and 0 796 in fig 11 it can be seen that with a smaller q t i the critical stagnation pointers are the two located closer to the x axis while the two outer stagnation points become critical for the larger q t i 4 3 2 sensitivity of a fig 12 shows the maximum net extraction rates with varying distances between the coastline and the injection well a together with corresponding recirculation ratios and stagnation point locations where q i 1 q i 2 q t i 0 398 and l 0 2 fig 12 a shows that still q n m first increases and then decreases with increasing a giving the optimal q n m 0 290 at a 0 764 when a 0 932 the multiple well system performs worse than a single extraction well in term of the net extraction rate it is interesting that when q n m increases with increasing a r r1 and r2 increase almost linearly see fig 12 b r1 reaches 1 as a 0 876 fig 12 c and d show that for a 0 764 the two outer stagnation points are critical for 0 764 a 0 876 by contrast the inner two stagnation points are critical for a 0 876 no stagnation points are located on the x axis while two inner stagnation points are located on the x axis when a 0 876 and the one with a lower x coordinate is the critical stagnation point fig 13 shows the interface toe stagnation points and capture zone developed for the case of a 0 9 where injected water of the middle well is all re extracted i e r1 1 and the stagnation point located on the x axis with a lower x coordinate is critical 4 3 3 sensitivity of l fig 14 shows the maximum net extraction rates with varying distances between the two injection wells l together with corresponding recirculation ratios and stagnation point locations where q i 1 q i 2 q t i 0 398 and a 0 8 with increasing l q n m first increases and then decreases resulting in an optimal value of q n m 0 285 at l 0 17 see fig 14 a a very large distance between the two injection wells l 0 39 could lead to that a single extraction well outperforms the multiple well system in terms of the next extraction rate the overall recirculation ratio r first increases slightly when l increases from 0 03 to 0 17 and then decreases approximately linearly with increasing l see fig 14 b by contrast r1 first increases quickly and then decreases with increasing l for r2 it decreases with increasing l and in particular the curve exhibits linearity for l 0 17 during the increase of q n m the two outer stagnation points are critical to the derivation of the maximum extraction rate while as q n m decreases with l the two inner stagnation points become critical see figs 14 c and 13 d 4 3 4 non uniform injection rates of side and middle injection wells fig 15 shows that the maximum net extraction rates of the tiw system with non uniform injection i e q i 1 q i 2 where q t i 0 398 a 0 8 l is varied between 0 02 and 0 58 and q i 1 is varied between 0 0133 and 0 385 considering a limiting case with a very small l or q i 1 q ti the tiw could be simplified as an injection extraction well pair scheme which is introduced in our previous study lu et al 2013 alternatively the tiw essentially could be simplified as a diw scheme for cases with q i 1 0 it is shown that a large q i 1 or a small l generally results in a large q n m suggesting that the performance of the injection extraction well pair on enhancing groundwater extraction is generally good the optimal q n m 0 287 is obtained when l 0 2 and q i 1 0 199 interestingly under the condition of the optimal q n m q i 2 1 2 q i 1 moreover when l is very large and q i 1 is very small a low q n m is achieved as two side wells with most injected water could not develop an effective hydraulic barrier to prevent seawater intrusion into the extraction well due to a large distance between the side well and the extraction well 5 discussion using a multiple well system to develop a hydraulic barrier could enhance groundwater net extraction in comparison with a single extraction well and an injection extraction well system employment of a multiple well hydraulic barrier system leads to a more complicated flow system as demonstrated above the analytical solutions presented in this study as well as the method for delineating the capture zone can be used to provide preliminary guidance in the design of a multiple well hydraulic barrier system including the well locations and pumping rates or to assess an existing multiple well hydraulic barrier system the overall recirculation ratio in combination with the recirculation ratio for each injection well are particularly useful when assessing cases using reclaimed wastewater as an injectant under some conditions small recirculation ratios are obtained indicating that a large proportion of injected reclaimed wastewater mixes with original groundwater and a high risk to the subsurface environment may occur in practice one could adjust well locations to achieve desired recirculation ratios and still keep the similar performance of net groundwater extraction for the diw system the monotonicity of the maximum net extraction rate is determined by the total injection rate when the total injection rate is fixed the maximum net extraction rate is a non monotonic function of the distance between the coastline and the injection well and the distance between two injection wells resulting in a global maximum by contrast when the total injection rate is not fixed the maximum net extraction rate depends on the total injection rate a larger total injection rate results in a larger maximum net extraction rate because a higher injection rate results in a stronger hydraulic barrier for preventing seawater intrusion without doubt note that for cases with a fixed total injection rate an extremely large or small distance between the injection well and extraction well could lead to ineffectiveness of two injection wells moreover a larger total injection rate or a shorter distance between the injection well and extraction well cause more injected water to be extracted i e a larger recirculation ratio as expected for a fixed total injection rate the tiw system with a significantly large injection rate of the middle well or a very small distance between the middle injection well and the side injection well can be simplified as an injection extraction well pair system by contrast the tiw system with a fixed total injection rate and a significantly small injection rate of the middle well is similar to the diw system with an appropriate distance between two injection wells and appropriate injection rates the tiw system may further improve the maximum extraction rate for a given total injection rate in comparison with the diw system with increasing number of injection wells the maximum net extraction rate increases if the injection rate of an injection well keeps the same as shown in fig 3 however as found in our previous study lu et al 2013 the increase of the maximum net extraction rate would lead to the occurrence of seawater intrusion across a wider front in aerial view see the red interface toe curves in fig 3 the degree of this impact depends not only on various parameters associated with the multiple well system but also on the hydrogeological conditions and the effect from other neighboring pumping wells on the other hand inappropriate well locations and pumping rates could cause the performance of the multiple well system to be less effective than a single extraction well 6 conclusions our analytical solutions are derived based on various assumptions including a simplified homogeneous aquifer with always confined condition a semi infinite aquifer size a steady state flow and pumping condition and a sharp interface between seawater and freshwater to different extents these simplified assumptions could impact the solutions our analytical solutions could serve as a rapid first order assessment tool for the selection of well locations and well operation parameters based on the selective well parameters from the analytical analysis and a more complicated conceptual model close to real hydrogeological conditions variable density flow and solute transport numerical simulations are required to be performed to conduct a more accurate assessment of the performance of the multiple well system hydraulic barriers using either two or three injection wells are investigated using the analytical method with the aim of maximizing groundwater extraction under the threat of seawater intrusion the multiple well system is operated by extracting freshwater through a single landward well and partially reinjecting into the aquifer through two or three wells located parallel to the coastline and between the interface toe and the extraction well with the consideration of a multiple well system the flow field becomes more complicated than those of a single extraction well and an injection extraction well pair it is found that with the appropriate design of well locations and pumping rates the multiple well system could outperform an injection extraction well pair system in terms of the maximum net extraction rate under otherwise similar hydrogeological conditions sensitivity analyses indicate that with a fixed total injection rate a global maximum net extraction rate could be achieved by selecting the appropriate distance between the injection well and the coastline and the appropriate distance between the two injection wells when the total injection rate is not fixed by contrast the maximum net extraction rate is controlled by the total injection rate a larger total injection rate leads to a larger maximum net extraction rate with the variation of values of these parameters the critical stagnation point and recirculation ratio corresponding to maximum net extraction vary for a hydraulic barrier using three injection wells non uniform injection could further improve the maximum net extraction rate our analytical results have demonstrated the multiple well system is effective in improving groundwater extraction in a coastal aquifer the analytical findings in this study can provide a guidance to evaluate and design this system and hence have significant implications for effective groundwater resources management in coastal aquifers an accurate numerical model is required to include more practical factors including aquifer heterogeneity transient conditions and variable density flow additionally the investment cost of infrastructure must be taken into account for a real project declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements j wu acknowledges the financial support from the national key research project 2016yfc0402800 c lu acknowledges the financial support from the national natural science foundation of china 51679067 and 51879088 and fundamental research funds for the central universities b200204002 y ye acknowledges the financial support from the national natural science foundation of china 51709085 y xie acknowledges the financial support from the national natural science foundation of china 41702243 this is a theoretical study and no data is used supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103704 appendix supplementary materials image application 1 
418,hydraulic barriers using either two or three injection wells are studied analytically to evaluate their performance on improving groundwater extraction in a coastal aquifer under the threat of seawater intrusion the multiple well system is operated by extracting fresh groundwater through a landward well and partially reinjecting into the aquifer through two or three wells located parallel to the coastline and between the interface toe and the extraction well we found that with appropriate well locations and pumping rates the multiple well system could outperform a single extraction well in terms of net extraction rate which is up to 90 higher for an aquifer with a thickness of 20 m hydraulic conductivity of 10 m d and freshwater influx of 0 24 m2 d sensitivity analyses reveal that the monotonicity of the maximum net extraction rate is determined by the total injection rate in specific when the total injection rate is fixed the maximum net extraction rate is a non monotonic function of the distance between the injection well and the coastline and the distance between two injection wells resulting in a global maximum when the total injection rate is not fixed by contrast the maximum net extraction rate depends on the total injection rate and a larger total injection rate leads to a larger maximum net extraction rate by using different injection rates for side and middle injection wells of the three injection well hydraulic barrier the maximum net extraction rate could be further improved depending on the distance between the two injection wells analytical analyses can provide initial guidance for the design of a multiple well system in coastal aquifers with the purpose of obtaining enhanced extraction under the threats of seawater intrusion keywords seawater intrusion injection well analytical method maximum net extraction 1 introduction groundwater stored in coastal aquifers represents a precious resource and supports the rapid development of economy and the increasing growth of population in many countries michael et al 2017 however groundwater overexploitation from a coastal aquifer can cause the natural equilibrium between freshwater and seawater to be disturbed and result in seawater intrusion into inland aquifers a well known groundwater contamination issue in coastal regions werner et al 2013 since aquifer salinization in coastal areas can lead to various consequences in terms of environment ecology and economy effective management strategies are required to prevent coastal aquifers from being contaminated by saltwater bear et al 1999 custodio 2010 werner 2010 shi and jiao 2014 various measures for controlling seawater intrusion have been introduced in past decades optimization methods have been used to address various practical questions in relation to pumping operation well placement and design of artificial recharge schemes e g cheng et al 2000 park et al 2004 abarca et al 2006 song et al 2018 christelis and mantoglou 2019 where groundwater needs to be exploited from an aquifer containing saltwater at the bottom the application of horizontal wells skimming wells and surface drains is a simple and effective engineering measure to avoid saltwater upconing yin and tsai 2019 other engineering strategies mainly include the use of recharge wells to create a hydraulic barrier near the interface toe mahesha 1996 lu et al 2013 the application of negative hydraulic barriers i e extraction of saltwater to reduce the saltwater volume sherif and hamza 2001 kacimov et al 2009 masciopinto 2013 pool and carrera 2010 kaleris and ziogas 2013 ebeling et al 2019 the construction of subsurface physical barriers luyun et al 2009 2011 strack et al 2016 lu et al 2019 wu et al 2020 and the injection of compressed air to reduce hydraulic conductivity sun and semprich 2013 among these recharging an aquifer to increase the hydraulic head may be the most popular strategy and has been widely adopted in the field e g land et al 2004 vandenbohede et al 2009 abd elhamid et al 2011 el rawy et al 2019 the traditional aquifer recharge method adopting either injection or infiltration usually depends on external freshwater resources sheahan 1977 to combat with such a shortage lu et al 2013 proposed a novel injection extraction well pair system that extracts fresh groundwater from a landward well and reinjects a proportion of this back into the coastal aquifer through an injection well located between the interface toe and the extraction well in addition to the benefit of not requiring surface freshwater resources for the injection well this system could alleviate the impact of aquifer recharge on groundwater quality and subsurface geochemical environments the authors found that with appropriate well placement and operation parameters the well pair system could significantly outperform a single extraction well in terms of the net extraction rate namely the difference between the extraction rate and injection rate for the well pair system more recently lu et al 2016 compared the performance of the well pair system with that of the pond well system on seawater intrusion and groundwater extraction where the pond is assumed elliptic their analytical analysis indicated that the shape of the elliptic pond highly controlled the maximum net extraction rate of the pond well system obtained under the condition that the stagnation points are located on the interface toe when the major axis of the elliptic pond is parallel to the coastline the pond well system could be capable of obtaining a higher net extraction rate than that of a well pair system under otherwise the same hydrogeological condition through the comparison of the performance between the well pair system and the pond well system it is suggested that given the same recharge rate the developed hydraulic barrier across a longer lateral distance parallel to the coastline would lead to more enhanced extraction this finding inspires us to test the performance of a multiple injection well hydraulic barrier on improving groundwater net extraction where the injection wells are placed parallel to the coastline to develop a hydraulic barrier across a wide extent in the lateral direction in this study we aim to show how double injection well diw and triple injection well tiw hydraulic barriers can be solutions for local seawater intrusion prevention the performance of these two systems will be compared each other and with those of a single extraction well and an injection extraction well pair the employment of the diw and tiw system result in an additional parameter the distance between two injection wells which is expected to have a significant effect on the performance of the multiple well system in fact the multiple injection well system in a coastal aquifer has been analytically explored in previous studies sheahan 1977 explored a multiple injection extraction well pair system where the injection wells are located between the coastline and the extraction wells in that study a hydraulic barrier is created by injecting reclaimed waste water which is different from the design in our study hunt 1985 derived closed form solutions for the steady state interface toe location and stagnation points when a line of recharge wells was used to inject freshwater into a coastal aquifer park et al 2009 developed explicit algebraic equations for approximating minimum injection rates to control seawater intrusion to a specified location however these studies failed to investigate the effects of injection on the enhancing groundwater extraction of a well located landward of the injection wells this study aimed to analytically evaluate the performance of multiple injection well hydraulic barriers on enhancing groundwater extraction in a coastal aquifer by assuming a steady state sharp interface the potential theory introduced by strack 1976 and 1989 is adopted to derive analytical solutions of the interface toe location stagnation points and recirculation ratios strack s 1976 and 1989 potential theory has been widely employed to tackle a variety of coastal interface flow problems with wells e g lu et al 2012 lu and luo 2014 the potential theory has also been employed by lu et al 2013 and 2016 to derive the analytical solutions for the well pair system despite these studies the configuration of the multiple well systems designed in the current study has not been analytically investigated in previous studies our analytical study is expected to provide a useful tool for the assessment and design of a multiple injection well hydraulic barrier system in a coastal aquifer 2 conceptual model we consider respectively a conceptual model with two injection wells and one extraction well i e the diw system and a conceptual model with three injection wells and one extraction well i e the tiw system located in a homogeneous isotropic confined coastal aquifer with the inflow rate per unit aquifer width of qf l2 t from inland all wells are fully penetrating fig 1 shows the plan view of the conceptual models with x axis and y axis perpendicular to and along the coastline respectively as shown in fig 1 a the two injection wells with the same injection rate are parallel to the coastline and the extraction well is located at the centerline between the two injection wells the x axis pointing inland coincides with the centerline between the two injection wells fig 1 b shows the tiw system where three injection wells are parallel to the coastline and the x axis pointing inland coincides with the middle injection well and the extraction well the origin of the coordinate system in the two conceptual models is located at the intersection of the x axis and the coastline note that qf is negative because of opposite directions of the x axis and the inflow fig 1 c shows the cross section of the multiple well system located in a confined coastal aquifer for both diw and tiw systems the injection well and extraction well are located at a distance a l and b l from the coastline respectively and the distance between the two injection wells is l l for the diw system the injection rate of each injection well is qi l3 t negative and the extraction rate of the extraction well is qe l3 t positive for the tiw system the injection rates of the middle injection well and the side injection well are q i1 l3 t and q i2 l3 t respectively and the extraction rate of the extraction well is qe l3 t the net extraction rate qn l3 t of the multiple well system is equal to the extraction rate plus the total injection rate qti l3 t qti 2qi for the diw system and qti qi1 2 q i2 for the tiw system we chose the aquifer base as the reference level the confined aquifer thickness is b l note that physical limits to drawdown at the extraction well are not considered in the current study lu et al 2013 in other words the confined aquifer is assumed to remain confined under the extraction condition to apply strack s theory of comprehensive discharge potential we assume that the entire aquifer system is under the steady state condition and separated by a sharp freshwater seawater interface e g strack 1976 lu et al 2012 2013 and 2016 and the flow in the vertical direction is neglected i e the dupuit forchheimer assumption is adopted in addition the ghyben herzberg relation is employed 3 mathematical derivation 3 1 complex potential function we adopt the complex potential theory to express the flow system and to derive analytical solutions as it provides a convenient tool for solving two dimensional groundwater flow problems the spatial coordinates x and y are combined to generate a complex variable z in the horizontal planes in which x and y represent respectively the real and imaginary parts the complex potential for the model assumed in this study is then expressed as strack 1989 1 ω z ϕ z i ψ z q f z j 1 n q j 2 π ln z z j 2 z x i y where ω l3 t is the complex potential ϕ l3 t is strack s comprehensive discharge potential ψ l3 t is the stream function i 1 qj l3 t is the flow rate of jth well qj 0 for the extraction well and qj 0 for the injection well n is the total number of mathematical singularities i e real and imaginary wells and zj is the location in the complex plane of the jth well note that imaginary wells are included in eq 1 to satisfy the assumption of the constant head coastal boundary therefore when considering the diw system n 6 and zj is expressed by 3 z 1 a l 2 i z 2 a l 2 i z 3 a l 2 i z 4 a l 2 i z 5 b and z 6 b where a and b are respectively the x coordinates of the injection well and extraction well when considering the tiw system n 8 and zj is expressed by 4 z 1 a z 2 a z 3 a l i z 4 a l i z 5 a l i z 6 a l i z 7 b and z 8 b in particular when we consider an injection extraction well pair system as that described in lu et al 2013 n 4 and zj is expressed by 5 z 1 a z 2 a z 3 b and z 4 b the complex potential ω is separated into a real discharge potential ϕ christ and goltz 2002 6 ϕ q f x j 1 n q j 4 π ln x x j 2 y y j 2 and an imaginary stream function 7 ψ q f y j 1 n q j 2 π tan 1 y y j x x j in which xj and yj are the x and y coordinates of the jth well respectively 3 2 stagnation points stagnation points are locations in the flow field where the flow discharge is zero generally each well has a stagnation point associated with it as indicated above due to the constant head coastal boundary the same number of the imaginary wells as that of the real wells occur in the complex potential discharge potential and stream function equations therefore the diw and tiw systems result in respectively six and eight stagnation points to locate the stagnation points the derivative of the complex potential ω with respective to z should equal to zero 8 d ω d z q f 1 2 π j 1 n q j z z j 0 by letting a 2πqf we obtain 9 j 1 n q j z z j a 0 eq 9 represents a polynomial of order n allowing us to derive the stagnation points by simply finding the roots of this polynomial it is well known that for n 4 the roots of the polynomial can be found analytically while the numerical root finding methods are required for n 4 in this study we use a matlab built in solver solve to numerically solve eq 9 3 3 release capture and recirculation zones with the locations of stagnation points the capture and release zones can be plotted through the method proposed by fienen et al 2005 fig 2 shows various scenarios of capture and release zones of the diw and tiw systems comparing with the injection extraction well pair the capture and release zones of the diw and tiw systems are more complicated however three scenarios of capture and release zones can be generally identified as well scenario 1 when the total injection rate is sufficiently low or and the distance between the injection and extraction wells is sufficiently long there could be no recirculation zone between the injection and extraction wells see fig 2 a1 and b1 in this case the incident fresh groundwater is squeezed between the neighbouring plumes of the injection wells scenario 2 a recirculation zone is formed between injection and extraction wells and injected water is partially captured by the extraction well i e partial hydraulic shortcut this scenario is associated with intermediate extraction rates relative to injection rates and well distances as shown in fig 2 a2 and b2 scenario 3 all injected water is pumped out by the extraction well i e full hydraulic shortcut see fig 2 a3 and b3 due to that the extraction rate is sufficiently high relative to the injection rate or and the distance between the injection and extraction wells is significantly short as shown the streamline passing through the stagnation point of the extraction well separates water flowing into the extraction well from water flowing into the sea 3 4 calculation of recirculation ratio it is of practical interest to understand how much injected water is re extracted particularly for those scenarios adopting reclaimed waste water as an injectant sheahan 1977 the recirculation ratio of the multiple well system is defined as 10 r q r q t i where r is the recirculation ratio ranging between 0 and 1 the limiting cases of r 0 and r 1 represent respectively scenarios 1 and 3 in fig 2 qr l3 t is the discharge in the recirculation zone qr 0 the definition of the recirculation ratio in our study is similar to those in previous studies investigating the injection extraction well pair system luo and kitanidis 2004 luo et al 2006 lu et al 2013 for the well pair system that contains two stagnation points the recirculation zone is enclosed by the stream tube between the two streamlines passing stagnation points similarly the discharge in the circulation zone for the diw system can be expressed as 11 q r q ti 2 ψ s 1 for x s 1 a 12 q r 2 ψ s 1 for x s 1 a where x s1 l is the x coordinate of the stagnation point which is not located on the x axis and ψ s1 l3 t is the value of the stream function of that stagnation point note that since we assume that the locations of the two injection wells are symmetric with respect to the x axis and the two injection rates are identical the middle stagnation point is located on the x axis the recirculation ratio is then given as 13 r 1 2 ψ s 1 q ti for x s 1 a 14 r 2 ψ s 1 q ti for x s 1 a the tiw system has four stagnation points in the real domain i e the flow domain resulting in three stream tubes at the most since two adjacent stagnation points could generate one stream tube as mentioned above we assume that the injection rates may be different for the middle injection well and two side injection wells therefore one may expect to derive an overall recirculation ratio for the tiw system as well as the recirculation ratio for each injection well the overall recirculation ratio of the tiw system can be derived by 15 r 1 2 ψ s 2 q ti for x s 2 a 16 r 2 ψ s 2 q ti for x s 2 a where x s2 is the x coordinate of the stagnation point which is located farther from the x axis i e the stagnation point with a lager absolute value of the y coordinate and ψ s2 is the value of the stream function of that stagnation point the recirculation ratio of the middle injection well can be calculated by 17 r 1 1 2 ψ s 1 q i 1 for x s 1 a 18 r 1 2 ψ s 1 q i 1 for x s 1 a where x s1 is the x coordinate of the stagnation point which is located closer to the x axis i e the stagnation point with a smaller absolute value of the y coordinate and ψ s1 is the value of the stream function of that stagnation point the recirculation ratio of the side injection well can be derived simply by 19 r 2 r q ti r 1 q i 1 2 q i 2 if we assume that q i1 q i2 we can obtain 20 r 2 3 2 r 1 2 r 1 3 5 interface toe location locating the freshwater seawater interface toe requires the continuity condition of the discharge potential across the interface toe between the freshwater only zone and the interface zone the discharge potential at the interface toe for a confined aquifer is expressed as strack 1976 21 ϕ t α 1 2 k b 2 where α is the ratio of the seawater density relative to the freshwater density and k l t is the hydraulic conductivity note that eq 21 is derived by the discharge potential expression of the interface zone strack 1976 the location of the interface toe can be evaluated by using eq 6 and replacing ϕ in eq 6 by ϕ t in eq 21 note that the performance of the multiple well system in an unconfined coastal aquifer can be assessed by simply using the toe potential of an unconfined aquifer lu et al 2013 3 6 maximum extraction rate the procedures of deriving the maximum extraction rate for given injection rates have been described in detail in lu et al 2013 main steps include 1 assigning an initial value to the extraction rate 2 deriving stagnation points using eq 9 3 calculating the discharge potential at the critical stagnation point i e the stagnation point where the interface toe first meets with increasing extraction rate using eq 6 4 calculating the discharge potential at the interface toe using eq 21 5 checking if the difference of the discharge potential of the interface toe and at the critical stagnation point is less than a given threshold 0 1 m3 d is adopted in the current study and 6 adjusting the extraction rate until step 5 is achieved the obtained extraction rate is the maximum extraction rate the maximum net extraction rate q n m of the multiple well system is simply the summation of the maximum extraction rate and the total injection rate because of negative values of the injection rate in step 3 the critical stagnation point of the diw and tiw systems can be searched by the following method normally the critical stagnation point is the one with the lowest value of the discharge potential for the diw system under some special conditions all injected water could be extracted namely r 1 under the maximum net extraction condition these scenarios could occur when the injection rate is too small or the injection wells are located too close to the extraction well the stagnation point located on the x axis is the critical stagnation point rather than the one with the lowest discharge potential for the tiw system special conditions occur when all injected water of the middle injection well is extracted namely r 1 1 under such a situation two stagnation points are located on the x axis and the one located more landward must not be the critical stagnation point therefore for the remaining three stagnation points the critical stagnation point is the one with the lowest discharge potential when r 1 in the tiw system the stagnation point located on the x axis with the lowest x coordinate is the critical stagnation point 3 7 dimensionless parameters to facilitate the analysis we define the following dimensionless parameters 22 x x b y y b a a b l l b q i q i 2 π b q f q i 1 q i 1 2 π b q f q i 2 q i 2 2 π b q f q e q e 2 π b q f q t i q t i 2 π b q f q n q e q t i 2 π b q f q n m q n m 2 π b q f and ϕ t ϕ t b q f 3 8 parameter values the parameter values of the aquifer used in the current study are similar to those adopted in lu et al 2013 the aquifer thickness b the inland freshwater flux qf the hydraulic conductivity k the ratio of the seawater density relative to the freshwater density α and the distance between the extraction well and the coastline b are 20 m 0 24 m2 d 10 m d 1 025 and 500 m respectively and fixed for all cases to examine the sensitivity of various parameters to the performance of the multiple injection well hydraulic barrier system on enhancing the maximum net extraction rate the distances between the injection well and the coastline a are varied between 300 m and 490 m the injection rates of each well qi q i1 and qi2 are varied between 0 m3 d and 2000 m3 d and the distances between two injection wells l are varied between 10 and 1000 m the values of these parameters are listed in table 1 4 results 4 1 comparison of a single extraction well system and multiple well systems fig 3 shows the interface toe positions stagnation points and release and capture zones created respectively by a single extraction well an injection extraction well pair a diw system and a tiw system where the locations of the extraction well a 0 8 and the distances between two injection wells l 0 2 in all multiple well cases are the same fig 3 a and b indicate that the interface toe reaches the stagnation point in cases of a single extraction well and an injection extraction well pair representing that the critical extraction condition is obtained i e the condition under maximum extraction by trial and error it is found that q e 0 174 for the single extraction well and q n 0 240 for the injection extraction well pair suggesting a 38 increase in the maximum net extraction rate by using an injection well located between the extraction well and the coastline with q i 0 252 these results are consistent with those in our previous study lu et al 2013 fig 3 c shows that there remains a significant gap between the interface toe and the stagnation point if the same net extraction rate of the well pair is applied as a net extraction rate i e q n 0 240 for the diw system where q i 0 252 is taken for each injection well in other words the diw system does not reach the critical condition under such a pumping condition and the extraction rate could be larger fig 3 d shows that the maximum net extraction rate is achieved for the given injection rate with q n 0 278 representing a 60 increase in comparison to that obtained for a single extraction well fig 3 e shows that the tiw system does not reach the critical condition when q n 0 278 and q i 0 252 is adopted for each injection well indicating that the tiw could extract more fresh groundwater than the diw system the critical condition of the tiw system is shown in fig 3 f with q n 0 322 an 85 increase compared to the single well situation as shown in these figures the number of stagnation points is identical to the number of wells in addition for all multiple well systems in fig 3 the capture and release zones are identified as scenario 2 which means that a recirculation zone is formed between injection and extraction wells and part of injected water is captured by the extraction well 4 2 diw system to focus on the effect of locations and operation parameters of injection wells we explore the sensitivity of q t i a and l to the maximum net extraction rate recirculation ratio and stagnation point locations and fix the value of ϕ t 0 417 when investigating the sensitivity of one parameter values of other two parameters are kept constant 4 2 1 sensitivity of q t i fig 4 shows the maximum net extraction rates with varying total injection rates q t i together with corresponding recirculation ratios and stagnation point locations where a 0 8 and l 0 2 when q t i 0 the system reduces to the case of a single extraction well and the resulting q n m 0 174 is consistent with the value obtained in fig 3 a fig 4 a indicates that the influence of q t i on q n m is non monotonic similar to that found in the injection extraction well pair system lu et al 2013 q n m initially increases and then decreases with increasing total injection rate i e q t i producing an optimal q n m 0 299 at q t i 1 273 this optimal value is about 72 higher than that of the corresponding single extraction well case it is also shown in fig 4 a that large injection rates when q t i 4 032 could cause the performance of the multiple well system to be less effective than a single extraction well furthermore extremely large total injection rates would lead to the maximum allowable pumping rate less than the total injection rate i e a negative net extraction rate fig 4 b shows that the recirculation ratios r under the condition of maximum net extraction are larger than 0 545 and asymptotes to 0 870 with increasing q t i indicating that less than half of injected water is re extracted and the remaining injected water flows to the sea to prevent seawater intrusion the asymptotical phenomenon of r of the diw system has also been found in the injection extraction well pair system lu et al 2013 because of symmetry as mentioned above one stagnation point is located on the x axis and the other two stagnation points are located symmetric with respect to the x axis we only show the x coordinates of two stagnation points in fig 4 c one located on the x axis and the other not on the x axis because the two stagnation points not on the x axis share the same x coordinates we only show non negative y coordinates of stagnation points in fig 4 d in figs 4 c and 4 d the curves in red represent the coordinates of the critical stagnation points with which the freshwater seawater interface toe meets under the condition of maximum net extraction it is clearly shown that with increasing q t i the critical stagnation point is first the one on the x axis when q t i 0 212 and then not on the x axis when q t i 0 212 to demonstrate this we show in fig 5 the interface toes and flow systems created by scenarios of q t i 0 133 and 1 194 respectively moreover x s of all stagnation points under the condition of maximum net extraction are not monotonic functions of q t i while the positive y s increases monotonically with increasing q t i 4 2 2 sensitivity of a fig 6 shows the maximum net extraction rates with varying distances between the injection well and the coastline a together with corresponding recirculation ratios and stagnation point locations where q t i 0 265 and l 0 2 similar to q t i q n m is a non monotonic function of a in specific q t i first increases and then decreases with increasing a resulting in an optimal q n m 0 256 at a 0 816 as shown in fig 6 a it is interesting that when a is less than the critical value namely 0 816 r almost linearly increases with increasing a while this linear relationship does not exist when a 0 816 see fig 6 b as a 0 948 r 1 indicating that all injected water is re extracted moreover a 0 816 is also a critical value for the locations of the critical stagnation point it can be found from figs 6 c and 6 d that when a 0 816 the critical stagnation point is not located on the x axis by contrast the stagnation point located on the x axis is the critical one when a 0 816 4 2 3 sensitivity of l fig 7 shows the maximum net extraction rates with varying distances between two injection wells l together with corresponding recirculation ratios and stagnation point locations where q t i 0 265 and a 0 8 as shown in fig 7 a as l increases from 0 02 to 0 22 q n m increases slightly from 0 242 to 0 255 however a further increase of l from 0 22 to 2 results in the decrease of q n m from 0 255 to 0 0112 the negative values of q n m indicate that the extraction rate is less than the total injection rate with increasing l r experiences three variation patterns see fig 7 b as l increases from 0 02 to 0 22 i e the step when q n m increases from 0 242 to 0 255 r increases slightly from 0 777 to 0 799 then r decreases approximately linearly with increasing l from 0 22 to 1 3 resulting in a minimum r almost equal to zero during the last step r is equal to zero with increasing l from 1 3 to 2 representing that no injected water is re extracted because the distance between the injection well and extraction well is too far fig 8 shows the flow system when r is almost equal to zero where l 1 3 and q n m 0 0378 it is interesting that the separation streamlines of the extraction well and two injection wells are almost overlapped leading to almost all extracted water coming from the original aquifer instead of water recharged by two injection wells fig 7 c and 7 d show that the critical stagnation point is initially not located on the x axis when l 0 2 and then located on the x axis when l 0 2 for large l the two plumes developed by two injection wells are too far from the x axis to form an effective hydraulic barrier for the extraction well resulting in low net extraction rates 4 2 4 joint effects of q t i a and l fig 9 shows the joint effects of q t i a and l on q n m fig 9 a demonstrates the sensitivity of q n m to q t i and l in which a 0 8 as indicated negative values are obtained for large values of q t i and l for a fixed value of q t i q n m is a non monotonic function of l resulting in a maximum value of q n m this maximum q n m increases with increasing q t i for example when q t i 0 106 and 2 653 q n m 0 217 and 0 399 respectively fig 9 b shows the sensitivity of q n m to a and l in which q t i 0 265 it is found that q n m is a non monotonic function of a and l when the value of the other one parameter is fixed resulting a global optimum q t i 0 257 when a 0 68 and l 0 48 fig 9 c shows the sensitivity of q n m to a and q t i in which l 0 2 for a fixed value of q t i q n m is a non monotonic function of a resulting in a maximum value of q n m similar to the sensitivity of q n m to l this maximum q n m increases with increasing q t i for example when q t i 0 106 and 2 653 q n m 0 219 and 0 357 respectively 4 3 tiw system we conduct the similar sensitivity analysis for the tiw system as described above the injection rate of the side well q i 1 could be different from that of the injection well located on the x axis q i 2 in the following we first conduct the sensitivity analysis by assuming q i 1 q i 2 and then the scenarios of q i 1 q i 2 are studied 4 3 1 sensitivity of q t i fig 10 shows the maximum net extraction rates with varying total injection rates q t i together with corresponding recirculation ratios and stagnation point locations where q i 1 q i 2 q t i 0 398 and a 0 8 similarly q n m is not a monotonic function of q t i and the optimal q n m 0 337 occurs when q t i 1 512 also large q t i 4 974 could lead to the performance of the multiple well system worse than a single extraction well in terms of the maximum net extraction rate see fig 10 a fig 10 b shows the variation of the overall recirculation ratio of the well system r and recirculation ratios of the middle r1 and side r2 wells with increasing q t i r and r2 increase sharply when q t i increases to 0 855 and then asymptotes to 0 878 by contrast r1 first quickly increases to its maximum value r1 0 947 and then decreases to approach the curve of r fig 10 c and d show varying stagnation points with increasing q t i as shown when q t i is low i e q t i 0 637 the stagnation points located closer to the x axis are critical while the critical stagnation points are located farther from the x axis when q t i 0 637 see fig 10 d to explain the variation of critical stagnation points with increasing q t i we plot the interface toes stagnation points and capture zone under the conditions of maximum extraction for two scenario with q t i 0 478 and 0 796 in fig 11 it can be seen that with a smaller q t i the critical stagnation pointers are the two located closer to the x axis while the two outer stagnation points become critical for the larger q t i 4 3 2 sensitivity of a fig 12 shows the maximum net extraction rates with varying distances between the coastline and the injection well a together with corresponding recirculation ratios and stagnation point locations where q i 1 q i 2 q t i 0 398 and l 0 2 fig 12 a shows that still q n m first increases and then decreases with increasing a giving the optimal q n m 0 290 at a 0 764 when a 0 932 the multiple well system performs worse than a single extraction well in term of the net extraction rate it is interesting that when q n m increases with increasing a r r1 and r2 increase almost linearly see fig 12 b r1 reaches 1 as a 0 876 fig 12 c and d show that for a 0 764 the two outer stagnation points are critical for 0 764 a 0 876 by contrast the inner two stagnation points are critical for a 0 876 no stagnation points are located on the x axis while two inner stagnation points are located on the x axis when a 0 876 and the one with a lower x coordinate is the critical stagnation point fig 13 shows the interface toe stagnation points and capture zone developed for the case of a 0 9 where injected water of the middle well is all re extracted i e r1 1 and the stagnation point located on the x axis with a lower x coordinate is critical 4 3 3 sensitivity of l fig 14 shows the maximum net extraction rates with varying distances between the two injection wells l together with corresponding recirculation ratios and stagnation point locations where q i 1 q i 2 q t i 0 398 and a 0 8 with increasing l q n m first increases and then decreases resulting in an optimal value of q n m 0 285 at l 0 17 see fig 14 a a very large distance between the two injection wells l 0 39 could lead to that a single extraction well outperforms the multiple well system in terms of the next extraction rate the overall recirculation ratio r first increases slightly when l increases from 0 03 to 0 17 and then decreases approximately linearly with increasing l see fig 14 b by contrast r1 first increases quickly and then decreases with increasing l for r2 it decreases with increasing l and in particular the curve exhibits linearity for l 0 17 during the increase of q n m the two outer stagnation points are critical to the derivation of the maximum extraction rate while as q n m decreases with l the two inner stagnation points become critical see figs 14 c and 13 d 4 3 4 non uniform injection rates of side and middle injection wells fig 15 shows that the maximum net extraction rates of the tiw system with non uniform injection i e q i 1 q i 2 where q t i 0 398 a 0 8 l is varied between 0 02 and 0 58 and q i 1 is varied between 0 0133 and 0 385 considering a limiting case with a very small l or q i 1 q ti the tiw could be simplified as an injection extraction well pair scheme which is introduced in our previous study lu et al 2013 alternatively the tiw essentially could be simplified as a diw scheme for cases with q i 1 0 it is shown that a large q i 1 or a small l generally results in a large q n m suggesting that the performance of the injection extraction well pair on enhancing groundwater extraction is generally good the optimal q n m 0 287 is obtained when l 0 2 and q i 1 0 199 interestingly under the condition of the optimal q n m q i 2 1 2 q i 1 moreover when l is very large and q i 1 is very small a low q n m is achieved as two side wells with most injected water could not develop an effective hydraulic barrier to prevent seawater intrusion into the extraction well due to a large distance between the side well and the extraction well 5 discussion using a multiple well system to develop a hydraulic barrier could enhance groundwater net extraction in comparison with a single extraction well and an injection extraction well system employment of a multiple well hydraulic barrier system leads to a more complicated flow system as demonstrated above the analytical solutions presented in this study as well as the method for delineating the capture zone can be used to provide preliminary guidance in the design of a multiple well hydraulic barrier system including the well locations and pumping rates or to assess an existing multiple well hydraulic barrier system the overall recirculation ratio in combination with the recirculation ratio for each injection well are particularly useful when assessing cases using reclaimed wastewater as an injectant under some conditions small recirculation ratios are obtained indicating that a large proportion of injected reclaimed wastewater mixes with original groundwater and a high risk to the subsurface environment may occur in practice one could adjust well locations to achieve desired recirculation ratios and still keep the similar performance of net groundwater extraction for the diw system the monotonicity of the maximum net extraction rate is determined by the total injection rate when the total injection rate is fixed the maximum net extraction rate is a non monotonic function of the distance between the coastline and the injection well and the distance between two injection wells resulting in a global maximum by contrast when the total injection rate is not fixed the maximum net extraction rate depends on the total injection rate a larger total injection rate results in a larger maximum net extraction rate because a higher injection rate results in a stronger hydraulic barrier for preventing seawater intrusion without doubt note that for cases with a fixed total injection rate an extremely large or small distance between the injection well and extraction well could lead to ineffectiveness of two injection wells moreover a larger total injection rate or a shorter distance between the injection well and extraction well cause more injected water to be extracted i e a larger recirculation ratio as expected for a fixed total injection rate the tiw system with a significantly large injection rate of the middle well or a very small distance between the middle injection well and the side injection well can be simplified as an injection extraction well pair system by contrast the tiw system with a fixed total injection rate and a significantly small injection rate of the middle well is similar to the diw system with an appropriate distance between two injection wells and appropriate injection rates the tiw system may further improve the maximum extraction rate for a given total injection rate in comparison with the diw system with increasing number of injection wells the maximum net extraction rate increases if the injection rate of an injection well keeps the same as shown in fig 3 however as found in our previous study lu et al 2013 the increase of the maximum net extraction rate would lead to the occurrence of seawater intrusion across a wider front in aerial view see the red interface toe curves in fig 3 the degree of this impact depends not only on various parameters associated with the multiple well system but also on the hydrogeological conditions and the effect from other neighboring pumping wells on the other hand inappropriate well locations and pumping rates could cause the performance of the multiple well system to be less effective than a single extraction well 6 conclusions our analytical solutions are derived based on various assumptions including a simplified homogeneous aquifer with always confined condition a semi infinite aquifer size a steady state flow and pumping condition and a sharp interface between seawater and freshwater to different extents these simplified assumptions could impact the solutions our analytical solutions could serve as a rapid first order assessment tool for the selection of well locations and well operation parameters based on the selective well parameters from the analytical analysis and a more complicated conceptual model close to real hydrogeological conditions variable density flow and solute transport numerical simulations are required to be performed to conduct a more accurate assessment of the performance of the multiple well system hydraulic barriers using either two or three injection wells are investigated using the analytical method with the aim of maximizing groundwater extraction under the threat of seawater intrusion the multiple well system is operated by extracting freshwater through a single landward well and partially reinjecting into the aquifer through two or three wells located parallel to the coastline and between the interface toe and the extraction well with the consideration of a multiple well system the flow field becomes more complicated than those of a single extraction well and an injection extraction well pair it is found that with the appropriate design of well locations and pumping rates the multiple well system could outperform an injection extraction well pair system in terms of the maximum net extraction rate under otherwise similar hydrogeological conditions sensitivity analyses indicate that with a fixed total injection rate a global maximum net extraction rate could be achieved by selecting the appropriate distance between the injection well and the coastline and the appropriate distance between the two injection wells when the total injection rate is not fixed by contrast the maximum net extraction rate is controlled by the total injection rate a larger total injection rate leads to a larger maximum net extraction rate with the variation of values of these parameters the critical stagnation point and recirculation ratio corresponding to maximum net extraction vary for a hydraulic barrier using three injection wells non uniform injection could further improve the maximum net extraction rate our analytical results have demonstrated the multiple well system is effective in improving groundwater extraction in a coastal aquifer the analytical findings in this study can provide a guidance to evaluate and design this system and hence have significant implications for effective groundwater resources management in coastal aquifers an accurate numerical model is required to include more practical factors including aquifer heterogeneity transient conditions and variable density flow additionally the investment cost of infrastructure must be taken into account for a real project declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements j wu acknowledges the financial support from the national key research project 2016yfc0402800 c lu acknowledges the financial support from the national natural science foundation of china 51679067 and 51879088 and fundamental research funds for the central universities b200204002 y ye acknowledges the financial support from the national natural science foundation of china 51709085 y xie acknowledges the financial support from the national natural science foundation of china 41702243 this is a theoretical study and no data is used supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103704 appendix supplementary materials image application 1 
419,the effect of emergent stems on the transport of downstream floating particles e g buoyant seeds is explored theoretically and experimentally at moderate to high reynolds number r d 2 u b a s υ 300 in an open channel where u b is the bulk velocity a s is stem radius and ν is the kinematic viscosity longitudinal dispersion d l of such seeds is shown to be given by d l u p 3 τ 0 2 η 1 η 2 s 1 η τ 0 u p thereby requiring the bulk transport velocity of particles u p spacing between canopy elements s 1 collision efficiency η between a particle and the stem and a wake trapping time scale τ 0 linkages between u p and u b and terms η and τ 0 are then derived using inhomogeneous flow characteristics adjacent to the stem with physical properties of particles a semiempirical model with potential flow theory around the stem is introduced to estimate η whereas τ 0 is shown to be related to the bulk drag coefficient and radius of stems the d l is experimentally determined across a wide range of r d and particle sizes and shown to be in good agreement with the proposed model calculations keywords floating seed emergent vegetation hydrochory seed vegetation collision dispersion mechanism longitudinal dispersal 1 introduction seed dispersal by water hydrochory sets a spatial template for the spread structure and survival of many aquatic plants nilsson et al 1994 merritt and wohl 2006 defina and peruzzo 2010 cunnings et al 2016 liu et al 2018 it is one of the main processes responsible for regeneration and self sustaining rehabilitation of riparian ecosystems schneider and sharitz 1988 dewoody et al 2004 hyslop and trowsdale 2012 dispersal by wind anemochory has received significant research attention and mathematical treatment e g okubo and levin 1989 greene and johnson 1996 clark et al 1998 levine 2003 katul et al 2005 nathan et al 2011 duman et al 2016 however hydrochory has received disproportionately less attention one complication arising in hydrochory that is absent in anemochory is the need to distinguish between non buoyant and buoyant seeds buoyant seeds can be transported through the combined action of flowing water surface waves and even surface wind nilsson et al 1994 many aquatic plant seeds have the ability to float meaning that an extended floating time enhances dispersal distances by mean advection danvind and nilsson 1997 nilsson et al 2010 riis and sand jensen 2006 a number of models use empirical or semi empirical approaches to describe seed transport in the form of a so called dispersal kernel groves et al 2009 shi et al 2020 dispersal kernels represent the probability of finding a seed at some finite distance from the parent source empirical approaches describe plausible mathematical shapes for the dispersal kernel that are then used to predict distribution of herbaceous plants and their communities levine 2003 mechanistic approaches such as the semi empirical gaussian plume equations have also been used to describe dispersal kernels using mean velocity and hydraulic geometry as variables groves et al 2009 the outcome from such models is that the majority of seeds deposit near the release point but few seeds can spread over long distance highlighting the possibility of long distance dispersal by a small number of seeds these results have been used to justify the differing dispersal patterns of short and long distance transport from parent source of seeds as has been observed in wind dispersal studies nathan et al 2002 another mechanism that can lead to differing dispersal patterns near and far from the parent source or release point is vegetation capture or trapping floating seeds can be captured temporarily or permanently by vegetation and mathematical models accommodating such capture are now beginning to receive theoretical and experimental attention defina and peruzzo 2010 proposed a stochastic model to describe the transport and diffusion of floating particles and the trapping mechanisms by emergent flexible vegetation with varied plant density they adopted a weighted combination of two exponential distributions to predict the distribution of particle retention time defina and peruzzo 2012 these two distributions were intended to reflect retention time differences for short and long duration trapping events furthermore peruzzo et al 2012 investigated the effect of surface tension on the fate of floating particles dispersal in open channel flows with emergent vegetation at low reynolds number and confirmed the effectiveness of such a weighted scheme liu et al 2018 further explored the mechanisms responsible for floating particles dispersal in slow moving flow with emergent vegetation by combining kinematic and statistical models of particle stem interactions these prior efforts primarily dealt with particle collision and trapping by stems due to surface tension at low flow velocity analogous to a small weber number e g peruzzo et al 2012 liu et al 2018 however for moderate to high reynolds numbers surface tension between stems and particles may be small and even ignored i e high weber number dispersal mechanism of such floating particles and corresponding particle stem interaction at moderate to high reynolds numbers have rarely been investigated however which may terminate long distance transport and change the fate of floating seeds within vegetated riverway the work here attempts to fill this knowledge gap through novel theories and flume experiments the focus is on the interaction between floating particles and emergent stems in fast moving free surface flows in which collision and trapping events exist but not due to surface tension when passing through an array of stems at moderate to high reynolds number the trajectory of a floating particle is impacted by a number of flow features i the particle transport velocity u p is significantly larger than the bulk flow velocity u b due to the so called blockage effect which was first proposed by maskell 1963 and developed by zdravkovich 2003 ii the stems generate wake turbulence and mechanical dispersion that distort the particle trajectory from streamlines set by the mean flow in the vicinity of the stem iii the stems modify particle trajectory when a collision occurs that can lead to rebound or trapping these mechanisms form the basis of a newly proposed model for floating particle dispersion in uniformly distributed array of emergent rigid stems the main novelties of the proposed approach include a semiempirical kinematic model with potential flow theory to estimate the probability of collision between particles and the stem and a retention time model based on wake theory following an isolated collision event by combining with classical theories of blockage effects within an array of cylinders we can arrive at a formulation for the longitudinal dispersion coefficient of floating particles at high reynolds number by dispersion coefficient we mean the coefficient that describes the spatial spread of a cloud of particles over a sufficiently long time interval as conventional in lagrangian particle studies fischer 1973 moreover it is to be noted that dispersal mechanism within the array of stems of floating seeds differs from the well studied solute particles e g chemical contaminant biological hormone and suspended fine particles e g sediments i e surface effect hydrodynamic processes that occur at a free water surface e g wind drag and surface tension effects and volume effect inertial impaction sidewise repulsion due to asymmetric attached lateral velocity induced by stems acting on floating particles and lateral pressure on the side away from the centre of stem volume effect can be significant for floating seeds but not necessarily for small grains or sediments accordingly the length scale ratio between floating seeds and partices are expected to become a dynamically significant factor primarily because of volume effect and surface effect 2 theoretical model to explore the canonical aspects of floating seed dispersion for emergent canopy flow at high reynolds number the flow is assumed to be steady and uniform with the water surface not subjected to any wind stresses or wave action the vegetation covering the channel bottom is composed of a honeycomb stem arrangement fig 1 the stems are rigid cylindrical in shape with radius a s and are characterized by a uniform stem density ns defined by the number of stems per unit ground area or the solid area fraction λ π n s a s 2 wooden spherical particles are used to represent the floating seeds for consistency with prior experiments defina and peruzzo 2010 peruzzo et al 2012 and liu et al 2018 for the arrangement in fig 1 two distances are pointed out the center to center spacing between adjacent stems s 1 n s and the length of each segment in the direction of the mean flow s 1 0 5 3 n s see fig 1 2 1 longitudinal dispersion the dispersal of floating particles within such a stem array is anisotropic and is determined by two mechanisms wake turbulence and mechanical dispersion nepf et al 1996 in fig 1 two floating particles a and b starting at the same position will migrate within the stem array along different trajectories and experience longitudinal separation during a fixed time interval particles traversing a distance s 1 in the direction of the flow may collide with a stem with the collision efficiency η defined as the ratio of upstream width of particles colliding with the stem to the center to center spacing between adjacent stems after the collision a particle encounters a backflow region and resides in the wake for some time and then it moves into an intermediate wake region let τ 0 be the mean retention time due to an isolated collision and temporary wake trapping event compared to no collision case define nt as the total number of segments a particle passes through the entire vegetated patch and ni as the total number of collisions a particle experiences after crossing nt segments by definition the entire length of the vegetated patch is n t s 1 the total retention time a particle experiences while passing through the entire vegetated patch length isτ r τ0 ni thus the probability distribution function of τ r labeled as q τ r when a particle traverses the total distance n t s 1 is 1 q τ r c 0 τ 0 η n i 1 η n t n i where c 0 is the binomial coefficient the probability of τ r is based on a binomial distribution with a mean time and a variance σ t 2 τ 0 2 n t η 1 η as discussed elsewhere defina and peruzzo 2010 when a cloud of particles is released at the same position the total time that the cloud of particles experiences longitudinal separation is 2 t m n t s 1 u p n t η τ 0 where u p is the bulk transport velocity of the particle the first term in eq 2 describes the absence of collision and wake distortion scenario whereas the second term accommodates the collision and wake trapping effects on the overall travel time thus the longitudinal spatial variance of the cloud can be estimated as 3 σ l 2 u p 2 σ t 2 u p 2 τ 0 2 n t η 1 η at very long times the longitudinal dispersion of the cloud will converge to a fickian diffusion by the central limit theorem so that the longitudinal spatial variance of the cloud grows linearly with t m under those asymptotic conditions the longitudinal dispersion coefficient can be defined from σ l 2 2 d l t m rutherford 1994 or 4 d l σ l 2 2 t m u p 3 τ 0 2 η 1 η 2 s 1 η τ 0 u p to estimate dl requires determining parametersτ0and η as well as links between bulk velocity u b and particle transport velocity up in the applications of dimensional analysis identifying all the variables impacting the sought quantity is the most challenging step katul et al 2019 herein it is instructive to ask to what degree can τ 0 and η be predicted from dimensional analysis that is the list of plausible variables impacting τ 0 may include processes relevant to inertial impaction the buoyancy of the particles and the size of the wake zone trapping the particle hence this plausible list leads to 5 τ 0 f 1 u b a p a s l w ρ p ρ w where f 1 is an unknown function to be determined a p and as are the particle and stem radius respectively arising from inertial impaction ρ p andρ w are densities of the particle and water arising from buoyancy l w is length scale of the wake zone combined with u b can be used to form a characteristic trapping time scale in the wake zone behind the stem introducing the following dimensionless groups a r a p a s and ρ r ρ p ρ w dimensional analysis alone can be used to reduce the list of variables to 6 τ 0 a r m 1 ρ r m 2 l w u b here dimensional analysis cannot determine the exponents m 1 and m 2 the length scale of the wake zone l w is further impacted by the wake generation process so thatlw ascds with c ds being the bulk drag coefficient of the stem eq 6 can then be rearranged as 7 τ 0 c d s a r m 1 ρ r m 2 a s u b likewise the collision efficiency η must at minimum depend on the spacing between the interfaces of stem elements i e s 1 as and the size of the particle passing between these stem elements these two distances can be combined to yield 8 η 2 a p s 1 a s the proposed model next aims at describing τ 0 and η using what is known about the flow field around cylinders which can then be used in conjunction with eq 4 to predict d l 2 2 collision model at low reynolds number the collision efficiency η primarily depends on the acceleration caused by surface tension that draws floating particles toward stems as the bulk flow velocity increases the effect of particle inertia caused by advection will be dominant in a collision with stems similar to liu et al 2018 the weber number w b 2 ρ w u b 2 a p σ with σ as the surface tension is introduced to assess the vegetated water bodies for the small scale issue of floating particles when w b 1 the effect of surface tension on interactions between floating particles and emergent stems can be ignored in a flow through a dense population of emergent stems the blockage effect will also alter the flow around a stem it was found that the presence of the stem reduces the cross sectional area locally and results in a concomitant increase in the velocity around the body in relation to the bulk flow velocity zdravkovich 1997 in a flow through a dense population of emergent stems streamlines become circuitous as they bend and branch around the stem nepf et al 1997 a downstream floating particle approaching a stem will be subject to a lateral acceleration that acts to push the particle away from the stem the acceleration is caused by lateral velocity difference between particles and attached lateral velocity due to fluid parcels are displaced laterally by the presence of stems in the corresponding cross sections the frequency of random events that directly collided particles are pushed away from stems are called deviation effect britter et al 1979 measured turbulence around a circular cylinder and discussed how streamlines and turbulence are distorted relative to the upstream state the most pertinent result from this analysis is that there exist a region of vorticity distortion near the cylinder surface that is roughly 5a s in this region distortions from the free streamlines became apparent and the attached lateral velocity has a significant effect on the transport of particle thus a circular region with a radius of 5a s can be used to delineate the zone sensing such deviation effects see fig 2 let l r and l d be defined as lateral lengths of direct collision and the deviation effect respectively considering downstream particles initially entering the deviation effect region and defining a variable ξ y l r l d a semiempirical kinematic model can be developed to determine this acceleration based on numerical simulations in a confined pipe at a microfluidic scale di carlo et al 2009 describes the lateral repulsive force acting on particle due to asymmetrical distribution of flow velocity and pressure as f l ρ w u b 2 a p 2 a p l c 4 when the particle moving near the rigid boundary l c is the characteristic length and fl is inversely proportional to distance to the rigid boundary their results are of important reference value in quantifying the lateral repulsive force between particles and rigid boundary the stem though the experimental situation was quite different from present study because of similar mechanisms of f l and lateral fluid drag acting on particle the former is integrated to the latter and considered into the lateral deviation of particle both of which depend directly on the distribution of attached lateral velocity around the upstream half of the stem in a real flow separation occurs on the upstream half of stems and the inviscid solution may be a reasonable approximation to the real flow there thus the attached lateral velocity can be approximately u y a 2 u b x y a s 2 x 2 y 2 2 in terms of the outmost trajectories fig 2 path ⅰ denotes the shortest route or minimum u ya the particle experiences and path ⅱ denotes the longest route or maximum u ya the particle experiences the presupposed particle trajectory is between paths ⅰ and ⅱ and corresponding attached lateral velocity the particle experiences is weighted value of both herein a power law function with variable ξ is proposed to describe the weighted value 9 u y a k 1 u b ξ a s k 2 where k 1 and k 2 are scale and shape parameters respectively and k 2 varies according to different downstream particle trajectory as shown in fig 3 three dotted lines k 2 0 6 1 2 denote different potential particle trajectories intuitively the greater value of k 2 suggests that the outmost trajectory will be much closer to path ⅱ and the smaller value of which will be much closer to path ⅰ analogous to definition of palmer et al 2004 herein the evaluation of inertial impaction for floating particle is defined as the ratio of the stopping distance to stem radius 10 s t f a r 2 ρ r r d 9 δ a where a r is particle to stem ratio ρ r is the specific gravity of particle and δa is the area submergence or the ratio between the submerged and whole projected area of the particle a classical kinematic equation is established for particles to evaluate the deviation effect in rectangular coordinates which is 11 m p d 2 ξ d t 2 1 2 ρ w a p c d p u y s 2 m p d 2 x d t 2 1 2 ρ w a p c d p u x s 2 where u ys and u xs are y and x components of the slippage velocity between the particle and fluid parcels m p is the mass of a particle and m p 4 π a p 3 ρ p 3 a p δ a π a p 2 and the c dp is the drag coefficient for the floating particle in turbulent fluids before the collision occurs with regard to the outmost trajectory of the downstream particle approaching the stem x component of the slippage velocity between the particle and fluid parcels is close to zero i e uxs 0 meanwhile due to the elapse time from entering the deviation effect region ξ 0 x 5as t 0 to colliding with the stem ξ l d x a s t t e is relatively short u ys is approximately equal to u ya combining with eq 9 and 11 can be rearranged as 12 m p d 2 ξ d t 2 3 δ a 8 a p ρ w ρ p c d p u b 2 k 1 2 ξ a s 2 k 2 m p d 2 x d t 2 1 2 ρ w a p c d p u x s 2 as previously discussed by liu et al 2019 the specific gravity of particle may be interpreted as the relative submergence volume when the particle floats on the water surface as a particle approaches the stem if the lateral deviation distance is less than l d when reaching the position x a s the particle will collide with the stem thus the boundary condition on eq 12 is given as 13 t 0 ξ 0 d ξ d t 0 t t e ξ l d u y a 0 5 u b therefore the solution to eq 12 is 14 l d 3 a s c d 4 a r δ a δ v 2 k 2 4 2 k 2 1 3 a dimensionless shape coefficient γ δ a δ v is proposed for a floating particle herein with δ v the ratio between the submerged and total volume which is negatively and positively correlated with the density and sphericity of particles respectively as flow velocity increases the deviation effect will be more significant thus the collision efficiency η depends on the rate of particle inertia and the deviation effect and can be described as 15 η b s 2 a s l d s 2 3 wake trapping model after a particle collides with a stem the velocity of the particle instantaneously drops to zero subsequently the particle slips into the wake behind the stem and finally drift into the free stream the time that a particle spends during the whole collision process along the longitudinal length of the free stream is defined as retention time each particle will experience a varying number of collisions i e temporary trappings as it passes through the array of stems and the retention time of temporary trapping is random and described by a probability distribution model thus both the number of collisions and the corresponding retention time are random variables that determine d l for stems that are uniformly distributed with nearly identical trapping performance any two collision events are not linked and the probability distribution of the retention time for collision events is memoryless defina and peruzzo 2010 the large scale behavior of retention time due to collisions obeys the exponential distribution and relates to the angle of particles enter the retention zone which was verified in numerical experiments ziemniak et al 1994 and laboratory studies defina and peruzzo 2010 as r d increases rd 300 the steady recirculation vortex behind the stem begins to shed and turbulence gradually contributes to the downstream wake within the array of emergent stems kiya et al 1980 suggested the transition from laminar to turbulent wake structure may be delayed tord 200 for conditions of fully developed turbulence form drag between upstream and downstream sides of the stem due to turbulent wake structure dominates the drag force acting on the stem thom 1933 it follows that the bulk drag coefficient is assumed to be positively related to the characteristic velocity deficit and length scale of wakes to evaluate the effect of turbulence wake on retention time the velocity deficit u f in the wake should be quantified the measured velocity profiles along the center line of the wake converge well to accepted wake theory zdravkovich 1997 16 u f u b 5 c ds a s 81 β 2 x 0 5 whereβ o 1 is a correction coefficient and herein the velocity deficit u f along the centerline of the wake is used to assess the acceleration of a collided particle in the wake the u f 1 is plotted as a function of x in fig 4 and the time a particle resides in the wake regions mainly for the intermediate wake region is given by the integral from x 0 to x 2c ds as 3β 2 corresponding to uf ub 30 which is defined as the marginal value of the intermediate wake region zavistoski 1994 and represents the distribution feature of velocity deficit in whole wake 17 t a x 0 x 2 c ds a s 3 β 2 81 β 2 5 c ds a s x u b d x 4 2 15 c ds a s u b β 2 the time t a can be regarded as a parameter to evaluate the effect of turbulence wake on retention time i e τ 0 ta c ds as ub eq 17 is commensurate with predictions from dimensional considerations alone after the collision occurs the downstream particles will accelerate from zero to the bulk transport velocity within the wake region in the case of qualitative analyses of the acceleration particle inertia the mass or specific gravity and area of the intermediate wake are positively correlated with the retention time and the larger stems produce larger wake scale i e τ 0 ρ r a r thus τ0can be written as τ 0 c ds as ub ρ r ar and c ds as ub ρ r ar is defined as the retention parameter to define the retention time of an isolated collision event the trajectory of a particle within the array of stems is divided into two segments or the delayed and smooth transport segments see fig 5 the t de is the time spent by the particle to pass through the length of the delayed transport segment l de the u sm is the particle transport velocity in the smooth transport segment across gaps among stems if no interactions with the vegetation occur the retention time during an isolated collision eventτ0can now be described as 18 τ 0 t d e l d e u s m this completes the derivation of τ 0 and η from what is known about inertial particle flow past an isolated cylinder at moderate to high reynolds number using the derived models for τ 0 and η the proposed formulation for d l is now compared against experiments 3 experimental method laboratory experiments were conducted in a rectangular flume that is 18 m long 1 0 m wide and 0 5 m deep with glass walls to permit optical access to maintain an approximately uniform flow rate in the flume a tailgate located at the exit of the flume was used the recirculating flow rate q was measured by an electromagnetic flowmeter the bulk velocity u b was calculated as the ratio of q to flowing area within the array a uniform array of rigid clean cylindrical wooden dowels with diameter of 0 6 cm and height of 25 cm were used to represent the canopy the cylinders were uniformly inserted on polyvinyl chloride boards to create a test section that was 4 m long wooden sphere of different sizes radii set to 0 4 cm 0 3 cm and 0 2 cm were used to represent buoyant seeds all particles were evenly painted with white dye to improve image tracking capabilities the cylinders protruding out of the water surface were small enough less than 3cm so that trapped particle cannot cover the image during recording for each experiment a total of sixty particles were released one by one 50 cm upstream of the test section see fig 6 and at random positions in the transverse direction all the experimental runs were recorded by a digital camera sampling frequency is 25 hz mounted over the flume and can move left or right to alter recording position as shown in table 1 two sets of experiments were performed to test different aspects of the model one set fixes the stem density but varies the bulk velocity the other set varies the stem density but fixes the bulk velocity setup labeled a1 to a7 use seven different u b ranging from 0 065 to 0 219 m s for a fixed stem density of 1366 m 2 the bulk velocity this setup was intended to explore the effect of flow velocities on the collision efficiency between particles and the stem setup labeled b1 to b4 includes four different stem density n s ranges from 554 to 1164 m 2 and used particle sizes a p 0 3 cm but a fixed bulk velocity u b 0 113 ms 1 this setup was intended to explore the effect of stem densities on d l of floating particle by analyzing the recorded video of particle tracking using the video analysis software image pro plus 6 0 media cybernetics silver spring usa particle trajectories within the monitoring window see fig 6 were analyzed the number n i of measured collision events were determined from stable decelerating process and minimal particle velocity approximate to zero the bulk transport velocity of the particle u p can also be directly determined the bulk transport velocity of the particle u p can also be directly determined as a particle passes through the array of stems the total number of interaction points nt using the measured path length x is n t 1 x s 1 thus the measured collision efficiency η can be estimated as follows 19 η n i 1 x s 1 4 result and discussion 4 1 collision efficiency in this study a kinematic model was used to describe the collision and quantify the relation between the collision efficiency and the flow velocity and particle characteristics runs b1 b7 are to be used for exploring the performance of the proposed model with measured collision events within the image monitoring area and using eq 19 the collision efficiency can be obtained and plotted as a function of u b as shown in fig 7 η reduces as u b increasing and basically meet the negative logarithmic relationship defina and peruzzo 2012 suggested that the collision efficiency is likely to be independent of vegetation pattern and density liu et al 2018 further developed the model and concluded that η depends mainly on the flow velocity and particle physical characteristics the shape parameter k 2 can now be determined by combining the data of η u b pairs with eqs 12 14 the results are featured in figs 7 and 8 as shown in fig 8 and discussed in section 2 2 k 2 has a significant linear correlation with the inverse of s tf s tf 1 the intercept and slope of curves depend on volume effect specifically a r for wooden spheres of different sizes multiparameter nonlinea fitting is used to obtain the empirical formula of k 2 with r d 20 k 2 163 a r r d 1 713 a r the slope denotes effect of volume effect on the deviation of trajectories the larger particle means more significant deviation predictably k 2 becomes a small constant as a r decreases to 0 1 comparison between calculated from eq 20 and measured k 2 is presented in fig 9 with coefficient of determinationr 2 0 988 as the importance of inertial impaction increases i e a larger value of s tf for floating particle the outmost trajectories of collided particles will gradually divert close to path ⅱ fig 3 and the dominant deviation effect will make downstream particles much easier to escape away from stems one could speculate that outmost trajectories of collided particles become consistent with path ⅱ as u b becomes large r d 1800 estimated by the varying tendencies of η and u b and the collision efficiency tends to be a small constant and only depends on length scale of the stem and particle 4 2 retention time when processing the particle trajectories using eq 18 the measured retention time can be obtained the retention time of a collision free particle subject to temporal and spatial heterogeneity of the surface velocity around the stem was short enough to be ignored recorded particle trajectories within the array of stems were also divided into two segments delayed due to stem collision and smooth transport segments see fig 5 however this finding cannot apply to particles where capture events due to capillarity cannot be negligible for downstream floating particles the retention time of an isolated collision event depends on the collision angle φ defined as the angle between the line connecting initial collision point and the center of the stem and the flow direction and the maximum of which φ m corresponding to the outmost trajectory leading to collision determines the scale of the retention time distribution see fig 10 and a larger φm denotes a greater transport velocity deficit the particle experiences when the particle is attracted toward the stem due to surface tension at low velocity collision angle φ ranges from 0 to π and φm π 2 the particle will slip into the backflow region and the retention time varies substantially defina and peruzzo 2012 suggested that the distribution of retention time was exponential and divided this distribution into long and short parts and the proportion of long parts decreases with decreasing flow velocity for which we speculate the delineating factor for the two parts was the separation angleϕs that is ϕ ϕswas associated with the long part where the inelastic collided particle will slip into the backflow wake region under the action of the shear flow and lossless surface tension and be trapped in the form of quasiperiodic vibration and the opposite was true for the short part where the particle enters the intermediate wake region along the edge of the backflow under the action of the backflow and lossy surface tension with the flow velocity increasing the inertia effect of the particle becomes dominant r d 300 and φm gradually reduces toφ m π 2 at this point the retention time is attributed to mechanical collision and transport velocity deficit in the wake with short retention time of a collision free particle ignored the distribution of retention times has a short tail concentrated at the mean valueτ0 as discussed in section 2 3 τ0is proportional to the velocity deficit u f in the wake and the bulk drag force due to the stem is associated with u f the drag coefficient c ds for emergent vegetation has been extensively studied e g schlichting and gersten 1982 kothyari et al 2009 liu and zeng 2017 liu and zeng 2017 collected and analyzed data from the literature and suggested that c ds depends on r d and proposed an empirical formula with other factors fixed as shown in fig 11 τ0 exponentially decreases with increasing r d in a manner similar to relations between parameter c ds as ub and r d with c ds proposed by liu and zeng 2017 these findings are consistent with the prediction in section 2 3 as the dotted line shown in fig 11 the more massive particle will take longer time in an isolated collision event under the similar flow velocity i e τ0 0 4 cm τ0 0 3 cm τ0 0 2 cm they require a longer time to regain the mean transport velocity once it is slowed down or arrested by the stem with further data processing τ0appears to be positively related to the retention parameter c ds as ub ρr ar see fig 12 however there is an exception for r d 387 attributed to the effect of surface tension on trapped particle still exist as already reported peruzzo et al 2012 peruzzo et al 2016 liu et al 2018 the capture probability was estimated as the order of magnitude of 10 2 for r d 500 thereby the effect of surface tension on isolated capture event can be ignored particles are observed to be permanently captured τ0 10 min for r d 387 case run b1 the linear relation between c ds as ub ρr ar and τ0 after eliminating outliers can be described as 21 τ 0 3 215 c ds a s u b ρ r a r 0 034 with r 2 0 93 in the present experiments the measured u p within the stem density n s 1366 m 2 is significantly greater than u b consistent with the blockage effect and considering up 0when ub 0 u p can be described by a linear function with zero intercept as shown in fig 13 u p of low flow velocity a1 and a2 does not well conform with the linear relationship this is because the decelerating effect of surface tension compared with the blockage effect on downstream particle can not be ignored though the linear relationship for moderate to high flow velocity is acceptable with eliminating outliers for low flow velocities the slope of relationship curves decreases as a p increasing smaller particles are more sensitive to the blockage effect and may obtain greater transport velocity the reason for which is the smaller moves along the preferential path with higher lateral average constricted cross section velocity after collision with a stem particles move into the intermediate wake region the lateral velocity induced by stems will drive particles out of the intermediate wake and then into the free stream the presence of the stem results in a local increase in the velocity around it and a streamwise velocity gradient in lateral direction is generated which results in particles having a preference for drifting toward the higher flow regions among stems due to the lateral pressure difference therefore the measured u p will be significantly greater than u b and affected by stems density another reason may be due to the free surface velocity being slightly larger than the depth averaged velocity as shown in fig 14 the increment between particle transport and bulk flow velocity δu up ub is larger for smaller floating particles i e the smaller particle is more sensitive to the blockage effect under the similar density moreover δu is noticed positively correlated to the stem density fig 14 and can be reasonably fitted by a power relation 22 δ u 244 λ 1 88 u b with r 2 0 998 in fact the decrement of particle transport velocity due to collision is significantly less than the increment due to the blockage effect δu will steadily increase as λ increases until the center to center space between adjacent stems is approximately less than 4a p 4 3 longitudinal dispersion coefficient within the array of emergent stems stem scale and depth scale dispersion dominate the total longitudinal dispersion and the motion of floating particles stays in the horizontal plane depth scale dispersion can be ignored the magnitude of longitudinal dispersion within vegetated canopies has been very well studied e g nepf et al 1997 white and nepf 2003 lightbody and nepf 2006 for sparse canopies λ 0 1 stem scale dispersion results primarily from velocity heterogeneity due to the presence of stems and white and nepf 2003 the corresponding dispersion coefficient as 23 k l 1 2 c d 1 3 u b d s for denser canopies λ 0 1 stem scale dispersion will be dominated by the trapping and release of mass within the boundary layers and wakes of individual cylinders murphy 2006 approximated the stem scale dispersion at r d 40 by 24 k l 5 λ u b d s in present work the derivation process of d l is built on spherical particle moreover the irregularity of particles and corresponding kinetic difference are taken into consideration in the form of parameters δ a δ v γ and s tf thus the model can be generalized to seed particles in nature combining the semiempirical formulas of τ0and η with eq 4 the longitudinal dispersion coefficient d l can be semiempirically modeled and plotted as a function of r d ranges from 0 to 1500 in fig 15 and can well describe the experimental data the stem density adopted in this study is less than 0 1 the corresponding dispersion coefficient of eq 23 is also plotted in fig 15 as shown in fig 15 the dispersion coefficient of solute particles eq 23 is significantly smaller than dispersion coefficient of floating particles the root of this difference is various dynamic characteristics of particle and applying mechanically the dispersion coefficient of solute particles to dispersal model of floating seeds is not appropriate within the eulerian framework the time spent by particles from 0 5m downstream of the front end of the vegetated test section to reach the fixed cross sections 3 5m and we use these data to construct the cumulative arrival time distributions which is used to validate the model fig 16 shows comparison between measured and modeled results of cumulative arrival time distributions for runs a1 a7 the results are satisfactory the d l increases with an increase in r d which may be due to the contribution of mechanical dispersion becoming weaker with increasing u b and the delayed transport in wake region behind the stem becoming dominant moreover d l deserves a higher value for smaller particles however τ0and η become much less for small particles we can surmise that d l of floating particles is more sensitive to the blockage effect with the increase in stem density the increment of η and u p becomes more significant than the decrement in c ds from the wake interference or sheltering nepf 1999 hence d l increases with stem density due to more effective mechanical dispersion and this issue deserves future investigation through the proposed semiempirical model of longitudinal dispersion the rules of transport of floating seeds in vegetated aquatic flows can be investigated and we suggest that the results are of great significance to ecological restoration or restoration of riparian and wetland systems harnessing farmland weeds and even preventing invasion of exotic aquatic plant species especially for riparian aquatic and wetland systems and modeled results full line 5 conclusions two key mechanisms responsible for floating particle dispersal in fast moving flow within emergent vegetation have been studied these mechanisms include collisions between a particle and stems mechanical dispersion and subsequent wake trapping effect wake turbulence dispersion these two mechanisms differ from previous studies in slow moving flow where surface tension played a leading role in particle capture by vegetation a theoretical model of longitudinal dispersion based on a collision representation with appropriate length scales is proposed to describe the downstream transport process of floating seeds within the array of stems the model leads to an algebraic expression between longitudinal dispersion collision efficiency η between particles and the stem and retention time τ 0 for usability parameterizing η and retention time as a function of flow variables such as bulk velocity canopy properties and particle physical properties are necessary the kinematic model is established with potential flow theory to predict the collision efficiency between the particle and the stem to a first approximation the overall time particles reside in the wake is defined on the basis of an isolated collision event and shown to be positively correlated with the bulk drag coefficient and relative radius of stems using a simplified wake theory the distribution of retention times was shown to be related to the collision angle which may explain the superposition of two distribution relations proposed by defina and peruzzo 2012 the increment between particle transport and bulk flow velocity has a positive correlation with the blockage effect among stems and increases exponentially with increased stem density beside smaller particles can be considered more sensitive to the blockage effect and obtain greater transport velocity by comparison present semiempirical formula of d l can well describe the experimental data and the dispersion coefficient of solute particles is significantly smaller than dispersion coefficient of floating particles the root of the difference is various dynamic charateristics of particle to pursue the collision events further only a dense stems array n s 1366 m 2 was used for the dispersal process which means that the effect of stem density on the retention time is not varied increasing λ influences c ds as expected as well as the width of the wake zdravkovich 1997 thus further studies on the dependence of λ on τ 0 are needed and the application of the present theoretical model will be further evaluated in future studies credit authorship contribution statement xiaoguang liu conceptualization methodology formal analysis resources investigation writing original draft writing review editing validation yuhong zeng methodology formal analysis writing review editing supervision funding acquisition project administration gabriel katul methodology formal analysis writing review editing supervision wenxin huai formal analysis writing review editing yu bai writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the authors declare the following financial interests personal relationships which may be considered as potential competing interests acknowledgment y zeng acknowledges support from national natural science foundation of china 51879197 51622905 and 51439007 and support from the overseas expertise introduction project for discipline innovation 111 project funded by ministry of education and state administration of foreign experts affairs p r china b18037 g katul acknowledges support from the u s national science foundation nsf ags 1644382 and nsf ios 1754893 
419,the effect of emergent stems on the transport of downstream floating particles e g buoyant seeds is explored theoretically and experimentally at moderate to high reynolds number r d 2 u b a s υ 300 in an open channel where u b is the bulk velocity a s is stem radius and ν is the kinematic viscosity longitudinal dispersion d l of such seeds is shown to be given by d l u p 3 τ 0 2 η 1 η 2 s 1 η τ 0 u p thereby requiring the bulk transport velocity of particles u p spacing between canopy elements s 1 collision efficiency η between a particle and the stem and a wake trapping time scale τ 0 linkages between u p and u b and terms η and τ 0 are then derived using inhomogeneous flow characteristics adjacent to the stem with physical properties of particles a semiempirical model with potential flow theory around the stem is introduced to estimate η whereas τ 0 is shown to be related to the bulk drag coefficient and radius of stems the d l is experimentally determined across a wide range of r d and particle sizes and shown to be in good agreement with the proposed model calculations keywords floating seed emergent vegetation hydrochory seed vegetation collision dispersion mechanism longitudinal dispersal 1 introduction seed dispersal by water hydrochory sets a spatial template for the spread structure and survival of many aquatic plants nilsson et al 1994 merritt and wohl 2006 defina and peruzzo 2010 cunnings et al 2016 liu et al 2018 it is one of the main processes responsible for regeneration and self sustaining rehabilitation of riparian ecosystems schneider and sharitz 1988 dewoody et al 2004 hyslop and trowsdale 2012 dispersal by wind anemochory has received significant research attention and mathematical treatment e g okubo and levin 1989 greene and johnson 1996 clark et al 1998 levine 2003 katul et al 2005 nathan et al 2011 duman et al 2016 however hydrochory has received disproportionately less attention one complication arising in hydrochory that is absent in anemochory is the need to distinguish between non buoyant and buoyant seeds buoyant seeds can be transported through the combined action of flowing water surface waves and even surface wind nilsson et al 1994 many aquatic plant seeds have the ability to float meaning that an extended floating time enhances dispersal distances by mean advection danvind and nilsson 1997 nilsson et al 2010 riis and sand jensen 2006 a number of models use empirical or semi empirical approaches to describe seed transport in the form of a so called dispersal kernel groves et al 2009 shi et al 2020 dispersal kernels represent the probability of finding a seed at some finite distance from the parent source empirical approaches describe plausible mathematical shapes for the dispersal kernel that are then used to predict distribution of herbaceous plants and their communities levine 2003 mechanistic approaches such as the semi empirical gaussian plume equations have also been used to describe dispersal kernels using mean velocity and hydraulic geometry as variables groves et al 2009 the outcome from such models is that the majority of seeds deposit near the release point but few seeds can spread over long distance highlighting the possibility of long distance dispersal by a small number of seeds these results have been used to justify the differing dispersal patterns of short and long distance transport from parent source of seeds as has been observed in wind dispersal studies nathan et al 2002 another mechanism that can lead to differing dispersal patterns near and far from the parent source or release point is vegetation capture or trapping floating seeds can be captured temporarily or permanently by vegetation and mathematical models accommodating such capture are now beginning to receive theoretical and experimental attention defina and peruzzo 2010 proposed a stochastic model to describe the transport and diffusion of floating particles and the trapping mechanisms by emergent flexible vegetation with varied plant density they adopted a weighted combination of two exponential distributions to predict the distribution of particle retention time defina and peruzzo 2012 these two distributions were intended to reflect retention time differences for short and long duration trapping events furthermore peruzzo et al 2012 investigated the effect of surface tension on the fate of floating particles dispersal in open channel flows with emergent vegetation at low reynolds number and confirmed the effectiveness of such a weighted scheme liu et al 2018 further explored the mechanisms responsible for floating particles dispersal in slow moving flow with emergent vegetation by combining kinematic and statistical models of particle stem interactions these prior efforts primarily dealt with particle collision and trapping by stems due to surface tension at low flow velocity analogous to a small weber number e g peruzzo et al 2012 liu et al 2018 however for moderate to high reynolds numbers surface tension between stems and particles may be small and even ignored i e high weber number dispersal mechanism of such floating particles and corresponding particle stem interaction at moderate to high reynolds numbers have rarely been investigated however which may terminate long distance transport and change the fate of floating seeds within vegetated riverway the work here attempts to fill this knowledge gap through novel theories and flume experiments the focus is on the interaction between floating particles and emergent stems in fast moving free surface flows in which collision and trapping events exist but not due to surface tension when passing through an array of stems at moderate to high reynolds number the trajectory of a floating particle is impacted by a number of flow features i the particle transport velocity u p is significantly larger than the bulk flow velocity u b due to the so called blockage effect which was first proposed by maskell 1963 and developed by zdravkovich 2003 ii the stems generate wake turbulence and mechanical dispersion that distort the particle trajectory from streamlines set by the mean flow in the vicinity of the stem iii the stems modify particle trajectory when a collision occurs that can lead to rebound or trapping these mechanisms form the basis of a newly proposed model for floating particle dispersion in uniformly distributed array of emergent rigid stems the main novelties of the proposed approach include a semiempirical kinematic model with potential flow theory to estimate the probability of collision between particles and the stem and a retention time model based on wake theory following an isolated collision event by combining with classical theories of blockage effects within an array of cylinders we can arrive at a formulation for the longitudinal dispersion coefficient of floating particles at high reynolds number by dispersion coefficient we mean the coefficient that describes the spatial spread of a cloud of particles over a sufficiently long time interval as conventional in lagrangian particle studies fischer 1973 moreover it is to be noted that dispersal mechanism within the array of stems of floating seeds differs from the well studied solute particles e g chemical contaminant biological hormone and suspended fine particles e g sediments i e surface effect hydrodynamic processes that occur at a free water surface e g wind drag and surface tension effects and volume effect inertial impaction sidewise repulsion due to asymmetric attached lateral velocity induced by stems acting on floating particles and lateral pressure on the side away from the centre of stem volume effect can be significant for floating seeds but not necessarily for small grains or sediments accordingly the length scale ratio between floating seeds and partices are expected to become a dynamically significant factor primarily because of volume effect and surface effect 2 theoretical model to explore the canonical aspects of floating seed dispersion for emergent canopy flow at high reynolds number the flow is assumed to be steady and uniform with the water surface not subjected to any wind stresses or wave action the vegetation covering the channel bottom is composed of a honeycomb stem arrangement fig 1 the stems are rigid cylindrical in shape with radius a s and are characterized by a uniform stem density ns defined by the number of stems per unit ground area or the solid area fraction λ π n s a s 2 wooden spherical particles are used to represent the floating seeds for consistency with prior experiments defina and peruzzo 2010 peruzzo et al 2012 and liu et al 2018 for the arrangement in fig 1 two distances are pointed out the center to center spacing between adjacent stems s 1 n s and the length of each segment in the direction of the mean flow s 1 0 5 3 n s see fig 1 2 1 longitudinal dispersion the dispersal of floating particles within such a stem array is anisotropic and is determined by two mechanisms wake turbulence and mechanical dispersion nepf et al 1996 in fig 1 two floating particles a and b starting at the same position will migrate within the stem array along different trajectories and experience longitudinal separation during a fixed time interval particles traversing a distance s 1 in the direction of the flow may collide with a stem with the collision efficiency η defined as the ratio of upstream width of particles colliding with the stem to the center to center spacing between adjacent stems after the collision a particle encounters a backflow region and resides in the wake for some time and then it moves into an intermediate wake region let τ 0 be the mean retention time due to an isolated collision and temporary wake trapping event compared to no collision case define nt as the total number of segments a particle passes through the entire vegetated patch and ni as the total number of collisions a particle experiences after crossing nt segments by definition the entire length of the vegetated patch is n t s 1 the total retention time a particle experiences while passing through the entire vegetated patch length isτ r τ0 ni thus the probability distribution function of τ r labeled as q τ r when a particle traverses the total distance n t s 1 is 1 q τ r c 0 τ 0 η n i 1 η n t n i where c 0 is the binomial coefficient the probability of τ r is based on a binomial distribution with a mean time and a variance σ t 2 τ 0 2 n t η 1 η as discussed elsewhere defina and peruzzo 2010 when a cloud of particles is released at the same position the total time that the cloud of particles experiences longitudinal separation is 2 t m n t s 1 u p n t η τ 0 where u p is the bulk transport velocity of the particle the first term in eq 2 describes the absence of collision and wake distortion scenario whereas the second term accommodates the collision and wake trapping effects on the overall travel time thus the longitudinal spatial variance of the cloud can be estimated as 3 σ l 2 u p 2 σ t 2 u p 2 τ 0 2 n t η 1 η at very long times the longitudinal dispersion of the cloud will converge to a fickian diffusion by the central limit theorem so that the longitudinal spatial variance of the cloud grows linearly with t m under those asymptotic conditions the longitudinal dispersion coefficient can be defined from σ l 2 2 d l t m rutherford 1994 or 4 d l σ l 2 2 t m u p 3 τ 0 2 η 1 η 2 s 1 η τ 0 u p to estimate dl requires determining parametersτ0and η as well as links between bulk velocity u b and particle transport velocity up in the applications of dimensional analysis identifying all the variables impacting the sought quantity is the most challenging step katul et al 2019 herein it is instructive to ask to what degree can τ 0 and η be predicted from dimensional analysis that is the list of plausible variables impacting τ 0 may include processes relevant to inertial impaction the buoyancy of the particles and the size of the wake zone trapping the particle hence this plausible list leads to 5 τ 0 f 1 u b a p a s l w ρ p ρ w where f 1 is an unknown function to be determined a p and as are the particle and stem radius respectively arising from inertial impaction ρ p andρ w are densities of the particle and water arising from buoyancy l w is length scale of the wake zone combined with u b can be used to form a characteristic trapping time scale in the wake zone behind the stem introducing the following dimensionless groups a r a p a s and ρ r ρ p ρ w dimensional analysis alone can be used to reduce the list of variables to 6 τ 0 a r m 1 ρ r m 2 l w u b here dimensional analysis cannot determine the exponents m 1 and m 2 the length scale of the wake zone l w is further impacted by the wake generation process so thatlw ascds with c ds being the bulk drag coefficient of the stem eq 6 can then be rearranged as 7 τ 0 c d s a r m 1 ρ r m 2 a s u b likewise the collision efficiency η must at minimum depend on the spacing between the interfaces of stem elements i e s 1 as and the size of the particle passing between these stem elements these two distances can be combined to yield 8 η 2 a p s 1 a s the proposed model next aims at describing τ 0 and η using what is known about the flow field around cylinders which can then be used in conjunction with eq 4 to predict d l 2 2 collision model at low reynolds number the collision efficiency η primarily depends on the acceleration caused by surface tension that draws floating particles toward stems as the bulk flow velocity increases the effect of particle inertia caused by advection will be dominant in a collision with stems similar to liu et al 2018 the weber number w b 2 ρ w u b 2 a p σ with σ as the surface tension is introduced to assess the vegetated water bodies for the small scale issue of floating particles when w b 1 the effect of surface tension on interactions between floating particles and emergent stems can be ignored in a flow through a dense population of emergent stems the blockage effect will also alter the flow around a stem it was found that the presence of the stem reduces the cross sectional area locally and results in a concomitant increase in the velocity around the body in relation to the bulk flow velocity zdravkovich 1997 in a flow through a dense population of emergent stems streamlines become circuitous as they bend and branch around the stem nepf et al 1997 a downstream floating particle approaching a stem will be subject to a lateral acceleration that acts to push the particle away from the stem the acceleration is caused by lateral velocity difference between particles and attached lateral velocity due to fluid parcels are displaced laterally by the presence of stems in the corresponding cross sections the frequency of random events that directly collided particles are pushed away from stems are called deviation effect britter et al 1979 measured turbulence around a circular cylinder and discussed how streamlines and turbulence are distorted relative to the upstream state the most pertinent result from this analysis is that there exist a region of vorticity distortion near the cylinder surface that is roughly 5a s in this region distortions from the free streamlines became apparent and the attached lateral velocity has a significant effect on the transport of particle thus a circular region with a radius of 5a s can be used to delineate the zone sensing such deviation effects see fig 2 let l r and l d be defined as lateral lengths of direct collision and the deviation effect respectively considering downstream particles initially entering the deviation effect region and defining a variable ξ y l r l d a semiempirical kinematic model can be developed to determine this acceleration based on numerical simulations in a confined pipe at a microfluidic scale di carlo et al 2009 describes the lateral repulsive force acting on particle due to asymmetrical distribution of flow velocity and pressure as f l ρ w u b 2 a p 2 a p l c 4 when the particle moving near the rigid boundary l c is the characteristic length and fl is inversely proportional to distance to the rigid boundary their results are of important reference value in quantifying the lateral repulsive force between particles and rigid boundary the stem though the experimental situation was quite different from present study because of similar mechanisms of f l and lateral fluid drag acting on particle the former is integrated to the latter and considered into the lateral deviation of particle both of which depend directly on the distribution of attached lateral velocity around the upstream half of the stem in a real flow separation occurs on the upstream half of stems and the inviscid solution may be a reasonable approximation to the real flow there thus the attached lateral velocity can be approximately u y a 2 u b x y a s 2 x 2 y 2 2 in terms of the outmost trajectories fig 2 path ⅰ denotes the shortest route or minimum u ya the particle experiences and path ⅱ denotes the longest route or maximum u ya the particle experiences the presupposed particle trajectory is between paths ⅰ and ⅱ and corresponding attached lateral velocity the particle experiences is weighted value of both herein a power law function with variable ξ is proposed to describe the weighted value 9 u y a k 1 u b ξ a s k 2 where k 1 and k 2 are scale and shape parameters respectively and k 2 varies according to different downstream particle trajectory as shown in fig 3 three dotted lines k 2 0 6 1 2 denote different potential particle trajectories intuitively the greater value of k 2 suggests that the outmost trajectory will be much closer to path ⅱ and the smaller value of which will be much closer to path ⅰ analogous to definition of palmer et al 2004 herein the evaluation of inertial impaction for floating particle is defined as the ratio of the stopping distance to stem radius 10 s t f a r 2 ρ r r d 9 δ a where a r is particle to stem ratio ρ r is the specific gravity of particle and δa is the area submergence or the ratio between the submerged and whole projected area of the particle a classical kinematic equation is established for particles to evaluate the deviation effect in rectangular coordinates which is 11 m p d 2 ξ d t 2 1 2 ρ w a p c d p u y s 2 m p d 2 x d t 2 1 2 ρ w a p c d p u x s 2 where u ys and u xs are y and x components of the slippage velocity between the particle and fluid parcels m p is the mass of a particle and m p 4 π a p 3 ρ p 3 a p δ a π a p 2 and the c dp is the drag coefficient for the floating particle in turbulent fluids before the collision occurs with regard to the outmost trajectory of the downstream particle approaching the stem x component of the slippage velocity between the particle and fluid parcels is close to zero i e uxs 0 meanwhile due to the elapse time from entering the deviation effect region ξ 0 x 5as t 0 to colliding with the stem ξ l d x a s t t e is relatively short u ys is approximately equal to u ya combining with eq 9 and 11 can be rearranged as 12 m p d 2 ξ d t 2 3 δ a 8 a p ρ w ρ p c d p u b 2 k 1 2 ξ a s 2 k 2 m p d 2 x d t 2 1 2 ρ w a p c d p u x s 2 as previously discussed by liu et al 2019 the specific gravity of particle may be interpreted as the relative submergence volume when the particle floats on the water surface as a particle approaches the stem if the lateral deviation distance is less than l d when reaching the position x a s the particle will collide with the stem thus the boundary condition on eq 12 is given as 13 t 0 ξ 0 d ξ d t 0 t t e ξ l d u y a 0 5 u b therefore the solution to eq 12 is 14 l d 3 a s c d 4 a r δ a δ v 2 k 2 4 2 k 2 1 3 a dimensionless shape coefficient γ δ a δ v is proposed for a floating particle herein with δ v the ratio between the submerged and total volume which is negatively and positively correlated with the density and sphericity of particles respectively as flow velocity increases the deviation effect will be more significant thus the collision efficiency η depends on the rate of particle inertia and the deviation effect and can be described as 15 η b s 2 a s l d s 2 3 wake trapping model after a particle collides with a stem the velocity of the particle instantaneously drops to zero subsequently the particle slips into the wake behind the stem and finally drift into the free stream the time that a particle spends during the whole collision process along the longitudinal length of the free stream is defined as retention time each particle will experience a varying number of collisions i e temporary trappings as it passes through the array of stems and the retention time of temporary trapping is random and described by a probability distribution model thus both the number of collisions and the corresponding retention time are random variables that determine d l for stems that are uniformly distributed with nearly identical trapping performance any two collision events are not linked and the probability distribution of the retention time for collision events is memoryless defina and peruzzo 2010 the large scale behavior of retention time due to collisions obeys the exponential distribution and relates to the angle of particles enter the retention zone which was verified in numerical experiments ziemniak et al 1994 and laboratory studies defina and peruzzo 2010 as r d increases rd 300 the steady recirculation vortex behind the stem begins to shed and turbulence gradually contributes to the downstream wake within the array of emergent stems kiya et al 1980 suggested the transition from laminar to turbulent wake structure may be delayed tord 200 for conditions of fully developed turbulence form drag between upstream and downstream sides of the stem due to turbulent wake structure dominates the drag force acting on the stem thom 1933 it follows that the bulk drag coefficient is assumed to be positively related to the characteristic velocity deficit and length scale of wakes to evaluate the effect of turbulence wake on retention time the velocity deficit u f in the wake should be quantified the measured velocity profiles along the center line of the wake converge well to accepted wake theory zdravkovich 1997 16 u f u b 5 c ds a s 81 β 2 x 0 5 whereβ o 1 is a correction coefficient and herein the velocity deficit u f along the centerline of the wake is used to assess the acceleration of a collided particle in the wake the u f 1 is plotted as a function of x in fig 4 and the time a particle resides in the wake regions mainly for the intermediate wake region is given by the integral from x 0 to x 2c ds as 3β 2 corresponding to uf ub 30 which is defined as the marginal value of the intermediate wake region zavistoski 1994 and represents the distribution feature of velocity deficit in whole wake 17 t a x 0 x 2 c ds a s 3 β 2 81 β 2 5 c ds a s x u b d x 4 2 15 c ds a s u b β 2 the time t a can be regarded as a parameter to evaluate the effect of turbulence wake on retention time i e τ 0 ta c ds as ub eq 17 is commensurate with predictions from dimensional considerations alone after the collision occurs the downstream particles will accelerate from zero to the bulk transport velocity within the wake region in the case of qualitative analyses of the acceleration particle inertia the mass or specific gravity and area of the intermediate wake are positively correlated with the retention time and the larger stems produce larger wake scale i e τ 0 ρ r a r thus τ0can be written as τ 0 c ds as ub ρ r ar and c ds as ub ρ r ar is defined as the retention parameter to define the retention time of an isolated collision event the trajectory of a particle within the array of stems is divided into two segments or the delayed and smooth transport segments see fig 5 the t de is the time spent by the particle to pass through the length of the delayed transport segment l de the u sm is the particle transport velocity in the smooth transport segment across gaps among stems if no interactions with the vegetation occur the retention time during an isolated collision eventτ0can now be described as 18 τ 0 t d e l d e u s m this completes the derivation of τ 0 and η from what is known about inertial particle flow past an isolated cylinder at moderate to high reynolds number using the derived models for τ 0 and η the proposed formulation for d l is now compared against experiments 3 experimental method laboratory experiments were conducted in a rectangular flume that is 18 m long 1 0 m wide and 0 5 m deep with glass walls to permit optical access to maintain an approximately uniform flow rate in the flume a tailgate located at the exit of the flume was used the recirculating flow rate q was measured by an electromagnetic flowmeter the bulk velocity u b was calculated as the ratio of q to flowing area within the array a uniform array of rigid clean cylindrical wooden dowels with diameter of 0 6 cm and height of 25 cm were used to represent the canopy the cylinders were uniformly inserted on polyvinyl chloride boards to create a test section that was 4 m long wooden sphere of different sizes radii set to 0 4 cm 0 3 cm and 0 2 cm were used to represent buoyant seeds all particles were evenly painted with white dye to improve image tracking capabilities the cylinders protruding out of the water surface were small enough less than 3cm so that trapped particle cannot cover the image during recording for each experiment a total of sixty particles were released one by one 50 cm upstream of the test section see fig 6 and at random positions in the transverse direction all the experimental runs were recorded by a digital camera sampling frequency is 25 hz mounted over the flume and can move left or right to alter recording position as shown in table 1 two sets of experiments were performed to test different aspects of the model one set fixes the stem density but varies the bulk velocity the other set varies the stem density but fixes the bulk velocity setup labeled a1 to a7 use seven different u b ranging from 0 065 to 0 219 m s for a fixed stem density of 1366 m 2 the bulk velocity this setup was intended to explore the effect of flow velocities on the collision efficiency between particles and the stem setup labeled b1 to b4 includes four different stem density n s ranges from 554 to 1164 m 2 and used particle sizes a p 0 3 cm but a fixed bulk velocity u b 0 113 ms 1 this setup was intended to explore the effect of stem densities on d l of floating particle by analyzing the recorded video of particle tracking using the video analysis software image pro plus 6 0 media cybernetics silver spring usa particle trajectories within the monitoring window see fig 6 were analyzed the number n i of measured collision events were determined from stable decelerating process and minimal particle velocity approximate to zero the bulk transport velocity of the particle u p can also be directly determined the bulk transport velocity of the particle u p can also be directly determined as a particle passes through the array of stems the total number of interaction points nt using the measured path length x is n t 1 x s 1 thus the measured collision efficiency η can be estimated as follows 19 η n i 1 x s 1 4 result and discussion 4 1 collision efficiency in this study a kinematic model was used to describe the collision and quantify the relation between the collision efficiency and the flow velocity and particle characteristics runs b1 b7 are to be used for exploring the performance of the proposed model with measured collision events within the image monitoring area and using eq 19 the collision efficiency can be obtained and plotted as a function of u b as shown in fig 7 η reduces as u b increasing and basically meet the negative logarithmic relationship defina and peruzzo 2012 suggested that the collision efficiency is likely to be independent of vegetation pattern and density liu et al 2018 further developed the model and concluded that η depends mainly on the flow velocity and particle physical characteristics the shape parameter k 2 can now be determined by combining the data of η u b pairs with eqs 12 14 the results are featured in figs 7 and 8 as shown in fig 8 and discussed in section 2 2 k 2 has a significant linear correlation with the inverse of s tf s tf 1 the intercept and slope of curves depend on volume effect specifically a r for wooden spheres of different sizes multiparameter nonlinea fitting is used to obtain the empirical formula of k 2 with r d 20 k 2 163 a r r d 1 713 a r the slope denotes effect of volume effect on the deviation of trajectories the larger particle means more significant deviation predictably k 2 becomes a small constant as a r decreases to 0 1 comparison between calculated from eq 20 and measured k 2 is presented in fig 9 with coefficient of determinationr 2 0 988 as the importance of inertial impaction increases i e a larger value of s tf for floating particle the outmost trajectories of collided particles will gradually divert close to path ⅱ fig 3 and the dominant deviation effect will make downstream particles much easier to escape away from stems one could speculate that outmost trajectories of collided particles become consistent with path ⅱ as u b becomes large r d 1800 estimated by the varying tendencies of η and u b and the collision efficiency tends to be a small constant and only depends on length scale of the stem and particle 4 2 retention time when processing the particle trajectories using eq 18 the measured retention time can be obtained the retention time of a collision free particle subject to temporal and spatial heterogeneity of the surface velocity around the stem was short enough to be ignored recorded particle trajectories within the array of stems were also divided into two segments delayed due to stem collision and smooth transport segments see fig 5 however this finding cannot apply to particles where capture events due to capillarity cannot be negligible for downstream floating particles the retention time of an isolated collision event depends on the collision angle φ defined as the angle between the line connecting initial collision point and the center of the stem and the flow direction and the maximum of which φ m corresponding to the outmost trajectory leading to collision determines the scale of the retention time distribution see fig 10 and a larger φm denotes a greater transport velocity deficit the particle experiences when the particle is attracted toward the stem due to surface tension at low velocity collision angle φ ranges from 0 to π and φm π 2 the particle will slip into the backflow region and the retention time varies substantially defina and peruzzo 2012 suggested that the distribution of retention time was exponential and divided this distribution into long and short parts and the proportion of long parts decreases with decreasing flow velocity for which we speculate the delineating factor for the two parts was the separation angleϕs that is ϕ ϕswas associated with the long part where the inelastic collided particle will slip into the backflow wake region under the action of the shear flow and lossless surface tension and be trapped in the form of quasiperiodic vibration and the opposite was true for the short part where the particle enters the intermediate wake region along the edge of the backflow under the action of the backflow and lossy surface tension with the flow velocity increasing the inertia effect of the particle becomes dominant r d 300 and φm gradually reduces toφ m π 2 at this point the retention time is attributed to mechanical collision and transport velocity deficit in the wake with short retention time of a collision free particle ignored the distribution of retention times has a short tail concentrated at the mean valueτ0 as discussed in section 2 3 τ0is proportional to the velocity deficit u f in the wake and the bulk drag force due to the stem is associated with u f the drag coefficient c ds for emergent vegetation has been extensively studied e g schlichting and gersten 1982 kothyari et al 2009 liu and zeng 2017 liu and zeng 2017 collected and analyzed data from the literature and suggested that c ds depends on r d and proposed an empirical formula with other factors fixed as shown in fig 11 τ0 exponentially decreases with increasing r d in a manner similar to relations between parameter c ds as ub and r d with c ds proposed by liu and zeng 2017 these findings are consistent with the prediction in section 2 3 as the dotted line shown in fig 11 the more massive particle will take longer time in an isolated collision event under the similar flow velocity i e τ0 0 4 cm τ0 0 3 cm τ0 0 2 cm they require a longer time to regain the mean transport velocity once it is slowed down or arrested by the stem with further data processing τ0appears to be positively related to the retention parameter c ds as ub ρr ar see fig 12 however there is an exception for r d 387 attributed to the effect of surface tension on trapped particle still exist as already reported peruzzo et al 2012 peruzzo et al 2016 liu et al 2018 the capture probability was estimated as the order of magnitude of 10 2 for r d 500 thereby the effect of surface tension on isolated capture event can be ignored particles are observed to be permanently captured τ0 10 min for r d 387 case run b1 the linear relation between c ds as ub ρr ar and τ0 after eliminating outliers can be described as 21 τ 0 3 215 c ds a s u b ρ r a r 0 034 with r 2 0 93 in the present experiments the measured u p within the stem density n s 1366 m 2 is significantly greater than u b consistent with the blockage effect and considering up 0when ub 0 u p can be described by a linear function with zero intercept as shown in fig 13 u p of low flow velocity a1 and a2 does not well conform with the linear relationship this is because the decelerating effect of surface tension compared with the blockage effect on downstream particle can not be ignored though the linear relationship for moderate to high flow velocity is acceptable with eliminating outliers for low flow velocities the slope of relationship curves decreases as a p increasing smaller particles are more sensitive to the blockage effect and may obtain greater transport velocity the reason for which is the smaller moves along the preferential path with higher lateral average constricted cross section velocity after collision with a stem particles move into the intermediate wake region the lateral velocity induced by stems will drive particles out of the intermediate wake and then into the free stream the presence of the stem results in a local increase in the velocity around it and a streamwise velocity gradient in lateral direction is generated which results in particles having a preference for drifting toward the higher flow regions among stems due to the lateral pressure difference therefore the measured u p will be significantly greater than u b and affected by stems density another reason may be due to the free surface velocity being slightly larger than the depth averaged velocity as shown in fig 14 the increment between particle transport and bulk flow velocity δu up ub is larger for smaller floating particles i e the smaller particle is more sensitive to the blockage effect under the similar density moreover δu is noticed positively correlated to the stem density fig 14 and can be reasonably fitted by a power relation 22 δ u 244 λ 1 88 u b with r 2 0 998 in fact the decrement of particle transport velocity due to collision is significantly less than the increment due to the blockage effect δu will steadily increase as λ increases until the center to center space between adjacent stems is approximately less than 4a p 4 3 longitudinal dispersion coefficient within the array of emergent stems stem scale and depth scale dispersion dominate the total longitudinal dispersion and the motion of floating particles stays in the horizontal plane depth scale dispersion can be ignored the magnitude of longitudinal dispersion within vegetated canopies has been very well studied e g nepf et al 1997 white and nepf 2003 lightbody and nepf 2006 for sparse canopies λ 0 1 stem scale dispersion results primarily from velocity heterogeneity due to the presence of stems and white and nepf 2003 the corresponding dispersion coefficient as 23 k l 1 2 c d 1 3 u b d s for denser canopies λ 0 1 stem scale dispersion will be dominated by the trapping and release of mass within the boundary layers and wakes of individual cylinders murphy 2006 approximated the stem scale dispersion at r d 40 by 24 k l 5 λ u b d s in present work the derivation process of d l is built on spherical particle moreover the irregularity of particles and corresponding kinetic difference are taken into consideration in the form of parameters δ a δ v γ and s tf thus the model can be generalized to seed particles in nature combining the semiempirical formulas of τ0and η with eq 4 the longitudinal dispersion coefficient d l can be semiempirically modeled and plotted as a function of r d ranges from 0 to 1500 in fig 15 and can well describe the experimental data the stem density adopted in this study is less than 0 1 the corresponding dispersion coefficient of eq 23 is also plotted in fig 15 as shown in fig 15 the dispersion coefficient of solute particles eq 23 is significantly smaller than dispersion coefficient of floating particles the root of this difference is various dynamic characteristics of particle and applying mechanically the dispersion coefficient of solute particles to dispersal model of floating seeds is not appropriate within the eulerian framework the time spent by particles from 0 5m downstream of the front end of the vegetated test section to reach the fixed cross sections 3 5m and we use these data to construct the cumulative arrival time distributions which is used to validate the model fig 16 shows comparison between measured and modeled results of cumulative arrival time distributions for runs a1 a7 the results are satisfactory the d l increases with an increase in r d which may be due to the contribution of mechanical dispersion becoming weaker with increasing u b and the delayed transport in wake region behind the stem becoming dominant moreover d l deserves a higher value for smaller particles however τ0and η become much less for small particles we can surmise that d l of floating particles is more sensitive to the blockage effect with the increase in stem density the increment of η and u p becomes more significant than the decrement in c ds from the wake interference or sheltering nepf 1999 hence d l increases with stem density due to more effective mechanical dispersion and this issue deserves future investigation through the proposed semiempirical model of longitudinal dispersion the rules of transport of floating seeds in vegetated aquatic flows can be investigated and we suggest that the results are of great significance to ecological restoration or restoration of riparian and wetland systems harnessing farmland weeds and even preventing invasion of exotic aquatic plant species especially for riparian aquatic and wetland systems and modeled results full line 5 conclusions two key mechanisms responsible for floating particle dispersal in fast moving flow within emergent vegetation have been studied these mechanisms include collisions between a particle and stems mechanical dispersion and subsequent wake trapping effect wake turbulence dispersion these two mechanisms differ from previous studies in slow moving flow where surface tension played a leading role in particle capture by vegetation a theoretical model of longitudinal dispersion based on a collision representation with appropriate length scales is proposed to describe the downstream transport process of floating seeds within the array of stems the model leads to an algebraic expression between longitudinal dispersion collision efficiency η between particles and the stem and retention time τ 0 for usability parameterizing η and retention time as a function of flow variables such as bulk velocity canopy properties and particle physical properties are necessary the kinematic model is established with potential flow theory to predict the collision efficiency between the particle and the stem to a first approximation the overall time particles reside in the wake is defined on the basis of an isolated collision event and shown to be positively correlated with the bulk drag coefficient and relative radius of stems using a simplified wake theory the distribution of retention times was shown to be related to the collision angle which may explain the superposition of two distribution relations proposed by defina and peruzzo 2012 the increment between particle transport and bulk flow velocity has a positive correlation with the blockage effect among stems and increases exponentially with increased stem density beside smaller particles can be considered more sensitive to the blockage effect and obtain greater transport velocity by comparison present semiempirical formula of d l can well describe the experimental data and the dispersion coefficient of solute particles is significantly smaller than dispersion coefficient of floating particles the root of the difference is various dynamic charateristics of particle to pursue the collision events further only a dense stems array n s 1366 m 2 was used for the dispersal process which means that the effect of stem density on the retention time is not varied increasing λ influences c ds as expected as well as the width of the wake zdravkovich 1997 thus further studies on the dependence of λ on τ 0 are needed and the application of the present theoretical model will be further evaluated in future studies credit authorship contribution statement xiaoguang liu conceptualization methodology formal analysis resources investigation writing original draft writing review editing validation yuhong zeng methodology formal analysis writing review editing supervision funding acquisition project administration gabriel katul methodology formal analysis writing review editing supervision wenxin huai formal analysis writing review editing yu bai writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the authors declare the following financial interests personal relationships which may be considered as potential competing interests acknowledgment y zeng acknowledges support from national natural science foundation of china 51879197 51622905 and 51439007 and support from the overseas expertise introduction project for discipline innovation 111 project funded by ministry of education and state administration of foreign experts affairs p r china b18037 g katul acknowledges support from the u s national science foundation nsf ags 1644382 and nsf ios 1754893 
