index,text
24270,an eddy resolving 1 12⁰ coupled physical biogeochemical ocean model configured for the indian ocean is used to study the upwelling off the west coast of india the dynamics of the south eastern arabian sea and the associated bio physical chemical mechanisms the model reproduces well the climatological features and local and remotely forced dynamical processes of the upwelling system in physical variables as well as biogeochemical parameters modelling experiments show that fresh water from rainfall and river runoff alter the phytoplankton concentration as well as the distribution of the phytoplankton size classes it is seen that rainfall influences the nanoplankton concentrations while river runoff influences larger diatom concentrations fresh water due to rainfall shoals the mixed layer ml and thermocline restricting upwelling due to enhanced stratification resulting in reduced nutrient and thereby reduced chlorophyll essentially nanoplankton further a thinner and warmer ml modifies thermodynamics and can consequently influence zooplankton by altering mesozooplankton grazing river runoff additionally influences by supplying nutrient causing a reduction in diatom and increase in nanoplankton concentrations thus increasing the preferred prey of zooplankton in the seas our simulations indicate phosphorous limitation in the region the biophysical controls linking ecological responses to fresh water like zooplankton food preferences are detailed with discussions on implications to food web dynamics of the region graphical abstract image graphical abstract keywords coupled model bio physical coupling diatoms river runoff arabian sea upwelling marine coastal ecosystems phytoplankton nutrients data availability data will be made available on request 1 introduction it is well known that the seasonally reversing monsoons regulate the phenomena in the indian ocean with the robust southwest monsoon swm occurring during may to october and the milder north east monsoon nem during november to february the seasonal west india coastal current wicc and onset and evolution of upwelling along the west coast of india are prominent dynamical features in the south east arabian sea seas shetye et al 1990 many studies have established that upwelling of cold water takes place during the swm period ex banse 1968 gupta et al 2016 this swm upwelling is important for the fisheries and marine life as this brings sub surface hypoxic waters to the surface thus depleting oxygen in the upper layers of the coastal waters banse 1959 gupta et al 2021 worldwide coastal upwelling is economically important due to large fishery production fishing in india is a major industry employing 14 5 million people and contributes to 1 07 of the total gdp of india the upwelling reaches the surface layer in may and intensifies during june july but withdraws completely and abruptly by october gupta et al 2016 the relative roles of windstress curl the coastal kelvin wave and the rossby waves are important in the onset and the evolution of upwelling along the south west coast of india upwelling is most prominent in the latitudes 9⁰n to 13⁰ n smitha et al 2008 2014 sachin and rasheed 2020 during the swm season winds blow from southwest and the coastal current along the west coast of india is southward this current reverses during the northeast monsoon and flows northward while numerous field and observational studies have progressed modelling studies are few on the swm upwelling mccreary et al 1996 haugen 2002 rao et al 2008 are some notable studies biophysical interactions are significant for marine ecosystem dynamics in the tropical indian ocean e g hood et al 2003 mccreary et al 2009 sathyendranath et al 1991 it has been shown that ocean biology impacts physical properties of the ocean by gera et al 2020 they have shown that changes in chlorophyll concentration can modulate the summer monsoon current and the wyrtky jet in the tropical india ocean although physical numerical ocean models have reached a reasonable state coupled physical biogeochemical models are still evolving a small difference in the physical variables can lead to large changes in biogeochemical variables in this study we demonstrate the capability of a high resolution coupled physical biogeochemical model to simulate and validate the coupled dynamics of the seas region coupled physical biogeochemical models would be useful tools for studying various coupled processes by segregating individual processes involved which cannot be done in the real world hence we use the nemo pisces coupled model to investigate bio physical interactions in the seas upwelling system observational evidence indicated influence of fresh water on this upwelling system narvekar et al 2021 the net buoyancy flux in the arabian sea is dominated by that due to fresh water compared to that due to heat flux anitha et al 2008 gera et al 2016 hence freshwater can play a significant role in upwelling the fresh water changes salinity and influences the physiological preferences of plankton eg brand 1984 ezhilarasan et al 2021 very few studies were carried out on impact of fresh water on chlorophyll in the seas and were inconclusive about it eg narvekar et al 2021 fresh water changes stratification which influence the phytoplankton size and community structure through controlling and light and nutrients behrenfeld et al 2006 phytoplankton size structure and composition is critical for the marine food webs and carbon fluxes riegman et al 1993 finkel et al 2010 to explore the role of fresh water on both physics and biology of the seas upwelling system we conducted three model experiments by including and excluding the rainfall and river run off in the model the main river that discharges into the seas region is the periyar river with an average discharge of 223 m3 s near kochi the results from the model experiments and the ecological responses are discussed such a modelling study has so far not been conducted for the seas region and this is the first such study 2 model experiments and data sets the model we used for this study is the nucleus for european modelling of the ocean nemo model madec et al 1998 madec 2008 based on a staggered arakawa c grid which uses a leap frog time stepping scheme for the dynamics for this study the model is configured for the indian ocean domain extending from 10 s to 30 n and 40 e to 100 e different configurations of the nemo model have earlier been used to study the indian ocean dynamics and found that the dynamics of the indian ocean are well represented in the model momin et al 2014 gera et al 2020 srivastava et al 2020 keerthi et al 2016 kone et al 2009 have used a similar configuration of the coupled model with a horizontal resolution of 0 5⁰ x 0 5⁰ to study the surface phytoplankton dynamics in the indian ocean they found that the model simulates well the chlorophyll variability and the timing of the onset of the blooms they also recommended using a higher horizontal resolution to better simulate meso scale and submesoscale processes like eddies which play a key role in bloom dynamics by supplying nutrients to photic zone our model grid is on orthogonal curvilinear tripolar grid with a horizontal resolution of 1 12 and with 31 vertical levels vertical mixing is parameterized using the turbulence closure model of bougeault and lacarrere 1989 additional modifications have been introduced by madec et al 1998 in implementation in the nemo model realistic bathymetry derived from earth topography 2 etopo2 smith and sandwell 1997 with a maximum depth of 6000 m is employed in the model no slip boundary conditions are applied at land boundaries the biogeochemical model coupled to the nemo model is the pelagic interactions scheme for carbon and ecosystem studies pisces v2 model which simulates the lower trophic levels of marine ecosystems phytoplankton micro zooplankton and meso zooplankton and the biogeochemical cycles of carbon and of the main nutrients p n fe and si the model comprises a total of 24 tracers which include two phytoplankton compartments diatoms and nanoplankton two zooplankton size classes micro zooplankton and meso zooplankton and carbonate chemistry in the model the larger size diatoms tend to have larger half saturation constants than nanoplankton the iron and silicate half saturation constants increase with biomass for diatoms while for nanoplankton only the iron constant increases the production terms for both diatoms and nanoplankton are similar except that limitation terms for diatoms also include si the fe c and chl c ratios of both the phytoplankton groups as well as the si c ratio of diatoms are prognostically predicted by the model based on the external sources like river and atmosphere a detailed description of the model is documented in aumount et al 2015 solutions are obtained for the indian ocean domain by forcing with six hourly core 2 corrected normal year climatological winds and fluxes large and yeager 2009 the input data for the core 2 are based on ncep reanalysis for near surface vector wind temperature specific humidity and density and on a variety of satellite based radiation sea surface temperature sea ice concentration and precipitation products the winds are determined from satellite derived winds and the ncep ncar reanalysis winds kalnay et al 1996 derived using data from 1984 2000 the radiation is obtained using isccp fd data and hadley oi sst precipitation is obtained using xie and arkin 1996 gpcp huffman et al 1997 and satellite and rain gauge blended data sets surface heat and evaporative fluxes are computed using core bulk formulae and model sst climatological river runoff is derived from dai and trenberth 2002 nutrients are initialized from observed climatology woa 09 data set garcia et al 2013 garcia et al 2019 twenty year spin up run is made from rest which is followed by a two year run the time for dynamical adjustments in the indian ocean is about one year or less as the propagation speed of rossby waves in the tropical indian ocean is fast therefore the spin up time of 20 years is more than sufficient for the upper ocean to reach equilibrium although the deeper layers might take more time to attain the dynamical equilibrium the model fields validation are considered from december of the 21st year run to december of the 22nd year for validation of the model we used observed temperature and salinity from woa 09 locarnini et al 2010 pentad oscar currents with 1 3 resolution bonjean and lagerloef 2002 from jpl nasa for 1993 2017 are used to construct a monthly climatology the oscar data set does not provide the data close to the coast as it is limited by availability of satellite data on each day the seawifs climatology of chlorophyll a concentration data is taken from jpl nasa the nemo model is run on the high performance computer cluster aditya of the ministry of earth sciences india the number of processors used for the model run is 64 the model time step used is 300 s a typical run for one year in the coupled configuration used for the study took about 7 8 days 185 h for the spin up of 20 years run and the experimental runs took more than six months three model experiments are conducted by 1 plugging in river runoff and precipitation rainfall ctl 2 plugging off the river runoff alone nrr and 3 plugging off fresh water from both river runoff and precipitation rainfall nrp in the spin up run of 20 years both rainfall and river runoff are used then the solutions for the three experiments are carried out for two subsequent years 21st and 22nd years after the spin up solution therefore the changes in these experiments will not be drastic as the spin up run includes both rainfall and runoff and are switched off only for the last two years 21st and 22nd years of the experiment run these changes reflect those due to enhanced fresh water and not total presence or absence of fresh water the river runoff discharge location in the study region is shown in fig s1 supplementary figure the runoff is converted from m3 s discharge to mm day to make it uniform and comparable to rainfall one mm 0 001 m of rainfall refers to rainfall falling on one square meter area hence it is equivalent to a volume of water of 0 001 m3 one litre therefore 1 mm day 0 001 m3 day volume of water day the fresh water monthly discharging into the seas representative region 8 13n and 74 78e is 0 6 mm day this discharge is distributed in 49 7 7 model grids which equals 49 8 km 8 km 7 7 8 8 square km 3136 sq km 3136 106 sq m 1mm day 0 001m3 day therefore 0 6mm day 0 0006 m 3 d a y of monthly discharge 12 60 60 24 0 0006 m 3 s 8 3 10 8 m s in one square meter of area therefore in 49 model grids area the discharge will be 8 3 10 8 3136 10 6 m 3 s 260 28 m 3 s this is comparable to average discharge of periyar river is 223 m3 s near kochi 3 model performance and experiment results 3 1 model mean annual cycle the model performance is first examined for the annual mean spatial patterns of sea surface temperature sst sea surface salinity sss and the surface currents these patterns are found to match reasonably well with the climatological observations fig 1 the average biases are 0 5 ⁰c 1 psu and 10 cm s respectively for sst sss and surface currents which are less than the respective standard deviations the correlation co efficient for sst is 0 72 while the root mean square deviation rmsd is 0 13⁰ c the corresponding values for sss are 0 61 and 0 22 psu respectively warmer waters in the equatorial regions depicting the mini warm pool in the indian ocean is well represented in the model so also the cooler western arabian sea due to the influence of findlater jet during swm is fairly well brought out with minimum biases in the region the contrasting salinity in the two basins arabian sea as and bay of bengal bob with low salinity in bob and higher salinity in the arabian sea can clearly seen fig 1b e however the largest biases are found in the bob and the simulated surface salinity shows positive bias in the bob the bob is one of the regions which receives very heavy rainfall on the globe and river run off into bob is also among the highest hence small errors in the climatological precipitation forcing data set can escalate and lead to such anomalies the xie and arkin data set is known to bear a negative bias in indian ocean regions ramesh kumar et al 2005 which may have resulted in the positive bias of salinity interestingly the surface salinity bias is close to zero in the as the currents in the equatorial region seem to be slightly more pronounced in the model which may be due to errors in the wind forcing the annual cycle of sst in as and bob are captured well in terms of magnitude as well as spatial patterns figs 2 and 1 respectively showing the semi annual peaks during summer april may and post monsoon october november and lower temperatures during winter december to february and july august fig 2 the amplitude differences in as and bob are also well represented fig 3 shows the seasonal cycle of surface chlorophyll in the as simulated by the model and seawifs observational climatology the model is able to simulate the seasonal cycle well with slightly lower magnitude the correlation coefficient of mean surface chlorophyll concentration is 0 9 while the rmsd is 0 03 mg chl m3 indicating a good agreement with observations the mean annual chlorophyll in the region is 0 4378 mg chl m3 3 2 swm upwelling in temperature salinity and dissolved oxygen in the seas the seas upwelling region is marked on fig 1g with a rectangular box swm upwelling in the seas is a typical eastern boundary upwelling upwelling brings the sub surface waters to the upper layers causing nutrient enrichment and enhanced biological production uplift of isotherms and thermocline are indicative for the upwelling process strong uplift of isotherms can be noticed during july and august at 9 n and 13 n in the model simulated temperature fig 4 the uplift is stronger at 9 n southern part of the upwelling region during july and august and decreases during september and october as the season progresses at a northern latitude at 13 n the upwelling is seen closer to the coast as compared to 9 n cooler surface temperatures are seen and upwelling happens here a month later than at 9 n hence stronger upwelling at the southern latitudes is inferred complying with known literature that upwelling starts in the south and extends northward with progress of the season during swm vertical sections of salinity at these latitudes indicate that upwelling can be observed from the isohalines fig 5 as well and these patterns are similar to the upwelling in the isotherms clear upwelling signature is seen in the oxygen vertical profiles during the swm fig 6 lower oxygen levels moving to the near surface can be noticed in the figure these dissolved oxygen do plots also show that upwelling peaks early during july and august in the southern latitudes and little later september october along the northern latitudes during the swm 3 3 dynamics of seas during swm the wicc flows equatorward favouring upwelling and while during nem it flows poleward the seasonal flow of the wicc is shown in figs 7 and 8 from these figures it can be seen that the seasonality of south west monsoon current smc and the wicc are well brought out in the model both in terms of magnitude and direction comparison with oscar currents gives a good match during both nem and swm seasons the meridional velocity of the surface currents averaged over 72⁰ to 77⁰e in the latitudinal range 5⁰ 20⁰n clearly shows the change from southerly equatorward negative to poleward positive flow fig 8 negative velocities indicating southward flow can be observed during april to august and positive velocities indicating poleward flow during october to january during the swm an undercurrent flows below the smc in the opposite direction near the southern latitudes of the coast extending from 8⁰ to 12⁰n supplementary figure fig s2 model simulation of the undercurrent is shown in fig s2 depicting the vertical cross section of the meridional velocity during swm july in the top 200m averaged over 8⁰n to 9 n and 72⁰e to 78⁰e the magnitude timing and the direction are noticed to match with earlier observational reports eg schott and mccreary 2001 model simulated annual rossby waves in the arabian sea are shown in fig s3 supplementary figure the phased speed of 0 42 m s match with the values of previous studies of brandt et al 2002 3 4 experiment results the fresh water sources are 1 precipitation rainfall and 2 river runoff it may be noted that the quantity of rainfall is much larger than the river runoff in the seas periyar is the only river discharging into the seas region the fresh water discharging into the seas representative region 8 13n and 74 78e is 0 6 mm day while it is 8 mm day in case of rainfall during swm however discharges from rivers of the northern arabian sea like the indus the narmada and the tapi might also influence the seas in order to understand the influence of fresh water from the rainfall and river on various parameters we examine 1 the difference of ctl minus nrr which isolates the changes due to rainfall alone and 2 the difference of ctl minus nrp which brings out the changes due to both river runoff and rainfall in the indian ocean the depth of the 24⁰ isotherm d24 is considered proxy for the middle of the thermocline depth the differences of d24 of the two experiments from the control ctl run δd24 ctl d24 minus nrr d24 or ctl d24 minus nrp d24 as per the case are shown in fig 9 which indicates that the thermocline is shallower by 5 10m in the absence of river runoff and by 10 20 m when both river runoff and precipitation are absent freshwater increases stratification in the upper layers leading to restriction of upwelling figs 10 and 11 show the phytoplankton total nano and diatom simulated by the model and the differences of experiments with the control run which bring out the influence of freshwater on phytoplankton and its constituents size classes fig 10 b c show the percentage contributions of nanoplankton and diatoms in the control run ctrl we see from these figures that nanoplankton is the major contributor to total phytoplankton our results corroborate madhu et al 2010 which reports that in the coastal region of seas region nanoplankton contributes an average of 73 2 sd 17 2 to the total chlorophyll the model is able to simulate both the total chlorophyll and its components to a reasonable accuracy hence the model results of phytoplankton classes can be used reliably for our sensitivity experiments the profiles of chlorophyll show a maximum at about 20 m depth recent observational studies in seas eg martin et al 2020 smitha et al 2020 jayaram et al 2021 also corroborate our results the negative values of the differences fig 10d i indicate a decrease of concentration of both the species of phytoplankton diatoms as well as nanoplankton due to enhanced fresh water it is seen that the reduction in concentration of total plankton and nanoplankton in the top 100 m is not much due to river runoff alone figs 10d e and 11 the influence of river runoff is found confined to the changes in diatom concentration and is limited to small region in the southern part of seas fig 10f from figures fig 10f g i it is seen that there is a plume like extension pattern in the plankton difference in the region south of 10⁰n which is almost entirely a contribution due to diatoms while in region north of 10⁰n the decrease is predominantly in the nanoplankton and is restricted to along the coast further there is a decrease in nanoplankton off the coast between 10⁰ and 12⁰n in essence the influence of river runoff is to reduce the diatom concentration limited to the plume region south of 10⁰n while rainfall reduces the nanoplankton and diatom concentrations and thus the total plankton in the seas 4 discussion modelling experiments can provide insights into the role of different forcing factors of a particular process and bring the quantitative contributions of the factors in this study our coupled physical biogeochemical modelling experiments are aimed to investigate the role of fresh water in the seas upwelling ecosystem in our modelling experiments we study both the physical and biological changes due to freshwater the model simulates the parameters like temperature salinity currents and chlorophyll quite well both quantitatively and qualitatively our simulations show features of upwelling to be well represented however the magnitude of dissolved oxygen simulated by the model seems to be much higher compared to observational studies like gupta et al 2016 2021 this may be due to poor initialization of biogeochemical data sets in the coastal regions the model is initialized with climatological data sets which are of very coarse resolution one degree and much of the indian ocean and coastal regions have sparse data most of the available data is from open ocean observations it is therefore very much essential to initialize the model with realistic fields which include observations from coastal regions the marine ecosystem dynamics of eastern arabian sea medas programme has made systematic observations gupta et al 2021 of all the physical biogeochemical parameters along the eastern arabian sea and such data sets would help in initialization which would provide better model simulations 4 1 impact of fresh water and ecological response reasonable impact of fresh water on phytoplankton concentration and its size classes is manifested from our experiments and seen to be more in the nrp than in the nrr implying the stronger role of precipitation than river runoff which is in agreement with the narvekar et al 2021 earlier studies santhikrishna et al 2021 reported an increase in larger size fraction micro of plankton where upwelling was predominant and predominance of smaller nano plankton where upwelling is inhibited due to fresh water in coastal waters of eastern arabian sea such responses and the bio physical chemical coupling are explained below based on our experiments which are also presented in the graphical abstract fig 13 4 2 ecological response to rainfall the impact of rainfall precipitation on nanoplankton can have cascading ecological implications which are discussed as follows in the seas during swm due to strong hydrographic upwelling changes strong biophysical coupling exists the influence of rainfall is to enhance the stratification which results in shallow thermocline and shallower mixed layer fig 10 as the mixed layer becomes thinner it warms faster due to stratification mixing reduces causing reduction in nutrient supply to the euphotic zone from the deeper layers fig 12 of silicate phosphate and nitrate profiles clearly the values of no3 corresponding to ctl nrr red and green profiles more fresh water are lower than those of nrp blue profile less fresh water a zoomed figure of the same showing the changes in the top 30 m is provided as fig s4 supplementary figure hence it implies that in enhanced fresh water cases ctl and nrr mixing is reduced and thereby nutrient is reduced by restricting upwelling which may be sufficient to bring about the change observed in the chlorophyll profiles as these changes are not linear but are complex eg in model no3 concentration depends on concentration of phosphorous further the changes in chlorophyll profile do not reflect exactly the changes in nutrients also the model vertical resolution is 10 m in the top 100 m and the first layer is average of 10 m which make the plots smoother thus the nutrient concentrations and ratios change leading to reduced nanoplankton concentration figs 10 and 11 as nanoplankton is the preferred prey of meso and micro zooplankton this would result in their reduction previous studies also have reported that meso zooplankton dominated by copepods as well as micro zooplankton showed highest grazing rate and preference for nanoplankton in the eas anjusha et al 2018 jagadeesan et al 2017 during swm when the chl a concentration is highest it is reported that by studies like banse 1996 that copepods are usually the dominant meso zooplankton marine ecosystems and play a key role in the aquatic food web through pathways of bacteria phytoplankton and microzooplankton to higher trophic levels such as fishes therefore it implies that enhanced freshening due to rainfall influences meso zooplankton by reducing both micro zooplankton as well as nanoplankton jagadeesan et al 2017 reported that copepods contributed 82 58 98 49 to the total zooplankton biomass in the coastal waters of as during swm high meso zooplankton biomass was reported in the mixed and thermocline layers along the southwest coast of india jyothibabu et al 2010 it has been observed that copepod species composition shifts during the pre swm to the swm and that during swm the abundance of only the smaller copepods increased madhupratap 1987 madhupratap et al 1996 jagadeesan et al 2017 anjusha et al 2018 which reflects on the zooplankton biomass combining our results with these studies suggests of a biophysical link of enhanced freshening due to rainfall altering the aquatic plankton food web thus a possible biophysical link of enhanced freshening due to rainfall on plankton food web dynamics in the upper ocean of seas during swm season is to reduce the preferred prey of a large proportion of zooplankton and further influence the energy transfer to higher trophic levels through restriction of upwelling due to stratification the model simulations of the zooplankton fields could not be saved during the model run due to computational and storage limitations hence the impacts on zooplankton could not be verified from the model results 4 3 ecological response to river runoff the ecological implications of river runoff on diatoms are discussed below the phytoplankton growth rate is the highest during the swm in the south west coast of india studies suggest that diatom blooms peak during swm in the seas and these are dominated by larger diatoms and dinoflagellates due to their intrinsic growth capacity banse et al 1996 ahmed et al 2016 jyothibabu et al 2018a larger phytoplankton micro fraction biomass was higher during the swm anjusha et al 2018 diatoms tend to have significantly higher maximum uptake rates of nutrients than any other group litchman et al 2006 the general conception is that river runoff should be supplying more nutrient leading to enhanced primary production in our experiments presence of river runoff reduces diatom chlorophyll concentration figs 10 and 11 this is explained as follows the presence of fresh water from river runoff as like rainfall restricts upwelling thermocline of the deeper nutrient rich water through stratification leading to less nutrient in the euphotic zone resulting in reduction of phytoplantkon the additional influence is from the supply of nutrients from the rivers that the runoff brings diatoms occupy the mixed layer ml and the presence of fresh water causes the ml to shoal reducing the vertical entrainment to ml resulting in a decline in their concentration hence low nutrient to the mixed layer results in lesser blooming as the ml shoals it gets heated faster this warmer ml modulates the grazing rate of zooplankton meso and micro the light saturation parameter dissolution of silica as these all are functions of temperature in turn the changes in phytoplankton concentration modulate the ml as well as the dynamics in the indian ocean gera et al 2020 the reduction in diatom is supported by a study by mangala et al 2017 which shows that supply of excess n and p over si leads to the development of non diatom blooms fig 12 plots the profiles of silicate showing changes in the three experiments which indicate the same a reduction in the diatom bloom would make nutrient available for growth of smaller plankton nano as discussed earlier that micro and meso zooplankton prefer nanoplankton resulting in increase of zoo plankton thus the energy transfer may be more efficient to the higher trophics thus influencing the food web dynamics in the seas during swm further as the fe c chl c and si c are prognostically predicted in the model the diatom growth depend on the relative concentrations of the nutrients 4 4 nutrient limitations different species in a phytoplankton community are constrained by concentration of different nutrients and growth of marine phytoplankton is complex limited by multiple nutrients at both individual cell level and community level arrigo 2005 the nitrate phosphate no3 po4 ratio of 16 1 in the sea is controlled by the requirements of phytoplankton redfield 1963 the nitrate phosphate ratio in all the three experiments is greater than the general redfield ratio of 16 1 the ratio is around 27 1 for ctl and nrr experiments but is 24 1 a slightly lower value in the nrp experiment the near surface layer shows a ratio less than one 0 9 for silicate to nitrate hence phosphorus and silicate act as the limiting nutrient for plankton productivity and not nitrogen in the near surface layers of the region the phosphate limitation in arabian sea agree with previous modelling studies aumont et al 2003 lower value 25 of nitrate phosphate ratio in nrp indicates greater enrichment of phosphate than nitrate in the nrp experiment although it still remains phosphorus limited this phosphate enrichment during swm upwelling is corroborated by previous observational studies in the waters off kochi fathin et al 2021 in nrp upwelling is enhanced due to lower freshwater and reduced stratification which may be bringing the subsurface phosphate to near surface layer 5 summary and conclusions eastern boundary upwelling systems are highly productive which are known to bring nutrient rich but oxygen deficient water to coasts a coupled physical biogeochemical model is configured for the indian ocean to study the seas eastern boundary upwelling system which simulates all the physical and biogeochemical parameters and their dynamics fairly well despite good simulation of physical parameters the limitation of the model is in the quantitative reproduction of biogeochemical parameters especially in the coastal regions the study demonstrates the capability of coupled physical biogeochemical models in simulating the dynamics of seas and highlights the need for good biogeochemical initialization data sets in the coastal regions for realistic simulation and forecast experiments with this model have manifested that the presence of fresh water decreases the plankton concentration in the seas upwelling system and that the influence of precipitation is larger than that of river runoff the study manifests that phytoplankton concentration is biophysically linked to freshwater through three responses which are 1 limiting the sub surface nutrient supply to euphotic zone by suppressing upwelling through enhanced stratification 2 shoaling and warming of mixed layer and 3 supply of nutrient from river sources phytoplankton response to enhanced freshening through river runoff is complex and involves a multitude of processes our model simulations show that seas is a phosphate limiting system during swm the changes in nanoplankton are mostly linked to changes in rainfall while changes of diatoms are linked to river runoff possible ecological responses biophysical link to enhanced freshening rainfall is to reduce nanoplankton which is the preferred prey of a large portion of zooplankton and thereby influence the energy transfer to higher trophic levels while from enhanced freshening through river runoff is to decrease the diatom blooms thereby making nutrient available for other planktons size groups like nanoplankton thus increasing the energy transfer to higher trophic levels hence fresh water influences the planktonic size structure community thus altering the aquatic plankton food web dynamics the limitation of the study is that these inferences are subject to the assumptions and empirical constants used in the model in future we plan to carry out more sensitivity experiments aimed to break out the further complex dependencies of fresh water credit authorship contribution statement anitha gera conceptualization writing original draft writing review editing visualization r gayathri software writing review editing p ezhilarasan writing review editing v ranga rao supervision writing review editing m v ramana murthy project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank data providers jpl nasa for oscar surface current and chlorophyll data sets the authors are thankful to the ministry of earth sciences govt of india for implementing the ecosystem based services programme project at the national centre for coastal research nccr chennai the authors thank dr k ramu nccr for fruitful discussions which helped us in sorting out key issues on the planktonic groups the authors are sincerely thankful to the secretary moes dr m ravichandran for encouraging the study this is nccr contribution no nccr ms 368 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110246 appendix supplementary materials image application 1 
24270,an eddy resolving 1 12⁰ coupled physical biogeochemical ocean model configured for the indian ocean is used to study the upwelling off the west coast of india the dynamics of the south eastern arabian sea and the associated bio physical chemical mechanisms the model reproduces well the climatological features and local and remotely forced dynamical processes of the upwelling system in physical variables as well as biogeochemical parameters modelling experiments show that fresh water from rainfall and river runoff alter the phytoplankton concentration as well as the distribution of the phytoplankton size classes it is seen that rainfall influences the nanoplankton concentrations while river runoff influences larger diatom concentrations fresh water due to rainfall shoals the mixed layer ml and thermocline restricting upwelling due to enhanced stratification resulting in reduced nutrient and thereby reduced chlorophyll essentially nanoplankton further a thinner and warmer ml modifies thermodynamics and can consequently influence zooplankton by altering mesozooplankton grazing river runoff additionally influences by supplying nutrient causing a reduction in diatom and increase in nanoplankton concentrations thus increasing the preferred prey of zooplankton in the seas our simulations indicate phosphorous limitation in the region the biophysical controls linking ecological responses to fresh water like zooplankton food preferences are detailed with discussions on implications to food web dynamics of the region graphical abstract image graphical abstract keywords coupled model bio physical coupling diatoms river runoff arabian sea upwelling marine coastal ecosystems phytoplankton nutrients data availability data will be made available on request 1 introduction it is well known that the seasonally reversing monsoons regulate the phenomena in the indian ocean with the robust southwest monsoon swm occurring during may to october and the milder north east monsoon nem during november to february the seasonal west india coastal current wicc and onset and evolution of upwelling along the west coast of india are prominent dynamical features in the south east arabian sea seas shetye et al 1990 many studies have established that upwelling of cold water takes place during the swm period ex banse 1968 gupta et al 2016 this swm upwelling is important for the fisheries and marine life as this brings sub surface hypoxic waters to the surface thus depleting oxygen in the upper layers of the coastal waters banse 1959 gupta et al 2021 worldwide coastal upwelling is economically important due to large fishery production fishing in india is a major industry employing 14 5 million people and contributes to 1 07 of the total gdp of india the upwelling reaches the surface layer in may and intensifies during june july but withdraws completely and abruptly by october gupta et al 2016 the relative roles of windstress curl the coastal kelvin wave and the rossby waves are important in the onset and the evolution of upwelling along the south west coast of india upwelling is most prominent in the latitudes 9⁰n to 13⁰ n smitha et al 2008 2014 sachin and rasheed 2020 during the swm season winds blow from southwest and the coastal current along the west coast of india is southward this current reverses during the northeast monsoon and flows northward while numerous field and observational studies have progressed modelling studies are few on the swm upwelling mccreary et al 1996 haugen 2002 rao et al 2008 are some notable studies biophysical interactions are significant for marine ecosystem dynamics in the tropical indian ocean e g hood et al 2003 mccreary et al 2009 sathyendranath et al 1991 it has been shown that ocean biology impacts physical properties of the ocean by gera et al 2020 they have shown that changes in chlorophyll concentration can modulate the summer monsoon current and the wyrtky jet in the tropical india ocean although physical numerical ocean models have reached a reasonable state coupled physical biogeochemical models are still evolving a small difference in the physical variables can lead to large changes in biogeochemical variables in this study we demonstrate the capability of a high resolution coupled physical biogeochemical model to simulate and validate the coupled dynamics of the seas region coupled physical biogeochemical models would be useful tools for studying various coupled processes by segregating individual processes involved which cannot be done in the real world hence we use the nemo pisces coupled model to investigate bio physical interactions in the seas upwelling system observational evidence indicated influence of fresh water on this upwelling system narvekar et al 2021 the net buoyancy flux in the arabian sea is dominated by that due to fresh water compared to that due to heat flux anitha et al 2008 gera et al 2016 hence freshwater can play a significant role in upwelling the fresh water changes salinity and influences the physiological preferences of plankton eg brand 1984 ezhilarasan et al 2021 very few studies were carried out on impact of fresh water on chlorophyll in the seas and were inconclusive about it eg narvekar et al 2021 fresh water changes stratification which influence the phytoplankton size and community structure through controlling and light and nutrients behrenfeld et al 2006 phytoplankton size structure and composition is critical for the marine food webs and carbon fluxes riegman et al 1993 finkel et al 2010 to explore the role of fresh water on both physics and biology of the seas upwelling system we conducted three model experiments by including and excluding the rainfall and river run off in the model the main river that discharges into the seas region is the periyar river with an average discharge of 223 m3 s near kochi the results from the model experiments and the ecological responses are discussed such a modelling study has so far not been conducted for the seas region and this is the first such study 2 model experiments and data sets the model we used for this study is the nucleus for european modelling of the ocean nemo model madec et al 1998 madec 2008 based on a staggered arakawa c grid which uses a leap frog time stepping scheme for the dynamics for this study the model is configured for the indian ocean domain extending from 10 s to 30 n and 40 e to 100 e different configurations of the nemo model have earlier been used to study the indian ocean dynamics and found that the dynamics of the indian ocean are well represented in the model momin et al 2014 gera et al 2020 srivastava et al 2020 keerthi et al 2016 kone et al 2009 have used a similar configuration of the coupled model with a horizontal resolution of 0 5⁰ x 0 5⁰ to study the surface phytoplankton dynamics in the indian ocean they found that the model simulates well the chlorophyll variability and the timing of the onset of the blooms they also recommended using a higher horizontal resolution to better simulate meso scale and submesoscale processes like eddies which play a key role in bloom dynamics by supplying nutrients to photic zone our model grid is on orthogonal curvilinear tripolar grid with a horizontal resolution of 1 12 and with 31 vertical levels vertical mixing is parameterized using the turbulence closure model of bougeault and lacarrere 1989 additional modifications have been introduced by madec et al 1998 in implementation in the nemo model realistic bathymetry derived from earth topography 2 etopo2 smith and sandwell 1997 with a maximum depth of 6000 m is employed in the model no slip boundary conditions are applied at land boundaries the biogeochemical model coupled to the nemo model is the pelagic interactions scheme for carbon and ecosystem studies pisces v2 model which simulates the lower trophic levels of marine ecosystems phytoplankton micro zooplankton and meso zooplankton and the biogeochemical cycles of carbon and of the main nutrients p n fe and si the model comprises a total of 24 tracers which include two phytoplankton compartments diatoms and nanoplankton two zooplankton size classes micro zooplankton and meso zooplankton and carbonate chemistry in the model the larger size diatoms tend to have larger half saturation constants than nanoplankton the iron and silicate half saturation constants increase with biomass for diatoms while for nanoplankton only the iron constant increases the production terms for both diatoms and nanoplankton are similar except that limitation terms for diatoms also include si the fe c and chl c ratios of both the phytoplankton groups as well as the si c ratio of diatoms are prognostically predicted by the model based on the external sources like river and atmosphere a detailed description of the model is documented in aumount et al 2015 solutions are obtained for the indian ocean domain by forcing with six hourly core 2 corrected normal year climatological winds and fluxes large and yeager 2009 the input data for the core 2 are based on ncep reanalysis for near surface vector wind temperature specific humidity and density and on a variety of satellite based radiation sea surface temperature sea ice concentration and precipitation products the winds are determined from satellite derived winds and the ncep ncar reanalysis winds kalnay et al 1996 derived using data from 1984 2000 the radiation is obtained using isccp fd data and hadley oi sst precipitation is obtained using xie and arkin 1996 gpcp huffman et al 1997 and satellite and rain gauge blended data sets surface heat and evaporative fluxes are computed using core bulk formulae and model sst climatological river runoff is derived from dai and trenberth 2002 nutrients are initialized from observed climatology woa 09 data set garcia et al 2013 garcia et al 2019 twenty year spin up run is made from rest which is followed by a two year run the time for dynamical adjustments in the indian ocean is about one year or less as the propagation speed of rossby waves in the tropical indian ocean is fast therefore the spin up time of 20 years is more than sufficient for the upper ocean to reach equilibrium although the deeper layers might take more time to attain the dynamical equilibrium the model fields validation are considered from december of the 21st year run to december of the 22nd year for validation of the model we used observed temperature and salinity from woa 09 locarnini et al 2010 pentad oscar currents with 1 3 resolution bonjean and lagerloef 2002 from jpl nasa for 1993 2017 are used to construct a monthly climatology the oscar data set does not provide the data close to the coast as it is limited by availability of satellite data on each day the seawifs climatology of chlorophyll a concentration data is taken from jpl nasa the nemo model is run on the high performance computer cluster aditya of the ministry of earth sciences india the number of processors used for the model run is 64 the model time step used is 300 s a typical run for one year in the coupled configuration used for the study took about 7 8 days 185 h for the spin up of 20 years run and the experimental runs took more than six months three model experiments are conducted by 1 plugging in river runoff and precipitation rainfall ctl 2 plugging off the river runoff alone nrr and 3 plugging off fresh water from both river runoff and precipitation rainfall nrp in the spin up run of 20 years both rainfall and river runoff are used then the solutions for the three experiments are carried out for two subsequent years 21st and 22nd years after the spin up solution therefore the changes in these experiments will not be drastic as the spin up run includes both rainfall and runoff and are switched off only for the last two years 21st and 22nd years of the experiment run these changes reflect those due to enhanced fresh water and not total presence or absence of fresh water the river runoff discharge location in the study region is shown in fig s1 supplementary figure the runoff is converted from m3 s discharge to mm day to make it uniform and comparable to rainfall one mm 0 001 m of rainfall refers to rainfall falling on one square meter area hence it is equivalent to a volume of water of 0 001 m3 one litre therefore 1 mm day 0 001 m3 day volume of water day the fresh water monthly discharging into the seas representative region 8 13n and 74 78e is 0 6 mm day this discharge is distributed in 49 7 7 model grids which equals 49 8 km 8 km 7 7 8 8 square km 3136 sq km 3136 106 sq m 1mm day 0 001m3 day therefore 0 6mm day 0 0006 m 3 d a y of monthly discharge 12 60 60 24 0 0006 m 3 s 8 3 10 8 m s in one square meter of area therefore in 49 model grids area the discharge will be 8 3 10 8 3136 10 6 m 3 s 260 28 m 3 s this is comparable to average discharge of periyar river is 223 m3 s near kochi 3 model performance and experiment results 3 1 model mean annual cycle the model performance is first examined for the annual mean spatial patterns of sea surface temperature sst sea surface salinity sss and the surface currents these patterns are found to match reasonably well with the climatological observations fig 1 the average biases are 0 5 ⁰c 1 psu and 10 cm s respectively for sst sss and surface currents which are less than the respective standard deviations the correlation co efficient for sst is 0 72 while the root mean square deviation rmsd is 0 13⁰ c the corresponding values for sss are 0 61 and 0 22 psu respectively warmer waters in the equatorial regions depicting the mini warm pool in the indian ocean is well represented in the model so also the cooler western arabian sea due to the influence of findlater jet during swm is fairly well brought out with minimum biases in the region the contrasting salinity in the two basins arabian sea as and bay of bengal bob with low salinity in bob and higher salinity in the arabian sea can clearly seen fig 1b e however the largest biases are found in the bob and the simulated surface salinity shows positive bias in the bob the bob is one of the regions which receives very heavy rainfall on the globe and river run off into bob is also among the highest hence small errors in the climatological precipitation forcing data set can escalate and lead to such anomalies the xie and arkin data set is known to bear a negative bias in indian ocean regions ramesh kumar et al 2005 which may have resulted in the positive bias of salinity interestingly the surface salinity bias is close to zero in the as the currents in the equatorial region seem to be slightly more pronounced in the model which may be due to errors in the wind forcing the annual cycle of sst in as and bob are captured well in terms of magnitude as well as spatial patterns figs 2 and 1 respectively showing the semi annual peaks during summer april may and post monsoon october november and lower temperatures during winter december to february and july august fig 2 the amplitude differences in as and bob are also well represented fig 3 shows the seasonal cycle of surface chlorophyll in the as simulated by the model and seawifs observational climatology the model is able to simulate the seasonal cycle well with slightly lower magnitude the correlation coefficient of mean surface chlorophyll concentration is 0 9 while the rmsd is 0 03 mg chl m3 indicating a good agreement with observations the mean annual chlorophyll in the region is 0 4378 mg chl m3 3 2 swm upwelling in temperature salinity and dissolved oxygen in the seas the seas upwelling region is marked on fig 1g with a rectangular box swm upwelling in the seas is a typical eastern boundary upwelling upwelling brings the sub surface waters to the upper layers causing nutrient enrichment and enhanced biological production uplift of isotherms and thermocline are indicative for the upwelling process strong uplift of isotherms can be noticed during july and august at 9 n and 13 n in the model simulated temperature fig 4 the uplift is stronger at 9 n southern part of the upwelling region during july and august and decreases during september and october as the season progresses at a northern latitude at 13 n the upwelling is seen closer to the coast as compared to 9 n cooler surface temperatures are seen and upwelling happens here a month later than at 9 n hence stronger upwelling at the southern latitudes is inferred complying with known literature that upwelling starts in the south and extends northward with progress of the season during swm vertical sections of salinity at these latitudes indicate that upwelling can be observed from the isohalines fig 5 as well and these patterns are similar to the upwelling in the isotherms clear upwelling signature is seen in the oxygen vertical profiles during the swm fig 6 lower oxygen levels moving to the near surface can be noticed in the figure these dissolved oxygen do plots also show that upwelling peaks early during july and august in the southern latitudes and little later september october along the northern latitudes during the swm 3 3 dynamics of seas during swm the wicc flows equatorward favouring upwelling and while during nem it flows poleward the seasonal flow of the wicc is shown in figs 7 and 8 from these figures it can be seen that the seasonality of south west monsoon current smc and the wicc are well brought out in the model both in terms of magnitude and direction comparison with oscar currents gives a good match during both nem and swm seasons the meridional velocity of the surface currents averaged over 72⁰ to 77⁰e in the latitudinal range 5⁰ 20⁰n clearly shows the change from southerly equatorward negative to poleward positive flow fig 8 negative velocities indicating southward flow can be observed during april to august and positive velocities indicating poleward flow during october to january during the swm an undercurrent flows below the smc in the opposite direction near the southern latitudes of the coast extending from 8⁰ to 12⁰n supplementary figure fig s2 model simulation of the undercurrent is shown in fig s2 depicting the vertical cross section of the meridional velocity during swm july in the top 200m averaged over 8⁰n to 9 n and 72⁰e to 78⁰e the magnitude timing and the direction are noticed to match with earlier observational reports eg schott and mccreary 2001 model simulated annual rossby waves in the arabian sea are shown in fig s3 supplementary figure the phased speed of 0 42 m s match with the values of previous studies of brandt et al 2002 3 4 experiment results the fresh water sources are 1 precipitation rainfall and 2 river runoff it may be noted that the quantity of rainfall is much larger than the river runoff in the seas periyar is the only river discharging into the seas region the fresh water discharging into the seas representative region 8 13n and 74 78e is 0 6 mm day while it is 8 mm day in case of rainfall during swm however discharges from rivers of the northern arabian sea like the indus the narmada and the tapi might also influence the seas in order to understand the influence of fresh water from the rainfall and river on various parameters we examine 1 the difference of ctl minus nrr which isolates the changes due to rainfall alone and 2 the difference of ctl minus nrp which brings out the changes due to both river runoff and rainfall in the indian ocean the depth of the 24⁰ isotherm d24 is considered proxy for the middle of the thermocline depth the differences of d24 of the two experiments from the control ctl run δd24 ctl d24 minus nrr d24 or ctl d24 minus nrp d24 as per the case are shown in fig 9 which indicates that the thermocline is shallower by 5 10m in the absence of river runoff and by 10 20 m when both river runoff and precipitation are absent freshwater increases stratification in the upper layers leading to restriction of upwelling figs 10 and 11 show the phytoplankton total nano and diatom simulated by the model and the differences of experiments with the control run which bring out the influence of freshwater on phytoplankton and its constituents size classes fig 10 b c show the percentage contributions of nanoplankton and diatoms in the control run ctrl we see from these figures that nanoplankton is the major contributor to total phytoplankton our results corroborate madhu et al 2010 which reports that in the coastal region of seas region nanoplankton contributes an average of 73 2 sd 17 2 to the total chlorophyll the model is able to simulate both the total chlorophyll and its components to a reasonable accuracy hence the model results of phytoplankton classes can be used reliably for our sensitivity experiments the profiles of chlorophyll show a maximum at about 20 m depth recent observational studies in seas eg martin et al 2020 smitha et al 2020 jayaram et al 2021 also corroborate our results the negative values of the differences fig 10d i indicate a decrease of concentration of both the species of phytoplankton diatoms as well as nanoplankton due to enhanced fresh water it is seen that the reduction in concentration of total plankton and nanoplankton in the top 100 m is not much due to river runoff alone figs 10d e and 11 the influence of river runoff is found confined to the changes in diatom concentration and is limited to small region in the southern part of seas fig 10f from figures fig 10f g i it is seen that there is a plume like extension pattern in the plankton difference in the region south of 10⁰n which is almost entirely a contribution due to diatoms while in region north of 10⁰n the decrease is predominantly in the nanoplankton and is restricted to along the coast further there is a decrease in nanoplankton off the coast between 10⁰ and 12⁰n in essence the influence of river runoff is to reduce the diatom concentration limited to the plume region south of 10⁰n while rainfall reduces the nanoplankton and diatom concentrations and thus the total plankton in the seas 4 discussion modelling experiments can provide insights into the role of different forcing factors of a particular process and bring the quantitative contributions of the factors in this study our coupled physical biogeochemical modelling experiments are aimed to investigate the role of fresh water in the seas upwelling ecosystem in our modelling experiments we study both the physical and biological changes due to freshwater the model simulates the parameters like temperature salinity currents and chlorophyll quite well both quantitatively and qualitatively our simulations show features of upwelling to be well represented however the magnitude of dissolved oxygen simulated by the model seems to be much higher compared to observational studies like gupta et al 2016 2021 this may be due to poor initialization of biogeochemical data sets in the coastal regions the model is initialized with climatological data sets which are of very coarse resolution one degree and much of the indian ocean and coastal regions have sparse data most of the available data is from open ocean observations it is therefore very much essential to initialize the model with realistic fields which include observations from coastal regions the marine ecosystem dynamics of eastern arabian sea medas programme has made systematic observations gupta et al 2021 of all the physical biogeochemical parameters along the eastern arabian sea and such data sets would help in initialization which would provide better model simulations 4 1 impact of fresh water and ecological response reasonable impact of fresh water on phytoplankton concentration and its size classes is manifested from our experiments and seen to be more in the nrp than in the nrr implying the stronger role of precipitation than river runoff which is in agreement with the narvekar et al 2021 earlier studies santhikrishna et al 2021 reported an increase in larger size fraction micro of plankton where upwelling was predominant and predominance of smaller nano plankton where upwelling is inhibited due to fresh water in coastal waters of eastern arabian sea such responses and the bio physical chemical coupling are explained below based on our experiments which are also presented in the graphical abstract fig 13 4 2 ecological response to rainfall the impact of rainfall precipitation on nanoplankton can have cascading ecological implications which are discussed as follows in the seas during swm due to strong hydrographic upwelling changes strong biophysical coupling exists the influence of rainfall is to enhance the stratification which results in shallow thermocline and shallower mixed layer fig 10 as the mixed layer becomes thinner it warms faster due to stratification mixing reduces causing reduction in nutrient supply to the euphotic zone from the deeper layers fig 12 of silicate phosphate and nitrate profiles clearly the values of no3 corresponding to ctl nrr red and green profiles more fresh water are lower than those of nrp blue profile less fresh water a zoomed figure of the same showing the changes in the top 30 m is provided as fig s4 supplementary figure hence it implies that in enhanced fresh water cases ctl and nrr mixing is reduced and thereby nutrient is reduced by restricting upwelling which may be sufficient to bring about the change observed in the chlorophyll profiles as these changes are not linear but are complex eg in model no3 concentration depends on concentration of phosphorous further the changes in chlorophyll profile do not reflect exactly the changes in nutrients also the model vertical resolution is 10 m in the top 100 m and the first layer is average of 10 m which make the plots smoother thus the nutrient concentrations and ratios change leading to reduced nanoplankton concentration figs 10 and 11 as nanoplankton is the preferred prey of meso and micro zooplankton this would result in their reduction previous studies also have reported that meso zooplankton dominated by copepods as well as micro zooplankton showed highest grazing rate and preference for nanoplankton in the eas anjusha et al 2018 jagadeesan et al 2017 during swm when the chl a concentration is highest it is reported that by studies like banse 1996 that copepods are usually the dominant meso zooplankton marine ecosystems and play a key role in the aquatic food web through pathways of bacteria phytoplankton and microzooplankton to higher trophic levels such as fishes therefore it implies that enhanced freshening due to rainfall influences meso zooplankton by reducing both micro zooplankton as well as nanoplankton jagadeesan et al 2017 reported that copepods contributed 82 58 98 49 to the total zooplankton biomass in the coastal waters of as during swm high meso zooplankton biomass was reported in the mixed and thermocline layers along the southwest coast of india jyothibabu et al 2010 it has been observed that copepod species composition shifts during the pre swm to the swm and that during swm the abundance of only the smaller copepods increased madhupratap 1987 madhupratap et al 1996 jagadeesan et al 2017 anjusha et al 2018 which reflects on the zooplankton biomass combining our results with these studies suggests of a biophysical link of enhanced freshening due to rainfall altering the aquatic plankton food web thus a possible biophysical link of enhanced freshening due to rainfall on plankton food web dynamics in the upper ocean of seas during swm season is to reduce the preferred prey of a large proportion of zooplankton and further influence the energy transfer to higher trophic levels through restriction of upwelling due to stratification the model simulations of the zooplankton fields could not be saved during the model run due to computational and storage limitations hence the impacts on zooplankton could not be verified from the model results 4 3 ecological response to river runoff the ecological implications of river runoff on diatoms are discussed below the phytoplankton growth rate is the highest during the swm in the south west coast of india studies suggest that diatom blooms peak during swm in the seas and these are dominated by larger diatoms and dinoflagellates due to their intrinsic growth capacity banse et al 1996 ahmed et al 2016 jyothibabu et al 2018a larger phytoplankton micro fraction biomass was higher during the swm anjusha et al 2018 diatoms tend to have significantly higher maximum uptake rates of nutrients than any other group litchman et al 2006 the general conception is that river runoff should be supplying more nutrient leading to enhanced primary production in our experiments presence of river runoff reduces diatom chlorophyll concentration figs 10 and 11 this is explained as follows the presence of fresh water from river runoff as like rainfall restricts upwelling thermocline of the deeper nutrient rich water through stratification leading to less nutrient in the euphotic zone resulting in reduction of phytoplantkon the additional influence is from the supply of nutrients from the rivers that the runoff brings diatoms occupy the mixed layer ml and the presence of fresh water causes the ml to shoal reducing the vertical entrainment to ml resulting in a decline in their concentration hence low nutrient to the mixed layer results in lesser blooming as the ml shoals it gets heated faster this warmer ml modulates the grazing rate of zooplankton meso and micro the light saturation parameter dissolution of silica as these all are functions of temperature in turn the changes in phytoplankton concentration modulate the ml as well as the dynamics in the indian ocean gera et al 2020 the reduction in diatom is supported by a study by mangala et al 2017 which shows that supply of excess n and p over si leads to the development of non diatom blooms fig 12 plots the profiles of silicate showing changes in the three experiments which indicate the same a reduction in the diatom bloom would make nutrient available for growth of smaller plankton nano as discussed earlier that micro and meso zooplankton prefer nanoplankton resulting in increase of zoo plankton thus the energy transfer may be more efficient to the higher trophics thus influencing the food web dynamics in the seas during swm further as the fe c chl c and si c are prognostically predicted in the model the diatom growth depend on the relative concentrations of the nutrients 4 4 nutrient limitations different species in a phytoplankton community are constrained by concentration of different nutrients and growth of marine phytoplankton is complex limited by multiple nutrients at both individual cell level and community level arrigo 2005 the nitrate phosphate no3 po4 ratio of 16 1 in the sea is controlled by the requirements of phytoplankton redfield 1963 the nitrate phosphate ratio in all the three experiments is greater than the general redfield ratio of 16 1 the ratio is around 27 1 for ctl and nrr experiments but is 24 1 a slightly lower value in the nrp experiment the near surface layer shows a ratio less than one 0 9 for silicate to nitrate hence phosphorus and silicate act as the limiting nutrient for plankton productivity and not nitrogen in the near surface layers of the region the phosphate limitation in arabian sea agree with previous modelling studies aumont et al 2003 lower value 25 of nitrate phosphate ratio in nrp indicates greater enrichment of phosphate than nitrate in the nrp experiment although it still remains phosphorus limited this phosphate enrichment during swm upwelling is corroborated by previous observational studies in the waters off kochi fathin et al 2021 in nrp upwelling is enhanced due to lower freshwater and reduced stratification which may be bringing the subsurface phosphate to near surface layer 5 summary and conclusions eastern boundary upwelling systems are highly productive which are known to bring nutrient rich but oxygen deficient water to coasts a coupled physical biogeochemical model is configured for the indian ocean to study the seas eastern boundary upwelling system which simulates all the physical and biogeochemical parameters and their dynamics fairly well despite good simulation of physical parameters the limitation of the model is in the quantitative reproduction of biogeochemical parameters especially in the coastal regions the study demonstrates the capability of coupled physical biogeochemical models in simulating the dynamics of seas and highlights the need for good biogeochemical initialization data sets in the coastal regions for realistic simulation and forecast experiments with this model have manifested that the presence of fresh water decreases the plankton concentration in the seas upwelling system and that the influence of precipitation is larger than that of river runoff the study manifests that phytoplankton concentration is biophysically linked to freshwater through three responses which are 1 limiting the sub surface nutrient supply to euphotic zone by suppressing upwelling through enhanced stratification 2 shoaling and warming of mixed layer and 3 supply of nutrient from river sources phytoplankton response to enhanced freshening through river runoff is complex and involves a multitude of processes our model simulations show that seas is a phosphate limiting system during swm the changes in nanoplankton are mostly linked to changes in rainfall while changes of diatoms are linked to river runoff possible ecological responses biophysical link to enhanced freshening rainfall is to reduce nanoplankton which is the preferred prey of a large portion of zooplankton and thereby influence the energy transfer to higher trophic levels while from enhanced freshening through river runoff is to decrease the diatom blooms thereby making nutrient available for other planktons size groups like nanoplankton thus increasing the energy transfer to higher trophic levels hence fresh water influences the planktonic size structure community thus altering the aquatic plankton food web dynamics the limitation of the study is that these inferences are subject to the assumptions and empirical constants used in the model in future we plan to carry out more sensitivity experiments aimed to break out the further complex dependencies of fresh water credit authorship contribution statement anitha gera conceptualization writing original draft writing review editing visualization r gayathri software writing review editing p ezhilarasan writing review editing v ranga rao supervision writing review editing m v ramana murthy project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank data providers jpl nasa for oscar surface current and chlorophyll data sets the authors are thankful to the ministry of earth sciences govt of india for implementing the ecosystem based services programme project at the national centre for coastal research nccr chennai the authors thank dr k ramu nccr for fruitful discussions which helped us in sorting out key issues on the planktonic groups the authors are sincerely thankful to the secretary moes dr m ravichandran for encouraging the study this is nccr contribution no nccr ms 368 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110246 appendix supplementary materials image application 1 
24271,a three stage medusa polyp ephyra life history model of aurelia aurita is formulated to investigate the role of ephyra and explore the ecological effects of sea surface temperature and seawater salinity on blooms both theoretical analyses and numerical simulations explain the mechanisms of a aurita blooms in specific seasons sensitivity analyses sas characterize the key factors that affect population sizes and provide a basis for feasible and effective control recommendations in agreement with observational data we then summarize the interannual variation patterns in the a aurita population in jiaozhou bay and generalize its distribution in the yellow sea this study shows that the occurrence of strobilation ephyra development and degree of asexual reproduction can significantly influence the steady states of a aurita moreover the population size of medusae is sensitive to medusa mortality and strobilation the findings provide some valuable insights into revealing the mechanisms of a aurita blooms and explain the connection between its population dynamics and environmental factors keywords aurelia aurita mpe model temperature salinity ephyra data availability i have shared the link to my data at the attach file step 1 introduction aurelia aurita scyphozoa semaeostomae is one of the most abundant jellyfish species and is mainly distributed in alongshore sea areas at 70 n 40 s purcell et al 2007 wang and sun 2015 zheng et al 2010 due to its proximity to population centers a aurita is significantly affected by human activities and the damage to humans caused by its blooms is also extremely severe in recent years this species has been blooming frequently in various sea areas including tokyo bay inland area of the sea of japan uye and shimauchi 2005 and in the northern yellow sea and jiaozhou bay in china wang and sun 2015 such blooms may have deleterious effects on fisheries tourism and agriculture wang et al 2015 wang and sun 2015 zheng et al 2010 many researchers are investigating the factors that contribute to the frequent occurrence of a aurita blooms these factors include environmental changes and human activities e g sea surface temperature purcell et al 2007 2009 willcox et al 2007 xing et al 2020 wang and sun 2015 seawater salinity purcell et al 2007 2009 willcox et al 2007 xing et al 2020 dong et al 2019 food supply han and uye 2010 wang et al 2015 xing et al 2020 light intensity purcell et al 2007 2009 eutrophication parsons and lalli 2002 aquaculture lo et al 2008 overfishing daskalov et al 2007 brodeur 2002 lynam et al 2006 and species invasions graham and bayha considering the special role of a aurita in the ecosystem mathematical models were developed to depict the relationships among jellyfish and other species brodeur et al 2011 haraldsson et al 2012 legović 1987 oguz et al 2008 ren et al 2010 rupp and scheurle 2015 ruzicka et al 2007 titelman et al 2007 however these models only considered jellyfish as a trophic level usually as a member of zooplankton in the food chain neglected the characteristics of jellyfish as a critical species and did not focus on the key processes in the life history of jellyfish in reality a aurita has a complex life history one of the main characteristics is generation overlapping zheng et al 2010 the life cycle consists of five stages medusa planula polyp strobila and ephyra medusae are dioecious and release sperm or eggs by sexual reproduction after developing from fertilized eggs planulae settle to the bottom and metamorphose into tentacle bearing polyps some of the polyps reproduce asexually by budding stolon propagation and podocyst generation while the remaining polyps elongate to strobilae and then release free swimming ephyrae after the ephyrae are released strobilae regress to initial polyps and ephyrae develop into medusae see fig 1 some key processes of the life cycle are strongly affected by environmental factors for example asexual reproduction and ephyra development are impacted by temperature while strobilation is impacted by both temperature and salinity wang et al 2015 wang and sun 2015 xing et al 2020 some researchers constructed life history models to investigate the biological and statistical effects jin et al 2012 melica et al 2014 ruiz et al 2012 however a aurita subspecies respond distinctively to environmental factors wang and sun 2015 to adapt to the surroundings polyps select specific alleles to form unique genotypes kogovšek et al 2012 different genotypes determine various physiological and ecological characteristics wang and sun 2015 thus the conclusions derived from experiments and statistical models for specific sea areas are not sufficiently representative to explore the mechanisms of the whole species suchman et al 2012 by considering a aurita as a key species a life history dynamic model can be used to discuss the critical processes and emphasize the effects of environmental factors xie et al 2015 first proposed a general life cycle model for scyphozoa polyp medusa model i e pm model and verified that expanding substrates were the primary cause for increases in scyphozoa population sizes nonetheless there were some deviations between the model conclusions and the actual situation this might be because the model considered only two life stages and overlooked some crucial processes in the life cycle it was observed that ephyrae appeared in both early summer and winter whereas medusae only were found in abundance in late summer and nearly disappeared in winter wang 2013 zheng et al 2010 hernroth and gröndahl 1985 accordingly the life stage of ephyra and its development processes that are impacted by environmental factors should be further discussed moreover the pm model discussed only the impact of temperature and this single factor could not fully account for the scyphozoa outbreak in reality chen et al 2015 xing et al 2019 indicated that salinity seriously affected the reproductive behaviors of a aurita when the salinity is 28 32 the strobilation efficiency remains at high levels additionally the effects of temperature and salinity on the a aurita population interact with each other lin and wang 2019 lo et al 2008 both parameters should be included into models to study the comprehensive and integrated impacts of multiple environmental factors accordingly to explore the ecological effect on blooms the principal objectives of this study are as follows 1 formulate a three stage life history model of a aurita that characterizes the impacts of environmental factors and seasonal variations on population dynamics 2 develop a dynamic analysis and reveal the impacts of key processes on the population structure 3 obtain the critical parameters that affect population sizes by utilizing sensitivity analysis sa and propose recommendations to control blooms 4 summarize the patterns of the interannual variations of the population in jiaozhou bay and generalize its distribution in the yellow sea 2 methods 2 1 model formulation an autonomous dynamic model was established primarily to quantitatively describe the characteristics of the life history of a aurita and to explore the effects of environmental factors we paid attention to population sizes and neglected somatic growth and morphological changes polyp ephyra and medusa are three main stages in the life cycle and are dramatically impacted by environmental factors chi et al 2013 sun et al 2017 therefore the life cycle was simplified to alternations between the bottom dwelling polyp benthic and free swimming ephyra and medusa pelagic stages fig 1 b moreover the sea area was assumed to be sufficiently large and the resources were assumed to be sufficient for a aurita growth planula are the larval stage of polyps grndahl 1989 they were assumed to be different only in their survival rates which implies that the number of polyps recruited by planulae is equal to the number of surviving planulae young polyps and developed polyps differ only in shape so they were combined into the polyp phase in other words growth from young polyps to developed polyps occurred instantaneously a portion of polyps engage in asexual reproduction and the other portion conducts strobilation miyake 2002 we neglected the degeneration loss and regression period from strobilae to polyps and considered that the changes in benthic polyp numbers only came from asexual reproduction xie et al 2015 to understand the impacts of environmental factors in the model we assumed that the asexual reproduction rate α and ephyra development rate θ were functions of temperature gambill and peck 2014 wan and zhang 2012 wang and sun 2015 xing et al 2020 the strobilation parameters including the average release quantity of ephyra β polyp strobilation rate η and strobila development rate q were assumed to be functions of temperature and salinity xing et al 2020 björn et al 2014 let m t p t and e t be the population sizes of medusae polyps and ephyrae at time t respectively by following the above framework a three state model for a aurita growth was described by 2 1 d m d t s 1 θ t e ephyra development d 1 m death d p d t α t 1 η t s p asexual reproduction s 2 γ m medusa sexual reproduction d 2 p death b p 2 intraspecific competition d e d t β t s η t s q t s p polyps strobilation s 1 θ t e development d 3 e death where medusae increments result from ephyrae development s 1 θ t e while the decrements are due to natural death and predation by other species d 1 m increases in polyp numbers are due to sexual reproduction s 2 γ m and asexual reproduction α t 1 η t s p while decreases result from natural death being covered by silt or consumption by nudibranches d 2 p and intraspecific competition for substrates b p 2 changes in ephyrae numbers include recruitment due to strobilation β t s η t s q t s p and reductions resulting from development s 1 θ t e natural death and predation by other species d 3 e considering the periodic changes in temperature and salinity we then explored the effects of seasonal variations on the life history of a aurita the nonautonomous analog of system 2 1 was as follows 2 2 d m d t s 1 θ t e d 1 m d p d t α t 1 η t p s 2 γ m d 2 p b p 2 d e d t β t η t q t p s 1 θ t e d 3 e where α β θ η and q are periodic functions of temperature or salinity over time which are denoted as α t β t θ t η t and q t respectively the parameters of the above systems are listed in table 1 their ranges were estimated and standardized based on empirical or field experimental data provided in the references 2 2 theoretical analysis and parameter calibration theoretical analyses characterize the dynamic behaviors of systems 2 1 first we defined a positively invariant set and showed the dissipativity of the system by a comparison theorem next we explored the existence and stability of equilibria by applying the theory of asymptotically autonomous systems lyapunov second method and lasalle s invariance principle bifurcation dynamics were then considered by using sotomayor theorem finally ecological explanations of the above behaviors connected the model with reality parameter calibration lays the foundation for numerical analyses since different dimensions were adopted in diverse experiments we achieved dimensional homogeneity by standardizing the data by using days fitting functions of the parameters affected by environmental factors β t s η t s q t s α t and θ t were primarily developed by considering the experimental data obtained in jiaozhou bay xing et al 2020 wang and sun 2015 while the data were mostly accessible in the form of figures rather than tables these were first digitized using the digitizer in origin 2017 all analyses were run and all graphs were generated by origin 2017 and matlab 2018b based on the experimental results and model assumptions β t s was calculated as follows β t s number of released ephyrae number of strobilae times of strobilation number of released ephyrae initial number of polyps before strobilation polyps go through two periods that are referred to as the prestrobilation and bet strobilation periods wang et al 2015 we obtained η t s by the following formula mean time before strobilation initial number of polyps η t s pre bet strobilation period 1 η t s experiment period similarly q t s was obtained by q t s 1 period from the threshold of polyps strobilation to the first release of ephyrae 1 pre bet strobilation period polyps can asynchronously engage in asexual reproduction or strobilation while new polyps are released only during asexual reproduction α t s was therefore derived using number of newly released polyps α t initial number of polyps 1 η t s experimental period η t s experimental period pre bet strobilation period length transformations of ephyra umbrella diameters can be introduced to indicate the development progress from ephyra to medusa wang and sun 2015 we therefore deduced θ t via the formula θ t 1 period of ephyra development umbrella diameter after experiment initial umbrella diameter experiment period minimum umbrella diameter of medusa minimum umbrella diameter of ephyra numerical evaluations were applied to confirm the reliability of the simulations this evaluation involved calculating residual sum of squares rss and r square values a low rss value represents a good fit and accurate predictions while r square values indicate the opposite empirical data such as observations and characterizations are also useful to verify the fitting accuracy extrema are the main consideration in this verification the ranges of the other model parameters were then confirmed with the help of the above simulations we considered the annual variations in β t η t q t α t and θ t by utilizing the temperature and salinity data from jiaozhou bay in 2009 on this basis we also obtained the annual variations in three population sizes that were affected by these parameters except for the calculated parameters the values of the other four parameters were determined by using the mean values of their annual variation curves the remaining parameter values in the model are shown in v 0 in table 1 and the value for the initial population was 0 10 10 see appendix a parameter calibration for details 2 3 sa and control recommendations sa is necessary for model development calibration and improvement it consists of two categories according to whether parameter interactions are considered specifically local sensitivity analysis including the differential method wang et al 2017 mainly tests the influence of slight disturbances of a single parameter global sensitivity analysis such as the morris method morris 1991 morris et al 2014 and prcc method marino et al 2009 is capable of determining variations that occur due to simultaneous changes of multiple parameters in this study we used the morris method to qualitatively identify the parameter sensitivities to the internal steady states of the system 2 1 as an analysis algorithm the morris method improves the reliability of results through random and multiple selections from the parameter set morris 1991 both the mean value sensitivity index i e si and standard deviation std of the basic effects of the parameters were calculated separately to obtain the sensitivity properties morris et al 2014 zheng et al 2012 first we observed the overall sensitivity distribution to understand global changes in the system the default parameter value was v 0 in table 1 the parameter variation range which was divided equally into 10 intervals was 10 of the default value parameters were selected 10000 times and then separated into 50 groups to calculate the distribution of sis and stds the average si and std values were next calculated to rank the parameter sensitivities the average si and std values describe the strength of sensitivity and represent the dispersion of the si on average respectively the signs of the average si values indicate the positive or negative correlations among the parameters and steady states by considering the average values we then ranked the parameters in the following order the most sensitive parameter belongs to the first level the second one belongs to the second level the fifth to eighth are in the third level and the remaining parameters are in the fourth level the darker the color is the higher the level i e the more sensitive the parameter this order also applies to the stds the above results were further verified by two other typical methods as a local sensitivity analysis the differential method resembles the morris method in terms of the calculations i e central differences and standardized basic effects but is relatively easier to implement it is also widely used in marine ecological dynamic models wang et al 2017 xie et al 2021 for a further comparison the same default parameters v 0 and variation ranges 10 were selected with great care for use in the calculations moreover the morris method considers the interactions among parameters e g stds which may influence its sensitivity results one approach for solving this problem involves using the partial rank correlation coefficients method prcc to verify the comprehensiveness of the results marino et al 2009 the method uses partial rank correlation coefficients to statistically describe the closeness of the relationships among variables the radar map summarizes all of the results among the three methods and reveals their similarities and key differences we ultimately evaluated the advantages and disadvantages of these methods sas provide measures to qualitatively rank the relative importances of model parameters zheng et al 2012 with the help of sas we proposed control recommendations and evaluated their validity and efficiency 2 4 model validation and application validation is important to confirm the model accuracy utilizing system 2 2 we predicted the population sizes of a aurita and compared the predictions with the field observations the field data were obtained from jiaozhou bay over two years 2009 and 2011 when a aurita were present at different scales wang and sun 2015 wang 2013 wan and zhang 2012 fourier functions are useful for fitting temperature and salinity values over time xie et al 2021 luo 2013 the parameters were optimized based on their sensitivity sensitive parameters were selected more precisely in light of the empirical data while others were modified on demand based on this optimization we predicted the population sizes of all life stages and compared the predictions with the standardized field observations and empirical results following validation an application was introduced to confirm the model generalization and adaptation to further explore the impacts of seasonal variations on a aurita we calculated their interannual variations based on temperature and salinity values from 2014 to 2019 in jiaozhou bay xiaomaidao 120 4 e 36 0 n the life history was also summarized based on the variations and was collated with other literature reviews studies indicated that aurelia sp 1 was the most wildly distributed a aurita type in the northern sea area of china wang 2013 because the population genotypes are the same the system is also applicable to the yellow sea the observations reflected clearly increasing temperature and salinity trends from north to south and from the seashore to the central sea area zhang 2019 accordingly we mainly analyzed the population sizes of a aurita in 2020 in the north shidao 122 4 e 36 9 n central xiaomaidao 120 4 e 36 0 n and south lianyungang 119 4 e 34 8 n parts of the yellow sea to summarize their quantitative distributions in the entire sea area 3 results 3 1 model dynamics to facilitate the discussion below let a s 1 θ t c α t 1 η t s d 2 d s 2 γ e β t s η t s q t s f d 3 s 1 θ t then system 2 1 becomes 3 1 d m d t a e d 1 m d p d t c p d m b p 2 d e d t e p f e where b d d 1 d 2 f 0 a e 0 c r it can be shown that ω m p e 0 m a e l d 1 f 0 p l 0 e e l f is a positively invariant set of system 3 1 where l c d 1 f a d e b d 1 f the system is also dissipative the extinction equilibrium e 0 0 0 0 always exists and is globally asymptotically stable gas if c a d e d 1 f if a 0 e 0 and c 0 then the boundary equilibrium e 1 0 c b c e b f exists and is gas if a 0 e 0 and c 0 then the other boundary equilibrium e 2 0 c b 0 exists and is gas if a 0 e 0 and c a d e d 1 f then there exists a unique internal equilibrium e m p e and is las for c a d e d 1 f a transcritical bifurcation occurs and the stability of the equilibria changes all theoretical findings are summarized in table 2 and detailed proofs are shown in appendix b model dynamics the above dynamic behaviors obtained from the mathematics can be ecologically explained for s 1 θ t 0 no ephyrae can develop into medusae which implies that medusae go extinct while polyps and ephyrae survive for β t s η t s q t s 0 no strobilation occurs and no new ephyrae are released which means that both ephyrae and medusae end in extinction and only polyps survive affected by environmental factors these situations may occur at a specific time such as in january and february this explains why medusae seldom appear in winter in addition to these situations when α t 1 η t s d 2 a d e d 1 f the growth rate of polyps is too small to sustain the a aurita population otherwise all three stages survive put simply the relationships among the asexual reproduction rate strobilation rate and polyp mortality rate determine the appearance of medusae in other seasons environmental factors play a major role in affecting these rate related processes and are hence crucial in regulating a aurita blooms 3 2 global sensitivity analysis by the morris method few outliers and slight quartile deviations are observed in fig 2 there are differences in the median si values as proof in fig 2 a large median si values are found in β η q and d 1 while the values in α and d 2 are relatively low in other words the stable size of medusae is sensitive to supplementation by strobilation and to medusa mortality and is insensitive to asexual reproduction and polyp mortality the sis in α and d 2 also have distinct signs indicating that the results are related to the settings of the default values additionally the average si values reveal that β contributes most to the increases in stable sizes of medusae and ephyrae table 3 the steady state of polyps is most sensitive to b whose impact is adverse strobilation and polyp intraspecific competition are hence the key processes that affect the a aurita population fig 3 a clarifies the influences of different parameters on the same steady state and for the same parameter on different steady states the sensitivities of β and q for three stable sizes all belong to the first or second level so strobilation is crucial to explore the mechanism of a aurita blooms b and d 1 are strongly related to the steady states of polyps and medusae respectively and have relatively weak impacts on the other two states fig 3 b shows a similar hierarchical distribution to fig 3 a this signifies a strong correlation between si and std which is confirmed by their pearson correlation coefficients of 0 3544 0 2772 and 0 7870 while p 0 05 cossarini and solidoro 2008 in addition the stds characterize the interactions among parameters parameters with higher std values have more decentralized distributions and are more greatly affected by other parameters cossarini and solidoro 2008 screening these parameters can improve the optimization efficiency and enhance the rationality of predictions furthermore parameter interactions may cause deviations in the results and decrease the sensitivity accuracy these limitations and resolutions are further clarified in appendix c comparison of sas 3 3 control recommendation as shown in fig 3 a the effects of the polyp asexual reproduction rate α ephyra development rate θ and their mortality rates d 2 and d 3 are insignificant and the control recommendations are therefore discussed without considering these processes table 3 demonstrates that the steady state of medusae is highly dependent on bottom up supplementation by strobilation β q η si 0 40315 0 40221 0 40101 the supplementation decreases under specific environmental conditions such as higher or lower temperatures and salinities eliminating medusae is a direct and effective way to control its population size by increasing d 1 si 0 40176 and concurrently decreasing γ si 0 20008 however uye and shimauchi 2005 discovered that medusae promoted gonadal maturation to release hundreds of sperm and eggs when damaged this may accelerate the reproduction process and result in incomplete elimination medusae numbers decline for smaller s 1 and s 2 si 0 02686 0 19977 periodically fishing for ephyrae and planulae to decrease their numbers is hence efficient in preventing medusa proliferation there is also a negative correlation between b and the population size of medusae si 0 20042 since competition strengthens as the substrate area decreases constraining substrate expansion is a practical control recommendation that can be achieved by restricting the establishment of coastal buildings or regularly measuring and scraping the adherent organisms on the surfaces of coastal substrates considering the critical role of a aurita in ecosystems reasonable control recommendations should reduce the population size and ensure survival of the species table 2 reveals that if s 1 decreases to zero extinction equilibrium e 0 or boundary equilibria e 1 and e 2 may exist but medusae will eventually become extinct in any case decreasing s 2 increases the threshold of c in the stability criterion i e a d e d 1 f as a e 0 which may convert the internal equilibrium e into extinction equilibrium e 0 resulting in increased difficulty for medusa survival in contrast b is excluded from the criteria for determining the dynamic behaviors fig 4 a c clarifies these results that medusae remain alive on small scales under increasing b and go extinct under decreasing s 1 and s 2 therefore the substrate constraint is more flexible while fishing intensities need to be managed to avoid population extinction fig 3 b shows the correlations among parameters we consequently considered the control efficiencies as multiple parameters were varied in fig 4 d f it is feasible to simultaneously implement the above recommendations fig 4 d and e show that if s 1 and s 2 remain at lower levels small scale medusae may be acquired more rapidly as b increases thus the combination of substrate constraints and fisheries can improve the control efficiency 3 4 model validation as indicated in fig 5 temperatures in spring and early summer in 2009 were significantly higher than those in 2011 salinities in 2009 generally varied between 28 5 and 31 5 while in 2011 salinities fluctuated more widely since β η q θ and α are significantly affected by temperature and salinity we substituted their fitting functions into the model for analysis due to the continuous establishment of coastal buildings the substrate areas for polyp attachment have increased note that attachment is affected by factors such as the deposition and coverage of suspended solids and we chose b as 0 009 the survival proportion in ephyra development decreases with increasing temperature so we defined the function s 1 in temperature t 3 2 s 1 t 0 6 t 17 5 0 5 t 17 5 because the polyp mortality rate d 2 does not have significant effects on the three stable sizes we optimized only the other two mortality rates d 1 and d 3 below in addition to temperature and other abiotic factors the population sizes of medusae are also significantly affected by food and other biotic factors especially by zooplankton kogovšek et al 2012 wang et al 2020 in general medusae have three typical growth stages first medusae numbers slowly increase most of the time in winter and spring then grow exponentially with sufficient food and suitable temperatures in late spring and finally shrink rapidly in summer and autumn zheng et al 2010 this phenomenon arises in part because medusa activities decline after releasing planulae and emptying stomach filaments wang and sun 2015 lucas 2001 furthermore the zooplankton population size gradually decreases as temperatures rise but the energy demand of medusae simultaneously increases therefore medusae disappear rapidly due to a lack of energy frandsen and riisgard 1997 wang 2017 we defined a function of medusa mortality rate d 1 at time t 3 3 d 1 t 0 003 1 t 196 0 3 196 t 366 a japanese survey reported that ephyrae were observed at 7 14 c and the peak value appeared at 8 c toyokawa et al 2011 widmer 2005 also indicated that ephyrae remained active and undeveloped at 8 c and grew from 4 mm to 14 5 mm in two weeks at 21 c suitable temperatures for ephyrae growth range from 12 21 c wang and sun 2015 wang 2013 put simply due to low temperatures ephyrae remain undeveloped with a low mortality rate with a rise in temperature ephyrae develop and the rate increases until the temperature reaches a certain value ephyrae activities sharply decrease and the population size rapidly shrinks the function for the ephyra mortality rate d 3 was derived at temperature t 3 4 d 3 t 0 01 t 12 0 08 12 t 21 0 3 t 21 to estimate the polyp numbers in january we initially identified their habitats by observing the locations of ephyrae occurrences the observations indicated that there were three stations where ephyrae appeared in spring among 18 stations wan and zhang 2012 in general the attachment rates of polyps were approximately 0 19 4 47 ind cm 2 on unnatural artificial materials the specific values were affected by the surface roughness and placement angles of the materials wang 2013 cui et al 2018 due to winter migration the ephyrae numbers in january were then approximated based on their populations at the occurrence locations in june wang 2013 hernroth and gröndahl 1985 ye et al 2009 since few medusae are present in winter we finally calculated the initial value as 0 6 8 wang and sun 2015 wan and zhang 2012 fig 6 a and b show that the variation trends of each life stage in 2009 resembled those in 2011 polyps were present throughout the year and reached their peak values in july both ephyrae and medusae fluctuated twice a year in approximately spring and autumn ephyrae numbers fluctuated more strongly in autumn while medusae exhibited opposite trends fig 6 c and d demonstrate that the appearance times and peak values of the first fluctuation were distinct in different years in comparison ephyrae and medusae appeared earlier and reached higher peaks in 2009 specifically ephyrae appeared on 12 april peaked at 28 63703 in late may and then declined and disappeared in july medusae appeared on 3 may reached a peak value of approximately 13 66456 in july and then decreased sharply and disappeared in august however in 2011 ephyrae began to appear on 8 may and reached a peak value of 22 70203 in early june medusae appeared on 27 may peaked at 10 21512 in july and shrank markedly in 2009 the first ephyra were observed in april with an abundance of 0 1066 ind m 3 their abundances then increased to 0 78166 ind m 3 and reached a peak value of 2 80953 ind m 3 in june these population sizes were calculated as 7 33265 and 26 35582 respectively medusae reached a maximum population in july at 1 3 ind m 3 which represented 12 19512 medusae similarly in 2011 ephyrae began to appear on 24 april peaked from may to june and then disappeared on 2 july the abundance on 23 may was 1 72321 ind m 3 which consisted of 16 16520 ephyrae young medusae emerged on 22 may increased rapidly until approaching a peak around the end of july and then disappeared rapidly the predicted results resemble the field observations in terms of the appearance and disappearance times and population sizes of medusae and ephyrae in addition the major ephyrae release period occurs from october to november rather than during the spring this finding seems to validate the results obtained by hernroth and gröndahl 1985 meanwhile ephyrae released in the previous year disappeared completely before spring which confirms that the ehpyrae that are released in the previous year are not the primary source of medusae for the current year wang and li 2015 the similarities between results show the efficiency of the hypothesis confirms the rationality of the model and proves the validity of parameter fitting and range selection however slight differences still exist between the predicted values and actual population size values the possible reasons are the location of the observed sea area method of measurement and precision of fishing equipment wan and zhang 2012 3 5 model application 3 5 1 seasonal variations of a aurita fig 5 c i show the interannual variations in sea surface temperature and seawater salinity at xiaomaidao in jiaozhou bay from 2014 to 2019 temperatures and salinities change periodically over a long time scale the annual variation trends for temperature are generally the same and the maximum and minimum values occur around august and february respectively the salinity oscillates from 29 to 32 changes regularly and often reaches its lowest and highest values in august and may respectively the oscillation amplitudes were large in 2017 and small in other years section 3 1 shows that a aurita populations varied with the environment fig 6 e and f confirm that a aurita populations fluctuated with approximate periodicity from 2014 to 2019 under seasonal variations these fluctuations were similar to those in 2009 and 2011 fig 6 a and b there were concurrent differences in the yearly population quantities and appearance times annual medusa peaks were within a 20 gap of which the maximum occurred in 2014 and minimum occurred in 2018 medusae emerged latest in 2018 on 17 may and earliest in 2019 on 10 may these results generally agree with the empirical data zhang 2019 with the aid of the methodology described in zhang 2019 we calculated the period of strobilation in light of its effective range 10 c 17 c 15 40 proposed by wang et al 2015 xing et al 2020 and appendix a as indicated in fig 5 temperature remained within the range for 44 days and 38 days in 2014 and 2018 respectively these values are exactly the maximum and minimum values that occurred over the years the salinity concurrently maintained an optimum value i e 29 5 32 5 to confirm the strobilation efficiency polyps began strobilation on 16 april 2019 nine days earlier than in 2018 resulting in their earlier entry into development suitable temperatures 12 c 21 c then promoted development in approximately 20 22 days fig 6 e and f these beneficial environmental conditions ultimately led to earlier appearances and larger population sizes of medusae furthermore this conclusion also applies to 2009 and 2011 in 2009 the start date for strobilation was 26 days earlier and the strobilation period was 6 days longer therefore medusae emerged earlier at larger scales the life history of a aurita in jiaozhou bay is therefore summarized as being consistent with the interannual variations polyps are present year round they mainly begin strobilation in early spring and late autumn and reproduce asexually in summer ephyrae appear in spring and autumn they develop rapidly when temperatures rise in early summer and stop growing when temperatures drop in late winter medusae appear in early summer peak in late summer and then shrink rapidly all of the conclusions are consistent with the life history described by wang 2013 3 5 2 quantitative distributions of a aurita in the yellow sea fig 7 a and b show the environmental variations in the three regions in 2020 similar temperature trends appeared in these regions lianyungang has a wider temperature range and higher heating rate throughout the year xiaomaidao takes second place and shidao is the last the salinities vary slightly in xiaomaidao and shidao but fluctuate strongly with a sharp decrease from june to october in lianyungang this may be due to the large amount of precipitation in summer the variations in all three stages are shown in fig 7 c e both the fluctuations and medusa sizes show distinct differences in terms of the fluctuations medusae and ephyrae appeared earliest at shidao followed by xiaomaidao and lianyungang this sequence is also applicable to the descending order of medusa size this is probably because the latitudinal distributions in various sea areas affect the temperature variations resulting in differences in strobilation periods specifically fig 7 a and b indicate that strobilation lasted for 47 45 and 41 days at shidao xiaomaidao and lianyungang respectively moreover precipitation differences in these areas led to diverse salinity variations and the efficiency of strobilation then varied these results are consistent with the observations that a aurita are mainly distributed in the northern and central sea areas of the yellow sea and the biomass of medusae is highest in the north and lowest in the south zhang 2019 zuo et al 2016 in addition sas shed new light on the strong effects of polyp competition and prey concentrations of a aurita in this section the analyses mainly concentrate on specific stations and moderate food supplies to verify the universality of our conclusions we depicted the seasonal patterns in the entire yellow sea to explore the potential causes of a aurita blooms in summary a aurita distributions exhibit apparent seasonal patterns and spatial differences due to regulation by environmental factors meanwhile the variations in zooplankton and establishment of coastal buildings may contribute to episodic blooms the details of the discussion are presented in appendix d seasonal variations of a aurita in the yellow sea 4 discussion in this study we formulated a three stage life history model medusa polyp ephyra model to investigate the effects of environmental factors i e temperature and salinity on growth and bloom formation of a aurita to accomplish this we emphasized the crucial processes affected by these factors such as asexual reproduction strobilation and ephyra development theoretical analyses and numerical simulations explained the impacts of these processes on the population structure sas characterized the effects of these processes on population sizes and verified the rationality of the control recommendations the interannual variations and general distribution shed new light on the practical implications of the model theoretical analyses and numerical simulations indicated that the existence of medusae primarily depended on the occurrence of strobilation e i e β η and q or ephyra development a i e θ and s 1 this conclusion explains the phenomenon that there are specific seasons without medusae appearing due to the higher temperatures required for ephyra development than for strobilation fig 8 f h j few medusae occurred in winter due to an unsuitable environment for released ephyrae in addition only when c exceeded a threshold value could the number of medusae stabilize at a positive constant number this emphasizes the role of asexual reproduction α and polyp mortality d 2 on the appearance of medusae therefore environmental factors are crucial in regulating the population by affecting the above processes the analyses also provide a reference for control recommendations to ensure population survival sas verified that medusae population sizes were mainly dependent on bottom up supplementation indicating that strobilation is the key process that causes a aurita blooms in addition medusa mortality d 1 polyp competition b sexual reproduction γ and ephyra development s 1 are all essential while the effect of asexual reproduction is weak considering that most of the above parameters are significantly affected by temperature and salinity the population sizes of a aurita are also closely associated with these two factors there are recommendations to control a aurita blooms based on to the sensitivity results we can restrict the establishment of coastal buildings or regularly measure and scrape adherent organisms present on the surfaces of coastal substrates to decrease b fishing for ephyrae and planulae in certain seasons to decrease s 1 and s 2 is also valid and effective but is less controllable in contrast simultaneously implementing the above recommendations can further improve the control efficiency some recommendations are relatively difficult to accomplish such as restraining bottom up supplementation by decreasing β η and q these parameters can be used as valuable indicators to measure population variations as the environment changes the validation indicated quantitative agreement between predictions and observations on this basis the model provided further insight into exploring the impacts of seasonal changes on a aurita by utilizing temperature and salinity data in jiaozhou bay the interannual variations of a aurita from 2009 to 2019 show its periodic fluctuations reveal its life history and explain the influence of environmental variations on population dynamics the results reveal that seasonal variations mainly affect a aurita by regulating strobilation in the past ten decades temperatures have steadily increased in jiaozhou bay especially in winter salinities have generally decreased while these declines have mainly occurred in summer from winter to spring the increases in temperature and optimum salinity have extended the strobilation period which may contribute to the increased frequency of blooms consequently we analyzed the quantitative distributions of a aurita in light of the temperature and salinity data in the northern central and southern parts of the yellow sea the results showed differences in both the periods and degrees of medusa appearances in diverse locations in general medusae emerged later at higher latitudes with greater population sizes a aurita were mainly distributed in the northern and central sea areas of the yellow sea these findings ensure the adaptability of the model to provide real world explanations and identify an area with a potentially high incidence of a aurita blooms we can adopt appropriate control activities at the right time and location according to the environmental variations compared with the pm system in xie et al 2015 the mpe system exhibits more comprehensive dynamic behaviors by utilizing sa the mpe system ranks the sensitivities of critical parameters to further validate the feasibility of the control recommendations the cpm podocyst polyp medusa system in xie et al 2021 sheds light on different processes e g podocyst dormancy and ephyra development dormancy is essential in certain species such as nemopilema nomurai while development is indispensable during the life cycle in contrast the cpm system more accurately depicts the behaviors of such species and the mpe system has a wider application for all species furthermore the mpe system verifies the effect of salinity and explores the interactions among environmental factors the effects of seasonal variations on a aurita are also explored to summarize the actual change patterns and general distributions of a aurita furthermore our present study still has some limitations and further problems to be explored in light of the sa the control recommendations focus more on theoretical considerations regarding its practicability a connection can be established between the parameters used and true population responses this can be implemented by the optimized model on the other hand strobilation is a crucial process that is susceptible to environmental factors based on this more abiotic and biotic factors could be incorporated into the system for instance light intensity and nutrient supply which are closely related to frequent eutrophication could be discussed further moreover we considered only the complex life history of the population and neglected its role in the ecosystem hence depicting the interactions among a aurita and other populations such as fish and zooplankton and to emphasize its characteristics as a key species can be investigated in the future credit authorship contribution statement shiyang yu conceptualization methodology software validation formal analysis data curation writing original draft da song conceptualization writing review editing meng fan conceptualization methodology writing review editing congbo xie conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national natural science foundation of china no 12071068 fm and ysy no 11671072 fm and no 11901076 xcb appendix a parameter calibration a 1 standardization fitting functions were first developed for β t s the fitting function is given by β t s 9 46991 exp 2 05070 ln 2 t 13 89346 22 82478 exp 6 86074 ln 2 s 29 98299 34 87645 exp 2 05070 ln 2 t 13 89346 6 86074 ln 2 s 29 98299 6 68662 where r square is 0 92151 and rss is 30 60148 because β t s is always positive the fitting curve was then standardized to acquire β t s 0 14 817 fig 8 a shows that the peak value occurs when the temperature is 13 9 c and the salinity is 30 0 which is in agreement with the field observation data wang and sun 2015 xing et al 2020 similarly the fitting curves of η t s and q t s are η t s 0 15839 1 13052 exp 0 06464 t 12 95244 2 s 35 31666 2 0 06342 sin 0 05715 t 12 95244 cos 0 05715 s 35 31666 2 and q t s 0 02096 0 03303 exp 0 33478 t 13 81665 2 0 00719 s 31 58823 2 where the r square values are 0 61449 and 0 99749 and the rss values are 0 64871 and 7 72565 1 0 7 respectively since η t s and q t s are positive we standardized the results to obtain η t s 0 0 971 and q t s 0 0210 0 0538 fig 8 b and c demonstrated that both curves approach high values when the temperature is approximately 13 c and the salinity is approximately 33 which conforms to the field observation data shi et al 2018 for α we initially fitted both the temperature and salinity data and discovered that the salinity coefficient was clearly lower than the temperature coefficient thus there were no significant differences in the results when the effect of salinity was ignored xing et al 2019 sun et al 2017 2018 since the salinity in jiaozhou bay is between 30 and 34 sun et al 2011 we chose the data with a salinity of 33 to obtain the fitting curve α t 0 2084 exp t 26 04 14 71 2 where r square is 0 6986 and rss is 0 008293 fig 8 d shows α t 0 009 0 208 and its peak value occurs at 26 04 c asexual reproduction activities decline when temperatures are above 27 c duan et al 2020 which is consistent with the fitting result according to the formula the fitted curve of θ t is θ t 0 04244 exp t 16 94 3 479 2 where r square is 1 and rss is 5 541 1 0 10 we calculated θ 0 0 0424 the curve reaches a peak when the temperature is 16 94 c and maintains high levels at temperatures from 12 c to 20 c which agrees with the observed facts wang 2013 the ranges of the remaining parameters in the model were next confirmed sexually mature medusae can release 7000 65000 planulae during reproduction and then shrink rapidly lucas 2001 1996 because the average medusae lifespan in jiaozhou bay is 5 months wang 2013 we obtained γ 22 88 212 42 by time standardization two survival proportions were considered during ephyra development s 1 and planula attachment s 2 in general the development rate declined as temperature decreased according to the quantity changes in ephyrae during development we defined s 1 0 46 0 93 wang 2013 many factors such as substrate materials placement angles and surface roughness can affect the attachment and distribution of polyps in other words these factors influence the attachment rates of planulae cui et al 2018 feng et al 2012 for example most polyps can successfully adhere to the bottoms of buildings only under the influence of sediment burial tides and interspecific competition of algae feng et al 2012 miyake 2002 in addition s 2 is weak by regarding a aurita as the r strategist lucas 1996 yet it can sometimes increase to 0 3 in an appropriate environment conley and uye 2015 in summary we obtained s 2 0 001 0 3 three death rates were estimated medusae can survive from 4 to 8 months naturally and 10 months experimentally wang 2013 so we determined the medusa mortality rate d 1 0 0033 0 0082 the polyp mortality rate d 2 can be regarded at a low value for its adaptability to the environment and dormancy characteristics xie et al 2015 wang 2013 sun et al 2017 however under severe environmental conditions such as high temperatures and low salinities the survival period decreases for example polyps live for 42 to 70 days in experimental environments with temperatures of 20 c and live for 21 days in areas where the temperatures are 27 c such as the yellow sea and bohai sea lo et al 2008 sun et al 2017 duan et al 2020 therefore we defined d 2 0 0 048 ephyra mortality rate d 3 can be affected by diet concentrations ephyrae can survive from 12 to 40 days when these concentrations are 0 0 1 but can remain alive when the concentrations exceed 0 25 wang and li 2015 thus we considered d 3 0 0 083 intraspecific competition among polyps consists mainly of spatial competition on floating piers and artificial buildings when food is available in sufficient quantities since this competition diminishes as the sea area considered increases b is generally considered to be negligible in field studies xie et al 2015 meanwhile this is also approximated as the ratio of the intrinsic growth rate of polyps to the maximum capacity per unit area under experimental conditions xie et al 2015 research indicated that the polyp attachment density on cement was 5 1 ind cm 2 at day 30 and 5 67 1 53 ind cm 2 at day 60 wang 2013 the maximum value of b was 0 037 since the intrinsic growth rate of polyps was 0 175 ind day 1 p 1 at 20 c the range was therefore summarized as b 0 0 037 a 2 annual variation as shown in fig 8 f j there are two peaks in β t η t q t θ t and only one peak in α t the two peaks of β t η t and q t emerged at nearly the same time in contrast the first peak of θ t appeared later and the second peak appeared earlier thus polyps and ephyrae can benefit from the appropriate temperatures and salinities in spring and early summer for strobilation and development which leads to a aurita surging however when ephyrae are released through strobilation in winter no suitable conditions were provided for their development hence few medusae were present during this period in addition the α t peak occurred in august which means that summer was the period for maximum polyp reproduction fig 8 k o show that changes in all five parameters increase medusa population sizes moreover the variation trends affected by β t η t and q t were nearly the same which confirms the effect of strobilation on the three population sizes the medusa population increased noticeably in late spring and winter and the polyp population exhibited rapid growth in summer these changes were caused by ephyrae development θ t and asexual reproduction α t respectively appendix b model dynamics theorem b 1 ω m p e 0 m a e l d 1 f 0 p l 0 e e l f is positively invariant with respect to system 3 1 moreover the system is dissipative proof ω is enclosed with six planes defined as follows π u p m p e 0 m a e l d 1 f 0 p l e e l f π d o w n m p e 0 m a e l d 1 f 0 p l e 0 π r i g h t m p e 0 m a e l d 1 f p l 0 e e l f π l e f t m p e 0 m a e l d 1 f p 0 0 e e l f π f r o n t m p e m a e l d 1 f 0 p l 0 e e l f π b a c k m p e m 0 0 p l 0 e e l f direct calculations show that π u p e e p e l 0 π d o w n e e p 0 π r i g h t p c l d m b l 2 c c p 0 π l e f t p d m 0 π f r o n t m a e a e l f 0 π b a c k m a e 0 consequently any trajectory starting in ω stays in ω for all forward time ω is positively invariant with respect to system 3 1 let l m g d 1 d p a g f e with min d 1 f g 0 then l 3 1 a e d 1 m g d 1 d c p d m b p 2 a g f e p f e b g d 1 d c g b a d e b g d 1 g f p p 2 g m g d 1 d p a g f e b g d 1 4 d c g b a d e b g d 1 g f 2 g m g d 1 d p a g f e which implies that l g l b g d 1 4 d c g b a d e b g d 1 g f 2 by comparison theorem lawrence 2001 we have lim t l t b g d 1 4 d g c g b a d e b g d 1 g f 2 the proof is complete next we investigate the existence and stability of equilibria of system 3 1 theorem b 2 the extinction equilibrium e 0 0 0 0 always exists furthermore if c a d e d 1 f then e 0 is globally asymptotically stable gas if c a d e d 1 f then e 0 is stable but not asymptotically stable if c a d e d 1 f then e 0 is unstable proof to obtain the stability of e 0 we calculate the jacobian matrix as j e 0 d 1 0 a d c 0 0 e f and its characteristic equation reads λ 3 d 1 f c λ 2 d 1 f c d 1 c f λ a d e c d 1 f 0 simple computations show that h 1 0 d 1 f c h 2 0 d 1 f c a d e c d 1 f 1 d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f a d e h 3 0 d 1 f c a d e c d 1 f 0 1 d 1 f c d 1 f 0 0 d 1 f c a d e c d 1 f a d e c d 1 f d 1 f c 2 c d 1 f d 1 f a d e if c a d e d 1 f then the routh hurwitz criteria are satisfied and all eigenvalues of the jacobian matrix j e 0 have negative real parts e 0 is hence locally asymptotically stable las similarly if c a d e d 1 f then e 0 is stable but not asymptotically stable if c a d e d 1 f then e 0 is unstable next we prove that e 0 is gas if c a d e d 1 f consider the lyapunov function defined by v 0 m p e e c 2 f c f 2 a d e c f m p c 3 c 2 f c 2 d 1 a d e c d 1 f c m e a e d 1 c f f p e a c f d 1 c f 2 f a c 2 f c f 2 a d e 2 c f e 2 a e 2 d 1 c f 2 c f p 2 d e d 1 c f 2 f d 1 f c 3 c 2 f c 2 d 1 a d e c d 1 f 2 a c m 2 direct calculation of the derivative of v 0 along the solutions of 3 1 produces v 0 m p e 3 1 e c 2 f c f 2 a d e c f p m m p c 3 c 2 f c 2 d 1 a d e c d 1 f c e m m e a e d 1 c f f p e e p a c f d 1 c f 2 f a c 2 f c f 2 a d e c f e e d e d 1 c f 2 f d 1 f c 3 c 2 f c 2 d 1 a d e c d 1 f a c m m a e 2 d 1 c f c f p p d 1 d 0 a m 2 a b e 2 d 1 c f 2 c f p 3 b e c 2 f c f 2 a d e c f p 2 m a b e d 1 c f f p 2 e where d 0 1 c d 1 f a 2 d 2 e 2 a c 2 d d 1 e a c 2 d e f a c d d 1 2 e a c d d 1 e f a c d e f 2 a d d 1 2 e f a d d 1 e f 2 c 3 d 1 2 f c 3 d 1 f 2 c 2 d 1 3 f 2 c 2 d 1 2 f 2 c 2 d 1 f 3 c d 1 3 f 2 c d 1 2 f 3 note that v 0 m p e is positive definite v 0 m p e is negative semi definite and e 0 is the maximum invariant set of system 3 1 in m p e v 0 0 according to lasalle s invariance principle lawrence 2001 e 0 is gas theorem b 3 if a 0 e 0 and c 0 then the boundary equilibrium e 1 0 c b c e b f exists and is gas proof if a 0 e 0 and c 0 then the existence of e 1 is trivially verified to obtain the stability of the equilibrium we calculate the jacobian matrix as j e 1 d 1 0 0 d c 0 0 e f and its characteristic equation is λ 3 d 1 f c λ 2 d 1 f c d 1 c f λ c d 1 f 0 simple computations show that h 1 1 d 1 f c 0 h 2 1 d 1 f c c d 1 f 1 d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f 0 h 3 1 d 1 f c c d 1 f 0 1 d 1 f c d 1 f 0 0 d 1 f c c d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f 0 the routh hurwitz criteria are satisfied and all eigenvalues of the jacobian matrix j e 1 have negative real parts thus e 1 is las next we prove e 1 is gas according to system 3 1 we have d m d t d 1 m this means that m t 0 as t the equations of p t and e t are now autonomous and their limit behaviors are determined by the semiflow generated by b 1 d p d t c p b p 2 f 1 1 p e d e d t e p f e f 2 1 p e ω 1 p e r 2 0 p c b 0 e c e b f is positively invariant select a dulac function h p e 1 p then f 1 1 h p f 2 1 h e b f p 0 based on the bendixson dulac theorem lawrence 2001 no closed orbit exists in system b 1 we calculate the jacobian matrix as j 1 c 2 b p 0 e f simple calculations on the equilibria 0 0 c b c e b f show that det j 1 0 0 c f 0 tr j 1 c b c e b f c f 0 det j 1 c b c e b f c f 0 then 0 0 is an unable saddle while c b c e b f is a node and is las since ω 1 is simply connected and is positive invariant with no closed orbits contained all solutions of system b 1 starting from ω 1 converge to c b c e b f as t which reveals that c b c e b f is globally attractive from the theory of asymptotically autonomous system mischaikow et al 1995 e 1 is globally attractive thus e 1 is gas theorem b 4 if a 0 e 0 and c 0 then a unique boundary equilibrium e 2 0 c b 0 exists which is gas proof if a 0 e 0 c 0 then the existence of e 2 is readily verified to obtain the stability of the equilibrium we calculate the jacobian matrix as j e 2 d 1 0 a d c 0 0 0 f and its characteristic equation is λ 3 d 1 f c λ 2 d 1 f c d 1 c f λ c d 1 f 0 simple computation shows that h 1 2 d 1 f c 0 h 2 2 d 1 f c c d 1 f 1 d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f 0 h 3 2 d 1 f c c d 1 f 0 1 d 1 f c d 1 f 0 0 d 1 f c c d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f 0 the routh hurwitz criteria are satisfied and all eigenvalues of the jacobian matrix j e 2 have negative real parts thus e 2 is las next we prove e 2 is gas according to system 3 1 we have d e d t f e this implies that e t 0 as t the equations of m t and p t are now autonomous and their limit behaviors are determined by the semiflow generated by b 2 d m d t d 1 m f 1 2 m p d p d t c p d m b p 2 f 2 2 m p moreover ω 2 m p r 2 m 0 0 p c b is positively invariant select a dulac function h m p 1 p then f 1 2 h m f 2 2 h p d 1 p b 0 based on the bendixson dulac theorem lawrence 2001 no closed orbit exists for system b 2 we calculate the jacobian matrix as j 2 d 1 0 d c 2 b p simple calculations on the equilibria 0 0 c b c e b f show that det j 2 0 0 c d 1 0 tr j 2 0 c b c d 1 0 det j 2 0 c b c d 1 0 then 0 0 is an unable saddle while 0 c b is a node and is las because ω 2 is simply connected and is positive invariant with no closed orbits contained all solutions of system b 2 starting from ω 1 converge to 0 c b as t which implies that 0 c b is globally attractive from the theory of asymptotically autonomous system mischaikow et al 1995 e 2 is globally attractive thus e 2 is gas theorem b 5 if a 0 e 0 and c a d e d 1 f then a unique internal equilibrium e m p e exists and is las where m a e 2 b d 1 f 2 c f e a d d 1 p e b f c f e a d d 1 e e 2 b f 2 c f e a d d 1 proof if a 0 e 0 and c a d e d 1 f then we obtain e by simple computation the jacobian matrix is defined as j e d 1 0 a d c 2 b p 0 0 e f and its characteristic equation is λ 3 d 1 f c 2 b p λ 2 d 1 f c 2 b p d 1 f λ a d e c 2 b p d 1 f 0 direct computations show that h 1 d 1 f c 2 b p 0 h 2 d 1 f c 2 b p a d e c 2 b p d 1 f 1 d 1 f c 2 b p d 1 f d 1 f c 2 b p 2 c 2 b p d 1 f d 1 f a d e 0 h 3 d 1 f c 2 b p a d e c 2 b p d 1 f 0 1 d 1 f c 2 b p d 1 f 0 0 d 1 f c 2 b p a d e c 2 b p d 1 f a d e c 2 b p d 1 f d 1 f c 2 b p 2 c 2 b p d 1 f d 1 f a d e 0 the routh hurwitz criteria are satisfied and all eigenvalues of the jacobian matrix j e have negative real parts thus e is las theorem b 6 if a 0 e 0 and c a d e d 1 f then system 3 1 has a transcritical bifurcation at e 0 at this point e 0 is non hyperbolic proof for c a d e d 1 f the jacobian matrix j e 0 has zero eigenvalue thus e 0 is non hyperbolic and a d e d 1 f is the bifurcation value eigenvectors v and w of jacobian matrices j e 0 and j e 0 t corresponding to the zero eigenvalue are calculated as v a e d 1 f e d 1 t w d f d 1 f a d t let x m p e t and denote system 3 1 as x f x c where f x c a e d 1 m c p d m b p 2 e p f e hence f c e 0 a d e d 1 f 0 0 0 t direct calculations show that w t f c e 0 a d e d 1 f 0 w t d f c e 0 a d e d 1 f v d 1 2 f 2 0 w t d 2 f e 0 a d e d 1 f v v 2 b d 1 3 f 3 0 according to sotomayor s theorem lawrence 2001 the bifurcation at e 0 is a transcritical bifurcation the analytical results can also be numerically confirmed we provide some numerical simulations in fig 9 with the parameters given in appendix e appendix c comparison of sas c 1 differential method table 4 shows the strongest negative correlations between the steady state of medusae and mortality d 1 the stable sizes of polyps and ephyrae are most sensitive to intraspecific competition b and strobilation β and q respectively these results are consistent with those obtained using the morris method to compare these results in more detail fig 10 implies that the sensitivity orders between the two methods are essentially the same since the shapes of their radar images fig 10 a f are close to being identical meanwhile there are considerable differences in the numerical results which reveal fine distinctions in their calculations as a local sensitivity analysis the differential method is applied for the case where one parameter changes although its calculations are simpler and faster the results are affected by the default values liu et al 2016 therefore the differential method is suitable in the same sea area for short term analyses when different sea areas are involved or when performing long term analyses the morris method is appropriate to decrease the influence of the default values to obtain general conclusions c 2 prcc method table 5 demonstrates that all the sensitivity results are significant except for α d 2 and d 3 which are the same parameters with low standard deviations in the morris method fig 10 suggests that the sensitivity order of the prcc method resembles the orders of the other two methods however the differences in results for some parameters such as β η q and d 1 which are highly correlated with other parameters are smaller than those obtained by the other methods the symbols of some parameters with low sis in other methods also change in the prcc method which implies a change in sensitivity this is partly because the prcc method is a statistical method that ignores the influence of other parameters during the calculations the prcc method excludes the influence of interactions among parameters on the sensitivity results which more accurately describes the associations between steady states and parameters in contrast the morris method is a good choice to effectively optimize the parameters with high correlations liu et al 2016 according to the three methods the steady states are highly dependent on effective bottom up supplementation of strobilation β q and η and are weakly related to asexual reproduction α in addition they are also dependent on medusa mortality d 1 polyp competition b ephyra development θ and s 1 and sexual reproduction γ most of the above parameters are affected by temperature and salinity which means that the population sizes of a aurita are closely associated with these two factors by applying the above methods we can obtain more comprehensive and general conclusions about the sensitivity appendix d seasonal variation in a aurita in the yellow sea we firstly analyzed the interannual variations in different maritime spaces and for different prey concentrations since polyp competition diminishes as the sea area increases b is set to 0 009 at the jiaozhou bay station and 0 0001 in the central yellow sea aside from medusa mortality prey concentrations also exhibit strong effects on sexual reproduction γ is selected as 100 or 2000 when food supplies are moderate or abundant respectively on this basis we then simulated the population sizes of a aurita in the north central and south parts of the yellow sea in 2020 to further explore the effects of environmental factors on the quantitative distributions fig 11 a d demonstrate that all annual variations show seasonal patterns with similar fluctuation trends specifically increases in b and γ result in steep rises in the annual peak quantities of medusae the trend remains unchanged as b rises while slight differences in peak quantities are observed as γ rises the observations reflected steep episodic rises and declines among zooplankton during these years shi 2015 meanwhile the establishment of coastal buildings reduces polyp competition these are therefore the potential causes of episodic a aurita blooms which verifies our results in the sas fig 11 e g show that the a aurita distributions in the yellow sea exhibit obvious spatial differences medusae emerge later at higher latitudes with higher population sizes because of the longest strobilation period the north yellow sea is the most compatible maritime space for a aurita growth these results are all consistent with those obtained at specific stations in summary temperature and salinity play an important role on the seasonal patterns of a aurita by regulating strobilation moreover abiotic factors e g temperature salinity substrate and prey show strong effects on the variations in quantity resulting in blooms in certain years appendix e supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 110229 appendix e supplementary data the following is the supplementary material related to this article mmc s1 s1 sis and stds of medusae polyps and ephyrae fig 2 s2 standardized data and fitting functions in sea surface temperature and seawater salinity in jiaozhou bay from 2009 to 2019 fig 5 s3 observations of medusae and ephyrae in jiaozhou bay in 2009 and 2011 fig 6 s4 mean sea surface temperatures and seawater salinities per month at shidao xiaomaidao and lianyungang respectively fig 7 s5 the standardized data of β t s η t s q t s α t and θ t fig 8 s6 the parameter values of different dynamic behaviors fig 9 s7 the raw values of sis using the morris differential and prcc methods respectively fig 10 
24271,a three stage medusa polyp ephyra life history model of aurelia aurita is formulated to investigate the role of ephyra and explore the ecological effects of sea surface temperature and seawater salinity on blooms both theoretical analyses and numerical simulations explain the mechanisms of a aurita blooms in specific seasons sensitivity analyses sas characterize the key factors that affect population sizes and provide a basis for feasible and effective control recommendations in agreement with observational data we then summarize the interannual variation patterns in the a aurita population in jiaozhou bay and generalize its distribution in the yellow sea this study shows that the occurrence of strobilation ephyra development and degree of asexual reproduction can significantly influence the steady states of a aurita moreover the population size of medusae is sensitive to medusa mortality and strobilation the findings provide some valuable insights into revealing the mechanisms of a aurita blooms and explain the connection between its population dynamics and environmental factors keywords aurelia aurita mpe model temperature salinity ephyra data availability i have shared the link to my data at the attach file step 1 introduction aurelia aurita scyphozoa semaeostomae is one of the most abundant jellyfish species and is mainly distributed in alongshore sea areas at 70 n 40 s purcell et al 2007 wang and sun 2015 zheng et al 2010 due to its proximity to population centers a aurita is significantly affected by human activities and the damage to humans caused by its blooms is also extremely severe in recent years this species has been blooming frequently in various sea areas including tokyo bay inland area of the sea of japan uye and shimauchi 2005 and in the northern yellow sea and jiaozhou bay in china wang and sun 2015 such blooms may have deleterious effects on fisheries tourism and agriculture wang et al 2015 wang and sun 2015 zheng et al 2010 many researchers are investigating the factors that contribute to the frequent occurrence of a aurita blooms these factors include environmental changes and human activities e g sea surface temperature purcell et al 2007 2009 willcox et al 2007 xing et al 2020 wang and sun 2015 seawater salinity purcell et al 2007 2009 willcox et al 2007 xing et al 2020 dong et al 2019 food supply han and uye 2010 wang et al 2015 xing et al 2020 light intensity purcell et al 2007 2009 eutrophication parsons and lalli 2002 aquaculture lo et al 2008 overfishing daskalov et al 2007 brodeur 2002 lynam et al 2006 and species invasions graham and bayha considering the special role of a aurita in the ecosystem mathematical models were developed to depict the relationships among jellyfish and other species brodeur et al 2011 haraldsson et al 2012 legović 1987 oguz et al 2008 ren et al 2010 rupp and scheurle 2015 ruzicka et al 2007 titelman et al 2007 however these models only considered jellyfish as a trophic level usually as a member of zooplankton in the food chain neglected the characteristics of jellyfish as a critical species and did not focus on the key processes in the life history of jellyfish in reality a aurita has a complex life history one of the main characteristics is generation overlapping zheng et al 2010 the life cycle consists of five stages medusa planula polyp strobila and ephyra medusae are dioecious and release sperm or eggs by sexual reproduction after developing from fertilized eggs planulae settle to the bottom and metamorphose into tentacle bearing polyps some of the polyps reproduce asexually by budding stolon propagation and podocyst generation while the remaining polyps elongate to strobilae and then release free swimming ephyrae after the ephyrae are released strobilae regress to initial polyps and ephyrae develop into medusae see fig 1 some key processes of the life cycle are strongly affected by environmental factors for example asexual reproduction and ephyra development are impacted by temperature while strobilation is impacted by both temperature and salinity wang et al 2015 wang and sun 2015 xing et al 2020 some researchers constructed life history models to investigate the biological and statistical effects jin et al 2012 melica et al 2014 ruiz et al 2012 however a aurita subspecies respond distinctively to environmental factors wang and sun 2015 to adapt to the surroundings polyps select specific alleles to form unique genotypes kogovšek et al 2012 different genotypes determine various physiological and ecological characteristics wang and sun 2015 thus the conclusions derived from experiments and statistical models for specific sea areas are not sufficiently representative to explore the mechanisms of the whole species suchman et al 2012 by considering a aurita as a key species a life history dynamic model can be used to discuss the critical processes and emphasize the effects of environmental factors xie et al 2015 first proposed a general life cycle model for scyphozoa polyp medusa model i e pm model and verified that expanding substrates were the primary cause for increases in scyphozoa population sizes nonetheless there were some deviations between the model conclusions and the actual situation this might be because the model considered only two life stages and overlooked some crucial processes in the life cycle it was observed that ephyrae appeared in both early summer and winter whereas medusae only were found in abundance in late summer and nearly disappeared in winter wang 2013 zheng et al 2010 hernroth and gröndahl 1985 accordingly the life stage of ephyra and its development processes that are impacted by environmental factors should be further discussed moreover the pm model discussed only the impact of temperature and this single factor could not fully account for the scyphozoa outbreak in reality chen et al 2015 xing et al 2019 indicated that salinity seriously affected the reproductive behaviors of a aurita when the salinity is 28 32 the strobilation efficiency remains at high levels additionally the effects of temperature and salinity on the a aurita population interact with each other lin and wang 2019 lo et al 2008 both parameters should be included into models to study the comprehensive and integrated impacts of multiple environmental factors accordingly to explore the ecological effect on blooms the principal objectives of this study are as follows 1 formulate a three stage life history model of a aurita that characterizes the impacts of environmental factors and seasonal variations on population dynamics 2 develop a dynamic analysis and reveal the impacts of key processes on the population structure 3 obtain the critical parameters that affect population sizes by utilizing sensitivity analysis sa and propose recommendations to control blooms 4 summarize the patterns of the interannual variations of the population in jiaozhou bay and generalize its distribution in the yellow sea 2 methods 2 1 model formulation an autonomous dynamic model was established primarily to quantitatively describe the characteristics of the life history of a aurita and to explore the effects of environmental factors we paid attention to population sizes and neglected somatic growth and morphological changes polyp ephyra and medusa are three main stages in the life cycle and are dramatically impacted by environmental factors chi et al 2013 sun et al 2017 therefore the life cycle was simplified to alternations between the bottom dwelling polyp benthic and free swimming ephyra and medusa pelagic stages fig 1 b moreover the sea area was assumed to be sufficiently large and the resources were assumed to be sufficient for a aurita growth planula are the larval stage of polyps grndahl 1989 they were assumed to be different only in their survival rates which implies that the number of polyps recruited by planulae is equal to the number of surviving planulae young polyps and developed polyps differ only in shape so they were combined into the polyp phase in other words growth from young polyps to developed polyps occurred instantaneously a portion of polyps engage in asexual reproduction and the other portion conducts strobilation miyake 2002 we neglected the degeneration loss and regression period from strobilae to polyps and considered that the changes in benthic polyp numbers only came from asexual reproduction xie et al 2015 to understand the impacts of environmental factors in the model we assumed that the asexual reproduction rate α and ephyra development rate θ were functions of temperature gambill and peck 2014 wan and zhang 2012 wang and sun 2015 xing et al 2020 the strobilation parameters including the average release quantity of ephyra β polyp strobilation rate η and strobila development rate q were assumed to be functions of temperature and salinity xing et al 2020 björn et al 2014 let m t p t and e t be the population sizes of medusae polyps and ephyrae at time t respectively by following the above framework a three state model for a aurita growth was described by 2 1 d m d t s 1 θ t e ephyra development d 1 m death d p d t α t 1 η t s p asexual reproduction s 2 γ m medusa sexual reproduction d 2 p death b p 2 intraspecific competition d e d t β t s η t s q t s p polyps strobilation s 1 θ t e development d 3 e death where medusae increments result from ephyrae development s 1 θ t e while the decrements are due to natural death and predation by other species d 1 m increases in polyp numbers are due to sexual reproduction s 2 γ m and asexual reproduction α t 1 η t s p while decreases result from natural death being covered by silt or consumption by nudibranches d 2 p and intraspecific competition for substrates b p 2 changes in ephyrae numbers include recruitment due to strobilation β t s η t s q t s p and reductions resulting from development s 1 θ t e natural death and predation by other species d 3 e considering the periodic changes in temperature and salinity we then explored the effects of seasonal variations on the life history of a aurita the nonautonomous analog of system 2 1 was as follows 2 2 d m d t s 1 θ t e d 1 m d p d t α t 1 η t p s 2 γ m d 2 p b p 2 d e d t β t η t q t p s 1 θ t e d 3 e where α β θ η and q are periodic functions of temperature or salinity over time which are denoted as α t β t θ t η t and q t respectively the parameters of the above systems are listed in table 1 their ranges were estimated and standardized based on empirical or field experimental data provided in the references 2 2 theoretical analysis and parameter calibration theoretical analyses characterize the dynamic behaviors of systems 2 1 first we defined a positively invariant set and showed the dissipativity of the system by a comparison theorem next we explored the existence and stability of equilibria by applying the theory of asymptotically autonomous systems lyapunov second method and lasalle s invariance principle bifurcation dynamics were then considered by using sotomayor theorem finally ecological explanations of the above behaviors connected the model with reality parameter calibration lays the foundation for numerical analyses since different dimensions were adopted in diverse experiments we achieved dimensional homogeneity by standardizing the data by using days fitting functions of the parameters affected by environmental factors β t s η t s q t s α t and θ t were primarily developed by considering the experimental data obtained in jiaozhou bay xing et al 2020 wang and sun 2015 while the data were mostly accessible in the form of figures rather than tables these were first digitized using the digitizer in origin 2017 all analyses were run and all graphs were generated by origin 2017 and matlab 2018b based on the experimental results and model assumptions β t s was calculated as follows β t s number of released ephyrae number of strobilae times of strobilation number of released ephyrae initial number of polyps before strobilation polyps go through two periods that are referred to as the prestrobilation and bet strobilation periods wang et al 2015 we obtained η t s by the following formula mean time before strobilation initial number of polyps η t s pre bet strobilation period 1 η t s experiment period similarly q t s was obtained by q t s 1 period from the threshold of polyps strobilation to the first release of ephyrae 1 pre bet strobilation period polyps can asynchronously engage in asexual reproduction or strobilation while new polyps are released only during asexual reproduction α t s was therefore derived using number of newly released polyps α t initial number of polyps 1 η t s experimental period η t s experimental period pre bet strobilation period length transformations of ephyra umbrella diameters can be introduced to indicate the development progress from ephyra to medusa wang and sun 2015 we therefore deduced θ t via the formula θ t 1 period of ephyra development umbrella diameter after experiment initial umbrella diameter experiment period minimum umbrella diameter of medusa minimum umbrella diameter of ephyra numerical evaluations were applied to confirm the reliability of the simulations this evaluation involved calculating residual sum of squares rss and r square values a low rss value represents a good fit and accurate predictions while r square values indicate the opposite empirical data such as observations and characterizations are also useful to verify the fitting accuracy extrema are the main consideration in this verification the ranges of the other model parameters were then confirmed with the help of the above simulations we considered the annual variations in β t η t q t α t and θ t by utilizing the temperature and salinity data from jiaozhou bay in 2009 on this basis we also obtained the annual variations in three population sizes that were affected by these parameters except for the calculated parameters the values of the other four parameters were determined by using the mean values of their annual variation curves the remaining parameter values in the model are shown in v 0 in table 1 and the value for the initial population was 0 10 10 see appendix a parameter calibration for details 2 3 sa and control recommendations sa is necessary for model development calibration and improvement it consists of two categories according to whether parameter interactions are considered specifically local sensitivity analysis including the differential method wang et al 2017 mainly tests the influence of slight disturbances of a single parameter global sensitivity analysis such as the morris method morris 1991 morris et al 2014 and prcc method marino et al 2009 is capable of determining variations that occur due to simultaneous changes of multiple parameters in this study we used the morris method to qualitatively identify the parameter sensitivities to the internal steady states of the system 2 1 as an analysis algorithm the morris method improves the reliability of results through random and multiple selections from the parameter set morris 1991 both the mean value sensitivity index i e si and standard deviation std of the basic effects of the parameters were calculated separately to obtain the sensitivity properties morris et al 2014 zheng et al 2012 first we observed the overall sensitivity distribution to understand global changes in the system the default parameter value was v 0 in table 1 the parameter variation range which was divided equally into 10 intervals was 10 of the default value parameters were selected 10000 times and then separated into 50 groups to calculate the distribution of sis and stds the average si and std values were next calculated to rank the parameter sensitivities the average si and std values describe the strength of sensitivity and represent the dispersion of the si on average respectively the signs of the average si values indicate the positive or negative correlations among the parameters and steady states by considering the average values we then ranked the parameters in the following order the most sensitive parameter belongs to the first level the second one belongs to the second level the fifth to eighth are in the third level and the remaining parameters are in the fourth level the darker the color is the higher the level i e the more sensitive the parameter this order also applies to the stds the above results were further verified by two other typical methods as a local sensitivity analysis the differential method resembles the morris method in terms of the calculations i e central differences and standardized basic effects but is relatively easier to implement it is also widely used in marine ecological dynamic models wang et al 2017 xie et al 2021 for a further comparison the same default parameters v 0 and variation ranges 10 were selected with great care for use in the calculations moreover the morris method considers the interactions among parameters e g stds which may influence its sensitivity results one approach for solving this problem involves using the partial rank correlation coefficients method prcc to verify the comprehensiveness of the results marino et al 2009 the method uses partial rank correlation coefficients to statistically describe the closeness of the relationships among variables the radar map summarizes all of the results among the three methods and reveals their similarities and key differences we ultimately evaluated the advantages and disadvantages of these methods sas provide measures to qualitatively rank the relative importances of model parameters zheng et al 2012 with the help of sas we proposed control recommendations and evaluated their validity and efficiency 2 4 model validation and application validation is important to confirm the model accuracy utilizing system 2 2 we predicted the population sizes of a aurita and compared the predictions with the field observations the field data were obtained from jiaozhou bay over two years 2009 and 2011 when a aurita were present at different scales wang and sun 2015 wang 2013 wan and zhang 2012 fourier functions are useful for fitting temperature and salinity values over time xie et al 2021 luo 2013 the parameters were optimized based on their sensitivity sensitive parameters were selected more precisely in light of the empirical data while others were modified on demand based on this optimization we predicted the population sizes of all life stages and compared the predictions with the standardized field observations and empirical results following validation an application was introduced to confirm the model generalization and adaptation to further explore the impacts of seasonal variations on a aurita we calculated their interannual variations based on temperature and salinity values from 2014 to 2019 in jiaozhou bay xiaomaidao 120 4 e 36 0 n the life history was also summarized based on the variations and was collated with other literature reviews studies indicated that aurelia sp 1 was the most wildly distributed a aurita type in the northern sea area of china wang 2013 because the population genotypes are the same the system is also applicable to the yellow sea the observations reflected clearly increasing temperature and salinity trends from north to south and from the seashore to the central sea area zhang 2019 accordingly we mainly analyzed the population sizes of a aurita in 2020 in the north shidao 122 4 e 36 9 n central xiaomaidao 120 4 e 36 0 n and south lianyungang 119 4 e 34 8 n parts of the yellow sea to summarize their quantitative distributions in the entire sea area 3 results 3 1 model dynamics to facilitate the discussion below let a s 1 θ t c α t 1 η t s d 2 d s 2 γ e β t s η t s q t s f d 3 s 1 θ t then system 2 1 becomes 3 1 d m d t a e d 1 m d p d t c p d m b p 2 d e d t e p f e where b d d 1 d 2 f 0 a e 0 c r it can be shown that ω m p e 0 m a e l d 1 f 0 p l 0 e e l f is a positively invariant set of system 3 1 where l c d 1 f a d e b d 1 f the system is also dissipative the extinction equilibrium e 0 0 0 0 always exists and is globally asymptotically stable gas if c a d e d 1 f if a 0 e 0 and c 0 then the boundary equilibrium e 1 0 c b c e b f exists and is gas if a 0 e 0 and c 0 then the other boundary equilibrium e 2 0 c b 0 exists and is gas if a 0 e 0 and c a d e d 1 f then there exists a unique internal equilibrium e m p e and is las for c a d e d 1 f a transcritical bifurcation occurs and the stability of the equilibria changes all theoretical findings are summarized in table 2 and detailed proofs are shown in appendix b model dynamics the above dynamic behaviors obtained from the mathematics can be ecologically explained for s 1 θ t 0 no ephyrae can develop into medusae which implies that medusae go extinct while polyps and ephyrae survive for β t s η t s q t s 0 no strobilation occurs and no new ephyrae are released which means that both ephyrae and medusae end in extinction and only polyps survive affected by environmental factors these situations may occur at a specific time such as in january and february this explains why medusae seldom appear in winter in addition to these situations when α t 1 η t s d 2 a d e d 1 f the growth rate of polyps is too small to sustain the a aurita population otherwise all three stages survive put simply the relationships among the asexual reproduction rate strobilation rate and polyp mortality rate determine the appearance of medusae in other seasons environmental factors play a major role in affecting these rate related processes and are hence crucial in regulating a aurita blooms 3 2 global sensitivity analysis by the morris method few outliers and slight quartile deviations are observed in fig 2 there are differences in the median si values as proof in fig 2 a large median si values are found in β η q and d 1 while the values in α and d 2 are relatively low in other words the stable size of medusae is sensitive to supplementation by strobilation and to medusa mortality and is insensitive to asexual reproduction and polyp mortality the sis in α and d 2 also have distinct signs indicating that the results are related to the settings of the default values additionally the average si values reveal that β contributes most to the increases in stable sizes of medusae and ephyrae table 3 the steady state of polyps is most sensitive to b whose impact is adverse strobilation and polyp intraspecific competition are hence the key processes that affect the a aurita population fig 3 a clarifies the influences of different parameters on the same steady state and for the same parameter on different steady states the sensitivities of β and q for three stable sizes all belong to the first or second level so strobilation is crucial to explore the mechanism of a aurita blooms b and d 1 are strongly related to the steady states of polyps and medusae respectively and have relatively weak impacts on the other two states fig 3 b shows a similar hierarchical distribution to fig 3 a this signifies a strong correlation between si and std which is confirmed by their pearson correlation coefficients of 0 3544 0 2772 and 0 7870 while p 0 05 cossarini and solidoro 2008 in addition the stds characterize the interactions among parameters parameters with higher std values have more decentralized distributions and are more greatly affected by other parameters cossarini and solidoro 2008 screening these parameters can improve the optimization efficiency and enhance the rationality of predictions furthermore parameter interactions may cause deviations in the results and decrease the sensitivity accuracy these limitations and resolutions are further clarified in appendix c comparison of sas 3 3 control recommendation as shown in fig 3 a the effects of the polyp asexual reproduction rate α ephyra development rate θ and their mortality rates d 2 and d 3 are insignificant and the control recommendations are therefore discussed without considering these processes table 3 demonstrates that the steady state of medusae is highly dependent on bottom up supplementation by strobilation β q η si 0 40315 0 40221 0 40101 the supplementation decreases under specific environmental conditions such as higher or lower temperatures and salinities eliminating medusae is a direct and effective way to control its population size by increasing d 1 si 0 40176 and concurrently decreasing γ si 0 20008 however uye and shimauchi 2005 discovered that medusae promoted gonadal maturation to release hundreds of sperm and eggs when damaged this may accelerate the reproduction process and result in incomplete elimination medusae numbers decline for smaller s 1 and s 2 si 0 02686 0 19977 periodically fishing for ephyrae and planulae to decrease their numbers is hence efficient in preventing medusa proliferation there is also a negative correlation between b and the population size of medusae si 0 20042 since competition strengthens as the substrate area decreases constraining substrate expansion is a practical control recommendation that can be achieved by restricting the establishment of coastal buildings or regularly measuring and scraping the adherent organisms on the surfaces of coastal substrates considering the critical role of a aurita in ecosystems reasonable control recommendations should reduce the population size and ensure survival of the species table 2 reveals that if s 1 decreases to zero extinction equilibrium e 0 or boundary equilibria e 1 and e 2 may exist but medusae will eventually become extinct in any case decreasing s 2 increases the threshold of c in the stability criterion i e a d e d 1 f as a e 0 which may convert the internal equilibrium e into extinction equilibrium e 0 resulting in increased difficulty for medusa survival in contrast b is excluded from the criteria for determining the dynamic behaviors fig 4 a c clarifies these results that medusae remain alive on small scales under increasing b and go extinct under decreasing s 1 and s 2 therefore the substrate constraint is more flexible while fishing intensities need to be managed to avoid population extinction fig 3 b shows the correlations among parameters we consequently considered the control efficiencies as multiple parameters were varied in fig 4 d f it is feasible to simultaneously implement the above recommendations fig 4 d and e show that if s 1 and s 2 remain at lower levels small scale medusae may be acquired more rapidly as b increases thus the combination of substrate constraints and fisheries can improve the control efficiency 3 4 model validation as indicated in fig 5 temperatures in spring and early summer in 2009 were significantly higher than those in 2011 salinities in 2009 generally varied between 28 5 and 31 5 while in 2011 salinities fluctuated more widely since β η q θ and α are significantly affected by temperature and salinity we substituted their fitting functions into the model for analysis due to the continuous establishment of coastal buildings the substrate areas for polyp attachment have increased note that attachment is affected by factors such as the deposition and coverage of suspended solids and we chose b as 0 009 the survival proportion in ephyra development decreases with increasing temperature so we defined the function s 1 in temperature t 3 2 s 1 t 0 6 t 17 5 0 5 t 17 5 because the polyp mortality rate d 2 does not have significant effects on the three stable sizes we optimized only the other two mortality rates d 1 and d 3 below in addition to temperature and other abiotic factors the population sizes of medusae are also significantly affected by food and other biotic factors especially by zooplankton kogovšek et al 2012 wang et al 2020 in general medusae have three typical growth stages first medusae numbers slowly increase most of the time in winter and spring then grow exponentially with sufficient food and suitable temperatures in late spring and finally shrink rapidly in summer and autumn zheng et al 2010 this phenomenon arises in part because medusa activities decline after releasing planulae and emptying stomach filaments wang and sun 2015 lucas 2001 furthermore the zooplankton population size gradually decreases as temperatures rise but the energy demand of medusae simultaneously increases therefore medusae disappear rapidly due to a lack of energy frandsen and riisgard 1997 wang 2017 we defined a function of medusa mortality rate d 1 at time t 3 3 d 1 t 0 003 1 t 196 0 3 196 t 366 a japanese survey reported that ephyrae were observed at 7 14 c and the peak value appeared at 8 c toyokawa et al 2011 widmer 2005 also indicated that ephyrae remained active and undeveloped at 8 c and grew from 4 mm to 14 5 mm in two weeks at 21 c suitable temperatures for ephyrae growth range from 12 21 c wang and sun 2015 wang 2013 put simply due to low temperatures ephyrae remain undeveloped with a low mortality rate with a rise in temperature ephyrae develop and the rate increases until the temperature reaches a certain value ephyrae activities sharply decrease and the population size rapidly shrinks the function for the ephyra mortality rate d 3 was derived at temperature t 3 4 d 3 t 0 01 t 12 0 08 12 t 21 0 3 t 21 to estimate the polyp numbers in january we initially identified their habitats by observing the locations of ephyrae occurrences the observations indicated that there were three stations where ephyrae appeared in spring among 18 stations wan and zhang 2012 in general the attachment rates of polyps were approximately 0 19 4 47 ind cm 2 on unnatural artificial materials the specific values were affected by the surface roughness and placement angles of the materials wang 2013 cui et al 2018 due to winter migration the ephyrae numbers in january were then approximated based on their populations at the occurrence locations in june wang 2013 hernroth and gröndahl 1985 ye et al 2009 since few medusae are present in winter we finally calculated the initial value as 0 6 8 wang and sun 2015 wan and zhang 2012 fig 6 a and b show that the variation trends of each life stage in 2009 resembled those in 2011 polyps were present throughout the year and reached their peak values in july both ephyrae and medusae fluctuated twice a year in approximately spring and autumn ephyrae numbers fluctuated more strongly in autumn while medusae exhibited opposite trends fig 6 c and d demonstrate that the appearance times and peak values of the first fluctuation were distinct in different years in comparison ephyrae and medusae appeared earlier and reached higher peaks in 2009 specifically ephyrae appeared on 12 april peaked at 28 63703 in late may and then declined and disappeared in july medusae appeared on 3 may reached a peak value of approximately 13 66456 in july and then decreased sharply and disappeared in august however in 2011 ephyrae began to appear on 8 may and reached a peak value of 22 70203 in early june medusae appeared on 27 may peaked at 10 21512 in july and shrank markedly in 2009 the first ephyra were observed in april with an abundance of 0 1066 ind m 3 their abundances then increased to 0 78166 ind m 3 and reached a peak value of 2 80953 ind m 3 in june these population sizes were calculated as 7 33265 and 26 35582 respectively medusae reached a maximum population in july at 1 3 ind m 3 which represented 12 19512 medusae similarly in 2011 ephyrae began to appear on 24 april peaked from may to june and then disappeared on 2 july the abundance on 23 may was 1 72321 ind m 3 which consisted of 16 16520 ephyrae young medusae emerged on 22 may increased rapidly until approaching a peak around the end of july and then disappeared rapidly the predicted results resemble the field observations in terms of the appearance and disappearance times and population sizes of medusae and ephyrae in addition the major ephyrae release period occurs from october to november rather than during the spring this finding seems to validate the results obtained by hernroth and gröndahl 1985 meanwhile ephyrae released in the previous year disappeared completely before spring which confirms that the ehpyrae that are released in the previous year are not the primary source of medusae for the current year wang and li 2015 the similarities between results show the efficiency of the hypothesis confirms the rationality of the model and proves the validity of parameter fitting and range selection however slight differences still exist between the predicted values and actual population size values the possible reasons are the location of the observed sea area method of measurement and precision of fishing equipment wan and zhang 2012 3 5 model application 3 5 1 seasonal variations of a aurita fig 5 c i show the interannual variations in sea surface temperature and seawater salinity at xiaomaidao in jiaozhou bay from 2014 to 2019 temperatures and salinities change periodically over a long time scale the annual variation trends for temperature are generally the same and the maximum and minimum values occur around august and february respectively the salinity oscillates from 29 to 32 changes regularly and often reaches its lowest and highest values in august and may respectively the oscillation amplitudes were large in 2017 and small in other years section 3 1 shows that a aurita populations varied with the environment fig 6 e and f confirm that a aurita populations fluctuated with approximate periodicity from 2014 to 2019 under seasonal variations these fluctuations were similar to those in 2009 and 2011 fig 6 a and b there were concurrent differences in the yearly population quantities and appearance times annual medusa peaks were within a 20 gap of which the maximum occurred in 2014 and minimum occurred in 2018 medusae emerged latest in 2018 on 17 may and earliest in 2019 on 10 may these results generally agree with the empirical data zhang 2019 with the aid of the methodology described in zhang 2019 we calculated the period of strobilation in light of its effective range 10 c 17 c 15 40 proposed by wang et al 2015 xing et al 2020 and appendix a as indicated in fig 5 temperature remained within the range for 44 days and 38 days in 2014 and 2018 respectively these values are exactly the maximum and minimum values that occurred over the years the salinity concurrently maintained an optimum value i e 29 5 32 5 to confirm the strobilation efficiency polyps began strobilation on 16 april 2019 nine days earlier than in 2018 resulting in their earlier entry into development suitable temperatures 12 c 21 c then promoted development in approximately 20 22 days fig 6 e and f these beneficial environmental conditions ultimately led to earlier appearances and larger population sizes of medusae furthermore this conclusion also applies to 2009 and 2011 in 2009 the start date for strobilation was 26 days earlier and the strobilation period was 6 days longer therefore medusae emerged earlier at larger scales the life history of a aurita in jiaozhou bay is therefore summarized as being consistent with the interannual variations polyps are present year round they mainly begin strobilation in early spring and late autumn and reproduce asexually in summer ephyrae appear in spring and autumn they develop rapidly when temperatures rise in early summer and stop growing when temperatures drop in late winter medusae appear in early summer peak in late summer and then shrink rapidly all of the conclusions are consistent with the life history described by wang 2013 3 5 2 quantitative distributions of a aurita in the yellow sea fig 7 a and b show the environmental variations in the three regions in 2020 similar temperature trends appeared in these regions lianyungang has a wider temperature range and higher heating rate throughout the year xiaomaidao takes second place and shidao is the last the salinities vary slightly in xiaomaidao and shidao but fluctuate strongly with a sharp decrease from june to october in lianyungang this may be due to the large amount of precipitation in summer the variations in all three stages are shown in fig 7 c e both the fluctuations and medusa sizes show distinct differences in terms of the fluctuations medusae and ephyrae appeared earliest at shidao followed by xiaomaidao and lianyungang this sequence is also applicable to the descending order of medusa size this is probably because the latitudinal distributions in various sea areas affect the temperature variations resulting in differences in strobilation periods specifically fig 7 a and b indicate that strobilation lasted for 47 45 and 41 days at shidao xiaomaidao and lianyungang respectively moreover precipitation differences in these areas led to diverse salinity variations and the efficiency of strobilation then varied these results are consistent with the observations that a aurita are mainly distributed in the northern and central sea areas of the yellow sea and the biomass of medusae is highest in the north and lowest in the south zhang 2019 zuo et al 2016 in addition sas shed new light on the strong effects of polyp competition and prey concentrations of a aurita in this section the analyses mainly concentrate on specific stations and moderate food supplies to verify the universality of our conclusions we depicted the seasonal patterns in the entire yellow sea to explore the potential causes of a aurita blooms in summary a aurita distributions exhibit apparent seasonal patterns and spatial differences due to regulation by environmental factors meanwhile the variations in zooplankton and establishment of coastal buildings may contribute to episodic blooms the details of the discussion are presented in appendix d seasonal variations of a aurita in the yellow sea 4 discussion in this study we formulated a three stage life history model medusa polyp ephyra model to investigate the effects of environmental factors i e temperature and salinity on growth and bloom formation of a aurita to accomplish this we emphasized the crucial processes affected by these factors such as asexual reproduction strobilation and ephyra development theoretical analyses and numerical simulations explained the impacts of these processes on the population structure sas characterized the effects of these processes on population sizes and verified the rationality of the control recommendations the interannual variations and general distribution shed new light on the practical implications of the model theoretical analyses and numerical simulations indicated that the existence of medusae primarily depended on the occurrence of strobilation e i e β η and q or ephyra development a i e θ and s 1 this conclusion explains the phenomenon that there are specific seasons without medusae appearing due to the higher temperatures required for ephyra development than for strobilation fig 8 f h j few medusae occurred in winter due to an unsuitable environment for released ephyrae in addition only when c exceeded a threshold value could the number of medusae stabilize at a positive constant number this emphasizes the role of asexual reproduction α and polyp mortality d 2 on the appearance of medusae therefore environmental factors are crucial in regulating the population by affecting the above processes the analyses also provide a reference for control recommendations to ensure population survival sas verified that medusae population sizes were mainly dependent on bottom up supplementation indicating that strobilation is the key process that causes a aurita blooms in addition medusa mortality d 1 polyp competition b sexual reproduction γ and ephyra development s 1 are all essential while the effect of asexual reproduction is weak considering that most of the above parameters are significantly affected by temperature and salinity the population sizes of a aurita are also closely associated with these two factors there are recommendations to control a aurita blooms based on to the sensitivity results we can restrict the establishment of coastal buildings or regularly measure and scrape adherent organisms present on the surfaces of coastal substrates to decrease b fishing for ephyrae and planulae in certain seasons to decrease s 1 and s 2 is also valid and effective but is less controllable in contrast simultaneously implementing the above recommendations can further improve the control efficiency some recommendations are relatively difficult to accomplish such as restraining bottom up supplementation by decreasing β η and q these parameters can be used as valuable indicators to measure population variations as the environment changes the validation indicated quantitative agreement between predictions and observations on this basis the model provided further insight into exploring the impacts of seasonal changes on a aurita by utilizing temperature and salinity data in jiaozhou bay the interannual variations of a aurita from 2009 to 2019 show its periodic fluctuations reveal its life history and explain the influence of environmental variations on population dynamics the results reveal that seasonal variations mainly affect a aurita by regulating strobilation in the past ten decades temperatures have steadily increased in jiaozhou bay especially in winter salinities have generally decreased while these declines have mainly occurred in summer from winter to spring the increases in temperature and optimum salinity have extended the strobilation period which may contribute to the increased frequency of blooms consequently we analyzed the quantitative distributions of a aurita in light of the temperature and salinity data in the northern central and southern parts of the yellow sea the results showed differences in both the periods and degrees of medusa appearances in diverse locations in general medusae emerged later at higher latitudes with greater population sizes a aurita were mainly distributed in the northern and central sea areas of the yellow sea these findings ensure the adaptability of the model to provide real world explanations and identify an area with a potentially high incidence of a aurita blooms we can adopt appropriate control activities at the right time and location according to the environmental variations compared with the pm system in xie et al 2015 the mpe system exhibits more comprehensive dynamic behaviors by utilizing sa the mpe system ranks the sensitivities of critical parameters to further validate the feasibility of the control recommendations the cpm podocyst polyp medusa system in xie et al 2021 sheds light on different processes e g podocyst dormancy and ephyra development dormancy is essential in certain species such as nemopilema nomurai while development is indispensable during the life cycle in contrast the cpm system more accurately depicts the behaviors of such species and the mpe system has a wider application for all species furthermore the mpe system verifies the effect of salinity and explores the interactions among environmental factors the effects of seasonal variations on a aurita are also explored to summarize the actual change patterns and general distributions of a aurita furthermore our present study still has some limitations and further problems to be explored in light of the sa the control recommendations focus more on theoretical considerations regarding its practicability a connection can be established between the parameters used and true population responses this can be implemented by the optimized model on the other hand strobilation is a crucial process that is susceptible to environmental factors based on this more abiotic and biotic factors could be incorporated into the system for instance light intensity and nutrient supply which are closely related to frequent eutrophication could be discussed further moreover we considered only the complex life history of the population and neglected its role in the ecosystem hence depicting the interactions among a aurita and other populations such as fish and zooplankton and to emphasize its characteristics as a key species can be investigated in the future credit authorship contribution statement shiyang yu conceptualization methodology software validation formal analysis data curation writing original draft da song conceptualization writing review editing meng fan conceptualization methodology writing review editing congbo xie conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national natural science foundation of china no 12071068 fm and ysy no 11671072 fm and no 11901076 xcb appendix a parameter calibration a 1 standardization fitting functions were first developed for β t s the fitting function is given by β t s 9 46991 exp 2 05070 ln 2 t 13 89346 22 82478 exp 6 86074 ln 2 s 29 98299 34 87645 exp 2 05070 ln 2 t 13 89346 6 86074 ln 2 s 29 98299 6 68662 where r square is 0 92151 and rss is 30 60148 because β t s is always positive the fitting curve was then standardized to acquire β t s 0 14 817 fig 8 a shows that the peak value occurs when the temperature is 13 9 c and the salinity is 30 0 which is in agreement with the field observation data wang and sun 2015 xing et al 2020 similarly the fitting curves of η t s and q t s are η t s 0 15839 1 13052 exp 0 06464 t 12 95244 2 s 35 31666 2 0 06342 sin 0 05715 t 12 95244 cos 0 05715 s 35 31666 2 and q t s 0 02096 0 03303 exp 0 33478 t 13 81665 2 0 00719 s 31 58823 2 where the r square values are 0 61449 and 0 99749 and the rss values are 0 64871 and 7 72565 1 0 7 respectively since η t s and q t s are positive we standardized the results to obtain η t s 0 0 971 and q t s 0 0210 0 0538 fig 8 b and c demonstrated that both curves approach high values when the temperature is approximately 13 c and the salinity is approximately 33 which conforms to the field observation data shi et al 2018 for α we initially fitted both the temperature and salinity data and discovered that the salinity coefficient was clearly lower than the temperature coefficient thus there were no significant differences in the results when the effect of salinity was ignored xing et al 2019 sun et al 2017 2018 since the salinity in jiaozhou bay is between 30 and 34 sun et al 2011 we chose the data with a salinity of 33 to obtain the fitting curve α t 0 2084 exp t 26 04 14 71 2 where r square is 0 6986 and rss is 0 008293 fig 8 d shows α t 0 009 0 208 and its peak value occurs at 26 04 c asexual reproduction activities decline when temperatures are above 27 c duan et al 2020 which is consistent with the fitting result according to the formula the fitted curve of θ t is θ t 0 04244 exp t 16 94 3 479 2 where r square is 1 and rss is 5 541 1 0 10 we calculated θ 0 0 0424 the curve reaches a peak when the temperature is 16 94 c and maintains high levels at temperatures from 12 c to 20 c which agrees with the observed facts wang 2013 the ranges of the remaining parameters in the model were next confirmed sexually mature medusae can release 7000 65000 planulae during reproduction and then shrink rapidly lucas 2001 1996 because the average medusae lifespan in jiaozhou bay is 5 months wang 2013 we obtained γ 22 88 212 42 by time standardization two survival proportions were considered during ephyra development s 1 and planula attachment s 2 in general the development rate declined as temperature decreased according to the quantity changes in ephyrae during development we defined s 1 0 46 0 93 wang 2013 many factors such as substrate materials placement angles and surface roughness can affect the attachment and distribution of polyps in other words these factors influence the attachment rates of planulae cui et al 2018 feng et al 2012 for example most polyps can successfully adhere to the bottoms of buildings only under the influence of sediment burial tides and interspecific competition of algae feng et al 2012 miyake 2002 in addition s 2 is weak by regarding a aurita as the r strategist lucas 1996 yet it can sometimes increase to 0 3 in an appropriate environment conley and uye 2015 in summary we obtained s 2 0 001 0 3 three death rates were estimated medusae can survive from 4 to 8 months naturally and 10 months experimentally wang 2013 so we determined the medusa mortality rate d 1 0 0033 0 0082 the polyp mortality rate d 2 can be regarded at a low value for its adaptability to the environment and dormancy characteristics xie et al 2015 wang 2013 sun et al 2017 however under severe environmental conditions such as high temperatures and low salinities the survival period decreases for example polyps live for 42 to 70 days in experimental environments with temperatures of 20 c and live for 21 days in areas where the temperatures are 27 c such as the yellow sea and bohai sea lo et al 2008 sun et al 2017 duan et al 2020 therefore we defined d 2 0 0 048 ephyra mortality rate d 3 can be affected by diet concentrations ephyrae can survive from 12 to 40 days when these concentrations are 0 0 1 but can remain alive when the concentrations exceed 0 25 wang and li 2015 thus we considered d 3 0 0 083 intraspecific competition among polyps consists mainly of spatial competition on floating piers and artificial buildings when food is available in sufficient quantities since this competition diminishes as the sea area considered increases b is generally considered to be negligible in field studies xie et al 2015 meanwhile this is also approximated as the ratio of the intrinsic growth rate of polyps to the maximum capacity per unit area under experimental conditions xie et al 2015 research indicated that the polyp attachment density on cement was 5 1 ind cm 2 at day 30 and 5 67 1 53 ind cm 2 at day 60 wang 2013 the maximum value of b was 0 037 since the intrinsic growth rate of polyps was 0 175 ind day 1 p 1 at 20 c the range was therefore summarized as b 0 0 037 a 2 annual variation as shown in fig 8 f j there are two peaks in β t η t q t θ t and only one peak in α t the two peaks of β t η t and q t emerged at nearly the same time in contrast the first peak of θ t appeared later and the second peak appeared earlier thus polyps and ephyrae can benefit from the appropriate temperatures and salinities in spring and early summer for strobilation and development which leads to a aurita surging however when ephyrae are released through strobilation in winter no suitable conditions were provided for their development hence few medusae were present during this period in addition the α t peak occurred in august which means that summer was the period for maximum polyp reproduction fig 8 k o show that changes in all five parameters increase medusa population sizes moreover the variation trends affected by β t η t and q t were nearly the same which confirms the effect of strobilation on the three population sizes the medusa population increased noticeably in late spring and winter and the polyp population exhibited rapid growth in summer these changes were caused by ephyrae development θ t and asexual reproduction α t respectively appendix b model dynamics theorem b 1 ω m p e 0 m a e l d 1 f 0 p l 0 e e l f is positively invariant with respect to system 3 1 moreover the system is dissipative proof ω is enclosed with six planes defined as follows π u p m p e 0 m a e l d 1 f 0 p l e e l f π d o w n m p e 0 m a e l d 1 f 0 p l e 0 π r i g h t m p e 0 m a e l d 1 f p l 0 e e l f π l e f t m p e 0 m a e l d 1 f p 0 0 e e l f π f r o n t m p e m a e l d 1 f 0 p l 0 e e l f π b a c k m p e m 0 0 p l 0 e e l f direct calculations show that π u p e e p e l 0 π d o w n e e p 0 π r i g h t p c l d m b l 2 c c p 0 π l e f t p d m 0 π f r o n t m a e a e l f 0 π b a c k m a e 0 consequently any trajectory starting in ω stays in ω for all forward time ω is positively invariant with respect to system 3 1 let l m g d 1 d p a g f e with min d 1 f g 0 then l 3 1 a e d 1 m g d 1 d c p d m b p 2 a g f e p f e b g d 1 d c g b a d e b g d 1 g f p p 2 g m g d 1 d p a g f e b g d 1 4 d c g b a d e b g d 1 g f 2 g m g d 1 d p a g f e which implies that l g l b g d 1 4 d c g b a d e b g d 1 g f 2 by comparison theorem lawrence 2001 we have lim t l t b g d 1 4 d g c g b a d e b g d 1 g f 2 the proof is complete next we investigate the existence and stability of equilibria of system 3 1 theorem b 2 the extinction equilibrium e 0 0 0 0 always exists furthermore if c a d e d 1 f then e 0 is globally asymptotically stable gas if c a d e d 1 f then e 0 is stable but not asymptotically stable if c a d e d 1 f then e 0 is unstable proof to obtain the stability of e 0 we calculate the jacobian matrix as j e 0 d 1 0 a d c 0 0 e f and its characteristic equation reads λ 3 d 1 f c λ 2 d 1 f c d 1 c f λ a d e c d 1 f 0 simple computations show that h 1 0 d 1 f c h 2 0 d 1 f c a d e c d 1 f 1 d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f a d e h 3 0 d 1 f c a d e c d 1 f 0 1 d 1 f c d 1 f 0 0 d 1 f c a d e c d 1 f a d e c d 1 f d 1 f c 2 c d 1 f d 1 f a d e if c a d e d 1 f then the routh hurwitz criteria are satisfied and all eigenvalues of the jacobian matrix j e 0 have negative real parts e 0 is hence locally asymptotically stable las similarly if c a d e d 1 f then e 0 is stable but not asymptotically stable if c a d e d 1 f then e 0 is unstable next we prove that e 0 is gas if c a d e d 1 f consider the lyapunov function defined by v 0 m p e e c 2 f c f 2 a d e c f m p c 3 c 2 f c 2 d 1 a d e c d 1 f c m e a e d 1 c f f p e a c f d 1 c f 2 f a c 2 f c f 2 a d e 2 c f e 2 a e 2 d 1 c f 2 c f p 2 d e d 1 c f 2 f d 1 f c 3 c 2 f c 2 d 1 a d e c d 1 f 2 a c m 2 direct calculation of the derivative of v 0 along the solutions of 3 1 produces v 0 m p e 3 1 e c 2 f c f 2 a d e c f p m m p c 3 c 2 f c 2 d 1 a d e c d 1 f c e m m e a e d 1 c f f p e e p a c f d 1 c f 2 f a c 2 f c f 2 a d e c f e e d e d 1 c f 2 f d 1 f c 3 c 2 f c 2 d 1 a d e c d 1 f a c m m a e 2 d 1 c f c f p p d 1 d 0 a m 2 a b e 2 d 1 c f 2 c f p 3 b e c 2 f c f 2 a d e c f p 2 m a b e d 1 c f f p 2 e where d 0 1 c d 1 f a 2 d 2 e 2 a c 2 d d 1 e a c 2 d e f a c d d 1 2 e a c d d 1 e f a c d e f 2 a d d 1 2 e f a d d 1 e f 2 c 3 d 1 2 f c 3 d 1 f 2 c 2 d 1 3 f 2 c 2 d 1 2 f 2 c 2 d 1 f 3 c d 1 3 f 2 c d 1 2 f 3 note that v 0 m p e is positive definite v 0 m p e is negative semi definite and e 0 is the maximum invariant set of system 3 1 in m p e v 0 0 according to lasalle s invariance principle lawrence 2001 e 0 is gas theorem b 3 if a 0 e 0 and c 0 then the boundary equilibrium e 1 0 c b c e b f exists and is gas proof if a 0 e 0 and c 0 then the existence of e 1 is trivially verified to obtain the stability of the equilibrium we calculate the jacobian matrix as j e 1 d 1 0 0 d c 0 0 e f and its characteristic equation is λ 3 d 1 f c λ 2 d 1 f c d 1 c f λ c d 1 f 0 simple computations show that h 1 1 d 1 f c 0 h 2 1 d 1 f c c d 1 f 1 d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f 0 h 3 1 d 1 f c c d 1 f 0 1 d 1 f c d 1 f 0 0 d 1 f c c d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f 0 the routh hurwitz criteria are satisfied and all eigenvalues of the jacobian matrix j e 1 have negative real parts thus e 1 is las next we prove e 1 is gas according to system 3 1 we have d m d t d 1 m this means that m t 0 as t the equations of p t and e t are now autonomous and their limit behaviors are determined by the semiflow generated by b 1 d p d t c p b p 2 f 1 1 p e d e d t e p f e f 2 1 p e ω 1 p e r 2 0 p c b 0 e c e b f is positively invariant select a dulac function h p e 1 p then f 1 1 h p f 2 1 h e b f p 0 based on the bendixson dulac theorem lawrence 2001 no closed orbit exists in system b 1 we calculate the jacobian matrix as j 1 c 2 b p 0 e f simple calculations on the equilibria 0 0 c b c e b f show that det j 1 0 0 c f 0 tr j 1 c b c e b f c f 0 det j 1 c b c e b f c f 0 then 0 0 is an unable saddle while c b c e b f is a node and is las since ω 1 is simply connected and is positive invariant with no closed orbits contained all solutions of system b 1 starting from ω 1 converge to c b c e b f as t which reveals that c b c e b f is globally attractive from the theory of asymptotically autonomous system mischaikow et al 1995 e 1 is globally attractive thus e 1 is gas theorem b 4 if a 0 e 0 and c 0 then a unique boundary equilibrium e 2 0 c b 0 exists which is gas proof if a 0 e 0 c 0 then the existence of e 2 is readily verified to obtain the stability of the equilibrium we calculate the jacobian matrix as j e 2 d 1 0 a d c 0 0 0 f and its characteristic equation is λ 3 d 1 f c λ 2 d 1 f c d 1 c f λ c d 1 f 0 simple computation shows that h 1 2 d 1 f c 0 h 2 2 d 1 f c c d 1 f 1 d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f 0 h 3 2 d 1 f c c d 1 f 0 1 d 1 f c d 1 f 0 0 d 1 f c c d 1 f c d 1 f d 1 f c 2 c d 1 f d 1 f 0 the routh hurwitz criteria are satisfied and all eigenvalues of the jacobian matrix j e 2 have negative real parts thus e 2 is las next we prove e 2 is gas according to system 3 1 we have d e d t f e this implies that e t 0 as t the equations of m t and p t are now autonomous and their limit behaviors are determined by the semiflow generated by b 2 d m d t d 1 m f 1 2 m p d p d t c p d m b p 2 f 2 2 m p moreover ω 2 m p r 2 m 0 0 p c b is positively invariant select a dulac function h m p 1 p then f 1 2 h m f 2 2 h p d 1 p b 0 based on the bendixson dulac theorem lawrence 2001 no closed orbit exists for system b 2 we calculate the jacobian matrix as j 2 d 1 0 d c 2 b p simple calculations on the equilibria 0 0 c b c e b f show that det j 2 0 0 c d 1 0 tr j 2 0 c b c d 1 0 det j 2 0 c b c d 1 0 then 0 0 is an unable saddle while 0 c b is a node and is las because ω 2 is simply connected and is positive invariant with no closed orbits contained all solutions of system b 2 starting from ω 1 converge to 0 c b as t which implies that 0 c b is globally attractive from the theory of asymptotically autonomous system mischaikow et al 1995 e 2 is globally attractive thus e 2 is gas theorem b 5 if a 0 e 0 and c a d e d 1 f then a unique internal equilibrium e m p e exists and is las where m a e 2 b d 1 f 2 c f e a d d 1 p e b f c f e a d d 1 e e 2 b f 2 c f e a d d 1 proof if a 0 e 0 and c a d e d 1 f then we obtain e by simple computation the jacobian matrix is defined as j e d 1 0 a d c 2 b p 0 0 e f and its characteristic equation is λ 3 d 1 f c 2 b p λ 2 d 1 f c 2 b p d 1 f λ a d e c 2 b p d 1 f 0 direct computations show that h 1 d 1 f c 2 b p 0 h 2 d 1 f c 2 b p a d e c 2 b p d 1 f 1 d 1 f c 2 b p d 1 f d 1 f c 2 b p 2 c 2 b p d 1 f d 1 f a d e 0 h 3 d 1 f c 2 b p a d e c 2 b p d 1 f 0 1 d 1 f c 2 b p d 1 f 0 0 d 1 f c 2 b p a d e c 2 b p d 1 f a d e c 2 b p d 1 f d 1 f c 2 b p 2 c 2 b p d 1 f d 1 f a d e 0 the routh hurwitz criteria are satisfied and all eigenvalues of the jacobian matrix j e have negative real parts thus e is las theorem b 6 if a 0 e 0 and c a d e d 1 f then system 3 1 has a transcritical bifurcation at e 0 at this point e 0 is non hyperbolic proof for c a d e d 1 f the jacobian matrix j e 0 has zero eigenvalue thus e 0 is non hyperbolic and a d e d 1 f is the bifurcation value eigenvectors v and w of jacobian matrices j e 0 and j e 0 t corresponding to the zero eigenvalue are calculated as v a e d 1 f e d 1 t w d f d 1 f a d t let x m p e t and denote system 3 1 as x f x c where f x c a e d 1 m c p d m b p 2 e p f e hence f c e 0 a d e d 1 f 0 0 0 t direct calculations show that w t f c e 0 a d e d 1 f 0 w t d f c e 0 a d e d 1 f v d 1 2 f 2 0 w t d 2 f e 0 a d e d 1 f v v 2 b d 1 3 f 3 0 according to sotomayor s theorem lawrence 2001 the bifurcation at e 0 is a transcritical bifurcation the analytical results can also be numerically confirmed we provide some numerical simulations in fig 9 with the parameters given in appendix e appendix c comparison of sas c 1 differential method table 4 shows the strongest negative correlations between the steady state of medusae and mortality d 1 the stable sizes of polyps and ephyrae are most sensitive to intraspecific competition b and strobilation β and q respectively these results are consistent with those obtained using the morris method to compare these results in more detail fig 10 implies that the sensitivity orders between the two methods are essentially the same since the shapes of their radar images fig 10 a f are close to being identical meanwhile there are considerable differences in the numerical results which reveal fine distinctions in their calculations as a local sensitivity analysis the differential method is applied for the case where one parameter changes although its calculations are simpler and faster the results are affected by the default values liu et al 2016 therefore the differential method is suitable in the same sea area for short term analyses when different sea areas are involved or when performing long term analyses the morris method is appropriate to decrease the influence of the default values to obtain general conclusions c 2 prcc method table 5 demonstrates that all the sensitivity results are significant except for α d 2 and d 3 which are the same parameters with low standard deviations in the morris method fig 10 suggests that the sensitivity order of the prcc method resembles the orders of the other two methods however the differences in results for some parameters such as β η q and d 1 which are highly correlated with other parameters are smaller than those obtained by the other methods the symbols of some parameters with low sis in other methods also change in the prcc method which implies a change in sensitivity this is partly because the prcc method is a statistical method that ignores the influence of other parameters during the calculations the prcc method excludes the influence of interactions among parameters on the sensitivity results which more accurately describes the associations between steady states and parameters in contrast the morris method is a good choice to effectively optimize the parameters with high correlations liu et al 2016 according to the three methods the steady states are highly dependent on effective bottom up supplementation of strobilation β q and η and are weakly related to asexual reproduction α in addition they are also dependent on medusa mortality d 1 polyp competition b ephyra development θ and s 1 and sexual reproduction γ most of the above parameters are affected by temperature and salinity which means that the population sizes of a aurita are closely associated with these two factors by applying the above methods we can obtain more comprehensive and general conclusions about the sensitivity appendix d seasonal variation in a aurita in the yellow sea we firstly analyzed the interannual variations in different maritime spaces and for different prey concentrations since polyp competition diminishes as the sea area increases b is set to 0 009 at the jiaozhou bay station and 0 0001 in the central yellow sea aside from medusa mortality prey concentrations also exhibit strong effects on sexual reproduction γ is selected as 100 or 2000 when food supplies are moderate or abundant respectively on this basis we then simulated the population sizes of a aurita in the north central and south parts of the yellow sea in 2020 to further explore the effects of environmental factors on the quantitative distributions fig 11 a d demonstrate that all annual variations show seasonal patterns with similar fluctuation trends specifically increases in b and γ result in steep rises in the annual peak quantities of medusae the trend remains unchanged as b rises while slight differences in peak quantities are observed as γ rises the observations reflected steep episodic rises and declines among zooplankton during these years shi 2015 meanwhile the establishment of coastal buildings reduces polyp competition these are therefore the potential causes of episodic a aurita blooms which verifies our results in the sas fig 11 e g show that the a aurita distributions in the yellow sea exhibit obvious spatial differences medusae emerge later at higher latitudes with higher population sizes because of the longest strobilation period the north yellow sea is the most compatible maritime space for a aurita growth these results are all consistent with those obtained at specific stations in summary temperature and salinity play an important role on the seasonal patterns of a aurita by regulating strobilation moreover abiotic factors e g temperature salinity substrate and prey show strong effects on the variations in quantity resulting in blooms in certain years appendix e supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 110229 appendix e supplementary data the following is the supplementary material related to this article mmc s1 s1 sis and stds of medusae polyps and ephyrae fig 2 s2 standardized data and fitting functions in sea surface temperature and seawater salinity in jiaozhou bay from 2009 to 2019 fig 5 s3 observations of medusae and ephyrae in jiaozhou bay in 2009 and 2011 fig 6 s4 mean sea surface temperatures and seawater salinities per month at shidao xiaomaidao and lianyungang respectively fig 7 s5 the standardized data of β t s η t s q t s α t and θ t fig 8 s6 the parameter values of different dynamic behaviors fig 9 s7 the raw values of sis using the morris differential and prcc methods respectively fig 10 
24272,the tension between economic development and ecological conservation has always been a hotly debated topic especially in critical ecologically sensitive areas such as nature reserves in the developing world complexity modeling methods such as agent based models abm are a feasible way to study such coupled human and nature systems chans this paper presents an abm named socio econ ecosystem multipurpose simulator seems for small scale chans with particular focus on biological conservation hotspots areas under developmental pressures the model highlights a microeconomic basis tailored for research objects of the kind featuring heterogeneous agents with partial rationality and integration of various mechanisms of two way human nature interaction such as ecological succession and farmland fallowing these features together with merits in low data and computational requirements and convenient extendibility make seems an easy to apply approach in chans modeling a case study in china s wolong national reserve for giant pandas not only validates the model s capacity of accurately simulate the real world demographic social economic and ecological situations but also demonstrates nonlinear outcomes that might not otherwise emerge in statistical models subsequent studies may benefit from these features of seems to investigate theoretical problems in the human nature relationship in biological conservation hotspots or practical ones regarding conservative policy making in such areas keywords coupled human nature systems chans agent based model abm heterogeneous agents partial rationality biological conservation hotspots wolong data availability data will be made available on request 1 introduction human societies are increasingly dependent on ecosystem services díaz et al 2015 foley et al 2005 however what constitutes a sharp contrast is that the continued growth of the world population and the uncontrolled exploitation of natural resources have resulted in consequences such as deforestation waste emissions air pollution water pollution overfishing acid rain ozone layer depletion and reduced biodiversity pata and yilanci 2021 thus putting significant negative pressure on the supply of ecosystem services across the globe foley et al 2005 vitousek et al 1997 the pressure is particularly imminent in the biological conservation hotspots especially those located in developing countries vitousek et al 1997 where indigenous communities like many subsistence communities around the world depend on their abstraction to the natural environment for basic livelihood baro and deubel 2006 which in turn creates a tension between human development and ecological conservation while programs such as ecological compensation are expected to reconcile human land tensions in such territories cuperus et al 1996 jeník 2002 wunder 2005 policy intervention effects to date have remained limited yin et al 2020 to a large extent the major limitation lies in people s lack of in depth understanding of the socio ecological systems as well as their operating mechanisms of such human settlements which makes it difficult to formulate reasonable compensation policies that are particularly targeted to the roots of the problems muradian et al 2010 wünscher et al 2008 research endeavors therefore are urgently needed the coupled human nature systems chans are considered to be a good perspective for studying the socio ecological systems of this nature liu et al 2007 chans proposes a framework for studying individual social ecosystem interactions which allows the modeling of various types of interaction mechanisms in a complex system that exhibits characteristics including thresholds mutual feedback loops time lags heterogeneity and the final emergence of nonlinear results quinn and quinn 2020 in the past decade there has been a large number of chans based studies that have been dedicated to simulate and or quantitatively assess certain highly interrelated complex variable and unpredictable interactions between human and natural systems an et al 2021 balasubramaniam et al 2021 cardinot et al 2019 kulik and baker 2008 this is a complex process that requires a lot of information input to model while limited by the underdeveloped conditions of typical study areas usually only limited data are available in this context computer based modeling tools have been widely resorted to alizad et al 2016 among which the agent based model abm is one of the mostly used mainstream models many studies have shown that abm is an effective method for learning and building system complexity aghaie et al 2020 castilla rho et al 2015 jaxa rozen et al 2019 it is able to aggregate data across spatial temporal and hierarchical scales and discover relationships between the decision processes of individual and other agents an 2012 these agents usually include different levels of socio ecological system participants such as residents farmers trade union organizations authorities etc they make autonomous rule based decisions on given environmental conditions and following certain feedback mechanisms zellner et al 2008 usually having unique and modifiable goals that reflect the attributes and behavioral characteristics of each type of agent it is easy to present agents and the environment and some external sub modules in a computer model and have them interact at different scales abm makes extensive use of stochastic processes to model these interactions although stochastic processes lead to some uncertainty research has shown that the effect of such uncertainty within a complex systems model is generally directionless and therefore does not change the predictive direction of the model an et al 2014 overall the complex system mechanism of abm establishes the underlying feasibility for predicting the emergence realistic results in chans that said there are still three major limitations to the use of abm in the study of chans in the existing literature first the models do not always have an appropriate microeconomic foundation it is worth pointing out that in chans humans play a critical role in shaping the system and causing various environmental consequences that may further influence future human decisions and behaviors an 2012 therefore a proper portrayal of human activities is of key value in chans based studies where economic ones usually assume a central rule one would implant microeconomic models or their variants in simulating the economic activities in order to study the decision making processes of heterogeneous agents under validated and reliable premises however the simulated objects often do not satisfy the basic assumptions of microeconomics leaving the simulations unsubstantiated kulik and baker 2008 for example the scale of the target community may be too large or too small further even if applicable in the sense of the scale most residents in the real world tend to be partially rational and thus the relevant microeconomic assumptions involved must be context specific pawlak et al 2020 all of these factors pose challenges in the study second the models usually do not adequately address human land feedback mechanisms the core concept of chans is the two way interaction between humans and nature quinn and quinn 2020 in many ecologically sensitive hotspots the effects of human activities on plants and animals are primarily accomplished through interactions with the land and changes in land condition may also be feedback to human activities and thus strongly influenced by local policies geographic conditions and scale parker et al 2003 therefore it is important to explore human land feedback mechanisms in depth especially for heterogeneous agents however many studies are still relatively limited in this regard kramer et al 2017 third in order to realistically model chans abm still requires a considerable amount of data first in land modeling as it explores land use dynamics it is limited by the inherent complexity of its process high requirements for geospatial data in both quantity and quality terms kramer et al 2017 valbuena et al 2010 moreover such models involve various factors such as economic social practices and policies which means that the process of quantitative analysis of the model must involve extensive on site work alberti et al 2011 to determine system parameters social surveys interviews or composite score evaluations are usually required to obtain information such as the effect of household size on agricultural land use change or the validity of household life cycle models and variables in temporal changes cabrera et al 2012 due to resource constraints these parameters are often difficult to obtain nor to be inferred objectively rendering the models difficult to validate pontius et al 2004 to address the above issues we present in this paper an abm called the socio econ ecosystem multipurpose simulator which constructs a small scale human nature coupled system the model introduces a preference based utility function with households as the basic behavioral unit and simulates community and economic development as well as human nature interactions under the influence of certain policies the model has three main advantages first the target scale of seems ensures that the required assumptions do not exceed the range typical microeconomic ones that is the agents are price takers operating in a small open perfectly competitive free market economy and are with the goal of utility maximization note that we do not assume homogeneous preference or perfect rationality thus the assumptions here are loose and are more closed to real world situations second seems contains a rich mechanism of human land interactions which allows microscopic observation of the relationship between individual decisions and systemic emergence finally seems has a relatively low data demand and most of it can be obtained from the regular statistics from the local government in a developing country like china and thus has a high degree of implementability this paper describes seems and demonstrates its validity with an exemplary case the rest of the paper is organized as follows chapter 2 describes the basic structure and processes of the model in which microeconomic modeling based on differentiated household preferences and income leisure trade offs is highlighted chapter 3 presents a validation of test run results of the baseline model with a case of a global biological conservation hotspot the wolong national reserve for giant pandas in china and demonstrates the model s capacity to extend to broader decision support contexts with a case of ecological compensation program design we conclude the paper with a brief discussion on possible future research with seems in chapter 4 2 model description the seems model is described following the latest odd overview design concept and details protocol which combines the previous odd and odd d protocols grimm et al 2006 2010 2020 detailed code could be found on github https github com cover letter seems v1 0 git 2 1 purpose and patterns the main purpose of seems is to simulate the impact of community development in small chans as a result of changes in farmers business behavior under the influence of conservation policies which is based on the interaction between human communities and the natural environment to assess the policy effects and provide a basis for conservation policies a model of farmers production consumption preference behavior regarding policy economic changes land use and vegetation cover change was developed the basic assumptions of seems are similar to what of a typical agriculture abm singh et al 1986 in the model households anchor different business strategies and income expectations and adjust their production and business strategies accordingly in the process they decide to join or not various ecological subsidy or compensation programs by comparing the income gap under the programs the decisions are dependent on the heterogeneous preferences of the households and would have an impact on the local land ecology the model responds to how households perceive the income gap and adjust their production and livelihoods behavior and how their changes affect the natural environment 2 2 overall structure the basic structure of seems is shown in fig 1 the main model consists of two sub modules natural and socioeconomic among them the socioeconomic module simulates human behavior in which individuals and households act according to certain rules and these activities influence the natural system by changing land use producing ecological footprints etc the natural system on the one hand evolves following certain physical or biological rules e g ecological succession on the other hand it is influenced by human activities and feeds back into the socioeconomic system in some way beyond these two sub modules policies act as exogenous parameters influencing the operation of the system as a whole in the form of an imposed stimulus or constraint such modeling of policies allows seems to be used for scenario evaluations and thus it constitutes a convenient tool for policy analysis the exogeneity of the policies means that they do not change the agents rules of behavior but exist only as factors to be taken into account in their decision making for example policies may change the supply or demand for a good or service through imposition of taxes or offer of subsidies but they do not directly change the agents behavior rules per se the structure empowers seems the merit of good extensibility in both modular and main body terms the former means that seems can be easily coupled with additional thematic sub modules such as those for simulating the nitrogen cycle and biomass dynamics the latter enabled by the system s adoption of basic microeconomic assumptions allows incremental modeling that introduces new agent types and behavior rules for example firm agents can be added and described by rules based on the assumptions of complete or partial rationality thus releasing the agriculture based household run assumption in the baseline model in addition since abms cannot fully reflect the infinite complexity in the real world we have made necessary trade offs in model complexity considering the level of abstraction prediction accuracy and time cost of computation more specifically the non core components such as business classification are simplified as much as possible while ensuring the reflection of basic facts and attaining potential for extension while the core modules such as those for simulating the economic activities are modelled as close as possible to real world situations 2 3 entities state variables and scales in seems we conceptualize four types of agents individual household landscape and government among them the individual agent is the most basic entity and individual changes serve as the basis for household changes since seems is not a dedicated demographic model it does not aim to be extremely precise in its simulation of the individual agent s life course at the cost of model complexity instead the system is designed on the principle of formulating behavioral rules for birth education marriage migration and death of individual agents in a way as simple as possible such that it is able to simulate the natural and mechanical changes of the population with acceptable accuracy and without the loss generality following this principle the state variables set in the model for the individual agent include gender age education marital status and whether or not they have children the household agent is defined as a collection of individual agents and it is the basic behavioral unit in the model the basic relationship between the two types of agents is that household agents self upgrade with the demographic changes of its individual members as time passes in the model such to form a dynamic pool of households for long time simulation specific household status includes the creation of new ones and the demise of established ones the latter is mainly through divorce or separation in addition to the death of all household members and changes in its membership further the individual characteristics of the household members influenced by their life courses will determine the specific type of the household in behavioral terms and in turn influence its decision making detailed in the section on household heterogeneity the state variables that distinguish households thus include the household id hid the existence nonexistence state of the household preference types business types and policy program joining status besides the model treats the natural system and the government as agents the landscape agent has a set of state variable describing its land use and land cover types which supports its main behavior of ecological succession as for the government agent currently we do not set it up with state variables for the time being but rather model it as a set of super parameters for the simulation of common policies or government programs such as subsidies compensation changes in product prices introduction of new business and relocation or fallowing programs etc the reason for including the government as one of the entities is to reserve room for future upgrade of the model the full range of agents and state variables and their value ranges are listed in table 1 the model is run at a time step of one year but when calculating farmers production and business income their labor force is measured by the number of hours they need to consume per day and the model was run for 10 years from 2009 to 2019 the starting time the year of 2009 was chosen because it is when our illustrative case wolong basically recovered from the major earthquake in 2008 and the year of 2019 was chosen as the ending time because the latest statistics for model validation are only available until this year as for the simulation of the ecological module the simulation period is elongated to 2024 due to the fact that 14 complete years is the shortest complete cycle for the most successional top community in the model setting 2 4 process overview and scheduling seems consists of four main sub modules the demographic sub module the socioeconomic sub module the ecosystem sub module and the accounting sub module the demographic sub module forms the basis of the entire simulation demographic changes determine the state of the households as well as state variable values such as the available labor the socioeconomic sub module plays a central role in the model as almost all other activities are related to the economic behavior of the households the ecosystem sub module simulates natural dynamics as well as the feedbacks of human behaviors on the nature which are mainly reflected to land use land cover changes finally the accounting sub module is used to record the indicators and state changes in all other sub modules as far as the entities are concerned the household is the main decision unit in this model with relatively complex behavior rules in addition to the natural changes in household members through changes in individual agents it includes the demise of established households the creation of new households and the redistribution of properties among households the main behaviors of land agents fall into two categories natural processes and feedbacks to human intervention the natural processes at concern mainly involve the cyclical vegetation succession and the feedbacks to interventions include policy impacts animal and human interventions on the land the main behavior of the government agents was set to issuing policies which is considered as global parameters that does not change in one run of the simulation the main flow of the model in a complete iteration cycle is described as follows 1 the model first creates a scenario and generates a government agent which will publish some policies in the first unit of time year the model accesses the database creates agents including individuals households and land reads the corresponding state variables and completes the initialization of the social module 2 next the model calls the economic sub module the household agents will be classified by preference according to the refreshed agent attributes and then the module determines the production function applicable to each type of agent 3 next the model proceeds to the main simulation phase for each household agent the system simulates its production and consumption behaviors if at this point there are optional policies that may influence the household s choice each household will compare the alternative policies and choose the one that best satisfies its preferences for implementation the socioeconomic sub module is completed by traversing all households in this way 4 meanwhile the nature sub module simulates ecological succession in a set cycle and also simulates the interactions between human activities and natural elements that produce mutual effects relevant behaviors include the framers reverting of farmland to forest and wild animals destroying farming yields 5 lastly at the end of the first time unit the system first performs regular update actions for individuals households and land including demographic status changes household status changes and land cover changes etc thus completing the refresh of the agent s status in this iteration cycle at this point one round of simulation process is completed after that steps 2 5 are iterated until the end of the simulation fig 2 2 5 design concepts 2 5 1 basic principles abms can be generally classified into heterogeneous and representative agent models depending on the heterogeneity of agents many studies have discussed the performance difference between the two and a consensus appears to be that some deviations or even divergences may occur when using these two types of models for the same economic phenomenon overall representative homogeneous abms encounter difficulties in showing the different characteristics among agents while heterogeneous abms can better explain aggregated data aydilek and aydilek 2020 gallen 2021 therefore in seems in order to better represent the widely varying motivations of different actors in the real world we set the household agents in seems as heterogeneous and so are the decision processes the heterogeneity between household agents is mainly reflected in the heterogeneity of preferences as consumers as consumers households face an income leisure trade off becker 1988 in principle there can always be a dichotomy between preferences of households that tend to work hard and those that tend to enjoy life in consequence we divide households into two categories in seems the entrepreneurs who tend to exhaust their labor resources in productive activities for a maximum income and the carpe diem ers who devote as little labor as possible only for subsistence and spend the rest of time for leisure as the basis of behavior preferences play a crucial role in economics sociology law political science psychology and virtually all other social sciences behavioral economics suggests that although many economical behaviors and outcomes change in response to technological policy social and market changes people s preferences or tastes are by large endogenous palacios huerta and santos 2004 therefore we assume that the heterogeneity of household preferences is endogenous that is preferences are shaped by the households own endowments rather than by external factors ebert 2007 in seems we determine household preference based on this assumption and use household demographic variables economic conditions and social conditions as the independent variables to classify the preference of households by using regression models we present a formal model for household preference classification and its implementation in the following paragraphs furthermore following scott 2017 a risk factor is introduced the presence of risk makes the production function of each business non deterministic causing the returns to fluctuate within a certain range the point here is not to better reflect uncertainties in the real world as they are proven not likely to significantly change the simulation results an et al 2014 rather it is to better simulate the agents heterogeneity according to the tolerance for risk and preference in the income leisure trade off households are finally classified into four types households with different preferences make different types of decisions fig 3 the technical models for household categorization are detailed in supplementary materials section 1 2 5 2 emergence the households productive activities affect all aspects of the associated social ecological system and the sum of all households behaviors and their impacts form the observable macroscopic patterns of the social ecological system these include land use land cover status economic output income energy consumption greenhouse gas emissions etc in which the large number of individual interactions at the micro level makes the macro observed phenomena not simply linearly related to the micro behavior of individuals such phenomena are particularly evident in economic systems and land use land cover changes again taking land use land cover change as an example in the course of the baseline simulation we found that the behavior of reverting from farmland to forest shows a neighborhood diffusion phenomenon and the priority areas for fallowing are located in high mid mountain implicitly there will be random wildlife activity on non cultivated land which in turn will affect the yield of cultivated land spatially manifesting as neighborhood effects nevertheless the decision to revert farmland or not is made solely through the satisfaction of the household utility function in addition the willingness to quit farming in the household decision making process will be amplified or reduced to different degrees depending on the heterogeneous preferences of the households resulting in a more complex phenomenon of reverting farming another example is that variable risk preferences may generate herding behavior at the household level leading to significant changes in the industry structure at the macro level 2 5 3 adaptation based on the estimated income level and their consumption needs households examine the three assets of labor capital and land and make trade offs in their production operations to reach the goal of utility maximization for example in the case of the grain to green g2g program households will decide whether to participate in the reforestation program considering the program offered compensation income and potential production losses as an opportunity cost and adjust their business strategy accordingly to achieve their goals hence adaptability here is related to the intrinsic traits of the agents for example for some conservative households they may choose the adaptive behavior of accepting policies while not restructuring their production activities in other words there are differences in individual adaptability both in terms of the direction of adaptation and the scope of it the policy decision strategies of the households are shown in table 2 where fra t is a function of agricultural income on land area t frt t is a function of labor income on labor input l frl k is a function of farm income on capital input k and fl tr is a function of labor input on land area t tr is the area of land retired from cultivation λ is the compensation rate per mu of land and fc x is a function of expenditures for livelihood the specific functions covered in the table are shown in the supplementary materials table s5 finally the resulting possible business strategies are shown in table 3 2 5 4 objectives in seems the basic economic actor is the household who possesses certain factors of production including human resources capital and land and makes production and consumption decisions based on their own preferences as the producer households behave following the typical producer model they make production decisions among a set of businesses with the objective of profit maximization subjecting to the constraints of their own factors of production capital labor and land and when acting as the consumer households make utility maximization choices between income and leisure from the previous assumptions households consume only two things income and leisure based on the different preferences for the two we have divided households into two categories carpe diem ers and entrepreneurs the two possess different consumption preferences as shown in fig 4 in the income leisure space the entrepreneurs can do without any non essential leisure at all and so obtains the corner solution thus their utility maximization condition is equivalent to maximizing income which is in turn equivalent to profit when the household acts as a producer the carpe diem ers on the contrary try to maximize leisure as long as their income can sustain their lives at the subsistence level in other words their optimal solution is equivalent to minimizing the labor input under the condition that a certain minimum level of income is guaranteed in this way the household s utility maximization problem as a consumer is converted into its production decision problem as a producer with a clear optimization objective we will give a formal statement of the optimization problem in section 2 7 2 2 5 5 interaction processes such as the ecological succession of the natural agent are similar to the behavior of human agents and they also interact with human agents following certain rules for example the choice of households to join in the reforestation program will change the cover of many high hills while the activities of animals for example will have an impact on the agriculture and grazing of farmers in seems human agents are in constant interactions with both other people and the nature the former reflected in the changes in household demographics and social relations directly affects the assets and labor conditions of the household and in turn the choice of businesses for the latter a most prominent example is farming on the one hand agricultural activities have a direct impact on the natural environment in which the cultivation of land leads to the change of the surrounding habitat conditions giant pandas tend to avoid places with intense human activities on the other hand reverting farmland can restore the habitat if households choose to abandon agriculture their arable land will be left fallow thus changing the land cover and improving habitat quality which will have a positive impact on biological conservation furthermore these choices will interact with each other for example under the g2g program if the farmland near a household s farmland is abandoned these areas will become habitat for certain wildlife such as the boar and their presence will threaten the agricultural yield consequently the household will be more likely to give up on farming fig 5 2 5 6 stochasticity stochasticity is innate in seems and is reflected in the following ways in the economic sub module stochasticity is reflected in the uncertain realization of the risk factor in business operations as stated earlier households must consider risk when making production decisions and different types of households have different attitudes toward risk the model stipulates that risk appetite households tend to consider risk more optimistically meaning that they believe they will always get the best outcome the opposite is true for risk averse households however despite the subjectivity the final realization of the risk is random through a monte carlo process that decides actual risks and the limit of such stochasticity is determined by the intrinsic characteristics of the business sectors similarly in the ecosystem sub module stochasticity is reflected in the random occurrence of animal activities that affect agricultural yields in plots with better habitat quality some random animal activity may arise that can affect the yield of agricultural products within certain limits one example of it is the frequent stealing of agricultural products by local monkeys or boars which is also realized in the model through a monte carlo process where the above limits are also determined by assigning risk parameters according to the land cover types in the area 2 5 7 observation at the end of the simulation the model outputs annual data on population change income per person household change household income and by business incomes which can be viewed in the graphical form in addition the model outputs a series of maps representing the annual change in land use land cover the extent of human activities and the impact on the habitat these results can help us discern how well a program is being implemented 2 5 8 policy interventions and scenarios policy interventions in seems take the form of a global controller specifically they take effects by altering the cost benefit ratios of particular businesses for example by compensating those reverting their farmlands to woods the g2g program brings higher the opportunity cost of agriculture similarly subsidizing the use of electricity rather than firewood lowers the cost of relatively energy intensive businesses in the service sector thus encouraging household to switch to these businesses usually the direction of the effects of policy intervention is non deterministic in other words policies seldom make a business completely worthless on the contrary there are always pros and cons in policies that households must trade off according to their own preferences for instance for a profit maximizing household whether or not to participate in g2g depends on whether its expected realized profit of its freed labor plus compensation could exceed its expected agriculture income trading off between the two options the household would choose whichever that yields more profit in some occasions such trade offs can become very complicated consider the case of subsidizing electricity use as discussed above households are thus encouraged to enter energy intensive businesses the problem is on the one hand operating in these businesses may greatly increase the total energy demand and hence the total expenditure in energy may increase despite a lowered unit price on the other hand the prosperity of these businesses may also bring more income so that they can still profit as a whole in either case it will depend on the overall performance of the local economy and the latter ultimately depends on the households choices these feed backs can actually be repeated endlessly 2 6 initialization and input data the initial state variables of seems include physical environment parameters and socioeconomic parameters which are subdivided into 19 categories with a total of 44 parameters and the brief information is shown in table 4 and the specific parameters and the values of each parameter are shown in table s6 of the supplementary material 2 7 sub modules 2 7 1 the demographic sub module specific rules involve natural and mechanical changes in the population the former includes growth of age births and deaths the latter includes marriage and education related out migration we do not include work related migration at this stage as the objects village settlements of study are typically remote and thus such migration is rare as it is not where the main innovation of seems lies and also considering the computational cost we design the sub module with necessary simplification specifically basic marriage divorce and household split rules are directly adopted from an 2003 which addresses identical objects with our research we only updated the basic demographic parameters with the latest statistical data table 3 also certain modifications are made regarding the rules for household status changes through marriage divorce of which the details are provided in the supplementary materials section 2 2 7 2 the socioeconomic sub module since the various behaviors of agents are heterogeneous the socioeconomic sub module examines in detail the different types of household behavior this includes the preferences of household agents for risk consumption business choice and so on 2 7 2 1 maximization of household utility in seems each household first evaluates and makes decisions before making choices about industries and production activities for the year and the goal of the decisions is to pursue utility maximization the household has three factors of production capital k labor l and land t it allocates these factors of production among different business sectors to maximize profits the following notation is used i h o u s e h o l d j p r o d u c t i o n s e c t o r π j p r o f i t r a t e o f s e c t o r j k n o w n t h r o u g h s t a t i s t i c s q j o u t p u t f u n c t i o n o f s e c t o r j k n o w n t h r o u g h s t a t i s t i c s c o l i c o s t o f l i v i n g f u n c t i o n o f h o u s e h o l d i k n o w n t h r o u g h s t a t i s t i c s the entrepreneurs will try to exhaust all their productive resources to maximize profit thus they will take the corner solution where the isoquant is tangent to the maximum isocost 1 max l k t j i j l i j k i j t i j π j q j i j l i j k i j t i j 2 s t j l i j l i 3 j k i j k i 4 j t i j t i the carpe diem ers will be satisfied when their output is just equal to the income necessary to maintain subsistence at this time there will be a surplus of productive resources l k t etc fig 6 5 min l k t j l i j 6 s t j l i j l i 7 j k i j k i 8 j t i j t i 9 j i j l i j k i j t i j π j q j i j l i j k i j t i j c o l i this leads us to the optimization objectives and constraints for maximizing the utility of the two types of households there are many ways to solve this problem in general when the production function is explicit it can be solved by the lagrangian method for some specific economies if the factors are completely irreplaceable the production function is leontief expressed as 10 q m i n k a l b the optimization problem can be solved by linear programming or other methods if prior relevant knowledge is present mas collell et al 1995 as an easy to implement model seems applies an iterative solution based on the greedy method alidaee et al 2001 thus circumventing excessive a prior requirements 2 7 2 2 business choice production and revenues households have certain factors of production labor capital and farmland each household will after deducting the cost of living will calculate the productive inputs available for the year and generate a list of alternative sectors based on the entry threshold for each sector to simplify the model seems is designed at this stage to provide three choices of available sectors agriculture temporary work and lodging different household preferences may lead them to choose different combinations of sectors the specific selection logic is shown in the pseudo code below seems sets a series of entry thresholds for each sector taking into account the household s asset position and risk preferences and households make decisions based on these entry conditions and their own asset position and type of intrinsic preferences with the corresponding pseudo codes as follows after households complete their production decisions they begin to execute them at this point the risk factor is realized through a monte carlo process with a certain probability distribution and income is generated accordingly detailed parameters and functions of the business sectors are given in supplementary materials section 4 2 7 2 3 expenditures seems assumes that the expenditure of households is also endogenous which includes two parts monetary inputs in production and living expenditures the former is necessary because the above production module only generate the gross revenues thus to find the net income one must also consider the costs in production the latter further includes two major parts the everyday consumption and educational expenditures the overall expenditure module therefore is constructed as follows firstly the production input of the household is calculated based on the types of economic activities the household engages in next the living expenditure is calculated based on the local living and educational cost statistics finally the total disposable cash assets of the household at the end of the year will be calculated by subtracting the total cash assets with the expenditures details of the household expenditure model is explained in supplementary materials section 3 2 7 2 4 policy factors in a small open community the socioeconomic impact of the policy is directly reflected in the households factors of production and assets for illustrative purposes the baseline version of seems introduces the program of g2g which offers cash compensation to farmers who revert their farmland to woods the whole process of the socioeconomic sub module is shown in fig 7 2 7 3 the ecosystem sub module natural dynamics are mainly applied to land patches without human activities mainly in the forms of vegetation succession and biomass increase artificial impacts are mainly regarding people s extraction of natural resources including land resources firewood herbs etc these also include conservative actions such as the reverting of farmland to woods or bamboos fig 8 the two way relationships between the nature and human activities in seems have been described earlier here we elaborate on the natural dynamics which mainly contains a vegetation succession process at this stage of course subsequent developments of seems may further include thematic sub modules for nitrogen cycle and biomass accumulation as each process runs independently with great scalability the natural vegetation succession process simulates the respective ecological phenomena ecological succession means the change from abandoned farmland to forest or more academically the process of vegetation developing into a climax level through several scattering stages clements 1916 without or with few human disturbances the succession of vegetation communities follows a certain pattern of continuous change in time and space curtis and mcintosh 1951 particular succession cycles are subject to the specific geographical context for illustrative purposes in the baseline version of seems we use the succession cycle that is fit for the case study area wolong wolong is located in the central subtropical zone at high altitudes and the common vegetation is subtropical evergreen broad leaved forest due to the mountainous topography the vegetation types show obvious differentiation characteristics with altitude changes to reflect this the model refers to the alpine vegetation succession type and other on site research yunus et al 2020 and determines the specific succession stages the succession intervals and the climax communities table 5 based on the above information seems determines the vegetation type of each land parcel in the current year and iterates to determine whether the next succession state is reached when the vegetation reaches the climax community type the process is stopped and the vegetation type is kept at the climax community type 2 7 4 the accounting sub module 2 7 4 1 social indicators the social indicators include basic demographic information such as the number of individuals the number of households and the number of people with different levels of education etc as well as the number of households with different risk preferences and business choices these indicators are updated after the completion of the respective sub modules and stored in a dedicated database from these raw records any relevant compound statistics can be further calculated such as the age gender and education structures 2 7 4 2 economic indicators the economic indicators include gross and net household income cash income debt income from various businesses income from policy compensation or savings from subsidy etc as well as statistics on income and business sector structures etc 2 7 4 3 ecological indicators the ecological indicators include statistics on land use land cover areas of each type and habitat conditions the statistics are geospatial allocated and visualized further compound indicators such as landscape pattern indices are also optionally output further developments of seems may include additional thematic sub modules such as energy and carbon budget biomass nitrogen cycle etc and performance of these sub modules can also be summarized through the ecological indicators for example via recording the volume and distribution of firewood collected carbon footprint etc 2 8 software information seems is programmed in python 2 7 python is an interpretive language that supports dynamic input for interactive operations and rapid prototyping of one time programs i e scripts while having the power to code large applications in addition by using a number of off the shelf application programming interfaces python provides a user friendly graphical interface to set parameters and run programs geospatial processing and visualization and realized by integrating a gis module within the system we include a snapshot of the user interface of seems in supplementary materials section 5 3 model validation case study results and discussion for the validation of seems and also for illustrating its applicability with a meaningful real world case study we choose the wolong national reserve for giant pandas as the case wolong is located in wenchuan county aba tibetan and qiang autonomous prefecture sichuan province in southwest china its latitude and longitude range from 102 52 to 103 24 e and 30 45 to 31 25 n with a total area of about 200 000 ha the reserve is known for protecting giant pandas and their habitats while there are also snow leopards white lipped deer bull antelope golden monkeys and other national protected animal species as a nature reserve wolong assumes a rather prominent role in ecological conservation as a global hotspot for biodiversity conservation which is manifest in its jurisdictional status it is called wolong special administrative region sar the sole jurisdiction with an sar status in mainland china meanwhile like many other protected areas in the developing world baro and deubel 2006 there are also two human settlement communities in the reserve the townships of wolong and gengda with a total population of about 5000 in 2010 the vast majority of whom are agricultural households fig 9 in recent years biodiversity conservation efforts in wolong have faced serious and increasing threats inflicted by the contest for habitat living spaces between the protected species and the people economic development activities including the local villagers production mainly farming and everyday living activities village expansion and tourism activities have inevitably invaded into natural realms causing an increasingly fragmented habitat for example studies have found that the traditional firewood collection activities in wolong communities have been expanding which can lead to the loss of giant panda habitat an et al 2005 however the human nature interactions are two way in wolong examples of the feedback effects include the increasingly frequent occurrence of boars destroying farmland as the fallowing policy proceeds therefore the very nature of this complex coupled human natural system dictates that the administration in this protected area should reconcile both needs of economic development of the local community and nature conservation which requires the in depth understandings of the mechanisms by which the local socio ecological system runs besides the importance of wolong per se it is a small scale human land coupled system with household based farming as the main economic activity meeting the assumptions of seems all these features make wolong a perfect case not only for validating our model but also for demonstrating its applicability in a broad scope we run a baseline scenario for model validation most data used are derived from basic economic and demographic statistics in wolong in 2009 other information needed to run the simulation including necessary local knowledge to initialize the parameters and tailor certain sub modules specific to wolong s situation is obtained from a field survey on wolong in april 2009 three follow up field surveys conducted in january 2010 january 2012 and august 2017 help accumulated updated information it should be noted that as a low data requirement model seems only partially relies on the data obtained in the first field survey while those obtained in follow up surveys are mainly used for model validation the values of the initialization parameters are detailed in supplementary materials section 5 the simulation in model time starts on january 1 2009 with a step size of 1 year and a total of 10 years of results are simulated the model initially includes a total of 1283 households in 26 village groups the baseline model is run 10 times and average of the results are reported to minimize any influence from stochasticity we validate the model with the social economic and ecological indicators in the following sections 3 1 the grain to green program the grain to green program g2g which converts low yielding arable or abandoned land into forests shrubs and or grasslands is the largest land reforestation project in china 1 1 http lyj zj gov cn art 2021 12 24 art 1277845 59023364 html in the last century china s rapid population growth and sloppy production methods caused a large number of forests grasslands and wetlands to be converted to other uses which had caused extensive deforestation serious soil erosion and ecological degradation in 1999 the first round of g2g programs were piloted in three provinces sichuan shaanxi and gansu and the implementation of a new round of g2g programs was launched in 2014 as of 2020 the central government has invested a total of 535 3 billion yuan in 2435 counties in 25 provinces or equivalent jurisdictions autonomous regions and centrally administered municipalities to implement the g2g covering a land area of 34 8 million ha g2g offers compensation for farmers who revert their farmland and the specific compensation standard has undergone several revisions and has regional variations in wolong before 2004 majorly in kind compensation grain was issued to the farmers along with a small amount of living expenses subsidy since 2004 however the in kind compensation was changed to cash at a price comparable to the market price 1 4 yuan kg the compensation is effective for several years ranging from 2 to 8 depending on which land cover type the farmland is reverted to additionally when the compensation expires it can be extended for another cycle with a lower compensation standard in wolong the latest round of the program has the compensation standard of 1600 yuan mu 1 mu 1 15 ha for reverting farmland to forest and 1000 yuan mu for reverting to grassland also in wolong for obvious reasons a special category of g2g takes the form of reverting farmland to bamboo which is more heavily compensated than others in this paper we use these compensation standards as the simulation parameters 3 2 results 3 2 1 social indicators from the average statistics the total population changed from 4676 to 4744 with an average annual population growth rate of about 0 14 the number of households changed from 1283 to 1447 with an average annual growth rate of about 1 21 fig 10 the higher growth of the household number indicates a frequent household separation behavior which means adult children setting up new households considering the relatively young age structure of wolong s population this is understandable seems also reports changes in the educational level of the population during this simulation period the number of people receiving high school education increased significantly accounting for about 30 of the total population complementing to the decline of the number of people with primary and junior secondary education a few people have a college degree or higher but there is an upward trend finally the overall illiteracy rate remains at a high level and does not fluctuate much fig 11 due to the short simulation period of the model 10 years and the fact that migration of the population is not considered the number of natural population changes is relatively small and the basic marriage divorce and household split rules are directly adopted from an 2003 which addresses identical objects with our research therefore no validation of these demographic indicators was performed 3 2 2 economic indicators the economic indicators reflect the business and living situations of the households since the commodity prices used in the model are constant prices we use the inflation rate calculated from the cpi index of sichuan province to adjust the economic data in order to be more consistent with the actual situation in terms of the overall economic performance and structure the total value of economic output increased from 18 93 million yuan to 50 32 million yuan in the simulation with an average annual growth rate of about 10 3 in terms of the composition of different businesses in the output the output from agriculture decreased from 26 339 million yuan to 24 38 million yuan the output from temporary jobs increased from 7 21 million yuan to 7 72 million yuan and the output from lodging increased from 9 26 million yuan to 38 79 million yuan fig 12 the lodging business had become a pillar business in the area with an average annual output growth rate of 15 4 there may be two reasons for the decrease of output from agriculture first the g2g had taken effects second the return from agriculture had been becoming not as attractive as other businesses the latter explains the situation with temporary jobs too findings from field surveys also convinced the trend that many local young people no longer work as casual laborers but concentrate on running lodging businesses at home next are economic indicators at the household and individual levels it can be seen that the average annual incomes of individuals and households are in relatively stable growth with the annual per capita income increasing from 4064 50 yuan to 10 249 02 yuan with an average annual growth rate of 9 9 annual household income increased from 14 813 32 yuan to 39 581 49 yuan with an average annual growth rate of 10 3 for validation due to the lack of specific statistical data at the township or county levels we used the data of wenchuan county which is the one level higher jurisdiction of wolong fig 13 as can be seen from table 6 the results show that there is a high growth phase in revenues at the beginning of the simulation and then a gradual slowdown trend since the model does not consider the enterprise subjects the test data used exclude one item of wage income and the rest of the obtained actual average annual growth rate of net per capita income of farmers in the county is 12 8 compared to the simulated average annual growth rate in wolong of 9 9 considering wolong not being the county seat town is the less developed part in the county the result appears understandable finally we examine the role of policy related income for the households business generated income accounted for the majority of household income accounting for an average of 98 8 of total household income however despite the small portion there was still a clear upward trend in policy related income which in the baseline scenario refers to compensations from reverting farmland to woods or bamboo by the end of the simulation period the total annual compensatory income for the entire community was approximately 593 252 yuan fig 14 for real world validation the only ground truth data we have is that the g2g program had issued a total of about 350 thousand yuan compensation by the fourth year in comparison the simulated total compensation by the fourth year is 393 046 yuan table 7 a very closed figure with the ground truth 3 2 3 ecological indicators in the sense of supporting conservation policy making the most important indicator produced by seems is the ecological indicator of land use land cover status the change of land use land cover in the simulation output shows that under the compensation standards set by the model which reflects the real world situation the fallow behavior mainly occurs in the first few years and gradually tends to level off after that and finally reaches a relatively stable state the total area of reverted farmland is about 1 3 of the total area of original farmland fig 15 all these patterns are consistent with the real world situation where officials have been concerned about the invisible roof effect of the g2g our model suggests that the effect may be indicating the tipping point when the policy offered benefits and inflicted losses after complex household level trade offs has reached a balance we will further test this hypothesis in subsequent research regarding the appropriate compensation standard target problem geospatial visualization shows that most of the followed land is located in hillside plus some scattered plots on the periphery of the settlements while little of the continuous farmland around the main valley settlement areas is abandoned fig 16 this result reflects precisely the real world situation possibly because the followed land is either far from the settlement and thus induced high costs to cultivate or is vulnerable to wild animals who would destroy the yield nevertheless evaluation of the giant panda habitat fig 17 a b shows that aside from the valley locations vast areas of mountain habitats still demonstrate significant more than 40 improvement in habitat quality also with the farmland parcels around the isolated settlement groups mostly reverted fragmentation of habitat is greatly reduced again contributing to the improvement of habitat quality as are indicated with red squares in fig 17c overall the results show that the g2g program does help improving habitat quality and the differences of improvement among the locales imply the need for more location specific policy designs which may be subject to future inquiries 3 3 discussion overall seems simulates the economic and social changes in the wolong community with results that approximate the reality and the results appear acceptable or at least understandable although with some shortcomings besides the fact that the ground truth we used for validation was not the real ground truth but from situations from a larger jurisdiction for the above mentioned data availability issues deviations mainly occur in the later stages of the simulation the reason as we speculate it may mainly arise from exogeneous shocks the simulation in this paper represents a baseline scenario i e community development without any disturbance imposed however in the real world a national highway that crosses wolong g305 was completed at the end of 2015 and the opening of this highway brought a large number of tourists to wolong and to a larger extent to wenchuan county due to the attractiveness of the giant panda breeding base and also migrant workers who sought opportunities in the post earthquake reconstruction projects both had significantly boosted local economic growth obviously such exogeneous disturbance was not considered in our baseline model resulting in the simulated economic growth not catching up with the actual situation in the final years of the simulation if adjusting for these effects the results would appear reasonable the inclusion of such outside interference however is beyond the scope of baseline validation and may be addressed in future studies that focus on the consequence of outside event shocks on the otherwise closed chans as for the ecological indicators seems also appears to present logical results however the validation unlike in the case of the demographic and socioeconomic indicators is in an indirect manner as we were not able to compare the land use patterns directly with the real situations this is because the baseline scenario in land use pattern terms is in fact hypothetical which does not reflect the real world scenario as mentioned above there was a catastrophic earthquake in wolong in may 2008 and three restoration plans were proposed afterwards 1 to reconstruct the community as it was 2 to regroup the village settlements and form larger ones while abandoning the smaller ones that scattered in the mountains and 3 to relocate all the population outside the reserve obviously our baseline scenarios assumed the first proposal but in the real world it was the second one that was finally adopted the reason we assumed a hypothetical baseline again lies in the consideration of avoiding excess exogeneous shocks in reality the reconstruction projects were conducted from after the earthquake until early 2012 which would have inflicted constant interference from outside of the chans besides to start the simulation in the year of 2012 would have caused a too short simulation period otherwise we will not have sufficient data to validation the model overall weighing the benefits and setbacks and with the purpose of testing the main logics of the model in mind we had reached the decision of using the hypothetical baseline at the expense of not being able to compare the land use dynamics in a spatially explicit manner but rather relying on statistics of the land use structure to illustrate the logical self satisfaction of the model design future works however will certainly involve analysis of the different restoration strategies which we will briefly discuss in the end of the paper another issue regarding the ecological indicators is about the way we evaluated the habitat quality which was also conducted in an indirect manner we used land use land cover status as a proxy for the quality of habitat for giant panda and other species rather than directly investigating the occurrence of them simultaneously the land use land cover typology was also presented in a coarse grained manner it only reflects the vegetation type of the climax community in a categorical way which ignores the continuous change of vegetation status in the sub canopy and understory layers for the purpose of detailed habitat status evaluation the simplified model is subjected to refinement in future studies of this nature lastly aside from the above discussed problems another potential issue that might arise in expanding the model is scaling although the model is designed for a small scale chans which basically dictates the geographical scope scaling problem may still exist say when the land use land cover data with a different resolution is involved whereas more fine grained data may at most cause unnecessarily increased computation time more coarse grained data would affect the accuracy of prediction as small plot patches and the associated human activities would have been eliminated therefore in applying the model to real world cases appropriate choice of the spatial granularity is essential of which the basic criteria would be to choose one that best matches the characteristic scales of ecological processes and human activities at stake for an agriculture based small chans economy a spatial resolution around 30 m appears proper which is also operationally convenient as it is the resolution of common land use land cover data sources for example the landsat imageries 4 conclusion this paper presents an abm named socio econ ecosystem multipurpose simulator seems for small scale chans which simulates the interaction between human communities and natural systems with particular focus on biological conservation hotspots areas under developmental pressures the model highlights a sound microeconomic basis that considers heterogeneous agents with partial rationality together with integration of various mechanisms of human nature dynamics such as ecological succession farmland fallowing and people s firewood collection behavior the data required for the model can be obtained from common sources such as local socioeconomic statistics land use data and simple surveys making data acquisition much less difficult in addition the assumptions based on behavioral rules simplify the rule setting of the agents behaviors making the model less demanding in terms of data accuracy and reducing the computational cost of the model an advantage over alternative much complex models for similar purposes such as the computable general equilibrium model decaluwe and martens 1989 finally the sub modules in the model are coupled together in a rather simplified structure making it easy to extend for any part of the model a convenient feature to facilitate scenario based policy evaluations all these features have helped effectively respond to the three knowledge gaps in chans modeling and make seems an easy to apply approach in this regard through a case study in china s wolong national reserve for giant pandas we tested the model the results validate the model s capacity to simulate real world demographic social economic and ecological conditions to some extent beyond this we introduced the grain to green program and simulated the households decisions and the subsequent socio ecological impacts of reverting farmland statistics and geospatial visualization of the results again confirm the model s validity against real world situations and further demonstrate nonlinear outcomes that might not otherwise emerge in common statistical models subsequent studies may take advantage of the features of seems to investigate theoretical problems in the human nature relationship in biological conservation hotspots or practical ones regarding conservative policy making in such areas we will follow up this paper with seems based research dedicated to evaluate the g2g the firewood to electricity program and the post earthquake restoration strategies in wolong in future works these might involve further modeling of the government agent so that they indeed interact with other entities in a two way manner such as conservation activities administration etc rather than acting merely as a global controller also the refinement of the vegetation succession model is probably necessary which will also be addressed in future works funding information this study is supported by the nsfc project u2040206 and nsfc project 31 972 940 credit authorship contribution statement yufeng chen methodology data curation software writing original draft liyan xu supervision conceptualization methodology software writing review editing xiao zhang data curation funding acquisition zilin wang data curation hailong li supervision conceptualization yansheng yang software hong you methodology dihua li funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110232 appendix supplementary materials image application 1 
24272,the tension between economic development and ecological conservation has always been a hotly debated topic especially in critical ecologically sensitive areas such as nature reserves in the developing world complexity modeling methods such as agent based models abm are a feasible way to study such coupled human and nature systems chans this paper presents an abm named socio econ ecosystem multipurpose simulator seems for small scale chans with particular focus on biological conservation hotspots areas under developmental pressures the model highlights a microeconomic basis tailored for research objects of the kind featuring heterogeneous agents with partial rationality and integration of various mechanisms of two way human nature interaction such as ecological succession and farmland fallowing these features together with merits in low data and computational requirements and convenient extendibility make seems an easy to apply approach in chans modeling a case study in china s wolong national reserve for giant pandas not only validates the model s capacity of accurately simulate the real world demographic social economic and ecological situations but also demonstrates nonlinear outcomes that might not otherwise emerge in statistical models subsequent studies may benefit from these features of seems to investigate theoretical problems in the human nature relationship in biological conservation hotspots or practical ones regarding conservative policy making in such areas keywords coupled human nature systems chans agent based model abm heterogeneous agents partial rationality biological conservation hotspots wolong data availability data will be made available on request 1 introduction human societies are increasingly dependent on ecosystem services díaz et al 2015 foley et al 2005 however what constitutes a sharp contrast is that the continued growth of the world population and the uncontrolled exploitation of natural resources have resulted in consequences such as deforestation waste emissions air pollution water pollution overfishing acid rain ozone layer depletion and reduced biodiversity pata and yilanci 2021 thus putting significant negative pressure on the supply of ecosystem services across the globe foley et al 2005 vitousek et al 1997 the pressure is particularly imminent in the biological conservation hotspots especially those located in developing countries vitousek et al 1997 where indigenous communities like many subsistence communities around the world depend on their abstraction to the natural environment for basic livelihood baro and deubel 2006 which in turn creates a tension between human development and ecological conservation while programs such as ecological compensation are expected to reconcile human land tensions in such territories cuperus et al 1996 jeník 2002 wunder 2005 policy intervention effects to date have remained limited yin et al 2020 to a large extent the major limitation lies in people s lack of in depth understanding of the socio ecological systems as well as their operating mechanisms of such human settlements which makes it difficult to formulate reasonable compensation policies that are particularly targeted to the roots of the problems muradian et al 2010 wünscher et al 2008 research endeavors therefore are urgently needed the coupled human nature systems chans are considered to be a good perspective for studying the socio ecological systems of this nature liu et al 2007 chans proposes a framework for studying individual social ecosystem interactions which allows the modeling of various types of interaction mechanisms in a complex system that exhibits characteristics including thresholds mutual feedback loops time lags heterogeneity and the final emergence of nonlinear results quinn and quinn 2020 in the past decade there has been a large number of chans based studies that have been dedicated to simulate and or quantitatively assess certain highly interrelated complex variable and unpredictable interactions between human and natural systems an et al 2021 balasubramaniam et al 2021 cardinot et al 2019 kulik and baker 2008 this is a complex process that requires a lot of information input to model while limited by the underdeveloped conditions of typical study areas usually only limited data are available in this context computer based modeling tools have been widely resorted to alizad et al 2016 among which the agent based model abm is one of the mostly used mainstream models many studies have shown that abm is an effective method for learning and building system complexity aghaie et al 2020 castilla rho et al 2015 jaxa rozen et al 2019 it is able to aggregate data across spatial temporal and hierarchical scales and discover relationships between the decision processes of individual and other agents an 2012 these agents usually include different levels of socio ecological system participants such as residents farmers trade union organizations authorities etc they make autonomous rule based decisions on given environmental conditions and following certain feedback mechanisms zellner et al 2008 usually having unique and modifiable goals that reflect the attributes and behavioral characteristics of each type of agent it is easy to present agents and the environment and some external sub modules in a computer model and have them interact at different scales abm makes extensive use of stochastic processes to model these interactions although stochastic processes lead to some uncertainty research has shown that the effect of such uncertainty within a complex systems model is generally directionless and therefore does not change the predictive direction of the model an et al 2014 overall the complex system mechanism of abm establishes the underlying feasibility for predicting the emergence realistic results in chans that said there are still three major limitations to the use of abm in the study of chans in the existing literature first the models do not always have an appropriate microeconomic foundation it is worth pointing out that in chans humans play a critical role in shaping the system and causing various environmental consequences that may further influence future human decisions and behaviors an 2012 therefore a proper portrayal of human activities is of key value in chans based studies where economic ones usually assume a central rule one would implant microeconomic models or their variants in simulating the economic activities in order to study the decision making processes of heterogeneous agents under validated and reliable premises however the simulated objects often do not satisfy the basic assumptions of microeconomics leaving the simulations unsubstantiated kulik and baker 2008 for example the scale of the target community may be too large or too small further even if applicable in the sense of the scale most residents in the real world tend to be partially rational and thus the relevant microeconomic assumptions involved must be context specific pawlak et al 2020 all of these factors pose challenges in the study second the models usually do not adequately address human land feedback mechanisms the core concept of chans is the two way interaction between humans and nature quinn and quinn 2020 in many ecologically sensitive hotspots the effects of human activities on plants and animals are primarily accomplished through interactions with the land and changes in land condition may also be feedback to human activities and thus strongly influenced by local policies geographic conditions and scale parker et al 2003 therefore it is important to explore human land feedback mechanisms in depth especially for heterogeneous agents however many studies are still relatively limited in this regard kramer et al 2017 third in order to realistically model chans abm still requires a considerable amount of data first in land modeling as it explores land use dynamics it is limited by the inherent complexity of its process high requirements for geospatial data in both quantity and quality terms kramer et al 2017 valbuena et al 2010 moreover such models involve various factors such as economic social practices and policies which means that the process of quantitative analysis of the model must involve extensive on site work alberti et al 2011 to determine system parameters social surveys interviews or composite score evaluations are usually required to obtain information such as the effect of household size on agricultural land use change or the validity of household life cycle models and variables in temporal changes cabrera et al 2012 due to resource constraints these parameters are often difficult to obtain nor to be inferred objectively rendering the models difficult to validate pontius et al 2004 to address the above issues we present in this paper an abm called the socio econ ecosystem multipurpose simulator which constructs a small scale human nature coupled system the model introduces a preference based utility function with households as the basic behavioral unit and simulates community and economic development as well as human nature interactions under the influence of certain policies the model has three main advantages first the target scale of seems ensures that the required assumptions do not exceed the range typical microeconomic ones that is the agents are price takers operating in a small open perfectly competitive free market economy and are with the goal of utility maximization note that we do not assume homogeneous preference or perfect rationality thus the assumptions here are loose and are more closed to real world situations second seems contains a rich mechanism of human land interactions which allows microscopic observation of the relationship between individual decisions and systemic emergence finally seems has a relatively low data demand and most of it can be obtained from the regular statistics from the local government in a developing country like china and thus has a high degree of implementability this paper describes seems and demonstrates its validity with an exemplary case the rest of the paper is organized as follows chapter 2 describes the basic structure and processes of the model in which microeconomic modeling based on differentiated household preferences and income leisure trade offs is highlighted chapter 3 presents a validation of test run results of the baseline model with a case of a global biological conservation hotspot the wolong national reserve for giant pandas in china and demonstrates the model s capacity to extend to broader decision support contexts with a case of ecological compensation program design we conclude the paper with a brief discussion on possible future research with seems in chapter 4 2 model description the seems model is described following the latest odd overview design concept and details protocol which combines the previous odd and odd d protocols grimm et al 2006 2010 2020 detailed code could be found on github https github com cover letter seems v1 0 git 2 1 purpose and patterns the main purpose of seems is to simulate the impact of community development in small chans as a result of changes in farmers business behavior under the influence of conservation policies which is based on the interaction between human communities and the natural environment to assess the policy effects and provide a basis for conservation policies a model of farmers production consumption preference behavior regarding policy economic changes land use and vegetation cover change was developed the basic assumptions of seems are similar to what of a typical agriculture abm singh et al 1986 in the model households anchor different business strategies and income expectations and adjust their production and business strategies accordingly in the process they decide to join or not various ecological subsidy or compensation programs by comparing the income gap under the programs the decisions are dependent on the heterogeneous preferences of the households and would have an impact on the local land ecology the model responds to how households perceive the income gap and adjust their production and livelihoods behavior and how their changes affect the natural environment 2 2 overall structure the basic structure of seems is shown in fig 1 the main model consists of two sub modules natural and socioeconomic among them the socioeconomic module simulates human behavior in which individuals and households act according to certain rules and these activities influence the natural system by changing land use producing ecological footprints etc the natural system on the one hand evolves following certain physical or biological rules e g ecological succession on the other hand it is influenced by human activities and feeds back into the socioeconomic system in some way beyond these two sub modules policies act as exogenous parameters influencing the operation of the system as a whole in the form of an imposed stimulus or constraint such modeling of policies allows seems to be used for scenario evaluations and thus it constitutes a convenient tool for policy analysis the exogeneity of the policies means that they do not change the agents rules of behavior but exist only as factors to be taken into account in their decision making for example policies may change the supply or demand for a good or service through imposition of taxes or offer of subsidies but they do not directly change the agents behavior rules per se the structure empowers seems the merit of good extensibility in both modular and main body terms the former means that seems can be easily coupled with additional thematic sub modules such as those for simulating the nitrogen cycle and biomass dynamics the latter enabled by the system s adoption of basic microeconomic assumptions allows incremental modeling that introduces new agent types and behavior rules for example firm agents can be added and described by rules based on the assumptions of complete or partial rationality thus releasing the agriculture based household run assumption in the baseline model in addition since abms cannot fully reflect the infinite complexity in the real world we have made necessary trade offs in model complexity considering the level of abstraction prediction accuracy and time cost of computation more specifically the non core components such as business classification are simplified as much as possible while ensuring the reflection of basic facts and attaining potential for extension while the core modules such as those for simulating the economic activities are modelled as close as possible to real world situations 2 3 entities state variables and scales in seems we conceptualize four types of agents individual household landscape and government among them the individual agent is the most basic entity and individual changes serve as the basis for household changes since seems is not a dedicated demographic model it does not aim to be extremely precise in its simulation of the individual agent s life course at the cost of model complexity instead the system is designed on the principle of formulating behavioral rules for birth education marriage migration and death of individual agents in a way as simple as possible such that it is able to simulate the natural and mechanical changes of the population with acceptable accuracy and without the loss generality following this principle the state variables set in the model for the individual agent include gender age education marital status and whether or not they have children the household agent is defined as a collection of individual agents and it is the basic behavioral unit in the model the basic relationship between the two types of agents is that household agents self upgrade with the demographic changes of its individual members as time passes in the model such to form a dynamic pool of households for long time simulation specific household status includes the creation of new ones and the demise of established ones the latter is mainly through divorce or separation in addition to the death of all household members and changes in its membership further the individual characteristics of the household members influenced by their life courses will determine the specific type of the household in behavioral terms and in turn influence its decision making detailed in the section on household heterogeneity the state variables that distinguish households thus include the household id hid the existence nonexistence state of the household preference types business types and policy program joining status besides the model treats the natural system and the government as agents the landscape agent has a set of state variable describing its land use and land cover types which supports its main behavior of ecological succession as for the government agent currently we do not set it up with state variables for the time being but rather model it as a set of super parameters for the simulation of common policies or government programs such as subsidies compensation changes in product prices introduction of new business and relocation or fallowing programs etc the reason for including the government as one of the entities is to reserve room for future upgrade of the model the full range of agents and state variables and their value ranges are listed in table 1 the model is run at a time step of one year but when calculating farmers production and business income their labor force is measured by the number of hours they need to consume per day and the model was run for 10 years from 2009 to 2019 the starting time the year of 2009 was chosen because it is when our illustrative case wolong basically recovered from the major earthquake in 2008 and the year of 2019 was chosen as the ending time because the latest statistics for model validation are only available until this year as for the simulation of the ecological module the simulation period is elongated to 2024 due to the fact that 14 complete years is the shortest complete cycle for the most successional top community in the model setting 2 4 process overview and scheduling seems consists of four main sub modules the demographic sub module the socioeconomic sub module the ecosystem sub module and the accounting sub module the demographic sub module forms the basis of the entire simulation demographic changes determine the state of the households as well as state variable values such as the available labor the socioeconomic sub module plays a central role in the model as almost all other activities are related to the economic behavior of the households the ecosystem sub module simulates natural dynamics as well as the feedbacks of human behaviors on the nature which are mainly reflected to land use land cover changes finally the accounting sub module is used to record the indicators and state changes in all other sub modules as far as the entities are concerned the household is the main decision unit in this model with relatively complex behavior rules in addition to the natural changes in household members through changes in individual agents it includes the demise of established households the creation of new households and the redistribution of properties among households the main behaviors of land agents fall into two categories natural processes and feedbacks to human intervention the natural processes at concern mainly involve the cyclical vegetation succession and the feedbacks to interventions include policy impacts animal and human interventions on the land the main behavior of the government agents was set to issuing policies which is considered as global parameters that does not change in one run of the simulation the main flow of the model in a complete iteration cycle is described as follows 1 the model first creates a scenario and generates a government agent which will publish some policies in the first unit of time year the model accesses the database creates agents including individuals households and land reads the corresponding state variables and completes the initialization of the social module 2 next the model calls the economic sub module the household agents will be classified by preference according to the refreshed agent attributes and then the module determines the production function applicable to each type of agent 3 next the model proceeds to the main simulation phase for each household agent the system simulates its production and consumption behaviors if at this point there are optional policies that may influence the household s choice each household will compare the alternative policies and choose the one that best satisfies its preferences for implementation the socioeconomic sub module is completed by traversing all households in this way 4 meanwhile the nature sub module simulates ecological succession in a set cycle and also simulates the interactions between human activities and natural elements that produce mutual effects relevant behaviors include the framers reverting of farmland to forest and wild animals destroying farming yields 5 lastly at the end of the first time unit the system first performs regular update actions for individuals households and land including demographic status changes household status changes and land cover changes etc thus completing the refresh of the agent s status in this iteration cycle at this point one round of simulation process is completed after that steps 2 5 are iterated until the end of the simulation fig 2 2 5 design concepts 2 5 1 basic principles abms can be generally classified into heterogeneous and representative agent models depending on the heterogeneity of agents many studies have discussed the performance difference between the two and a consensus appears to be that some deviations or even divergences may occur when using these two types of models for the same economic phenomenon overall representative homogeneous abms encounter difficulties in showing the different characteristics among agents while heterogeneous abms can better explain aggregated data aydilek and aydilek 2020 gallen 2021 therefore in seems in order to better represent the widely varying motivations of different actors in the real world we set the household agents in seems as heterogeneous and so are the decision processes the heterogeneity between household agents is mainly reflected in the heterogeneity of preferences as consumers as consumers households face an income leisure trade off becker 1988 in principle there can always be a dichotomy between preferences of households that tend to work hard and those that tend to enjoy life in consequence we divide households into two categories in seems the entrepreneurs who tend to exhaust their labor resources in productive activities for a maximum income and the carpe diem ers who devote as little labor as possible only for subsistence and spend the rest of time for leisure as the basis of behavior preferences play a crucial role in economics sociology law political science psychology and virtually all other social sciences behavioral economics suggests that although many economical behaviors and outcomes change in response to technological policy social and market changes people s preferences or tastes are by large endogenous palacios huerta and santos 2004 therefore we assume that the heterogeneity of household preferences is endogenous that is preferences are shaped by the households own endowments rather than by external factors ebert 2007 in seems we determine household preference based on this assumption and use household demographic variables economic conditions and social conditions as the independent variables to classify the preference of households by using regression models we present a formal model for household preference classification and its implementation in the following paragraphs furthermore following scott 2017 a risk factor is introduced the presence of risk makes the production function of each business non deterministic causing the returns to fluctuate within a certain range the point here is not to better reflect uncertainties in the real world as they are proven not likely to significantly change the simulation results an et al 2014 rather it is to better simulate the agents heterogeneity according to the tolerance for risk and preference in the income leisure trade off households are finally classified into four types households with different preferences make different types of decisions fig 3 the technical models for household categorization are detailed in supplementary materials section 1 2 5 2 emergence the households productive activities affect all aspects of the associated social ecological system and the sum of all households behaviors and their impacts form the observable macroscopic patterns of the social ecological system these include land use land cover status economic output income energy consumption greenhouse gas emissions etc in which the large number of individual interactions at the micro level makes the macro observed phenomena not simply linearly related to the micro behavior of individuals such phenomena are particularly evident in economic systems and land use land cover changes again taking land use land cover change as an example in the course of the baseline simulation we found that the behavior of reverting from farmland to forest shows a neighborhood diffusion phenomenon and the priority areas for fallowing are located in high mid mountain implicitly there will be random wildlife activity on non cultivated land which in turn will affect the yield of cultivated land spatially manifesting as neighborhood effects nevertheless the decision to revert farmland or not is made solely through the satisfaction of the household utility function in addition the willingness to quit farming in the household decision making process will be amplified or reduced to different degrees depending on the heterogeneous preferences of the households resulting in a more complex phenomenon of reverting farming another example is that variable risk preferences may generate herding behavior at the household level leading to significant changes in the industry structure at the macro level 2 5 3 adaptation based on the estimated income level and their consumption needs households examine the three assets of labor capital and land and make trade offs in their production operations to reach the goal of utility maximization for example in the case of the grain to green g2g program households will decide whether to participate in the reforestation program considering the program offered compensation income and potential production losses as an opportunity cost and adjust their business strategy accordingly to achieve their goals hence adaptability here is related to the intrinsic traits of the agents for example for some conservative households they may choose the adaptive behavior of accepting policies while not restructuring their production activities in other words there are differences in individual adaptability both in terms of the direction of adaptation and the scope of it the policy decision strategies of the households are shown in table 2 where fra t is a function of agricultural income on land area t frt t is a function of labor income on labor input l frl k is a function of farm income on capital input k and fl tr is a function of labor input on land area t tr is the area of land retired from cultivation λ is the compensation rate per mu of land and fc x is a function of expenditures for livelihood the specific functions covered in the table are shown in the supplementary materials table s5 finally the resulting possible business strategies are shown in table 3 2 5 4 objectives in seems the basic economic actor is the household who possesses certain factors of production including human resources capital and land and makes production and consumption decisions based on their own preferences as the producer households behave following the typical producer model they make production decisions among a set of businesses with the objective of profit maximization subjecting to the constraints of their own factors of production capital labor and land and when acting as the consumer households make utility maximization choices between income and leisure from the previous assumptions households consume only two things income and leisure based on the different preferences for the two we have divided households into two categories carpe diem ers and entrepreneurs the two possess different consumption preferences as shown in fig 4 in the income leisure space the entrepreneurs can do without any non essential leisure at all and so obtains the corner solution thus their utility maximization condition is equivalent to maximizing income which is in turn equivalent to profit when the household acts as a producer the carpe diem ers on the contrary try to maximize leisure as long as their income can sustain their lives at the subsistence level in other words their optimal solution is equivalent to minimizing the labor input under the condition that a certain minimum level of income is guaranteed in this way the household s utility maximization problem as a consumer is converted into its production decision problem as a producer with a clear optimization objective we will give a formal statement of the optimization problem in section 2 7 2 2 5 5 interaction processes such as the ecological succession of the natural agent are similar to the behavior of human agents and they also interact with human agents following certain rules for example the choice of households to join in the reforestation program will change the cover of many high hills while the activities of animals for example will have an impact on the agriculture and grazing of farmers in seems human agents are in constant interactions with both other people and the nature the former reflected in the changes in household demographics and social relations directly affects the assets and labor conditions of the household and in turn the choice of businesses for the latter a most prominent example is farming on the one hand agricultural activities have a direct impact on the natural environment in which the cultivation of land leads to the change of the surrounding habitat conditions giant pandas tend to avoid places with intense human activities on the other hand reverting farmland can restore the habitat if households choose to abandon agriculture their arable land will be left fallow thus changing the land cover and improving habitat quality which will have a positive impact on biological conservation furthermore these choices will interact with each other for example under the g2g program if the farmland near a household s farmland is abandoned these areas will become habitat for certain wildlife such as the boar and their presence will threaten the agricultural yield consequently the household will be more likely to give up on farming fig 5 2 5 6 stochasticity stochasticity is innate in seems and is reflected in the following ways in the economic sub module stochasticity is reflected in the uncertain realization of the risk factor in business operations as stated earlier households must consider risk when making production decisions and different types of households have different attitudes toward risk the model stipulates that risk appetite households tend to consider risk more optimistically meaning that they believe they will always get the best outcome the opposite is true for risk averse households however despite the subjectivity the final realization of the risk is random through a monte carlo process that decides actual risks and the limit of such stochasticity is determined by the intrinsic characteristics of the business sectors similarly in the ecosystem sub module stochasticity is reflected in the random occurrence of animal activities that affect agricultural yields in plots with better habitat quality some random animal activity may arise that can affect the yield of agricultural products within certain limits one example of it is the frequent stealing of agricultural products by local monkeys or boars which is also realized in the model through a monte carlo process where the above limits are also determined by assigning risk parameters according to the land cover types in the area 2 5 7 observation at the end of the simulation the model outputs annual data on population change income per person household change household income and by business incomes which can be viewed in the graphical form in addition the model outputs a series of maps representing the annual change in land use land cover the extent of human activities and the impact on the habitat these results can help us discern how well a program is being implemented 2 5 8 policy interventions and scenarios policy interventions in seems take the form of a global controller specifically they take effects by altering the cost benefit ratios of particular businesses for example by compensating those reverting their farmlands to woods the g2g program brings higher the opportunity cost of agriculture similarly subsidizing the use of electricity rather than firewood lowers the cost of relatively energy intensive businesses in the service sector thus encouraging household to switch to these businesses usually the direction of the effects of policy intervention is non deterministic in other words policies seldom make a business completely worthless on the contrary there are always pros and cons in policies that households must trade off according to their own preferences for instance for a profit maximizing household whether or not to participate in g2g depends on whether its expected realized profit of its freed labor plus compensation could exceed its expected agriculture income trading off between the two options the household would choose whichever that yields more profit in some occasions such trade offs can become very complicated consider the case of subsidizing electricity use as discussed above households are thus encouraged to enter energy intensive businesses the problem is on the one hand operating in these businesses may greatly increase the total energy demand and hence the total expenditure in energy may increase despite a lowered unit price on the other hand the prosperity of these businesses may also bring more income so that they can still profit as a whole in either case it will depend on the overall performance of the local economy and the latter ultimately depends on the households choices these feed backs can actually be repeated endlessly 2 6 initialization and input data the initial state variables of seems include physical environment parameters and socioeconomic parameters which are subdivided into 19 categories with a total of 44 parameters and the brief information is shown in table 4 and the specific parameters and the values of each parameter are shown in table s6 of the supplementary material 2 7 sub modules 2 7 1 the demographic sub module specific rules involve natural and mechanical changes in the population the former includes growth of age births and deaths the latter includes marriage and education related out migration we do not include work related migration at this stage as the objects village settlements of study are typically remote and thus such migration is rare as it is not where the main innovation of seems lies and also considering the computational cost we design the sub module with necessary simplification specifically basic marriage divorce and household split rules are directly adopted from an 2003 which addresses identical objects with our research we only updated the basic demographic parameters with the latest statistical data table 3 also certain modifications are made regarding the rules for household status changes through marriage divorce of which the details are provided in the supplementary materials section 2 2 7 2 the socioeconomic sub module since the various behaviors of agents are heterogeneous the socioeconomic sub module examines in detail the different types of household behavior this includes the preferences of household agents for risk consumption business choice and so on 2 7 2 1 maximization of household utility in seems each household first evaluates and makes decisions before making choices about industries and production activities for the year and the goal of the decisions is to pursue utility maximization the household has three factors of production capital k labor l and land t it allocates these factors of production among different business sectors to maximize profits the following notation is used i h o u s e h o l d j p r o d u c t i o n s e c t o r π j p r o f i t r a t e o f s e c t o r j k n o w n t h r o u g h s t a t i s t i c s q j o u t p u t f u n c t i o n o f s e c t o r j k n o w n t h r o u g h s t a t i s t i c s c o l i c o s t o f l i v i n g f u n c t i o n o f h o u s e h o l d i k n o w n t h r o u g h s t a t i s t i c s the entrepreneurs will try to exhaust all their productive resources to maximize profit thus they will take the corner solution where the isoquant is tangent to the maximum isocost 1 max l k t j i j l i j k i j t i j π j q j i j l i j k i j t i j 2 s t j l i j l i 3 j k i j k i 4 j t i j t i the carpe diem ers will be satisfied when their output is just equal to the income necessary to maintain subsistence at this time there will be a surplus of productive resources l k t etc fig 6 5 min l k t j l i j 6 s t j l i j l i 7 j k i j k i 8 j t i j t i 9 j i j l i j k i j t i j π j q j i j l i j k i j t i j c o l i this leads us to the optimization objectives and constraints for maximizing the utility of the two types of households there are many ways to solve this problem in general when the production function is explicit it can be solved by the lagrangian method for some specific economies if the factors are completely irreplaceable the production function is leontief expressed as 10 q m i n k a l b the optimization problem can be solved by linear programming or other methods if prior relevant knowledge is present mas collell et al 1995 as an easy to implement model seems applies an iterative solution based on the greedy method alidaee et al 2001 thus circumventing excessive a prior requirements 2 7 2 2 business choice production and revenues households have certain factors of production labor capital and farmland each household will after deducting the cost of living will calculate the productive inputs available for the year and generate a list of alternative sectors based on the entry threshold for each sector to simplify the model seems is designed at this stage to provide three choices of available sectors agriculture temporary work and lodging different household preferences may lead them to choose different combinations of sectors the specific selection logic is shown in the pseudo code below seems sets a series of entry thresholds for each sector taking into account the household s asset position and risk preferences and households make decisions based on these entry conditions and their own asset position and type of intrinsic preferences with the corresponding pseudo codes as follows after households complete their production decisions they begin to execute them at this point the risk factor is realized through a monte carlo process with a certain probability distribution and income is generated accordingly detailed parameters and functions of the business sectors are given in supplementary materials section 4 2 7 2 3 expenditures seems assumes that the expenditure of households is also endogenous which includes two parts monetary inputs in production and living expenditures the former is necessary because the above production module only generate the gross revenues thus to find the net income one must also consider the costs in production the latter further includes two major parts the everyday consumption and educational expenditures the overall expenditure module therefore is constructed as follows firstly the production input of the household is calculated based on the types of economic activities the household engages in next the living expenditure is calculated based on the local living and educational cost statistics finally the total disposable cash assets of the household at the end of the year will be calculated by subtracting the total cash assets with the expenditures details of the household expenditure model is explained in supplementary materials section 3 2 7 2 4 policy factors in a small open community the socioeconomic impact of the policy is directly reflected in the households factors of production and assets for illustrative purposes the baseline version of seems introduces the program of g2g which offers cash compensation to farmers who revert their farmland to woods the whole process of the socioeconomic sub module is shown in fig 7 2 7 3 the ecosystem sub module natural dynamics are mainly applied to land patches without human activities mainly in the forms of vegetation succession and biomass increase artificial impacts are mainly regarding people s extraction of natural resources including land resources firewood herbs etc these also include conservative actions such as the reverting of farmland to woods or bamboos fig 8 the two way relationships between the nature and human activities in seems have been described earlier here we elaborate on the natural dynamics which mainly contains a vegetation succession process at this stage of course subsequent developments of seems may further include thematic sub modules for nitrogen cycle and biomass accumulation as each process runs independently with great scalability the natural vegetation succession process simulates the respective ecological phenomena ecological succession means the change from abandoned farmland to forest or more academically the process of vegetation developing into a climax level through several scattering stages clements 1916 without or with few human disturbances the succession of vegetation communities follows a certain pattern of continuous change in time and space curtis and mcintosh 1951 particular succession cycles are subject to the specific geographical context for illustrative purposes in the baseline version of seems we use the succession cycle that is fit for the case study area wolong wolong is located in the central subtropical zone at high altitudes and the common vegetation is subtropical evergreen broad leaved forest due to the mountainous topography the vegetation types show obvious differentiation characteristics with altitude changes to reflect this the model refers to the alpine vegetation succession type and other on site research yunus et al 2020 and determines the specific succession stages the succession intervals and the climax communities table 5 based on the above information seems determines the vegetation type of each land parcel in the current year and iterates to determine whether the next succession state is reached when the vegetation reaches the climax community type the process is stopped and the vegetation type is kept at the climax community type 2 7 4 the accounting sub module 2 7 4 1 social indicators the social indicators include basic demographic information such as the number of individuals the number of households and the number of people with different levels of education etc as well as the number of households with different risk preferences and business choices these indicators are updated after the completion of the respective sub modules and stored in a dedicated database from these raw records any relevant compound statistics can be further calculated such as the age gender and education structures 2 7 4 2 economic indicators the economic indicators include gross and net household income cash income debt income from various businesses income from policy compensation or savings from subsidy etc as well as statistics on income and business sector structures etc 2 7 4 3 ecological indicators the ecological indicators include statistics on land use land cover areas of each type and habitat conditions the statistics are geospatial allocated and visualized further compound indicators such as landscape pattern indices are also optionally output further developments of seems may include additional thematic sub modules such as energy and carbon budget biomass nitrogen cycle etc and performance of these sub modules can also be summarized through the ecological indicators for example via recording the volume and distribution of firewood collected carbon footprint etc 2 8 software information seems is programmed in python 2 7 python is an interpretive language that supports dynamic input for interactive operations and rapid prototyping of one time programs i e scripts while having the power to code large applications in addition by using a number of off the shelf application programming interfaces python provides a user friendly graphical interface to set parameters and run programs geospatial processing and visualization and realized by integrating a gis module within the system we include a snapshot of the user interface of seems in supplementary materials section 5 3 model validation case study results and discussion for the validation of seems and also for illustrating its applicability with a meaningful real world case study we choose the wolong national reserve for giant pandas as the case wolong is located in wenchuan county aba tibetan and qiang autonomous prefecture sichuan province in southwest china its latitude and longitude range from 102 52 to 103 24 e and 30 45 to 31 25 n with a total area of about 200 000 ha the reserve is known for protecting giant pandas and their habitats while there are also snow leopards white lipped deer bull antelope golden monkeys and other national protected animal species as a nature reserve wolong assumes a rather prominent role in ecological conservation as a global hotspot for biodiversity conservation which is manifest in its jurisdictional status it is called wolong special administrative region sar the sole jurisdiction with an sar status in mainland china meanwhile like many other protected areas in the developing world baro and deubel 2006 there are also two human settlement communities in the reserve the townships of wolong and gengda with a total population of about 5000 in 2010 the vast majority of whom are agricultural households fig 9 in recent years biodiversity conservation efforts in wolong have faced serious and increasing threats inflicted by the contest for habitat living spaces between the protected species and the people economic development activities including the local villagers production mainly farming and everyday living activities village expansion and tourism activities have inevitably invaded into natural realms causing an increasingly fragmented habitat for example studies have found that the traditional firewood collection activities in wolong communities have been expanding which can lead to the loss of giant panda habitat an et al 2005 however the human nature interactions are two way in wolong examples of the feedback effects include the increasingly frequent occurrence of boars destroying farmland as the fallowing policy proceeds therefore the very nature of this complex coupled human natural system dictates that the administration in this protected area should reconcile both needs of economic development of the local community and nature conservation which requires the in depth understandings of the mechanisms by which the local socio ecological system runs besides the importance of wolong per se it is a small scale human land coupled system with household based farming as the main economic activity meeting the assumptions of seems all these features make wolong a perfect case not only for validating our model but also for demonstrating its applicability in a broad scope we run a baseline scenario for model validation most data used are derived from basic economic and demographic statistics in wolong in 2009 other information needed to run the simulation including necessary local knowledge to initialize the parameters and tailor certain sub modules specific to wolong s situation is obtained from a field survey on wolong in april 2009 three follow up field surveys conducted in january 2010 january 2012 and august 2017 help accumulated updated information it should be noted that as a low data requirement model seems only partially relies on the data obtained in the first field survey while those obtained in follow up surveys are mainly used for model validation the values of the initialization parameters are detailed in supplementary materials section 5 the simulation in model time starts on january 1 2009 with a step size of 1 year and a total of 10 years of results are simulated the model initially includes a total of 1283 households in 26 village groups the baseline model is run 10 times and average of the results are reported to minimize any influence from stochasticity we validate the model with the social economic and ecological indicators in the following sections 3 1 the grain to green program the grain to green program g2g which converts low yielding arable or abandoned land into forests shrubs and or grasslands is the largest land reforestation project in china 1 1 http lyj zj gov cn art 2021 12 24 art 1277845 59023364 html in the last century china s rapid population growth and sloppy production methods caused a large number of forests grasslands and wetlands to be converted to other uses which had caused extensive deforestation serious soil erosion and ecological degradation in 1999 the first round of g2g programs were piloted in three provinces sichuan shaanxi and gansu and the implementation of a new round of g2g programs was launched in 2014 as of 2020 the central government has invested a total of 535 3 billion yuan in 2435 counties in 25 provinces or equivalent jurisdictions autonomous regions and centrally administered municipalities to implement the g2g covering a land area of 34 8 million ha g2g offers compensation for farmers who revert their farmland and the specific compensation standard has undergone several revisions and has regional variations in wolong before 2004 majorly in kind compensation grain was issued to the farmers along with a small amount of living expenses subsidy since 2004 however the in kind compensation was changed to cash at a price comparable to the market price 1 4 yuan kg the compensation is effective for several years ranging from 2 to 8 depending on which land cover type the farmland is reverted to additionally when the compensation expires it can be extended for another cycle with a lower compensation standard in wolong the latest round of the program has the compensation standard of 1600 yuan mu 1 mu 1 15 ha for reverting farmland to forest and 1000 yuan mu for reverting to grassland also in wolong for obvious reasons a special category of g2g takes the form of reverting farmland to bamboo which is more heavily compensated than others in this paper we use these compensation standards as the simulation parameters 3 2 results 3 2 1 social indicators from the average statistics the total population changed from 4676 to 4744 with an average annual population growth rate of about 0 14 the number of households changed from 1283 to 1447 with an average annual growth rate of about 1 21 fig 10 the higher growth of the household number indicates a frequent household separation behavior which means adult children setting up new households considering the relatively young age structure of wolong s population this is understandable seems also reports changes in the educational level of the population during this simulation period the number of people receiving high school education increased significantly accounting for about 30 of the total population complementing to the decline of the number of people with primary and junior secondary education a few people have a college degree or higher but there is an upward trend finally the overall illiteracy rate remains at a high level and does not fluctuate much fig 11 due to the short simulation period of the model 10 years and the fact that migration of the population is not considered the number of natural population changes is relatively small and the basic marriage divorce and household split rules are directly adopted from an 2003 which addresses identical objects with our research therefore no validation of these demographic indicators was performed 3 2 2 economic indicators the economic indicators reflect the business and living situations of the households since the commodity prices used in the model are constant prices we use the inflation rate calculated from the cpi index of sichuan province to adjust the economic data in order to be more consistent with the actual situation in terms of the overall economic performance and structure the total value of economic output increased from 18 93 million yuan to 50 32 million yuan in the simulation with an average annual growth rate of about 10 3 in terms of the composition of different businesses in the output the output from agriculture decreased from 26 339 million yuan to 24 38 million yuan the output from temporary jobs increased from 7 21 million yuan to 7 72 million yuan and the output from lodging increased from 9 26 million yuan to 38 79 million yuan fig 12 the lodging business had become a pillar business in the area with an average annual output growth rate of 15 4 there may be two reasons for the decrease of output from agriculture first the g2g had taken effects second the return from agriculture had been becoming not as attractive as other businesses the latter explains the situation with temporary jobs too findings from field surveys also convinced the trend that many local young people no longer work as casual laborers but concentrate on running lodging businesses at home next are economic indicators at the household and individual levels it can be seen that the average annual incomes of individuals and households are in relatively stable growth with the annual per capita income increasing from 4064 50 yuan to 10 249 02 yuan with an average annual growth rate of 9 9 annual household income increased from 14 813 32 yuan to 39 581 49 yuan with an average annual growth rate of 10 3 for validation due to the lack of specific statistical data at the township or county levels we used the data of wenchuan county which is the one level higher jurisdiction of wolong fig 13 as can be seen from table 6 the results show that there is a high growth phase in revenues at the beginning of the simulation and then a gradual slowdown trend since the model does not consider the enterprise subjects the test data used exclude one item of wage income and the rest of the obtained actual average annual growth rate of net per capita income of farmers in the county is 12 8 compared to the simulated average annual growth rate in wolong of 9 9 considering wolong not being the county seat town is the less developed part in the county the result appears understandable finally we examine the role of policy related income for the households business generated income accounted for the majority of household income accounting for an average of 98 8 of total household income however despite the small portion there was still a clear upward trend in policy related income which in the baseline scenario refers to compensations from reverting farmland to woods or bamboo by the end of the simulation period the total annual compensatory income for the entire community was approximately 593 252 yuan fig 14 for real world validation the only ground truth data we have is that the g2g program had issued a total of about 350 thousand yuan compensation by the fourth year in comparison the simulated total compensation by the fourth year is 393 046 yuan table 7 a very closed figure with the ground truth 3 2 3 ecological indicators in the sense of supporting conservation policy making the most important indicator produced by seems is the ecological indicator of land use land cover status the change of land use land cover in the simulation output shows that under the compensation standards set by the model which reflects the real world situation the fallow behavior mainly occurs in the first few years and gradually tends to level off after that and finally reaches a relatively stable state the total area of reverted farmland is about 1 3 of the total area of original farmland fig 15 all these patterns are consistent with the real world situation where officials have been concerned about the invisible roof effect of the g2g our model suggests that the effect may be indicating the tipping point when the policy offered benefits and inflicted losses after complex household level trade offs has reached a balance we will further test this hypothesis in subsequent research regarding the appropriate compensation standard target problem geospatial visualization shows that most of the followed land is located in hillside plus some scattered plots on the periphery of the settlements while little of the continuous farmland around the main valley settlement areas is abandoned fig 16 this result reflects precisely the real world situation possibly because the followed land is either far from the settlement and thus induced high costs to cultivate or is vulnerable to wild animals who would destroy the yield nevertheless evaluation of the giant panda habitat fig 17 a b shows that aside from the valley locations vast areas of mountain habitats still demonstrate significant more than 40 improvement in habitat quality also with the farmland parcels around the isolated settlement groups mostly reverted fragmentation of habitat is greatly reduced again contributing to the improvement of habitat quality as are indicated with red squares in fig 17c overall the results show that the g2g program does help improving habitat quality and the differences of improvement among the locales imply the need for more location specific policy designs which may be subject to future inquiries 3 3 discussion overall seems simulates the economic and social changes in the wolong community with results that approximate the reality and the results appear acceptable or at least understandable although with some shortcomings besides the fact that the ground truth we used for validation was not the real ground truth but from situations from a larger jurisdiction for the above mentioned data availability issues deviations mainly occur in the later stages of the simulation the reason as we speculate it may mainly arise from exogeneous shocks the simulation in this paper represents a baseline scenario i e community development without any disturbance imposed however in the real world a national highway that crosses wolong g305 was completed at the end of 2015 and the opening of this highway brought a large number of tourists to wolong and to a larger extent to wenchuan county due to the attractiveness of the giant panda breeding base and also migrant workers who sought opportunities in the post earthquake reconstruction projects both had significantly boosted local economic growth obviously such exogeneous disturbance was not considered in our baseline model resulting in the simulated economic growth not catching up with the actual situation in the final years of the simulation if adjusting for these effects the results would appear reasonable the inclusion of such outside interference however is beyond the scope of baseline validation and may be addressed in future studies that focus on the consequence of outside event shocks on the otherwise closed chans as for the ecological indicators seems also appears to present logical results however the validation unlike in the case of the demographic and socioeconomic indicators is in an indirect manner as we were not able to compare the land use patterns directly with the real situations this is because the baseline scenario in land use pattern terms is in fact hypothetical which does not reflect the real world scenario as mentioned above there was a catastrophic earthquake in wolong in may 2008 and three restoration plans were proposed afterwards 1 to reconstruct the community as it was 2 to regroup the village settlements and form larger ones while abandoning the smaller ones that scattered in the mountains and 3 to relocate all the population outside the reserve obviously our baseline scenarios assumed the first proposal but in the real world it was the second one that was finally adopted the reason we assumed a hypothetical baseline again lies in the consideration of avoiding excess exogeneous shocks in reality the reconstruction projects were conducted from after the earthquake until early 2012 which would have inflicted constant interference from outside of the chans besides to start the simulation in the year of 2012 would have caused a too short simulation period otherwise we will not have sufficient data to validation the model overall weighing the benefits and setbacks and with the purpose of testing the main logics of the model in mind we had reached the decision of using the hypothetical baseline at the expense of not being able to compare the land use dynamics in a spatially explicit manner but rather relying on statistics of the land use structure to illustrate the logical self satisfaction of the model design future works however will certainly involve analysis of the different restoration strategies which we will briefly discuss in the end of the paper another issue regarding the ecological indicators is about the way we evaluated the habitat quality which was also conducted in an indirect manner we used land use land cover status as a proxy for the quality of habitat for giant panda and other species rather than directly investigating the occurrence of them simultaneously the land use land cover typology was also presented in a coarse grained manner it only reflects the vegetation type of the climax community in a categorical way which ignores the continuous change of vegetation status in the sub canopy and understory layers for the purpose of detailed habitat status evaluation the simplified model is subjected to refinement in future studies of this nature lastly aside from the above discussed problems another potential issue that might arise in expanding the model is scaling although the model is designed for a small scale chans which basically dictates the geographical scope scaling problem may still exist say when the land use land cover data with a different resolution is involved whereas more fine grained data may at most cause unnecessarily increased computation time more coarse grained data would affect the accuracy of prediction as small plot patches and the associated human activities would have been eliminated therefore in applying the model to real world cases appropriate choice of the spatial granularity is essential of which the basic criteria would be to choose one that best matches the characteristic scales of ecological processes and human activities at stake for an agriculture based small chans economy a spatial resolution around 30 m appears proper which is also operationally convenient as it is the resolution of common land use land cover data sources for example the landsat imageries 4 conclusion this paper presents an abm named socio econ ecosystem multipurpose simulator seems for small scale chans which simulates the interaction between human communities and natural systems with particular focus on biological conservation hotspots areas under developmental pressures the model highlights a sound microeconomic basis that considers heterogeneous agents with partial rationality together with integration of various mechanisms of human nature dynamics such as ecological succession farmland fallowing and people s firewood collection behavior the data required for the model can be obtained from common sources such as local socioeconomic statistics land use data and simple surveys making data acquisition much less difficult in addition the assumptions based on behavioral rules simplify the rule setting of the agents behaviors making the model less demanding in terms of data accuracy and reducing the computational cost of the model an advantage over alternative much complex models for similar purposes such as the computable general equilibrium model decaluwe and martens 1989 finally the sub modules in the model are coupled together in a rather simplified structure making it easy to extend for any part of the model a convenient feature to facilitate scenario based policy evaluations all these features have helped effectively respond to the three knowledge gaps in chans modeling and make seems an easy to apply approach in this regard through a case study in china s wolong national reserve for giant pandas we tested the model the results validate the model s capacity to simulate real world demographic social economic and ecological conditions to some extent beyond this we introduced the grain to green program and simulated the households decisions and the subsequent socio ecological impacts of reverting farmland statistics and geospatial visualization of the results again confirm the model s validity against real world situations and further demonstrate nonlinear outcomes that might not otherwise emerge in common statistical models subsequent studies may take advantage of the features of seems to investigate theoretical problems in the human nature relationship in biological conservation hotspots or practical ones regarding conservative policy making in such areas we will follow up this paper with seems based research dedicated to evaluate the g2g the firewood to electricity program and the post earthquake restoration strategies in wolong in future works these might involve further modeling of the government agent so that they indeed interact with other entities in a two way manner such as conservation activities administration etc rather than acting merely as a global controller also the refinement of the vegetation succession model is probably necessary which will also be addressed in future works funding information this study is supported by the nsfc project u2040206 and nsfc project 31 972 940 credit authorship contribution statement yufeng chen methodology data curation software writing original draft liyan xu supervision conceptualization methodology software writing review editing xiao zhang data curation funding acquisition zilin wang data curation hailong li supervision conceptualization yansheng yang software hong you methodology dihua li funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110232 appendix supplementary materials image application 1 
24273,to formulate the environmental requirements for sustainable development of the aquaculture industry adequately we need a comprehensive understanding of the interrelations between a coastal marine ecosystem and embedded artificial objects of aquaculture simulation experiments with the models based on this knowledge provide recommendations on sustainable management of aquaculture in coastal zones we propose a coupled 2d chemical biological model of marine ecosystem with an embedded mussel farm this model was constructed using the object oriented technique we described the biological components dynamics in the individual based approach using the dynamic energy balance of an individual organism the chemical module included dynamical description the 2d fields of nitrates nitrites phosphates dissolved oxygen suspended and dissolved organic matter the model was verified by the observations data from the mussel farm located in the laspi bay black sea we estimated the environmental impact of the mussel farm comparing several simulations with different sets of the model components phytoplankton bottom seaweeds and a mussel farm the length of each simulation covered the period of intensive growth of mussels and their spawning period early spring late autumn of the first year of cultivation for this comparison averaged concentrations of dissolved and suspended hydrochemical components were used it was found that the farm functioning leads to an increase of ammonium nitrites nitrates and phosphates and decrease of organic matter in water bottom seaweeds have significant positive influence on the ecosystem state and can mitigate adverse effects of the mussel cultivation keywords individual based modeling object based approach bottom seaweeds marine ecosystem data availability data will be made available on request 1 introduction the only form of aquaculture supported in the near shore zone of the crimean peninsula is bivalve culturing its attractiveness is determined by the fact that mollusks do not require additional feeding and grow on natural diet throughout their life cycle therefore this form of aquaculture has sufficiently less negative impact on the environment comparing with marine cage fish farming however large mussel farms with high biomasses may have appreciable influence on benthic communities in coastal marine ecosystems chamberlain 2002 christensen et al 2003 grant et al 1995 nitrogen and phosphorus inputs due to excretion of dissolved fraction and biodeposition on the seabed are large compared with the amounts removed during mussel harvesting and have major influence on nutrient cycling fluxes of large volumes of organic matter to the seabed can cause degradation of benthic communities including macrophytes and have serious eutrophication consequences cranford et al 2007 overall oxygen consumption increases with the increase in organic load because of growing bacterial activity and this process can lead to depletion of oxygen in the sediments and near bottom water layer imbalance between oxygen demand and supply in this layer leads to dramatic consequences for benthic infauna and macrofauna detailed reviews of investigations of potential impacts and environmental interactions of marine ecosystem and a mussel farm are presented in filgueira et al 2015 mckindsey et al 2011 sustainable development of shellfish aquaculture without degrading the environment is an important task and simulation models are necessary for searching the ways to solve it complexity of interactions between bivalve aquaculture and the environment determines the need to use coupled biochemical models with embedded objects imitating a mussel farm functioning cranford et al 2007 using such models we can estimate the ecological carrying capacity which defines the maximum harvest that can be obtained by a farm without causing unacceptable ecological impact on the other hand the so called production carrying capacity defines the maximum volume of farmed mussels that will not become food limited in that site due to depletion of food supply cranford p j li et al 2008 production and ecological carrying capacity are strongly related mckindsey et al 2011 to formulate the environmental requirements for sustainable development of this industry adequately we need a comprehensive understanding of the interrelations between a coastal marine ecosystem and embedded artificial objects of aquaculture simulation experiments with the models based on this knowledge should provide recommendations on sustainable management of aquaculture in coastal zones in recent decades a number of mathematical models were developed in order to study interactions between bivalve aquaculture and the environment and to estimate environmental changes which could accompany intense mariculture activities ferreira et al 2007 filgueira et al 2010 filgueira grant 2009 the authors of review filgueira et al 2015 discussed the existing approaches to modeling the culture of filter feeding mollusks dividing them into two large groups the so called farm models which constrain the model area to the size of the farm and spatial models which can better describe the interaction of aquaculture with the environment biochemical models may vary in complexity from simple nutrient bivalve seston interactions to detailed description of complex ecosystem processes water exchange can be parameterized as integrated flows connecting model boxes or by coupling a hydrodynamic model to the biogeochemical one the submodel for simulating the growth of cultivated mollusks is usually based on the energy balance approach individual based models ibm are the useful tools for describing the growth of cultivated bivalves this approach was used in the farm aquaculture resource management farm model ferreira et al 2007 where it was combined with a one dimensional biochemical model the farm model allowed calculation the yield of the farm based on food supply farm size shellfish density and environmental parameters in ferreira et al 2008 the authors combined various types of models ranging from individual shellfish growth models to broad scale ecosystem models to develop an integrated framework for determination of sustainable carrying capacity in shellfish growing areas the ibm based on the energy budget was developed for the species mytilus galloprovincialis cultivating in the adriatic sea brigolin et al 2009 the model equations for the rates of the energy intake and consumption were formulated as allometric relationships a set of monte carlo simulations were run to upscale the ibm to the population level each individual of the population had different coefficients characterizing genetic differences within a population an individual s position within the farm also influenced its weight trajectory the size structure of the population was estimated based on a series of monte carlo simulations the ibm for the same species cultivation in the black sea was developed in vasechkina kazankova 2014 comparing with the previous one it had slightly different parametrizations and coefficients but the main processes of the energy budget were described similarly coupling of this ibm with a 3d physical biochemical model was discussed in vasechkina 2017 the coupled model was developed using the object based approach the shellfish farm was described as a set of objects located in a computational domain and controlled by the ibm the objects growth differed from each other due to slightly different coefficients in parameterization of the main processes and we investigated how the individual variability influences the averaged dynamics of the cultivated bivalves biomass in this article we propose another application of the above mentioned ibm vasechkina kazankova 2014 which was coupled with the two layer ecological model of a shallow coastal area vasechkina 2020 first we discuss the coupled model architecture and then show the results of its verification using observational data of the actual mussel farm in the laspi bay black sea in the last section of the article we demonstrate the comparison of several simulations with the proposed coupled model the aim of this comparison is to estimate the farm impact on the environment in a bay with poor water exchange with the open sea 2 materials and methods the ecological model proposed earlier vasechkina 2020 was developed using the object based modeling obm technique and combined hydrodynamics hd hydrochemistry hc and hydrobiological hb modules it can simulate the dynamics of dissolved gases nitrogen phosphorus and sulfur compounds dissolved and suspended organic matter dom som phytoplankton and seaweeds biomasses in hd module we consider the two layer vertical structure of a water column with upper and bottom layers different in their hydrophysical characteristics it can transform to the one layer structure in the process of turbulent mixing caused by the wind new upper layer can appear in conditions of wind intensification or warming up through the heat flow from the atmosphere a detailed description of this model can be found in vasechkina 2020 together with the explanation of the obm application and definition of the classes used in the proposed approach obm allows combining the specific characteristics properties of similar entities with the dynamic procedures describing their behavior methods into a single definition named class all that is necessary to calculate the future state of these entities is defined in this class an object is an instance of a class at the beginning the objects are created within 2d modeling domain in accordance with their class definition the properties of each object represent their state and the changes of this state depend on the corresponding environmental influences the dynamic models describing evolution of the objects state in the changing environment are the methods of the appropriate classes we used the individual based approach to develop these dynamics models for each class classes of the previous version of the model vasechkina 2020 were bio object algae species algae here we added the new classes bivalve species bivalves and collector fig 1 the first is a list of morphological and physiological properties and coefficients in allometric and other empirical relationships parametrizations of mussels physiological activity it has no methods we can describe natural individual variability assigning random values with the known mean and dispersion to empirical coefficients listed in the objects of the bivalve species class instances of this class the second class contains the whole description of internal and external mussel states in dynamics the main method of this class is ibm according to many researchers breckling et al 2006 parrott kok 2000 brigolin et al 2009 it is the most appropriate way to describe individual evolution of a biological entity other methods of this class are supplemented procedures describing interaction of the mussels objects with the environment creation of new objects and eliminating the existing ones under certain conditions in this work we used the ibm previously developed for the mytilus galloprovincialis species vasechkina kazankova 2014 creating a set of objects of this class in a modeling domain we can simulate mussel farm dynamics and then investigate its behavior under given external conditions the third class collector was created to describe a structural unit the totality of which makes up the farm an object of this class described a real collector located along the line of the farm each collector object might contain several bivalves objects each with their own morphological and physiological properties this construction was assigned to account for possible variety of sizes and ages of the mollusks located on the same collector of the real farm we used the data collected during exploitation of the mussel farm based in the laspi bay for the model verification in this farm the size structure of the mussel population located on the collectors changed during the year due to the settling of larvae uneven growth and loss during stormy periods the proposed model can be easily extended if necessary we can add another method ibm to the bivalve class for an oyster energetic budget for example and then using corresponding object of the bivalve species class with oyster properties create another set of objects of the same class simulating an oyster farm now we can simulate various forms of aquaculture or communities of wild bivalve mollusks functioning in the marine ecosystem simultaneously with the farm by varying the location of bivalve objects in the modeling area their number and density in space 2 1 ibm for mussel aquaculture ibm simulates the dynamic energy balance between consumption excretion and metabolic costs of the mytilus galloprovincialis mussel the dynamic equation for the dry weight of soft tissue wd is 1 k d d w d d t i e r table 1 shows the definitions of state variables and model parameters with their numeric estimates and variability ranges the wastes e is the sum of undigested food biodeposition and excretion of dissolved compounds in energetic units cal day 2 e i a e x 1 a e i e x where ae is the coefficient of assimilation that shows what part of ingested food a mussel assimilates it is a function of the mussel s dry weight the right part of 1 2 determines the fluxes of matter associated with the physiological processes such as filtration respiration excretion and production of faeces and pseudo faeces parametrizations of these fluxes were made using laboratory experiments data based on the new findings we have made some corrections in the parametrizations of the main physiological processes earlier applied in the model table 2 summarizes all of them and provides the links to the corresponding data source 2 2 aquaculture simulation as explained above the farm model was developed using the obm approach collectors of a mussel aquaculture were described as a set of objects located along the straight lines fig 2 we used the collector class to describe these entities as was mentioned above an object of the collector class might contain several bivalves objects each with homogenous distribution of the same mussels characterized by identical morphological and physiological properties biomass of a bivalves object was proportional to a number of identical organisms 3 b i n w d biomass of a collector object containing n bivalves objects was calculated as 4 b 1 n b i properties of the bivalves objects located on the same collector might differ due to individual variability and age of mussels time since larvae attachment many researchers note that the rates of physiological processes of hydrobionts in aggregations vary from those in isolated state we accounted for this peculiarity using the coefficient of aggregation impact cw table 2 which we wrote as a power function by analogy with those estimated for phyto and zooplankton khailov prazukin 1999 we checked for the resulting effect analyzing dynamics of the state variables in simulations and comparing model data with observations at an actual farm model collectors of the mussel farm existed in different environmental conditions and the mussel objects connected with them have slightly different coefficients in parametrizations to take into account the uncertainty when using empirical functions to parameterize the functional activity of living organisms the coefficients were set by random variables with a known mean value and a relatively small dispersion accordingly we can observe different evolutionary tracks of the objects dynamics during simulations the whole functioning of the farm can be characterized by some averaged parameters such as consumption of food and oxygen excretion of dissolved compounds of nitrogen and phosphorus biodeposition growth rate of mussels the model can calculate these parameters together with the averaged and spatially distributed environmental characteristics inorganic and organic nutrients concentrations dissolved oxygen and phytoplankton biomass comparing these model data with those obtained under the same external conditions but without embedding the model farm we can estimate the impact of the farm on the environment 2 3 observations data field studies were carried out on the experimental farm in the laspi bay near sevastopol in 2010 2011 holodov pyrkova 2011 the farm covered an area of 18000 square meters total mass was approximately 100 ton wet weight the size structure of mussel settlements on collectors changed throughout the year due to larvae settlement mussels growth and their fall especially during storms shell size distribution all over the year except may and june was between 15 and 65 mm holodov pyrkova 2011 gave estimates of the filtration rate excretion rate of ammonium and phosphates oxygen consumption by one mussel for different size groups over several seasons they also calculated integral rate of sedimentation of organic matter from the farm in the next section we compare the results of our simulations with these data and analyze the simulations by the coupled biochemical model with an imbedded mussel farm 3 results and discussion 3 1 model verification to verify our model we carried out simulations with the farm containing 400 collectors along 8 straight lines located in a model area 0 25 sq km the gap between the collectors was 5 m the distance between the lines 50 m total wet mass of the cultivated mollusks was 100 ton environmental conditions were air temperature 24 2 c wind speed 4 5 m s upper layer temperature 18 5 21 5 c bottom layer temperature 12 16 c we compared the averaged results of one month simulations with the abovementioned observed characteristics of mussels for different size groups in june holodov pyrkova 2011 assuming that our external conditions were similar to early summer in the laspi bay fig 3 illustrates the results of this comparison for the specific rates of filtration respiration and excretion comparison of these graphs shows satisfactory agreement of the modelling results with the observations made on the mussel farm in the laspi bay in summer table a1 shows the averaged physiological characteristics of a mean cultivated mussel obtained in model experiments we can also compare our results with the published observational data provided in the comprehensive work jansen 2012 devoted to the investigation of nutrient turnover by suspended mussel communities considering that in the summer their experimental mussels had a shell length of 20 35 mm we can compare the estimates of this work with ours for the corresponding size group table 2 3 in jansen 2012 shows the estimates of nitrogen and phosphorus excretion and biodeposition standardized to a mean individual of 1 g tissue afdw the values for nitrogen and phosphorus excretion are very similar 0 34 our estimate and 0 37 mg n d 1 g 1 afdw 0 09 our estimate and 0 11 mg p d 1 g 1 afdw biodeposition rate is twice as high in our simulations 1 2 versus 0 6 mg n d 1 g 1 afdw 0 1 versus 0 05 mg p d 1 g 1 afdw apparently due to better supply of food in comparison with the oligotrophic fiords where the cited observations were carried out 3 2 impact of crowding the results of in situ and laboratory experiments demonstrated that physiological measurements of isolated mussels differed from the rates measured in mussel aquaculture jansen 2012 the authors assumed that differences were induced by interactions between individual mussels the largest differences were observed for clearance rates with 2 4 times higher rates recorded for individuals compared to communities figures 5 1 5 2 in jansen 2012 in our model this phenomenon is simulated using the coefficient of crowding impact cw in parametrization of a respiration rate which depends on the community biomass table 2 competition for food supply between the neighboring mussel objects leads to decrease in the filtration rate in the community in accordance with the approximation f f w d t f c table 2 fig 4 shows the impact of crowding on the filtration and respiration rates in our simulations filtration rate for an isolated mussel was estimated assuming that an optimal food supply is available for a mussel respiration rate for an isolated mussel was estimated assuming cw equal to 1 3 3 environmental changes we investigated the potential impact of the mussel farm on the environment by comparing the simulations with an embedded farm and without it for two different natural conditions with developed bottom seaweeds and without them the system was closed to external influences so that there was no inflow of additional nutrients organic matter or phytoplankton into the model domain the nutrients necessary for the phytoplankton growth were replenished due to the turnover of nitrogen and phosphorus these idealized conditions were used to accurately evaluate the impact of the farm functioning on the biochemical state of the environment three groups prevailing in the coastal waters in summer diatoms dinoflagellates and coccolithophores represented the model phytoplankton bottom phytocenosis was described by 8 species typical for a rocky bottom of the crimean seashore individual based models for plant objects are described in vasechkina filippova 2019 vasechkina 2020 the initial total mass of the simulated mussels at the farm was 100 ton wet weight the configuration of the farm was the same as described in the previous section annual variation of mean air temperature and insolation influenced the system dynamics as external control variables fig 5 each simulation covered the period of the intensive mussels growth from early spring to late autumn 250 model days we carried out several experiments with different initial weights of mussels to simulate the first three years of the cultivation shallow marine ecosystem with total water volume 3 75 106 m3 16 6 105 m3 of which were occupied by farm collectors rather quickly reacted on the embedded mussel farm maximum impact was observed during the period of intensive mussel growth in the first year of cultivation mollusks of this age demonstrated the highest rates of physiological processes and actively interacted with the environment we conducted four experiments with different composition of the modeling system table 3 the full model combined the modules of phytoplankton seaweeds and the farm the farm model included phytoplankton as food and the aquaculture but did not include bottom macroalgae comparing the full model variant with the farm variant 1 2 in table 4 we could estimate the embedded farm impact on the state of the ecosystem with developed bottom phytocenosis in comparison with the situation when there was bare bottom without seaweeds in the farm area the algae variant included only bottom seaweeds without a farm in order to be a control point in the comparison full model algae 1 3 in table 4 the aim of this comparison was to evaluate the farm impact on the ecosystem with a well developed bottom phytocenosis and clarify the possible softening effect of the bottom macroalgae the plankton variant included phytoplankton only and was calculated to be a control point in the evaluation of the farm impact in the case with the absence of bottom seaweeds we compared the averaged concentrations of nitrogen and phosphorus compounds between these four experiments and summarized the results in table 4 initial size structure of the mussel farm corresponded to the first year of cultivation with the initial dry weight of a mussel 0 06 g initial values of chemical compounds were chosen in accordance with the mean concentrations in the sevastopol bay farm functioning leads to an increase in ammonium nitrites nitrates and phosphates and decrease in organic matter in water full model algae these differences are slight due to rather small size of the farm but can increase at bigger scales of cultivation the differences between full model farm and algae plankton show the positive influence of bottom seaweeds on the water quality uptake of nitrogen and phosphates during their growth led to the decrease in the farm impact on the environment the opposite effect was also positive the averaged macroalgae biomass in the simulation with the farm was 3 higher due to additional excreted ammonium and phosphates concentration of phytoplankton main food for mussels did not vary too much the decrease was about 6 10 in comparison with the simulation without the farm concentrations of dissolved inorganic nutrients were low but the growth rate of the phytoplankton was sufficient to provide mussels with food this became possible due to the model mechanism of increasing the nutrients uptake rate under the conditions of their lack elena vasechkina 2019 for the second year of mussel cultivation the differences between the modelling variants were lower but the tendencies were the same the energy budget approach used in the model allows quantity estimation of internal energy flows and external matter interchange of the farm with the surrounding waters fig 5 shows the dynamics of these characteristics in the full model scenario fig 6 illustrates the spatial distribution of phytoplankton and seaweeds biomass at the end of the full model simulation comparing these maps with the farm scheme fig 2 we can observe lower concentration of microalgae and higher concentration of macroalgae in the area occupied by the farm 4 conclusions the proposed model approach based on the dynamic energy balance of a living entity enables us to describe the biological components of a marine ecosystem in the most natural way the object based technique provides coupling of biological and chemical components of the ecosystem in the uniform model we used a rather simple hydrodynamic model but it is not important the hydrodynamic block works separately and calculates the dynamics of temperature salinity and current velocity fields used by chemical and biological submodels as external variables therefore we can use any model that had better described our ecosystem dynamics verification showed good correspondence between the observed and simulated data this gives us confidence in our estimates of the farm s environmental impact the mussel farm embedding increases the averaged concentrations of ammonium nitrites and nitrates in the surrounding waters and decreases the concentration of suspended organic matter higher density of bottom seaweeds leads to lower concentrations of nutrients and higher concentrations of dissolved organic matter in water when the bottom macroalgae are dense the impact of the farm on the environment is lower the proposed model has good potential for researching the interrelations between the aquaculture and the natural ecosystem which could be important for planning new culturing facilities funding this work was supported by the marine hydrophysical institute of ras theme fnnn 2021 0005 credit authorship contribution statement e f vasechkina methodology software validation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements i am particularly grateful to ludmila verzhevskaya for assistance with english editing appendix table a1 
24273,to formulate the environmental requirements for sustainable development of the aquaculture industry adequately we need a comprehensive understanding of the interrelations between a coastal marine ecosystem and embedded artificial objects of aquaculture simulation experiments with the models based on this knowledge provide recommendations on sustainable management of aquaculture in coastal zones we propose a coupled 2d chemical biological model of marine ecosystem with an embedded mussel farm this model was constructed using the object oriented technique we described the biological components dynamics in the individual based approach using the dynamic energy balance of an individual organism the chemical module included dynamical description the 2d fields of nitrates nitrites phosphates dissolved oxygen suspended and dissolved organic matter the model was verified by the observations data from the mussel farm located in the laspi bay black sea we estimated the environmental impact of the mussel farm comparing several simulations with different sets of the model components phytoplankton bottom seaweeds and a mussel farm the length of each simulation covered the period of intensive growth of mussels and their spawning period early spring late autumn of the first year of cultivation for this comparison averaged concentrations of dissolved and suspended hydrochemical components were used it was found that the farm functioning leads to an increase of ammonium nitrites nitrates and phosphates and decrease of organic matter in water bottom seaweeds have significant positive influence on the ecosystem state and can mitigate adverse effects of the mussel cultivation keywords individual based modeling object based approach bottom seaweeds marine ecosystem data availability data will be made available on request 1 introduction the only form of aquaculture supported in the near shore zone of the crimean peninsula is bivalve culturing its attractiveness is determined by the fact that mollusks do not require additional feeding and grow on natural diet throughout their life cycle therefore this form of aquaculture has sufficiently less negative impact on the environment comparing with marine cage fish farming however large mussel farms with high biomasses may have appreciable influence on benthic communities in coastal marine ecosystems chamberlain 2002 christensen et al 2003 grant et al 1995 nitrogen and phosphorus inputs due to excretion of dissolved fraction and biodeposition on the seabed are large compared with the amounts removed during mussel harvesting and have major influence on nutrient cycling fluxes of large volumes of organic matter to the seabed can cause degradation of benthic communities including macrophytes and have serious eutrophication consequences cranford et al 2007 overall oxygen consumption increases with the increase in organic load because of growing bacterial activity and this process can lead to depletion of oxygen in the sediments and near bottom water layer imbalance between oxygen demand and supply in this layer leads to dramatic consequences for benthic infauna and macrofauna detailed reviews of investigations of potential impacts and environmental interactions of marine ecosystem and a mussel farm are presented in filgueira et al 2015 mckindsey et al 2011 sustainable development of shellfish aquaculture without degrading the environment is an important task and simulation models are necessary for searching the ways to solve it complexity of interactions between bivalve aquaculture and the environment determines the need to use coupled biochemical models with embedded objects imitating a mussel farm functioning cranford et al 2007 using such models we can estimate the ecological carrying capacity which defines the maximum harvest that can be obtained by a farm without causing unacceptable ecological impact on the other hand the so called production carrying capacity defines the maximum volume of farmed mussels that will not become food limited in that site due to depletion of food supply cranford p j li et al 2008 production and ecological carrying capacity are strongly related mckindsey et al 2011 to formulate the environmental requirements for sustainable development of this industry adequately we need a comprehensive understanding of the interrelations between a coastal marine ecosystem and embedded artificial objects of aquaculture simulation experiments with the models based on this knowledge should provide recommendations on sustainable management of aquaculture in coastal zones in recent decades a number of mathematical models were developed in order to study interactions between bivalve aquaculture and the environment and to estimate environmental changes which could accompany intense mariculture activities ferreira et al 2007 filgueira et al 2010 filgueira grant 2009 the authors of review filgueira et al 2015 discussed the existing approaches to modeling the culture of filter feeding mollusks dividing them into two large groups the so called farm models which constrain the model area to the size of the farm and spatial models which can better describe the interaction of aquaculture with the environment biochemical models may vary in complexity from simple nutrient bivalve seston interactions to detailed description of complex ecosystem processes water exchange can be parameterized as integrated flows connecting model boxes or by coupling a hydrodynamic model to the biogeochemical one the submodel for simulating the growth of cultivated mollusks is usually based on the energy balance approach individual based models ibm are the useful tools for describing the growth of cultivated bivalves this approach was used in the farm aquaculture resource management farm model ferreira et al 2007 where it was combined with a one dimensional biochemical model the farm model allowed calculation the yield of the farm based on food supply farm size shellfish density and environmental parameters in ferreira et al 2008 the authors combined various types of models ranging from individual shellfish growth models to broad scale ecosystem models to develop an integrated framework for determination of sustainable carrying capacity in shellfish growing areas the ibm based on the energy budget was developed for the species mytilus galloprovincialis cultivating in the adriatic sea brigolin et al 2009 the model equations for the rates of the energy intake and consumption were formulated as allometric relationships a set of monte carlo simulations were run to upscale the ibm to the population level each individual of the population had different coefficients characterizing genetic differences within a population an individual s position within the farm also influenced its weight trajectory the size structure of the population was estimated based on a series of monte carlo simulations the ibm for the same species cultivation in the black sea was developed in vasechkina kazankova 2014 comparing with the previous one it had slightly different parametrizations and coefficients but the main processes of the energy budget were described similarly coupling of this ibm with a 3d physical biochemical model was discussed in vasechkina 2017 the coupled model was developed using the object based approach the shellfish farm was described as a set of objects located in a computational domain and controlled by the ibm the objects growth differed from each other due to slightly different coefficients in parameterization of the main processes and we investigated how the individual variability influences the averaged dynamics of the cultivated bivalves biomass in this article we propose another application of the above mentioned ibm vasechkina kazankova 2014 which was coupled with the two layer ecological model of a shallow coastal area vasechkina 2020 first we discuss the coupled model architecture and then show the results of its verification using observational data of the actual mussel farm in the laspi bay black sea in the last section of the article we demonstrate the comparison of several simulations with the proposed coupled model the aim of this comparison is to estimate the farm impact on the environment in a bay with poor water exchange with the open sea 2 materials and methods the ecological model proposed earlier vasechkina 2020 was developed using the object based modeling obm technique and combined hydrodynamics hd hydrochemistry hc and hydrobiological hb modules it can simulate the dynamics of dissolved gases nitrogen phosphorus and sulfur compounds dissolved and suspended organic matter dom som phytoplankton and seaweeds biomasses in hd module we consider the two layer vertical structure of a water column with upper and bottom layers different in their hydrophysical characteristics it can transform to the one layer structure in the process of turbulent mixing caused by the wind new upper layer can appear in conditions of wind intensification or warming up through the heat flow from the atmosphere a detailed description of this model can be found in vasechkina 2020 together with the explanation of the obm application and definition of the classes used in the proposed approach obm allows combining the specific characteristics properties of similar entities with the dynamic procedures describing their behavior methods into a single definition named class all that is necessary to calculate the future state of these entities is defined in this class an object is an instance of a class at the beginning the objects are created within 2d modeling domain in accordance with their class definition the properties of each object represent their state and the changes of this state depend on the corresponding environmental influences the dynamic models describing evolution of the objects state in the changing environment are the methods of the appropriate classes we used the individual based approach to develop these dynamics models for each class classes of the previous version of the model vasechkina 2020 were bio object algae species algae here we added the new classes bivalve species bivalves and collector fig 1 the first is a list of morphological and physiological properties and coefficients in allometric and other empirical relationships parametrizations of mussels physiological activity it has no methods we can describe natural individual variability assigning random values with the known mean and dispersion to empirical coefficients listed in the objects of the bivalve species class instances of this class the second class contains the whole description of internal and external mussel states in dynamics the main method of this class is ibm according to many researchers breckling et al 2006 parrott kok 2000 brigolin et al 2009 it is the most appropriate way to describe individual evolution of a biological entity other methods of this class are supplemented procedures describing interaction of the mussels objects with the environment creation of new objects and eliminating the existing ones under certain conditions in this work we used the ibm previously developed for the mytilus galloprovincialis species vasechkina kazankova 2014 creating a set of objects of this class in a modeling domain we can simulate mussel farm dynamics and then investigate its behavior under given external conditions the third class collector was created to describe a structural unit the totality of which makes up the farm an object of this class described a real collector located along the line of the farm each collector object might contain several bivalves objects each with their own morphological and physiological properties this construction was assigned to account for possible variety of sizes and ages of the mollusks located on the same collector of the real farm we used the data collected during exploitation of the mussel farm based in the laspi bay for the model verification in this farm the size structure of the mussel population located on the collectors changed during the year due to the settling of larvae uneven growth and loss during stormy periods the proposed model can be easily extended if necessary we can add another method ibm to the bivalve class for an oyster energetic budget for example and then using corresponding object of the bivalve species class with oyster properties create another set of objects of the same class simulating an oyster farm now we can simulate various forms of aquaculture or communities of wild bivalve mollusks functioning in the marine ecosystem simultaneously with the farm by varying the location of bivalve objects in the modeling area their number and density in space 2 1 ibm for mussel aquaculture ibm simulates the dynamic energy balance between consumption excretion and metabolic costs of the mytilus galloprovincialis mussel the dynamic equation for the dry weight of soft tissue wd is 1 k d d w d d t i e r table 1 shows the definitions of state variables and model parameters with their numeric estimates and variability ranges the wastes e is the sum of undigested food biodeposition and excretion of dissolved compounds in energetic units cal day 2 e i a e x 1 a e i e x where ae is the coefficient of assimilation that shows what part of ingested food a mussel assimilates it is a function of the mussel s dry weight the right part of 1 2 determines the fluxes of matter associated with the physiological processes such as filtration respiration excretion and production of faeces and pseudo faeces parametrizations of these fluxes were made using laboratory experiments data based on the new findings we have made some corrections in the parametrizations of the main physiological processes earlier applied in the model table 2 summarizes all of them and provides the links to the corresponding data source 2 2 aquaculture simulation as explained above the farm model was developed using the obm approach collectors of a mussel aquaculture were described as a set of objects located along the straight lines fig 2 we used the collector class to describe these entities as was mentioned above an object of the collector class might contain several bivalves objects each with homogenous distribution of the same mussels characterized by identical morphological and physiological properties biomass of a bivalves object was proportional to a number of identical organisms 3 b i n w d biomass of a collector object containing n bivalves objects was calculated as 4 b 1 n b i properties of the bivalves objects located on the same collector might differ due to individual variability and age of mussels time since larvae attachment many researchers note that the rates of physiological processes of hydrobionts in aggregations vary from those in isolated state we accounted for this peculiarity using the coefficient of aggregation impact cw table 2 which we wrote as a power function by analogy with those estimated for phyto and zooplankton khailov prazukin 1999 we checked for the resulting effect analyzing dynamics of the state variables in simulations and comparing model data with observations at an actual farm model collectors of the mussel farm existed in different environmental conditions and the mussel objects connected with them have slightly different coefficients in parametrizations to take into account the uncertainty when using empirical functions to parameterize the functional activity of living organisms the coefficients were set by random variables with a known mean value and a relatively small dispersion accordingly we can observe different evolutionary tracks of the objects dynamics during simulations the whole functioning of the farm can be characterized by some averaged parameters such as consumption of food and oxygen excretion of dissolved compounds of nitrogen and phosphorus biodeposition growth rate of mussels the model can calculate these parameters together with the averaged and spatially distributed environmental characteristics inorganic and organic nutrients concentrations dissolved oxygen and phytoplankton biomass comparing these model data with those obtained under the same external conditions but without embedding the model farm we can estimate the impact of the farm on the environment 2 3 observations data field studies were carried out on the experimental farm in the laspi bay near sevastopol in 2010 2011 holodov pyrkova 2011 the farm covered an area of 18000 square meters total mass was approximately 100 ton wet weight the size structure of mussel settlements on collectors changed throughout the year due to larvae settlement mussels growth and their fall especially during storms shell size distribution all over the year except may and june was between 15 and 65 mm holodov pyrkova 2011 gave estimates of the filtration rate excretion rate of ammonium and phosphates oxygen consumption by one mussel for different size groups over several seasons they also calculated integral rate of sedimentation of organic matter from the farm in the next section we compare the results of our simulations with these data and analyze the simulations by the coupled biochemical model with an imbedded mussel farm 3 results and discussion 3 1 model verification to verify our model we carried out simulations with the farm containing 400 collectors along 8 straight lines located in a model area 0 25 sq km the gap between the collectors was 5 m the distance between the lines 50 m total wet mass of the cultivated mollusks was 100 ton environmental conditions were air temperature 24 2 c wind speed 4 5 m s upper layer temperature 18 5 21 5 c bottom layer temperature 12 16 c we compared the averaged results of one month simulations with the abovementioned observed characteristics of mussels for different size groups in june holodov pyrkova 2011 assuming that our external conditions were similar to early summer in the laspi bay fig 3 illustrates the results of this comparison for the specific rates of filtration respiration and excretion comparison of these graphs shows satisfactory agreement of the modelling results with the observations made on the mussel farm in the laspi bay in summer table a1 shows the averaged physiological characteristics of a mean cultivated mussel obtained in model experiments we can also compare our results with the published observational data provided in the comprehensive work jansen 2012 devoted to the investigation of nutrient turnover by suspended mussel communities considering that in the summer their experimental mussels had a shell length of 20 35 mm we can compare the estimates of this work with ours for the corresponding size group table 2 3 in jansen 2012 shows the estimates of nitrogen and phosphorus excretion and biodeposition standardized to a mean individual of 1 g tissue afdw the values for nitrogen and phosphorus excretion are very similar 0 34 our estimate and 0 37 mg n d 1 g 1 afdw 0 09 our estimate and 0 11 mg p d 1 g 1 afdw biodeposition rate is twice as high in our simulations 1 2 versus 0 6 mg n d 1 g 1 afdw 0 1 versus 0 05 mg p d 1 g 1 afdw apparently due to better supply of food in comparison with the oligotrophic fiords where the cited observations were carried out 3 2 impact of crowding the results of in situ and laboratory experiments demonstrated that physiological measurements of isolated mussels differed from the rates measured in mussel aquaculture jansen 2012 the authors assumed that differences were induced by interactions between individual mussels the largest differences were observed for clearance rates with 2 4 times higher rates recorded for individuals compared to communities figures 5 1 5 2 in jansen 2012 in our model this phenomenon is simulated using the coefficient of crowding impact cw in parametrization of a respiration rate which depends on the community biomass table 2 competition for food supply between the neighboring mussel objects leads to decrease in the filtration rate in the community in accordance with the approximation f f w d t f c table 2 fig 4 shows the impact of crowding on the filtration and respiration rates in our simulations filtration rate for an isolated mussel was estimated assuming that an optimal food supply is available for a mussel respiration rate for an isolated mussel was estimated assuming cw equal to 1 3 3 environmental changes we investigated the potential impact of the mussel farm on the environment by comparing the simulations with an embedded farm and without it for two different natural conditions with developed bottom seaweeds and without them the system was closed to external influences so that there was no inflow of additional nutrients organic matter or phytoplankton into the model domain the nutrients necessary for the phytoplankton growth were replenished due to the turnover of nitrogen and phosphorus these idealized conditions were used to accurately evaluate the impact of the farm functioning on the biochemical state of the environment three groups prevailing in the coastal waters in summer diatoms dinoflagellates and coccolithophores represented the model phytoplankton bottom phytocenosis was described by 8 species typical for a rocky bottom of the crimean seashore individual based models for plant objects are described in vasechkina filippova 2019 vasechkina 2020 the initial total mass of the simulated mussels at the farm was 100 ton wet weight the configuration of the farm was the same as described in the previous section annual variation of mean air temperature and insolation influenced the system dynamics as external control variables fig 5 each simulation covered the period of the intensive mussels growth from early spring to late autumn 250 model days we carried out several experiments with different initial weights of mussels to simulate the first three years of the cultivation shallow marine ecosystem with total water volume 3 75 106 m3 16 6 105 m3 of which were occupied by farm collectors rather quickly reacted on the embedded mussel farm maximum impact was observed during the period of intensive mussel growth in the first year of cultivation mollusks of this age demonstrated the highest rates of physiological processes and actively interacted with the environment we conducted four experiments with different composition of the modeling system table 3 the full model combined the modules of phytoplankton seaweeds and the farm the farm model included phytoplankton as food and the aquaculture but did not include bottom macroalgae comparing the full model variant with the farm variant 1 2 in table 4 we could estimate the embedded farm impact on the state of the ecosystem with developed bottom phytocenosis in comparison with the situation when there was bare bottom without seaweeds in the farm area the algae variant included only bottom seaweeds without a farm in order to be a control point in the comparison full model algae 1 3 in table 4 the aim of this comparison was to evaluate the farm impact on the ecosystem with a well developed bottom phytocenosis and clarify the possible softening effect of the bottom macroalgae the plankton variant included phytoplankton only and was calculated to be a control point in the evaluation of the farm impact in the case with the absence of bottom seaweeds we compared the averaged concentrations of nitrogen and phosphorus compounds between these four experiments and summarized the results in table 4 initial size structure of the mussel farm corresponded to the first year of cultivation with the initial dry weight of a mussel 0 06 g initial values of chemical compounds were chosen in accordance with the mean concentrations in the sevastopol bay farm functioning leads to an increase in ammonium nitrites nitrates and phosphates and decrease in organic matter in water full model algae these differences are slight due to rather small size of the farm but can increase at bigger scales of cultivation the differences between full model farm and algae plankton show the positive influence of bottom seaweeds on the water quality uptake of nitrogen and phosphates during their growth led to the decrease in the farm impact on the environment the opposite effect was also positive the averaged macroalgae biomass in the simulation with the farm was 3 higher due to additional excreted ammonium and phosphates concentration of phytoplankton main food for mussels did not vary too much the decrease was about 6 10 in comparison with the simulation without the farm concentrations of dissolved inorganic nutrients were low but the growth rate of the phytoplankton was sufficient to provide mussels with food this became possible due to the model mechanism of increasing the nutrients uptake rate under the conditions of their lack elena vasechkina 2019 for the second year of mussel cultivation the differences between the modelling variants were lower but the tendencies were the same the energy budget approach used in the model allows quantity estimation of internal energy flows and external matter interchange of the farm with the surrounding waters fig 5 shows the dynamics of these characteristics in the full model scenario fig 6 illustrates the spatial distribution of phytoplankton and seaweeds biomass at the end of the full model simulation comparing these maps with the farm scheme fig 2 we can observe lower concentration of microalgae and higher concentration of macroalgae in the area occupied by the farm 4 conclusions the proposed model approach based on the dynamic energy balance of a living entity enables us to describe the biological components of a marine ecosystem in the most natural way the object based technique provides coupling of biological and chemical components of the ecosystem in the uniform model we used a rather simple hydrodynamic model but it is not important the hydrodynamic block works separately and calculates the dynamics of temperature salinity and current velocity fields used by chemical and biological submodels as external variables therefore we can use any model that had better described our ecosystem dynamics verification showed good correspondence between the observed and simulated data this gives us confidence in our estimates of the farm s environmental impact the mussel farm embedding increases the averaged concentrations of ammonium nitrites and nitrates in the surrounding waters and decreases the concentration of suspended organic matter higher density of bottom seaweeds leads to lower concentrations of nutrients and higher concentrations of dissolved organic matter in water when the bottom macroalgae are dense the impact of the farm on the environment is lower the proposed model has good potential for researching the interrelations between the aquaculture and the natural ecosystem which could be important for planning new culturing facilities funding this work was supported by the marine hydrophysical institute of ras theme fnnn 2021 0005 credit authorship contribution statement e f vasechkina methodology software validation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements i am particularly grateful to ludmila verzhevskaya for assistance with english editing appendix table a1 
24274,as an important part of the energy matter cycle gross primary productivity gpp reflects the ability of plants to absorb carbon dioxide from the atmosphere the accurate estimation of gpp is critical to understanding the regional carbon cycle with the development of machine learning ml theory machine learning models are increasingly used to study complex phenomena with high variability in time and space in this study three machine learning models support vector regression svr artificial neural network ann and long short term memory networks lstm were investigated for predicting gpp in northwest china and compared them with the traditional physical models carbon flux various environmental factors and maize growth indices were measured in the maize field over five years in northwest china the rigorous analysis which included statistical comparison and cross validation for the prediction of gpp confirmed that the machine learning models performed better than traditional physical models and the svr model performed the best among the considered ml models with the highest nash efficiency coefficient and the lowest root mean squared error the machine learning model also outperformed the traditional physical models on cloudy days and after irrigation the svr achieved good prediction accuracy and high stability with different training data sets the ann and lstm were relatively more sensitive to the training data set when the training data was sufficient svr ann and lstm could achieve similar prediction accuracy but svr was slightly higher when the training data was small the simulation accuracy of svr was better than ann and lstm the performance of ann and lstm was more sensitive to parameter selection and the relationship between model performance and parameter selection had no obvious regularity based on this comprehensive comparison study it was elicited that the svr model can be successfully applied to gpp simulation of maize fields which provided a new perspective for the application of machine learning modeling in gpp simulation keywords gross primary productivity support vector regression artificial neural network long short term memory networks data availability the authors do not have permission to share data 1 introduction as an important part of terrestrial ecosystems agroecosystems not only provide food fiber and wood products for human beings piao et al 2006 ruiz and bertero 2008 but also play an important role in sequestrating carbon it will help to slow down the increase of atmospheric co2 concentration and achieve carbon neutrality agroecosystems are directly affected by human activities and different farm management practices directly affect carbon emissions from farmland the gross primary productivity gpp is the total amount of carbon dioxide fixed by ecosystems through photosynthesis beer et al 2010 zhang and ye 2021 and it is closely related to plant growth biomass accumulation and distribution in agroecosystems and has a significant impact on the global carbon balance chen et al 2019 accurately predicting the gross primary productivity of agroecosystems is a big challenge for quantifying the global carbon cycle at present the measurement of gross primary productivity at the canopy scale is measured based on respiration models by separating the net ecosystem exchange observed by eddy covariance system however monitoring gpp of plants on a large scale is impractical due to the expensiveness high subsurface requirements and limited observation range of the eddy covariance systems estimating gpp from easily monitored data such as air temperature and radiation is critical to understanding plant growth and assessing the carbon dynamics of terrestrial ecosystems jiang et al 2021 over the past few decades different methods have been developed for gpp estimation light response photosynthetic models rnnning et al 2000 and stomatal conductance models yu et al 2003 were used to simulate photosynthesis at the leaf scale these models performed well in simulating diurnal variation of leaf photosynthesis rate however as the photosynthetic capacity of plants is constantly changing with the growth of plants the parameters of such models often need to be fitted repeatedly and the calculation process is complicated which limits their practicability for gpp simulation on regional scale the light use efficiency models and the process models are generally adopted the light use efficiency models mainly rely on satellite remote sensing data which can hardly observe gpp on a continuous time scale the process models such as the biome bgc model hunt et al 1996 century model melillo et al 1995 beps model liu et al 1997 consider the mechanism of photosynthesis by plants in terms of physiological and ecological processes of vegetation but these models often require a lot of parameters to determine the photosynthetic properties of plants and accurate deployment of these model is difficult besides the above methods mainly focus on the leaf scale and regional scale and there are few studies on the simulation of gpp at the canopy scale although the observations of gross primary productivity are more difficult automated meteorological observation stations are widely distributed around the world therefore the mapping of the relationship between gross primary productivity and meteorological data can be established to predict gpp in unobserved areas machine learning ml methods mitchell 1997 in the field of computer science provide powerful tools to analyze the data behavior to find patterns and correlations among data which do not require comprehensive knowledge about the specific system or excessive engineering experience in recent years ml has been applied to build data driven models rather than explicit expressions for biological processes it is widely used in predicting greenhouse gas emissions and water carbon fluxes in recent years virnodkar et al 2020 based on the eddy covariance flux towers observation data and satellite remote sensing data yang et al 2006 used support vector machine svm to estimate the 8 day evapotranspiration of the us lu and zhuang 2010 used the artificial neural network ann to produce the daily evapotranspiration product in the us wang et al 2017 compared the applicability of ann svm and multivariate adaptive regression in predicting daily latent heat fluxes of different vegetation types in north america xu et al 2018 compared the accuracy of 5 different machine learning methods in predicting regional evapotranspiration beaulieu et al 2020 used the boosted regression trees brts to predict the rate of ch4 emissions from reservoirs in the united states with a fairly low margin of error guevara escobar et al 2021 chose the ensembles of machine learning algorithms to predict the carbon fluxes in the mexican highland shrubs and the gpp was consistent with the simulated value of 0 6 saha et al 2021 used random forest rf to simulate the n2o flux at the farmland scale and explained 65 89 flux variation with fewer input variables in recent years deep learning dl which is proficient in handling more intricate structures and high dimensional data has developed benefitting from improved data collection ability and computing power as a subfield of ml dl can learn very complex functions from raw data and has been applied in many domains including science business and government lecun et al 2015 researchers also have tried to apply dl in the field of agroecosystems and atmospheric environments for example you et al 2017 used convolutional neural network cnn and long short term memory networks lstm to predict soybean yields in the united states and the simulation effect of these two methods was significantly better than that of statistics based methods yang et al 2019 trained cnn with high resolution uav images to predict the yield of rice and the results obtained were far better than the statistical model based on vegetation index yue et al 2020 used the convolutional lstm to predict the variation of meteorological factors and then predicted the growth stage of crops cao et al 2021 used lstm to predict rice yields in china ghosh and behera 2021 used deep learning to estimate the aboveground biomass of mangroves while liu et al 2021 used lstm technology to expand the use of air quality monitoring data this study took maize gpp prediction in the arid region of northwest china as an example based on the carbon flux and meteorological data observed by the eddy covariance system during 2014 2018 this study discussed the prediction performance of several dl and traditional ml methods including lstm ann and support vector regression svr under different conditions as well as compare them with the widely used rectangular hyperbolic model rh model ec lue model and stomatal conductance photosynthesis transpiration coupling model smpt sb model the goal of this study is to explore the following questions 1 compared with traditional physical models whether the ml and dl methods can achieve better gpp prediction accuracy and if so in what case can they have good performance 2 among the ml and dl methods which one has better effectiveness and practicability in the gpp prediction problem 3 how the model parameters and training data will influence the model performance 2 methodology the problem that estimating gpp from available data can be classified as a regression problem which tries to find a relationship between inputs and targets in this study three different regression models in ml and dl are tested and compared which are support vector regression svr artificial neural network ann and long short term memory lstm svr is a good method to deal with the regression problem with nonlinear relationships and has achieved good results in applications such as simulation of evapotranspiration greenhouse gas emissions etc hamrani et al 2020 xia et al 2021 ann and lstm are commonly used in the research of neural network fields to deduce unknown variables through monitoring data among them there are many researches on ann application which is easy to use simple and clear principle the lstm method has a good ability to handle time series data for the prediction of gpp the lstm method may also be better applicable to gpp because the variation of gpp is continuous and may be influenced by the historical growth status of the crop whose growth environment and growth status are continuous time series data so the lstm method may also be applicable to the simulation of gpp 2 1 machine learning and deep learning models 2 1 1 support vector regression support vector regression is based on support vector machine svm theory which is a widely used ml algorithm to classify data with different labels svm tries to find a hyperplane with direction w and offset scalar b i e y w x b to separate the training data according to their labels when the original data are not linearly separable svm employs a kernel function to map the data from the original space to a higher dimensional feature space to enhance linear separability brereton and lloyd 2010 as shown in fig 1 drucker et al 1997 extended svm for regression problems and proposed svr method given a set of training data and corresponding target value x 1 y 1 x n y n svr employs a hyperplane in high dimensional feature space to fit the given training data 1 y w φ x b where φ is the kernel function a commonly used kernel function is rbf kernel e γ x i x 2 where γ is the parameter to be chosen to find optimal w and b the structural risk minimization srm principle is adopted which tries to improve data fitting accuracy while limiting model complexity written as 2 minimize 1 2 w 2 c i 1 n ξ i ξ i subject to y i w φ x i b ε ξ i y i w φ x i b ε ξ i ξ i ξ i 0 i 1 n where ξ i and ξ i are penalizing values to be minimized a training sample will not be penalized if the distance between its target and the estimated value is smaller than the tunable parameter ε c is the penalty parameter that balances model flatness and penalties to estimation errors methodologies to solve eq x and a more detailed explanation of svr can be found in smola and schölkopf 2004 research 2 1 2 artificial neural network ann in this study ann refers to a kind of basic neural network structure with direct connections among layers ann is generally constructed by a collection of many simple connected processors called artificial neurons each neuron receives inputs and maps the input features to a slightly more abstract level lecun et al 2015 3 z n f n w n t i n b where i n is the vector of inputs of neuron n z n represents the output of the neuron w n is the vector of weights b is the bias term f n is the active function which introduces nonlinearity to the neuron an ann arranges and connects the neurons to form an input layer several hidden layers and an output layer it learns experience from the known data by comparing the model outputs with the ground truths i e targets and adjusting the weights of neurons accordingly mean square error mse are commonly used loss function to evaluate the difference between the outputs and labels given as 4 l i o i t i 2 where l o t represent loss outputs and targets of the ann respectively based on the chain rule the loss is propagated backward to each neuron and the weights of neurons are updated by the stochastic gradient descent sgd method baioletti et al 2018 thus an ann can be gradually adjusted with a smaller loss function value which means better performance to match its outputs with targets 2 1 3 long short term memory lstm lstm is a kind of neural network with recurrent structures it is initially proposed by hochreiter schmidhuber 1997 to solve the gradient vanishing problem when processing long time series data the key mechanism of lstm is to employ a cell state c to store the long term state of a system as shown in fig 2 b at arbitrary time step t the input of lstm is model input i t hidden state of the previous time step h t 1 and the cell state of the previous time step c t 1 the output is the hidden state of the current time step h t 1 and refreshed cell state c t three gates are used to control update and utilize the cell state defined as 5 f t σ w f h t 1 i t b f 6 i t σ w i h t 1 i t b i 7 o t σ w o h t 1 i t b o where f t i t and o t are forget gate input gate and output gate respectively w f w i and w o are weights of the gates respectively and b f b i and b o are biases σ represents the sigmoid function the model input of the current time step i t are used to generate new input cell state c t given as 8 c t tanh w c h t 1 i t b c where w c and b c are weights and bias respectively c t 1 and c t are combined by f t and i t to form the cell state of the current time step given by 9 c t f t c t 1 i t c t where represents hadamard product the output of lstm h t is decided by 10 h t o t tanh c t where h t acts as the not only output of the current time step but also the input variable of the next time step besides lstm can have multiple layers in that case h t is transferred to the next layer as data input as shown in fig 2 a a detailed explanation of lstm can be found in kratzert et al 2018 research 2 1 4 improving the performance of ann and lstm in the past few decades researchers have proposed various methods to enable neural networks to have better accuracy faster training speed etc some of them are also used to improve the performance of ann and lstm which are used in our study as summarized herein 1 adaptive moment estimation adam adam is an advanced gradient descent strategy it combines the momentum algorithm sutskever et al 2013 which optimizes the training process by enhancing the gradient descent direction and the rmsprop algorithm tieleman and hinton 2012 which can modify the learning rate of different weights according to their gradients adam enables better learning efficiency and faster convergence compared with traditional gradient descending methods kingma and ba 2015 2 learning rate schedule at the beginning of training a neural network a large learning rate could be used for faster descending of the loss function on the other hand when the minimum is closing smaller steps could be better for the convergence to the minimum therefore in our study the learning rate is scheduled by setting a decay parameter which downscales the learning rate with the progress of training 2 2 traditional physical models the physical model used to simulate gpp in this study is mainly used to compare and illustrate the results of deep learning and machine learning methods we selected three widely used models to calculate gpp rectangular hyperbolic model rh model ec lue model and stomatal conductance photosynthesis transpiration coupling model smpt sb model 2 2 1 rectangular hyperbolic model as one of the most widely used light response photosynthetic models the rectangular hyperbolic model rh model was proposed by bally in 1935 baly 1935 which has the advantages of fewer parameters and higher simulation accuracy the mathematical expression of the rectangular hyperbolic model is as follows 11 p α i p max α i p max where p is the total photosynthetic rate i is the light intensity α 0 is the slope of the light response curve of plant photosynthesis at i 0 also known as the initial quantum efficiency α is used in the calculation of the showing results was obtained based on the observed data in 2014 and pmax is the maximum photosynthetic rate therefore gpp can be calculated on a daily scale only by integrating over time 12 g p p 0 d l α i p max α i p max d t where dl is the hours of sunshine gpp is the photosynthetic rate at the canopy scale umol m 2 s 1 2 2 2 ec lue model the ec lue model was proposed by yuan et al in 2007 yuan et al 2007 it was driven by only four variables leaf area index lai photosynthetic active radiation par air temperature t and the bowen ratio of sensible to latent heat flux used to calculate moisture stress the ec lue model can be expressed as 13 g p p l u e f a p a r p a r where lue is the light use efficiency par is photosynthetic active radiation f a p a r represents the fraction of absorbed par f a p a r is calculated based on lai and light extinction coefficient 14 f a p a r 0 95 1 exp 0 5 l a i the ec lue model employs down regulating scalars ranging from 0 to 1 to characterize the effect of temperature f t and water stress f w on the lue as 15 l u e l u e max f t f w where luemax is the maximum light use efficiency luemax used in the calculation of the showing results was obtained based on the observed data in 2014 f t was calculated at each time step as in the terrestrial ecosystem model raich et al 1991 as 16 f t t t min t t max t t min t t max t t o p t 2 where t is the air temperature and tmin tmax and topt represent the minimum maximum and optimum temperatures for photosynthesis respectively the latent heat le and sensible heat h were used to account for the effect of water stress on photosynthesis yuan et al 2007 17 f w l e l e h 2 2 3 stomatal conductance photosynthesis transpiration coupling model the stomatal conductance photosynthesis transpiration coupling model smpt sb model regards the diffusion of co2 and h2o through the stoma of plant leaves as a comprehensive physical and physiological phenomenon yu et al 2003 and introduces the internal conductance of co2 which effectively improves the practicability of the water carbon coupling model the model has high accuracy in the simulation of maize soybean and trees yu et al 2003 2004 ren et al improved the parameters in the model and established a photosynthesis transpiration coupling model of the ecosystem on the canopy scale in the absence of water stress this model has high accuracy in the simulation of the photosynthetic rate on the canopy scale ren et al 2004 the smpt sb model can be expressed as 18 g p p c r γ 1 1 56 a 1 f d s r a 1 37 r b w r i c where gpp is the photosynthetic rate at canopy scale µmol m 2 s 1 cr is the ambient co2 concentration µmol mol 1 γ is co2 compensation point without dark respiration µmol mol 1 a1 is the constant we calculated that a1 is equal to 3 85 by using 2014 data f d s is the response of stomatal conductance to humidity ra is aerodynamic resistance m2 s mol 1 rbw is the boundary layer resistance m2 s mol 1 and ric is the canopy conductance for co2 m2 s mol 1 co2 compensation point without dark respiration γ for c3 plants can be calculated as brooks and farquhar 1985 19 γ c 3 42 7 1 68 t 25 0 012 t 25 2 where t is air temperature c and for c4 plants woodward and smith 1994 the γ is 20 γ 0 1 γ c 3 f d s can be calculated as yu et al 2003 21 f d s h s where hs is relative humidity the aerodynamic resistance ra in smpt sb model can be expressed as 22 r a 2 24 1 0 2 ln z m d z o m ln z h d z o h k 2 u z where 2 24 10 2 is the coefficient that goes from s m 1 to m2 s mol 1 boundary layer resistance rbw can be expressed as 23 r b w 2 24 10 2 100 α 2 l w u h 1 2 1 e α 2 where α is the attenuation coefficient of wind speed in the canopy α 3 l is the leaf area index w is leaves wide m and uh is the speed at the height of the canopy m s 1 according to yu et al 2001 the internal resistance ric has a form of 24 r i c c i γ a m where ci is intercellular co2 concentration µmol mol 1 and am is the net assimilation rate of co2 µmol m 2 s 1 the ric used in the calculation of the showing results was obtained based on the observed data in 2014 3 case study 3 1 site description the data used in this study were collected from the eddy covariance flux tower observation data of shiyanghe experimental station china agricultural university which is located in wuwei city gansu province china 37 52 n 102 50 e 1581 m the region is located at the eastern end of the hexi corridor with the qilian mountains to the south and the tengger desert to the north water resources are scarce the evaporation of evaporation pans over the years is more than 2000 mm while the average rainfall over the years is only 164 mm and the groundwater table is 40 50 m below the ground surface li et al 2013 the region has a temperate continental climate the annual average temperature is 8 c the annual average cumulative temperature is more than 3550 c and the average sunshine hours are more than 3000 h li et al 2015 see fig 3 for the specific location the area of the site is 400 m 200 m it can meet the requirements of fetch 3 2 data acquisition and processing the site has eddy covariance and automatic weather stations systems to measure ecosystem water and carbon fluxes as well as the relevant weather conditions air temperature ta and relative humidity rh were measured by a temperature and humidity probe at 3 m hmp155a csi usa photosynthetic active radiation par was measured with a hobo automatic weather station onset computer corporation usa soil temperature probes 109l campbell scientific inc usa and soil moisture probes cs616 campbell scientific inc usa were installed to monitor the variations in the soil temperature and soil water content swc respectively at depths of 20 cm 40 cm 60 cm 80 cm and 100 cm the eddy covariance flux observation tower was installed in the middle of the experiment site the eddy covariance system was consisted of an infrared gas analyzer ec150 campbell scientific inc usa and a three dimensional anemometer csat3 campbell scientific inc usa all the data were collected with a cr3000 campbell scientific inc usa data logger raw data from the ec sensors are continuously recorded at a frequency of 10 hz the observation data were converted into data with a frequency of 30 min by loggernet software campbell scientific inc usa to reduce the heterogeneity of vegetation on the underlying surface and the errors caused by instrument installation eddypro software li cor usa was used to further process the observation data the procedures included spike detection two dimensional coordinate rotation lag correction of h2o co2 relative to the vertical wind component sonic virtual temperature correction density fluctuations wpl correction and frequency response correction since the stability of atmospheric conditions at night reduced the quality of the data we use the frictional wind speed to process the data according to the average test method we eliminated the night data when the frictional wind speed was less than the critical frictional wind speed from 2014 to 2018 the critical friction wind speeds were 0 15 m s 1 0 15 m s 1 0 20 m s 1 0 18 m s 1 and 0 12 m s 1 respectively data gaps caused by turbulent flux or instrument failure are divided into the short gap 2 h and the long gap 2 h gao et al 2017 the former was filled by linear interpolation while the latter was filled by statistical and empirical models baldocchi 2003 the michaelis menten equation michaelis and menten 1913 was used for the daytime data gaps 25 n e e e r α p a r p m a x p m a x m a x the van t hoff equation was used for nighttime data gaps collatz et al 1991 26 e r e r r e f e x p b t s t r e f where erref is the reference er at 10 c b is the regression parameter ts is the surface temperature and tref is the reference surface temperature at 10 c the difference between the nee and the calculated er is gpp 27 g p p e r n e e 3 3 model evaluation parameters the parameters of the ml and dl models are manually determined through a series of pre tests as summarized in table 1 these parameters that have a significant impact on results are further discussed in section 4 the performance of different models is evaluated by decision coefficient r2 root mean error rmse and nash sutcliffe efficiency coefficient nse given as 28 r 2 i 1 n e i o i 2 i 1 n o i o i 2 29 r m s e 1 n i 1 n e i o i 2 30 n s e 1 i 1 n o i e i 2 i 1 n e i o i 2 4 results 4 1 model performance 4 1 1 overall evaluation of simulation effect of whole growth period model fig 4 showed the half hour simulated results given by svr ann and lstm compared with three physical models ec lue rh and smpt sb in 2018 it can be found that all the ml and dl methods perform better than physical models for example the nses of the three machine learning methods were all greater than 0 90 which showed accurate prediction results of the half hour gpp as a comparison the nse of the physical models were 0 75 0 83 and 0 74 respectively the superiority of the ml and dl methods is also reflected in smaller r2 and rmse among all the tested methods svr showed the best performance svr was accurate for all half hour gpp predictions with only a few deviations but all within acceptable limits to further assess the performance of three machine learning methods over the whole maize growing seasons the daily variations of gpp were also compared in fig 5 which were the daily summation of data in fig 4 same as the half hour prediction results the ml and dl methods performed better than the physical models where svr had the best performance among them the overall accuracy of svr was higher and gpp was underestimated only on a few dates such as day 107 although ann and lstm also had high overall accuracy the estimated results in a few periods were inaccurate for example ann had a large error in the early and middle growth stages while lstm overestimated the values of gpp in the late growth stages the reason could be explained as follows in the training process of ann and lstm the training data were separated into small batches the models are trained by the batched data respectively rather than considering all the data at one time therefore the trained model may fall into local optimality which had good accuracy for some data while performing poorly for others in comparison svr considers all the data at the same time so it can better balance the error between different data compared with the machine learning models the performance of the three physical models was poor especially in the early and middle stages of crop growth from the simulated results of both half hour gpp and daily gpp we could see that the ml and dl models performed better than the traditional physical models although the physical mechanism of machine learning methods was not clear enough they could automatically adjust model parameters through long term and large quantities of data and better reveal the nonlinear relationship between output data and input variables to adapt to different situations most of the traditional physical models contain parameters that need to be specified empirically or calibrated based on available data but the accuracy of the physical model will be significantly affected by inaccurate calibration besides due to the differences in physiological properties of plants in different growth stages it was often difficult to use a fixed set of physical model parameters to represent the whole growth process more accurate application of physical models often needs to validate parameters in different growth stages which increased the difficulty to apply physical models on the contrary when training the ml and dl methods the growing time can be regarded as inputs and features of different growth stages can be integrated into the trained models thus dividing the growth into different stages was not required which emphasizes the practicability of the ml and dl models 4 1 2 evaluation of model simulation effect under different conditions since the photosynthesis of plants is influenced by light conditions we chose the sunny and cloudy days with continuous time to analyze the applicability of different models for simulating gpp under different light conditions the results showed that the simulation of each model was better on the sunny day the simulated values of the six models were significantly higher than the observed values but the simulated values of the machine learning models were closer to the observed gpp and the r2 of all the six models reached above 0 95 but the slope of the machine learning models was closer to 1 fig 7a indicating that the simulated results were closer to the observed values on the cloudy day the simulated values were significantly lower than the observed values due to the high dependence of the ec lue and rh models on the light intensity while the simulated values of the smpt sb model are larger than the observed values fig 6 b the simulation of the machine learning models was better than the physical models and the maximum values simulated by the lstm model were relatively close to the observed values irrigation changes the distribution of soil moisture in the soil which has an impact on the energy distribution and farm microclimate of the farmland the simulation effects of different models before and after irrigation were compared to explore the applicability of different models in complex situations before the irrigation event the simulation effects of the six models were not very different and the ec lue model significantly underestimated gpp after 13 00 fig 6c the r2 of all six models reached above 0 96 and the slopes of svr and ann were both 1 08 which were only 8 higher than the observed values after irrigation soil moisture was at a higher level and the simulated values of the smpt sb model were significantly higher than the observed values fig 6d with the simulated values of the svr model being closest to the observed values fig 7 d with a slope of 0 99 the overall results indicated that the lstm was better than the other models for the simulation of the peak gpp on cloudy days and after irrigation while the overall effect of the svr and ann was better than the other models 4 2 the influence of different training data sets on the results 4 2 1 k fold cross validation in order to validate the effectiveness of the ml and dl methods with different training data the k fold cross validation was used which divided the data into k groups equally then uses each subset of data as a validation set and the remaining k 1 subsets as the training set respectively k fold cross validation can check the generalization ability of the models and effectively avoid the occurrence of overfitting or underfitting which helps to provide more stable and convincing results for example when the data of 2014 was used as the test data the data sets of 2015 2018 were used as the training data by analogy the years 2014 2018 were used as test sets for validation respectively the results of the simulation were shown in fig 8 the ann and lstm were run 20 times and the mean and standard deviation were labeled in the bar chart the svr achieved good prediction accuracy and high stability with different training data sets although the machine learning methods outperformed the traditional physical models in most cases the ann and lstm were relatively more sensitive to the training data set for example the accuracy of ann became worse when predicting the data of 2016 and lstm showed poor performance when predicting the data of 2014 during the training process svr required fewer manually determined parameters and these meters also had less impact on the results in contrast the performance of ann and lstm was more sensitive to parameter choosing therefore when using the same parameters for each set of training and testing data svr could achieve similar performance while ann and lstm may have bad performance for some datasets the influence of parameter setting on these methods was further discussed in section 4 3 4 2 2 comparison of simulation results of different lengths of training data to show the impact of training data on the ml and dl methods their predicting accuracy on the data of 2016 as these data have relatively poor prediction accuracy in the k fold cross validation was further tested with different lengths of training data as shown in fig 9 ann and lstm were run 20 times each and the results were expressed in boxplot by analyzing the results of half hour and daily gpp the rmse of the three machine learning algorithms generally showed a downward trend with the increase in training length while the overall performance of r2 and nse showed an upward trend with the increase of training data length which implied that better prediction accuracy could be achieved by using more training data svr achieved better results for most of the different training data lengths than ann and lstm which indicated its more stable performance besides the accuracy of ann decreased when the training data length increases from 3 years to 4 years this may due to the limited ability of ann to fully reveal different features thus some of the training data which had the diverse pattern to the test data may cause undesired features learned by ann and features that are similar to the test data may be ignored for machine learning algorithms such as ann and lstm the results of each training may be slightly different as the model training methods such as sgd and adam employ stochastic strategies to update model parameters however as more training data were used the results of ann and lstm became more stable i e the differences in accuracy achieved by different training times were smaller this implied that ann and lstm need sufficient training data to ensure stable and predictable results taking svr as an example the daily gpp prediction results using the different lengths of training data lengths were shown in fig 10 when using only 1 year data for training svr had a large simulation bias in the middle and late stages of maize growth and there was an underestimation of gpp where the values of r2 and nse were only 0 63 and 0 51 as the training length increased the simulation accuracy improved significantly when the training length was 4 years the rmse achieved about 1 3 of the original value and the r2 and nse improved to 0 86 and 0 88 4 3 discussion of model parameters to reveal the impacts of parameter settings the performance indicated as nse of half hour data herein of the ml and dl models was tested with different parameters that had a significant impact on the model accuracy fig 11 a and b showed the accuracy of svr concerning the choice of parameters c and ε see eq 1 svr could achieve good results when c is near 0 1 1 and ε 0 1 with the nse around 0 88 fig 9 c and d showed the accuracy of ann and lstm concerning the change of learning rate using different training strategies including sgd sgd with learning rate scheduler sgd s adam and adam with learning rate scheduler adam s it could be found that each training strategy needs a particular learning rate to achieve good performance for example when using sgd s as optimizer ann could achieve good results when the learning rate was close to 10 2 but when using adam s the best learning rate was around 10 4 the choosing of training strategy also significantly impacted model accuracy for example in the best case training ann by sgd could achieve very good results with nse close to 0 9 but when using adam as the trainer nse could only reach 0 83 at most comparing the impacts of parameters on svr we could find that performance of ann and lstm were more sensitive to parameter choosing with no easy to find regularity for the relationship between model performance and parameter choosing therefore it was more difficult for ann and lstm to find the best parameter settings 5 discussions 5 1 consider soil moisture content in the input variables based on the results above the tested ml models showed better performance in the gpp prediction compared with traditional physical models such as rh model ec lue model and smpt sb model ml methods had a good ability to identify comprehensive features that determine the non linear relationship between plant growth factors lai and gpp besides these methods had more adaptability to different growth conditions thus it was not required to frequently calibrate model parameters as physical models therefore when historical data was available training ml models could be a more accurate and convenient way to estimate gpp irrigation plays an essential role in the growth of the crop especially in semiarid climates and regions with scarce precipitation during crop reproductive stages grassini et al 2015 zhang et al 2020 drip irrigation under film mulching a water saving irrigation technique is being promoted in northwest china drip irrigation under film mulching can change the distribution of soil water by changing the infiltration process of water flow irrigation directly changes the soil moisture so soil water content has a significant impact on crop growth in arid areas and crop growth directly affects its photosynthetic capacity therefore the influence of soil moisture on photosynthesis can not be ignored when the soil water content is low the stomata of plants gradually close and mesophyll conductance declines which means that the efficiency of co2 uptake and photosynthesis declines de souza et al 2013 bai et al 2019 also proved that the increase in soil water content promoted the uptake of co2 by maize fu et al 2020 found that the decrease in gpp caused by drought was consistent with the decrease in soil water content while studying the sensitivity of gross primary productivity to climate drivers in dry seasons considering the effect of soil moisture on crop growth we used soil moisture as the input data the effect of soil moisture on gpp was also considered in some studies when wu et al 2019 studied the gpp of global forest ecosystems they selected 7 ecological and climatic parameters including precipitation as input parameters wolanin et al 2019 combined process based modeling and the soil canopy energy balance radiative transfer model with sentinel 2 and landsat 8 optical remote sensing data and machine learning methods to estimate crop gpp and this method also took soil moisture as an input parameter dou et al 2018 adopted several machine learning algorithms to simulate forest carbon flux based on eddy covariance measurements these models also took into account the influence of soil moisture on gpp the ml models integrated data from different growth conditions even under different irrigation methods and succeeded in making accurate predictions for the unknown gpp in the test set therefore in practical applications even when historical gpp data are not available in the target region for training data collected from other regions which may have some differences in growth conditions can be used to train the model and applied to the target region or data from different regions and growth conditions can be combined for training to obtain better model accuracy 5 2 applicability of different machine learning models compared with ann and lstm models svr performed slightly better in gpp prediction in different situations the advantage of dl methods was that these methods were more capable of handling compressed features on spatial and temporal scales which were difficult to be handled by conventional mathematical methods li et al 2019 for example the lstm model can memorize the system state over a long period to make predictions however the relationship between plant growth conditions and gpp could be described as a nonlinear relationship without complicated temporal analysis using lstm to predict gpp will increase the complexity of the model and training lstm requires more historical data and more complicated parameter settings in the case of limited data using svr made it easier to efficiently extract the feature relationships between plant growth conditions and gpp from the limited training data therefore svr could achieve higher accuracy than lstm as for ann its complexity is lower than lstm thus is easier for training therefore ann can achieve high model accuracy under specific conditions e g ann can achieve better performance than lstm and svr when trained with sgd as shown in fig 11 d however ann is more sensitive to the data and parameters used for training for example the model performance is lower when training ann with adam in addition it can also be seen from fig 7 that ann performs worse when using 4 years of training data than using 3 years of training data which may be due to the discrepant data features of the final year therefore in most cases the final prediction accuracy of the ann model is also than that of the svr another advantage of svr is that the choice of model parameters is more convenient ann and lstm models involve a large number of parameters that need to be manually determined during the model construction process such as model training method learning rate number of hidden layers hidden layer size etc and there is no clear rule to explain the influence of these parameters on the final accuracy of the models so in practical applications it is more difficult to construct suitable and accurate ann and lstm models on the contrary the svr model requires fewer parameters to be determined and the impact of different parameters on the model results is clearer thus is easier to determine the optimal parameters 6 conclusions in this study three machine learning models ranging from classical regressions to deep learning were investigated for predicting gross primary productivity in northwest china and compared with traditional gpp simulation models an extensive comparison of the models was performed by evaluating and comparing several statistical metrics input data i e photosynthetic active radiation air temperature humidity soil water content and leaf area index were used in ml models the key findings of this study can be summarized as follows 1 compared with the three traditional gpp simulation models the simulation results of the machine learning models were better and the nses of the half hour scale were more than 0 90 the overall accuracy of svr was higher than ann and lstm the machine learning model also outperformed the traditional physical model on a cloudy days and after irrigation 2 the results of k fold cross validation showed that the svr achieved good prediction accuracy and high stability with different training data sets the ann and lstm were relatively more sensitive to the training data set svr achieved better results for most of the different training data lengths than ann and lstm 3 comparing with the impacts of parameters on svr the performance of ann and lstm were more sensitive to parameter choosing with no obvious regularity for the relationship between model performance and parameter choosing in future studies developing hybrid models such as combining data driven ml and biophysical based approaches will be an important idea and machine learning methods can be used to optimize their configuration and parameters to improve prediction accuracy credit authorship contribution statement hui guo data curation methodology writing original draft xiao zhou methodology supervision writing review editing yi dong writing review editing yahui wang writing review editing sien li conceptualization resources writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we greatly appreciate the careful and precise reviews by anonymous reviewers they paid great effort into improving the manuscript and study this work was financially supported by the chinese national natural science fund 51879262 51790530 51725904 
24274,as an important part of the energy matter cycle gross primary productivity gpp reflects the ability of plants to absorb carbon dioxide from the atmosphere the accurate estimation of gpp is critical to understanding the regional carbon cycle with the development of machine learning ml theory machine learning models are increasingly used to study complex phenomena with high variability in time and space in this study three machine learning models support vector regression svr artificial neural network ann and long short term memory networks lstm were investigated for predicting gpp in northwest china and compared them with the traditional physical models carbon flux various environmental factors and maize growth indices were measured in the maize field over five years in northwest china the rigorous analysis which included statistical comparison and cross validation for the prediction of gpp confirmed that the machine learning models performed better than traditional physical models and the svr model performed the best among the considered ml models with the highest nash efficiency coefficient and the lowest root mean squared error the machine learning model also outperformed the traditional physical models on cloudy days and after irrigation the svr achieved good prediction accuracy and high stability with different training data sets the ann and lstm were relatively more sensitive to the training data set when the training data was sufficient svr ann and lstm could achieve similar prediction accuracy but svr was slightly higher when the training data was small the simulation accuracy of svr was better than ann and lstm the performance of ann and lstm was more sensitive to parameter selection and the relationship between model performance and parameter selection had no obvious regularity based on this comprehensive comparison study it was elicited that the svr model can be successfully applied to gpp simulation of maize fields which provided a new perspective for the application of machine learning modeling in gpp simulation keywords gross primary productivity support vector regression artificial neural network long short term memory networks data availability the authors do not have permission to share data 1 introduction as an important part of terrestrial ecosystems agroecosystems not only provide food fiber and wood products for human beings piao et al 2006 ruiz and bertero 2008 but also play an important role in sequestrating carbon it will help to slow down the increase of atmospheric co2 concentration and achieve carbon neutrality agroecosystems are directly affected by human activities and different farm management practices directly affect carbon emissions from farmland the gross primary productivity gpp is the total amount of carbon dioxide fixed by ecosystems through photosynthesis beer et al 2010 zhang and ye 2021 and it is closely related to plant growth biomass accumulation and distribution in agroecosystems and has a significant impact on the global carbon balance chen et al 2019 accurately predicting the gross primary productivity of agroecosystems is a big challenge for quantifying the global carbon cycle at present the measurement of gross primary productivity at the canopy scale is measured based on respiration models by separating the net ecosystem exchange observed by eddy covariance system however monitoring gpp of plants on a large scale is impractical due to the expensiveness high subsurface requirements and limited observation range of the eddy covariance systems estimating gpp from easily monitored data such as air temperature and radiation is critical to understanding plant growth and assessing the carbon dynamics of terrestrial ecosystems jiang et al 2021 over the past few decades different methods have been developed for gpp estimation light response photosynthetic models rnnning et al 2000 and stomatal conductance models yu et al 2003 were used to simulate photosynthesis at the leaf scale these models performed well in simulating diurnal variation of leaf photosynthesis rate however as the photosynthetic capacity of plants is constantly changing with the growth of plants the parameters of such models often need to be fitted repeatedly and the calculation process is complicated which limits their practicability for gpp simulation on regional scale the light use efficiency models and the process models are generally adopted the light use efficiency models mainly rely on satellite remote sensing data which can hardly observe gpp on a continuous time scale the process models such as the biome bgc model hunt et al 1996 century model melillo et al 1995 beps model liu et al 1997 consider the mechanism of photosynthesis by plants in terms of physiological and ecological processes of vegetation but these models often require a lot of parameters to determine the photosynthetic properties of plants and accurate deployment of these model is difficult besides the above methods mainly focus on the leaf scale and regional scale and there are few studies on the simulation of gpp at the canopy scale although the observations of gross primary productivity are more difficult automated meteorological observation stations are widely distributed around the world therefore the mapping of the relationship between gross primary productivity and meteorological data can be established to predict gpp in unobserved areas machine learning ml methods mitchell 1997 in the field of computer science provide powerful tools to analyze the data behavior to find patterns and correlations among data which do not require comprehensive knowledge about the specific system or excessive engineering experience in recent years ml has been applied to build data driven models rather than explicit expressions for biological processes it is widely used in predicting greenhouse gas emissions and water carbon fluxes in recent years virnodkar et al 2020 based on the eddy covariance flux towers observation data and satellite remote sensing data yang et al 2006 used support vector machine svm to estimate the 8 day evapotranspiration of the us lu and zhuang 2010 used the artificial neural network ann to produce the daily evapotranspiration product in the us wang et al 2017 compared the applicability of ann svm and multivariate adaptive regression in predicting daily latent heat fluxes of different vegetation types in north america xu et al 2018 compared the accuracy of 5 different machine learning methods in predicting regional evapotranspiration beaulieu et al 2020 used the boosted regression trees brts to predict the rate of ch4 emissions from reservoirs in the united states with a fairly low margin of error guevara escobar et al 2021 chose the ensembles of machine learning algorithms to predict the carbon fluxes in the mexican highland shrubs and the gpp was consistent with the simulated value of 0 6 saha et al 2021 used random forest rf to simulate the n2o flux at the farmland scale and explained 65 89 flux variation with fewer input variables in recent years deep learning dl which is proficient in handling more intricate structures and high dimensional data has developed benefitting from improved data collection ability and computing power as a subfield of ml dl can learn very complex functions from raw data and has been applied in many domains including science business and government lecun et al 2015 researchers also have tried to apply dl in the field of agroecosystems and atmospheric environments for example you et al 2017 used convolutional neural network cnn and long short term memory networks lstm to predict soybean yields in the united states and the simulation effect of these two methods was significantly better than that of statistics based methods yang et al 2019 trained cnn with high resolution uav images to predict the yield of rice and the results obtained were far better than the statistical model based on vegetation index yue et al 2020 used the convolutional lstm to predict the variation of meteorological factors and then predicted the growth stage of crops cao et al 2021 used lstm to predict rice yields in china ghosh and behera 2021 used deep learning to estimate the aboveground biomass of mangroves while liu et al 2021 used lstm technology to expand the use of air quality monitoring data this study took maize gpp prediction in the arid region of northwest china as an example based on the carbon flux and meteorological data observed by the eddy covariance system during 2014 2018 this study discussed the prediction performance of several dl and traditional ml methods including lstm ann and support vector regression svr under different conditions as well as compare them with the widely used rectangular hyperbolic model rh model ec lue model and stomatal conductance photosynthesis transpiration coupling model smpt sb model the goal of this study is to explore the following questions 1 compared with traditional physical models whether the ml and dl methods can achieve better gpp prediction accuracy and if so in what case can they have good performance 2 among the ml and dl methods which one has better effectiveness and practicability in the gpp prediction problem 3 how the model parameters and training data will influence the model performance 2 methodology the problem that estimating gpp from available data can be classified as a regression problem which tries to find a relationship between inputs and targets in this study three different regression models in ml and dl are tested and compared which are support vector regression svr artificial neural network ann and long short term memory lstm svr is a good method to deal with the regression problem with nonlinear relationships and has achieved good results in applications such as simulation of evapotranspiration greenhouse gas emissions etc hamrani et al 2020 xia et al 2021 ann and lstm are commonly used in the research of neural network fields to deduce unknown variables through monitoring data among them there are many researches on ann application which is easy to use simple and clear principle the lstm method has a good ability to handle time series data for the prediction of gpp the lstm method may also be better applicable to gpp because the variation of gpp is continuous and may be influenced by the historical growth status of the crop whose growth environment and growth status are continuous time series data so the lstm method may also be applicable to the simulation of gpp 2 1 machine learning and deep learning models 2 1 1 support vector regression support vector regression is based on support vector machine svm theory which is a widely used ml algorithm to classify data with different labels svm tries to find a hyperplane with direction w and offset scalar b i e y w x b to separate the training data according to their labels when the original data are not linearly separable svm employs a kernel function to map the data from the original space to a higher dimensional feature space to enhance linear separability brereton and lloyd 2010 as shown in fig 1 drucker et al 1997 extended svm for regression problems and proposed svr method given a set of training data and corresponding target value x 1 y 1 x n y n svr employs a hyperplane in high dimensional feature space to fit the given training data 1 y w φ x b where φ is the kernel function a commonly used kernel function is rbf kernel e γ x i x 2 where γ is the parameter to be chosen to find optimal w and b the structural risk minimization srm principle is adopted which tries to improve data fitting accuracy while limiting model complexity written as 2 minimize 1 2 w 2 c i 1 n ξ i ξ i subject to y i w φ x i b ε ξ i y i w φ x i b ε ξ i ξ i ξ i 0 i 1 n where ξ i and ξ i are penalizing values to be minimized a training sample will not be penalized if the distance between its target and the estimated value is smaller than the tunable parameter ε c is the penalty parameter that balances model flatness and penalties to estimation errors methodologies to solve eq x and a more detailed explanation of svr can be found in smola and schölkopf 2004 research 2 1 2 artificial neural network ann in this study ann refers to a kind of basic neural network structure with direct connections among layers ann is generally constructed by a collection of many simple connected processors called artificial neurons each neuron receives inputs and maps the input features to a slightly more abstract level lecun et al 2015 3 z n f n w n t i n b where i n is the vector of inputs of neuron n z n represents the output of the neuron w n is the vector of weights b is the bias term f n is the active function which introduces nonlinearity to the neuron an ann arranges and connects the neurons to form an input layer several hidden layers and an output layer it learns experience from the known data by comparing the model outputs with the ground truths i e targets and adjusting the weights of neurons accordingly mean square error mse are commonly used loss function to evaluate the difference between the outputs and labels given as 4 l i o i t i 2 where l o t represent loss outputs and targets of the ann respectively based on the chain rule the loss is propagated backward to each neuron and the weights of neurons are updated by the stochastic gradient descent sgd method baioletti et al 2018 thus an ann can be gradually adjusted with a smaller loss function value which means better performance to match its outputs with targets 2 1 3 long short term memory lstm lstm is a kind of neural network with recurrent structures it is initially proposed by hochreiter schmidhuber 1997 to solve the gradient vanishing problem when processing long time series data the key mechanism of lstm is to employ a cell state c to store the long term state of a system as shown in fig 2 b at arbitrary time step t the input of lstm is model input i t hidden state of the previous time step h t 1 and the cell state of the previous time step c t 1 the output is the hidden state of the current time step h t 1 and refreshed cell state c t three gates are used to control update and utilize the cell state defined as 5 f t σ w f h t 1 i t b f 6 i t σ w i h t 1 i t b i 7 o t σ w o h t 1 i t b o where f t i t and o t are forget gate input gate and output gate respectively w f w i and w o are weights of the gates respectively and b f b i and b o are biases σ represents the sigmoid function the model input of the current time step i t are used to generate new input cell state c t given as 8 c t tanh w c h t 1 i t b c where w c and b c are weights and bias respectively c t 1 and c t are combined by f t and i t to form the cell state of the current time step given by 9 c t f t c t 1 i t c t where represents hadamard product the output of lstm h t is decided by 10 h t o t tanh c t where h t acts as the not only output of the current time step but also the input variable of the next time step besides lstm can have multiple layers in that case h t is transferred to the next layer as data input as shown in fig 2 a a detailed explanation of lstm can be found in kratzert et al 2018 research 2 1 4 improving the performance of ann and lstm in the past few decades researchers have proposed various methods to enable neural networks to have better accuracy faster training speed etc some of them are also used to improve the performance of ann and lstm which are used in our study as summarized herein 1 adaptive moment estimation adam adam is an advanced gradient descent strategy it combines the momentum algorithm sutskever et al 2013 which optimizes the training process by enhancing the gradient descent direction and the rmsprop algorithm tieleman and hinton 2012 which can modify the learning rate of different weights according to their gradients adam enables better learning efficiency and faster convergence compared with traditional gradient descending methods kingma and ba 2015 2 learning rate schedule at the beginning of training a neural network a large learning rate could be used for faster descending of the loss function on the other hand when the minimum is closing smaller steps could be better for the convergence to the minimum therefore in our study the learning rate is scheduled by setting a decay parameter which downscales the learning rate with the progress of training 2 2 traditional physical models the physical model used to simulate gpp in this study is mainly used to compare and illustrate the results of deep learning and machine learning methods we selected three widely used models to calculate gpp rectangular hyperbolic model rh model ec lue model and stomatal conductance photosynthesis transpiration coupling model smpt sb model 2 2 1 rectangular hyperbolic model as one of the most widely used light response photosynthetic models the rectangular hyperbolic model rh model was proposed by bally in 1935 baly 1935 which has the advantages of fewer parameters and higher simulation accuracy the mathematical expression of the rectangular hyperbolic model is as follows 11 p α i p max α i p max where p is the total photosynthetic rate i is the light intensity α 0 is the slope of the light response curve of plant photosynthesis at i 0 also known as the initial quantum efficiency α is used in the calculation of the showing results was obtained based on the observed data in 2014 and pmax is the maximum photosynthetic rate therefore gpp can be calculated on a daily scale only by integrating over time 12 g p p 0 d l α i p max α i p max d t where dl is the hours of sunshine gpp is the photosynthetic rate at the canopy scale umol m 2 s 1 2 2 2 ec lue model the ec lue model was proposed by yuan et al in 2007 yuan et al 2007 it was driven by only four variables leaf area index lai photosynthetic active radiation par air temperature t and the bowen ratio of sensible to latent heat flux used to calculate moisture stress the ec lue model can be expressed as 13 g p p l u e f a p a r p a r where lue is the light use efficiency par is photosynthetic active radiation f a p a r represents the fraction of absorbed par f a p a r is calculated based on lai and light extinction coefficient 14 f a p a r 0 95 1 exp 0 5 l a i the ec lue model employs down regulating scalars ranging from 0 to 1 to characterize the effect of temperature f t and water stress f w on the lue as 15 l u e l u e max f t f w where luemax is the maximum light use efficiency luemax used in the calculation of the showing results was obtained based on the observed data in 2014 f t was calculated at each time step as in the terrestrial ecosystem model raich et al 1991 as 16 f t t t min t t max t t min t t max t t o p t 2 where t is the air temperature and tmin tmax and topt represent the minimum maximum and optimum temperatures for photosynthesis respectively the latent heat le and sensible heat h were used to account for the effect of water stress on photosynthesis yuan et al 2007 17 f w l e l e h 2 2 3 stomatal conductance photosynthesis transpiration coupling model the stomatal conductance photosynthesis transpiration coupling model smpt sb model regards the diffusion of co2 and h2o through the stoma of plant leaves as a comprehensive physical and physiological phenomenon yu et al 2003 and introduces the internal conductance of co2 which effectively improves the practicability of the water carbon coupling model the model has high accuracy in the simulation of maize soybean and trees yu et al 2003 2004 ren et al improved the parameters in the model and established a photosynthesis transpiration coupling model of the ecosystem on the canopy scale in the absence of water stress this model has high accuracy in the simulation of the photosynthetic rate on the canopy scale ren et al 2004 the smpt sb model can be expressed as 18 g p p c r γ 1 1 56 a 1 f d s r a 1 37 r b w r i c where gpp is the photosynthetic rate at canopy scale µmol m 2 s 1 cr is the ambient co2 concentration µmol mol 1 γ is co2 compensation point without dark respiration µmol mol 1 a1 is the constant we calculated that a1 is equal to 3 85 by using 2014 data f d s is the response of stomatal conductance to humidity ra is aerodynamic resistance m2 s mol 1 rbw is the boundary layer resistance m2 s mol 1 and ric is the canopy conductance for co2 m2 s mol 1 co2 compensation point without dark respiration γ for c3 plants can be calculated as brooks and farquhar 1985 19 γ c 3 42 7 1 68 t 25 0 012 t 25 2 where t is air temperature c and for c4 plants woodward and smith 1994 the γ is 20 γ 0 1 γ c 3 f d s can be calculated as yu et al 2003 21 f d s h s where hs is relative humidity the aerodynamic resistance ra in smpt sb model can be expressed as 22 r a 2 24 1 0 2 ln z m d z o m ln z h d z o h k 2 u z where 2 24 10 2 is the coefficient that goes from s m 1 to m2 s mol 1 boundary layer resistance rbw can be expressed as 23 r b w 2 24 10 2 100 α 2 l w u h 1 2 1 e α 2 where α is the attenuation coefficient of wind speed in the canopy α 3 l is the leaf area index w is leaves wide m and uh is the speed at the height of the canopy m s 1 according to yu et al 2001 the internal resistance ric has a form of 24 r i c c i γ a m where ci is intercellular co2 concentration µmol mol 1 and am is the net assimilation rate of co2 µmol m 2 s 1 the ric used in the calculation of the showing results was obtained based on the observed data in 2014 3 case study 3 1 site description the data used in this study were collected from the eddy covariance flux tower observation data of shiyanghe experimental station china agricultural university which is located in wuwei city gansu province china 37 52 n 102 50 e 1581 m the region is located at the eastern end of the hexi corridor with the qilian mountains to the south and the tengger desert to the north water resources are scarce the evaporation of evaporation pans over the years is more than 2000 mm while the average rainfall over the years is only 164 mm and the groundwater table is 40 50 m below the ground surface li et al 2013 the region has a temperate continental climate the annual average temperature is 8 c the annual average cumulative temperature is more than 3550 c and the average sunshine hours are more than 3000 h li et al 2015 see fig 3 for the specific location the area of the site is 400 m 200 m it can meet the requirements of fetch 3 2 data acquisition and processing the site has eddy covariance and automatic weather stations systems to measure ecosystem water and carbon fluxes as well as the relevant weather conditions air temperature ta and relative humidity rh were measured by a temperature and humidity probe at 3 m hmp155a csi usa photosynthetic active radiation par was measured with a hobo automatic weather station onset computer corporation usa soil temperature probes 109l campbell scientific inc usa and soil moisture probes cs616 campbell scientific inc usa were installed to monitor the variations in the soil temperature and soil water content swc respectively at depths of 20 cm 40 cm 60 cm 80 cm and 100 cm the eddy covariance flux observation tower was installed in the middle of the experiment site the eddy covariance system was consisted of an infrared gas analyzer ec150 campbell scientific inc usa and a three dimensional anemometer csat3 campbell scientific inc usa all the data were collected with a cr3000 campbell scientific inc usa data logger raw data from the ec sensors are continuously recorded at a frequency of 10 hz the observation data were converted into data with a frequency of 30 min by loggernet software campbell scientific inc usa to reduce the heterogeneity of vegetation on the underlying surface and the errors caused by instrument installation eddypro software li cor usa was used to further process the observation data the procedures included spike detection two dimensional coordinate rotation lag correction of h2o co2 relative to the vertical wind component sonic virtual temperature correction density fluctuations wpl correction and frequency response correction since the stability of atmospheric conditions at night reduced the quality of the data we use the frictional wind speed to process the data according to the average test method we eliminated the night data when the frictional wind speed was less than the critical frictional wind speed from 2014 to 2018 the critical friction wind speeds were 0 15 m s 1 0 15 m s 1 0 20 m s 1 0 18 m s 1 and 0 12 m s 1 respectively data gaps caused by turbulent flux or instrument failure are divided into the short gap 2 h and the long gap 2 h gao et al 2017 the former was filled by linear interpolation while the latter was filled by statistical and empirical models baldocchi 2003 the michaelis menten equation michaelis and menten 1913 was used for the daytime data gaps 25 n e e e r α p a r p m a x p m a x m a x the van t hoff equation was used for nighttime data gaps collatz et al 1991 26 e r e r r e f e x p b t s t r e f where erref is the reference er at 10 c b is the regression parameter ts is the surface temperature and tref is the reference surface temperature at 10 c the difference between the nee and the calculated er is gpp 27 g p p e r n e e 3 3 model evaluation parameters the parameters of the ml and dl models are manually determined through a series of pre tests as summarized in table 1 these parameters that have a significant impact on results are further discussed in section 4 the performance of different models is evaluated by decision coefficient r2 root mean error rmse and nash sutcliffe efficiency coefficient nse given as 28 r 2 i 1 n e i o i 2 i 1 n o i o i 2 29 r m s e 1 n i 1 n e i o i 2 30 n s e 1 i 1 n o i e i 2 i 1 n e i o i 2 4 results 4 1 model performance 4 1 1 overall evaluation of simulation effect of whole growth period model fig 4 showed the half hour simulated results given by svr ann and lstm compared with three physical models ec lue rh and smpt sb in 2018 it can be found that all the ml and dl methods perform better than physical models for example the nses of the three machine learning methods were all greater than 0 90 which showed accurate prediction results of the half hour gpp as a comparison the nse of the physical models were 0 75 0 83 and 0 74 respectively the superiority of the ml and dl methods is also reflected in smaller r2 and rmse among all the tested methods svr showed the best performance svr was accurate for all half hour gpp predictions with only a few deviations but all within acceptable limits to further assess the performance of three machine learning methods over the whole maize growing seasons the daily variations of gpp were also compared in fig 5 which were the daily summation of data in fig 4 same as the half hour prediction results the ml and dl methods performed better than the physical models where svr had the best performance among them the overall accuracy of svr was higher and gpp was underestimated only on a few dates such as day 107 although ann and lstm also had high overall accuracy the estimated results in a few periods were inaccurate for example ann had a large error in the early and middle growth stages while lstm overestimated the values of gpp in the late growth stages the reason could be explained as follows in the training process of ann and lstm the training data were separated into small batches the models are trained by the batched data respectively rather than considering all the data at one time therefore the trained model may fall into local optimality which had good accuracy for some data while performing poorly for others in comparison svr considers all the data at the same time so it can better balance the error between different data compared with the machine learning models the performance of the three physical models was poor especially in the early and middle stages of crop growth from the simulated results of both half hour gpp and daily gpp we could see that the ml and dl models performed better than the traditional physical models although the physical mechanism of machine learning methods was not clear enough they could automatically adjust model parameters through long term and large quantities of data and better reveal the nonlinear relationship between output data and input variables to adapt to different situations most of the traditional physical models contain parameters that need to be specified empirically or calibrated based on available data but the accuracy of the physical model will be significantly affected by inaccurate calibration besides due to the differences in physiological properties of plants in different growth stages it was often difficult to use a fixed set of physical model parameters to represent the whole growth process more accurate application of physical models often needs to validate parameters in different growth stages which increased the difficulty to apply physical models on the contrary when training the ml and dl methods the growing time can be regarded as inputs and features of different growth stages can be integrated into the trained models thus dividing the growth into different stages was not required which emphasizes the practicability of the ml and dl models 4 1 2 evaluation of model simulation effect under different conditions since the photosynthesis of plants is influenced by light conditions we chose the sunny and cloudy days with continuous time to analyze the applicability of different models for simulating gpp under different light conditions the results showed that the simulation of each model was better on the sunny day the simulated values of the six models were significantly higher than the observed values but the simulated values of the machine learning models were closer to the observed gpp and the r2 of all the six models reached above 0 95 but the slope of the machine learning models was closer to 1 fig 7a indicating that the simulated results were closer to the observed values on the cloudy day the simulated values were significantly lower than the observed values due to the high dependence of the ec lue and rh models on the light intensity while the simulated values of the smpt sb model are larger than the observed values fig 6 b the simulation of the machine learning models was better than the physical models and the maximum values simulated by the lstm model were relatively close to the observed values irrigation changes the distribution of soil moisture in the soil which has an impact on the energy distribution and farm microclimate of the farmland the simulation effects of different models before and after irrigation were compared to explore the applicability of different models in complex situations before the irrigation event the simulation effects of the six models were not very different and the ec lue model significantly underestimated gpp after 13 00 fig 6c the r2 of all six models reached above 0 96 and the slopes of svr and ann were both 1 08 which were only 8 higher than the observed values after irrigation soil moisture was at a higher level and the simulated values of the smpt sb model were significantly higher than the observed values fig 6d with the simulated values of the svr model being closest to the observed values fig 7 d with a slope of 0 99 the overall results indicated that the lstm was better than the other models for the simulation of the peak gpp on cloudy days and after irrigation while the overall effect of the svr and ann was better than the other models 4 2 the influence of different training data sets on the results 4 2 1 k fold cross validation in order to validate the effectiveness of the ml and dl methods with different training data the k fold cross validation was used which divided the data into k groups equally then uses each subset of data as a validation set and the remaining k 1 subsets as the training set respectively k fold cross validation can check the generalization ability of the models and effectively avoid the occurrence of overfitting or underfitting which helps to provide more stable and convincing results for example when the data of 2014 was used as the test data the data sets of 2015 2018 were used as the training data by analogy the years 2014 2018 were used as test sets for validation respectively the results of the simulation were shown in fig 8 the ann and lstm were run 20 times and the mean and standard deviation were labeled in the bar chart the svr achieved good prediction accuracy and high stability with different training data sets although the machine learning methods outperformed the traditional physical models in most cases the ann and lstm were relatively more sensitive to the training data set for example the accuracy of ann became worse when predicting the data of 2016 and lstm showed poor performance when predicting the data of 2014 during the training process svr required fewer manually determined parameters and these meters also had less impact on the results in contrast the performance of ann and lstm was more sensitive to parameter choosing therefore when using the same parameters for each set of training and testing data svr could achieve similar performance while ann and lstm may have bad performance for some datasets the influence of parameter setting on these methods was further discussed in section 4 3 4 2 2 comparison of simulation results of different lengths of training data to show the impact of training data on the ml and dl methods their predicting accuracy on the data of 2016 as these data have relatively poor prediction accuracy in the k fold cross validation was further tested with different lengths of training data as shown in fig 9 ann and lstm were run 20 times each and the results were expressed in boxplot by analyzing the results of half hour and daily gpp the rmse of the three machine learning algorithms generally showed a downward trend with the increase in training length while the overall performance of r2 and nse showed an upward trend with the increase of training data length which implied that better prediction accuracy could be achieved by using more training data svr achieved better results for most of the different training data lengths than ann and lstm which indicated its more stable performance besides the accuracy of ann decreased when the training data length increases from 3 years to 4 years this may due to the limited ability of ann to fully reveal different features thus some of the training data which had the diverse pattern to the test data may cause undesired features learned by ann and features that are similar to the test data may be ignored for machine learning algorithms such as ann and lstm the results of each training may be slightly different as the model training methods such as sgd and adam employ stochastic strategies to update model parameters however as more training data were used the results of ann and lstm became more stable i e the differences in accuracy achieved by different training times were smaller this implied that ann and lstm need sufficient training data to ensure stable and predictable results taking svr as an example the daily gpp prediction results using the different lengths of training data lengths were shown in fig 10 when using only 1 year data for training svr had a large simulation bias in the middle and late stages of maize growth and there was an underestimation of gpp where the values of r2 and nse were only 0 63 and 0 51 as the training length increased the simulation accuracy improved significantly when the training length was 4 years the rmse achieved about 1 3 of the original value and the r2 and nse improved to 0 86 and 0 88 4 3 discussion of model parameters to reveal the impacts of parameter settings the performance indicated as nse of half hour data herein of the ml and dl models was tested with different parameters that had a significant impact on the model accuracy fig 11 a and b showed the accuracy of svr concerning the choice of parameters c and ε see eq 1 svr could achieve good results when c is near 0 1 1 and ε 0 1 with the nse around 0 88 fig 9 c and d showed the accuracy of ann and lstm concerning the change of learning rate using different training strategies including sgd sgd with learning rate scheduler sgd s adam and adam with learning rate scheduler adam s it could be found that each training strategy needs a particular learning rate to achieve good performance for example when using sgd s as optimizer ann could achieve good results when the learning rate was close to 10 2 but when using adam s the best learning rate was around 10 4 the choosing of training strategy also significantly impacted model accuracy for example in the best case training ann by sgd could achieve very good results with nse close to 0 9 but when using adam as the trainer nse could only reach 0 83 at most comparing the impacts of parameters on svr we could find that performance of ann and lstm were more sensitive to parameter choosing with no easy to find regularity for the relationship between model performance and parameter choosing therefore it was more difficult for ann and lstm to find the best parameter settings 5 discussions 5 1 consider soil moisture content in the input variables based on the results above the tested ml models showed better performance in the gpp prediction compared with traditional physical models such as rh model ec lue model and smpt sb model ml methods had a good ability to identify comprehensive features that determine the non linear relationship between plant growth factors lai and gpp besides these methods had more adaptability to different growth conditions thus it was not required to frequently calibrate model parameters as physical models therefore when historical data was available training ml models could be a more accurate and convenient way to estimate gpp irrigation plays an essential role in the growth of the crop especially in semiarid climates and regions with scarce precipitation during crop reproductive stages grassini et al 2015 zhang et al 2020 drip irrigation under film mulching a water saving irrigation technique is being promoted in northwest china drip irrigation under film mulching can change the distribution of soil water by changing the infiltration process of water flow irrigation directly changes the soil moisture so soil water content has a significant impact on crop growth in arid areas and crop growth directly affects its photosynthetic capacity therefore the influence of soil moisture on photosynthesis can not be ignored when the soil water content is low the stomata of plants gradually close and mesophyll conductance declines which means that the efficiency of co2 uptake and photosynthesis declines de souza et al 2013 bai et al 2019 also proved that the increase in soil water content promoted the uptake of co2 by maize fu et al 2020 found that the decrease in gpp caused by drought was consistent with the decrease in soil water content while studying the sensitivity of gross primary productivity to climate drivers in dry seasons considering the effect of soil moisture on crop growth we used soil moisture as the input data the effect of soil moisture on gpp was also considered in some studies when wu et al 2019 studied the gpp of global forest ecosystems they selected 7 ecological and climatic parameters including precipitation as input parameters wolanin et al 2019 combined process based modeling and the soil canopy energy balance radiative transfer model with sentinel 2 and landsat 8 optical remote sensing data and machine learning methods to estimate crop gpp and this method also took soil moisture as an input parameter dou et al 2018 adopted several machine learning algorithms to simulate forest carbon flux based on eddy covariance measurements these models also took into account the influence of soil moisture on gpp the ml models integrated data from different growth conditions even under different irrigation methods and succeeded in making accurate predictions for the unknown gpp in the test set therefore in practical applications even when historical gpp data are not available in the target region for training data collected from other regions which may have some differences in growth conditions can be used to train the model and applied to the target region or data from different regions and growth conditions can be combined for training to obtain better model accuracy 5 2 applicability of different machine learning models compared with ann and lstm models svr performed slightly better in gpp prediction in different situations the advantage of dl methods was that these methods were more capable of handling compressed features on spatial and temporal scales which were difficult to be handled by conventional mathematical methods li et al 2019 for example the lstm model can memorize the system state over a long period to make predictions however the relationship between plant growth conditions and gpp could be described as a nonlinear relationship without complicated temporal analysis using lstm to predict gpp will increase the complexity of the model and training lstm requires more historical data and more complicated parameter settings in the case of limited data using svr made it easier to efficiently extract the feature relationships between plant growth conditions and gpp from the limited training data therefore svr could achieve higher accuracy than lstm as for ann its complexity is lower than lstm thus is easier for training therefore ann can achieve high model accuracy under specific conditions e g ann can achieve better performance than lstm and svr when trained with sgd as shown in fig 11 d however ann is more sensitive to the data and parameters used for training for example the model performance is lower when training ann with adam in addition it can also be seen from fig 7 that ann performs worse when using 4 years of training data than using 3 years of training data which may be due to the discrepant data features of the final year therefore in most cases the final prediction accuracy of the ann model is also than that of the svr another advantage of svr is that the choice of model parameters is more convenient ann and lstm models involve a large number of parameters that need to be manually determined during the model construction process such as model training method learning rate number of hidden layers hidden layer size etc and there is no clear rule to explain the influence of these parameters on the final accuracy of the models so in practical applications it is more difficult to construct suitable and accurate ann and lstm models on the contrary the svr model requires fewer parameters to be determined and the impact of different parameters on the model results is clearer thus is easier to determine the optimal parameters 6 conclusions in this study three machine learning models ranging from classical regressions to deep learning were investigated for predicting gross primary productivity in northwest china and compared with traditional gpp simulation models an extensive comparison of the models was performed by evaluating and comparing several statistical metrics input data i e photosynthetic active radiation air temperature humidity soil water content and leaf area index were used in ml models the key findings of this study can be summarized as follows 1 compared with the three traditional gpp simulation models the simulation results of the machine learning models were better and the nses of the half hour scale were more than 0 90 the overall accuracy of svr was higher than ann and lstm the machine learning model also outperformed the traditional physical model on a cloudy days and after irrigation 2 the results of k fold cross validation showed that the svr achieved good prediction accuracy and high stability with different training data sets the ann and lstm were relatively more sensitive to the training data set svr achieved better results for most of the different training data lengths than ann and lstm 3 comparing with the impacts of parameters on svr the performance of ann and lstm were more sensitive to parameter choosing with no obvious regularity for the relationship between model performance and parameter choosing in future studies developing hybrid models such as combining data driven ml and biophysical based approaches will be an important idea and machine learning methods can be used to optimize their configuration and parameters to improve prediction accuracy credit authorship contribution statement hui guo data curation methodology writing original draft xiao zhou methodology supervision writing review editing yi dong writing review editing yahui wang writing review editing sien li conceptualization resources writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we greatly appreciate the careful and precise reviews by anonymous reviewers they paid great effort into improving the manuscript and study this work was financially supported by the chinese national natural science fund 51879262 51790530 51725904 
