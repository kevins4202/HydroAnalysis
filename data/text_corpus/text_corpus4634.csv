index,text
23170,a mathematical model is developed to estimate the amplification of multidirectional random waves in the paradip port odisha india under the resonance conditions a 3 d boundary element method with the consideration of variable bathymetry is utilized for solving laplace equation in an irregular domain including the partial reflection boundary condition the current numerical scheme is validated through the comparison of simulation results with previous well defined studies along with measurement data for the rectangular harbor six key recorder stations are chosen as port location of moored ship to analyze the wave response in the paradip port for multidirectional random waves further wave spectrum is also estimated based on fast fourier transformation fft with respect to wave period at six recorder stations actual bathymetry of paradip port is utilized to estimate the wave height ratio at each record station for the incident waves with different directions further the resonance frequencies are determined for each directional incident wave and safe locations in paradip port is also identified based on the simulation results thus the proposed numerical scheme can be utilized to foster the prediction of wave profile in the realistic ports or harbors with complex geometries for the safe navigation keywords boundary element method laplace equation bathymetry wave spectrum convergence analysis recorder stations paradip port 1 introduction extreme wave height in coastal regions has a significant impact on ports or harbors connecting to open sea in recent decades paradip port has experienced extreme wave height approximately 3 4 m due to the strong winds generated by cyclone and typhoon in the bay of bengal high amplitude incident waves with resonant frequencies can damage the coastal structures moored ships and ropes in paradip port however it is designed to protect the coastal structures and moored cargo ships etc from the high amplitude long waves it is required to construct an efficient numerical model to analyze the resonance phenomenon in paradip port with actual bathymetry paradip port is one of a major industrial port located in jagatsinghpur district odisha india on the southeast coastal boundary of india in the bay of bengal long period waves frequency matches the natural resonant frequency of harbors or ports it generates high amplification in the inner region of harbor on the free water surface miles and munk 1961 in 1963 ippen and goda analyzed the wave induced amplification factor in a rectangular harbor moreover hwang and tuck 1970 and lee 1971 utilized the helmholtz equation for the analysis of wave induced oscillation in an arbitrarily shaped harbor by using the boundary element method chou and han 1994 1993 hoernig 2010 researchers have used the boundary element method bem to estimate the amplification factor under the resonance conditions in irregular shaped harbor including partial reflection boundaries bellotti 2007 cerrato et al 2016 chen et al 2015 kumar et al 2014 2013 lee 2004 lee and williams 2002 there is a variety of external forcing for inducing the significant wave oscillations such as tsunami waves longshore propagating waves strong typhoons and low high pressure fluctuations near harbor bellotti et al 2012 de jong and battjes 2004 dong et al 2010 several researchers have worked on tsunami waves the most destructive incident waves are generated by a strong earthquake monserrat et al 2006 rabinovich 1997 e g sumatra tsunami rabinovich et al 2006 rabinovich and thomson 2007 traditionally the mild slope equation mse or modified mse is solved by various numerical methods as finite difference method fdm finite element method fem and spectral element method sem to analyze the combined wave refraction diffraction and partial reflection berkhoff 1976 1972 cerrato et al 2017 hsiao and fang 2005 lee et al 2006 li and anastasiou 1992 liu et al 2008 sharma et al 2014 nevertheless numerical schemes based on fdm and fem have some deficiency such as open and partial reflection boundary conditions are difficult to address further these deficiencies have been studied by several researchers such as chen 1986 and tsay et al 1989 utilizing hybrid fem formulation including the bottom friction mei et al 2005 in 3 d boundary element model the bottom topography variable bathymetry is considered while in 2 d boundary element models depth is assumed as constant since the topography and bathymetry of the harbor play a crucial role to analyze the resonance behaviour inside the port yalciner and pelinovsky 2007 estimated the oscillation in the sea of marmara with irregular geometry and bathymetry further rabinovich 1997 analyzed the effect of the bottom topography on the tsunami waves slinn et al 2000 three dimensional 3 d boundary element modeling gives better accuracy to analyze the wave induced oscillations in an irregular bounded domain recently kumar et al 2014 2013 implemented the boundary element method on realistic pohang new harbor south korea bellotti and franco 2011 and guerrini et al 2014 have work in marina di carrara harbor in italy further the redesigning or modification of the original port or harbor simulation result is conducted for the safety of moored ship motion kumar et al 2016 kwak et al 2012 these studies have helped to reduce the wave induced oscillation in realistic harbors and ports the major drawback for the 3 d boundary element model is that it required the more computation time as compared to the 2d boundary element model due to the increment of mess element consideration of bottom topography in the context of this paper we present an efficient 3 d boundary element formulation for a complex geometry domain with variable bathymetry to analyze impacts of the multidirectional random waves under the resonance conditions the partial reflection boundary condition chou and han 1993 is also utilized along with kinematic and dynamic free surface boundary conditions for shallow water waves the green s theorem is applied to solve the laplace equation in the interior or bounded domain where the depth variation is arbitrary distributed and helmholtz equation in exterior or unbounded domain with constant depth the interior domain of a port is bounded by four connected boundaries to each other i e port walls free surface pseudo boundary and bottom topography finally the numerical approximation is obtained after matching the solution at the pseudo boundary surface the common boundary in interior and exterior domain the current numerical approach is applied on a realistic port in india i e the paradip port the second largest port of india to validate the numerical scheme comparison is shown with rectangular and long beach harbor california further numerical scheme for wave spectrum is validate with the given in situ measurement data for pohang new harbor south korea the numerical convergence is obtained to verify the present numerical scheme for the paradip port wave spectrum for multidirectional random wave is analyzed for a realistic harbor with partially reflecting condition by using the mitsuyasu s spectrum amplification factor is evaluated inside the paradip port to locate the safe locations for moored ship this paper is organized as follows in section 2 the boundary element formulation for the variable bathymetry and analytical approximation for constant depth are estimated under the resonance conditions the comparison and convergence analysis for the current numerical scheme is covered in section 3 the proposed 3 d boundary element model is implemented on realistic paradip port odisha india for multi directional random waves in section 4 finally section 5 gives brief summary and conclusion remarks 2 mathematical formulation in fig 1 the pseudo boundary e 1 e 2 e 3 is divided the fluid region into two regions region i i e the open sea region exterior ω o with constant water depth and region ii i e the bounded region interior enclosed by free surface ω f s bottom topography or variable bottom ω s b break waters including harbor walls ω h and pseudo boundary e 1 e 2 e 3 the cartesian coordinate system is taken with z axis vertically upward and x axis along shoreline and y axis towards the open sea the main reason to consider circular boundary instead of simple line at the port entrance because at the entrance and exterior boundary the incident waves are diffracted partially reflected and scatter from the interior harbor boundary the matching boundary condition at the entrance cannot capture the partial reflection diffraction and refraction of the incident wave on the exterior harbor boundaries however the matching boundary condition at some distance away from entrance at circular pseudo boundary can estimate the scatter waves including diffraction refraction and partial reflection at the entrance exterior and interior harbor boundary the outward normal vector is taken on the solid boundary walls and pseudo boundary see fig 1 for simplicity we assumed that the fluid flow is irrotational fluid is inviscid and incompressible velocity vector v can be defined as the gradient of potential function φ x y z t thus the continuity equation is given as follows 2 1 v 2 φ 0 the linear incident waves come from the open sea region with angular frequency ω 2π τ t is incident wave period and a i is the amplitude of the incident wave thus the fluid motion for both the regions will have the velocity potentials function φ of the form 2 2 φ x y z t i g a i ω ϕ x y z e i ω t where i is the imaginary number i 1 and g is the gravitational acceleration also potential function ϕ x y z satisfies the laplace equation 2 3 2 ϕ x 2 2 ϕ y 2 2 ϕ z 2 0 2 1 potential function in the bounded region ii region ii interior domain is a three dimensional domain with variable water depth bounded by the pseudo boundary e 1 e 2 e 3 the breakwaters and quays ω h the free water surface ω f s and uneven sea bed ω s b further interior domain divided as pseudo boundary in p breakwaters and quays in n 1 free surface in n 2 and uneven sea bed in n 3 discrete elements the potential function at any point inside the bounded region ii can be calculated by using the green s second identity mei et al 2005 2 4 ϕ x c ϕ x 0 n 1 4 π r ϕ x 0 n 1 4 π r d a where x x y z is a field point x 0 x 0 y 0 z 0 is a source point and the distance between field point and source point is defined as r x x 0 2 y y 0 2 z z 0 2 and n is the outward normal vector the parameter c can be expressed as 2 5 c 1 if x ω f s 2 if x ω h e 1 e 2 e 3 further eq 2 4 can be expressed in matrix form 2 6 ϕ d ϕ d where matrix d ϕ and ϕ d is given as 2 7 d r n 1 r 2 8 ϕ ϕ j ϕ d ϕ n j 1 2 p n 1 n 2 n 3 2 9 r n r n i j r n i j if i j r n i j 1 if i j i j 1 2 p n 1 n 2 n 3 2 10 r n i j c n 1 4 π r d a 2 11 r r i j c 1 4 π r d a whereas ϕ d represents the normal derivative of the potential function on the pseudo boundary surface e 1 e 2 e 3 the breakwaters and quays ω h the matrix d represents the coefficient matrix depending on the geometry of the boundaries 2 2 wave potential function in open sea region i in region i open sea water depth is assumed constant therefore wave scattering due to depth variation is considered nil thus in region i wave potential function ϕ 0 x y z is given by the following expression 2 12 ϕ 0 x y z η i n c x y η r a d x y cosh k z h cosh k h where k denotes wave number and it can be written in term of angular wave frequency ω by dispersion relation i e ω 2 g k tanh k h for shallow water waves k h 1 i e tanh k h k h η i n c is the incident incoming wave propagating towards pseudo boundary from various directions and η r a d is the radiated wave emanating wave moving out from the entrance of harbor to open sea region due to diffraction refraction and partial reflection at interior boundaries and breakwaters decay to infinity thus the monochromatic incident wave is defined in terms of incident wave angle i e 2 13 η i n c a i exp i k x cos θ i n c y sin θ i n c where a i is the incident wave amplitude θ i n c is the incident wave angle substitute eq 2 12 into eq 2 3 the radiated wave function η r a d x y satisfied the helmholtz equation i e 2 14 2 x 2 2 y 2 k 2 η r a d 0 in region i the exterior of pseudo boundary and scattered waves propagates towards open sea satisfies the somerfield radiation boundary condition at infinity the radiated wave function η r a d x y for any point lying in region i can be calculated after applying green s formula by 2 15 η r a d x y c e 1 e 2 e 3 η r a d x 0 y 0 n h 0 1 k r h 0 1 k r n η r a d x 0 y 0 d s x 0 y 0 here the field point x y approaches to the source point x 0 y 0 and r is the distance between the field point and source point the parameter c is given as 2 16 c i 4 if x y lie inside region i i 2 if x y lie on the pseduo boundary line e 1 e 2 e 3 if pseudo boundary line e 1 e 2 e 3 divided into p 1 line segments and the point x y lie on the pseudo boundary the matrix form of eq 2 15 is written as 2 17 η r a d d η r a d d where the matrix d can be written as 2 18 d h n 1 h 2 19 η r a d η r a d j η r a d d n η r a d j j 1 2 p 1 2 20 h n h n i j h n i j if i j h n i j 1 if i j i j 1 2 p 1 2 21 h n i j c e 1 e 2 e 3 n h 0 1 k r d s 2 22 h h i j c e 1 e 2 e 3 h 0 1 k r d s η r a d and η r a d d denotes the wave function and its normal derivate on the pseudo boundary line e 1 e 2 e 3 and d represents the coefficient matrix depends on the geometric location of the pseudo boundary e 1 e 2 e 3 2 3 boundary conditions in region i and region ii the boundary conditions are given on the sea bed ω s b the free surface ω f s the solid harbor walls and breakwaters ω h and pseudo boundary e 1 e 2 e 3 as follows a at the sea bed ω s b the fluid flow in the normal direction is zero i e 2 23 ϕ d 0 b the boundary condition on the free water surface ω f s is given by 2 24 ϕ d ω 2 g ϕ c the boundary condition at the quays and breakwaters ω h in the port is considered as partially reflected the partial reflection boundary condition on the harbor walls and breakwaters is given by isaacson and qu 1990 2 25 ϕ n l p k ϕ 0 where l p is transmission coefficient i e l p l p 1 i l p 2 further the transmission coefficients are written in terms of reflection coefficient r c and incident wave angel β reflection coefficient defined as the ratio of reflected wave to incident wave height hence the transmission coefficient is given for the partially reflecting boundary i e 2 26 l p 1 2 r c sin γ cos β 1 r c 2 2 r c cos γ l p 2 1 r c 2 cos β 1 r c 2 2 r c cos γ where γ denotes as reflection phase angle and β denotes incident wave angle to the entrance in case of fully reflected boundary the reflection coefficient r c 1 and phase angle γ 0 while in reverse case the reflection coefficient r c 0 and phase angle γ 0 for fully absorption boundary hence the transmission coefficients are given by 2 27 l p 1 0 l p 2 1 r c 1 r c d the matching boundary conditions on the pseudo boundary surface e 1 e 2 e 3 is given by 2 28 ϕ 0 d ϕ d 2 29 ϕ 0 x y z ϕ x y z substituting eq 2 12 into 2 28 multiplying cosh k z h both sides then integrate form h to 0 with respect to z we get h 0 η i n c d x y η r a d d x y cosh 2 k z h cosh k h d z h 0 ϕ d x y z cosh k z h d z divide the pseudo boundary surface e 1 e 2 e 3 into p 1 segments vertically and n segments horizontally then the above equation can be written in discretized form as 2 30 η r a d d x i y i w 0 j 1 n ϕ d x i y i z j cosh k z j h δ z j η i n c d x i y i where the parameter w 0 2 k sinh k h 1 2 k h sinh 2 k h is written in terms of wave number moreover eq 2 30 is written by the following matrix form 2 31 η r a d d w 0 q ϕ d η i n c d where the matrix q is written in terms of cosh k z h with depth variation the coefficient matrix q is depending on the location of the pseudo boundary e 1 e 2 e 3 substituting eq 2 12 into eq 2 29 we get 2 32 ϕ x i y i z i η i n c x i y i η r a d x i y i cosh k z h cosh k h i 1 2 p 1 n using eq 2 17 and eq 2 31 into eq 2 32 then the matrix form is written as 2 33 ϕ 1 b η i n c d η i n c d w 0 b d q ϕ 1 d where the matrix b is given as cosh k z h cosh k h as z varies with segment wise ϕ 1 represents the wave function on the pseudo boundary surface e 1 e 2 e 3 eq 2 33 represents the relationship between potential function and their normal derivative with on the pseudo boundary surface e 1 e 2 e 3 using eq 2 24 eq 2 25 and eq 2 33 into 2 6 the system of equations into matrix form is written as 2 34 d 11 w 0 b d q l p k d 12 ω 2 g d 13 d 21 l p k d 22 i ω 2 g d 23 d 31 l p k d 32 ω 2 g d 33 i ϕ 1 d ϕ 2 ϕ 3 b η i n c d η i n c d 0 0 by using gauss elimination the system of a linear equation given in eq 2 34 is solved where normal derivative of the potential wave function on the pseudo boundary line e 1 e 2 e 3 is represented by ϕ 1 d potential function on the quays and breakwater ω h is represented by ϕ 2 and potential function on the free surface ω f s is represented by ϕ 3 the potential function ϕ 3 at any interior point x y z in the bounded region port is also described as the wave filed wave field ϕ 3 x y z at any point inside the port is estimated by solving the linear system of eq 2 34 the free surface of port ω f s is discretized into n3 number of discrete points to obtain the wave field at these points amplification factor af at any point x y z in the interior of the harbor is defined as the ratio of the wave amplitude at that point to incident wave amplitude i e a f ϕ x y z ϕ i n c x y z 2 4 wave spectrum the wave spectrum provides the information about the distribution of the wave energy among the different wave periods on the sea surface most efficient method is fast fourier transformation fft to calculate the wave spectrum kumar et al 2015 the multidirectional irregular waves are communicated by incident directional wave spectrum s f θ i n c which is expressed as the product of frequency spectrum s f and a spreading function in multidirectional e f θ i n c i e 2 35 s f θ i n c s f e f θ i n c where s f is a multi directional frequency spectrum and e f θ i n c is a dimensionless directional wave spreading function under the normalization condition the function s f θ i n c is called the directional wave spectral density function and it has the dimension of m 2 s radian the frequency spectrum s f can be written in the form of mitsuyasu spectrum as the function of significant wave height h s and period t s i e 2 36 s f 0 258 h s 2 t s 4 f 5 e 1 03 t s f 4 a significant number of field measurements have been conducted by mitsuyasu et al 1975 for the elucidation of the functional form of e f θ i n c thus the wave directional spreading function e f θ i n c is summarized as 2 37 e f θ i n c e 0 cos 2 s θ i n c θ 0 2 where θ 0 is the principle direction of incident wave and e 0 1 2 π 2 2 s 1 γ 2 s 1 γ 2 s 1 represents a constant 3 validation and convergence analysis 3 1 validation of the present numerical scheme the amplification factor of the 3d bem is evaluated for a fully open rectangle domain with length l 0 3112 meters breadth b 0 06045 meters and depth d 0 2573 meters at the back of wall in the middle point w in fig 2 the present numerical method is compared with the analytical approximation and previous studies by lee 1971 and ippen and goda 1963 in current numerical model entrance in p 6 quays in n 1 88 free surface in n 2 100 and even sea bed in n 3 50 discrete elements are discretized the x axis is considered as non dimensional wave number k l l is the length of the rectangular harbor and the y axis is placed as an amplification factor it is observed that the simulation results for current numerical scheme show good agreement with analytic approximation and experimental data conducted by lee 1971 and ippen and goda 1963 therefore the present numerical method is validated to implement on realistic harbor furthermore the present numerical method is also compared with arbitrary shaped harbor theory lee 1971 and measurement data given by lee 1971 at the point q 0 4023 m 0 2926 m for the long beach harbor california usa see fig 3 the resonance modes for long beach harbor are obtained at ka 0 61 ka 1 50 ka 3 32 ka 5 30 ka 6 60 and ka 7 64 the present numerical scheme is well consistent with arbitrary shaped harbor theory and experimental data obtained by lee 1971 pohang new harbor pnh south korea is chosen to validate the present numerical scheme for estimating the wave spectrum at different record stations wave spectrum in pnh is estimated at three recorder stations s1 s2 and s3 as given in fig 4 the wave spectrum is estimated by measurement data at recorder stations s1 s2 and s3 as shown in fig 4 a the resonance frequency is obtained at wave period t1 5 min t2 8 min t3 22 28 min and t4 78 84 min respectively in fig 4 b the wave spectrum at recorder stations s1 s2 and s3 is shown by using the current numerical scheme which shows the good agreement with measurement data therefore the current numerical scheme is applied on paradip port odisha to estimate the wave spectrum with respect to wave period 3 2 paradip port paradip port is situated on the bay of bengal in jagatsinghpur district of odisha india its exact location in terms of latitude and longitude is 20 15 55 44 n and 20 40 27 34 e respectively it was built to serve the several states of india including odisha chhattisgarh jharkhand madhya pradesh west bengal uttar pradesh and bihar for industrial purposes the annual cargo handling capacity of paradip port is 126 94 million metric tons mmt with maximum ship size 260 000 dead weight tonnage dwt paradip port is experienced extreme wave oscillation from 3 5 to 5 3 m during the seasonal weather conditions the topography image of paradip port is shown in fig 5 which is taken by google maps the locations of six recorder stations r1 r6 in terms of longitude and latitude coordinates are presented in table 1 for numerical calculation semi circular arc e 1 e 2 e 3 the pseudo boundary line divides into p 1 75 line segments vertically and n 6 segment horizontally in the direction of depth further the pseudo boundary surface e 1 e 2 e 3 represented by green blocks discretized into p p 1 n 450 elements where port quays and breakwater are denoted by black grids with n 1 1980 discrete elements free water surface ω f s with n 2 1977 elements and the bottom topography ω s b is discretized by n 3 989 see fig 6 outward normal vectors on the pseudo boundary and harbor walls are denoted by outward red lines the actual bottom topography with depth contours ω s b of paradip port is shown in fig 7 the depth near the pseudo boundary is close to 30 m the depth variation near the entrance is approximately 18 m the depth in the interior of paradip port is distributed from 8 m to 18 m 3 3 convergence analysis a numerical scheme converges if its numerical solution tends to the exact solution of the original problem as the mesh grid spacing tends to zero the order of convergence of the present numerical scheme is obtained by using the least square method firstly we considered paradip port with m 1 m 2 and m 3 discrete non uniform finite elements the error norm for i 1 2 can be written as 3 1 error m i ϕ m i x ϕ m x l 2 b m i α where m 1 p n 1 n 2 n 3 m 2 2 m 1 and m 3 2 m 2 α is the order of convergence and b is assumed as constant we have an approximate value of ϕ m is ϕ m 3 the values of α and b are evaluated by solving two linear equations then an iterative scheme is used to proximate the logarithmic error the logarithmic error norm with respect to logarithmic segment division is given for the paradip port in fig 8 utilizing the 3 d bem the order of convergence for paradip port is obtained 1 57 as the segment division increases the error in the numerical scheme is sharply reduced thus the numerical scheme is validated for the implementation 4 implementation on paradip port 4 1 wave height ratio in paradip port in fig 9 the resonance modes frequencies are obtained in paradip port at non dimensional frequency points k 1 1 62 first k 2 3 26 second k 3 4 785 third k 4 6 27 fourth and k 5 7 805 fifth with frequency difference δ k 0 01 the wave height ratio kd are given with incident wave with the angle π 4 π 2 and 3 π 4 there are slight variation in wave amplitude as the direction of the incident wave varies from π 4 to 3 π 4 the resonance modes provide the crucial information to understand the wave phenomenon in the interior of paradip port incident waves with resonant modes or frequencies k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 induced higher resonance as compare to any other incident waves in order to analyze the wave height at key port locations we have chosen the six different locations inside the paradip port as shown in fig 5 these six record stations denote from r1 to r6 in paradip port located near the boundary of the port wave height ratio is obtained at six record stations r 1 r 2 r 3 r 4 r 5 and r 6 in paradip port as shown in fig 10 at each record stations from r1 to r6 the direction of the incident wave is considered with wave angle θ i n c π 4 to θ i n c 3 π 4 further the wave height ratio changes with respect to wave number as the directional of the incident wave change from incident wave angle π 4 to 3 π 4 we have obtained some smaller peaks for all directional incident waves as compare to resonance peaks due to local resonance induced by sharp boundaries of paradip port the incoming waves with global resonance modes are hazardous for the exterior and interior quays and breakwaters of the port it can destroy the coastal structure and moored vessel in the port 4 2 wave spectrum the numerical simulations are conducted at recorder stations from r1 to r6 to determine the wave spectrum of multidirectional waves the wave range is ascertained regarding wave period at each record station r 1 to r 6 the abscissa is taken as the wave period frame varies from 10 s to 100 min while and ordinate is considered as wave spectrum in fig 11 wave spectrum at recorder stations r 1 r 2 r 3 r 4 r 5 and r 6 are given for multidirectional random waves in paradip port the wave period difference is taken as 10 s sec starting from 10 s to 100 min min the resonance peaks at recorder stations r1 to r6 are obtained at frequencies or wave period t 1 f t1 1 5 min t2 5 5 min t3 18 8 min and t4 90 95 min see fig 11 at resonance frequencies t1 1 5 min t2 5 5 min t3 18 8 min and t4 90 95 min the wave spectrum is stronger with respect to rest of frequencies therefore the incident wave with long wave periods can generate high oscillation in the harbor in physical sense these resonance frequencies provide the urgent data information of the approaching incident waves with relating wave periods in this manner wave oscillation in the harbor is known at these resonant frequencies however the resonance created by rest of the frequencies cannot be neglected as they can induce the local resonance these high amplitude waves can destroy coastal structure and moored ship along the harbor boundary the wave spectra at every recorder station are additionally depending on vital parameters i e critical frequencies and the direction of incident waves however the amplitude of wave height ratio test varies at each record station as the direction of incident wave changes from an angle π 4 to 3 π 4 thus the direction of the incident wave and the geometry of port is also crucial parameter to analyze the wave amplification 4 3 ocean surface wave height in paradip port the wave height for the first five resonance modes as k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 and k 5 7 805 at incident wave angle π 4 π 2 and 3 π 4 are estimated in paradip port see fig 12 the wave height for first resonance mode k 1 1 62 at incident wave angle at π 4 is induced stronger resonance as compare to other resonance modes further the wave height at incident wave angle π 4 in the paradip port observed least significant for third resonance mode k 3 4 785 the combined influence of incident wave with wave angle at π 4 and first resonance mode k 1 1 62 is most significant near the entrance of the paradip port the resonance phenomenon is obtained for the incident wave direction at π 2 normal to entrance for first five resonance modes each mode of resonance has different impacts on the wave height in the interior of paradip port however first k 1 1 62 and third resonance mode k 3 4 785 have significant influence in the port for the incident wave propagating normal to entrance similarly the wave height is estimate for first five resonance modes for the directional wave coming at incident wave angle 3 π 4 the moderate wave amplification is incurred for the incident wave angle at π 4 and 3 π 4 as compare to the incident wave angle at π 2 it implies that the direction of the incident waves propagating toward the port is crucial parameter to anlyze the impact of wave oscialltion in the port the wave height on the free surface in an interior of the paradip port for the fourth k 4 6 27 and fifth k 5 7 805 resonance modes have less resonance for the directional incident wave at angle π 4 π 2 and 3 π 4 higher resonance modes signify the short period waves which can induce local resonance in the interior the port the incident wave at 3 π 4 is induced weaker resonance as compare to other directional incident waves thus the direction of incident wave is an important parameter to estimate the wave height in the port incident waves with different resonant frequencies k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 and k 5 7 805 is also a crucial factor to analyze the wave induced osculation in any port overall the surface wave oscillation for different directional incidents waves is analyzed under the resonance conditions i e k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 and k 5 7 805 for the paradip port the incident waves with different resonance modes have the diverse impact in the various key locations in the port as the incident waves direction varies the wave height is also change for each mode of resonance therefore incident wave direction plays a critical role to generate local resonance in paradip port it is observed based on the simulation results that record station r 1 r 2 and r 3 are the critical high amplification location for the moored ship during the extreme weather conditions further the record stations r 4 r 5 and r 6 are the safest locations for loading and unloading of the moored ship in paradip port therefore based on the direction of incident wave and resonance frequency we can identify the resonance profile in the realistic ports or harbors 5 conclusion and discussion a 3 d boundary element numerical model has been presented for the paradip port considering the partial reflection boundary condition variable bathymetry and directional incident waves the green s second identity is utilized to obtained the solution of the laplace equation the paradip port under the resonance conditions the comparison with previous studies lee 1971 ippen and goda 1963 and convergence analysis is conducted to validate the numerical model six record stations r 1 to r 6 are identified to estimate the wave height ratio with different directional incident waves the wave spectrum provides crucial information about the distribution of wave energy with respect to the wave period at key locations inside the paradip port further the resonance modes k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 and k 5 7 805 are obtained for paradip port at each record station from r1 to r6 the direction of the incident waves is considered at angle π 4 π 2 and 3 π 4 to analyze the surface wave height in the paradip port under the resonance conditions safe locations in the paradip port are at recorder station r 4 r 5 and r 6 are identified based on the simulation results for different directional waves and resonant frequencies the direction of incident waves plays an important role to determine the wave oscillation in the interior of the port the present numerical model is implemented to any other complex geometry realistic harbor or port with variable bathymetry under the resonance condition acknowledgement this study is supported by project grant no file no ecr 2016 001680 under the science and engineering research board department of science and technology government of india prof kim kwang ik emeritus pohang university of science and technology south korea has given their sincere suggestion to improve our manuscript we are thankful to the reviewers for their valuable suggestion to improve our manuscript 
23170,a mathematical model is developed to estimate the amplification of multidirectional random waves in the paradip port odisha india under the resonance conditions a 3 d boundary element method with the consideration of variable bathymetry is utilized for solving laplace equation in an irregular domain including the partial reflection boundary condition the current numerical scheme is validated through the comparison of simulation results with previous well defined studies along with measurement data for the rectangular harbor six key recorder stations are chosen as port location of moored ship to analyze the wave response in the paradip port for multidirectional random waves further wave spectrum is also estimated based on fast fourier transformation fft with respect to wave period at six recorder stations actual bathymetry of paradip port is utilized to estimate the wave height ratio at each record station for the incident waves with different directions further the resonance frequencies are determined for each directional incident wave and safe locations in paradip port is also identified based on the simulation results thus the proposed numerical scheme can be utilized to foster the prediction of wave profile in the realistic ports or harbors with complex geometries for the safe navigation keywords boundary element method laplace equation bathymetry wave spectrum convergence analysis recorder stations paradip port 1 introduction extreme wave height in coastal regions has a significant impact on ports or harbors connecting to open sea in recent decades paradip port has experienced extreme wave height approximately 3 4 m due to the strong winds generated by cyclone and typhoon in the bay of bengal high amplitude incident waves with resonant frequencies can damage the coastal structures moored ships and ropes in paradip port however it is designed to protect the coastal structures and moored cargo ships etc from the high amplitude long waves it is required to construct an efficient numerical model to analyze the resonance phenomenon in paradip port with actual bathymetry paradip port is one of a major industrial port located in jagatsinghpur district odisha india on the southeast coastal boundary of india in the bay of bengal long period waves frequency matches the natural resonant frequency of harbors or ports it generates high amplification in the inner region of harbor on the free water surface miles and munk 1961 in 1963 ippen and goda analyzed the wave induced amplification factor in a rectangular harbor moreover hwang and tuck 1970 and lee 1971 utilized the helmholtz equation for the analysis of wave induced oscillation in an arbitrarily shaped harbor by using the boundary element method chou and han 1994 1993 hoernig 2010 researchers have used the boundary element method bem to estimate the amplification factor under the resonance conditions in irregular shaped harbor including partial reflection boundaries bellotti 2007 cerrato et al 2016 chen et al 2015 kumar et al 2014 2013 lee 2004 lee and williams 2002 there is a variety of external forcing for inducing the significant wave oscillations such as tsunami waves longshore propagating waves strong typhoons and low high pressure fluctuations near harbor bellotti et al 2012 de jong and battjes 2004 dong et al 2010 several researchers have worked on tsunami waves the most destructive incident waves are generated by a strong earthquake monserrat et al 2006 rabinovich 1997 e g sumatra tsunami rabinovich et al 2006 rabinovich and thomson 2007 traditionally the mild slope equation mse or modified mse is solved by various numerical methods as finite difference method fdm finite element method fem and spectral element method sem to analyze the combined wave refraction diffraction and partial reflection berkhoff 1976 1972 cerrato et al 2017 hsiao and fang 2005 lee et al 2006 li and anastasiou 1992 liu et al 2008 sharma et al 2014 nevertheless numerical schemes based on fdm and fem have some deficiency such as open and partial reflection boundary conditions are difficult to address further these deficiencies have been studied by several researchers such as chen 1986 and tsay et al 1989 utilizing hybrid fem formulation including the bottom friction mei et al 2005 in 3 d boundary element model the bottom topography variable bathymetry is considered while in 2 d boundary element models depth is assumed as constant since the topography and bathymetry of the harbor play a crucial role to analyze the resonance behaviour inside the port yalciner and pelinovsky 2007 estimated the oscillation in the sea of marmara with irregular geometry and bathymetry further rabinovich 1997 analyzed the effect of the bottom topography on the tsunami waves slinn et al 2000 three dimensional 3 d boundary element modeling gives better accuracy to analyze the wave induced oscillations in an irregular bounded domain recently kumar et al 2014 2013 implemented the boundary element method on realistic pohang new harbor south korea bellotti and franco 2011 and guerrini et al 2014 have work in marina di carrara harbor in italy further the redesigning or modification of the original port or harbor simulation result is conducted for the safety of moored ship motion kumar et al 2016 kwak et al 2012 these studies have helped to reduce the wave induced oscillation in realistic harbors and ports the major drawback for the 3 d boundary element model is that it required the more computation time as compared to the 2d boundary element model due to the increment of mess element consideration of bottom topography in the context of this paper we present an efficient 3 d boundary element formulation for a complex geometry domain with variable bathymetry to analyze impacts of the multidirectional random waves under the resonance conditions the partial reflection boundary condition chou and han 1993 is also utilized along with kinematic and dynamic free surface boundary conditions for shallow water waves the green s theorem is applied to solve the laplace equation in the interior or bounded domain where the depth variation is arbitrary distributed and helmholtz equation in exterior or unbounded domain with constant depth the interior domain of a port is bounded by four connected boundaries to each other i e port walls free surface pseudo boundary and bottom topography finally the numerical approximation is obtained after matching the solution at the pseudo boundary surface the common boundary in interior and exterior domain the current numerical approach is applied on a realistic port in india i e the paradip port the second largest port of india to validate the numerical scheme comparison is shown with rectangular and long beach harbor california further numerical scheme for wave spectrum is validate with the given in situ measurement data for pohang new harbor south korea the numerical convergence is obtained to verify the present numerical scheme for the paradip port wave spectrum for multidirectional random wave is analyzed for a realistic harbor with partially reflecting condition by using the mitsuyasu s spectrum amplification factor is evaluated inside the paradip port to locate the safe locations for moored ship this paper is organized as follows in section 2 the boundary element formulation for the variable bathymetry and analytical approximation for constant depth are estimated under the resonance conditions the comparison and convergence analysis for the current numerical scheme is covered in section 3 the proposed 3 d boundary element model is implemented on realistic paradip port odisha india for multi directional random waves in section 4 finally section 5 gives brief summary and conclusion remarks 2 mathematical formulation in fig 1 the pseudo boundary e 1 e 2 e 3 is divided the fluid region into two regions region i i e the open sea region exterior ω o with constant water depth and region ii i e the bounded region interior enclosed by free surface ω f s bottom topography or variable bottom ω s b break waters including harbor walls ω h and pseudo boundary e 1 e 2 e 3 the cartesian coordinate system is taken with z axis vertically upward and x axis along shoreline and y axis towards the open sea the main reason to consider circular boundary instead of simple line at the port entrance because at the entrance and exterior boundary the incident waves are diffracted partially reflected and scatter from the interior harbor boundary the matching boundary condition at the entrance cannot capture the partial reflection diffraction and refraction of the incident wave on the exterior harbor boundaries however the matching boundary condition at some distance away from entrance at circular pseudo boundary can estimate the scatter waves including diffraction refraction and partial reflection at the entrance exterior and interior harbor boundary the outward normal vector is taken on the solid boundary walls and pseudo boundary see fig 1 for simplicity we assumed that the fluid flow is irrotational fluid is inviscid and incompressible velocity vector v can be defined as the gradient of potential function φ x y z t thus the continuity equation is given as follows 2 1 v 2 φ 0 the linear incident waves come from the open sea region with angular frequency ω 2π τ t is incident wave period and a i is the amplitude of the incident wave thus the fluid motion for both the regions will have the velocity potentials function φ of the form 2 2 φ x y z t i g a i ω ϕ x y z e i ω t where i is the imaginary number i 1 and g is the gravitational acceleration also potential function ϕ x y z satisfies the laplace equation 2 3 2 ϕ x 2 2 ϕ y 2 2 ϕ z 2 0 2 1 potential function in the bounded region ii region ii interior domain is a three dimensional domain with variable water depth bounded by the pseudo boundary e 1 e 2 e 3 the breakwaters and quays ω h the free water surface ω f s and uneven sea bed ω s b further interior domain divided as pseudo boundary in p breakwaters and quays in n 1 free surface in n 2 and uneven sea bed in n 3 discrete elements the potential function at any point inside the bounded region ii can be calculated by using the green s second identity mei et al 2005 2 4 ϕ x c ϕ x 0 n 1 4 π r ϕ x 0 n 1 4 π r d a where x x y z is a field point x 0 x 0 y 0 z 0 is a source point and the distance between field point and source point is defined as r x x 0 2 y y 0 2 z z 0 2 and n is the outward normal vector the parameter c can be expressed as 2 5 c 1 if x ω f s 2 if x ω h e 1 e 2 e 3 further eq 2 4 can be expressed in matrix form 2 6 ϕ d ϕ d where matrix d ϕ and ϕ d is given as 2 7 d r n 1 r 2 8 ϕ ϕ j ϕ d ϕ n j 1 2 p n 1 n 2 n 3 2 9 r n r n i j r n i j if i j r n i j 1 if i j i j 1 2 p n 1 n 2 n 3 2 10 r n i j c n 1 4 π r d a 2 11 r r i j c 1 4 π r d a whereas ϕ d represents the normal derivative of the potential function on the pseudo boundary surface e 1 e 2 e 3 the breakwaters and quays ω h the matrix d represents the coefficient matrix depending on the geometry of the boundaries 2 2 wave potential function in open sea region i in region i open sea water depth is assumed constant therefore wave scattering due to depth variation is considered nil thus in region i wave potential function ϕ 0 x y z is given by the following expression 2 12 ϕ 0 x y z η i n c x y η r a d x y cosh k z h cosh k h where k denotes wave number and it can be written in term of angular wave frequency ω by dispersion relation i e ω 2 g k tanh k h for shallow water waves k h 1 i e tanh k h k h η i n c is the incident incoming wave propagating towards pseudo boundary from various directions and η r a d is the radiated wave emanating wave moving out from the entrance of harbor to open sea region due to diffraction refraction and partial reflection at interior boundaries and breakwaters decay to infinity thus the monochromatic incident wave is defined in terms of incident wave angle i e 2 13 η i n c a i exp i k x cos θ i n c y sin θ i n c where a i is the incident wave amplitude θ i n c is the incident wave angle substitute eq 2 12 into eq 2 3 the radiated wave function η r a d x y satisfied the helmholtz equation i e 2 14 2 x 2 2 y 2 k 2 η r a d 0 in region i the exterior of pseudo boundary and scattered waves propagates towards open sea satisfies the somerfield radiation boundary condition at infinity the radiated wave function η r a d x y for any point lying in region i can be calculated after applying green s formula by 2 15 η r a d x y c e 1 e 2 e 3 η r a d x 0 y 0 n h 0 1 k r h 0 1 k r n η r a d x 0 y 0 d s x 0 y 0 here the field point x y approaches to the source point x 0 y 0 and r is the distance between the field point and source point the parameter c is given as 2 16 c i 4 if x y lie inside region i i 2 if x y lie on the pseduo boundary line e 1 e 2 e 3 if pseudo boundary line e 1 e 2 e 3 divided into p 1 line segments and the point x y lie on the pseudo boundary the matrix form of eq 2 15 is written as 2 17 η r a d d η r a d d where the matrix d can be written as 2 18 d h n 1 h 2 19 η r a d η r a d j η r a d d n η r a d j j 1 2 p 1 2 20 h n h n i j h n i j if i j h n i j 1 if i j i j 1 2 p 1 2 21 h n i j c e 1 e 2 e 3 n h 0 1 k r d s 2 22 h h i j c e 1 e 2 e 3 h 0 1 k r d s η r a d and η r a d d denotes the wave function and its normal derivate on the pseudo boundary line e 1 e 2 e 3 and d represents the coefficient matrix depends on the geometric location of the pseudo boundary e 1 e 2 e 3 2 3 boundary conditions in region i and region ii the boundary conditions are given on the sea bed ω s b the free surface ω f s the solid harbor walls and breakwaters ω h and pseudo boundary e 1 e 2 e 3 as follows a at the sea bed ω s b the fluid flow in the normal direction is zero i e 2 23 ϕ d 0 b the boundary condition on the free water surface ω f s is given by 2 24 ϕ d ω 2 g ϕ c the boundary condition at the quays and breakwaters ω h in the port is considered as partially reflected the partial reflection boundary condition on the harbor walls and breakwaters is given by isaacson and qu 1990 2 25 ϕ n l p k ϕ 0 where l p is transmission coefficient i e l p l p 1 i l p 2 further the transmission coefficients are written in terms of reflection coefficient r c and incident wave angel β reflection coefficient defined as the ratio of reflected wave to incident wave height hence the transmission coefficient is given for the partially reflecting boundary i e 2 26 l p 1 2 r c sin γ cos β 1 r c 2 2 r c cos γ l p 2 1 r c 2 cos β 1 r c 2 2 r c cos γ where γ denotes as reflection phase angle and β denotes incident wave angle to the entrance in case of fully reflected boundary the reflection coefficient r c 1 and phase angle γ 0 while in reverse case the reflection coefficient r c 0 and phase angle γ 0 for fully absorption boundary hence the transmission coefficients are given by 2 27 l p 1 0 l p 2 1 r c 1 r c d the matching boundary conditions on the pseudo boundary surface e 1 e 2 e 3 is given by 2 28 ϕ 0 d ϕ d 2 29 ϕ 0 x y z ϕ x y z substituting eq 2 12 into 2 28 multiplying cosh k z h both sides then integrate form h to 0 with respect to z we get h 0 η i n c d x y η r a d d x y cosh 2 k z h cosh k h d z h 0 ϕ d x y z cosh k z h d z divide the pseudo boundary surface e 1 e 2 e 3 into p 1 segments vertically and n segments horizontally then the above equation can be written in discretized form as 2 30 η r a d d x i y i w 0 j 1 n ϕ d x i y i z j cosh k z j h δ z j η i n c d x i y i where the parameter w 0 2 k sinh k h 1 2 k h sinh 2 k h is written in terms of wave number moreover eq 2 30 is written by the following matrix form 2 31 η r a d d w 0 q ϕ d η i n c d where the matrix q is written in terms of cosh k z h with depth variation the coefficient matrix q is depending on the location of the pseudo boundary e 1 e 2 e 3 substituting eq 2 12 into eq 2 29 we get 2 32 ϕ x i y i z i η i n c x i y i η r a d x i y i cosh k z h cosh k h i 1 2 p 1 n using eq 2 17 and eq 2 31 into eq 2 32 then the matrix form is written as 2 33 ϕ 1 b η i n c d η i n c d w 0 b d q ϕ 1 d where the matrix b is given as cosh k z h cosh k h as z varies with segment wise ϕ 1 represents the wave function on the pseudo boundary surface e 1 e 2 e 3 eq 2 33 represents the relationship between potential function and their normal derivative with on the pseudo boundary surface e 1 e 2 e 3 using eq 2 24 eq 2 25 and eq 2 33 into 2 6 the system of equations into matrix form is written as 2 34 d 11 w 0 b d q l p k d 12 ω 2 g d 13 d 21 l p k d 22 i ω 2 g d 23 d 31 l p k d 32 ω 2 g d 33 i ϕ 1 d ϕ 2 ϕ 3 b η i n c d η i n c d 0 0 by using gauss elimination the system of a linear equation given in eq 2 34 is solved where normal derivative of the potential wave function on the pseudo boundary line e 1 e 2 e 3 is represented by ϕ 1 d potential function on the quays and breakwater ω h is represented by ϕ 2 and potential function on the free surface ω f s is represented by ϕ 3 the potential function ϕ 3 at any interior point x y z in the bounded region port is also described as the wave filed wave field ϕ 3 x y z at any point inside the port is estimated by solving the linear system of eq 2 34 the free surface of port ω f s is discretized into n3 number of discrete points to obtain the wave field at these points amplification factor af at any point x y z in the interior of the harbor is defined as the ratio of the wave amplitude at that point to incident wave amplitude i e a f ϕ x y z ϕ i n c x y z 2 4 wave spectrum the wave spectrum provides the information about the distribution of the wave energy among the different wave periods on the sea surface most efficient method is fast fourier transformation fft to calculate the wave spectrum kumar et al 2015 the multidirectional irregular waves are communicated by incident directional wave spectrum s f θ i n c which is expressed as the product of frequency spectrum s f and a spreading function in multidirectional e f θ i n c i e 2 35 s f θ i n c s f e f θ i n c where s f is a multi directional frequency spectrum and e f θ i n c is a dimensionless directional wave spreading function under the normalization condition the function s f θ i n c is called the directional wave spectral density function and it has the dimension of m 2 s radian the frequency spectrum s f can be written in the form of mitsuyasu spectrum as the function of significant wave height h s and period t s i e 2 36 s f 0 258 h s 2 t s 4 f 5 e 1 03 t s f 4 a significant number of field measurements have been conducted by mitsuyasu et al 1975 for the elucidation of the functional form of e f θ i n c thus the wave directional spreading function e f θ i n c is summarized as 2 37 e f θ i n c e 0 cos 2 s θ i n c θ 0 2 where θ 0 is the principle direction of incident wave and e 0 1 2 π 2 2 s 1 γ 2 s 1 γ 2 s 1 represents a constant 3 validation and convergence analysis 3 1 validation of the present numerical scheme the amplification factor of the 3d bem is evaluated for a fully open rectangle domain with length l 0 3112 meters breadth b 0 06045 meters and depth d 0 2573 meters at the back of wall in the middle point w in fig 2 the present numerical method is compared with the analytical approximation and previous studies by lee 1971 and ippen and goda 1963 in current numerical model entrance in p 6 quays in n 1 88 free surface in n 2 100 and even sea bed in n 3 50 discrete elements are discretized the x axis is considered as non dimensional wave number k l l is the length of the rectangular harbor and the y axis is placed as an amplification factor it is observed that the simulation results for current numerical scheme show good agreement with analytic approximation and experimental data conducted by lee 1971 and ippen and goda 1963 therefore the present numerical method is validated to implement on realistic harbor furthermore the present numerical method is also compared with arbitrary shaped harbor theory lee 1971 and measurement data given by lee 1971 at the point q 0 4023 m 0 2926 m for the long beach harbor california usa see fig 3 the resonance modes for long beach harbor are obtained at ka 0 61 ka 1 50 ka 3 32 ka 5 30 ka 6 60 and ka 7 64 the present numerical scheme is well consistent with arbitrary shaped harbor theory and experimental data obtained by lee 1971 pohang new harbor pnh south korea is chosen to validate the present numerical scheme for estimating the wave spectrum at different record stations wave spectrum in pnh is estimated at three recorder stations s1 s2 and s3 as given in fig 4 the wave spectrum is estimated by measurement data at recorder stations s1 s2 and s3 as shown in fig 4 a the resonance frequency is obtained at wave period t1 5 min t2 8 min t3 22 28 min and t4 78 84 min respectively in fig 4 b the wave spectrum at recorder stations s1 s2 and s3 is shown by using the current numerical scheme which shows the good agreement with measurement data therefore the current numerical scheme is applied on paradip port odisha to estimate the wave spectrum with respect to wave period 3 2 paradip port paradip port is situated on the bay of bengal in jagatsinghpur district of odisha india its exact location in terms of latitude and longitude is 20 15 55 44 n and 20 40 27 34 e respectively it was built to serve the several states of india including odisha chhattisgarh jharkhand madhya pradesh west bengal uttar pradesh and bihar for industrial purposes the annual cargo handling capacity of paradip port is 126 94 million metric tons mmt with maximum ship size 260 000 dead weight tonnage dwt paradip port is experienced extreme wave oscillation from 3 5 to 5 3 m during the seasonal weather conditions the topography image of paradip port is shown in fig 5 which is taken by google maps the locations of six recorder stations r1 r6 in terms of longitude and latitude coordinates are presented in table 1 for numerical calculation semi circular arc e 1 e 2 e 3 the pseudo boundary line divides into p 1 75 line segments vertically and n 6 segment horizontally in the direction of depth further the pseudo boundary surface e 1 e 2 e 3 represented by green blocks discretized into p p 1 n 450 elements where port quays and breakwater are denoted by black grids with n 1 1980 discrete elements free water surface ω f s with n 2 1977 elements and the bottom topography ω s b is discretized by n 3 989 see fig 6 outward normal vectors on the pseudo boundary and harbor walls are denoted by outward red lines the actual bottom topography with depth contours ω s b of paradip port is shown in fig 7 the depth near the pseudo boundary is close to 30 m the depth variation near the entrance is approximately 18 m the depth in the interior of paradip port is distributed from 8 m to 18 m 3 3 convergence analysis a numerical scheme converges if its numerical solution tends to the exact solution of the original problem as the mesh grid spacing tends to zero the order of convergence of the present numerical scheme is obtained by using the least square method firstly we considered paradip port with m 1 m 2 and m 3 discrete non uniform finite elements the error norm for i 1 2 can be written as 3 1 error m i ϕ m i x ϕ m x l 2 b m i α where m 1 p n 1 n 2 n 3 m 2 2 m 1 and m 3 2 m 2 α is the order of convergence and b is assumed as constant we have an approximate value of ϕ m is ϕ m 3 the values of α and b are evaluated by solving two linear equations then an iterative scheme is used to proximate the logarithmic error the logarithmic error norm with respect to logarithmic segment division is given for the paradip port in fig 8 utilizing the 3 d bem the order of convergence for paradip port is obtained 1 57 as the segment division increases the error in the numerical scheme is sharply reduced thus the numerical scheme is validated for the implementation 4 implementation on paradip port 4 1 wave height ratio in paradip port in fig 9 the resonance modes frequencies are obtained in paradip port at non dimensional frequency points k 1 1 62 first k 2 3 26 second k 3 4 785 third k 4 6 27 fourth and k 5 7 805 fifth with frequency difference δ k 0 01 the wave height ratio kd are given with incident wave with the angle π 4 π 2 and 3 π 4 there are slight variation in wave amplitude as the direction of the incident wave varies from π 4 to 3 π 4 the resonance modes provide the crucial information to understand the wave phenomenon in the interior of paradip port incident waves with resonant modes or frequencies k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 induced higher resonance as compare to any other incident waves in order to analyze the wave height at key port locations we have chosen the six different locations inside the paradip port as shown in fig 5 these six record stations denote from r1 to r6 in paradip port located near the boundary of the port wave height ratio is obtained at six record stations r 1 r 2 r 3 r 4 r 5 and r 6 in paradip port as shown in fig 10 at each record stations from r1 to r6 the direction of the incident wave is considered with wave angle θ i n c π 4 to θ i n c 3 π 4 further the wave height ratio changes with respect to wave number as the directional of the incident wave change from incident wave angle π 4 to 3 π 4 we have obtained some smaller peaks for all directional incident waves as compare to resonance peaks due to local resonance induced by sharp boundaries of paradip port the incoming waves with global resonance modes are hazardous for the exterior and interior quays and breakwaters of the port it can destroy the coastal structure and moored vessel in the port 4 2 wave spectrum the numerical simulations are conducted at recorder stations from r1 to r6 to determine the wave spectrum of multidirectional waves the wave range is ascertained regarding wave period at each record station r 1 to r 6 the abscissa is taken as the wave period frame varies from 10 s to 100 min while and ordinate is considered as wave spectrum in fig 11 wave spectrum at recorder stations r 1 r 2 r 3 r 4 r 5 and r 6 are given for multidirectional random waves in paradip port the wave period difference is taken as 10 s sec starting from 10 s to 100 min min the resonance peaks at recorder stations r1 to r6 are obtained at frequencies or wave period t 1 f t1 1 5 min t2 5 5 min t3 18 8 min and t4 90 95 min see fig 11 at resonance frequencies t1 1 5 min t2 5 5 min t3 18 8 min and t4 90 95 min the wave spectrum is stronger with respect to rest of frequencies therefore the incident wave with long wave periods can generate high oscillation in the harbor in physical sense these resonance frequencies provide the urgent data information of the approaching incident waves with relating wave periods in this manner wave oscillation in the harbor is known at these resonant frequencies however the resonance created by rest of the frequencies cannot be neglected as they can induce the local resonance these high amplitude waves can destroy coastal structure and moored ship along the harbor boundary the wave spectra at every recorder station are additionally depending on vital parameters i e critical frequencies and the direction of incident waves however the amplitude of wave height ratio test varies at each record station as the direction of incident wave changes from an angle π 4 to 3 π 4 thus the direction of the incident wave and the geometry of port is also crucial parameter to analyze the wave amplification 4 3 ocean surface wave height in paradip port the wave height for the first five resonance modes as k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 and k 5 7 805 at incident wave angle π 4 π 2 and 3 π 4 are estimated in paradip port see fig 12 the wave height for first resonance mode k 1 1 62 at incident wave angle at π 4 is induced stronger resonance as compare to other resonance modes further the wave height at incident wave angle π 4 in the paradip port observed least significant for third resonance mode k 3 4 785 the combined influence of incident wave with wave angle at π 4 and first resonance mode k 1 1 62 is most significant near the entrance of the paradip port the resonance phenomenon is obtained for the incident wave direction at π 2 normal to entrance for first five resonance modes each mode of resonance has different impacts on the wave height in the interior of paradip port however first k 1 1 62 and third resonance mode k 3 4 785 have significant influence in the port for the incident wave propagating normal to entrance similarly the wave height is estimate for first five resonance modes for the directional wave coming at incident wave angle 3 π 4 the moderate wave amplification is incurred for the incident wave angle at π 4 and 3 π 4 as compare to the incident wave angle at π 2 it implies that the direction of the incident waves propagating toward the port is crucial parameter to anlyze the impact of wave oscialltion in the port the wave height on the free surface in an interior of the paradip port for the fourth k 4 6 27 and fifth k 5 7 805 resonance modes have less resonance for the directional incident wave at angle π 4 π 2 and 3 π 4 higher resonance modes signify the short period waves which can induce local resonance in the interior the port the incident wave at 3 π 4 is induced weaker resonance as compare to other directional incident waves thus the direction of incident wave is an important parameter to estimate the wave height in the port incident waves with different resonant frequencies k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 and k 5 7 805 is also a crucial factor to analyze the wave induced osculation in any port overall the surface wave oscillation for different directional incidents waves is analyzed under the resonance conditions i e k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 and k 5 7 805 for the paradip port the incident waves with different resonance modes have the diverse impact in the various key locations in the port as the incident waves direction varies the wave height is also change for each mode of resonance therefore incident wave direction plays a critical role to generate local resonance in paradip port it is observed based on the simulation results that record station r 1 r 2 and r 3 are the critical high amplification location for the moored ship during the extreme weather conditions further the record stations r 4 r 5 and r 6 are the safest locations for loading and unloading of the moored ship in paradip port therefore based on the direction of incident wave and resonance frequency we can identify the resonance profile in the realistic ports or harbors 5 conclusion and discussion a 3 d boundary element numerical model has been presented for the paradip port considering the partial reflection boundary condition variable bathymetry and directional incident waves the green s second identity is utilized to obtained the solution of the laplace equation the paradip port under the resonance conditions the comparison with previous studies lee 1971 ippen and goda 1963 and convergence analysis is conducted to validate the numerical model six record stations r 1 to r 6 are identified to estimate the wave height ratio with different directional incident waves the wave spectrum provides crucial information about the distribution of wave energy with respect to the wave period at key locations inside the paradip port further the resonance modes k 1 1 62 k 2 3 26 k 3 4 785 k 4 6 27 and k 5 7 805 are obtained for paradip port at each record station from r1 to r6 the direction of the incident waves is considered at angle π 4 π 2 and 3 π 4 to analyze the surface wave height in the paradip port under the resonance conditions safe locations in the paradip port are at recorder station r 4 r 5 and r 6 are identified based on the simulation results for different directional waves and resonant frequencies the direction of incident waves plays an important role to determine the wave oscillation in the interior of the port the present numerical model is implemented to any other complex geometry realistic harbor or port with variable bathymetry under the resonance condition acknowledgement this study is supported by project grant no file no ecr 2016 001680 under the science and engineering research board department of science and technology government of india prof kim kwang ik emeritus pohang university of science and technology south korea has given their sincere suggestion to improve our manuscript we are thankful to the reviewers for their valuable suggestion to improve our manuscript 
23171,during voyages a ship will inevitably encounter wavy conditions that cause heaving motions these motions induce oscillations in the propeller relative to its surrounding fluid causing the propeller to operate in off design conditions under non uniform inflows these environments induced motions will significantly alter propeller performance to study the motions of the propeller of a surface ship in wavy conditions during actual voyages numerical simulations were conducted on an oscillating propeller in cavitating flows by using reynolds averaged navier stokes rans approach the rotations and oscillations of the propeller were coupled using an independently defined set of equations of motion with the oscillations being represented as sinusoidal cyclic motions the numerical propagation of unsteady flow fields was obtained using the overset grid technique this approach allowed the hydrodynamic behaviours of a propeller to be fully investigated in the presence of coupling between the rotations and oscillatory motions of the propeller the effects of non uniform incoming flows on a propeller s unsteady load and the distribution of sheet cavitation and wake field were analysed for two different loading conditions the results of these calculations are significant for propeller design and optimization keywords propeller oscillatory motions off design conditions sheet cavitation 1 introduction propeller is the most widely used device for ships propulsions therefore their viscous flow fields and hydrodynamic performance are important concerns for ship researchers and designers di mascio et al 2014 dubbioso et al 2013 kumar and mahesh 2017 during voyages a surface ship will inevitably encounter wavy conditions that induce heaving motions resulting in oscillations in the propeller relative to its surrounding fluid the operational state of a propeller in these conditions differs from that in still water conditions because of oscillatory motions in addition to forward and rotational motions as well as non uniform flows in previous studies we identified a series of problems caused by the ship following motions of a propeller in actual sea conditions for example for a ship with multiple propellers and rudders the allocation of power to the main engine in actual sea conditions differs from that in still water conditions depending on the actual torque of the propeller some engines may be overloaded while others may be underloaded making it impossible to achieve an optimal efficiency the increasing demand for optimum propeller performance in actual sea conditions and the continuous improvement of computer hardware mean that new considerations such as oscillatory motions and pitching are gradually being implemented in the simulation of ship following propeller motions according to huse 1972 detrimental cavitation effects e g fluctuations in pressure and noise are enhanced by propeller operation in non uniform flow fields and fluctuations in the cavitation volume around a propeller could induce damaging vibrations at the stern therefore a detailed understanding of the cavitation characteristics of a propeller is very important for propeller design cavitation is an extremely complex phase transition that occurs within fluids or at fluid solid interfaces because of the flow energy cavitation significantly reduces the hydrodynamic performance of a propeller and induces vibrations noise and erosion chen et al 2016 paik et al 2010 peng et al 2018 pennings et al 2016 taskar et al 2017 wu et al 2015 thus far cavitation remains a focal point of hydrodynamic studies around the world chow et al 2017 ji et al 2015 long et al 2018 pendar and roohi 2018 wu et al 2016 theoretical calculations on propeller cavitation performance are generally based on potential flow theories or viscous flow theories the panel method and boundary element method bem are the most frequently used potential flow methods for calculating the propeller cavitation performance for instance yari and ghassemi 2013 used bem to calculate the properties pressure distribution on the surface of the propeller s blades and cavity thickness of a dtmb4119 propeller in cavitating and non cavitating conditions with a focus on changes in cross flows during the formation and growth of cavitation the results of their numerical computations showed good agreements to experimental results s gaggero et al 2016a b used an in house bem to assess the comprehensive performance of a propeller that was selected through genetic algorithms and they validated the efficacy of their methods through comparisons with experimental values s gaggero et al 2016a b also used an unsteady bem in the design and optimization of a next generation contracted and loaded tip propeller they calculated the unsteady cavitation performance and propeller induced pressure fluctuations of the propeller and evaluated the performance of the propeller most viscous flow methods for the calculation of propeller cavitation performance are implemented through computational fluid dynamics cfd for example zhu 2015 used ansys fluent to study the relationship between a propeller s skew angles and cavitation based on four dtmb propellers with different skews this led to a detailed analysis on how a propeller s sheet cavitation propeller induced pressure fluctuation and wake field are related to a propeller s skew characteristics based on openfoam huuva and törnros 2016 used an independently developed cfd program to predict the cavitation performance of a pptc propeller and a ducted azimuth thruster their results indicate that this cfd method has a degree of applicability zhu et al 2017 studied methods for the numerical prediction of vortex cavitation in uniform and non uniform flows based on e779a and e779b propellers they found that advanced grid techniques and the selection of appropriate turbulence models are crucial factors for the prediction of vortex cavitation based on the steady and unsteady incompressible reynolds averaged navier stokes rans solvers in openfoam gaggero and villa 2017 predicted the cavitation performance of a pptc propeller and compared their results with those of the star ccm solver and bem the comparison indicated that the rans solver in openfoam has a sufficient level of accuracy if a propeller exhibits oscillatory motions pitching motions or a combination of both the numerical procedures for calculating the propeller s properties can become quite complex studies on oscillating propellers are uncommon although some research has been conducted on this topic politis 2004 used panel methods to calculate the hydrodynamic performance of an impulsively started propeller a propeller in inclined flow and a propeller in heaving motion stable wake patterns were obtained in these calculations and the distribution of forces and pressures on the propeller were accurately predicted under both steady and unsteady conditions wang et al 2017a b numerically analysed the interaction between the free surface and oscillating propellers near the free surface they found that the air ingestion exerted upon the free surface by the oscillating propeller is an extremely complex coupled process that depends on the motion state and operating time of the propeller and the distance between the propeller and free surface wang et al 2017a b also performed numerical simulations on oscillating propellers in cavitating flows based on the rans approach the results for different oscillatory periods were compared and the period of a propeller s oscillatory motions was found to be intimately related to its load and wake field however based on our literature review the numerical analysis of oscillating propellers performance in cavitating flow under different loading conditions has not yet been reported in this paper a numerical simulation of an oscillating propeller in cavitating flows conducted using the rans approach with the shear stress transport sst k ω turbulence model is presented the overset grid technique is used in these simulations and the coupling between the propeller s rotations and oscillations is described using an independently defined set of equations the unsteady load distribution of sheet cavitation and wake field of the propeller are analysed in the presence of non uniform inflows for two different loading conditions the main objective of this study is to improve our understanding of the hydrodynamic behaviours of propellers in oscillatory conditions the simulation results provide a useful theoretical reference for propeller design and optimization 2 simulation details 2 1 governing equations assuming that the fluids are incompressible and that the vapor and liquid phases only interact via the continuity equation we may consider a single mixed fluid its properties including density dynamic viscosity and velocity are the weighted averages of the liquid l and vapor v properties zhu and fang 2012 zhu 2014 ji et al 2015 whose volume fractions are 1 α and α respectively 1 ρ m i x α ρ v 1 α ρ l μ m i x α μ v 1 α μ l u m i x α u v 1 α u l the incompressible continuity and momentum equations gaggero and villa 2017 wu et al 2018 solved for this mixed fluid may be expressed as follows 2 u m i x 1 ρ l 1 ρ v m u m i x t u m i x u m i x 1 ρ m i x p t re s where t re is the reynolds stress term which is solved and closed using the sst k ω turbulence model menter 1994 p is the average pressure s is the momentum source term and m ρ v ρ l ρ m d α d t is the interphase mass flow rate per unit volume this set of equations was closed using eq 3 known as the volume of fluid method gaggero et al 2016a b in star ccm through which the interaction between the vapor and liquid phases is also simulated 3 α t α u m i x m ρ v the core of the rans solver for cavitating flows is the interphase mass flow model star ccm uses the cavitation model proposed by sauer and schnerr 2000 and schnerr and sauer 2001 which assumes that vapor consists of n spherical bubbles n 0 n v l is the nuclei concentration per unit volume of liquid v l is the volume of liquid phase of radius r thus the vapor fraction can be defined as follows 4 α n 0 4 3 π r 3 1 n 0 4 3 π r 3 according to eq 4 the time derivative of the vapor fraction is 5 d α d t α 1 α 3 r d r d t where d r d t is the vapor liquid interface velocity which is calculated using the rayleigh relation kubota et al 1992 6 d r d t 2 3 p p v ρ l sgn p v p where p v is the vapor tension in this manner the interphase mass flow rate m that is needed for solving eqs 2 and 3 can be defined 7 m c g r o w 3 ρ v ρ l ρ m α 1 α r 2 3 p p v ρ l sgn p v p if p p v 0 c c o l l a p s e 3 ρ v ρ l ρ m α 1 α r 2 3 p p v ρ l sgn p v p if p p v 0 where c g r o w and c c o l l a p s e are the constants used as the symmetrical treatment of the grow and collapse of vapor bubbles gaggero et al 2016a b gaggero and villa 2017 the solving procedure and pressure velocity coupling are both based on the simplec algorithm the simplec second order scheme is employed for pressure and convection terms the second order central difference scheme is used for diffusion terms 2 2 overset grid the overset grid or chimera grid is widely used in problems with moving geometries carrica et al 2007 tang et al 2014 tezdogan et al 2015 in simulating oscillating propellers abnormal mesh deformations and low efficiency remeshing problems often arise when large motions occur in conventional dynamic grids the limitations of grids in handling large motions can be overcome using overset grids which provide an effective solution for calculating unsteady problems an overset grid allows complex regions to be replaced with multiple overlapping body conforming curvilinear grids the overset grid divides a computed flow regime into several sub regimes thus enhancing the flexibility of grid generation this allows component grids to be added in a mutually independent manner therefore grid connectivity only has to be updated locally and information is propagated through the embedding and overlapping of each regional grid while interpolations are used to couple information from the boundary flow fields of the overset grids the synthesized grid ø consists of a set of component grids ø k k 1 2 n the points in each ø k may be divided into interior points boundary points interpolation points exterior points or unused points fig 1 illustrates an overset grid consisting of two component grids the specific algorithms for constructing an overset grid are described by koblitz et al 2017 and chesshire and henshaw 1990 2 3 geometry the subject of this study is a fixed pitch right handed four bladed e779a propeller pereira et al 2004 as shown in fig 2 the primary parameters of this propeller are listed in table 1 a series of detailed experiment were performed to determine the open water performance and cavitation performance of this propeller in the italian ship model basin insean di felice et al 2004 felli et al 2006 2011 fig 2 illustrates the inertial reference system used in the numerical calculations the x axis is the rotational axis which is oriented in the downstream direction the z axis points upwards and the y axis is determined by the right hand rule the four quadrants which are determined by their circumferential positions are labelled in the figure 2 4 numerical setup numerical simulations were performed to examine the performance of an oscillating propeller in cavitating flows the ship following motions of the propeller in wavy sea conditions with the assumption that the propeller axis and direction of gravity are always perpendicular to each other were simulated using independently defined equations of motion the oscillatory motions of the propeller are mathematically defined as follows 8 z t a h sin ω t δ t where z t is the displacement of the propeller s vertical motion a h is the magnitude of the propeller s oscillatory motion defined as d 4 and ω 2π t e where t e is the period of the propeller s oscillation δt denotes the delay set as 0 32 s for all cases of oscillating motion which prevents excessively large changes in force and moment caused by sudden propeller movements in the vertical direction during the first δt of the calculation the propeller only rotates and does not exhibit oscillatory motions the propeller s pattern of motion is shown in fig 3 in this figure the times corresponding to four special positions in the propeller s motions have been labelled in the following sections the hydrodynamic behaviours of an e779a propeller are described as it moves through these representative positions the behaviours of the propeller at other times may be deduced from its characteristics at these instants the propeller s advance coefficient j is defined as j u 0 n d where u 0 is the propeller s advance speed and n is its rotational speed 36 rps different advance coefficients of 0 55 and 0 83 were obtained by changing u 0 the period of the propeller s oscillatory motion was set to t e 0 2 s the cavitation number is defined as σ p p v 0 5 ρ l n 2 d 2 where p is the reference pressure at the centre of the propeller axis and different values of σ were obtained by varying p in this study the cut cell method was employed for grid division two controlling volumes the outer cylinder and inner cylinder were used to refine the grid around the tips of the propeller s blades to avoid resolving the viscous sublayer directly wall functions based on the blended wall law baek et al 2015 was implemented the dimensionless distance between the first node of the grid and the wall surface y was defined as 30 and 20 layers were used in the prismatic boundary mesh the tip refining region and the boundary layer mesh are shown in fig 4 the calculation time step was set to 1 54 10 4 s which corresponds to a 2 rotation of the propeller 3 mesh verification and open water validation the following discussion refers to the dimensionless forces and moments 9 k t i t i ρ n 2 d 4 k q i q i ρ n 2 d 5 where i x y z represents the reference axis t is the thrust and q is the torque the propeller efficiency was calculated using the following equation 10 η j k t x 2 π k q x in most cases cfd simulations have three primary sources of uncertainty iterative u i grid u g and time step uncertainties u t according to stern et al 2001 grid uncertainty is the most important among these uncertainties as it is an order of magnitude larger than the other two firstly the hydrodynamic performance of the propeller in non cavitating flows was numerically calculated to validate the effectiveness of the numerical model and to test for grid independence in addition grid divisions were performed on the e779a propeller at three levels of fineness coarse medium and fine to test for grid convergence the thrust and torque coefficients calculated by these grids are listed in table 2 these results indicate that k t and 10k q are relatively insensitive to grid density the grid convergence was validated using the procedures described by stern et al 2001 and wilson et al 2004 the grid convergence ratio r g is defined as follows 11 r g s 3 s 2 s 2 s 1 where s i i 1 2 3 represents the results obtained by the coarse medium and fine grids respectively the refinement ratio must be determined before grid convergence can be examined as the cut cell method was used to perform grid division the refinement ratio r g was defined as follows 12 r g n f i n e n c o a r s e 1 d where n is the total number of grids and d is the dimensionality of the problem as propeller cavitation is a three dimensional problem we set d 3 the three aforementioned grids had a refinement ratio of approximately 1 2 the results of grid convergence validation are presented in table 3 in this table the r g values calculated for the thrust coefficient and torque coefficient are both less than 1 which indicates that the grid converges monotonically when j 0 55 the grid uncertainties of k t and 10k q are 6 9 d and 4 5 d respectively when j 0 83 the grid uncertainties of k t and 10k q are 7 7 d and 7 6 d respectively with d being the experimental value overall the grid convergence study indicates that the grid used in the simulations has an adequate level of convergence in addition we calculated the open water performance of the e779a propeller and obtained its open water efficiency curve fig 5 the results show that the cfd output is consistent with experimental values salvatore et al 2006 prior to calculating the coupling between propeller rotation and oscillation in cavitating flows the overset grid model was used to calculate the properties of the e779a propeller in cavitating flows without any oscillatory motion the results of these calculations were compared with experimental values salvatore et al 2003 to validate the accuracy and effectiveness of the proposed computational method fig 6 illustrates the computed and experimental cavitation extensions of an e779a propeller under various operating conditions without oscillatory motions with a vapor volume fraction of α v 0 3 both sets of results indicate that cavitation always occurs around the leading edge of the blade tips the computed results also capture the detachment of hub vortices from the hub cap the calculated cavitation extensions are consistent with experimental observations although some over prediction provides a slightly different scale vaz et al 2015 explained why such over prediction occurs and concluded that cfd is still a highly mature technique for calculating cavitating flows the computed results do not reproduce the detachment of the tip vortex cavitation because the grids corresponding to the positions where detachment occurs have not been refined fig 7 illustrates the vortical structures that were captured from the e779a propeller at two different loading conditions without oscillatory motion the dimensionless velocity u u 0 was used to colour the q iso surfaces this figure shows that the overset grid model is highly effective in capturing the vortical structures of the propellers comparing the results obtained using different advance coefficients same grid distribution we see that a merging process occurs among the tip vortices at a certain distance downstream from the propeller at low advance coefficients leading to vortex distortion and instability however at high advance coefficients the merging process is delayed and the vortical structures maintain their stability over a long distance downstream from the propeller these observations are consistent with the findings of felli et al 2011 and wang et al 2018 in summary the proposed computational method is suitable for calculating propeller performance in cavitating flows 4 results and discussion 4 1 hydrodynamic loads the velocity decomposition diagrams of blades 1 and 3 at radius r are shown in fig 8 in reality the coupling between the rotation and oscillation of a propeller can be treated as a fixed propeller in the vertical direction with fluids that move in the vertical direction towards the propeller according to the oscillation velocity in other words the vertical flow velocity is v ωa h cos ω t δt which is written as v a cos ξ for the sake of simplicity the axial velocity is the propeller s velocity of advancement u 0 therefore inflows towards the blade section consist of axial and circumferential components which can be defined as follows 13 v x u 0 v tangential ω r a cos ξ cos θ where ω is the angular speed of the propeller and θ is the circumferential position of the blade the initial circumferential position is θ 0 neglecting the propeller s self induced velocity u 0 is uniformly distributed over the propeller disk however the circumferential velocity is not uniformly distributed and this is the main cause for the generation of unsteady forces and moments by the propeller the circumferential velocity associated with the rotation of the propeller s blades ωr is fixed for a given radial position whereas acosξcosθ which is related to the circumferential position and vertical inflow velocity changes continuously throughout the propeller s operation this causes the blade section angle of attack aoa to change continuously 14 α φ arctan u 0 ω r a cos ξ cos θ where φ is the blade section pitch angle at radius r when the oscillatory motion has zero velocity i e v 0 the propeller operates in a purely axial flow a comprehensive analysis indicates that vertical flows change periodically in the oscillating state therefore the non uniformity of the flow field is directly responsible for continuous changes in propeller load throughout its rotational and oscillatory cycles the distribution of blade loads is the result of coupling between the propeller s circumferential position in each rotational cycle and oscillatory state z axis position in each oscillation cycle in addition when the propeller moves downwards the blade section aoas of blades 1 and 3 are lower and higher respectively than those with purely axial flows see fig 8 given the same z axis position without consideration of the propeller s induced velocity therefore the blade section aoa attains its maximum at 180 and minimum at 0 and decreases in the anticlockwise direction from the 180 position to the 0 position when t 0 5t e and t 1 0t e i e the propeller is passing through the origin of the z axis the vertical flow velocity v a cos ξ reaches its maximum value when the propeller passes through the origin of the z axis the blade section aoa will be maximized when the circumferential position of the blade is exactly 180 and minimized if the circumferential position is 0 the blade section aoa is greater in the second and third quadrants than in the first and fourth quadrants the exact opposite applies when the propeller moves upwards according to the analysis shown in fig 8 the variation in the aoa and the resultant velocity for a single propeller blade is shown in fig 9 the inflection point of the plot always appears at around θ n180 n 0 1 2 when the velocity of the oscillatory motion is decreasing when the propeller moves downwards from the origin of the z axis or increasing when the propeller moves upwards from the furthest end of its range of motion monotonically this is because the blade section aoa increases from its minimum value to the aoa for purely axial flows and it eventually attains the maximum value then the aoa decreases to its minimum value furthermore the intensity of oscillations in the aoa and the resultant velocity is intimately related to the effects of the propeller s oscillatory motion when the oscillatory effect is strong i e the oscillatory velocity is large the oscillations in the aoa and resultant velocity are very intense conversely when the oscillatory effect is weak the oscillations of the plot become milder when the propeller moves downwards changes in the aoa and resultant velocity caused by oscillatory velocity are in contrast to those observed when the propeller moves upwards however there is a phase difference between the periodicities of the rotations and oscillatory motions of the propellers thus the inflection point of the curves does not always occur at θ n180 fig 10 illustrates the unsteady thrust and torque coefficients of the propeller and the time dependence of its oscillation magnitude am in cavitating flows for two different loading conditions this figure shows that the thrust and torque coefficients of the propeller exhibit a significant degree of unsteadiness in oscillatory conditions as they display similar patterns to those of the propeller s motions a sinusoidal curve therefore it is important to consider this unsteadiness during strength checking the period of the propeller s thrust and torque coefficients is only half of the oscillation period this is because oscillation induced changes in the propeller s unsteady load are symmetric about the origin of the z axis the position corresponding to t 0 5t e and t 1 0t e hence each oscillatory period contains two unsteady force cycles the minimum thrust and torque appear near the peak and trough of the oscillation curve whereas the maximum thrust and torque appear near the origin of the z axis of the oscillatory motion the dotted line in fig 10 indicates the thrust and torque coefficients of the propeller in non oscillatory conditions it should be noted that the thrust and torque coefficients are always greater in oscillatory conditions than those in non oscillatory conditions in other words the minimum thrust and torque coefficients in oscillatory conditions are equivalent to the thrust and torque coefficients in non oscillatory conditions this is reasonable because the oscillatory condition consists of the non oscillatory condition with additional periodic oscillatory motion in addition when the oscillation frequency of the propeller decreases the oscillation period increases the oscillation amplitude is constant the oscillatory effect is weak the average oscillatory velocity is small and the fluctuations of the plot of the thrust and torque coefficients will become milder it can be speculated that when the oscillation period approaches infinity the propeller oscillation tends to be static in this condition the hydrodynamic performance of the propeller is identical to that in still water without oscillation similarly when the oscillation amplitude of the propeller decreases the oscillatory effect is weak and the fluctuations of the plot of the thrust and torque will become milder it can be also speculated that when the oscillation amplitude becomes sufficiently small the propeller oscillation tends to be static in this condition the hydrodynamic performance of the propeller is the same as that of one in still water without oscillation conversely when the oscillation amplitude of the propeller increases but the oscillation period is constant the oscillatory effect will become strong and the fluctuations of the plot of the thrust and torque will become intense non uniform inflows directly result in non constant loads on the propeller blades during their revolutions the dependence of the x y and z components of the thrust and torque coefficients of each blade on their circumferential position when j 0 55 is shown in fig 11 as the presence of unsteady loads on a propeller blade is caused by couplings between propeller rotation and oscillation this figure also shows the circumferential position of the blade corresponding to each instant of the oscillatory motion revealing how propeller oscillation and rotation affect blade loads the first and second halves of the oscillatory motion are symmetric about the origin of the z axis thus only the second half of the oscillatory motion is shown in fig 11 based on the plots of the axial thrust coefficient the inflection point always appears at around θ n180 n 0 1 2 if the velocity of the oscillatory motion is decreasing 0 5t e t 0 75t e or increasing 0 75t e t 1 0t e monotonically this observation is consistent with the conclusions drawn from fig 8 the axial thrust coefficient increases as the blade section aoa increases from its minimum value to the aoa for purely axial flows and eventually attains the maximum value then the aoa decreases to its minimum value if the period of oscillation is sufficiently long or if the rotational velocity of the propeller is sufficiently large multiple inflection points could result in a single δt 0 25t e period furthermore the intensity of oscillations in the axial thrust coefficient is intimately related to the effects of the oscillatory motion of the propeller when the oscillatory effect is strong i e the average oscillatory velocity is large the oscillations in the axial thrust coefficient are very intense conversely when the oscillatory effect is weak the oscillations of the plot become milder during the period 0 75t e t 1 0t e the changes in the axial force coefficient caused by oscillatory velocity are opposite to those observed during the period 0 5t e t 0 75t e however there is a phase difference between the periodicities of the rotations and oscillatory motions of the propeller thus the inflection point of the curves does not always occur at θ n180 for example a reversal occurs near t 0 75t e as the velocity of the oscillatory motion approaches zero similar trends are observed for k qx and k tx but the positions of their extrema exhibit a certain phase difference the extrema of the lateral force coefficient k ty and the vertical force coefficient k tz have a phase difference of π 2 and the positions of the extrema are only affected by the rotational effect a similar pattern is observed between k qy and k qz compared with the lateral force coefficients the vertical force coefficients are more strongly affected by the oscillatory motion this is because the oscillatory motion occurs along the vertical direction 4 2 sheet cavitation and wake field as the propeller inflows change constantly throughout each revolution the trailing and shed vortex systems of each propeller blade will have different circulations therefore the induced velocity field has an asymmetric distribution the propeller slipstream is inclined with respect to the propeller s rotational axis and thus the negative induced velocity field generated on the propeller disk during its oscillation will aggravate the non uniformity of the propeller load distributions fig 12 illustrates how the deflection of the propeller s slipstream affects the loads on the propeller blades with the propeller moving downwards in this example the velocity decomposition of blades 1 and 3 also shown in fig 8 a at r is shown in fig 12 c and d these figures demonstrate that the deflection of the propeller s wake will generate negative induced velocities along the outside of the third and fourth quadrants of the propeller disk moreover self induction is more concentrated on the opposite side where the wake is deflected therefore the downwash of the propeller caused by the downward propeller motions will amplify the effects of the transverse velocity component acosξcosθ in the third and fourth quadrants thus increasing the blade section aoa of blade 3 however an opposite trend is observed at blade 1 because an increase in the axial velocity component reduces its aoa to investigate this aspect further the distribution of velocities in the transverse section at x d 0 5 downstream of the propeller s wake is shown in fig 13 with the magnitude of the velocities being non dimensionalized by u 0 based on the circumferential distribution of velocity magnitudes when the propeller reaches the furthest end of its oscillatory motions t 0 25t e and t 0 75t e the inflow of the blade becomes purely axial and the circumferential distribution of the velocity field becomes highly uniform the circumferential distributions of the velocity fields corresponding to the propeller moving downwards t 0 5t e and upwards t 1 0t e through the origin of the z axis differ quite significantly at these instants the acceleration of the fluid is the maximum owing to the action of the propeller therefore each propeller blade will pass through the maximum load position however the propeller s load distribution is mostly concentrated in the third quadrant 180 θ 270 when the propeller moves downwards whereas the highest concentration of loads is observed in the first quadrant 0 θ 90 when the propeller moves upwards this finding is slightly different from the conclusion drawn from eq 14 which suggests that θ 180 is the maximum inflow angle when the propeller moves downwards the above analysis allows us to derive the patterns of change in blade section aoa these patterns are shown in fig 14 which illustrates the positions corresponding to the maximum and minimum aoas and indicates the trends in each quadrant when the propeller moves downwards the second and third quadrants have greater aoas than the first and fourth quadrants denoted by green when the propeller moves upwards however the green areas represent the first and fourth quadrants fig 12 indicates that when the propeller moves downwards the aoa increases in the third and fourth quadrants denoted by yellow under the effects of negative induced velocities conversely when the propeller moves upwards the yellow areas represent the first and second quadrants this causes the yellow and green areas to overlap this area of overlap has the greatest relative aoa when the propeller moves downwards and upwards the areas of overlap are the third and first quadrants respectively this is consistent with the conclusion drawn from fig 13 the same patterns may also be used to describe the circumferential distribution of sheet cavitation around the blades in the presence of oscillatory motions for example when the propeller moves downwards the second and third quadrants exhibit a greater degree of cavitation than the first and fourth quadrants further the effects of negative induced velocities result in the most severe cavitation in the third quadrant and the least severe in the first quadrant in the following text the sheet cavitation distributions will be used to support the above analysis and to describe the hydrodynamic behaviours of propeller blades in the presence of coupled propeller rotation and oscillation non uniform inflows also lead to the generation of non uniform sheet cavitation by the propeller s blades the patterns of propeller sheet cavitation at representative instants of the oscillation of the propeller under two different loading conditions are shown in fig 15 the oscillation velocity of the propeller becomes zero when the propeller reaches the furthest end of its oscillation t 0 25t e and t 0 75t e in both loading conditions the inflow becomes purely axial and the distribution of unsteady sheet cavitation on the propeller blades becomes relatively uniform the distributions of unsteady sheet cavitation on the blades at t 0 5t e and t 1 0t e i e when the propeller is passing through the origin of the z axis differ quite significantly severe cavitation occurs in certain sections of the blades whereas the area of cavitation in other sections is relatively small when the propeller moves downwards the areas with severe and light cavitation are mainly observed in the third and first quadrants respectively which is identical to the scenario depicted in fig 14 the distribution of propeller sheet cavitation is basically identical to that described in fig 14 when the propeller moves upwards in addition severe cavitation will occur in certain propeller blades but not in others if the propeller is lightly loaded i e j 0 83 and operating with highly non uniform inflows e g the inflows at t 0 5t e and t 1 0t e attention must be paid to vibrational noise and structural problems in propellers that are made to operate in these conditions propeller induced fluctuations in pressure were measured downstream from the propeller the observation point a was placed at x 1 0r z 0 5r as shown in fig 16 a point a may be treated as an infinitely small region that records changes in pressure on this surface this pressure is the sum of hydrostatic and hydrodynamic pressures in addition to ensure that point a remains fixed in relation to the propeller during the propeller s oscillations the motion of point a was identical to that of the propeller s vertical oscillations the numerical predictions of the power spectral density at point an under two loading conditions are shown in fig 16 b and c the dominant frequency f p exhibits a slight difference in each loading condition with the amplitude of f p corresponding to j 0 55 being significantly greater than that of j 0 83 the axial velocity fields in the vicinity of the propeller blades are plotted in fig 17 for the cylindrical cut planes at r r 0 7 the axial velocity in this figure has been non dimensionalized by u 0 and theta is used as the circumferential angle of the cylindrical section in radians the details of the flow on the blade section are clearly shown in the x theta plane the flow acceleration may be observed in the blade passages which generate differences in pressure on the blade section that result in the generation of force and moment in addition by comparing the flows at the root of each blade it may be observed that blade wakes near the midspan section have a larger spread the wake of the propeller blades has trailing edge vortices which allow the appearance of streaks in the figure when the propeller reaches the farthest end of its oscillatory motion t 0 25t e and t 0 75t e the velocity fields around all four blade sections are relatively uniform in both loading conditions in comparison however a degree of interference may be observed between the adjacent blade wakes when j 0 55 therefore the stripe profiles are clearer at j 0 83 significant differences may be observed in the velocity fields of the blades when the propeller passes through the origin of its oscillatory motion flow acceleration is extremely significant in a part of the blade passages although relatively weak in other parts this is caused by differences in the aoa of each blade section which is a consequence of non uniform inflows interference is much more pronounced at j 0 55 than at j 0 83 during the evolution of blade wakes and this leads to the disruption of stripe profiles this form of interference mainly occurs between the wakes of blades with a large aoa and the wakes of adjacent blades with a small aoa mechanical analyses of propeller wakes are of utmost importance for studies on the structural problems of modern ships and propeller vibration and noise felli et al 2011 the mid longitudinal sections of the propeller s tip vortices at representative instants of the propeller s oscillation are shown in fig 18 with j 0 55 and j 0 83 this figure clearly demonstrates that the computational method used in this work effectively captures the trajectory of the propeller s tip and hub vortices in the presence of coupling between propeller rotation and oscillation in both loading conditions the velocity of the propeller s oscillatory motion approaches zero as it reaches the furthest end of its range of motion i e t 0 25t e and t 0 75t e in this scenario the tip and hub vortices near the propeller can follow the movements of the propeller and remain attached to the propeller as for the tip and hub vortices located further away from the propeller there is a lag in their movements because of the cumulative differences in velocity when the propeller passes through the origin of the oscillatory motion at t 0 5t e and t 1 0t e the trajectory of the trailing tip and hub vortices exhibits substantial sloping relative to the x axis a pronounced lag is then observed between the propeller s oscillatory motions and those of the trailing tip and hub vortices and this becomes increasingly pronounced with increasing distance from the propeller this is because the velocity of the propeller s oscillation is maximal at t 0 5t e and t 1 0t e and there is a difference in vertical velocity between the tip and hub vortices and the propeller which increases with increasing distance from the propeller blades consequently the tip and hub vortices detach from the propeller in a direction opposite to that of the oscillatory motion fig 18 also indicates that root vortices tend to appear in the direction of the oscillatory motion by comparing the trajectory of the wake vortex at j 0 55 and j 0 83 it is clear that the pitch of the wake vortex is greater at j 0 83 than that at j 0 55 because of the difference in convection velocity the velocity contour plots corresponding to representative instants of the propeller s oscillation i e the instants when the propeller passes through the origin of the z axis are shown in fig 19 where the axial velocity has been non dimensionalized by u 0 in this figure the energy of the flow is always higher in the negative half of the z axis when the propeller moves downwards through the origin t 0 5t e regardless of the advance coefficient conversely the energy of the flow is higher in the positive half of the z axis when the propeller moves upwards through the origin t 1 0t e by comparing fig 19 a and b we see that an increase in the advance coefficient leads to the flow energies being concentrated in the direction of the propeller s oscillatory motion furthermore the shed vortices in the wake strongly interfere with one another at lower advance coefficients which amplifies the so called diffusion effect thus disrupting the vortices shed in the wake and the outline of the wake vortex this interference between the shed vortices attenuates as the advance coefficient increases therefore the outline of the wake vortex structures becomes clearer and these outlines are maintained over long distances downstream from the propeller the dimensionless axial vorticity fields in fig 20 were further analysed to examine the characteristics of the propeller s wake vortices for j 0 55 and j 0 83 as the diffusion effect is significant at j 0 55 the interference between wake vortices is quite pronounced in this case this interference which may be described as a kinematic vortex vortex merging process is especially severe in the direction of the propeller s oscillatory motion starting from a distance equivalent to the propeller s diameter in the downstream direction when the advance coefficient increases to j 0 83 the kinematic vortex vortex merging effect becomes insignificant thus the disturbance and interference between the shed vortex systems are considerably reduced and the outlines of the tip vortex structures become very distinct 5 conclusions using the overset grid technique and a set of independently defined equations of motion for the coupling of propeller rotation and oscillation we have numerically simulated an oscillating propeller in cavitating flows based on the rans approach in combination with the sst k ω turbulence model the oscillatory motion of the propeller causes the propeller inflows to change constantly throughout each of its revolutions this leads to pronounced differences in the circulation of the trailing and shed vortex system of each propeller blade in particular the unsteadiness of the propeller s thrust and torque coefficients is highly pronounced as they exhibit sinusoidal patterns the minimum values of the thrust and torque coefficients in the presence of oscillation are equivalent to those in non oscillatory conditions changes in the forces and torques acting on each propeller blade are the combined result of their circumferential position and the state of the propeller s oscillatory motions position in the z axis as the propeller slipstream is inclined with respect to the propeller s rotational axis the negative induced velocity field generated on the propeller disk during its oscillation will aggravate the non uniformity of the propeller load distributions non uniform inflows lead to the generation of severe cavitation and light cavitation zones when the propeller moves downwards the areas with severe cavitation are mainly observed in the third quadrant but when the propeller moves upwards the first quadrant exhibits severe cavitation in addition severe cavitation tends to occur in blades that are highly loaded and operate with highly non uniform inflows moreover in oscillatory conditions the vertical movements of the tip vortices clearly lag behind those of the propeller and the wake shed vortices strongly interfere with one another in the direction of the propeller s oscillatory motions when the propeller operates in a relatively higher loading condition j 0 55 the computational methods and results of this work will be of theoretical significance for propeller design and optimization acknowledgment this work was supported by the national natural science foundation of china grant nos 41176074 51409063 and 51209048 and the high technology ship scientific research project of the ministry of industry and information technology of china grant no g014613002 
23171,during voyages a ship will inevitably encounter wavy conditions that cause heaving motions these motions induce oscillations in the propeller relative to its surrounding fluid causing the propeller to operate in off design conditions under non uniform inflows these environments induced motions will significantly alter propeller performance to study the motions of the propeller of a surface ship in wavy conditions during actual voyages numerical simulations were conducted on an oscillating propeller in cavitating flows by using reynolds averaged navier stokes rans approach the rotations and oscillations of the propeller were coupled using an independently defined set of equations of motion with the oscillations being represented as sinusoidal cyclic motions the numerical propagation of unsteady flow fields was obtained using the overset grid technique this approach allowed the hydrodynamic behaviours of a propeller to be fully investigated in the presence of coupling between the rotations and oscillatory motions of the propeller the effects of non uniform incoming flows on a propeller s unsteady load and the distribution of sheet cavitation and wake field were analysed for two different loading conditions the results of these calculations are significant for propeller design and optimization keywords propeller oscillatory motions off design conditions sheet cavitation 1 introduction propeller is the most widely used device for ships propulsions therefore their viscous flow fields and hydrodynamic performance are important concerns for ship researchers and designers di mascio et al 2014 dubbioso et al 2013 kumar and mahesh 2017 during voyages a surface ship will inevitably encounter wavy conditions that induce heaving motions resulting in oscillations in the propeller relative to its surrounding fluid the operational state of a propeller in these conditions differs from that in still water conditions because of oscillatory motions in addition to forward and rotational motions as well as non uniform flows in previous studies we identified a series of problems caused by the ship following motions of a propeller in actual sea conditions for example for a ship with multiple propellers and rudders the allocation of power to the main engine in actual sea conditions differs from that in still water conditions depending on the actual torque of the propeller some engines may be overloaded while others may be underloaded making it impossible to achieve an optimal efficiency the increasing demand for optimum propeller performance in actual sea conditions and the continuous improvement of computer hardware mean that new considerations such as oscillatory motions and pitching are gradually being implemented in the simulation of ship following propeller motions according to huse 1972 detrimental cavitation effects e g fluctuations in pressure and noise are enhanced by propeller operation in non uniform flow fields and fluctuations in the cavitation volume around a propeller could induce damaging vibrations at the stern therefore a detailed understanding of the cavitation characteristics of a propeller is very important for propeller design cavitation is an extremely complex phase transition that occurs within fluids or at fluid solid interfaces because of the flow energy cavitation significantly reduces the hydrodynamic performance of a propeller and induces vibrations noise and erosion chen et al 2016 paik et al 2010 peng et al 2018 pennings et al 2016 taskar et al 2017 wu et al 2015 thus far cavitation remains a focal point of hydrodynamic studies around the world chow et al 2017 ji et al 2015 long et al 2018 pendar and roohi 2018 wu et al 2016 theoretical calculations on propeller cavitation performance are generally based on potential flow theories or viscous flow theories the panel method and boundary element method bem are the most frequently used potential flow methods for calculating the propeller cavitation performance for instance yari and ghassemi 2013 used bem to calculate the properties pressure distribution on the surface of the propeller s blades and cavity thickness of a dtmb4119 propeller in cavitating and non cavitating conditions with a focus on changes in cross flows during the formation and growth of cavitation the results of their numerical computations showed good agreements to experimental results s gaggero et al 2016a b used an in house bem to assess the comprehensive performance of a propeller that was selected through genetic algorithms and they validated the efficacy of their methods through comparisons with experimental values s gaggero et al 2016a b also used an unsteady bem in the design and optimization of a next generation contracted and loaded tip propeller they calculated the unsteady cavitation performance and propeller induced pressure fluctuations of the propeller and evaluated the performance of the propeller most viscous flow methods for the calculation of propeller cavitation performance are implemented through computational fluid dynamics cfd for example zhu 2015 used ansys fluent to study the relationship between a propeller s skew angles and cavitation based on four dtmb propellers with different skews this led to a detailed analysis on how a propeller s sheet cavitation propeller induced pressure fluctuation and wake field are related to a propeller s skew characteristics based on openfoam huuva and törnros 2016 used an independently developed cfd program to predict the cavitation performance of a pptc propeller and a ducted azimuth thruster their results indicate that this cfd method has a degree of applicability zhu et al 2017 studied methods for the numerical prediction of vortex cavitation in uniform and non uniform flows based on e779a and e779b propellers they found that advanced grid techniques and the selection of appropriate turbulence models are crucial factors for the prediction of vortex cavitation based on the steady and unsteady incompressible reynolds averaged navier stokes rans solvers in openfoam gaggero and villa 2017 predicted the cavitation performance of a pptc propeller and compared their results with those of the star ccm solver and bem the comparison indicated that the rans solver in openfoam has a sufficient level of accuracy if a propeller exhibits oscillatory motions pitching motions or a combination of both the numerical procedures for calculating the propeller s properties can become quite complex studies on oscillating propellers are uncommon although some research has been conducted on this topic politis 2004 used panel methods to calculate the hydrodynamic performance of an impulsively started propeller a propeller in inclined flow and a propeller in heaving motion stable wake patterns were obtained in these calculations and the distribution of forces and pressures on the propeller were accurately predicted under both steady and unsteady conditions wang et al 2017a b numerically analysed the interaction between the free surface and oscillating propellers near the free surface they found that the air ingestion exerted upon the free surface by the oscillating propeller is an extremely complex coupled process that depends on the motion state and operating time of the propeller and the distance between the propeller and free surface wang et al 2017a b also performed numerical simulations on oscillating propellers in cavitating flows based on the rans approach the results for different oscillatory periods were compared and the period of a propeller s oscillatory motions was found to be intimately related to its load and wake field however based on our literature review the numerical analysis of oscillating propellers performance in cavitating flow under different loading conditions has not yet been reported in this paper a numerical simulation of an oscillating propeller in cavitating flows conducted using the rans approach with the shear stress transport sst k ω turbulence model is presented the overset grid technique is used in these simulations and the coupling between the propeller s rotations and oscillations is described using an independently defined set of equations the unsteady load distribution of sheet cavitation and wake field of the propeller are analysed in the presence of non uniform inflows for two different loading conditions the main objective of this study is to improve our understanding of the hydrodynamic behaviours of propellers in oscillatory conditions the simulation results provide a useful theoretical reference for propeller design and optimization 2 simulation details 2 1 governing equations assuming that the fluids are incompressible and that the vapor and liquid phases only interact via the continuity equation we may consider a single mixed fluid its properties including density dynamic viscosity and velocity are the weighted averages of the liquid l and vapor v properties zhu and fang 2012 zhu 2014 ji et al 2015 whose volume fractions are 1 α and α respectively 1 ρ m i x α ρ v 1 α ρ l μ m i x α μ v 1 α μ l u m i x α u v 1 α u l the incompressible continuity and momentum equations gaggero and villa 2017 wu et al 2018 solved for this mixed fluid may be expressed as follows 2 u m i x 1 ρ l 1 ρ v m u m i x t u m i x u m i x 1 ρ m i x p t re s where t re is the reynolds stress term which is solved and closed using the sst k ω turbulence model menter 1994 p is the average pressure s is the momentum source term and m ρ v ρ l ρ m d α d t is the interphase mass flow rate per unit volume this set of equations was closed using eq 3 known as the volume of fluid method gaggero et al 2016a b in star ccm through which the interaction between the vapor and liquid phases is also simulated 3 α t α u m i x m ρ v the core of the rans solver for cavitating flows is the interphase mass flow model star ccm uses the cavitation model proposed by sauer and schnerr 2000 and schnerr and sauer 2001 which assumes that vapor consists of n spherical bubbles n 0 n v l is the nuclei concentration per unit volume of liquid v l is the volume of liquid phase of radius r thus the vapor fraction can be defined as follows 4 α n 0 4 3 π r 3 1 n 0 4 3 π r 3 according to eq 4 the time derivative of the vapor fraction is 5 d α d t α 1 α 3 r d r d t where d r d t is the vapor liquid interface velocity which is calculated using the rayleigh relation kubota et al 1992 6 d r d t 2 3 p p v ρ l sgn p v p where p v is the vapor tension in this manner the interphase mass flow rate m that is needed for solving eqs 2 and 3 can be defined 7 m c g r o w 3 ρ v ρ l ρ m α 1 α r 2 3 p p v ρ l sgn p v p if p p v 0 c c o l l a p s e 3 ρ v ρ l ρ m α 1 α r 2 3 p p v ρ l sgn p v p if p p v 0 where c g r o w and c c o l l a p s e are the constants used as the symmetrical treatment of the grow and collapse of vapor bubbles gaggero et al 2016a b gaggero and villa 2017 the solving procedure and pressure velocity coupling are both based on the simplec algorithm the simplec second order scheme is employed for pressure and convection terms the second order central difference scheme is used for diffusion terms 2 2 overset grid the overset grid or chimera grid is widely used in problems with moving geometries carrica et al 2007 tang et al 2014 tezdogan et al 2015 in simulating oscillating propellers abnormal mesh deformations and low efficiency remeshing problems often arise when large motions occur in conventional dynamic grids the limitations of grids in handling large motions can be overcome using overset grids which provide an effective solution for calculating unsteady problems an overset grid allows complex regions to be replaced with multiple overlapping body conforming curvilinear grids the overset grid divides a computed flow regime into several sub regimes thus enhancing the flexibility of grid generation this allows component grids to be added in a mutually independent manner therefore grid connectivity only has to be updated locally and information is propagated through the embedding and overlapping of each regional grid while interpolations are used to couple information from the boundary flow fields of the overset grids the synthesized grid ø consists of a set of component grids ø k k 1 2 n the points in each ø k may be divided into interior points boundary points interpolation points exterior points or unused points fig 1 illustrates an overset grid consisting of two component grids the specific algorithms for constructing an overset grid are described by koblitz et al 2017 and chesshire and henshaw 1990 2 3 geometry the subject of this study is a fixed pitch right handed four bladed e779a propeller pereira et al 2004 as shown in fig 2 the primary parameters of this propeller are listed in table 1 a series of detailed experiment were performed to determine the open water performance and cavitation performance of this propeller in the italian ship model basin insean di felice et al 2004 felli et al 2006 2011 fig 2 illustrates the inertial reference system used in the numerical calculations the x axis is the rotational axis which is oriented in the downstream direction the z axis points upwards and the y axis is determined by the right hand rule the four quadrants which are determined by their circumferential positions are labelled in the figure 2 4 numerical setup numerical simulations were performed to examine the performance of an oscillating propeller in cavitating flows the ship following motions of the propeller in wavy sea conditions with the assumption that the propeller axis and direction of gravity are always perpendicular to each other were simulated using independently defined equations of motion the oscillatory motions of the propeller are mathematically defined as follows 8 z t a h sin ω t δ t where z t is the displacement of the propeller s vertical motion a h is the magnitude of the propeller s oscillatory motion defined as d 4 and ω 2π t e where t e is the period of the propeller s oscillation δt denotes the delay set as 0 32 s for all cases of oscillating motion which prevents excessively large changes in force and moment caused by sudden propeller movements in the vertical direction during the first δt of the calculation the propeller only rotates and does not exhibit oscillatory motions the propeller s pattern of motion is shown in fig 3 in this figure the times corresponding to four special positions in the propeller s motions have been labelled in the following sections the hydrodynamic behaviours of an e779a propeller are described as it moves through these representative positions the behaviours of the propeller at other times may be deduced from its characteristics at these instants the propeller s advance coefficient j is defined as j u 0 n d where u 0 is the propeller s advance speed and n is its rotational speed 36 rps different advance coefficients of 0 55 and 0 83 were obtained by changing u 0 the period of the propeller s oscillatory motion was set to t e 0 2 s the cavitation number is defined as σ p p v 0 5 ρ l n 2 d 2 where p is the reference pressure at the centre of the propeller axis and different values of σ were obtained by varying p in this study the cut cell method was employed for grid division two controlling volumes the outer cylinder and inner cylinder were used to refine the grid around the tips of the propeller s blades to avoid resolving the viscous sublayer directly wall functions based on the blended wall law baek et al 2015 was implemented the dimensionless distance between the first node of the grid and the wall surface y was defined as 30 and 20 layers were used in the prismatic boundary mesh the tip refining region and the boundary layer mesh are shown in fig 4 the calculation time step was set to 1 54 10 4 s which corresponds to a 2 rotation of the propeller 3 mesh verification and open water validation the following discussion refers to the dimensionless forces and moments 9 k t i t i ρ n 2 d 4 k q i q i ρ n 2 d 5 where i x y z represents the reference axis t is the thrust and q is the torque the propeller efficiency was calculated using the following equation 10 η j k t x 2 π k q x in most cases cfd simulations have three primary sources of uncertainty iterative u i grid u g and time step uncertainties u t according to stern et al 2001 grid uncertainty is the most important among these uncertainties as it is an order of magnitude larger than the other two firstly the hydrodynamic performance of the propeller in non cavitating flows was numerically calculated to validate the effectiveness of the numerical model and to test for grid independence in addition grid divisions were performed on the e779a propeller at three levels of fineness coarse medium and fine to test for grid convergence the thrust and torque coefficients calculated by these grids are listed in table 2 these results indicate that k t and 10k q are relatively insensitive to grid density the grid convergence was validated using the procedures described by stern et al 2001 and wilson et al 2004 the grid convergence ratio r g is defined as follows 11 r g s 3 s 2 s 2 s 1 where s i i 1 2 3 represents the results obtained by the coarse medium and fine grids respectively the refinement ratio must be determined before grid convergence can be examined as the cut cell method was used to perform grid division the refinement ratio r g was defined as follows 12 r g n f i n e n c o a r s e 1 d where n is the total number of grids and d is the dimensionality of the problem as propeller cavitation is a three dimensional problem we set d 3 the three aforementioned grids had a refinement ratio of approximately 1 2 the results of grid convergence validation are presented in table 3 in this table the r g values calculated for the thrust coefficient and torque coefficient are both less than 1 which indicates that the grid converges monotonically when j 0 55 the grid uncertainties of k t and 10k q are 6 9 d and 4 5 d respectively when j 0 83 the grid uncertainties of k t and 10k q are 7 7 d and 7 6 d respectively with d being the experimental value overall the grid convergence study indicates that the grid used in the simulations has an adequate level of convergence in addition we calculated the open water performance of the e779a propeller and obtained its open water efficiency curve fig 5 the results show that the cfd output is consistent with experimental values salvatore et al 2006 prior to calculating the coupling between propeller rotation and oscillation in cavitating flows the overset grid model was used to calculate the properties of the e779a propeller in cavitating flows without any oscillatory motion the results of these calculations were compared with experimental values salvatore et al 2003 to validate the accuracy and effectiveness of the proposed computational method fig 6 illustrates the computed and experimental cavitation extensions of an e779a propeller under various operating conditions without oscillatory motions with a vapor volume fraction of α v 0 3 both sets of results indicate that cavitation always occurs around the leading edge of the blade tips the computed results also capture the detachment of hub vortices from the hub cap the calculated cavitation extensions are consistent with experimental observations although some over prediction provides a slightly different scale vaz et al 2015 explained why such over prediction occurs and concluded that cfd is still a highly mature technique for calculating cavitating flows the computed results do not reproduce the detachment of the tip vortex cavitation because the grids corresponding to the positions where detachment occurs have not been refined fig 7 illustrates the vortical structures that were captured from the e779a propeller at two different loading conditions without oscillatory motion the dimensionless velocity u u 0 was used to colour the q iso surfaces this figure shows that the overset grid model is highly effective in capturing the vortical structures of the propellers comparing the results obtained using different advance coefficients same grid distribution we see that a merging process occurs among the tip vortices at a certain distance downstream from the propeller at low advance coefficients leading to vortex distortion and instability however at high advance coefficients the merging process is delayed and the vortical structures maintain their stability over a long distance downstream from the propeller these observations are consistent with the findings of felli et al 2011 and wang et al 2018 in summary the proposed computational method is suitable for calculating propeller performance in cavitating flows 4 results and discussion 4 1 hydrodynamic loads the velocity decomposition diagrams of blades 1 and 3 at radius r are shown in fig 8 in reality the coupling between the rotation and oscillation of a propeller can be treated as a fixed propeller in the vertical direction with fluids that move in the vertical direction towards the propeller according to the oscillation velocity in other words the vertical flow velocity is v ωa h cos ω t δt which is written as v a cos ξ for the sake of simplicity the axial velocity is the propeller s velocity of advancement u 0 therefore inflows towards the blade section consist of axial and circumferential components which can be defined as follows 13 v x u 0 v tangential ω r a cos ξ cos θ where ω is the angular speed of the propeller and θ is the circumferential position of the blade the initial circumferential position is θ 0 neglecting the propeller s self induced velocity u 0 is uniformly distributed over the propeller disk however the circumferential velocity is not uniformly distributed and this is the main cause for the generation of unsteady forces and moments by the propeller the circumferential velocity associated with the rotation of the propeller s blades ωr is fixed for a given radial position whereas acosξcosθ which is related to the circumferential position and vertical inflow velocity changes continuously throughout the propeller s operation this causes the blade section angle of attack aoa to change continuously 14 α φ arctan u 0 ω r a cos ξ cos θ where φ is the blade section pitch angle at radius r when the oscillatory motion has zero velocity i e v 0 the propeller operates in a purely axial flow a comprehensive analysis indicates that vertical flows change periodically in the oscillating state therefore the non uniformity of the flow field is directly responsible for continuous changes in propeller load throughout its rotational and oscillatory cycles the distribution of blade loads is the result of coupling between the propeller s circumferential position in each rotational cycle and oscillatory state z axis position in each oscillation cycle in addition when the propeller moves downwards the blade section aoas of blades 1 and 3 are lower and higher respectively than those with purely axial flows see fig 8 given the same z axis position without consideration of the propeller s induced velocity therefore the blade section aoa attains its maximum at 180 and minimum at 0 and decreases in the anticlockwise direction from the 180 position to the 0 position when t 0 5t e and t 1 0t e i e the propeller is passing through the origin of the z axis the vertical flow velocity v a cos ξ reaches its maximum value when the propeller passes through the origin of the z axis the blade section aoa will be maximized when the circumferential position of the blade is exactly 180 and minimized if the circumferential position is 0 the blade section aoa is greater in the second and third quadrants than in the first and fourth quadrants the exact opposite applies when the propeller moves upwards according to the analysis shown in fig 8 the variation in the aoa and the resultant velocity for a single propeller blade is shown in fig 9 the inflection point of the plot always appears at around θ n180 n 0 1 2 when the velocity of the oscillatory motion is decreasing when the propeller moves downwards from the origin of the z axis or increasing when the propeller moves upwards from the furthest end of its range of motion monotonically this is because the blade section aoa increases from its minimum value to the aoa for purely axial flows and it eventually attains the maximum value then the aoa decreases to its minimum value furthermore the intensity of oscillations in the aoa and the resultant velocity is intimately related to the effects of the propeller s oscillatory motion when the oscillatory effect is strong i e the oscillatory velocity is large the oscillations in the aoa and resultant velocity are very intense conversely when the oscillatory effect is weak the oscillations of the plot become milder when the propeller moves downwards changes in the aoa and resultant velocity caused by oscillatory velocity are in contrast to those observed when the propeller moves upwards however there is a phase difference between the periodicities of the rotations and oscillatory motions of the propellers thus the inflection point of the curves does not always occur at θ n180 fig 10 illustrates the unsteady thrust and torque coefficients of the propeller and the time dependence of its oscillation magnitude am in cavitating flows for two different loading conditions this figure shows that the thrust and torque coefficients of the propeller exhibit a significant degree of unsteadiness in oscillatory conditions as they display similar patterns to those of the propeller s motions a sinusoidal curve therefore it is important to consider this unsteadiness during strength checking the period of the propeller s thrust and torque coefficients is only half of the oscillation period this is because oscillation induced changes in the propeller s unsteady load are symmetric about the origin of the z axis the position corresponding to t 0 5t e and t 1 0t e hence each oscillatory period contains two unsteady force cycles the minimum thrust and torque appear near the peak and trough of the oscillation curve whereas the maximum thrust and torque appear near the origin of the z axis of the oscillatory motion the dotted line in fig 10 indicates the thrust and torque coefficients of the propeller in non oscillatory conditions it should be noted that the thrust and torque coefficients are always greater in oscillatory conditions than those in non oscillatory conditions in other words the minimum thrust and torque coefficients in oscillatory conditions are equivalent to the thrust and torque coefficients in non oscillatory conditions this is reasonable because the oscillatory condition consists of the non oscillatory condition with additional periodic oscillatory motion in addition when the oscillation frequency of the propeller decreases the oscillation period increases the oscillation amplitude is constant the oscillatory effect is weak the average oscillatory velocity is small and the fluctuations of the plot of the thrust and torque coefficients will become milder it can be speculated that when the oscillation period approaches infinity the propeller oscillation tends to be static in this condition the hydrodynamic performance of the propeller is identical to that in still water without oscillation similarly when the oscillation amplitude of the propeller decreases the oscillatory effect is weak and the fluctuations of the plot of the thrust and torque will become milder it can be also speculated that when the oscillation amplitude becomes sufficiently small the propeller oscillation tends to be static in this condition the hydrodynamic performance of the propeller is the same as that of one in still water without oscillation conversely when the oscillation amplitude of the propeller increases but the oscillation period is constant the oscillatory effect will become strong and the fluctuations of the plot of the thrust and torque will become intense non uniform inflows directly result in non constant loads on the propeller blades during their revolutions the dependence of the x y and z components of the thrust and torque coefficients of each blade on their circumferential position when j 0 55 is shown in fig 11 as the presence of unsteady loads on a propeller blade is caused by couplings between propeller rotation and oscillation this figure also shows the circumferential position of the blade corresponding to each instant of the oscillatory motion revealing how propeller oscillation and rotation affect blade loads the first and second halves of the oscillatory motion are symmetric about the origin of the z axis thus only the second half of the oscillatory motion is shown in fig 11 based on the plots of the axial thrust coefficient the inflection point always appears at around θ n180 n 0 1 2 if the velocity of the oscillatory motion is decreasing 0 5t e t 0 75t e or increasing 0 75t e t 1 0t e monotonically this observation is consistent with the conclusions drawn from fig 8 the axial thrust coefficient increases as the blade section aoa increases from its minimum value to the aoa for purely axial flows and eventually attains the maximum value then the aoa decreases to its minimum value if the period of oscillation is sufficiently long or if the rotational velocity of the propeller is sufficiently large multiple inflection points could result in a single δt 0 25t e period furthermore the intensity of oscillations in the axial thrust coefficient is intimately related to the effects of the oscillatory motion of the propeller when the oscillatory effect is strong i e the average oscillatory velocity is large the oscillations in the axial thrust coefficient are very intense conversely when the oscillatory effect is weak the oscillations of the plot become milder during the period 0 75t e t 1 0t e the changes in the axial force coefficient caused by oscillatory velocity are opposite to those observed during the period 0 5t e t 0 75t e however there is a phase difference between the periodicities of the rotations and oscillatory motions of the propeller thus the inflection point of the curves does not always occur at θ n180 for example a reversal occurs near t 0 75t e as the velocity of the oscillatory motion approaches zero similar trends are observed for k qx and k tx but the positions of their extrema exhibit a certain phase difference the extrema of the lateral force coefficient k ty and the vertical force coefficient k tz have a phase difference of π 2 and the positions of the extrema are only affected by the rotational effect a similar pattern is observed between k qy and k qz compared with the lateral force coefficients the vertical force coefficients are more strongly affected by the oscillatory motion this is because the oscillatory motion occurs along the vertical direction 4 2 sheet cavitation and wake field as the propeller inflows change constantly throughout each revolution the trailing and shed vortex systems of each propeller blade will have different circulations therefore the induced velocity field has an asymmetric distribution the propeller slipstream is inclined with respect to the propeller s rotational axis and thus the negative induced velocity field generated on the propeller disk during its oscillation will aggravate the non uniformity of the propeller load distributions fig 12 illustrates how the deflection of the propeller s slipstream affects the loads on the propeller blades with the propeller moving downwards in this example the velocity decomposition of blades 1 and 3 also shown in fig 8 a at r is shown in fig 12 c and d these figures demonstrate that the deflection of the propeller s wake will generate negative induced velocities along the outside of the third and fourth quadrants of the propeller disk moreover self induction is more concentrated on the opposite side where the wake is deflected therefore the downwash of the propeller caused by the downward propeller motions will amplify the effects of the transverse velocity component acosξcosθ in the third and fourth quadrants thus increasing the blade section aoa of blade 3 however an opposite trend is observed at blade 1 because an increase in the axial velocity component reduces its aoa to investigate this aspect further the distribution of velocities in the transverse section at x d 0 5 downstream of the propeller s wake is shown in fig 13 with the magnitude of the velocities being non dimensionalized by u 0 based on the circumferential distribution of velocity magnitudes when the propeller reaches the furthest end of its oscillatory motions t 0 25t e and t 0 75t e the inflow of the blade becomes purely axial and the circumferential distribution of the velocity field becomes highly uniform the circumferential distributions of the velocity fields corresponding to the propeller moving downwards t 0 5t e and upwards t 1 0t e through the origin of the z axis differ quite significantly at these instants the acceleration of the fluid is the maximum owing to the action of the propeller therefore each propeller blade will pass through the maximum load position however the propeller s load distribution is mostly concentrated in the third quadrant 180 θ 270 when the propeller moves downwards whereas the highest concentration of loads is observed in the first quadrant 0 θ 90 when the propeller moves upwards this finding is slightly different from the conclusion drawn from eq 14 which suggests that θ 180 is the maximum inflow angle when the propeller moves downwards the above analysis allows us to derive the patterns of change in blade section aoa these patterns are shown in fig 14 which illustrates the positions corresponding to the maximum and minimum aoas and indicates the trends in each quadrant when the propeller moves downwards the second and third quadrants have greater aoas than the first and fourth quadrants denoted by green when the propeller moves upwards however the green areas represent the first and fourth quadrants fig 12 indicates that when the propeller moves downwards the aoa increases in the third and fourth quadrants denoted by yellow under the effects of negative induced velocities conversely when the propeller moves upwards the yellow areas represent the first and second quadrants this causes the yellow and green areas to overlap this area of overlap has the greatest relative aoa when the propeller moves downwards and upwards the areas of overlap are the third and first quadrants respectively this is consistent with the conclusion drawn from fig 13 the same patterns may also be used to describe the circumferential distribution of sheet cavitation around the blades in the presence of oscillatory motions for example when the propeller moves downwards the second and third quadrants exhibit a greater degree of cavitation than the first and fourth quadrants further the effects of negative induced velocities result in the most severe cavitation in the third quadrant and the least severe in the first quadrant in the following text the sheet cavitation distributions will be used to support the above analysis and to describe the hydrodynamic behaviours of propeller blades in the presence of coupled propeller rotation and oscillation non uniform inflows also lead to the generation of non uniform sheet cavitation by the propeller s blades the patterns of propeller sheet cavitation at representative instants of the oscillation of the propeller under two different loading conditions are shown in fig 15 the oscillation velocity of the propeller becomes zero when the propeller reaches the furthest end of its oscillation t 0 25t e and t 0 75t e in both loading conditions the inflow becomes purely axial and the distribution of unsteady sheet cavitation on the propeller blades becomes relatively uniform the distributions of unsteady sheet cavitation on the blades at t 0 5t e and t 1 0t e i e when the propeller is passing through the origin of the z axis differ quite significantly severe cavitation occurs in certain sections of the blades whereas the area of cavitation in other sections is relatively small when the propeller moves downwards the areas with severe and light cavitation are mainly observed in the third and first quadrants respectively which is identical to the scenario depicted in fig 14 the distribution of propeller sheet cavitation is basically identical to that described in fig 14 when the propeller moves upwards in addition severe cavitation will occur in certain propeller blades but not in others if the propeller is lightly loaded i e j 0 83 and operating with highly non uniform inflows e g the inflows at t 0 5t e and t 1 0t e attention must be paid to vibrational noise and structural problems in propellers that are made to operate in these conditions propeller induced fluctuations in pressure were measured downstream from the propeller the observation point a was placed at x 1 0r z 0 5r as shown in fig 16 a point a may be treated as an infinitely small region that records changes in pressure on this surface this pressure is the sum of hydrostatic and hydrodynamic pressures in addition to ensure that point a remains fixed in relation to the propeller during the propeller s oscillations the motion of point a was identical to that of the propeller s vertical oscillations the numerical predictions of the power spectral density at point an under two loading conditions are shown in fig 16 b and c the dominant frequency f p exhibits a slight difference in each loading condition with the amplitude of f p corresponding to j 0 55 being significantly greater than that of j 0 83 the axial velocity fields in the vicinity of the propeller blades are plotted in fig 17 for the cylindrical cut planes at r r 0 7 the axial velocity in this figure has been non dimensionalized by u 0 and theta is used as the circumferential angle of the cylindrical section in radians the details of the flow on the blade section are clearly shown in the x theta plane the flow acceleration may be observed in the blade passages which generate differences in pressure on the blade section that result in the generation of force and moment in addition by comparing the flows at the root of each blade it may be observed that blade wakes near the midspan section have a larger spread the wake of the propeller blades has trailing edge vortices which allow the appearance of streaks in the figure when the propeller reaches the farthest end of its oscillatory motion t 0 25t e and t 0 75t e the velocity fields around all four blade sections are relatively uniform in both loading conditions in comparison however a degree of interference may be observed between the adjacent blade wakes when j 0 55 therefore the stripe profiles are clearer at j 0 83 significant differences may be observed in the velocity fields of the blades when the propeller passes through the origin of its oscillatory motion flow acceleration is extremely significant in a part of the blade passages although relatively weak in other parts this is caused by differences in the aoa of each blade section which is a consequence of non uniform inflows interference is much more pronounced at j 0 55 than at j 0 83 during the evolution of blade wakes and this leads to the disruption of stripe profiles this form of interference mainly occurs between the wakes of blades with a large aoa and the wakes of adjacent blades with a small aoa mechanical analyses of propeller wakes are of utmost importance for studies on the structural problems of modern ships and propeller vibration and noise felli et al 2011 the mid longitudinal sections of the propeller s tip vortices at representative instants of the propeller s oscillation are shown in fig 18 with j 0 55 and j 0 83 this figure clearly demonstrates that the computational method used in this work effectively captures the trajectory of the propeller s tip and hub vortices in the presence of coupling between propeller rotation and oscillation in both loading conditions the velocity of the propeller s oscillatory motion approaches zero as it reaches the furthest end of its range of motion i e t 0 25t e and t 0 75t e in this scenario the tip and hub vortices near the propeller can follow the movements of the propeller and remain attached to the propeller as for the tip and hub vortices located further away from the propeller there is a lag in their movements because of the cumulative differences in velocity when the propeller passes through the origin of the oscillatory motion at t 0 5t e and t 1 0t e the trajectory of the trailing tip and hub vortices exhibits substantial sloping relative to the x axis a pronounced lag is then observed between the propeller s oscillatory motions and those of the trailing tip and hub vortices and this becomes increasingly pronounced with increasing distance from the propeller this is because the velocity of the propeller s oscillation is maximal at t 0 5t e and t 1 0t e and there is a difference in vertical velocity between the tip and hub vortices and the propeller which increases with increasing distance from the propeller blades consequently the tip and hub vortices detach from the propeller in a direction opposite to that of the oscillatory motion fig 18 also indicates that root vortices tend to appear in the direction of the oscillatory motion by comparing the trajectory of the wake vortex at j 0 55 and j 0 83 it is clear that the pitch of the wake vortex is greater at j 0 83 than that at j 0 55 because of the difference in convection velocity the velocity contour plots corresponding to representative instants of the propeller s oscillation i e the instants when the propeller passes through the origin of the z axis are shown in fig 19 where the axial velocity has been non dimensionalized by u 0 in this figure the energy of the flow is always higher in the negative half of the z axis when the propeller moves downwards through the origin t 0 5t e regardless of the advance coefficient conversely the energy of the flow is higher in the positive half of the z axis when the propeller moves upwards through the origin t 1 0t e by comparing fig 19 a and b we see that an increase in the advance coefficient leads to the flow energies being concentrated in the direction of the propeller s oscillatory motion furthermore the shed vortices in the wake strongly interfere with one another at lower advance coefficients which amplifies the so called diffusion effect thus disrupting the vortices shed in the wake and the outline of the wake vortex this interference between the shed vortices attenuates as the advance coefficient increases therefore the outline of the wake vortex structures becomes clearer and these outlines are maintained over long distances downstream from the propeller the dimensionless axial vorticity fields in fig 20 were further analysed to examine the characteristics of the propeller s wake vortices for j 0 55 and j 0 83 as the diffusion effect is significant at j 0 55 the interference between wake vortices is quite pronounced in this case this interference which may be described as a kinematic vortex vortex merging process is especially severe in the direction of the propeller s oscillatory motion starting from a distance equivalent to the propeller s diameter in the downstream direction when the advance coefficient increases to j 0 83 the kinematic vortex vortex merging effect becomes insignificant thus the disturbance and interference between the shed vortex systems are considerably reduced and the outlines of the tip vortex structures become very distinct 5 conclusions using the overset grid technique and a set of independently defined equations of motion for the coupling of propeller rotation and oscillation we have numerically simulated an oscillating propeller in cavitating flows based on the rans approach in combination with the sst k ω turbulence model the oscillatory motion of the propeller causes the propeller inflows to change constantly throughout each of its revolutions this leads to pronounced differences in the circulation of the trailing and shed vortex system of each propeller blade in particular the unsteadiness of the propeller s thrust and torque coefficients is highly pronounced as they exhibit sinusoidal patterns the minimum values of the thrust and torque coefficients in the presence of oscillation are equivalent to those in non oscillatory conditions changes in the forces and torques acting on each propeller blade are the combined result of their circumferential position and the state of the propeller s oscillatory motions position in the z axis as the propeller slipstream is inclined with respect to the propeller s rotational axis the negative induced velocity field generated on the propeller disk during its oscillation will aggravate the non uniformity of the propeller load distributions non uniform inflows lead to the generation of severe cavitation and light cavitation zones when the propeller moves downwards the areas with severe cavitation are mainly observed in the third quadrant but when the propeller moves upwards the first quadrant exhibits severe cavitation in addition severe cavitation tends to occur in blades that are highly loaded and operate with highly non uniform inflows moreover in oscillatory conditions the vertical movements of the tip vortices clearly lag behind those of the propeller and the wake shed vortices strongly interfere with one another in the direction of the propeller s oscillatory motions when the propeller operates in a relatively higher loading condition j 0 55 the computational methods and results of this work will be of theoretical significance for propeller design and optimization acknowledgment this work was supported by the national natural science foundation of china grant nos 41176074 51409063 and 51209048 and the high technology ship scientific research project of the ministry of industry and information technology of china grant no g014613002 
23172,this paper presents a unifying task priority control architecture for underwater vehicle manipulator systems the proposed control framework can be applied to different operative scenarios such as waypoint navigation assisted teleoperation interaction landing and grasping this work extends the results of the trident and maris projects which were limited to the execution of grasping actions to other applications taken from the dexrov and robust projects in particular simulation results show how the control framework can be used for example for pipeline inspection scenarios and deep sea mining exploration keywords task priority control intervention autonomous underwater vehicles remotely operated vehicles kinematic control underwater vehicle manipulator systems 1 introduction during the last 20 years autonomous underwater vehicles auvs have been widely used as a tool for mapping the seafloor using optical and acoustic sensors with applications to dam inspection ridao et al 2010 marine geology wynn et al 2014 urabe et al 2015 and underwater archaeology drap et al 2008 bingham et al 2010 to mention but a few after years of research few autonomous platforms are already available in the market alvarez et al 2009 ribas et al 2012 most of them able to perform side scan sonar and bathymetric multi beam surveys a recent survey yuh et al 2011 reports a list of commercial platforms and applications of auvs however a large number of applications exist that go beyond the survey capabilities a number of them stem from the oil and gas industry such as the maintenance of submerged oil wells cabled sensor networks and pipelines in fact chevron has since 2007 an on going program for the employment of resident intervention auvs i auvs to provide better and more frequent inspections earlier monitoring and reduced field maintenance and development costs gilmour et al 2012 nowadays these tasks require the use of work class remotely operated vehicles rovs deployed from dynamic positioning vessels making them very expensive to respond to this increasing demand research in marine robotics has started focusing on the development of underwater vehicle manipulator systems uvms since early 90s different pioneering works were carried out on the control of compliant underwater manipulators yoerger et al 1991 coordinated vehicle arm control for teleoperation schempf and yoerger 1992 and during the odin choi et al 1994 and otter wang et al 1995 projects successively within the union project rigaud et al 1998 the first mechatronic assembly of an autonomous uvms was achieved between 1993 and 2000 the amadeus project lane et al 1997 developed grippers for underwater manipulation angeletti et al 1998 and studied the problem of dual arm autonomous manipulation casalino et al 2001 demonstrating these features in water tank experiments the successive decade was characterized by different field demonstrations among which we can cite the swimmer project evans et al 2001 and the alive project evans et al 2003 martyet al 2004 that achieved autonomous docking into a seabed docking station or rov friendly panels and the sauvim project yuh et al 1998 marani et al 2008 which demonstrated the capability of searching and recovering an object whose position was roughly known a priori concurrently research in industrial robotics focused on how to effectively specify the control objectives of a robotic system especially for redundant systems the task based control nakamura and hanafusa 1986 also known as operational space control khatib 1987 defines control objectives in a coordinate system that is directly relevant to the task that needs to be performed rather than in the generalized coordinates of the robotic system such an idea was immediately enhanced by the introduction of the concept of task priority nakamura 1991 in that work a primary task was executed and a secondary task was accomplished or attempted only in the null space of the primary one in order to guarantee the invariance of the main task w r t with respect to the secondary one this concept was later generalized to any number of task priority levels in the seminal work siciliano and slotine 1991 however it must be noted how the position control of the end effector was always the highest priority task and safety tasks such as joint limits were only attempted at lower priority given that an uvms is a robotic system characterized by a high number of degrees of freedom within the trident project sanz et al 2013 these two research trends were merged a novel task priority resolution mechanism which managed equality and scalar only inequality control objectives was developed and exploited for the first time for the coordinated control of a floating base and a manipulator for performing autonomous floating intervention simetti et al 2014 a blackbox recovery intervention was experimentally proved in a harbour environment shortly after trident the pandora project has demonstrated autonomous free floating valve turning operation on a subsea panel using a learning by demonstration paradigm carrera et al 2014 and a task priority kinematic control approach cieslak et al 2015 however the adopted task priority framework only dealt with equality control objectives and an ad hoc solution was devised to manage the joint limit safety task therefore it does not represent a general solution successively the concepts developed in the trident project were further enhanced within the maris project with the definition of a task priority framework able to activate and deactivate equality inequality control objectives of any dimension i e not limited to scalar ones depending on the system current needs simetti and casalino 2016 this feature allows the user to put safety and operational enabling objectives at the highest priority as they should be experiments in free floating grasping have been conducted with multiple attempts to test the repeatability and robustness of the control simetti et al 2017 the maris project also studied the extension of the control architecture to cooperative agents simetti and casalino 2017 finally recent studies on i auvs can be found in farivarnejad and moosavian 2014 allotta et al 2015 conti et al 2015 nowadays the authors are involved in two other projects where uvmss are employed namely the eu h2020 dexrov and robust projects the dexrov project di lillo et al 2016 main goal is to delocalize on shore the manned support to rov operations as much as possible reducing the crew on board the support vessel and consequently the costs and risks of the whole operation the delocalization is performed using satellite communications between the support ship and the remote control center therefore only high level commands are sent through the satellite channels and forwarded to the rov which must execute them in a semi autonomous manner the robust project robust website 2016 aims to use robotic technologies for the exploration of deep water mining sites especially manganese nodule fields the main idea is to perform in situ measurements of the nodules to identify if they contain rare earth elements which are particularly sought after in the market this paper presents a unifying control architecture for the control of uvmss both in the case of partial assisted teleoperation and fully autonomous operation the architecture handles inequality control objectives without overconstraining the system it coordinates the arm and vehicle movements thanks to a parallel task priority inversion scheme section 2 10 which is also suitable for multi rate control and it also manages the presence of vehicle underactuations to the best extent possible with the simple addition of a control task section 2 9 with respect to previous publications this work does not consider only a grasping scenario as it was the case of the trident and maris projects but it extends the framework and shows its flexibility in tackling different operative scenarios presenting the most recent results of the dexrov and robust projects in fact the same architecture can execute the required operations as long as the corresponding actions are defined with the advantage of having a unique controller at the kinematic level simplifying the overall implementation and allowing greater modularity as many control tasks are common to more than one action the present work s contributions are listed as follows c 1 it presents in a self contained way all the properties of the proposed task priority framework omitting only the mathematical details presented in simetti and casalino 2016 c 2 it shows how the proposed approach can be used for both autonomous operation and assisted teleoperation either if the user wants to control some of the degrees of freedom or even if he she desires to control only the end effector this is a requirement coming from the dexrov project c 3 it presents the integration of force regulation at the kinematic level for example to carry out the inspection of a pipeline as needed in the dexrov project validated through dynamic simulations including different rates for the kinematic and dynamic control layers vehicle added masses and coriolis effects thruster dynamics and actuator saturations c 4 it discusses how a safe navigation action and how landing in front of a specific target can be implemented again validated through dynamic simulations as they are two of the operations needed in the robust project for deep mining exploration the paper is organized as follows section 2 recaps the theory behind the developed task priority control framework then the flexibility of the proposed architecture in tackling many different kind of applications spanning all the aforementioned projects is highlighted in section 3 in section 4 the most recent simulation results of the dexrov and robust projects are shown section 5 presents the current open problems and research trends finally some conclusions are given in section 6 2 the control framework theory the control framework presented in this paper is based on the cascade of blocks shown in fig 1 in particular the architecture is constituted by three main blocks 1 the mission manager is in charge of supervising the execution of the current mission and generates the corresponding actions to be executed by the kinematic control layer as it will be explained later in section 2 4 an action is any prioritized list of control objectives to be concurrently achieved and a mission is a sequence or graph of actions 2 the kinematic control layer kcl implements the proposed task priority control framework and is in charge of reactively accomplishing the control objectives that make up the current action to be executed generating the desired system velocity vector 3 the dynamic control layer dcl tracks the desired system velocity vector by generating appropriate force torques commands for the vehicle and the manipulator the paper focuses on the kinematic control layer since it is the one implementing the proposed task priority approach the interfaces with the higher level mission manager and the lower one dcl are highlighted whenever relevant 2 1 general definitions let us introduce two definitions that will be used thoroughly in this paper the system configuration vector c ℝ n of the uvms as c q η t where q ℝ l is the arm configuration vector and η ℝ 6 is the vehicle generalized coordinate position vector which is the stacked vector of the position vector η 1 x y z t with components in the inertial frame w and the orientation vector η 2 ϕ θ ψ t the latter expressed in terms of the three angles roll pitch yaw applied in the yaw pitch roll sequence perez and fossen 2007 the possible singularity arising when the pitch angle is near π 2 is handled through a dedicated control objective as it will be shown later in section 3 from the above definitions it results n l 6 the system velocity vector y ℝ n of the uvms as y q v t where q ℝ l are the arm joint velocities and v ℝ 6 is the stacked vector of the vehicle linear velocity vector v 1 x y z t and the vehicle angular velocity vector v 2 p q r t both with components in the vehicle frame v note that the angular velocities are not the derivatives of the euler angles used in η 2 for the time being this work will be developed with the assumption of a vehicle fully actuated in its 6 degrees of freedom therefore the system velocity vector will coincide with the control vector to be used at the kinematic level section 2 9 will show how to relax this assumption 2 2 control objectives definition categories and examples let us start the discussion by considering what the robotic system needs to achieve mathematically speaking let us consider any scalar variable x c dependent on the current configuration of the robot and the environment then for this variable two broad classes of objectives can be defined 1 the requirement for t that x c x 0 is called a scalar equality control objective 2 the requirement for t that x c x m a x or x c x m i n is called a scalar inequality control objective control objectives can be further divided in different categories depending on their purpose and as it will be clear later on their priority physical constraints objectives e g interacting with the environment system safety objectives e g avoiding joint limits or obstacles objectives that are a prerequisite for accomplishing the mission e g maintaining the manipulated object in the camera field of view action oriented objectives i e what the system ultimately needs to execute to accomplish the current user defined action e g the end effector grasping an object reaching the desired position with the vehicle etc optimization objectives i e control objectives such as maintaining an arm preferred pose or minimizing the vehicle velocity which express a preference but whose achievement is not required for the execution of the action 2 3 reactive and non reactive control tasks to each scalar control objective there is always associated a feedback reference rate x it represents the closed loop rate control law that if tracked would drive the associated variable x c toward an arbitrary point x where the objective is satisfied a possible feedback reference rate is the following one 1 x x γ x x γ 0 where γ is a positive gain proportional to the desired convergence rate for the considered variable the need for tracking the desired x is termed a reactive control task sometimes a control task is defined directly in a certain task velocity space without having an associated control objective as an example consider the case where a human operator wants to control the end effector by generating velocity references through a joystick in such a case the reference rate x is generated by the user rather than being the output of a feedback control loop as in 1 in this case tracking the desired x is termed a non reactive control task in both situations to track the desired reference rate it is necessary to act upon the system velocity vector through a jacobian relationship of the type 2 x g t y where the vector g ℝ n is the jacobian of the considered task 2 4 actions in the terminology of this work an action is a prioritized list of control tasks to be concurrently managed the meaning is that lower priority tasks should not influence the fulfilment of higher priority ones if two or more scalar control tasks are assigned to the same priority level then they are grouped into a multidimensional control task for example for a robotic manipulator a manipulation action a m could be represented by following list of prioritized control objectives 1 arm joint limits 2 arm manipulability 3 end effector position control 4 end effector attitude control 5 arm preferred shape where it is natural to see safety objectives such as joint limits at the highest priority further remarks on how a list composing an action can be constructed will be given in section 2 8 and section 3 for the time being let us assume that a list of prioritized control tasks has been established 2 5 activation functions as remarked in the introduction one of the important points of this control architecture is the ability of handling inequality control objectives without overconstraining the system to this aim let us define an activation function 3 a i x 0 1 as a continuous sigmoidal function of the objective variable x c which assumes zero values within the validity region of the associated inequality objective for example assuming an objective of the class x c x m i n 4 a i x 1 x c x m i n s x x m i n x c x m i n δ 0 x c x m i n δ where s x is any smooth strictly decreasing function joining the two extrema and δ is a value that creates a buffer zone where the inequality is already satisfied but the activation value is still greater than zero preventing chattering problems around the inequality control objective threshold x m i n a similar function can be defined for objectives of the class x c x m a x clearly for both reactive control task associated to an equality control objective and for non reactive control tasks the activation function is always the unitary one i e a i x 1 from now on the distinction between reactive and non reactive control tasks will be dropped and the generic term control task will be used unless otherwise specified 2 6 task priority inverse kinematics given an action a for each priority level k the following matrices and vectors are consequently defined x k x 1 k x m k k t is the stacked vector of all the reference rates of the scalar control tasks where m k is the number of scalar tasks at the priority level k j k is the jacobian relationship expressing the current rate of change of the k th task vector x 1 k x m k k t w r t the system velocity vector y simply resulting from the stacking of the row vector ones in 2 a k diag a 1 k a m k k is the diagonal matrix of all the activation functions described in 3 to find the system velocity reference vector y that satisfies the above expressed priority requirements between the different tasks the following sequence of nested minimization problems needs to be solved corresponding to the so called task priority inverse kinematics tpik 5 s k argr min y s k 1 a k x k j k y 2 k 1 2 n where s k 1 is the manifold of solutions of all the previous tasks in the hierarchy s 0 ℝ n n is the total number of priority levels and finally where the notation r min is introduced for underlining that each minimization is performed via the specialized form of simetti and casalino 2016 within such a specialized framework named icat inequality constraints and task transitions the above tpik problem 5 results in the following algorithm to be initialized with ρ 0 0 q 0 i and then for k 1 n 6 w k j k q k 1 j k q k 1 a k q k 1 q k q k 1 i j k q k 1 a k i j k q k 1 ρ k ρ k 1 sat q k 1 j k q k 1 a k i w k x k j k ρ k 1 where the special pseudo inverse operator a q has been introduced in simetti and casalino 2016 to cope with certain invariance problems arising in 5 and where the function sat implements the management of control variable saturations accordingly with what suggested in antonelli et al 2009 at the end of the above iterative process the final system velocity vector is therefore y ρ n the interested reader can find all the relevant details of this procedure in simetti and casalino 2016 where a comparison with other task priority approaches as for instance those appearing in kanoun et al 2011 escande et al 2014 moe et al 2016 is given 2 7 building a mission through action sequencing the concept of an action represents a nice way to embed a certain complexity within the kcl exposing a simple interface toward the mission manager an important point to develop is the transition between two actions once an action change has been commanded by the mission manager let us consider the following two actions a 1 a b c d and a 2 a d c e composed by objectives abstractly labelled with alphabetic letters where a b denotes that a has higher priority than b and where b c means that b has equal priority to c now consider the merged list u a d 1 b c d 2 e where d 1 and d 2 represent the same objective d but with a different priority it is clear that through insertion deletion of some of the entries the two original lists can be reconstructed for example a 1 can be obtained by removing d 1 and e from the unified list conversely a 2 can be obtained by removing the control objectives d 2 and b to enable such transitions the activation function 3 is modified to become 7 a x p a i x a p p where a p p 0 1 is a continuous sigmoidal function of a vector of parameters p that contains the previous and current action being executed and the time elapsed in the current action to obtain the desired activation deactivation smooth transition of course this new activation function a p p applies to both reactive and non reactive control tasks since it does not depend on the variable x c an example of transition from action a 1 to a 2 is reported in table 1 where s d e c t t m a x represents a sigmoidal function whose values goes from 1 to 0 as the time t within the current action goes from 0 to the threshold time t m a x after which the transition between a 1 and a 2 is completed similarly s i n c t t m a x goes from 0 to 1 2 8 remarks on conflicting objectives an action is concluded successfully when its action defining objectives are satisfied thus a necessary condition to guarantee that an action can be terminated is the existence of a non void set of configurations where all high priority and action defining objectives are contemporaneously satisfied the presence of such a non conflicting zone is however not a sufficient condition as it does not imply its reachability in correspondence of all system initial configurations starting outside it such a reachability problem affects all the task priority strategies and in general all reactive control approaches in the proposed architecture this problem needs to be addressed at a higher level within the mission manager block the creation of different control actions helps in defining a set of well structured blocks that can be sequenced by the mission manager in case of inability of completing the required action the mission manager should devise an alternative solution e g a different sequencing of actions or different action parameters i e a new path to follow a detailed discussion of how the mission manager could be implemented falls outside the scope of the current work 2 9 control in presence of vehicle underactuations until now the vehicle was assumed fully actuated in all its degrees of freedom as it usually the case for work class rovs that need to perform manipulation activities in any case the proposed architecture can also be used for managing underactuated vehicles at the best extent possible as already shown in simetti et al 2017 let us consider a vehicle does not have thrusters allowing to control the angular velocities along the vehicle x and y axes roll and pitch which is often the case for small size vehicles to cope with underactuation let us add at the top of the hierarchy a non reactive control task structured as follows its reference rate x is composed by the vector of the measured vehicle velocities all vehicle velocities including the non actuated ones are assumed measurable therefore for such a task x v 1 t p q r t where v 2 has been explicitly written in terms of its components its jacobian is simply 0 6 l i 6 6 where the first block of zeroes regards the arm joint velocities that are kinematically non influencing the vehicle ones its activation function in the considered roll and pitch underactuation example is the constant diagonal matrix diag 0 0 0 1 1 0 selecting the non actuated velocities only it can be easily seen that at the end of the procedure the values of y corresponding to the non actuated degrees of freedom are equal to the measured ones hence the resulting vector y is the optimal one in correspondence of such non actuated degrees of freedom velocities in general with a proper choice of the activation function the proposed architecture can actually cope with any kind of vehicle underactuation thus possibly even underactuation caused by actuators failures provided they are detected and the vehicle velocities remain all measurable 2 10 arm vehicle coordination scheme an important feature of the proposed architecture is the arm vehicle motion coordination since if manipulator and vehicle motions are not kinematically decoupled then disturbances of the floating base e g due to nonlinear properties of thrusters whitcomb and yoerger 1995 whitcomb and yoerger 1999 bachmayer et al 2000 or the large inertia of the vehicle would propagate through the coupled kinematics immediately to the end effector of the manipulator simetti et al 2017 to cope with this problem the idea is to have two optimizations 6 running in parallel as depicted in fig 2 having as input the same action a the first optimization tpik 1 implements the task hiearchy of the action a and its output is used to generate the reference velocity for the vehicle the second optimization tpik 2 considers the vehicle as totally non controllable therefore the non reactive control task presented in 2 9 is used and all the vehicle degrees of freedom are initialized with the corresponding measured velocities the vehicle constrained velocity task is placed on top of the task hierarchy of action a as depicted in the tpik 2 block of fig 2 in such an optimization de facto only the manipulator variables are subject to be optimized hence the outputs of this procedure are the optimal joint velocities in correspondence of the measured vehicle velocity more details on this coordination technique are shown in simetti et al 2017 together with several experiments highlighting its importance for floating manipulation finally note how this parallel strategy for arm vehicle coordinated control is also suitable for implementing multi rate control of the two subsystems as tpik 1 can be run at the vehicle control frequency while tpik 2 can be updated at the higher arm control rate 3 applications this sections highlights different operative scenarios where the control of the uvms can take advantage of the proposed architecture showing its flexibility in being adapted to many applications in the following the actions to carry out the specific operations will be presented using the following compact notation r nr i e c s p ad o name of the task objective where r nr specifies if the task is reactive or non reactive i e specifies if the task is of inequality or equality type c s p ad o specifies if the category of the task i e constraint safety prerequisite action defining optimization finally all the actions that will be presented in the following sections can be thought as having the underactuation constraint task presented in section 2 9 at the top of the hierarchy i e nr e c vehicle underactuation constraint 3 1 safe waypoint navigation let us consider the requirement of having the uvms reaching a new position expressed for example in global coordinates through an ultra short or long baseline system in such a scenario other than having the vehicle in the required position there are a number of other objectives that the system needs to satisfy which can be summarized in the following list highest to lowest priority objective 1 r i s vehicle minimum altitude 2 r i s vehicle obstacle avoidance 3 r i s vehicle horizontal attitude 4 r i p vehicle auto heading 5 r e ad vehicle position x y and depth to avoid excessive energy consumption to keep a precise positioning the vehicle position control objective could be implemented as an inequality one introducing a dead band zone an hysteresis in the activation of the task could be also introduced to prevent excessive chattering around the threshold due to the vehicle dynamics the altitude task and obstacle avoidance one are written separately just because they usually work with different sensors i e an altimeter and a forward looking sonar the horizontal attitude control objective requires the vehicle to be parallel to the horizontal plane reducing the misalignment vector between its vertical axis and the absolute one simetti and casalino 2017 this control objective needed only for fully actuated vehicles avoids the possible singularity arising when the pitch angle is near π 2 in the roll pitch yaw representation the above defined navigation to a waypoint action allows us to make a few important remarks there is a natural conflict between certain objectives in the above example the minimum altitude might conflict with the auto depth objective which is implicitly considered in the vehicle position one however the altitude objective is activated only when really necessary the specified higher priority of the altitude task ensures that the altitude is maintained at the cost of the depth setpoint whenever necessary the resulting task priority behaviour is depicted in fig 3 thanks to the possibility of activating and deactivating tasks the priority of the objectives can follow a natural order without over constraining the system safety objectives first then operational enabling objectives auto heading then actual action defining objectives vehicle position 3 2 assisted teleoperation of uvms degrees of freedom the flexibility of the proposed control framework also allows one to implement an assisted teleoperation of the uvms in a sort of advanced rov operational mode typically the rov operator controls the vehicle through body frame velocities i e using the surge sway heave and angular velocity commands while he she also sets the desired joint velocities for the manipulator this means that the system velocity vector y is exactly the variable that contains the desired inputs for the operator therefore a non reactive control task for the manual control can be easily defined the jacobian relationship is simply the identity matrix the activation function is set to one in correspondence of the degrees of freedom that needs to be manually controlled zero otherwise the reference rate vector x is initialized with the values generated by the operator s console a control task so defined placed at the top of the control task hierarchy will directly set the corresponding control vector to the desired one provided by the operator it is important to note that if only some of the degrees of freedom are activated for manual control all the others can be used by the control system for the achievement of the remaining control objectives furthermore the task priority approach will automatically take into account the influence of the manually controlled degrees of freedom on the remaining control tasks to clarify let us consider the following example action of safe navigation with manual assisted teleoperation characterized by the following list of tasks 1 nr e ad manual control 2 r i s vehicle minimum altitude 3 r i s vehicle obstacle avoidance 4 r i s vehicle horizontal attitude 5 r i p vehicle auto heading 6 r i ad vehicle position x y and depth which is the same one as the previous section with the addition of the non reactive manual control task let us suppose that the operator configures the manual control task through a proper choice of the activation function to take control of surge sway and angular velocity along the z axis leaving the degrees of freedom of heave and the rotation along the x and y axes to the control system in such a configuration if the operator moves the vehicle with a certain surge velocity and the pitch of the vehicle points slightly down the depth will increase and altitude decrease however the control system through the vehicle position depth objective will automatically regulate the heave motion to compensate for the possible increase in depth finally the altitude control objective will prevent the operator for getting too close to the seafloor at the expenses of the depth regulation task accordingly with the desired priority and safety requirements 3 3 grasping another action that can be defined with the proposed architecture regards the grasping of an object in this case the action involves also the manipulator therefore the number of control objectives is naturally higher than in the previous examples the following hierarchy could be used to define such an action 1 r i s vehicle minimum altitude 2 r i s vehicle obstacle avoidance 3 r i s arm joint limits 4 r i p arm manipulability 5 r i p camera centering 6 r i p camera arm occlusions 7 r e ad end effector position control 8 r e ad end effector attitude control 9 r i o arm preferred shape 10 nr e o vehicle motion minimization where the need of avoiding occlusions between the manipulator and the camera system providing the feedback as well as the need of maintaining the object in the camera frame are clearly prerequisites for guiding the end effector on top of the object therefore they have higher priority the arm manipulability task aims at maintaining the manipulability index μ yoshikawa 1985 8 μ det j j t above a minimum value the index represents a distance of the arm from its singular postures if this index is maintained away from zero then singular postures are avoided finally it might desirable to move the vehicle as least as possible for the same considerations made in section 2 10 hence the final motion minimization task the implementation of an action of this kind has been done within the already mentioned trident and maris projects for which experimental results such as the one shown in fig 4 are detailed in simetti et al 2014 and simetti et al 2017 respectively for such a reason they will not be covered in this work 3 4 assisted end effector teleoperation a further advanced assisted rov application consists in considering a teleoperation of the end effector of the manipulator rather than a set of degrees of freedom of the uvms as done in section 3 2 in this scenario the operator generates reference velocities for the end effector and the control system assists him in a set of prerequisite and safety objectives this can lead to the creation of an action similar to the one presented in section 3 3 1 r i s vehicle minimum altitude 2 r i s vehicle obstacle avoidance 3 r i s arm joint limits 4 r i p arm manipulability 5 r i p camera centering if visual feedback is available 6 r i p camera arm occlusions if visual feedback is available 7 nr e ad end effector linear velocity teleoperation 8 nr e ad end effector angular velocity teleoperation 9 r i o arm preferred shape 10 nr e o vehicle motion minimization in this case the camera objectives are included only if an acoustic vision feedback is available let us remark how the control loop to do the manipulative operation is now closed by the human operator hence the end effector tasks are of non reactive type 3 5 inspection another interesting action that can be defined within the proposed architecture stems from one of the reference missions of the dexrov project and regards the inspection of a pipeline an electromagnetic sensor placed at the end effector needs to be put in contact with the pipeline s weld and follow it in order to discover any possible cracks or leaks this application is very interesting since it requires interaction between the uvms and the environment and allows us to show how the proposed task priority framework can enforce kinematic constraints as well as despite being at the kinematic level manage interaction tasks let us consider a surface characterized by its normal n ℝ 3 the contact of the end effector with the surface creates two major requirements 1 the end effector can freely move only tangentially to the surface 2 any velocity requirement along the surface normal in the direction of the surface will actually result in a force exerted on the surface which can be exploited to maintain the contact with it for these reasons the control algorithm should take the surface constraint into account at the highest priority let us call j e l ℝ 3 n the total linear jacobian of the end effector frame comprehensive of both the vehicle and the manipulator contributions and let us consider the following task 9 s 1 argr min y x f n t j e l y 2 where the task reference x f can be exploited to modulate the velocity requirement along the surface s normal which will result in the desired interaction necessary to maintain contact with the surface through force regulation for example x f can be chosen as the output of any outer interaction force control loop once reported at the linear velocity level as done for instance in villani and de schutter 2016 antonelli 2014 cataldi and antonelli 2015 furthermore with the adoption of this task at the highest priority it is clear that subsequent tasks can only generate linear velocities in the tangential space to the surface finally let us assume that the end effector ends with a flat surface where the sensor is installed this flat surface should be the one in contact with the pipeline weld s surface let us further assume that the z axis of the end effector frame coincides with the normal direction of the end effector s flat surface then the misalignment vector between the z axis of the end effector frame and the surface s normal n should be minimized allowing the alignment of the sensor with the surface following the aforementioned requirement of having interaction tasks at the top of the task hierarchy the pipeline inspection action results to be 1 r e c constraint complying and force regulation 2 r i s arm joint limits 3 r i s arm manipulability 4 r i s vehicle horizontal attitude 5 r i p end effector alignment with the surface s normal 6 r e ad end effector linear path following 7 r e ad end effector attitude tracking 8 r i o arm preferred shape as regards the action goal tasks 6 and 7 above further details will be outlined within the dexrov pipeline inspection simulations presented in the successive section 4 2 3 6 landing finally a landing action is considered this action is the result of the initial investigations of the robust project robust website 2016 the auv needs to land in front of a manganese nodule to perform an in situ measurement of the nodule itself and identify the presence of possible rare earth elements deposits in the seafloor the landing is achieved using the following hierarchy of objectives 1 r i s vehicle horizontal attitude 2 r i p vehicle longitudinal alignment to the nodule 3 r i p vehicle distance to the nodule 4 r e ad vehicle altitude after the successful landing the in situ measurement is executed through the arm manipulation action presented in section 2 4 4 simulation results the results presented in the following subsections have been obtained through dynamic simulations coded in matlab in particular the following settings have been used a dynamic simulation was implemented and made running at 1 khz frequency to simulate the rigid body dynamics of the vehicle manipulator system we have implemented the newton euler equations modelling the vehicle as a serial kinematic chain with 3 linear actuators and a spherical joint this has allowed to easily take into account interaction forces between the vehicle and the manipulator s base the simulation of vehicle dynamics included the added mass term m a and linear and quadratic damping it is in general difficult to separate the different sources of damping therefore we wrote the total hydrodynamic damping as 10 d ν ν d d n ν where d is the linear damping matrix and d n ν is the nonlinear damping matrix due to quadratic damping and higher order terms fossen 2011 we have assumed both d and d n ν to be diagonal see eq 7 256 of fossen 2011 note that the robust and dexrov simulation are using the same vehicle parameters since no identification trials of the hydrodynamic terms have been executed yet the only difference is represented by the position of the arm w r t the center of mass of the vehicle therefore the main vehicle dynamic parameters have been chosen as a scaled down version of caccia et al 2000 and are reported in table 2 each arm link inertia was modelled taking into account mass and reduction gears and arm torques were saturated while hydrodynamic forces added mass and drag were neglected reference values are reported in table 3 we have assumed both the vehicle and the arm to be slightly negatively buoyant the dynamic control layer has been implemented in terms of separate independent proportional integrative controllers one for each degree of freedom tuned around the nominal inertia of the manipulator links and vehicle these controllers were executed at a frequency of 1 khz the kinematic control layer implementing the proposed task priority approach was executed at 100 hz frequency all system states were assumed measurable and no measurement noise was included in the simulations 4 1 safe waypoint navigation in this section a simulation of the safe navigation action presented in section 3 1 is shown the vehicle starts from the position 48 5 11 5 31 and is required to reach the target position 50 12 5 31 while maintaining at least an altitude of 1 5 m from the seafloor the corresponding activation function has a buffer zone δ 1 5 as clearly seen in fig 5 the target point cannot be reached maintaining the desired depth of 31 m since the seafloor rises in the vicinity of the starting position fig 6 b shows the time history of the activation functions of the inequality control objectives and in particular of the minimum altitude task the two plots of fig 6 c and d show how the depth regulation is lost in favour of maintaining the required altitude from the seafloor and as soon as the seafloor increases in depth the vehicle converges to its target depth again the simulation is therefore complaint with the desired behaviour shown in fig 3 as a final remark the oscillations that can be seen in the minimum altitude and in its activation function are due to the irregular seafloor shape inside the simulation environment this is confirmed by the depth of the vehicle which does not have such oscillations 4 2 pipeline weld inspection dexrov project as said in section 3 one of the test case scenarios of the h2020 dexrov project is the inspection of a pipeline s weld normally to carry out such an inspection an electromagnetic sensor is placed in contact with the weld and made slide along all the surface to do so with a robotized system requires that the uvms regulates the contact force to a given value to ensure contact without damaging the probe to carry out the inspection of the weld a reference path has been defined in the horizontal plane in correspondence of the projection of the weld therefore there is no knowledge of the actual shape or radius of the pipe the expected result is that the end effector follows the path projected on the pipe s surface adapting to the unknown surface a frictionless multi point contact between the end effector and the pipe surface was simulated all the simulated forces and moments have been transferred to a unique point on the end effector s rigid body space where the presence of force torque sensor has been assumed conversely to previous works di lillo et al 2016 the dynamics of the thrusters have been simulated based on the single state model whitcomb and yoerger 1999 and taking the motor and propeller parameters from the girona 500 ribas et al 2012 seaeye thrusters si mct01 in the simulation the action presented in section 3 5 has been implemented for the force regulation task the following simple reactive reference rate has been used and substituted in 9 11 x f γ λ λ γ 0 where λ and λ are the current and desired scalar values of the force to be exerted on the surface and γ is a positive proportional gain note that in this specific case a proportional law is sufficient since in the simulation the underlying dcl has been implemented with integral actions as done in the actual dexrov uvms prototype as previously explained in section 3 5 the jacobian of this task requires the knowledge of the surface normal n which can be estimated only once the end effector is already in contact with the pipeline through the force torque sensor on the wrist of the manipulator therefore this task has an activation function that depends on the norm of the contact force which explains the presence of a force activation function shown in the plots of fig 8 e the same activation function is also used for the surface alignment task screenshots of the uvms performing the inspection task are reported in fig 7 taken from the video available at https youtu be 5hk2umaon94 the results are summarized in fig 8 where in particular fig 8 a shows how the force is regulated close to the desired value of 10 n while following the path on the pipe with a maximum deviation of approximately 3 cm occurring around t 39 s as shown in fig 8 f the above results are achieved notwithstanding the activation of different safety tasks such as joint limits see fig 8 d and prerequisite ones such as manipulability see fig 8 e finally the generated system velocity references take into account the velocity saturations as it can be clearly appreciated in both fig 8 b and c to further comment on the obtained results let us consider the deviations from the desired path depicted in fig 8 f there are three intervals where the error is significant between t 15 s and t 25 s both the joint 2 limit avoidance and the minimum manipulability tasks are active this means that 2 out of 7 manipulator s degrees of freedom are used for such tasks therefore in tpik 2 of the vehicle arm coordination scheme of section 2 10 the manipulator does not have enough degrees of freedom to accomplish the end effector tracking tasks on its own since the vehicle has a significant tracking error the deviations occur at t 39 s the manipulability task has an activation value of approximately 0 9 indicating that the manipulability index is very low and that at least one of the singular value is approaching zero the end effector linear position task pseudo inverse in 6 is thus regularized to prevent joint and vehicle velocities going to infinity simetti and casalino 2016 at the expenses of path tracking accuracy at t 48 s we have a further different reason for the path tracking error in this case there are two joints near their limit for the same reasons outlined in the first point the path tracking error occurs let us also comment on the two spikes occurring in the force regulation shown in fig 8 a they are occurring approximately at t 25 s and at t 47 s it is interesting to note that in such time instants the desired velocity for the manipulator is quite high and close to the saturation value as a consequence despite the fast arm dynamics there is a peak in the joint velocity tracking error as evident in fig 8 g as the manipulator is in contact with the pipe such tracking errors make the manipulator move against the surface of the pipe creating unwanted spikes in the force regulation a second simulation is also presented here where a non reactive vehicle velocity minimization task was added at the bottom of the task hierarchy results are shown in fig 9 looking at fig 9 f and comparing with fig 8 f a slightly better path tracking can be observed this can be motivated by the lower velocity requested to the vehicle fig 9 c compared to fig 8 c and hence the lower tracking error therefore even when two joints are close to their limit the deviations from the desired path are of minor entity 4 3 landing robust project the h2020 robust project robust website 2016 aims to develop sea bed in situ material identification through the use of laser induced breakdown spectroscopy libs after diving to a preprogrammed altitude the uvms performs a mapping of the area and identifies the most promising area where manganese nodules can be found at this point it proceeds with a second more detailed survey at a lower altitude in a smaller area and whenever a nodule is identified it lands to perform the in situ measurement by bringing the libs rigidly attached to the end effector of the manipulator within a few centimetres of the nodule in this simulation the uvms starts close to the nodule position but not in front therefore the uvms first needs to align itself with the nodule direction and maintain a certain distance from it once these values are settled it can perform the final descend and land on the seafloor once the system has detected that the landing has been successfully completed i e depth is constant a 3d laser based reconstruction of the nodule is performed the output of the scan is used to generate a set of points around the nodule where the measurements should be taken afterwards the manipulator acting as a fixed base one moves the libs in the position to perform the measurement the same simulation settings as in the pipeline inspection case were used fig 10 shows a few snapshots of the simulation while the uvms performs the landing operation and the successive in situ measurement the results are summarized in fig 11 showing the time behaviour of the activation functions and the generated joint and vehicle reference velocities as clearly seen in the figures approximately at t 6 s the landing is concluded and the manipulation action is started which then concludes at about t 10 s as a final remark contact between the vehicle and the seafloor is not simulated hence once the landing has been completed the simulation simply fixes the vehicle actual velocity to zero therefore the activation functions of the vehicle related tasks such as minimum altitude should be disregarded after t 6 s in the real implementation to keep the vehicle fixated to the seafloor two solutions are being considered the first one is to add a variable buoyancy system and make the vehicle negative once the landing has been completed the second solution simply consists in using the vertical thrusters on top of the auv to keep the vehicle pushed against the seafloor 5 open problems and current research this paper has described the task priority control framework implemented within the kcl the output of the kcl are the system reference velocities that need to be tracked by the underlying dcl therefore the kcl should generate reference signals within the dcl bandwidth i e the kcl should be slower than the dcl which is often constituted by commercial actuators both for the thrusters of the vehicle and the joint controllers of the manipulator consequently it is not possible to implement advanced control techniques such as a computed torque control for the above reasons the kcl should adapt its performances to those given by the dcl the tuning of the kcl is generally long and tedious mostly due to the high number of kcl parameters even if the task priority approach decouples the contribution of the control tasks thanks to the priority concept it still requires different simulation sessions with an hydrodynamic model of the system followed by experimental trials ad hoc designed to test each control task tuning best practices for the task priority kcl parameters and gains tuning do not exist yet assessing them is currently under investigation as well as the possibility of devising auto tuning procedures 6 conclusions this paper has presented a unifying framework for the kinematic control layer of underwater vehicle manipulator systems the original task priority approach siciliano and slotine 1991 has been first extended allowing control tasks activation and deactivation without discontinuities in the control variables in order to efficiently implement inequality control objectives and task transitions between different actions simetti and casalino 2016 furthermore the developed framework explicitly deals with the tracking inaccuracies of the vehicle dynamic control layer with the two parallel optimizations recalled in section 2 10 allowing for optimal control of the end effector even during floating operations as shown in simetti et al 2017 underactuated vehicles are also deal with in a simple manner as briefly recalled in section 2 9 everything has been accomplished maintaining an invariant and uniform algorithmic structure as presented in section 2 6 in the maris project the proposed architecture has been experimentally tested in a grasping scenario achieving good results in repeatability and robustness simetti et al 2017 in this work we have shown how the architecture can be applied to execute different operations ranging from a safe navigation action to the dexrov pipeline inspection test case or the in site mineral measurement needed in the robust project in particular this work has shown how the framework has been extended to include interaction and force regulation at the kinematic level a necessary feature to handle the dexrov pipeline inspection case study the flexibility of the approach is demonstrated through different dynamic simulations further refinements especially on the integration of impedance control and on kcl parameter tuning procedures are currently being developed in the scope of the dexrov and robust projects acknowledgments this work has received funding from the european union s horizon 2020 research and innovation programme under grant agreement no 690416 robust and under grant agreement no 635491 dexrov 
23172,this paper presents a unifying task priority control architecture for underwater vehicle manipulator systems the proposed control framework can be applied to different operative scenarios such as waypoint navigation assisted teleoperation interaction landing and grasping this work extends the results of the trident and maris projects which were limited to the execution of grasping actions to other applications taken from the dexrov and robust projects in particular simulation results show how the control framework can be used for example for pipeline inspection scenarios and deep sea mining exploration keywords task priority control intervention autonomous underwater vehicles remotely operated vehicles kinematic control underwater vehicle manipulator systems 1 introduction during the last 20 years autonomous underwater vehicles auvs have been widely used as a tool for mapping the seafloor using optical and acoustic sensors with applications to dam inspection ridao et al 2010 marine geology wynn et al 2014 urabe et al 2015 and underwater archaeology drap et al 2008 bingham et al 2010 to mention but a few after years of research few autonomous platforms are already available in the market alvarez et al 2009 ribas et al 2012 most of them able to perform side scan sonar and bathymetric multi beam surveys a recent survey yuh et al 2011 reports a list of commercial platforms and applications of auvs however a large number of applications exist that go beyond the survey capabilities a number of them stem from the oil and gas industry such as the maintenance of submerged oil wells cabled sensor networks and pipelines in fact chevron has since 2007 an on going program for the employment of resident intervention auvs i auvs to provide better and more frequent inspections earlier monitoring and reduced field maintenance and development costs gilmour et al 2012 nowadays these tasks require the use of work class remotely operated vehicles rovs deployed from dynamic positioning vessels making them very expensive to respond to this increasing demand research in marine robotics has started focusing on the development of underwater vehicle manipulator systems uvms since early 90s different pioneering works were carried out on the control of compliant underwater manipulators yoerger et al 1991 coordinated vehicle arm control for teleoperation schempf and yoerger 1992 and during the odin choi et al 1994 and otter wang et al 1995 projects successively within the union project rigaud et al 1998 the first mechatronic assembly of an autonomous uvms was achieved between 1993 and 2000 the amadeus project lane et al 1997 developed grippers for underwater manipulation angeletti et al 1998 and studied the problem of dual arm autonomous manipulation casalino et al 2001 demonstrating these features in water tank experiments the successive decade was characterized by different field demonstrations among which we can cite the swimmer project evans et al 2001 and the alive project evans et al 2003 martyet al 2004 that achieved autonomous docking into a seabed docking station or rov friendly panels and the sauvim project yuh et al 1998 marani et al 2008 which demonstrated the capability of searching and recovering an object whose position was roughly known a priori concurrently research in industrial robotics focused on how to effectively specify the control objectives of a robotic system especially for redundant systems the task based control nakamura and hanafusa 1986 also known as operational space control khatib 1987 defines control objectives in a coordinate system that is directly relevant to the task that needs to be performed rather than in the generalized coordinates of the robotic system such an idea was immediately enhanced by the introduction of the concept of task priority nakamura 1991 in that work a primary task was executed and a secondary task was accomplished or attempted only in the null space of the primary one in order to guarantee the invariance of the main task w r t with respect to the secondary one this concept was later generalized to any number of task priority levels in the seminal work siciliano and slotine 1991 however it must be noted how the position control of the end effector was always the highest priority task and safety tasks such as joint limits were only attempted at lower priority given that an uvms is a robotic system characterized by a high number of degrees of freedom within the trident project sanz et al 2013 these two research trends were merged a novel task priority resolution mechanism which managed equality and scalar only inequality control objectives was developed and exploited for the first time for the coordinated control of a floating base and a manipulator for performing autonomous floating intervention simetti et al 2014 a blackbox recovery intervention was experimentally proved in a harbour environment shortly after trident the pandora project has demonstrated autonomous free floating valve turning operation on a subsea panel using a learning by demonstration paradigm carrera et al 2014 and a task priority kinematic control approach cieslak et al 2015 however the adopted task priority framework only dealt with equality control objectives and an ad hoc solution was devised to manage the joint limit safety task therefore it does not represent a general solution successively the concepts developed in the trident project were further enhanced within the maris project with the definition of a task priority framework able to activate and deactivate equality inequality control objectives of any dimension i e not limited to scalar ones depending on the system current needs simetti and casalino 2016 this feature allows the user to put safety and operational enabling objectives at the highest priority as they should be experiments in free floating grasping have been conducted with multiple attempts to test the repeatability and robustness of the control simetti et al 2017 the maris project also studied the extension of the control architecture to cooperative agents simetti and casalino 2017 finally recent studies on i auvs can be found in farivarnejad and moosavian 2014 allotta et al 2015 conti et al 2015 nowadays the authors are involved in two other projects where uvmss are employed namely the eu h2020 dexrov and robust projects the dexrov project di lillo et al 2016 main goal is to delocalize on shore the manned support to rov operations as much as possible reducing the crew on board the support vessel and consequently the costs and risks of the whole operation the delocalization is performed using satellite communications between the support ship and the remote control center therefore only high level commands are sent through the satellite channels and forwarded to the rov which must execute them in a semi autonomous manner the robust project robust website 2016 aims to use robotic technologies for the exploration of deep water mining sites especially manganese nodule fields the main idea is to perform in situ measurements of the nodules to identify if they contain rare earth elements which are particularly sought after in the market this paper presents a unifying control architecture for the control of uvmss both in the case of partial assisted teleoperation and fully autonomous operation the architecture handles inequality control objectives without overconstraining the system it coordinates the arm and vehicle movements thanks to a parallel task priority inversion scheme section 2 10 which is also suitable for multi rate control and it also manages the presence of vehicle underactuations to the best extent possible with the simple addition of a control task section 2 9 with respect to previous publications this work does not consider only a grasping scenario as it was the case of the trident and maris projects but it extends the framework and shows its flexibility in tackling different operative scenarios presenting the most recent results of the dexrov and robust projects in fact the same architecture can execute the required operations as long as the corresponding actions are defined with the advantage of having a unique controller at the kinematic level simplifying the overall implementation and allowing greater modularity as many control tasks are common to more than one action the present work s contributions are listed as follows c 1 it presents in a self contained way all the properties of the proposed task priority framework omitting only the mathematical details presented in simetti and casalino 2016 c 2 it shows how the proposed approach can be used for both autonomous operation and assisted teleoperation either if the user wants to control some of the degrees of freedom or even if he she desires to control only the end effector this is a requirement coming from the dexrov project c 3 it presents the integration of force regulation at the kinematic level for example to carry out the inspection of a pipeline as needed in the dexrov project validated through dynamic simulations including different rates for the kinematic and dynamic control layers vehicle added masses and coriolis effects thruster dynamics and actuator saturations c 4 it discusses how a safe navigation action and how landing in front of a specific target can be implemented again validated through dynamic simulations as they are two of the operations needed in the robust project for deep mining exploration the paper is organized as follows section 2 recaps the theory behind the developed task priority control framework then the flexibility of the proposed architecture in tackling many different kind of applications spanning all the aforementioned projects is highlighted in section 3 in section 4 the most recent simulation results of the dexrov and robust projects are shown section 5 presents the current open problems and research trends finally some conclusions are given in section 6 2 the control framework theory the control framework presented in this paper is based on the cascade of blocks shown in fig 1 in particular the architecture is constituted by three main blocks 1 the mission manager is in charge of supervising the execution of the current mission and generates the corresponding actions to be executed by the kinematic control layer as it will be explained later in section 2 4 an action is any prioritized list of control objectives to be concurrently achieved and a mission is a sequence or graph of actions 2 the kinematic control layer kcl implements the proposed task priority control framework and is in charge of reactively accomplishing the control objectives that make up the current action to be executed generating the desired system velocity vector 3 the dynamic control layer dcl tracks the desired system velocity vector by generating appropriate force torques commands for the vehicle and the manipulator the paper focuses on the kinematic control layer since it is the one implementing the proposed task priority approach the interfaces with the higher level mission manager and the lower one dcl are highlighted whenever relevant 2 1 general definitions let us introduce two definitions that will be used thoroughly in this paper the system configuration vector c ℝ n of the uvms as c q η t where q ℝ l is the arm configuration vector and η ℝ 6 is the vehicle generalized coordinate position vector which is the stacked vector of the position vector η 1 x y z t with components in the inertial frame w and the orientation vector η 2 ϕ θ ψ t the latter expressed in terms of the three angles roll pitch yaw applied in the yaw pitch roll sequence perez and fossen 2007 the possible singularity arising when the pitch angle is near π 2 is handled through a dedicated control objective as it will be shown later in section 3 from the above definitions it results n l 6 the system velocity vector y ℝ n of the uvms as y q v t where q ℝ l are the arm joint velocities and v ℝ 6 is the stacked vector of the vehicle linear velocity vector v 1 x y z t and the vehicle angular velocity vector v 2 p q r t both with components in the vehicle frame v note that the angular velocities are not the derivatives of the euler angles used in η 2 for the time being this work will be developed with the assumption of a vehicle fully actuated in its 6 degrees of freedom therefore the system velocity vector will coincide with the control vector to be used at the kinematic level section 2 9 will show how to relax this assumption 2 2 control objectives definition categories and examples let us start the discussion by considering what the robotic system needs to achieve mathematically speaking let us consider any scalar variable x c dependent on the current configuration of the robot and the environment then for this variable two broad classes of objectives can be defined 1 the requirement for t that x c x 0 is called a scalar equality control objective 2 the requirement for t that x c x m a x or x c x m i n is called a scalar inequality control objective control objectives can be further divided in different categories depending on their purpose and as it will be clear later on their priority physical constraints objectives e g interacting with the environment system safety objectives e g avoiding joint limits or obstacles objectives that are a prerequisite for accomplishing the mission e g maintaining the manipulated object in the camera field of view action oriented objectives i e what the system ultimately needs to execute to accomplish the current user defined action e g the end effector grasping an object reaching the desired position with the vehicle etc optimization objectives i e control objectives such as maintaining an arm preferred pose or minimizing the vehicle velocity which express a preference but whose achievement is not required for the execution of the action 2 3 reactive and non reactive control tasks to each scalar control objective there is always associated a feedback reference rate x it represents the closed loop rate control law that if tracked would drive the associated variable x c toward an arbitrary point x where the objective is satisfied a possible feedback reference rate is the following one 1 x x γ x x γ 0 where γ is a positive gain proportional to the desired convergence rate for the considered variable the need for tracking the desired x is termed a reactive control task sometimes a control task is defined directly in a certain task velocity space without having an associated control objective as an example consider the case where a human operator wants to control the end effector by generating velocity references through a joystick in such a case the reference rate x is generated by the user rather than being the output of a feedback control loop as in 1 in this case tracking the desired x is termed a non reactive control task in both situations to track the desired reference rate it is necessary to act upon the system velocity vector through a jacobian relationship of the type 2 x g t y where the vector g ℝ n is the jacobian of the considered task 2 4 actions in the terminology of this work an action is a prioritized list of control tasks to be concurrently managed the meaning is that lower priority tasks should not influence the fulfilment of higher priority ones if two or more scalar control tasks are assigned to the same priority level then they are grouped into a multidimensional control task for example for a robotic manipulator a manipulation action a m could be represented by following list of prioritized control objectives 1 arm joint limits 2 arm manipulability 3 end effector position control 4 end effector attitude control 5 arm preferred shape where it is natural to see safety objectives such as joint limits at the highest priority further remarks on how a list composing an action can be constructed will be given in section 2 8 and section 3 for the time being let us assume that a list of prioritized control tasks has been established 2 5 activation functions as remarked in the introduction one of the important points of this control architecture is the ability of handling inequality control objectives without overconstraining the system to this aim let us define an activation function 3 a i x 0 1 as a continuous sigmoidal function of the objective variable x c which assumes zero values within the validity region of the associated inequality objective for example assuming an objective of the class x c x m i n 4 a i x 1 x c x m i n s x x m i n x c x m i n δ 0 x c x m i n δ where s x is any smooth strictly decreasing function joining the two extrema and δ is a value that creates a buffer zone where the inequality is already satisfied but the activation value is still greater than zero preventing chattering problems around the inequality control objective threshold x m i n a similar function can be defined for objectives of the class x c x m a x clearly for both reactive control task associated to an equality control objective and for non reactive control tasks the activation function is always the unitary one i e a i x 1 from now on the distinction between reactive and non reactive control tasks will be dropped and the generic term control task will be used unless otherwise specified 2 6 task priority inverse kinematics given an action a for each priority level k the following matrices and vectors are consequently defined x k x 1 k x m k k t is the stacked vector of all the reference rates of the scalar control tasks where m k is the number of scalar tasks at the priority level k j k is the jacobian relationship expressing the current rate of change of the k th task vector x 1 k x m k k t w r t the system velocity vector y simply resulting from the stacking of the row vector ones in 2 a k diag a 1 k a m k k is the diagonal matrix of all the activation functions described in 3 to find the system velocity reference vector y that satisfies the above expressed priority requirements between the different tasks the following sequence of nested minimization problems needs to be solved corresponding to the so called task priority inverse kinematics tpik 5 s k argr min y s k 1 a k x k j k y 2 k 1 2 n where s k 1 is the manifold of solutions of all the previous tasks in the hierarchy s 0 ℝ n n is the total number of priority levels and finally where the notation r min is introduced for underlining that each minimization is performed via the specialized form of simetti and casalino 2016 within such a specialized framework named icat inequality constraints and task transitions the above tpik problem 5 results in the following algorithm to be initialized with ρ 0 0 q 0 i and then for k 1 n 6 w k j k q k 1 j k q k 1 a k q k 1 q k q k 1 i j k q k 1 a k i j k q k 1 ρ k ρ k 1 sat q k 1 j k q k 1 a k i w k x k j k ρ k 1 where the special pseudo inverse operator a q has been introduced in simetti and casalino 2016 to cope with certain invariance problems arising in 5 and where the function sat implements the management of control variable saturations accordingly with what suggested in antonelli et al 2009 at the end of the above iterative process the final system velocity vector is therefore y ρ n the interested reader can find all the relevant details of this procedure in simetti and casalino 2016 where a comparison with other task priority approaches as for instance those appearing in kanoun et al 2011 escande et al 2014 moe et al 2016 is given 2 7 building a mission through action sequencing the concept of an action represents a nice way to embed a certain complexity within the kcl exposing a simple interface toward the mission manager an important point to develop is the transition between two actions once an action change has been commanded by the mission manager let us consider the following two actions a 1 a b c d and a 2 a d c e composed by objectives abstractly labelled with alphabetic letters where a b denotes that a has higher priority than b and where b c means that b has equal priority to c now consider the merged list u a d 1 b c d 2 e where d 1 and d 2 represent the same objective d but with a different priority it is clear that through insertion deletion of some of the entries the two original lists can be reconstructed for example a 1 can be obtained by removing d 1 and e from the unified list conversely a 2 can be obtained by removing the control objectives d 2 and b to enable such transitions the activation function 3 is modified to become 7 a x p a i x a p p where a p p 0 1 is a continuous sigmoidal function of a vector of parameters p that contains the previous and current action being executed and the time elapsed in the current action to obtain the desired activation deactivation smooth transition of course this new activation function a p p applies to both reactive and non reactive control tasks since it does not depend on the variable x c an example of transition from action a 1 to a 2 is reported in table 1 where s d e c t t m a x represents a sigmoidal function whose values goes from 1 to 0 as the time t within the current action goes from 0 to the threshold time t m a x after which the transition between a 1 and a 2 is completed similarly s i n c t t m a x goes from 0 to 1 2 8 remarks on conflicting objectives an action is concluded successfully when its action defining objectives are satisfied thus a necessary condition to guarantee that an action can be terminated is the existence of a non void set of configurations where all high priority and action defining objectives are contemporaneously satisfied the presence of such a non conflicting zone is however not a sufficient condition as it does not imply its reachability in correspondence of all system initial configurations starting outside it such a reachability problem affects all the task priority strategies and in general all reactive control approaches in the proposed architecture this problem needs to be addressed at a higher level within the mission manager block the creation of different control actions helps in defining a set of well structured blocks that can be sequenced by the mission manager in case of inability of completing the required action the mission manager should devise an alternative solution e g a different sequencing of actions or different action parameters i e a new path to follow a detailed discussion of how the mission manager could be implemented falls outside the scope of the current work 2 9 control in presence of vehicle underactuations until now the vehicle was assumed fully actuated in all its degrees of freedom as it usually the case for work class rovs that need to perform manipulation activities in any case the proposed architecture can also be used for managing underactuated vehicles at the best extent possible as already shown in simetti et al 2017 let us consider a vehicle does not have thrusters allowing to control the angular velocities along the vehicle x and y axes roll and pitch which is often the case for small size vehicles to cope with underactuation let us add at the top of the hierarchy a non reactive control task structured as follows its reference rate x is composed by the vector of the measured vehicle velocities all vehicle velocities including the non actuated ones are assumed measurable therefore for such a task x v 1 t p q r t where v 2 has been explicitly written in terms of its components its jacobian is simply 0 6 l i 6 6 where the first block of zeroes regards the arm joint velocities that are kinematically non influencing the vehicle ones its activation function in the considered roll and pitch underactuation example is the constant diagonal matrix diag 0 0 0 1 1 0 selecting the non actuated velocities only it can be easily seen that at the end of the procedure the values of y corresponding to the non actuated degrees of freedom are equal to the measured ones hence the resulting vector y is the optimal one in correspondence of such non actuated degrees of freedom velocities in general with a proper choice of the activation function the proposed architecture can actually cope with any kind of vehicle underactuation thus possibly even underactuation caused by actuators failures provided they are detected and the vehicle velocities remain all measurable 2 10 arm vehicle coordination scheme an important feature of the proposed architecture is the arm vehicle motion coordination since if manipulator and vehicle motions are not kinematically decoupled then disturbances of the floating base e g due to nonlinear properties of thrusters whitcomb and yoerger 1995 whitcomb and yoerger 1999 bachmayer et al 2000 or the large inertia of the vehicle would propagate through the coupled kinematics immediately to the end effector of the manipulator simetti et al 2017 to cope with this problem the idea is to have two optimizations 6 running in parallel as depicted in fig 2 having as input the same action a the first optimization tpik 1 implements the task hiearchy of the action a and its output is used to generate the reference velocity for the vehicle the second optimization tpik 2 considers the vehicle as totally non controllable therefore the non reactive control task presented in 2 9 is used and all the vehicle degrees of freedom are initialized with the corresponding measured velocities the vehicle constrained velocity task is placed on top of the task hierarchy of action a as depicted in the tpik 2 block of fig 2 in such an optimization de facto only the manipulator variables are subject to be optimized hence the outputs of this procedure are the optimal joint velocities in correspondence of the measured vehicle velocity more details on this coordination technique are shown in simetti et al 2017 together with several experiments highlighting its importance for floating manipulation finally note how this parallel strategy for arm vehicle coordinated control is also suitable for implementing multi rate control of the two subsystems as tpik 1 can be run at the vehicle control frequency while tpik 2 can be updated at the higher arm control rate 3 applications this sections highlights different operative scenarios where the control of the uvms can take advantage of the proposed architecture showing its flexibility in being adapted to many applications in the following the actions to carry out the specific operations will be presented using the following compact notation r nr i e c s p ad o name of the task objective where r nr specifies if the task is reactive or non reactive i e specifies if the task is of inequality or equality type c s p ad o specifies if the category of the task i e constraint safety prerequisite action defining optimization finally all the actions that will be presented in the following sections can be thought as having the underactuation constraint task presented in section 2 9 at the top of the hierarchy i e nr e c vehicle underactuation constraint 3 1 safe waypoint navigation let us consider the requirement of having the uvms reaching a new position expressed for example in global coordinates through an ultra short or long baseline system in such a scenario other than having the vehicle in the required position there are a number of other objectives that the system needs to satisfy which can be summarized in the following list highest to lowest priority objective 1 r i s vehicle minimum altitude 2 r i s vehicle obstacle avoidance 3 r i s vehicle horizontal attitude 4 r i p vehicle auto heading 5 r e ad vehicle position x y and depth to avoid excessive energy consumption to keep a precise positioning the vehicle position control objective could be implemented as an inequality one introducing a dead band zone an hysteresis in the activation of the task could be also introduced to prevent excessive chattering around the threshold due to the vehicle dynamics the altitude task and obstacle avoidance one are written separately just because they usually work with different sensors i e an altimeter and a forward looking sonar the horizontal attitude control objective requires the vehicle to be parallel to the horizontal plane reducing the misalignment vector between its vertical axis and the absolute one simetti and casalino 2017 this control objective needed only for fully actuated vehicles avoids the possible singularity arising when the pitch angle is near π 2 in the roll pitch yaw representation the above defined navigation to a waypoint action allows us to make a few important remarks there is a natural conflict between certain objectives in the above example the minimum altitude might conflict with the auto depth objective which is implicitly considered in the vehicle position one however the altitude objective is activated only when really necessary the specified higher priority of the altitude task ensures that the altitude is maintained at the cost of the depth setpoint whenever necessary the resulting task priority behaviour is depicted in fig 3 thanks to the possibility of activating and deactivating tasks the priority of the objectives can follow a natural order without over constraining the system safety objectives first then operational enabling objectives auto heading then actual action defining objectives vehicle position 3 2 assisted teleoperation of uvms degrees of freedom the flexibility of the proposed control framework also allows one to implement an assisted teleoperation of the uvms in a sort of advanced rov operational mode typically the rov operator controls the vehicle through body frame velocities i e using the surge sway heave and angular velocity commands while he she also sets the desired joint velocities for the manipulator this means that the system velocity vector y is exactly the variable that contains the desired inputs for the operator therefore a non reactive control task for the manual control can be easily defined the jacobian relationship is simply the identity matrix the activation function is set to one in correspondence of the degrees of freedom that needs to be manually controlled zero otherwise the reference rate vector x is initialized with the values generated by the operator s console a control task so defined placed at the top of the control task hierarchy will directly set the corresponding control vector to the desired one provided by the operator it is important to note that if only some of the degrees of freedom are activated for manual control all the others can be used by the control system for the achievement of the remaining control objectives furthermore the task priority approach will automatically take into account the influence of the manually controlled degrees of freedom on the remaining control tasks to clarify let us consider the following example action of safe navigation with manual assisted teleoperation characterized by the following list of tasks 1 nr e ad manual control 2 r i s vehicle minimum altitude 3 r i s vehicle obstacle avoidance 4 r i s vehicle horizontal attitude 5 r i p vehicle auto heading 6 r i ad vehicle position x y and depth which is the same one as the previous section with the addition of the non reactive manual control task let us suppose that the operator configures the manual control task through a proper choice of the activation function to take control of surge sway and angular velocity along the z axis leaving the degrees of freedom of heave and the rotation along the x and y axes to the control system in such a configuration if the operator moves the vehicle with a certain surge velocity and the pitch of the vehicle points slightly down the depth will increase and altitude decrease however the control system through the vehicle position depth objective will automatically regulate the heave motion to compensate for the possible increase in depth finally the altitude control objective will prevent the operator for getting too close to the seafloor at the expenses of the depth regulation task accordingly with the desired priority and safety requirements 3 3 grasping another action that can be defined with the proposed architecture regards the grasping of an object in this case the action involves also the manipulator therefore the number of control objectives is naturally higher than in the previous examples the following hierarchy could be used to define such an action 1 r i s vehicle minimum altitude 2 r i s vehicle obstacle avoidance 3 r i s arm joint limits 4 r i p arm manipulability 5 r i p camera centering 6 r i p camera arm occlusions 7 r e ad end effector position control 8 r e ad end effector attitude control 9 r i o arm preferred shape 10 nr e o vehicle motion minimization where the need of avoiding occlusions between the manipulator and the camera system providing the feedback as well as the need of maintaining the object in the camera frame are clearly prerequisites for guiding the end effector on top of the object therefore they have higher priority the arm manipulability task aims at maintaining the manipulability index μ yoshikawa 1985 8 μ det j j t above a minimum value the index represents a distance of the arm from its singular postures if this index is maintained away from zero then singular postures are avoided finally it might desirable to move the vehicle as least as possible for the same considerations made in section 2 10 hence the final motion minimization task the implementation of an action of this kind has been done within the already mentioned trident and maris projects for which experimental results such as the one shown in fig 4 are detailed in simetti et al 2014 and simetti et al 2017 respectively for such a reason they will not be covered in this work 3 4 assisted end effector teleoperation a further advanced assisted rov application consists in considering a teleoperation of the end effector of the manipulator rather than a set of degrees of freedom of the uvms as done in section 3 2 in this scenario the operator generates reference velocities for the end effector and the control system assists him in a set of prerequisite and safety objectives this can lead to the creation of an action similar to the one presented in section 3 3 1 r i s vehicle minimum altitude 2 r i s vehicle obstacle avoidance 3 r i s arm joint limits 4 r i p arm manipulability 5 r i p camera centering if visual feedback is available 6 r i p camera arm occlusions if visual feedback is available 7 nr e ad end effector linear velocity teleoperation 8 nr e ad end effector angular velocity teleoperation 9 r i o arm preferred shape 10 nr e o vehicle motion minimization in this case the camera objectives are included only if an acoustic vision feedback is available let us remark how the control loop to do the manipulative operation is now closed by the human operator hence the end effector tasks are of non reactive type 3 5 inspection another interesting action that can be defined within the proposed architecture stems from one of the reference missions of the dexrov project and regards the inspection of a pipeline an electromagnetic sensor placed at the end effector needs to be put in contact with the pipeline s weld and follow it in order to discover any possible cracks or leaks this application is very interesting since it requires interaction between the uvms and the environment and allows us to show how the proposed task priority framework can enforce kinematic constraints as well as despite being at the kinematic level manage interaction tasks let us consider a surface characterized by its normal n ℝ 3 the contact of the end effector with the surface creates two major requirements 1 the end effector can freely move only tangentially to the surface 2 any velocity requirement along the surface normal in the direction of the surface will actually result in a force exerted on the surface which can be exploited to maintain the contact with it for these reasons the control algorithm should take the surface constraint into account at the highest priority let us call j e l ℝ 3 n the total linear jacobian of the end effector frame comprehensive of both the vehicle and the manipulator contributions and let us consider the following task 9 s 1 argr min y x f n t j e l y 2 where the task reference x f can be exploited to modulate the velocity requirement along the surface s normal which will result in the desired interaction necessary to maintain contact with the surface through force regulation for example x f can be chosen as the output of any outer interaction force control loop once reported at the linear velocity level as done for instance in villani and de schutter 2016 antonelli 2014 cataldi and antonelli 2015 furthermore with the adoption of this task at the highest priority it is clear that subsequent tasks can only generate linear velocities in the tangential space to the surface finally let us assume that the end effector ends with a flat surface where the sensor is installed this flat surface should be the one in contact with the pipeline weld s surface let us further assume that the z axis of the end effector frame coincides with the normal direction of the end effector s flat surface then the misalignment vector between the z axis of the end effector frame and the surface s normal n should be minimized allowing the alignment of the sensor with the surface following the aforementioned requirement of having interaction tasks at the top of the task hierarchy the pipeline inspection action results to be 1 r e c constraint complying and force regulation 2 r i s arm joint limits 3 r i s arm manipulability 4 r i s vehicle horizontal attitude 5 r i p end effector alignment with the surface s normal 6 r e ad end effector linear path following 7 r e ad end effector attitude tracking 8 r i o arm preferred shape as regards the action goal tasks 6 and 7 above further details will be outlined within the dexrov pipeline inspection simulations presented in the successive section 4 2 3 6 landing finally a landing action is considered this action is the result of the initial investigations of the robust project robust website 2016 the auv needs to land in front of a manganese nodule to perform an in situ measurement of the nodule itself and identify the presence of possible rare earth elements deposits in the seafloor the landing is achieved using the following hierarchy of objectives 1 r i s vehicle horizontal attitude 2 r i p vehicle longitudinal alignment to the nodule 3 r i p vehicle distance to the nodule 4 r e ad vehicle altitude after the successful landing the in situ measurement is executed through the arm manipulation action presented in section 2 4 4 simulation results the results presented in the following subsections have been obtained through dynamic simulations coded in matlab in particular the following settings have been used a dynamic simulation was implemented and made running at 1 khz frequency to simulate the rigid body dynamics of the vehicle manipulator system we have implemented the newton euler equations modelling the vehicle as a serial kinematic chain with 3 linear actuators and a spherical joint this has allowed to easily take into account interaction forces between the vehicle and the manipulator s base the simulation of vehicle dynamics included the added mass term m a and linear and quadratic damping it is in general difficult to separate the different sources of damping therefore we wrote the total hydrodynamic damping as 10 d ν ν d d n ν where d is the linear damping matrix and d n ν is the nonlinear damping matrix due to quadratic damping and higher order terms fossen 2011 we have assumed both d and d n ν to be diagonal see eq 7 256 of fossen 2011 note that the robust and dexrov simulation are using the same vehicle parameters since no identification trials of the hydrodynamic terms have been executed yet the only difference is represented by the position of the arm w r t the center of mass of the vehicle therefore the main vehicle dynamic parameters have been chosen as a scaled down version of caccia et al 2000 and are reported in table 2 each arm link inertia was modelled taking into account mass and reduction gears and arm torques were saturated while hydrodynamic forces added mass and drag were neglected reference values are reported in table 3 we have assumed both the vehicle and the arm to be slightly negatively buoyant the dynamic control layer has been implemented in terms of separate independent proportional integrative controllers one for each degree of freedom tuned around the nominal inertia of the manipulator links and vehicle these controllers were executed at a frequency of 1 khz the kinematic control layer implementing the proposed task priority approach was executed at 100 hz frequency all system states were assumed measurable and no measurement noise was included in the simulations 4 1 safe waypoint navigation in this section a simulation of the safe navigation action presented in section 3 1 is shown the vehicle starts from the position 48 5 11 5 31 and is required to reach the target position 50 12 5 31 while maintaining at least an altitude of 1 5 m from the seafloor the corresponding activation function has a buffer zone δ 1 5 as clearly seen in fig 5 the target point cannot be reached maintaining the desired depth of 31 m since the seafloor rises in the vicinity of the starting position fig 6 b shows the time history of the activation functions of the inequality control objectives and in particular of the minimum altitude task the two plots of fig 6 c and d show how the depth regulation is lost in favour of maintaining the required altitude from the seafloor and as soon as the seafloor increases in depth the vehicle converges to its target depth again the simulation is therefore complaint with the desired behaviour shown in fig 3 as a final remark the oscillations that can be seen in the minimum altitude and in its activation function are due to the irregular seafloor shape inside the simulation environment this is confirmed by the depth of the vehicle which does not have such oscillations 4 2 pipeline weld inspection dexrov project as said in section 3 one of the test case scenarios of the h2020 dexrov project is the inspection of a pipeline s weld normally to carry out such an inspection an electromagnetic sensor is placed in contact with the weld and made slide along all the surface to do so with a robotized system requires that the uvms regulates the contact force to a given value to ensure contact without damaging the probe to carry out the inspection of the weld a reference path has been defined in the horizontal plane in correspondence of the projection of the weld therefore there is no knowledge of the actual shape or radius of the pipe the expected result is that the end effector follows the path projected on the pipe s surface adapting to the unknown surface a frictionless multi point contact between the end effector and the pipe surface was simulated all the simulated forces and moments have been transferred to a unique point on the end effector s rigid body space where the presence of force torque sensor has been assumed conversely to previous works di lillo et al 2016 the dynamics of the thrusters have been simulated based on the single state model whitcomb and yoerger 1999 and taking the motor and propeller parameters from the girona 500 ribas et al 2012 seaeye thrusters si mct01 in the simulation the action presented in section 3 5 has been implemented for the force regulation task the following simple reactive reference rate has been used and substituted in 9 11 x f γ λ λ γ 0 where λ and λ are the current and desired scalar values of the force to be exerted on the surface and γ is a positive proportional gain note that in this specific case a proportional law is sufficient since in the simulation the underlying dcl has been implemented with integral actions as done in the actual dexrov uvms prototype as previously explained in section 3 5 the jacobian of this task requires the knowledge of the surface normal n which can be estimated only once the end effector is already in contact with the pipeline through the force torque sensor on the wrist of the manipulator therefore this task has an activation function that depends on the norm of the contact force which explains the presence of a force activation function shown in the plots of fig 8 e the same activation function is also used for the surface alignment task screenshots of the uvms performing the inspection task are reported in fig 7 taken from the video available at https youtu be 5hk2umaon94 the results are summarized in fig 8 where in particular fig 8 a shows how the force is regulated close to the desired value of 10 n while following the path on the pipe with a maximum deviation of approximately 3 cm occurring around t 39 s as shown in fig 8 f the above results are achieved notwithstanding the activation of different safety tasks such as joint limits see fig 8 d and prerequisite ones such as manipulability see fig 8 e finally the generated system velocity references take into account the velocity saturations as it can be clearly appreciated in both fig 8 b and c to further comment on the obtained results let us consider the deviations from the desired path depicted in fig 8 f there are three intervals where the error is significant between t 15 s and t 25 s both the joint 2 limit avoidance and the minimum manipulability tasks are active this means that 2 out of 7 manipulator s degrees of freedom are used for such tasks therefore in tpik 2 of the vehicle arm coordination scheme of section 2 10 the manipulator does not have enough degrees of freedom to accomplish the end effector tracking tasks on its own since the vehicle has a significant tracking error the deviations occur at t 39 s the manipulability task has an activation value of approximately 0 9 indicating that the manipulability index is very low and that at least one of the singular value is approaching zero the end effector linear position task pseudo inverse in 6 is thus regularized to prevent joint and vehicle velocities going to infinity simetti and casalino 2016 at the expenses of path tracking accuracy at t 48 s we have a further different reason for the path tracking error in this case there are two joints near their limit for the same reasons outlined in the first point the path tracking error occurs let us also comment on the two spikes occurring in the force regulation shown in fig 8 a they are occurring approximately at t 25 s and at t 47 s it is interesting to note that in such time instants the desired velocity for the manipulator is quite high and close to the saturation value as a consequence despite the fast arm dynamics there is a peak in the joint velocity tracking error as evident in fig 8 g as the manipulator is in contact with the pipe such tracking errors make the manipulator move against the surface of the pipe creating unwanted spikes in the force regulation a second simulation is also presented here where a non reactive vehicle velocity minimization task was added at the bottom of the task hierarchy results are shown in fig 9 looking at fig 9 f and comparing with fig 8 f a slightly better path tracking can be observed this can be motivated by the lower velocity requested to the vehicle fig 9 c compared to fig 8 c and hence the lower tracking error therefore even when two joints are close to their limit the deviations from the desired path are of minor entity 4 3 landing robust project the h2020 robust project robust website 2016 aims to develop sea bed in situ material identification through the use of laser induced breakdown spectroscopy libs after diving to a preprogrammed altitude the uvms performs a mapping of the area and identifies the most promising area where manganese nodules can be found at this point it proceeds with a second more detailed survey at a lower altitude in a smaller area and whenever a nodule is identified it lands to perform the in situ measurement by bringing the libs rigidly attached to the end effector of the manipulator within a few centimetres of the nodule in this simulation the uvms starts close to the nodule position but not in front therefore the uvms first needs to align itself with the nodule direction and maintain a certain distance from it once these values are settled it can perform the final descend and land on the seafloor once the system has detected that the landing has been successfully completed i e depth is constant a 3d laser based reconstruction of the nodule is performed the output of the scan is used to generate a set of points around the nodule where the measurements should be taken afterwards the manipulator acting as a fixed base one moves the libs in the position to perform the measurement the same simulation settings as in the pipeline inspection case were used fig 10 shows a few snapshots of the simulation while the uvms performs the landing operation and the successive in situ measurement the results are summarized in fig 11 showing the time behaviour of the activation functions and the generated joint and vehicle reference velocities as clearly seen in the figures approximately at t 6 s the landing is concluded and the manipulation action is started which then concludes at about t 10 s as a final remark contact between the vehicle and the seafloor is not simulated hence once the landing has been completed the simulation simply fixes the vehicle actual velocity to zero therefore the activation functions of the vehicle related tasks such as minimum altitude should be disregarded after t 6 s in the real implementation to keep the vehicle fixated to the seafloor two solutions are being considered the first one is to add a variable buoyancy system and make the vehicle negative once the landing has been completed the second solution simply consists in using the vertical thrusters on top of the auv to keep the vehicle pushed against the seafloor 5 open problems and current research this paper has described the task priority control framework implemented within the kcl the output of the kcl are the system reference velocities that need to be tracked by the underlying dcl therefore the kcl should generate reference signals within the dcl bandwidth i e the kcl should be slower than the dcl which is often constituted by commercial actuators both for the thrusters of the vehicle and the joint controllers of the manipulator consequently it is not possible to implement advanced control techniques such as a computed torque control for the above reasons the kcl should adapt its performances to those given by the dcl the tuning of the kcl is generally long and tedious mostly due to the high number of kcl parameters even if the task priority approach decouples the contribution of the control tasks thanks to the priority concept it still requires different simulation sessions with an hydrodynamic model of the system followed by experimental trials ad hoc designed to test each control task tuning best practices for the task priority kcl parameters and gains tuning do not exist yet assessing them is currently under investigation as well as the possibility of devising auto tuning procedures 6 conclusions this paper has presented a unifying framework for the kinematic control layer of underwater vehicle manipulator systems the original task priority approach siciliano and slotine 1991 has been first extended allowing control tasks activation and deactivation without discontinuities in the control variables in order to efficiently implement inequality control objectives and task transitions between different actions simetti and casalino 2016 furthermore the developed framework explicitly deals with the tracking inaccuracies of the vehicle dynamic control layer with the two parallel optimizations recalled in section 2 10 allowing for optimal control of the end effector even during floating operations as shown in simetti et al 2017 underactuated vehicles are also deal with in a simple manner as briefly recalled in section 2 9 everything has been accomplished maintaining an invariant and uniform algorithmic structure as presented in section 2 6 in the maris project the proposed architecture has been experimentally tested in a grasping scenario achieving good results in repeatability and robustness simetti et al 2017 in this work we have shown how the architecture can be applied to execute different operations ranging from a safe navigation action to the dexrov pipeline inspection test case or the in site mineral measurement needed in the robust project in particular this work has shown how the framework has been extended to include interaction and force regulation at the kinematic level a necessary feature to handle the dexrov pipeline inspection case study the flexibility of the approach is demonstrated through different dynamic simulations further refinements especially on the integration of impedance control and on kcl parameter tuning procedures are currently being developed in the scope of the dexrov and robust projects acknowledgments this work has received funding from the european union s horizon 2020 research and innovation programme under grant agreement no 690416 robust and under grant agreement no 635491 dexrov 
23173,tidal energy exploitation is at an early deployment stage and costs need to be reduced to improve the long term economic viability of the sector high costs of tidal turbines are in part the result of load uncertainties which lead to the use of high factors of safety in the design to ensure survival one of the most important causes of uncertainty is hydrodynamic loadings to date most of the scaled model experiments with horizontal axis turbines investigating this issue have been carried out with collinear wave and current directions to the authors knowledge the work presented herein is the first experimental investigation of a horizontal axis turbine model subjected to combined oblique waves and current turbine performance and loading are measured for a 1 15 scale model tested in the flowave circular combined wave and current basin at the university of edinburgh uk three different flow directions were tested and each of them were also combined with regular waves in three different directions non collinear with the flow fifteen physical quantities were measured including flow velocity rotor and foundation loads and turbine speed characterisation of loads and turbine performance in those oblique current and wave conditions are presented waves affect means and standard deviation of rotor power and thrust but off axis waves are associated with lower thrust loads than head on waves compared to current only rotor torque and thrust standard deviations are higher in the presence of waves and almost twice as high when the wave crest is parallel to the rotor plan the experimental data associated with this article can be downloaded from http dx doi org 10 7488 ds 2360 keywords tidal energy horizontal axis tidal rotor wave current interaction performance characterisation tank testing physical modelling 1 general introduction due to the ever greater urgency to address global warming issues the scottish government 2013 has set a target of generating the equivalent of 100 of scotland s electricity from renewable sources by 2020 with the added challenge of maintaining the country as a global lead in tidal and wave energy developments compared with other renewables such as wind and solar pv tidal energy is at a relatively early stage on its maturity and needs continued research into fundamentals of machine loading and performance in realistic conditions to enhance reliability and cost effectiveness according to the department of energy and climate change 2013 the levelised cost of electricity lcoe from tidal stream sources is expected to reduce from 190 mwh in 2025 to 171 mwh by 2030 for shallow water deployments and from 148 mwh to 129 mwh for deep water deployments this is still not a competitive generation method compared to onshore wind turbines over 5 mw per unit which is forecasted to have in 2030 a lcoe of 97 mwh this is due to the high cost of capital expenditure capex and operational expenditure opex a solution to lower the lcoe is to reduce capex by optimising the structural design of the device whilst maintaining the device s performance and survivability a possible approach is to lower the factors of safety fs that account for the design and performance uncertainties arising from loads in naturally occurring flows a way to assess the effect of these loads is physical testing of scale models there is an extensive literature on tidal turbine testing based upon physical models bahaj et al 2007 used a 0 8m rotor in a towing tank finding that the highest performance for their tidal turbine model was at a tip speed ratio tsr λ 5 7 with pitch angle of 20 they found that the power coefficient cp of the turbine decreases as the rotor is yawed and when the turbine tip is around 0 19d from the water surface mycek et al 2014 with a 0 7m rotor gaurier et al 2013 with a 0 9m rotor and de jesus henriques et al 2014 with a 0 5m rotor all in a recirculating tank observed that wave induced fatigue loads show a standard deviation two to three times higher than for the current only induced fatigue loads and represents a significant risk of failure the average cp and the average thrust coefficient ct are however not affected in addition they found that the ambient turbulence affects the fatigue loadings on the turbine but not its performance at higher turbulence intensity ti the wake was observed to recover faster than at lower ti luznik et al 2013 with a 0 46m rotor tested in a towing tank observed that in the absence of waves the turbine can operate at lower tsr values evans 2014 and easton 2013 using adcp measurements at ramsey sound pembrokeshire wales uk and the inner sound pentland firth scotland uk respectively showed that the main flow direction at potential tidal sites can vary by up to 20 between flood and ebb their findings were used to inform the range of directionalities explored in the present work in the field although there is a predominant wave direction there will be occasions when the wave direction varies from this the wave direction is independent of the tidal flow direction to the authors knowledge however the influence of waves not collinear to the current has not been explored in the literature perhaps in part due to the limited number of testing facilities capable of producing such conditions the turbine model used for this project is described in payne et al 2017 the article details the design process of the turbine blade element momentum bem is first used estimate the loads the turbine would be subjected to which in turn informs the specifications for the force sensors and for the drive train finite element analysis fea is used to ensure that the blades can structurally withstand the loads preliminary results from testing carried out in the recirculating flume of ifremer in boulogne sur mer france is also presented including cp and ct curves load time series and wake measurements the tests for this project were carried out in the flowave basin of the university of edinburgh whose characteristics have been documented in noble et al 2015 and sutherland et al 2017 both articles describe a fairly straight velocity depth profile from the surface up to mid depth with slower speeds closer to the bottom of the basin they observed that at 1 5m above the floor the measured flow speed experiences significant spatial variation throughout the basin s raiseable floor area and it can be up to 50 lower than the prescribed value the velocity depth profiles change considerably as the flow measurements are performed further away from the basin s centre especially on the transverse direction to the flow significant changes become noticeable outside a 5 meters radius noble et al 2015 propose a working area of 8 by 6 meters outside of which the spatial variations are of the order of 10 of the nominal speeds inside this working area all speed measurements are within 5 of the nominal speed the main objective of this study is to identify the effects of oblique waves and currents on the root bending moment of the blades on the rotor thrust and torque loadings and on the performance of a tidal turbine presently the use of factors of safety fs protect the devices from damage due to uncertain flow characteristics the aim of this work is to reduce these design uncertainties tests were undertaken in a circular tank that allows the generation of waves and currents at any desired angle this research used a 1 2 m diameter horizontal axis turbine model and a matrix of wave and current parameters ranging from collinear to oblique interactions this work expands the findings from martinez et al 2017 this work is divided in two main sections flow characterisation and turbine testing these sections are preceded by a general introduction of the testing facility and turbine model 2 the experimental facility and turbine model 2 1 wave current basin and instrumentation the flowave facility shown in fig 1 is located at the university of edinburgh in scotland uk it is a 25m diameter circular basin with a 2m working depth and a 15m diameter elevating floor to facilitate access to the basin bottom when setting up models current is generated by 28 5 bladed 1 7m diameter impellers arranged around the full circumference of the basin multidirectional wave generation is archived by 168 absorbing flap type wavemakers also arranged around the full circumference this facility has the advantage of creating flow and waves independently at any given angle robinson et al 2015 it was specifically designed to support tidal and wave energy research and development in intermediate water depths an acoustic doppler velocimeter adv was used for all flow measurements the specific instruments used was a vectrino profiler from nortek this instrument can measure flow velocities up to 3 0 m s at a sample rate of up to 100hz wave elevation are measured using resistive wave gauges these are sampled at 64hz and were calibrated every day before testing 2 2 turbine model the turbine model used for the tests was designed and built by payne et al 2017 at the university of edinburgh under the engineering and physical sciences research council epsrc funded project x med ep j010235 1 it consists of a 1 15 scale 1 2m diameter rotor that represents an 18m diameter turbine at full scale the blade profile is a naca 63 8xx made of aluminium manufactured by computer numerical control cnc machining for these experiments the turbine was operated under speed control fig 2 shows the turbine mounted on the basin floor all the instrumentation is kept protected inside the black and silver cylindrical sleeves the turbine was first tested at ifremer in boulogne sur mer france with results presented by payne et al 2017 2 2 1 turbine instrumentation the turbine model is fitted with a transducer measuring rotor torque and thrust on the rotor only it also includes sensors measuring the stream wise root bending moment at the root of each blade a resolver records the absolute angular position of the rotor all the turbine sensors are sampled synchronously at 256hz the root bending moment load cells developed a fault during the tests and their measurements are therefore not analysed herein 3 flow characterisation 3 1 introduction and methodology in order to understand the onset flow the turbine was going to be exposed to a campaign of flow characterisation tests was carried out before putting the turbine in the water this section describes the tested conditions and findings fig 3 shows a top view of the basin with a blue marker representing the location of the turbine the dashed lines represent the wave angles selected and the solid coloured lines represent the flow angles a flow speed of 0 8 m s was selected this is the design speed for the turbine model presented by payne et al 2017 from froude scaling this corresponds to a full scale velocity of 3 1 m s which according to mcnaughton et al 2015 is a realistic flow speed for deployment sites such as the european marine energy centre emec the wave directions were chosen to provide a broad range of conditions within the testing time allocated and the technical capability of the facility in that context tests in 180 opposing wave were not carried out as it limits the range of wave period available because of the doppler effect 90 waves were also excluded because the associated wave induced velocity will be parallel to the rotor disc and will therefore have limited influence on its load wave heights and periods were chosen to produce according to linear wave theory a horizontal wave induced velocity at hub height of 0 1 m s such a flow speed fluctuation is within the capability of the turbine model and would be associated at full scale with a 1 5m wave height and 8s wave period wave heights and periods were selected to generate a wave induced horizontal water particle velocity at hub height of 0 1 m s three regular waves were used with the characteristics shown in table 1 these tests were performed without the turbine and measurements of the flow speed were taken in the plane where the rotor would be fig 4 shows a front view of the rotor plane indicating where the wave gauges yellow lines were positioned during the tests and the flow velocity measurement positions red markers to create vertical and transverse profiles the dashed circle represents the rotor swept area the figure also shows the coordinate system used to describe the flow velocity components all the flow characterisation tests were recorded for 160s with a 32s ramp up at the beginning to allow for the first waves generated to reach the centre of the basin yielding an effective test duration of 128s after trimming off the run up seconds 3 2 results first the case of no waves and zero yaw is considered fig 5 shows the spectral density of the onset velocity components u v and w at hub height plotted against frequency both axes use a logarithmic scale these curves were obtained using a method where the data is downsampled logarithmically meaning that at lower frequencies the bins contain fewer frequency components than at higher frequencies giving smother curves at high frequencies two distinct regions of the spectrum are visible in the figure for frequencies 0 2 hz the trend of the spectra of the three velocity components is broadly horizontal corresponding to the energy containing range for higher frequencies the fall away of the spectral density indicates the inertial range all the velocity components are observed to follow closely the kolmogorov slope of 5 3 indicating that measured flow is similar to the idealised case of 3d isotropic homogeneous turbulent flow conditions modelled by kolmogorov s theory as presented by thorpe 2007 the levelling off of the spectra at the highest frequencies above 30 hz or so is due to the limits of the instrumentation this is discussed in section 3 3 the flow velocity magnitude u comprises both horizontal components of the flow u and v and is defined by 1 u u 2 v 2 as the vertical flow component w u v it was decided not to be included in u fig 6 shows the spectral density of the onset flow velocity u at hub height without waves for three flow directions the spectra are very similar for the three directions comparing figs 5 and 6 it can be seen that u has a similar spectral density to the individual velocity components henceforth s u will replace the use of the components spectra s u s v and s w focussing on the 20 yaw case the influence of waves was explored by the addition of waves period t 2 0s height h 102 mm from three different directions 0 45 and 315 fig 7 shows the resulting spectral density functions of the velocity u it is interesting to note the size of the spectral peaks associated with the wave period are about an order of magnitude higher than those associated with turbulence this suggests that at the wave frequency the energy contained in the waves is more significant than the energy contained in the turbulence in order to explore the uniformity of the flow within the rotor area and later on assess its effect on the turbine the nine u point measurements located within the rotor area shown in fig 4 were calculated with 1 time averaged and then spatial averaged giving one single velocity value u 0 fig 8 shows three different rotor area velocity maps there are nine point measurements represented by red crosses the dashed circle shows the rotor disc area the subfigures are for flow at a 0 b 10 and c 20 respectively it can be seen that closer to the bottom of the basin the velocity is slower this is due to bed friction induced velocity shear profile and also due to the way in which the water is projected from the turning vanes in the basin see noble et al 2015 it can also be observed that in the 0 and 20 cases the right hand side of the rotor disc experiences a faster flow with a relative increase to the rotor averaged velocity u 0 of 8 5 and 7 7 respectively the 10 case is more uniform throughout the rotor area although at the rotor axis the velocity is slightly higher than the rotor area average bare basin measurements reported in noble et al 2015 and sutherland et al 2017 give the turbulence intensity varying between 5 and 11 in the stream wise direction all the cases show a transverse profile with the left hand side showing slower velocities than the right side on the other hand 0 and 10 cases show also a depth profile that is not as pronounced in the 20 case these variations in flow are not dissimilar to those of noble et al 2015 3 3 discussion a feature of the spectral density data in figs 5 7 is an apparent levelling off for highest frequencies the instrument s geometry shown in fig 9 is responsible for this artefact the so called noise floor seen in fig 6 where u and v curve start to become horizontal and detach from the 5 3 slope at around 10 hz while the vertical component w keeps following the 5 3 slope up to 50 hz this is due to the 60 angle at which the probe s receivers are mounted relative to the emitter the vertical direction is therefore better aligned with the receivers compared horizontal this phenomenon was also observed by harding et al 2014 it is worth noting that the instrument was never rotated between tests and the basin velocity input values were always the same bare basin testing gave a better understanding of how the flow behaves at the same position where the turbine sits although the flow showed some non uniformity within the rotor area of the order of 10 or less the quality of the data and the different conditions tested gave confidence that the data is fit for purpose and it was now possible to move on to the next stage of the data analysis with the turbine tests 4 turbine testing 4 1 introduction the objective of these tests is to determine how big an influence oblique waves and flows have on a horizontal axis turbine and to assist designers in choosing less conservative factors of safety for this to happen it is necessary to understand how the conditions selected affect the performance and loadings of the turbine the performance of the turbine is assessed through power and thrust coefficients across a range of tip speed ratio turbine testing allows to understand the behaviour of the turbine loadings under oblique waves and currents conditions that are poorly represented in the literature 4 2 methodology the torque and thrust sensors were calibrated by the manufacturer previous experience has given confidence that the torque and thrust transducer show no drift during operation to improve the frequency analysis utilising fast fourier transforms fft the duration of each test was selected so that the number of measurement samples is a power of two however to allow for the waves to travel to the turbine s position 30s had to be added to each test s duration but was removed prior to analysis from previous experience operating the turbine below a particular tsr value in steady flow conditions leads to instability in the rotor s rotational speed as presented by payne et al 2017 therefore special care had to be taken while choosing the tests parameters here a set of tests aimed at characterising turbine performance cp and ct across a range of tsr from 4 25 to 7 5 were performed in these tests the flow velocity remained fixed at 0 8 m s and the rotor s speed was varied from 45 rpm and 95 rpm it is thought that there is a hydrodynamic limitation that triggers instabilities for tsr 4 all the turbine characterisation tests were performed without waves and at three different flow angles as shown in fig 10 and were based upon a measurement duration of 256s the location of the wave gauges yellow markers and vectrino red marker relative to the turbine is shown in fig 11 shown in fig 3 are the flow and wave angles used for flow characterisation these same conditions were also used for testing the turbine the difference between the two sets of tests is that there is only one point measurement for the flow velocity as shown in fig 12 to limit the potential for damage to the turbine and its instrumentation a cycle of tests was performed with the turbine configuration where all the load sensors were removed and replaced with dummy solid metal parts to make sure that the test program did not include conditions triggering the instabilities observed by payne et al 2017 in previous tests also special care was taken during testing with instrumentation by constantly monitoring the live instruments data stream looking for signal clipping or signals out of the expected range or shape all the loading tests were performed at a rated tsr of 7 with prescribed flow speed of 0 8 m s and 90 rpm they were all recorded for 512s with a 33s buffer at the beginning to allow for the first waves generated to reach the centre of the basin 4 3 results for calculating the power and thrust coefficients cp and ct respectively the following familiar definitions were used 2 c p p 1 2 ρ a u 0 3 3 c t t 1 2 ρ a u 0 2 where p is the power generated t is the thrust experienced by the rotor ρ is the water density a is the rotor area and u 0 is the rotor area averaged flow velocity before calculating the spatial averaged u 0 3 and u 0 2 each single point measurement u needs to be calculated using equation 1 for calculating u 0 3 and u 0 2 it is important to emphasise that each point measurement in the rotor area is cubed or squared before time averaging and then averaged over the nine measured points this allows a more realistic representation of the flow as this method takes into account the dynamic nature of the flow and also gives a true rms value as presented by blackmore et al 2016 in fig 13 the ct curves for flow at the three different yaw angles and without waves are presented against the tsr markers are the experimental data and the dashed lines show a quadratic fit it is possible to note a decreasing trend that goes with the increasing yaw angle the shadings in the background show the uncertainty bounds associated with standard deviation the standard deviation is defined as the variation of the measurements from their mean and it is the square root of the variance fig 14 shows the cp variation with tsr for the same tests covering three yaw angles without waves again quadratic fits have been done to try to assist in the visual interpretation of the data in this case the curves do not follow the same intuitive variation with yaw that was followed by ct the red 10 yaw angle curve has a higher cp while the 20 curve shows a considerably lower curve with the 0 yaw curve lying between this phenomenon was also observed by frost 2016 but has not yet been satisfactorily explained it could possibly be due to the significant variation in onset flow velocity observed over the rotor disc see section 3 2 the flow characterisation used for the ct and cp calculations rely on only nine points it is thought that using denser velocity mapping across the rotor area could yield different results it can be noticed that both cp and ct have very high standard deviation which arises from the high turbulence intensities and velocity variability across the rotor area now introducing waves fig 15 shows ct and cp for different flow yaw angle and for waves at 0 the turbine tsr is 7 at nominal flow speed u 0 8 m s in this case the coefficients were calculated using rotor averaged u 0 without waves this approach helped identify the influence of the waves in the coefficients it is possible to see the same trend in cp as seen in fig 14 where the curve for the 10 flow case is higher than 0 curve for ct similarly to fig 14 both 0 and 10 are very close to each other when waves are present it is also worth noting how both 0 and 10 decrease as the wave period increases but the 20 flow case behaves the opposite way in fig 16 cp and ct curves for three flow angles with no waves and waves with t 2 0 s at 0 45 and 315 are presented for all tsr 7 and the flow speed is 0 8 m s as for fig 15 the coefficients were calculated using rotor averaged u 0 without waves again it is the cases at 0 and 10 which show similar behaviour the 20 case follows the other two flow angles contrary to fig 15 here comparing the same wave shows that as the waves incidence angle increases the coefficients decrease plotted against frequency normalised by rotational frequency f 0 the ct frequency spectra at tsr 7 and u 0 0 8 m s fig 17 where several noticeable peaks can be observed the 20 yawed flow was chosen to keep consistency with the other cases presented in this work to see how big of an impact the most oblique flow has on the turbine following the spectra from left to right the first large peak is associated with the wave frequency the next peak at exactly 3f f 0 is the frequency with the passage of the three blades further harmonics of this at exactly 6 9 and 12 f f 0 are clearly identifiable each with successively smaller amplitudes the peak at 16 f f 0 is believed to be caused by a mechanical artefact indeed tests carried out at the same rotational speed but with the turbine outside the water dry test show the same peak fig 18 shows a close up of the spectral peaks associated with the waves the 45 and 315 peaks have similar amplitude which is consistent with them both being associated with wave conditions symmetrical with respect to the rotor axis the peak at 0 shows the highest amplitude compared to the same wave at other angles this is because the wave crest is parallel to the rotor plane therefore the rotor experiences the whole force magnitude of the waves and not a component of this force fig 19 shows the cp spectra at tsr 7 and u 0 0 8 m s against the normalized frequency f f 0 in this case the wave frequency and blade frequency 3f f 0 peaks can be seen the 6f f 0 peak is not believed to be a harmonic of the blade frequency since it is higher than the 3f f 0 peak the 6f f 0 peak as well as the 18 f f 0 and the 26 f f 0 peaks are also present in dry tests and are therefore not thought to be associated with fluid blade interactions the mean and sd values for all the tests performed with waves with period t 2 0s tsr 7 and u 0 0 8 m s are presented in table 2 at all flow angles cases b f and j with waves at 0 show the highest means and standard deviations for both torque and thrust compared to all the other cases with the same wave at different angles the high sd values mean that the waves aligned with the rotor have a higher impact on the load variability because the rotor experiences the whole magnitude of the waves forces and not a smaller component when the waves have an angle relative to the turbines axis this will affect the fatigue loads directly cases d h and l with waves at 315 show the lowest mean values for both torque and thrust the difference between the values at 45 and the 315 cases is due to the relative angle between the flow and the wave at 315 both have a ne direction while in the 45 case the flow goes ne while the waves are moving nw at all the flow angles the cases with no waves have the lowest sd values for torque and thrust the cases a e and i with no waves show the lowest sd values fig 20 shows time series of wave elevation and rotor thrust for a test with nominal velocity u 0 8 m s yaw angle 20 waves t 2 0s h 102 mm and wave angle 45 it is possible to see how the low frequency component of the thrust signal follows the quasi period of the wave gauges highlighting the influence of the wave on the thrust forces the two wave gauges are slightly out of phase due to the angle of 45 at which the waves are generated looking at fig 11 it can be seen that when waves come at an angle other than perpendicular to the rotor plane one of the wave gauges will sense the wave sooner than the other wave gauge giving a phase difference 4 4 discussion the data presented in this section proved to be of great use despite the faults with the root bending moment sensors and the high variability in the flow that accounted for such high sd on ct and cp these values were expected after the non uniformity presented on section 3 turbine testing allowed to understand the impact of waves and current at different angles on the loadings and performance of the turbine it is the standard deviation values of the torque and thrust that are highly affected by them with flow at 20 and waves at 315 the torque has the lowest mean values flow at 0 with no waves has the lowest sd values and any flow case with waves at 0 gave the highest means and sd this tests reduce some of the uncertainties associated with the effect of the onset flow on a tidal stream turbine 5 conclusions the work reported results from basin testing of a 1 15 scale horizontal axis tidal turbine in oblique currents and waves at flowave to the knowledge of the authors the tests are the first of their kind the flow characterisation for the current only cases showed some flow velocity spatial variation across the rotor area it was decided to use all the measurement points taken within the rotor area to give a better representation of the flow the case with flow at 10 yaw had the highest cp values followed by 0 and 20 similar findings are reported by frost 2016 this counterintuitive trend could be related to the significant velocity variations in the onset flow the velocity value used in the computation of cp and ct are based on the nine measurement points across the rotor but a higher number of points within the rotor area would yield a more accurate representation of the onset flow which could have consequences on power coefficient values these results show the importance of onset flow characterisation for turbine performance assessment the ct at 10 showed the expected trend where the thrust coefficient decreases with flow angle the presence of waves especially at 0 incidence to the turbine axis leads to sd values for torque and thrust which are almost double those associated with current only this would have a detrimental impact for fatigue loading the mean values of the torque and thrust are however hardly affect by waves compared to current only conditions unlike the flow with yaw angles of 0 and 10 20 yawed current in combination with waves at 0 show an increase in the ct and cp with wave period once again this trend should be treated with caution given the importance and uncertainties associated with the onset flow velocity used in the power and thrust coefficients calculations in the frequency analysis the peaks in s c t and s c p associated with waves at 45 and 315 have similar magnitude which is consistent with the fact that these two wave directions are symmetrical with respect to the rotor axis the peaks associated with the waves at 0 have the highest magnitude compared to all the other wave angles the peaks associated with waves at 135 have the lowest magnitude the different parameters used to test the turbine covered a wide range of cases which could be found in the ocean and which to the authors knowledge had not been tested at scale previously the findings presented herein provide original and important elements for considerations in the design process of tidal turbine the spectral analysis of loads could be a key input for turbine components design and specifications with a better understanding of the frequency distribution of loads safety factors could be reduced and the turbine structure can be designed to ensure that no vibration mode corresponds to significant load frequencies acknowledgments the first author would like to acknowledge the financial support of consejo nacional de ciencia y tecnología conacyt the authors would like to thank the flowave staff jeff steynor tom davey and martin lennon for their help with the testing this work would not have been possible without the funding from the epsrc via the marine challenge grant ep j010235 1 x med for the development of the turbine model the experimental data used to create the plots can be downloaded from http dx doi org 10 7488 ds 2360 
23173,tidal energy exploitation is at an early deployment stage and costs need to be reduced to improve the long term economic viability of the sector high costs of tidal turbines are in part the result of load uncertainties which lead to the use of high factors of safety in the design to ensure survival one of the most important causes of uncertainty is hydrodynamic loadings to date most of the scaled model experiments with horizontal axis turbines investigating this issue have been carried out with collinear wave and current directions to the authors knowledge the work presented herein is the first experimental investigation of a horizontal axis turbine model subjected to combined oblique waves and current turbine performance and loading are measured for a 1 15 scale model tested in the flowave circular combined wave and current basin at the university of edinburgh uk three different flow directions were tested and each of them were also combined with regular waves in three different directions non collinear with the flow fifteen physical quantities were measured including flow velocity rotor and foundation loads and turbine speed characterisation of loads and turbine performance in those oblique current and wave conditions are presented waves affect means and standard deviation of rotor power and thrust but off axis waves are associated with lower thrust loads than head on waves compared to current only rotor torque and thrust standard deviations are higher in the presence of waves and almost twice as high when the wave crest is parallel to the rotor plan the experimental data associated with this article can be downloaded from http dx doi org 10 7488 ds 2360 keywords tidal energy horizontal axis tidal rotor wave current interaction performance characterisation tank testing physical modelling 1 general introduction due to the ever greater urgency to address global warming issues the scottish government 2013 has set a target of generating the equivalent of 100 of scotland s electricity from renewable sources by 2020 with the added challenge of maintaining the country as a global lead in tidal and wave energy developments compared with other renewables such as wind and solar pv tidal energy is at a relatively early stage on its maturity and needs continued research into fundamentals of machine loading and performance in realistic conditions to enhance reliability and cost effectiveness according to the department of energy and climate change 2013 the levelised cost of electricity lcoe from tidal stream sources is expected to reduce from 190 mwh in 2025 to 171 mwh by 2030 for shallow water deployments and from 148 mwh to 129 mwh for deep water deployments this is still not a competitive generation method compared to onshore wind turbines over 5 mw per unit which is forecasted to have in 2030 a lcoe of 97 mwh this is due to the high cost of capital expenditure capex and operational expenditure opex a solution to lower the lcoe is to reduce capex by optimising the structural design of the device whilst maintaining the device s performance and survivability a possible approach is to lower the factors of safety fs that account for the design and performance uncertainties arising from loads in naturally occurring flows a way to assess the effect of these loads is physical testing of scale models there is an extensive literature on tidal turbine testing based upon physical models bahaj et al 2007 used a 0 8m rotor in a towing tank finding that the highest performance for their tidal turbine model was at a tip speed ratio tsr λ 5 7 with pitch angle of 20 they found that the power coefficient cp of the turbine decreases as the rotor is yawed and when the turbine tip is around 0 19d from the water surface mycek et al 2014 with a 0 7m rotor gaurier et al 2013 with a 0 9m rotor and de jesus henriques et al 2014 with a 0 5m rotor all in a recirculating tank observed that wave induced fatigue loads show a standard deviation two to three times higher than for the current only induced fatigue loads and represents a significant risk of failure the average cp and the average thrust coefficient ct are however not affected in addition they found that the ambient turbulence affects the fatigue loadings on the turbine but not its performance at higher turbulence intensity ti the wake was observed to recover faster than at lower ti luznik et al 2013 with a 0 46m rotor tested in a towing tank observed that in the absence of waves the turbine can operate at lower tsr values evans 2014 and easton 2013 using adcp measurements at ramsey sound pembrokeshire wales uk and the inner sound pentland firth scotland uk respectively showed that the main flow direction at potential tidal sites can vary by up to 20 between flood and ebb their findings were used to inform the range of directionalities explored in the present work in the field although there is a predominant wave direction there will be occasions when the wave direction varies from this the wave direction is independent of the tidal flow direction to the authors knowledge however the influence of waves not collinear to the current has not been explored in the literature perhaps in part due to the limited number of testing facilities capable of producing such conditions the turbine model used for this project is described in payne et al 2017 the article details the design process of the turbine blade element momentum bem is first used estimate the loads the turbine would be subjected to which in turn informs the specifications for the force sensors and for the drive train finite element analysis fea is used to ensure that the blades can structurally withstand the loads preliminary results from testing carried out in the recirculating flume of ifremer in boulogne sur mer france is also presented including cp and ct curves load time series and wake measurements the tests for this project were carried out in the flowave basin of the university of edinburgh whose characteristics have been documented in noble et al 2015 and sutherland et al 2017 both articles describe a fairly straight velocity depth profile from the surface up to mid depth with slower speeds closer to the bottom of the basin they observed that at 1 5m above the floor the measured flow speed experiences significant spatial variation throughout the basin s raiseable floor area and it can be up to 50 lower than the prescribed value the velocity depth profiles change considerably as the flow measurements are performed further away from the basin s centre especially on the transverse direction to the flow significant changes become noticeable outside a 5 meters radius noble et al 2015 propose a working area of 8 by 6 meters outside of which the spatial variations are of the order of 10 of the nominal speeds inside this working area all speed measurements are within 5 of the nominal speed the main objective of this study is to identify the effects of oblique waves and currents on the root bending moment of the blades on the rotor thrust and torque loadings and on the performance of a tidal turbine presently the use of factors of safety fs protect the devices from damage due to uncertain flow characteristics the aim of this work is to reduce these design uncertainties tests were undertaken in a circular tank that allows the generation of waves and currents at any desired angle this research used a 1 2 m diameter horizontal axis turbine model and a matrix of wave and current parameters ranging from collinear to oblique interactions this work expands the findings from martinez et al 2017 this work is divided in two main sections flow characterisation and turbine testing these sections are preceded by a general introduction of the testing facility and turbine model 2 the experimental facility and turbine model 2 1 wave current basin and instrumentation the flowave facility shown in fig 1 is located at the university of edinburgh in scotland uk it is a 25m diameter circular basin with a 2m working depth and a 15m diameter elevating floor to facilitate access to the basin bottom when setting up models current is generated by 28 5 bladed 1 7m diameter impellers arranged around the full circumference of the basin multidirectional wave generation is archived by 168 absorbing flap type wavemakers also arranged around the full circumference this facility has the advantage of creating flow and waves independently at any given angle robinson et al 2015 it was specifically designed to support tidal and wave energy research and development in intermediate water depths an acoustic doppler velocimeter adv was used for all flow measurements the specific instruments used was a vectrino profiler from nortek this instrument can measure flow velocities up to 3 0 m s at a sample rate of up to 100hz wave elevation are measured using resistive wave gauges these are sampled at 64hz and were calibrated every day before testing 2 2 turbine model the turbine model used for the tests was designed and built by payne et al 2017 at the university of edinburgh under the engineering and physical sciences research council epsrc funded project x med ep j010235 1 it consists of a 1 15 scale 1 2m diameter rotor that represents an 18m diameter turbine at full scale the blade profile is a naca 63 8xx made of aluminium manufactured by computer numerical control cnc machining for these experiments the turbine was operated under speed control fig 2 shows the turbine mounted on the basin floor all the instrumentation is kept protected inside the black and silver cylindrical sleeves the turbine was first tested at ifremer in boulogne sur mer france with results presented by payne et al 2017 2 2 1 turbine instrumentation the turbine model is fitted with a transducer measuring rotor torque and thrust on the rotor only it also includes sensors measuring the stream wise root bending moment at the root of each blade a resolver records the absolute angular position of the rotor all the turbine sensors are sampled synchronously at 256hz the root bending moment load cells developed a fault during the tests and their measurements are therefore not analysed herein 3 flow characterisation 3 1 introduction and methodology in order to understand the onset flow the turbine was going to be exposed to a campaign of flow characterisation tests was carried out before putting the turbine in the water this section describes the tested conditions and findings fig 3 shows a top view of the basin with a blue marker representing the location of the turbine the dashed lines represent the wave angles selected and the solid coloured lines represent the flow angles a flow speed of 0 8 m s was selected this is the design speed for the turbine model presented by payne et al 2017 from froude scaling this corresponds to a full scale velocity of 3 1 m s which according to mcnaughton et al 2015 is a realistic flow speed for deployment sites such as the european marine energy centre emec the wave directions were chosen to provide a broad range of conditions within the testing time allocated and the technical capability of the facility in that context tests in 180 opposing wave were not carried out as it limits the range of wave period available because of the doppler effect 90 waves were also excluded because the associated wave induced velocity will be parallel to the rotor disc and will therefore have limited influence on its load wave heights and periods were chosen to produce according to linear wave theory a horizontal wave induced velocity at hub height of 0 1 m s such a flow speed fluctuation is within the capability of the turbine model and would be associated at full scale with a 1 5m wave height and 8s wave period wave heights and periods were selected to generate a wave induced horizontal water particle velocity at hub height of 0 1 m s three regular waves were used with the characteristics shown in table 1 these tests were performed without the turbine and measurements of the flow speed were taken in the plane where the rotor would be fig 4 shows a front view of the rotor plane indicating where the wave gauges yellow lines were positioned during the tests and the flow velocity measurement positions red markers to create vertical and transverse profiles the dashed circle represents the rotor swept area the figure also shows the coordinate system used to describe the flow velocity components all the flow characterisation tests were recorded for 160s with a 32s ramp up at the beginning to allow for the first waves generated to reach the centre of the basin yielding an effective test duration of 128s after trimming off the run up seconds 3 2 results first the case of no waves and zero yaw is considered fig 5 shows the spectral density of the onset velocity components u v and w at hub height plotted against frequency both axes use a logarithmic scale these curves were obtained using a method where the data is downsampled logarithmically meaning that at lower frequencies the bins contain fewer frequency components than at higher frequencies giving smother curves at high frequencies two distinct regions of the spectrum are visible in the figure for frequencies 0 2 hz the trend of the spectra of the three velocity components is broadly horizontal corresponding to the energy containing range for higher frequencies the fall away of the spectral density indicates the inertial range all the velocity components are observed to follow closely the kolmogorov slope of 5 3 indicating that measured flow is similar to the idealised case of 3d isotropic homogeneous turbulent flow conditions modelled by kolmogorov s theory as presented by thorpe 2007 the levelling off of the spectra at the highest frequencies above 30 hz or so is due to the limits of the instrumentation this is discussed in section 3 3 the flow velocity magnitude u comprises both horizontal components of the flow u and v and is defined by 1 u u 2 v 2 as the vertical flow component w u v it was decided not to be included in u fig 6 shows the spectral density of the onset flow velocity u at hub height without waves for three flow directions the spectra are very similar for the three directions comparing figs 5 and 6 it can be seen that u has a similar spectral density to the individual velocity components henceforth s u will replace the use of the components spectra s u s v and s w focussing on the 20 yaw case the influence of waves was explored by the addition of waves period t 2 0s height h 102 mm from three different directions 0 45 and 315 fig 7 shows the resulting spectral density functions of the velocity u it is interesting to note the size of the spectral peaks associated with the wave period are about an order of magnitude higher than those associated with turbulence this suggests that at the wave frequency the energy contained in the waves is more significant than the energy contained in the turbulence in order to explore the uniformity of the flow within the rotor area and later on assess its effect on the turbine the nine u point measurements located within the rotor area shown in fig 4 were calculated with 1 time averaged and then spatial averaged giving one single velocity value u 0 fig 8 shows three different rotor area velocity maps there are nine point measurements represented by red crosses the dashed circle shows the rotor disc area the subfigures are for flow at a 0 b 10 and c 20 respectively it can be seen that closer to the bottom of the basin the velocity is slower this is due to bed friction induced velocity shear profile and also due to the way in which the water is projected from the turning vanes in the basin see noble et al 2015 it can also be observed that in the 0 and 20 cases the right hand side of the rotor disc experiences a faster flow with a relative increase to the rotor averaged velocity u 0 of 8 5 and 7 7 respectively the 10 case is more uniform throughout the rotor area although at the rotor axis the velocity is slightly higher than the rotor area average bare basin measurements reported in noble et al 2015 and sutherland et al 2017 give the turbulence intensity varying between 5 and 11 in the stream wise direction all the cases show a transverse profile with the left hand side showing slower velocities than the right side on the other hand 0 and 10 cases show also a depth profile that is not as pronounced in the 20 case these variations in flow are not dissimilar to those of noble et al 2015 3 3 discussion a feature of the spectral density data in figs 5 7 is an apparent levelling off for highest frequencies the instrument s geometry shown in fig 9 is responsible for this artefact the so called noise floor seen in fig 6 where u and v curve start to become horizontal and detach from the 5 3 slope at around 10 hz while the vertical component w keeps following the 5 3 slope up to 50 hz this is due to the 60 angle at which the probe s receivers are mounted relative to the emitter the vertical direction is therefore better aligned with the receivers compared horizontal this phenomenon was also observed by harding et al 2014 it is worth noting that the instrument was never rotated between tests and the basin velocity input values were always the same bare basin testing gave a better understanding of how the flow behaves at the same position where the turbine sits although the flow showed some non uniformity within the rotor area of the order of 10 or less the quality of the data and the different conditions tested gave confidence that the data is fit for purpose and it was now possible to move on to the next stage of the data analysis with the turbine tests 4 turbine testing 4 1 introduction the objective of these tests is to determine how big an influence oblique waves and flows have on a horizontal axis turbine and to assist designers in choosing less conservative factors of safety for this to happen it is necessary to understand how the conditions selected affect the performance and loadings of the turbine the performance of the turbine is assessed through power and thrust coefficients across a range of tip speed ratio turbine testing allows to understand the behaviour of the turbine loadings under oblique waves and currents conditions that are poorly represented in the literature 4 2 methodology the torque and thrust sensors were calibrated by the manufacturer previous experience has given confidence that the torque and thrust transducer show no drift during operation to improve the frequency analysis utilising fast fourier transforms fft the duration of each test was selected so that the number of measurement samples is a power of two however to allow for the waves to travel to the turbine s position 30s had to be added to each test s duration but was removed prior to analysis from previous experience operating the turbine below a particular tsr value in steady flow conditions leads to instability in the rotor s rotational speed as presented by payne et al 2017 therefore special care had to be taken while choosing the tests parameters here a set of tests aimed at characterising turbine performance cp and ct across a range of tsr from 4 25 to 7 5 were performed in these tests the flow velocity remained fixed at 0 8 m s and the rotor s speed was varied from 45 rpm and 95 rpm it is thought that there is a hydrodynamic limitation that triggers instabilities for tsr 4 all the turbine characterisation tests were performed without waves and at three different flow angles as shown in fig 10 and were based upon a measurement duration of 256s the location of the wave gauges yellow markers and vectrino red marker relative to the turbine is shown in fig 11 shown in fig 3 are the flow and wave angles used for flow characterisation these same conditions were also used for testing the turbine the difference between the two sets of tests is that there is only one point measurement for the flow velocity as shown in fig 12 to limit the potential for damage to the turbine and its instrumentation a cycle of tests was performed with the turbine configuration where all the load sensors were removed and replaced with dummy solid metal parts to make sure that the test program did not include conditions triggering the instabilities observed by payne et al 2017 in previous tests also special care was taken during testing with instrumentation by constantly monitoring the live instruments data stream looking for signal clipping or signals out of the expected range or shape all the loading tests were performed at a rated tsr of 7 with prescribed flow speed of 0 8 m s and 90 rpm they were all recorded for 512s with a 33s buffer at the beginning to allow for the first waves generated to reach the centre of the basin 4 3 results for calculating the power and thrust coefficients cp and ct respectively the following familiar definitions were used 2 c p p 1 2 ρ a u 0 3 3 c t t 1 2 ρ a u 0 2 where p is the power generated t is the thrust experienced by the rotor ρ is the water density a is the rotor area and u 0 is the rotor area averaged flow velocity before calculating the spatial averaged u 0 3 and u 0 2 each single point measurement u needs to be calculated using equation 1 for calculating u 0 3 and u 0 2 it is important to emphasise that each point measurement in the rotor area is cubed or squared before time averaging and then averaged over the nine measured points this allows a more realistic representation of the flow as this method takes into account the dynamic nature of the flow and also gives a true rms value as presented by blackmore et al 2016 in fig 13 the ct curves for flow at the three different yaw angles and without waves are presented against the tsr markers are the experimental data and the dashed lines show a quadratic fit it is possible to note a decreasing trend that goes with the increasing yaw angle the shadings in the background show the uncertainty bounds associated with standard deviation the standard deviation is defined as the variation of the measurements from their mean and it is the square root of the variance fig 14 shows the cp variation with tsr for the same tests covering three yaw angles without waves again quadratic fits have been done to try to assist in the visual interpretation of the data in this case the curves do not follow the same intuitive variation with yaw that was followed by ct the red 10 yaw angle curve has a higher cp while the 20 curve shows a considerably lower curve with the 0 yaw curve lying between this phenomenon was also observed by frost 2016 but has not yet been satisfactorily explained it could possibly be due to the significant variation in onset flow velocity observed over the rotor disc see section 3 2 the flow characterisation used for the ct and cp calculations rely on only nine points it is thought that using denser velocity mapping across the rotor area could yield different results it can be noticed that both cp and ct have very high standard deviation which arises from the high turbulence intensities and velocity variability across the rotor area now introducing waves fig 15 shows ct and cp for different flow yaw angle and for waves at 0 the turbine tsr is 7 at nominal flow speed u 0 8 m s in this case the coefficients were calculated using rotor averaged u 0 without waves this approach helped identify the influence of the waves in the coefficients it is possible to see the same trend in cp as seen in fig 14 where the curve for the 10 flow case is higher than 0 curve for ct similarly to fig 14 both 0 and 10 are very close to each other when waves are present it is also worth noting how both 0 and 10 decrease as the wave period increases but the 20 flow case behaves the opposite way in fig 16 cp and ct curves for three flow angles with no waves and waves with t 2 0 s at 0 45 and 315 are presented for all tsr 7 and the flow speed is 0 8 m s as for fig 15 the coefficients were calculated using rotor averaged u 0 without waves again it is the cases at 0 and 10 which show similar behaviour the 20 case follows the other two flow angles contrary to fig 15 here comparing the same wave shows that as the waves incidence angle increases the coefficients decrease plotted against frequency normalised by rotational frequency f 0 the ct frequency spectra at tsr 7 and u 0 0 8 m s fig 17 where several noticeable peaks can be observed the 20 yawed flow was chosen to keep consistency with the other cases presented in this work to see how big of an impact the most oblique flow has on the turbine following the spectra from left to right the first large peak is associated with the wave frequency the next peak at exactly 3f f 0 is the frequency with the passage of the three blades further harmonics of this at exactly 6 9 and 12 f f 0 are clearly identifiable each with successively smaller amplitudes the peak at 16 f f 0 is believed to be caused by a mechanical artefact indeed tests carried out at the same rotational speed but with the turbine outside the water dry test show the same peak fig 18 shows a close up of the spectral peaks associated with the waves the 45 and 315 peaks have similar amplitude which is consistent with them both being associated with wave conditions symmetrical with respect to the rotor axis the peak at 0 shows the highest amplitude compared to the same wave at other angles this is because the wave crest is parallel to the rotor plane therefore the rotor experiences the whole force magnitude of the waves and not a component of this force fig 19 shows the cp spectra at tsr 7 and u 0 0 8 m s against the normalized frequency f f 0 in this case the wave frequency and blade frequency 3f f 0 peaks can be seen the 6f f 0 peak is not believed to be a harmonic of the blade frequency since it is higher than the 3f f 0 peak the 6f f 0 peak as well as the 18 f f 0 and the 26 f f 0 peaks are also present in dry tests and are therefore not thought to be associated with fluid blade interactions the mean and sd values for all the tests performed with waves with period t 2 0s tsr 7 and u 0 0 8 m s are presented in table 2 at all flow angles cases b f and j with waves at 0 show the highest means and standard deviations for both torque and thrust compared to all the other cases with the same wave at different angles the high sd values mean that the waves aligned with the rotor have a higher impact on the load variability because the rotor experiences the whole magnitude of the waves forces and not a smaller component when the waves have an angle relative to the turbines axis this will affect the fatigue loads directly cases d h and l with waves at 315 show the lowest mean values for both torque and thrust the difference between the values at 45 and the 315 cases is due to the relative angle between the flow and the wave at 315 both have a ne direction while in the 45 case the flow goes ne while the waves are moving nw at all the flow angles the cases with no waves have the lowest sd values for torque and thrust the cases a e and i with no waves show the lowest sd values fig 20 shows time series of wave elevation and rotor thrust for a test with nominal velocity u 0 8 m s yaw angle 20 waves t 2 0s h 102 mm and wave angle 45 it is possible to see how the low frequency component of the thrust signal follows the quasi period of the wave gauges highlighting the influence of the wave on the thrust forces the two wave gauges are slightly out of phase due to the angle of 45 at which the waves are generated looking at fig 11 it can be seen that when waves come at an angle other than perpendicular to the rotor plane one of the wave gauges will sense the wave sooner than the other wave gauge giving a phase difference 4 4 discussion the data presented in this section proved to be of great use despite the faults with the root bending moment sensors and the high variability in the flow that accounted for such high sd on ct and cp these values were expected after the non uniformity presented on section 3 turbine testing allowed to understand the impact of waves and current at different angles on the loadings and performance of the turbine it is the standard deviation values of the torque and thrust that are highly affected by them with flow at 20 and waves at 315 the torque has the lowest mean values flow at 0 with no waves has the lowest sd values and any flow case with waves at 0 gave the highest means and sd this tests reduce some of the uncertainties associated with the effect of the onset flow on a tidal stream turbine 5 conclusions the work reported results from basin testing of a 1 15 scale horizontal axis tidal turbine in oblique currents and waves at flowave to the knowledge of the authors the tests are the first of their kind the flow characterisation for the current only cases showed some flow velocity spatial variation across the rotor area it was decided to use all the measurement points taken within the rotor area to give a better representation of the flow the case with flow at 10 yaw had the highest cp values followed by 0 and 20 similar findings are reported by frost 2016 this counterintuitive trend could be related to the significant velocity variations in the onset flow the velocity value used in the computation of cp and ct are based on the nine measurement points across the rotor but a higher number of points within the rotor area would yield a more accurate representation of the onset flow which could have consequences on power coefficient values these results show the importance of onset flow characterisation for turbine performance assessment the ct at 10 showed the expected trend where the thrust coefficient decreases with flow angle the presence of waves especially at 0 incidence to the turbine axis leads to sd values for torque and thrust which are almost double those associated with current only this would have a detrimental impact for fatigue loading the mean values of the torque and thrust are however hardly affect by waves compared to current only conditions unlike the flow with yaw angles of 0 and 10 20 yawed current in combination with waves at 0 show an increase in the ct and cp with wave period once again this trend should be treated with caution given the importance and uncertainties associated with the onset flow velocity used in the power and thrust coefficients calculations in the frequency analysis the peaks in s c t and s c p associated with waves at 45 and 315 have similar magnitude which is consistent with the fact that these two wave directions are symmetrical with respect to the rotor axis the peaks associated with the waves at 0 have the highest magnitude compared to all the other wave angles the peaks associated with waves at 135 have the lowest magnitude the different parameters used to test the turbine covered a wide range of cases which could be found in the ocean and which to the authors knowledge had not been tested at scale previously the findings presented herein provide original and important elements for considerations in the design process of tidal turbine the spectral analysis of loads could be a key input for turbine components design and specifications with a better understanding of the frequency distribution of loads safety factors could be reduced and the turbine structure can be designed to ensure that no vibration mode corresponds to significant load frequencies acknowledgments the first author would like to acknowledge the financial support of consejo nacional de ciencia y tecnología conacyt the authors would like to thank the flowave staff jeff steynor tom davey and martin lennon for their help with the testing this work would not have been possible without the funding from the epsrc via the marine challenge grant ep j010235 1 x med for the development of the turbine model the experimental data used to create the plots can be downloaded from http dx doi org 10 7488 ds 2360 
23174,internal gaseous velocity distribution and gas loss are significant and interconnected mechanisms of ventilated supercavitating flows considering gas vapor water momentum interactions and vapor water mass transport a multi fluid model has been established for high speed ventilated supercavitating flows based on the model the velocity distributions in the longitudinal and cross sectional planes are analyzed to clearly reveal the gas loss mechanism for the flows around cavitator and body for the former two vortex cores are formed in the longitudinal plane and are symmetrically distributed about the longitudinal axis most inner regions in the cavity cross section are occupied by circulation flows when passing the vortex center the direction of the velocity changes and the component in the radial direction increases the gas departs to wake flows in the outermost regions close to the section boundary the velocity distribution law in a characteristic cross section through vortex cores does not depend on cavitation number for the supercavitating body there is a similar entrainment mechanism and multiple axisymmetrical vortices may be distributed inside the cavity the velocity distributions go through turning points in the characteristic sections covering the inner body whereas the distribution has a monotonic trend in the section without the inner body near the body tail the tail pressure gradient influences velocity differences in the inner regions of the sections close to the supercavity tails at different cavitation numbers using computations of the flows at different reynolds and cavitation numbers the dependence of gas loss on reynolds number is also presented keywords ventilated supercavitating flows multi fluid model velocity distribution gas loss 1 introduction improved theories and technologies of ventilated supercavitating flows will accelerate the development of underwater high speed vehicles subsequent to observations of drag reduction due to supercavitation significant advances have been made in understanding the formation stability and hydrodynamic forces of supercavitating flows stinebring et al 2002 kirschner et al 2001 lindau and kunz 2004 lu et al 2007 wei et al 2007 zou and liu 2015a only a few studies have focused on internal flow structures of ventilated supercavitating flows kinzel et al 2009 savchenko and savchenko 2012 flow velocity distribution inside high speed supercavity remains to be studied further and those distribution laws determine the gas loss mechanisms closely related to the stability paryshev 2003 and control zou and liu 2015b of flows around vehicles by and large there are two gas loss regimes i e two vortex tubes and toroidal vortices which were experimentally well observed by epstein 1973 and research developments were discussed by zou and liu 2015b although two vortex tubes are often found in water tunnels with small froude numbers kawakami and arndt 2011 the toroidal vortex mode usually dominates gases departing from ventilated supercavities at high froude numbers caused by high speeds in unbounded flows the transition modes between the two mechanisms were further revealed by karn et al 2015 2016 using water tunnel experiments epstein s entrainment model has been widely accepted for vortex tubes epstein 1961 in the case of the toroidal vortex mode focused on here a reentrant jet occurs in the supercavity s tail under the action of the adverse pressure gradient where the gas liquid mediums collide to form foam structures some of the foams fill the cavity end and the others leave with non condensable gas along the cavity wall in the form of toroidal vortices wang et al 2015 logvinovich 1969 modeled this gas loss using a dimensional analysis method when gravity effect is not considered the model is suitable for the case that cavitation number without the action of ventilation approached natural one further the gas entrainment theoretical assumption made by spurk 2002a has been experimentally confirmed savchenko and savchenko 2012 based on the homogenous multiphase model a local gas entrainment rate was defined by kinzel et al 2009 to show internal gaseous streamlines for ventilated supercavitating flows and a similar gas loss mode also applies to the main structure of the supercavity with two vortex tubes the escaped gas finally occupies the entirety of the cross sections of the vortex tubes considering momentum interactions and mass transport between phases the gas vapor water multi fluid model which is based on the theory for nonhomogeneous multiphase flows is established for ventilated supercavitating flows in the cfd solver cfx because each phase is respectively solved in the model ventilated supercavitating flows at high speeds can be simulated to directly determine the internal gaseous velocity field the velocity distributions were analyzed to clearly reveal the gas loss mechanisms in the longitudinal and cross sectional planes by simulating the flows at different reynolds and cavitation numbers the dependence of gas loss on reynolds number was obtained the analyses of the internal velocity field and gas loss law aid in deepening the understanding of the gas leakage mechanism for the dynamics model of the maneuvering ventilated supercavity zou et al 2016 and can provide greater detail for models and methods used to control supercavitating flows yu et al 2013 zou and liu 2015b 2 multi fluid model and numerical method in a ventilated supercavitating flow there is an obvious gas liquid phase interface except in the tail closure region the flows inside and outside the cavity differ fundamentally and interact among each other yu et al 2010 xiang et al 2011 flow interactions in different phases are inevitable and can be considered sequentially kunz et al 2003 such that the two fluid model is suitable for describing ventilated supercavitating flows yu et al 2012 alongside microbubble boundary layer flows to achieve drag reduction using bubble dynamics and the mass transport mechanism kunz et al 2007 however flow parameters may be more complex in unsteady flows and natural cavitation can occur when liquid pressures drop below saturated vapor pressure taking into further account the vaporization effect in high speed flows a gas vapor water multi fluid model is developed for the flows here 2 1 governing equations based on the theory of nonhomogeneous multiphase flows the governing equations consist of the continuity and momentum equations of each phase and the volume conservation and pressure constraint equations if supercavitating flows are considered to be approximately isothermal momentum transports between phases depend on the interphase contact area according to actual flow states the mixture models are applied to the interfacial transfers between water and vapor and between gas and vapor the free surface model is applied between gas and water the rayleigh plesset equation provides the basis for the mass sources control of vapor generation and condensation the respective continuity equations for each phase are 1 γ w ρ w t γ w ρ w u w m m 2 γ v ρ v t γ v ρ v u v m m 3 γ g ρ g t γ g ρ g u g 0 where γ ρ and u are the volume fraction density and velocity respectively m and m are the mass transfer rates of condensation and vaporization and subscripts w v and g denote the water vapor and gas phases respectively the momentum equations for the three phases are 4 γ w ρ w u w t γ w ρ w u w u w γ w p w γ w μ w u w u w t γ w v u v γ v w u w γ w ρ w g m w 5 γ v ρ v u v t γ v ρ v u v u v γ v p v γ v μ v u v u v t γ v w u w γ w v u v γ v ρ v g m v 6 γ g ρ g u g t γ g ρ g u g u g γ g p g γ g μ g u g u g t γ g ρ g g m g where p and μ are the pressure and dynamic viscosity respectively γ α β u β γ β α u α is the momentum transfer of phase α induced by the mass transfer between phases α and β and g is the gravitational acceleration m is the interfacial force due to the presence of other phases 7 m α α β c d p ρ α β a α β u β u α u β u α where m α is the interfacial force acting on phase α c d p is the drag coefficient between two different phases ρ α β is the mixture density ρ α β γ α ρ α γ β ρ β a α β is the interfacial area per unit volume where a α β 2 γ α γ β γ α γ β for the free surface model and a α β γ α γ β d α β for the mixture model and d α β is the mixture length scale combining the phase continuity equations with the constraint condition on the phase volume fractions γ w γ v γ g 1 the volume conservation equation yields 8 α 1 ρ α γ α ρ α t γ α ρ α u α α 1 ρ α s ms α β 1 n p γ α β where s m s α is the mass source of phase α γ α β is the mass flow rate from phases β to α per unit volume and n p is the phase number to close the set of hydrodynamic equations the constraints on pressure are given in the following form whereby all of the phases share the same pressure field 9 p a p α 1 n p 2 2 turbulence model the shear stress transport sst model based on k ω menter 1994 accounts for the transport of the turbulent shear stress and gives reasonably good predictions of the onset and amounts of flow separation under adverse pressure gradients the model is suitable for simulating ventilated supercavitating flows and for analyzing gas entrainment yu et al 2010 the model uses the k ω model in the near wall region and the k ε model in the free stream i e it combines the best of the two models where the ω equation is different from that of the standard k ε model grids are clustered at the wall to guarantee a range of 0 y 30 for the separated flows when the sst model is used based on the grid spacing near the wall the switch between a wall function formulation and a low reynolds number form is made 10 ρ k t ρ k u μ μ t σ k 3 k p k β ρ k ω p k b 11 ρ ω t ρ ω u μ μ t σ ω 3 ω α 3 ω k p k β 3 ρ ω 2 2 ρ 1 f 1 σ ω 2 ω k ω p ω b where μ t is formulated as μ t α 1 ρ k max α 1 ω s f 2 the model constants are obtained by weighting the two k ε and k ω models owis and nayfeh 2003 12 ϕ f 1 ϕ 1 1 f 1 ϕ 2 where ϕ 1 and ϕ 2 are the constants of the k ω wilcox model wilcox 1988 and the k ε jones launder model jones and launder 1973 respectively and can be written as follows 13 β 0 09 α 1 5 9 β 1 0 075 σ k 1 2 σ ω 1 2 α 2 0 44 β 2 0 0828 σ k 2 1 σ ω 2 1 0 856 based on the distance to the nearest surface and the flow variables the blending functions f 1 and f 2 are 14 f 1 tanh arg 1 4 f 2 tanh arg 2 2 15 arg 1 min max k β ω y 500 ν y 2 ω 4 ρ k c d k w σ ω 2 y 2 c d k ω max 2 ρ 1 σ ω 2 ω k ω 1 0 10 10 16 arg 2 max 2 k β ω y 500 ν y 2 ω 2 3 cavitation model natural cavitation also occur in ventilated supercavitating flows at high speeds if the water pressure drops below the saturated vapor pressure so the vapor water mass conversion needs to be considered in the governing equations the cavitation model which is developed on the basis of the mass transfer has been widely used the mass sources bakir et al 2004 are modeled to represent the vaporization and condensation between vapor and liquid in the continuity equations 17 m f v 3 γ n u c 1 γ v ρ v r n u c 2 p v p ρ w m f c 3 γ v ρ v r n u c 2 p v p 3 ρ w where γ nuc and r n u c are the volume fraction and the radius of the nucleation site respectively γ n u c 5 10 4 and r n u c 1 10 6 m f v and f e are the empirical factors of vaporization and condensation respectively f v 50 and f c 0 01 2 4 numerical method the fully implicit coupled solution method is applied to solve the continuity momentum and volume conservation equations simultaneously and the turbulence equations are then solved the transient term is discretized using a second order backward euler scheme in the governing equations and the convection and diffusive terms are approximated by the high resolution and second order central difference schemes respectively 3 model validations the multi fluid model needs to be validated before numerical simulations are carried out to study ventilated supercavitating flows to demonstrate the model s validity and universality the flows simulated in a water tunnel and unbounded flows based on the model were used to represent low and high speed flows respectively gravity plays a key role in the deformation of a supercavity to form the entrainment mechanism of vortex tubes in a water tunnel whereas reynolds number influences the gas leakage of a supercavity for high speed unbounded flows by changing the shear layer thickness on the cavity wall and the relationship is also restrained by cavitation number the numerical and experimental results were compared for both cases the dimensions of the body model shown in fig 1 a were cavitator diameter d n 0 01 m body diameter d b 0 015 m and body length l b 0 60 m the distance between the inlet and cavitator was 0 40 m the computational domain in fig 1 c was set to 0 19 m 0 19 m 1 00 m for the water tunnel at the st anthony falls laboratory kawakami and arndt 2011 as shown in fig 1 d the size of the unbounded flow was 0 114 m 0 760 m under a free slip circular outer wall condition and the body model size used for high froude number was one tenth the model size dzielski and kurdila 2003 structured hexahedral grids that were non uniformly distributed throughout the flow fields were used several computational meshes were tested to undertake grid independent validations by simulating the longitudinal pressure distributions inside the supercavities in fig 2 in the figure x is the non dimensional cavity axial length x x d n p c is the non dimensional internal pressure p c p c p f p f is the average incoming flow pressure measured at a distance of 16 d n in front of the cavitator and m denotes million the maximum solution differences between the selected medium meshes and the fine meshes did not exceed 0 03 and the grid2 results were then applied in the numerical simulations the supercavitating flows in the water tunnel were simulated under the influences of gravity at the minimum cavitation numbers zou et al 2013 where the supercavity shapes did not change as ventilation increased at a given froude number due to the wall effect the numerical and experimental results for the supercavity shapes and cavitation numbers were close as shown in fig 3 the incoming flow velocity v is changed to obtain cavitation numbers and the corresponding supercavitating flows at different froude numbers under the condition of constant ventilation in the simulations which is the same as the experimental process kawakami 2010 in the figure h d is the blockage ratio of the water tunnel such that h d d 0 d n and d 0 is the equivalent diameter of the water tunnel fr is the froude number fr v g d n σ c m is the minimum cavitation number and σ c e and σ c n are its experimental and numerical values respectively q i n is the ventilation coefficient q i n q i n v d n 2 q i n is the ventilation rate furthermore high speed supercavitating flows in unbounded flows were simulated to obtain their characteristic dimensions under different cavitation numbers as shown in fig 4 these results were compared with some classic solutions from experiments and the empirical model in eq 18 savchenko et al 1999 the theoretical model in eq 19 garabedian 1956 and the supercavity dynamics model serebryakov 2009 zou et al 2016 fig 5 shows that they were in good agreement 18 d c 3 659 0 761 σ c l c 0 5 4 0 3 595 σ c 19 d c c d σ c l c c d σ c ln 1 σ c σ c is the cavitation number l c and d c are two dimensionless parameters i e length and maximum diameter d c d c d n l c l c d n and c d is the drag coefficient of cavitator 4 results and discussion for supercavitating flows there are four main scaling parameters that are based on the theorem of dimensional analysis theory i e cavitation number σ c froude number fr reynolds number re and weber number w e the effects of gravity are limited because of the large froude numbers in the high speed state whereas in cases of large scale problems the weber numbers are far larger than 1 so that the surface tension forces also do not need to be considered at high speeds flows are mainly characterized by cavitation number and reynolds number for that reason numerical simulations were performed to detailedly determine the gaseous velocity distributions inside the flows at different reynolds and cavitation numbers using the model in fig 1 d which is based on the multiple fluid model the dependence of gas loss quantity on reynolds number is then examined 4 1 gas velocity distribution high speed ventilated supercavitating flows around a cavitator were first simulated to show that the noncondensable gas almost fills the entire interior space as supercavitation eventually and steadily forms two vortex cores appeared in the longitudinal axisymmetrical plane and were symmetric about the longitudinal axis as shown in fig 6 a the characteristic cross section s v which passes the vortex cores was selected to reveal the flow velocity as shown in fig 6 b where v and r are the nondimensional gas velocity and the nondimensional radial displacement respectively v v v r r r max and r max is the cavity radius it can be seen that the backflows occurred in the innermost regions of the section i e the internal flow was oppositely directed to the incoming flows and the gas near the cavity wall flowed downstream under the action of wall viscous forces the velocity dropped to zero with the increase in radial displacement and then steadily climbed to the external flow velocity on the cavity surface moreover the velocity distributions were almost independent of cavitation number for the supercavitating body the internal flow was more complicated because of the enveloped body as shown in fig 7 a there were multi pairs of symmetrical vortex cores about the longitudinal axis inside the supercavity in addition to that in region a near the ventilation wrist where the complex head geometry was prone to some vortex structures the structures were the results of the interactions of the viscous forces on the surfaces of the body and cavity in region b in the case of region c they are attributed to the interactions of the viscous force on the cavity wall and the adverse pressure gradient in the flows closure zone several characteristic cross sections s i i 1 8 were selected to reveal the gas velocity distributions and the gas entrainment mechanism in fig 7 b where s i i 3 6 were the sections passing the vortex cores most of the internal gas also flowed in the opposite direction of the incoming flows and some gas departed to the wake flows in a relative thin region near the cavity wall furthermore the velocity distributions were simulated in the characteristic sections for supercavitating flows at different cavitation numbers because each section was almost symmetrical the upper halves of the sections were taken as the research objects the ventilation effect on cavitation number was weakened at high speeds a trend that was more obvious with increasing ventilation vlasenko 2003 and the cavitation number therefore did not change much for ventilation coefficients ranging from 0 0783 to 0 3916 at a reynolds number of re 3 4059 10 5 in fig 8 the velocity distributions were generally consistent and there were inflection points on the velocity curves due to the interactions of the viscous forces on the inner body and cavity wall in sections s 3 and s 4 the velocity distribution for section s 5 showed a monotonic trend in the absence of an inner body the pressure gradient in the cavity tail impacted the central velocity field in section s 6 increasing the velocity differences in the inner regions of the sections under different cavitation number conditions and the effect increased with increasing cavitation number the gas speed on the cavity surface was approximately equal to the speed value of v 1 σ c which is consistent with the classical potential supercavitating flow theory 4 2 gas loss law given the above discussion of the velocity distributions the gas departed to wake flows along the cavity wall for supercavitating flows at high speeds whether in the presence or absence of inner body the gas leakage mechanisms were in agreement with spurk s assumption that gas entrainment occurs in the inner boundary layer of the cavity surface similar to that for a layer formed on a rigid wall however the cavity wall at which the momentum exchange between gas and water certainly occurred was insufficiently smooth and there were radial disturbances that could be filmed using a high speed camera operating at 1000 frames per second savchenko and savchenko 2012 water vapor mass transport can also occur when the local pressure is below the saturated vapor pressure just the same as the cavity boundary defined by the gas volume fraction α g in numerical simulations it is not difficult to understand that inner and outer boundary layers exist in reality and both become passageways through which gas exits however spurk 2002a also formulated a concise gas loss model using dimensional analysis such that problems induced by the gas entrainment assumption could be eliminated the model has been experimentally validated for supercavitating flows at high froude number using the following form 20 q o u t c g 1 σ c σ c 1 σ c ln 1 σ c where q o u t is the gas entrainment coefficient q o u t q o u t v d n 2 c d 0 q o u t is the gas entrainment rate c d 0 is the drag coefficient at zero cavitation number c g is the unknown model coefficient which is certainly related to reynolds number in varying degrees i e c g f re based on the experimental observation at re 5 35 10 5 c g was determined to be 0 013 in addition it is important to note that the high motion speed influenced gas loss by restricting ventilation cavitation number from another level from eq 20 it can be seen that gas loss depends on cavitation and reynolds numbers the relationship between gas loss and cavitation number has been determined quantitatively but the dependence on reynolds number remains unknown obviously the use of the developed multi fluid model is a cost effective way to study the effects of reynolds number before numerical analyses the model must be further validated to perform gas loss calculations for unbounded supercavitating flows at high speeds to enable comparisons with the experimental verification results the flow condition was fixed at a reynolds number of re 0 535 10 6 the gas velocity distributions in the closure regions were analyzed for flows at different cavitation numbers as shown in fig 9 and the gas loss rate was calculated via eq 21 21 q out v g s t where v g is the area weighted average gas velocity in the closure region v g s t v g d s s t v g is the gas velocity and s t is the closure area gas entrainment coefficients are calculated at different cavitation numbers in fig 10 by averaging the coefficients the numerical coefficient for spurk model was determined to be c g 0 0134 very close to the theoretical value 0 0130 substituting the value into eq 20 the analytic solution is obtained after numerical averaging the figure shows that numerical and theoretical results were consistent within acceptable limits and that experimental data spurk 2002b support the comparisons on the whole it follows that the multi fluid model could be effectively used to analyze the gas losses in this study so further according to the results in fig 11 the amounts of gas leakage and the coefficients were both found to decrease with increasing reynolds number for a given cavitation number 5 conclusions a gas vapor water multi fluid model was developed for high speed ventilated supercavitating flows within the framework of nonhomogeneous multiphase flow theory based on the model the internal flow velocity fields were determined for flows around a disk cavitator and a body respectively for the former two vortex cores were symmetrically distributed in the longitudinal symmetrical plane the gas velocity distribution in the characteristic cross section was shown to be independent of cavitation number circulation flows filled the most inner regions of the section where the velocity was in the opposite direction of the incoming flows and decreased along the radial direction the vortex center was the turning point through which the velocity changed direction and increases with increasing radial distance gas moved downstream in the small outer regions of the section for the supercavitating body there were multiple internal vortex structures near the tails of the supercavity and the body due to the viscous forces on the surfaces of the body and cavity wall and the adverse pressure gradient in the closure region the velocity experienced an inflection point due to the interactions of the viscous forces on the inner body and the cavity wall in the characteristic cross sections with the inner body whereas the velocity monotonically changed in the section closely following the body tail the pressure gradient increased the velocity differences in the inner region of the section near the supercavity tail at different cavitation numbers the difference increased with cavitation number the gas loss mechanism was similar to that of the supercavitating flows around a disk cavitator given this understanding the relationship between gas loss and reynolds number was presented from calculations of the flows for different cavitation and reynolds numbers ranges and it was found that the gas leakage decreased with increasing reynolds number for a given cavitation number this study deepens our understanding of the gas loss mechanisms of ventilated supercavities at high speeds and contributes to further perfecting the dynamics model of maneuvering ventilated supercavities and the control algorithm or method used for flows in our works further studies are needed on the effects of flow and body parameters on internal structure to lay a foundation for focusing on flow structures and gas entrainment mechanisms in the supercavitating flows with maneuvering motions acknowledgments this work is supported by the director fund project of key laboratory of hydrodynamics ministry of education and the innovative special project of numerical tank of the ministry of industry and information technology of china 
23174,internal gaseous velocity distribution and gas loss are significant and interconnected mechanisms of ventilated supercavitating flows considering gas vapor water momentum interactions and vapor water mass transport a multi fluid model has been established for high speed ventilated supercavitating flows based on the model the velocity distributions in the longitudinal and cross sectional planes are analyzed to clearly reveal the gas loss mechanism for the flows around cavitator and body for the former two vortex cores are formed in the longitudinal plane and are symmetrically distributed about the longitudinal axis most inner regions in the cavity cross section are occupied by circulation flows when passing the vortex center the direction of the velocity changes and the component in the radial direction increases the gas departs to wake flows in the outermost regions close to the section boundary the velocity distribution law in a characteristic cross section through vortex cores does not depend on cavitation number for the supercavitating body there is a similar entrainment mechanism and multiple axisymmetrical vortices may be distributed inside the cavity the velocity distributions go through turning points in the characteristic sections covering the inner body whereas the distribution has a monotonic trend in the section without the inner body near the body tail the tail pressure gradient influences velocity differences in the inner regions of the sections close to the supercavity tails at different cavitation numbers using computations of the flows at different reynolds and cavitation numbers the dependence of gas loss on reynolds number is also presented keywords ventilated supercavitating flows multi fluid model velocity distribution gas loss 1 introduction improved theories and technologies of ventilated supercavitating flows will accelerate the development of underwater high speed vehicles subsequent to observations of drag reduction due to supercavitation significant advances have been made in understanding the formation stability and hydrodynamic forces of supercavitating flows stinebring et al 2002 kirschner et al 2001 lindau and kunz 2004 lu et al 2007 wei et al 2007 zou and liu 2015a only a few studies have focused on internal flow structures of ventilated supercavitating flows kinzel et al 2009 savchenko and savchenko 2012 flow velocity distribution inside high speed supercavity remains to be studied further and those distribution laws determine the gas loss mechanisms closely related to the stability paryshev 2003 and control zou and liu 2015b of flows around vehicles by and large there are two gas loss regimes i e two vortex tubes and toroidal vortices which were experimentally well observed by epstein 1973 and research developments were discussed by zou and liu 2015b although two vortex tubes are often found in water tunnels with small froude numbers kawakami and arndt 2011 the toroidal vortex mode usually dominates gases departing from ventilated supercavities at high froude numbers caused by high speeds in unbounded flows the transition modes between the two mechanisms were further revealed by karn et al 2015 2016 using water tunnel experiments epstein s entrainment model has been widely accepted for vortex tubes epstein 1961 in the case of the toroidal vortex mode focused on here a reentrant jet occurs in the supercavity s tail under the action of the adverse pressure gradient where the gas liquid mediums collide to form foam structures some of the foams fill the cavity end and the others leave with non condensable gas along the cavity wall in the form of toroidal vortices wang et al 2015 logvinovich 1969 modeled this gas loss using a dimensional analysis method when gravity effect is not considered the model is suitable for the case that cavitation number without the action of ventilation approached natural one further the gas entrainment theoretical assumption made by spurk 2002a has been experimentally confirmed savchenko and savchenko 2012 based on the homogenous multiphase model a local gas entrainment rate was defined by kinzel et al 2009 to show internal gaseous streamlines for ventilated supercavitating flows and a similar gas loss mode also applies to the main structure of the supercavity with two vortex tubes the escaped gas finally occupies the entirety of the cross sections of the vortex tubes considering momentum interactions and mass transport between phases the gas vapor water multi fluid model which is based on the theory for nonhomogeneous multiphase flows is established for ventilated supercavitating flows in the cfd solver cfx because each phase is respectively solved in the model ventilated supercavitating flows at high speeds can be simulated to directly determine the internal gaseous velocity field the velocity distributions were analyzed to clearly reveal the gas loss mechanisms in the longitudinal and cross sectional planes by simulating the flows at different reynolds and cavitation numbers the dependence of gas loss on reynolds number was obtained the analyses of the internal velocity field and gas loss law aid in deepening the understanding of the gas leakage mechanism for the dynamics model of the maneuvering ventilated supercavity zou et al 2016 and can provide greater detail for models and methods used to control supercavitating flows yu et al 2013 zou and liu 2015b 2 multi fluid model and numerical method in a ventilated supercavitating flow there is an obvious gas liquid phase interface except in the tail closure region the flows inside and outside the cavity differ fundamentally and interact among each other yu et al 2010 xiang et al 2011 flow interactions in different phases are inevitable and can be considered sequentially kunz et al 2003 such that the two fluid model is suitable for describing ventilated supercavitating flows yu et al 2012 alongside microbubble boundary layer flows to achieve drag reduction using bubble dynamics and the mass transport mechanism kunz et al 2007 however flow parameters may be more complex in unsteady flows and natural cavitation can occur when liquid pressures drop below saturated vapor pressure taking into further account the vaporization effect in high speed flows a gas vapor water multi fluid model is developed for the flows here 2 1 governing equations based on the theory of nonhomogeneous multiphase flows the governing equations consist of the continuity and momentum equations of each phase and the volume conservation and pressure constraint equations if supercavitating flows are considered to be approximately isothermal momentum transports between phases depend on the interphase contact area according to actual flow states the mixture models are applied to the interfacial transfers between water and vapor and between gas and vapor the free surface model is applied between gas and water the rayleigh plesset equation provides the basis for the mass sources control of vapor generation and condensation the respective continuity equations for each phase are 1 γ w ρ w t γ w ρ w u w m m 2 γ v ρ v t γ v ρ v u v m m 3 γ g ρ g t γ g ρ g u g 0 where γ ρ and u are the volume fraction density and velocity respectively m and m are the mass transfer rates of condensation and vaporization and subscripts w v and g denote the water vapor and gas phases respectively the momentum equations for the three phases are 4 γ w ρ w u w t γ w ρ w u w u w γ w p w γ w μ w u w u w t γ w v u v γ v w u w γ w ρ w g m w 5 γ v ρ v u v t γ v ρ v u v u v γ v p v γ v μ v u v u v t γ v w u w γ w v u v γ v ρ v g m v 6 γ g ρ g u g t γ g ρ g u g u g γ g p g γ g μ g u g u g t γ g ρ g g m g where p and μ are the pressure and dynamic viscosity respectively γ α β u β γ β α u α is the momentum transfer of phase α induced by the mass transfer between phases α and β and g is the gravitational acceleration m is the interfacial force due to the presence of other phases 7 m α α β c d p ρ α β a α β u β u α u β u α where m α is the interfacial force acting on phase α c d p is the drag coefficient between two different phases ρ α β is the mixture density ρ α β γ α ρ α γ β ρ β a α β is the interfacial area per unit volume where a α β 2 γ α γ β γ α γ β for the free surface model and a α β γ α γ β d α β for the mixture model and d α β is the mixture length scale combining the phase continuity equations with the constraint condition on the phase volume fractions γ w γ v γ g 1 the volume conservation equation yields 8 α 1 ρ α γ α ρ α t γ α ρ α u α α 1 ρ α s ms α β 1 n p γ α β where s m s α is the mass source of phase α γ α β is the mass flow rate from phases β to α per unit volume and n p is the phase number to close the set of hydrodynamic equations the constraints on pressure are given in the following form whereby all of the phases share the same pressure field 9 p a p α 1 n p 2 2 turbulence model the shear stress transport sst model based on k ω menter 1994 accounts for the transport of the turbulent shear stress and gives reasonably good predictions of the onset and amounts of flow separation under adverse pressure gradients the model is suitable for simulating ventilated supercavitating flows and for analyzing gas entrainment yu et al 2010 the model uses the k ω model in the near wall region and the k ε model in the free stream i e it combines the best of the two models where the ω equation is different from that of the standard k ε model grids are clustered at the wall to guarantee a range of 0 y 30 for the separated flows when the sst model is used based on the grid spacing near the wall the switch between a wall function formulation and a low reynolds number form is made 10 ρ k t ρ k u μ μ t σ k 3 k p k β ρ k ω p k b 11 ρ ω t ρ ω u μ μ t σ ω 3 ω α 3 ω k p k β 3 ρ ω 2 2 ρ 1 f 1 σ ω 2 ω k ω p ω b where μ t is formulated as μ t α 1 ρ k max α 1 ω s f 2 the model constants are obtained by weighting the two k ε and k ω models owis and nayfeh 2003 12 ϕ f 1 ϕ 1 1 f 1 ϕ 2 where ϕ 1 and ϕ 2 are the constants of the k ω wilcox model wilcox 1988 and the k ε jones launder model jones and launder 1973 respectively and can be written as follows 13 β 0 09 α 1 5 9 β 1 0 075 σ k 1 2 σ ω 1 2 α 2 0 44 β 2 0 0828 σ k 2 1 σ ω 2 1 0 856 based on the distance to the nearest surface and the flow variables the blending functions f 1 and f 2 are 14 f 1 tanh arg 1 4 f 2 tanh arg 2 2 15 arg 1 min max k β ω y 500 ν y 2 ω 4 ρ k c d k w σ ω 2 y 2 c d k ω max 2 ρ 1 σ ω 2 ω k ω 1 0 10 10 16 arg 2 max 2 k β ω y 500 ν y 2 ω 2 3 cavitation model natural cavitation also occur in ventilated supercavitating flows at high speeds if the water pressure drops below the saturated vapor pressure so the vapor water mass conversion needs to be considered in the governing equations the cavitation model which is developed on the basis of the mass transfer has been widely used the mass sources bakir et al 2004 are modeled to represent the vaporization and condensation between vapor and liquid in the continuity equations 17 m f v 3 γ n u c 1 γ v ρ v r n u c 2 p v p ρ w m f c 3 γ v ρ v r n u c 2 p v p 3 ρ w where γ nuc and r n u c are the volume fraction and the radius of the nucleation site respectively γ n u c 5 10 4 and r n u c 1 10 6 m f v and f e are the empirical factors of vaporization and condensation respectively f v 50 and f c 0 01 2 4 numerical method the fully implicit coupled solution method is applied to solve the continuity momentum and volume conservation equations simultaneously and the turbulence equations are then solved the transient term is discretized using a second order backward euler scheme in the governing equations and the convection and diffusive terms are approximated by the high resolution and second order central difference schemes respectively 3 model validations the multi fluid model needs to be validated before numerical simulations are carried out to study ventilated supercavitating flows to demonstrate the model s validity and universality the flows simulated in a water tunnel and unbounded flows based on the model were used to represent low and high speed flows respectively gravity plays a key role in the deformation of a supercavity to form the entrainment mechanism of vortex tubes in a water tunnel whereas reynolds number influences the gas leakage of a supercavity for high speed unbounded flows by changing the shear layer thickness on the cavity wall and the relationship is also restrained by cavitation number the numerical and experimental results were compared for both cases the dimensions of the body model shown in fig 1 a were cavitator diameter d n 0 01 m body diameter d b 0 015 m and body length l b 0 60 m the distance between the inlet and cavitator was 0 40 m the computational domain in fig 1 c was set to 0 19 m 0 19 m 1 00 m for the water tunnel at the st anthony falls laboratory kawakami and arndt 2011 as shown in fig 1 d the size of the unbounded flow was 0 114 m 0 760 m under a free slip circular outer wall condition and the body model size used for high froude number was one tenth the model size dzielski and kurdila 2003 structured hexahedral grids that were non uniformly distributed throughout the flow fields were used several computational meshes were tested to undertake grid independent validations by simulating the longitudinal pressure distributions inside the supercavities in fig 2 in the figure x is the non dimensional cavity axial length x x d n p c is the non dimensional internal pressure p c p c p f p f is the average incoming flow pressure measured at a distance of 16 d n in front of the cavitator and m denotes million the maximum solution differences between the selected medium meshes and the fine meshes did not exceed 0 03 and the grid2 results were then applied in the numerical simulations the supercavitating flows in the water tunnel were simulated under the influences of gravity at the minimum cavitation numbers zou et al 2013 where the supercavity shapes did not change as ventilation increased at a given froude number due to the wall effect the numerical and experimental results for the supercavity shapes and cavitation numbers were close as shown in fig 3 the incoming flow velocity v is changed to obtain cavitation numbers and the corresponding supercavitating flows at different froude numbers under the condition of constant ventilation in the simulations which is the same as the experimental process kawakami 2010 in the figure h d is the blockage ratio of the water tunnel such that h d d 0 d n and d 0 is the equivalent diameter of the water tunnel fr is the froude number fr v g d n σ c m is the minimum cavitation number and σ c e and σ c n are its experimental and numerical values respectively q i n is the ventilation coefficient q i n q i n v d n 2 q i n is the ventilation rate furthermore high speed supercavitating flows in unbounded flows were simulated to obtain their characteristic dimensions under different cavitation numbers as shown in fig 4 these results were compared with some classic solutions from experiments and the empirical model in eq 18 savchenko et al 1999 the theoretical model in eq 19 garabedian 1956 and the supercavity dynamics model serebryakov 2009 zou et al 2016 fig 5 shows that they were in good agreement 18 d c 3 659 0 761 σ c l c 0 5 4 0 3 595 σ c 19 d c c d σ c l c c d σ c ln 1 σ c σ c is the cavitation number l c and d c are two dimensionless parameters i e length and maximum diameter d c d c d n l c l c d n and c d is the drag coefficient of cavitator 4 results and discussion for supercavitating flows there are four main scaling parameters that are based on the theorem of dimensional analysis theory i e cavitation number σ c froude number fr reynolds number re and weber number w e the effects of gravity are limited because of the large froude numbers in the high speed state whereas in cases of large scale problems the weber numbers are far larger than 1 so that the surface tension forces also do not need to be considered at high speeds flows are mainly characterized by cavitation number and reynolds number for that reason numerical simulations were performed to detailedly determine the gaseous velocity distributions inside the flows at different reynolds and cavitation numbers using the model in fig 1 d which is based on the multiple fluid model the dependence of gas loss quantity on reynolds number is then examined 4 1 gas velocity distribution high speed ventilated supercavitating flows around a cavitator were first simulated to show that the noncondensable gas almost fills the entire interior space as supercavitation eventually and steadily forms two vortex cores appeared in the longitudinal axisymmetrical plane and were symmetric about the longitudinal axis as shown in fig 6 a the characteristic cross section s v which passes the vortex cores was selected to reveal the flow velocity as shown in fig 6 b where v and r are the nondimensional gas velocity and the nondimensional radial displacement respectively v v v r r r max and r max is the cavity radius it can be seen that the backflows occurred in the innermost regions of the section i e the internal flow was oppositely directed to the incoming flows and the gas near the cavity wall flowed downstream under the action of wall viscous forces the velocity dropped to zero with the increase in radial displacement and then steadily climbed to the external flow velocity on the cavity surface moreover the velocity distributions were almost independent of cavitation number for the supercavitating body the internal flow was more complicated because of the enveloped body as shown in fig 7 a there were multi pairs of symmetrical vortex cores about the longitudinal axis inside the supercavity in addition to that in region a near the ventilation wrist where the complex head geometry was prone to some vortex structures the structures were the results of the interactions of the viscous forces on the surfaces of the body and cavity in region b in the case of region c they are attributed to the interactions of the viscous force on the cavity wall and the adverse pressure gradient in the flows closure zone several characteristic cross sections s i i 1 8 were selected to reveal the gas velocity distributions and the gas entrainment mechanism in fig 7 b where s i i 3 6 were the sections passing the vortex cores most of the internal gas also flowed in the opposite direction of the incoming flows and some gas departed to the wake flows in a relative thin region near the cavity wall furthermore the velocity distributions were simulated in the characteristic sections for supercavitating flows at different cavitation numbers because each section was almost symmetrical the upper halves of the sections were taken as the research objects the ventilation effect on cavitation number was weakened at high speeds a trend that was more obvious with increasing ventilation vlasenko 2003 and the cavitation number therefore did not change much for ventilation coefficients ranging from 0 0783 to 0 3916 at a reynolds number of re 3 4059 10 5 in fig 8 the velocity distributions were generally consistent and there were inflection points on the velocity curves due to the interactions of the viscous forces on the inner body and cavity wall in sections s 3 and s 4 the velocity distribution for section s 5 showed a monotonic trend in the absence of an inner body the pressure gradient in the cavity tail impacted the central velocity field in section s 6 increasing the velocity differences in the inner regions of the sections under different cavitation number conditions and the effect increased with increasing cavitation number the gas speed on the cavity surface was approximately equal to the speed value of v 1 σ c which is consistent with the classical potential supercavitating flow theory 4 2 gas loss law given the above discussion of the velocity distributions the gas departed to wake flows along the cavity wall for supercavitating flows at high speeds whether in the presence or absence of inner body the gas leakage mechanisms were in agreement with spurk s assumption that gas entrainment occurs in the inner boundary layer of the cavity surface similar to that for a layer formed on a rigid wall however the cavity wall at which the momentum exchange between gas and water certainly occurred was insufficiently smooth and there were radial disturbances that could be filmed using a high speed camera operating at 1000 frames per second savchenko and savchenko 2012 water vapor mass transport can also occur when the local pressure is below the saturated vapor pressure just the same as the cavity boundary defined by the gas volume fraction α g in numerical simulations it is not difficult to understand that inner and outer boundary layers exist in reality and both become passageways through which gas exits however spurk 2002a also formulated a concise gas loss model using dimensional analysis such that problems induced by the gas entrainment assumption could be eliminated the model has been experimentally validated for supercavitating flows at high froude number using the following form 20 q o u t c g 1 σ c σ c 1 σ c ln 1 σ c where q o u t is the gas entrainment coefficient q o u t q o u t v d n 2 c d 0 q o u t is the gas entrainment rate c d 0 is the drag coefficient at zero cavitation number c g is the unknown model coefficient which is certainly related to reynolds number in varying degrees i e c g f re based on the experimental observation at re 5 35 10 5 c g was determined to be 0 013 in addition it is important to note that the high motion speed influenced gas loss by restricting ventilation cavitation number from another level from eq 20 it can be seen that gas loss depends on cavitation and reynolds numbers the relationship between gas loss and cavitation number has been determined quantitatively but the dependence on reynolds number remains unknown obviously the use of the developed multi fluid model is a cost effective way to study the effects of reynolds number before numerical analyses the model must be further validated to perform gas loss calculations for unbounded supercavitating flows at high speeds to enable comparisons with the experimental verification results the flow condition was fixed at a reynolds number of re 0 535 10 6 the gas velocity distributions in the closure regions were analyzed for flows at different cavitation numbers as shown in fig 9 and the gas loss rate was calculated via eq 21 21 q out v g s t where v g is the area weighted average gas velocity in the closure region v g s t v g d s s t v g is the gas velocity and s t is the closure area gas entrainment coefficients are calculated at different cavitation numbers in fig 10 by averaging the coefficients the numerical coefficient for spurk model was determined to be c g 0 0134 very close to the theoretical value 0 0130 substituting the value into eq 20 the analytic solution is obtained after numerical averaging the figure shows that numerical and theoretical results were consistent within acceptable limits and that experimental data spurk 2002b support the comparisons on the whole it follows that the multi fluid model could be effectively used to analyze the gas losses in this study so further according to the results in fig 11 the amounts of gas leakage and the coefficients were both found to decrease with increasing reynolds number for a given cavitation number 5 conclusions a gas vapor water multi fluid model was developed for high speed ventilated supercavitating flows within the framework of nonhomogeneous multiphase flow theory based on the model the internal flow velocity fields were determined for flows around a disk cavitator and a body respectively for the former two vortex cores were symmetrically distributed in the longitudinal symmetrical plane the gas velocity distribution in the characteristic cross section was shown to be independent of cavitation number circulation flows filled the most inner regions of the section where the velocity was in the opposite direction of the incoming flows and decreased along the radial direction the vortex center was the turning point through which the velocity changed direction and increases with increasing radial distance gas moved downstream in the small outer regions of the section for the supercavitating body there were multiple internal vortex structures near the tails of the supercavity and the body due to the viscous forces on the surfaces of the body and cavity wall and the adverse pressure gradient in the closure region the velocity experienced an inflection point due to the interactions of the viscous forces on the inner body and the cavity wall in the characteristic cross sections with the inner body whereas the velocity monotonically changed in the section closely following the body tail the pressure gradient increased the velocity differences in the inner region of the section near the supercavity tail at different cavitation numbers the difference increased with cavitation number the gas loss mechanism was similar to that of the supercavitating flows around a disk cavitator given this understanding the relationship between gas loss and reynolds number was presented from calculations of the flows for different cavitation and reynolds numbers ranges and it was found that the gas leakage decreased with increasing reynolds number for a given cavitation number this study deepens our understanding of the gas loss mechanisms of ventilated supercavities at high speeds and contributes to further perfecting the dynamics model of maneuvering ventilated supercavities and the control algorithm or method used for flows in our works further studies are needed on the effects of flow and body parameters on internal structure to lay a foundation for focusing on flow structures and gas entrainment mechanisms in the supercavitating flows with maneuvering motions acknowledgments this work is supported by the director fund project of key laboratory of hydrodynamics ministry of education and the innovative special project of numerical tank of the ministry of industry and information technology of china 
