index,text
22800,a new analytical method to calculate the nonlinear correction to the wavemaker motion needed for the accurate generation of steep waves is suggested it is developed taking advantage of the existing models of nonlinear water waves such as zakharov dysthe or schrödinger equations the limitations of the method in terms of the order of nonlinearity and spectral width are determined by the wave model used thus allowing its extension to the 3rd and higher orders beyond the limits of the existing wavemaker theories application of the nonlinear water waves models allowed significant simplification of the procedure of determination of the nonlinear correction to the wavemaker driving signal the suggested method was carefully validated against the theory of schäffer fully nonlinear numerical simulations and wave flume experiments the advantages of the method were exploited to carefully investigate different regimes of wave generation an appreciable deviation of the actual value of the linear transfer function from the theoretical predictions was found in agreement with the earlier experimental investigations the mean current arising at the 2nd order due to finite displacements of the wavemaker surface was suggested as one of the reasons for that deviation keywords wavemaker theory nonlinear wave generation piston paddle nonlinear water waves zakharov equation bound waves 1 introduction laboratory investigation of unidirectional surface gravity water waves in tanks requires generation of wave trains with a certain shape computer controlled wavemakers driven by prescribed signals are used for that purpose the accuracy of generation decreases with wave nonlinearity that is represented by the wave steepness ε ka k and a being the characteristic wave number and the wave amplitude respectively a number of wavemaker theories were developed in order to reduce the deviation of the actually excited in the tank wave shape from the prescribed one for waves with non negligible nonlinearity havelock 1929 barthel et al 1983 madsen 1971 among the factors affecting the accuracy of the reproduction of the desired wave shape evanescent modes dean and dalrymple 1991 play an important role however since these modes vanish fast with the distance from the wavemaker and therefore do not affect waves sufficiently far away they often are disregarded appearance of spurious propagating free modes at frequencies absent in the spectrum of the wavemaker motion was also reported in schäffer 1996 these undesirable waves constitute a significant problem as they contaminate wave field at much longer distances one of the most comprehensive approaches to avoid excitation of the parasitic free waves was suggested by schäffer 1996 and schäffer and steenberg 2003 their theory has no limitations on the width of the wave train spectrum the applicability of the theory was confirmed experimentally for regular waves wave groups and even for irregular wave fields however certain deviations from the theoretical predictions were still observed in the amplitudes as well as in the phases of the measured surface elevation spectra aknin and spinneken 2017 indicating that spurious waves were not completely suppressed it should be stressed that the theory presented by schäffer 1996 is limited to the 2nd order nonlinearities while neglecting higher order effects thus limiting its range of applicability zhang and schäffer 2007 alternative experimental and numerical procedures were therefore developed in order to improve the accuracy of the wave generation force feedback controller system employing impedance matching procedure applicable to generation of a nearly single frequency wave train by a flap type wavemaker was presented by spinneken and swan 2009a 2009b 2012 spinneken et al 2014 in contrast to the 2nd order theory of schäffer spinniken and swan measured all forces acting on the wavemaker board and use them as the feedback for the computer aided wave generation system a significant advantage of the force feedback model is associated with the inherent self correction which allows wave generation and absorption to be performed in parallel by a single wavemaker this feature is particularly important in the presence of immersed or submerged structures in the tank away from the wavemaker that inevitably cause wave reflection from the structure back to the generating boundary further experimental investigation of the force feedback method demonstrated that the inaccuracies are not always associated with the spurious higher order waves significant errors were reported in the spectrum of the 1st order waves generated using the theoretical transfer functions matching the surface elevation amplitude to the displacements of the wavemaker aknin and spinneken 2017 these findings are in agreement with earlier investigations ursell et al 1960 the wave generation technique using the higher order spectral method hosm supplemented with the 2nd order correction based on the theory of schäffer is presented in houtani et al 2018 the accuracy of this method was shown to be superior to the conventional linear approach when the wave steepness the bandwidth of the frequency spectrum or the directional spreading became large in practice the experimental method of the wave basin calibration is often applied masterton and swan 2008 fernández et al 2014 this empirical approach was amended in shemer et al 2007 by application of the spatial version of the zakharov equation zakharov 1968 as a theoretical model to account for the spectral changes during the propagation of the nonlinear wave train along the experimental facility the method was used for the generation of broad banded wave trains adopting iterative corrections of the wavemaker transfer function the iterative procedure correcting the transfer function was improved in buldakov et al 2017 by application of the harmonics separation technique for linearization of the amplitude spectrum it was shown that iterative adjustment based on the linear part of the surface elevation spectrum only noticeably improves the accuracy of the wave generation nevertheless this method was found to be time consuming since it requires four experimental runs with different driving signals to complete a single iteration thus increasing the duration of experiments significantly especially in large experimental facilities a different method of the harmonics separation was studied in khait and shemer 2019 application of the fully nonlinear numerical wave tank allowed minimization of the experimental effort the applicability of the iterative method in deep water conditions was demonstrated however in intermediate and nearly shallow water depth its applicability proved to be limited because of much stronger contamination of the wave field by the spurious waves it is generally accepted that the wavemaker motion correct to the 2nd order is sufficient in most cases for the generation of the steep ε 0 1 up to ε 0 3 nonlinear waves in deep water in intermediate water depth when approaching shallow water conditions the importance of higher order contributions to the wavemaker motion increases strongly that prescribes the limits of applicability of the 2nd order wavemaker theory according to schäffer 1996 zhang and schäffer 2007 eldrup and andersen 2019 we present here an analytical method of wave generation in deep intermediate and nearly shallow water depth that may be considered as an alternative to the theory of schäffer 1996 the suggested method is not restricted to the 2nd order in wave steepness the main difficulty here comes from the need to calculate accurately the velocity field induced by the 2nd and higher order bound waves existing nonlinear water wave models such as zakharov 1968 trulsen and dysthe 1996 nonlinear schrödinger equation mei 1989 onorato et al 2013 chabchoub and fink 2014 or alternative may be used for that purpose as they provide analytic expression for computation of bound waves up to the 4th order in the modified zakharov model stiassnie and shemer 1984 1987 krasitskii 1994 shemer et al 2001 shemer and chernyshova 2017 thus simplifying the computations as compared to schäffer the limitations of the method are stipulated by the selected theoretical model the adopted approach also allows application of the same theoretical model for an accurate determination of the wavemaker motion and for simulation of the evolution of the generated wave train during its propagation away from the wavemaker this approach thus allows selecting the model that is most suitable for the particular problem to enable consistent quantitative comparison of the present results with the theory of schäffer the analysis here is limited to the 2nd order in the wave steepness the accuracy of the wave generation using the suggested method was carefully verified in deep water in a wave flume and in intermediate water depth using a fully nonlinear numerical wave tank based on boundary element method the method allows identifying the sources of wave generation inaccuracies thus resulting in new insight 2 formulation of the method of nonlinear wave generation the types of the wavemaker considered are shown schematically in fig 1 the description of the wavemaker geometry is adopted from schäffer 1996 variation of the hinge location within the range 0 l h h defines a variety of configurations including paddle for l h 0 and piston for l h the motion of the plane wavemaker surface can be presented as x t f z where f z defines the wavemaker shape see fig 1 1 f z 1 z h l h the wavemaker surface at any instant is described by 2 f x z t x x t f z 0 where x is the horizontal coordinate non penetration boundary condition at the wavemaker surface can be expressed dean and dalrymple 1991 as 3 f t v f f 0 0 where v u w is the velocity vector of a fluid particle in 2d domain using 2 3 can be written as 4 u w x t d f z d z u t f z x x 0 where u t dx dt is the velocity of the wavemaker surface at z 0 equation 4 is expanded into the taylor series around the mean location of the wavemaker x 0 limiting the analysis to the 2nd order yields 5 u w x d f z d z u f z x 0 x f z x u w x d f z d z u f z x 0 0 for potential flow the fluid velocity v φ x φ z and 5 can be rewritten as 6 φ x x 0 φ z x d f z d z u f z x f z 2 φ x 2 x 2 f z d f z d z 2 φ z x x 0 assuming ε ka 1 the fluid velocity potential φ describing the field the coordinate x and the wavemaker velocity u can be expanded in series of wave steepness ε as φ εφ 1 ε 2 φ 2 x εx 1 ε 2 x 2 and u εu 1 ε 2 u 2 the boundary condition 6 expresses the equality between the horizontal fluid velocity component φ x and the horizontal wavemaker velocity u for all vertical coordinates z substitution of those expansions into 6 allows decomposition of the wavemaker boundary condition according to the order in ε first order 7 φ 1 x x 0 u 1 t f z second order 8 φ 2 x x 0 u b 2 t f z x 1 φ 1 z d f z d z f z 2 φ 1 x 2 x 0 d the linear term u 1 t f z in 7 represents the wavemaker motion needed for generation of free waves generation of free waves leads to appearance of bound waves at the 2nd and higher orders to reproduce the velocity field of those bound waves by the wavemaker the 2nd order wavemaker motion u b 2 t f z is incorporated in 8 since the vertical distribution of velocity of the propagating 1st and 2nd order waves do not match the wavemaker surface velocity defined by its shape f z the so called evanescent modes appear at different orders dean and dalrymple 1991 thus the horizontal fluid velocity at the wavemaker on the left side of 7 and 8 at each order n can be seen as composed of two contributions 9 φ n x x 0 φ p m n x x 0 j 1 φ e m j n x x 0 where pm and em denote propagating and evanescent waves respectively the term denoted by d in 8 that results from the finite displacement of the wavemaker contributes to the fluid velocity at the 2nd order and causes excitation of unwanted free propagating waves to cancel d introduction of an additional 2nd order correction to the wavemaker motion u d 2 t f z to be determined later is needed the total wavemaker motion accurate to the 2nd order is thus 10 u t u 1 t 1 s t o r d e r u b 2 t u d 2 t 2 n d o r d e r 11 x t u t d t in the present approach the wavemaker motion is modified so that it complies with the velocity profile due to both free and bound waves in water to calculate the actual water velocities at the wavemaker in the presence of nonlinear waves advantage is taken here of the expressions obtained in the course of derivation of the zakharov equation it is expected that this procedure will eliminate spurious propagating waves at the 2nd order 2 1 first order motion of the wavemaker the required shape of the 1st order free propagating wave spectrum is prescribed at the wavemaker location x 0 the contribution of an arbitrary harmonic with the radian frequency ω 1 and complex amplitude a 1 to the surface elevation and to the vertical profile of the horizontal velocity in linear approximation can be presented as dean and dalrymple 1991 12a η p m 1 re a 1 e i k 1 x ω 1 t 12b φ p m 1 x η p m 1 κ 1 cosh k 1 h z 12c κ 1 g k 1 ω 1 cosh k 1 h where k 1 is the wave number related to the angular frequency ω 1 by the dispersion relation 13 ω 2 g k tanh k h g being the acceleration of gravity and h the mean water depth using 9 and 12b the 1st order motion of the wavemaker 7 can be rewritten as 14 u 1 f z κ 1 cosh k 1 h z re a 1 e i ω 1 t p m j 1 φ e m j 1 x explicit expressions for the evanescent modes are given in dean and dalrymple 1991 for our purposes it is only essential that the propagating and the evanescent modes are orthogonal the wavemaker motion can be related to the surface elevation of the propagating wave using transfer function λ 1 15 u 1 t λ 1 re a 1 e i ω 1 t substituting 15 into 14 multiplying both sides of 14 by cosh k 1 h z and integrating over depth yields in view of the orthogonality of pm and em the 1st order transfer function for the propagating wave 16 λ 1 κ 1 k 1 κ 1 h 0 cosh 2 k 1 h z d z h 0 f z cosh k 1 h z d z κ 1 k 1 h l h sinh 2 k 1 h 2 k 1 h 4 1 cosh k 1 h k 1 h l h sinh k 1 h 2 2 second order motion of the wavemaker due to bound waves surface elevation for a single 2nd order propagating bound wave can be expressed as 17a η p m b o u n d 2 re a 2 e i k 2 x ω 2 t the velocity field of each bound wave component 17a can be expressed by dean and dalrymple 1991 17b φ p m b o u n d 2 x η p m b o u n d 2 κ 2 cosh k 2 h z 17c κ 2 3 ω 2 sinh k 2 h 2 cosh k 2 h the amplitude spectrum of bound waves a 2 ω is calculated from the free wave spectrum a 1 ω that is prescribed at x 0 using the theoretical model of zakharov adopted in this study the wave numbers k 2 and the angular frequencies ω 2 of bound waves do not satisfy the linear dispersion relation 13 for every pair of the 1st order harmonics ω m 1 and ω n 1 with complex amplitudes a m 1 and a n 1 three 2nd order bound waves appear with the following frequencies ω j 2 wave numbers k j 2 and complex amplitudes a j 2 stiassnie and shemer 1984 1987 krasitskii 1994 18a ω 1 2 ω m 1 ω n 1 k 1 2 k m 1 k n 1 a 1 2 π 2 g g k 1 2 tanh k 1 2 h ω m 1 ω n 1 v 1 g k 1 2 tanh k 1 2 h ω m 1 ω n 1 k 1 2 k m 1 k n 1 g k 1 2 tanh k 1 2 h ω m 1 ω n 1 a m 1 a n 1 18b ω 2 2 ω m 1 ω n 1 k 2 2 k m 1 k n 1 a 2 2 π 2 g g k 2 2 tanh k 2 2 h ω m 1 ω n 1 v 2 g k 2 2 tanh k 2 2 h ω m 1 ω n 1 k 2 2 k m 1 k n 1 g k 2 2 tanh k 2 2 h ω m 1 ω n 1 a m 1 a n 1 18c ω 3 2 ω m 1 ω n 1 k 3 2 k m 1 k n 1 a 3 2 π 2 g g k 3 2 tanh k 3 2 h ω m 1 ω n 1 v 3 g k 3 2 tanh k 3 2 h ω m 1 ω n 1 k 3 2 k m 1 k n 1 g k 3 2 tanh k 3 2 h ω m 1 ω n 1 a m 1 a n 1 here denotes complex conjugate the coefficients in 18 are given in appendix a similarity of the velocity profiles 12b and 17b indicates that the transfer function for the bound waves may be presented in the form of 16 by replacing the coefficient κ 1 and the wave number k 1 by the corresponding values in 17b c λ 2 λ 1 κ 2 k 2 the wavemaker motion needed to excite in its vicinity the velocity field corresponding to that of the 2nd order bound wave with frequency ω 2 and amplitude a 2 is 19 u b 2 t λ 2 re a 2 e i ω 2 t 2 3 second order correction to wavemaker motion due to its displacement the term d in 8 introduces the 2nd order fluid velocity at the wavemaker 20 φ d 2 x x 0 x 1 φ 1 z d f z d z f z 2 φ 1 x 2 x 0 substitution of the 1st order solutions 12 and 15 into 20 yields 21a φ d 2 x x 0 κ d p z a 1 2 f κ d p z re a 1 2 e i 2 ω 1 t 21b p z sinh k 1 h z k 1 h l h z cosh k 1 h z 21c κ d λ 1 g k 1 2 h l h ω 1 2 cosh k 1 h the effect of the mean current f on the wave field is expected to be small and is neglected as in the linear case the velocity profile of the 2nd order free wave at frequency 2ω 1 does not coincide with that prescribed by the shape function p z see 21b this leads to the addition of superposition of evanescent modes to the free wave see 9 the velocity associated with the 2nd order free wave at the wavemaker is 22 φ p m f r e e 2 x x 0 κ f 2 ω 1 k 2 ω cosh k 2 ω h z re a f e i 2 ω 1 t the value of κ f 2ω 1 k 2ω is defined by 12c the wave number k 2ω k 2ω 1 in 22 is related to the double frequency 2ω 1 by the linear dispersion relation 13 as in the linear case elimination of the evanescent modes allows determination of the 2nd order free wave amplitude 23 a f a 1 2 κ d κ f h 0 p z cosh k 2 ω h z d z h 0 cosh 2 k 2 ω h z d z the 2nd order correction to the wavemaker motion u d 2 t should result in generation of the free wave with the phase shifted by π relative to that of 22 and with the amplitude a f 23 introduction of this correction to the wavemaker motion leads to excitation of an additional set of evanescent modes following the procedure similar to the linear case the required wavemaker velocity can be found using 22 and 23 24 u d 2 κ d h 0 p z cosh k 2 ω h z d z h 0 f z cosh k 2 ω h z d z re a 1 2 e i 2 ω 1 t finally the velocity of the wavemaker oscillations that cancels the term d in 8 is 25a u d 2 κ d k 2 ω 2 h l h 2 1 cosh k 2 ω h k 2 ω h l h sinh k 2 ω h g re a 1 2 e i 2 ω 1 t 25b g k 2 ω k 1 k 2 ω 2 k 2 ω k 1 k 2 ω 2 k 2 ω cosh k 1 k 2 ω h k 1 k 2 ω 2 k 1 h l h sinh k 1 k 2 ω h k 1 k 2 ω k 1 k 1 k 2 ω h l h sinh k 1 k 2 ω h k 1 k 2 ω 2 k 2 ω cosh k 1 k 2 ω h k 1 k 2 ω 2 2 4 simplifications for the piston wavemaker the expressions for the piston type wavemaker with f z 1 are significantly simpler the transfer function for the 1st order free waves is 26 λ 1 κ 1 k 1 κ 1 2 cosh k 1 h k 1 h sinh k 1 h the correction to the piston motion suppressing generation of the 2nd order free waves is 27 u d 2 t λ 1 g k 2 ω 2 k 2 ω 2 k 1 2 k 1 ω 1 2 k 2 ω k 1 coth k 2 ω h tanh k 1 h re a 1 2 e i 2 ω 1 t 3 regimes of the wave generation we now compare quantitatively the method presented in section 2 with the theory of schäffer 1996 to this end a regular wave field consisting of a single free harmonic is considered first since the analysis is limited to the 2nd order nonlinearities the free wave is complemented by the bound wave at the second frequency 28 η x t re a 1 e i k x ω t a 2 e 2 i k x ω t where k is the wave number related to the angular frequency ω according to the dispersion relation 13 the required 2nd order wavemaker motion is given by 29 x t re b 1 e i ω t b b 2 e i 2 ω t b d 2 e i 2 ω t b being the amplitudes of the wavemaker motion calculated using 10 and 11 absolute values of the amplitudes in 29 are analyzed in figs 2 and 3 for the piston and paddle wavemakers respectively note that the dimensionless water depth kh π corresponds to the deep water regime while the values in the range π 10 kh π correspond to the intermediate depth dean and dalrymple 1991 the maximum wave steepness is ε ka 1 0 3 to eliminate wave breaking relative deviations of the amplitudes calculated according to the present method from the schäffer s results are shown in figs 2 a and 3 a and do not exceed 1 5 for the piston wavemaker the deviations practically vanish in both deep and shallow water regions they attain maximum at intermediate water depth see fig 2 a for the paddle wavemaker the highest deviations are obtained in the nearly shallow water area fig 3 a the 2nd order correction to the wavemaker motion that results from its finite displacement b d 2 depends on water depth as well as on wave steepness see figs 2 c and 3 c this correction is most pronounced at low values of kh however for steep waves the amplitudes b d 2 are quite significant even in deep water kh π contrary to that 2nd order corrections to the wavemaker motion due to bound waves b b 2 decay fast with kh and become negligible in deep water see figs 2 d and 3 d as seen from figs 2 b and 3 b at certain value of kh that depends on the wavemaker geometry the 2nd order correction to the wavemaker motion vanishes thus enabling accurate generation of even very steep waves using the linear wavemaker theory the reasons for this phenomenon are clarified in fig 4 where the variation with time of all three components of 29 is plotted for ka 1 0 3 and the selected values of water depth in the range 0 25π kh 1 6π piston wavemaker is considered fig 4 demonstrates that the 2nd order wavemaker motion components x d 2 and x b 2 are in opposite phases and thus partially cancel each other in intermediate depth particularly when kh 0 385π the correction due to the bound waves x b 2 dominates see fig 4 a and b with increase of kh x b 2 tends to zero and vanishes in deep water while the amplitude of the contribution due to the finite displacement of the wavemaker x d 2 remains nearly constant fig 4 e and f at kh 0 385π both 2nd order contributions to the wavemaker motion cancel each other fig 4 c and d the value of kh for which the 2nd order correction vanishes can be found from the condition 30 b b 2 b d 2 the explicit form of 30 is given in appendix b for an arbitrary value of the hinge location l h h there is no dependence on the wave steepness ε the solution of the equation 30 is plotted in fig 5 the effects of nonlinearity are considered in sequel for the water depths beyond the range studied in fig 5 4 validation of the method to validate the generation method described above experiments were carried out in a wave flume equipped with a paddle wavemaker the 2nd order effects are most pronounced at intermediate depth with kh 0 2π the wavemaker in our facility is ineffective in those conditions because of limitations on maximum inclination angle of the paddle leading to an inability to generate a wave with a desired steepness therefore in this case verification for the intermediate depth is carried out using the fully nonlinear numerical wave tank nwt based on boundary element method bem with a piston type wavemaker the nwt was carefully validated against experimental data in deep water by khait and shemer 2018 the same method was also extensively tested by grilli et al 1989 grilli and svendsen 1990 grilli and subramanya 1996 grilli and horrillo 1997 for different conditions including propagation of the breaking wave under variable bathymetry from deep water to the beach 4 1 experimental facility the tau wave flume is 18 m long 1 2 m wide 0 9 m deep and filled to the mean water depth of 0 6 m the wavemaker is controlled by computer wave energy absorbing sloping beach of 3 m long located at the far end of the flume significantly reduces the reflection of waves an instrument carriage with longitudinal position controlled by a computer carries four resistance type wave gauges mounted along the flume with the spacing of 0 2 m between the adjacent gauges the experiments including the wave generation and data acquisition are controlled by a single labview program ensuring precise synchronization static calibration of the wave gauges was performed prior to every experimental run by variation of the vertical position of the wave gauges using a fully automatic procedure the outputs of the wave gauges and instantaneous coordinates of the paddles were sampled at the rate of t 0 128 where t 0 is the carrier wave period 4 2 numerical wave tank nwt the unidirectional wave train is simulated in two dimensional constant depth numerical domain ω shown schematically in fig 6 in the beginning of every simulation the domain has an undisturbed rectangular shape bounded by four boundaries the bottom γ b and lateral γ l boundaries represent perfectly reflecting solid walls γ wm is the moving boundary representing piston or paddle wavemaker and γ fs is the free surface the boundaries are defined on a one dimensional grid consisting of regular and corner nodes the exact values of the flow parameters are defined at the nodes while interpolation is applied between the adjacent nodes introducing fluid velocity v φ the green s identity is applied to solve the potential flow in the domain ω 31 α r s φ r s γ φ n r ψ r r s φ r ψ n r r s d γ here ψ r r s 1 2 π ln r r s is the fundamental solution that represents the potential flow at point r due to a source located at r s the geometric factor α π for regular nodes and α π 2 for corner nodes the integration was carried out along the closed circuit γ γ f s γ l γ b γ w m equation 31 is solved numerically using the boundary element method bem grilli et al 1989 grilli and subramanya 1996 grilli and svendsen 1990 the 3rd order accurate mii local interpolation technique grilli and subramanya 1996 was implemented using a sliding cubic boundary element defined by four neighbor grid nodes as shown schematically in fig 6 only the central part of the boundary elements was used for the numerical integration of 31 while the extreme nodes of the element defined the curvature of the central part the system of the discretized equations can be written in the matrix form 32 a φ b φ n where a and b are known n n matrices φ and φ n are unknown vectors with the length of n n being the number of the nodes additional set of equations obtained by differentiation of 32 with respect to time is used to find the values of φ t and 2 φ t n a half of the 2n unknowns in 32 is determined by the boundary conditions 33a γ w m φ n u w m 33b γ b a n d γ l φ n 0 33c γ f s d φ d t g z 1 2 φ 2 p ρ b f x t e r m 1 2 μ d ρ 2 φ s 2 b f x t e r m 2 33d γ f s d r d t φ where r x z is the radius vector in the global coordinate system u wm t is the prescribed normal velocity of the wavemaker equations 33a and 33b define naturally the velocity component normal to the boundaries γ b γ l and γ wm the values of the potential at the free surface nodes and their positions are found from equations 33c and 33d respectively the numerical integration of 33c d was performed using the 2nd order taylor expansion of the radius vector r and the potential φ at the free surface nodes the expansion terms are estimated by the 4th order interpolation polynomial defined in the local n s coordinate system see fig 6 two additional terms were introduced into 33c to take into account the numerical absorbing beach shown schematically in fig 6 grilli and horrillo 1997 tian et al 2010 the beach minimizes the wave reflection from γ l the artificial pressure and the beach function are defined as follows 34a p p d ρ g h φ n 34b b f x 1 2 1 tanh b ε x x o r i g x e n d x o r i g where ρ is the water density p d and b ε are the dimensionless constants x orig and x end are coordinates of the beach origin and the end see fig 6 values of the constants were set according to khait and shemer 2019 b ε 6 p d 2 and μ d 1500 pa s for steep waves the stokes drift of the free surface nodes was observed resulting in a considerable increase of the distances between adjacent nodes in the vicinity of the wavemaker to maintain sufficient accuracy of the simulations adaptive domain regridding subramanya and grilli 1994 was applied to restore a nearly uniform distribution of the nodes over the boundaries since the free surface nodes have all degrees of freedom interpolation was applied to find the variation of the surface elevation with time at the fixed location x p see fig 6 the length of the domain was set such that x p l nwt 4 while l b l nwt 2 was taken to ensure good performance of the numerical beach different grids were considered while generating the regular wave field consisting of a single free harmonic with t 0 0 7 s see table 1 it was found that the grid density of at least 40 nodes m grid 2 results in a grid independent solution in agreement with khait and shemer 2018 once the spatial configuration is found the integration time step was set as δt t 0 2 n the value of n is taken to provide the courant number cfl 0 1 grilli et al 1989 grilli and subramanya 1996 grilli and svendsen 1990 35 c f l g h δ t δ r min where δ r min is a minimum distance between the adjacent nodes of the grid 5 results 5 1 linear transfer function the linear transfer function is applied to obtain the 1st order wavemaker motion as discussed above it was shown aknin and spinneken 2017 ursell et al 1960 that the actually measured values of the transfer function may significantly deviate from the theoretical values by more than 15 for some cases leading to appreciable inaccuracies in wave generation these discrepancies were attributed to the fluid leakage at the wavemaker as well as to viscous and nonlinear effects aknin and spinneken 2017 application of the nwt allows to circumvent any effects of viscosity and leakages thus enabling to analyze alternative possible reasons for inaccuracy of the transfer function the linear transfer function relating amplitudes of the surface elevation and the wavemaker displacement is conventionally defined as 36 c 1 a 1 b 1 ω 1 λ 1 a regular monochromatic free wave field was generated in the nwt using 29 with b b 2 b d 2 0 the parameters of the numerical model were set as follows domain length l nwt 6 m wave period t 0 0 7 s mean water depth h and wave amplitude a 1 were varied to study different wave excitation regimes the dominant amplitude a 1 of the wave field was determined from the spectrum of the surface elevation recorded at x p 3h during the numerical simulation comparison of the theoretical values of the linear transfer function with those determined in the numerical simulations is presented in figs 7 and 8 for piston and paddle wavemakers respectively significant deviation of the theoretical value of c 1 from that obtained in the numerical simulations is observed for steep waves with ε ka 1 0 25 see figs 7 a and 8 a this observation implies that viscosity and fluid leakages at the wavemaker have only a minor if any contribution to the observed inaccuracy of the linear transfer function the problem apparently stems from neglected nonlinear effects which may include the impact of the mean current f in 21a disregarded in the derivations the coefficient β is introduced to account for the deviation of the transfer function its value was found to be dependent mainly on the wave steepness ε and in some extent on water depth kh the value of β tends to zero when ε is low and may exceed 10 for extremely steep waves cf figs 7 b and 8 b the nearly quadratic dependence of β on ε corroborates the conjecture that nonlinearity is the dominant factor responsible for the inaccuracy of the transfer function 5 2 generation in intermediate depth two different cases are investigated first we test the accuracy of the wave generation method against the experimental results reported in schäffer 1996 for the wave train with the most pronounced nonlinear effects to this end we consider the generation of a monochromatic free wave in intermediate depth with the following parameters mean water depth h 0 7 m wave period t 0 3 s wave length λ 0 7 45 m dominant amplitude a 1 7 cm k 0 h 0 59 0 19π ε k 0 a 1 0 06 the nonlinearity parameter introduced by schäffer is equal to s 1 08 in this limiting case while the applicability limit of the theory s 1 is reported in schäffer 1996 numerical simulations were performed in nwt using both linear and nonlinear 2nd order wavemaker motion according to 29 to enable comparison with measurements reported in schäffer 1996 the surface elevation variation with time was recorded at three locations x p 1 4 and 8 7 m results of the linear wave generation are plotted in fig 9 a b c together with the theoretically expected 2nd order wave shapes shown for the reference note that close to the wavemaker x p 1 m the surface elevation has a nearly sinusoidal shape because the distorting bound wave is effectively cancelled by the parasitic free wave arising at the frequency of the bound wave since the parasitic wave propagates with the phase velocity different from that of the bound wave the shape of the free surface becomes distorted farther away from the wavemaker application of the 2nd order wavemaker motion as described in section 2 eliminates the parasitic wave leading to the free surface shape independent of the distance from the wavemaker fig 9 d e f the wave shape obtained in nwt practically coincide with both target wave form and with the experimental results of schäffer 1996 generation by the piston wavemaker of the wave train having bi chromatic free wave spectrum is now investigated the 1st order surface elevation at the wavemaker is 37 η 1 a 0 2 cos ω 0 δ ω t cos ω 0 δ ω t the parameters were set to be close to the previous case in terms of the wave steepness and water depth h 0 6 m t 0 2 8 s ω 0 2π t 0 λ 0 6 44 m δω ω 0 10 a 0 6 15 cm k 0 a 0 0 06 k 0 h 0 186π the results of the numerical simulation in nwt with application of the linear wavemaker motion are presented in fig 10 the surface elevation variation with time fig 10 a contains both free and bound waves as in fig 9 significant deviation of the wave shape from the prescribed one is caused by parasitic free waves at frequencies of bound waves the difference in phases of the parasitic and the bound waves is dependent on the distance from the wavemaker which leads to the variation of the surface elevation amplitudes at the second harmonic 2δω 2 ω 0 δω 2ω 0 shown by error bounds in fig 10 b the amplitude spectrum of the 2nd order motion of the piston wavemaker required for the accurate generation of the bi chromatic wave train is plotted in fig 11 c application of the corrected wavemaker motion as a boundary condition in nwt leads to the surface elevation variation that is in a very good agreement with the target see fig 11 a moreover the variation with the distance from the wavemaker of the surface elevation amplitudes at the 2nd order is almost completely eliminated cf figs 10 b and 11 b thus indicating at the substantial reduction of the parasitic waves content 5 3 generation in deep water the accuracy of the method for a paddle wavemaker in deep water is now investigated first generation of bi chromatic narrow banded wave train 37 is considered to satisfy deep water conditions the carrier wave period was reduced while leaving all other wave train parameters unchanged see table 2 the wave steepness k 0 a 0 and the water depth k 0 h were limited by the maximum possible paddle displacements in the experimental facility in case 1 table 2 the water depth k 0 h 0 78π approximately satisfies the deep water conditions it is expected that in this regime the finite displacements of the wavemaker surface x d 2 will constitute the main contribution to the 2nd order correction of the wavemaker motion the linear driving signal b d 2 b b 2 0 using theoretical values of the transfer function was utilized in experiments to measure the reference surface elevation the length of a single wave group in this case is such that four groups occupy almost full length of the flume taking into account that first group is affected by nonlinearities at the leading edge of the wave sequence the bi chromatic spectrum is constructed based on the third and the forth wave groups to avoid contamination of the measurements by the reflected waves from the far end of the flume the wave gauges were located within the range 0 8 m x p 4 0 m with the spatial step of 0 2 m an amplitude spectrum of the surface elevation in the wave train excited by the linear driving signal is plotted in fig 12 c contrary to numerical simulations cf figs 10 and 11 in experiments the spectra are contaminated by noise caused by the imperfect paddle motion as expected a discrepancy is found in the amplitudes of the 2nd order harmonics some inaccuracies also appear even for the 1st order free harmonics since the theoretical values of the transfer function were utilized here for wave train generation the measured values of the surface elevation are slightly underestimated fig 12 e to improve the wave generation accuracy the values of the transfer function c 1 related to λ 1 by 36 were measured experimentally by excitation of the monochromatic free wave with the prescribed amplitude combination of experimental values of c 1 and λ 1 with the accurate to the 2nd order driving signal see fig 12 b leads to the averaged spectrum and the surface elevation plotted in fig 12 d f which agree very well with the theoretical predictions fig 13 examines the results of the nonlinear wave generation of the deep water wave trains denoted by 2 and 3 in table 2 the measured values of the amplitudes of the 1st and the 2nd order harmonics are close to the theoretical predictions even though the wave steepness in those cases is appreciably higher as compared to case 1 the impact of the bound waves relative to the free dominant waves is less pronounced in deeper water cf figs 12 and 13 consider now a broad banded wave train with the gaussian shaped envelope so that the 1st order surface elevation at x f 4 m is given by 38 η 1 x f t a 0 exp t m t 0 2 cos ω 0 t here m 0 6 defines the spectral width of the wave train the following parameters were selected t 0 0 7 s ω 0 2π t 0 a 0 3 04 cm k 0 a 0 0 25 k 0 h 1 6π relative spectral width at a half amplitude is δ ω 1 2 ω 0 0 88 confirming that the spectrum is indeed broad banded the spectral representation of 38 is 39 η 1 x t j re a j 1 e i k j x ω j t where wave number k j is related to the angular frequency ω j by the linear dispersion relation 13 the spectrum a j 1 also has a gaussian shape substitution of x 0 into 39 defines the 1st order surface elevation at the wavemaker location in broad banded wave trains spectral domains of bound and free waves may overlap the 2nd order spectrum of the wavemaker motion computed as specified in section 2 is plotted in fig 14 a since b d 2 and b b 2 are smaller by orders of the magnitude than b 1 the effect of the nonlinear correction of the wavemaker motion is expected to be minor attention should be given to the frequency dependent linear transfer function the values of the transfer function at different frequencies were iteratively adjusted using nwt and the algorithm presented in shemer et al 2007 khait and shemer 2019 see fig 14 b the transfer function obtained as a result of such iterative adjustment may significantly reduce the inaccuracies in the wave generation close to the carrier frequency ω 0 the values of the transfer function obtained in the numerical simulations are practically identical to the theoretical values at ω 2ω 0 the transfer function obtained numerically tends to zero since the amplitudes of the free wave harmonics are negligibly small at those frequencies the agreement of the theoretical values of the transfer function and those obtained in the fully nonlinear simulations stems from the fact that in a broad banded spectrum comprised on numerous harmonics the wave steepness of each individual harmonic is small within the limits of validity of the linear theory cf figs 7 and 8 the nonlinear driving signal depicted in fig 14 a was applied in experiments the wave gauges covered the range 1 2 m x p 2 6 m with the spatial step 0 2 m the averaged surface elevation spectrum and error bounds presented in fig 14 c agree well with both the theoretically expected and the numerically simulated spectra the errors are negligibly small in the vicinity of the carrier frequency ω 0 and increase at frequencies that differ notably from ω 0 remaining lower by several orders of the magnitude than the dominant amplitudes the theoretical 1st order surface elevation was calculated at x p 2 m using 39 and supplemented by the 2nd order bound waves using 17a the measured and simulated surface elevation variation with time at x p 2 m is found to agree very well with the theoretical prediction see fig 14 d 6 conclusions accurate generation of nonlinear waves by wavemakers may constitute a significant problem in experimental investigations the 2nd order wavemaker theory developed by schäffer 1996 is one of the most comprehensive approaches applied so far to improve the wave generation accuracy this theory introduces 2nd order correction to the wavemaker motion calculated from the spectrum of the 1st order free waves given at the wavemaker location the derivations start from basic equations of the potential flow theory with nonlinear boundary conditions on both free surface and at the wavemaker resulting in significant complexity of the final expressions the theory by schäffer requires surface elevation spectrum as an input parameter the experiments in wave flumes are often used for validation of different theoretical models of the nonlinear water waves resulting in solutions in different forms such as the complex surface elevation spectrum in the fourier space which is the outcome of the zakharov model zakharov 1968 or the complex envelope in the physical space in the nonlinear schrödinger mei 1989 or modified nonlinear schrödinger trulsen and dysthe 1996 models an alternative analytic method of determination of nonlinear correction to the wavemaker motion is offered here that allows definition of the target wave field in either fourier or physical space rather than starting the derivation from the governing potential flow equations as in the theory by schäffer advantage is taken here of the existing nonlinear wave models supplemented by the nonlinear boundary condition at the wavemaker since the existing nonlinear water wave theories are accurate to the 3rd and higher orders the present approach makes possible to circumvent the 2nd order limitation of the schäffer theory this approach allows significant simplification of the procedure needed for determination of the nonlinear correction to the wavemaker driving signal which is critical in many practical applications the method was carefully validated against schäffer s theory which has no limitations on the width of the surface elevation spectrum the approach based on the zakharov model that is also free of any restrictions on the spectral width was thus used in the present paper for computation of 2nd order bound waves for narrower spectra the expressions based on the nonlinear schrödinger equation or its extension by dysthe can be used for that purpose the accurate to the 2nd order wavemaker driving signal was also validated against experiments in the wave flume in deep water and against the fully nonlinear numerical simulations in intermediate depth it was found that the 2nd order correction to the wavemaker motion disappears at a certain water depth this depth depends on the geometry of the wavemaker particular attention was given to significant deviation of the linear wavemaker transfer function obtained in the fully nonlinear numerical simulations from the theoretical predictions this deviation was observed in numerous experimental works the existence of such a deviation in fully nonlinear simulations of potential flow indicates that viscous friction and possible leakages at the wavemaker that were suggested as a possible source for this effect can only play a minor role the quadratic dependence on the wave steepness of the relative deviation of the transfer function from the linear predictions suggests that the mean current at the 2nd order that results from the nonlinear interaction of the velocity field of the propagating waves with the wavemaker surface oscillations of finite amplitude is a possible reason for this inaccuracy a more careful investigation is needed to clarify the reasons for this behavior of the transfer function acknowledgements this study was supported by a grant 3 12473 from israel ministry of science technology and space and by a grant 306 15 from israel science foundation appendix a the coefficients in 18 required for the determination of the 2nd order bound wave harmonics in the nonlinear amplitude spectrum of the surface elevation stiassnie and shemer 1984 1987 v 1 ω 0 ω 1 ω 2 k 0 k 1 k 2 1 4 π g 2 1 2 ω 0 ω 1 ω 2 ω 1 ω 2 g 2 k 1 k 2 ω 2 ω 0 ω 1 ω 0 ω 1 g 2 k 0 k 1 v 2 ω 0 ω 1 ω 2 k 0 k 1 k 2 1 4 π g 2 ω 2 ω 0 ω 1 ω 0 ω 1 g 2 k 0 k 1 ω 1 ω 0 ω 2 ω 0 ω 2 g 2 k 0 k 2 ω 0 ω 1 ω 2 ω 1 ω 2 g 2 k 1 k 2 v 3 ω 0 ω 1 ω 2 k 0 k 1 k 2 1 4 π g 2 ω 2 ω 0 ω 1 ω 0 ω 1 g 2 k 0 k 1 1 2 ω 0 ω 1 ω 2 ω 1 ω 2 g 2 k 1 k 2 appendix b the dimensionless mean water depth associated with the zero 2nd order correction to the wavemaker motion can be found from the solution of the equation b 1 u b 2 u d 2 0 where u b 2 and u d 2 are defined by 19 and 25 respectively considering a monochromatic free wave equation b 1 can be written as follows b 2 3 k 4 k h sinh 4 k h 1 2 sech 2 k h sinh 4 k h 2 k h l w m coth k h 1 1 2 sech 2 k h k 2 ω 2 2 k h sinh 2 k h 1 cosh k h k h l w m sinh k h 1 cosh k 2 ω h k 2 ω h l w m sinh k 2 ω h q 0 b 3 q k 2 ω cosh k k 2 ω h k k 2 ω 2 k 2 ω cosh k k 2 ω h k k 2 ω 2 2 k 2 k 2 ω 2 k 2 k 2 ω 2 h l w m k 2 k 2 ω 2 2 k cosh k 2 ω h sinh k h k 2 ω cosh k h sinh k 2 ω h here k k 1 is the wave number of the 1st order free wave wave number k 2ω corresponds to the free wave with the double frequency 2ω 1 b 4 4 k tanh k h k 2 ω tanh k 2 ω h solution of the equation b 2 with respect to kh is plotted in fig 5 
22800,a new analytical method to calculate the nonlinear correction to the wavemaker motion needed for the accurate generation of steep waves is suggested it is developed taking advantage of the existing models of nonlinear water waves such as zakharov dysthe or schrödinger equations the limitations of the method in terms of the order of nonlinearity and spectral width are determined by the wave model used thus allowing its extension to the 3rd and higher orders beyond the limits of the existing wavemaker theories application of the nonlinear water waves models allowed significant simplification of the procedure of determination of the nonlinear correction to the wavemaker driving signal the suggested method was carefully validated against the theory of schäffer fully nonlinear numerical simulations and wave flume experiments the advantages of the method were exploited to carefully investigate different regimes of wave generation an appreciable deviation of the actual value of the linear transfer function from the theoretical predictions was found in agreement with the earlier experimental investigations the mean current arising at the 2nd order due to finite displacements of the wavemaker surface was suggested as one of the reasons for that deviation keywords wavemaker theory nonlinear wave generation piston paddle nonlinear water waves zakharov equation bound waves 1 introduction laboratory investigation of unidirectional surface gravity water waves in tanks requires generation of wave trains with a certain shape computer controlled wavemakers driven by prescribed signals are used for that purpose the accuracy of generation decreases with wave nonlinearity that is represented by the wave steepness ε ka k and a being the characteristic wave number and the wave amplitude respectively a number of wavemaker theories were developed in order to reduce the deviation of the actually excited in the tank wave shape from the prescribed one for waves with non negligible nonlinearity havelock 1929 barthel et al 1983 madsen 1971 among the factors affecting the accuracy of the reproduction of the desired wave shape evanescent modes dean and dalrymple 1991 play an important role however since these modes vanish fast with the distance from the wavemaker and therefore do not affect waves sufficiently far away they often are disregarded appearance of spurious propagating free modes at frequencies absent in the spectrum of the wavemaker motion was also reported in schäffer 1996 these undesirable waves constitute a significant problem as they contaminate wave field at much longer distances one of the most comprehensive approaches to avoid excitation of the parasitic free waves was suggested by schäffer 1996 and schäffer and steenberg 2003 their theory has no limitations on the width of the wave train spectrum the applicability of the theory was confirmed experimentally for regular waves wave groups and even for irregular wave fields however certain deviations from the theoretical predictions were still observed in the amplitudes as well as in the phases of the measured surface elevation spectra aknin and spinneken 2017 indicating that spurious waves were not completely suppressed it should be stressed that the theory presented by schäffer 1996 is limited to the 2nd order nonlinearities while neglecting higher order effects thus limiting its range of applicability zhang and schäffer 2007 alternative experimental and numerical procedures were therefore developed in order to improve the accuracy of the wave generation force feedback controller system employing impedance matching procedure applicable to generation of a nearly single frequency wave train by a flap type wavemaker was presented by spinneken and swan 2009a 2009b 2012 spinneken et al 2014 in contrast to the 2nd order theory of schäffer spinniken and swan measured all forces acting on the wavemaker board and use them as the feedback for the computer aided wave generation system a significant advantage of the force feedback model is associated with the inherent self correction which allows wave generation and absorption to be performed in parallel by a single wavemaker this feature is particularly important in the presence of immersed or submerged structures in the tank away from the wavemaker that inevitably cause wave reflection from the structure back to the generating boundary further experimental investigation of the force feedback method demonstrated that the inaccuracies are not always associated with the spurious higher order waves significant errors were reported in the spectrum of the 1st order waves generated using the theoretical transfer functions matching the surface elevation amplitude to the displacements of the wavemaker aknin and spinneken 2017 these findings are in agreement with earlier investigations ursell et al 1960 the wave generation technique using the higher order spectral method hosm supplemented with the 2nd order correction based on the theory of schäffer is presented in houtani et al 2018 the accuracy of this method was shown to be superior to the conventional linear approach when the wave steepness the bandwidth of the frequency spectrum or the directional spreading became large in practice the experimental method of the wave basin calibration is often applied masterton and swan 2008 fernández et al 2014 this empirical approach was amended in shemer et al 2007 by application of the spatial version of the zakharov equation zakharov 1968 as a theoretical model to account for the spectral changes during the propagation of the nonlinear wave train along the experimental facility the method was used for the generation of broad banded wave trains adopting iterative corrections of the wavemaker transfer function the iterative procedure correcting the transfer function was improved in buldakov et al 2017 by application of the harmonics separation technique for linearization of the amplitude spectrum it was shown that iterative adjustment based on the linear part of the surface elevation spectrum only noticeably improves the accuracy of the wave generation nevertheless this method was found to be time consuming since it requires four experimental runs with different driving signals to complete a single iteration thus increasing the duration of experiments significantly especially in large experimental facilities a different method of the harmonics separation was studied in khait and shemer 2019 application of the fully nonlinear numerical wave tank allowed minimization of the experimental effort the applicability of the iterative method in deep water conditions was demonstrated however in intermediate and nearly shallow water depth its applicability proved to be limited because of much stronger contamination of the wave field by the spurious waves it is generally accepted that the wavemaker motion correct to the 2nd order is sufficient in most cases for the generation of the steep ε 0 1 up to ε 0 3 nonlinear waves in deep water in intermediate water depth when approaching shallow water conditions the importance of higher order contributions to the wavemaker motion increases strongly that prescribes the limits of applicability of the 2nd order wavemaker theory according to schäffer 1996 zhang and schäffer 2007 eldrup and andersen 2019 we present here an analytical method of wave generation in deep intermediate and nearly shallow water depth that may be considered as an alternative to the theory of schäffer 1996 the suggested method is not restricted to the 2nd order in wave steepness the main difficulty here comes from the need to calculate accurately the velocity field induced by the 2nd and higher order bound waves existing nonlinear water wave models such as zakharov 1968 trulsen and dysthe 1996 nonlinear schrödinger equation mei 1989 onorato et al 2013 chabchoub and fink 2014 or alternative may be used for that purpose as they provide analytic expression for computation of bound waves up to the 4th order in the modified zakharov model stiassnie and shemer 1984 1987 krasitskii 1994 shemer et al 2001 shemer and chernyshova 2017 thus simplifying the computations as compared to schäffer the limitations of the method are stipulated by the selected theoretical model the adopted approach also allows application of the same theoretical model for an accurate determination of the wavemaker motion and for simulation of the evolution of the generated wave train during its propagation away from the wavemaker this approach thus allows selecting the model that is most suitable for the particular problem to enable consistent quantitative comparison of the present results with the theory of schäffer the analysis here is limited to the 2nd order in the wave steepness the accuracy of the wave generation using the suggested method was carefully verified in deep water in a wave flume and in intermediate water depth using a fully nonlinear numerical wave tank based on boundary element method the method allows identifying the sources of wave generation inaccuracies thus resulting in new insight 2 formulation of the method of nonlinear wave generation the types of the wavemaker considered are shown schematically in fig 1 the description of the wavemaker geometry is adopted from schäffer 1996 variation of the hinge location within the range 0 l h h defines a variety of configurations including paddle for l h 0 and piston for l h the motion of the plane wavemaker surface can be presented as x t f z where f z defines the wavemaker shape see fig 1 1 f z 1 z h l h the wavemaker surface at any instant is described by 2 f x z t x x t f z 0 where x is the horizontal coordinate non penetration boundary condition at the wavemaker surface can be expressed dean and dalrymple 1991 as 3 f t v f f 0 0 where v u w is the velocity vector of a fluid particle in 2d domain using 2 3 can be written as 4 u w x t d f z d z u t f z x x 0 where u t dx dt is the velocity of the wavemaker surface at z 0 equation 4 is expanded into the taylor series around the mean location of the wavemaker x 0 limiting the analysis to the 2nd order yields 5 u w x d f z d z u f z x 0 x f z x u w x d f z d z u f z x 0 0 for potential flow the fluid velocity v φ x φ z and 5 can be rewritten as 6 φ x x 0 φ z x d f z d z u f z x f z 2 φ x 2 x 2 f z d f z d z 2 φ z x x 0 assuming ε ka 1 the fluid velocity potential φ describing the field the coordinate x and the wavemaker velocity u can be expanded in series of wave steepness ε as φ εφ 1 ε 2 φ 2 x εx 1 ε 2 x 2 and u εu 1 ε 2 u 2 the boundary condition 6 expresses the equality between the horizontal fluid velocity component φ x and the horizontal wavemaker velocity u for all vertical coordinates z substitution of those expansions into 6 allows decomposition of the wavemaker boundary condition according to the order in ε first order 7 φ 1 x x 0 u 1 t f z second order 8 φ 2 x x 0 u b 2 t f z x 1 φ 1 z d f z d z f z 2 φ 1 x 2 x 0 d the linear term u 1 t f z in 7 represents the wavemaker motion needed for generation of free waves generation of free waves leads to appearance of bound waves at the 2nd and higher orders to reproduce the velocity field of those bound waves by the wavemaker the 2nd order wavemaker motion u b 2 t f z is incorporated in 8 since the vertical distribution of velocity of the propagating 1st and 2nd order waves do not match the wavemaker surface velocity defined by its shape f z the so called evanescent modes appear at different orders dean and dalrymple 1991 thus the horizontal fluid velocity at the wavemaker on the left side of 7 and 8 at each order n can be seen as composed of two contributions 9 φ n x x 0 φ p m n x x 0 j 1 φ e m j n x x 0 where pm and em denote propagating and evanescent waves respectively the term denoted by d in 8 that results from the finite displacement of the wavemaker contributes to the fluid velocity at the 2nd order and causes excitation of unwanted free propagating waves to cancel d introduction of an additional 2nd order correction to the wavemaker motion u d 2 t f z to be determined later is needed the total wavemaker motion accurate to the 2nd order is thus 10 u t u 1 t 1 s t o r d e r u b 2 t u d 2 t 2 n d o r d e r 11 x t u t d t in the present approach the wavemaker motion is modified so that it complies with the velocity profile due to both free and bound waves in water to calculate the actual water velocities at the wavemaker in the presence of nonlinear waves advantage is taken here of the expressions obtained in the course of derivation of the zakharov equation it is expected that this procedure will eliminate spurious propagating waves at the 2nd order 2 1 first order motion of the wavemaker the required shape of the 1st order free propagating wave spectrum is prescribed at the wavemaker location x 0 the contribution of an arbitrary harmonic with the radian frequency ω 1 and complex amplitude a 1 to the surface elevation and to the vertical profile of the horizontal velocity in linear approximation can be presented as dean and dalrymple 1991 12a η p m 1 re a 1 e i k 1 x ω 1 t 12b φ p m 1 x η p m 1 κ 1 cosh k 1 h z 12c κ 1 g k 1 ω 1 cosh k 1 h where k 1 is the wave number related to the angular frequency ω 1 by the dispersion relation 13 ω 2 g k tanh k h g being the acceleration of gravity and h the mean water depth using 9 and 12b the 1st order motion of the wavemaker 7 can be rewritten as 14 u 1 f z κ 1 cosh k 1 h z re a 1 e i ω 1 t p m j 1 φ e m j 1 x explicit expressions for the evanescent modes are given in dean and dalrymple 1991 for our purposes it is only essential that the propagating and the evanescent modes are orthogonal the wavemaker motion can be related to the surface elevation of the propagating wave using transfer function λ 1 15 u 1 t λ 1 re a 1 e i ω 1 t substituting 15 into 14 multiplying both sides of 14 by cosh k 1 h z and integrating over depth yields in view of the orthogonality of pm and em the 1st order transfer function for the propagating wave 16 λ 1 κ 1 k 1 κ 1 h 0 cosh 2 k 1 h z d z h 0 f z cosh k 1 h z d z κ 1 k 1 h l h sinh 2 k 1 h 2 k 1 h 4 1 cosh k 1 h k 1 h l h sinh k 1 h 2 2 second order motion of the wavemaker due to bound waves surface elevation for a single 2nd order propagating bound wave can be expressed as 17a η p m b o u n d 2 re a 2 e i k 2 x ω 2 t the velocity field of each bound wave component 17a can be expressed by dean and dalrymple 1991 17b φ p m b o u n d 2 x η p m b o u n d 2 κ 2 cosh k 2 h z 17c κ 2 3 ω 2 sinh k 2 h 2 cosh k 2 h the amplitude spectrum of bound waves a 2 ω is calculated from the free wave spectrum a 1 ω that is prescribed at x 0 using the theoretical model of zakharov adopted in this study the wave numbers k 2 and the angular frequencies ω 2 of bound waves do not satisfy the linear dispersion relation 13 for every pair of the 1st order harmonics ω m 1 and ω n 1 with complex amplitudes a m 1 and a n 1 three 2nd order bound waves appear with the following frequencies ω j 2 wave numbers k j 2 and complex amplitudes a j 2 stiassnie and shemer 1984 1987 krasitskii 1994 18a ω 1 2 ω m 1 ω n 1 k 1 2 k m 1 k n 1 a 1 2 π 2 g g k 1 2 tanh k 1 2 h ω m 1 ω n 1 v 1 g k 1 2 tanh k 1 2 h ω m 1 ω n 1 k 1 2 k m 1 k n 1 g k 1 2 tanh k 1 2 h ω m 1 ω n 1 a m 1 a n 1 18b ω 2 2 ω m 1 ω n 1 k 2 2 k m 1 k n 1 a 2 2 π 2 g g k 2 2 tanh k 2 2 h ω m 1 ω n 1 v 2 g k 2 2 tanh k 2 2 h ω m 1 ω n 1 k 2 2 k m 1 k n 1 g k 2 2 tanh k 2 2 h ω m 1 ω n 1 a m 1 a n 1 18c ω 3 2 ω m 1 ω n 1 k 3 2 k m 1 k n 1 a 3 2 π 2 g g k 3 2 tanh k 3 2 h ω m 1 ω n 1 v 3 g k 3 2 tanh k 3 2 h ω m 1 ω n 1 k 3 2 k m 1 k n 1 g k 3 2 tanh k 3 2 h ω m 1 ω n 1 a m 1 a n 1 here denotes complex conjugate the coefficients in 18 are given in appendix a similarity of the velocity profiles 12b and 17b indicates that the transfer function for the bound waves may be presented in the form of 16 by replacing the coefficient κ 1 and the wave number k 1 by the corresponding values in 17b c λ 2 λ 1 κ 2 k 2 the wavemaker motion needed to excite in its vicinity the velocity field corresponding to that of the 2nd order bound wave with frequency ω 2 and amplitude a 2 is 19 u b 2 t λ 2 re a 2 e i ω 2 t 2 3 second order correction to wavemaker motion due to its displacement the term d in 8 introduces the 2nd order fluid velocity at the wavemaker 20 φ d 2 x x 0 x 1 φ 1 z d f z d z f z 2 φ 1 x 2 x 0 substitution of the 1st order solutions 12 and 15 into 20 yields 21a φ d 2 x x 0 κ d p z a 1 2 f κ d p z re a 1 2 e i 2 ω 1 t 21b p z sinh k 1 h z k 1 h l h z cosh k 1 h z 21c κ d λ 1 g k 1 2 h l h ω 1 2 cosh k 1 h the effect of the mean current f on the wave field is expected to be small and is neglected as in the linear case the velocity profile of the 2nd order free wave at frequency 2ω 1 does not coincide with that prescribed by the shape function p z see 21b this leads to the addition of superposition of evanescent modes to the free wave see 9 the velocity associated with the 2nd order free wave at the wavemaker is 22 φ p m f r e e 2 x x 0 κ f 2 ω 1 k 2 ω cosh k 2 ω h z re a f e i 2 ω 1 t the value of κ f 2ω 1 k 2ω is defined by 12c the wave number k 2ω k 2ω 1 in 22 is related to the double frequency 2ω 1 by the linear dispersion relation 13 as in the linear case elimination of the evanescent modes allows determination of the 2nd order free wave amplitude 23 a f a 1 2 κ d κ f h 0 p z cosh k 2 ω h z d z h 0 cosh 2 k 2 ω h z d z the 2nd order correction to the wavemaker motion u d 2 t should result in generation of the free wave with the phase shifted by π relative to that of 22 and with the amplitude a f 23 introduction of this correction to the wavemaker motion leads to excitation of an additional set of evanescent modes following the procedure similar to the linear case the required wavemaker velocity can be found using 22 and 23 24 u d 2 κ d h 0 p z cosh k 2 ω h z d z h 0 f z cosh k 2 ω h z d z re a 1 2 e i 2 ω 1 t finally the velocity of the wavemaker oscillations that cancels the term d in 8 is 25a u d 2 κ d k 2 ω 2 h l h 2 1 cosh k 2 ω h k 2 ω h l h sinh k 2 ω h g re a 1 2 e i 2 ω 1 t 25b g k 2 ω k 1 k 2 ω 2 k 2 ω k 1 k 2 ω 2 k 2 ω cosh k 1 k 2 ω h k 1 k 2 ω 2 k 1 h l h sinh k 1 k 2 ω h k 1 k 2 ω k 1 k 1 k 2 ω h l h sinh k 1 k 2 ω h k 1 k 2 ω 2 k 2 ω cosh k 1 k 2 ω h k 1 k 2 ω 2 2 4 simplifications for the piston wavemaker the expressions for the piston type wavemaker with f z 1 are significantly simpler the transfer function for the 1st order free waves is 26 λ 1 κ 1 k 1 κ 1 2 cosh k 1 h k 1 h sinh k 1 h the correction to the piston motion suppressing generation of the 2nd order free waves is 27 u d 2 t λ 1 g k 2 ω 2 k 2 ω 2 k 1 2 k 1 ω 1 2 k 2 ω k 1 coth k 2 ω h tanh k 1 h re a 1 2 e i 2 ω 1 t 3 regimes of the wave generation we now compare quantitatively the method presented in section 2 with the theory of schäffer 1996 to this end a regular wave field consisting of a single free harmonic is considered first since the analysis is limited to the 2nd order nonlinearities the free wave is complemented by the bound wave at the second frequency 28 η x t re a 1 e i k x ω t a 2 e 2 i k x ω t where k is the wave number related to the angular frequency ω according to the dispersion relation 13 the required 2nd order wavemaker motion is given by 29 x t re b 1 e i ω t b b 2 e i 2 ω t b d 2 e i 2 ω t b being the amplitudes of the wavemaker motion calculated using 10 and 11 absolute values of the amplitudes in 29 are analyzed in figs 2 and 3 for the piston and paddle wavemakers respectively note that the dimensionless water depth kh π corresponds to the deep water regime while the values in the range π 10 kh π correspond to the intermediate depth dean and dalrymple 1991 the maximum wave steepness is ε ka 1 0 3 to eliminate wave breaking relative deviations of the amplitudes calculated according to the present method from the schäffer s results are shown in figs 2 a and 3 a and do not exceed 1 5 for the piston wavemaker the deviations practically vanish in both deep and shallow water regions they attain maximum at intermediate water depth see fig 2 a for the paddle wavemaker the highest deviations are obtained in the nearly shallow water area fig 3 a the 2nd order correction to the wavemaker motion that results from its finite displacement b d 2 depends on water depth as well as on wave steepness see figs 2 c and 3 c this correction is most pronounced at low values of kh however for steep waves the amplitudes b d 2 are quite significant even in deep water kh π contrary to that 2nd order corrections to the wavemaker motion due to bound waves b b 2 decay fast with kh and become negligible in deep water see figs 2 d and 3 d as seen from figs 2 b and 3 b at certain value of kh that depends on the wavemaker geometry the 2nd order correction to the wavemaker motion vanishes thus enabling accurate generation of even very steep waves using the linear wavemaker theory the reasons for this phenomenon are clarified in fig 4 where the variation with time of all three components of 29 is plotted for ka 1 0 3 and the selected values of water depth in the range 0 25π kh 1 6π piston wavemaker is considered fig 4 demonstrates that the 2nd order wavemaker motion components x d 2 and x b 2 are in opposite phases and thus partially cancel each other in intermediate depth particularly when kh 0 385π the correction due to the bound waves x b 2 dominates see fig 4 a and b with increase of kh x b 2 tends to zero and vanishes in deep water while the amplitude of the contribution due to the finite displacement of the wavemaker x d 2 remains nearly constant fig 4 e and f at kh 0 385π both 2nd order contributions to the wavemaker motion cancel each other fig 4 c and d the value of kh for which the 2nd order correction vanishes can be found from the condition 30 b b 2 b d 2 the explicit form of 30 is given in appendix b for an arbitrary value of the hinge location l h h there is no dependence on the wave steepness ε the solution of the equation 30 is plotted in fig 5 the effects of nonlinearity are considered in sequel for the water depths beyond the range studied in fig 5 4 validation of the method to validate the generation method described above experiments were carried out in a wave flume equipped with a paddle wavemaker the 2nd order effects are most pronounced at intermediate depth with kh 0 2π the wavemaker in our facility is ineffective in those conditions because of limitations on maximum inclination angle of the paddle leading to an inability to generate a wave with a desired steepness therefore in this case verification for the intermediate depth is carried out using the fully nonlinear numerical wave tank nwt based on boundary element method bem with a piston type wavemaker the nwt was carefully validated against experimental data in deep water by khait and shemer 2018 the same method was also extensively tested by grilli et al 1989 grilli and svendsen 1990 grilli and subramanya 1996 grilli and horrillo 1997 for different conditions including propagation of the breaking wave under variable bathymetry from deep water to the beach 4 1 experimental facility the tau wave flume is 18 m long 1 2 m wide 0 9 m deep and filled to the mean water depth of 0 6 m the wavemaker is controlled by computer wave energy absorbing sloping beach of 3 m long located at the far end of the flume significantly reduces the reflection of waves an instrument carriage with longitudinal position controlled by a computer carries four resistance type wave gauges mounted along the flume with the spacing of 0 2 m between the adjacent gauges the experiments including the wave generation and data acquisition are controlled by a single labview program ensuring precise synchronization static calibration of the wave gauges was performed prior to every experimental run by variation of the vertical position of the wave gauges using a fully automatic procedure the outputs of the wave gauges and instantaneous coordinates of the paddles were sampled at the rate of t 0 128 where t 0 is the carrier wave period 4 2 numerical wave tank nwt the unidirectional wave train is simulated in two dimensional constant depth numerical domain ω shown schematically in fig 6 in the beginning of every simulation the domain has an undisturbed rectangular shape bounded by four boundaries the bottom γ b and lateral γ l boundaries represent perfectly reflecting solid walls γ wm is the moving boundary representing piston or paddle wavemaker and γ fs is the free surface the boundaries are defined on a one dimensional grid consisting of regular and corner nodes the exact values of the flow parameters are defined at the nodes while interpolation is applied between the adjacent nodes introducing fluid velocity v φ the green s identity is applied to solve the potential flow in the domain ω 31 α r s φ r s γ φ n r ψ r r s φ r ψ n r r s d γ here ψ r r s 1 2 π ln r r s is the fundamental solution that represents the potential flow at point r due to a source located at r s the geometric factor α π for regular nodes and α π 2 for corner nodes the integration was carried out along the closed circuit γ γ f s γ l γ b γ w m equation 31 is solved numerically using the boundary element method bem grilli et al 1989 grilli and subramanya 1996 grilli and svendsen 1990 the 3rd order accurate mii local interpolation technique grilli and subramanya 1996 was implemented using a sliding cubic boundary element defined by four neighbor grid nodes as shown schematically in fig 6 only the central part of the boundary elements was used for the numerical integration of 31 while the extreme nodes of the element defined the curvature of the central part the system of the discretized equations can be written in the matrix form 32 a φ b φ n where a and b are known n n matrices φ and φ n are unknown vectors with the length of n n being the number of the nodes additional set of equations obtained by differentiation of 32 with respect to time is used to find the values of φ t and 2 φ t n a half of the 2n unknowns in 32 is determined by the boundary conditions 33a γ w m φ n u w m 33b γ b a n d γ l φ n 0 33c γ f s d φ d t g z 1 2 φ 2 p ρ b f x t e r m 1 2 μ d ρ 2 φ s 2 b f x t e r m 2 33d γ f s d r d t φ where r x z is the radius vector in the global coordinate system u wm t is the prescribed normal velocity of the wavemaker equations 33a and 33b define naturally the velocity component normal to the boundaries γ b γ l and γ wm the values of the potential at the free surface nodes and their positions are found from equations 33c and 33d respectively the numerical integration of 33c d was performed using the 2nd order taylor expansion of the radius vector r and the potential φ at the free surface nodes the expansion terms are estimated by the 4th order interpolation polynomial defined in the local n s coordinate system see fig 6 two additional terms were introduced into 33c to take into account the numerical absorbing beach shown schematically in fig 6 grilli and horrillo 1997 tian et al 2010 the beach minimizes the wave reflection from γ l the artificial pressure and the beach function are defined as follows 34a p p d ρ g h φ n 34b b f x 1 2 1 tanh b ε x x o r i g x e n d x o r i g where ρ is the water density p d and b ε are the dimensionless constants x orig and x end are coordinates of the beach origin and the end see fig 6 values of the constants were set according to khait and shemer 2019 b ε 6 p d 2 and μ d 1500 pa s for steep waves the stokes drift of the free surface nodes was observed resulting in a considerable increase of the distances between adjacent nodes in the vicinity of the wavemaker to maintain sufficient accuracy of the simulations adaptive domain regridding subramanya and grilli 1994 was applied to restore a nearly uniform distribution of the nodes over the boundaries since the free surface nodes have all degrees of freedom interpolation was applied to find the variation of the surface elevation with time at the fixed location x p see fig 6 the length of the domain was set such that x p l nwt 4 while l b l nwt 2 was taken to ensure good performance of the numerical beach different grids were considered while generating the regular wave field consisting of a single free harmonic with t 0 0 7 s see table 1 it was found that the grid density of at least 40 nodes m grid 2 results in a grid independent solution in agreement with khait and shemer 2018 once the spatial configuration is found the integration time step was set as δt t 0 2 n the value of n is taken to provide the courant number cfl 0 1 grilli et al 1989 grilli and subramanya 1996 grilli and svendsen 1990 35 c f l g h δ t δ r min where δ r min is a minimum distance between the adjacent nodes of the grid 5 results 5 1 linear transfer function the linear transfer function is applied to obtain the 1st order wavemaker motion as discussed above it was shown aknin and spinneken 2017 ursell et al 1960 that the actually measured values of the transfer function may significantly deviate from the theoretical values by more than 15 for some cases leading to appreciable inaccuracies in wave generation these discrepancies were attributed to the fluid leakage at the wavemaker as well as to viscous and nonlinear effects aknin and spinneken 2017 application of the nwt allows to circumvent any effects of viscosity and leakages thus enabling to analyze alternative possible reasons for inaccuracy of the transfer function the linear transfer function relating amplitudes of the surface elevation and the wavemaker displacement is conventionally defined as 36 c 1 a 1 b 1 ω 1 λ 1 a regular monochromatic free wave field was generated in the nwt using 29 with b b 2 b d 2 0 the parameters of the numerical model were set as follows domain length l nwt 6 m wave period t 0 0 7 s mean water depth h and wave amplitude a 1 were varied to study different wave excitation regimes the dominant amplitude a 1 of the wave field was determined from the spectrum of the surface elevation recorded at x p 3h during the numerical simulation comparison of the theoretical values of the linear transfer function with those determined in the numerical simulations is presented in figs 7 and 8 for piston and paddle wavemakers respectively significant deviation of the theoretical value of c 1 from that obtained in the numerical simulations is observed for steep waves with ε ka 1 0 25 see figs 7 a and 8 a this observation implies that viscosity and fluid leakages at the wavemaker have only a minor if any contribution to the observed inaccuracy of the linear transfer function the problem apparently stems from neglected nonlinear effects which may include the impact of the mean current f in 21a disregarded in the derivations the coefficient β is introduced to account for the deviation of the transfer function its value was found to be dependent mainly on the wave steepness ε and in some extent on water depth kh the value of β tends to zero when ε is low and may exceed 10 for extremely steep waves cf figs 7 b and 8 b the nearly quadratic dependence of β on ε corroborates the conjecture that nonlinearity is the dominant factor responsible for the inaccuracy of the transfer function 5 2 generation in intermediate depth two different cases are investigated first we test the accuracy of the wave generation method against the experimental results reported in schäffer 1996 for the wave train with the most pronounced nonlinear effects to this end we consider the generation of a monochromatic free wave in intermediate depth with the following parameters mean water depth h 0 7 m wave period t 0 3 s wave length λ 0 7 45 m dominant amplitude a 1 7 cm k 0 h 0 59 0 19π ε k 0 a 1 0 06 the nonlinearity parameter introduced by schäffer is equal to s 1 08 in this limiting case while the applicability limit of the theory s 1 is reported in schäffer 1996 numerical simulations were performed in nwt using both linear and nonlinear 2nd order wavemaker motion according to 29 to enable comparison with measurements reported in schäffer 1996 the surface elevation variation with time was recorded at three locations x p 1 4 and 8 7 m results of the linear wave generation are plotted in fig 9 a b c together with the theoretically expected 2nd order wave shapes shown for the reference note that close to the wavemaker x p 1 m the surface elevation has a nearly sinusoidal shape because the distorting bound wave is effectively cancelled by the parasitic free wave arising at the frequency of the bound wave since the parasitic wave propagates with the phase velocity different from that of the bound wave the shape of the free surface becomes distorted farther away from the wavemaker application of the 2nd order wavemaker motion as described in section 2 eliminates the parasitic wave leading to the free surface shape independent of the distance from the wavemaker fig 9 d e f the wave shape obtained in nwt practically coincide with both target wave form and with the experimental results of schäffer 1996 generation by the piston wavemaker of the wave train having bi chromatic free wave spectrum is now investigated the 1st order surface elevation at the wavemaker is 37 η 1 a 0 2 cos ω 0 δ ω t cos ω 0 δ ω t the parameters were set to be close to the previous case in terms of the wave steepness and water depth h 0 6 m t 0 2 8 s ω 0 2π t 0 λ 0 6 44 m δω ω 0 10 a 0 6 15 cm k 0 a 0 0 06 k 0 h 0 186π the results of the numerical simulation in nwt with application of the linear wavemaker motion are presented in fig 10 the surface elevation variation with time fig 10 a contains both free and bound waves as in fig 9 significant deviation of the wave shape from the prescribed one is caused by parasitic free waves at frequencies of bound waves the difference in phases of the parasitic and the bound waves is dependent on the distance from the wavemaker which leads to the variation of the surface elevation amplitudes at the second harmonic 2δω 2 ω 0 δω 2ω 0 shown by error bounds in fig 10 b the amplitude spectrum of the 2nd order motion of the piston wavemaker required for the accurate generation of the bi chromatic wave train is plotted in fig 11 c application of the corrected wavemaker motion as a boundary condition in nwt leads to the surface elevation variation that is in a very good agreement with the target see fig 11 a moreover the variation with the distance from the wavemaker of the surface elevation amplitudes at the 2nd order is almost completely eliminated cf figs 10 b and 11 b thus indicating at the substantial reduction of the parasitic waves content 5 3 generation in deep water the accuracy of the method for a paddle wavemaker in deep water is now investigated first generation of bi chromatic narrow banded wave train 37 is considered to satisfy deep water conditions the carrier wave period was reduced while leaving all other wave train parameters unchanged see table 2 the wave steepness k 0 a 0 and the water depth k 0 h were limited by the maximum possible paddle displacements in the experimental facility in case 1 table 2 the water depth k 0 h 0 78π approximately satisfies the deep water conditions it is expected that in this regime the finite displacements of the wavemaker surface x d 2 will constitute the main contribution to the 2nd order correction of the wavemaker motion the linear driving signal b d 2 b b 2 0 using theoretical values of the transfer function was utilized in experiments to measure the reference surface elevation the length of a single wave group in this case is such that four groups occupy almost full length of the flume taking into account that first group is affected by nonlinearities at the leading edge of the wave sequence the bi chromatic spectrum is constructed based on the third and the forth wave groups to avoid contamination of the measurements by the reflected waves from the far end of the flume the wave gauges were located within the range 0 8 m x p 4 0 m with the spatial step of 0 2 m an amplitude spectrum of the surface elevation in the wave train excited by the linear driving signal is plotted in fig 12 c contrary to numerical simulations cf figs 10 and 11 in experiments the spectra are contaminated by noise caused by the imperfect paddle motion as expected a discrepancy is found in the amplitudes of the 2nd order harmonics some inaccuracies also appear even for the 1st order free harmonics since the theoretical values of the transfer function were utilized here for wave train generation the measured values of the surface elevation are slightly underestimated fig 12 e to improve the wave generation accuracy the values of the transfer function c 1 related to λ 1 by 36 were measured experimentally by excitation of the monochromatic free wave with the prescribed amplitude combination of experimental values of c 1 and λ 1 with the accurate to the 2nd order driving signal see fig 12 b leads to the averaged spectrum and the surface elevation plotted in fig 12 d f which agree very well with the theoretical predictions fig 13 examines the results of the nonlinear wave generation of the deep water wave trains denoted by 2 and 3 in table 2 the measured values of the amplitudes of the 1st and the 2nd order harmonics are close to the theoretical predictions even though the wave steepness in those cases is appreciably higher as compared to case 1 the impact of the bound waves relative to the free dominant waves is less pronounced in deeper water cf figs 12 and 13 consider now a broad banded wave train with the gaussian shaped envelope so that the 1st order surface elevation at x f 4 m is given by 38 η 1 x f t a 0 exp t m t 0 2 cos ω 0 t here m 0 6 defines the spectral width of the wave train the following parameters were selected t 0 0 7 s ω 0 2π t 0 a 0 3 04 cm k 0 a 0 0 25 k 0 h 1 6π relative spectral width at a half amplitude is δ ω 1 2 ω 0 0 88 confirming that the spectrum is indeed broad banded the spectral representation of 38 is 39 η 1 x t j re a j 1 e i k j x ω j t where wave number k j is related to the angular frequency ω j by the linear dispersion relation 13 the spectrum a j 1 also has a gaussian shape substitution of x 0 into 39 defines the 1st order surface elevation at the wavemaker location in broad banded wave trains spectral domains of bound and free waves may overlap the 2nd order spectrum of the wavemaker motion computed as specified in section 2 is plotted in fig 14 a since b d 2 and b b 2 are smaller by orders of the magnitude than b 1 the effect of the nonlinear correction of the wavemaker motion is expected to be minor attention should be given to the frequency dependent linear transfer function the values of the transfer function at different frequencies were iteratively adjusted using nwt and the algorithm presented in shemer et al 2007 khait and shemer 2019 see fig 14 b the transfer function obtained as a result of such iterative adjustment may significantly reduce the inaccuracies in the wave generation close to the carrier frequency ω 0 the values of the transfer function obtained in the numerical simulations are practically identical to the theoretical values at ω 2ω 0 the transfer function obtained numerically tends to zero since the amplitudes of the free wave harmonics are negligibly small at those frequencies the agreement of the theoretical values of the transfer function and those obtained in the fully nonlinear simulations stems from the fact that in a broad banded spectrum comprised on numerous harmonics the wave steepness of each individual harmonic is small within the limits of validity of the linear theory cf figs 7 and 8 the nonlinear driving signal depicted in fig 14 a was applied in experiments the wave gauges covered the range 1 2 m x p 2 6 m with the spatial step 0 2 m the averaged surface elevation spectrum and error bounds presented in fig 14 c agree well with both the theoretically expected and the numerically simulated spectra the errors are negligibly small in the vicinity of the carrier frequency ω 0 and increase at frequencies that differ notably from ω 0 remaining lower by several orders of the magnitude than the dominant amplitudes the theoretical 1st order surface elevation was calculated at x p 2 m using 39 and supplemented by the 2nd order bound waves using 17a the measured and simulated surface elevation variation with time at x p 2 m is found to agree very well with the theoretical prediction see fig 14 d 6 conclusions accurate generation of nonlinear waves by wavemakers may constitute a significant problem in experimental investigations the 2nd order wavemaker theory developed by schäffer 1996 is one of the most comprehensive approaches applied so far to improve the wave generation accuracy this theory introduces 2nd order correction to the wavemaker motion calculated from the spectrum of the 1st order free waves given at the wavemaker location the derivations start from basic equations of the potential flow theory with nonlinear boundary conditions on both free surface and at the wavemaker resulting in significant complexity of the final expressions the theory by schäffer requires surface elevation spectrum as an input parameter the experiments in wave flumes are often used for validation of different theoretical models of the nonlinear water waves resulting in solutions in different forms such as the complex surface elevation spectrum in the fourier space which is the outcome of the zakharov model zakharov 1968 or the complex envelope in the physical space in the nonlinear schrödinger mei 1989 or modified nonlinear schrödinger trulsen and dysthe 1996 models an alternative analytic method of determination of nonlinear correction to the wavemaker motion is offered here that allows definition of the target wave field in either fourier or physical space rather than starting the derivation from the governing potential flow equations as in the theory by schäffer advantage is taken here of the existing nonlinear wave models supplemented by the nonlinear boundary condition at the wavemaker since the existing nonlinear water wave theories are accurate to the 3rd and higher orders the present approach makes possible to circumvent the 2nd order limitation of the schäffer theory this approach allows significant simplification of the procedure needed for determination of the nonlinear correction to the wavemaker driving signal which is critical in many practical applications the method was carefully validated against schäffer s theory which has no limitations on the width of the surface elevation spectrum the approach based on the zakharov model that is also free of any restrictions on the spectral width was thus used in the present paper for computation of 2nd order bound waves for narrower spectra the expressions based on the nonlinear schrödinger equation or its extension by dysthe can be used for that purpose the accurate to the 2nd order wavemaker driving signal was also validated against experiments in the wave flume in deep water and against the fully nonlinear numerical simulations in intermediate depth it was found that the 2nd order correction to the wavemaker motion disappears at a certain water depth this depth depends on the geometry of the wavemaker particular attention was given to significant deviation of the linear wavemaker transfer function obtained in the fully nonlinear numerical simulations from the theoretical predictions this deviation was observed in numerous experimental works the existence of such a deviation in fully nonlinear simulations of potential flow indicates that viscous friction and possible leakages at the wavemaker that were suggested as a possible source for this effect can only play a minor role the quadratic dependence on the wave steepness of the relative deviation of the transfer function from the linear predictions suggests that the mean current at the 2nd order that results from the nonlinear interaction of the velocity field of the propagating waves with the wavemaker surface oscillations of finite amplitude is a possible reason for this inaccuracy a more careful investigation is needed to clarify the reasons for this behavior of the transfer function acknowledgements this study was supported by a grant 3 12473 from israel ministry of science technology and space and by a grant 306 15 from israel science foundation appendix a the coefficients in 18 required for the determination of the 2nd order bound wave harmonics in the nonlinear amplitude spectrum of the surface elevation stiassnie and shemer 1984 1987 v 1 ω 0 ω 1 ω 2 k 0 k 1 k 2 1 4 π g 2 1 2 ω 0 ω 1 ω 2 ω 1 ω 2 g 2 k 1 k 2 ω 2 ω 0 ω 1 ω 0 ω 1 g 2 k 0 k 1 v 2 ω 0 ω 1 ω 2 k 0 k 1 k 2 1 4 π g 2 ω 2 ω 0 ω 1 ω 0 ω 1 g 2 k 0 k 1 ω 1 ω 0 ω 2 ω 0 ω 2 g 2 k 0 k 2 ω 0 ω 1 ω 2 ω 1 ω 2 g 2 k 1 k 2 v 3 ω 0 ω 1 ω 2 k 0 k 1 k 2 1 4 π g 2 ω 2 ω 0 ω 1 ω 0 ω 1 g 2 k 0 k 1 1 2 ω 0 ω 1 ω 2 ω 1 ω 2 g 2 k 1 k 2 appendix b the dimensionless mean water depth associated with the zero 2nd order correction to the wavemaker motion can be found from the solution of the equation b 1 u b 2 u d 2 0 where u b 2 and u d 2 are defined by 19 and 25 respectively considering a monochromatic free wave equation b 1 can be written as follows b 2 3 k 4 k h sinh 4 k h 1 2 sech 2 k h sinh 4 k h 2 k h l w m coth k h 1 1 2 sech 2 k h k 2 ω 2 2 k h sinh 2 k h 1 cosh k h k h l w m sinh k h 1 cosh k 2 ω h k 2 ω h l w m sinh k 2 ω h q 0 b 3 q k 2 ω cosh k k 2 ω h k k 2 ω 2 k 2 ω cosh k k 2 ω h k k 2 ω 2 2 k 2 k 2 ω 2 k 2 k 2 ω 2 h l w m k 2 k 2 ω 2 2 k cosh k 2 ω h sinh k h k 2 ω cosh k h sinh k 2 ω h here k k 1 is the wave number of the 1st order free wave wave number k 2ω corresponds to the free wave with the double frequency 2ω 1 b 4 4 k tanh k h k 2 ω tanh k 2 ω h solution of the equation b 2 with respect to kh is plotted in fig 5 
22801,in this paper wavelet analysis of the cavitating flow over a sphere is reported unsteady and dynamic behaviors of cavitation were captured using large eddy simulation les turbulence approach and sauer mass transfer models numerical simulation is implemented under the framework of openfoam within the interphasechangefoam solver the simulation is conducted over a wide range of cavitation numbers two more essential variations pressures and kinetic energies were considered at specific points in front and behind of the sphere s body for sufficient simulation period the oscillations global frequency modes and spectral content of the cavity cloud are computed and analyzed using fourier and continuous wavelet transformations the computed results show that the flow fluctuations enhance by increasing the cavitation number the low frequency fluctuations play a pivotal role in the cavitating flow and possess almost the same magnitude in all investigated cavitation numbers the frequencies enhance as the simulation time increases in all cases one of the primary frequencies that happened in all cavitation numbers in the cavity cloud separation is due to a strouhal number within the range of 0 046 and 0 05 therefore this strouhal number can be used for the purpose of cloud cavitation detection keywords unsteady cavitation wavelet transform fourier transform sphere large eddy simulation les 1 introduction cavitation is a multi phase and complex physical phenomenon that happens when the local pressure of the liquid becomes lower than its saturated vapor pressure in most cases cavitation damages the equipment reduces the system efficiency by making erosion noises vibrations and unsteady behaviors which are not favorable due to such problems this phenomenon has long been under scrutiny cavitation number σ p p v 0 5 ρ u 2 categories cavitation regimes where ρ is the liquid density p v is the vapor pressure and p u are the free stream flow pressure and velocity respectively several cavitation regimes are depending on the cavitation numbers such as incipient cavitation shear cavitation sheet cloud cavitation and supercavitation diagnosing different phenomena such as shedding and collapsing in different cavitation regimes appears very helpful in realizing physical behavior in the considered fluid signal processing is one of the versatile tools to analyze the fluctuations and changes in unsteady systems or processes therefore it is evidently useful in the detection of cavitation phenomena many different experimental and numerical investigations reported on cavitating flow although there are just a few studies considering cavitating flows over the sphere marston et al 2011 using a high speed camera considered the dynamics of cavitating flow passing over a sphere to investigate cavitation structures in both newtonian and non newtonian liquids by changing its viscosity shang et al 2012 investigated the cavitating flow numerically around a submarine using les turbulence models validating their data with that of experiments then they found out how the cavitation number affected the circumfluence of the tail regions they also found that in small cavitation numbers between 0 1 and 0 4 the cavity cloud lasted continuously gnanaskandan and mahesh 2016 reported a numerical investigation on cavitation around a circular cylinder at reynolds numbers ranging between 200 and 3900 for different cavitation numbers from 0 5 to 2 they captured the dynamics of cavity formation and its collapse in their simulations the reported results show that when σ 1 0 the cavity detaches itself from the body at the shedding frequency however in the transitory regime of cavitation when the cavitation number was between 0 5 and 0 7 in addition to the shedding frequency there exists a cavity detachment phenomenon in low frequencies pendar and roohi 2016 stimulated cavitating flow in hemispherical head bodies and conical cavitators they compared the result of les and k ω sst turbulence models as well as predictions of various cavitation mass transfer models in another study roohi et al 2016 they investigated unsteady cavitating flow behind a 3 d disk cavitator pendar and roohi 2018 simulated the cavitating flow passing over a sphere at a constant reynolds number of 1 5 106 and a wide range of cavitation numbers varying from 0 36 to 1 and compared the results with the experimental data they reported the detailed analyses of the instantaneous cavity leading edge its separation point location and vortex shedding alongside numerical and experimental studies focused on understanding the physics of cavitating flows there is experimental research considering signal processing in different cavitation regimes cudina čdina 2003 used the audible sound of a centrifugal pump to detect the cavitation he did experiments to discover the incipient and the development of cavity cloud experimental results illustrated that there was a discrete frequency tone within the audible noise spectra which was strongly dependent on the cavitation process and its development escaler et al 2006 evaluated the detection of cavitation in an actual hydraulic turbine experimentally they analyzed the acoustic emissions measurements of the structural vibrations and hydrodynamic pressures in a particular machine they found out that by increasing the cavitation strength the amplitude of the entire spectrum increases without any significant change in its shape using an algorithm based on the hilbert transform they computed the amplitude of the filtered signal he and liu 2011 used the wavelet scalogram analysis to figure out the characteristics of the cavitation noise they investigated the time frequency characteristics of the cavitation noise in various cavitating states and processes experimentally by recording audible sounds their results showed that the cavitation noise could be distinguished from the background noise because of its different frequency characteristic furthermore they mentioned that the wavelet scalogram method was very potent for the time frequency analysis of the cavitation noise lee et al 2013 expressed the useful application of signal processing techniques in the detection of the vortex tip and cavitating noise in marine propeller based on the acoustical measurements in their study the short time fourier transform stft analysis and the detection of envelope modulation on noise demon spectrum analysis were employed they illustrated that these two techniques are appropriate for finding such a repeating frequency also they observed that these two techniques had been successfully employed for identifying the vortex tip ji et al 2013 considered cavitating flow around hydrofoils using the partially averaged navier stokes method their predicted cavity characteristic compared favorably with the experimental data ji et al ji et al 2014 09 investigated the structure of the cavitating flow around a twisted hydrofoil using a modified k ε model with a local density correction for turbulent eddy viscosity their prediction for the cavity structures and the shedding frequency were in suitable agreement with the experimental observations giorgi et al de giorgi et al 2015 implemented an experimental study of cavitating flows inside a restricted nozzle the cavitation phenomena were characterized by four different flow regimes at the variation of the pressure and temperature they analyzed the signals with the wavelet transform to highlight the influence of the temperature the required data is acquired by pressure signals and images of the cavitating flow field kang et al 2017 employed the wavelet transform for their experiments on aa hydro turbine to diagnose whether the cavitation occurs the results illustrated that the characteristics of incipient cavitation could be detected in the audible frequency band they found that the wavelet analysis of noise signals can distinguish the differences of the various operating conditions and also can discriminate between the incipient cavitation and the other regimes of cavitation by visual observations on the other hand long et al long et al 2019 06 recently simulated the cavitating flow around a clark y hydrofoil using implicitly filtered les and a homogenous cavitation model they compared the unsteady cavitating with non cavitating flows the cavitating flow had more fluctuation and total error compared to that of non cavitating recently experimental studies on signal processing and spectrum content analysis of cavitating flow passing over spheres have been reported brandner et al 2010 investigated the cloud cavitation passed over a sphere and captured high speed imaging of the sphere in water tunnel in a constant reynolds number re 1 5 106 in different regimes of cavitation from inception to supercavitation pixel intensity of photos in different cavitation numbers was studied using wavelet transform because of the limitation in data collection in their study they asserted that higher spatial and temporal resolutions are required graaf et al de graaf et al 2016 investigated the physics and spectral content of cloud cavitation of a sphere experimentally in a water tunnel by high speed imaging and surface pressure measurement the power spectral densities of the long sampled normalized pressure signals were analyzed using the welch and wavelet methods they identified three distinct shedding regimes an uni modal regime for σ 0 9 and two bi modal regimes for 0 675 σ 0 9 and 0 3 σ 0 675 they found that at high cavitation numbers σ 0 9 where cavity lengths are small the breakup was driven by small scale instabilities in the overlying boundary layer however in cavitation numbers below 0 9 greater cavity lengths allow large scale shedding to develop driven by coupled re entrant jet formation and shockwave propagation in a recent work venning et al 2018 used a high speed image set of cloud cavitation about a sphere then they used fast fourier transforms applied to individual pixel intensities of image frames they found three shedding frequencies in their analyses including the main shedding mode the subharmonic mode and the harmonic mode brandner et al 2018 investigated wavelet methods used in cavitating fluid flows precisely containing cross wavelet transform and wavelet transform plots to comprehensive review into this complex phenomenon as the above literature survey indicates a few reports on the spectral content analysis of cavitating flows with an emphasis on sphere cavitation are available on the other hand the available signal processing research on the sphere cavitation are experimental brandner et al 2010 de graaf et al 2016 venning et al 2018 which were claimed that because of limitations in data collection higher spatial and temporal resolutions are required furthermore numerical studies help to widen the range of studied cavitation numbers in contrast to previous works on signal processing of cavitating flows where fluctuation data was gained by capturing images acoustic recorders or pressure sensors here flow properties in different points near the sphere are captured numerically during the time over a wide range of cavitation numbers then the data is analyzed utilizing wavelet and fourier transforms 2 mathematical modeling 2 1 governing equations cavitating flow is a multiphase flow obeying the navier stokes equations in this study the incompressible homogeneous mixture multiphase flow was assumed thus the governing equations are described as follows 1 t ρ ρ v 0 t ρ v ρ v v p s where ρ v p and s are density velocity pressure and viscous stress tensor respectively the rate of strain tensor d is given as 2 d v v t where viscous stress tensor defined as s 2μd a multiphase flow modeling should be used to describe a phase change from liquid to vapor that happens under cavitation in this study we consider a two phase mixture method this method uses a local volume fraction transport equation with a source term incorporating the rate of mass transfer between the two phases due to cavitation 3 t γ v γ s a the mixture density ρ and dynamic viscosity μ are given as follows 4 μ γ l μ l 1 γ l μ ϑ 5 ρ ρ l γ l 1 γ l ρ ϑ also s a is the phase change rate between vapor and liquid and γ is the liquid volume fraction indicator defined as follows 6 γ 1 0 0 γ 1 w a t e r v a p o r i n t e r f a c e for tracking the interface between the vapor and liquid phases a compressive volume of fluid vof method is utilized to treat eq 3 the compressive vof equation utilized in the openfoam considers eq 5 in the following form 7 t γ γ v v c γ 1 γ s a where vc is the compressive velocity term as suggested by rusche 2003 and the last term in the left side of the vof equation eq 7 is a surface compression term that is active at the interfaces for further information on the compressive velocity vof technique see roohi et al 2013 05 klostermann et al 2013 the schnerr sauer mass transfer model is used in this study given by 8 t γ γ v ρ ϑ ρ l ρ 1 γ γ 3 r b 2 3 p ϑ p ρ l where r b is the radius of bubbles is derived as follow 9 r b 3 4 π n 0 γ 1 γ 1 3 where in the interphasechangefoam solver the initial number of bubbles n 0 is set as 1 6 109 for further information on the schnerr sauer mass transfer model see schnerr and sauer 2001 2 2 large eddy governing equations the construction of large eddy simulation les turbulence approach is based on computing the large scale structures that are determined on the computational grid whereas the smaller sub grid eddies are modeled filtering operation of a variable e g is carried out using a predefined filtering function g g x δ this function employs a cut off length scale δ where smaller scales than that are not involved in in other words scales smaller than δ are subtracted from the filtered function x t where δ is defined as sub grid scale and is a sub grid term that consists of sub grid scales 10 x t r t g x r t t d t d r 11 δ depends on the computational grid size e g 12 δ δ x δ y δ z 3 convolving g function within continuity and momentum equations filtered equations of continuity and momentum employed in the les approach are derived 13 u i x i 0 14 u i t x j u i u j 1 ρ p x i x j τ i j x j υ u i x j u j x i here all variables with an overbar denote filtered parameters the most crucial aspect of the equations mentioned above is the presence of x j τ i j term that is unknown a priori and is present in the navier stokes equations following shang et al 2012 it is feasible to express τ i j as 15 τ i j u i u j u i u j τ i j is termed as sgs stress tensor and is usually modeled indeed τ i j resembles the reynolds stresses in the reynolds averaged navier stokes rans methods there are various types of approaches to model the sub grid stress tensor τ i j prevalent sub grid modeling approaches utilize an eddy or sub grid viscosity μ k where μ k can be calculated using a wide variety of approaches in the eddy viscosity model we have 16 τ i j 2 3 ρ k i 2 μ k s i j 17 s i j 1 2 u i x j u j x i where s ij is the rate of strain tensor for the resolved scale and the sub grid scale turbulent viscosity μ k is closed by a local eddy viscosity model here the one equation eddy viscosity model oeevm sub grid scale is used to obtain turbulence kinetic energy k oeevm solves the following equation 18 ρ k ρ k u τ i j s i j μ k k ρ ε 19 ε c ε k 3 2 δ sub grid scale turbulent viscosity μ k is then computed by 20 μ k c k ρ δ k while c ε and c k are set as 1 048 and 0 094 in openfoam respectively in large eddy simulation approach the eddies are divided into two categories including grid scales and sub grid scales sgs the conservation equations are governed for grid scales while sgs models are used for simulating the small scale elements in the flow in the current study the flow is modeled using one equation eddy viscosity model oeevm as sub grid scales modeling this model is selected because of two reasons including its successful usage in previous cavitation works and its lower computational cost first previous works pendar and roohi 2018 roohi et al 2013 05 zahiri and roohi 2018 12 showed that oeevm model is accurate enough in simulating cavitating flow and capturing cavity shedding second the computational cost is an essential factor in cavitating flow simulations recently different sub grid scale models namely oeevm and dynamic smagorinsky ds were studied in treating cavitating sphere flow zahiri and roohi 2018 12 in addition to accurate prediction of general properties of the cavity cloud such as the length diameter and pressure drag coefficient the computational cost of the oeevm was slightly lower than the ds model therefore oeevm sub grid scales model is selected here and well validated with the experimental data de graaf et al 2016 for managing different values of y for the first grid cell a blending function is employed in openfoam which is given by spalding law as given by damián and nigro 2010 de villiers 2006 21 y u 1 e e κ u 1 κ u 1 2 κ u 2 1 6 κ u 3 where κ 0 4187 e 9 y y u τ ν and u u u τ therefore the first off the wall grid point can be in the buffer or viscous regions y 30 without the loss of accuracy as the function beneficiary 2 3 pressure velocity coupling the velocity pressure coupling is achieved using the pimple algorithm that is a hybrid piso simple algorithm employed in the openfoam the pimple consists of three parts a momentum predictor a pressure solver and a momentum corrector in the pimple for stability purposes an outer correction loops i e cycling over a given time step for a number of iterations and equation under relaxation between outer correctors are allowed the pimple provides a more robust pressure velocity coupling by coupling a simple outer corrector loop with a piso inner corrector loop this algorithm demonstrates better stability for larger time steps compared to piso here we employed two piso iterations and one simple iteration more details of the numerical procedure are available in pendar and roohi 2018 2 4 spectrum analysis in this study two methods fast fourier transforms fft and wavelet transforms are used for processing data obtained using the interphasechangefoam solver the fft disintegrates time series data into the frequencies that influence it the fourier transformation of a function x t is expressed as 22 x f x t e 2 j π f t d t let x 0 x n 1 be complex numbers the discrete fourier transform dft is defined by the following formula 23 x k n 0 n 1 x n e i 2 π k n n k 0 n 1 dft performs o n2 operations to reduce the number of operations and calculation time the fft is introduced that produce the same results but with a much lower number of operations e g o n logn continuous wavelet transforms cwt is a way to transform a time based function into wavelets which provide a time frequency representation of a signal specifying the location of frequencies at different times the continuous wavelet transformation of a function f t is expressed by 24 f t ψ a b t 1 a 1 2 f t ψ t b a d t where a b and ψ t are scale a 0 translational time and mother wavelet respectively the primary purpose of the mother wavelet is to give a source capacity to generate the little daughter wavelets which are the interpreted and scaled forms of the mother wavelet when the scale factor is moderately low the signal is more contracted which in turn results in a more detailed resulting graph however when the scale factor is high the signal is extended to analyze the spectral content of the cavitating flows in the sequel of this paper we use cwt since discrete signals are noticeable the reason is that interpreting the amplitude of wavelet coefficients is difficult in a discrete wavelet transform dwt sampling and decreasing time intervals to zero give approximate of cwt in this method the scale parameter is discretized on logarithmic cells and the time parameter is discretized on its scale if it is defined 25 ψ a t 1 a ψ t a to discretize cwt equation eq 24 assume that the input function f t is a length n vector x n thus the discretized variant of cwt is 26 w a b n 0 n 1 x n ψ a b n the discretized version of cwt solves this equation for each value of the shift parameter b and repeat this process for each scale a there is an approximate relation which converts scales to frequencies this relation is determined by the center frequency of the wavelet f c as given 27 f a f c a δ where δ and f a are the sampling period and the pseudo frequency corresponding to the scale a respectively the strouhal number is a dimensionless number describing an oscillating flow e g 28 s t f l u where l is the characteristic length 2 5 problem description fig 1 and fig 2 show schematically the geometry of the considered problem boundary conditions and solution procedure respectively in agreement with the experimental data of australian maritime college s tom fink cavitation tunnel brandner et al 2010 a sphere whose diameter is 0 15 m is placed at the center of a water tunnel with a dimension of 0 6 m 0 6 m 2 6 m the inlet velocity of the water tunnel is 9 m s the spherical surface is specified as a no slip wall reflector the quality of the computational grid has a direct influence on the accuracy of numerical results the grid convergence indicates that grid with around 5 106 cells provides a converged solution for the cavity characteristic the spacing of the grid near the surface of the sphere s body is the same size in all three directions in the mentioned grid the normalized wall distance of the first layer of grid nodes near the wall is 6 236 10 4 fig 1 b illustrates that structured quadrilateral meshes were utilized for a typical simulation case at σ 0 5 mean values of y are 2 19 and 5 73 and minimum values of y are around 0 205 and 0 425 for grid 4 and grid 3 respectively there should be a balance between accuracy and computational cost in numerical simulations in this work four different sizes for the case σ 0 5 are considered which are called grid 1 to grid 4 whose number of cells varies from 2 106 to 9 106 in all the studied grids the space near the surface of the geometry is the same size in all directions table 1 reports non dimensional data from all studied grids including the minimum size of the cell and length and the diameter of the cavity by comparing the data of the table grid 3 which provides a converged solution for the cavity characteristic is selected to perform simulations of the current research in the selected grid the normalized wall distance of the first layer of grid nodes near the wall is 6 236 10 4 in the current research the length and diameter of the cavity is computed considering the iso surface of the simulated volume fraction with values of 0 25 a commercial software namely tecplot is employed for finding the length and diameter of the cavity the difference between the current and the previously calculated parameter values specifies residual it increases at the start of each time step and drops some orders of magnitude fig 3 indicates the convergence history of the liquid volume fraction and pressure residuals for a typical case at σ 0 45 the figure also shows the pressure need more iterations in comparison with the volume fraction to reach the appropriate pre set threshold value the residuals of pressure and volume fraction reach around 10 8 and 10 12 respectively the residuals of velocity turbulent kinetic energy were both set at 10 6 in this work the cavitating flow is solved using interphasechangefoam solver at twelve different cavitation numbers 0 1 σ 1 and a constant reynolds number of 1 5 106 the flow is assumed to be unsteady and computations start from initial conditions and continue to about 500 ms the time step size was calculated automatically during the simulation based on the specified courant number we set a small courant number of 0 175 that resulted in an average time step around 10 7 s which is a sufficiently small period to capture cavity shedding the data of volume fraction pressure and kinetic energy are captured during the time in the whole of the domain the fluid properties are specified as ρ l 1000 kg m3 ρ v0 0 02308 kg m3 μ l 9 10 4kg m s μ v 1 10 5kg m s and p v 2300 pa the pressure data is sampled in 345 points around the sphere from its leading edge towards the wake region see fig 2 on the central axis behind the geometry where cloud cavitation occurs next the average of the gathered data is computed during the simulation time subsequently wavelet and fourier transformations are employed to investigate cavity frequency modes in this study the daubechies wavelet which provides desirable results in detecting cavity cycles is considered 3 result and discussion 3 1 validation the numerical results of cavitating flow around the sphere also are compared with the experimental results of brandner s work brandner et al 2010 which has studied cavitation at re 1 5 106 with a σ ranging from 1 0 to 0 36 fig 4 illustrates a comparison between these numerical results and a series of low speed photographic images which is obtained from experimental data fig 5 indicates that les solution in comparison to k ω sst turbulence model suitably captures the unsteady vapor shedding of the cavity behind the sphere that is in agreement with the experimental results fig 6 compares power spectral density psd fraction of current numerical study with that of experimental data reported in venning et al 2018 at σ 0 8 which shows similarity the figure shows a general agreement between the current numerical simulation and experimental data fig 7 illustrates mean velocity contours and the velocity streamlines of flow visualized by lic method line integral convolution stalling and hege 1997 at three cavitation numbers as lic velocity and vorticity pattern depicted in figs 7 8 show the created cavity may little be affected by the walls of water tunnel indeed the presence of the boundary layer is observable over the tunnel walls 3 2 fourier transform analysis in this section the fluctuation of cloud cavitation past the sphere is investigated using a fast fourier transform fft the fft is applied to the mean pressure of selected points inside the domain in each studied cavitation numbers then the dominant frequencies are extracted from the results frequencies are also converted to the strouhal number which is a dimensionless parameter depicting the fluctuations of a system fig 9 compares the psd fractions of the dominant strouhal numbers at different cavitation numbers the psd fraction is defined by dividing psd to the mean psd which is a parameter to show the percentage of each strouhal numbers in the flow according to the figure there are three different regions regarding cavitation numbers also in a recent experimental study three distinct regimes for cavitating flow passing over a sphere were demonstrated as a function of cavitation number de graaf et al 2016 fig 9 a shows two low strouhal numbers which are the most dominant 0 042 and 0 079 labeled as a and b from σ 0 1 to 0 36 psd fractions of a and b experience reductions by increasing the cavitation number it means that by increasing the cavitation number the effect of low frequency parameters of the flow reduces then there are almost sudden increases in those of a and b between σ 0 4 and 0 5 it demonstrates that this range of cavitation numbers is a location where the flow experiences changing in its regime similar to the first region of the line graph that of a and b encounter decrements until σ 0 8 from σ 0 9 to 1 there are slight increases in both a and b fig 9 b illustrates two higher frequencies which are labeled as c and d as the figure shows there are three distinct regions regarding cavitation numbers first for 0 1 σ 0 4 the psd fractions of c and d decrease by increasing cavitation number and fractions are the lowest at σ 0 4 next there is a region between 0 4 and 0 8 where those of c and d fluctuate by increasing the cavitation number then those of c and d remain constant from σ 0 9 to σ 1 this is the third region regarding the cavitation number fig 9 c compares two high frequency signals in the cavitational flow the psd fraction of e and f with strouhal numbers of 0 196 and 0 238 have almost a reverse correlation it means that when one of them has a high value in the psd fraction another one has a lower impact on the cavitating flow in conclusion two strouhal numbers 0 048 and 0 086 are the two most dominant frequencies in the studied cavitating flow over the sphere fourier analysis shows that three regions appeared by changing the cavitation number first oscillation in a cavitating flow with σ 0 4 decreases by increasing the cavitation number next the region where the cavitation number is between 0 4 and 0 9 has higher fractions of high frequencies then there is a region where the cavitation number is higher than 0 9 and has almost constant psd fractions with the cavitation numbers 3 3 wavelet analysis due to the unsteady behavior and various fluctuations of the cavitating flow it is necessary to consider time in the spectrum analysis in this case signals have short term high frequency components and long term low frequency components thus a method is required to produce accurate time resolution and low frequency resolution as well as proper frequency resolution and weak time resolution for high and low frequencies respectively there are different frequencies in different time inside the flow therefore the wavelet analysis may prepare more details about the flow unlike the fourier analysis which provides the same transform for all times the continuous wavelet transform is calculated separately for different parts of the signal in the time dimension in this section the effect of cavitation number on flow fluctuations will be examined based on the time frequency graphs before analyzing the wavelet precisely we briefly explain the formation and development of the cloud cavity in fig 10 cavitation past the sphere can be divided into three different regimes based on how the cavity is shed at very high cavitation numbers σ 1 0 a small stable cavity cloud with breakup due to the re entrant jet is formed at lower cavitation numbers σ 0 9 a moderate length cavity cloud is established which is sufficient enough for the formation of the re entrant jet cavity breakup occurs followed by a vortex shedding in the cavity cloud and also the instabilities of the cavity with a cyclic shedding increase in very low cavitation number i e σ 0 36 an extended supercavity cloud forms without any considerable re entrant jet or large scale breakup fig 11 illustrates the continuous wavelet transform of the cavitating flow around the sphere with a cavitation number of 0 1 until t 500 ms it can be observed that lower strouhal numbers e g st 0 1 have higher altitude in comparison with high range frequencies strouhal numbers moreover according to the figure high range frequencies depicted by e are damped in almost 0 15 s in the previous section the flow was analyzed by the fourier transform method and the five dominant strouhal numbers according to fig 9 were 0 047 0 084 0 120 0 156 and 0 192 respectively similarly as it is shown in the figure five lines a to e are equivalent to them respectively another point perceived from the above figure is that the assigned lines are positively sloped indicating the increase in the strouhal number with time it also can be seen that high frequencies are damped with time furthermore according to fig 11 numbers 1 and 2 are two peaks of line a which is related to the st 0 047 based on the fourier transform as the volume fraction contours show they are the moments which show one dominant type of separation in the cavitating flow in σ 0 1 this type of separation is available in other studied cavitation numbers but it is not the only one in higher cavitation numbers numbers 3 and 4 are two moments in the flow which show one type of shedding at the end of the cloud cavity which is located on peaks of line e in fig 12 fig 12 illustrates the wavelet transform of cavitating flow in σ 0 36 besides it shows phase fraction contours in specified moments in the flow similar to σ 0 1 it can be observed in this figure lower strouhal numbers st 0 1 has higher altitude in comparison with high range frequency ones moreover according to the figure high range frequencies which is shown as e are damped in almost 0 2 s which is higher than σ 0 1 similar to fourier analysis of σ 0 36 which shows that the dominant st of the flow is 0 046 0 084 0 121 0 158 and 0 191 respectively wavelet transform shows the same which are labeled a to e in the figure moreover numbers 1 2 and 3 in fig 12 are three specified moments in the flow which are on the peaks of line a demonstrating st 0 046 based on the fourier transform results these are shedding moments in the flow as depicted in the contour plot similar to σ 0 1 numbers 4 and 5 are located in peaks of line e depicting shedding at the end of the cloud cavity with a divergent shape fig 13 shows the wavelet transform and phase fraction contours in specified moments during the flow simulation where σ 0 5 as the figure shows the wavelet transform has the same structure compared to previous cases labeled lines a to e show the same strouhal numbers as the previous figures similar to σ 0 1 and σ 0 36 line a shows flow separation and line e shows divergent shedding at the back of the cavity cloud according to the wavelet transform by increasing the cavitation number the number of cycles is increased for instance in σ 0 5 the number of cycles of divergent shedding is more than previous cases which have lower cavitation numbers fig 14 shows the wavelet transform and phase fraction contours at different moments in the flow with σ 0 7 the number of cycles of high frequencies in this case is more than previous ones also the duration of cycles before damping is longer than previously studied cases similar to previous cases the assigned numbers show separations and divergent shedding generally it has been observed that an increase in the cavitation number causes more fluctuations in the cavitating flow especially in higher strouhal numbers moreover the wavelet transformation of cavitating flow shows that in all studied cavitation numbers strouhal number which is a dimensionless expression of frequency increases during the studied span of time in other words all labeled lines in figs 11 14 have an ascending trend regarding the time but the slop of lines are different regarding cavitation number and strouhal number besides the line e which almost equals to st 0 196 shows a particular type of shedding in the cavitating flow which is like a divergent funnel and the line a which almost equals to st 0 048 shows a specific type of separation which is dominant in lower cavitation numbers 4 concluding remarks in the present study the cavitation phenomenon around the sphere in different cavitation numbers was analyzed numerically where the effect of changing the cavitation number was shown on the flow fluctuations compared with experimental data besides the fourier transform the flow is analyzed by a wavelet transform the latter is suitable for unsteady three dimensional and discontinuous phenomena like cavitation to show the effects of the time dimension fourier analysis shows that st 0 048 and st 0 086 are two dominant frequencies in the cavitating flow around the sphere at the studied reynolds number moreover while the dominant strouhal numbers are almost the same in all studied cases the value of each one is varying based on the flow regime in other words overall there are three regions in the flow regarding the cavitation number wavelet analysis shows that by increasing the cavitation number more fluctuations in the cavitating flow is obtained especially in higher strouhal numbers in all studied cavitation numbers strouhal number increases during the studied span of time the slop of strouhal numbers lines over time are ascending and different regarding cavitation number and strouhal number therefore fourier analysis cannot be a proper analysis of the cavitating flow st 0 196 shows a special type of shedding in the cavitating flow which is like a divergent funnel similarly st 0 048 illustrates a particular type of separation which is dominant in lower cavitation numbers especially in σ 0 1 but it exists in higher cavitation numbers as well appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 multimedia component 5 multimedia component 5 multimedia component 6 multimedia component 6 multimedia component 7 multimedia component 7 multimedia component 8 multimedia component 8 multimedia component 9 multimedia component 9 multimedia component 10 multimedia component 10 multimedia component 11 multimedia component 11 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 070 
22801,in this paper wavelet analysis of the cavitating flow over a sphere is reported unsteady and dynamic behaviors of cavitation were captured using large eddy simulation les turbulence approach and sauer mass transfer models numerical simulation is implemented under the framework of openfoam within the interphasechangefoam solver the simulation is conducted over a wide range of cavitation numbers two more essential variations pressures and kinetic energies were considered at specific points in front and behind of the sphere s body for sufficient simulation period the oscillations global frequency modes and spectral content of the cavity cloud are computed and analyzed using fourier and continuous wavelet transformations the computed results show that the flow fluctuations enhance by increasing the cavitation number the low frequency fluctuations play a pivotal role in the cavitating flow and possess almost the same magnitude in all investigated cavitation numbers the frequencies enhance as the simulation time increases in all cases one of the primary frequencies that happened in all cavitation numbers in the cavity cloud separation is due to a strouhal number within the range of 0 046 and 0 05 therefore this strouhal number can be used for the purpose of cloud cavitation detection keywords unsteady cavitation wavelet transform fourier transform sphere large eddy simulation les 1 introduction cavitation is a multi phase and complex physical phenomenon that happens when the local pressure of the liquid becomes lower than its saturated vapor pressure in most cases cavitation damages the equipment reduces the system efficiency by making erosion noises vibrations and unsteady behaviors which are not favorable due to such problems this phenomenon has long been under scrutiny cavitation number σ p p v 0 5 ρ u 2 categories cavitation regimes where ρ is the liquid density p v is the vapor pressure and p u are the free stream flow pressure and velocity respectively several cavitation regimes are depending on the cavitation numbers such as incipient cavitation shear cavitation sheet cloud cavitation and supercavitation diagnosing different phenomena such as shedding and collapsing in different cavitation regimes appears very helpful in realizing physical behavior in the considered fluid signal processing is one of the versatile tools to analyze the fluctuations and changes in unsteady systems or processes therefore it is evidently useful in the detection of cavitation phenomena many different experimental and numerical investigations reported on cavitating flow although there are just a few studies considering cavitating flows over the sphere marston et al 2011 using a high speed camera considered the dynamics of cavitating flow passing over a sphere to investigate cavitation structures in both newtonian and non newtonian liquids by changing its viscosity shang et al 2012 investigated the cavitating flow numerically around a submarine using les turbulence models validating their data with that of experiments then they found out how the cavitation number affected the circumfluence of the tail regions they also found that in small cavitation numbers between 0 1 and 0 4 the cavity cloud lasted continuously gnanaskandan and mahesh 2016 reported a numerical investigation on cavitation around a circular cylinder at reynolds numbers ranging between 200 and 3900 for different cavitation numbers from 0 5 to 2 they captured the dynamics of cavity formation and its collapse in their simulations the reported results show that when σ 1 0 the cavity detaches itself from the body at the shedding frequency however in the transitory regime of cavitation when the cavitation number was between 0 5 and 0 7 in addition to the shedding frequency there exists a cavity detachment phenomenon in low frequencies pendar and roohi 2016 stimulated cavitating flow in hemispherical head bodies and conical cavitators they compared the result of les and k ω sst turbulence models as well as predictions of various cavitation mass transfer models in another study roohi et al 2016 they investigated unsteady cavitating flow behind a 3 d disk cavitator pendar and roohi 2018 simulated the cavitating flow passing over a sphere at a constant reynolds number of 1 5 106 and a wide range of cavitation numbers varying from 0 36 to 1 and compared the results with the experimental data they reported the detailed analyses of the instantaneous cavity leading edge its separation point location and vortex shedding alongside numerical and experimental studies focused on understanding the physics of cavitating flows there is experimental research considering signal processing in different cavitation regimes cudina čdina 2003 used the audible sound of a centrifugal pump to detect the cavitation he did experiments to discover the incipient and the development of cavity cloud experimental results illustrated that there was a discrete frequency tone within the audible noise spectra which was strongly dependent on the cavitation process and its development escaler et al 2006 evaluated the detection of cavitation in an actual hydraulic turbine experimentally they analyzed the acoustic emissions measurements of the structural vibrations and hydrodynamic pressures in a particular machine they found out that by increasing the cavitation strength the amplitude of the entire spectrum increases without any significant change in its shape using an algorithm based on the hilbert transform they computed the amplitude of the filtered signal he and liu 2011 used the wavelet scalogram analysis to figure out the characteristics of the cavitation noise they investigated the time frequency characteristics of the cavitation noise in various cavitating states and processes experimentally by recording audible sounds their results showed that the cavitation noise could be distinguished from the background noise because of its different frequency characteristic furthermore they mentioned that the wavelet scalogram method was very potent for the time frequency analysis of the cavitation noise lee et al 2013 expressed the useful application of signal processing techniques in the detection of the vortex tip and cavitating noise in marine propeller based on the acoustical measurements in their study the short time fourier transform stft analysis and the detection of envelope modulation on noise demon spectrum analysis were employed they illustrated that these two techniques are appropriate for finding such a repeating frequency also they observed that these two techniques had been successfully employed for identifying the vortex tip ji et al 2013 considered cavitating flow around hydrofoils using the partially averaged navier stokes method their predicted cavity characteristic compared favorably with the experimental data ji et al ji et al 2014 09 investigated the structure of the cavitating flow around a twisted hydrofoil using a modified k ε model with a local density correction for turbulent eddy viscosity their prediction for the cavity structures and the shedding frequency were in suitable agreement with the experimental observations giorgi et al de giorgi et al 2015 implemented an experimental study of cavitating flows inside a restricted nozzle the cavitation phenomena were characterized by four different flow regimes at the variation of the pressure and temperature they analyzed the signals with the wavelet transform to highlight the influence of the temperature the required data is acquired by pressure signals and images of the cavitating flow field kang et al 2017 employed the wavelet transform for their experiments on aa hydro turbine to diagnose whether the cavitation occurs the results illustrated that the characteristics of incipient cavitation could be detected in the audible frequency band they found that the wavelet analysis of noise signals can distinguish the differences of the various operating conditions and also can discriminate between the incipient cavitation and the other regimes of cavitation by visual observations on the other hand long et al long et al 2019 06 recently simulated the cavitating flow around a clark y hydrofoil using implicitly filtered les and a homogenous cavitation model they compared the unsteady cavitating with non cavitating flows the cavitating flow had more fluctuation and total error compared to that of non cavitating recently experimental studies on signal processing and spectrum content analysis of cavitating flow passing over spheres have been reported brandner et al 2010 investigated the cloud cavitation passed over a sphere and captured high speed imaging of the sphere in water tunnel in a constant reynolds number re 1 5 106 in different regimes of cavitation from inception to supercavitation pixel intensity of photos in different cavitation numbers was studied using wavelet transform because of the limitation in data collection in their study they asserted that higher spatial and temporal resolutions are required graaf et al de graaf et al 2016 investigated the physics and spectral content of cloud cavitation of a sphere experimentally in a water tunnel by high speed imaging and surface pressure measurement the power spectral densities of the long sampled normalized pressure signals were analyzed using the welch and wavelet methods they identified three distinct shedding regimes an uni modal regime for σ 0 9 and two bi modal regimes for 0 675 σ 0 9 and 0 3 σ 0 675 they found that at high cavitation numbers σ 0 9 where cavity lengths are small the breakup was driven by small scale instabilities in the overlying boundary layer however in cavitation numbers below 0 9 greater cavity lengths allow large scale shedding to develop driven by coupled re entrant jet formation and shockwave propagation in a recent work venning et al 2018 used a high speed image set of cloud cavitation about a sphere then they used fast fourier transforms applied to individual pixel intensities of image frames they found three shedding frequencies in their analyses including the main shedding mode the subharmonic mode and the harmonic mode brandner et al 2018 investigated wavelet methods used in cavitating fluid flows precisely containing cross wavelet transform and wavelet transform plots to comprehensive review into this complex phenomenon as the above literature survey indicates a few reports on the spectral content analysis of cavitating flows with an emphasis on sphere cavitation are available on the other hand the available signal processing research on the sphere cavitation are experimental brandner et al 2010 de graaf et al 2016 venning et al 2018 which were claimed that because of limitations in data collection higher spatial and temporal resolutions are required furthermore numerical studies help to widen the range of studied cavitation numbers in contrast to previous works on signal processing of cavitating flows where fluctuation data was gained by capturing images acoustic recorders or pressure sensors here flow properties in different points near the sphere are captured numerically during the time over a wide range of cavitation numbers then the data is analyzed utilizing wavelet and fourier transforms 2 mathematical modeling 2 1 governing equations cavitating flow is a multiphase flow obeying the navier stokes equations in this study the incompressible homogeneous mixture multiphase flow was assumed thus the governing equations are described as follows 1 t ρ ρ v 0 t ρ v ρ v v p s where ρ v p and s are density velocity pressure and viscous stress tensor respectively the rate of strain tensor d is given as 2 d v v t where viscous stress tensor defined as s 2μd a multiphase flow modeling should be used to describe a phase change from liquid to vapor that happens under cavitation in this study we consider a two phase mixture method this method uses a local volume fraction transport equation with a source term incorporating the rate of mass transfer between the two phases due to cavitation 3 t γ v γ s a the mixture density ρ and dynamic viscosity μ are given as follows 4 μ γ l μ l 1 γ l μ ϑ 5 ρ ρ l γ l 1 γ l ρ ϑ also s a is the phase change rate between vapor and liquid and γ is the liquid volume fraction indicator defined as follows 6 γ 1 0 0 γ 1 w a t e r v a p o r i n t e r f a c e for tracking the interface between the vapor and liquid phases a compressive volume of fluid vof method is utilized to treat eq 3 the compressive vof equation utilized in the openfoam considers eq 5 in the following form 7 t γ γ v v c γ 1 γ s a where vc is the compressive velocity term as suggested by rusche 2003 and the last term in the left side of the vof equation eq 7 is a surface compression term that is active at the interfaces for further information on the compressive velocity vof technique see roohi et al 2013 05 klostermann et al 2013 the schnerr sauer mass transfer model is used in this study given by 8 t γ γ v ρ ϑ ρ l ρ 1 γ γ 3 r b 2 3 p ϑ p ρ l where r b is the radius of bubbles is derived as follow 9 r b 3 4 π n 0 γ 1 γ 1 3 where in the interphasechangefoam solver the initial number of bubbles n 0 is set as 1 6 109 for further information on the schnerr sauer mass transfer model see schnerr and sauer 2001 2 2 large eddy governing equations the construction of large eddy simulation les turbulence approach is based on computing the large scale structures that are determined on the computational grid whereas the smaller sub grid eddies are modeled filtering operation of a variable e g is carried out using a predefined filtering function g g x δ this function employs a cut off length scale δ where smaller scales than that are not involved in in other words scales smaller than δ are subtracted from the filtered function x t where δ is defined as sub grid scale and is a sub grid term that consists of sub grid scales 10 x t r t g x r t t d t d r 11 δ depends on the computational grid size e g 12 δ δ x δ y δ z 3 convolving g function within continuity and momentum equations filtered equations of continuity and momentum employed in the les approach are derived 13 u i x i 0 14 u i t x j u i u j 1 ρ p x i x j τ i j x j υ u i x j u j x i here all variables with an overbar denote filtered parameters the most crucial aspect of the equations mentioned above is the presence of x j τ i j term that is unknown a priori and is present in the navier stokes equations following shang et al 2012 it is feasible to express τ i j as 15 τ i j u i u j u i u j τ i j is termed as sgs stress tensor and is usually modeled indeed τ i j resembles the reynolds stresses in the reynolds averaged navier stokes rans methods there are various types of approaches to model the sub grid stress tensor τ i j prevalent sub grid modeling approaches utilize an eddy or sub grid viscosity μ k where μ k can be calculated using a wide variety of approaches in the eddy viscosity model we have 16 τ i j 2 3 ρ k i 2 μ k s i j 17 s i j 1 2 u i x j u j x i where s ij is the rate of strain tensor for the resolved scale and the sub grid scale turbulent viscosity μ k is closed by a local eddy viscosity model here the one equation eddy viscosity model oeevm sub grid scale is used to obtain turbulence kinetic energy k oeevm solves the following equation 18 ρ k ρ k u τ i j s i j μ k k ρ ε 19 ε c ε k 3 2 δ sub grid scale turbulent viscosity μ k is then computed by 20 μ k c k ρ δ k while c ε and c k are set as 1 048 and 0 094 in openfoam respectively in large eddy simulation approach the eddies are divided into two categories including grid scales and sub grid scales sgs the conservation equations are governed for grid scales while sgs models are used for simulating the small scale elements in the flow in the current study the flow is modeled using one equation eddy viscosity model oeevm as sub grid scales modeling this model is selected because of two reasons including its successful usage in previous cavitation works and its lower computational cost first previous works pendar and roohi 2018 roohi et al 2013 05 zahiri and roohi 2018 12 showed that oeevm model is accurate enough in simulating cavitating flow and capturing cavity shedding second the computational cost is an essential factor in cavitating flow simulations recently different sub grid scale models namely oeevm and dynamic smagorinsky ds were studied in treating cavitating sphere flow zahiri and roohi 2018 12 in addition to accurate prediction of general properties of the cavity cloud such as the length diameter and pressure drag coefficient the computational cost of the oeevm was slightly lower than the ds model therefore oeevm sub grid scales model is selected here and well validated with the experimental data de graaf et al 2016 for managing different values of y for the first grid cell a blending function is employed in openfoam which is given by spalding law as given by damián and nigro 2010 de villiers 2006 21 y u 1 e e κ u 1 κ u 1 2 κ u 2 1 6 κ u 3 where κ 0 4187 e 9 y y u τ ν and u u u τ therefore the first off the wall grid point can be in the buffer or viscous regions y 30 without the loss of accuracy as the function beneficiary 2 3 pressure velocity coupling the velocity pressure coupling is achieved using the pimple algorithm that is a hybrid piso simple algorithm employed in the openfoam the pimple consists of three parts a momentum predictor a pressure solver and a momentum corrector in the pimple for stability purposes an outer correction loops i e cycling over a given time step for a number of iterations and equation under relaxation between outer correctors are allowed the pimple provides a more robust pressure velocity coupling by coupling a simple outer corrector loop with a piso inner corrector loop this algorithm demonstrates better stability for larger time steps compared to piso here we employed two piso iterations and one simple iteration more details of the numerical procedure are available in pendar and roohi 2018 2 4 spectrum analysis in this study two methods fast fourier transforms fft and wavelet transforms are used for processing data obtained using the interphasechangefoam solver the fft disintegrates time series data into the frequencies that influence it the fourier transformation of a function x t is expressed as 22 x f x t e 2 j π f t d t let x 0 x n 1 be complex numbers the discrete fourier transform dft is defined by the following formula 23 x k n 0 n 1 x n e i 2 π k n n k 0 n 1 dft performs o n2 operations to reduce the number of operations and calculation time the fft is introduced that produce the same results but with a much lower number of operations e g o n logn continuous wavelet transforms cwt is a way to transform a time based function into wavelets which provide a time frequency representation of a signal specifying the location of frequencies at different times the continuous wavelet transformation of a function f t is expressed by 24 f t ψ a b t 1 a 1 2 f t ψ t b a d t where a b and ψ t are scale a 0 translational time and mother wavelet respectively the primary purpose of the mother wavelet is to give a source capacity to generate the little daughter wavelets which are the interpreted and scaled forms of the mother wavelet when the scale factor is moderately low the signal is more contracted which in turn results in a more detailed resulting graph however when the scale factor is high the signal is extended to analyze the spectral content of the cavitating flows in the sequel of this paper we use cwt since discrete signals are noticeable the reason is that interpreting the amplitude of wavelet coefficients is difficult in a discrete wavelet transform dwt sampling and decreasing time intervals to zero give approximate of cwt in this method the scale parameter is discretized on logarithmic cells and the time parameter is discretized on its scale if it is defined 25 ψ a t 1 a ψ t a to discretize cwt equation eq 24 assume that the input function f t is a length n vector x n thus the discretized variant of cwt is 26 w a b n 0 n 1 x n ψ a b n the discretized version of cwt solves this equation for each value of the shift parameter b and repeat this process for each scale a there is an approximate relation which converts scales to frequencies this relation is determined by the center frequency of the wavelet f c as given 27 f a f c a δ where δ and f a are the sampling period and the pseudo frequency corresponding to the scale a respectively the strouhal number is a dimensionless number describing an oscillating flow e g 28 s t f l u where l is the characteristic length 2 5 problem description fig 1 and fig 2 show schematically the geometry of the considered problem boundary conditions and solution procedure respectively in agreement with the experimental data of australian maritime college s tom fink cavitation tunnel brandner et al 2010 a sphere whose diameter is 0 15 m is placed at the center of a water tunnel with a dimension of 0 6 m 0 6 m 2 6 m the inlet velocity of the water tunnel is 9 m s the spherical surface is specified as a no slip wall reflector the quality of the computational grid has a direct influence on the accuracy of numerical results the grid convergence indicates that grid with around 5 106 cells provides a converged solution for the cavity characteristic the spacing of the grid near the surface of the sphere s body is the same size in all three directions in the mentioned grid the normalized wall distance of the first layer of grid nodes near the wall is 6 236 10 4 fig 1 b illustrates that structured quadrilateral meshes were utilized for a typical simulation case at σ 0 5 mean values of y are 2 19 and 5 73 and minimum values of y are around 0 205 and 0 425 for grid 4 and grid 3 respectively there should be a balance between accuracy and computational cost in numerical simulations in this work four different sizes for the case σ 0 5 are considered which are called grid 1 to grid 4 whose number of cells varies from 2 106 to 9 106 in all the studied grids the space near the surface of the geometry is the same size in all directions table 1 reports non dimensional data from all studied grids including the minimum size of the cell and length and the diameter of the cavity by comparing the data of the table grid 3 which provides a converged solution for the cavity characteristic is selected to perform simulations of the current research in the selected grid the normalized wall distance of the first layer of grid nodes near the wall is 6 236 10 4 in the current research the length and diameter of the cavity is computed considering the iso surface of the simulated volume fraction with values of 0 25 a commercial software namely tecplot is employed for finding the length and diameter of the cavity the difference between the current and the previously calculated parameter values specifies residual it increases at the start of each time step and drops some orders of magnitude fig 3 indicates the convergence history of the liquid volume fraction and pressure residuals for a typical case at σ 0 45 the figure also shows the pressure need more iterations in comparison with the volume fraction to reach the appropriate pre set threshold value the residuals of pressure and volume fraction reach around 10 8 and 10 12 respectively the residuals of velocity turbulent kinetic energy were both set at 10 6 in this work the cavitating flow is solved using interphasechangefoam solver at twelve different cavitation numbers 0 1 σ 1 and a constant reynolds number of 1 5 106 the flow is assumed to be unsteady and computations start from initial conditions and continue to about 500 ms the time step size was calculated automatically during the simulation based on the specified courant number we set a small courant number of 0 175 that resulted in an average time step around 10 7 s which is a sufficiently small period to capture cavity shedding the data of volume fraction pressure and kinetic energy are captured during the time in the whole of the domain the fluid properties are specified as ρ l 1000 kg m3 ρ v0 0 02308 kg m3 μ l 9 10 4kg m s μ v 1 10 5kg m s and p v 2300 pa the pressure data is sampled in 345 points around the sphere from its leading edge towards the wake region see fig 2 on the central axis behind the geometry where cloud cavitation occurs next the average of the gathered data is computed during the simulation time subsequently wavelet and fourier transformations are employed to investigate cavity frequency modes in this study the daubechies wavelet which provides desirable results in detecting cavity cycles is considered 3 result and discussion 3 1 validation the numerical results of cavitating flow around the sphere also are compared with the experimental results of brandner s work brandner et al 2010 which has studied cavitation at re 1 5 106 with a σ ranging from 1 0 to 0 36 fig 4 illustrates a comparison between these numerical results and a series of low speed photographic images which is obtained from experimental data fig 5 indicates that les solution in comparison to k ω sst turbulence model suitably captures the unsteady vapor shedding of the cavity behind the sphere that is in agreement with the experimental results fig 6 compares power spectral density psd fraction of current numerical study with that of experimental data reported in venning et al 2018 at σ 0 8 which shows similarity the figure shows a general agreement between the current numerical simulation and experimental data fig 7 illustrates mean velocity contours and the velocity streamlines of flow visualized by lic method line integral convolution stalling and hege 1997 at three cavitation numbers as lic velocity and vorticity pattern depicted in figs 7 8 show the created cavity may little be affected by the walls of water tunnel indeed the presence of the boundary layer is observable over the tunnel walls 3 2 fourier transform analysis in this section the fluctuation of cloud cavitation past the sphere is investigated using a fast fourier transform fft the fft is applied to the mean pressure of selected points inside the domain in each studied cavitation numbers then the dominant frequencies are extracted from the results frequencies are also converted to the strouhal number which is a dimensionless parameter depicting the fluctuations of a system fig 9 compares the psd fractions of the dominant strouhal numbers at different cavitation numbers the psd fraction is defined by dividing psd to the mean psd which is a parameter to show the percentage of each strouhal numbers in the flow according to the figure there are three different regions regarding cavitation numbers also in a recent experimental study three distinct regimes for cavitating flow passing over a sphere were demonstrated as a function of cavitation number de graaf et al 2016 fig 9 a shows two low strouhal numbers which are the most dominant 0 042 and 0 079 labeled as a and b from σ 0 1 to 0 36 psd fractions of a and b experience reductions by increasing the cavitation number it means that by increasing the cavitation number the effect of low frequency parameters of the flow reduces then there are almost sudden increases in those of a and b between σ 0 4 and 0 5 it demonstrates that this range of cavitation numbers is a location where the flow experiences changing in its regime similar to the first region of the line graph that of a and b encounter decrements until σ 0 8 from σ 0 9 to 1 there are slight increases in both a and b fig 9 b illustrates two higher frequencies which are labeled as c and d as the figure shows there are three distinct regions regarding cavitation numbers first for 0 1 σ 0 4 the psd fractions of c and d decrease by increasing cavitation number and fractions are the lowest at σ 0 4 next there is a region between 0 4 and 0 8 where those of c and d fluctuate by increasing the cavitation number then those of c and d remain constant from σ 0 9 to σ 1 this is the third region regarding the cavitation number fig 9 c compares two high frequency signals in the cavitational flow the psd fraction of e and f with strouhal numbers of 0 196 and 0 238 have almost a reverse correlation it means that when one of them has a high value in the psd fraction another one has a lower impact on the cavitating flow in conclusion two strouhal numbers 0 048 and 0 086 are the two most dominant frequencies in the studied cavitating flow over the sphere fourier analysis shows that three regions appeared by changing the cavitation number first oscillation in a cavitating flow with σ 0 4 decreases by increasing the cavitation number next the region where the cavitation number is between 0 4 and 0 9 has higher fractions of high frequencies then there is a region where the cavitation number is higher than 0 9 and has almost constant psd fractions with the cavitation numbers 3 3 wavelet analysis due to the unsteady behavior and various fluctuations of the cavitating flow it is necessary to consider time in the spectrum analysis in this case signals have short term high frequency components and long term low frequency components thus a method is required to produce accurate time resolution and low frequency resolution as well as proper frequency resolution and weak time resolution for high and low frequencies respectively there are different frequencies in different time inside the flow therefore the wavelet analysis may prepare more details about the flow unlike the fourier analysis which provides the same transform for all times the continuous wavelet transform is calculated separately for different parts of the signal in the time dimension in this section the effect of cavitation number on flow fluctuations will be examined based on the time frequency graphs before analyzing the wavelet precisely we briefly explain the formation and development of the cloud cavity in fig 10 cavitation past the sphere can be divided into three different regimes based on how the cavity is shed at very high cavitation numbers σ 1 0 a small stable cavity cloud with breakup due to the re entrant jet is formed at lower cavitation numbers σ 0 9 a moderate length cavity cloud is established which is sufficient enough for the formation of the re entrant jet cavity breakup occurs followed by a vortex shedding in the cavity cloud and also the instabilities of the cavity with a cyclic shedding increase in very low cavitation number i e σ 0 36 an extended supercavity cloud forms without any considerable re entrant jet or large scale breakup fig 11 illustrates the continuous wavelet transform of the cavitating flow around the sphere with a cavitation number of 0 1 until t 500 ms it can be observed that lower strouhal numbers e g st 0 1 have higher altitude in comparison with high range frequencies strouhal numbers moreover according to the figure high range frequencies depicted by e are damped in almost 0 15 s in the previous section the flow was analyzed by the fourier transform method and the five dominant strouhal numbers according to fig 9 were 0 047 0 084 0 120 0 156 and 0 192 respectively similarly as it is shown in the figure five lines a to e are equivalent to them respectively another point perceived from the above figure is that the assigned lines are positively sloped indicating the increase in the strouhal number with time it also can be seen that high frequencies are damped with time furthermore according to fig 11 numbers 1 and 2 are two peaks of line a which is related to the st 0 047 based on the fourier transform as the volume fraction contours show they are the moments which show one dominant type of separation in the cavitating flow in σ 0 1 this type of separation is available in other studied cavitation numbers but it is not the only one in higher cavitation numbers numbers 3 and 4 are two moments in the flow which show one type of shedding at the end of the cloud cavity which is located on peaks of line e in fig 12 fig 12 illustrates the wavelet transform of cavitating flow in σ 0 36 besides it shows phase fraction contours in specified moments in the flow similar to σ 0 1 it can be observed in this figure lower strouhal numbers st 0 1 has higher altitude in comparison with high range frequency ones moreover according to the figure high range frequencies which is shown as e are damped in almost 0 2 s which is higher than σ 0 1 similar to fourier analysis of σ 0 36 which shows that the dominant st of the flow is 0 046 0 084 0 121 0 158 and 0 191 respectively wavelet transform shows the same which are labeled a to e in the figure moreover numbers 1 2 and 3 in fig 12 are three specified moments in the flow which are on the peaks of line a demonstrating st 0 046 based on the fourier transform results these are shedding moments in the flow as depicted in the contour plot similar to σ 0 1 numbers 4 and 5 are located in peaks of line e depicting shedding at the end of the cloud cavity with a divergent shape fig 13 shows the wavelet transform and phase fraction contours in specified moments during the flow simulation where σ 0 5 as the figure shows the wavelet transform has the same structure compared to previous cases labeled lines a to e show the same strouhal numbers as the previous figures similar to σ 0 1 and σ 0 36 line a shows flow separation and line e shows divergent shedding at the back of the cavity cloud according to the wavelet transform by increasing the cavitation number the number of cycles is increased for instance in σ 0 5 the number of cycles of divergent shedding is more than previous cases which have lower cavitation numbers fig 14 shows the wavelet transform and phase fraction contours at different moments in the flow with σ 0 7 the number of cycles of high frequencies in this case is more than previous ones also the duration of cycles before damping is longer than previously studied cases similar to previous cases the assigned numbers show separations and divergent shedding generally it has been observed that an increase in the cavitation number causes more fluctuations in the cavitating flow especially in higher strouhal numbers moreover the wavelet transformation of cavitating flow shows that in all studied cavitation numbers strouhal number which is a dimensionless expression of frequency increases during the studied span of time in other words all labeled lines in figs 11 14 have an ascending trend regarding the time but the slop of lines are different regarding cavitation number and strouhal number besides the line e which almost equals to st 0 196 shows a particular type of shedding in the cavitating flow which is like a divergent funnel and the line a which almost equals to st 0 048 shows a specific type of separation which is dominant in lower cavitation numbers 4 concluding remarks in the present study the cavitation phenomenon around the sphere in different cavitation numbers was analyzed numerically where the effect of changing the cavitation number was shown on the flow fluctuations compared with experimental data besides the fourier transform the flow is analyzed by a wavelet transform the latter is suitable for unsteady three dimensional and discontinuous phenomena like cavitation to show the effects of the time dimension fourier analysis shows that st 0 048 and st 0 086 are two dominant frequencies in the cavitating flow around the sphere at the studied reynolds number moreover while the dominant strouhal numbers are almost the same in all studied cases the value of each one is varying based on the flow regime in other words overall there are three regions in the flow regarding the cavitation number wavelet analysis shows that by increasing the cavitation number more fluctuations in the cavitating flow is obtained especially in higher strouhal numbers in all studied cavitation numbers strouhal number increases during the studied span of time the slop of strouhal numbers lines over time are ascending and different regarding cavitation number and strouhal number therefore fourier analysis cannot be a proper analysis of the cavitating flow st 0 196 shows a special type of shedding in the cavitating flow which is like a divergent funnel similarly st 0 048 illustrates a particular type of separation which is dominant in lower cavitation numbers especially in σ 0 1 but it exists in higher cavitation numbers as well appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 multimedia component 5 multimedia component 5 multimedia component 6 multimedia component 6 multimedia component 7 multimedia component 7 multimedia component 8 multimedia component 8 multimedia component 9 multimedia component 9 multimedia component 10 multimedia component 10 multimedia component 11 multimedia component 11 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 070 
22802,the linear and non linear dynamics of a bottom hinged flap type wave energy converter in response to regular waves were studied through computational simulations to assess the performance of power take off techniques and enhance the power extraction the computational model was developed in comsol multiphysics using its multibody dynamics module and was carefully validated the hydrodynamic coefficients are from the linear wave theory to avoid damages to the device especially in extreme sea conditions a brake mechanism is used to limit the amplitude of flap oscillations with that limit imposed we show that the optimum damping coefficient proposed in the literature for power take off does not actually lead to an optimum power extraction for a range of wave frequencies over that range the brake mechanism becomes engaged leading to a significant energy loss we propose new power take off techniques that avoid the engagement of the brake yet keep the amplitude within the specified range they are proposed for both the linear and non linear flap dynamics and their efficacy is demonstrated for several flap geometries the proposed techniques enhance the power extraction by as high as 600 linear and 19 non linear in the latter case by minimizing the energy loss due to brake keywords wave energy converter wec power take off pto bottom hinged flap power extraction 1 introduction one of the most promising renewable energy sources is the ocean wave energy which has the potential to reliably meet a significant portion of the world s energy demand there are many wave energy conversion techniques patented worldwide european renewable energy council 2010 they can be generally categorized according to their operating principle i e power extraction method as attenuator point absorber submerged pressure differential overtopping oscillating water column and oscillating wave surge converter owsc or based on their deployment location relative to the coastline as shoreline nearshore and offshore drew et al 2009 the wave energy converter wec device studied in this work is a nearshore owsc such class of wecs has relatively small installation and maintenance costs and less exposure to extreme sea conditions than offshore devices it also has higher power extraction potential than shoreline devices flocard and finnigan 2012 a well known example of the owscs is the aquamarine power oyster which is a bottom hinged flap type device and has been cited to output the highest power ever captured by wecs renzi et al 2014 the owscs have recently received significant research attention whittaker and folley 2011 renzi and dias 2013 gomes et al 2015 sarkar et al 2016 pathak et al 2017 where their technology was claimed to be one of the simplest yet most promising several studies have investigated methods to improve the power extraction in wecs gomes et al 2015 investigated the power extraction of bottom hinged flap type wecs numerically through parametric analyses of the flap width and height varying the flap s natural frequency and testing new power take off pto techniques their findings show that the flap height has a significant impact on the power extraction performance and that a surface piercing device outperforms a fully submerged one additionally the proposed pto techniques were shown to improve the power extraction performance caska and finnigan 2008 showed that the power extraction performance of a bottom hinged cylinder type wec increases by moving the device from shallow to intermediate water depth in another experimental study flocard and finnigan 2012 investigated the effects of inertia modification on the bottom hinged cylinder type wecs they found that inertia modification can improve the power capture substantially for waves of long period and large amplitudes behzad and panahi 2017 studied the pto of bottom hinged cylinder type wecs and showed that varying the stiffness and damping of the pto can improve the energy extraction efficiency of the device bailey 2009 investigated the effects of non linear pto in point absorber wecs experimentally as well as numerically and demonstrated that non linear pto techniques can improve the power extraction performance using a non linear controller in a bottom hinged flap type wec bacelli and ringwood 2014 reported improved pto techniques compared to the linear case optimization efforts have been applied to enhance power extraction in other types of wecs too barambones et al 2018 increased the power output of an oscillating water column wec that utilized a wells turbine as the pto mechanism using the sliding mode control method they maximized the power extraction by optimizing the turbine s speed and the flow coefficients ulvin et al 2012 considered a point absorber wec device under sinusoidal waves of low amplitude and proposed parameter tuning that would increase the power extraction by approximately 18 focusing on a submerged wec of planar pressure differential type esmaeilzadeh and alam 2019 used the genetic algorithm and performed shape optimization of the absorber which led to significant improvements in energy harvesting developing a stepwise control system aggidis et al aggidis et al 2009 optimized the power extraction of a point absorber wec operating in irregular waves where the peak period was used for device optimization in this paper we consider bottom hinged flap type wecs in such wecs a brake mechanism is typically used in order to limit the flap s amplitude of oscillations the limit is imposed to avoid damages to the wec especially in extreme sea conditions and address performance challenges such as structural strength of the device and large variability in the oscillations furthermore a linear wave theory analysis of flap interaction with waves would require the amplitude of oscillations to be sufficiently small through computational simulations we will show that even with the optimum pto models suggested in the literature the power extraction does not reach the expected maximum because a significant amount of energy is lost due to the engagement of the brake mechanism we will then propose new pto models for both linear and non linear flap dynamics that avoid the engagement of the brake but keep the amplitude of oscillations within the specified range the proposed pto models eliminate or minimize the brake engagement thereby significantly increasing the power extraction the paper is structured as follows the governing equations and computational modeling are described in section 2 section 3 presents the results from the computational models finally the work is summarized in section 4 along with a discussion of the results and some concluding remarks 2 governing equations and computational modeling 2 1 theory consider the bottom hinged flap shown in fig 1 which performs oscillatory pitching motion about the axis of rotation we first briefly explain terminologies of hydrodynamics if the flap performs harmonic oscillation in the absence of an incident wave the flap motion generates outgoing waves in such a case the hydrodynamic loads include added mass damping and restoring loads if the flap is restrained from oscillation but exposed to incident waves an excitation force will be exerted on it faltinsen 1993 when the flap starts pitching it results in a reaction in the surrounding water this reaction causes an impulsive displacement on the body during a certain time interval as a result of this displacement water particles start moving and continue their motion even after a reference time interval which will influence the subsequent time intervals as a consequence the system will have a memory which is called radiation impulse response function or memory function journée and massie 2001 additionally a drag force or load due to viscous effects can be introduced into the model to consider a more realistic system memory function effects and drag loads can be considered as non linear terms in the model hence two main models can be developed to simulate the flap mechanics linear neglecting the effect of memory function and drag load and non linear models 2 1 1 linear model a general equation of flap motion for the linear model can be written as 1 i θ t m r t m h t m m t m e t where i is the moment of inertia of the pitching flap t is the time θ is the relative angular rotation or pitching angle see fig 1 and θ denotes the angular acceleration m r is the radiation moment m h is the hydrostatic restoring moment m m is the mechanical moment for pto and m e is the excitation moment resulting from the wave motion by the parallel axis theorem for a pitching flap presented in fig 1 the moment of inertia is obtained as gomes et al 2015 2 i ρ f v t p l 2 12 l 2 2 where ρ f is the density of the flap v is the flap volume t p is the flap thickness and l is the flap height the radiation moment m r is 3 m r t a ω θ t b ω θ t where ω is the wave frequency and θ is the angular velocity a ω and b ω are the frequency dependent added mass moment of inertia and radiation damping coefficient respectively the hydrostatic restoring moment m h is 4 m h t c k j θ t where c k j is the hydrostatic restoring coefficient assuming uniform mass distribution within the flap and that the center of buoyancy and the center of gravity are both located at the center of the body the hydrostatic restoring coefficient is given as 5 c k j ρ w g w t p l 2 2 where ρ w is the density of water g is the gravitational acceleration and w is the flap width the mechanical moment m m applied by the pto is 6 m m t b m θ t c m θ t where b m and c m are the mechanical damping and spring coefficient respectively the excitation moment m e is 7 m e t a w γ ω c o s ω t where a w is the wave amplitude γ is the frequency dependent excitation moment coefficient discussed further in section 2 2 2 1 2 non linear model in addition to the above effects the non linear model includes the effects of memory function and drag load which are both non linear the general equation of motion for the non linear model can be obtained by using the cummins equation cummins 1962 which is widely used to model the response of ships to ocean waves in the time domain and in presence of non linear effects the equation of motion can be written as 8 i a θ 0 t κ t τ θ τ d τ c s i n θ m d t m m t m b t m e t where a is the added mass moment of inertia at infinite frequency κ is the memory function c is the hydrostatic restoring coefficient m d is the drag moment m m is the mechanical moment m b is the braking moment and m e is the excitation moment the expressions for i c m m and m e were presented in section 2 1 1 the memory function can be expressed as falnes 2002 9 κ t 2 π 0 b ω c o s ω t d ω the drag moment m d can be written as gomes et al 2015 10 m d t 1 2 ρ w w c d h l h θ t r u n θ t r u n r d r where c d is the drag coefficient h is the water depth r is the radial coordinate with respect to flap s axis of rotation and u n is the velocity of water particles normal to the flap surface written as 11 u n u c o s θ w s i n θ where u and w are the horizontal and vertical velocity component see fig 1 of water particles in the absence of the flap respectively the velocity components can be derived from incident wave potential at x 0 mccormick 1973 the braking moment m b will be detailed in section 2 2 the time averaged energy flux e of regular linear waves per unit wave crest length is cummins 1962 12 e ρ w g ω a w 2 4 k 1 2 k h sinh 2 k h where k is the wave number the time averaged power extracted by the linear pto can be written as falnes 2002 13 p ω 1 2 ω 2 b m θ ω 2 where θ is the flap motion amplitude the instantaneous power extracted by the pto can also be written as 14 p t b m θ 2 using the above quantities a capture width can be defined as 15 l c p ω e which can be made dimensionless by using the flap width w as l c w 2 2 computational modeling based upon the governing equations presented in the previous section linear and non linear models of flap dynamics and power extraction were developed in comsol multiphysics 5 1 documentation for comsol by using its multibody dynamics module fig 2 illustrates a general view of the computational model the system was assumed to consist of a rigid flap with dimensions shown in fig 2 and table 1 a foundation over which the flap is hinged and a pto mechanism attached to the axis of rotation at the bottom of the sea the flap was assumed to be pitching about a hinge joint that has a torsional spring and damper the water depth h was considered as 10 m in all models in this study several types of flap geometries were analyzed by changing the thickness height and width of the flap table 1 presents the flap geometries along with wave amplitudes analyzed in the linear and non linear models the density of the flap and sea water were assumed as 256 25 and 1025 k g m 3 gomes et al 2015 respectively in all models in addition the comsol model was interfaced with matlab codes developed for calculating the memory function and convolution integral this was achieved through comsol s livelink for matlab facilitating data exchange between comsol and matlab during the solution procedure from the hydrodynamic coefficients in gomes et al 2015 explained more below b ω was generated to allow the computation of κ matlab curve fitting tool was used to obtain b ω as a rational function for the flap geometries studied in the non linear model section physics controlled mesh sequence and finer mesh size were used to discretize the rigid structure in the comsol models performing time dependent analysis of dynamic behavior of the device the physics controlled mesh sequence option creates tetrahedral meshes grid refinement studies were performed to ensure the numerical results are grid independent an example of such studies is shown in fig 3 depicting the time history of the relative angular rotation of a flap of height l 5 m width w 10 m and thickness t p 2 m in response to a wave frequency of ω 1 3 rad s and an amplitude of a w 0 5 m as can be seen the results are grid independent and the finer mesh provides sufficient resolution to accurately capture the flap dynamics the hydrodynamic coefficients were incorporated as frequency dependent parameters in the comsol models the coefficients are based on the work by gomes et al 2015 in which wamit software t 7 1 user manual was used to calculate the hydrodynamic coefficients of a bottom hinged flap type wec gomes et al reported see fig 4 in gomes et al 2015 non dimensional added mass moment of inertia a radiation damping b and wave excitation moment γ as a function of non dimensional wave frequency ω the non dimensional quantities are defined as gomes et al 2015 16 a a ρ w h 4 w 17 b b ρ w g h 3 5 w 18 γ γ ρ w g h 2 w 19 ω ω h g since the impact of the flap thickness on the hydrodynamic coefficients is small gomes et al 2015 considered a zero flap thickness approximation in calculating the hydrodynamic coefficients for both linear and non linear models and unless it is stated otherwise the mechanical damping coefficient b m of the pto mechanism was considered as b m o p t given below which is the optimized power extracted from a linear system falnes 2002 20 b m o p t b 2 c ω ω i a 2 where a and b are the added mass moment of inertia and radiation damping coefficient respectively the braking moment m b applied on the axis of rotation in order to limit the flap pitch angle θ is calculated as gomes et al 2015 21 m b t 0 θ θ b f b b θ 3 θ θ b f θ b s θ b f 2 2 θ θ b f θ b s θ b f 3 θ b f θ θ b s b b θ θ θ b s where the braking moment coefficient b b 10 ρ w g 0 5 h 3 5 w θ b f is the angle where the braking moment starts to engage which is defined as π 6 and θ b s is the angle where the braking moment acts linearly which is defined as 2 π 9 3 results in this section the linear and non linear comsol models are first validated through comparison with gomes et al 2015 then the improved pto techniques are introduced for each model and the associated enhancements in power extraction are quantified 3 1 linear model 3 1 1 validation results the comsol model developed in this study was used to simulate the linear response of the wec device under the conditions stated in table 1 note that following gomes et al 2015 the optimized damping coefficient b m o p t eq 20 and a zero spring coefficient c m 0 are applied then the steady state response of the flap was used to calculate the capture width l c in each case fig 4 presents our results for the non dimensional capture width l c w along with comparison to the results reported in gomes et al 2015 for various flap geometries and t p h in fig 4 g refers to the results reported by gomes et al 2015 and c refers to the results obtained by our comsol model as can be seen in fig 4 the results agree very well validating the comsol model additionally the magnitude of the flap motion amplitude θ in the above simulations are presented in fig 5 the figure shows θ divided by the wave amplitude a w and confirms that the conditions required by the linear wave theory are met next the comsol model will be used to propose optimized pto techniques leading to enhanced wave power extraction 3 1 2 parametric study results following the validation studies a parametric study was performed to explore the ways that the power extraction efficiency can be improved through optimization of the mechanical damping and spring coefficients two of the simulations presented in section 3 1 1 were selected for this parametric study case a is a fully submerged flap with a height of l 5 m width of w 10 m thickness of t p 2 m with a wave frequency of ω 1 456 rad s case b is a surface piercing flap with l 10 m w 20 m and t p 1 m with a wave frequency of ω 0 812 rad s case a and b are shown in fig 4 a and h respectively as it is seen when b m b m o p t and c m 0 case a exhibits a relatively poor power extraction performance l c w 0 114 whereas case b shows a strong performance l c w 0 712 next we will show that by optimizing b m and c m coefficients of the pto system the power extraction performance in both case a and b can be enhanced fig 6 a and b present the magnitude of the flap motion amplitude θ and the non dimensional capture width l c w respectively as a function of b m and c m for case a note that with b m b m o p t and c m 0 which was studied in section 3 1 1 case a shows θ 0 07 rad or 4 from fig 6 a and b it is seen that the capture width increases as θ becomes greater which is expected because θ plays an important role in power extraction it is also seen that for certain ranges of b m and c m θ and capture width drastically increase which happens because the natural frequency of the device at those b m and c m values becomes close to the incident wave frequency ω 1 456 rad s for case a hence the device operates at or close to the resonance state however if the amplitude of oscillations becomes too large due to resonance the small amplitude assumption of the linear theory can be violated to address that the damping coefficient can be increased in an optimized fashion to keep the amplitude below the limit but at the same time achieve the greatest power extraction performance possible in this study the flap motion amplitude limit was assumed to be π 6 gomes et al 2015 our parametric study shows that the capture width in case a can be increased to l c w 0 8 by changing the damping and spring coefficients to b m 1 37 10 5 n m s r a d and c m 1 6 10 6 n m r a d this represents a significant improvement in the power extraction performance by approximately 600 compared to the device performance when b m b m o p t and c m 0 next using a similar parametric study we will propose further improvements to the power extraction performance in case b which already shows high performance when b m b m o p t and c m 0 fig 6 c and d present θ and l c w respectively as a function of b m and c m for case b note that θ 0 063 rad or 3 6 when b m b m o p t and c m 0 it is seen again that θ and capture width increase for the given range of b m and c m although the increase is not as drastic as in case a imposing the same oscillation amplitude limit the parametric study shows that the capture width in case b can be optimized and increased further to l c w 1 12 by using b m 4 5 10 7 n m s r a d and c m 7 10 7 n m r a d this represents an improvement of about 57 compared to the case with b m b m o p t and c m 0 which is still significant the above studies demonstrate that the damping coefficient given in eq 20 does not necessarily lead to an optimized performance and that the power extraction performance can be significantly increased by optimizing the damping and spring coefficients 3 2 non linear model 3 2 1 validation results in this section the non linear comsol model was used to study the flap performance under various conditions given in table 1 and with different damping coefficients following gomes et al 2015 five different damping coefficients were considered in total which will be expressed as a non dimensional mechanical damping coefficient b m given by 22 b m b m ρ w g 0 5 h 3 5 w the comsol model was interfaced with a matlab code developed to compute the convolution integral and calculate the memory function in the calculation of the extracted power via the pto an average power extraction was computed by using the data over 10 wave periods after transient effects were diminished fig 7 presents the flap motion amplitude and the non dimensional capture width results with b m b m o p t and a wave amplitude of a w 0 5 m as it is seen the comsol model results denoted by c agree very well with the results by gomes et al 2015 denoted by g as fig 7 shows the capture width decreases significantly when the braking moment is activated to limit the flap motion amplitude the energy that should have been extracted by the pto was lost to the braking moment on the other hand the braking moment is a necessary system component to keep the flap oscillations within the prescribed range and to prevent damages to the device due to extreme sea conditions to better understand the adverse effects of the braking moment on the capture width the wave amplitude a w was increased to 1 m while the flap width was kept at w 20 m following gomes et al 2015 five different mechanical damping coefficients were considered including b m b m o p t b m b m c 0 b m 0 05 b m 0 1 and b m 0 3 here b m c 0 was the optimum mechanical damping coefficient eq 20 with no hydrostatic restoring i e c 0 the results are presented in fig 8 again the results of our model show excellent agreement with gomes et al 2015 validating the non linear comsol model next the comsol model was used to enhance the power extraction through improved pto techniques 3 2 2 enhanced power extraction through improved pto techniques from the validation results it can be concluded that the optimized mechanical damping coefficient eq 20 proposed in the literature does not lead to an optimum power extraction in every case in this section we propose two mechanical damping functions and through comsol simulations show that they enhance the power extraction performance the functions were tested in surface piercing flaps of height l 10 m and width w 10 20 and 50 m the results are compared with cases where the mechanical damping is determined by eq 20 with and without hydrostatic restoring we begin with a non linear mechanical damping function designed to avoid the engagement of the braking system and the associated energy loss the function which is named non linear damping function and denoted by b m n takes into account the limit of flap motion amplitude and is expressed as 23 b m n f θ g θ b m o p t where f θ and g θ are functions of the angular rotation θ and the angular velocity of the flap θ respectively a 6 t h order polynomial is proposed for f θ given as 24 f θ c 1 θ 6 c 2 θ 5 c 3 θ 4 c 4 θ 3 c 5 θ 2 c 6 θ c 7 where through matlab curve fitting tool the coefficients were found as c 1 883 c 2 2148 c 3 1021 c 4 36 61 c 5 69 71 c 6 9 575 c 7 1 228 the function g θ was defined as 25 g θ d 1 e d 2 θ d 3 e d 4 θ where the coefficients determined by matlab curve fitting tool are as follows d 1 5 35 10 7 d 2 46 14 s d 3 1 143 d 4 2 547 s the objective in the derivation of f θ and g θ functions and their coefficients was that b m n should increase when θ and θ increase in order to capture more power while keeping the flap motion below the amplitude limit without engaging the brake mechanism the second damping function introduced in this work was developed by employing the frequency dependent flap motion equation journée and massie 2001 26 θ ω a w γ ω ω 2 i a i ω b b m c c m note that eq 26 is meant for linear dynamics of the flap and can be used only when the non linear effects are small knowing the hydrodynamic coefficients eq 26 can be solved for the wave frequencies and flap geometries specified in this study to examine whether the flap motion amplitude exceeds the limit which is equal to π 6 when the flap motion amplitude exceeded the limit the mechanical damping coefficient was increased systematically for the wave frequencies until the flap motion amplitude becomes less than π 6 for such cases a new increased mechanical damping value was generated by the matlab code and used in the comsol model however if the flap motion amplitude never exceeds its limit in eq 26 the optimal mechanical damping coefficient was used the new increased mechanical damping is denoted by b m l the ratio of b m l b m o p t as a function of the wave period is plotted in fig 9 for various flap width next the results obtained from various pto techniques including b m b m o p t b m b m c 0 b m b m n and b m b m l are presented for a w 1 m and flap width of w 10 20 and 50 m the amplitude of flap oscillations and the non dimensional capture widths are shown in fig 10 for each case comparing the results of various pto techniques it is clearly seen that the overall power extraction is not the highest when b m b m o p t using other pto techniques most notably b m n and b m l proposed in this study the overall power extraction can be significantly improved while keeping the amplitude within the specified range the improvement achieved with the new pto techniques compared to using b m o p t varies with flap width and are presented in table 2 another idea could be to switch between the optimum mechanical damping coefficient b m o p t and the non linear mechanical damping function b m n according to the wave period to recover the energy lost to the brake mechanism in other words the non linear mechanical damping function is only used when the flap motion amplitude becomes larger than the limit otherwise the optimum mechanical damping coefficient is used the improvement in overall power extraction achieved by this approach is listed in table 2 for different flap width as the above results show by preventing the engagement of the brake through improved pto techniques the overall power extraction efficiency can be increased significantly as high as 19 without exceeding the limit in the amplitude of oscillations 3 3 comparison between linear and non linear models finally to compare the performance of the linear and non linear models we consider a case where the flap dimensions are l 10 m w 10 m and t p 2 m and the wave amplitude is a w 0 5 m note that the viscous effects such as drag loads are neglected in the linear model but included in the non linear model by considering a drag coefficient of c d 1 98 furthermore to be able to properly compare the results a new linear model simulation was performed over a wave period of 5 t 25 s which is different than the results presented earlier in figs 4 and 5 fig 11 shows the results and a comparison in a the flap motion amplitude and b the non dimensional capture width it is seen that the results obtained from the linear and non linear models are very close except near the resonance point where the non linear effects are strong such similarity in the flap dynamics can be explained by the keulegan carpenter kc number which represents the competition between the drag and inertia forces and can be defined as kc 2 π a w w wei et al 2015 when the kc number is greater than o 10 the viscous effects are dominant sarpkaya and isaacson 1981 in the case presented in fig 11 the kc number is π 10 indicating relatively weak viscous effects thus the flap dynamics obtained from the linear and non linear models are expected to be close note that other conditions may lead to larger differences between the linear and non linear models depending on the relative magnitude of forces 4 summary and conclusions linear and non linear modeling of the dynamics of a bottom hinged flap type wec was carried out in comsol where the multibody dynamic module was used and interfaced with matlab the waves were assumed regular and the linear wave theory was used which requires the flap oscillation amplitude to be small validation studies were performed on both linear and non linear models using the linear model parametric studies were performed on fully submerged and surface piercing wecs to improve the pto mechanisms the studies showed significant enhancements in the power extraction efficiency 600 in the fully submerged case and 57 in the surface piercing case the findings from the linear model show that the power extraction performance can be increased by adding a spring to the pto mechanism and varying the mechanical spring and damping coefficients varying the mechanical spring coefficient effectively leads to a variation in the natural frequency of the flap bringing it very close to the incident wave frequency and ultimately leading to a better power extraction performance various mechanical damping techniques were investigated using the non linear model from the validation studies it was clear that significant amount of energy is lost due to the engagement of the brake mechanism over a specific range of wave frequency the brake is a necessary system component to ensure the amplitude of the flap s motion remains reasonably small we developed and tested two mechanical damping techniques that keep the amplitude small and within range but avoid the brake engagement hence recover the lost energy the improvements in power extraction over the specified wave period range vary with the flap width and are as high as 19 in conclusion the computational simulations show that the pto techniques proposed in this study can lead to an enhanced power extraction performance in bottom hinged flap type wecs under both linear and non linear regimes although irregular waves were not studied in this work the proposed pto techniques are expected to be still useful in real sea environment mainly because the central idea behind them is to avoid engagement of the brake mechanism which results in energy loss further studies should be performed to fine tune the proposed pto techniques for irregular waves present at each specific deployment area acknowledgements mr gratefully acknowledges the research support from the national science foundation under the cbet grants 1236462 and 1336232 
22802,the linear and non linear dynamics of a bottom hinged flap type wave energy converter in response to regular waves were studied through computational simulations to assess the performance of power take off techniques and enhance the power extraction the computational model was developed in comsol multiphysics using its multibody dynamics module and was carefully validated the hydrodynamic coefficients are from the linear wave theory to avoid damages to the device especially in extreme sea conditions a brake mechanism is used to limit the amplitude of flap oscillations with that limit imposed we show that the optimum damping coefficient proposed in the literature for power take off does not actually lead to an optimum power extraction for a range of wave frequencies over that range the brake mechanism becomes engaged leading to a significant energy loss we propose new power take off techniques that avoid the engagement of the brake yet keep the amplitude within the specified range they are proposed for both the linear and non linear flap dynamics and their efficacy is demonstrated for several flap geometries the proposed techniques enhance the power extraction by as high as 600 linear and 19 non linear in the latter case by minimizing the energy loss due to brake keywords wave energy converter wec power take off pto bottom hinged flap power extraction 1 introduction one of the most promising renewable energy sources is the ocean wave energy which has the potential to reliably meet a significant portion of the world s energy demand there are many wave energy conversion techniques patented worldwide european renewable energy council 2010 they can be generally categorized according to their operating principle i e power extraction method as attenuator point absorber submerged pressure differential overtopping oscillating water column and oscillating wave surge converter owsc or based on their deployment location relative to the coastline as shoreline nearshore and offshore drew et al 2009 the wave energy converter wec device studied in this work is a nearshore owsc such class of wecs has relatively small installation and maintenance costs and less exposure to extreme sea conditions than offshore devices it also has higher power extraction potential than shoreline devices flocard and finnigan 2012 a well known example of the owscs is the aquamarine power oyster which is a bottom hinged flap type device and has been cited to output the highest power ever captured by wecs renzi et al 2014 the owscs have recently received significant research attention whittaker and folley 2011 renzi and dias 2013 gomes et al 2015 sarkar et al 2016 pathak et al 2017 where their technology was claimed to be one of the simplest yet most promising several studies have investigated methods to improve the power extraction in wecs gomes et al 2015 investigated the power extraction of bottom hinged flap type wecs numerically through parametric analyses of the flap width and height varying the flap s natural frequency and testing new power take off pto techniques their findings show that the flap height has a significant impact on the power extraction performance and that a surface piercing device outperforms a fully submerged one additionally the proposed pto techniques were shown to improve the power extraction performance caska and finnigan 2008 showed that the power extraction performance of a bottom hinged cylinder type wec increases by moving the device from shallow to intermediate water depth in another experimental study flocard and finnigan 2012 investigated the effects of inertia modification on the bottom hinged cylinder type wecs they found that inertia modification can improve the power capture substantially for waves of long period and large amplitudes behzad and panahi 2017 studied the pto of bottom hinged cylinder type wecs and showed that varying the stiffness and damping of the pto can improve the energy extraction efficiency of the device bailey 2009 investigated the effects of non linear pto in point absorber wecs experimentally as well as numerically and demonstrated that non linear pto techniques can improve the power extraction performance using a non linear controller in a bottom hinged flap type wec bacelli and ringwood 2014 reported improved pto techniques compared to the linear case optimization efforts have been applied to enhance power extraction in other types of wecs too barambones et al 2018 increased the power output of an oscillating water column wec that utilized a wells turbine as the pto mechanism using the sliding mode control method they maximized the power extraction by optimizing the turbine s speed and the flow coefficients ulvin et al 2012 considered a point absorber wec device under sinusoidal waves of low amplitude and proposed parameter tuning that would increase the power extraction by approximately 18 focusing on a submerged wec of planar pressure differential type esmaeilzadeh and alam 2019 used the genetic algorithm and performed shape optimization of the absorber which led to significant improvements in energy harvesting developing a stepwise control system aggidis et al aggidis et al 2009 optimized the power extraction of a point absorber wec operating in irregular waves where the peak period was used for device optimization in this paper we consider bottom hinged flap type wecs in such wecs a brake mechanism is typically used in order to limit the flap s amplitude of oscillations the limit is imposed to avoid damages to the wec especially in extreme sea conditions and address performance challenges such as structural strength of the device and large variability in the oscillations furthermore a linear wave theory analysis of flap interaction with waves would require the amplitude of oscillations to be sufficiently small through computational simulations we will show that even with the optimum pto models suggested in the literature the power extraction does not reach the expected maximum because a significant amount of energy is lost due to the engagement of the brake mechanism we will then propose new pto models for both linear and non linear flap dynamics that avoid the engagement of the brake but keep the amplitude of oscillations within the specified range the proposed pto models eliminate or minimize the brake engagement thereby significantly increasing the power extraction the paper is structured as follows the governing equations and computational modeling are described in section 2 section 3 presents the results from the computational models finally the work is summarized in section 4 along with a discussion of the results and some concluding remarks 2 governing equations and computational modeling 2 1 theory consider the bottom hinged flap shown in fig 1 which performs oscillatory pitching motion about the axis of rotation we first briefly explain terminologies of hydrodynamics if the flap performs harmonic oscillation in the absence of an incident wave the flap motion generates outgoing waves in such a case the hydrodynamic loads include added mass damping and restoring loads if the flap is restrained from oscillation but exposed to incident waves an excitation force will be exerted on it faltinsen 1993 when the flap starts pitching it results in a reaction in the surrounding water this reaction causes an impulsive displacement on the body during a certain time interval as a result of this displacement water particles start moving and continue their motion even after a reference time interval which will influence the subsequent time intervals as a consequence the system will have a memory which is called radiation impulse response function or memory function journée and massie 2001 additionally a drag force or load due to viscous effects can be introduced into the model to consider a more realistic system memory function effects and drag loads can be considered as non linear terms in the model hence two main models can be developed to simulate the flap mechanics linear neglecting the effect of memory function and drag load and non linear models 2 1 1 linear model a general equation of flap motion for the linear model can be written as 1 i θ t m r t m h t m m t m e t where i is the moment of inertia of the pitching flap t is the time θ is the relative angular rotation or pitching angle see fig 1 and θ denotes the angular acceleration m r is the radiation moment m h is the hydrostatic restoring moment m m is the mechanical moment for pto and m e is the excitation moment resulting from the wave motion by the parallel axis theorem for a pitching flap presented in fig 1 the moment of inertia is obtained as gomes et al 2015 2 i ρ f v t p l 2 12 l 2 2 where ρ f is the density of the flap v is the flap volume t p is the flap thickness and l is the flap height the radiation moment m r is 3 m r t a ω θ t b ω θ t where ω is the wave frequency and θ is the angular velocity a ω and b ω are the frequency dependent added mass moment of inertia and radiation damping coefficient respectively the hydrostatic restoring moment m h is 4 m h t c k j θ t where c k j is the hydrostatic restoring coefficient assuming uniform mass distribution within the flap and that the center of buoyancy and the center of gravity are both located at the center of the body the hydrostatic restoring coefficient is given as 5 c k j ρ w g w t p l 2 2 where ρ w is the density of water g is the gravitational acceleration and w is the flap width the mechanical moment m m applied by the pto is 6 m m t b m θ t c m θ t where b m and c m are the mechanical damping and spring coefficient respectively the excitation moment m e is 7 m e t a w γ ω c o s ω t where a w is the wave amplitude γ is the frequency dependent excitation moment coefficient discussed further in section 2 2 2 1 2 non linear model in addition to the above effects the non linear model includes the effects of memory function and drag load which are both non linear the general equation of motion for the non linear model can be obtained by using the cummins equation cummins 1962 which is widely used to model the response of ships to ocean waves in the time domain and in presence of non linear effects the equation of motion can be written as 8 i a θ 0 t κ t τ θ τ d τ c s i n θ m d t m m t m b t m e t where a is the added mass moment of inertia at infinite frequency κ is the memory function c is the hydrostatic restoring coefficient m d is the drag moment m m is the mechanical moment m b is the braking moment and m e is the excitation moment the expressions for i c m m and m e were presented in section 2 1 1 the memory function can be expressed as falnes 2002 9 κ t 2 π 0 b ω c o s ω t d ω the drag moment m d can be written as gomes et al 2015 10 m d t 1 2 ρ w w c d h l h θ t r u n θ t r u n r d r where c d is the drag coefficient h is the water depth r is the radial coordinate with respect to flap s axis of rotation and u n is the velocity of water particles normal to the flap surface written as 11 u n u c o s θ w s i n θ where u and w are the horizontal and vertical velocity component see fig 1 of water particles in the absence of the flap respectively the velocity components can be derived from incident wave potential at x 0 mccormick 1973 the braking moment m b will be detailed in section 2 2 the time averaged energy flux e of regular linear waves per unit wave crest length is cummins 1962 12 e ρ w g ω a w 2 4 k 1 2 k h sinh 2 k h where k is the wave number the time averaged power extracted by the linear pto can be written as falnes 2002 13 p ω 1 2 ω 2 b m θ ω 2 where θ is the flap motion amplitude the instantaneous power extracted by the pto can also be written as 14 p t b m θ 2 using the above quantities a capture width can be defined as 15 l c p ω e which can be made dimensionless by using the flap width w as l c w 2 2 computational modeling based upon the governing equations presented in the previous section linear and non linear models of flap dynamics and power extraction were developed in comsol multiphysics 5 1 documentation for comsol by using its multibody dynamics module fig 2 illustrates a general view of the computational model the system was assumed to consist of a rigid flap with dimensions shown in fig 2 and table 1 a foundation over which the flap is hinged and a pto mechanism attached to the axis of rotation at the bottom of the sea the flap was assumed to be pitching about a hinge joint that has a torsional spring and damper the water depth h was considered as 10 m in all models in this study several types of flap geometries were analyzed by changing the thickness height and width of the flap table 1 presents the flap geometries along with wave amplitudes analyzed in the linear and non linear models the density of the flap and sea water were assumed as 256 25 and 1025 k g m 3 gomes et al 2015 respectively in all models in addition the comsol model was interfaced with matlab codes developed for calculating the memory function and convolution integral this was achieved through comsol s livelink for matlab facilitating data exchange between comsol and matlab during the solution procedure from the hydrodynamic coefficients in gomes et al 2015 explained more below b ω was generated to allow the computation of κ matlab curve fitting tool was used to obtain b ω as a rational function for the flap geometries studied in the non linear model section physics controlled mesh sequence and finer mesh size were used to discretize the rigid structure in the comsol models performing time dependent analysis of dynamic behavior of the device the physics controlled mesh sequence option creates tetrahedral meshes grid refinement studies were performed to ensure the numerical results are grid independent an example of such studies is shown in fig 3 depicting the time history of the relative angular rotation of a flap of height l 5 m width w 10 m and thickness t p 2 m in response to a wave frequency of ω 1 3 rad s and an amplitude of a w 0 5 m as can be seen the results are grid independent and the finer mesh provides sufficient resolution to accurately capture the flap dynamics the hydrodynamic coefficients were incorporated as frequency dependent parameters in the comsol models the coefficients are based on the work by gomes et al 2015 in which wamit software t 7 1 user manual was used to calculate the hydrodynamic coefficients of a bottom hinged flap type wec gomes et al reported see fig 4 in gomes et al 2015 non dimensional added mass moment of inertia a radiation damping b and wave excitation moment γ as a function of non dimensional wave frequency ω the non dimensional quantities are defined as gomes et al 2015 16 a a ρ w h 4 w 17 b b ρ w g h 3 5 w 18 γ γ ρ w g h 2 w 19 ω ω h g since the impact of the flap thickness on the hydrodynamic coefficients is small gomes et al 2015 considered a zero flap thickness approximation in calculating the hydrodynamic coefficients for both linear and non linear models and unless it is stated otherwise the mechanical damping coefficient b m of the pto mechanism was considered as b m o p t given below which is the optimized power extracted from a linear system falnes 2002 20 b m o p t b 2 c ω ω i a 2 where a and b are the added mass moment of inertia and radiation damping coefficient respectively the braking moment m b applied on the axis of rotation in order to limit the flap pitch angle θ is calculated as gomes et al 2015 21 m b t 0 θ θ b f b b θ 3 θ θ b f θ b s θ b f 2 2 θ θ b f θ b s θ b f 3 θ b f θ θ b s b b θ θ θ b s where the braking moment coefficient b b 10 ρ w g 0 5 h 3 5 w θ b f is the angle where the braking moment starts to engage which is defined as π 6 and θ b s is the angle where the braking moment acts linearly which is defined as 2 π 9 3 results in this section the linear and non linear comsol models are first validated through comparison with gomes et al 2015 then the improved pto techniques are introduced for each model and the associated enhancements in power extraction are quantified 3 1 linear model 3 1 1 validation results the comsol model developed in this study was used to simulate the linear response of the wec device under the conditions stated in table 1 note that following gomes et al 2015 the optimized damping coefficient b m o p t eq 20 and a zero spring coefficient c m 0 are applied then the steady state response of the flap was used to calculate the capture width l c in each case fig 4 presents our results for the non dimensional capture width l c w along with comparison to the results reported in gomes et al 2015 for various flap geometries and t p h in fig 4 g refers to the results reported by gomes et al 2015 and c refers to the results obtained by our comsol model as can be seen in fig 4 the results agree very well validating the comsol model additionally the magnitude of the flap motion amplitude θ in the above simulations are presented in fig 5 the figure shows θ divided by the wave amplitude a w and confirms that the conditions required by the linear wave theory are met next the comsol model will be used to propose optimized pto techniques leading to enhanced wave power extraction 3 1 2 parametric study results following the validation studies a parametric study was performed to explore the ways that the power extraction efficiency can be improved through optimization of the mechanical damping and spring coefficients two of the simulations presented in section 3 1 1 were selected for this parametric study case a is a fully submerged flap with a height of l 5 m width of w 10 m thickness of t p 2 m with a wave frequency of ω 1 456 rad s case b is a surface piercing flap with l 10 m w 20 m and t p 1 m with a wave frequency of ω 0 812 rad s case a and b are shown in fig 4 a and h respectively as it is seen when b m b m o p t and c m 0 case a exhibits a relatively poor power extraction performance l c w 0 114 whereas case b shows a strong performance l c w 0 712 next we will show that by optimizing b m and c m coefficients of the pto system the power extraction performance in both case a and b can be enhanced fig 6 a and b present the magnitude of the flap motion amplitude θ and the non dimensional capture width l c w respectively as a function of b m and c m for case a note that with b m b m o p t and c m 0 which was studied in section 3 1 1 case a shows θ 0 07 rad or 4 from fig 6 a and b it is seen that the capture width increases as θ becomes greater which is expected because θ plays an important role in power extraction it is also seen that for certain ranges of b m and c m θ and capture width drastically increase which happens because the natural frequency of the device at those b m and c m values becomes close to the incident wave frequency ω 1 456 rad s for case a hence the device operates at or close to the resonance state however if the amplitude of oscillations becomes too large due to resonance the small amplitude assumption of the linear theory can be violated to address that the damping coefficient can be increased in an optimized fashion to keep the amplitude below the limit but at the same time achieve the greatest power extraction performance possible in this study the flap motion amplitude limit was assumed to be π 6 gomes et al 2015 our parametric study shows that the capture width in case a can be increased to l c w 0 8 by changing the damping and spring coefficients to b m 1 37 10 5 n m s r a d and c m 1 6 10 6 n m r a d this represents a significant improvement in the power extraction performance by approximately 600 compared to the device performance when b m b m o p t and c m 0 next using a similar parametric study we will propose further improvements to the power extraction performance in case b which already shows high performance when b m b m o p t and c m 0 fig 6 c and d present θ and l c w respectively as a function of b m and c m for case b note that θ 0 063 rad or 3 6 when b m b m o p t and c m 0 it is seen again that θ and capture width increase for the given range of b m and c m although the increase is not as drastic as in case a imposing the same oscillation amplitude limit the parametric study shows that the capture width in case b can be optimized and increased further to l c w 1 12 by using b m 4 5 10 7 n m s r a d and c m 7 10 7 n m r a d this represents an improvement of about 57 compared to the case with b m b m o p t and c m 0 which is still significant the above studies demonstrate that the damping coefficient given in eq 20 does not necessarily lead to an optimized performance and that the power extraction performance can be significantly increased by optimizing the damping and spring coefficients 3 2 non linear model 3 2 1 validation results in this section the non linear comsol model was used to study the flap performance under various conditions given in table 1 and with different damping coefficients following gomes et al 2015 five different damping coefficients were considered in total which will be expressed as a non dimensional mechanical damping coefficient b m given by 22 b m b m ρ w g 0 5 h 3 5 w the comsol model was interfaced with a matlab code developed to compute the convolution integral and calculate the memory function in the calculation of the extracted power via the pto an average power extraction was computed by using the data over 10 wave periods after transient effects were diminished fig 7 presents the flap motion amplitude and the non dimensional capture width results with b m b m o p t and a wave amplitude of a w 0 5 m as it is seen the comsol model results denoted by c agree very well with the results by gomes et al 2015 denoted by g as fig 7 shows the capture width decreases significantly when the braking moment is activated to limit the flap motion amplitude the energy that should have been extracted by the pto was lost to the braking moment on the other hand the braking moment is a necessary system component to keep the flap oscillations within the prescribed range and to prevent damages to the device due to extreme sea conditions to better understand the adverse effects of the braking moment on the capture width the wave amplitude a w was increased to 1 m while the flap width was kept at w 20 m following gomes et al 2015 five different mechanical damping coefficients were considered including b m b m o p t b m b m c 0 b m 0 05 b m 0 1 and b m 0 3 here b m c 0 was the optimum mechanical damping coefficient eq 20 with no hydrostatic restoring i e c 0 the results are presented in fig 8 again the results of our model show excellent agreement with gomes et al 2015 validating the non linear comsol model next the comsol model was used to enhance the power extraction through improved pto techniques 3 2 2 enhanced power extraction through improved pto techniques from the validation results it can be concluded that the optimized mechanical damping coefficient eq 20 proposed in the literature does not lead to an optimum power extraction in every case in this section we propose two mechanical damping functions and through comsol simulations show that they enhance the power extraction performance the functions were tested in surface piercing flaps of height l 10 m and width w 10 20 and 50 m the results are compared with cases where the mechanical damping is determined by eq 20 with and without hydrostatic restoring we begin with a non linear mechanical damping function designed to avoid the engagement of the braking system and the associated energy loss the function which is named non linear damping function and denoted by b m n takes into account the limit of flap motion amplitude and is expressed as 23 b m n f θ g θ b m o p t where f θ and g θ are functions of the angular rotation θ and the angular velocity of the flap θ respectively a 6 t h order polynomial is proposed for f θ given as 24 f θ c 1 θ 6 c 2 θ 5 c 3 θ 4 c 4 θ 3 c 5 θ 2 c 6 θ c 7 where through matlab curve fitting tool the coefficients were found as c 1 883 c 2 2148 c 3 1021 c 4 36 61 c 5 69 71 c 6 9 575 c 7 1 228 the function g θ was defined as 25 g θ d 1 e d 2 θ d 3 e d 4 θ where the coefficients determined by matlab curve fitting tool are as follows d 1 5 35 10 7 d 2 46 14 s d 3 1 143 d 4 2 547 s the objective in the derivation of f θ and g θ functions and their coefficients was that b m n should increase when θ and θ increase in order to capture more power while keeping the flap motion below the amplitude limit without engaging the brake mechanism the second damping function introduced in this work was developed by employing the frequency dependent flap motion equation journée and massie 2001 26 θ ω a w γ ω ω 2 i a i ω b b m c c m note that eq 26 is meant for linear dynamics of the flap and can be used only when the non linear effects are small knowing the hydrodynamic coefficients eq 26 can be solved for the wave frequencies and flap geometries specified in this study to examine whether the flap motion amplitude exceeds the limit which is equal to π 6 when the flap motion amplitude exceeded the limit the mechanical damping coefficient was increased systematically for the wave frequencies until the flap motion amplitude becomes less than π 6 for such cases a new increased mechanical damping value was generated by the matlab code and used in the comsol model however if the flap motion amplitude never exceeds its limit in eq 26 the optimal mechanical damping coefficient was used the new increased mechanical damping is denoted by b m l the ratio of b m l b m o p t as a function of the wave period is plotted in fig 9 for various flap width next the results obtained from various pto techniques including b m b m o p t b m b m c 0 b m b m n and b m b m l are presented for a w 1 m and flap width of w 10 20 and 50 m the amplitude of flap oscillations and the non dimensional capture widths are shown in fig 10 for each case comparing the results of various pto techniques it is clearly seen that the overall power extraction is not the highest when b m b m o p t using other pto techniques most notably b m n and b m l proposed in this study the overall power extraction can be significantly improved while keeping the amplitude within the specified range the improvement achieved with the new pto techniques compared to using b m o p t varies with flap width and are presented in table 2 another idea could be to switch between the optimum mechanical damping coefficient b m o p t and the non linear mechanical damping function b m n according to the wave period to recover the energy lost to the brake mechanism in other words the non linear mechanical damping function is only used when the flap motion amplitude becomes larger than the limit otherwise the optimum mechanical damping coefficient is used the improvement in overall power extraction achieved by this approach is listed in table 2 for different flap width as the above results show by preventing the engagement of the brake through improved pto techniques the overall power extraction efficiency can be increased significantly as high as 19 without exceeding the limit in the amplitude of oscillations 3 3 comparison between linear and non linear models finally to compare the performance of the linear and non linear models we consider a case where the flap dimensions are l 10 m w 10 m and t p 2 m and the wave amplitude is a w 0 5 m note that the viscous effects such as drag loads are neglected in the linear model but included in the non linear model by considering a drag coefficient of c d 1 98 furthermore to be able to properly compare the results a new linear model simulation was performed over a wave period of 5 t 25 s which is different than the results presented earlier in figs 4 and 5 fig 11 shows the results and a comparison in a the flap motion amplitude and b the non dimensional capture width it is seen that the results obtained from the linear and non linear models are very close except near the resonance point where the non linear effects are strong such similarity in the flap dynamics can be explained by the keulegan carpenter kc number which represents the competition between the drag and inertia forces and can be defined as kc 2 π a w w wei et al 2015 when the kc number is greater than o 10 the viscous effects are dominant sarpkaya and isaacson 1981 in the case presented in fig 11 the kc number is π 10 indicating relatively weak viscous effects thus the flap dynamics obtained from the linear and non linear models are expected to be close note that other conditions may lead to larger differences between the linear and non linear models depending on the relative magnitude of forces 4 summary and conclusions linear and non linear modeling of the dynamics of a bottom hinged flap type wec was carried out in comsol where the multibody dynamic module was used and interfaced with matlab the waves were assumed regular and the linear wave theory was used which requires the flap oscillation amplitude to be small validation studies were performed on both linear and non linear models using the linear model parametric studies were performed on fully submerged and surface piercing wecs to improve the pto mechanisms the studies showed significant enhancements in the power extraction efficiency 600 in the fully submerged case and 57 in the surface piercing case the findings from the linear model show that the power extraction performance can be increased by adding a spring to the pto mechanism and varying the mechanical spring and damping coefficients varying the mechanical spring coefficient effectively leads to a variation in the natural frequency of the flap bringing it very close to the incident wave frequency and ultimately leading to a better power extraction performance various mechanical damping techniques were investigated using the non linear model from the validation studies it was clear that significant amount of energy is lost due to the engagement of the brake mechanism over a specific range of wave frequency the brake is a necessary system component to ensure the amplitude of the flap s motion remains reasonably small we developed and tested two mechanical damping techniques that keep the amplitude small and within range but avoid the brake engagement hence recover the lost energy the improvements in power extraction over the specified wave period range vary with the flap width and are as high as 19 in conclusion the computational simulations show that the pto techniques proposed in this study can lead to an enhanced power extraction performance in bottom hinged flap type wecs under both linear and non linear regimes although irregular waves were not studied in this work the proposed pto techniques are expected to be still useful in real sea environment mainly because the central idea behind them is to avoid engagement of the brake mechanism which results in energy loss further studies should be performed to fine tune the proposed pto techniques for irregular waves present at each specific deployment area acknowledgements mr gratefully acknowledges the research support from the national science foundation under the cbet grants 1236462 and 1336232 
22803,random wave cfd experiments have been carried out to study the loading process on a sloping top caisson breakwater subject to significant overtopping numerical results suggest that since wave force under crest is reduced by the overpassing wave pressures under trough become comparatively larger leading the structure to fail seaward even in absence of violent impact events this finding is consistent with what observed by oumeraci 1994 in reviewing the failures of a number of vertical face breakwaters during the first half of 20th century present findings also show that wave pressures under trough may be significantly underestimated by the design formulae currently available to face this issue a set of simple alternative equations are proposed based on the maximum momentum flux concept originally introduced by hughes 2004 a second part of the research work is dedicated to the occurrence of intense impulsive loadings at rear of the breakwater caused by the huge inertia of the overtopping jet the analysis of this interesting phenomenon is though presented in a separate paper keywords numerical modeling computational fluid dynamics sloping top breakwater wave force wave impact 1 introduction monolithic breakwaters have been employed for the protection of harbor areas since times before the ancient roman empire the most common type generally referred to as vertical face breakwater or vertically composite breakwater consists of an upright wall rested on a foundation mound as well documented by oumeraci 1994 in first half of the 20th century such kind of structures suffered from catastrophic failures which led to their almost complete abandoning many of those breakdowns were caused by tremendous wave forces associated with wave breaking and featured by an impulsive nature however nearly 50 years later the need for structures at large water depths with a relatively low cost reignited the interest about vertical face breakwaters giving rise to an intense research work the latter culminated in the eu funded project proverbs probabilistic design tools for vertical breakwaters which gathered together the most important european research groups oumeraci et al 1999 in those years the effort of scientists was addressed at either improving the knowledge about the wave structure interaction or suggesting solutions to reduce the intensity of hydrodynamic loadings exerted on the walls many milestone papers were dedicated at describing the mechanics of wave breaking and the related impulsive loadings cooker and peregrine 1990 kirkgoz 1991 hattori and arami 1992 oumeraci et al 1993 the authors recognized that under heavy plunging breakers air tends to be trapped between wave and structure so cushioning the impact of most of water mass peregrine 2003 however the maximum pressure was observed prior the air trapping and was caused by the direct collision between the plunging water jet and the wall hammer shock see also lundgren 1969 following an interesting alternative approach some research focused instead on the loading case predictability that consists in individuating the hydraulic conditions under which impulsive or quasi static forces tend to take place oumeraci et al 1999 calabrese and buccino 2001 calabrese et al 2000 as for the strategies to reduce the intensity of wave actions the solutions proposed in literature basically include lowering of the breakwater crest so to allow a significant wave overtopping under the design storm and changing of the outer profile from perfectly vertical to inclined or curvilinear yet significant uncertainties still remain on the effectiveness of those suggestions essentially due to the stalling of the research work in the new millennium thus despite commonly accepted by engineers the beneficial role of wave overtopping is not completely demonstrated goda 1995 reasoned that historically the low crest of japanese vertical face breakwaters traditionally 0 6 times the design wave height prevented structures from being damaged by violent impact loadings conversely the aforementioned case histories presented by oumeraci 1994 reported a number of examples in which the walls failed just after experiencing severe overtopping it should be noticed then that failures occurred often seaward in actuality at current state of knowledge the prediction of the design wave loadings at low crested monolithic breakwaters is affected by two sources of uncertainty and namely 1 since wave overtopping reduces the horizontal force under wave crest loadings under wave trough become comparatively more important however the reliability of the existing design methods for such a wave phase has been little investigated for conventional non overtopped vertical face breakwaters a laboratory study by mcconnell et al 1999 showed that significant underpredictions could occur but this result has been not analyzed further 2 engineers are used to accounting for wave overtopping effects by simply truncating the wave pressure distributions valid for non overtopped breakwaters this means loadings generated by the overtopping process onto the inner face of the structure are considered negligible but this assumption is far from being scientifically ascertained regarding the previous point 2 walkden et al 2001 warned that massive overtopping may cause intense impulsive loadings at rear of the structure due to the huge inertia of the overtopping jet the authors referred to this phenomenon as plume impact and hypothesized it to be significantly affected by the air trapped between the jet and the wall since a non negligible amount of momentum might be transferred from the air cushion to the water column unfortunately the research of walkden et al 2001 was based on small scale physical model tests conducted on three individual waves only and accordingly the features of the plume impact could not be appropriately investigated information on wave loadings at inclined or curvilinear walls generally come from regular wave laboratory studies the main results of those works consist in prediction formulae e g tanimoto and kimura 1985 takahashi et al 1994 which slightly modify the traditional design tools valid for vertical structures these new predictive equations need to be further verified especially under random wave conditions additionally more details on other aspects of the wave structure interaction such as shape of wave profiles at walls loading case prediction etc would be desirable similarly to what accomplished for vertical face breakwaters this study aims to give a contribution at filling the research gaps previously highlighted analyzing the loadings exerted by random waves on a sloping top caisson breakwater subject to significant overtopping sloping top caisson breakwaters the first built in napoli italy in 1906 possess a sloping roof that convert part of the wave action into a downward directed force that aids the stability under crest such kind of structure was used by walkden et al 2001 when investigating the plume impact while takahashi et al 1994 developed a design formula to predict wave pressures under crest which modifies the well known equation of goda 1986 for vertical face breakwaters the analysis has been carried out via numerical experiments conducted in a computational fluid dynamics cfd wave flume based on the commercial code flow 3d flow science inc 2009 the cfd technique which solves numerically the navier stokes equations is recently growing popular in the field of coastal and ocean engineering e g jun and meng 2011 kamath 2015 antonini et al 2016 2017 miquel et al 2018 and has proved rather efficient in describing the loading process at monolithic coastal structures even under breaking waves vicinanza et al 2015 buccino et al 2016 in case of relatively little researched topics like are partly those treated here the use of cfd allows providing very detailed information on the phenomena under study since a great deal of probes can be employed at once this feature is of course essential for the comprehension of physical processes and planning of future research works finally a breakwater at full scale can be simulated so reducing scale effects cuomo et al 2010 and the experiments can be repeated with and without the presence of air see gaeta and lamberti 2015 the present research is divided into two parts after discussing and validating the numerical model sections 2 and 3 this article deals with wave shapes at the outer face of the a sloping top breakwater loading case predictability and reliability of the available design tools in predicting wave force under both the crest and the trough phases the second part of the research buccino et al 2019 is instead expressly dedicated to the analysis of plume impact 2 governing equations and turbulence closure it is assumed the physical processes here investigated to be governed by the reynolds averaged navier stokes equations rans for incompressible fluids in a 2d reference where the x axis is perpendicular to the coast onshore directed and the z axis is vertical upward directed the continuity equation reads 1 u x w z 0 where u and w are the turbulence averaged velocity components along x and z respectively the momentum equations are 2 u t u u x w u z 1 ρ p x 2 x ν ν t u x z ν ν t u z w x 0 3 w t u w x w w z 1 ρ p z g x ν ν t u z w x 2 z ν ν t w z 0 where ρ is the fluid density g is gravity p is the turbulence averaged pressure and ν is the kinematic viscosity the eddy viscosity νt is expressed as 4 ν t c μ f μ k 2 ε where k is the turbulent kinetic energy ε is the dissipation rate of k c μ is an empirical constant and f μ is a damping factor the latter reduces exponentially with the turbulence reynolds number r t k 2 νε to determine k and ε two additional transport equations must be solved 5 k t u k x w k z x ν ν t σ k k x z ν ν t σ k k z ε p 0 6 ε t u ε x w ε z x ν ν t σ ε ε x z ν ν t σ ε ε z c 2 ε 2 k c 1 ε k ν t p 0 where the shear production p is defined as 7 p ν ν t ρ 2 u x 2 u z w x 2 2 w z 2 eqs 5 7 represent the widely known standard k ε turbulence model where σ k σ ε c 1 and c 2 are additional constants launder and spalding 1974 however in this study a renormalized group rng extension of the above model has been used rng here the parameters c μ c 1 σ k and σ ε still remain constant c μ 0 085 c 1 1 42 σ k σ ε 1 39 whereas c 2 is assumed to vary with p according to the formula yakhot et al 1992 8 c 2 1 68 c μ β 3 1 0 2283 β 1 0 012 β 3 in which 9 β k ε p ν ν t by allowing c 2 to vary with the fluid strain rate a presumably more general model is obtained that should yield more accurate results for strongly sheared flows bradford 2000 in this respect it is interesting to remark that comparing numerical cfd simulations to the experiments of ting and kirby 1994 bradford 2000 found out the rng closure to be more effective than standard k ε model in simulating the evolution of plunging breakers both prior and just after the onset of breaking this result is particularly useful for the present research where waves have been observed to break in wise of plunging breakers at a short distance from the structure fluid configurations are defined in terms of a volume of fluid vof function f x y z t hirt and nichols 1981 which represents the volume of fluid that occupies a portion of space of unitary volume f satisfies the following transport equation 10 f t u f x w f z 0 for a single incompressible fluid with a free surface fluid exists where f 1 while locations where f 0 correspond to void regions in which a uniform pressure is applied in case of two incompressible fluids with no free surface f represents the volume fraction of the fluid 1 whereas the complementary region with volume fraction 1 f represents fluid 2 3 numerical solution the equations above described have been finite difference solved via the commercially available multi physics cfd software flow 3d developed by flow science inc 2009 flow 3d has been recently employed with satisfactory results in a number of wave structure interaction problems including both impermeable walls and permeable breakwaters e g buccino et al 2016 vicinanza et al 2015 dentale et al 2014a 2014b the flow region is subdivided into a mesh of fixed rectangular cells at center of which are located all the variables but velocities which are situated instead at the cell faces staggered grid arrangement curved obstacles wall boundaries or other geometric features are embedded in the mesh by defining the fractional areas of the cells that are open to flow favor method hirt and sicilian 1985 the governing equations are discretized as follows 11 u i 1 j n 1 u i j n 1 δ x w i j 0 5 n 1 w i j n 1 δ z 0 12 u i j n 1 u i j n δ t n 1 a ux a uy a uz i j n vi s x i j n 2 ρ i j n ρ i 1 j n p i 1 j n 1 p i j n 1 δ x 13 w i j n 1 w i j n δ t n 1 a wx a wy a wz i j n vi s z i j n 2 ρ i j n ρ i j 1 n p i 1 j n 1 p i j n 1 δ z where the subscripts indicate the cell coordinates and the superscripts indicate time step δx and δz represent the cell length and height respectively while δt is the time step size see subsection 3 1 in the momentum equations both the advective fluxes a αβ and the viscous terms vi s x z are calculated explicitly using the old time level n according to the first order donor cell approximation method as far as the fluid density ρ is concerned a single value is used in case of one incompressible fluid flow whereas a weighted average over the vof function f is employed for two incompressible fluids since in eq 11 13 pressures and velocities are coupled implicitly an iteration solution procedure is needed to this purpose the momentum balance is firstly solved using the pressure gradient at the time level n this gives an intermediate velocity vector u which is linked to the real velocity at the time step n 1 u n 1 by the following relationship 14 u n 1 u 2 δ t n 1 ρ i j n ρ i 1 j n p where p p n 1 p n by inserting eq 14 into eq 11 a poisson equation in p is obtained which is solved through the generalized minimum residual method gmres saad 1996 after obtaining u n 1 the new free surface configuration is computed with the vof method while k and ε are computed using analogous discretizations of 5 and 6 3 1 stability considerations flow 3d uses variable time stepping to maintain the stability and accuracy of the solution in particular the n th time step size δtn is automatically adjusted to 15 δ t n min δ t con n δ t s where δ t s is a user defined sampling rate which depends on the frequency spectrum of the phenomenon under study and δ t con n is a convergence time step size that is needed to avoid numerical instabilities since the advective fluxes have been computed using a simple first order donor cell δ t con n is required to meet the following criterion 16 δ t con n min 0 5 δ t cfl 0 5 δ δ x δ z δ az where δ t cfl is the time step to satisfy the courant friedrichs lewy cfl stability criterion and the second quantity at the right hand side of eq 16 ensures surface waves cannot propagate more than one cell in one time step az indicates vertical acceleration 3 2 validation study to validate the numerical model above described with respect to the interaction between waves and sloping walls with a particular focus on the loading process and wave shape at the structure a comparison with the 2d physical model tests carried out by buccino et al 2015 is here presented the lab experiments were conducted on a small scale model of seawave slotcone generator ssg a wave energy converter based on the overtopping principle vicinanza et al 2012 the ssg has been placed on the top of a steep multi linear slope seaward of which the water depth d has been kept constant fig 1 a regular waves with different height and period have been generated and the hydrodynamic pressures have been acquired via four resistive transducers fig 1b sampled at 1 khz the numerical flume fig 2 has been set up at full scale and reproduces un distortedly both the ssg and the foreshore according to the sensitivity analysis described in buccino et al 2016 the computational domain 400 m in the x direction and 60 m in the z direction has been divided into three zones the meshes 1 and 3 include 62 400 and 14 400 cells respectively the size of which is 50 50 cm the local mesh that surrounds the wec mesh 2 consists instead of 38400 cells 0 25 0 25 m for the aims of the present work two experiments have been selected whose wave parameters calculated at the flat part of the flumes are reported in table 1 note that numerical experiments have been carried out with a single incompressible fluid given the urserll number hl 2 d 3 do not exceed 2 0 numerical regular waves have been generated using the linear wave generator available in flow 3d lateral and upper limits of the numerical flume have been treated as symmetry boundaries s where the velocity gradient vanishes and the turbulence production is zero also a zero flow area has been here imposed that automatically ensures no advective or diffusive fluxes at the bottom a wall condition w has been set implying no slip as well as zero velocity gradient since flow 3d includes no active absorption system only the part of the numerical loading signals that is unaffected by re reflection at the wave generator has been considered for the analysis see subsection 4 6 from table 1 it is seen lab and numerical wave heights to differ by 10 at most whereas wave periods deviate from each other by few percents only for test v a a simple quasi standing wave with no overtopping was observed fig 3 as shown in fig 4 the numerical model satisfactorily reproduces duration and shape of loadings besides their magnitude in particular panels b and c suggest the non linearity of pressure time series is well captured whereas panel d ensures no overtopping has taken place since the pressure signals have a zero amplitude fig 5 compares the wave profiles at the wall during test v b which corresponds to a heavy plunging breaker the numerical model properly reproduces the hammer shock which occurs approximately at the ssg toe first panel from the top the secondary splash up buccino et al 2015 where the water mass hits again the structure onto the higher plate second panel the overtopping phase third and fourth panel the impacts generated by the hammer shock and secondary splash up produce impulsive pressure events at the transducers 1 and 3 which are realistically simulated in the numerical flume as shown in fig 6 4 study of a sloping top breakwater to investigate the structural response of sloping top breakwaters the full scale numerical wave flume pictured in fig 7 has been employed the structure is located 300 m far from the wavemaker wv at the rear of the wall the channel continues by 200 m up to an outflow boundary o which let the waves to flow out without any reflections lateral walls flume upper and limit bottom have been subjected to the same boundary conditions as those described in section 3 2 4 1 structure details the structure tested fig 8 has a total height of 21 42 m and the sloping part is inclined to the horizontal by θ 30 the height of the sloping top s is 5 39 m whilst the upright section v measures 16 03 m the sea floor is constant with a still water depth d 18 9 m altogether the structure is rather similar to that used by walkden et al 2001 who tested a caisson with the same s to v ratio 0 34 and θ 35 on the other hand takahashi et al 1994 employed steeper tops θ 45 and 56 and s v ranging from 0 26 to 0 92 a leading feature of the breakwater here considered is that the lower tip of the sloping face is located 2 87 m underwater whereas in walkden et al 2001 it was just at the mean water level as shown later in the paper this characteristic which might be generated by a rise of the mean sea level under the design storm could of course affect the statics of the structure this because while enhancing the stability under wave crest an upward directed component of the wave force tends to take place at the sloping top under the trough phase it is also noteworthy that four structures out the six considered in the takahashi et al 1994 study had a partially submerged sloping profile 4 2 grid selection in order to select the most appropriate grid dimensions a sensitivity study has been conducted three rectangular grids with different cell size have been tested and namely 0 5 m horizontal x 1 m vertical 0 25 m 0 5 m 0 125 m 0 25 m for each mesh the structure has been subjected to a train of 30 regular waves and the signal of the horizontal force exerted onto the front face has been acquired wave generation has been carried out via the cnoidal wave generation tool available in flow 3d the generated waves h 4 4 m and t 8s have been preliminarily checked to reach the structure without breaking in order the sensitivity analysis were not affected by the inherent randomness of loadings induced by breaking waves buccino et al 2015 peregrine 2003 it is also worth noticing that for each grid flow 3d uses variable time stepping to maintain the stability and accuracy of solution see subsection 3 1 as shown in fig 9 the widest grid tends to create deep troughs that are not observed with the finer ones on the other hand the results for 0 25 m 0 5 m and 0 125 m 0 25 m are very similar to each other to measure the degree of convergence two indicators have been introduced and namely a the relative error from the wider to the finer grid defined as 17 r s s t d e v f w i d e f f i n e max f f i n e where f represents the force signal and the subscripts wide and fine refer to the wider and the finer grid used the symbol stdev indicates standard deviation b the square correlation between the force signals 18 r 2 ε f w i d e f f i n e s t d e v f w i d e s t d e v f w i d e 2 in which e indicates statistical expectation results of the analysis are summarized in table 2 which confirms the substantial coherence between the grids 0 5 m 0 25 m and 0 25 m 0 125 m r2 exceeds 99 accordingly the former has been selected for the final experiments 4 3 waves and hydraulic variables eleven sea states have been generated lasting approximately 30 waves each sea state was driven by a very narrow banded spectrum accordingly the incoming waves had almost the same period whereas their height could vary narrow banded wave series have been first generated numerically through a specific code written in labview then the power spectrum has been calculated and used as input for wave generation in flow 3d table 3 reports the main wave statistics whilst table 4 shows some relevant non dimensional variables as well as sampling rate δts note that the ursell number at the fifth column is calculated as 19 u r h m 0 l p 2 d 3 in which h m 0 is the spectral significant wave height and l p is the local wavelength obtained by the linear dispersion relationship using the peak period t p the range of wave steepness h l 0 024 0 093 is almost identical to that tested by takahashi et al 0 023 0 109 and same goes for relative water depth d l 0 124 0 315 vs 0 09 0 23 as far as relative crest freeboard is concerned the present study focuses on structures subject to significant overtopping rc h 0 356 0 829 whereas takahashi et al extended their analysis to non overtopped breakwaters too rc h 0 321 3 81 it is also worth to mention that the three individual waves tested by walkden et al 2001 had a 0 17 m height and a 1s period corresponding to a wave steepness of 0 11 and a relative crest freeboard 0 558 it is finally noteworthy that waves travelled by 2 5 wavelenghts before reaching the structure while this distance ensures them to be properly developed on the flat bottom it substantially dampens the effects of undesired phenomena of turbulence over production as recently shown by larsen and fuhrman 2018 in fact the authors concluded that the short propagation distance allotted prior the onset of breaking limits the turbulence overproduction problem even in the post breaking phase 4 4 fluid properties the experiments from 1a to n2 have been conducted with a single fluid water i e neglecting any effect of air on contrary in the tests 3a 3b and 4a the presence of air has been accounted for using the two fluid model option of flow 3d accordingly the properties of water and air density viscosity have been assigned separately and the governing equations have been solved for all fluid cells regardless of fluid fraction in the simulations the fluids have been assumed immiscible and incompressible 4 5 measurements fluctuations of the free surface were acquired in six positions in front of the structure while a single probe was used to measure wave transmission not dealt with here fig 10 along with the horizontal component of the wave force time series of pressure have been surveyed in 10 positions in front and 10 positions behind the breakwater the chronogram of the overtopping discharge has been also obtained fig 11 and the wave structure interaction was visually inspected by videos incident and reflected waves were separated via the zelt and skjelbreia 1992 method which is based on a weighted least square procedure in the frequency domain force and pressure signals have been analyzed separately in front and at the rear of the wall to capture the effect of wave overtopping the rise time of loading events has been calculated as the time interval between the instants corresponding to the 2 5 and 97 5 of the peak magnitude finally the impulse has been obtained from integration in time 4 6 wave absorption unfortunately flow 3d does not allow active wave absorption however in this study the presence of a significant overtopping rate limits the effect of undesired re reflections at the wavemaker to analyze this point the horizontal force signal has been divided into two time segments the first δt1 corresponds to the time interval for the first wave reaching the structure to travel back to the wavemaker at the linear phase speed and reach the breakwater again the second segment δt2 lasts from the end of δt1 to the end of the test fig 12 compares the standard deviation of the horizontal force signal for δt1 and δt2 respectively the graph shows a difference of 4 63 on average indicating the effect of re reflections is practically negligible 5 results 5 1 wave shapes and loading features at the front face 5 1 1 analysis of wave patterns as argued in the proverbs project nature and magnitude of wave loadings at the outer face of monolithic marine structures may significantly vary depending on the shape of the wave profile in this study three different wave patterns have been recognized and namely c broken waves d plunging breakers e quasi standing waves broken waves were observed in sea states with high steepness an example of wave evolution is shown in fig 13 which refers to the test 1a in the picture the incoming wave is seen to plunge into the water in the neighborhood of the sloping top frame b then the wave reforms and a secondary plunging jet detaches from the new crest hitting the wall frames c and d finally the breakwater is overtopped frame f the resulting force chronogram displayed in fig 14 is characterized by a nearly 3 hz oscillation which likely corresponds to the natural frequency of the flume excited by the curling down of the wave into the water low left tip of the figure the impact of the secondary plunging jet onto the wall produces a sharp peak with a distribution of pressures at the instant of maximum force that is typical of the impact events e g peregrine 2003 the measured pressures are significantly larger compared to the predictions of the takahashi et al 1994 method reported in green in fig 14 and in fig 14 a the maximum pressure is underestimated by 80 whereas an average underprediction of 40 is observed along the wall in the case just described the beneficial effect of the sloping top is seen to be twofold besides transforming part of the wave slam into vertical force so reducing the horizontal thrust the phase lag between the wave pressures along the wall leads the maximum horizontal force to be delayed compared to the impulsive peak this is clear in fig 14a where it is seen that the peak pressure onto the slope is about 11 m but when the maximum force is attained it is reduced to 8 m i e 30 less impact events generated by plunging breakers have been recorded in tests dominated by broken waves as a particular case in which the curling wave hits the structure instead of plunging into the water an example is given in fig 15 which also refers to the test 1a the slam of the water tongue leads to impulsive loadings around the transducer s14 i e at the junction between the sloping and the upright section see fig 16 and a the takahashi et al predictions are again largely exceeded the maximum pressure is underestimated by 90 with an average underprediction of 50 along the wall however the maximum measured pressure is of the order of two times the incident significant wave height which is far lower than what observed on conventional vertical breakwaters where relative pressures larger than 10 have been reported goda 1995 allsop et al 1996 this occurs because the sloping top constrains the wave front to experience a significant rotation before reaching the structure curling down whereas on vertical breakwaters the impact takes place almost frontally oumeraci et al 1993 calabrese and buccino 2001 with longer periods quasi standing waves occur an example is given in fig 17 which refers to the test 3b the wave overtops the structure without impact frame d although a secondary plunging jet is seen sometimes to form during the down rush phase caused by the abrupt change in the wall profile as shown in frames a and b this gives rise to a small impact between the vertical section and the sloping top the resulting loading case is basically quasi static or pulsating fig 18 with the takahashi et al method predicting wave pressures at the peak of force rather well this is shown in the upper part of fig 18 a wave pressures are now overpredicted by 30 on average whereas the maximum pressure is overestimated by 40 the small impact described above is actually seen to produce only a fast oscillation of the pressure signals at the transducers s13 and s14 lower part of fig 18 table 5 reports for each test the loading case observed and the value of the maximum nondimensional pressure at the peak of force it can be noticed that the impact events either due to a direct plunging or secondary jet generate pressures not exceeding 2 5 times h m0 no clear effect of the air entrainment has been detected this outcome is in a fairly agreement with the results of small scale regular wave physical model tests conducted by buccino et al 2015 on a monolithic sloping structure resting on a steep foreshore the authors measured pressures generated by plunging breakers and found a modal value of 2 times the incident wave height as mentioned before this is likely the effect of the inclined outer face which forces the incoming wave to rotate before reaching the wall this impedes a big water mass to be involved in the impact event 5 1 2 prediction of loading case and maximum pressure within the proverbs project two design tools were developed which allow the prediction of the most probable loading case at simple vertical or vertically composite breakwaters one is a parameter decision map parm which uses a few nondimensional variables related to structure geometry water depth and wave conditions in the nearfield oumeraci et al 1999 the other is a breaking criterion based on two threshold values of the wave steepness h m0 l p calabrese and buccino 2001 although the loading cases previously described are some different from those observed on conventional vertical structures a comparison appears of interest under the hypothesis that the tested sloping top caisson could be assimilated to a simple vertical breakwater it has been found out the calabrese and buccino method to give predictions some more consistent with the observation than parm table 6 this because for simple vertical walls the latter uses only the wave height to depth ratio as predictive variable so neglecting the effect of period as shown in fig 19 impact events have been observed for h m0 l p included between 0 048 and the limit value at incipient breaking suggested by kamphuis 1991 20 h m 0 l p 0 095 t a n h 2 π d l p the test 4a where the waves break rather far from the structure producing no secondary impact falls above the curve of eq 20 conversely for steepness lower than 0 048 only pulsating loads have been observed it is also worth to notice that for data not exceeding the kamphuis limit the maximum pressure at the peak of force is well predictable as a linear function of the quantity fig 20 21 r p r c h m 0 h m 0 g t p 2 which has been originally introduced by owen 1980 as a wave overtopping predictor in practice data suggest that wave pressure is the more intense the higher wave steepness since wave breaking tends to occur however for a given steepness though pressure reduces for low crest freeboards that is with increasing the overtopping rate 5 2 horizontal component of wave force comparison with literature as mentioned above in most of literature studies the only effect of wave overtopping is assumed to be a truncation of the wave pressure distribution at the outer face of the structure accordingly despite testing overtopped breakwaters also in takahashi et al 1994 no pressure measurements were taken on the rear wall in view of this it has seemed consistent to perform the comparison between predictive models and numerical experiments ignoring at first the pressures exerted on the inner face subsection 5 2 1 and 5 2 2 successively in subsection 5 2 3 the effects of wave overtopping are examined in a more detail 5 2 1 peak of horizontal force under uprush phase fig 21 compares the maximum landward directed horizontal force measured for each test to the takahashi et al predictions the latter are obtained using the maximum wave height and the respective period hmax and tmax as wave parameters most of points exceed the line of perfect agreement with an average underestimation rate of 79 additionally 6 points are underpredicted by a factor larger than 1 4 which is used in the italian design practice as a safety factor against sliding however these force peaks are mostly generated by breaking waves e g figs 14 and 16 and in virtue of their short duration and low impulse they are not likely to affect the stability of the structure but rather durability of concrete peregrine 2003 goda 1986 with this in mind the comparison above has been repeated after smoothing the force signals via a second order savitzky and golay 1964 filter with a 0 8s time window e g fig 22 as shown in fig 23 the filtered force peaks compare now quite well with the takahashi et al predictions the average underprediction rate is now 16 and only two point slightly exceeds the sf 1 4 line however 8 data out 11 are still underestimated moreover a trend with relative water depth has been detected with the amount of underprediction increasing in deep waters fig 24 previous results do not depend on the inclusion of air in the simulation 5 2 2 horizontal force peak under trough phase the maximum seaward directed horizontal force has been found to exceed the shoreward maximum after smoothing the breaking peaks by a factor ranging between 1 1 and 2 1 1 37 on average fig 25 since no particular suggestions come from the takahashi et al work numerical results have been compared to the methods proposed by goda 1986 and sainflou 1928 for traditional vertical face breakwaters in both cases hmax and tmax have been employed as wave parameters figs 26 and 27 show significant underpredictions for the longer waves although the sainflou equation seems to perform slightly better than the goda model the average underprediction rate for long waves is around 52 for the goda method whereas it lowers to 31 for sainflou these results are qualitatively consistent with the findings of mcconell et al 1999 based on physical model tests on conventional non overtopped vertical breakwaters although larger underpredictions have been here detected red broken line fig 27 5 2 3 effect of wave overtopping along with clipping wave pressure distribution at the outer face wave overtopping also induces loadings onto the inner wall this produces either a variation of quasi static maxima of wave force basically due to the phase lag between incident and transmitted waves or as shown by walkden et al 2001 the occurrence of intense impulsive loadings both these features have been surprisingly little researched so far in the following only quasi static effects are discussed whereas impact loadings are analyzed in buccino et al 2019 for the analyses discussed below wave force chronograms have been first re computed including rear pressures then they have been smoothed using the savitzky and golay filter as employed in section 5 2 1 to retain only the pulsating part it has been found out that wave overtopping amplifies both the seaward and the landward horizontal force peaks as shown in fig 28 when the maximum landward force is attained upper panel negative pressures take place at the inner wall and vice versa however fig 29 suggests the amplification factor to be negligible for trough loads 1 05 on average panel b whereas for the landward directed force it reaches 1 16 with including the overtopping loadings the ratio between the maximum force under trough and the maximum force under crest lowers from 1 37 on average fig 19 to nearly 1 20 however all data under wave crest are underpredicted by the takahashi et al formula the mean underprediction rate is now 22 compared to the 16 detected in fig 23 5 3 approximate sliding force as the wave force under trough generally exceeds the wave force under crest and since the presence of dynamic pressures at the inner wall fig 28 invariably alters the regime of uplifts it is rather difficult to predict which wave phase whether crest or trough may be the most critical for structure stability to have a deeper insight of this issue the sliding force s l should be more appropriately considered the latter represents the total shear the structure has to withstand by its weight to prevent sliding on the bottom neglecting the wave loadings exerted on the caisson roof s l can be defined as follows fig 30 22 s l f h μ f u p l i f t f s v in which f h is the horizontal force including the overtopping effects f u p l i f t is the uplift force acting at the bottom f s v is the vertical component of the wave force at the sloping top μ is the structure bottom friction factor in the present study due to the lack of measurements for uplifts only an approximate sliding chronogram can be calculated in which the distribution of pressure beneath the structure is assumed trapezoidal in all instants fig 30 in practice that means to set 23 f u p l i f t 0 5 p s 20 p s 20 b where p s20 and p s10 are the pressure signals at the transducers 20 and 10 respectively fig 10 and b indicates the caisson width a sample of sliding signal after smoothing is shown in fig 31 whereas fig 32 compares for each test the maximum positive landward directed and the maximum negative shoreward directed peaks the graph indicates that for the larger periods the structure would tend to slide seaward being the negative peak up to twice the positive one in practice under wave crest the presence of negative dynamic pressures on the rear wall see upper panel of fig 28 increases f h but reduces uplifts on the other hand under a wave trough both the previous components f h and f u p l i f t are enhanced so that the seaward sliding peak is amplified by wave overtopping furthermore it is worth noticing that since the sloping top extends below the swl it tends to favor the sliding under trough as the vertical component of the negative wave pressures is upward directed lower panel of fig 28 fig 33 shows the comparison with literature models analogously to what observed for f h the takahashi et al method predicts up to a certain extent the measurements although some underpredictions for the shorter waves has been detected average underprediction rate 42 on contrary under a wave trough the sainflou formula exhibit larger underestimations 60 on average which may render design process rather uncertain 5 4 the use of the linear thrust parameter none of the literature methods have been found to be plenty satisfactory in predicting present data this is especially true for trough conditions which on the other hand have been shown to be crucial for the structure stability hence an alternative approach is here tested namely that introduced by buccino et al 2015 in the frame of the experimental study mentioned in subsection 3 2 in analyzing the behavior of ssgs subject to severe overtopping the authors proposed the following linear formula to calculate the horizontal component of the quasi static wave force under crest phase 24 f k ρ g l t p d h c where beyond the quantities already introduced hc represents the structure height in eq 24 ltp is the linear thrust parameter i e the ratio between the linearized maximum momentum flux due to the incoming waves and the hydrostatic force corresponding to the still water level d basically buccino et al 2015 considered the ratio between the maximum value over a wave period of the cross shore component of the incident wave momentum flux at the toe of the structure and the corresponding hydrostatic still water thrust 25 l t p m a x t t d η p ρ g z ρ u 2 d z 0 5 ρ g d 2 in eq 25 η is the free surface z is the vertical coordinate positive upwards u is the cross shore wave velocity ρ is the water density and g is the gravity acceleration by using the linear wave theory and retaining only the first order terms one gets 26 l t p h d tanh k d k d which is a fully linearized and slightly modified form of the momentum flux parameter originally introduced by hughes 2004 see also buccino et al 2018 note that ltp coincides with the wave height to depth ratio h d in shallow water altogether eq 24 establishes a simple proportionality between wave force and maximum wave momentum flux via the empirical coefficient k which buccino et al 2015 reasoned to be of the order of 1 the retaining of the first order terms only is legitimized by the low crest of the structure for the case of ssg a value of k 0 77 has been estimated based on regular wave physical model tests despite a very good r 2 statistics was found 0 95 the authors warned that some small non linear effects could exist in this paper eq 24 has been used to predict both the landward and the seaward horizontal force maxima where the overtopping effects are included according to the previous sections h max and t max have been employed as wave parameters as shown in fig 33 the method performs rather well for the landward peak for which the same k as in buccino et al 2015 has been found and a very good r 2 statistics 0 92 on the other hand the prediction power drops a little under trough conditions although the r 2 still remains relatively high see fig 34 finally an attempt has been conducted to use the ltp method for the prediction of the approximate sliding force maxima to this purpose a simplified distribution of pressures has been hypothesized which is uniform on the front face and triangular at the bottom accordingly the magnitude of the front pressure p front and the maximum uplift p u max is assumed to be 27 p f r o n t p u m a x k ρ g l t p d where the values of k are those obtained from fig 29 in spite of the simplification introduced the proposed approach still allows good predictions of the experimental data fig 35 again the estimates under crest are rather efficient although some non linear effects are visible the model is less accurate but still reasonable under trough where the hypothesis of uniform distribution of the front pressures becomes quite questionable table 7 reports some reliability indexes 6 summary and conclusions a set of 11 full scale random wave cfd experiments have been conducted to deepen the knowledge on the loading process at sloping top caissons subject to significant wave overtopping the commercially available software flow 3d has been used which numerically solves the reynolds averaged navier stokes equations using the finite difference method with a stationary cartesian grid as for the turbulence closure the renormalized group rng extension of the k ε model has been selected which is particularly suited to describe the wave evolution in the neighborhoods of the breaking point the structure employed had a relative crest freeboard r c hm0 ranging from 0 4 to 0 8 whereas the relative water depth d lp was included between 0 12 and 0 31 despite the limitedness of data a number of interesting items have been discussed with respect to loading case occurring at the structure global stability conditions predictability of wave actions as far as the loading cases are concerned although testing very steep waves giving rise to impact conditions the maximum pressure at the instant of the maximum force has been observed not to exceed 2 5 times the incident significant wave height i e far less than what measured on conventional vertical face breakwaters this finding is consistent with the results of physical model tests conducted by buccino et al 2015 and is essentially caused by the presence of the sloping top which constraints the breaking front to a big rotation before hitting the wall additionally the discontinuity of the wall profile produces a phase lag between the pressure signals which leads the instant of maximum force not to coincide with the instant of maximum impulsive pressure regarding the global stability it has been found out that since wave overtopping leads to a significant reduction of loadings under wave crest trough conditions become crucial to the structural response this is especially true for long waves with relative water depth included between 0 1 and 0 2 this is consistent with the case history published in 1994 by oumaraci who reported the cases of 5 real vertical breakwaters out 14 examined which failed seaward after experiencing severe overtopping in the four cases where wave data were available valencia catania algiers niigata the relative crest freeboard was included between 0 64 and 1 07 whereas the relative water depth ranged between 0 08 and 0 17 indicating long waves similar to those employed in this study in this respect it is worth to emphasize that differently from what argued by walkden et al present data suggests that seaward failure of overtopped breakwaters is not necessarily related to the occurrence of impact forces onto the rear face the sliding signals here analyzed have been here previously smoothed rather significant overtopping reduces the landward force peaks compared to non overtopped structure making the seaward peaks comparatively larger and crucial to the stability it has been then observed that wave actions under crest are reasonably predicted by the takahashi et al method although a certain trend at underestimating data has been detected especially for short periods this would confirm the previous findings of vicinanza and frigaard 2009 however large underpredictions have been found for the trough phase where no specific method exists but those valid for conventional vertical phase breakwaters in view of this result an alternative predictive approach has been tested which assumes a simple proportionality law between wave force and peak of linear wave momentum flux the method proved to be rather efficient under wave crest and this appears very interesting in virtue of the simplicity of calculations under wave trough the momentum flux approach still remains an useful prediction tool producing a remarkable improvement compared to the existing methods such as the sainflou formula neverthless the quality of estimates lowers a little this occurs mainly because some of the assumptions the method relies on are no longer verified this includes the uniform distribution of pressures along the entire outer face of the structure and the neglecting of the hydrostatic thrust above the trough which is of order of h2 on the whole this research has suggested that significant gaps still exist about the global features of loadings exerted by waves on non conventional monolithic breakwaters and that a supplementary research effort is needed to reduce the degree of uncertainty that affects the design process acknowledgment the authors wish to acknowlege eng fabio maresca for his precious assistance in data analysis 
22803,random wave cfd experiments have been carried out to study the loading process on a sloping top caisson breakwater subject to significant overtopping numerical results suggest that since wave force under crest is reduced by the overpassing wave pressures under trough become comparatively larger leading the structure to fail seaward even in absence of violent impact events this finding is consistent with what observed by oumeraci 1994 in reviewing the failures of a number of vertical face breakwaters during the first half of 20th century present findings also show that wave pressures under trough may be significantly underestimated by the design formulae currently available to face this issue a set of simple alternative equations are proposed based on the maximum momentum flux concept originally introduced by hughes 2004 a second part of the research work is dedicated to the occurrence of intense impulsive loadings at rear of the breakwater caused by the huge inertia of the overtopping jet the analysis of this interesting phenomenon is though presented in a separate paper keywords numerical modeling computational fluid dynamics sloping top breakwater wave force wave impact 1 introduction monolithic breakwaters have been employed for the protection of harbor areas since times before the ancient roman empire the most common type generally referred to as vertical face breakwater or vertically composite breakwater consists of an upright wall rested on a foundation mound as well documented by oumeraci 1994 in first half of the 20th century such kind of structures suffered from catastrophic failures which led to their almost complete abandoning many of those breakdowns were caused by tremendous wave forces associated with wave breaking and featured by an impulsive nature however nearly 50 years later the need for structures at large water depths with a relatively low cost reignited the interest about vertical face breakwaters giving rise to an intense research work the latter culminated in the eu funded project proverbs probabilistic design tools for vertical breakwaters which gathered together the most important european research groups oumeraci et al 1999 in those years the effort of scientists was addressed at either improving the knowledge about the wave structure interaction or suggesting solutions to reduce the intensity of hydrodynamic loadings exerted on the walls many milestone papers were dedicated at describing the mechanics of wave breaking and the related impulsive loadings cooker and peregrine 1990 kirkgoz 1991 hattori and arami 1992 oumeraci et al 1993 the authors recognized that under heavy plunging breakers air tends to be trapped between wave and structure so cushioning the impact of most of water mass peregrine 2003 however the maximum pressure was observed prior the air trapping and was caused by the direct collision between the plunging water jet and the wall hammer shock see also lundgren 1969 following an interesting alternative approach some research focused instead on the loading case predictability that consists in individuating the hydraulic conditions under which impulsive or quasi static forces tend to take place oumeraci et al 1999 calabrese and buccino 2001 calabrese et al 2000 as for the strategies to reduce the intensity of wave actions the solutions proposed in literature basically include lowering of the breakwater crest so to allow a significant wave overtopping under the design storm and changing of the outer profile from perfectly vertical to inclined or curvilinear yet significant uncertainties still remain on the effectiveness of those suggestions essentially due to the stalling of the research work in the new millennium thus despite commonly accepted by engineers the beneficial role of wave overtopping is not completely demonstrated goda 1995 reasoned that historically the low crest of japanese vertical face breakwaters traditionally 0 6 times the design wave height prevented structures from being damaged by violent impact loadings conversely the aforementioned case histories presented by oumeraci 1994 reported a number of examples in which the walls failed just after experiencing severe overtopping it should be noticed then that failures occurred often seaward in actuality at current state of knowledge the prediction of the design wave loadings at low crested monolithic breakwaters is affected by two sources of uncertainty and namely 1 since wave overtopping reduces the horizontal force under wave crest loadings under wave trough become comparatively more important however the reliability of the existing design methods for such a wave phase has been little investigated for conventional non overtopped vertical face breakwaters a laboratory study by mcconnell et al 1999 showed that significant underpredictions could occur but this result has been not analyzed further 2 engineers are used to accounting for wave overtopping effects by simply truncating the wave pressure distributions valid for non overtopped breakwaters this means loadings generated by the overtopping process onto the inner face of the structure are considered negligible but this assumption is far from being scientifically ascertained regarding the previous point 2 walkden et al 2001 warned that massive overtopping may cause intense impulsive loadings at rear of the structure due to the huge inertia of the overtopping jet the authors referred to this phenomenon as plume impact and hypothesized it to be significantly affected by the air trapped between the jet and the wall since a non negligible amount of momentum might be transferred from the air cushion to the water column unfortunately the research of walkden et al 2001 was based on small scale physical model tests conducted on three individual waves only and accordingly the features of the plume impact could not be appropriately investigated information on wave loadings at inclined or curvilinear walls generally come from regular wave laboratory studies the main results of those works consist in prediction formulae e g tanimoto and kimura 1985 takahashi et al 1994 which slightly modify the traditional design tools valid for vertical structures these new predictive equations need to be further verified especially under random wave conditions additionally more details on other aspects of the wave structure interaction such as shape of wave profiles at walls loading case prediction etc would be desirable similarly to what accomplished for vertical face breakwaters this study aims to give a contribution at filling the research gaps previously highlighted analyzing the loadings exerted by random waves on a sloping top caisson breakwater subject to significant overtopping sloping top caisson breakwaters the first built in napoli italy in 1906 possess a sloping roof that convert part of the wave action into a downward directed force that aids the stability under crest such kind of structure was used by walkden et al 2001 when investigating the plume impact while takahashi et al 1994 developed a design formula to predict wave pressures under crest which modifies the well known equation of goda 1986 for vertical face breakwaters the analysis has been carried out via numerical experiments conducted in a computational fluid dynamics cfd wave flume based on the commercial code flow 3d flow science inc 2009 the cfd technique which solves numerically the navier stokes equations is recently growing popular in the field of coastal and ocean engineering e g jun and meng 2011 kamath 2015 antonini et al 2016 2017 miquel et al 2018 and has proved rather efficient in describing the loading process at monolithic coastal structures even under breaking waves vicinanza et al 2015 buccino et al 2016 in case of relatively little researched topics like are partly those treated here the use of cfd allows providing very detailed information on the phenomena under study since a great deal of probes can be employed at once this feature is of course essential for the comprehension of physical processes and planning of future research works finally a breakwater at full scale can be simulated so reducing scale effects cuomo et al 2010 and the experiments can be repeated with and without the presence of air see gaeta and lamberti 2015 the present research is divided into two parts after discussing and validating the numerical model sections 2 and 3 this article deals with wave shapes at the outer face of the a sloping top breakwater loading case predictability and reliability of the available design tools in predicting wave force under both the crest and the trough phases the second part of the research buccino et al 2019 is instead expressly dedicated to the analysis of plume impact 2 governing equations and turbulence closure it is assumed the physical processes here investigated to be governed by the reynolds averaged navier stokes equations rans for incompressible fluids in a 2d reference where the x axis is perpendicular to the coast onshore directed and the z axis is vertical upward directed the continuity equation reads 1 u x w z 0 where u and w are the turbulence averaged velocity components along x and z respectively the momentum equations are 2 u t u u x w u z 1 ρ p x 2 x ν ν t u x z ν ν t u z w x 0 3 w t u w x w w z 1 ρ p z g x ν ν t u z w x 2 z ν ν t w z 0 where ρ is the fluid density g is gravity p is the turbulence averaged pressure and ν is the kinematic viscosity the eddy viscosity νt is expressed as 4 ν t c μ f μ k 2 ε where k is the turbulent kinetic energy ε is the dissipation rate of k c μ is an empirical constant and f μ is a damping factor the latter reduces exponentially with the turbulence reynolds number r t k 2 νε to determine k and ε two additional transport equations must be solved 5 k t u k x w k z x ν ν t σ k k x z ν ν t σ k k z ε p 0 6 ε t u ε x w ε z x ν ν t σ ε ε x z ν ν t σ ε ε z c 2 ε 2 k c 1 ε k ν t p 0 where the shear production p is defined as 7 p ν ν t ρ 2 u x 2 u z w x 2 2 w z 2 eqs 5 7 represent the widely known standard k ε turbulence model where σ k σ ε c 1 and c 2 are additional constants launder and spalding 1974 however in this study a renormalized group rng extension of the above model has been used rng here the parameters c μ c 1 σ k and σ ε still remain constant c μ 0 085 c 1 1 42 σ k σ ε 1 39 whereas c 2 is assumed to vary with p according to the formula yakhot et al 1992 8 c 2 1 68 c μ β 3 1 0 2283 β 1 0 012 β 3 in which 9 β k ε p ν ν t by allowing c 2 to vary with the fluid strain rate a presumably more general model is obtained that should yield more accurate results for strongly sheared flows bradford 2000 in this respect it is interesting to remark that comparing numerical cfd simulations to the experiments of ting and kirby 1994 bradford 2000 found out the rng closure to be more effective than standard k ε model in simulating the evolution of plunging breakers both prior and just after the onset of breaking this result is particularly useful for the present research where waves have been observed to break in wise of plunging breakers at a short distance from the structure fluid configurations are defined in terms of a volume of fluid vof function f x y z t hirt and nichols 1981 which represents the volume of fluid that occupies a portion of space of unitary volume f satisfies the following transport equation 10 f t u f x w f z 0 for a single incompressible fluid with a free surface fluid exists where f 1 while locations where f 0 correspond to void regions in which a uniform pressure is applied in case of two incompressible fluids with no free surface f represents the volume fraction of the fluid 1 whereas the complementary region with volume fraction 1 f represents fluid 2 3 numerical solution the equations above described have been finite difference solved via the commercially available multi physics cfd software flow 3d developed by flow science inc 2009 flow 3d has been recently employed with satisfactory results in a number of wave structure interaction problems including both impermeable walls and permeable breakwaters e g buccino et al 2016 vicinanza et al 2015 dentale et al 2014a 2014b the flow region is subdivided into a mesh of fixed rectangular cells at center of which are located all the variables but velocities which are situated instead at the cell faces staggered grid arrangement curved obstacles wall boundaries or other geometric features are embedded in the mesh by defining the fractional areas of the cells that are open to flow favor method hirt and sicilian 1985 the governing equations are discretized as follows 11 u i 1 j n 1 u i j n 1 δ x w i j 0 5 n 1 w i j n 1 δ z 0 12 u i j n 1 u i j n δ t n 1 a ux a uy a uz i j n vi s x i j n 2 ρ i j n ρ i 1 j n p i 1 j n 1 p i j n 1 δ x 13 w i j n 1 w i j n δ t n 1 a wx a wy a wz i j n vi s z i j n 2 ρ i j n ρ i j 1 n p i 1 j n 1 p i j n 1 δ z where the subscripts indicate the cell coordinates and the superscripts indicate time step δx and δz represent the cell length and height respectively while δt is the time step size see subsection 3 1 in the momentum equations both the advective fluxes a αβ and the viscous terms vi s x z are calculated explicitly using the old time level n according to the first order donor cell approximation method as far as the fluid density ρ is concerned a single value is used in case of one incompressible fluid flow whereas a weighted average over the vof function f is employed for two incompressible fluids since in eq 11 13 pressures and velocities are coupled implicitly an iteration solution procedure is needed to this purpose the momentum balance is firstly solved using the pressure gradient at the time level n this gives an intermediate velocity vector u which is linked to the real velocity at the time step n 1 u n 1 by the following relationship 14 u n 1 u 2 δ t n 1 ρ i j n ρ i 1 j n p where p p n 1 p n by inserting eq 14 into eq 11 a poisson equation in p is obtained which is solved through the generalized minimum residual method gmres saad 1996 after obtaining u n 1 the new free surface configuration is computed with the vof method while k and ε are computed using analogous discretizations of 5 and 6 3 1 stability considerations flow 3d uses variable time stepping to maintain the stability and accuracy of the solution in particular the n th time step size δtn is automatically adjusted to 15 δ t n min δ t con n δ t s where δ t s is a user defined sampling rate which depends on the frequency spectrum of the phenomenon under study and δ t con n is a convergence time step size that is needed to avoid numerical instabilities since the advective fluxes have been computed using a simple first order donor cell δ t con n is required to meet the following criterion 16 δ t con n min 0 5 δ t cfl 0 5 δ δ x δ z δ az where δ t cfl is the time step to satisfy the courant friedrichs lewy cfl stability criterion and the second quantity at the right hand side of eq 16 ensures surface waves cannot propagate more than one cell in one time step az indicates vertical acceleration 3 2 validation study to validate the numerical model above described with respect to the interaction between waves and sloping walls with a particular focus on the loading process and wave shape at the structure a comparison with the 2d physical model tests carried out by buccino et al 2015 is here presented the lab experiments were conducted on a small scale model of seawave slotcone generator ssg a wave energy converter based on the overtopping principle vicinanza et al 2012 the ssg has been placed on the top of a steep multi linear slope seaward of which the water depth d has been kept constant fig 1 a regular waves with different height and period have been generated and the hydrodynamic pressures have been acquired via four resistive transducers fig 1b sampled at 1 khz the numerical flume fig 2 has been set up at full scale and reproduces un distortedly both the ssg and the foreshore according to the sensitivity analysis described in buccino et al 2016 the computational domain 400 m in the x direction and 60 m in the z direction has been divided into three zones the meshes 1 and 3 include 62 400 and 14 400 cells respectively the size of which is 50 50 cm the local mesh that surrounds the wec mesh 2 consists instead of 38400 cells 0 25 0 25 m for the aims of the present work two experiments have been selected whose wave parameters calculated at the flat part of the flumes are reported in table 1 note that numerical experiments have been carried out with a single incompressible fluid given the urserll number hl 2 d 3 do not exceed 2 0 numerical regular waves have been generated using the linear wave generator available in flow 3d lateral and upper limits of the numerical flume have been treated as symmetry boundaries s where the velocity gradient vanishes and the turbulence production is zero also a zero flow area has been here imposed that automatically ensures no advective or diffusive fluxes at the bottom a wall condition w has been set implying no slip as well as zero velocity gradient since flow 3d includes no active absorption system only the part of the numerical loading signals that is unaffected by re reflection at the wave generator has been considered for the analysis see subsection 4 6 from table 1 it is seen lab and numerical wave heights to differ by 10 at most whereas wave periods deviate from each other by few percents only for test v a a simple quasi standing wave with no overtopping was observed fig 3 as shown in fig 4 the numerical model satisfactorily reproduces duration and shape of loadings besides their magnitude in particular panels b and c suggest the non linearity of pressure time series is well captured whereas panel d ensures no overtopping has taken place since the pressure signals have a zero amplitude fig 5 compares the wave profiles at the wall during test v b which corresponds to a heavy plunging breaker the numerical model properly reproduces the hammer shock which occurs approximately at the ssg toe first panel from the top the secondary splash up buccino et al 2015 where the water mass hits again the structure onto the higher plate second panel the overtopping phase third and fourth panel the impacts generated by the hammer shock and secondary splash up produce impulsive pressure events at the transducers 1 and 3 which are realistically simulated in the numerical flume as shown in fig 6 4 study of a sloping top breakwater to investigate the structural response of sloping top breakwaters the full scale numerical wave flume pictured in fig 7 has been employed the structure is located 300 m far from the wavemaker wv at the rear of the wall the channel continues by 200 m up to an outflow boundary o which let the waves to flow out without any reflections lateral walls flume upper and limit bottom have been subjected to the same boundary conditions as those described in section 3 2 4 1 structure details the structure tested fig 8 has a total height of 21 42 m and the sloping part is inclined to the horizontal by θ 30 the height of the sloping top s is 5 39 m whilst the upright section v measures 16 03 m the sea floor is constant with a still water depth d 18 9 m altogether the structure is rather similar to that used by walkden et al 2001 who tested a caisson with the same s to v ratio 0 34 and θ 35 on the other hand takahashi et al 1994 employed steeper tops θ 45 and 56 and s v ranging from 0 26 to 0 92 a leading feature of the breakwater here considered is that the lower tip of the sloping face is located 2 87 m underwater whereas in walkden et al 2001 it was just at the mean water level as shown later in the paper this characteristic which might be generated by a rise of the mean sea level under the design storm could of course affect the statics of the structure this because while enhancing the stability under wave crest an upward directed component of the wave force tends to take place at the sloping top under the trough phase it is also noteworthy that four structures out the six considered in the takahashi et al 1994 study had a partially submerged sloping profile 4 2 grid selection in order to select the most appropriate grid dimensions a sensitivity study has been conducted three rectangular grids with different cell size have been tested and namely 0 5 m horizontal x 1 m vertical 0 25 m 0 5 m 0 125 m 0 25 m for each mesh the structure has been subjected to a train of 30 regular waves and the signal of the horizontal force exerted onto the front face has been acquired wave generation has been carried out via the cnoidal wave generation tool available in flow 3d the generated waves h 4 4 m and t 8s have been preliminarily checked to reach the structure without breaking in order the sensitivity analysis were not affected by the inherent randomness of loadings induced by breaking waves buccino et al 2015 peregrine 2003 it is also worth noticing that for each grid flow 3d uses variable time stepping to maintain the stability and accuracy of solution see subsection 3 1 as shown in fig 9 the widest grid tends to create deep troughs that are not observed with the finer ones on the other hand the results for 0 25 m 0 5 m and 0 125 m 0 25 m are very similar to each other to measure the degree of convergence two indicators have been introduced and namely a the relative error from the wider to the finer grid defined as 17 r s s t d e v f w i d e f f i n e max f f i n e where f represents the force signal and the subscripts wide and fine refer to the wider and the finer grid used the symbol stdev indicates standard deviation b the square correlation between the force signals 18 r 2 ε f w i d e f f i n e s t d e v f w i d e s t d e v f w i d e 2 in which e indicates statistical expectation results of the analysis are summarized in table 2 which confirms the substantial coherence between the grids 0 5 m 0 25 m and 0 25 m 0 125 m r2 exceeds 99 accordingly the former has been selected for the final experiments 4 3 waves and hydraulic variables eleven sea states have been generated lasting approximately 30 waves each sea state was driven by a very narrow banded spectrum accordingly the incoming waves had almost the same period whereas their height could vary narrow banded wave series have been first generated numerically through a specific code written in labview then the power spectrum has been calculated and used as input for wave generation in flow 3d table 3 reports the main wave statistics whilst table 4 shows some relevant non dimensional variables as well as sampling rate δts note that the ursell number at the fifth column is calculated as 19 u r h m 0 l p 2 d 3 in which h m 0 is the spectral significant wave height and l p is the local wavelength obtained by the linear dispersion relationship using the peak period t p the range of wave steepness h l 0 024 0 093 is almost identical to that tested by takahashi et al 0 023 0 109 and same goes for relative water depth d l 0 124 0 315 vs 0 09 0 23 as far as relative crest freeboard is concerned the present study focuses on structures subject to significant overtopping rc h 0 356 0 829 whereas takahashi et al extended their analysis to non overtopped breakwaters too rc h 0 321 3 81 it is also worth to mention that the three individual waves tested by walkden et al 2001 had a 0 17 m height and a 1s period corresponding to a wave steepness of 0 11 and a relative crest freeboard 0 558 it is finally noteworthy that waves travelled by 2 5 wavelenghts before reaching the structure while this distance ensures them to be properly developed on the flat bottom it substantially dampens the effects of undesired phenomena of turbulence over production as recently shown by larsen and fuhrman 2018 in fact the authors concluded that the short propagation distance allotted prior the onset of breaking limits the turbulence overproduction problem even in the post breaking phase 4 4 fluid properties the experiments from 1a to n2 have been conducted with a single fluid water i e neglecting any effect of air on contrary in the tests 3a 3b and 4a the presence of air has been accounted for using the two fluid model option of flow 3d accordingly the properties of water and air density viscosity have been assigned separately and the governing equations have been solved for all fluid cells regardless of fluid fraction in the simulations the fluids have been assumed immiscible and incompressible 4 5 measurements fluctuations of the free surface were acquired in six positions in front of the structure while a single probe was used to measure wave transmission not dealt with here fig 10 along with the horizontal component of the wave force time series of pressure have been surveyed in 10 positions in front and 10 positions behind the breakwater the chronogram of the overtopping discharge has been also obtained fig 11 and the wave structure interaction was visually inspected by videos incident and reflected waves were separated via the zelt and skjelbreia 1992 method which is based on a weighted least square procedure in the frequency domain force and pressure signals have been analyzed separately in front and at the rear of the wall to capture the effect of wave overtopping the rise time of loading events has been calculated as the time interval between the instants corresponding to the 2 5 and 97 5 of the peak magnitude finally the impulse has been obtained from integration in time 4 6 wave absorption unfortunately flow 3d does not allow active wave absorption however in this study the presence of a significant overtopping rate limits the effect of undesired re reflections at the wavemaker to analyze this point the horizontal force signal has been divided into two time segments the first δt1 corresponds to the time interval for the first wave reaching the structure to travel back to the wavemaker at the linear phase speed and reach the breakwater again the second segment δt2 lasts from the end of δt1 to the end of the test fig 12 compares the standard deviation of the horizontal force signal for δt1 and δt2 respectively the graph shows a difference of 4 63 on average indicating the effect of re reflections is practically negligible 5 results 5 1 wave shapes and loading features at the front face 5 1 1 analysis of wave patterns as argued in the proverbs project nature and magnitude of wave loadings at the outer face of monolithic marine structures may significantly vary depending on the shape of the wave profile in this study three different wave patterns have been recognized and namely c broken waves d plunging breakers e quasi standing waves broken waves were observed in sea states with high steepness an example of wave evolution is shown in fig 13 which refers to the test 1a in the picture the incoming wave is seen to plunge into the water in the neighborhood of the sloping top frame b then the wave reforms and a secondary plunging jet detaches from the new crest hitting the wall frames c and d finally the breakwater is overtopped frame f the resulting force chronogram displayed in fig 14 is characterized by a nearly 3 hz oscillation which likely corresponds to the natural frequency of the flume excited by the curling down of the wave into the water low left tip of the figure the impact of the secondary plunging jet onto the wall produces a sharp peak with a distribution of pressures at the instant of maximum force that is typical of the impact events e g peregrine 2003 the measured pressures are significantly larger compared to the predictions of the takahashi et al 1994 method reported in green in fig 14 and in fig 14 a the maximum pressure is underestimated by 80 whereas an average underprediction of 40 is observed along the wall in the case just described the beneficial effect of the sloping top is seen to be twofold besides transforming part of the wave slam into vertical force so reducing the horizontal thrust the phase lag between the wave pressures along the wall leads the maximum horizontal force to be delayed compared to the impulsive peak this is clear in fig 14a where it is seen that the peak pressure onto the slope is about 11 m but when the maximum force is attained it is reduced to 8 m i e 30 less impact events generated by plunging breakers have been recorded in tests dominated by broken waves as a particular case in which the curling wave hits the structure instead of plunging into the water an example is given in fig 15 which also refers to the test 1a the slam of the water tongue leads to impulsive loadings around the transducer s14 i e at the junction between the sloping and the upright section see fig 16 and a the takahashi et al predictions are again largely exceeded the maximum pressure is underestimated by 90 with an average underprediction of 50 along the wall however the maximum measured pressure is of the order of two times the incident significant wave height which is far lower than what observed on conventional vertical breakwaters where relative pressures larger than 10 have been reported goda 1995 allsop et al 1996 this occurs because the sloping top constrains the wave front to experience a significant rotation before reaching the structure curling down whereas on vertical breakwaters the impact takes place almost frontally oumeraci et al 1993 calabrese and buccino 2001 with longer periods quasi standing waves occur an example is given in fig 17 which refers to the test 3b the wave overtops the structure without impact frame d although a secondary plunging jet is seen sometimes to form during the down rush phase caused by the abrupt change in the wall profile as shown in frames a and b this gives rise to a small impact between the vertical section and the sloping top the resulting loading case is basically quasi static or pulsating fig 18 with the takahashi et al method predicting wave pressures at the peak of force rather well this is shown in the upper part of fig 18 a wave pressures are now overpredicted by 30 on average whereas the maximum pressure is overestimated by 40 the small impact described above is actually seen to produce only a fast oscillation of the pressure signals at the transducers s13 and s14 lower part of fig 18 table 5 reports for each test the loading case observed and the value of the maximum nondimensional pressure at the peak of force it can be noticed that the impact events either due to a direct plunging or secondary jet generate pressures not exceeding 2 5 times h m0 no clear effect of the air entrainment has been detected this outcome is in a fairly agreement with the results of small scale regular wave physical model tests conducted by buccino et al 2015 on a monolithic sloping structure resting on a steep foreshore the authors measured pressures generated by plunging breakers and found a modal value of 2 times the incident wave height as mentioned before this is likely the effect of the inclined outer face which forces the incoming wave to rotate before reaching the wall this impedes a big water mass to be involved in the impact event 5 1 2 prediction of loading case and maximum pressure within the proverbs project two design tools were developed which allow the prediction of the most probable loading case at simple vertical or vertically composite breakwaters one is a parameter decision map parm which uses a few nondimensional variables related to structure geometry water depth and wave conditions in the nearfield oumeraci et al 1999 the other is a breaking criterion based on two threshold values of the wave steepness h m0 l p calabrese and buccino 2001 although the loading cases previously described are some different from those observed on conventional vertical structures a comparison appears of interest under the hypothesis that the tested sloping top caisson could be assimilated to a simple vertical breakwater it has been found out the calabrese and buccino method to give predictions some more consistent with the observation than parm table 6 this because for simple vertical walls the latter uses only the wave height to depth ratio as predictive variable so neglecting the effect of period as shown in fig 19 impact events have been observed for h m0 l p included between 0 048 and the limit value at incipient breaking suggested by kamphuis 1991 20 h m 0 l p 0 095 t a n h 2 π d l p the test 4a where the waves break rather far from the structure producing no secondary impact falls above the curve of eq 20 conversely for steepness lower than 0 048 only pulsating loads have been observed it is also worth to notice that for data not exceeding the kamphuis limit the maximum pressure at the peak of force is well predictable as a linear function of the quantity fig 20 21 r p r c h m 0 h m 0 g t p 2 which has been originally introduced by owen 1980 as a wave overtopping predictor in practice data suggest that wave pressure is the more intense the higher wave steepness since wave breaking tends to occur however for a given steepness though pressure reduces for low crest freeboards that is with increasing the overtopping rate 5 2 horizontal component of wave force comparison with literature as mentioned above in most of literature studies the only effect of wave overtopping is assumed to be a truncation of the wave pressure distribution at the outer face of the structure accordingly despite testing overtopped breakwaters also in takahashi et al 1994 no pressure measurements were taken on the rear wall in view of this it has seemed consistent to perform the comparison between predictive models and numerical experiments ignoring at first the pressures exerted on the inner face subsection 5 2 1 and 5 2 2 successively in subsection 5 2 3 the effects of wave overtopping are examined in a more detail 5 2 1 peak of horizontal force under uprush phase fig 21 compares the maximum landward directed horizontal force measured for each test to the takahashi et al predictions the latter are obtained using the maximum wave height and the respective period hmax and tmax as wave parameters most of points exceed the line of perfect agreement with an average underestimation rate of 79 additionally 6 points are underpredicted by a factor larger than 1 4 which is used in the italian design practice as a safety factor against sliding however these force peaks are mostly generated by breaking waves e g figs 14 and 16 and in virtue of their short duration and low impulse they are not likely to affect the stability of the structure but rather durability of concrete peregrine 2003 goda 1986 with this in mind the comparison above has been repeated after smoothing the force signals via a second order savitzky and golay 1964 filter with a 0 8s time window e g fig 22 as shown in fig 23 the filtered force peaks compare now quite well with the takahashi et al predictions the average underprediction rate is now 16 and only two point slightly exceeds the sf 1 4 line however 8 data out 11 are still underestimated moreover a trend with relative water depth has been detected with the amount of underprediction increasing in deep waters fig 24 previous results do not depend on the inclusion of air in the simulation 5 2 2 horizontal force peak under trough phase the maximum seaward directed horizontal force has been found to exceed the shoreward maximum after smoothing the breaking peaks by a factor ranging between 1 1 and 2 1 1 37 on average fig 25 since no particular suggestions come from the takahashi et al work numerical results have been compared to the methods proposed by goda 1986 and sainflou 1928 for traditional vertical face breakwaters in both cases hmax and tmax have been employed as wave parameters figs 26 and 27 show significant underpredictions for the longer waves although the sainflou equation seems to perform slightly better than the goda model the average underprediction rate for long waves is around 52 for the goda method whereas it lowers to 31 for sainflou these results are qualitatively consistent with the findings of mcconell et al 1999 based on physical model tests on conventional non overtopped vertical breakwaters although larger underpredictions have been here detected red broken line fig 27 5 2 3 effect of wave overtopping along with clipping wave pressure distribution at the outer face wave overtopping also induces loadings onto the inner wall this produces either a variation of quasi static maxima of wave force basically due to the phase lag between incident and transmitted waves or as shown by walkden et al 2001 the occurrence of intense impulsive loadings both these features have been surprisingly little researched so far in the following only quasi static effects are discussed whereas impact loadings are analyzed in buccino et al 2019 for the analyses discussed below wave force chronograms have been first re computed including rear pressures then they have been smoothed using the savitzky and golay filter as employed in section 5 2 1 to retain only the pulsating part it has been found out that wave overtopping amplifies both the seaward and the landward horizontal force peaks as shown in fig 28 when the maximum landward force is attained upper panel negative pressures take place at the inner wall and vice versa however fig 29 suggests the amplification factor to be negligible for trough loads 1 05 on average panel b whereas for the landward directed force it reaches 1 16 with including the overtopping loadings the ratio between the maximum force under trough and the maximum force under crest lowers from 1 37 on average fig 19 to nearly 1 20 however all data under wave crest are underpredicted by the takahashi et al formula the mean underprediction rate is now 22 compared to the 16 detected in fig 23 5 3 approximate sliding force as the wave force under trough generally exceeds the wave force under crest and since the presence of dynamic pressures at the inner wall fig 28 invariably alters the regime of uplifts it is rather difficult to predict which wave phase whether crest or trough may be the most critical for structure stability to have a deeper insight of this issue the sliding force s l should be more appropriately considered the latter represents the total shear the structure has to withstand by its weight to prevent sliding on the bottom neglecting the wave loadings exerted on the caisson roof s l can be defined as follows fig 30 22 s l f h μ f u p l i f t f s v in which f h is the horizontal force including the overtopping effects f u p l i f t is the uplift force acting at the bottom f s v is the vertical component of the wave force at the sloping top μ is the structure bottom friction factor in the present study due to the lack of measurements for uplifts only an approximate sliding chronogram can be calculated in which the distribution of pressure beneath the structure is assumed trapezoidal in all instants fig 30 in practice that means to set 23 f u p l i f t 0 5 p s 20 p s 20 b where p s20 and p s10 are the pressure signals at the transducers 20 and 10 respectively fig 10 and b indicates the caisson width a sample of sliding signal after smoothing is shown in fig 31 whereas fig 32 compares for each test the maximum positive landward directed and the maximum negative shoreward directed peaks the graph indicates that for the larger periods the structure would tend to slide seaward being the negative peak up to twice the positive one in practice under wave crest the presence of negative dynamic pressures on the rear wall see upper panel of fig 28 increases f h but reduces uplifts on the other hand under a wave trough both the previous components f h and f u p l i f t are enhanced so that the seaward sliding peak is amplified by wave overtopping furthermore it is worth noticing that since the sloping top extends below the swl it tends to favor the sliding under trough as the vertical component of the negative wave pressures is upward directed lower panel of fig 28 fig 33 shows the comparison with literature models analogously to what observed for f h the takahashi et al method predicts up to a certain extent the measurements although some underpredictions for the shorter waves has been detected average underprediction rate 42 on contrary under a wave trough the sainflou formula exhibit larger underestimations 60 on average which may render design process rather uncertain 5 4 the use of the linear thrust parameter none of the literature methods have been found to be plenty satisfactory in predicting present data this is especially true for trough conditions which on the other hand have been shown to be crucial for the structure stability hence an alternative approach is here tested namely that introduced by buccino et al 2015 in the frame of the experimental study mentioned in subsection 3 2 in analyzing the behavior of ssgs subject to severe overtopping the authors proposed the following linear formula to calculate the horizontal component of the quasi static wave force under crest phase 24 f k ρ g l t p d h c where beyond the quantities already introduced hc represents the structure height in eq 24 ltp is the linear thrust parameter i e the ratio between the linearized maximum momentum flux due to the incoming waves and the hydrostatic force corresponding to the still water level d basically buccino et al 2015 considered the ratio between the maximum value over a wave period of the cross shore component of the incident wave momentum flux at the toe of the structure and the corresponding hydrostatic still water thrust 25 l t p m a x t t d η p ρ g z ρ u 2 d z 0 5 ρ g d 2 in eq 25 η is the free surface z is the vertical coordinate positive upwards u is the cross shore wave velocity ρ is the water density and g is the gravity acceleration by using the linear wave theory and retaining only the first order terms one gets 26 l t p h d tanh k d k d which is a fully linearized and slightly modified form of the momentum flux parameter originally introduced by hughes 2004 see also buccino et al 2018 note that ltp coincides with the wave height to depth ratio h d in shallow water altogether eq 24 establishes a simple proportionality between wave force and maximum wave momentum flux via the empirical coefficient k which buccino et al 2015 reasoned to be of the order of 1 the retaining of the first order terms only is legitimized by the low crest of the structure for the case of ssg a value of k 0 77 has been estimated based on regular wave physical model tests despite a very good r 2 statistics was found 0 95 the authors warned that some small non linear effects could exist in this paper eq 24 has been used to predict both the landward and the seaward horizontal force maxima where the overtopping effects are included according to the previous sections h max and t max have been employed as wave parameters as shown in fig 33 the method performs rather well for the landward peak for which the same k as in buccino et al 2015 has been found and a very good r 2 statistics 0 92 on the other hand the prediction power drops a little under trough conditions although the r 2 still remains relatively high see fig 34 finally an attempt has been conducted to use the ltp method for the prediction of the approximate sliding force maxima to this purpose a simplified distribution of pressures has been hypothesized which is uniform on the front face and triangular at the bottom accordingly the magnitude of the front pressure p front and the maximum uplift p u max is assumed to be 27 p f r o n t p u m a x k ρ g l t p d where the values of k are those obtained from fig 29 in spite of the simplification introduced the proposed approach still allows good predictions of the experimental data fig 35 again the estimates under crest are rather efficient although some non linear effects are visible the model is less accurate but still reasonable under trough where the hypothesis of uniform distribution of the front pressures becomes quite questionable table 7 reports some reliability indexes 6 summary and conclusions a set of 11 full scale random wave cfd experiments have been conducted to deepen the knowledge on the loading process at sloping top caissons subject to significant wave overtopping the commercially available software flow 3d has been used which numerically solves the reynolds averaged navier stokes equations using the finite difference method with a stationary cartesian grid as for the turbulence closure the renormalized group rng extension of the k ε model has been selected which is particularly suited to describe the wave evolution in the neighborhoods of the breaking point the structure employed had a relative crest freeboard r c hm0 ranging from 0 4 to 0 8 whereas the relative water depth d lp was included between 0 12 and 0 31 despite the limitedness of data a number of interesting items have been discussed with respect to loading case occurring at the structure global stability conditions predictability of wave actions as far as the loading cases are concerned although testing very steep waves giving rise to impact conditions the maximum pressure at the instant of the maximum force has been observed not to exceed 2 5 times the incident significant wave height i e far less than what measured on conventional vertical face breakwaters this finding is consistent with the results of physical model tests conducted by buccino et al 2015 and is essentially caused by the presence of the sloping top which constraints the breaking front to a big rotation before hitting the wall additionally the discontinuity of the wall profile produces a phase lag between the pressure signals which leads the instant of maximum force not to coincide with the instant of maximum impulsive pressure regarding the global stability it has been found out that since wave overtopping leads to a significant reduction of loadings under wave crest trough conditions become crucial to the structural response this is especially true for long waves with relative water depth included between 0 1 and 0 2 this is consistent with the case history published in 1994 by oumaraci who reported the cases of 5 real vertical breakwaters out 14 examined which failed seaward after experiencing severe overtopping in the four cases where wave data were available valencia catania algiers niigata the relative crest freeboard was included between 0 64 and 1 07 whereas the relative water depth ranged between 0 08 and 0 17 indicating long waves similar to those employed in this study in this respect it is worth to emphasize that differently from what argued by walkden et al present data suggests that seaward failure of overtopped breakwaters is not necessarily related to the occurrence of impact forces onto the rear face the sliding signals here analyzed have been here previously smoothed rather significant overtopping reduces the landward force peaks compared to non overtopped structure making the seaward peaks comparatively larger and crucial to the stability it has been then observed that wave actions under crest are reasonably predicted by the takahashi et al method although a certain trend at underestimating data has been detected especially for short periods this would confirm the previous findings of vicinanza and frigaard 2009 however large underpredictions have been found for the trough phase where no specific method exists but those valid for conventional vertical phase breakwaters in view of this result an alternative predictive approach has been tested which assumes a simple proportionality law between wave force and peak of linear wave momentum flux the method proved to be rather efficient under wave crest and this appears very interesting in virtue of the simplicity of calculations under wave trough the momentum flux approach still remains an useful prediction tool producing a remarkable improvement compared to the existing methods such as the sainflou formula neverthless the quality of estimates lowers a little this occurs mainly because some of the assumptions the method relies on are no longer verified this includes the uniform distribution of pressures along the entire outer face of the structure and the neglecting of the hydrostatic thrust above the trough which is of order of h2 on the whole this research has suggested that significant gaps still exist about the global features of loadings exerted by waves on non conventional monolithic breakwaters and that a supplementary research effort is needed to reduce the degree of uncertainty that affects the design process acknowledgment the authors wish to acknowlege eng fabio maresca for his precious assistance in data analysis 
22804,this paper presents model scale computations of self propelled turning circle and zig zag manoeuvres for a benchmark combatant dtmb 5415m adopting the unsteady reynolds averaged navier stokes urans equations a hierarchy of overset grids is utilised to allow rudder deflections while the ship undertakes 6 dof dynamic motions with both manoeuvres executed at approach speed corresponds to fr 0 41 two different propulsion techniques are applied to drive the free running vessel the body force propeller model bfm and the discretised propeller model dpm a verification and validation study is also performed for estimating the numerical uncertainties within the urans simulated manoeuvres comparisons of the results are made between computations adopting the two propulsion approaches and against experimental data from literature the bfm propulsion method in this study is shown to under predict the magnitude of propeller induced wake passing the rudders compared to the dpm approach which is able to resolve high fidelity flow physics behind the propellers in general the comparison between experimental and numerical results agree mostly within about 10 for the studied turning circle and zig zag manoeuvres keywords dynamic manoeuvres unsteady reynolds averaged navier stokes self propulsion overset grid surface vessel abbreviations bfm body force model des detached eddy simulation dof degrees of freedom dpm discretised propeller model ear expanded area ratio of propeller efd experimental fluid dynamics ittc international towing tank conference lcb longitudinal centre of buoyancy lcg longitudinal centre of gravity urans unsteady reynolds averaged navier stokes vcg vertical centre of gravity nomenclature bwl ship waterline beam m cb block coefficient d propeller diameter m fs ship local force n ixx iyy ship moment of inertia kg m2 j propeller advance coefficient kq propeller torque coefficient kt propeller thrust coefficient lpp ship length between perpendiculars m lwl ship waterline length m ms ship local moment nm n propeller rotation speed rps t time s t ship draft m η ship position matrix on the earth fixed reference frame j 1 euler angle transformation matrix v ship linear and angular velocity matrix on the ship local reference frame us ship advance speed m s 1 introduction manoeuvrability is one of the major considerations when assessing ship hydrodynamic performance for navigational safety and efficiency to ensure its compliance with imo s regulation imo 2002 studying ship s manoeuvring performance during the design stage is indispensable hooft and nienhuis 1994 the manoeuvrability of a surface ship is often determined through standard free running manoeuvres such as turning circle and zig zag tests lewis 1989 these dynamic manoeuvres are commonly carried out by sea trials model tests or numerical simulations where analysis on the ship control characteristics and turning abilities can be performed although full scale manoeuvring sea trials are still the most direct and reliable approach to quantify ship manoeuvrability there are limitations that must be considered for example the trials can only be conducted after the ship is constructed and in an uncontrolled environment crane 1979 performed manoeuvring trials on a typical vlcc in both shallow medium and deep waters the data gathered are regarded as a source of validation and is referenced in many recent works such as delefortrie and vantorre 2007 toxopeus 2011 a widely adopted method of investigating ship manoeuvrability during the design stage is scale model testing this could involve using a horizontal planar motion mechanism to conduct a series of quasi static measurements under prescribed captive motions kim et al 2007 simonsen et al 2012 or dynamically varying rudder deflections on a self propelled model to achieve turning and zig zag manoeuvres in simman 2008 stern et al 2011 a collection of benchmark ship models were tested under both captive and dynamic manoeuvres by different research institutes the experimental measurements are compared and documented with uncertainty levels which makes them extremely valuable for validation studies an alternative and more cost effective approach of analysing ship manoeuvring performance and its associated fluid structure interaction problems is by numerical simulations which adopts either system based or cfd based techniques the system based method calculates the global and local kinematics of the dynamic manoeuvres by solving truncated mathematical models such as the abkowitz model abkowitz 1964 and the mmg model hirano and takashina 1980 son and nomoto 1982 the hydrodynamic derivatives in these models are usually obtained from captive model scale tests or virtual pmm simulations jin et al 2016 guo and zou 2017 the cfd based method is often based on using urans or urans les hybrid solvers to resolve time domain hydrodynamic loads and motions when a ship is undertaking dynamic manoeuvres such computations require self propulsion moving rudders and are typically performed using full 6 dof capabilities in a free surface environment and are able to provide rich details of flow physics during manoeuvres carrica et al 2013 araki et al 2012 mofidi and carrica 2014 and shen and korpus 2015 all carried out cfd based computations to model dynamic manoeuvres and their results showed good correlation with experimental measurements with analogous approach broglia et al 2015 and dubbioso et al 2016 carried out comprehensive studies on the manoeuvrability of a twin screw vessel for different rudder configurations in order to capture the local dynamics of the ship as well as the closely moving appendages the overset grid technique is commonly adopted in these simulations the ultimate approach to numerically model dynamic manoeuvres is to incorporate fully discretised and rotating propellers dpm appended to the ship geometry which often requires great computational resource and effort an alternative simplified method is to adopt a body force model bfm to represent propeller generated force and induced flow sadat hosseini et al 2014 most of the up to date cfd based dynamic manoeuvring studies were carried out by research groups with their in house codes in the present work the dynamic manoeuvres are performed by the commercial urans solver star ccm using its embedded overset grid function the turning circle and zig zag manoeuvres of a benchmark model dtmb 5415m in calm water are carried out using dpm and bfm propulsion techniques the aim of this paper is to quantify the difference between these two different types of propulsion modelling techniques in terms of computational efficiency and fidelity a verification study is performed for the dynamic maneouvres with body force propulsion but not for the maneouvres with discretised propellers due to high computational cost the computed trajectories of local kinematics of the ship are compared against experimental measurements from marin taken from simman 2008 stern and agdrup 2008 2 ship geometry the dtmb 5415m model geometry was downloaded from simonsen et al 2014 this has been used as a benchmark by the ship hydrodynamic community for many years and extensive experimental data exists the fully appended model with twin split bilge keels roll stabilizer fins twin rudders twin propellers and struts is given in fig 1 the geometrical details of the ship model and its operational condition can be found in table 1 the computed cases presented in this paper include a turning circle manoeuvre at 35 degrees of rudder angle and a 20 20 zig zag manoeuvre in calm deep water 3 computational method the dynamic manoeuvres are carried out using commercial urans solver star ccm the code uses a finite volume discretisation on structured or unstructured grids consisting of arbitrary convex polyhedrals the pressure velocity coupling is solved using a pimple algorithm where its practical implementation is discussed in cd adapco 2014 3 1 urans equations and turbulence modelling the governing equations for the two phase incompressible flow combining air and water are given by the urans equations coupled with the conservation of continuity rusche 2003 1 ρu t ρuu p g x ρ μ u ρτ σ t κ γ γ 2 u 0 here u u v w is the velocity field in cartesian coordinates p represents the pressure including hydrostatic ρ ρ x is the fluid density which varies with the content of air water in the computational cells x x y z are the cartesian coordinates g is the gravitational acceleration and μ is the dynamic molecular viscosity here τ is the reynolds stress tensor 3 τ 2 ρ μ t c 2 3 ki where μ t is the dynamic eddy viscosity 1 2 t is the fluid strain rate tensor and k is the turbulent kinetic energy per unit mass is the gradient operator x y z i is the identity matrix the last term in equation 1 represents surface tension where σ t is the surface tension coefficient which is 0 074 kg s2 between air and water at 20 c and κ γ is the surface curvature jacobsen et al 2012 the above equations are solved for air and water simultaneously where the fluids are tracked using the volume of fraction γ with the value of 0 for air and 1 for water and any intermediate value is a mixture of the two fluids the distribution of γ is modelled by an advection equation 4 γ t uγ u r γ 1 γ 0 the last term on the left hand side is a compression term which limits the smearing of the interface and u r is the relative velocity vector using γ the spatial variation in fluid properties such as ρ and μ can be derived through weighting 5 ρ γρ water 1 γ ρ air 6 μ γμ water 1 γ μ air the closure of the urans equations is achieved using the k ω shear stress transport turbulence model on the basis of the description by menter 1994 and wilcox 2008 3 2 computational domain boundary conditions and grid the computational domain is designed following the ittc practical guidelines for ship cfd applications ittc 2014 to avoid blockage effect and wave reflections the mass centre of the ship is located at an initial position of 0 0 0 in the earth fixed reference frame a schematic drawing of the computed fluid domain is given in fig 2 a a velocity inlet boundary condition is applied at the upstream end of the fluid domain where the inflow velocity is set to be zero at the downstream end of the fluid domain a damping pressure outlet boundary is imposed to prevent wave reflections the top bottom and side walls of the domain are all selected as velocity inlets to avoid velocity gradient occurring from the boundaries slow cell growth rate is selected to create smooth mesh transition between the refined hull surfaces and the overset boundaries hexahedral trimmer and surface remesher are adopted to generate global volume mesh as well as local refinements to resolve the turbulent boundary layer all y wall treatment is utilised as well as the prism layer mesh achieving minimum y value of 30 along the hull for all computations at the free surface anisotropic trimmer refinement is applied in the vicinity of the ship hull to capture the kelvin wave generated during the dynamic maneouvres a summary of the number of grids for each computational case is shown in table 2 the time step resolution is selected according to star ccm practice for ship resistance modelling for computations adopting the body force propulsion method the courant number is kept at around 1 with respect to the hull surface grid size details of the grid and time step independence study are presented in a later section on the other hand the time step for the manoeuvres with discretised propeller is chosen based on the propeller rotation rate to achieve a courant number of around 1 at the blade tip 3 3 ship motion and overset grid assembling the motions of the ship are simulated by the dynamic fluid body interaction module integrated in the 6 dof motion solver two reference frames are involved in solving the motion equations which are denoted as the ship local and earth fixed reference frames in fig 1 the linear and angular velocities v equation 8 on the ship local reference frame are related to the spatial positions and rotations η equation 7 on the earth fixed reference frame through equation 9 7 η x y z ϕ 8 v u v w p 9 v j 1 η where j is the euler angle transformation matrix fossen 1994 v is calculated through the integration of linear and angular accelerations in the ship local reference frame computed from equation 10 10 u x s m vr wq x g q 2 r 2 y g pq r z g pr q v y s m wp ur y g r 2 p 2 z g qr p x g qp r w z s m uq vp z g p 2 q 2 x g rp q y g rp p p 1 i xx k s i zz i yy qr m y g w uq vp z g v wp ur q 1 i yy m s i xx i zz rp m z g u vr wq x g w up vp r 1 i zz n s i yy i xx pq m x g v wp ur y g u vr wq where m is the mass of the ship x g x g y g z g is the distance vector from the centre of rotation to the centre of gravity and i i xx i yy i zz is the moment of inertia around the centre of rotation it is assumed the centre of rotation aligns with centre of gravity during the dynamic maneouvres shen et al 2015 the ship local forces and moments in equation 10 f s x s y s z s and m s k s m s n s are computed by applying the euler angle transformation matrix j 1 on the hydrodynamic and gravitational loads in the earth fixed reference frame which are integration of pressure on the fully appended ship hull including rudders and propellers a hierarchy of overset regions is included in the computation of 6 dof dynamic manoeuvres the background domain is superimposed with the linear and angular velocities of the ship s surge sway and yaw motion which enables a relative static position between the overset and background grids the propeller and rudder overset regions are defined within the ship local reference frame and act as children objects to the ship overset body and move together with it the strategy to compute the angular motion of rudders depends on the type of manoeuvres required for the turning circle manoeuvre the rudders are fixed at zero degree angle until the ship reaches a constant speed and then they deflect to a prescribed angle allowing the ship to carry out the manoeuvring motion after approximately two turning circles the rudders deflect back to their original position enabling the ship s pull out to compute the zig zag manoeuvre the rudder angle is governed by a field function referring to the yaw angle of the ship 4 propulsion modelling the ship model is self propelled at model scale propulsion point by two different numerical techniques for the dynamic manoeuvres the body force model and the discretised propeller model the angular velocity of the propellers is adjusted manually until the vessel achieves the target froude number of 0 41 the propeller rotation speed is maintained to be constant throughout individual manoeuvres 4 1 body force propeller model bfm the body force propeller model applies the actuator disk concept to account for the presence of the propellers a field of body forces are distributed over the cylindrical virtual disk and varies in its radial direction following the goldstein optimum the distributed axial and tangential body forces are used to simulate the acceleration and the increase in swirl that the flow undergoes when passing through the propeller computations adopt similar method to drive dynamic manoeuvres can be found in broglia et al 2013 and dubbioso et al 2017 it is worth mentioning that the body forces are computed from the thrust and torque coefficients k t and k q of the propeller these two variables are depended of the advance coefficient j u s nd where u s is the velocity at the inflow plane of the virtual disks n is the angular velocity of the propellers in rps and d is the propeller diameter the open water performance curve of the adopted marin propeller no 4058 simonsen et al 2014 is given as a polynomial function in equation 11 where the coefficients are tabulated in table 3 11 k t or k q a bj cj 2 dj 3 ej 4 fj 5 4 2 discretised propeller model dpm the discretised approach adopts an overset grid to simulate the rotation of propellers the hydrodynamic loads acting on the propeller blades are treated as external forces in the 6 dof motion equations to solve the dynamics for the ship overset domain to validate the feasibility of the discretised propeller modelling several open water simulations are performed prior to the dynamic manoeuvre computations the numerical domain comprised a propeller overset region and a background region as shown in fig 3 the inlet of the background region is given different uniform inflow velocities to simulate varying advance coefficients for the propeller a prescribed angular velocity corresponding to that in the dynamic manoeuvres is applied on the propeller overset region to mimic the rotation of the blades the grid size on the propeller is set to be the same as it is in the dynamic manoeuvres meanwhile the computations are carried out at an equivalent courant number fig 4 shows the vortical structures in the vicinity of the propeller operating at different inflow velocities the tip vortices are clearly resolved where a thick vortex ring forms outside of the tip vortices as the inflow velocity is reduced although the vortex pairing phenomenon mentioned in carrica et al 2010 is not captured considering the use of a relatively coarse grid for the purpose of generating global propulsion force the limitation of the urans method in turbulence modelling the presented discretised propeller model is deemed acceptable fig 5 presents the open water performance curve predicted from the discretised propeller model against benchmark data from marin the good agreement with experimental data demonstrates that this approach is feasible to propel the ship model for the dynamic manoeuvres 5 verification and validation prior to performing computations on the dynamic manoeuvres it is essential to verify and validate the present computational approach due to its better computational efficiency the turning circle manoeuvre with the body force propeller model is selected as the base case for conducting the verification and validation study 5 1 numerical uncertainty firstly the verification study is performed to estimate the numerical uncertainties within our simulations following the procedures by stern et al 2001 and wilson et al 2001 it is assumed that the numerical uncertainty u sn comprises iterative convergence uncertainty u i grid spacing uncertainty u g and time step uncertainty u t giving the following expression 12 u sn 2 u i 2 u g 2 u t 2 tezdogan et al 2015 estimated the iterative convergence uncertainty in the predictions of motion responses for a container ship using the star ccm urans solver their analysis indicated u i to be less than 0 50 in simulation results which is considered to be negligible since similar computational settings are applied grid and time step uncertainties are of primary interest in the present study the grid and time step convergence study are both conducted with triple solutions systematically the grid uncertainty analysis is performed with the smallest time step whilst the time step independence study is carried out with the finest mesh the details of the grid and time step adopted in the verification study are presented in table 4 referring to simonsen et al 2012 and jin et al 2018 the grid uncertainty of unstructured trimmer mesh can also be estimated based on richardson s extrapolation variations of simulation results s between the fine sg1 medium sg2 and coarse sg3 grids with refinement ratio of r g 2 are identified as 13 ε g 21 s 2 s 1 14 ε g 32 s 3 s 2 the numerical convergence ratio r g can be calculated from equation 15 15 r g ε g 21 ε g 32 depending on the value of the convergence ratio four conditions can be predicted i 0 r g 1 monotonic convergence mc ii r g 0 r g 1 oscillatory convergence oc iii 1 r g monotonic divergence md iv r g 0 r g 1 oscillatory divergence od it is noted that for divergence conditions iii and iv the numerical uncertainty cannot be estimated for the oscillatory convergence ii the numerical uncertainty can be estimated by bounding the error based on oscillation with upper limit s u and lower limit s l using equation 16 16 u g 1 2 s u s l for convergence condition i the generalized richardson extrapolation can be employed to estimate the numerical error δ re g 1 and order of accuracy p g as 17 δ re g 1 ε g 21 r g p g 1 18 p g ln ε g 32 ε g 21 ln r g there are two ways to estimate the numerical uncertainty depending on whether the solutions are close to the asymptotic range this is determined by the correction factor c g defined as 19 c g r g p g 1 r g p gest 1 where p gest is an estimate for the limiting order of accuracy if c g approaches unity the solutions are close to the asymptotic range in this case the numerical error δ sn benchmark result s c and uncertainty u g can be estimated from 20 δ sn c g δ re g 1 21 s c s δ sn 22 u g 2 4 1 c g 2 0 1 δ re g 1 1 c g δ re g 1 1 c g 0 125 1 c g 0 125 when c g is sufficiently greater than 1 which means the solutions are far away from the asymptotic range the numerical uncertainty u g can be calculated from equation 19 23 u g 9 6 1 c g 2 1 1 δ re g 1 2 1 c g 1 δ re g 1 1 c g 0 125 1 c g 0 125 based on similar procedures the time step uncertainty u t can be estimated with refinement ratio r t 2 a summary of the grid and time step uncertainties for the urans computations are listed in table 5 and table 6 overall the present computation gives relatively small numerical uncertainties and correlates well to the experimental data stern and agdrup 2008 demonstrating its feasibility for undertaking further systematic simulations 5 2 validation against experimental data to validate the presented computations it is necessary to check if the absolute comparison error e between numerical and experimental results carrica et al 2010 is less than the validation uncertainty u v shown in equation 24 calculated as a combination of numerical uncertainty u sn and experimental uncertainty u d 24 u v u sn 2 u d 2 comparisons between e and u v for the turning circle manoeuvre results from the present computation are given in table 7 in order to quantify the validation uncertainty it is necessary to know the uncertainty of the experimental data this is not provided by the literature therefore the experimental uncertainties u d are approximated as 5 00 it is observed the numerical uncertainties for all investigated parameters are below 15 0 the validation uncertainties are greater than the comparison error indicating the urans model is validated 4 results and discussion before executing the dynamic manoeuvres the propeller speed is tuned until the model is able to reach the speed of 2 59 m s corresponding to a froude number of 0 41 at self propulsion stage then the selected propeller speed is kept constant throughout the manoeuvres a summary of run cases is listed in table 8 4 1 turning circle manoeuvre fig 6 a shows trajectories of the computed starboard turning circle manoeuvre with 35 rudder deflection at an approaching speed corresponding to fr 0 41 cases 1 and 2 comparison is made against experimental results from stern and agdrup 2008 and numerical data presented in carrica et al 2013 the predicted tactical diameter agrees well with the experimental data for both bfm and dpm propulsion methods the comparison errors are less than 3 00 as quantified in table 9 fig 6 b depicts the prediction of yaw rate histories for the turning circle manoeuvre the tendency and magnitude of the urans computed results match well with the experimental data at t 5s the rudders deflect to starboard with an angular speed of 53 6 s meanwhile the vessel starts to yaw to the starboard side and reaches a steady yaw rate at approximately t 10s to pull out the vessel from the dynamic manoeuvre the rudders are returned back to their original position with the same angular speed it is worth mentioning here that there is a difference in the pull out time point between the presented urans computations and the results from literature consequently this leads to the computed yaw rate and the data gathered from the literature to decline at different instantaneous time points t 37 s and t 40 s a comparison of the maximum yaw rate between the numerical and experimental data is presented in table 9 the difference between numerical and experimental results for both bfm and dpm propulsion methods are below 10 0 the time histories of roll motion from urans computations and experiment are presented in fig 6 c at the beginning of the turning circle manoeuvre when the positive starboard rudder rotation is imposed a positive roll excursion into the portside of the vessel occurs oscillates and then decays to a roll angle of relatively static signature at about t 6s a maximum positive roll angle of almost 12 appears due to the dominant rudder moment induced by high speed and large angle rudder deflections when the vessel reaches the steady turning phase at about t 14s the roll angle becomes negative and is towards the port side indicating the centrifugal and hull hydrodynamic roll moment overcome the rudder moment at the end of the turning circle manoeuvre negative rudder rotation is applied to the vessel where the rudder moment adds up to the centrifugal and hull hydrodynamic roll moment producing a large instantaneous roll motion of nearly 13 this roll motion continues to oscillate for about 5s and decays to zero magnitude when predicting roll motion the urans predictions exhibit less fluctuation compared to the experimental data the dpm propulsion model seems to produce the best estimation of the static roll motion during the manoeuvre where the bfm model in this study over predicts this quantity this can be explained from the difference in the lateral rudder force between the bfm and dpm methods shown in fig 6 d the dpm produces an inflow velocity of greater magnitude to the rudders comparing to the bfm approach as shown in fig 7 this leads to greater stagnation pressure on the foreside of the rudder and therefore a more significant pressure difference between the forward side and back side of the rudders as shown in fig 8 consequently the rudders after the discretised propeller experience more significant hydrodynamic load which produces greater positive restoring roll moment to balance out the centrifugal and hull hydrodynamic roll moment during the steady turning phase quantitative comparison between urans and experimental data on the peak roll motions is given in table 9 the comparison errors of both bfm and dpm approaches are less than 13 0 fig 9 depicts the interaction of vortices between the rudders and propellers from the dpm computation at the rudder angle of 0 the rotation of discretised propellers generates noticeable circular tip vortices and strong hub vortices passing the rudders for the rudder angle of 35 the hub vortices are jeopardised and form a larger size vortical structure reduction in the flow velocity is observed in fig 9 b which is caused by ship speed loss from the rudder action fig 10 summarises the computed free surface elevation at different time points during the turning circle manoeuvre the kelvin wave patterns are well captured after the vessel the bow and stern waves are both very steep and gird refinements are recommended at these regions for resolving possible breaking 4 2 zig zag manoeuvre fig 11 presents the computed 20 20 zig zag manoeuvre at the approaching speed corresponds to fr 0 41 cases 3 and 4 comparison is made against experimental data and numerical results from literature during the first cycle defined as the time between the initial rudder execution to portside to the following zero crossing moving to portside again there are small discrepancies in terms of yaw angle and rudder period as given in table 10 the comparison errors of both bfm and dpm computations are well below 10 for the second cycle a similar level of accuracy from urans computations can be found for the rudder and yaw angle as the zig zag manoeuvre progresses time lag starts to appear in the rudder and yaw angle results from urans bfm approach when comparing to experimental and urans dpm results this is primarily due to under predicted rudder loads in the simplistic wake flow after the body force propeller model which is evident from fig 6 d combining fig 11 a and b it is found that the heading overshoot in cfd models is generally greater than the experiment this may be due to insufficient rudder moment or yaw damping as stated in carrica et al 2010 as shown in table 10 the comparison errors for the overshoot angle during the first and second cycle are around 10 0 in terms of yaw rate cfd and experimental data show excellent correlation the comparison errors for both urans bfm and dpm during the first two cycles are below 5 00 notice that the rate of change in the time series yaw rate is very close to the experimental data suggesting the numerical model responds well to the rudder action again the progressively increasing time lag observed in the urans bfm results indicates slightly under estimated rudder force the roll angle given in fig 11 d shows relatively greater discrepancies between urans predictions and experimental data referring to table 10 the urans dpm method tends to over predict the maximum roll amplitude by 11 95 and 13 34 during the first and second cycle respectively the bfm computation gives better predictions on the magnitude of this parameter but it possesses greater time lag along the progress of the zig zag manoeuvre all urans computations seem to over predict the magnitude of the maximum roll angle when comparing against experiment this demonstrates that the cfd computations tend to under predict the roll damping and this could possibly due to relatively coarse grid in the transverse direction near the hull nonetheless both urans bfm and dpm methods provide satisfactory engineering solutions fig 12 summarises the computed free surface elevation at different time points during the zigzag manoeuvre similar to the turning circle case the kelvin wave patterns around the vessel are well resolved indicating steep bow and stern waves from fig 12 a to b the vessel continues to yaw to the starboard side due to constant positive rudder action at around t 11 5s the rudders begin to deflect from starboard side 20 to the portside 20 and the yaw rate in the negative direction reaches its maximum as a result of changing rudder angle the yaw rate of the vessel starts to change its bow direction to the portside positive the magnitude of the yaw angle in the bow to starboard negative direction starts to decline and approaches zero at about t 15s and then climbs and reaches its maximum in the positive direction at about t 18s shown in fig 12 c when the yaw angle approaches 20 once more the rudder deflects again the vessel starts yawing back into the starboard direction and reaches a maximum yaw angle at t 24s in fig 12 d this process repeats again and again during the zig zag manoeuvre 4 3 computational efficiency table 11 presents the computational cost for each of the studied dynamic manoeuvres it is observed that the computations with dpm require much greater cpu power compared to the bfm approach this is primarily due to the demand of a much smaller time step to resolve the angular motion of the propeller overset grids despite the difference in computational time the accuracies of dpm and bfm approaches are close and commendable tables 9 and 10 therefore it is observed that for applications solely focused on the vessel global trajectories the bfm method is a valid option to model the dynamic manoeuvres considering the accuracy and rapid computational time for problems that require high fidelity fluid physics after the propellers for example to capture propeller rudder interactions the dpm method is still needed 5 concluding remarks urans methods have been extensively adopted and validated for predicting steady and quasi static ship hydrodynamic applications including resistance and virtual planar motions and to some extent for unsteady problems such as seakeeping jin et al 2017 highly coupled and dynamic computations such as the ship free running manoeuvres in calm water and waves still pose a challenge and require detailed verification this paper presents urans computations of dtmb 5415m undergoing self propelled turning circle and zig zag manoeuvres using commercial solver star ccm two different propulsion techniques the body force and the discretised propeller models are investigated where the results are compared with benchmark experimental and numerical data from simman 2008 by analysing the computed dynamic manoeuvres the following conclusions can be drawn urans approach together with overset grid technique is a feasible technique to model the fully dynamic surface vessel free running manoeuvres both bfm and dpm propulsion methods are practical for driving free running manoeuvres considering the good correlation between computed results and the experimental data the computed turning circle manoeuvre with bfm propulsion tends to under predict the lateral rudder force in the steady phase of turn which leads to over estimation of the ship roll motion the bfm method exhibits more merits in terms of rapid computational time while the dpm is more advantageous in resolving high fidelity flow physics near the propeller and rudder regions future work includes full scale computations and modelling dynamic manoeuvres in wave environments the free running results will also be subjected to system identification process to quantify manoeuvring coefficients leading to more robust system based manoeuvring model for control applications acknowledgement the authors acknowledge the financial support provided by the australian maritime college university of tasmania on the present work computations were performed on the kunanyi cluster funded by the tasmanian partnership for advanced computing tpac program 
22804,this paper presents model scale computations of self propelled turning circle and zig zag manoeuvres for a benchmark combatant dtmb 5415m adopting the unsteady reynolds averaged navier stokes urans equations a hierarchy of overset grids is utilised to allow rudder deflections while the ship undertakes 6 dof dynamic motions with both manoeuvres executed at approach speed corresponds to fr 0 41 two different propulsion techniques are applied to drive the free running vessel the body force propeller model bfm and the discretised propeller model dpm a verification and validation study is also performed for estimating the numerical uncertainties within the urans simulated manoeuvres comparisons of the results are made between computations adopting the two propulsion approaches and against experimental data from literature the bfm propulsion method in this study is shown to under predict the magnitude of propeller induced wake passing the rudders compared to the dpm approach which is able to resolve high fidelity flow physics behind the propellers in general the comparison between experimental and numerical results agree mostly within about 10 for the studied turning circle and zig zag manoeuvres keywords dynamic manoeuvres unsteady reynolds averaged navier stokes self propulsion overset grid surface vessel abbreviations bfm body force model des detached eddy simulation dof degrees of freedom dpm discretised propeller model ear expanded area ratio of propeller efd experimental fluid dynamics ittc international towing tank conference lcb longitudinal centre of buoyancy lcg longitudinal centre of gravity urans unsteady reynolds averaged navier stokes vcg vertical centre of gravity nomenclature bwl ship waterline beam m cb block coefficient d propeller diameter m fs ship local force n ixx iyy ship moment of inertia kg m2 j propeller advance coefficient kq propeller torque coefficient kt propeller thrust coefficient lpp ship length between perpendiculars m lwl ship waterline length m ms ship local moment nm n propeller rotation speed rps t time s t ship draft m η ship position matrix on the earth fixed reference frame j 1 euler angle transformation matrix v ship linear and angular velocity matrix on the ship local reference frame us ship advance speed m s 1 introduction manoeuvrability is one of the major considerations when assessing ship hydrodynamic performance for navigational safety and efficiency to ensure its compliance with imo s regulation imo 2002 studying ship s manoeuvring performance during the design stage is indispensable hooft and nienhuis 1994 the manoeuvrability of a surface ship is often determined through standard free running manoeuvres such as turning circle and zig zag tests lewis 1989 these dynamic manoeuvres are commonly carried out by sea trials model tests or numerical simulations where analysis on the ship control characteristics and turning abilities can be performed although full scale manoeuvring sea trials are still the most direct and reliable approach to quantify ship manoeuvrability there are limitations that must be considered for example the trials can only be conducted after the ship is constructed and in an uncontrolled environment crane 1979 performed manoeuvring trials on a typical vlcc in both shallow medium and deep waters the data gathered are regarded as a source of validation and is referenced in many recent works such as delefortrie and vantorre 2007 toxopeus 2011 a widely adopted method of investigating ship manoeuvrability during the design stage is scale model testing this could involve using a horizontal planar motion mechanism to conduct a series of quasi static measurements under prescribed captive motions kim et al 2007 simonsen et al 2012 or dynamically varying rudder deflections on a self propelled model to achieve turning and zig zag manoeuvres in simman 2008 stern et al 2011 a collection of benchmark ship models were tested under both captive and dynamic manoeuvres by different research institutes the experimental measurements are compared and documented with uncertainty levels which makes them extremely valuable for validation studies an alternative and more cost effective approach of analysing ship manoeuvring performance and its associated fluid structure interaction problems is by numerical simulations which adopts either system based or cfd based techniques the system based method calculates the global and local kinematics of the dynamic manoeuvres by solving truncated mathematical models such as the abkowitz model abkowitz 1964 and the mmg model hirano and takashina 1980 son and nomoto 1982 the hydrodynamic derivatives in these models are usually obtained from captive model scale tests or virtual pmm simulations jin et al 2016 guo and zou 2017 the cfd based method is often based on using urans or urans les hybrid solvers to resolve time domain hydrodynamic loads and motions when a ship is undertaking dynamic manoeuvres such computations require self propulsion moving rudders and are typically performed using full 6 dof capabilities in a free surface environment and are able to provide rich details of flow physics during manoeuvres carrica et al 2013 araki et al 2012 mofidi and carrica 2014 and shen and korpus 2015 all carried out cfd based computations to model dynamic manoeuvres and their results showed good correlation with experimental measurements with analogous approach broglia et al 2015 and dubbioso et al 2016 carried out comprehensive studies on the manoeuvrability of a twin screw vessel for different rudder configurations in order to capture the local dynamics of the ship as well as the closely moving appendages the overset grid technique is commonly adopted in these simulations the ultimate approach to numerically model dynamic manoeuvres is to incorporate fully discretised and rotating propellers dpm appended to the ship geometry which often requires great computational resource and effort an alternative simplified method is to adopt a body force model bfm to represent propeller generated force and induced flow sadat hosseini et al 2014 most of the up to date cfd based dynamic manoeuvring studies were carried out by research groups with their in house codes in the present work the dynamic manoeuvres are performed by the commercial urans solver star ccm using its embedded overset grid function the turning circle and zig zag manoeuvres of a benchmark model dtmb 5415m in calm water are carried out using dpm and bfm propulsion techniques the aim of this paper is to quantify the difference between these two different types of propulsion modelling techniques in terms of computational efficiency and fidelity a verification study is performed for the dynamic maneouvres with body force propulsion but not for the maneouvres with discretised propellers due to high computational cost the computed trajectories of local kinematics of the ship are compared against experimental measurements from marin taken from simman 2008 stern and agdrup 2008 2 ship geometry the dtmb 5415m model geometry was downloaded from simonsen et al 2014 this has been used as a benchmark by the ship hydrodynamic community for many years and extensive experimental data exists the fully appended model with twin split bilge keels roll stabilizer fins twin rudders twin propellers and struts is given in fig 1 the geometrical details of the ship model and its operational condition can be found in table 1 the computed cases presented in this paper include a turning circle manoeuvre at 35 degrees of rudder angle and a 20 20 zig zag manoeuvre in calm deep water 3 computational method the dynamic manoeuvres are carried out using commercial urans solver star ccm the code uses a finite volume discretisation on structured or unstructured grids consisting of arbitrary convex polyhedrals the pressure velocity coupling is solved using a pimple algorithm where its practical implementation is discussed in cd adapco 2014 3 1 urans equations and turbulence modelling the governing equations for the two phase incompressible flow combining air and water are given by the urans equations coupled with the conservation of continuity rusche 2003 1 ρu t ρuu p g x ρ μ u ρτ σ t κ γ γ 2 u 0 here u u v w is the velocity field in cartesian coordinates p represents the pressure including hydrostatic ρ ρ x is the fluid density which varies with the content of air water in the computational cells x x y z are the cartesian coordinates g is the gravitational acceleration and μ is the dynamic molecular viscosity here τ is the reynolds stress tensor 3 τ 2 ρ μ t c 2 3 ki where μ t is the dynamic eddy viscosity 1 2 t is the fluid strain rate tensor and k is the turbulent kinetic energy per unit mass is the gradient operator x y z i is the identity matrix the last term in equation 1 represents surface tension where σ t is the surface tension coefficient which is 0 074 kg s2 between air and water at 20 c and κ γ is the surface curvature jacobsen et al 2012 the above equations are solved for air and water simultaneously where the fluids are tracked using the volume of fraction γ with the value of 0 for air and 1 for water and any intermediate value is a mixture of the two fluids the distribution of γ is modelled by an advection equation 4 γ t uγ u r γ 1 γ 0 the last term on the left hand side is a compression term which limits the smearing of the interface and u r is the relative velocity vector using γ the spatial variation in fluid properties such as ρ and μ can be derived through weighting 5 ρ γρ water 1 γ ρ air 6 μ γμ water 1 γ μ air the closure of the urans equations is achieved using the k ω shear stress transport turbulence model on the basis of the description by menter 1994 and wilcox 2008 3 2 computational domain boundary conditions and grid the computational domain is designed following the ittc practical guidelines for ship cfd applications ittc 2014 to avoid blockage effect and wave reflections the mass centre of the ship is located at an initial position of 0 0 0 in the earth fixed reference frame a schematic drawing of the computed fluid domain is given in fig 2 a a velocity inlet boundary condition is applied at the upstream end of the fluid domain where the inflow velocity is set to be zero at the downstream end of the fluid domain a damping pressure outlet boundary is imposed to prevent wave reflections the top bottom and side walls of the domain are all selected as velocity inlets to avoid velocity gradient occurring from the boundaries slow cell growth rate is selected to create smooth mesh transition between the refined hull surfaces and the overset boundaries hexahedral trimmer and surface remesher are adopted to generate global volume mesh as well as local refinements to resolve the turbulent boundary layer all y wall treatment is utilised as well as the prism layer mesh achieving minimum y value of 30 along the hull for all computations at the free surface anisotropic trimmer refinement is applied in the vicinity of the ship hull to capture the kelvin wave generated during the dynamic maneouvres a summary of the number of grids for each computational case is shown in table 2 the time step resolution is selected according to star ccm practice for ship resistance modelling for computations adopting the body force propulsion method the courant number is kept at around 1 with respect to the hull surface grid size details of the grid and time step independence study are presented in a later section on the other hand the time step for the manoeuvres with discretised propeller is chosen based on the propeller rotation rate to achieve a courant number of around 1 at the blade tip 3 3 ship motion and overset grid assembling the motions of the ship are simulated by the dynamic fluid body interaction module integrated in the 6 dof motion solver two reference frames are involved in solving the motion equations which are denoted as the ship local and earth fixed reference frames in fig 1 the linear and angular velocities v equation 8 on the ship local reference frame are related to the spatial positions and rotations η equation 7 on the earth fixed reference frame through equation 9 7 η x y z ϕ 8 v u v w p 9 v j 1 η where j is the euler angle transformation matrix fossen 1994 v is calculated through the integration of linear and angular accelerations in the ship local reference frame computed from equation 10 10 u x s m vr wq x g q 2 r 2 y g pq r z g pr q v y s m wp ur y g r 2 p 2 z g qr p x g qp r w z s m uq vp z g p 2 q 2 x g rp q y g rp p p 1 i xx k s i zz i yy qr m y g w uq vp z g v wp ur q 1 i yy m s i xx i zz rp m z g u vr wq x g w up vp r 1 i zz n s i yy i xx pq m x g v wp ur y g u vr wq where m is the mass of the ship x g x g y g z g is the distance vector from the centre of rotation to the centre of gravity and i i xx i yy i zz is the moment of inertia around the centre of rotation it is assumed the centre of rotation aligns with centre of gravity during the dynamic maneouvres shen et al 2015 the ship local forces and moments in equation 10 f s x s y s z s and m s k s m s n s are computed by applying the euler angle transformation matrix j 1 on the hydrodynamic and gravitational loads in the earth fixed reference frame which are integration of pressure on the fully appended ship hull including rudders and propellers a hierarchy of overset regions is included in the computation of 6 dof dynamic manoeuvres the background domain is superimposed with the linear and angular velocities of the ship s surge sway and yaw motion which enables a relative static position between the overset and background grids the propeller and rudder overset regions are defined within the ship local reference frame and act as children objects to the ship overset body and move together with it the strategy to compute the angular motion of rudders depends on the type of manoeuvres required for the turning circle manoeuvre the rudders are fixed at zero degree angle until the ship reaches a constant speed and then they deflect to a prescribed angle allowing the ship to carry out the manoeuvring motion after approximately two turning circles the rudders deflect back to their original position enabling the ship s pull out to compute the zig zag manoeuvre the rudder angle is governed by a field function referring to the yaw angle of the ship 4 propulsion modelling the ship model is self propelled at model scale propulsion point by two different numerical techniques for the dynamic manoeuvres the body force model and the discretised propeller model the angular velocity of the propellers is adjusted manually until the vessel achieves the target froude number of 0 41 the propeller rotation speed is maintained to be constant throughout individual manoeuvres 4 1 body force propeller model bfm the body force propeller model applies the actuator disk concept to account for the presence of the propellers a field of body forces are distributed over the cylindrical virtual disk and varies in its radial direction following the goldstein optimum the distributed axial and tangential body forces are used to simulate the acceleration and the increase in swirl that the flow undergoes when passing through the propeller computations adopt similar method to drive dynamic manoeuvres can be found in broglia et al 2013 and dubbioso et al 2017 it is worth mentioning that the body forces are computed from the thrust and torque coefficients k t and k q of the propeller these two variables are depended of the advance coefficient j u s nd where u s is the velocity at the inflow plane of the virtual disks n is the angular velocity of the propellers in rps and d is the propeller diameter the open water performance curve of the adopted marin propeller no 4058 simonsen et al 2014 is given as a polynomial function in equation 11 where the coefficients are tabulated in table 3 11 k t or k q a bj cj 2 dj 3 ej 4 fj 5 4 2 discretised propeller model dpm the discretised approach adopts an overset grid to simulate the rotation of propellers the hydrodynamic loads acting on the propeller blades are treated as external forces in the 6 dof motion equations to solve the dynamics for the ship overset domain to validate the feasibility of the discretised propeller modelling several open water simulations are performed prior to the dynamic manoeuvre computations the numerical domain comprised a propeller overset region and a background region as shown in fig 3 the inlet of the background region is given different uniform inflow velocities to simulate varying advance coefficients for the propeller a prescribed angular velocity corresponding to that in the dynamic manoeuvres is applied on the propeller overset region to mimic the rotation of the blades the grid size on the propeller is set to be the same as it is in the dynamic manoeuvres meanwhile the computations are carried out at an equivalent courant number fig 4 shows the vortical structures in the vicinity of the propeller operating at different inflow velocities the tip vortices are clearly resolved where a thick vortex ring forms outside of the tip vortices as the inflow velocity is reduced although the vortex pairing phenomenon mentioned in carrica et al 2010 is not captured considering the use of a relatively coarse grid for the purpose of generating global propulsion force the limitation of the urans method in turbulence modelling the presented discretised propeller model is deemed acceptable fig 5 presents the open water performance curve predicted from the discretised propeller model against benchmark data from marin the good agreement with experimental data demonstrates that this approach is feasible to propel the ship model for the dynamic manoeuvres 5 verification and validation prior to performing computations on the dynamic manoeuvres it is essential to verify and validate the present computational approach due to its better computational efficiency the turning circle manoeuvre with the body force propeller model is selected as the base case for conducting the verification and validation study 5 1 numerical uncertainty firstly the verification study is performed to estimate the numerical uncertainties within our simulations following the procedures by stern et al 2001 and wilson et al 2001 it is assumed that the numerical uncertainty u sn comprises iterative convergence uncertainty u i grid spacing uncertainty u g and time step uncertainty u t giving the following expression 12 u sn 2 u i 2 u g 2 u t 2 tezdogan et al 2015 estimated the iterative convergence uncertainty in the predictions of motion responses for a container ship using the star ccm urans solver their analysis indicated u i to be less than 0 50 in simulation results which is considered to be negligible since similar computational settings are applied grid and time step uncertainties are of primary interest in the present study the grid and time step convergence study are both conducted with triple solutions systematically the grid uncertainty analysis is performed with the smallest time step whilst the time step independence study is carried out with the finest mesh the details of the grid and time step adopted in the verification study are presented in table 4 referring to simonsen et al 2012 and jin et al 2018 the grid uncertainty of unstructured trimmer mesh can also be estimated based on richardson s extrapolation variations of simulation results s between the fine sg1 medium sg2 and coarse sg3 grids with refinement ratio of r g 2 are identified as 13 ε g 21 s 2 s 1 14 ε g 32 s 3 s 2 the numerical convergence ratio r g can be calculated from equation 15 15 r g ε g 21 ε g 32 depending on the value of the convergence ratio four conditions can be predicted i 0 r g 1 monotonic convergence mc ii r g 0 r g 1 oscillatory convergence oc iii 1 r g monotonic divergence md iv r g 0 r g 1 oscillatory divergence od it is noted that for divergence conditions iii and iv the numerical uncertainty cannot be estimated for the oscillatory convergence ii the numerical uncertainty can be estimated by bounding the error based on oscillation with upper limit s u and lower limit s l using equation 16 16 u g 1 2 s u s l for convergence condition i the generalized richardson extrapolation can be employed to estimate the numerical error δ re g 1 and order of accuracy p g as 17 δ re g 1 ε g 21 r g p g 1 18 p g ln ε g 32 ε g 21 ln r g there are two ways to estimate the numerical uncertainty depending on whether the solutions are close to the asymptotic range this is determined by the correction factor c g defined as 19 c g r g p g 1 r g p gest 1 where p gest is an estimate for the limiting order of accuracy if c g approaches unity the solutions are close to the asymptotic range in this case the numerical error δ sn benchmark result s c and uncertainty u g can be estimated from 20 δ sn c g δ re g 1 21 s c s δ sn 22 u g 2 4 1 c g 2 0 1 δ re g 1 1 c g δ re g 1 1 c g 0 125 1 c g 0 125 when c g is sufficiently greater than 1 which means the solutions are far away from the asymptotic range the numerical uncertainty u g can be calculated from equation 19 23 u g 9 6 1 c g 2 1 1 δ re g 1 2 1 c g 1 δ re g 1 1 c g 0 125 1 c g 0 125 based on similar procedures the time step uncertainty u t can be estimated with refinement ratio r t 2 a summary of the grid and time step uncertainties for the urans computations are listed in table 5 and table 6 overall the present computation gives relatively small numerical uncertainties and correlates well to the experimental data stern and agdrup 2008 demonstrating its feasibility for undertaking further systematic simulations 5 2 validation against experimental data to validate the presented computations it is necessary to check if the absolute comparison error e between numerical and experimental results carrica et al 2010 is less than the validation uncertainty u v shown in equation 24 calculated as a combination of numerical uncertainty u sn and experimental uncertainty u d 24 u v u sn 2 u d 2 comparisons between e and u v for the turning circle manoeuvre results from the present computation are given in table 7 in order to quantify the validation uncertainty it is necessary to know the uncertainty of the experimental data this is not provided by the literature therefore the experimental uncertainties u d are approximated as 5 00 it is observed the numerical uncertainties for all investigated parameters are below 15 0 the validation uncertainties are greater than the comparison error indicating the urans model is validated 4 results and discussion before executing the dynamic manoeuvres the propeller speed is tuned until the model is able to reach the speed of 2 59 m s corresponding to a froude number of 0 41 at self propulsion stage then the selected propeller speed is kept constant throughout the manoeuvres a summary of run cases is listed in table 8 4 1 turning circle manoeuvre fig 6 a shows trajectories of the computed starboard turning circle manoeuvre with 35 rudder deflection at an approaching speed corresponding to fr 0 41 cases 1 and 2 comparison is made against experimental results from stern and agdrup 2008 and numerical data presented in carrica et al 2013 the predicted tactical diameter agrees well with the experimental data for both bfm and dpm propulsion methods the comparison errors are less than 3 00 as quantified in table 9 fig 6 b depicts the prediction of yaw rate histories for the turning circle manoeuvre the tendency and magnitude of the urans computed results match well with the experimental data at t 5s the rudders deflect to starboard with an angular speed of 53 6 s meanwhile the vessel starts to yaw to the starboard side and reaches a steady yaw rate at approximately t 10s to pull out the vessel from the dynamic manoeuvre the rudders are returned back to their original position with the same angular speed it is worth mentioning here that there is a difference in the pull out time point between the presented urans computations and the results from literature consequently this leads to the computed yaw rate and the data gathered from the literature to decline at different instantaneous time points t 37 s and t 40 s a comparison of the maximum yaw rate between the numerical and experimental data is presented in table 9 the difference between numerical and experimental results for both bfm and dpm propulsion methods are below 10 0 the time histories of roll motion from urans computations and experiment are presented in fig 6 c at the beginning of the turning circle manoeuvre when the positive starboard rudder rotation is imposed a positive roll excursion into the portside of the vessel occurs oscillates and then decays to a roll angle of relatively static signature at about t 6s a maximum positive roll angle of almost 12 appears due to the dominant rudder moment induced by high speed and large angle rudder deflections when the vessel reaches the steady turning phase at about t 14s the roll angle becomes negative and is towards the port side indicating the centrifugal and hull hydrodynamic roll moment overcome the rudder moment at the end of the turning circle manoeuvre negative rudder rotation is applied to the vessel where the rudder moment adds up to the centrifugal and hull hydrodynamic roll moment producing a large instantaneous roll motion of nearly 13 this roll motion continues to oscillate for about 5s and decays to zero magnitude when predicting roll motion the urans predictions exhibit less fluctuation compared to the experimental data the dpm propulsion model seems to produce the best estimation of the static roll motion during the manoeuvre where the bfm model in this study over predicts this quantity this can be explained from the difference in the lateral rudder force between the bfm and dpm methods shown in fig 6 d the dpm produces an inflow velocity of greater magnitude to the rudders comparing to the bfm approach as shown in fig 7 this leads to greater stagnation pressure on the foreside of the rudder and therefore a more significant pressure difference between the forward side and back side of the rudders as shown in fig 8 consequently the rudders after the discretised propeller experience more significant hydrodynamic load which produces greater positive restoring roll moment to balance out the centrifugal and hull hydrodynamic roll moment during the steady turning phase quantitative comparison between urans and experimental data on the peak roll motions is given in table 9 the comparison errors of both bfm and dpm approaches are less than 13 0 fig 9 depicts the interaction of vortices between the rudders and propellers from the dpm computation at the rudder angle of 0 the rotation of discretised propellers generates noticeable circular tip vortices and strong hub vortices passing the rudders for the rudder angle of 35 the hub vortices are jeopardised and form a larger size vortical structure reduction in the flow velocity is observed in fig 9 b which is caused by ship speed loss from the rudder action fig 10 summarises the computed free surface elevation at different time points during the turning circle manoeuvre the kelvin wave patterns are well captured after the vessel the bow and stern waves are both very steep and gird refinements are recommended at these regions for resolving possible breaking 4 2 zig zag manoeuvre fig 11 presents the computed 20 20 zig zag manoeuvre at the approaching speed corresponds to fr 0 41 cases 3 and 4 comparison is made against experimental data and numerical results from literature during the first cycle defined as the time between the initial rudder execution to portside to the following zero crossing moving to portside again there are small discrepancies in terms of yaw angle and rudder period as given in table 10 the comparison errors of both bfm and dpm computations are well below 10 for the second cycle a similar level of accuracy from urans computations can be found for the rudder and yaw angle as the zig zag manoeuvre progresses time lag starts to appear in the rudder and yaw angle results from urans bfm approach when comparing to experimental and urans dpm results this is primarily due to under predicted rudder loads in the simplistic wake flow after the body force propeller model which is evident from fig 6 d combining fig 11 a and b it is found that the heading overshoot in cfd models is generally greater than the experiment this may be due to insufficient rudder moment or yaw damping as stated in carrica et al 2010 as shown in table 10 the comparison errors for the overshoot angle during the first and second cycle are around 10 0 in terms of yaw rate cfd and experimental data show excellent correlation the comparison errors for both urans bfm and dpm during the first two cycles are below 5 00 notice that the rate of change in the time series yaw rate is very close to the experimental data suggesting the numerical model responds well to the rudder action again the progressively increasing time lag observed in the urans bfm results indicates slightly under estimated rudder force the roll angle given in fig 11 d shows relatively greater discrepancies between urans predictions and experimental data referring to table 10 the urans dpm method tends to over predict the maximum roll amplitude by 11 95 and 13 34 during the first and second cycle respectively the bfm computation gives better predictions on the magnitude of this parameter but it possesses greater time lag along the progress of the zig zag manoeuvre all urans computations seem to over predict the magnitude of the maximum roll angle when comparing against experiment this demonstrates that the cfd computations tend to under predict the roll damping and this could possibly due to relatively coarse grid in the transverse direction near the hull nonetheless both urans bfm and dpm methods provide satisfactory engineering solutions fig 12 summarises the computed free surface elevation at different time points during the zigzag manoeuvre similar to the turning circle case the kelvin wave patterns around the vessel are well resolved indicating steep bow and stern waves from fig 12 a to b the vessel continues to yaw to the starboard side due to constant positive rudder action at around t 11 5s the rudders begin to deflect from starboard side 20 to the portside 20 and the yaw rate in the negative direction reaches its maximum as a result of changing rudder angle the yaw rate of the vessel starts to change its bow direction to the portside positive the magnitude of the yaw angle in the bow to starboard negative direction starts to decline and approaches zero at about t 15s and then climbs and reaches its maximum in the positive direction at about t 18s shown in fig 12 c when the yaw angle approaches 20 once more the rudder deflects again the vessel starts yawing back into the starboard direction and reaches a maximum yaw angle at t 24s in fig 12 d this process repeats again and again during the zig zag manoeuvre 4 3 computational efficiency table 11 presents the computational cost for each of the studied dynamic manoeuvres it is observed that the computations with dpm require much greater cpu power compared to the bfm approach this is primarily due to the demand of a much smaller time step to resolve the angular motion of the propeller overset grids despite the difference in computational time the accuracies of dpm and bfm approaches are close and commendable tables 9 and 10 therefore it is observed that for applications solely focused on the vessel global trajectories the bfm method is a valid option to model the dynamic manoeuvres considering the accuracy and rapid computational time for problems that require high fidelity fluid physics after the propellers for example to capture propeller rudder interactions the dpm method is still needed 5 concluding remarks urans methods have been extensively adopted and validated for predicting steady and quasi static ship hydrodynamic applications including resistance and virtual planar motions and to some extent for unsteady problems such as seakeeping jin et al 2017 highly coupled and dynamic computations such as the ship free running manoeuvres in calm water and waves still pose a challenge and require detailed verification this paper presents urans computations of dtmb 5415m undergoing self propelled turning circle and zig zag manoeuvres using commercial solver star ccm two different propulsion techniques the body force and the discretised propeller models are investigated where the results are compared with benchmark experimental and numerical data from simman 2008 by analysing the computed dynamic manoeuvres the following conclusions can be drawn urans approach together with overset grid technique is a feasible technique to model the fully dynamic surface vessel free running manoeuvres both bfm and dpm propulsion methods are practical for driving free running manoeuvres considering the good correlation between computed results and the experimental data the computed turning circle manoeuvre with bfm propulsion tends to under predict the lateral rudder force in the steady phase of turn which leads to over estimation of the ship roll motion the bfm method exhibits more merits in terms of rapid computational time while the dpm is more advantageous in resolving high fidelity flow physics near the propeller and rudder regions future work includes full scale computations and modelling dynamic manoeuvres in wave environments the free running results will also be subjected to system identification process to quantify manoeuvring coefficients leading to more robust system based manoeuvring model for control applications acknowledgement the authors acknowledge the financial support provided by the australian maritime college university of tasmania on the present work computations were performed on the kunanyi cluster funded by the tasmanian partnership for advanced computing tpac program 
