index,text
22760,a system for motion planning collision avoidance guidance and control of an autonomous surface vehicles formation navigating in complex marine environment is presented the motion planning unit which is based in angle guidance fast marching square method is specially developed for operation in dynamic and static environments the collision avoidance unit is based in fuzzy logic formulation the guidance unit uses the vector field guidance formulation and the control unit is composed by a pid heading controller and a speed controller the leader follower s configuration is used for cooperative operation a set of numerical simulations are carried out for a team of three autonomous surface vehicles navigating in a complex maritime environment including static and dynamic obstacles and the results show good performance of the system keywords autonomous surface vehicles cooperative algorithm fast marching method collision avoidance vector field guidance 1 introduction in the last decade with the increasing number successful projects in asvs there is a larger interest in the application of this concept in the maritime industry this refers to the application of the concept of unmanned navigation involving the reduction of crew on board vessels with the ultimate goal in mind of a ship carrying out its functions without man on board in the long run in this scenario rolls royce 2014 has announced that remotely controlled local ships are expected in 2020 furthermore seagoing vessels for marine transportation in 2030 these remotely operated ships have as objective increase the safety in sea operations optimize fuel consumption and renovate the work roles in the marine field in the navy field darpa defense advanced research project agency has developed a trimaran unmanned vehicle called sea hunter built as part of its actuv anti submarine warfare continuous trail unmanned vessel program and this autonomous vessel began sea trials in april of 2015 sea hunter is a 40 m long trimaran manufactured in the silicon forest of portland oregon njus 2016 it is an autonomous vehicle power driven by two diesel engines with a maximum speed of 27 knots it is planned that in a near future this kind of marine vehicles may be armed and used for anti submarine and countermine duties operating at a minor fraction of the operating cost of a destroyer recently the world s first autonomous cargo vessel yara birkeland was announced the unmanned vessel is expected to navigate in the norwegian fjords and is projected for fully autonomous operation by 2020 kongsberg maritime 2017 this will be a giant achievement for maritime transportation and will begin a new era for unmanned marine vehicles however there are still various challenges related to these operations and this work aims to contribute solving some of these problems on the other hand ports and specialized terminals have had significant developments in recent years in electronics sensors and actuators automation and information technologies which makes feasible the construction of fully automatized terminals thus the rotterdam s port is operating a fully automatized container terminal using automated guided vehicles and automatized yard cranes to handle container units liu et al 2002 likewise the ports of singapore and of hamburg have been investigating similar ideas thus is easy to understand the good synergy of these technologies and unmanned navigation for the maritime transport in the near future other example is the small scale family of autonomous surface vehicles which includes a variety of sizes and types for example the autonomous surface fishing trawler artemis developed by mit sea grant college program and the catamaran delfim autonomous surface craft built in portugal in 2006 these prototypes of unmanned ships have successfully tested in open sea missions this kind of asvs incorporates colregs rules and regulations at an elementary level for head on encounter situations at the same time as keeping wi fi communication benjamin and curcio 2004 moreira and guedes soares 2011 performed successfully model tests using a scaled ship model of the tanker esso osaka which was instrumented for autonomous operation and different guidance and control approaches perera et al 2015 ferrari et al 2015 hinostroza et al 2017 and xu et al 2018 have conducted model tests with an autonomous surface vehicle 2 5 m long for intelligent navigation and collision avoidance manoeuvring tests and system identification respectively one popular challenge in this field involves the cooperative operation of one or more asvs to create a broadcast network with wi fi communication the benefits of using a team of asvs includes a large mission area improved system robustness reducing system cost and providing redundancy against individual failure and increased fault tolerant resilience liu and bucknall 2016 during the cooperative operation of asvs team the collision avoidance module has a crucial role therefore fuzzy logic based control systems for automatic collision avoidance system in vessel are a very promising option this kind of systems has been developed several decades ago hasegawa 1987 however those approaches in general ignore the rules and regulations proposed by the international maritime organization imo in 1972 sato and ishii 1998 statheros et al 2008 nonetheless in recent literature new formulations including colregs rules and regulation were addressed perera et al 2011 2012 zhang et al 2015 he et al 2017 in this approach the conjunction of human conduct and the decision making process has been formulated by several fuzzy member functions this paper proposes a full navigation system for cooperative operation of a asvs fleet in complex marine environment including static environment and dynamic obstacles the system is composed by motion planning collision avoidance guidance and control modules the motion planning algorithm is based in a fast marching method that computes the optimal trajectories for asv formation from a real marine environment the collision avoidance unit is fuzzy logic based including colregs rules and regulations the guidance unit of each individual asv is based in vector field guidance algorithm and the controller unit is composed by a pid heading and feedback speed controllers fig 1 presents a block diagram of the integrated system for cooperative operation of asvs fleet the structure consists of four modules i e task motion planning fast marching algorithm collision avoidance fuzzy logic based algorithm trajectory tracking vector field guidance and controller heading and speed controller the organization of the paper is as follows section 2 presents the mathematical formulation of the integrated system including a detailed description of each individual module section 3 presents numerical simulations to study the performance of the motion planning and collision avoidance system for formation asvs in a complex environment section 4 addressed a case study of the system for a ship traffic in the estuary of tagus river estuary including static and dynamic obstacles finally some conclusions are drawn in section 5 1 1 motion planning guidance and control formulation in this section the mathematical formulation of the angle guidance fast marching square algorithm for motion planning fuzzy logic based collision avoidance vector field guidance and control modules for cooperative operation of asv fleet shown in fig 1 are described in brief the cooperative algorithm block is where the formation strategy is defined by a formation shape of the asvs team the angle guidance fast marching method block is where the desired path of the leader and followers asvs is calculated the collision avoidance block ensures the safe navigation and the guidance and control blocks is where the trajectory tracking is performed based in a desired heading and speed 1 2 motion planning algorithm the motion planning algorithm used herein is an extension of the angle guidance fast marching square method afms this extended afms formulation is based in the classic fast marching method fmm proposed by sethian 1996 to solve the eikonal equation the improvements of afms method with respect to fmm are the inclusion of the ship heading angle and the safety margin potential map both formulations are presented in detail in liu and bucknall 2016 the present formulation has as starting point the afms formulation but modifications are included to allow the integration of collision avoidance trajectory tracking and controller units the fast marching method which was first addressed by sethian 1996 solves iteratively the eikonal equation in order to simulate the boundary propagation the eikonal equation has the formula 1 t x y v x y 1 where t x y is the boundary arrival time at point x y and v x y is the interface propagating speed in fig 2 consider that x y is the grid point where t x y needs to be calculated the neighbor of x y is a set of grid points with four elements x δ x y x δ x y x y δ y and x y δ y t x y can be calculated as 2 t 1 min t x δ x y t x δ x y t 2 min t x y δ y t x y δ y 3 t x y t x y t 1 δ x 2 t x y t 2 δ y 2 4 t x y t 1 δ x 2 t x y t 2 δ y 2 1 v x y 2 where δ x δ y are the spacing of the grid in the x and y coordinates the solution of equation 4 is given by 5 t x y t 1 1 v x y if t 2 t t 1 t 2 1 v x y if t 1 t t 2 quadratic solution of eq 4 the fast marching method follows the fundamentals of dijikstra 1959 technique but in place of using the traditional rectilinear distance metric it employs equation 5 to update the function cost which quantifies the distance in euclidean metric consequently compared with dijisktra the result generated by the fmm is more continuous the grid points present four neighboring points because the grid map has 4 connectivity points the dimension of the grid are δ x and δ y in the x and y directions respectively as presented in liu and bucknall 2016 table 1 shows as an example the specific fast marching method fmm algorithm by simulating an interface propagation process over a grid map the angle guidance fast marching square method afms is an extension of the classical fmm which incorporates the initial ship heading angle which is described in detail in liu and bucknall 2016 it uses as the base the fast marching method fmm proposed by garrido et al 2011 and ávares et al 2015 to make the generated path more realistic with the asv motion constraints the core of the afms method defines a guidance range in the grid planning space the shape of the guidance range is defined as a circle with a radius calculated from ship turning capabilities vehicle s yaw constraint fig 2 presents a simple application of the fast marching method and a more complex application of the angle guidance fast marching square method from the plots it is possible to identify the advantage of the use of angle guidance fast marching square method compared with fmm both methodologies estimate a smooth trajectory however in the case of fast marching method the path does not consider the initial heading angle and pass very close to the obstacles 1 2 1 asvs formation architecture in this subsection the chosen strategy for asvs formation is presented and a description of each control layer is addressed fig 3 presents the leader follower architecture adopted herein in this architecture the asvs formation algorithm can be divided in three layers i e physical layer individual layer and coordination layer the coordination layer is divided in local and network sub layers being the local layer where the follower leader communication is established by sending their position and speed to the leader asv in the network sub layer the leader communicates with the environment and obstacles that is vessel to environment v2e as well as vessel to vessel v2v the environmental information map grid data and position of obstacles can be obtained from automatic identification system ais or estimated from on board marine radar in addition each asv has an individual dynamic controller to perform trajectory tracking see fig 3 1 2 2 leader follower cooperative algorithm the cooperative motion planning unit computes the desired paths for the leader and followers asvs formation using marine environment grid map static and dynamic obstacles information in this unit the formation shape is also pre defined based on the number of asvs distance between asvs d and formation angle θ in this work the triangular shape will be used fig 4 the procedure is designed based in followers leader formation control schema as presented in liu and bucknall 2016 in this formulation the leader target point is defined as the asv formation target which is beforehand defined and remains unaltered during the task execution while followers desired target position is recomputed during each time step operation according to follower leader formation shape the trajectories for the followers are calculated from the leader s path as was using the algorithm proposed in alvares et al 2015 which can compliantly produce the sub targets according to environment modifications static or dynamic obstacles and makes the shape of the asv formation deformable based on the follower leader scheme each follower s sub target is re computed by referring to the desired angle of formation θ and the formation distance d 12 d 13 between the follower and leader as presented in fig 4 the angle of formation θ determines the desired angle between the follower and the leader while the formation distance represents the desired distance that the follower asv wants to preserve with respect to the leader θ and d 12 can be combined to have the desired formation configuration vector see fig 5 6 d l f 1 d 12 cos θ n i d 12 sin θ m j d l f 2 d 13 cos θ n i d 13 sin θ m j in equation 6 n i m j are the unitary vectors with respect to the heading angle ψ of leader asv d l f 1 and d l f 2 are the vector from the leader s origin to the follower s origin respectively is important to mention that the unitary vectors and the origin of the asv formation s frame can be computed from the absolute frame of reference see fig 5 using the leader heading angle given that the desired distance is represented by d 12 d 13 for a formation with triangular shape sub target points can be obtained as 7 x f o l l o w e r 1 x l e a d e r d 12 cos θ y f o l l o w e r 1 y l e a d e r d 12 sin θ 8 x f o l l o w e r 2 x l e a d e r d 13 cos θ y f o l l o w e r 2 y l e a d e r d 13 sin θ however according to equations 7 8 the shape of the formation cannot be altered however the safety map m s computed by the fast marching method has good capabilities for representing local information in the m s map each grid point has values in the limits from 0 to 1 where the value 1 represents collision free space and 0 represents obstacle space that value can be employed as a deformation parameter b to specify how much the formation shape needs to change therefore the new sub targets generation formulas are 9 b 1 m s x f o l l o w e r 1 y f o l l o w e r 1 b 2 m s x f o l l o w e r 2 y f o l l o w e r 2 10 x f o l l o w e r 1 x l e a d e r d 12 cos θ y f o l l o w e r 1 y l e a d e r d 12 sin θ b 1 x f o l l o w e r 2 x l e a d e r k b 2 d 13 cos θ y f o l l o w e r 2 y l e a d e r d 13 sin θ b 2 where the function m s x y yields the value at point x y in m s b 1 and b 2 are the deformation parameters governing the coordinates of sub targets of asv followers the values of deformation parameters are the same as in the map m s at x f o l l o w e r 1 y f o l l o w e r 1 and x f o l l o w e r 2 y f o l l o w e r 2 it could be observed that as distances between obstacles and followers become smaller the values of the deformation parameters b 1 or b 2 will be closer to 0 which decreases the distance values in the y axis attracting follower vessel to stay closer to each other parameter k is a constraint indicating the priority of each vessel follower fig 5 also shows the elliptical formation domain which is used to define a safety region and it is necessary to compute the collision risk presented in next section 2 2 this safety region is controlled by the parameters l i i 1 2 3 which depend on leader and follower s location thus the semi axis of the ellipse is computed as 11 a e l 1 l 3 l d 2 b e l 2 2 where a e is the half of major axis b e is the half of minor axis and l d max d 12 cos θ d 13 cos θ in this study the following values were assumed l 1 l 3 l d and l 2 2 max d 12 sin θ d 13 sin θ 1 3 fuzzy logic based collision avoidance formulation the fuzzy logic collision avoidance unit is composed by two blocks i e collision detection and the fuzzy logic algorithm the collision detection block uses the distance and time to the closest point of approach between vessels to detect potential conflicts using colregs rules and regulation the fuzzy logic block uses linguistic variables to characterize encounter situation between the asvs team and a dynamic obstacle target ship then using fuzzy rules compute changes in heading and speed in order to avoid collision notice that the collision avoidance algorithm is based in the work proposed by perera et al 2011 2012 however this paper includes a collision detection module see fig 1 an iterative collision situation fuzzy membership function in order to reduce the number of fuzzy rules and includes a new fuzzy membership function based in fast marching method 1 3 1 colregs rules and regulations the colregs rules and regulation imo 1972 include thirty eight rules which are divided in five parts general rules in part a steering and sailing in part b lights and shapes in part c sound and light signals in part d and some exemptions in part e in the present work the part b of colregs regarding to steering and sailing rules are contemplated as was mentioned in section 1 the colregs rules and regulations concerning collision situations in maritime traffic have been neglect in most of the recent publications this negligence of the colregs rules might lead to collisions in sea navigation thus five sixths of major maritime collisions include violations of the colregs rules and regulations perera et al 2011 consequently the systems addressed by the literature ignoring the colregs rules and regulations must not be implemented in maritime traffic also there are some practical issues regarding applications of the colregs rules and regulations in maritime transportation fig 6 presents the typical collision situations between ships in ocean navigation head on overtake situations and crossing fig 6 also shows the colregs rules and regulation to solve the potential conflict 1 3 2 collision avoidance algorithm the collision detection module is responsible to determine if there is a potential conflict in route as shown in fig 7 where 2 vessels have a potential collision in a point at the desired trajectory to successfully remove the collision situation it is necessary to compute the distance to the closest point of approach dcpa and the time to the closest point of approach tcpa as shown in fig 7 vessel 1 is travelling with the speed v1 and vessel 2 has the speed of v2 v12 is the relative speed of vessel 1 with respect to vessel 2 d is the separation between 2 vessels and γ is gamma is the angle between the relative motion line and line d the fuzzy logic collision avoidance unit is responsible to compute the desired heading and velocity of own vessel in order to avoid potential conflicts in a desired trajectory this study uses the mamdani formulation mamdani and assilian 1975 fig 8 presents a relative collision situation in maritime traffic which is analogous to a radar plot the own vessel ocean domain centered around the virtual center of formation of the asvs is defined by two regions the elliptical safety domain formation and the circumference entailed by the distance to the target vessel the formation asvs region of collision are split into 8 regions labeled from i to viii these polar regions are similar with the collision regions formulated in the fuzzy membership function fmf as in perera et al 2011 it is intended that the target ship will be positioned inside one of these 8 regions and the decisions for collision avoidance are formulated in accordance to each individual region the target ship possible orientations have been split into eight divisions of vessel heading regarding the relative course i e for a target ship in region ii ii a ii b ii c ii d ii e ii f ii g and ii h these partitions are divided by dotted lines which are coincident with the relative collision angle fuzzy membership function tables 2 and 3 present the list of fuzzy logic rules and decisions of the asvs formation and a target vessel in collision situations as presented in fig 8 the first column denotes the collision regions with respect to the own vessel the second column denotes the divisions of the target ship headings the third column ψ r e l represents relative collision angle the fourth column represents the value of potential map m s x y and using these inputs is possible to assess the collision risk with respect to each of the collision situation depending on the degree of risk the correction actions in order to avoid collision are presented in columns fifth and sixth taking into account the colregs rules and regulations in this table n a means no action in the formulation of the collision avoidance unit based in fuzzy logic algorithm the definition of fuzzy membership functions are decisive this fmf describes fuzzy sets which are obtained from one given universe of discourse to a unit interval this function is formally and conceptually different from the fundamental concept of probability pedrycz and gomide 2007 the core of the fuzzy set is defined as the set of all elements of the universe that are associated with the membership value from 0 to 1 the support of the fmfs are defined as the set of all elements of x that have nonzero membership degree the fmf for inputs collision region division relative collision angle ψ r and decision for heading δ ψ and variation of speed are presented in fig 9 the core and support variables are listed on the respective figures of inputs and outputs fmfs in this work the relative collision angle ψ r fmf is represented by three sub regions v1 v2 v3 this fmf change its values in each iteration according to the relative region of the target vessel in fig 9 for example the plot is for region ii θ 0 fig 10 presents the fmf for the potential map m s x y this fmf is obtained from the potential map generated with fast marching method this fmf is divided in three sub regions i e dangerous medium and safe this region needs to be calibrated and section 3 presents simulations to determine parameters as a summary a flow chart of cooperative operation of asv team in a marine complex environment including the motion planning collision avoidance guidance and control algorithm is presented in fig 11 the algorithm implements follower leader formation strategy along an online path planning in a complex environment including dynamic and static obstacles at the beginning of the algorithm the asv formation shape is defined and the grid map static and dynamic obstacles and target vessel are read next using the afms methodology the leader path is computed where depending in the complexity of the navigation area the follower s desired trajectories are computed in case of potential collision situations evaluated by the tcpa and dcpa the collision avoidance module computes a desired heading formation in order to avoid a collision situation after the collision situation disappears the process is restarted and a new online path is computed for each asv taking as a starting point the new position of the asv leader 1 3 3 3 dof mathematical model for simulations in order to simulate the 3dof planar ship motions the abkowitz 1980 model is modified in order to make the modelling more flexible and realistic physically in this formulation the effect of current is treated as the principal external disturbance because the ship model has a small above water structure fig 12 presents the coordinate frames for 3dof ship motions as presented in fig 12 u c and α are the magnitude and direction of the current while ψ u and v are the heading surge speed and sway speed of the ship respectively the relative speeds in the presence of current are given by 12 u r u u c cos ψ α v r v u c sin ψ α the time derivatives of u and v are given 13 u u r u c r sin ψ α v v r u c r cos ψ α where the accelerations of the motion in 3 dof surge sway and yaw are given by 14 m x u r u r m v r r m x g r 2 f 1 m y v r v r m x g y r r m u r r f 2 m x g n v r v i z n r r m x g u r r f 3 with m being the mass of the vessel x u r y v r y r n v r n r are the added mass and moment respectively the dimensionless forces are defined as multi variety third order regression polynomials depending on the non dimensional velocities 15 f 1 η 1 u r 2 η 2 n u r η 3 n 2 c r x v r 2 v r 2 x e 2 e 2 x r 2 r 2 x v r r v r r x v r 2 r 2 v r 2 r 2 16 f 2 y 0 y v r v r y δ c c 0 v r y r r y δ 2 c c 0 r y δ δ y r 2 v r r 2 v r y e 3 e 3 17 f 3 n 0 n v r v r n δ c c 0 v r n r r 1 2 n δ c c 0 r n δ δ n r 2 v r r 2 v r n e 3 e 3 where e is the effective rudder angle given by 18 e δ v c r l 2 c detailed information about the formulation can be found in moreira et al 2007 in equations 16 and 17 c is the weighted average flow velocity over the rudder which is evaluated as a sum of 1 ω u r and u a 19 c a p a r 1 ω u r k u a 2 a r a p a r 1 ω 2 u r 2 in which a p is the propeller surface a r is the rudder area ω is the wake fraction u a is the induced axial speed far behind the propeller disk which given by 20 u a 1 w u 1 w 2 u 2 8 π k t n d 2 where k t is the propulsive coefficient d is the propeller diameter in this study the effect of the current in not considered in order to simplify the model 1 4 vector field guidance law to track the predefined trajectory autonomous ships must be capable of following the desired heading angles the vector field guidance law xu and guedes soares 2016 is used to generate a vector field around the predefined path the vectors indicated the desired heading angle as presented in fig 13 if the ships follow the vectors direction it will end up following the path successfully as shown in the fig 13 the solid line between the waypoints is the predefined path the area between the red dashed lines which lie at a distance τ on each side of the path indicates the transition region a vector field around the path is constructed as presented in fig 13 if the distance d is greater than the predefined constant τ it means that the ships are outside the transition region then the guidance laws will force the ship to travel towards the path at a constant desired heading angle χ e which is called entry angle when the vehicle is inside the transition region d τ the desired heading is calculated using eq 21 the rate of transition is controlled by a gain k 1 the vector field guidance is given xu and guedes soares 2016 21 χ d χ f sgn y e χ e if x τ χ f sgn y e y e δ k χ e if x τ where χ d is the desired course angle and is defined as χ d ψ d β ψ d is the desired heading angle β is the sideslip angle which can be measured directly χ f is the angle of the path χ e is the entry course angle when the ship located outside the transition area y e is the cross track error k and δ are the predefined parameters 1 5 pid heading controller 1 5 1 control model nomoto model is widely used to design the autopilot for marine vessels due to its simple structure it was proposed by nomoto et al 1957 by eliminating the sway velocity v from equation 22 from the general dynamics of marine vessel making some assumptions the linearized manoeuvring model 22 m v n u 0 v b δ r where v v r t is the state vector δ r is the rudder angle 23 m m y v m x g y r m x g y v i z n r n u 0 y v m u 0 y r n v m x g u 0 n r b y δ n δ the nomoto transfer function is 24 r δ s k 1 t 3 s 1 t 1 s 1 t 2 s where t i i 1 2 3 are time constants and k is the gain constant a 1st order approximation is obtained by letting the effective time constant be equal to t t 1 t 2 t 3 such that 25 r δ s k 1 t s since r s s ψ s finally 26 ψ δ s k s 1 t s in time domain eq 26 can be rewritten as t ψ ψ k δ as presented in fossen 2011 the nomoto model is only used for low frequencies based on the 1st order nomoto model the pid heading controller is designed and the controller gains are calculated consider the pid controller law 27 τ n τ p i d s k p ψ d ψ k d ψ k i 0 t ψ d ψ τ d τ k p 1 t d s 1 t i s ψ d ψ another simple intuited way to do this is by noticing that δ can be written as fossen 2011 28 δ k p ψ k i ψ d τ k d ψ where τ n is the controller yaw moment k d k p t d and k i k p t i k p 0 k d 0 and k i 0 are the regulator design parameters applying this control law to nomoto 1st order model equation 26 the closed loop characteristic equation is as follows xu and guedes soares 2016 29 t σ 3 1 k k d σ 2 k k p σ k k i 0 according to the routh s stability criterion the controller gains can be calculated using pole placement in the terms of the design parameters ω n and ζ as shown below 30 k p ω n 2 t k 0 k d 2 ζ ω n t 1 k 0 k i ω n 3 t 10 k 0 where ω n is the natural frequency and ζ is the relative damping ratio of the 1st order system in this case ω n 1 rad s and critical damping ζ 1 thus the following controller gains obtained k p 40 93 k d 76 33 and k i 0 05 1 5 2 feedback linearization speed controller the speed controller is based in feedback linearization the basic idea of feedback linearization is to transform the nonlinear systems dynamics into a linear system by cancelling the nonlinear term then conventional control techniques can be applied to the linear system fossen 2011 from moreira et al 2007 the surge model of the ship is given 31 u f 1 m x u r u c r sin ψ α with f 1 thrust u r n f 1 u r v r u v r δ the thrust term and f 1 is given by moreira et al 2007 the commanded acceleration can be calculated through fossen 2011 32 a b u d k p u r u d k i 0 t u r u d d τ thus the speed controller can be computed by 33 τ thrust m x u r u d k p u r u d k i 0 t u r u d d τ u c r sin ψ α f 1 u r v r u v r δ the following controller gains are used for simulations k p 0 15 k i 1 e 5 1 6 catamaran mathematical model a 3dof mathematical model for a catamaran is presented in this subsection this model will be used to simulate the motions of a transtejo ship in section 4 the model is addressed in more detail in sutulo and guedes soares 2005 and ferrari et al 2014 here only a brief overview is described the dynamic equations of motions are 34 m μ 11 u m v r m x g r 2 x h x p r x f m μ 22 v m x g μ 26 r m u r y h y p r y f m x g μ 26 v i z z μ 66 r m x g u r n h n p r n f coupled with the following kinematics equations 35 ξ u cos ψ v sin ψ η u sin ψ v cos ψ ψ r with m being the ship mass μ i j are the added mass of the hull u v r are the quasi velocities x g abscissa of mass center x h y h and n h are the bare hull forces and yaw moment respectively x p r y p r n p r are the forces caused by the steerable waterjets x f y f n f are the forces due to the skegs the couple ξ η gives the ship coordinates in the earth fixed frame with the origin at the starting point of the manoeuvre and ψ is the ship heading angle 2 numerical simulations this section presents numerical simulations for the complete navigation system including the afms cooperative path planning algorithm collision avoidance guidance and the individual heading and speed controller of each asv the leader and follower models are simulated considering the same vessel based in the particularities of the esso osaka tanker ship model 2 1 esso osaka ship model this sub section presents the characteristics of the esso osaka ship model the model was scaled 1 100 from the real esso osaka tanker ship the overall length is 3 43 m the breadth is 0 53 m and the displacement is 319 kg all the vehicle main characteristics are listed in table 4 the non dimensional hydrodynamics coefficients are presented in moreira et al 2007 2 2 numerical simulations 2 2 1 cooperative path planning and control simulations in static environment this numerical simulation is carried out to study the performance of the motion planning trajectory tracking and control modules in a static environment for a pre defined asvs team mission the motion planning algorithm is the angle guidance fast marching square method presented in section 2 the grid map is a rectangular map of 350 750 pixels2 where 1 pixel is equal to 1 m 10 static obstacles are considered table 5 shows the model configuration for the numerical simulation considering static obstacles the three asvs starts at the same nearly position with similar headings the formation shape is a triangular with d 25 m and θ 45 ο the starting speeds are 0 6 m s the desired target point is in the opposite corner fig 14 a presents the grid map and static obstacles the physical grid map is considered as an input for the present formulation extended angle guidance fast marching square method fig 14b shows the resulting color bar plot after applying afms method in this plot the values from 0 1 represents how easy or complex is to pass through that grid point i e the obstacles have a grid value of 0 fig 15 presents the sequence motions of asvs during the execution of the desired task from this sequence it is clear to see that the formation shape changes according the distribution of the obstacles in sequence motion t 500 s the formation is a perfect triangle because there are no obstacles in this area however in t 800 s the formation shape changes in order to pass through a complex sector this simulation shows the good performance of the system even when the initial conditions are different for each asvs i e initial heading angles are different fig 16 a presents the distance between leader and followers asvs during the execution of the mission task as was expected the distance changes during the mission execution according to the obstacles distribution fig 16b presents the speeds of each asv the speed of asv leader keeps constant and unchanged while the speed of the others asvs changes in order to preserve the formation shape or avoid collision between vessels thus is important to notice that the speeds are changing in order to avoid collision between asvs or trying to achieve the desired formation shape from this first numerical simulation it is clear to see the good performance of the complete cooperative navigation system sailing in a complex environment including static obstacles the asvs try to preserve the formation shape during the execution task the motion planning unit generates a smooth trajectory the heading and speed controller allows the vessels to tracking the desired path of each asvs 2 2 2 collision avoidance simulation to study the performance of the fuzzy logic based collision avoidance module numerical simulations were carried out for this simulation a case of potential collision between two vessels the own vessel and target vessel where considered both vessels are sailing in straight paths in a complex environment with static obstacles the desired trajectories are defined by a set of waypoints and trajectory tracking is performed using the vector field guidance and heading controller table 6 presents the model configurations for collision avoidance simulations fig 17 shows the results of numerical simulations for three different collision avoidance scenarios the own vessel trajectory in yellow represents the first case where the potential map m s membership function is not considered the own vessel trajectory in magenta represents the second case for m s potential map fmf with parameters in λ 1 0 2 λ 2 0 4 and the last own vessel trajectory in black dotted line is for m s λ 1 0 03 λ 1 0 11 see fig 10 for details from this numerical simulation it is clear to see that in the case where m s fuzzy membership function is not considered the trajectory of the own vessel is too close to the static obstacle in the right corner in blue however when a m s membership function is considered the trajectory of the own vessel changes in order to avoid colliding with the static obstacles from this simulation it is clear to see the influence of selection parameters for the potential map m s fuzzy logic membership function 3 case study in this case study the marine traffic in the estuary of tagus river in lisbon is chosen as the place for simulations the objective is to test the capabilities of the complete system motion planning collision avoidance guidance and control modules considering a real marine environment for this purpose the estuary of tagus river is modelled and static obstacles were included also the routes of two transtejo vessels are simulated 3 1 simulations parameters the area chosen for the simulation is a square area of 4 km side length fig 18 a and b this area includes the cais do sodré dock in lisbon portugal and two routes of river transport i e cacilhas cais do sodré seixal cais do sodré and navy dock in alfeite fig 19 shows the esso osaka model used for numerical simulations and the transtejo vessel which is used for passenger transport in the estuary in this study the motions of transtejo vessels are simulated using a catamaran 3dof mathematical model presented in section 2 6 the model considered for simulation was scaled 1 10 from the real catamaran ship which was subjected to full scale tests described in guedes soares et al 1999 whose hydrodynamic coefficients were obtained from captive model tests as described in sutulo and guedes soares 2004 2006 table 7 presents the main particularities of the catamaran 3 2 results fig 20 presents the modelling of a satellite picture of the tagus river estuary to generate a grid map later this grid map is used to generate a potential map by the use of afms method in the grid map 1 pixel is equal to 10 m notice that in this case study the influence of wind speed waves and others environmental disturbances are neglected in this colour plot the yellow grid points represents the static obstacles table 8 presents the model configuration for two cases of numerical simulations in simulation case a the starting point is the navy dock in alfeite and the target point is the dock in alcantara the desired formation distance d 10 pixels and the formation angle θ 45 ο in the case b a more complex arrangement was modelled in this case three simulated obstacles are included fig 21 presents the trajectories of the asvs team during the execution of the desired mission task in this figure the leader trajectory is on blue line the follower 1 in orange and follower 2 in yellow the desired trajectories calculated from afms algorithm are represented by way points in asterisk for each asv from the plot it is possible to see the modification of the formation shape when the team passes through a bottleneck at the end of the task fig 22 a presents plots of distance between leader and followers asvs during the execution of the mission task in this plot it is possible to see a constant value of distance at the beginning of the simulation because the trajectories are similar for all asvs and there are no obstacles fig 22b presents the speeds of each asv the speed of the asv leader is constant and the speed of the other asvs change in order to keep the formation shape or avoid collision between vessels from this plot it is possible to appreciate that follower 2 has a higher speed because this asvs needs to travel more distance than the others table 8 also presents the model configuration of the numerical simulation for the case b in this configuration three simulated obstacles are added along the grid map the starting point is an arbitrary point in the top left of the map and the target point is the navy dock in alfeite the desired formation distance d 10 pixels and the angle θ 45 ο fig 23 presents the initial configuration for the simulation b the simulated static obstacles are plotted in black and distributed in the map randomly this figure also addresses the gradient colour plot from the angle guidance fast marching square method for a 450 450 pixels2 and a start point in the leader initial position in colour plot the points with a highest value yellow points represents how complicate is pass through that points fig 24 presents the sequence of motions of the asvs during the execution of the desired task in simulation b in this plot the remaining path of the leader is plot in red the asvs are represented by a black circle for leader blue circle for follower 1 and magenta circle for follower 2 the formation shape is plotted in green from this sequence it is clear to see that the formation shape changes according the distribution of the obstacles but most of the time is constant in sequence motion t 20 the formation is a line because there is near to the initial conditions however in t 350 the formation shape changes in a perfect triangle because there are no obstacles in this region fig 25 a presents the distance between leader and follower asvs during the execution of the mission task in case b from this plot it is possible to see a constant value of distance between the asv leader and followers during the simulation because the trajectories are similar for all asvs and there is not a complicated distribution of obstacles fig 25b presents the speeds of each asv the speed of the asv leader is constant and the speed of the other asvs changes in order to keep the formation shape or avoid collision between vessels from this plot it is possible to appreciate that follower 1 has a higher speed because this asv needs to travel more distance than the others table 9 presents the model configuration of the numerical simulation case study in this configuration for the target vessels the starting point of the transtejo vessel is located in cais do sodré dock lisbon and the target point are a located dock in cacilhas and seixal docks the starting point of the asv formation is an arbitrary point in the middle of tagus river and the target point is in a navy dock in lisbon the formation distance is 15 pixels and the angle of formation is 45 fig 26 a presents the dynamic configuration for case study collision avoidance simulations this picture shows the marine traffic between cais do sodré dock in lisbon and two routes of river transport i e cacilhas cais do sodré and seixal cais do sodré fig 26b presents the map grid and waypoints of desired trajectories for simulation it is important to mention that the trajectories have been changed slightly in order to simulate a collision situation also the color for the desired trajectories for line 1 and line 2 are different in fig 26a and b fig 26c shows the potential map m s related to the static obstacles fig 27 presents the sequence of motions of the integrated system motion planning collision avoidance guidance and control for cooperative operation of a team of 3 avss in a complex marine environment including static and dynamic obstacles in this plot the trajectory of the asv leader is plot in dotted red line the transtejo 1 ship in green and transtejo 2 ships in magenta the desired trajectories indicated by way points were presented in fig 26 from this sequence it is clear to see the heading angle changes in order to avoid potential collision situation at the begin of simulation the asv leader is tracking the desired path without perturbation however after some minutes the first transtejo 1 ship is detected and a potential collision is identified thus according to the colregs regulations the asvs starts the collision avoidance manoeuvre later a second collision situation is detected with the transtejo 2 ship and the asv once more modify his heading angle in order to avoid the imminent collision finally when the collision risk disappears the asvs continues tracking the desired path when a collision situation is overpass there are overshoots in the trajectory tracking because the vector field guidance needs to recalculate the parameters fig 28 presents the time series of distance between the centre of asv leader and transtejo 1 ship in blue and asv and transtejo 2 ship in green during the execution of the collision avoidance task from this plot it is possible to see a constant decrease of distance between both parties involved in a potential collision risk situation at the first part of the simulation however after the collision situation is detected the heading of the leader in the usv formation changes in order to avoid collision and the distance increases in order to study the performance of the system in a case where both parties involved in a collision risk area required to alter their trajectories using the same motion planning and collision avoidance a head on colregs situation in simulated fig 29 presents the initial condition estimated trajectory and time sequence of head on collision avoidance simulation the simulation is performed for a map grid of 300 700 pixels2 and the parameters considered for the collision avoidance module are λ 1 0 35 λ 2 0 6 from the sequence of the motion it is possible to see that both vessels are following their normal trajectories until a potential collision is detected then both ships alter their trajectories following the colregs rules and regulations in order to avoid the collision from the figures it is possible to see that both ships perform slightly different manoeuvres because vessel 1 detects the potential collision when his heading angle is not the same of the vessel 2 3 3 computational cost analysis in this third subsection a preliminary computational cost study for the complete system of the cooperative operation of an asvs formation is presented the numerical simulations were performed in core i7 2 6 ghz with 8 gb ram memory computer running a matlab 2017b given that the system is composed by various modules it is imperative to isolate each individual module thus the modules from the heaviest computation cost to the lightest are the motion planning unit collision avoidance unit guidance unit and controllers the motion planning unit is the heaviest one it takes around 1 5 min to compute a new optimal path for each asvs fleet sailing in a grid map of 450 450 pixels2 it is principally because the module needs to calculate the potential map applying the angle guidance fast marching square for each different distribution of static and dynamic obstacles in the second position is the fuzzy logic collision avoidance unit it takes around 15 s to determine if there is a potential conflict and to calculate the desired changes in the vessels heading and speed the rest of modules the vector field guidance law and the controller has almost an instantaneous response in total the algorithm takes around 2 min to operate the complete system which can be considered a real time system in full scale ships it is important to mention that it is not always necessary to compute a new path for the asvs it is only necessary in case of a potential collision see fig 11 4 conclusions this paper has presented a system for motion planning collision avoidance guidance and control for asvs fleet in a complex marine environment leader followers architecture was adopted the motion planning is based in an extend angle guidance fast marching square method the collision avoidance unit is based in a fuzzy log algorithm and includes colregs rules and regulation the guidance unit employs the vector field guidance algorithm and the control unit is composed by a pid heading controller plus a speed controller a team composed by 3 identical asvs was chosen to simulate a fleet and the triangular formation shape was adopted numerical simulations were carried out to test each module first individually and then all together from the results of numerical simulation in static environment a good performance of the motion planning unit guidance and control system was found thus during the execution of a pre defined task the heading and speeds of the asv follower were adjusting in order overpass difficult regions and to keep as much as it is possible the desired formation shape in the case of collision avoidance simulations a good performance of the fuzzy logic based collision avoidance module was detected however this module is very sensitive to the parameters of potential map fuzzy membership function the case study of marine traffic in tagus river estuary shows the good performance of the complete navigation system in a real physical place thus the system is able to identify and process a realistic place including static and dynamic obstacles and execute a pre defined mission for an asv formation acknowledgment this study was performed within the strategic research plan of the centre for marine technology and ocean engineering which is financed by portuguese foundation for science and technology fundação para a ciência e a tecnologia under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 the first author has been funded by a phd scholarship from the university of lisbon and the centre for marine technology and ocean engineering centec the authors would like to thank the anonymous reviewers for their helpful and constructive comments that contributed to improving the final version of the manuscript 
22760,a system for motion planning collision avoidance guidance and control of an autonomous surface vehicles formation navigating in complex marine environment is presented the motion planning unit which is based in angle guidance fast marching square method is specially developed for operation in dynamic and static environments the collision avoidance unit is based in fuzzy logic formulation the guidance unit uses the vector field guidance formulation and the control unit is composed by a pid heading controller and a speed controller the leader follower s configuration is used for cooperative operation a set of numerical simulations are carried out for a team of three autonomous surface vehicles navigating in a complex maritime environment including static and dynamic obstacles and the results show good performance of the system keywords autonomous surface vehicles cooperative algorithm fast marching method collision avoidance vector field guidance 1 introduction in the last decade with the increasing number successful projects in asvs there is a larger interest in the application of this concept in the maritime industry this refers to the application of the concept of unmanned navigation involving the reduction of crew on board vessels with the ultimate goal in mind of a ship carrying out its functions without man on board in the long run in this scenario rolls royce 2014 has announced that remotely controlled local ships are expected in 2020 furthermore seagoing vessels for marine transportation in 2030 these remotely operated ships have as objective increase the safety in sea operations optimize fuel consumption and renovate the work roles in the marine field in the navy field darpa defense advanced research project agency has developed a trimaran unmanned vehicle called sea hunter built as part of its actuv anti submarine warfare continuous trail unmanned vessel program and this autonomous vessel began sea trials in april of 2015 sea hunter is a 40 m long trimaran manufactured in the silicon forest of portland oregon njus 2016 it is an autonomous vehicle power driven by two diesel engines with a maximum speed of 27 knots it is planned that in a near future this kind of marine vehicles may be armed and used for anti submarine and countermine duties operating at a minor fraction of the operating cost of a destroyer recently the world s first autonomous cargo vessel yara birkeland was announced the unmanned vessel is expected to navigate in the norwegian fjords and is projected for fully autonomous operation by 2020 kongsberg maritime 2017 this will be a giant achievement for maritime transportation and will begin a new era for unmanned marine vehicles however there are still various challenges related to these operations and this work aims to contribute solving some of these problems on the other hand ports and specialized terminals have had significant developments in recent years in electronics sensors and actuators automation and information technologies which makes feasible the construction of fully automatized terminals thus the rotterdam s port is operating a fully automatized container terminal using automated guided vehicles and automatized yard cranes to handle container units liu et al 2002 likewise the ports of singapore and of hamburg have been investigating similar ideas thus is easy to understand the good synergy of these technologies and unmanned navigation for the maritime transport in the near future other example is the small scale family of autonomous surface vehicles which includes a variety of sizes and types for example the autonomous surface fishing trawler artemis developed by mit sea grant college program and the catamaran delfim autonomous surface craft built in portugal in 2006 these prototypes of unmanned ships have successfully tested in open sea missions this kind of asvs incorporates colregs rules and regulations at an elementary level for head on encounter situations at the same time as keeping wi fi communication benjamin and curcio 2004 moreira and guedes soares 2011 performed successfully model tests using a scaled ship model of the tanker esso osaka which was instrumented for autonomous operation and different guidance and control approaches perera et al 2015 ferrari et al 2015 hinostroza et al 2017 and xu et al 2018 have conducted model tests with an autonomous surface vehicle 2 5 m long for intelligent navigation and collision avoidance manoeuvring tests and system identification respectively one popular challenge in this field involves the cooperative operation of one or more asvs to create a broadcast network with wi fi communication the benefits of using a team of asvs includes a large mission area improved system robustness reducing system cost and providing redundancy against individual failure and increased fault tolerant resilience liu and bucknall 2016 during the cooperative operation of asvs team the collision avoidance module has a crucial role therefore fuzzy logic based control systems for automatic collision avoidance system in vessel are a very promising option this kind of systems has been developed several decades ago hasegawa 1987 however those approaches in general ignore the rules and regulations proposed by the international maritime organization imo in 1972 sato and ishii 1998 statheros et al 2008 nonetheless in recent literature new formulations including colregs rules and regulation were addressed perera et al 2011 2012 zhang et al 2015 he et al 2017 in this approach the conjunction of human conduct and the decision making process has been formulated by several fuzzy member functions this paper proposes a full navigation system for cooperative operation of a asvs fleet in complex marine environment including static environment and dynamic obstacles the system is composed by motion planning collision avoidance guidance and control modules the motion planning algorithm is based in a fast marching method that computes the optimal trajectories for asv formation from a real marine environment the collision avoidance unit is fuzzy logic based including colregs rules and regulations the guidance unit of each individual asv is based in vector field guidance algorithm and the controller unit is composed by a pid heading and feedback speed controllers fig 1 presents a block diagram of the integrated system for cooperative operation of asvs fleet the structure consists of four modules i e task motion planning fast marching algorithm collision avoidance fuzzy logic based algorithm trajectory tracking vector field guidance and controller heading and speed controller the organization of the paper is as follows section 2 presents the mathematical formulation of the integrated system including a detailed description of each individual module section 3 presents numerical simulations to study the performance of the motion planning and collision avoidance system for formation asvs in a complex environment section 4 addressed a case study of the system for a ship traffic in the estuary of tagus river estuary including static and dynamic obstacles finally some conclusions are drawn in section 5 1 1 motion planning guidance and control formulation in this section the mathematical formulation of the angle guidance fast marching square algorithm for motion planning fuzzy logic based collision avoidance vector field guidance and control modules for cooperative operation of asv fleet shown in fig 1 are described in brief the cooperative algorithm block is where the formation strategy is defined by a formation shape of the asvs team the angle guidance fast marching method block is where the desired path of the leader and followers asvs is calculated the collision avoidance block ensures the safe navigation and the guidance and control blocks is where the trajectory tracking is performed based in a desired heading and speed 1 2 motion planning algorithm the motion planning algorithm used herein is an extension of the angle guidance fast marching square method afms this extended afms formulation is based in the classic fast marching method fmm proposed by sethian 1996 to solve the eikonal equation the improvements of afms method with respect to fmm are the inclusion of the ship heading angle and the safety margin potential map both formulations are presented in detail in liu and bucknall 2016 the present formulation has as starting point the afms formulation but modifications are included to allow the integration of collision avoidance trajectory tracking and controller units the fast marching method which was first addressed by sethian 1996 solves iteratively the eikonal equation in order to simulate the boundary propagation the eikonal equation has the formula 1 t x y v x y 1 where t x y is the boundary arrival time at point x y and v x y is the interface propagating speed in fig 2 consider that x y is the grid point where t x y needs to be calculated the neighbor of x y is a set of grid points with four elements x δ x y x δ x y x y δ y and x y δ y t x y can be calculated as 2 t 1 min t x δ x y t x δ x y t 2 min t x y δ y t x y δ y 3 t x y t x y t 1 δ x 2 t x y t 2 δ y 2 4 t x y t 1 δ x 2 t x y t 2 δ y 2 1 v x y 2 where δ x δ y are the spacing of the grid in the x and y coordinates the solution of equation 4 is given by 5 t x y t 1 1 v x y if t 2 t t 1 t 2 1 v x y if t 1 t t 2 quadratic solution of eq 4 the fast marching method follows the fundamentals of dijikstra 1959 technique but in place of using the traditional rectilinear distance metric it employs equation 5 to update the function cost which quantifies the distance in euclidean metric consequently compared with dijisktra the result generated by the fmm is more continuous the grid points present four neighboring points because the grid map has 4 connectivity points the dimension of the grid are δ x and δ y in the x and y directions respectively as presented in liu and bucknall 2016 table 1 shows as an example the specific fast marching method fmm algorithm by simulating an interface propagation process over a grid map the angle guidance fast marching square method afms is an extension of the classical fmm which incorporates the initial ship heading angle which is described in detail in liu and bucknall 2016 it uses as the base the fast marching method fmm proposed by garrido et al 2011 and ávares et al 2015 to make the generated path more realistic with the asv motion constraints the core of the afms method defines a guidance range in the grid planning space the shape of the guidance range is defined as a circle with a radius calculated from ship turning capabilities vehicle s yaw constraint fig 2 presents a simple application of the fast marching method and a more complex application of the angle guidance fast marching square method from the plots it is possible to identify the advantage of the use of angle guidance fast marching square method compared with fmm both methodologies estimate a smooth trajectory however in the case of fast marching method the path does not consider the initial heading angle and pass very close to the obstacles 1 2 1 asvs formation architecture in this subsection the chosen strategy for asvs formation is presented and a description of each control layer is addressed fig 3 presents the leader follower architecture adopted herein in this architecture the asvs formation algorithm can be divided in three layers i e physical layer individual layer and coordination layer the coordination layer is divided in local and network sub layers being the local layer where the follower leader communication is established by sending their position and speed to the leader asv in the network sub layer the leader communicates with the environment and obstacles that is vessel to environment v2e as well as vessel to vessel v2v the environmental information map grid data and position of obstacles can be obtained from automatic identification system ais or estimated from on board marine radar in addition each asv has an individual dynamic controller to perform trajectory tracking see fig 3 1 2 2 leader follower cooperative algorithm the cooperative motion planning unit computes the desired paths for the leader and followers asvs formation using marine environment grid map static and dynamic obstacles information in this unit the formation shape is also pre defined based on the number of asvs distance between asvs d and formation angle θ in this work the triangular shape will be used fig 4 the procedure is designed based in followers leader formation control schema as presented in liu and bucknall 2016 in this formulation the leader target point is defined as the asv formation target which is beforehand defined and remains unaltered during the task execution while followers desired target position is recomputed during each time step operation according to follower leader formation shape the trajectories for the followers are calculated from the leader s path as was using the algorithm proposed in alvares et al 2015 which can compliantly produce the sub targets according to environment modifications static or dynamic obstacles and makes the shape of the asv formation deformable based on the follower leader scheme each follower s sub target is re computed by referring to the desired angle of formation θ and the formation distance d 12 d 13 between the follower and leader as presented in fig 4 the angle of formation θ determines the desired angle between the follower and the leader while the formation distance represents the desired distance that the follower asv wants to preserve with respect to the leader θ and d 12 can be combined to have the desired formation configuration vector see fig 5 6 d l f 1 d 12 cos θ n i d 12 sin θ m j d l f 2 d 13 cos θ n i d 13 sin θ m j in equation 6 n i m j are the unitary vectors with respect to the heading angle ψ of leader asv d l f 1 and d l f 2 are the vector from the leader s origin to the follower s origin respectively is important to mention that the unitary vectors and the origin of the asv formation s frame can be computed from the absolute frame of reference see fig 5 using the leader heading angle given that the desired distance is represented by d 12 d 13 for a formation with triangular shape sub target points can be obtained as 7 x f o l l o w e r 1 x l e a d e r d 12 cos θ y f o l l o w e r 1 y l e a d e r d 12 sin θ 8 x f o l l o w e r 2 x l e a d e r d 13 cos θ y f o l l o w e r 2 y l e a d e r d 13 sin θ however according to equations 7 8 the shape of the formation cannot be altered however the safety map m s computed by the fast marching method has good capabilities for representing local information in the m s map each grid point has values in the limits from 0 to 1 where the value 1 represents collision free space and 0 represents obstacle space that value can be employed as a deformation parameter b to specify how much the formation shape needs to change therefore the new sub targets generation formulas are 9 b 1 m s x f o l l o w e r 1 y f o l l o w e r 1 b 2 m s x f o l l o w e r 2 y f o l l o w e r 2 10 x f o l l o w e r 1 x l e a d e r d 12 cos θ y f o l l o w e r 1 y l e a d e r d 12 sin θ b 1 x f o l l o w e r 2 x l e a d e r k b 2 d 13 cos θ y f o l l o w e r 2 y l e a d e r d 13 sin θ b 2 where the function m s x y yields the value at point x y in m s b 1 and b 2 are the deformation parameters governing the coordinates of sub targets of asv followers the values of deformation parameters are the same as in the map m s at x f o l l o w e r 1 y f o l l o w e r 1 and x f o l l o w e r 2 y f o l l o w e r 2 it could be observed that as distances between obstacles and followers become smaller the values of the deformation parameters b 1 or b 2 will be closer to 0 which decreases the distance values in the y axis attracting follower vessel to stay closer to each other parameter k is a constraint indicating the priority of each vessel follower fig 5 also shows the elliptical formation domain which is used to define a safety region and it is necessary to compute the collision risk presented in next section 2 2 this safety region is controlled by the parameters l i i 1 2 3 which depend on leader and follower s location thus the semi axis of the ellipse is computed as 11 a e l 1 l 3 l d 2 b e l 2 2 where a e is the half of major axis b e is the half of minor axis and l d max d 12 cos θ d 13 cos θ in this study the following values were assumed l 1 l 3 l d and l 2 2 max d 12 sin θ d 13 sin θ 1 3 fuzzy logic based collision avoidance formulation the fuzzy logic collision avoidance unit is composed by two blocks i e collision detection and the fuzzy logic algorithm the collision detection block uses the distance and time to the closest point of approach between vessels to detect potential conflicts using colregs rules and regulation the fuzzy logic block uses linguistic variables to characterize encounter situation between the asvs team and a dynamic obstacle target ship then using fuzzy rules compute changes in heading and speed in order to avoid collision notice that the collision avoidance algorithm is based in the work proposed by perera et al 2011 2012 however this paper includes a collision detection module see fig 1 an iterative collision situation fuzzy membership function in order to reduce the number of fuzzy rules and includes a new fuzzy membership function based in fast marching method 1 3 1 colregs rules and regulations the colregs rules and regulation imo 1972 include thirty eight rules which are divided in five parts general rules in part a steering and sailing in part b lights and shapes in part c sound and light signals in part d and some exemptions in part e in the present work the part b of colregs regarding to steering and sailing rules are contemplated as was mentioned in section 1 the colregs rules and regulations concerning collision situations in maritime traffic have been neglect in most of the recent publications this negligence of the colregs rules might lead to collisions in sea navigation thus five sixths of major maritime collisions include violations of the colregs rules and regulations perera et al 2011 consequently the systems addressed by the literature ignoring the colregs rules and regulations must not be implemented in maritime traffic also there are some practical issues regarding applications of the colregs rules and regulations in maritime transportation fig 6 presents the typical collision situations between ships in ocean navigation head on overtake situations and crossing fig 6 also shows the colregs rules and regulation to solve the potential conflict 1 3 2 collision avoidance algorithm the collision detection module is responsible to determine if there is a potential conflict in route as shown in fig 7 where 2 vessels have a potential collision in a point at the desired trajectory to successfully remove the collision situation it is necessary to compute the distance to the closest point of approach dcpa and the time to the closest point of approach tcpa as shown in fig 7 vessel 1 is travelling with the speed v1 and vessel 2 has the speed of v2 v12 is the relative speed of vessel 1 with respect to vessel 2 d is the separation between 2 vessels and γ is gamma is the angle between the relative motion line and line d the fuzzy logic collision avoidance unit is responsible to compute the desired heading and velocity of own vessel in order to avoid potential conflicts in a desired trajectory this study uses the mamdani formulation mamdani and assilian 1975 fig 8 presents a relative collision situation in maritime traffic which is analogous to a radar plot the own vessel ocean domain centered around the virtual center of formation of the asvs is defined by two regions the elliptical safety domain formation and the circumference entailed by the distance to the target vessel the formation asvs region of collision are split into 8 regions labeled from i to viii these polar regions are similar with the collision regions formulated in the fuzzy membership function fmf as in perera et al 2011 it is intended that the target ship will be positioned inside one of these 8 regions and the decisions for collision avoidance are formulated in accordance to each individual region the target ship possible orientations have been split into eight divisions of vessel heading regarding the relative course i e for a target ship in region ii ii a ii b ii c ii d ii e ii f ii g and ii h these partitions are divided by dotted lines which are coincident with the relative collision angle fuzzy membership function tables 2 and 3 present the list of fuzzy logic rules and decisions of the asvs formation and a target vessel in collision situations as presented in fig 8 the first column denotes the collision regions with respect to the own vessel the second column denotes the divisions of the target ship headings the third column ψ r e l represents relative collision angle the fourth column represents the value of potential map m s x y and using these inputs is possible to assess the collision risk with respect to each of the collision situation depending on the degree of risk the correction actions in order to avoid collision are presented in columns fifth and sixth taking into account the colregs rules and regulations in this table n a means no action in the formulation of the collision avoidance unit based in fuzzy logic algorithm the definition of fuzzy membership functions are decisive this fmf describes fuzzy sets which are obtained from one given universe of discourse to a unit interval this function is formally and conceptually different from the fundamental concept of probability pedrycz and gomide 2007 the core of the fuzzy set is defined as the set of all elements of the universe that are associated with the membership value from 0 to 1 the support of the fmfs are defined as the set of all elements of x that have nonzero membership degree the fmf for inputs collision region division relative collision angle ψ r and decision for heading δ ψ and variation of speed are presented in fig 9 the core and support variables are listed on the respective figures of inputs and outputs fmfs in this work the relative collision angle ψ r fmf is represented by three sub regions v1 v2 v3 this fmf change its values in each iteration according to the relative region of the target vessel in fig 9 for example the plot is for region ii θ 0 fig 10 presents the fmf for the potential map m s x y this fmf is obtained from the potential map generated with fast marching method this fmf is divided in three sub regions i e dangerous medium and safe this region needs to be calibrated and section 3 presents simulations to determine parameters as a summary a flow chart of cooperative operation of asv team in a marine complex environment including the motion planning collision avoidance guidance and control algorithm is presented in fig 11 the algorithm implements follower leader formation strategy along an online path planning in a complex environment including dynamic and static obstacles at the beginning of the algorithm the asv formation shape is defined and the grid map static and dynamic obstacles and target vessel are read next using the afms methodology the leader path is computed where depending in the complexity of the navigation area the follower s desired trajectories are computed in case of potential collision situations evaluated by the tcpa and dcpa the collision avoidance module computes a desired heading formation in order to avoid a collision situation after the collision situation disappears the process is restarted and a new online path is computed for each asv taking as a starting point the new position of the asv leader 1 3 3 3 dof mathematical model for simulations in order to simulate the 3dof planar ship motions the abkowitz 1980 model is modified in order to make the modelling more flexible and realistic physically in this formulation the effect of current is treated as the principal external disturbance because the ship model has a small above water structure fig 12 presents the coordinate frames for 3dof ship motions as presented in fig 12 u c and α are the magnitude and direction of the current while ψ u and v are the heading surge speed and sway speed of the ship respectively the relative speeds in the presence of current are given by 12 u r u u c cos ψ α v r v u c sin ψ α the time derivatives of u and v are given 13 u u r u c r sin ψ α v v r u c r cos ψ α where the accelerations of the motion in 3 dof surge sway and yaw are given by 14 m x u r u r m v r r m x g r 2 f 1 m y v r v r m x g y r r m u r r f 2 m x g n v r v i z n r r m x g u r r f 3 with m being the mass of the vessel x u r y v r y r n v r n r are the added mass and moment respectively the dimensionless forces are defined as multi variety third order regression polynomials depending on the non dimensional velocities 15 f 1 η 1 u r 2 η 2 n u r η 3 n 2 c r x v r 2 v r 2 x e 2 e 2 x r 2 r 2 x v r r v r r x v r 2 r 2 v r 2 r 2 16 f 2 y 0 y v r v r y δ c c 0 v r y r r y δ 2 c c 0 r y δ δ y r 2 v r r 2 v r y e 3 e 3 17 f 3 n 0 n v r v r n δ c c 0 v r n r r 1 2 n δ c c 0 r n δ δ n r 2 v r r 2 v r n e 3 e 3 where e is the effective rudder angle given by 18 e δ v c r l 2 c detailed information about the formulation can be found in moreira et al 2007 in equations 16 and 17 c is the weighted average flow velocity over the rudder which is evaluated as a sum of 1 ω u r and u a 19 c a p a r 1 ω u r k u a 2 a r a p a r 1 ω 2 u r 2 in which a p is the propeller surface a r is the rudder area ω is the wake fraction u a is the induced axial speed far behind the propeller disk which given by 20 u a 1 w u 1 w 2 u 2 8 π k t n d 2 where k t is the propulsive coefficient d is the propeller diameter in this study the effect of the current in not considered in order to simplify the model 1 4 vector field guidance law to track the predefined trajectory autonomous ships must be capable of following the desired heading angles the vector field guidance law xu and guedes soares 2016 is used to generate a vector field around the predefined path the vectors indicated the desired heading angle as presented in fig 13 if the ships follow the vectors direction it will end up following the path successfully as shown in the fig 13 the solid line between the waypoints is the predefined path the area between the red dashed lines which lie at a distance τ on each side of the path indicates the transition region a vector field around the path is constructed as presented in fig 13 if the distance d is greater than the predefined constant τ it means that the ships are outside the transition region then the guidance laws will force the ship to travel towards the path at a constant desired heading angle χ e which is called entry angle when the vehicle is inside the transition region d τ the desired heading is calculated using eq 21 the rate of transition is controlled by a gain k 1 the vector field guidance is given xu and guedes soares 2016 21 χ d χ f sgn y e χ e if x τ χ f sgn y e y e δ k χ e if x τ where χ d is the desired course angle and is defined as χ d ψ d β ψ d is the desired heading angle β is the sideslip angle which can be measured directly χ f is the angle of the path χ e is the entry course angle when the ship located outside the transition area y e is the cross track error k and δ are the predefined parameters 1 5 pid heading controller 1 5 1 control model nomoto model is widely used to design the autopilot for marine vessels due to its simple structure it was proposed by nomoto et al 1957 by eliminating the sway velocity v from equation 22 from the general dynamics of marine vessel making some assumptions the linearized manoeuvring model 22 m v n u 0 v b δ r where v v r t is the state vector δ r is the rudder angle 23 m m y v m x g y r m x g y v i z n r n u 0 y v m u 0 y r n v m x g u 0 n r b y δ n δ the nomoto transfer function is 24 r δ s k 1 t 3 s 1 t 1 s 1 t 2 s where t i i 1 2 3 are time constants and k is the gain constant a 1st order approximation is obtained by letting the effective time constant be equal to t t 1 t 2 t 3 such that 25 r δ s k 1 t s since r s s ψ s finally 26 ψ δ s k s 1 t s in time domain eq 26 can be rewritten as t ψ ψ k δ as presented in fossen 2011 the nomoto model is only used for low frequencies based on the 1st order nomoto model the pid heading controller is designed and the controller gains are calculated consider the pid controller law 27 τ n τ p i d s k p ψ d ψ k d ψ k i 0 t ψ d ψ τ d τ k p 1 t d s 1 t i s ψ d ψ another simple intuited way to do this is by noticing that δ can be written as fossen 2011 28 δ k p ψ k i ψ d τ k d ψ where τ n is the controller yaw moment k d k p t d and k i k p t i k p 0 k d 0 and k i 0 are the regulator design parameters applying this control law to nomoto 1st order model equation 26 the closed loop characteristic equation is as follows xu and guedes soares 2016 29 t σ 3 1 k k d σ 2 k k p σ k k i 0 according to the routh s stability criterion the controller gains can be calculated using pole placement in the terms of the design parameters ω n and ζ as shown below 30 k p ω n 2 t k 0 k d 2 ζ ω n t 1 k 0 k i ω n 3 t 10 k 0 where ω n is the natural frequency and ζ is the relative damping ratio of the 1st order system in this case ω n 1 rad s and critical damping ζ 1 thus the following controller gains obtained k p 40 93 k d 76 33 and k i 0 05 1 5 2 feedback linearization speed controller the speed controller is based in feedback linearization the basic idea of feedback linearization is to transform the nonlinear systems dynamics into a linear system by cancelling the nonlinear term then conventional control techniques can be applied to the linear system fossen 2011 from moreira et al 2007 the surge model of the ship is given 31 u f 1 m x u r u c r sin ψ α with f 1 thrust u r n f 1 u r v r u v r δ the thrust term and f 1 is given by moreira et al 2007 the commanded acceleration can be calculated through fossen 2011 32 a b u d k p u r u d k i 0 t u r u d d τ thus the speed controller can be computed by 33 τ thrust m x u r u d k p u r u d k i 0 t u r u d d τ u c r sin ψ α f 1 u r v r u v r δ the following controller gains are used for simulations k p 0 15 k i 1 e 5 1 6 catamaran mathematical model a 3dof mathematical model for a catamaran is presented in this subsection this model will be used to simulate the motions of a transtejo ship in section 4 the model is addressed in more detail in sutulo and guedes soares 2005 and ferrari et al 2014 here only a brief overview is described the dynamic equations of motions are 34 m μ 11 u m v r m x g r 2 x h x p r x f m μ 22 v m x g μ 26 r m u r y h y p r y f m x g μ 26 v i z z μ 66 r m x g u r n h n p r n f coupled with the following kinematics equations 35 ξ u cos ψ v sin ψ η u sin ψ v cos ψ ψ r with m being the ship mass μ i j are the added mass of the hull u v r are the quasi velocities x g abscissa of mass center x h y h and n h are the bare hull forces and yaw moment respectively x p r y p r n p r are the forces caused by the steerable waterjets x f y f n f are the forces due to the skegs the couple ξ η gives the ship coordinates in the earth fixed frame with the origin at the starting point of the manoeuvre and ψ is the ship heading angle 2 numerical simulations this section presents numerical simulations for the complete navigation system including the afms cooperative path planning algorithm collision avoidance guidance and the individual heading and speed controller of each asv the leader and follower models are simulated considering the same vessel based in the particularities of the esso osaka tanker ship model 2 1 esso osaka ship model this sub section presents the characteristics of the esso osaka ship model the model was scaled 1 100 from the real esso osaka tanker ship the overall length is 3 43 m the breadth is 0 53 m and the displacement is 319 kg all the vehicle main characteristics are listed in table 4 the non dimensional hydrodynamics coefficients are presented in moreira et al 2007 2 2 numerical simulations 2 2 1 cooperative path planning and control simulations in static environment this numerical simulation is carried out to study the performance of the motion planning trajectory tracking and control modules in a static environment for a pre defined asvs team mission the motion planning algorithm is the angle guidance fast marching square method presented in section 2 the grid map is a rectangular map of 350 750 pixels2 where 1 pixel is equal to 1 m 10 static obstacles are considered table 5 shows the model configuration for the numerical simulation considering static obstacles the three asvs starts at the same nearly position with similar headings the formation shape is a triangular with d 25 m and θ 45 ο the starting speeds are 0 6 m s the desired target point is in the opposite corner fig 14 a presents the grid map and static obstacles the physical grid map is considered as an input for the present formulation extended angle guidance fast marching square method fig 14b shows the resulting color bar plot after applying afms method in this plot the values from 0 1 represents how easy or complex is to pass through that grid point i e the obstacles have a grid value of 0 fig 15 presents the sequence motions of asvs during the execution of the desired task from this sequence it is clear to see that the formation shape changes according the distribution of the obstacles in sequence motion t 500 s the formation is a perfect triangle because there are no obstacles in this area however in t 800 s the formation shape changes in order to pass through a complex sector this simulation shows the good performance of the system even when the initial conditions are different for each asvs i e initial heading angles are different fig 16 a presents the distance between leader and followers asvs during the execution of the mission task as was expected the distance changes during the mission execution according to the obstacles distribution fig 16b presents the speeds of each asv the speed of asv leader keeps constant and unchanged while the speed of the others asvs changes in order to preserve the formation shape or avoid collision between vessels thus is important to notice that the speeds are changing in order to avoid collision between asvs or trying to achieve the desired formation shape from this first numerical simulation it is clear to see the good performance of the complete cooperative navigation system sailing in a complex environment including static obstacles the asvs try to preserve the formation shape during the execution task the motion planning unit generates a smooth trajectory the heading and speed controller allows the vessels to tracking the desired path of each asvs 2 2 2 collision avoidance simulation to study the performance of the fuzzy logic based collision avoidance module numerical simulations were carried out for this simulation a case of potential collision between two vessels the own vessel and target vessel where considered both vessels are sailing in straight paths in a complex environment with static obstacles the desired trajectories are defined by a set of waypoints and trajectory tracking is performed using the vector field guidance and heading controller table 6 presents the model configurations for collision avoidance simulations fig 17 shows the results of numerical simulations for three different collision avoidance scenarios the own vessel trajectory in yellow represents the first case where the potential map m s membership function is not considered the own vessel trajectory in magenta represents the second case for m s potential map fmf with parameters in λ 1 0 2 λ 2 0 4 and the last own vessel trajectory in black dotted line is for m s λ 1 0 03 λ 1 0 11 see fig 10 for details from this numerical simulation it is clear to see that in the case where m s fuzzy membership function is not considered the trajectory of the own vessel is too close to the static obstacle in the right corner in blue however when a m s membership function is considered the trajectory of the own vessel changes in order to avoid colliding with the static obstacles from this simulation it is clear to see the influence of selection parameters for the potential map m s fuzzy logic membership function 3 case study in this case study the marine traffic in the estuary of tagus river in lisbon is chosen as the place for simulations the objective is to test the capabilities of the complete system motion planning collision avoidance guidance and control modules considering a real marine environment for this purpose the estuary of tagus river is modelled and static obstacles were included also the routes of two transtejo vessels are simulated 3 1 simulations parameters the area chosen for the simulation is a square area of 4 km side length fig 18 a and b this area includes the cais do sodré dock in lisbon portugal and two routes of river transport i e cacilhas cais do sodré seixal cais do sodré and navy dock in alfeite fig 19 shows the esso osaka model used for numerical simulations and the transtejo vessel which is used for passenger transport in the estuary in this study the motions of transtejo vessels are simulated using a catamaran 3dof mathematical model presented in section 2 6 the model considered for simulation was scaled 1 10 from the real catamaran ship which was subjected to full scale tests described in guedes soares et al 1999 whose hydrodynamic coefficients were obtained from captive model tests as described in sutulo and guedes soares 2004 2006 table 7 presents the main particularities of the catamaran 3 2 results fig 20 presents the modelling of a satellite picture of the tagus river estuary to generate a grid map later this grid map is used to generate a potential map by the use of afms method in the grid map 1 pixel is equal to 10 m notice that in this case study the influence of wind speed waves and others environmental disturbances are neglected in this colour plot the yellow grid points represents the static obstacles table 8 presents the model configuration for two cases of numerical simulations in simulation case a the starting point is the navy dock in alfeite and the target point is the dock in alcantara the desired formation distance d 10 pixels and the formation angle θ 45 ο in the case b a more complex arrangement was modelled in this case three simulated obstacles are included fig 21 presents the trajectories of the asvs team during the execution of the desired mission task in this figure the leader trajectory is on blue line the follower 1 in orange and follower 2 in yellow the desired trajectories calculated from afms algorithm are represented by way points in asterisk for each asv from the plot it is possible to see the modification of the formation shape when the team passes through a bottleneck at the end of the task fig 22 a presents plots of distance between leader and followers asvs during the execution of the mission task in this plot it is possible to see a constant value of distance at the beginning of the simulation because the trajectories are similar for all asvs and there are no obstacles fig 22b presents the speeds of each asv the speed of the asv leader is constant and the speed of the other asvs change in order to keep the formation shape or avoid collision between vessels from this plot it is possible to appreciate that follower 2 has a higher speed because this asvs needs to travel more distance than the others table 8 also presents the model configuration of the numerical simulation for the case b in this configuration three simulated obstacles are added along the grid map the starting point is an arbitrary point in the top left of the map and the target point is the navy dock in alfeite the desired formation distance d 10 pixels and the angle θ 45 ο fig 23 presents the initial configuration for the simulation b the simulated static obstacles are plotted in black and distributed in the map randomly this figure also addresses the gradient colour plot from the angle guidance fast marching square method for a 450 450 pixels2 and a start point in the leader initial position in colour plot the points with a highest value yellow points represents how complicate is pass through that points fig 24 presents the sequence of motions of the asvs during the execution of the desired task in simulation b in this plot the remaining path of the leader is plot in red the asvs are represented by a black circle for leader blue circle for follower 1 and magenta circle for follower 2 the formation shape is plotted in green from this sequence it is clear to see that the formation shape changes according the distribution of the obstacles but most of the time is constant in sequence motion t 20 the formation is a line because there is near to the initial conditions however in t 350 the formation shape changes in a perfect triangle because there are no obstacles in this region fig 25 a presents the distance between leader and follower asvs during the execution of the mission task in case b from this plot it is possible to see a constant value of distance between the asv leader and followers during the simulation because the trajectories are similar for all asvs and there is not a complicated distribution of obstacles fig 25b presents the speeds of each asv the speed of the asv leader is constant and the speed of the other asvs changes in order to keep the formation shape or avoid collision between vessels from this plot it is possible to appreciate that follower 1 has a higher speed because this asv needs to travel more distance than the others table 9 presents the model configuration of the numerical simulation case study in this configuration for the target vessels the starting point of the transtejo vessel is located in cais do sodré dock lisbon and the target point are a located dock in cacilhas and seixal docks the starting point of the asv formation is an arbitrary point in the middle of tagus river and the target point is in a navy dock in lisbon the formation distance is 15 pixels and the angle of formation is 45 fig 26 a presents the dynamic configuration for case study collision avoidance simulations this picture shows the marine traffic between cais do sodré dock in lisbon and two routes of river transport i e cacilhas cais do sodré and seixal cais do sodré fig 26b presents the map grid and waypoints of desired trajectories for simulation it is important to mention that the trajectories have been changed slightly in order to simulate a collision situation also the color for the desired trajectories for line 1 and line 2 are different in fig 26a and b fig 26c shows the potential map m s related to the static obstacles fig 27 presents the sequence of motions of the integrated system motion planning collision avoidance guidance and control for cooperative operation of a team of 3 avss in a complex marine environment including static and dynamic obstacles in this plot the trajectory of the asv leader is plot in dotted red line the transtejo 1 ship in green and transtejo 2 ships in magenta the desired trajectories indicated by way points were presented in fig 26 from this sequence it is clear to see the heading angle changes in order to avoid potential collision situation at the begin of simulation the asv leader is tracking the desired path without perturbation however after some minutes the first transtejo 1 ship is detected and a potential collision is identified thus according to the colregs regulations the asvs starts the collision avoidance manoeuvre later a second collision situation is detected with the transtejo 2 ship and the asv once more modify his heading angle in order to avoid the imminent collision finally when the collision risk disappears the asvs continues tracking the desired path when a collision situation is overpass there are overshoots in the trajectory tracking because the vector field guidance needs to recalculate the parameters fig 28 presents the time series of distance between the centre of asv leader and transtejo 1 ship in blue and asv and transtejo 2 ship in green during the execution of the collision avoidance task from this plot it is possible to see a constant decrease of distance between both parties involved in a potential collision risk situation at the first part of the simulation however after the collision situation is detected the heading of the leader in the usv formation changes in order to avoid collision and the distance increases in order to study the performance of the system in a case where both parties involved in a collision risk area required to alter their trajectories using the same motion planning and collision avoidance a head on colregs situation in simulated fig 29 presents the initial condition estimated trajectory and time sequence of head on collision avoidance simulation the simulation is performed for a map grid of 300 700 pixels2 and the parameters considered for the collision avoidance module are λ 1 0 35 λ 2 0 6 from the sequence of the motion it is possible to see that both vessels are following their normal trajectories until a potential collision is detected then both ships alter their trajectories following the colregs rules and regulations in order to avoid the collision from the figures it is possible to see that both ships perform slightly different manoeuvres because vessel 1 detects the potential collision when his heading angle is not the same of the vessel 2 3 3 computational cost analysis in this third subsection a preliminary computational cost study for the complete system of the cooperative operation of an asvs formation is presented the numerical simulations were performed in core i7 2 6 ghz with 8 gb ram memory computer running a matlab 2017b given that the system is composed by various modules it is imperative to isolate each individual module thus the modules from the heaviest computation cost to the lightest are the motion planning unit collision avoidance unit guidance unit and controllers the motion planning unit is the heaviest one it takes around 1 5 min to compute a new optimal path for each asvs fleet sailing in a grid map of 450 450 pixels2 it is principally because the module needs to calculate the potential map applying the angle guidance fast marching square for each different distribution of static and dynamic obstacles in the second position is the fuzzy logic collision avoidance unit it takes around 15 s to determine if there is a potential conflict and to calculate the desired changes in the vessels heading and speed the rest of modules the vector field guidance law and the controller has almost an instantaneous response in total the algorithm takes around 2 min to operate the complete system which can be considered a real time system in full scale ships it is important to mention that it is not always necessary to compute a new path for the asvs it is only necessary in case of a potential collision see fig 11 4 conclusions this paper has presented a system for motion planning collision avoidance guidance and control for asvs fleet in a complex marine environment leader followers architecture was adopted the motion planning is based in an extend angle guidance fast marching square method the collision avoidance unit is based in a fuzzy log algorithm and includes colregs rules and regulation the guidance unit employs the vector field guidance algorithm and the control unit is composed by a pid heading controller plus a speed controller a team composed by 3 identical asvs was chosen to simulate a fleet and the triangular formation shape was adopted numerical simulations were carried out to test each module first individually and then all together from the results of numerical simulation in static environment a good performance of the motion planning unit guidance and control system was found thus during the execution of a pre defined task the heading and speeds of the asv follower were adjusting in order overpass difficult regions and to keep as much as it is possible the desired formation shape in the case of collision avoidance simulations a good performance of the fuzzy logic based collision avoidance module was detected however this module is very sensitive to the parameters of potential map fuzzy membership function the case study of marine traffic in tagus river estuary shows the good performance of the complete navigation system in a real physical place thus the system is able to identify and process a realistic place including static and dynamic obstacles and execute a pre defined mission for an asv formation acknowledgment this study was performed within the strategic research plan of the centre for marine technology and ocean engineering which is financed by portuguese foundation for science and technology fundação para a ciência e a tecnologia under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 the first author has been funded by a phd scholarship from the university of lisbon and the centre for marine technology and ocean engineering centec the authors would like to thank the anonymous reviewers for their helpful and constructive comments that contributed to improving the final version of the manuscript 
22761,in this paper a deep reinforcement learning drl based controller for path following of an unmanned surface vehicle usv is proposed the proposed controller can self develop a vehicle s path following capability by interacting with the nearby environment a deep deterministic policy gradient ddpg algorithm which is an actor critic based reinforcement learning algorithm was adapted to capture the usv s experience during the path following trials a markov decision process model which includes the state action and reward formulation specially designed for the usv path following problem is suggested the control policy was trained with repeated trials of path following simulation the proposed method s path following and self learning capabilities were validated through usv simulation and a free running test of the full scale usv keywords deep reinforcement learning path following unmanned surface vehicle learning based control artificial intelligence 1 introduction recently unmanned surface vehicles usvs have been actively adopted in both military and commercial areas in terms of safety usvs can replace humans in tasks performed in dangerous and extreme environments such as mine countermeasures bertram 2008 anti submarine warfare corfield and young 2006 and reconnaissance kucik 2004 in terms of economic efficiency usvs can replace humans in performing repetitive and tedious missions such as resource exploration majohr and buch 2006 or oceanic sample acquisition naeem et al 2006 although there are different types of usvs designed for different tasks their common feature is their path following capability which is one of the most fundamental capabilities that any usv must possess for this a usv must have a properly designed path following controller that is effective and robust various control algorithms have been developed by many researchers to implement path following in unmanned marine vehicles these include the proportional integral derivative control lekkas and fossen 2012 bibuli et al 2009 sliding mode control meng et al 2012 backstepping control sonnenburg and woolsey 2013 fuzzy control zhu et al 2016 garus and zak 2010 and model predictive control naeem et al 2006 in recent years there have been many attempts to deal with uncertainty in the control domain such as disturbance or dynamic modeling uncertainty an adaptive control algorithm shin et al 2017 mu et al 2017 has been developed in an attempt to consider the uncertainty in the vehicle s dynamic model in lu et al 2018 minimal learning parameter mlp and the disturbance observer dob techniques are adopted to deal with usv formation control similarly a robust neural algorithm was adopted to deal with uncertainty in zhang et al 2018 while the usv is performing path following control in presence of multiple obstacles although a number of usv path following controllers have been proposed most of the approaches have limitations in terms of dependency on prior knowledge of dynamic modeling and handling of modeling uncertainty to overcome such limitations we adopted recently devised machine learning techniques to develop a usv controller the proposed deep reinforcement learning drl based usv controller has self learning capability and thus it does not require any prior knowledge of usv dynamics to tune the controller similarly because the learning process directly uses experience data consisting of the control input and the corresponding dynamic response of the vehicle the controller can implicitly consider modeling the uncertainty or the effect of environmental disturbances as well in recent years there have been several attempts to implement machine learning techniques in the field of unmanned maritime vehicles bertaska 2016 bertaska and von ellenrieder 2018 cheng and zhang 2018 magalhães et al 2018 carreras et al 2003 zhang et al 2014 de paula and acosta 2015 yoo and kim 2016 woo 2018 cui et al 2017 bertaska 2016 used a traditional q learning approach to develop a supervisory switching controller for usvs in this work three basis controllers were specially designed for transiting station keeping and reversing maneuver respectively then a q learning algorithm was used to intelligently switch the basis controller of the usv according to the current situation and maneuver of the usv a full scale usv experiment was conducted to validate the proposed method cheng and zhang 2018 adopted a drl technique for obstacle avoidance of an underactuated unmanned marine vehicle in this work convolutional layers were used to capture the obstacle s information and a reward was specially designed for obstacle avoidance tasks magalhães et al 2018 devised a conventional q learning based reinforcement learning technique to develop a biomimetic underwater vehicle controller in their work the q learning based controller mimicked the stroke style of a fish with two lateral fins and a tail the control policy was trained by using a biomimetic vehicle simulator and the learned model was transferred to the real vehicle for validation woo and kim 2016 adopted the deep reinforcement learning in the field of collision avoidance of an unmanned surface vehicle by expressing the encounter situation using a grid map based visual information an unmanned surface vehicle can deal with avoidance decision making in complex encounter situation similar to magalhães et al 2018 a policy model was trained in simulation environment and additional validation experiment was conducted some of the contributions of the proposed method to the field of marine vehicle control are as follows first this work was the first implementation of continuous action space reinforcement learning in the control of an unmanned marine vehicle there exist some works that used reinforcement learning for control purposes magalhães et al 2018 carreras et al 2003 however they defined action space as discrete actions with only a few action candidates the small number of action candidates hinders the precise control of a vehicle or often results in the chattering phenomenon second we applied the drl based controller to a full scale usv control and conducted a number of real world experiments for validation in most of the works related to reinforcement learning on a marine vehicle the training and the validation domain were restricted to simulation in contrast we extended the domain into a real world domain to show its practical applicability the rest of the paper is organized as follows in section 2 the usv dynamics and path following system used in this work are presented in section 3 the theoretical background and problem formulation of the reinforcement learning based controller are given in section 4 the validation of the proposed method through full scale usv path following experiments is discussed as well as the test results and analysis conducted finally in section 5 the main conclusions and additional discussions are presented 2 usv path following according to the theoretical background on reinforcement learning a learning based controller is developed through a repeated training process during the training the controller will perform an action that is then evaluated on the basis of the response of the environment to the conducted action because of these characteristics a learning based controller requires an environment to interact with to be trained in this work we conducted usv path following simulations to train the controller fig 1 shows a schematic diagram of the usv path following system for the training simulation as illustrated a dynamic system should be implemented to describe the vehicle s dynamic behavior and a guidance block is adopted to determine the desired course angle the rest of this section provides detailed information about the components of the usv path following system 2 1 usv dynamic model in this work we selected a 16 ft wave adaptive modular vessel wam v platform as the target usv type a wam v platform is a catamaran shaped platform with two inflatable pontoons hulls with a wave shock observer described in fig 2 the vehicle was equipped with two electric thrusters on each hull and the thruster vector angle was fixed as illustrated in fig 2 because of this characteristic the vehicle generated yaw motion by making rpm differences in the two thrusters known as differential thruster type woo et al 2018 recently conducted a dynamic system identification on an identical platform in his work several dynamic model including simplified dynamics and lstm based deep neural network model was identified in this work we adopted the identification result of the simplified dynamic model represented in woo et al 2018 as a simulation model once the simulation based training process was finished the trained controller was implemented on the wam v platform and path following experiments were conducted to validate its performance since a horizontal planar motion of the usv is the primary concern in a path following problem we mainly focused on 3 degrees of freedom 3dof usv motions surge sway and yaw motion for the notation the one proposed by fossen 2002 was used the coordinate system used in this work is illustrated in fig 2 where x i and y i are the north and the east directional position respectively of the usv in the inertial frame whereas u v and v are the surge sway and total speed respectively of the vehicle in a body fixed frame the heading angle of the usv is defined as ψ whereas the course angle and the side slip angle are represented by χ and β respectively by definition the side slip angle β can be calculated by the equation β a s i n v v and the course angle can be described by the sum of ψ and β as in the expression χ ψ β the usv kinematic model can be described as in 1 where ν and η are defined as the velocity vector and the position vector respectively r η is a rotation matrix from a body fixed frame to an inertial frame 1 η r η ν 2 ν u v r t 3 η x i y i ψ t 4 r η c o s ψ s i n ψ 0 s i n ψ c o s ψ 0 0 0 1 the 3dof horizontal planar dynamic model of the usv can be described by the following equation 5 m ν c ν ν d ν ν f where m is the mass matrix c ν is the coriolis and centripetal matrix d ν is the damping matrix and f is the control forces and moment since the target usv was a differential thruster type the control forces and moment f can be described as follows 6 f τ x τ y τ n t p o r t t s t b d 0 t p o r t t s t b d b 2 in the above equation t p o r t and t s t b d represent the thrust force of the port side and the starboard side thruster respectively and b refers to the beam of the target usv we implemented an actuator model based on model of woo et al 2018 thus the thrust force can be directly calculated from the thruster s rpm δ n as in 7 7 t 3 54 1 0 5 δ n 2 0 084 δ n 3 798 where the rpm δ n of either the port or the starboard side is determined by the steering command δ n d and the speed command δ n m which are inversely calculated from 8 and 9 respectively in 8 the steering command δ n d is defined as the rpm difference between δ n p o r t and δ s t b d normalized by the maximum rpm value δ n m a x similarly the speed command is defined as a normalized mean value of both rpms as in 9 8 δ n d δ n p o r t δ n s t b d 2 δ n m a x 9 δ n m δ n p o r t δ n s t b d 2 δ n m a x according to the actuator dynamics presented in woo et al 2018 the absolute value of the rpm δ n and the rate of the rpm δ n are saturated as δ n m a x and δ n m a x respectively as shown in fig 3 among the various dynamic models suggested in woo et al 2018 we adopted the linearized maneuvering dynamics as the model for the simulation owing to the simplicity of the selected model the calculation time of the model is fast enough for running millions of simulation steps from the repetitive training process in a limited time while maintaining an appropriate level of dynamics prediction accuracy for the linearized maneuvering dynamics the speed dynamic model is described as in 10 and the steering dynamics can be represented as in 11 10 u a u u b u u τ x b u b i a s 11 v r a v r b τ n b bias where the matrix a is a 2 by 2 system matrix the matrix b is a 2 by 1 control matrix and b bias is a 2 by 1 matrix for inclusion of the bias term according to the system identification result in woo et al 2018 the unknown parameters in 10 and 11 can be described as in 12 and 13 12 u 1 3191 u 0 0028 u τ x 0 6836 13 v r 0 0161 0 0052 8 2861 0 9860 v r 0 0002 0 0307 τ n 0 0068 1 3276 2 2 guidance as illustrated in fig 1 the role of the guidance block in a usv path following scenario is to determine the desired setpoint course angle value based on the path information and on the current state of the usv for the speed dynamics we did not implement any guidance or control method to simplify the problem this is still a valid approach because in the path following problem there is no temporal specification bibuli et al 2009 contrary to trajectory tracking thus speed dynamics is less important than steering dynamics therefore for the speed dynamics we applied a constant target speed v d to the vehicle s speed controller for the steering dynamics we adopted the vector field guidance vfg method proposed by nelson et al 2007 to determine the desired course angle the vfg method was developed to deal with the path following problem of an unmanned aerial vehicle but was applied to the maritime domain as well by several researchers yiannis and mitchel niu et al 2016 woo and kim 2016 in the vfg method the vector field directly indicates the desired direction of the vehicle to move to follow the given path on the assumption that the autopilot of the course angle system was first order nelson showed a mathematical proof for the lyapunov stability of the guidance see nelson et al 2007 fig 4 shows an example of the vector field for a linear path each of the blue arrows represents the desired course angle of the vehicle when the vehicle is at the designated position according to the figure the desired course tends to be affected by the path angle χ p a t h and the cross track error e y the vehicle s perpendicular distance to the path when e y is small the desired direction is identical to the direction of the path however as e y increases the difference between the path angle and the desired direction tends to increase as well considering this characteristic nelson et al 2007 defined a vector field for a linear path as in 14 according to the equation the maximum deviation of the course angle from the path angle is limited to χ 14 χ d χ t a n 1 k e y χ p a t h a target path for a usv can be represented in various forms such as a polynomial spline often used with the serret frenet frame or a set of waypoints in this study we assumed that a path can be considered as a piecewise linear path and can be represented by a set of waypoints fig 5 shows the path representation using a set of waypoints according to this approach the target path is represented by using a line of sight los from the previous waypoint w k 1 x k 1 y k 1 toward the current waypoint w k x k y k when d is defined as an euclidean distance between w k 1 and w k once the difference between the d and along track error e x became smaller than certain threshold distance value d t h as d e x d t h the target waypoint is changed to the next waypoint with this approach a path can always be considered as a linear path and the vfg model for the linear path can be directly applied to apply the vfg method in path following we need to identify the vehicle s positional error the along track error e x and the cross track error e y the error value can be calculated by using the following process first the direction of the path χ p a t h the direction from w k 1 to the usv χ w k 1 and the distance from the previous waypoint to the usv d w k 1 can be calculated as follows 15 χ p a t h a t a n y k y k 1 x k x k 1 χ w k 1 a t a n y u s v y k 1 x u s v x k 1 d w k 1 y u s v y k 1 2 x u s v x k 1 2 then using the geometric relationship we can calculate the along track error e x and the cross track error e y using 16 16 e x c o s χ p a t h χ w k 1 d w k 1 e y s i n χ p a t h χ w k 1 d w k 1 once the error variables are identified the desired course angle can be calculated using 14 the desired course angle is then used as the setpoint value for the steering controller of the usv in this work a reinforcement learning based controller was used for the steering dynamics controller and a detailed explanation of the controller is provided in section 3 3 reinforcement learning based controller reinforcement learning is one branch of machine learning in which the agent interacts with the environment to find the best policy in supervised learning the desired output information corresponds to the input variable which is provided as a label during the training process however in reinforcement learning the agent directly interacts with the environment without having any information in advance during the training the agent performs an action a t at time t based on the current state s t and policy π as a result of the action a t the current state s t may change according to the transition probability model p s t 1 s t a t based on the evaluation of the state transition a reward r s t a t is received this process is repeated and based on this experience the policy π is trained a policy π can be modeled as a stochastic policy π a s or a deterministic policy π s in a reinforcement learning problem the goal is to find an optimal policy π that maximizes the accumulated discounted reward r t as in 17 sutton and barto 1998 in the following equation γ is known as a discount factor which weighs the future error and has a value between 0 and 1 17 r t r t γ r t 1 γ 2 r t 2 k 1 γ k r t k 1 a policy π can be evaluated by using two value functions a state value function v π s is defined as the expectation of the accumulated discounted reward r t while maintaining the policy π similarly an action value function q π s t a t is defined as a value function for the specific state and action pair s t a t 18 v π s t e π r t s t e π k 1 γ k r t k 1 s t 19 q π s t a t e π r t s t a t e π k 1 γ k r t k 1 s t a t according to the definition of the value functions and the optimal policy π the optimal policy π always satisfies the following conditions 20 π arg max π v π s t arg max π q π s t a t to solve the reinforcement learning problem researchers often use a neural network as an approximator of the value functions however the learning process by updating the temporal difference update of the reinforcement learning algorithm and the training of the neural network approximator for the value function approximation often interfere with each other hindering the learning process to be settled this phenomenon is known as interference problem carreras et al 2003 and was considered as the biggest obstacle to the reinforcement learning to be applied in a real world problem owing to the interference problem training of a large scale neural network often results in unstable outcomes and sometimes even diverges during the learning process recently mnih et al 2015 proposed a training method to deal with a large scale neural network in a reinforcement learning problem the key factor that mnih et al used to eliminate instability was the use of experience replay and a separate target network although the deep q network dqn proposed by mnih et al 2015 significantly improved the stability and performance of the complex reinforcement learning problem the method is not suitable for the usv path following problem because of its discrete action space since the dqn is a type of q learning based reinforcement learning algorithm it uses a discrete action space therefore the agent can only select the best action from among the limited predefined action candidates usually less than 10 action candidates if the number of action candidates is too small precise control of the vehicle becomes difficult especially at the steady state the controller tends to periodically change its action similar to the bang bang control which is known as chattering to overcome this limitation we used a reinforcement learning algorithm that can be applied to a continuous action space the deep deterministic policy gradient ddpg algorithm is an actor critic structure based reinforcement algorithm that can deal with a continuous action space based on the structure and mathematical foundation of a deterministic policy gradient dpg silver et al 2014 the ddpg algorithm can deal with a continuous action space the method assumes that the target policy π is a deterministic policy as μ but uses a stochastic policy β for exploration by this assumption the learning process can be off policy in reinforcement learning method dealing with action value function q π s t a t updating of the q value is performed by using the bellman equation 22 if there is an assumption that the target policy is deterministic then the inner expectation can be eliminated as in 22 since the expectation is dependent on the environment the policy q μ could be learned off policy which means that the exploration can be separated from the learning process silver et al 2014 21 q π s t a t e r t s t 1 e r s t a t γ e a t 1 π q π s t 1 a t 1 22 q μ s t a t e r t s t 1 e r s t a t γ q μ s t 1 m u s t 1 when a neural network based function approximator is parameterized by θ q the approximator can be optimized by minimizing the loss function l θ q in 23 23 l θ q e s t ρ β a t β r t e q s t a t θ q y t 2 where y t is known as the temporal difference target and is defined as follows 24 y t r s t a t γ q s t 1 μ s t 1 θ q by adopting the recently developed techniques in deep reinforcement learning such as experience replay separate target network and batch normalization the ddpg algorithm lillicrap et al 2015 can deal with large scale neural network approximators fig 6 shows a schematic diagram of the structure of the ddpg algorithm used in this work there are two feed forward neural networks namely the actor network and the critic network each of the networks is composed of two hidden layers with 400 and 300 node for the activation of each node a rectified linear unit function is used for the updating of the networks the critic network is updated using the gradient of the loss function l θ q in 23 whereas the actor network uses a deterministic policy gradient silver et al 2014 which can be obtained by using 25 25 θ μ j e s t ρ β θ μ q s a θ q s s t a μ s t θ μ e s t ρ β a q s a θ q s s t a μ s t θ μ μ s θ μ s s t in reinforcement learning the design of the components of the markov decision process is one of the most crucial processes the performance of the algorithm and the speed of the convergence are strongly affected by the correctness of the state space action space and reward in this work the primary goal of the reinforcement learning based controller is to minimize the vehicle s cross track error toward the target path e y whereas the desired course angle is provided by the vector field guidance method according to this the state space s s is defined as 26 26 s χ χ e y e y δ n d where χ is the difference between the course angle of the usv and the desired course angle calculated from the vector field guidance method as χ χ d χ u s v e y is the cross track error and δ n d is a steering command of the usv since χ only provides angular positional error information to the controller the variable e y is added to consider the relative positional error information in generating the control input moreover δ n d is included in the state space to provide the current steering command information to prevent the chattering phenomenon in addition the time derivative variables χ and e y are included to provide the temporal information to the controller in order to obtain the state variables during the experiment we used on board navigation sensor such as gps ahrs to measure the navigational solution a signal processing filter savitzky golay filter is applied to the measurement signal in order to reduce the effect of high frequency sensor noise this is an essential process especially for calculating the time derivative variables without magnifying the sensor noise since the reinforcement learning based controller is designed as a steering controller the action space a a is defined as 27 27 a δ n d where δ n d is a steering control command which defines the rpm commands of the main thrusters as in 9 in this work since the research scope is limited to the path following problem the control action for the reinforcement learning is only focused on the steering control command δ n d this simplifies the complexity of the reinforcement learning problem and boosts the speed of the convergence in the reinforcement learning problem a reward is used to evaluate the performance of the current policy thus we defined a reward function such that it evaluates the current vehicle status based on the goal of the path following problem since the goal of the path following problem is to minimize the cross track error and the course angle error without producing chattering partial reward functions are defined as 28 30 and are illustrated in fig 7 28 r χ e k 1 χ if χ 9 0 e k 1 χ 180 if χ 9 0 e k 1 χ 180 if χ 9 0 29 r e y e k 2 e y 30 r σ δ e k 3 σ δ where χ e y and σ δ are the course angle error cross track error and standard deviation respectively of the recent 20 steering command history values as described in fig 7 the partial reward function has a positive peak value when each sub goal is satisfied for r χ the partial reward has a maximum value when χ is equal to 0 and a minimum value when the error is near 18 0 the negative penalty term prevents the vehicle from turning toward the inverse path direction for r e y the partial reward value reaches a peak value when e y is equal to 0 similarly the value of r σ δ reaches the maximum value when σ δ approaches 0 this is the case when the vehicle maintains its steering command statically without producing any chattering overall the total reward value r is defined as the weighted sum of the partial reward values as in 31 during the training stage the weight variables w χ w e y and w σ δ are selected as 0 4 0 5 and 0 1 respectively combination of the weight variables is determined by using the heuristic approach through repeated trials and errors in our work the constant variables in the partial reward function were selected as 0 1 0 2 and 0 3 for k 1 k 2 and k 3 respectively 31 r w χ e r χ e w e y r e y w σ δ r σ δ in this work the reinforcement learning based controller was trained through repeated up to 8000 episodes and about 750 000 training steps path following simulations during the simulation the initial usv position heading angle and path angle were randomly selected to generate a variety of encounter conditions with the target path the maximum time step for each episode was limited to 1000 steps and each episode was finished when the cross track error e y became larger than 40 m in the training simulation the time step was defined as 0 1 s 10 hz and the size of the minibatch was set to 64 for the training of the network the adam optimizer was used to train both the actor and the critic network the learning rate was set to 10 4 for the actor network and to 10 3 for the critic network the target network transition gain τ was selected as 10 3 and the discount factor γ was selected as 0 99 for the exploration of the training the ornstein uhlenbeck exploration method discussed in lillicrap et al 2015 was used fig 8 illustrates the learning curve achieved as a result of the training the red line represents the moving average of the accumulated reward for each episode and the shaded region represents the standard deviation of the accumulated reward within the moving window the result showed that the average value of the accumulated reward tended to monotonically increase until it reached about 1300 episodes after that phase the average and the standard deviation of the accumulated reward tended to stabilize according to this learning curve we can discover the development tendency of the policy as the training proceeds however it is still uncertain how the policy works as a controller in a path following problem to find out the behavior of the control policies from different training phases we selected four different training phases and extracted the policy parameter from the actor network the extracted parameters were then used for the path following controller and the performance and behavior of the controller are analyzed in the next section 4 validation to validate the path following and self learning capabilities of the proposed method we conducted several usv simulations and free running tests with a full scale usv for validation purposes we selected two different types of path as a target path first we selected a linear path as a target path since a usv path is often represented by a set of waypoints a path can be expressed as a piecewise linear path thus the path following capability of a linear path can be the most fundamental requirement for a usv second a grid search path was selected as a target path a usv is often used to substitute for a human operator in performing dangerous or tedious repeated operations such missions include data collecting mission and object search mission either an above water search or an underwater search which often follow the grid search path a grid search path may be considered as a piecewise linear path however we selected a grid search path since it can cover a dynamic behavior during the path transition of an adjoining piecewise linear path to analyze the proposed method s self learning capability we extracted a series of control policies policies a b c and d during the training process as illustrated in fig 8 the extracted policies were then implemented in the full scale usv as a steering controller a number of path following experiments were conducted with different target path types and various control policies an experiment was conducted in pyeongtaek lake south korea during a calm water condition for the usv as mentioned in section 2 the wam v platform was used as a target usv note that the control policies were trained by simulation but were directly implemented in the free running experiment we concluded that this was still reasonable since the dynamic model used in the simulation was directly identified from the same usv platform and actuators using the system identification experiment woo et al 2018 fig 9 shows the experimental area and the wam v platform during the path following experiment fig 10 shows a number of usv trajectories resulting from the linear path following experiment with different control policies for each control policy an identical linear path was used as the target path in addition the initial value of the position and heading angle of the vehicle was intentionally controlled in an attempt to eliminate its effect on the path following capability the right side of fig 10 shows an aerial snapshot of the usv during the path following experiment with various control policies the snapshot pictures were taken sequentially at 4 s of time interval in this work we used two error variables to measure the performance of the control policy namely the cross track error e y and the course angle error χ the cross track error is defined as a lateral positional error that is perpendicular to the path angle whereas the course angle error is defined as the difference between the usv course angle and the desired course angle calculated from the vfg guidance command fig 11 shows the time history of the cross track error and the course angle error during the path following experiments and fig 12 shows the corresponding control input during the experiments according to the experimental result as the training proceeded from policy a to policy d the linear path following capability tended to develop at the initial training stage policy a the control policy generated a hardover maneuver toward the port side producing a full negative steering command continuously as soon as the path following mode was switched on this could cause a repeated turning maneuver of the usv as indicated by the green line in fig 10 after a certain period of training about 400 more training episodes control policy b could be achieved as illustrated in the magenta colored line in fig 10 the control policy tended to track the desired course angle at the initial stage however as soon as the course angle error exceed certain threshold value at approximately 18 s the vehicle tended to perform a hardover toward the port side see fig 12 this indicates that the policy was capable of tracking the desired course angle when it had a negative course angle error however once the course angle error reached a positive value the control policy started to produce a continuous negative steering command like what policy a did this phenomenon vanished when the training process reached policy c according to the usv trajectory in fig 10 the usv did not produce a hardover steering command anymore the path following capability of policy c was superior to those of policies a and b however this policy tended to have a steady state error once the training stage reached policy d the path following capability tended to become robust enough to track a linear path the control policy did not produce a hardover command or a steady state tracking error note that the steering command δ n m remains nearly zero during the steady state on dynamic equilibrium point such command may be different if there exists side direction force acting on the vehicle such as wind or current loads fig 13 shows the comparison result of the different control policies for the linear path following problem both the cross track and the course angle error tended to decrease as the training proceeded so far we have demonstrated the feasibility of the proposed ddpg based controller by comparing the path following result of a number of ddpg policy extracted from different learning stages in order to analyze the performance of the ddpg algorithm we have conducted linear path following simulations using benchmark controllers as well for the comparison we have selected a conventional pid controller and dqn based controller as benchmark controllers for the control gain of the pid controller we have heuristically tuned the pid controller until the control performance reaches to a suitable level figs 14 16 represents comparison results of the linear path following simulation using a number of different controllers as a result of the comparison the proposed method and dqn based controller tends to have a comparable path following ability as the conventional pid controller however the dqn based controller has a chattering tendency which produces constant switching of the control input such tendency occurs because the number of action candidate is limited e g only 10 action candidates thus in most of the case a sub optimal steering command is chosen from the candidates instead of optimal value for that condition because of this tendency sometimes the sub optimal action produces overshoot during the control to suppress the overshoot a control input with opposite direction is chosen and by repeating this process chattering occurs in the case of the ddpg based controller due to the continuous action space characteristics there exists no such problem while it follows the target path with comparable control performance as the conventional pid controller since the conventional pid controller is designed for siso single input single output system the control command of the pid controller depends on only the course angle error however in the case of the drl based controller both the cross track error and course angle error are simultaneously used for calculating the control command such capability to consider multiple process variable is one of the characteristics of the drl based controller see fig 15 table 1 describes the comparison result of each controller during the linear path following validations the dynamic characteristics of the respective control policies during the linear path following could also be found during the search path following since the search path was composed of piecewise linear paths the hardover characteristics in policies a and b and the steady state error characteristic in policy c were also found in the search path following experimental data this is shown in fig 17 where fig 17 left represents the trajectory of the usv during the path following experiment with various control policies and fig 17 right shows the simulation result of the usv with the same condition as in fig 17 left by comparing the figures we can see that the dynamic behaviors of the usv were similar in both data in addition the distinctive characteristics of each control policy could be found in both data with this phenomenon we can conclude that the policies trained by the usv simulator can be directly applied to the free running experiment although unmodeled dynamics terms or environmental disturbance may exist in fig 18 the cross track error and the course angle error during the experiment are shown respectively like in the linear path following there was a steady state error in both the cross track error and the course angle error one noticeable feature was that the sign of the steady state errors was always positive except for the transient phase this means that the vehicle tended to be on the right side of the current piecewise linear path similarly the direction of the hardover turning of policies a and b was always in the same direction port side turning this phenomenon could be found in both the linear and the search path case as well as in both the experiment and the simulation data in the result of policy d both the cross track and course angle error tends to be stabilized as soon as the abrupt error is produced by waypoint transition overall we can say that the reinforcement learning based control policies possessed a control habit which resulted in a distinctive maneuver under certain conditions at the initial training stage such habits resulted in drawbacks in the path following capability preventing the vehicle from properly following its target path however as the training proceeded the control habit tended to be eliminated and the control capability tended to develop by itself this phenomenon could also be found in the learning curve fig 8 where the accumulated reward value increased monotonically as the training proceeded although we can be empirically aware of the existence of the control habit and its effect on the path following performance because of the massive number of training variables and the complex structure of the policy network it was impossible to provide an analytical reason as to why such defects were produced and how the control habit generated such distinctive maneuvers this is one of the drawbacks of the drl based controller in cases involving a massive deep neural network it is hard to provide an analytical reason as to why such behavior is produced which makes it more difficult to analyze the produced result similarly there is a limitation on analytical stability analysis of the overall system when using a massive and complex deep neural network in such case instead of analytic way the stability of the controller is often proved by the empirical way such as repeated validation field tests rodriguez ramos et al 2019 according to the learning curve fig 8 the average reward value of policies a b and c was not fully developed at the stages such underdevelopment could also be found in the activation history of each hidden node in a policy network fig 20 shows the histogram of the probability of each hidden node being activated during the linear path following scenario for the fair comparison we have limited the period of comparison as an initial transient phase until the course angle error reaches 5 of its initial value by doing this the time length of the steady state does not affect to the histogram distribution in the case of policy a according to fig 20 a the hidden nodes tended to be either always inactive or always active this means that only a small number of hidden nodes produced a control action whereas a number of nodes did not play any role in producing a control action this tendency tended to gradually vanish as the training proceeded in the case of policy d the number of nodes with varying activation probabilities seemed to be uniformly distributed compared to the histogram of policies a b and c this implies that most of the hidden nodes in the policy network participated in generating a control action command this is a desirable phenomenon because by doing so the policy network becomes accessible to the neural network s full capacity of approximating the policy 5 conclusion in this work we proposed a deep reinforcement learning based controller for path following of an unmanned surface vehicle usv a deep deterministic policy gradient ddpg algorithm was used to construct the steering controller and with the use of repeated path following simulation the learning based control policy was trained while the training proceeded four different control policies were extracted in consecutive order the extracted control policies were then implemented in a full scale usv to validate its path following capability according to the results of the path following simulations and experiments the extracted control policy tended to possess a control habit at the initial stage of the training the control habit prevented the vehicle from properly following the target path this phenomenon was due to the inadequate training of the policy network and we found that the hidden nodes in the policy network were not uniformly active at this stage of the training as the training stage continued the path following performance tended to develop resulting in a decrease in the cross track error and the course angle error the self learning ability of the usv controller by interacting with the nearby environment is one of the most distinctive features of the proposed method such capability can be applied to solve a problem dealing with the uncertain environmental condition in future work it may be beneficial to replace simulation based training with experimental data based training or real time training in addition a reinforcement learning based controller for disturbance rejection could be developed to deal with unmodeled and time varying environmental disturbance moreover the reinforcement learning based controller can be extended to much broader research areas such as trajectory tracking or collision avoidance as well acknowledgments this work was supported by a research institute of marine systems engineering of seoul national university republic of korea b agency for defense development ud160009dd of republic of korea 
22761,in this paper a deep reinforcement learning drl based controller for path following of an unmanned surface vehicle usv is proposed the proposed controller can self develop a vehicle s path following capability by interacting with the nearby environment a deep deterministic policy gradient ddpg algorithm which is an actor critic based reinforcement learning algorithm was adapted to capture the usv s experience during the path following trials a markov decision process model which includes the state action and reward formulation specially designed for the usv path following problem is suggested the control policy was trained with repeated trials of path following simulation the proposed method s path following and self learning capabilities were validated through usv simulation and a free running test of the full scale usv keywords deep reinforcement learning path following unmanned surface vehicle learning based control artificial intelligence 1 introduction recently unmanned surface vehicles usvs have been actively adopted in both military and commercial areas in terms of safety usvs can replace humans in tasks performed in dangerous and extreme environments such as mine countermeasures bertram 2008 anti submarine warfare corfield and young 2006 and reconnaissance kucik 2004 in terms of economic efficiency usvs can replace humans in performing repetitive and tedious missions such as resource exploration majohr and buch 2006 or oceanic sample acquisition naeem et al 2006 although there are different types of usvs designed for different tasks their common feature is their path following capability which is one of the most fundamental capabilities that any usv must possess for this a usv must have a properly designed path following controller that is effective and robust various control algorithms have been developed by many researchers to implement path following in unmanned marine vehicles these include the proportional integral derivative control lekkas and fossen 2012 bibuli et al 2009 sliding mode control meng et al 2012 backstepping control sonnenburg and woolsey 2013 fuzzy control zhu et al 2016 garus and zak 2010 and model predictive control naeem et al 2006 in recent years there have been many attempts to deal with uncertainty in the control domain such as disturbance or dynamic modeling uncertainty an adaptive control algorithm shin et al 2017 mu et al 2017 has been developed in an attempt to consider the uncertainty in the vehicle s dynamic model in lu et al 2018 minimal learning parameter mlp and the disturbance observer dob techniques are adopted to deal with usv formation control similarly a robust neural algorithm was adopted to deal with uncertainty in zhang et al 2018 while the usv is performing path following control in presence of multiple obstacles although a number of usv path following controllers have been proposed most of the approaches have limitations in terms of dependency on prior knowledge of dynamic modeling and handling of modeling uncertainty to overcome such limitations we adopted recently devised machine learning techniques to develop a usv controller the proposed deep reinforcement learning drl based usv controller has self learning capability and thus it does not require any prior knowledge of usv dynamics to tune the controller similarly because the learning process directly uses experience data consisting of the control input and the corresponding dynamic response of the vehicle the controller can implicitly consider modeling the uncertainty or the effect of environmental disturbances as well in recent years there have been several attempts to implement machine learning techniques in the field of unmanned maritime vehicles bertaska 2016 bertaska and von ellenrieder 2018 cheng and zhang 2018 magalhães et al 2018 carreras et al 2003 zhang et al 2014 de paula and acosta 2015 yoo and kim 2016 woo 2018 cui et al 2017 bertaska 2016 used a traditional q learning approach to develop a supervisory switching controller for usvs in this work three basis controllers were specially designed for transiting station keeping and reversing maneuver respectively then a q learning algorithm was used to intelligently switch the basis controller of the usv according to the current situation and maneuver of the usv a full scale usv experiment was conducted to validate the proposed method cheng and zhang 2018 adopted a drl technique for obstacle avoidance of an underactuated unmanned marine vehicle in this work convolutional layers were used to capture the obstacle s information and a reward was specially designed for obstacle avoidance tasks magalhães et al 2018 devised a conventional q learning based reinforcement learning technique to develop a biomimetic underwater vehicle controller in their work the q learning based controller mimicked the stroke style of a fish with two lateral fins and a tail the control policy was trained by using a biomimetic vehicle simulator and the learned model was transferred to the real vehicle for validation woo and kim 2016 adopted the deep reinforcement learning in the field of collision avoidance of an unmanned surface vehicle by expressing the encounter situation using a grid map based visual information an unmanned surface vehicle can deal with avoidance decision making in complex encounter situation similar to magalhães et al 2018 a policy model was trained in simulation environment and additional validation experiment was conducted some of the contributions of the proposed method to the field of marine vehicle control are as follows first this work was the first implementation of continuous action space reinforcement learning in the control of an unmanned marine vehicle there exist some works that used reinforcement learning for control purposes magalhães et al 2018 carreras et al 2003 however they defined action space as discrete actions with only a few action candidates the small number of action candidates hinders the precise control of a vehicle or often results in the chattering phenomenon second we applied the drl based controller to a full scale usv control and conducted a number of real world experiments for validation in most of the works related to reinforcement learning on a marine vehicle the training and the validation domain were restricted to simulation in contrast we extended the domain into a real world domain to show its practical applicability the rest of the paper is organized as follows in section 2 the usv dynamics and path following system used in this work are presented in section 3 the theoretical background and problem formulation of the reinforcement learning based controller are given in section 4 the validation of the proposed method through full scale usv path following experiments is discussed as well as the test results and analysis conducted finally in section 5 the main conclusions and additional discussions are presented 2 usv path following according to the theoretical background on reinforcement learning a learning based controller is developed through a repeated training process during the training the controller will perform an action that is then evaluated on the basis of the response of the environment to the conducted action because of these characteristics a learning based controller requires an environment to interact with to be trained in this work we conducted usv path following simulations to train the controller fig 1 shows a schematic diagram of the usv path following system for the training simulation as illustrated a dynamic system should be implemented to describe the vehicle s dynamic behavior and a guidance block is adopted to determine the desired course angle the rest of this section provides detailed information about the components of the usv path following system 2 1 usv dynamic model in this work we selected a 16 ft wave adaptive modular vessel wam v platform as the target usv type a wam v platform is a catamaran shaped platform with two inflatable pontoons hulls with a wave shock observer described in fig 2 the vehicle was equipped with two electric thrusters on each hull and the thruster vector angle was fixed as illustrated in fig 2 because of this characteristic the vehicle generated yaw motion by making rpm differences in the two thrusters known as differential thruster type woo et al 2018 recently conducted a dynamic system identification on an identical platform in his work several dynamic model including simplified dynamics and lstm based deep neural network model was identified in this work we adopted the identification result of the simplified dynamic model represented in woo et al 2018 as a simulation model once the simulation based training process was finished the trained controller was implemented on the wam v platform and path following experiments were conducted to validate its performance since a horizontal planar motion of the usv is the primary concern in a path following problem we mainly focused on 3 degrees of freedom 3dof usv motions surge sway and yaw motion for the notation the one proposed by fossen 2002 was used the coordinate system used in this work is illustrated in fig 2 where x i and y i are the north and the east directional position respectively of the usv in the inertial frame whereas u v and v are the surge sway and total speed respectively of the vehicle in a body fixed frame the heading angle of the usv is defined as ψ whereas the course angle and the side slip angle are represented by χ and β respectively by definition the side slip angle β can be calculated by the equation β a s i n v v and the course angle can be described by the sum of ψ and β as in the expression χ ψ β the usv kinematic model can be described as in 1 where ν and η are defined as the velocity vector and the position vector respectively r η is a rotation matrix from a body fixed frame to an inertial frame 1 η r η ν 2 ν u v r t 3 η x i y i ψ t 4 r η c o s ψ s i n ψ 0 s i n ψ c o s ψ 0 0 0 1 the 3dof horizontal planar dynamic model of the usv can be described by the following equation 5 m ν c ν ν d ν ν f where m is the mass matrix c ν is the coriolis and centripetal matrix d ν is the damping matrix and f is the control forces and moment since the target usv was a differential thruster type the control forces and moment f can be described as follows 6 f τ x τ y τ n t p o r t t s t b d 0 t p o r t t s t b d b 2 in the above equation t p o r t and t s t b d represent the thrust force of the port side and the starboard side thruster respectively and b refers to the beam of the target usv we implemented an actuator model based on model of woo et al 2018 thus the thrust force can be directly calculated from the thruster s rpm δ n as in 7 7 t 3 54 1 0 5 δ n 2 0 084 δ n 3 798 where the rpm δ n of either the port or the starboard side is determined by the steering command δ n d and the speed command δ n m which are inversely calculated from 8 and 9 respectively in 8 the steering command δ n d is defined as the rpm difference between δ n p o r t and δ s t b d normalized by the maximum rpm value δ n m a x similarly the speed command is defined as a normalized mean value of both rpms as in 9 8 δ n d δ n p o r t δ n s t b d 2 δ n m a x 9 δ n m δ n p o r t δ n s t b d 2 δ n m a x according to the actuator dynamics presented in woo et al 2018 the absolute value of the rpm δ n and the rate of the rpm δ n are saturated as δ n m a x and δ n m a x respectively as shown in fig 3 among the various dynamic models suggested in woo et al 2018 we adopted the linearized maneuvering dynamics as the model for the simulation owing to the simplicity of the selected model the calculation time of the model is fast enough for running millions of simulation steps from the repetitive training process in a limited time while maintaining an appropriate level of dynamics prediction accuracy for the linearized maneuvering dynamics the speed dynamic model is described as in 10 and the steering dynamics can be represented as in 11 10 u a u u b u u τ x b u b i a s 11 v r a v r b τ n b bias where the matrix a is a 2 by 2 system matrix the matrix b is a 2 by 1 control matrix and b bias is a 2 by 1 matrix for inclusion of the bias term according to the system identification result in woo et al 2018 the unknown parameters in 10 and 11 can be described as in 12 and 13 12 u 1 3191 u 0 0028 u τ x 0 6836 13 v r 0 0161 0 0052 8 2861 0 9860 v r 0 0002 0 0307 τ n 0 0068 1 3276 2 2 guidance as illustrated in fig 1 the role of the guidance block in a usv path following scenario is to determine the desired setpoint course angle value based on the path information and on the current state of the usv for the speed dynamics we did not implement any guidance or control method to simplify the problem this is still a valid approach because in the path following problem there is no temporal specification bibuli et al 2009 contrary to trajectory tracking thus speed dynamics is less important than steering dynamics therefore for the speed dynamics we applied a constant target speed v d to the vehicle s speed controller for the steering dynamics we adopted the vector field guidance vfg method proposed by nelson et al 2007 to determine the desired course angle the vfg method was developed to deal with the path following problem of an unmanned aerial vehicle but was applied to the maritime domain as well by several researchers yiannis and mitchel niu et al 2016 woo and kim 2016 in the vfg method the vector field directly indicates the desired direction of the vehicle to move to follow the given path on the assumption that the autopilot of the course angle system was first order nelson showed a mathematical proof for the lyapunov stability of the guidance see nelson et al 2007 fig 4 shows an example of the vector field for a linear path each of the blue arrows represents the desired course angle of the vehicle when the vehicle is at the designated position according to the figure the desired course tends to be affected by the path angle χ p a t h and the cross track error e y the vehicle s perpendicular distance to the path when e y is small the desired direction is identical to the direction of the path however as e y increases the difference between the path angle and the desired direction tends to increase as well considering this characteristic nelson et al 2007 defined a vector field for a linear path as in 14 according to the equation the maximum deviation of the course angle from the path angle is limited to χ 14 χ d χ t a n 1 k e y χ p a t h a target path for a usv can be represented in various forms such as a polynomial spline often used with the serret frenet frame or a set of waypoints in this study we assumed that a path can be considered as a piecewise linear path and can be represented by a set of waypoints fig 5 shows the path representation using a set of waypoints according to this approach the target path is represented by using a line of sight los from the previous waypoint w k 1 x k 1 y k 1 toward the current waypoint w k x k y k when d is defined as an euclidean distance between w k 1 and w k once the difference between the d and along track error e x became smaller than certain threshold distance value d t h as d e x d t h the target waypoint is changed to the next waypoint with this approach a path can always be considered as a linear path and the vfg model for the linear path can be directly applied to apply the vfg method in path following we need to identify the vehicle s positional error the along track error e x and the cross track error e y the error value can be calculated by using the following process first the direction of the path χ p a t h the direction from w k 1 to the usv χ w k 1 and the distance from the previous waypoint to the usv d w k 1 can be calculated as follows 15 χ p a t h a t a n y k y k 1 x k x k 1 χ w k 1 a t a n y u s v y k 1 x u s v x k 1 d w k 1 y u s v y k 1 2 x u s v x k 1 2 then using the geometric relationship we can calculate the along track error e x and the cross track error e y using 16 16 e x c o s χ p a t h χ w k 1 d w k 1 e y s i n χ p a t h χ w k 1 d w k 1 once the error variables are identified the desired course angle can be calculated using 14 the desired course angle is then used as the setpoint value for the steering controller of the usv in this work a reinforcement learning based controller was used for the steering dynamics controller and a detailed explanation of the controller is provided in section 3 3 reinforcement learning based controller reinforcement learning is one branch of machine learning in which the agent interacts with the environment to find the best policy in supervised learning the desired output information corresponds to the input variable which is provided as a label during the training process however in reinforcement learning the agent directly interacts with the environment without having any information in advance during the training the agent performs an action a t at time t based on the current state s t and policy π as a result of the action a t the current state s t may change according to the transition probability model p s t 1 s t a t based on the evaluation of the state transition a reward r s t a t is received this process is repeated and based on this experience the policy π is trained a policy π can be modeled as a stochastic policy π a s or a deterministic policy π s in a reinforcement learning problem the goal is to find an optimal policy π that maximizes the accumulated discounted reward r t as in 17 sutton and barto 1998 in the following equation γ is known as a discount factor which weighs the future error and has a value between 0 and 1 17 r t r t γ r t 1 γ 2 r t 2 k 1 γ k r t k 1 a policy π can be evaluated by using two value functions a state value function v π s is defined as the expectation of the accumulated discounted reward r t while maintaining the policy π similarly an action value function q π s t a t is defined as a value function for the specific state and action pair s t a t 18 v π s t e π r t s t e π k 1 γ k r t k 1 s t 19 q π s t a t e π r t s t a t e π k 1 γ k r t k 1 s t a t according to the definition of the value functions and the optimal policy π the optimal policy π always satisfies the following conditions 20 π arg max π v π s t arg max π q π s t a t to solve the reinforcement learning problem researchers often use a neural network as an approximator of the value functions however the learning process by updating the temporal difference update of the reinforcement learning algorithm and the training of the neural network approximator for the value function approximation often interfere with each other hindering the learning process to be settled this phenomenon is known as interference problem carreras et al 2003 and was considered as the biggest obstacle to the reinforcement learning to be applied in a real world problem owing to the interference problem training of a large scale neural network often results in unstable outcomes and sometimes even diverges during the learning process recently mnih et al 2015 proposed a training method to deal with a large scale neural network in a reinforcement learning problem the key factor that mnih et al used to eliminate instability was the use of experience replay and a separate target network although the deep q network dqn proposed by mnih et al 2015 significantly improved the stability and performance of the complex reinforcement learning problem the method is not suitable for the usv path following problem because of its discrete action space since the dqn is a type of q learning based reinforcement learning algorithm it uses a discrete action space therefore the agent can only select the best action from among the limited predefined action candidates usually less than 10 action candidates if the number of action candidates is too small precise control of the vehicle becomes difficult especially at the steady state the controller tends to periodically change its action similar to the bang bang control which is known as chattering to overcome this limitation we used a reinforcement learning algorithm that can be applied to a continuous action space the deep deterministic policy gradient ddpg algorithm is an actor critic structure based reinforcement algorithm that can deal with a continuous action space based on the structure and mathematical foundation of a deterministic policy gradient dpg silver et al 2014 the ddpg algorithm can deal with a continuous action space the method assumes that the target policy π is a deterministic policy as μ but uses a stochastic policy β for exploration by this assumption the learning process can be off policy in reinforcement learning method dealing with action value function q π s t a t updating of the q value is performed by using the bellman equation 22 if there is an assumption that the target policy is deterministic then the inner expectation can be eliminated as in 22 since the expectation is dependent on the environment the policy q μ could be learned off policy which means that the exploration can be separated from the learning process silver et al 2014 21 q π s t a t e r t s t 1 e r s t a t γ e a t 1 π q π s t 1 a t 1 22 q μ s t a t e r t s t 1 e r s t a t γ q μ s t 1 m u s t 1 when a neural network based function approximator is parameterized by θ q the approximator can be optimized by minimizing the loss function l θ q in 23 23 l θ q e s t ρ β a t β r t e q s t a t θ q y t 2 where y t is known as the temporal difference target and is defined as follows 24 y t r s t a t γ q s t 1 μ s t 1 θ q by adopting the recently developed techniques in deep reinforcement learning such as experience replay separate target network and batch normalization the ddpg algorithm lillicrap et al 2015 can deal with large scale neural network approximators fig 6 shows a schematic diagram of the structure of the ddpg algorithm used in this work there are two feed forward neural networks namely the actor network and the critic network each of the networks is composed of two hidden layers with 400 and 300 node for the activation of each node a rectified linear unit function is used for the updating of the networks the critic network is updated using the gradient of the loss function l θ q in 23 whereas the actor network uses a deterministic policy gradient silver et al 2014 which can be obtained by using 25 25 θ μ j e s t ρ β θ μ q s a θ q s s t a μ s t θ μ e s t ρ β a q s a θ q s s t a μ s t θ μ μ s θ μ s s t in reinforcement learning the design of the components of the markov decision process is one of the most crucial processes the performance of the algorithm and the speed of the convergence are strongly affected by the correctness of the state space action space and reward in this work the primary goal of the reinforcement learning based controller is to minimize the vehicle s cross track error toward the target path e y whereas the desired course angle is provided by the vector field guidance method according to this the state space s s is defined as 26 26 s χ χ e y e y δ n d where χ is the difference between the course angle of the usv and the desired course angle calculated from the vector field guidance method as χ χ d χ u s v e y is the cross track error and δ n d is a steering command of the usv since χ only provides angular positional error information to the controller the variable e y is added to consider the relative positional error information in generating the control input moreover δ n d is included in the state space to provide the current steering command information to prevent the chattering phenomenon in addition the time derivative variables χ and e y are included to provide the temporal information to the controller in order to obtain the state variables during the experiment we used on board navigation sensor such as gps ahrs to measure the navigational solution a signal processing filter savitzky golay filter is applied to the measurement signal in order to reduce the effect of high frequency sensor noise this is an essential process especially for calculating the time derivative variables without magnifying the sensor noise since the reinforcement learning based controller is designed as a steering controller the action space a a is defined as 27 27 a δ n d where δ n d is a steering control command which defines the rpm commands of the main thrusters as in 9 in this work since the research scope is limited to the path following problem the control action for the reinforcement learning is only focused on the steering control command δ n d this simplifies the complexity of the reinforcement learning problem and boosts the speed of the convergence in the reinforcement learning problem a reward is used to evaluate the performance of the current policy thus we defined a reward function such that it evaluates the current vehicle status based on the goal of the path following problem since the goal of the path following problem is to minimize the cross track error and the course angle error without producing chattering partial reward functions are defined as 28 30 and are illustrated in fig 7 28 r χ e k 1 χ if χ 9 0 e k 1 χ 180 if χ 9 0 e k 1 χ 180 if χ 9 0 29 r e y e k 2 e y 30 r σ δ e k 3 σ δ where χ e y and σ δ are the course angle error cross track error and standard deviation respectively of the recent 20 steering command history values as described in fig 7 the partial reward function has a positive peak value when each sub goal is satisfied for r χ the partial reward has a maximum value when χ is equal to 0 and a minimum value when the error is near 18 0 the negative penalty term prevents the vehicle from turning toward the inverse path direction for r e y the partial reward value reaches a peak value when e y is equal to 0 similarly the value of r σ δ reaches the maximum value when σ δ approaches 0 this is the case when the vehicle maintains its steering command statically without producing any chattering overall the total reward value r is defined as the weighted sum of the partial reward values as in 31 during the training stage the weight variables w χ w e y and w σ δ are selected as 0 4 0 5 and 0 1 respectively combination of the weight variables is determined by using the heuristic approach through repeated trials and errors in our work the constant variables in the partial reward function were selected as 0 1 0 2 and 0 3 for k 1 k 2 and k 3 respectively 31 r w χ e r χ e w e y r e y w σ δ r σ δ in this work the reinforcement learning based controller was trained through repeated up to 8000 episodes and about 750 000 training steps path following simulations during the simulation the initial usv position heading angle and path angle were randomly selected to generate a variety of encounter conditions with the target path the maximum time step for each episode was limited to 1000 steps and each episode was finished when the cross track error e y became larger than 40 m in the training simulation the time step was defined as 0 1 s 10 hz and the size of the minibatch was set to 64 for the training of the network the adam optimizer was used to train both the actor and the critic network the learning rate was set to 10 4 for the actor network and to 10 3 for the critic network the target network transition gain τ was selected as 10 3 and the discount factor γ was selected as 0 99 for the exploration of the training the ornstein uhlenbeck exploration method discussed in lillicrap et al 2015 was used fig 8 illustrates the learning curve achieved as a result of the training the red line represents the moving average of the accumulated reward for each episode and the shaded region represents the standard deviation of the accumulated reward within the moving window the result showed that the average value of the accumulated reward tended to monotonically increase until it reached about 1300 episodes after that phase the average and the standard deviation of the accumulated reward tended to stabilize according to this learning curve we can discover the development tendency of the policy as the training proceeds however it is still uncertain how the policy works as a controller in a path following problem to find out the behavior of the control policies from different training phases we selected four different training phases and extracted the policy parameter from the actor network the extracted parameters were then used for the path following controller and the performance and behavior of the controller are analyzed in the next section 4 validation to validate the path following and self learning capabilities of the proposed method we conducted several usv simulations and free running tests with a full scale usv for validation purposes we selected two different types of path as a target path first we selected a linear path as a target path since a usv path is often represented by a set of waypoints a path can be expressed as a piecewise linear path thus the path following capability of a linear path can be the most fundamental requirement for a usv second a grid search path was selected as a target path a usv is often used to substitute for a human operator in performing dangerous or tedious repeated operations such missions include data collecting mission and object search mission either an above water search or an underwater search which often follow the grid search path a grid search path may be considered as a piecewise linear path however we selected a grid search path since it can cover a dynamic behavior during the path transition of an adjoining piecewise linear path to analyze the proposed method s self learning capability we extracted a series of control policies policies a b c and d during the training process as illustrated in fig 8 the extracted policies were then implemented in the full scale usv as a steering controller a number of path following experiments were conducted with different target path types and various control policies an experiment was conducted in pyeongtaek lake south korea during a calm water condition for the usv as mentioned in section 2 the wam v platform was used as a target usv note that the control policies were trained by simulation but were directly implemented in the free running experiment we concluded that this was still reasonable since the dynamic model used in the simulation was directly identified from the same usv platform and actuators using the system identification experiment woo et al 2018 fig 9 shows the experimental area and the wam v platform during the path following experiment fig 10 shows a number of usv trajectories resulting from the linear path following experiment with different control policies for each control policy an identical linear path was used as the target path in addition the initial value of the position and heading angle of the vehicle was intentionally controlled in an attempt to eliminate its effect on the path following capability the right side of fig 10 shows an aerial snapshot of the usv during the path following experiment with various control policies the snapshot pictures were taken sequentially at 4 s of time interval in this work we used two error variables to measure the performance of the control policy namely the cross track error e y and the course angle error χ the cross track error is defined as a lateral positional error that is perpendicular to the path angle whereas the course angle error is defined as the difference between the usv course angle and the desired course angle calculated from the vfg guidance command fig 11 shows the time history of the cross track error and the course angle error during the path following experiments and fig 12 shows the corresponding control input during the experiments according to the experimental result as the training proceeded from policy a to policy d the linear path following capability tended to develop at the initial training stage policy a the control policy generated a hardover maneuver toward the port side producing a full negative steering command continuously as soon as the path following mode was switched on this could cause a repeated turning maneuver of the usv as indicated by the green line in fig 10 after a certain period of training about 400 more training episodes control policy b could be achieved as illustrated in the magenta colored line in fig 10 the control policy tended to track the desired course angle at the initial stage however as soon as the course angle error exceed certain threshold value at approximately 18 s the vehicle tended to perform a hardover toward the port side see fig 12 this indicates that the policy was capable of tracking the desired course angle when it had a negative course angle error however once the course angle error reached a positive value the control policy started to produce a continuous negative steering command like what policy a did this phenomenon vanished when the training process reached policy c according to the usv trajectory in fig 10 the usv did not produce a hardover steering command anymore the path following capability of policy c was superior to those of policies a and b however this policy tended to have a steady state error once the training stage reached policy d the path following capability tended to become robust enough to track a linear path the control policy did not produce a hardover command or a steady state tracking error note that the steering command δ n m remains nearly zero during the steady state on dynamic equilibrium point such command may be different if there exists side direction force acting on the vehicle such as wind or current loads fig 13 shows the comparison result of the different control policies for the linear path following problem both the cross track and the course angle error tended to decrease as the training proceeded so far we have demonstrated the feasibility of the proposed ddpg based controller by comparing the path following result of a number of ddpg policy extracted from different learning stages in order to analyze the performance of the ddpg algorithm we have conducted linear path following simulations using benchmark controllers as well for the comparison we have selected a conventional pid controller and dqn based controller as benchmark controllers for the control gain of the pid controller we have heuristically tuned the pid controller until the control performance reaches to a suitable level figs 14 16 represents comparison results of the linear path following simulation using a number of different controllers as a result of the comparison the proposed method and dqn based controller tends to have a comparable path following ability as the conventional pid controller however the dqn based controller has a chattering tendency which produces constant switching of the control input such tendency occurs because the number of action candidate is limited e g only 10 action candidates thus in most of the case a sub optimal steering command is chosen from the candidates instead of optimal value for that condition because of this tendency sometimes the sub optimal action produces overshoot during the control to suppress the overshoot a control input with opposite direction is chosen and by repeating this process chattering occurs in the case of the ddpg based controller due to the continuous action space characteristics there exists no such problem while it follows the target path with comparable control performance as the conventional pid controller since the conventional pid controller is designed for siso single input single output system the control command of the pid controller depends on only the course angle error however in the case of the drl based controller both the cross track error and course angle error are simultaneously used for calculating the control command such capability to consider multiple process variable is one of the characteristics of the drl based controller see fig 15 table 1 describes the comparison result of each controller during the linear path following validations the dynamic characteristics of the respective control policies during the linear path following could also be found during the search path following since the search path was composed of piecewise linear paths the hardover characteristics in policies a and b and the steady state error characteristic in policy c were also found in the search path following experimental data this is shown in fig 17 where fig 17 left represents the trajectory of the usv during the path following experiment with various control policies and fig 17 right shows the simulation result of the usv with the same condition as in fig 17 left by comparing the figures we can see that the dynamic behaviors of the usv were similar in both data in addition the distinctive characteristics of each control policy could be found in both data with this phenomenon we can conclude that the policies trained by the usv simulator can be directly applied to the free running experiment although unmodeled dynamics terms or environmental disturbance may exist in fig 18 the cross track error and the course angle error during the experiment are shown respectively like in the linear path following there was a steady state error in both the cross track error and the course angle error one noticeable feature was that the sign of the steady state errors was always positive except for the transient phase this means that the vehicle tended to be on the right side of the current piecewise linear path similarly the direction of the hardover turning of policies a and b was always in the same direction port side turning this phenomenon could be found in both the linear and the search path case as well as in both the experiment and the simulation data in the result of policy d both the cross track and course angle error tends to be stabilized as soon as the abrupt error is produced by waypoint transition overall we can say that the reinforcement learning based control policies possessed a control habit which resulted in a distinctive maneuver under certain conditions at the initial training stage such habits resulted in drawbacks in the path following capability preventing the vehicle from properly following its target path however as the training proceeded the control habit tended to be eliminated and the control capability tended to develop by itself this phenomenon could also be found in the learning curve fig 8 where the accumulated reward value increased monotonically as the training proceeded although we can be empirically aware of the existence of the control habit and its effect on the path following performance because of the massive number of training variables and the complex structure of the policy network it was impossible to provide an analytical reason as to why such defects were produced and how the control habit generated such distinctive maneuvers this is one of the drawbacks of the drl based controller in cases involving a massive deep neural network it is hard to provide an analytical reason as to why such behavior is produced which makes it more difficult to analyze the produced result similarly there is a limitation on analytical stability analysis of the overall system when using a massive and complex deep neural network in such case instead of analytic way the stability of the controller is often proved by the empirical way such as repeated validation field tests rodriguez ramos et al 2019 according to the learning curve fig 8 the average reward value of policies a b and c was not fully developed at the stages such underdevelopment could also be found in the activation history of each hidden node in a policy network fig 20 shows the histogram of the probability of each hidden node being activated during the linear path following scenario for the fair comparison we have limited the period of comparison as an initial transient phase until the course angle error reaches 5 of its initial value by doing this the time length of the steady state does not affect to the histogram distribution in the case of policy a according to fig 20 a the hidden nodes tended to be either always inactive or always active this means that only a small number of hidden nodes produced a control action whereas a number of nodes did not play any role in producing a control action this tendency tended to gradually vanish as the training proceeded in the case of policy d the number of nodes with varying activation probabilities seemed to be uniformly distributed compared to the histogram of policies a b and c this implies that most of the hidden nodes in the policy network participated in generating a control action command this is a desirable phenomenon because by doing so the policy network becomes accessible to the neural network s full capacity of approximating the policy 5 conclusion in this work we proposed a deep reinforcement learning based controller for path following of an unmanned surface vehicle usv a deep deterministic policy gradient ddpg algorithm was used to construct the steering controller and with the use of repeated path following simulation the learning based control policy was trained while the training proceeded four different control policies were extracted in consecutive order the extracted control policies were then implemented in a full scale usv to validate its path following capability according to the results of the path following simulations and experiments the extracted control policy tended to possess a control habit at the initial stage of the training the control habit prevented the vehicle from properly following the target path this phenomenon was due to the inadequate training of the policy network and we found that the hidden nodes in the policy network were not uniformly active at this stage of the training as the training stage continued the path following performance tended to develop resulting in a decrease in the cross track error and the course angle error the self learning ability of the usv controller by interacting with the nearby environment is one of the most distinctive features of the proposed method such capability can be applied to solve a problem dealing with the uncertain environmental condition in future work it may be beneficial to replace simulation based training with experimental data based training or real time training in addition a reinforcement learning based controller for disturbance rejection could be developed to deal with unmodeled and time varying environmental disturbance moreover the reinforcement learning based controller can be extended to much broader research areas such as trajectory tracking or collision avoidance as well acknowledgments this work was supported by a research institute of marine systems engineering of seoul national university republic of korea b agency for defense development ud160009dd of republic of korea 
22762,this paper presents a systematic work focused on the thrust generation and wake structures of two travelling wavy foils with tandem parallel and staggered arrangements therein presenting essential information about actual schooling fish the fluid dynamics around two identical foils arranged with a dimensionless horizontal gap g x and vertical gap g y are investigated at reynolds number r e 2 1 0 5 the wake structures are classified into proximity interference wake interference proximity and wake interference and no interference associated with thrust generation based on numerical computations we find that g x significantly affects the re organisation of the vortex shedding from the leading and following foils resulting in various propulsive forces acting on the foils moreover g y causes a result whereby the vortex shedding from the leading foil deflects towards the flow behind the following foil leading to a slight change in the thrust generation for both travelling wavy foils this work is helpful for guiding the queue control of multiple bio inspired underwater robots keywords fish school thrust generation wake structures bio inspired underwater robotics 1 introduction in the biological world it is quite common that living beings move together in a group versus solitarily from schools of fish flocks of birds clusters of ants and even crowds of humans in addition to the social behaviour brock and riffenburgh 1960 cushing and jones 1968 researchers have also considered that animals living in a fluid can obtain the fluid dynamic benefits from their neighbour companions resulting in energy saving weihs 1973 ashraf et al 2017 gazzola et al 2016 filella et al 2018 because a fish school is quite complicated researchers consider a two foil system to simplify the problem in the last decade various studies have been conducted on two swimming foils with tandem parallel configurations to reveal the crucial fluid dynamics of real fish schools for the tandem arrangement two foils are placed with an in line spacing gap so that the following foil swims in the flow field of the leading foil when a fish is swimming in a given wake it would take advantage of the oncoming wake and improve the propulsive performance of itself liao et al 2003 in the work conducted by beal et al a dead fish can propel itself forward when it is located in the wake of an oncoming vortices beal et al 2006 therefore the propulsive force acting on the following foil strongly depends on how the following foil re organises the vortex produced by itself and the vortex shedding from the leading foil by varying the spacing gap l and phase difference of the foil s kinematics ϕ between the two foils researchers have shown that there are two typical modes a destructive and constructive mode associated with the maximum thrust increase and decrease for the following foil zhu et al 2014 kim et al 2010 shoele and zhu 2015b zhang and zheng 2015 uddin et al 2015 khalid et al 2016 deng and shao 2007 boschitsch et al 2014 becker et al 2015 in the destructive mode the vortices with the same rotational direction shedding from the two foils are attracted toward each other and merge when ϕ 2 π l u t π where u is the foil s swimming speed and t is the undulating period of the foil s kinematics this leads to a stronger reverse von kármán vortex street behind the following foil and a significant increase in thrust on the following foil in particular ϕ 2 π l u t is usually called the global phase difference between two foils denoted φ however in the constructive mode the vortices with the opposite rotational direction shedding from the two foils are cancelled when φ 0 resulting in a lower propulsive performance on the following foil on the other hand the thrust generation of the leading foil differs from that of an isolated foil when two foils are located in a closed space and this difference attenuates rapidly with increasing space dimensions ramananarivo et al 2016 moreover researchers have also used a two tandem foil system to understand the fin fin interactions in fish swimming akhtar et al 2007 liu et al 2017 another typical pattern of a two foil system is the parallel or side by side arrangement similar to studies on two tandem foils researchers have mainly focused on the spacing gap and phase difference of the foil s kinematics between two foils when l is moderate two foils are of benefit to improving the propulsive forces at ϕ π and saving the energy at ϕ 0 dong and lu 2007 mougel et al 2016 dewey et al 2013 however the vortex re organisation in the two parallel foil system is obviously different from that in the two tandem foil system when ϕ 0 there are three kinds of wake structures characterising the wake while two types of synchronised vortex streets are observed at ϕ 0 dong and lu 2007 moreover the interaction between two foils is gradually diminished with increasing l in both tandem and parallel configurations in addition the geometry of the two foils in the aforementioned works is the same however the shape of the fish in a school would not be the same from the perspective of a single foil the thinner foil can generate higher propulsive force than the thicker foil ashraf et al 2017 therefore the shape of the foils affects the hydrodynamics and their interaction when two foils are placed in different spatial configurations walker 2002 kazakidi et al 2018 borazjani and sotiropoulos 2008 in particular the shape difference between two swimming foils is also related to a special condition in real biological world this special condition also known as drafting swimming is usually observed at a dolphin mother and calf weihs 2004 through numerical studies shoele and zhu have also shown that the dolphin mother and calf would adjust the gap between them to improve the propulsive performance of the calf shoele and zhu 2015a in recent years limited work has been conducted on two staggered foils which are more common than the two tandem parallel foils in the real biological world huera huarte 2018 huang et al 2018 moreover to the best of our knowledge the present study is the first work performed on two travelling wavy foils with tandem parallel and staggered arrangements using the travelling wavy foil as a substitute for real swimming fish we numerically consider the thrust generation and wake structures of two travelling wavy foils arranged with tandem parallel and staggered configurations the remainder of this paper is organised as follows first we introduce the computational approach in section 2 including the problem description related parameters and numerical method then we present the numerical results in section 3 where we discuss how the spatial configurations between two foils affect the thrust generation and wake structures of the leading and following foil respectively in section 4 we discuss the relationship between thrust generation and the wake structures to reveal the hydro mechanism of the two travelling wavy foil system section 5 summarises the essential observations obtained from our study and concludes the paper 2 computational method 2 1 problem formulation fig 1 depicts the problem through the schematic of the flow configuration two travelling wavy foils are placed with a physical longitudinal gap l and transverse gap t in a uniform flow of constant speed u in the x direction in addition l is calculated from the tail of the leading edge to the tail of the following foil and t is the distance between the centre lines of the two foils an naca0012 foil with a chord length c is used as the foil s geometry moreover the naca0012 foil is usually employed as a substitute of the shape of real fish deng and shao 2007 dong and lu 2007 xiao et al 2012 in particular the spatial configuration degenerates into two special conditions a tandem arrangement t 0 and a parallel arrangement at l 0 we assume that the two foils oscillate synchronously in the y direction the undulating equation of arbitrary foils described by the movement of their centre lines is 1 y x t a x sin 2 π x λ c t t with a x c 0 351 sin x c 1 796 0 359 where y x t is the instantaneous lateral locomotion of the foil a x is the lateral wave amplitude the lengthwise coordinate x is measured from the foil s head t is the instantaneous time λ is the wavelength and is equal to 1 115 and t is the undulating period this equation initially reported by wassersug and kawachi 1985 has been widely used to describe the locomotion of fish like swimming liu and kawachi 1999 xiao et al 2012 fig 2 shows the envelopes of centre line of an undulating foil where each line in the figure denotes the instantaneous shape of the foil in particular we illustrate some positions of the foil at the special undulating time in addition we use the strouhal number s t f a u to describe the dimensionless frequency of the swimming foil where f 1 t is the frequency of undulating locomotion in hz a is the characteristic the width of wake and is taken as the maximum value of 2 a x and u is the velocity of the oncoming flow which is set as 0 2 m s in this work moreover we use the constraint s t 0 32 to simplify the problem this value of s t is similar to many swimming aquatic animals taylor et al 2003 gazzola et al 2014 and has been employed in published papers xiao et al 2012 the reynolds number is set as r e ρ u c μ 2 1 0 5 where ρ is the fluid density and μ is the viscosity of the fluid in particular we use the water as the fluid in the present work where ρ 0 998 1 0 3 kg m 3 and μ 1 01 1 0 3 pa s to evaluate the thrust generation of two travelling wavy foils we use the symbols c d l and c d f to denote the time mean thrust coefficients on the leading and following foil respectively furthermore c d denotes the time mean thrust coefficients on an individual foil therefore we can use two dimensionless parameters c n d l and c n d f to illustrate the thrust alteration compared with a isolated foil the definitions of these two parameters are c n d l c d l c d c n d f c d f c d moreover we nondimensionalise the horizontal and vertical gap between the two foils using the following expressions g x l c g y t c 2 2 numerical approach the unsteady flow field around the two foil system was simulated using the commercially available cfd package fluent 14 0 for a newtonian fluid the governing equations describing unsteady incompressible flow denoting the conservation of mass and momentum are 2 u 0 ρ d u d t ρ f p μ 2 u where u denotes the velocity vector f is the body force acting on the fluid and p is the pressure the finite volume method is used to achieve the spatial discretisation of the navier stokes equations eq 2 and temporal discretisation is performed using a second order accurate backward implicit scheme the sst k ω model is employed to model the present turbulent flow the simple algorithm is used to achieve the pressure velocity coupling of the continuity equation moreover the gauss seidel linear equation solver is employed to solve the discretised equations this numerical method which is implemented in fluent 14 0 is used to simulate the present problems the validation of this method on bio inspired foil swimming under turbulent flow is available in the papers by xiao et al 2012 we also performed a variety of comparisons on the isolated undulating foil with the published literature by xiao et al and the numerical results instantaneous thrust coefficient c t agree well with the previous work as illustrated in fig 3 b in addition for a foil undergoing combined pitching and plunging motion the time mean thrust coefficients obtained by the present work have been compared with the previous experimental study triantafyllou et al 1991 as shown in fig 3 c the numerical results are in good agreement with the experimental result in this study the computational domain is considered as a rectangular area the inlet velocity boundary is at a distance of 15 c from the head of the leading foil as u u 0 0 and p x 0 u 0 0 and p 0 are used as the no stress out flow boundary conditions and the downstream pressure outlet is at a distance of 40 c from the trailing edge of the following foil the slip wall condition is used for the upper and lower flow boundaries located at a distance of 20 c from a certain line of the following foil the flow field is divided into two zones where the two foils are surrounded by unstructured grids in the inner zone and the remainder of the domain is constructed using a structured mesh as illustrated in fig 3 a the first cell is placed at a reasonable distance of 1 0 4 c from the foil surface with y being less than 1 moreover there are 14 layers within the boundary layer on the moving boundary of the foil the horizontal velocity equals zero and the vertical velocity is controlled by the undulated motion eq 1 the problem based user defined function udf has been used to handle the unsteady moving boundary during update time all cells around the undulated foils are smoothed and regenerated using the define grid motion function in fluent associated with re gridding and smoothing methods prior to performing the actual computations we conducted a grid and temporal resolution analysis to choose an appropriate mesh size and time step for the present work on the one hand the following three mesh sizes were considered a coarse mesh of 9 8 1 0 4 a medium mesh of 2 24 1 0 5 and a fine mesh of 9 8 1 0 5 corresponding to 91 401 and 891 points on the surface of each foil respectively the results of the tests indicate that the medium mesh is the most suitable for our study because it obtains higher accuracy with grids see fig 3 e on the other hand the temporal resolution tests are conducted on the medium mesh with several time steps 1000 2500 and 4000 in one period it is found that 2500 time steps per period were sufficient and yielded accurate results moreover the choice of the present time steps is in agreement with the time step formula presented by kinsey and dumas 2008 we also compared the present and previous work on two tandem foils to validate our numerical predictions in the work of zhou et al 2016 the authors used a high aspect ratio three dimensional geometry to predict the propulsive performance of a two foils pitching under turbulent flow where the aspect ratio equalled the ratio of the span wise length to the chord wise length because the fluid dynamics under a high aspect ratio can be considered as quasi two dimensional we show that our computational results agree with the previous literature see fig 3 d however to the best of our knowledge few studies have been conducted on two parallel foil swimming in a fully turbulent flow thus the validation is limited to a tandem arrangement in the present work 3 results in this section we show the results obtained from the numerical simulations and discuss how g x and g y affect the thrust generation and work structures of two travelling wavy foils first the time mean thrust coefficient of an individual foil is simulated resulting in c d 0 00864 on the one hand if the thrust on the leading following foil is larger than the thrust on an individual foil when c n d l 1 c n d f 1 then the thrust increase occurs at the leading following foil on the other hand the thrust decrease observed at the leading following foil denoted c n d l c n d f is less than 1 in particular it is noted that the collision of two foils would occur at smaller g x and g y to avoid this condition the present simulations do not include the zone g x g y 0 0 g x 1 0 0 0 g y 0 3 3 1 thrust generation in fig 4 we summarise the numerical results to investigate the dependence of g x and g y of the leading and following foil respectively based on the rhythmic changes in c n d l and c n d f we identify three regions with increasing g x i e 0 0 g x 1 0 region i divided into two subregions regions i a and i b 1 0 g x 3 0 region ii divided into two subregions regions ii a and ii b and 3 0 g x 4 0 region iii as shown in fig 4 a in region i c n d l strongly depends on both g x and g y for lower g y g y 0 5 and g y 0 7 c n d l decreases at 0 0 g x 0 5 region i a however there is a slight change at c n d l when g y 1 0 and g y 1 5 in region i b 0 5 g x 1 0 c n d l continually increases at lower g y while it increases first and then decreases at higher g y in particular it is noted that c n d l is basically less than 1 in region i except for a small zone found at g y 1 0 and g y 1 5 indicating that the leading foil does not achieve any hydrodynamic profits from travelling foil system in region i when g x 1 the following foil is located at the upper right of the leading foil and the sequence of the spatial gap between two foils is region ii a region ii b and region iii in region ii a 1 0 g x 1 3 c n d l keeps increase regardless of the values of g y moreover for g y 0 5 there exists a smaller zone represented as c n d l 1 indicating that thrust augmentation at the leading foil occurs for region ii b fig 4 a shows that the leading foil enjoys a thrust increase when g y 0 7 the largest increase in thrust on the leading foil is observed at g x g y 1 3 0 0 up to 92 42 larger than for an individual foil however those increases of the thrust force on the leading foil decrease with the sequential growth of g x when g y 1 0 the leading foil shows a weak ability to generate thrust compared to the isolated foil and this disadvantage is offset when g x increases hence with increasing g x the effect of g y on generating thrust is gradually vanished with continually increasing g x the two foils are located in region iii where the thrust on the leading foil is not obviously affected by spatial configurations between the two foils and the leading foil shows a similar ability to produce a propulsive force at the isolated foil for the following foil the changing rule of c n d f is entirely different from that of the leading foil in region i a it is noted that the following foil experiences a thrust increase regardless of g y and the most significant increase in thrust on the following foil is observed at g x g y 0 25 0 5 as c n d f 2 27 moreover the value of c n d f decreases with increasing g y in region i b c n d f first increases and then decreases at lower g y g y 0 7 whereas it first decreases and then increases at g y 1 0 in all curves shown in region i b the turning point is always achieved at g x 0 7 when g y 0 7 in regions ii and iii fig 4 b shows that c n d f gradually decreases with increasing g x indicating that the propulsive force on the following foil is not obviously affected by the leading foil in this zone however when g y 0 5 numerical results show that c n d f experiences a significant change especially at g y 0 0 when g y 0 0 the spatial configuration between two foils degenerates into the tandem arrangement in which an obvious vortex re organisation occurs following the previous work of shoele and zhu 2015b we use the global phase difference between two foils φ to understand the thrust increase or decrease on the following foil depending on the formula for φ we find that φ equals 0 7 n π n is a natural number for the destructive mode and φ n π for the constructive mode the present value of φ for the destructive mode is slightly different from the result of shoele and zhu φ 0 8 π we argue that this shifting of φ may be caused by the foil s geometry and reynolds number difference between the present and previous study as shown in fig 5 the positive red centre and negative blue centre vortex shedding from the leading foil are impeded and divided into two sub parts by the following foil during propagation downstream under the destructive mode fig 5 a the vortex shed from the leading foil merges with the vortex of the same rotational direction produced by the following one resulting in a stronger reverse von kármán vortex street behind the following foil significantly this stronger reverse von kármán vortex street leads to a thrust increase on the following foil however under the constructive mode fig 5 b the vorticity cancellation is observed when the vortex shedding from the following foil merges with the vortex shedding from the leading foil with opposite rotational direction which explains the decreased thrust on the following foil when 0 g y 0 5 fig 4 b shows that c n d f experiences a slight fluctuation compared to at g y 0 0 because the vortex re organisation is weakened under the influence of g y in fig 6 we show an example of the vortex evolution at g x g y 2 0 0 3 at the beginning of one period a negative vortex shed from the leading foil v l n is located under the positive vortex generated by the following foil v f p with the effects of v f p and v f n v l n is torn into two parts v l n 1 and v l n 2 where v l n 1 counteracts v f p and v l n 2 merges with v f n hence the wake behind the following foil is partly strengthened and partly weakened resulting in the slight change in c n d f shown in fig 4 b 3 2 wake structures in the last subsection we briefly describe some typical wake structures i e the destructive mode the constructive mode and the vortex evolution at g x g y 2 0 0 3 in this subsection we will consider the wake structures of the two travelling wavy foil system in detail first we introduce the classifications of a two cylinder system that are highly similar to the present system on the wake of two interacting cylinders zdravkovich 1997 divided the l t plane g x g y plane in our work into four regions i e the proximity interference wake interference proximity and wake interference and no interference regions at proximity interference the relative position between two foils plays a vital role in affecting the hydrodynamic force of the two foils the wake interference region shows that the wake of the following foil is affected by the leading foil but not vice versa however in proximity and wake interference the leading foil wake is influenced through a feedback mechanism by the following companion there is no significant influence of wake structures between two foils in the no interference zone and the hydrodynamic performance of the two foils is similar to an individual foil in this region we classify the wake structures of two travelling wavy foils in fig 7 under proximity and wake interference three modes mode i mode ii and mode iii are identified to display the different downstream evolutions of the wake structures mode i occurs at g y 0 where the vortex shedding from two foils completely merges or neutralises with each other behind the following foil in the destructive and constructive mode and partly merges or neutralises at other values of φ in mode ii 0 g y 0 5 the wake structure is highly complicated because of the combined effects of g x and g y we classify the downstream flow into two types symmetrical and asymmetrical wakes where the symmetrical axis is considered as the centroid of the wake the symmetrical wake in mode ii mode ii s is observed in two regions g x 0 0 and g x 1 7 when g x 0 0 mode ii sa the two foils are placed in a parallel arrangement because the two foils employ the same kinematics eq 1 the vortices shed from the two foils are synchronised and rotate with the same strength and direction hence the wake structure in the far field is symmetrical in the remaining regions of mode ii s mode ii sb the vortices shed from the two foils attract each other and form a symmetrical wake in the far field of the flow in contrast to mode ii sa the symmetrical axis of the wake in mode ii sb is not the centre line of the vertical gap between the two foils this axis is shifted upwards because the wake of the leading foil is deflected by the induced velocity of the following foil s wake moreover in mode ii as the wake structures in the far field clearly show the asymmetrical characteristics a rough flow topology in this case is that the far field of the flow includes one positive vortex row and two negative vortex rows and vice versa for a given g x the positive negative vortex shed from the leading foil arrives at the tail of the following foil and merges with the preceding vortex in the same rotational direction generated by the following foil then this new vortex breaches the re organisation of the forthcoming vortex in mode iii an inconspicuous interaction between the wake of the two foils can be observed and the wake structures in the far field are similar to two reverse von kármán vortex streets moreover we show some flow structures of the proximity and wake interference in fig 8 the wake interference shows that the interaction between the wakes of two foils would only affect the hydrodynamic performance of the following foil when two foils are placed in a tandem arrangement vortex re organisation is observed including the destructive and constructive modes in the staggered arrangement the wake of the leading foil deflects upwards when it is spread around the tail of the following foil however the energy of the vortex generated by the leading foil is significantly dissipated during long term propagation therefore the c n d f of the following foil in this region is substantially smaller than that of the following foil in proximity and wake interference even though vortex re organisation occurs on the other hand there is no feedback influence from the following foil to the leading foil in this region resulting in a lack of thrust augmentation of the leading foil under proximity interference there are no obvious interactions between the vortex shedding from the two foils in our classification the lower limit of g y is set to g y 0 7 while it decreases to zero during understanding the two cylinder system when g x and g y are sufficiently large there is no interference on the wake structures of the two foils the flows behind the two foils are mutually independent and similar to the reverse von kármán vortex street behind an individual foil 4 discussion we now consider the relationship between thrust generation and the wake structures to reveal the hydro mechanism of the two travelling wavy foil system within the no interference zone vortex interaction occurs resulting in the flow behind the two foils being a reverse von kármán vortex street hence the thrusts on the two foils are the same as that on an individual foil depending on the definition of wake interference the leading foil may not be affected by the following foil indicting that c n d l 1 moreover c n d f fluctuates slightly about 1 because a weak vortex re organisation occurs behind the following foil therefore as shown in fig 4 c n d l and c n d f are approximately equal to 1 in region iii at 0 0 g x 2 5 the relationship between thrust generation and the wake structures is quite intricate there are three types of interference in region i 0 0 g x 1 0 i e proximity interference and mode ii sa and mode iii show proximity and wake interference because the proximity and wake interference show quite significant effects on thrust generation compared to proximity interference the following foil obtains a more considerable hydrodynamic force from the leading foil at lower g y in general the following foil takes the hydrodynamic force from the leading foil in region i a however in region i b the following foil experiences a visible thrust reduction at lower g y when the wake structure exhibits proximity and wake interference in region ii the leading foil enjoys thrust augmentation under proximity and wake interference whereas it suffers a thrust decrease under proximity interference under mode i of proximity interference the fluctuation trend of c n d f is more evident than other types of wake structures the peak and smallest value of c n d f are obtained at g y 0 because the vortex re organisation is more significant in mode i than in the other modes for mode ii sb and mode ii as it is noted that the changes in c n d f are not significantly affected in the zones of the proximity and wake interference although there are different types of wake interactions occurring in summary g x plays a crucial role in thrust generation because it strongly determines the types of vortex re organisation on the other hand g y causes the deflection of the vortex shedding from the leading foil to shift towards the flow behind the following foil resulting in a slight change in thrust generation on the two travelling wavy foils 5 conclusions numerical studies are conducted on the fluid dynamics around two travelling wavy foils to understand the hydrodynamic mechanism of fish schools a systematic work on thrust generation and wake structures is discussed for when two foils are arranged in tandem parallel and staggered configurations by varying dimensionless horizontal gap g x and vertical gap g y between the two foils five regions accompanied by different rhythmic changes in the dimensionless time mean thrust coefficient on the leading and following foils are defined where the most significant increase in thrust on the leading and following foils is 92 42 and 127 respectively obtained at g x g y 1 3 0 0 and g x g y 0 25 0 5 with increasing g x and g y the thrust on the two foils gradually approaches the thrust on the isolated foil we classify the wake structures into four regions i e proximity interference wake interference proximity and wake interference and no interference regions moreover the wake structures are used to understand the special regions accompanied by thrust generation the numerical results reveal that g x significantly affects the thrust on the leading and following foils by changing the modes of the wake structures and the vortex generated by the leading foil deflects towards the wake behind the following foil under the influence of g y in addition the present work is also helpful for guiding the queue control of multiple bio inspired underwater robots as ocean observation mission becomes more complicated one mission may need two or more underwater robots based on the numerical results we can conclude that two robotics can cruise at g x g y 1 3 0 0 to improve their propulsive performance or save energy acknowledgements this work is supported by national natural science foundation of china grant no 11502210 51709229 51879220 51479170 and 61803306 national key research and development program of china grant no 2016yfc0301300 natural science basic research plan in shaanxi province of china grant no 2018jq5092 
22762,this paper presents a systematic work focused on the thrust generation and wake structures of two travelling wavy foils with tandem parallel and staggered arrangements therein presenting essential information about actual schooling fish the fluid dynamics around two identical foils arranged with a dimensionless horizontal gap g x and vertical gap g y are investigated at reynolds number r e 2 1 0 5 the wake structures are classified into proximity interference wake interference proximity and wake interference and no interference associated with thrust generation based on numerical computations we find that g x significantly affects the re organisation of the vortex shedding from the leading and following foils resulting in various propulsive forces acting on the foils moreover g y causes a result whereby the vortex shedding from the leading foil deflects towards the flow behind the following foil leading to a slight change in the thrust generation for both travelling wavy foils this work is helpful for guiding the queue control of multiple bio inspired underwater robots keywords fish school thrust generation wake structures bio inspired underwater robotics 1 introduction in the biological world it is quite common that living beings move together in a group versus solitarily from schools of fish flocks of birds clusters of ants and even crowds of humans in addition to the social behaviour brock and riffenburgh 1960 cushing and jones 1968 researchers have also considered that animals living in a fluid can obtain the fluid dynamic benefits from their neighbour companions resulting in energy saving weihs 1973 ashraf et al 2017 gazzola et al 2016 filella et al 2018 because a fish school is quite complicated researchers consider a two foil system to simplify the problem in the last decade various studies have been conducted on two swimming foils with tandem parallel configurations to reveal the crucial fluid dynamics of real fish schools for the tandem arrangement two foils are placed with an in line spacing gap so that the following foil swims in the flow field of the leading foil when a fish is swimming in a given wake it would take advantage of the oncoming wake and improve the propulsive performance of itself liao et al 2003 in the work conducted by beal et al a dead fish can propel itself forward when it is located in the wake of an oncoming vortices beal et al 2006 therefore the propulsive force acting on the following foil strongly depends on how the following foil re organises the vortex produced by itself and the vortex shedding from the leading foil by varying the spacing gap l and phase difference of the foil s kinematics ϕ between the two foils researchers have shown that there are two typical modes a destructive and constructive mode associated with the maximum thrust increase and decrease for the following foil zhu et al 2014 kim et al 2010 shoele and zhu 2015b zhang and zheng 2015 uddin et al 2015 khalid et al 2016 deng and shao 2007 boschitsch et al 2014 becker et al 2015 in the destructive mode the vortices with the same rotational direction shedding from the two foils are attracted toward each other and merge when ϕ 2 π l u t π where u is the foil s swimming speed and t is the undulating period of the foil s kinematics this leads to a stronger reverse von kármán vortex street behind the following foil and a significant increase in thrust on the following foil in particular ϕ 2 π l u t is usually called the global phase difference between two foils denoted φ however in the constructive mode the vortices with the opposite rotational direction shedding from the two foils are cancelled when φ 0 resulting in a lower propulsive performance on the following foil on the other hand the thrust generation of the leading foil differs from that of an isolated foil when two foils are located in a closed space and this difference attenuates rapidly with increasing space dimensions ramananarivo et al 2016 moreover researchers have also used a two tandem foil system to understand the fin fin interactions in fish swimming akhtar et al 2007 liu et al 2017 another typical pattern of a two foil system is the parallel or side by side arrangement similar to studies on two tandem foils researchers have mainly focused on the spacing gap and phase difference of the foil s kinematics between two foils when l is moderate two foils are of benefit to improving the propulsive forces at ϕ π and saving the energy at ϕ 0 dong and lu 2007 mougel et al 2016 dewey et al 2013 however the vortex re organisation in the two parallel foil system is obviously different from that in the two tandem foil system when ϕ 0 there are three kinds of wake structures characterising the wake while two types of synchronised vortex streets are observed at ϕ 0 dong and lu 2007 moreover the interaction between two foils is gradually diminished with increasing l in both tandem and parallel configurations in addition the geometry of the two foils in the aforementioned works is the same however the shape of the fish in a school would not be the same from the perspective of a single foil the thinner foil can generate higher propulsive force than the thicker foil ashraf et al 2017 therefore the shape of the foils affects the hydrodynamics and their interaction when two foils are placed in different spatial configurations walker 2002 kazakidi et al 2018 borazjani and sotiropoulos 2008 in particular the shape difference between two swimming foils is also related to a special condition in real biological world this special condition also known as drafting swimming is usually observed at a dolphin mother and calf weihs 2004 through numerical studies shoele and zhu have also shown that the dolphin mother and calf would adjust the gap between them to improve the propulsive performance of the calf shoele and zhu 2015a in recent years limited work has been conducted on two staggered foils which are more common than the two tandem parallel foils in the real biological world huera huarte 2018 huang et al 2018 moreover to the best of our knowledge the present study is the first work performed on two travelling wavy foils with tandem parallel and staggered arrangements using the travelling wavy foil as a substitute for real swimming fish we numerically consider the thrust generation and wake structures of two travelling wavy foils arranged with tandem parallel and staggered configurations the remainder of this paper is organised as follows first we introduce the computational approach in section 2 including the problem description related parameters and numerical method then we present the numerical results in section 3 where we discuss how the spatial configurations between two foils affect the thrust generation and wake structures of the leading and following foil respectively in section 4 we discuss the relationship between thrust generation and the wake structures to reveal the hydro mechanism of the two travelling wavy foil system section 5 summarises the essential observations obtained from our study and concludes the paper 2 computational method 2 1 problem formulation fig 1 depicts the problem through the schematic of the flow configuration two travelling wavy foils are placed with a physical longitudinal gap l and transverse gap t in a uniform flow of constant speed u in the x direction in addition l is calculated from the tail of the leading edge to the tail of the following foil and t is the distance between the centre lines of the two foils an naca0012 foil with a chord length c is used as the foil s geometry moreover the naca0012 foil is usually employed as a substitute of the shape of real fish deng and shao 2007 dong and lu 2007 xiao et al 2012 in particular the spatial configuration degenerates into two special conditions a tandem arrangement t 0 and a parallel arrangement at l 0 we assume that the two foils oscillate synchronously in the y direction the undulating equation of arbitrary foils described by the movement of their centre lines is 1 y x t a x sin 2 π x λ c t t with a x c 0 351 sin x c 1 796 0 359 where y x t is the instantaneous lateral locomotion of the foil a x is the lateral wave amplitude the lengthwise coordinate x is measured from the foil s head t is the instantaneous time λ is the wavelength and is equal to 1 115 and t is the undulating period this equation initially reported by wassersug and kawachi 1985 has been widely used to describe the locomotion of fish like swimming liu and kawachi 1999 xiao et al 2012 fig 2 shows the envelopes of centre line of an undulating foil where each line in the figure denotes the instantaneous shape of the foil in particular we illustrate some positions of the foil at the special undulating time in addition we use the strouhal number s t f a u to describe the dimensionless frequency of the swimming foil where f 1 t is the frequency of undulating locomotion in hz a is the characteristic the width of wake and is taken as the maximum value of 2 a x and u is the velocity of the oncoming flow which is set as 0 2 m s in this work moreover we use the constraint s t 0 32 to simplify the problem this value of s t is similar to many swimming aquatic animals taylor et al 2003 gazzola et al 2014 and has been employed in published papers xiao et al 2012 the reynolds number is set as r e ρ u c μ 2 1 0 5 where ρ is the fluid density and μ is the viscosity of the fluid in particular we use the water as the fluid in the present work where ρ 0 998 1 0 3 kg m 3 and μ 1 01 1 0 3 pa s to evaluate the thrust generation of two travelling wavy foils we use the symbols c d l and c d f to denote the time mean thrust coefficients on the leading and following foil respectively furthermore c d denotes the time mean thrust coefficients on an individual foil therefore we can use two dimensionless parameters c n d l and c n d f to illustrate the thrust alteration compared with a isolated foil the definitions of these two parameters are c n d l c d l c d c n d f c d f c d moreover we nondimensionalise the horizontal and vertical gap between the two foils using the following expressions g x l c g y t c 2 2 numerical approach the unsteady flow field around the two foil system was simulated using the commercially available cfd package fluent 14 0 for a newtonian fluid the governing equations describing unsteady incompressible flow denoting the conservation of mass and momentum are 2 u 0 ρ d u d t ρ f p μ 2 u where u denotes the velocity vector f is the body force acting on the fluid and p is the pressure the finite volume method is used to achieve the spatial discretisation of the navier stokes equations eq 2 and temporal discretisation is performed using a second order accurate backward implicit scheme the sst k ω model is employed to model the present turbulent flow the simple algorithm is used to achieve the pressure velocity coupling of the continuity equation moreover the gauss seidel linear equation solver is employed to solve the discretised equations this numerical method which is implemented in fluent 14 0 is used to simulate the present problems the validation of this method on bio inspired foil swimming under turbulent flow is available in the papers by xiao et al 2012 we also performed a variety of comparisons on the isolated undulating foil with the published literature by xiao et al and the numerical results instantaneous thrust coefficient c t agree well with the previous work as illustrated in fig 3 b in addition for a foil undergoing combined pitching and plunging motion the time mean thrust coefficients obtained by the present work have been compared with the previous experimental study triantafyllou et al 1991 as shown in fig 3 c the numerical results are in good agreement with the experimental result in this study the computational domain is considered as a rectangular area the inlet velocity boundary is at a distance of 15 c from the head of the leading foil as u u 0 0 and p x 0 u 0 0 and p 0 are used as the no stress out flow boundary conditions and the downstream pressure outlet is at a distance of 40 c from the trailing edge of the following foil the slip wall condition is used for the upper and lower flow boundaries located at a distance of 20 c from a certain line of the following foil the flow field is divided into two zones where the two foils are surrounded by unstructured grids in the inner zone and the remainder of the domain is constructed using a structured mesh as illustrated in fig 3 a the first cell is placed at a reasonable distance of 1 0 4 c from the foil surface with y being less than 1 moreover there are 14 layers within the boundary layer on the moving boundary of the foil the horizontal velocity equals zero and the vertical velocity is controlled by the undulated motion eq 1 the problem based user defined function udf has been used to handle the unsteady moving boundary during update time all cells around the undulated foils are smoothed and regenerated using the define grid motion function in fluent associated with re gridding and smoothing methods prior to performing the actual computations we conducted a grid and temporal resolution analysis to choose an appropriate mesh size and time step for the present work on the one hand the following three mesh sizes were considered a coarse mesh of 9 8 1 0 4 a medium mesh of 2 24 1 0 5 and a fine mesh of 9 8 1 0 5 corresponding to 91 401 and 891 points on the surface of each foil respectively the results of the tests indicate that the medium mesh is the most suitable for our study because it obtains higher accuracy with grids see fig 3 e on the other hand the temporal resolution tests are conducted on the medium mesh with several time steps 1000 2500 and 4000 in one period it is found that 2500 time steps per period were sufficient and yielded accurate results moreover the choice of the present time steps is in agreement with the time step formula presented by kinsey and dumas 2008 we also compared the present and previous work on two tandem foils to validate our numerical predictions in the work of zhou et al 2016 the authors used a high aspect ratio three dimensional geometry to predict the propulsive performance of a two foils pitching under turbulent flow where the aspect ratio equalled the ratio of the span wise length to the chord wise length because the fluid dynamics under a high aspect ratio can be considered as quasi two dimensional we show that our computational results agree with the previous literature see fig 3 d however to the best of our knowledge few studies have been conducted on two parallel foil swimming in a fully turbulent flow thus the validation is limited to a tandem arrangement in the present work 3 results in this section we show the results obtained from the numerical simulations and discuss how g x and g y affect the thrust generation and work structures of two travelling wavy foils first the time mean thrust coefficient of an individual foil is simulated resulting in c d 0 00864 on the one hand if the thrust on the leading following foil is larger than the thrust on an individual foil when c n d l 1 c n d f 1 then the thrust increase occurs at the leading following foil on the other hand the thrust decrease observed at the leading following foil denoted c n d l c n d f is less than 1 in particular it is noted that the collision of two foils would occur at smaller g x and g y to avoid this condition the present simulations do not include the zone g x g y 0 0 g x 1 0 0 0 g y 0 3 3 1 thrust generation in fig 4 we summarise the numerical results to investigate the dependence of g x and g y of the leading and following foil respectively based on the rhythmic changes in c n d l and c n d f we identify three regions with increasing g x i e 0 0 g x 1 0 region i divided into two subregions regions i a and i b 1 0 g x 3 0 region ii divided into two subregions regions ii a and ii b and 3 0 g x 4 0 region iii as shown in fig 4 a in region i c n d l strongly depends on both g x and g y for lower g y g y 0 5 and g y 0 7 c n d l decreases at 0 0 g x 0 5 region i a however there is a slight change at c n d l when g y 1 0 and g y 1 5 in region i b 0 5 g x 1 0 c n d l continually increases at lower g y while it increases first and then decreases at higher g y in particular it is noted that c n d l is basically less than 1 in region i except for a small zone found at g y 1 0 and g y 1 5 indicating that the leading foil does not achieve any hydrodynamic profits from travelling foil system in region i when g x 1 the following foil is located at the upper right of the leading foil and the sequence of the spatial gap between two foils is region ii a region ii b and region iii in region ii a 1 0 g x 1 3 c n d l keeps increase regardless of the values of g y moreover for g y 0 5 there exists a smaller zone represented as c n d l 1 indicating that thrust augmentation at the leading foil occurs for region ii b fig 4 a shows that the leading foil enjoys a thrust increase when g y 0 7 the largest increase in thrust on the leading foil is observed at g x g y 1 3 0 0 up to 92 42 larger than for an individual foil however those increases of the thrust force on the leading foil decrease with the sequential growth of g x when g y 1 0 the leading foil shows a weak ability to generate thrust compared to the isolated foil and this disadvantage is offset when g x increases hence with increasing g x the effect of g y on generating thrust is gradually vanished with continually increasing g x the two foils are located in region iii where the thrust on the leading foil is not obviously affected by spatial configurations between the two foils and the leading foil shows a similar ability to produce a propulsive force at the isolated foil for the following foil the changing rule of c n d f is entirely different from that of the leading foil in region i a it is noted that the following foil experiences a thrust increase regardless of g y and the most significant increase in thrust on the following foil is observed at g x g y 0 25 0 5 as c n d f 2 27 moreover the value of c n d f decreases with increasing g y in region i b c n d f first increases and then decreases at lower g y g y 0 7 whereas it first decreases and then increases at g y 1 0 in all curves shown in region i b the turning point is always achieved at g x 0 7 when g y 0 7 in regions ii and iii fig 4 b shows that c n d f gradually decreases with increasing g x indicating that the propulsive force on the following foil is not obviously affected by the leading foil in this zone however when g y 0 5 numerical results show that c n d f experiences a significant change especially at g y 0 0 when g y 0 0 the spatial configuration between two foils degenerates into the tandem arrangement in which an obvious vortex re organisation occurs following the previous work of shoele and zhu 2015b we use the global phase difference between two foils φ to understand the thrust increase or decrease on the following foil depending on the formula for φ we find that φ equals 0 7 n π n is a natural number for the destructive mode and φ n π for the constructive mode the present value of φ for the destructive mode is slightly different from the result of shoele and zhu φ 0 8 π we argue that this shifting of φ may be caused by the foil s geometry and reynolds number difference between the present and previous study as shown in fig 5 the positive red centre and negative blue centre vortex shedding from the leading foil are impeded and divided into two sub parts by the following foil during propagation downstream under the destructive mode fig 5 a the vortex shed from the leading foil merges with the vortex of the same rotational direction produced by the following one resulting in a stronger reverse von kármán vortex street behind the following foil significantly this stronger reverse von kármán vortex street leads to a thrust increase on the following foil however under the constructive mode fig 5 b the vorticity cancellation is observed when the vortex shedding from the following foil merges with the vortex shedding from the leading foil with opposite rotational direction which explains the decreased thrust on the following foil when 0 g y 0 5 fig 4 b shows that c n d f experiences a slight fluctuation compared to at g y 0 0 because the vortex re organisation is weakened under the influence of g y in fig 6 we show an example of the vortex evolution at g x g y 2 0 0 3 at the beginning of one period a negative vortex shed from the leading foil v l n is located under the positive vortex generated by the following foil v f p with the effects of v f p and v f n v l n is torn into two parts v l n 1 and v l n 2 where v l n 1 counteracts v f p and v l n 2 merges with v f n hence the wake behind the following foil is partly strengthened and partly weakened resulting in the slight change in c n d f shown in fig 4 b 3 2 wake structures in the last subsection we briefly describe some typical wake structures i e the destructive mode the constructive mode and the vortex evolution at g x g y 2 0 0 3 in this subsection we will consider the wake structures of the two travelling wavy foil system in detail first we introduce the classifications of a two cylinder system that are highly similar to the present system on the wake of two interacting cylinders zdravkovich 1997 divided the l t plane g x g y plane in our work into four regions i e the proximity interference wake interference proximity and wake interference and no interference regions at proximity interference the relative position between two foils plays a vital role in affecting the hydrodynamic force of the two foils the wake interference region shows that the wake of the following foil is affected by the leading foil but not vice versa however in proximity and wake interference the leading foil wake is influenced through a feedback mechanism by the following companion there is no significant influence of wake structures between two foils in the no interference zone and the hydrodynamic performance of the two foils is similar to an individual foil in this region we classify the wake structures of two travelling wavy foils in fig 7 under proximity and wake interference three modes mode i mode ii and mode iii are identified to display the different downstream evolutions of the wake structures mode i occurs at g y 0 where the vortex shedding from two foils completely merges or neutralises with each other behind the following foil in the destructive and constructive mode and partly merges or neutralises at other values of φ in mode ii 0 g y 0 5 the wake structure is highly complicated because of the combined effects of g x and g y we classify the downstream flow into two types symmetrical and asymmetrical wakes where the symmetrical axis is considered as the centroid of the wake the symmetrical wake in mode ii mode ii s is observed in two regions g x 0 0 and g x 1 7 when g x 0 0 mode ii sa the two foils are placed in a parallel arrangement because the two foils employ the same kinematics eq 1 the vortices shed from the two foils are synchronised and rotate with the same strength and direction hence the wake structure in the far field is symmetrical in the remaining regions of mode ii s mode ii sb the vortices shed from the two foils attract each other and form a symmetrical wake in the far field of the flow in contrast to mode ii sa the symmetrical axis of the wake in mode ii sb is not the centre line of the vertical gap between the two foils this axis is shifted upwards because the wake of the leading foil is deflected by the induced velocity of the following foil s wake moreover in mode ii as the wake structures in the far field clearly show the asymmetrical characteristics a rough flow topology in this case is that the far field of the flow includes one positive vortex row and two negative vortex rows and vice versa for a given g x the positive negative vortex shed from the leading foil arrives at the tail of the following foil and merges with the preceding vortex in the same rotational direction generated by the following foil then this new vortex breaches the re organisation of the forthcoming vortex in mode iii an inconspicuous interaction between the wake of the two foils can be observed and the wake structures in the far field are similar to two reverse von kármán vortex streets moreover we show some flow structures of the proximity and wake interference in fig 8 the wake interference shows that the interaction between the wakes of two foils would only affect the hydrodynamic performance of the following foil when two foils are placed in a tandem arrangement vortex re organisation is observed including the destructive and constructive modes in the staggered arrangement the wake of the leading foil deflects upwards when it is spread around the tail of the following foil however the energy of the vortex generated by the leading foil is significantly dissipated during long term propagation therefore the c n d f of the following foil in this region is substantially smaller than that of the following foil in proximity and wake interference even though vortex re organisation occurs on the other hand there is no feedback influence from the following foil to the leading foil in this region resulting in a lack of thrust augmentation of the leading foil under proximity interference there are no obvious interactions between the vortex shedding from the two foils in our classification the lower limit of g y is set to g y 0 7 while it decreases to zero during understanding the two cylinder system when g x and g y are sufficiently large there is no interference on the wake structures of the two foils the flows behind the two foils are mutually independent and similar to the reverse von kármán vortex street behind an individual foil 4 discussion we now consider the relationship between thrust generation and the wake structures to reveal the hydro mechanism of the two travelling wavy foil system within the no interference zone vortex interaction occurs resulting in the flow behind the two foils being a reverse von kármán vortex street hence the thrusts on the two foils are the same as that on an individual foil depending on the definition of wake interference the leading foil may not be affected by the following foil indicting that c n d l 1 moreover c n d f fluctuates slightly about 1 because a weak vortex re organisation occurs behind the following foil therefore as shown in fig 4 c n d l and c n d f are approximately equal to 1 in region iii at 0 0 g x 2 5 the relationship between thrust generation and the wake structures is quite intricate there are three types of interference in region i 0 0 g x 1 0 i e proximity interference and mode ii sa and mode iii show proximity and wake interference because the proximity and wake interference show quite significant effects on thrust generation compared to proximity interference the following foil obtains a more considerable hydrodynamic force from the leading foil at lower g y in general the following foil takes the hydrodynamic force from the leading foil in region i a however in region i b the following foil experiences a visible thrust reduction at lower g y when the wake structure exhibits proximity and wake interference in region ii the leading foil enjoys thrust augmentation under proximity and wake interference whereas it suffers a thrust decrease under proximity interference under mode i of proximity interference the fluctuation trend of c n d f is more evident than other types of wake structures the peak and smallest value of c n d f are obtained at g y 0 because the vortex re organisation is more significant in mode i than in the other modes for mode ii sb and mode ii as it is noted that the changes in c n d f are not significantly affected in the zones of the proximity and wake interference although there are different types of wake interactions occurring in summary g x plays a crucial role in thrust generation because it strongly determines the types of vortex re organisation on the other hand g y causes the deflection of the vortex shedding from the leading foil to shift towards the flow behind the following foil resulting in a slight change in thrust generation on the two travelling wavy foils 5 conclusions numerical studies are conducted on the fluid dynamics around two travelling wavy foils to understand the hydrodynamic mechanism of fish schools a systematic work on thrust generation and wake structures is discussed for when two foils are arranged in tandem parallel and staggered configurations by varying dimensionless horizontal gap g x and vertical gap g y between the two foils five regions accompanied by different rhythmic changes in the dimensionless time mean thrust coefficient on the leading and following foils are defined where the most significant increase in thrust on the leading and following foils is 92 42 and 127 respectively obtained at g x g y 1 3 0 0 and g x g y 0 25 0 5 with increasing g x and g y the thrust on the two foils gradually approaches the thrust on the isolated foil we classify the wake structures into four regions i e proximity interference wake interference proximity and wake interference and no interference regions moreover the wake structures are used to understand the special regions accompanied by thrust generation the numerical results reveal that g x significantly affects the thrust on the leading and following foils by changing the modes of the wake structures and the vortex generated by the leading foil deflects towards the wake behind the following foil under the influence of g y in addition the present work is also helpful for guiding the queue control of multiple bio inspired underwater robots as ocean observation mission becomes more complicated one mission may need two or more underwater robots based on the numerical results we can conclude that two robotics can cruise at g x g y 1 3 0 0 to improve their propulsive performance or save energy acknowledgements this work is supported by national natural science foundation of china grant no 11502210 51709229 51879220 51479170 and 61803306 national key research and development program of china grant no 2016yfc0301300 natural science basic research plan in shaanxi province of china grant no 2018jq5092 
22763,ensuring the operational safety of subsea pipelines is a growing challenge it requires monitoring of failure causation factors and detailed safety analysis this paper proposes an integrated framework for comprehensive safety analysis of subsea pipelines this framework is developed based on an index based risk evaluation system which incorporates interdependency analysis of failure causal factors hazard coupling analysis and risk grade evaluation in an integrated manner the decision making trial and evaluation laboratory dematel method is utilized to analyze the interdependencies among risk factors the fuzzy reasoning algorithm is employed to calculate the risk grades of these factors in the evaluation system this framework has also considered the effect of hazard coupling combination of hazards on subsea pipeline failure the framework is tested on a case study the case study demonstrates the practicality and usability of the proposed framework this framework will serve an important tool for swiftly assess and manage the risk of subsea pipeline failures keywords safety analysis comprehensive evaluation subsea pipelines integrated framework dematel method 1 introduction subsea pipelines are critical elements for the transportation of offshore oil and gas the safe operation of subsea pipelines encounters a lot of adverse factors e g corrosion fatigue third party activities harsh environmental conditions li et al 2016 these factors may lead to the occurrence of unexpected failure incidents such as leakage or rupture that may cause the discharge of oil and gas production downtime and even catastrophic consequences past decades have seen many subsea pipelines accidents uk hse 2011 phmsa 2014 iogp 2010 any pipeline failure involving hydrocarbons release may escalate into catastrophic accidents resulting in human injury assets damage environmental pollution and loss of corporate reputation to better cope with the abovementioned challenges comprehensive safety analysis and evaluation of subsea pipelines is highly recommended to support the development of the appropriate risk mitigation strategy and ensure operational safety quantitative risk analysis assessment qra technique is widely applied in offshore oil and gas industries to achieve this purpose in the past years a number of qra methodologies have been developed to perform a safety analysis of offshore pipelines yang et al 2017 kawsar et al 2015 arzaghi et al 2017 2018 li et al 2017 2018 2019 the contributions of some specific works are discussed here dnv rp f107 2010 presented a general risk analysis framework for subsea pipelines however it just gave a qualitative procedure which cannot be used to implement a quantitative analysis and evaluation quantitative approaches are helpful to quantify the risk of pipeline failure and make a risk informed decision li et al 2016 proposed a bayesian network based dynamic risk analysis methodology to identify and assess the leakage failure of subsea pipelines aljaroudi et al 2015 presented an integrated risk based assessment scheme to predict the corrosion failure of offshore crude oil pipelines considering degradation mechanisms shabani et al 2017 analyzed the reliability of free spanning subsea pipeline hasan et al 2018 presented a corrosion risk based subsea pipelines design methodology but these studies mainly focused on analyzing and assessing the risk of subsea pipelines resulting from a single failure and studied the failure mechanism of subsea pipelines in a specific scenario a comprehensive evaluation of safety level considering the integrated risk due to various possible failure modes is generally required for decision making to ensure safe operation of subsea pipelines there already exist some frameworks for the comprehensive safety evaluation of subsea pipelines and the most widely used is kent s scoring method which can be utilized to evaluate the comprehensive risk of subsea pipelines muhlbauer 2004 however this method does not include the interrelation and coupling analysis of multiple risk factors that are dependent or independent in addition the weights of different risk factors were not considered properly in the model on the other hand through an extensive literature survey most of the related studies on comprehensive risk evaluation were conducted focusing on onshore pipelines or other process facilities harsh operational environment adds unique risk factors e g wave and current effect relatively high corrosion rate in marine environment difficult access for inspection and maintenance to safety management of subsea pipelines which makes its safety analysis more important than that of onshore pipelines to develop an integrated safety analysis framework some basic qra elements are required the qra technologies have been widely developed and applied in safety analysis over the last decade guo et al 2016 proposed a fuzzy reasoning algorithm based methodology to evaluate the risk grade of long distance oil and gas pipelines chang et al 2018 improved this methodology and applied to risk analysis of deepwater drilling riser dematel is a matrix and graph based method and constructs the interrelations between factors to build a network relations map it is very suitable to analyze the logical interrelation between factors tzeng et al 2007 chang and cheng 2011 yang et al 2013 in risk analysis the weights of different factors are usually needed to be incorporated into the model they are employed to measure the importance of different factors on system safety analytic hierarchy process ahp and entropy method em are two popular approaches to account for factor weights bell et al 2001 wang and lee 2009 the existing literature demonstrated the superiority of these methods in safety and risk modeling which can be chosen as the preferred approach to develop an integrated framework the primary purpose of this study is to develop a novel framework for safety analysis of subsea pipelines by integrating interdependency identification of failure causing factors effect analysis of hazard coupling and risk grade evaluation the unique contribution of this study is providing a comprehensive analytical approach that is able to model and quantify the interrelationship between failure causal factors and their coupling effects which are incorporated into an index based risk evaluation system the paper is organized as follows section 2 presents the proposed integrated methodology framework in which the materials used to construct this methodology and specific application steps are described in details section 3 conducts a case study to illustrate the practical application of the proposed methodology section 4 summarizes this work and makes a conclusion 2 integrated safety analysis framework the proposed safety analysis framework is formalized in a structure of an index based risk evaluation system which is comprised of analyzing interdependencies among failure causations coupling of hazards and comprehensive risk evaluation the interdependency analysis is conducted for the basic risk factors that are considered to be dependent whereas the coupling analysis is carried out for the hazard events that are considered to be independent the flowchart of the proposed safety analysis framework is presented in fig 1 this methodology is suitable to perform a comprehensive safety analysis and evaluation of subsea pipelines in the operational stage the main steps of the framework are described in the following subsections in details 2 1 defining system and identifying risk factors identifying risk factors for a defined system is the basis for establishing a risk evaluation system once a subsea pipeline is selected and the related information of the pipeline including design construction operation environmental conditions and historical failure data should be collected based on this information the risk factors related to the subsea pipelines can be identified these risk factors are then further classified by their hierarchical relationships a risk evaluation system can be established based on the results of risk identification 2 2 establishing risk evaluation system establishing a risk evaluation system for subsea pipelines is the basis for implementing the proposed framework an index based risk evaluation system is a hierarchical structure which usually includes a three layer or four layer construction e g target layer event layer and factor layer fig 2 gives a simple example of such a system which includes a three layer construction using a three layer evaluation index system as an illustrative example the target layer is the first level index which represents the safety or the risk status of the whole system it defines the target of evaluation the middle layer also named the event layer is the second level indexes the bottom layer also named factor layer is the third level indexes the indexes in each layer except for the evaluation target layer are the factors or failure events related to system safety thus risk identification should be completed before the establishment of risk evaluation system the accident reports or database are valuable sources of information identification of risk factors or failure events of a system which are then classified according to their types and the effects on the target layer a total of five grades are used to measure the risk level of evaluation indexes which is expressed as follows 1 q 0 2 0 4 0 6 0 8 1 where 0 0 2 indicates the risk grade is low 0 2 0 4 indicates the risk grade is relatively low 0 4 0 6 indicates the risk grade is medium 0 6 0 8 indicates the risk grade is relatively high and 0 8 1 indicates the risk grade is high 2 3 interdependency analysis of risk factors the bottom layer indexes factors in the risk evaluation system the far right factors in fig 2 are considered to be dependent a failure incident often happens due to the integrated contribution of these factors identification and analysis of interrelationship among basic risk factors can help to understand the failure risk evolution mechanism and develop the better control and mitigation measures the purpose of this phase is to analyze the interdependency among basic risk indexes including causality and relation which is conducted through dematel analysis a dematel method was originally developed by the battelle memorial institute through its geneva research centre gabus and fontela 1973 this method can be used to quantitatively extract the interdependency among multiple factors that were contained in the problematique which involves both the direction and the indirect influences among multiple factors tzeng et al 2007 yang et al 2013 amiri et al 2011 fig 3 presents the procedures of dematel method which is depicted in details as follows 2 3 1 generating a direct relation matrix a decision maker evaluates the relationship between sets of paired alternatives a total of five scales 0 no influence 1 low influence 2 medium influence 3 high influence and 4 very high influence are used to measure the relationship among different factors the initial data can be obtained as the direct relation matrix a which is the initial data of the dematel analysis 2 a a 11 a 1 j a 1 n a j 1 a i j a i n a n 1 a n j a n n where a is a n n matrix in which each element a ij is denoted as the degree that the factor i affects the factor j all principal diagonal elements a ii of matrix a are set to zero 2 3 2 normalizing the direct relation matrix this step is carried out to normalize the direct relation matrix the normalized direct relation matrix x can be obtained by eqs 3 and 4 3 x s a 4 s min 1 max i j 1 n a i j 1 max j i 1 n a i j 2 3 3 calculating the total relation matrix based on the normalized direct relation matrix x the total relation matrix t can be obtained using eq 5 which consists of all the relations including direct and indirect relations between risk factors 5 t x i x 1 where i is denoted as the identity matrix furthermore the sum of each row sum and the sum of each column of matrix t denoted as r i and c j are also calculated in this step through the eqs 6 and 7 6 r r i n 1 j 1 n t i j n 1 7 c c j n 1 c j 1 n i 1 n t i j 1 n where r i represents the total effects of factor i on the other factors while c j represents total effects that factor j has received from the other factors r i c i reveals the relative importance of each factor in the system when i j and is named as prominence r i c i is named as the relation which divides factors into a cause and effect groups generally if r i c i is positive then factor i is affecting other factors and if r i c i is negative then factor i is being influenced by other factors 2 3 4 producing a causal diagram the ordered pairs of r c r c can be employed to produce a causal diagram in which r c is the horizontal axis while r c is the vertical axis a comparison of importance and relation among factors could be clearly seen in the causal diagram additionally the information in total relation matrix t can be used to construct a network relation map reflecting the interdependency among risk factors visually however if all information in matrix t is considered the map will be too complex to convey useful information for decision making in general a threshold is used to filter the minor effect information in total relation matrix t and simplify the structure of a network relation map yang et al 2013 2 4 hazards coupling analysis hazards coupling analysis considers the factors in the middle layer of the proposed risk evaluation system factors in the middle layer of fig 2 these factors can also be called hazard events that are considered to be independent since they usually result from the bottom layer factors one single factor may lead to a failure the hazards coupling analysis aims to analyze the effect of hazard event coupling on the failure risk of the system for example both corrosion and fatigue can result in failure of pipelines by oneself but a combination of the corrosion and the fatigue may change the system risk state therefore it is necessary to estimate the effect of the coupling of multiple hazard events on the system risk this can be achieved by calculating the coupling risk values of multiple factors a coupling degree model is introduced to determine the coupling risk values the procedures to carry out hazard coupling analysis are discussed as follows 2 4 1 evaluating risk values of second level factors calculating risk values of second level factors must be prior to assessing their coupling effect the risk values of second level factors are obtained by applying the fuzzy reasoning algorithm to third level factors liu et al 2014 lavasani et al 2011 the weights of third level factors are obtained based on their relative importance i e prominences that are normalized as the weights the initial state information of third level factors is determined based on expert judgments which are expressed by an initial state matrix m 0 in practical application a certain number of experts are invited to vote for each third level factor to judge their risk grades the credibility of risk factors in different risk grades can be obtained from the statistic results the values of credibility for each third level factors are used to generate an initial state matrix m 0 when the initial state matrix m 0 and weights for third level factors are determined the risk grades of second level factors can be calculated by the fuzzy reasoning algorithm as eq 8 8 r e i w e i m 0 i q where r ei is the risk grade of second level factor ei w ei is a weight vector in which the element is the weight of third level factor belonging to the branch the second level factor ei m 0i is the initial state matrix of third level factors in the branch of the second level factor ei 2 4 2 coupling analysis of second level factors when the risk values of second level factors are obtained their coupling risk values can be evaluated by a coupling degree model which is usually utilized to describe the interaction among different factors in a system the coupling degree model is originated from the capacity coupling concept in physics wang et al 2018 wang and ni 2014 regarding a system with m influence factors the coupling degree of these factors could be calculated by eq 9 9 c r 1 r 2 r m i 1 2 m 1 j i 1 i 2 m m r i r j 1 m where r i is the risk value of factor i c 0 1 is the coupling degree in physics the coupling state is defined as follows c 0 indicates that there is no coupling phenomenon among these factors c 0 0 3 represents that these factors are in a low intensity coupling state c 0 3 0 7 denotes that these factors are in a moderate intensity coupling state c 0 7 1 indicates that these factors are in a high intensity coupling state c 1 denotes that the coupling state reaches the highest intensity based on the risk values of single factors the coupling risk value in each coupling scenario can be calculated through the above equation the effect of multiple factor coupling on subsea pipelines safety can be obtained by comparing and analyzing the coupling risk values 2 5 integrated risk evaluation the final step is to evaluate the integrated risk grade of subsea pipelines considering all the factors in a risk evaluation system the risk grades of second level factors have been determined in the last step therefore if the weights of second level factors are calculated the risk grade of the first level factor can be obtained the evaluation of the first level factor is carried out based on the following two sub steps 2 5 1 determining the weights of second level indexes as claimed above the factors in second level are considered to be independent in logical relation their weights mainly depend on the effect extent on the first level index the present study utilizes an approach based on ahp and em to determine the weights of second level factors ahp and em are two popular weight calculation methods wang and lee 2009 the weight based on the former mainly depends on the subjective information of decision makers while the latter uses the inherent information of indexes to determine indexes weights an ahp em method could account for both the subjective weights and the objective weights kwong and bai 2002 in practice the ahp method is used to calculate the subjective weights of risk factors while the em approach is applied to estimate the objective weights finally a combination weight is obtained by integrating the subjective weight and the objective weight of each risk factors the detailed description of ahp em approach to determine factors weights can be found in chang et al 2018 and guo et al 2016 below is a brief introduction of the application steps of this approach a establishment of the judgment matrix b consistency judgments c determination of subjective weights d modifying the subjective weights by em the former three steps are conducted in an ahp framework 2 5 2 evaluating the risk grade of the first level index when the weights of the second level indexes are determined the risk value of the first level index can also be calculated by fuzzy reasoning algorithm thus the overall risk level of subsea pipeline can be known by the operators this helps them to decide whether any preventive actions are required to improve the safety status of subsea pipelines furthermore the results on the interdependency between risk factors and the effect of hazard coupling could help to understand the system failure mechanism which will be useful to develop some strategies to prevent and control subsea pipeline failures through the framework the risk factors related to subsea pipelines safety are identified and used as the basic elements in the risk evaluation system the interrelationship between risk factors is analyzed and the effect of hazard coupling is revealed the risk grades of indexes at all levels are evaluated these results could help to understand what the failure causal factors and hazards are how they interact with each other how much the combined effect is on safety degradation of subsea pipelines the integrated safety level of subsea pipelines and which key factors should be controlled to effectively reduce the risk 3 case study 3 1 risk evaluation index system of subsea pipelines a case study is presented in this section to illustrate the proposed methodology the subsea pipelines in chengdao oil field of china are analyzed which were established in 2002 and through the main waterway the risk evaluation index system is considered to be a general model that is suitable for all subsea pipelines the difference ranging from one pipeline to another pipeline is the initial information about risk factors thus this section tends to establish a general risk evaluation index system of subsea pipelines which is based on a comprehensive risk identification of subsea pipelines in the previous years a lot of subsea pipelines accidents happened worldwide which are reported in databases and literature iogp 2010 uk hse 2011 risk identification of subsea pipelines is carried out by analyzing accident cases as reported subsea pipelines accidents are usually arisen because of many factors including corrosion material failure external loads causing damage construction damage natural disaster considering a more general expression these factors are generalized into five aspects i e corrosion structure defect third party damage natural disaster and free span fatigue which are used as the second level indexes additionally these second level indexes are further divided into more specific aspects that are used as the third level indexes subsea pipelines safety is set as the target layer i e first level index in the evaluation index system fig 4 presents the established risk evaluation index system of subsea pipelines and below is a brief analysis of the effect of the identified risk factors on subsea pipelines safety 1 corrosion corrosion is an important cause leading to the degeneration of pipeline structure the corrosion may be internal corrosion arisen by the corrosive fluid medium or external corrosion arisen by the contact with soil and water in addition the occurrence of corrosion should account for the intervention of corrosion prevention measures e g corrosion inhibitors protective coating and cathodic protection etc the failure of corrosion preventive measures is also an important cause for the corrosion failure of subsea pipelines therefore corrosion factor and preventive measure are necessary indexes to evaluate pipeline corrosion palmer and king 2004 bhandari et al 2015 2 structure defect structure defect on subsea pipelines will reduce the resistance to internal or external loadings these structural defects may be induced by design construction operation maintenance and degradation due to structural aging the pipeline with a structure defect may not undergo the design loadings and the failure may happen thus the design construction operation maintenance and structure aging factors are used to evaluate the structural defect 3 third party damage subsea pipelines located in areas where third party activities such as trawl boards ship anchor sinking ships et al take place may be damaged however pipelines are normally dimensioned to withstand loads from some objects such as trawl the pipe wall is normally covered by a concrete coating giving protection against local impact loads to the pipeline and it gives the pipeline the necessary weight to gain stability additionally subsea pipelines are usually buried in the ground with enough depth to protect the impact of third party objects during the design stage the pipeline route could be designed to avoid areas such as the waterway where the frequency of third party activities is very high in reality some other protection measures e g concrete mattress gravel et al are used to reduce the damage from the falling objects to protect the subsea pipelines competent authorities often make some legislation to regulate the offshore third party activities and perform an extensive public education to improve their safety awareness 4 natural disaster natural disaster such as the subsea earthquake subsea landside and typhoon et al is a severe external load which will exceed the resistance and break pipeline the natural disaster is a kind of accidental incident which has a very low occurrence frequency but has a very serious consequence 5 free span fatigue free spans can result in fatigue if the span is excited by the current and the pipeline can fracture relatively quickly some spans develop as the soil beneath the pipeline is washed away and an already existing span may evolve quickly as the free spans influence the local currents near the pipelines in china the fatigue was caused by extreme climatic conditions and the free span was longer than what the pipeline was designed for vortex induced vibration viv has caused pipeline leaks in the past years although subsea pipelines are buried in the ground the current will carry the soil covering the pipeline away and generate the spans thus the buried depth soil type wave and current are critical elements to analyze the free span in engineering practice some control measures are usually adopted to cope with the spans including the short piles supporting bridging with flexible hose bionic seagrass to prevent scouring et al 3 2 interdependency analysis of risk factors using dematel method a dematel analysis is conducted here to analyze the interdependency among third level indexes according to the methodology depicted in section 2 three experts in the offshore oil and gas field are invited to judge the relations among the third level indexes and construct the direct relation matrix a using the dematel procedures the direct relation matrix a is converted into the total relation matrix t which is utilized to calculated the impact degree affected degree prominence degree and relation degree of each risk factors the calculation results are presented in table 1 fig 5 depicted the effect degree and the affected degree of third level indexes which presents a clear comparison the effect degree shows the total effects of factor i on other factors it could be seen that indexes a 3 corrosion prevention measures a 4 design factors a 6 operation factors a 9 third party activities a 11 pipeline route a 17 typhoon and a 20 wave and current have the relatively high effect degree indicating that these factors have a great effect on other factors therefore these factors should be paid more attention to risk management of subsea pipelines regarding the affected degree it can be seen that most indexes have a relatively high affected degree including a 1 internal corrosion a 2 external corrosion a 3 corrosion prevention measures a 6 operation factors a 7 maintenance factors a 10 protection measures to third party activities a 18 buried depth and a 21 control measures to span the affected degree shows the total effects of factor i have received from other factors which could help to conduct a vulnerability analysis and identify the weaknesses of the system based on the dematel calculation results a causal diagram of total relationship is produced as shown in fig 6 it presents the prominence and relation degree of third level indexes prominence represents the importance of a certain factor as seen in fig 6 a 9 third party activities has the maximum prominence which indicates that the third party activities are the most important factor to affect the safety of subsea pipelines as reported in iogp 2010 38 failure of subsea pipelines is induced by the third party damage and the analysis result is consistent with the statistical data a 15 subsea earthquake has the minimum prominence due to a fairly low occurrence frequency the subsea earthquake is not required to be focused clear sorting order of factors based on their prominence is presented in fig 6 and it could give guidance for the pipeline managers to make a decision about the priority to manage risk factors the relation degree divides the factors into two types i e cause and effect groups if r c is positive this factor belongs to the cause group on the contrary this factor belongs to the effect group it can be seen that a 9 belongs to the cause group similarly other factors can be analyzed a 15 a 14 a 19 a 17 a 20 a 4 a 11 belong to the cause group whereas a 13 a 16 a 12 a 21 a 5 a 18 a 2 a 8 a 1 a 3 a 6 a 10 and a 7 belong to the effect group in practice the efforts during risk management should be made to prevent the occurrence of factors in cause group and protect the factors in effect group to reduce the effect they receive from other factors to filter the minor effect in total relation matrix t a threshold value of 0 0623 is set to isolate the relation structure of partial factors finally a network relationship map is derived from the filtered total relation matrix t as shown in fig 7 the influence relationships among all third level indexes are clearly described by the direction of the arrow a factor has an effect on one other factor or more than one other factors on the contrary one factor may be affected by one other factor or more than one factors two colors are used to mark the nodes which are corresponding to the factor type identified in the causal diagram the nodes with yellow color are in effect group while the nodes with the light green color are in cause group 3 3 hazard coupling analysis to conduct a coupling risk analysis the risk values of second level indexes are calculated according to the method in section 2 the initial state matrix of third level indexes is determined as eq 11 the weights of the third level indexes are determined by normalizing their prominences which are calculated as following vectors w e1 0 322 0 301 0 377 w e2 0 208 0 162 0 221 0 225 0 183 w e3 0 273 0 216 0 205 0 142 0 067 0 097 w e4 0 229 0 338 0 434 w e5 0 287 0 173 0 303 0 238 matlab software is employed to carry out the specific calculation procedures fig 8 presents the risk values of second level indexes using the developed methods it could be seen that third party damage falls into the scope of relatively high risk structural defect falls into the scope between medium and relatively high risk and other second level indexes fall into the scope of medium risk 10 m 0 a 1 a 2 a 3 a 4 a 5 a 6 a 7 a 8 a 9 a 10 a 11 a 12 a 13 a 14 a 15 a 16 a 17 a 18 a 19 a 20 a 21 0 1 0 3 0 5 0 1 0 0 2 0 5 0 3 0 1 0 0 5 0 4 0 1 0 0 0 3 0 2 0 3 0 1 0 1 0 2 0 3 0 2 0 1 0 2 0 1 0 1 0 4 0 3 0 1 0 3 0 2 0 2 0 3 0 0 0 1 0 2 0 3 0 4 0 0 0 2 0 3 0 5 0 2 0 1 0 1 0 5 0 1 0 1 0 2 0 4 0 2 0 1 0 3 0 2 0 2 0 1 0 2 0 1 0 2 0 2 0 1 0 4 0 4 0 4 0 2 0 0 0 6 0 2 0 2 0 0 0 4 0 3 0 1 0 2 0 0 3 0 1 0 3 0 2 0 1 0 1 0 2 0 5 0 2 0 0 3 0 4 0 3 0 0 0 1 0 1 0 4 0 2 0 2 0 1 0 3 0 3 0 2 0 1 anything that is not an independent existence must be treated as a part of the system the coupling refers to the interaction of subsystems the coupling of risk factors may change the integrated risk of the system this study accounts for a total of four types of couplings involving two three four and five factors coupling two factors coupling refers to the coupling of two factors included in 5 s level indexes affecting the safety of subsea pipelines for example the corrosion interacting with fatigue may accelerate the failure process of subsea pipelines the coupling of any two factors can be a coupling type and these are a total of ten coupling of two factors similarly three factors coupling four factors coupling and five factors coupling could be defined based on the methodology presented in section 2 the coupling degrees of different coupling types are calculated as shown in fig 9 note that the notations in horizontal ordinate represent the coupling case for example c 12 means the coupling of second level factors e 1 and e 2 and the others can be reasoned in the same way the coupling degree reflects the coordination extent of the interactive factors a high coupling degree manifests the interactive factors have good coordination which will promote the increase of system risk as seen in fig 9 the coupling degrees for different coupling types range from 0 46 to 0 62 and these coupling types are in a moderate intensity state five factors coupling c 12345 has the highest coupling degree indicating that the coupling involving all second level indexes has the highest coordination and will contribute to the highest risk of the system however in reality there is a very low possibility for all factors involving in one scenario which could be ignored during risk management additionally it could be found that the coupling degrees of three and four factors are lower than two factors coupling indicating that low coordination exists in the coupling of three or four factors it seems that the coupling degree decreases with the number of factors involved increasing since the interaction becomes more complicated when the number of factors increases thus the coordination of them decreases due to a more complicated interaction overall two factors coupling has a relatively high coordination degree the reason is that the two factor coupling is easier compared to the involvement of more factors in two factors coupling there are four peaks of coupling degree i e corrosion and third party damage c 13 structural defect and third party damage c 23 structural defect and free span fatigue c 25 and third party damage and free span fatigue c 35 the pipeline with corrosion or structural defect will not be able to withstand the external interference as expected in the design in addition when a pipe segment loses the protection of soil and evolves into a free span its resistance to the external loads e g falling objects will also decrease the viv on a pipe segment with the structural defect can accelerate the failure process therefore these two factors coupling will increase and promote the failure risk of subsea pipelines in the risk management of subsea pipelines some measures should be adopted to avoid the coupling effect of these hazard factors in reality multiple factors couplings are very rare and operators should focus more on the prevention of two factors couplings 3 4 risk evaluation and management according to the methodology depicted in section 2 5 the weights of second level indexes are calculated by the ahp em approach the subjective weights obtained by ahp are expressed using a vector w 0 2578 0 0873 0 4430 0 0458 0 1661 then the weights are modified by the em approach to reduce the subjectivity and the modified weight vector is w 0 4037 0 0713 0 3096 0 0161 0 1994 using the fuzzy reasoning algorithm the risk value of the first level index is determined to be 0 5426 which indicates that the integrated risk grade of subsea pipelines is at a medium level note that the comprehensive risk grade of subsea pipelines is at a medium level but close to the lower bound of relatively high therefore some active and targeted measures are recommended to mitigate the risk of subsea pipelines fig 10 presents the risk values of third level indexes it could be seen that the risk grades of structure degradation a 8 and third party activities a 9 reaches a high level since these subsea pipelines are located in the waterway and there is a high frequency of third party activities which increases the failure risk of subsea pipelines due to drop objects ship anchors or sinking ships furthermore the subsea pipelines have operated for more than 16 years and the structural degradation due to aging is an important challenge for the normal operation of subsea pipelines therefore the evaluated results are consistent with the actual conditions of pipelines firstly the sea patrol period should be re planned to control the potential damage from third party activities in addition a comprehensive finite element analysis of pipeline structure is required to determine the effect of structure degradation on residual strength and life of subsea pipelines and some specific repairing and reinforcement measures are recommended to keep the structural integrity of subsea pipelines the risk grades of operation factors a 6 protection measures for third party activities a 10 pipeline route a 11 public education a 13 and wave and current a 16 are in the relatively high level the operation factors such as a false operation may cause the buckling or other failure forms of the pipeline insufficient protection measures for the critical pipe segments may also increase the failure risk of the pipeline during the early design stage an unreasonable design of pipeline route may make the pipeline cross the dense areas of third party activities such as the main waterway which can also increase the risk of pipeline damaged by the drop objects the execution of a well public education will make the public enhance the awareness to protect pipeline and report some intrusion or damage activities in time wave and current are a critical factor to induce the viv of the pipeline and cause fatigue failure in addition it is worth noting that the risk grades of half of the third level indexes are in the medium level and these factors include the a 1 a 2 a 4 a 5 a 7 a 12 a 16 a 17 a 18 a 19 and a 21 it is a priority to prevent the factors with higher risk grades therefore the results could provide a useful guide to manage the risk factors according to their risk grades 4 advantages and limitations the proposed methodology is an integrated framework which is capable of analyzing interrelationship among failure causations assessing effects of hazards coupling and evaluating comprehensive risk compared to the previous conventional techniques such as kent s scoring method the proposed framework enriches their functions and better facilitates implementation process it is able to assess the comprehensive risk of subsea pipelines but find out the interdependencies among failure causations and the effect of hazards coupling the proposed framework accounts for the weights of different indexes a weighted method is employed to integrate both subjective and objective weights of each evaluation index the risk values of indexes at different levels are obtained the comprehensive risk value reflects the safety status of subsea pipeline i e whether the system risk is at an acceptable level the risk value of indexes at second or third levels could provide a reference for risk ranking based management and control of failure causations i e which indexes are required to give the preferential control table 2 compares the quantitative evaluation results from kent s scoring method and proposed methodology it can be found that kent s scoring method gives a conservative assessment kent s scoring method considers that the weights of different evaluation indexes are same and the overall risk score is the sum of each evaluation index thus the fundamental contribution of each index to failure risk of pipeline is equivalent it leads to an excessive assessment of the overall risk in contrast the proposed methodology accounts for the weight of each index by including both its objective attribute and subjective cognition of evaluator thus the contributions of some indexes to pipeline risk are weakened as a result the proposed methodology produces a more reasonable result since the weights of different indexes are considered the interrelationship among failure causations and the effect of hazards coupling are two useful outputs which could help to understand the risk evolution mechanism of subsea pipeline failure i e how the failure causations interact with each other and what effects will be caused due to hazards coupling which can support the development of risk prevention and control strategy to disconnect the interrelationship and coupling of failure causations these mentioned results cannot be achieved by the previous conventional techniques the proposed framework is a promising approach to safety analysis and evaluation of subsea pipeline which can complement the conventional techniques however there is still some work required to be done for making further improvements the limitations of the present methodology are summarized as follows 1 the established risk evaluation index system only focuses on the operational stage of subsea pipelines 2 the proposed methodology is static and can be only used to analyze the present situation of subsea pipelines 3 initial state of risk factors still depends on the knowledge of experts and modelers 5 summary and conclusions this paper proposes an integrated framework for safety analysis and evaluation of subsea pipelines considering the interdependency between multiple factors an index based risk evaluation system of subsea pipelines is established and a dematel analysis is conducted to identify the interrelationships between third level indexes factors layer coupling analysis of second level indexes events layer is used to reveal the effect of multiple factors coupling on the system risk the integrated risk level of subsea pipelines is obtained using the fuzzy reasoning algorithm in which an ahp em approach is employed to determine the weights of risk factors the outcomes from the proposed framework could help to support decision making in risk management of subsea pipelines a case study on safety analysis of subsea pipelines in chengdao oil field of china is conducted to demonstrate the practicability of the proposed methodology the initial states of basic risk factors are determined based on expert judgments then the risk values of evaluation indexes at each level are obtained from the fuzzy reasoning algorithm the causality and relationships between risk factors are analyzed through dematel analysis which helps to quantify the effect and affected degree prominence and relation of each risk factor a causal diagram and a network relationship map are drawn based on the results of dematel analysis the coupling analysis indicates that the combined action of two factors has an obvious promotion on the failure risk of pipeline which could be the primary events that should be prevented in risk management of subsea pipelines the safety evaluation results on the risk grades of the indexes at all levels and the integrated system could not only support the safety related decision making but also provide valuable information for the management of various risk factors the present study is unique in 1 providing an integrated framework for comprehensive safety analysis of subsea pipelines which integrates risk identification interrelationship and coupling analysis and risk grade evaluation 2 underlying interdependency and interaction between risk factors are revealed 3 the way how these factors cause promote and affect the risk of subsea pipelines is investigated the proposed framework is suitable to execute a deep safety analysis and evaluation of subsea pipelines besides this methodology can also be used for safety analysis of other offshore facilities or operations with adjustment of the specific aspects for evaluation future work is planned to extend the proposed methodology for life cycle risk analysis and evaluation of subsea pipelines in addition more attempts will be made to include the dynamic elements in the model and develop it into a probabilistic approach acknowledgement the authors gratefully acknowledge the financial support provided by the national key r d program of china no 2016yfc0802305 furthermore the thanks are also given to anonymous reviewers for their valuable comments to improve the paper 
22763,ensuring the operational safety of subsea pipelines is a growing challenge it requires monitoring of failure causation factors and detailed safety analysis this paper proposes an integrated framework for comprehensive safety analysis of subsea pipelines this framework is developed based on an index based risk evaluation system which incorporates interdependency analysis of failure causal factors hazard coupling analysis and risk grade evaluation in an integrated manner the decision making trial and evaluation laboratory dematel method is utilized to analyze the interdependencies among risk factors the fuzzy reasoning algorithm is employed to calculate the risk grades of these factors in the evaluation system this framework has also considered the effect of hazard coupling combination of hazards on subsea pipeline failure the framework is tested on a case study the case study demonstrates the practicality and usability of the proposed framework this framework will serve an important tool for swiftly assess and manage the risk of subsea pipeline failures keywords safety analysis comprehensive evaluation subsea pipelines integrated framework dematel method 1 introduction subsea pipelines are critical elements for the transportation of offshore oil and gas the safe operation of subsea pipelines encounters a lot of adverse factors e g corrosion fatigue third party activities harsh environmental conditions li et al 2016 these factors may lead to the occurrence of unexpected failure incidents such as leakage or rupture that may cause the discharge of oil and gas production downtime and even catastrophic consequences past decades have seen many subsea pipelines accidents uk hse 2011 phmsa 2014 iogp 2010 any pipeline failure involving hydrocarbons release may escalate into catastrophic accidents resulting in human injury assets damage environmental pollution and loss of corporate reputation to better cope with the abovementioned challenges comprehensive safety analysis and evaluation of subsea pipelines is highly recommended to support the development of the appropriate risk mitigation strategy and ensure operational safety quantitative risk analysis assessment qra technique is widely applied in offshore oil and gas industries to achieve this purpose in the past years a number of qra methodologies have been developed to perform a safety analysis of offshore pipelines yang et al 2017 kawsar et al 2015 arzaghi et al 2017 2018 li et al 2017 2018 2019 the contributions of some specific works are discussed here dnv rp f107 2010 presented a general risk analysis framework for subsea pipelines however it just gave a qualitative procedure which cannot be used to implement a quantitative analysis and evaluation quantitative approaches are helpful to quantify the risk of pipeline failure and make a risk informed decision li et al 2016 proposed a bayesian network based dynamic risk analysis methodology to identify and assess the leakage failure of subsea pipelines aljaroudi et al 2015 presented an integrated risk based assessment scheme to predict the corrosion failure of offshore crude oil pipelines considering degradation mechanisms shabani et al 2017 analyzed the reliability of free spanning subsea pipeline hasan et al 2018 presented a corrosion risk based subsea pipelines design methodology but these studies mainly focused on analyzing and assessing the risk of subsea pipelines resulting from a single failure and studied the failure mechanism of subsea pipelines in a specific scenario a comprehensive evaluation of safety level considering the integrated risk due to various possible failure modes is generally required for decision making to ensure safe operation of subsea pipelines there already exist some frameworks for the comprehensive safety evaluation of subsea pipelines and the most widely used is kent s scoring method which can be utilized to evaluate the comprehensive risk of subsea pipelines muhlbauer 2004 however this method does not include the interrelation and coupling analysis of multiple risk factors that are dependent or independent in addition the weights of different risk factors were not considered properly in the model on the other hand through an extensive literature survey most of the related studies on comprehensive risk evaluation were conducted focusing on onshore pipelines or other process facilities harsh operational environment adds unique risk factors e g wave and current effect relatively high corrosion rate in marine environment difficult access for inspection and maintenance to safety management of subsea pipelines which makes its safety analysis more important than that of onshore pipelines to develop an integrated safety analysis framework some basic qra elements are required the qra technologies have been widely developed and applied in safety analysis over the last decade guo et al 2016 proposed a fuzzy reasoning algorithm based methodology to evaluate the risk grade of long distance oil and gas pipelines chang et al 2018 improved this methodology and applied to risk analysis of deepwater drilling riser dematel is a matrix and graph based method and constructs the interrelations between factors to build a network relations map it is very suitable to analyze the logical interrelation between factors tzeng et al 2007 chang and cheng 2011 yang et al 2013 in risk analysis the weights of different factors are usually needed to be incorporated into the model they are employed to measure the importance of different factors on system safety analytic hierarchy process ahp and entropy method em are two popular approaches to account for factor weights bell et al 2001 wang and lee 2009 the existing literature demonstrated the superiority of these methods in safety and risk modeling which can be chosen as the preferred approach to develop an integrated framework the primary purpose of this study is to develop a novel framework for safety analysis of subsea pipelines by integrating interdependency identification of failure causing factors effect analysis of hazard coupling and risk grade evaluation the unique contribution of this study is providing a comprehensive analytical approach that is able to model and quantify the interrelationship between failure causal factors and their coupling effects which are incorporated into an index based risk evaluation system the paper is organized as follows section 2 presents the proposed integrated methodology framework in which the materials used to construct this methodology and specific application steps are described in details section 3 conducts a case study to illustrate the practical application of the proposed methodology section 4 summarizes this work and makes a conclusion 2 integrated safety analysis framework the proposed safety analysis framework is formalized in a structure of an index based risk evaluation system which is comprised of analyzing interdependencies among failure causations coupling of hazards and comprehensive risk evaluation the interdependency analysis is conducted for the basic risk factors that are considered to be dependent whereas the coupling analysis is carried out for the hazard events that are considered to be independent the flowchart of the proposed safety analysis framework is presented in fig 1 this methodology is suitable to perform a comprehensive safety analysis and evaluation of subsea pipelines in the operational stage the main steps of the framework are described in the following subsections in details 2 1 defining system and identifying risk factors identifying risk factors for a defined system is the basis for establishing a risk evaluation system once a subsea pipeline is selected and the related information of the pipeline including design construction operation environmental conditions and historical failure data should be collected based on this information the risk factors related to the subsea pipelines can be identified these risk factors are then further classified by their hierarchical relationships a risk evaluation system can be established based on the results of risk identification 2 2 establishing risk evaluation system establishing a risk evaluation system for subsea pipelines is the basis for implementing the proposed framework an index based risk evaluation system is a hierarchical structure which usually includes a three layer or four layer construction e g target layer event layer and factor layer fig 2 gives a simple example of such a system which includes a three layer construction using a three layer evaluation index system as an illustrative example the target layer is the first level index which represents the safety or the risk status of the whole system it defines the target of evaluation the middle layer also named the event layer is the second level indexes the bottom layer also named factor layer is the third level indexes the indexes in each layer except for the evaluation target layer are the factors or failure events related to system safety thus risk identification should be completed before the establishment of risk evaluation system the accident reports or database are valuable sources of information identification of risk factors or failure events of a system which are then classified according to their types and the effects on the target layer a total of five grades are used to measure the risk level of evaluation indexes which is expressed as follows 1 q 0 2 0 4 0 6 0 8 1 where 0 0 2 indicates the risk grade is low 0 2 0 4 indicates the risk grade is relatively low 0 4 0 6 indicates the risk grade is medium 0 6 0 8 indicates the risk grade is relatively high and 0 8 1 indicates the risk grade is high 2 3 interdependency analysis of risk factors the bottom layer indexes factors in the risk evaluation system the far right factors in fig 2 are considered to be dependent a failure incident often happens due to the integrated contribution of these factors identification and analysis of interrelationship among basic risk factors can help to understand the failure risk evolution mechanism and develop the better control and mitigation measures the purpose of this phase is to analyze the interdependency among basic risk indexes including causality and relation which is conducted through dematel analysis a dematel method was originally developed by the battelle memorial institute through its geneva research centre gabus and fontela 1973 this method can be used to quantitatively extract the interdependency among multiple factors that were contained in the problematique which involves both the direction and the indirect influences among multiple factors tzeng et al 2007 yang et al 2013 amiri et al 2011 fig 3 presents the procedures of dematel method which is depicted in details as follows 2 3 1 generating a direct relation matrix a decision maker evaluates the relationship between sets of paired alternatives a total of five scales 0 no influence 1 low influence 2 medium influence 3 high influence and 4 very high influence are used to measure the relationship among different factors the initial data can be obtained as the direct relation matrix a which is the initial data of the dematel analysis 2 a a 11 a 1 j a 1 n a j 1 a i j a i n a n 1 a n j a n n where a is a n n matrix in which each element a ij is denoted as the degree that the factor i affects the factor j all principal diagonal elements a ii of matrix a are set to zero 2 3 2 normalizing the direct relation matrix this step is carried out to normalize the direct relation matrix the normalized direct relation matrix x can be obtained by eqs 3 and 4 3 x s a 4 s min 1 max i j 1 n a i j 1 max j i 1 n a i j 2 3 3 calculating the total relation matrix based on the normalized direct relation matrix x the total relation matrix t can be obtained using eq 5 which consists of all the relations including direct and indirect relations between risk factors 5 t x i x 1 where i is denoted as the identity matrix furthermore the sum of each row sum and the sum of each column of matrix t denoted as r i and c j are also calculated in this step through the eqs 6 and 7 6 r r i n 1 j 1 n t i j n 1 7 c c j n 1 c j 1 n i 1 n t i j 1 n where r i represents the total effects of factor i on the other factors while c j represents total effects that factor j has received from the other factors r i c i reveals the relative importance of each factor in the system when i j and is named as prominence r i c i is named as the relation which divides factors into a cause and effect groups generally if r i c i is positive then factor i is affecting other factors and if r i c i is negative then factor i is being influenced by other factors 2 3 4 producing a causal diagram the ordered pairs of r c r c can be employed to produce a causal diagram in which r c is the horizontal axis while r c is the vertical axis a comparison of importance and relation among factors could be clearly seen in the causal diagram additionally the information in total relation matrix t can be used to construct a network relation map reflecting the interdependency among risk factors visually however if all information in matrix t is considered the map will be too complex to convey useful information for decision making in general a threshold is used to filter the minor effect information in total relation matrix t and simplify the structure of a network relation map yang et al 2013 2 4 hazards coupling analysis hazards coupling analysis considers the factors in the middle layer of the proposed risk evaluation system factors in the middle layer of fig 2 these factors can also be called hazard events that are considered to be independent since they usually result from the bottom layer factors one single factor may lead to a failure the hazards coupling analysis aims to analyze the effect of hazard event coupling on the failure risk of the system for example both corrosion and fatigue can result in failure of pipelines by oneself but a combination of the corrosion and the fatigue may change the system risk state therefore it is necessary to estimate the effect of the coupling of multiple hazard events on the system risk this can be achieved by calculating the coupling risk values of multiple factors a coupling degree model is introduced to determine the coupling risk values the procedures to carry out hazard coupling analysis are discussed as follows 2 4 1 evaluating risk values of second level factors calculating risk values of second level factors must be prior to assessing their coupling effect the risk values of second level factors are obtained by applying the fuzzy reasoning algorithm to third level factors liu et al 2014 lavasani et al 2011 the weights of third level factors are obtained based on their relative importance i e prominences that are normalized as the weights the initial state information of third level factors is determined based on expert judgments which are expressed by an initial state matrix m 0 in practical application a certain number of experts are invited to vote for each third level factor to judge their risk grades the credibility of risk factors in different risk grades can be obtained from the statistic results the values of credibility for each third level factors are used to generate an initial state matrix m 0 when the initial state matrix m 0 and weights for third level factors are determined the risk grades of second level factors can be calculated by the fuzzy reasoning algorithm as eq 8 8 r e i w e i m 0 i q where r ei is the risk grade of second level factor ei w ei is a weight vector in which the element is the weight of third level factor belonging to the branch the second level factor ei m 0i is the initial state matrix of third level factors in the branch of the second level factor ei 2 4 2 coupling analysis of second level factors when the risk values of second level factors are obtained their coupling risk values can be evaluated by a coupling degree model which is usually utilized to describe the interaction among different factors in a system the coupling degree model is originated from the capacity coupling concept in physics wang et al 2018 wang and ni 2014 regarding a system with m influence factors the coupling degree of these factors could be calculated by eq 9 9 c r 1 r 2 r m i 1 2 m 1 j i 1 i 2 m m r i r j 1 m where r i is the risk value of factor i c 0 1 is the coupling degree in physics the coupling state is defined as follows c 0 indicates that there is no coupling phenomenon among these factors c 0 0 3 represents that these factors are in a low intensity coupling state c 0 3 0 7 denotes that these factors are in a moderate intensity coupling state c 0 7 1 indicates that these factors are in a high intensity coupling state c 1 denotes that the coupling state reaches the highest intensity based on the risk values of single factors the coupling risk value in each coupling scenario can be calculated through the above equation the effect of multiple factor coupling on subsea pipelines safety can be obtained by comparing and analyzing the coupling risk values 2 5 integrated risk evaluation the final step is to evaluate the integrated risk grade of subsea pipelines considering all the factors in a risk evaluation system the risk grades of second level factors have been determined in the last step therefore if the weights of second level factors are calculated the risk grade of the first level factor can be obtained the evaluation of the first level factor is carried out based on the following two sub steps 2 5 1 determining the weights of second level indexes as claimed above the factors in second level are considered to be independent in logical relation their weights mainly depend on the effect extent on the first level index the present study utilizes an approach based on ahp and em to determine the weights of second level factors ahp and em are two popular weight calculation methods wang and lee 2009 the weight based on the former mainly depends on the subjective information of decision makers while the latter uses the inherent information of indexes to determine indexes weights an ahp em method could account for both the subjective weights and the objective weights kwong and bai 2002 in practice the ahp method is used to calculate the subjective weights of risk factors while the em approach is applied to estimate the objective weights finally a combination weight is obtained by integrating the subjective weight and the objective weight of each risk factors the detailed description of ahp em approach to determine factors weights can be found in chang et al 2018 and guo et al 2016 below is a brief introduction of the application steps of this approach a establishment of the judgment matrix b consistency judgments c determination of subjective weights d modifying the subjective weights by em the former three steps are conducted in an ahp framework 2 5 2 evaluating the risk grade of the first level index when the weights of the second level indexes are determined the risk value of the first level index can also be calculated by fuzzy reasoning algorithm thus the overall risk level of subsea pipeline can be known by the operators this helps them to decide whether any preventive actions are required to improve the safety status of subsea pipelines furthermore the results on the interdependency between risk factors and the effect of hazard coupling could help to understand the system failure mechanism which will be useful to develop some strategies to prevent and control subsea pipeline failures through the framework the risk factors related to subsea pipelines safety are identified and used as the basic elements in the risk evaluation system the interrelationship between risk factors is analyzed and the effect of hazard coupling is revealed the risk grades of indexes at all levels are evaluated these results could help to understand what the failure causal factors and hazards are how they interact with each other how much the combined effect is on safety degradation of subsea pipelines the integrated safety level of subsea pipelines and which key factors should be controlled to effectively reduce the risk 3 case study 3 1 risk evaluation index system of subsea pipelines a case study is presented in this section to illustrate the proposed methodology the subsea pipelines in chengdao oil field of china are analyzed which were established in 2002 and through the main waterway the risk evaluation index system is considered to be a general model that is suitable for all subsea pipelines the difference ranging from one pipeline to another pipeline is the initial information about risk factors thus this section tends to establish a general risk evaluation index system of subsea pipelines which is based on a comprehensive risk identification of subsea pipelines in the previous years a lot of subsea pipelines accidents happened worldwide which are reported in databases and literature iogp 2010 uk hse 2011 risk identification of subsea pipelines is carried out by analyzing accident cases as reported subsea pipelines accidents are usually arisen because of many factors including corrosion material failure external loads causing damage construction damage natural disaster considering a more general expression these factors are generalized into five aspects i e corrosion structure defect third party damage natural disaster and free span fatigue which are used as the second level indexes additionally these second level indexes are further divided into more specific aspects that are used as the third level indexes subsea pipelines safety is set as the target layer i e first level index in the evaluation index system fig 4 presents the established risk evaluation index system of subsea pipelines and below is a brief analysis of the effect of the identified risk factors on subsea pipelines safety 1 corrosion corrosion is an important cause leading to the degeneration of pipeline structure the corrosion may be internal corrosion arisen by the corrosive fluid medium or external corrosion arisen by the contact with soil and water in addition the occurrence of corrosion should account for the intervention of corrosion prevention measures e g corrosion inhibitors protective coating and cathodic protection etc the failure of corrosion preventive measures is also an important cause for the corrosion failure of subsea pipelines therefore corrosion factor and preventive measure are necessary indexes to evaluate pipeline corrosion palmer and king 2004 bhandari et al 2015 2 structure defect structure defect on subsea pipelines will reduce the resistance to internal or external loadings these structural defects may be induced by design construction operation maintenance and degradation due to structural aging the pipeline with a structure defect may not undergo the design loadings and the failure may happen thus the design construction operation maintenance and structure aging factors are used to evaluate the structural defect 3 third party damage subsea pipelines located in areas where third party activities such as trawl boards ship anchor sinking ships et al take place may be damaged however pipelines are normally dimensioned to withstand loads from some objects such as trawl the pipe wall is normally covered by a concrete coating giving protection against local impact loads to the pipeline and it gives the pipeline the necessary weight to gain stability additionally subsea pipelines are usually buried in the ground with enough depth to protect the impact of third party objects during the design stage the pipeline route could be designed to avoid areas such as the waterway where the frequency of third party activities is very high in reality some other protection measures e g concrete mattress gravel et al are used to reduce the damage from the falling objects to protect the subsea pipelines competent authorities often make some legislation to regulate the offshore third party activities and perform an extensive public education to improve their safety awareness 4 natural disaster natural disaster such as the subsea earthquake subsea landside and typhoon et al is a severe external load which will exceed the resistance and break pipeline the natural disaster is a kind of accidental incident which has a very low occurrence frequency but has a very serious consequence 5 free span fatigue free spans can result in fatigue if the span is excited by the current and the pipeline can fracture relatively quickly some spans develop as the soil beneath the pipeline is washed away and an already existing span may evolve quickly as the free spans influence the local currents near the pipelines in china the fatigue was caused by extreme climatic conditions and the free span was longer than what the pipeline was designed for vortex induced vibration viv has caused pipeline leaks in the past years although subsea pipelines are buried in the ground the current will carry the soil covering the pipeline away and generate the spans thus the buried depth soil type wave and current are critical elements to analyze the free span in engineering practice some control measures are usually adopted to cope with the spans including the short piles supporting bridging with flexible hose bionic seagrass to prevent scouring et al 3 2 interdependency analysis of risk factors using dematel method a dematel analysis is conducted here to analyze the interdependency among third level indexes according to the methodology depicted in section 2 three experts in the offshore oil and gas field are invited to judge the relations among the third level indexes and construct the direct relation matrix a using the dematel procedures the direct relation matrix a is converted into the total relation matrix t which is utilized to calculated the impact degree affected degree prominence degree and relation degree of each risk factors the calculation results are presented in table 1 fig 5 depicted the effect degree and the affected degree of third level indexes which presents a clear comparison the effect degree shows the total effects of factor i on other factors it could be seen that indexes a 3 corrosion prevention measures a 4 design factors a 6 operation factors a 9 third party activities a 11 pipeline route a 17 typhoon and a 20 wave and current have the relatively high effect degree indicating that these factors have a great effect on other factors therefore these factors should be paid more attention to risk management of subsea pipelines regarding the affected degree it can be seen that most indexes have a relatively high affected degree including a 1 internal corrosion a 2 external corrosion a 3 corrosion prevention measures a 6 operation factors a 7 maintenance factors a 10 protection measures to third party activities a 18 buried depth and a 21 control measures to span the affected degree shows the total effects of factor i have received from other factors which could help to conduct a vulnerability analysis and identify the weaknesses of the system based on the dematel calculation results a causal diagram of total relationship is produced as shown in fig 6 it presents the prominence and relation degree of third level indexes prominence represents the importance of a certain factor as seen in fig 6 a 9 third party activities has the maximum prominence which indicates that the third party activities are the most important factor to affect the safety of subsea pipelines as reported in iogp 2010 38 failure of subsea pipelines is induced by the third party damage and the analysis result is consistent with the statistical data a 15 subsea earthquake has the minimum prominence due to a fairly low occurrence frequency the subsea earthquake is not required to be focused clear sorting order of factors based on their prominence is presented in fig 6 and it could give guidance for the pipeline managers to make a decision about the priority to manage risk factors the relation degree divides the factors into two types i e cause and effect groups if r c is positive this factor belongs to the cause group on the contrary this factor belongs to the effect group it can be seen that a 9 belongs to the cause group similarly other factors can be analyzed a 15 a 14 a 19 a 17 a 20 a 4 a 11 belong to the cause group whereas a 13 a 16 a 12 a 21 a 5 a 18 a 2 a 8 a 1 a 3 a 6 a 10 and a 7 belong to the effect group in practice the efforts during risk management should be made to prevent the occurrence of factors in cause group and protect the factors in effect group to reduce the effect they receive from other factors to filter the minor effect in total relation matrix t a threshold value of 0 0623 is set to isolate the relation structure of partial factors finally a network relationship map is derived from the filtered total relation matrix t as shown in fig 7 the influence relationships among all third level indexes are clearly described by the direction of the arrow a factor has an effect on one other factor or more than one other factors on the contrary one factor may be affected by one other factor or more than one factors two colors are used to mark the nodes which are corresponding to the factor type identified in the causal diagram the nodes with yellow color are in effect group while the nodes with the light green color are in cause group 3 3 hazard coupling analysis to conduct a coupling risk analysis the risk values of second level indexes are calculated according to the method in section 2 the initial state matrix of third level indexes is determined as eq 11 the weights of the third level indexes are determined by normalizing their prominences which are calculated as following vectors w e1 0 322 0 301 0 377 w e2 0 208 0 162 0 221 0 225 0 183 w e3 0 273 0 216 0 205 0 142 0 067 0 097 w e4 0 229 0 338 0 434 w e5 0 287 0 173 0 303 0 238 matlab software is employed to carry out the specific calculation procedures fig 8 presents the risk values of second level indexes using the developed methods it could be seen that third party damage falls into the scope of relatively high risk structural defect falls into the scope between medium and relatively high risk and other second level indexes fall into the scope of medium risk 10 m 0 a 1 a 2 a 3 a 4 a 5 a 6 a 7 a 8 a 9 a 10 a 11 a 12 a 13 a 14 a 15 a 16 a 17 a 18 a 19 a 20 a 21 0 1 0 3 0 5 0 1 0 0 2 0 5 0 3 0 1 0 0 5 0 4 0 1 0 0 0 3 0 2 0 3 0 1 0 1 0 2 0 3 0 2 0 1 0 2 0 1 0 1 0 4 0 3 0 1 0 3 0 2 0 2 0 3 0 0 0 1 0 2 0 3 0 4 0 0 0 2 0 3 0 5 0 2 0 1 0 1 0 5 0 1 0 1 0 2 0 4 0 2 0 1 0 3 0 2 0 2 0 1 0 2 0 1 0 2 0 2 0 1 0 4 0 4 0 4 0 2 0 0 0 6 0 2 0 2 0 0 0 4 0 3 0 1 0 2 0 0 3 0 1 0 3 0 2 0 1 0 1 0 2 0 5 0 2 0 0 3 0 4 0 3 0 0 0 1 0 1 0 4 0 2 0 2 0 1 0 3 0 3 0 2 0 1 anything that is not an independent existence must be treated as a part of the system the coupling refers to the interaction of subsystems the coupling of risk factors may change the integrated risk of the system this study accounts for a total of four types of couplings involving two three four and five factors coupling two factors coupling refers to the coupling of two factors included in 5 s level indexes affecting the safety of subsea pipelines for example the corrosion interacting with fatigue may accelerate the failure process of subsea pipelines the coupling of any two factors can be a coupling type and these are a total of ten coupling of two factors similarly three factors coupling four factors coupling and five factors coupling could be defined based on the methodology presented in section 2 the coupling degrees of different coupling types are calculated as shown in fig 9 note that the notations in horizontal ordinate represent the coupling case for example c 12 means the coupling of second level factors e 1 and e 2 and the others can be reasoned in the same way the coupling degree reflects the coordination extent of the interactive factors a high coupling degree manifests the interactive factors have good coordination which will promote the increase of system risk as seen in fig 9 the coupling degrees for different coupling types range from 0 46 to 0 62 and these coupling types are in a moderate intensity state five factors coupling c 12345 has the highest coupling degree indicating that the coupling involving all second level indexes has the highest coordination and will contribute to the highest risk of the system however in reality there is a very low possibility for all factors involving in one scenario which could be ignored during risk management additionally it could be found that the coupling degrees of three and four factors are lower than two factors coupling indicating that low coordination exists in the coupling of three or four factors it seems that the coupling degree decreases with the number of factors involved increasing since the interaction becomes more complicated when the number of factors increases thus the coordination of them decreases due to a more complicated interaction overall two factors coupling has a relatively high coordination degree the reason is that the two factor coupling is easier compared to the involvement of more factors in two factors coupling there are four peaks of coupling degree i e corrosion and third party damage c 13 structural defect and third party damage c 23 structural defect and free span fatigue c 25 and third party damage and free span fatigue c 35 the pipeline with corrosion or structural defect will not be able to withstand the external interference as expected in the design in addition when a pipe segment loses the protection of soil and evolves into a free span its resistance to the external loads e g falling objects will also decrease the viv on a pipe segment with the structural defect can accelerate the failure process therefore these two factors coupling will increase and promote the failure risk of subsea pipelines in the risk management of subsea pipelines some measures should be adopted to avoid the coupling effect of these hazard factors in reality multiple factors couplings are very rare and operators should focus more on the prevention of two factors couplings 3 4 risk evaluation and management according to the methodology depicted in section 2 5 the weights of second level indexes are calculated by the ahp em approach the subjective weights obtained by ahp are expressed using a vector w 0 2578 0 0873 0 4430 0 0458 0 1661 then the weights are modified by the em approach to reduce the subjectivity and the modified weight vector is w 0 4037 0 0713 0 3096 0 0161 0 1994 using the fuzzy reasoning algorithm the risk value of the first level index is determined to be 0 5426 which indicates that the integrated risk grade of subsea pipelines is at a medium level note that the comprehensive risk grade of subsea pipelines is at a medium level but close to the lower bound of relatively high therefore some active and targeted measures are recommended to mitigate the risk of subsea pipelines fig 10 presents the risk values of third level indexes it could be seen that the risk grades of structure degradation a 8 and third party activities a 9 reaches a high level since these subsea pipelines are located in the waterway and there is a high frequency of third party activities which increases the failure risk of subsea pipelines due to drop objects ship anchors or sinking ships furthermore the subsea pipelines have operated for more than 16 years and the structural degradation due to aging is an important challenge for the normal operation of subsea pipelines therefore the evaluated results are consistent with the actual conditions of pipelines firstly the sea patrol period should be re planned to control the potential damage from third party activities in addition a comprehensive finite element analysis of pipeline structure is required to determine the effect of structure degradation on residual strength and life of subsea pipelines and some specific repairing and reinforcement measures are recommended to keep the structural integrity of subsea pipelines the risk grades of operation factors a 6 protection measures for third party activities a 10 pipeline route a 11 public education a 13 and wave and current a 16 are in the relatively high level the operation factors such as a false operation may cause the buckling or other failure forms of the pipeline insufficient protection measures for the critical pipe segments may also increase the failure risk of the pipeline during the early design stage an unreasonable design of pipeline route may make the pipeline cross the dense areas of third party activities such as the main waterway which can also increase the risk of pipeline damaged by the drop objects the execution of a well public education will make the public enhance the awareness to protect pipeline and report some intrusion or damage activities in time wave and current are a critical factor to induce the viv of the pipeline and cause fatigue failure in addition it is worth noting that the risk grades of half of the third level indexes are in the medium level and these factors include the a 1 a 2 a 4 a 5 a 7 a 12 a 16 a 17 a 18 a 19 and a 21 it is a priority to prevent the factors with higher risk grades therefore the results could provide a useful guide to manage the risk factors according to their risk grades 4 advantages and limitations the proposed methodology is an integrated framework which is capable of analyzing interrelationship among failure causations assessing effects of hazards coupling and evaluating comprehensive risk compared to the previous conventional techniques such as kent s scoring method the proposed framework enriches their functions and better facilitates implementation process it is able to assess the comprehensive risk of subsea pipelines but find out the interdependencies among failure causations and the effect of hazards coupling the proposed framework accounts for the weights of different indexes a weighted method is employed to integrate both subjective and objective weights of each evaluation index the risk values of indexes at different levels are obtained the comprehensive risk value reflects the safety status of subsea pipeline i e whether the system risk is at an acceptable level the risk value of indexes at second or third levels could provide a reference for risk ranking based management and control of failure causations i e which indexes are required to give the preferential control table 2 compares the quantitative evaluation results from kent s scoring method and proposed methodology it can be found that kent s scoring method gives a conservative assessment kent s scoring method considers that the weights of different evaluation indexes are same and the overall risk score is the sum of each evaluation index thus the fundamental contribution of each index to failure risk of pipeline is equivalent it leads to an excessive assessment of the overall risk in contrast the proposed methodology accounts for the weight of each index by including both its objective attribute and subjective cognition of evaluator thus the contributions of some indexes to pipeline risk are weakened as a result the proposed methodology produces a more reasonable result since the weights of different indexes are considered the interrelationship among failure causations and the effect of hazards coupling are two useful outputs which could help to understand the risk evolution mechanism of subsea pipeline failure i e how the failure causations interact with each other and what effects will be caused due to hazards coupling which can support the development of risk prevention and control strategy to disconnect the interrelationship and coupling of failure causations these mentioned results cannot be achieved by the previous conventional techniques the proposed framework is a promising approach to safety analysis and evaluation of subsea pipeline which can complement the conventional techniques however there is still some work required to be done for making further improvements the limitations of the present methodology are summarized as follows 1 the established risk evaluation index system only focuses on the operational stage of subsea pipelines 2 the proposed methodology is static and can be only used to analyze the present situation of subsea pipelines 3 initial state of risk factors still depends on the knowledge of experts and modelers 5 summary and conclusions this paper proposes an integrated framework for safety analysis and evaluation of subsea pipelines considering the interdependency between multiple factors an index based risk evaluation system of subsea pipelines is established and a dematel analysis is conducted to identify the interrelationships between third level indexes factors layer coupling analysis of second level indexes events layer is used to reveal the effect of multiple factors coupling on the system risk the integrated risk level of subsea pipelines is obtained using the fuzzy reasoning algorithm in which an ahp em approach is employed to determine the weights of risk factors the outcomes from the proposed framework could help to support decision making in risk management of subsea pipelines a case study on safety analysis of subsea pipelines in chengdao oil field of china is conducted to demonstrate the practicability of the proposed methodology the initial states of basic risk factors are determined based on expert judgments then the risk values of evaluation indexes at each level are obtained from the fuzzy reasoning algorithm the causality and relationships between risk factors are analyzed through dematel analysis which helps to quantify the effect and affected degree prominence and relation of each risk factor a causal diagram and a network relationship map are drawn based on the results of dematel analysis the coupling analysis indicates that the combined action of two factors has an obvious promotion on the failure risk of pipeline which could be the primary events that should be prevented in risk management of subsea pipelines the safety evaluation results on the risk grades of the indexes at all levels and the integrated system could not only support the safety related decision making but also provide valuable information for the management of various risk factors the present study is unique in 1 providing an integrated framework for comprehensive safety analysis of subsea pipelines which integrates risk identification interrelationship and coupling analysis and risk grade evaluation 2 underlying interdependency and interaction between risk factors are revealed 3 the way how these factors cause promote and affect the risk of subsea pipelines is investigated the proposed framework is suitable to execute a deep safety analysis and evaluation of subsea pipelines besides this methodology can also be used for safety analysis of other offshore facilities or operations with adjustment of the specific aspects for evaluation future work is planned to extend the proposed methodology for life cycle risk analysis and evaluation of subsea pipelines in addition more attempts will be made to include the dynamic elements in the model and develop it into a probabilistic approach acknowledgement the authors gratefully acknowledge the financial support provided by the national key r d program of china no 2016yfc0802305 furthermore the thanks are also given to anonymous reviewers for their valuable comments to improve the paper 
22764,a three cylinder system with an equilateral triangular configuration represents one of the most common basic units of multi cylinder systems in many engineering fields in this paper an experimental investigation of the flow induced vibration fiv of a three cylinder system in an equilateral triangular arrangement was conducted in a towing tank to study their response characteristics three identical flexible cylinder models with a centre to centre distance of 6 0 times the cylinder diameter were towed along the tank to generate a uniform flow the reynolds number ranged from approximately 1600 to 16000 depending on the towing velocity which was in the range of 0 10 1 00 m s the time varying bending strains of the flexible cylinders in the cross flow cf and in line il directions were measured using strain gauges at different measurement positions the displacement responses were reconstructed by a modal analysis method based on the acquired strain signals the experimental results e g displacement amplitudes response frequencies dominant modes and motion trajectories of the flexible cylinders were presented to reveal the fiv response features three typical cases of the equilateral triangular configuration a b and c corresponding to flow incidence angles of 0 30 and 60 were selected and discussed the incidence angle is the angle between the flow direction and the line joining the centre of one cylinder to the centre of the equilateral triangular configuration in cases a and b the upstream cylinder is insignificantly affected by the downstream cylinders and behaves like an isolated flexible cylinder meanwhile the upstream cylinders in case c vibrate similarly to two side by side flexible cylinders with weak mutual interference striking departures exist in the il oscillations of the downstream cylinders due to the notable effects of the upstream cylinders the phenomenon of mixed modes appears in the il vibrations of the downstream cylinders furthermore the il response spectra always contain a robust lower frequency component equal to the dominant frequency in the cf direction moreover eight half moon and c shaped vibration figures are comparatively uncommon for the downstream cylinders graphical abstract image 1 keywords flow induced vibration equilateral triangular configuration flexible cylinder side by side tandem 1 introduction in many cases of engineering practice multiple cylinders form the basic components of machinery and structures such as offshore platforms marine risers cooling towers heat exchangers and conduction cables flow induced vibrations fiv of multiple cylinders may cause serious fatigue damage to such structures and reduce their service life consequently fiv constitutes a major concern in numerous engineering fields over the past several decades a great deal of research has been conducted on the wake interactions mutual interference dynamic responses and hydrodynamic features of multiple cylinder systems zdravkovich 1988 sumner 2010 lam and zou 2009 wang et al 2013 yan et al 2016 han et al 2018 xu et al 2018c 2018d wang et al 2019 to simplify the subject of multiple cylinders undergoing fiv two cylinders can be regarded as the basic cell of a multiple cylinder system accordingly the fiv of two cylinders has drawn increased attention during recent years there are three types of arrangements for the two cylinder system namely a side by side arrangement relative to the approaching flow direction a tandem arrangement consisting of one cylinder behind the other and a staggered arrangement zdravkovich 1985 a complete understanding of the wake interference within the flow around two fixed rigid cylinders can provide a theoretical basis for further investigations into fiv the flow regime behind two side by side stationary cylinders can be classified into three categories according to the spacing ratio s d where s is the centre to centre separation distance and d is the cylinder diameter at small spacing ratios s d 1 1 1 2 the two cylinders behave as a single bluff body and thus only one vortex street occurs bearman and wadcock 1973 as the spacing ratio increases 1 1 1 2 s d 2 2 2 7 a bi stable biased gap flow emerges forming a narrow wake behind one cylinder and a wide wake behind the other alam et al 2003 for larger spacing ratios s d 2 2 2 7 two in phase or out of phase coupled vortex streets appear williamson 1985 the flow regime around two tandem cylinders is also sensitive to the spacing ratio and can be subdivided into three basic types i an extended body regime at small spacing ratios 1 s d 1 2 1 8 ii a reattachment regime at intermediate spacing ratios 1 2 1 8 s d 3 4 3 8 and iii a co shedding regime at large spacing ratios s d 3 4 3 8 sumner 2010 zdravkovich 1987 of the three arrangements of the two cylinder system the staggered configuration is universally employed in engineering applications however the wake flow behaviours of two staggered cylinders depend upon not only the spacing ratio s d but also the flow arrival angle γ which is defined as the angle between the flow direction and the connecting line of the two cylindrical centres and thus these behaviours are more complicated than those of the other two configurations two cylinders in a staggered arrangement can be subjected to nine flow patterns that can be grouped into three broad categories namely single bluff body flow regimes small incidence angle flow regimes and large incidence angle flow regimes sumner 2010 sumner et al 2000 due to the oscillations of the structures the flow behaviours and fluid dynamics of two cylinders subjected to fiv are much more complex than those of two fixed rigid cylinders kim and alam 2015 experimentally examined the fiv characteristics of two side by side elastically supported cylinders with s d 0 1 3 2 and reynolds numbers re ranging from 4365 to 74200 they found that the wake flow between two oscillatory cylinders was significantly different from that of two fixed cylinders four flow patterns varying with s d were recognized in their tests chen et al 2015 numerically investigated the responses and wake patterns of two side by side elastically mounted cylinders undergoing fiv with s d 2 0 5 0 at re 100 six wake patterns were observed with various s d and reduced velocities they also found that the lock in region of the two cylinders mildly shifted towards the end with a smaller reduced velocity than observed for an isolated elastically mounted cylinder kim et al 2009 conducted a model test on two elastically supported cylinders restricted to vibrate in cross flow cf direction in a tandem arrangement with s d 1 1 4 2 the results indicated that the downstream cylinder had a slight influence on the vibration of the upstream cylinder while the interference effect of the upstream cylinder on the downstream cylinder was very strong prasanth and mittal 2009 numerically studied the fivs of two tandem elastically supported cylinders that were free to oscillate in both the cf and the in line il directions with s d 5 5 at re 100 the downstream cylinder experienced large displacements in both the cf and the il directions while the upstream cylinder underwent synchronization at a smaller reduced velocity due to the presence of the downstream cylinder huang and herfjord 2013 experimentally explored the fiv of two staggered elastically supported cylinders allowed to oscillate in the cf and il directions and found that the motion trajectory of the downstream cylinder obviously differed from that of the upstream cylinder alam and kim 2009 conducted a free vibration test on two staggered elastically supported cylinders oscillating in the cf direction with s d 1 1 3 2 and γ 5 60 seven response patterns were observed depending on s d and γ both the upstream and downstream cylinders might experience either vortex excited vibrations or galloping vibrations many cylindrical structures including marine risers and transmission lines which can be modelled as flexible cylinders have a large aspect ratio l d where l is the cylinder length the fiv characteristics of two long flexible cylinders are more complex than those of two elastically supported rigid cylinders zhou et al 2001 experimentally studied the fiv of two side by side flexible cylinders with s d 1 13 3 0 in contrast to the results obtained for two elastically supported rigid cylinders the first second and third mode resonances of the two flexible cylinders were observed in the case of s d 3 0 their findings demonstrated that structural flexibility plays a crucial role in structural instability and should not be ignored huera huarte and gharib 2011a experimentally investigated the effects of s d on the fiv of two side by side flexible cylinders with l d 93 75 following which they declared that the synchronized motion of the two cylinders was not observable at s d 3 5 xu et al 2018a experimentally examined the fiv of two side by side flexible cylinders with a large aspect ratio l d 350 they noted that proximity interference between the two cylinders existed until s d 6 0 while the oscillations of the two cylinders in the il direction interfered with each other even when s d was increased to 8 0 huera huarte and bearman 2011 explored the free vibrations of two tandem flexible cylinders at five different spacing ratios s d 2 0 2 5 3 0 3 5 and 4 0 they observed that the upstream cylinder experienced classical vortex induced vibrations viv however the downstream cylinder exhibited either viv or wake induced vibrations wiv which accounted for the prominent observed amplitudes at higher reduced velocities huera huarte and gharib 2011b further studied the fiv features of two tandem flexible cylinders with much larger spacing ratios s d 4 5 8 0 they found that the upstream cylinder behaved like an isolated cylinder with an increase in the spacing ratio however the downstream cylinder experienced classical viv at reduced velocities in the expected lock in region and exhibited wiv at reduced velocities beyond the expected lock in region xu et al 2018b experimentally investigated the multi mode fiv response of two tandem flexible cylinders in a towing tank they found that the responses and dominant frequencies of the upstream cylinder were insignificantly affected by the downstream cylinder which did not display large amplitudes similarly sherbrooke and laneville 1999 experimentally studied the flow interactions between a stationary cylinder and a downstream flexible cylinder in a staggered configuration and discovered that the response of the downstream cylinder is analogous to that of an isolated cylinder as γ exceeds a critical value prastianto et al 2008 examined the response characteristics of two staggered flexible cylinders by towing the cylinders in still water they demonstrated that the impacts of the mutual interference between the oscillations in the cf and il directions gradually weakened as the transverse spacing between the cylinders increased in addition the trajectory patterns of the two cylinders resembled that of an isolated cylinder at a large transverse spacing although the two cylinder system can be regarded as the basic unit of a multi cylinder system the flow interference between two cylinders cannot represent that for all multi cylinder system situations the equilateral triangular arrangement of three cylinders is also one of the most common configurations in many engineering fields the presence of the third cylinder notably distinguishes the mutual interference among the three cylinders from the situation with only two cylinders therefore the flow interference around three cylinders in an equilateral triangular configuration has been discussed by several investigators sayers 1987 1990 kareem et al 1998 tatsuno et al 1998 gu and sun 2001 pouryoussefi et al 2011 tatsuno et al 1998 experimentally investigated the effects of flow interference among three identical rigid fixed cylinders in a regular triangular arrangement and concluded that the mutual interference among the three cylinders was severe when the spacing ratio was small and vice versa gu and sun 2001 examined the flow patterns of three equally spaced stationary cylinders in an equilateral triangular arrangement with s d 1 7 5 0 via wind tunnel tests they observed three flow patterns namely a proximity effect a shear layer reattachment effect and a wake effect attributable to the various incidence angles at small values of s d pouryoussefi et al 2011 conducted wind tunnel tests on three rigid fixed cylinders in an equilateral triangular configuration at five subcritical re values in the range of 12600 60800 with incidence angle β 0 β is the angle between the flow direction and the line joining the centre of one cylinder to the centre of the equilateral triangular configuration as shown in fig 1 the strouhal number st for the upstream cylinder increased with the decreasing spacing ratio between the cylinders they concluded that the influence of the flow interference could be weakened by enlarging the spacing ratio furthermore the flow behaviour of the upstream cylinder was nearly identical to that of an isolated cylinder bansal and yarusevych 2017 experimentally investigated the flow through a cluster of three equally spaced rigid fixed cylinders with a small spacing ratio s d 1 35 at re 2100 they discovered that the value of st which was scaled by the projected height of the three cylinders was approximately identical to that of an isolated cylinder with an equivalent diameter since two side by side cylinders were situated upstream of the third cylinder the near wakes i e consisting of two narrow wakes and one wide wake were symmetric zheng et al 2016 numerically investigated the flow behaviours of three equally spaced stationary cylinders with s d 1 5 7 0 at re 100 and 200 two cases were considered i e two side by side cylinders were positioned upstream or downstream of the third cylinder they concluded that the flow interference among the cylinders depended upon not only s d but also re and showed that re has a significant impact on the critical spacing ratio where the biased flow pattern of the side by side downstream cylinders disappears however little research has been performed on the fiv of three elastically supported cylinders in an equilateral triangular arrangement ou et al 2009 and xu et al 2014 numerically investigated the fiv of three elastically supported rigid cylinders with two incidence angles β 0 and 60 in an equilateral triangular arrangement and determined that the motion trajectories of the downstream cylinder or cylinders may exhibit oblique oval orbits indicating that the il frequency of oscillation is equal to that of the cf furthermore the response amplitudes of the downstream cylinder or cylinders were enlarged due to the vibration of the upstream cylinders or cylinder wang et al 2013 numerically studied the fiv of three equally spaced elastically supported rigid cylinders with s d 4 0 at re 150 in consideration of typical flow incidence angles β 0 30 and 60 they discovered that the vortex shedding frequencies the response amplitudes and the oscillation trajectories markedly rely upon the incidence angle and the reduced velocity at β 0 both downstream side by side cylinders had the same response frequency in the cf and il directions at β 30 the motion trajectories of the cylinders were inclined figure eight patterns due to the asymmetric flow finally at β 60 the downstream cylinder exhibited irregular vibrations due to complicated wake interference from the two upstream side by side cylinders the fiv of one or two flexible cylinders has been investigated in recent years however to the best of the authors knowledge few studies on the fiv of three long flexible cylinders in an equilateral triangular configuration have been reported the fiv characteristics of flexible cylinders with large aspect ratio are significantly distinct from those of elastically mounted rigid cylinders with regard to many aspects including harmonic phenomena multi mode responses and mixing response features of travelling waves and standing waves larsen et al 1996 chaplin et al 2005 vandiver et al 2009 wu et al 2016 pavlovskaia et al 2016 the fiv of three equally spaced flexible cylinders are still not understood and thus warrant further investigation the main purpose of this paper is to experimentally study the dynamic response of three equally spaced long flexible cylinders with l d 350 subjected to fiv in a towing tank the spacing ratio was fixed at 6 0 at which the mutual interference of the flexible cylinders is still significant huera huarte and gharib 2011b xu et al 2018a 2018b three typical cases of incidence angles β 0 30 and 60 were explored with re ranging from 1600 to 16000 the dynamic response features of the three flexible cylinders were discussed by analysing their displacement amplitudes response frequencies dominant modes and motion trajectories the remainder of this paper is organized as follows section 2 provides information regarding the experimental details section 3 introduces a method for reconstructing the displacement responses of the flexible cylinders section 4 presents and discusses the experimental results for the three incidence angle cases including the displacement amplitudes response frequencies dominant modes and motion trajectories finally some concluding remarks are given in section 5 2 experimental details the three cylinders used in the experiment were labelled cylinder 1 cylinder 2 and cylinder 3 as shown in fig 1 three typical cases a b and c were considered depending on varying values of β i e the angle between the flow direction and the line joining the centre of cylinder 1 to the centre of the equilateral triangular configuration in case a with β 0 two side by side cylinders cylinders 2 and 3 were located downstream of the upstream cylinder cylinder 1 cylinder 1 was located upstream of cylinders 2 and 3 in case b with β 30 two side by side cylinders cylinders 1 and 2 were upstream of cylinder 3 in case c with β 60 the spacing ratio was chosen as s d 6 0 referring to previous experimental studies on the fiv of two flexible cylinders in side by side sanaati and kato 2014 xu et al 2018a 2018b and tandem arrangements xu et al 2018b zdravkovich 1987 for the two side by side flexible cylinders the mutual interference of two cylinders is still notable even when the spacing ratio reaches 6 0 xu et al 2018a and the motions of the two cylinders are strongly synchronized at s d 5 5 sanaati and kato 2014 for the two tandem flexible cylinders the spacing ratio s d 6 0 put the tandem configuration in a wake interference region as predicted by zdravkovich 1987 it can be inferred that the oscillations of three equally spaced flexible cylinders will exhibit mutual interference at s d 6 0 in our tests fig 2 shows the experimental setup which mainly had one supporting structure four vertical supporting rods two supporting plates and guide plates three cylinder models and pretension adjustment and measurement systems the guide plate was mounted on the supporting plate by several long bolts to avoid the disturbed flow caused by the supporting plates and supporting rods and ensure the incoming flow is two dimensional three flexible cylinders were simply mounted at the two guide dials which were fixed on the supporting plate dials one end of each flexible cylinder was connected to a universal joint mounted on the supporting dials installed on the supporting plate a steel wire that was passed through a pulley and successively connected to a spring tensioner and load cell was connected to the other end of each cylinder the tensioner was used to adjust the axial tension of the flexible cylinder while the spring ensured gradual variation in the axial tension and the load cell was adopted to monitor the variations in the axial tension a low axial tension would lead to large il deflections due to the mean drag whereas a high axial tension could improve the stiffness thereby enlarging the towing velocity needed to excite higher modes of vibration hence the initial axial tension was set at 450 n for all tests the apparatus used in the experiment is analogous to the experimental system for the fiv of two tandem cylinders xu et al 2018b and two side by side cylinders xu et al 2018a there are also several slight differences e g four strong vertical supporting rods were connected to the supporting structure to withstand the much larger loads of the three cylinder model compared with those of the two cylinder experimental system xu et al 2018a 2018b which only had two vertical supporting rods moreover two guide dials and two supporting plate dials in the system of the supporting and guide plates were designed to realize the different cases case a case b and case c of the three equally spaced cylinders as shown in figs 3 and 4 the flexible cylinder model with a diameter of 16 mm and a length of 5 60 m consisted of an internal copper pipe and an outer silicone tube the outer silicone tube covered the internal copper pipe and the measuring equipment to provide a smooth external surface for the flexible cylinder the copper pipe and the silicone tube were closely attached to each other and their movements were exactly the same the same flexible cylinder model has been used in our previous experiments to investigate the dynamic characteristics of an isolated inclined flexible cylinder undergoing viv han et al 2017 and the effect of spacing on fiv of two flexible cylinders in side by side and tandem arrangements xu et al 2018a 2018b the mass per unit length of the cylinder was 0 3821 kg m the mass ratio m of the cylinder which is defined as the structural mass divided by the mass of displaced fluid was 1 90 the main parameters of the flexible cylinder are shown in table 1 there were seven measurement points g1 g7 on the internal copper pipe at equal intervals each measurement point comprised four strain gauges to monitor the bending strains in the cf and the il directions the experimental apparatus see fig 2 was installed under a carriage and towed in a towing tank 7 0 m wide 3 3 m deep and 137 0 m long belonging to the state key laboratory of hydraulic engineering simulation and safety at tianjin university the flexible cylinders were submerged at depths of at least 1 0 m into the water to avoid free surface effects a uniform flow was generated when the carriage moved at a constant speed the towing velocity ranged from 0 10 m s to 1 00 m s with an interval of 0 05 m s corresponding to re 1600 16000 to prevent aliasing problems the sampling time was 50 s after the carriage reached a stable towing velocity and the sampling frequency was 100 hz the waiting time between two consecutive runs was 15 min for the purpose of calming the disturbed water more than 70 runs were conducted across all experimental cases decay tests were conducted in air and still water before carrying out the experimental cases the cf first seven order natural frequencies in water of the three cylinders and the isolated cylinder were identified from the decay tests as shown in table 2 the il natural frequencies were close to those in cf direction and not presented here the theoretical values of the natural frequencies in water were calculated from eq 1 for comparison 1 f n n 2 l t z m s m a n π l 2 e i m s m a where f n is the nth order natural frequency in water and m a ρπd 2 4 is the added mass per unit table 2 shows that the natural frequencies of the three cylinders and the isolated cylinder are all generally identical to the theoretical values within the error allowed range which indicates the experimental apparatus is reliable and the strain gages can give accurate measurements of the strain results during the oscillation of the flexible cylinder models 3 data analysis during the experimental tests the bending strain signals of the flexible cylinders in the cf and il directions were directly obtained by strain gauges at seven measurement points g1 g7 however the cf and il strain signals required pre processing before further use the data processing was the same as that used by xu et al 2018a the additional initial bending strain which is independent of time was eliminated a band pass filter with a bandwidth of 1 0 40 0 hz was also applied to the bending strains to remove the inevitable low and high frequency noise signals the displacement of the flexible cylinder is reconstructed using a modal analysis method according to the measured strain signals as proposed by lie and kaasen 2006 this method has been proven capable of reconstructing the displacements of flexible cylinders subjected to viv in a uniform flow song et al 2011 herein the reconstruction of the cf displacement is taken as an example the cf displacement y z t can be written in the form of modal superposition 2 y z t n 1 w n t φ n z z 0 l where z is the coordinate along the axis of the cylinder t denotes the time w n t represents the modal weight φ n z represents the mode shape and n denotes the number of the mode order the mode shape can be assumed to be sinusoidal or approximated with sinusoids for a simply supported cylinder as follows 3 φ n z sin n π z l the relationship between the strain ε z t and displacement y z t is expressed as follows 4 ε z t r 2 y z t z 2 n 1 n n π l 2 w n t sin n π z l where r is the radius of the copper pipe the modal weight w n t can be calculated according to eq 4 substituting the modal weights w n t into eq 2 the cf displacement was obtained the research presented by lie and kaasen 2006 gives more details about the modal analysis approach the reconstruction of the il displacements is similar to that of the cf displacements and not introduced in this paper for the sake of simplicity 4 results and discussion the displacement amplitudes response frequencies dominant modes and trajectory motions of the three flexible cylinders undergoing fiv in an equilateral triangular configuration are presented and discussed for the three typical cases a b and c in this section the reduced velocity v r is defined as 5 v r u f 1 d where f 1 is the first order natural frequency of the flexible cylinder in water the first order natural frequencies of the three cylinders in our free decay tests were not completely identical to each other hence f 1 was the theoretical value to avoid slight differences 4 1 fiv responses of the three flexible cylinders in case a the flexible cylinders have multi order natural frequencies and the high order modes can be excited when the structures undergoing fiv tables 3 and 4 list the cf and il dominant vibration modes of the three flexible cylinders in case a the results for an isolated cylinder are also displayed in these tables for comparison in the current study the dominant mode is defined as the mode with the largest modal weight from eq 2 to illustrate them more clearly different dominant modes are marked with various background colours from low to high orders the first second and third order mode resonances in the cf direction are found for the three cylinders and the isolated cylinder the dominant modes are transformed from low to high orders at v r 10 02 and 20 04 unlike the three cylinder group fourth order mode vibration is identified for the isolated cylinder as the reduced velocity is 25 05 it seems that the dominant modes of the cf vibrations show little discrepancies between the three equilateral triangular cylinders and the isolated one however the il dominant vibration modes of the flexible cylinders exhibit significant differences judging from the background colours in table 4 at first sight the maximum dominant vibration mode in the il direction of the isolated cylinder reaches the sixth order at v r 25 05 the result of cylinder 1 agrees well with that of the isolated cylinder though the il dominate mode of cylinder 1 is just up to the fifth order only little deviations are found between cylinder 1 and the isolated cylinder when the dominant mode switches such as v r 10 02 and 15 03 in this paper the reduced velocity areas where dominant modes switch are defined as the mode switch regions serious mode competition appears when the dominant mode switches chaplin et al 2005 which results in the differences between the il dominant vibration modes of cylinder 1 and the isolated cylinder for the two downstream side by side cylinders the il dominant modes are significantly different from those of the isolated cylinder at v r 15 03 at such reduced velocities it is challenging to judge the dominant mode because the two different modes have almost equal modal weights the second and fourth order modes dominate the il vibration together at v r 15 03 18 79 while the third and the fifth order modes take over the vibrations at v r 20 04 25 05 to give more insight into the multiple dominant modes the il modal weights of cylinder 1 and 2 at v r 21 29 are presented in fig 5 for cylinder 1 the modal weights of fifth order mode are the highest which indicates that the fifth order mode dominates the vibrations however for cylinder 2 the modal weights of both the third order mode and the fifth order mode are predominant the third order mode and the fifth order mode share the domination of the vibrations as noted by xu et al 2018a the dominant vibration modes of two side by side flexible cylinders with s d 6 0 agreed well with those of the isolated cylinder outside of the mode switch zone which confirms that the dissimilar il dominant modes of the downstream cylinders are mainly attributable to the wake effect of the upstream cylinder instead of the interference between the two downstream side by side cylinders fig 6 shows the maximum dimensionless root mean square rms values of the cf and il displacement amplitudes y rms d and x rms d respectively of the three cylinders the results for an isolated flexible cylinder are also drawn to facilitate a convenient comparison utilizing the modal analysis method the cf displacement y z t can be obtained according to the strain information at the seven measurement points g1 g7 the rms values of the cf displacement at every axial position z i can be calculated by the following formula 6 y r m s z i 1 s j 1 s y z i t j where s is the sampling number the max y rms d is the maximum dimensionless rms value of the cf displacement among all the axial position z i namely max y rms z i d the max dimensionless rms value of the il displacement x rms d is obtained in a similar way the maximum y rms d values of the three cylinders are plotted in the first column of fig 6 the first second and third order modes are excited in the cf vibration of cylinder 1 according to table 3 for the first order mode resonance the maximum y rms d peaks at v r 7 52 and then decreases until the vibration enters the second order mode the maximum y rms d reaches the highest point at v r 12 52 in the second order mode synchronized region and falls swiftly there is an upward trend when the vibration is in the third order mode resonance v r 18 79 cylinder 1 shares the analogous trend of y rms d with the isolated cylinder indicating that cylinder 1 is insignificantly affected by the two downstream cylinders except for several slight differences at individual reduced velocities e g the maximum y rms d of cylinder 1 surpasses that of the isolated cylinder at v r 25 05 in addition the maximum rms of the cf displacements of cylinders 2 and 3 also peak at the first second and third order mode resonances while the variation trend shows considerable differences from that of the isolated cylinder for example the maximum y rms d of cylinder 2 is slightly smaller than that of the isolated cylinder at the second order mode resonance cylinder 3 shows higher values of the maximum y rms d than the isolated cylinder at the first and third order mode resonance but it is the opposite at the second order mode resonance these differences could be due to two reasons 1 the two flexible cylinders are positioned side by side leading to mutual interference xu et al 2018a 2 the existing of the upstream cylinder has some effects on the cf oscillations of the two downstream side by side cylinders the maximum y rms d values for the two side by side cylinders in xu et al 2018a exhibit notable discrepancy from each other due to the motion interference however the difference in the maximum y rms d values between cylinders 2 and 3 is reduced compared to that of the two side by side cylinders meanwhile the maximum rms values of the cf displacements of cylinders 2 and 3 are much closer to that of the isolated cylinder than those of the side by side cylinders in xu et al 2018a hence it can be concluded that the upstream cylinder slightly suppresses the mutual interference between the downstream side by side cylinders as shown in the second column of fig 6 the maximum x rms d of cylinder 1 agrees with that of the isolated cylinder at most reduced velocities indicating that the two downstream cylinders demonstrate limited influences on the il vibrations of cylinder 1 some previous investigations into the flow regime around three equilateral triangular cylinders at β 0 have proven that the flow behaviours of the upstream cylinder are coincident with those of an isolated cylinder at a large s d gu and sun 2001 pouryoussefi et al 2011 this is the reason why cylinder 1 shares a matching trend of displacement amplitudes with the isolated cylinder however the il displacement of the two downstream cylinders shows different features cylinder 2 has larger maximum x rms d values than cylinder 3 at v r 3 76 7 52 and v r 20 04 25 05 while the x rms d values of the two cylinders are similar to each other at v r 10 02 18 79 despite some differences in the x rms d of cylinders 2 and 3 the x rms d of the isolated cylinder is significantly smaller than that of the two cylinders the extreme values of x rms d of cylinders 2 and 3 are 62 and 45 greater than that of the isolated cylinder respectively although the il responses of the two side by side flexible cylinders are affected by the wake interaction between the two cylinders the oscillation amplitudes do not reach such a high level xu et al 2018a this confirms that the immense amplification of the il displacement is mainly associated with the behaviour of the upstream cylinder for the three elastically supported rigid cylinders in an equilateral triangular configuration at β 0 wang et al 2013 the il amplitudes of the two downstream cylinders were more prominent than that of the isolated cylinder at the fundamental mode resonance except for the fundamental mode high order modes can also be excited when the flexible cylinder undergoing fiv the downstream side by side cylinders of three equilateral triangular flexible cylinders still experience tremendous vibration in il direction at the high order mode resonance fig 7 shows the displacement response spectra of the three cylinders at the middle measurement point g4 in case a which was produced by the fft analysis of the displacement data the blue dashed lines in the first and second columns of the figure represent one and two times the vortex shedding frequency of a stationary rigid cylinder the il and cf dominant frequencies f dominant il f dominant cf which are taken as the largest peak in the spectra plots of cylinder 1 which exhibit a double relationship with each other almost linearly increase with an increase in flow velocity this behaviour is consistent with that of an isolated cylinder except for the dominant response frequency a few frequency components with smaller peaks are observed at some velocities due to the multi mode vibrations of the flexible cylinder and the inconspicuous effect of the downstream cylinders the dominant frequencies of cylinders 2 and 3 in the cf direction also show an approximate linear growth with increasing flow velocity though the frequency spectrum is moderately wider than that of cylinder 1 at several flow velocities there are two robust frequencies in the il response spectra at many different flow velocities for both cylinders 2 and 3 for convenient description the robust frequency near the double vortex shedding frequency of a stationary rigid cylinder can be denoted as f v il the other outstanding frequency almost half of the f v il is denoted as f v il 1 2 interestingly the f v il 1 2 is close to the cf dominant frequency f dominant cf at the same flow velocity evidently the f v il 1 2 is the dominant frequency in the il direction for the two cylinders except when u 0 40 0 50 m s to illustrate this phenomenon clearly the f v il and f v il 1 2 of the two cylinders at u 0 90 m s v r 22 55 are compared in detail the f v il of cylinder 2 is equal to 17 3 hz and has an amplitude value of 0 21 while the f v il 1 2 of cylinder 2 is 8 7 hz with an amplitude value of 0 33 for cylinder 3 the f v il and f v il 1 2 corresponding to the amplitude values of 0 18 and 0 34 are equal to 16 8 hz and 8 40 hz respectively xu et al 2018a showed that the il dominant frequencies of the two side by side flexible cylinders with s d 6 0 were slightly smaller than the double vortex shedding frequency of a fixed cylinder and were generally close to that of an isolated flexible cylinder it can be concluded that the robust f v il 1 2 in il vibrations of cylinders 2 and 3 are mainly associated with the wake interference of the upstream cylinder instead of the mutual interaction caused by the side by side configuration meanwhile it seems that the preponderant f v il 1 2 is strongly related to the outstanding il response amplitudes of cylinders 2 and 3 it should be noted that the measurement point g4 is near the node when the even order mode dominates the vibrations to check the displacement spectra at g4 when the dominant mode is even order and compare the displacement spectra among the measurement points fig 8 shows the cf and il displacement response spectra of cylinder 2 at the measurement points g1 g7 and v r 16 28 according to tables 3 and 4 the cf and il dominant mode of cylinder 2 at v r 16 28 are the second order and the fourth order respectively the amplitudes at g4 are much lower than those at other measurement points due to the fact that g4 is near the node however the frequency characteristics of the displacement spectra at different measurement points show insignificant deviations except for small differences between high order frequencies as well known high order mode vibrations can be excited for the flexible cylinders which is a typical feature that rigid cylinders do not possess the fiv response characteristics of high order mode oscillations of three equilateral triangular flexible cylinders are worthy of further investigation according to table 3 the vibrations of the isolated flexible cylinder are at the third order mode resonance at v r 21 29 hence the response results of the three cylinders and the isolated cylinder at v r 21 29 are presented and discussed in detail fig 9 shows the space time varying non dimensional displacement contours spanwise evolutions of the rms displacements non dimensional displacement responses at seven measurement positions and motion trajectories at seven measurement positions along the three cylinders in case a as presented in fig 9 a the fiv responses of cylinder 1 in the cf and il directions are both standing waves the cf and il dominant vibration modes of cylinder 1 are third and fifth order modes respectively the spanwise evolutions of the rms displacements are asymmetric which can be attributed to the multi mode response of flexible cylinders subjected to fiv song et al 2011 the time varying il displacements exhibit notable harmonic components which is consistent with the displacement response spectra shown in fig 7 at g4 and g7 the motion trajectories are distorted eight shaped figures however the motion trajectories are half moon or c shaped figures at g1 g2 g3 and g6 these motion trajectory shapes were observed during research on the fiv of a single flexible cylinder by vandiver et al 2009 the eight half moon and c shaped figures indicate that the ratio of the il to cf dominant frequency is approximately equal to 2 0 however due to the phase angle between the il and cf response amplitudes the motion trajectories exhibit distinct eight or c shaped figures thus the fiv response characteristics of the upstream cylinder cylinder 1 agree with those of an isolated cylinder proving that the downstream cylinders insignificantly affect the upstream cylinder in case a the results for the two downstream side by side cylinders at v r 21 29 are presented in fig 9 b and c the cf response of cylinder 3 remains a standing wave while that of cylinder 2 is a mixture of standing and travelling waves both cylinders 2 and 3 exhibit a travelling wave behaviour in the il direction the spanwise evolutions of the rms displacements reveal that the cf dominant modes of the two cylinders are both third order modes these findings are the same as those for both the upstream cylinder and the isolated cylinder however the spanwise evolutions of the rms displacements in the il direction exhibit remarkably different features the il dominant mode of cylinder 2 is a mixture of third and fifth order modes in accordance with the results in table 4 judging from the spanwise evolutions of the rms il displacements cylinder 3 experiences an il vibration dominated by a third order mode the motion trajectories of cylinders 2 and 3 are significantly distinct from those of both the upstream cylinder and the isolated cylinder due to the mixture of third and fifth order dominant modes the ratio of the il to cf frequency of cylinder 2 is 2 0 at some measurement points i e g4 and g7 hence the motion trajectories at g4 and g7 are similar to eight shaped figures however no obvious eight half moon or c shaped figures are observed for cylinder 3 except for g4 at which the motion trajectory resembles an asymmetric eight shaped figure this phenomenon is mainly because the il vibration of cylinder 3 contains two robust frequency components as shown in fig 7 tear or lip shaped figures are observed for cylinder 3 at most measurement points indicating that the ratio of the il to cf dominant frequency is equal to 1 0 xu et al 2018a verified that the motion trajectories of two side by side flexible cylinders with s d 6 0 might be distinct eight half moon or c shaped figures consequently the distinct motion trajectories of cylinder 2 and 3 result from the presence of the upstream cylinder however there are also discrepancies between the motion trajectories of cylinder 2 and cylinder 3 which indicates that the mutual interactions still exist in the two downstream side by side cylinders 4 2 fiv responses of the three flexible cylinders in case b tables 5 and 6 list the dominant vibration modes in the cf and il directions for the three flexible cylinders respectively the cf dominant modes of cylinder 1 agree well with those of the isolated cylinder except for some individual reduced velocities v r 3 76 8 77 and 25 05 some distinction in cf dominant modes of cylinder 2 and the isolated cylinder is observed in the modal switch regions higher order mode vibration is excited more easily for cylinder 2 for example the cf oscillation of cylinder 2 enters the second third and fourth order modes at lower reduced velocities than the isolated cylinder a similar phenomenon was observed in xu et al 2018a for two side by side flexible cylinders the cf dominant modes of cylinder 3 and the isolated cylinder can be compared very satisfactorily at v r 18 79 however cylinder 3 undergoing fiv experiences a third order mode in the cf direction until v r 22 55 which is much later than the other two cylinders in case b xu et al 2018b elucidated that the downstream cylinder in a tandem arrangement experiences much lower dominant modes in the cf direction due to the shielding effect of the upstream cylinder hence the distinct features of cf dominant modes of cylinder 3 are attributed to the shielding effect of cylinder 1 table 6 demonstrates that up to a fifth order mode in the il direction is excited for cylinder 1 the dominant modes of cylinder 1 in the cf and il directions are in fair agreement with the results of the upstream cylinder in the two cylinder tandem system provided by xu et al 2018b hence it is convictive to ascribe the slight difference in the il dominant modes between cylinder 1 and the isolated cylinder to the presence of cylinder 3 similar to cylinders 2 and 3 in case a a mixture of two modes can be observed for the il oscillation of cylinder 2 in case b when v r 13 78 the mixture mode phenomenon is closely related to the wake effect of cylinder 1 remarkable discrepancies appear in the il dominant mode of cylinder 3 as the same as the cf dominant modes the il dominant modes of cylinder 3 are much lower than the other two cylinders and the isolated one for two tandem flexible cylinder the sixth order mode vibrations of the downstream cylinder can be exited in the il direction xu et al 2018b it seems that the presence of cylinder 2 rather than cylinder 1 suppresses the il vibration modes of cylinder 3 fig 10 shows the maximum dimensionless rms values of the cf and il displacement amplitudes of the three cylinders in case b clearly the data for the upstream cylinder cylinder 1 agrees well with those of the isolated cylinder indicating that cylinders 2 and 3 have limited influence on cylinder 1 cylinders 1 and 3 are positioned in a tandem configuration in case b and some research also proved that the upstream cylinder of two tandem flexible cylinders will behave similarly to an isolated cylinder at s d 6 0 huera huarte and gharib 2011b xu et al 2018b it seems that the wake of cylinder 1 generates some effects on the cf vibrations of cylinder 2 the displacement amplitudes of cylinder 2 and the isolated cylinder in the cf direction are almost coincident at the first order mode resonance however some discrepancies can be observed in the second and third order mode resonance regions the maximum y rms d of cylinder 3 fluctuates around that of the isolated cylinder which results from the wake effect of cylinder 1 and 2 cylinder 3 has much smaller response amplitude in cf direction than the isolated cylinder at v r 2 51 7 52 and v r 12 52 18 79 while the result is opposite at v r 8 77 10 02 20 04 and 21 29 the cf oscillation amplitudes of cylinder 3 of three equilateral triangular rigid cylinders were substantially increased wang et al 2013 which is inconsistent with the present research the large amplitude vibration of cylinder 3 in wang et al 2013 was identified as wiv by huera huarte and gharib 2011b however the wiv of a downstream flexible cylinder may be avoided if the multi mode vibration of the downstream cylinder is excited huera huarte and bearman 2011 xu et al 2018b also did not observe unusually large amplitudes for the flexible cylinder downstream of two tandem flexible cylinders due to the multi mode fiv response which is consistent with the cf response amplitude of cylinder 3 in the current research as shown in fig 10 the data for cylinder 1 converge with those of the isolated cylinder in the il direction however the il displacement amplitudes of cylinder 2 considerably exceed those of the isolated cylinder the extreme value of x rms d of cylinder 2 is 64 2 larger than that of the isolated cylinder the numerical simulation on the fiv of three elastically mounted rigid cylinders in equilateral triangular arrangement with s d 4 0 and β 30 showed that the il displacements of cylinder 2 and the isolated cylinder can be compared satisfactorily which is inconsistent with our results wang et al 2013 the main reason is that the spacing ratio and incidence angle adopted in the numerical simulation made cylinder 2 enter into the no no interference regime classified by zdravkovich 1988 where cylinder 1 could not affect the oscillation of cylinder 2 while the fiv response amplitudes of flexible cylinder usually larger than those of the elastically mounted rigid cylinder which causes the mutual interference of flexible cylinders still strong at large s d xu et al 2018a hence the wake of cylinder 1 still shows a significant impact on the vibration of cylinder 2 in the current research cylinder 3 has enormous il response amplitudes at v r 7 52 comparing to the isolated cylinder the extreme x rms d values of cylinder 3 is 100 greater than that of the isolated cylinder however the il displacements of the downstream cylinder of two tandem flexible cylinders are not as large as those of cylinder 3 xu et al 2018b it can be concluded that the enlargement of il response amplitudes of cylinder 3 is closely related to the wake effect of cylinder 2 instead of cylinder 1 fig 11 shows the displacement response spectra of the three cylinders at the middle measurement point g4 in case b the dominant frequencies in the il and cf directions which demonstrate a double relationship both linearly increase with increasing flow velocity a similar trend has been observed for the isolated cylinder the cf dominant frequencies of cylinder 2 resemble those of cylinder 1 and the isolated cylinder clearly two strong frequency components f v il and f v il 1 2 participate in the il vibration at the same time consistent with the results for cylinders 2 and 3 in case a the amplitude values of f v il 1 2 are greater than those of f v il at many flow velocities which indicates that f v il 1 2 is the il dominant frequency it becomes convincing that the il response amplitudes of cylinder 2 in case b and cylinders 2 and 3 in case a are closely related to the frequency component f v il 1 2 for cylinder 3 the cf and il dominant frequencies are both seriously affected by the oscillations of cylinders 1 and 2 the middle measurement point of cylinder 3 experiences broad band spectra in the cf and il directions at most flow velocities surprisingly the frequency component f v il is considerably suppressed and the frequency component f v il 1 2 takes over the il vibration completely in fact f v il 1 2 may account for the remarkable growth of the il response amplitude of cylinder 3 fig 12 presents the space time varying non dimensional displacement contours spanwise evolutions of the rms displacements non dimensional displacement responses at seven measurement positions and motion trajectories at seven measurement positions of the three cylinders in case b at v r 21 29 a standing wave behaviour is clearly observable in the cf and il vibrations of cylinder 1 the cf and il dominant modes of cylinder 1 are third and fifth order modes this can be recognized from the spanwise evolutions of the rms displacements the motion trajectories of cylinder 1 are similar to those of the isolated cylinder and appear as distinct eight half moon or c shaped figures which is consistent with the numerical simulation on three rigid cylinders at their fundamental mode resonance wang et al 2013 the response characteristics of cylinder 2 are much more complex as presented in fig 12 b the fiv of cylinder 2 in the cf and il directions are standing and travelling wave responses respectively a mixture of third and fifth order modes are observed in the il vibration which is in accordance with the two robust frequency components shown in fig 11 notable harmonics appear in the time varying displacement in the il direction which causes cylinder 2 to move along unclosed trajectories although the il amplitude of cylinder 2 was not significantly enlarged in the findings of wang et al 2013 the motion trajectories of the rigid cylinder at the fundamental mode resonance are similar to those of cylinder 2 in our tests the deviation in the trajectory of cylinder 2 from the isolated cylinder is mainly associated with the wake interference of cylinder 1 fig 12 c shows that cylinder 3 exhibits a dynamic response distinct from cylinders 1 and 2 a combined behaviour consisting of a standing wave and a travelling wave can be observed in both the cf and il directions the dominant modes of vibration in the two directions are both second order as previously mentioned the cf dominant mode is suppressed due to the shield effect of cylinder 1 while the low il dominant mode is probably correlated with cylinder 2 for cylinder 3 conspicuous harmonics are found in the plot of time varying displacement which is consistent with the response spectra displayed in fig 11 the motion trajectories are unclear at the measurement points but a fuzzy elliptical shape can be observed at g2 g3 g5 and g6 the fuzzy elliptical shaped trajectory of cylinder 3 indicates that the ratio of the il to cf dominant frequency is equal to 1 0 4 3 fiv responses of the three flexible cylinders in case c tables 7 and 8 list the cf and il dominant modes for the three cylinders in case c for cylinders 1 and 2 the dominant modes in the cf direction are the same as that of the isolated cylinder except for v r 18 79 the maximum cf dominant mode of cylinder 3 subjected to fiv can be up to a third order mode it is lower than that of the isolated cylinder due to the presence of two upstream side by side cylinders cylinders 1 and 2 there is a relatively high level of agreement in the il dominant modes between the two upstream cylinders and the isolated one however the il vibrations of cylinders 1 and 2 enter into higher order modes earlier which is specifically reflected at v r 13 78 and 18 79 this trend was also reported in the research pertaining to two side by side flexible cylinders undergoing fiv xu et al 2018a moreover mixed modes also appear in the il vibration of cylinder 3 the second order mode and fourth order mode compete fiercely in the il vibration for v r ranging from 15 03 to 18 79 the third order mode and the fifth order mode share the leadership of the oscillation as v r exceeds 20 04 in case c the two side by side cylinders cylinders 1 and 2 are upstream of cylinder 3 fig 13 displays the maximum dimensionless rms values of the cf and il displacement amplitudes of the three cylinders for cylinders 1 and 2 the cf displacement amplitudes show some discrepancies with that of the isolated cylinder due to the mutual interference between themselves however the difference in the maximum y rms d between cylinders 1 and 2 is much smaller than that of two side by side flexible cylinders xu et al 2018a indicating that cylinder 3 may suppress the mutual interference of the upstream side by side cylinders the cf response amplitudes of cylinder 3 show a distinct feature comparing to those of the isolated cylinder cylinder 3 oscillates with a significantly increased displacement amplitude at the first order mode resonance which is consistent with the results of the downstream rigid cylinder wang et al 2013 while the y rms d of cylinder 3 is slightly larger than that of the isolated cylinder at the second and third order mode resonance it is convictive that the wake of the upstream side by side cylinders enhances the cf vibration of cylinder 3 due to the mutual interference between the two upstream cylinders the il displacements of cylinders 1 and 2 show some differences from that of the isolated cylinder however the il displacements of the upstream cylinders are much closer to those of the side by side flexible cylinders in xu et al 2018a these findings show that the mutual interaction of cylinders 1 and 2 results in the deviation of il response amplitudes between themselves and the isolated cylinder the downstream cylinder has a limited effect on the il response amplitudes of cylinder 1 and cylinder 2 the il response amplitude of cylinder 3 experiences a gradual increase and the extreme values of x rms d is 36 5 higher than that of the isolated cylinder the increased x rms d is mainly induced by the wake interference of the upstream side by side cylinders comparing the il response amplitudes of the downstream cylinders in case a and case b the application of the il vibrations of cylinder 3 in case c is much smaller fig 14 shows the displacement response spectra of the three cylinders at the middle measurement point g4 in case c because cylinder 3 is downstream of cylinders 1 and 2 it has an insignificant impact on the two upstream cylinders hence the displacement response spectra for cylinders 1 and 2 are similar to those of two side by side flexible cylinders in xu et al 2018a the dominant frequencies of the two cylinders in the il direction are twice as large as the cf dominant frequencies and they linearly grow with increasing flow velocity the broad band frequencies are observed in the cf vibration of cylinder 3 which is strongly related to the presence of cylinders 1 and 2 the il response frequency of cylinder 3 is distinctly different from those of both the isolated cylinder and the two upstream side by side cylinders there are two notable frequency components f v il and f v il 1 2 with a double relationship at most flow velocities moreover the frequency component f v il 1 2 is the dominant frequency in general which is consistent with the findings of the downstream cylinder in case a and case b fig 15 shows the space time varying non dimensional displacement contours spanwise evolutions of the rms displacements non dimensional displacement responses at seven measurement positions and motion trajectories at seven measurement positions of the three cylinders in case c at v r 21 29 as previously mentioned the downstream cylinder cylinder 3 has a limited effect on the upstream two side by side cylinders cylinders 1 and 2 hence the response features of cylinders 1 and 2 are coincident with those of two side by side flexible cylinders in xu et al 2018a the fiv of the upstream side by side cylinders is a mixture of standing waves and travelling waves in both the cf and il directions the spanwise evolutions of the rms displacements reveal that the cf and il dominant modes of cylinders 1 and 2 are third and fifth order modes respectively the motion trajectories of cylinders 1 and 2 are distinct eight half moon or c shaped figures and this finding agrees quite well with the reported trajectories of two side by side flexible cylinders by xu et al 2018a and with the upstream elastically supported rigid cylinders discussed in case c ou et al 2009 wang et al 2013 however the trajectories of cylinders 1 and 2 are slightly different from each other due to their motion interactions fig 15 c shows that the response characteristics of cylinder 3 significantly differ from those of the isolated cylinder the cf and il oscillations of cylinder 3 both behave as travelling waves at v r 21 29 the cf response is dominated by a third order mode but a mixture of third and fifth order modes appear in the il oscillation which is consistent with the results shown in fig 14 and table 7 the time varying displacements in the cf and il directions contain obvious harmonic components and account for the disordered motion trajectories 5 conclusions a series of experimental tests of three equally spaced long flexible cylinders with s d 6 0 subjected to fiv was carried out in a towing tank three typical cases a b and c were addressed with corresponding incidence angles of 0 30 and 60 the dynamic response features of the three flexible cylinders including displacement amplitudes response frequencies dominant modes and motion trajectories etc were investigated leading to the following conclusions 1 two side by side cylinders cylinders 2 and 3 are located downstream of the upstream cylinder cylinder 1 in case a the upstream cylinder which is insignificantly affected by the downstream cylinders behaves like an isolated flexible cylinder however it exhibits a notable effect on the two downstream cylinders the maximum values of the rms il displacements of cylinders 2 and 3 are 62 and 45 higher than that of the isolated cylinder respectively two prominent frequencies appear in the il vibration the frequency component f v il 1 2 is equal to the dominant frequency in the cf direction which is probably associated with the amplification of the il response amplitude mixed modes are observed in the vibration along the il direction which is consistent with the two robust il frequencies the trajectories of the downstream cylinders cylinders 2 and 3 are tear or lip shaped at some measurement points implying that the ratio of the il to cf dominant frequency is equal to 1 0 eight half moon and c shaped oscillation figures which usually occur during the vibration of an isolated cylinder are uncommon during the vibrations of the downstream cylinders 2 in case b cylinder 1 is located upstream of cylinders 2 and 3 and shares a similar dynamic response with an isolated cylinder the maximum rms value of the il displacement of cylinder 2 is 64 2 larger than that of the isolated cylinder two robust frequencies and combined modes are observed for the il vibration of cylinder 2 the wake of cylinder 2 leads to a large il oscillating amplitude of cylinder 3 that is twice as large as that of the isolated cylinder the il dominant mode of cylinder 3 is suppressed and the il dominant frequency is much lower a fuzzy elliptical shaped motion trajectory is observed for cylinder 3 indicating that the il dominant frequency is identical to the cf dominant frequency 3 in case c the fiv responses of two cylinders cylinders 1 and 2 located upstream of cylinder 3 show less discrepancy than those of two side by side flexible cylinders in xu et al 2018a indicating that cylinder 3 may suppress the mutual interaction of two side by side flexible cylinders the two upstream cylinders have significant influences on the downstream cylinder cylinder 3 the response amplitudes of cylinder 3 in the cf and il directions are both enlarged which is consistent with the results of the downstream elastically supported rigid cylinder ou et al 2009 wang et al 2013 the vibration of cylinder 3 in the il direction also contains two major frequency components which are closely related to the mixed modes in the il direction moreover due to the wake effects of two upstream cylinders cylinders 1 and 2 the trajectory of cylinder 3 is disordered acknowledgments this research work was finically supported by national natural science foundation of china grant nos 51679167 51525803 and 51678548 and the science fund for creative research groups of the national natural science foundation of china grant no 51621092 
22764,a three cylinder system with an equilateral triangular configuration represents one of the most common basic units of multi cylinder systems in many engineering fields in this paper an experimental investigation of the flow induced vibration fiv of a three cylinder system in an equilateral triangular arrangement was conducted in a towing tank to study their response characteristics three identical flexible cylinder models with a centre to centre distance of 6 0 times the cylinder diameter were towed along the tank to generate a uniform flow the reynolds number ranged from approximately 1600 to 16000 depending on the towing velocity which was in the range of 0 10 1 00 m s the time varying bending strains of the flexible cylinders in the cross flow cf and in line il directions were measured using strain gauges at different measurement positions the displacement responses were reconstructed by a modal analysis method based on the acquired strain signals the experimental results e g displacement amplitudes response frequencies dominant modes and motion trajectories of the flexible cylinders were presented to reveal the fiv response features three typical cases of the equilateral triangular configuration a b and c corresponding to flow incidence angles of 0 30 and 60 were selected and discussed the incidence angle is the angle between the flow direction and the line joining the centre of one cylinder to the centre of the equilateral triangular configuration in cases a and b the upstream cylinder is insignificantly affected by the downstream cylinders and behaves like an isolated flexible cylinder meanwhile the upstream cylinders in case c vibrate similarly to two side by side flexible cylinders with weak mutual interference striking departures exist in the il oscillations of the downstream cylinders due to the notable effects of the upstream cylinders the phenomenon of mixed modes appears in the il vibrations of the downstream cylinders furthermore the il response spectra always contain a robust lower frequency component equal to the dominant frequency in the cf direction moreover eight half moon and c shaped vibration figures are comparatively uncommon for the downstream cylinders graphical abstract image 1 keywords flow induced vibration equilateral triangular configuration flexible cylinder side by side tandem 1 introduction in many cases of engineering practice multiple cylinders form the basic components of machinery and structures such as offshore platforms marine risers cooling towers heat exchangers and conduction cables flow induced vibrations fiv of multiple cylinders may cause serious fatigue damage to such structures and reduce their service life consequently fiv constitutes a major concern in numerous engineering fields over the past several decades a great deal of research has been conducted on the wake interactions mutual interference dynamic responses and hydrodynamic features of multiple cylinder systems zdravkovich 1988 sumner 2010 lam and zou 2009 wang et al 2013 yan et al 2016 han et al 2018 xu et al 2018c 2018d wang et al 2019 to simplify the subject of multiple cylinders undergoing fiv two cylinders can be regarded as the basic cell of a multiple cylinder system accordingly the fiv of two cylinders has drawn increased attention during recent years there are three types of arrangements for the two cylinder system namely a side by side arrangement relative to the approaching flow direction a tandem arrangement consisting of one cylinder behind the other and a staggered arrangement zdravkovich 1985 a complete understanding of the wake interference within the flow around two fixed rigid cylinders can provide a theoretical basis for further investigations into fiv the flow regime behind two side by side stationary cylinders can be classified into three categories according to the spacing ratio s d where s is the centre to centre separation distance and d is the cylinder diameter at small spacing ratios s d 1 1 1 2 the two cylinders behave as a single bluff body and thus only one vortex street occurs bearman and wadcock 1973 as the spacing ratio increases 1 1 1 2 s d 2 2 2 7 a bi stable biased gap flow emerges forming a narrow wake behind one cylinder and a wide wake behind the other alam et al 2003 for larger spacing ratios s d 2 2 2 7 two in phase or out of phase coupled vortex streets appear williamson 1985 the flow regime around two tandem cylinders is also sensitive to the spacing ratio and can be subdivided into three basic types i an extended body regime at small spacing ratios 1 s d 1 2 1 8 ii a reattachment regime at intermediate spacing ratios 1 2 1 8 s d 3 4 3 8 and iii a co shedding regime at large spacing ratios s d 3 4 3 8 sumner 2010 zdravkovich 1987 of the three arrangements of the two cylinder system the staggered configuration is universally employed in engineering applications however the wake flow behaviours of two staggered cylinders depend upon not only the spacing ratio s d but also the flow arrival angle γ which is defined as the angle between the flow direction and the connecting line of the two cylindrical centres and thus these behaviours are more complicated than those of the other two configurations two cylinders in a staggered arrangement can be subjected to nine flow patterns that can be grouped into three broad categories namely single bluff body flow regimes small incidence angle flow regimes and large incidence angle flow regimes sumner 2010 sumner et al 2000 due to the oscillations of the structures the flow behaviours and fluid dynamics of two cylinders subjected to fiv are much more complex than those of two fixed rigid cylinders kim and alam 2015 experimentally examined the fiv characteristics of two side by side elastically supported cylinders with s d 0 1 3 2 and reynolds numbers re ranging from 4365 to 74200 they found that the wake flow between two oscillatory cylinders was significantly different from that of two fixed cylinders four flow patterns varying with s d were recognized in their tests chen et al 2015 numerically investigated the responses and wake patterns of two side by side elastically mounted cylinders undergoing fiv with s d 2 0 5 0 at re 100 six wake patterns were observed with various s d and reduced velocities they also found that the lock in region of the two cylinders mildly shifted towards the end with a smaller reduced velocity than observed for an isolated elastically mounted cylinder kim et al 2009 conducted a model test on two elastically supported cylinders restricted to vibrate in cross flow cf direction in a tandem arrangement with s d 1 1 4 2 the results indicated that the downstream cylinder had a slight influence on the vibration of the upstream cylinder while the interference effect of the upstream cylinder on the downstream cylinder was very strong prasanth and mittal 2009 numerically studied the fivs of two tandem elastically supported cylinders that were free to oscillate in both the cf and the in line il directions with s d 5 5 at re 100 the downstream cylinder experienced large displacements in both the cf and the il directions while the upstream cylinder underwent synchronization at a smaller reduced velocity due to the presence of the downstream cylinder huang and herfjord 2013 experimentally explored the fiv of two staggered elastically supported cylinders allowed to oscillate in the cf and il directions and found that the motion trajectory of the downstream cylinder obviously differed from that of the upstream cylinder alam and kim 2009 conducted a free vibration test on two staggered elastically supported cylinders oscillating in the cf direction with s d 1 1 3 2 and γ 5 60 seven response patterns were observed depending on s d and γ both the upstream and downstream cylinders might experience either vortex excited vibrations or galloping vibrations many cylindrical structures including marine risers and transmission lines which can be modelled as flexible cylinders have a large aspect ratio l d where l is the cylinder length the fiv characteristics of two long flexible cylinders are more complex than those of two elastically supported rigid cylinders zhou et al 2001 experimentally studied the fiv of two side by side flexible cylinders with s d 1 13 3 0 in contrast to the results obtained for two elastically supported rigid cylinders the first second and third mode resonances of the two flexible cylinders were observed in the case of s d 3 0 their findings demonstrated that structural flexibility plays a crucial role in structural instability and should not be ignored huera huarte and gharib 2011a experimentally investigated the effects of s d on the fiv of two side by side flexible cylinders with l d 93 75 following which they declared that the synchronized motion of the two cylinders was not observable at s d 3 5 xu et al 2018a experimentally examined the fiv of two side by side flexible cylinders with a large aspect ratio l d 350 they noted that proximity interference between the two cylinders existed until s d 6 0 while the oscillations of the two cylinders in the il direction interfered with each other even when s d was increased to 8 0 huera huarte and bearman 2011 explored the free vibrations of two tandem flexible cylinders at five different spacing ratios s d 2 0 2 5 3 0 3 5 and 4 0 they observed that the upstream cylinder experienced classical vortex induced vibrations viv however the downstream cylinder exhibited either viv or wake induced vibrations wiv which accounted for the prominent observed amplitudes at higher reduced velocities huera huarte and gharib 2011b further studied the fiv features of two tandem flexible cylinders with much larger spacing ratios s d 4 5 8 0 they found that the upstream cylinder behaved like an isolated cylinder with an increase in the spacing ratio however the downstream cylinder experienced classical viv at reduced velocities in the expected lock in region and exhibited wiv at reduced velocities beyond the expected lock in region xu et al 2018b experimentally investigated the multi mode fiv response of two tandem flexible cylinders in a towing tank they found that the responses and dominant frequencies of the upstream cylinder were insignificantly affected by the downstream cylinder which did not display large amplitudes similarly sherbrooke and laneville 1999 experimentally studied the flow interactions between a stationary cylinder and a downstream flexible cylinder in a staggered configuration and discovered that the response of the downstream cylinder is analogous to that of an isolated cylinder as γ exceeds a critical value prastianto et al 2008 examined the response characteristics of two staggered flexible cylinders by towing the cylinders in still water they demonstrated that the impacts of the mutual interference between the oscillations in the cf and il directions gradually weakened as the transverse spacing between the cylinders increased in addition the trajectory patterns of the two cylinders resembled that of an isolated cylinder at a large transverse spacing although the two cylinder system can be regarded as the basic unit of a multi cylinder system the flow interference between two cylinders cannot represent that for all multi cylinder system situations the equilateral triangular arrangement of three cylinders is also one of the most common configurations in many engineering fields the presence of the third cylinder notably distinguishes the mutual interference among the three cylinders from the situation with only two cylinders therefore the flow interference around three cylinders in an equilateral triangular configuration has been discussed by several investigators sayers 1987 1990 kareem et al 1998 tatsuno et al 1998 gu and sun 2001 pouryoussefi et al 2011 tatsuno et al 1998 experimentally investigated the effects of flow interference among three identical rigid fixed cylinders in a regular triangular arrangement and concluded that the mutual interference among the three cylinders was severe when the spacing ratio was small and vice versa gu and sun 2001 examined the flow patterns of three equally spaced stationary cylinders in an equilateral triangular arrangement with s d 1 7 5 0 via wind tunnel tests they observed three flow patterns namely a proximity effect a shear layer reattachment effect and a wake effect attributable to the various incidence angles at small values of s d pouryoussefi et al 2011 conducted wind tunnel tests on three rigid fixed cylinders in an equilateral triangular configuration at five subcritical re values in the range of 12600 60800 with incidence angle β 0 β is the angle between the flow direction and the line joining the centre of one cylinder to the centre of the equilateral triangular configuration as shown in fig 1 the strouhal number st for the upstream cylinder increased with the decreasing spacing ratio between the cylinders they concluded that the influence of the flow interference could be weakened by enlarging the spacing ratio furthermore the flow behaviour of the upstream cylinder was nearly identical to that of an isolated cylinder bansal and yarusevych 2017 experimentally investigated the flow through a cluster of three equally spaced rigid fixed cylinders with a small spacing ratio s d 1 35 at re 2100 they discovered that the value of st which was scaled by the projected height of the three cylinders was approximately identical to that of an isolated cylinder with an equivalent diameter since two side by side cylinders were situated upstream of the third cylinder the near wakes i e consisting of two narrow wakes and one wide wake were symmetric zheng et al 2016 numerically investigated the flow behaviours of three equally spaced stationary cylinders with s d 1 5 7 0 at re 100 and 200 two cases were considered i e two side by side cylinders were positioned upstream or downstream of the third cylinder they concluded that the flow interference among the cylinders depended upon not only s d but also re and showed that re has a significant impact on the critical spacing ratio where the biased flow pattern of the side by side downstream cylinders disappears however little research has been performed on the fiv of three elastically supported cylinders in an equilateral triangular arrangement ou et al 2009 and xu et al 2014 numerically investigated the fiv of three elastically supported rigid cylinders with two incidence angles β 0 and 60 in an equilateral triangular arrangement and determined that the motion trajectories of the downstream cylinder or cylinders may exhibit oblique oval orbits indicating that the il frequency of oscillation is equal to that of the cf furthermore the response amplitudes of the downstream cylinder or cylinders were enlarged due to the vibration of the upstream cylinders or cylinder wang et al 2013 numerically studied the fiv of three equally spaced elastically supported rigid cylinders with s d 4 0 at re 150 in consideration of typical flow incidence angles β 0 30 and 60 they discovered that the vortex shedding frequencies the response amplitudes and the oscillation trajectories markedly rely upon the incidence angle and the reduced velocity at β 0 both downstream side by side cylinders had the same response frequency in the cf and il directions at β 30 the motion trajectories of the cylinders were inclined figure eight patterns due to the asymmetric flow finally at β 60 the downstream cylinder exhibited irregular vibrations due to complicated wake interference from the two upstream side by side cylinders the fiv of one or two flexible cylinders has been investigated in recent years however to the best of the authors knowledge few studies on the fiv of three long flexible cylinders in an equilateral triangular configuration have been reported the fiv characteristics of flexible cylinders with large aspect ratio are significantly distinct from those of elastically mounted rigid cylinders with regard to many aspects including harmonic phenomena multi mode responses and mixing response features of travelling waves and standing waves larsen et al 1996 chaplin et al 2005 vandiver et al 2009 wu et al 2016 pavlovskaia et al 2016 the fiv of three equally spaced flexible cylinders are still not understood and thus warrant further investigation the main purpose of this paper is to experimentally study the dynamic response of three equally spaced long flexible cylinders with l d 350 subjected to fiv in a towing tank the spacing ratio was fixed at 6 0 at which the mutual interference of the flexible cylinders is still significant huera huarte and gharib 2011b xu et al 2018a 2018b three typical cases of incidence angles β 0 30 and 60 were explored with re ranging from 1600 to 16000 the dynamic response features of the three flexible cylinders were discussed by analysing their displacement amplitudes response frequencies dominant modes and motion trajectories the remainder of this paper is organized as follows section 2 provides information regarding the experimental details section 3 introduces a method for reconstructing the displacement responses of the flexible cylinders section 4 presents and discusses the experimental results for the three incidence angle cases including the displacement amplitudes response frequencies dominant modes and motion trajectories finally some concluding remarks are given in section 5 2 experimental details the three cylinders used in the experiment were labelled cylinder 1 cylinder 2 and cylinder 3 as shown in fig 1 three typical cases a b and c were considered depending on varying values of β i e the angle between the flow direction and the line joining the centre of cylinder 1 to the centre of the equilateral triangular configuration in case a with β 0 two side by side cylinders cylinders 2 and 3 were located downstream of the upstream cylinder cylinder 1 cylinder 1 was located upstream of cylinders 2 and 3 in case b with β 30 two side by side cylinders cylinders 1 and 2 were upstream of cylinder 3 in case c with β 60 the spacing ratio was chosen as s d 6 0 referring to previous experimental studies on the fiv of two flexible cylinders in side by side sanaati and kato 2014 xu et al 2018a 2018b and tandem arrangements xu et al 2018b zdravkovich 1987 for the two side by side flexible cylinders the mutual interference of two cylinders is still notable even when the spacing ratio reaches 6 0 xu et al 2018a and the motions of the two cylinders are strongly synchronized at s d 5 5 sanaati and kato 2014 for the two tandem flexible cylinders the spacing ratio s d 6 0 put the tandem configuration in a wake interference region as predicted by zdravkovich 1987 it can be inferred that the oscillations of three equally spaced flexible cylinders will exhibit mutual interference at s d 6 0 in our tests fig 2 shows the experimental setup which mainly had one supporting structure four vertical supporting rods two supporting plates and guide plates three cylinder models and pretension adjustment and measurement systems the guide plate was mounted on the supporting plate by several long bolts to avoid the disturbed flow caused by the supporting plates and supporting rods and ensure the incoming flow is two dimensional three flexible cylinders were simply mounted at the two guide dials which were fixed on the supporting plate dials one end of each flexible cylinder was connected to a universal joint mounted on the supporting dials installed on the supporting plate a steel wire that was passed through a pulley and successively connected to a spring tensioner and load cell was connected to the other end of each cylinder the tensioner was used to adjust the axial tension of the flexible cylinder while the spring ensured gradual variation in the axial tension and the load cell was adopted to monitor the variations in the axial tension a low axial tension would lead to large il deflections due to the mean drag whereas a high axial tension could improve the stiffness thereby enlarging the towing velocity needed to excite higher modes of vibration hence the initial axial tension was set at 450 n for all tests the apparatus used in the experiment is analogous to the experimental system for the fiv of two tandem cylinders xu et al 2018b and two side by side cylinders xu et al 2018a there are also several slight differences e g four strong vertical supporting rods were connected to the supporting structure to withstand the much larger loads of the three cylinder model compared with those of the two cylinder experimental system xu et al 2018a 2018b which only had two vertical supporting rods moreover two guide dials and two supporting plate dials in the system of the supporting and guide plates were designed to realize the different cases case a case b and case c of the three equally spaced cylinders as shown in figs 3 and 4 the flexible cylinder model with a diameter of 16 mm and a length of 5 60 m consisted of an internal copper pipe and an outer silicone tube the outer silicone tube covered the internal copper pipe and the measuring equipment to provide a smooth external surface for the flexible cylinder the copper pipe and the silicone tube were closely attached to each other and their movements were exactly the same the same flexible cylinder model has been used in our previous experiments to investigate the dynamic characteristics of an isolated inclined flexible cylinder undergoing viv han et al 2017 and the effect of spacing on fiv of two flexible cylinders in side by side and tandem arrangements xu et al 2018a 2018b the mass per unit length of the cylinder was 0 3821 kg m the mass ratio m of the cylinder which is defined as the structural mass divided by the mass of displaced fluid was 1 90 the main parameters of the flexible cylinder are shown in table 1 there were seven measurement points g1 g7 on the internal copper pipe at equal intervals each measurement point comprised four strain gauges to monitor the bending strains in the cf and the il directions the experimental apparatus see fig 2 was installed under a carriage and towed in a towing tank 7 0 m wide 3 3 m deep and 137 0 m long belonging to the state key laboratory of hydraulic engineering simulation and safety at tianjin university the flexible cylinders were submerged at depths of at least 1 0 m into the water to avoid free surface effects a uniform flow was generated when the carriage moved at a constant speed the towing velocity ranged from 0 10 m s to 1 00 m s with an interval of 0 05 m s corresponding to re 1600 16000 to prevent aliasing problems the sampling time was 50 s after the carriage reached a stable towing velocity and the sampling frequency was 100 hz the waiting time between two consecutive runs was 15 min for the purpose of calming the disturbed water more than 70 runs were conducted across all experimental cases decay tests were conducted in air and still water before carrying out the experimental cases the cf first seven order natural frequencies in water of the three cylinders and the isolated cylinder were identified from the decay tests as shown in table 2 the il natural frequencies were close to those in cf direction and not presented here the theoretical values of the natural frequencies in water were calculated from eq 1 for comparison 1 f n n 2 l t z m s m a n π l 2 e i m s m a where f n is the nth order natural frequency in water and m a ρπd 2 4 is the added mass per unit table 2 shows that the natural frequencies of the three cylinders and the isolated cylinder are all generally identical to the theoretical values within the error allowed range which indicates the experimental apparatus is reliable and the strain gages can give accurate measurements of the strain results during the oscillation of the flexible cylinder models 3 data analysis during the experimental tests the bending strain signals of the flexible cylinders in the cf and il directions were directly obtained by strain gauges at seven measurement points g1 g7 however the cf and il strain signals required pre processing before further use the data processing was the same as that used by xu et al 2018a the additional initial bending strain which is independent of time was eliminated a band pass filter with a bandwidth of 1 0 40 0 hz was also applied to the bending strains to remove the inevitable low and high frequency noise signals the displacement of the flexible cylinder is reconstructed using a modal analysis method according to the measured strain signals as proposed by lie and kaasen 2006 this method has been proven capable of reconstructing the displacements of flexible cylinders subjected to viv in a uniform flow song et al 2011 herein the reconstruction of the cf displacement is taken as an example the cf displacement y z t can be written in the form of modal superposition 2 y z t n 1 w n t φ n z z 0 l where z is the coordinate along the axis of the cylinder t denotes the time w n t represents the modal weight φ n z represents the mode shape and n denotes the number of the mode order the mode shape can be assumed to be sinusoidal or approximated with sinusoids for a simply supported cylinder as follows 3 φ n z sin n π z l the relationship between the strain ε z t and displacement y z t is expressed as follows 4 ε z t r 2 y z t z 2 n 1 n n π l 2 w n t sin n π z l where r is the radius of the copper pipe the modal weight w n t can be calculated according to eq 4 substituting the modal weights w n t into eq 2 the cf displacement was obtained the research presented by lie and kaasen 2006 gives more details about the modal analysis approach the reconstruction of the il displacements is similar to that of the cf displacements and not introduced in this paper for the sake of simplicity 4 results and discussion the displacement amplitudes response frequencies dominant modes and trajectory motions of the three flexible cylinders undergoing fiv in an equilateral triangular configuration are presented and discussed for the three typical cases a b and c in this section the reduced velocity v r is defined as 5 v r u f 1 d where f 1 is the first order natural frequency of the flexible cylinder in water the first order natural frequencies of the three cylinders in our free decay tests were not completely identical to each other hence f 1 was the theoretical value to avoid slight differences 4 1 fiv responses of the three flexible cylinders in case a the flexible cylinders have multi order natural frequencies and the high order modes can be excited when the structures undergoing fiv tables 3 and 4 list the cf and il dominant vibration modes of the three flexible cylinders in case a the results for an isolated cylinder are also displayed in these tables for comparison in the current study the dominant mode is defined as the mode with the largest modal weight from eq 2 to illustrate them more clearly different dominant modes are marked with various background colours from low to high orders the first second and third order mode resonances in the cf direction are found for the three cylinders and the isolated cylinder the dominant modes are transformed from low to high orders at v r 10 02 and 20 04 unlike the three cylinder group fourth order mode vibration is identified for the isolated cylinder as the reduced velocity is 25 05 it seems that the dominant modes of the cf vibrations show little discrepancies between the three equilateral triangular cylinders and the isolated one however the il dominant vibration modes of the flexible cylinders exhibit significant differences judging from the background colours in table 4 at first sight the maximum dominant vibration mode in the il direction of the isolated cylinder reaches the sixth order at v r 25 05 the result of cylinder 1 agrees well with that of the isolated cylinder though the il dominate mode of cylinder 1 is just up to the fifth order only little deviations are found between cylinder 1 and the isolated cylinder when the dominant mode switches such as v r 10 02 and 15 03 in this paper the reduced velocity areas where dominant modes switch are defined as the mode switch regions serious mode competition appears when the dominant mode switches chaplin et al 2005 which results in the differences between the il dominant vibration modes of cylinder 1 and the isolated cylinder for the two downstream side by side cylinders the il dominant modes are significantly different from those of the isolated cylinder at v r 15 03 at such reduced velocities it is challenging to judge the dominant mode because the two different modes have almost equal modal weights the second and fourth order modes dominate the il vibration together at v r 15 03 18 79 while the third and the fifth order modes take over the vibrations at v r 20 04 25 05 to give more insight into the multiple dominant modes the il modal weights of cylinder 1 and 2 at v r 21 29 are presented in fig 5 for cylinder 1 the modal weights of fifth order mode are the highest which indicates that the fifth order mode dominates the vibrations however for cylinder 2 the modal weights of both the third order mode and the fifth order mode are predominant the third order mode and the fifth order mode share the domination of the vibrations as noted by xu et al 2018a the dominant vibration modes of two side by side flexible cylinders with s d 6 0 agreed well with those of the isolated cylinder outside of the mode switch zone which confirms that the dissimilar il dominant modes of the downstream cylinders are mainly attributable to the wake effect of the upstream cylinder instead of the interference between the two downstream side by side cylinders fig 6 shows the maximum dimensionless root mean square rms values of the cf and il displacement amplitudes y rms d and x rms d respectively of the three cylinders the results for an isolated flexible cylinder are also drawn to facilitate a convenient comparison utilizing the modal analysis method the cf displacement y z t can be obtained according to the strain information at the seven measurement points g1 g7 the rms values of the cf displacement at every axial position z i can be calculated by the following formula 6 y r m s z i 1 s j 1 s y z i t j where s is the sampling number the max y rms d is the maximum dimensionless rms value of the cf displacement among all the axial position z i namely max y rms z i d the max dimensionless rms value of the il displacement x rms d is obtained in a similar way the maximum y rms d values of the three cylinders are plotted in the first column of fig 6 the first second and third order modes are excited in the cf vibration of cylinder 1 according to table 3 for the first order mode resonance the maximum y rms d peaks at v r 7 52 and then decreases until the vibration enters the second order mode the maximum y rms d reaches the highest point at v r 12 52 in the second order mode synchronized region and falls swiftly there is an upward trend when the vibration is in the third order mode resonance v r 18 79 cylinder 1 shares the analogous trend of y rms d with the isolated cylinder indicating that cylinder 1 is insignificantly affected by the two downstream cylinders except for several slight differences at individual reduced velocities e g the maximum y rms d of cylinder 1 surpasses that of the isolated cylinder at v r 25 05 in addition the maximum rms of the cf displacements of cylinders 2 and 3 also peak at the first second and third order mode resonances while the variation trend shows considerable differences from that of the isolated cylinder for example the maximum y rms d of cylinder 2 is slightly smaller than that of the isolated cylinder at the second order mode resonance cylinder 3 shows higher values of the maximum y rms d than the isolated cylinder at the first and third order mode resonance but it is the opposite at the second order mode resonance these differences could be due to two reasons 1 the two flexible cylinders are positioned side by side leading to mutual interference xu et al 2018a 2 the existing of the upstream cylinder has some effects on the cf oscillations of the two downstream side by side cylinders the maximum y rms d values for the two side by side cylinders in xu et al 2018a exhibit notable discrepancy from each other due to the motion interference however the difference in the maximum y rms d values between cylinders 2 and 3 is reduced compared to that of the two side by side cylinders meanwhile the maximum rms values of the cf displacements of cylinders 2 and 3 are much closer to that of the isolated cylinder than those of the side by side cylinders in xu et al 2018a hence it can be concluded that the upstream cylinder slightly suppresses the mutual interference between the downstream side by side cylinders as shown in the second column of fig 6 the maximum x rms d of cylinder 1 agrees with that of the isolated cylinder at most reduced velocities indicating that the two downstream cylinders demonstrate limited influences on the il vibrations of cylinder 1 some previous investigations into the flow regime around three equilateral triangular cylinders at β 0 have proven that the flow behaviours of the upstream cylinder are coincident with those of an isolated cylinder at a large s d gu and sun 2001 pouryoussefi et al 2011 this is the reason why cylinder 1 shares a matching trend of displacement amplitudes with the isolated cylinder however the il displacement of the two downstream cylinders shows different features cylinder 2 has larger maximum x rms d values than cylinder 3 at v r 3 76 7 52 and v r 20 04 25 05 while the x rms d values of the two cylinders are similar to each other at v r 10 02 18 79 despite some differences in the x rms d of cylinders 2 and 3 the x rms d of the isolated cylinder is significantly smaller than that of the two cylinders the extreme values of x rms d of cylinders 2 and 3 are 62 and 45 greater than that of the isolated cylinder respectively although the il responses of the two side by side flexible cylinders are affected by the wake interaction between the two cylinders the oscillation amplitudes do not reach such a high level xu et al 2018a this confirms that the immense amplification of the il displacement is mainly associated with the behaviour of the upstream cylinder for the three elastically supported rigid cylinders in an equilateral triangular configuration at β 0 wang et al 2013 the il amplitudes of the two downstream cylinders were more prominent than that of the isolated cylinder at the fundamental mode resonance except for the fundamental mode high order modes can also be excited when the flexible cylinder undergoing fiv the downstream side by side cylinders of three equilateral triangular flexible cylinders still experience tremendous vibration in il direction at the high order mode resonance fig 7 shows the displacement response spectra of the three cylinders at the middle measurement point g4 in case a which was produced by the fft analysis of the displacement data the blue dashed lines in the first and second columns of the figure represent one and two times the vortex shedding frequency of a stationary rigid cylinder the il and cf dominant frequencies f dominant il f dominant cf which are taken as the largest peak in the spectra plots of cylinder 1 which exhibit a double relationship with each other almost linearly increase with an increase in flow velocity this behaviour is consistent with that of an isolated cylinder except for the dominant response frequency a few frequency components with smaller peaks are observed at some velocities due to the multi mode vibrations of the flexible cylinder and the inconspicuous effect of the downstream cylinders the dominant frequencies of cylinders 2 and 3 in the cf direction also show an approximate linear growth with increasing flow velocity though the frequency spectrum is moderately wider than that of cylinder 1 at several flow velocities there are two robust frequencies in the il response spectra at many different flow velocities for both cylinders 2 and 3 for convenient description the robust frequency near the double vortex shedding frequency of a stationary rigid cylinder can be denoted as f v il the other outstanding frequency almost half of the f v il is denoted as f v il 1 2 interestingly the f v il 1 2 is close to the cf dominant frequency f dominant cf at the same flow velocity evidently the f v il 1 2 is the dominant frequency in the il direction for the two cylinders except when u 0 40 0 50 m s to illustrate this phenomenon clearly the f v il and f v il 1 2 of the two cylinders at u 0 90 m s v r 22 55 are compared in detail the f v il of cylinder 2 is equal to 17 3 hz and has an amplitude value of 0 21 while the f v il 1 2 of cylinder 2 is 8 7 hz with an amplitude value of 0 33 for cylinder 3 the f v il and f v il 1 2 corresponding to the amplitude values of 0 18 and 0 34 are equal to 16 8 hz and 8 40 hz respectively xu et al 2018a showed that the il dominant frequencies of the two side by side flexible cylinders with s d 6 0 were slightly smaller than the double vortex shedding frequency of a fixed cylinder and were generally close to that of an isolated flexible cylinder it can be concluded that the robust f v il 1 2 in il vibrations of cylinders 2 and 3 are mainly associated with the wake interference of the upstream cylinder instead of the mutual interaction caused by the side by side configuration meanwhile it seems that the preponderant f v il 1 2 is strongly related to the outstanding il response amplitudes of cylinders 2 and 3 it should be noted that the measurement point g4 is near the node when the even order mode dominates the vibrations to check the displacement spectra at g4 when the dominant mode is even order and compare the displacement spectra among the measurement points fig 8 shows the cf and il displacement response spectra of cylinder 2 at the measurement points g1 g7 and v r 16 28 according to tables 3 and 4 the cf and il dominant mode of cylinder 2 at v r 16 28 are the second order and the fourth order respectively the amplitudes at g4 are much lower than those at other measurement points due to the fact that g4 is near the node however the frequency characteristics of the displacement spectra at different measurement points show insignificant deviations except for small differences between high order frequencies as well known high order mode vibrations can be excited for the flexible cylinders which is a typical feature that rigid cylinders do not possess the fiv response characteristics of high order mode oscillations of three equilateral triangular flexible cylinders are worthy of further investigation according to table 3 the vibrations of the isolated flexible cylinder are at the third order mode resonance at v r 21 29 hence the response results of the three cylinders and the isolated cylinder at v r 21 29 are presented and discussed in detail fig 9 shows the space time varying non dimensional displacement contours spanwise evolutions of the rms displacements non dimensional displacement responses at seven measurement positions and motion trajectories at seven measurement positions along the three cylinders in case a as presented in fig 9 a the fiv responses of cylinder 1 in the cf and il directions are both standing waves the cf and il dominant vibration modes of cylinder 1 are third and fifth order modes respectively the spanwise evolutions of the rms displacements are asymmetric which can be attributed to the multi mode response of flexible cylinders subjected to fiv song et al 2011 the time varying il displacements exhibit notable harmonic components which is consistent with the displacement response spectra shown in fig 7 at g4 and g7 the motion trajectories are distorted eight shaped figures however the motion trajectories are half moon or c shaped figures at g1 g2 g3 and g6 these motion trajectory shapes were observed during research on the fiv of a single flexible cylinder by vandiver et al 2009 the eight half moon and c shaped figures indicate that the ratio of the il to cf dominant frequency is approximately equal to 2 0 however due to the phase angle between the il and cf response amplitudes the motion trajectories exhibit distinct eight or c shaped figures thus the fiv response characteristics of the upstream cylinder cylinder 1 agree with those of an isolated cylinder proving that the downstream cylinders insignificantly affect the upstream cylinder in case a the results for the two downstream side by side cylinders at v r 21 29 are presented in fig 9 b and c the cf response of cylinder 3 remains a standing wave while that of cylinder 2 is a mixture of standing and travelling waves both cylinders 2 and 3 exhibit a travelling wave behaviour in the il direction the spanwise evolutions of the rms displacements reveal that the cf dominant modes of the two cylinders are both third order modes these findings are the same as those for both the upstream cylinder and the isolated cylinder however the spanwise evolutions of the rms displacements in the il direction exhibit remarkably different features the il dominant mode of cylinder 2 is a mixture of third and fifth order modes in accordance with the results in table 4 judging from the spanwise evolutions of the rms il displacements cylinder 3 experiences an il vibration dominated by a third order mode the motion trajectories of cylinders 2 and 3 are significantly distinct from those of both the upstream cylinder and the isolated cylinder due to the mixture of third and fifth order dominant modes the ratio of the il to cf frequency of cylinder 2 is 2 0 at some measurement points i e g4 and g7 hence the motion trajectories at g4 and g7 are similar to eight shaped figures however no obvious eight half moon or c shaped figures are observed for cylinder 3 except for g4 at which the motion trajectory resembles an asymmetric eight shaped figure this phenomenon is mainly because the il vibration of cylinder 3 contains two robust frequency components as shown in fig 7 tear or lip shaped figures are observed for cylinder 3 at most measurement points indicating that the ratio of the il to cf dominant frequency is equal to 1 0 xu et al 2018a verified that the motion trajectories of two side by side flexible cylinders with s d 6 0 might be distinct eight half moon or c shaped figures consequently the distinct motion trajectories of cylinder 2 and 3 result from the presence of the upstream cylinder however there are also discrepancies between the motion trajectories of cylinder 2 and cylinder 3 which indicates that the mutual interactions still exist in the two downstream side by side cylinders 4 2 fiv responses of the three flexible cylinders in case b tables 5 and 6 list the dominant vibration modes in the cf and il directions for the three flexible cylinders respectively the cf dominant modes of cylinder 1 agree well with those of the isolated cylinder except for some individual reduced velocities v r 3 76 8 77 and 25 05 some distinction in cf dominant modes of cylinder 2 and the isolated cylinder is observed in the modal switch regions higher order mode vibration is excited more easily for cylinder 2 for example the cf oscillation of cylinder 2 enters the second third and fourth order modes at lower reduced velocities than the isolated cylinder a similar phenomenon was observed in xu et al 2018a for two side by side flexible cylinders the cf dominant modes of cylinder 3 and the isolated cylinder can be compared very satisfactorily at v r 18 79 however cylinder 3 undergoing fiv experiences a third order mode in the cf direction until v r 22 55 which is much later than the other two cylinders in case b xu et al 2018b elucidated that the downstream cylinder in a tandem arrangement experiences much lower dominant modes in the cf direction due to the shielding effect of the upstream cylinder hence the distinct features of cf dominant modes of cylinder 3 are attributed to the shielding effect of cylinder 1 table 6 demonstrates that up to a fifth order mode in the il direction is excited for cylinder 1 the dominant modes of cylinder 1 in the cf and il directions are in fair agreement with the results of the upstream cylinder in the two cylinder tandem system provided by xu et al 2018b hence it is convictive to ascribe the slight difference in the il dominant modes between cylinder 1 and the isolated cylinder to the presence of cylinder 3 similar to cylinders 2 and 3 in case a a mixture of two modes can be observed for the il oscillation of cylinder 2 in case b when v r 13 78 the mixture mode phenomenon is closely related to the wake effect of cylinder 1 remarkable discrepancies appear in the il dominant mode of cylinder 3 as the same as the cf dominant modes the il dominant modes of cylinder 3 are much lower than the other two cylinders and the isolated one for two tandem flexible cylinder the sixth order mode vibrations of the downstream cylinder can be exited in the il direction xu et al 2018b it seems that the presence of cylinder 2 rather than cylinder 1 suppresses the il vibration modes of cylinder 3 fig 10 shows the maximum dimensionless rms values of the cf and il displacement amplitudes of the three cylinders in case b clearly the data for the upstream cylinder cylinder 1 agrees well with those of the isolated cylinder indicating that cylinders 2 and 3 have limited influence on cylinder 1 cylinders 1 and 3 are positioned in a tandem configuration in case b and some research also proved that the upstream cylinder of two tandem flexible cylinders will behave similarly to an isolated cylinder at s d 6 0 huera huarte and gharib 2011b xu et al 2018b it seems that the wake of cylinder 1 generates some effects on the cf vibrations of cylinder 2 the displacement amplitudes of cylinder 2 and the isolated cylinder in the cf direction are almost coincident at the first order mode resonance however some discrepancies can be observed in the second and third order mode resonance regions the maximum y rms d of cylinder 3 fluctuates around that of the isolated cylinder which results from the wake effect of cylinder 1 and 2 cylinder 3 has much smaller response amplitude in cf direction than the isolated cylinder at v r 2 51 7 52 and v r 12 52 18 79 while the result is opposite at v r 8 77 10 02 20 04 and 21 29 the cf oscillation amplitudes of cylinder 3 of three equilateral triangular rigid cylinders were substantially increased wang et al 2013 which is inconsistent with the present research the large amplitude vibration of cylinder 3 in wang et al 2013 was identified as wiv by huera huarte and gharib 2011b however the wiv of a downstream flexible cylinder may be avoided if the multi mode vibration of the downstream cylinder is excited huera huarte and bearman 2011 xu et al 2018b also did not observe unusually large amplitudes for the flexible cylinder downstream of two tandem flexible cylinders due to the multi mode fiv response which is consistent with the cf response amplitude of cylinder 3 in the current research as shown in fig 10 the data for cylinder 1 converge with those of the isolated cylinder in the il direction however the il displacement amplitudes of cylinder 2 considerably exceed those of the isolated cylinder the extreme value of x rms d of cylinder 2 is 64 2 larger than that of the isolated cylinder the numerical simulation on the fiv of three elastically mounted rigid cylinders in equilateral triangular arrangement with s d 4 0 and β 30 showed that the il displacements of cylinder 2 and the isolated cylinder can be compared satisfactorily which is inconsistent with our results wang et al 2013 the main reason is that the spacing ratio and incidence angle adopted in the numerical simulation made cylinder 2 enter into the no no interference regime classified by zdravkovich 1988 where cylinder 1 could not affect the oscillation of cylinder 2 while the fiv response amplitudes of flexible cylinder usually larger than those of the elastically mounted rigid cylinder which causes the mutual interference of flexible cylinders still strong at large s d xu et al 2018a hence the wake of cylinder 1 still shows a significant impact on the vibration of cylinder 2 in the current research cylinder 3 has enormous il response amplitudes at v r 7 52 comparing to the isolated cylinder the extreme x rms d values of cylinder 3 is 100 greater than that of the isolated cylinder however the il displacements of the downstream cylinder of two tandem flexible cylinders are not as large as those of cylinder 3 xu et al 2018b it can be concluded that the enlargement of il response amplitudes of cylinder 3 is closely related to the wake effect of cylinder 2 instead of cylinder 1 fig 11 shows the displacement response spectra of the three cylinders at the middle measurement point g4 in case b the dominant frequencies in the il and cf directions which demonstrate a double relationship both linearly increase with increasing flow velocity a similar trend has been observed for the isolated cylinder the cf dominant frequencies of cylinder 2 resemble those of cylinder 1 and the isolated cylinder clearly two strong frequency components f v il and f v il 1 2 participate in the il vibration at the same time consistent with the results for cylinders 2 and 3 in case a the amplitude values of f v il 1 2 are greater than those of f v il at many flow velocities which indicates that f v il 1 2 is the il dominant frequency it becomes convincing that the il response amplitudes of cylinder 2 in case b and cylinders 2 and 3 in case a are closely related to the frequency component f v il 1 2 for cylinder 3 the cf and il dominant frequencies are both seriously affected by the oscillations of cylinders 1 and 2 the middle measurement point of cylinder 3 experiences broad band spectra in the cf and il directions at most flow velocities surprisingly the frequency component f v il is considerably suppressed and the frequency component f v il 1 2 takes over the il vibration completely in fact f v il 1 2 may account for the remarkable growth of the il response amplitude of cylinder 3 fig 12 presents the space time varying non dimensional displacement contours spanwise evolutions of the rms displacements non dimensional displacement responses at seven measurement positions and motion trajectories at seven measurement positions of the three cylinders in case b at v r 21 29 a standing wave behaviour is clearly observable in the cf and il vibrations of cylinder 1 the cf and il dominant modes of cylinder 1 are third and fifth order modes this can be recognized from the spanwise evolutions of the rms displacements the motion trajectories of cylinder 1 are similar to those of the isolated cylinder and appear as distinct eight half moon or c shaped figures which is consistent with the numerical simulation on three rigid cylinders at their fundamental mode resonance wang et al 2013 the response characteristics of cylinder 2 are much more complex as presented in fig 12 b the fiv of cylinder 2 in the cf and il directions are standing and travelling wave responses respectively a mixture of third and fifth order modes are observed in the il vibration which is in accordance with the two robust frequency components shown in fig 11 notable harmonics appear in the time varying displacement in the il direction which causes cylinder 2 to move along unclosed trajectories although the il amplitude of cylinder 2 was not significantly enlarged in the findings of wang et al 2013 the motion trajectories of the rigid cylinder at the fundamental mode resonance are similar to those of cylinder 2 in our tests the deviation in the trajectory of cylinder 2 from the isolated cylinder is mainly associated with the wake interference of cylinder 1 fig 12 c shows that cylinder 3 exhibits a dynamic response distinct from cylinders 1 and 2 a combined behaviour consisting of a standing wave and a travelling wave can be observed in both the cf and il directions the dominant modes of vibration in the two directions are both second order as previously mentioned the cf dominant mode is suppressed due to the shield effect of cylinder 1 while the low il dominant mode is probably correlated with cylinder 2 for cylinder 3 conspicuous harmonics are found in the plot of time varying displacement which is consistent with the response spectra displayed in fig 11 the motion trajectories are unclear at the measurement points but a fuzzy elliptical shape can be observed at g2 g3 g5 and g6 the fuzzy elliptical shaped trajectory of cylinder 3 indicates that the ratio of the il to cf dominant frequency is equal to 1 0 4 3 fiv responses of the three flexible cylinders in case c tables 7 and 8 list the cf and il dominant modes for the three cylinders in case c for cylinders 1 and 2 the dominant modes in the cf direction are the same as that of the isolated cylinder except for v r 18 79 the maximum cf dominant mode of cylinder 3 subjected to fiv can be up to a third order mode it is lower than that of the isolated cylinder due to the presence of two upstream side by side cylinders cylinders 1 and 2 there is a relatively high level of agreement in the il dominant modes between the two upstream cylinders and the isolated one however the il vibrations of cylinders 1 and 2 enter into higher order modes earlier which is specifically reflected at v r 13 78 and 18 79 this trend was also reported in the research pertaining to two side by side flexible cylinders undergoing fiv xu et al 2018a moreover mixed modes also appear in the il vibration of cylinder 3 the second order mode and fourth order mode compete fiercely in the il vibration for v r ranging from 15 03 to 18 79 the third order mode and the fifth order mode share the leadership of the oscillation as v r exceeds 20 04 in case c the two side by side cylinders cylinders 1 and 2 are upstream of cylinder 3 fig 13 displays the maximum dimensionless rms values of the cf and il displacement amplitudes of the three cylinders for cylinders 1 and 2 the cf displacement amplitudes show some discrepancies with that of the isolated cylinder due to the mutual interference between themselves however the difference in the maximum y rms d between cylinders 1 and 2 is much smaller than that of two side by side flexible cylinders xu et al 2018a indicating that cylinder 3 may suppress the mutual interference of the upstream side by side cylinders the cf response amplitudes of cylinder 3 show a distinct feature comparing to those of the isolated cylinder cylinder 3 oscillates with a significantly increased displacement amplitude at the first order mode resonance which is consistent with the results of the downstream rigid cylinder wang et al 2013 while the y rms d of cylinder 3 is slightly larger than that of the isolated cylinder at the second and third order mode resonance it is convictive that the wake of the upstream side by side cylinders enhances the cf vibration of cylinder 3 due to the mutual interference between the two upstream cylinders the il displacements of cylinders 1 and 2 show some differences from that of the isolated cylinder however the il displacements of the upstream cylinders are much closer to those of the side by side flexible cylinders in xu et al 2018a these findings show that the mutual interaction of cylinders 1 and 2 results in the deviation of il response amplitudes between themselves and the isolated cylinder the downstream cylinder has a limited effect on the il response amplitudes of cylinder 1 and cylinder 2 the il response amplitude of cylinder 3 experiences a gradual increase and the extreme values of x rms d is 36 5 higher than that of the isolated cylinder the increased x rms d is mainly induced by the wake interference of the upstream side by side cylinders comparing the il response amplitudes of the downstream cylinders in case a and case b the application of the il vibrations of cylinder 3 in case c is much smaller fig 14 shows the displacement response spectra of the three cylinders at the middle measurement point g4 in case c because cylinder 3 is downstream of cylinders 1 and 2 it has an insignificant impact on the two upstream cylinders hence the displacement response spectra for cylinders 1 and 2 are similar to those of two side by side flexible cylinders in xu et al 2018a the dominant frequencies of the two cylinders in the il direction are twice as large as the cf dominant frequencies and they linearly grow with increasing flow velocity the broad band frequencies are observed in the cf vibration of cylinder 3 which is strongly related to the presence of cylinders 1 and 2 the il response frequency of cylinder 3 is distinctly different from those of both the isolated cylinder and the two upstream side by side cylinders there are two notable frequency components f v il and f v il 1 2 with a double relationship at most flow velocities moreover the frequency component f v il 1 2 is the dominant frequency in general which is consistent with the findings of the downstream cylinder in case a and case b fig 15 shows the space time varying non dimensional displacement contours spanwise evolutions of the rms displacements non dimensional displacement responses at seven measurement positions and motion trajectories at seven measurement positions of the three cylinders in case c at v r 21 29 as previously mentioned the downstream cylinder cylinder 3 has a limited effect on the upstream two side by side cylinders cylinders 1 and 2 hence the response features of cylinders 1 and 2 are coincident with those of two side by side flexible cylinders in xu et al 2018a the fiv of the upstream side by side cylinders is a mixture of standing waves and travelling waves in both the cf and il directions the spanwise evolutions of the rms displacements reveal that the cf and il dominant modes of cylinders 1 and 2 are third and fifth order modes respectively the motion trajectories of cylinders 1 and 2 are distinct eight half moon or c shaped figures and this finding agrees quite well with the reported trajectories of two side by side flexible cylinders by xu et al 2018a and with the upstream elastically supported rigid cylinders discussed in case c ou et al 2009 wang et al 2013 however the trajectories of cylinders 1 and 2 are slightly different from each other due to their motion interactions fig 15 c shows that the response characteristics of cylinder 3 significantly differ from those of the isolated cylinder the cf and il oscillations of cylinder 3 both behave as travelling waves at v r 21 29 the cf response is dominated by a third order mode but a mixture of third and fifth order modes appear in the il oscillation which is consistent with the results shown in fig 14 and table 7 the time varying displacements in the cf and il directions contain obvious harmonic components and account for the disordered motion trajectories 5 conclusions a series of experimental tests of three equally spaced long flexible cylinders with s d 6 0 subjected to fiv was carried out in a towing tank three typical cases a b and c were addressed with corresponding incidence angles of 0 30 and 60 the dynamic response features of the three flexible cylinders including displacement amplitudes response frequencies dominant modes and motion trajectories etc were investigated leading to the following conclusions 1 two side by side cylinders cylinders 2 and 3 are located downstream of the upstream cylinder cylinder 1 in case a the upstream cylinder which is insignificantly affected by the downstream cylinders behaves like an isolated flexible cylinder however it exhibits a notable effect on the two downstream cylinders the maximum values of the rms il displacements of cylinders 2 and 3 are 62 and 45 higher than that of the isolated cylinder respectively two prominent frequencies appear in the il vibration the frequency component f v il 1 2 is equal to the dominant frequency in the cf direction which is probably associated with the amplification of the il response amplitude mixed modes are observed in the vibration along the il direction which is consistent with the two robust il frequencies the trajectories of the downstream cylinders cylinders 2 and 3 are tear or lip shaped at some measurement points implying that the ratio of the il to cf dominant frequency is equal to 1 0 eight half moon and c shaped oscillation figures which usually occur during the vibration of an isolated cylinder are uncommon during the vibrations of the downstream cylinders 2 in case b cylinder 1 is located upstream of cylinders 2 and 3 and shares a similar dynamic response with an isolated cylinder the maximum rms value of the il displacement of cylinder 2 is 64 2 larger than that of the isolated cylinder two robust frequencies and combined modes are observed for the il vibration of cylinder 2 the wake of cylinder 2 leads to a large il oscillating amplitude of cylinder 3 that is twice as large as that of the isolated cylinder the il dominant mode of cylinder 3 is suppressed and the il dominant frequency is much lower a fuzzy elliptical shaped motion trajectory is observed for cylinder 3 indicating that the il dominant frequency is identical to the cf dominant frequency 3 in case c the fiv responses of two cylinders cylinders 1 and 2 located upstream of cylinder 3 show less discrepancy than those of two side by side flexible cylinders in xu et al 2018a indicating that cylinder 3 may suppress the mutual interaction of two side by side flexible cylinders the two upstream cylinders have significant influences on the downstream cylinder cylinder 3 the response amplitudes of cylinder 3 in the cf and il directions are both enlarged which is consistent with the results of the downstream elastically supported rigid cylinder ou et al 2009 wang et al 2013 the vibration of cylinder 3 in the il direction also contains two major frequency components which are closely related to the mixed modes in the il direction moreover due to the wake effects of two upstream cylinders cylinders 1 and 2 the trajectory of cylinder 3 is disordered acknowledgments this research work was finically supported by national natural science foundation of china grant nos 51679167 51525803 and 51678548 and the science fund for creative research groups of the national natural science foundation of china grant no 51621092 
