index,text
21700,an increasing number of ships are being equipped with sensors and devices for monitoring of operational behavior and the amount and access to operational data is gradually increasing due to various reasons described in this paper the operational data may contain erroneous data points that are critical to assess prior to performing data analysis or building mathematical and statistical models in this paper a stepwise method for preparation of data for ship operation and performance analysis is presented the method deals with removing jumps in the time series data including loss of time synchronization between different measurement subsystems outlier detection including repeated samples dropouts and spikes and data selection and extraction including stationarity detection the final result is a data set free from disturbances distortions and undesired physical effects that can be used to improve the quality of a ship operation and performance analysis keywords data preparation data preprocessing outlier detection synchronization steady state detection data extraction 1 introduction ship operation and performance evaluation based on real ship operational data is gradually becoming more relevant as the amount and access to operational data improves the growing amount of operational data is facilitated by an increasing number of ships being equipped with sensors and devices for monitoring the operational behavior the complexity of the systems varies from simple systems monitoring navigational variables such as position speed course and heading to more sophisticated systems monitoring fuel consumption propeller torque and or thrust propeller rpm ship motions rudder azimuth angle rotating machinery vibrations heavy consumers and even some weather parameters increasing amount and access to large data sets of ships in operation is however not equivalent to a better understanding of real ship behavior at least the researcher should be aware of the data quality but as the interest in data processing increases a more systematic view on the methods to handle the data is required over time new techniques and tools for modeling have been developed e g machine learning implementations such as deep learning which has changed and improved the capabilities of mathematical and statistical modeling however what has not changed at all being almost a law of nature is the so called gigo garbage in garbage out pyle 1999 p 23 that is the quality of a data analysis will generally reflect the quality of the input data good data preparation is therefore essential to practical modeling in the real world pyle 1999 p 24 a related and widely used term is data preprocessing 17 p 112 introduced eight steps of data preparation from the initial activity of accessing the data to the final process of building the data model the overall purpose of data preparation is to transform data sets in such a way that the information content is best exposed to the modeling tool pyle 1999 p 122 in this paper it is assumed that data is available this means that data is collected but equally important that the data is accessible to the user in terms of legal ownership data format and data connectivity it is also assumed that the model strategy is selected i e that the user has knowledge of the most suitable models to build for the ship operation and performance analysis it should however be noted that issues concerning data accessibility are not so rare experience shows that lack of standards in terms of e g type of sensor sensor quality sensor naming schemes signal meta data information ship instrumentation and interfaces data recorders data communication and data transmission highly limits the accessibility of the data lack of standards or simply just ignoring available standards during preparation for in service monitoring might become particularly challenging in a future signal interpretation and will require a more careful adaption of methods and procedures to new installations scarce documentation of sensor quality with sensor descriptions and signal meta data information may lead to the final question whether or not it will be virtually possible to prepare the data for analysis along with entire fleets gradually becoming more digitized standardization of ship instrumentation is fortunately getting more and more attention including from ship classification societies and international federations with international standards such as iso15926 iso 2011 and iso19848 iso 2018 other relevant tools that have been developed are the functional mock up interface fmi the sfi system and imos common maritime data structure cmds initiative to further improve the utilization of ship in service data and to ease the process of preparing vessels for in service monitoring as well as maintaining sensors and relevant instrumentation a continued focus towards global standards for in service monitoring should be maintained this will further encourage the objectives and ambitions related to the development of a general data preparation toolbox assuming data is collected and accessible the data preparation starts with selecting the signals that according to the selected model strategy contain the required information for the analysis in literature this is referred to as feature selection or reduction of data width that is known to have a significant contribution to the overall computational effort with a subset of features in hand it is further critical to ensure that the data quality is sufficient by identification and correction of signal distortions and disturbances going from physical ship behavior to a final data sample includes several steps and the steps can introduce various kinds of disturbances and signal distortions to the data first of all each sensor has its individual quality in terms of a range and accuracy specification that sets the premises for capturing the physical behavior and the level of sensitivity from the physical sensor or measurement device the signal enters the transducer which converts the physical measurement into an electrical signal the electrical signal is further amplified using a signal amplifier the signal then goes through an analog to digital conversion adc that samples the analog signal from the sensor and converts it to a stream of binary values the stream of binary values finally enters the data logger the transducers amplifiers adc and data logger form the components of what is referred to as the data acquisition system daq all parts of a daq can potentially introduce distortions and disturbances to the data vaseghi 2008 the most common distortions and disturbances are excessive instrumentation noise signal clipping intermittent noise spikes temporary signal dropouts power line pickup and spurious trends bendat and piersol 2010 in addition to the concern regarding the quality of each individual signal unphysical relationship between the signals may also be present this happens particularly if the analysis exploits data originating from multiple subsystems and is seen as a missing time synchronization or time delay of the signal swider and pedersen 2017 use of operational data for modeling of ship behavior has to consider to what extent all of the data all of the time is suitable for doing the intended analyses data depth or just simply the length of the time series does not have quite the same impact on computational effort as data width pyle 1999 p 120 yet more important the subset of data should reflect the relationships that the model tries to analyze in this paper depth reduction is referred to as data extraction indicating that proper time intervals of the time series data are extracted from the complete data set to form intervals of data suited for the particular analysis of interest data extraction is also known as splitting of data for a wide range of practical purposes for ship operation and performance analysis the data extraction deals with identification of stationary time intervals other special cases can be extraction of port to port trips extraction of specific operational modes engine configurations severity of weather parameters etc it has been found that data preparation generally takes approximately 80 of the total data engineering effort zhang et al 2010 and in the recent literature particularly in data mining applications there has been a more focused effort into data preparation the research emphasizes development of practical techniques and methodologies for data preparation zhang et al 2010 while literature puts effort into data preparation as a complete process in relation to general data mining approaches there is limited literature on the details of preparing ship monitoring data for analysis a review of recent literature shows that petersen 2011 summarized some of the most important aspects of the data preparation process for mining of ship operation data with a short presentation of asynchronously sampled data missing values and outliers and feature extraction for further improvements the authors suggested to study the feature extraction process as well as the data extraction process considering window size relative to the application the selected models and features in more detail hansen 2011 presented an overview of the required steps from data acquisition to statistical analysis of ship performance including discussion of sampling rate stationarity time synchronization and spike removal the descriptions of sampling rate stationarity and time synchronization were of a more general type regarding spike detection a more detailed discussion was given with instructions of two methods to detect spikes in monitored ship data a considerable amount of material related to fault detection and fault tolerant systems has been published by the control community for ships particularly related to control of general ship components engine propulsion system rudder etc a fault tolerant system is characterized by inherent fault detection procedures that initiate necessary decisions in order to prevent a further propagation of their effects blanke et al 2015 a virtual example of fault detection developed for shipboard monitoring and decision support systems was presented by lajic and nielsen 2009 nielsen et al 2012 summarized important findings on fault tolerant monitoring and decision support systems by using a frequency domain model to detect faults in ship motion variables used in sea state estimation rong et al 2020 developed a method for probabilistic characterization of ship trajectories along a given route that enabled real time ship trajectory anomaly detection fault detection in a control perspective is generally solved under real time constraints considering past information up to the current time instant during analysis of historical data e g in a ship performance analysis one has the advantage of rather using sets of time series data which enables delayless filtering of the sensor data swider 2018 introduced the concept of data preprocessing in relation to analysis of power systems onboard ships using monitored data a thorough introduction to the most common sources of distortions was given as well as mathematical descriptions of methods for investigating data quality and relation between signals for data cleaning the concept of digital filtering was presented but no instructions or practical examples of spike removal removal of repeated values or zero dropping were given methods for time synchronization were presented and further elaborated in swider and pedersen 2017 in this paper we present a stepwise method for preparation of onboard monitored operational and navigational data for ship operation and performance analysis the work is motivated by the increased activity in the use of operational data combined with a missing general procedure for preparing the data for analysis along with detailed instructions for implementation of the methods the present literature describes some of the available methods for data preparation however it has been found that the descriptions of the methods are incomplete and often exclude explicit guidelines on how the methods should be implemented in addition the important discussion considering more of a physical interpretation of the methods as well as how methodical input parameters relate to the data is usually ignored using a combination of methods from different sources poses additional challenges with regard to the order in which the methods should be implemented it is also likely that the methods will be overlapping or even worse that some parts of the preparation will be incomplete the main contribution of this paper is therefore to unify the most physical interpretable methods for data preparation in a stepwise procedure that is easy to implement that considers in which order the methods should be applied and which assures that the data is compatible between all the relevant steps the methods for data preparation that are presented are not only applicable for ships exclusively but more or less required for all kinds of operational analysis of real world data domain knowledge is however beneficial due to better assessment of data quality and for better control of the input to the data analysis 2 preparing data for analysis the concept of data preparation contains all steps to prepare and preprocess the operational data for its particular analysis that is selecting features for analysis combining data quality assessment with data quality improvement that removes erroneous data regions and running procedures for data extraction the aim is to prepare a final data set free from disturbances distortions and undesired physical effects that improves the quality of the final results of a ship operation and performance analysis a laborious quality assessment of input data will generally repay itself in terms of higher quality in the ship operation and performance analysis and form a basis for building mathematical and statistical models with higher precision the description of data preparation is structured according to an order that is recommended by the authors for the best result of data preparation it is recommended to follow this order during implementation of the methods the first stage is to select all relevant features this is followed by identification of missing data and loss of time synchronization for the selected features after missing or unsynchronized data are identified the still intact time series intervals are further prepared by identifying and removing erroneous data referred to as outlier detection finally a suitable practice of data extraction is applied 2 1 feature selection the first stage in data preparation is to select the features that comprise all information required for doing the intended analyses forming the total set of features f 1 f 2 f f features are the various measurement data that can be extracted from the monitoring system for instance motion measurements propeller rpm wind speed rudder angle etc by selecting particular features the data analyst determines which data that should be presented to the model pyle 1999 feature selection is however not to be misinterpreted as feature extraction whose intention is to map the useful information content into a lower dimensional feature space meyer bäse and schmid 2014 a thorough check of the available signals is advised as to ensure that all the required information for further use is included yet limited to the amount of information that actually will be used in order to reduce complexity and following computational effort a list of available signals including details of the variables and their units should preferably be at hand however experience shows that such a systematic overview is generally missing and that the documentation of the measurements can be rather insufficient in that case the configuration file in the data logger can be informative with respect to descriptions of the signals care should always be taken regarding the origin of measurement its unit and whether the signal is measured or calculated it is during the stage of feature selection that misinterpretations of measurements are identified and it is recommended to put effort into this stage 2 2 time vector jumps and synchronization a ship typically has a variety of subsystems onboard depending on size complexity primary purpose and usage etc this can for example be systems for energy production propulsion control fire alarm main engines cranes heating ventilation and air conditioning hvac navigation cargo etc when designing and setting up ship monitoring systems an important design perspective is how to set up and fetch data from all the sensors installed on the ship this applies to everything from routing of signals to the sampling rates and internal filters of the measurement variables when available a general approach is to fetch data from the main control unit of each system in the system control unit multiple signals are assembled together and the unit may have ports and options for data export in other cases data has to be collected directly from each individual sensor for ship operation and performance monitoring the systems and sensors must communicate with a server that samples and stores the data unfortunately in various situations delays server latency or other interruptions may occur that prevents the data samples to be logged in accordance with the system configuration other incidents can cause conflicts in the communication channels between the server and the measurement devices if there is an interruption in the data stream to the data logger the result can be an inconsistent time series of operational data in the data set this is typically revealed as temporary delays or dropouts giving nonuniform spacing of data in time referred to as time vector jumps for the individual signal it is important to identify such jumps in the data prior to applying filters making time averages and analyzing the frequency content of the signal when combining several measurement variables for a ship operation and performance analysis loss of time synchronization between the variables can also be a problem this happens mainly if the data acquisition is separated into different modules or systems and or if various filter frequencies are applied before the data arrives at the data logger loss of time synchronization might also happen if a signal having a gps based time stamp i e coordinated universal time utc is to be merged with a signal getting its time stamp from the onboard daq this is particularly a concern if the ship experiences shifts in time zones for which the relative difference between two time vectors might change it is generally recommended to avoid local time stamps for all kinds of in service monitoring and data processing and rather use a fixed reference time stamp such as the unix timestamp in this way it is made explicit to the data analyst that the time reference is absolute and that no further considerations regarding shift in time zones are necessary if the time stamp however is given by e g the daq in a local time format it is recommended to transform the time vector to unix time prior to any further processing of the data complementary information regarding time zone should preferably be used for the transformation if not available the time zone can be established from gps positional data in the data set the various losses of time synchronization show as corrupted correlations and unphysical relationships between the measured variables which is further critical for the building of robust mathematical and statistical models time vector jumps can be identified as outliers in the first order differenced series of the time vector if the time vector t t 1 t 2 t n consists of n discrete timestamps the first order differenced series t is found as 1 t t i t i 1 t 2 t 1 t 3 t 2 t n t n 1 i 2 n where t has a length of n 1 the standard deviation σ t of t is expressed in eq 3 if a tolerance of k number of standard deviations from the ideal uniformly spaced time vector is accepted the criteria for which an unintended jump in the time vector takes place between time index i and time index i 1 can be mathematically expressed as 2 t i 1 f s k σ t where f s is the sampling frequency in the daq 3 σ t 1 n 2 i 1 n 1 t i t 2 in fig 1 an example of time vector jump identification is presented using k 1 the time vector used in the example originates from the dynamic positioning dp system which is responsible for collecting signals from the global positioning system gps gyro wind sensor and the motion reference unit mru ten situations of time vector jumps larger than σ t are identified in this example as illustrated in fig 1 for the ease of implementation the tolerance of t relative to a time vector with uniform sampling may also be set as a constant number a general suggestion is to use half of the intended sampling interval as the fixed tolerance e g such that k σ t 1 2 f s when time vector jumps are identified the corresponding time t i at which the jump takes place is saved to a matrix j regardless of whether the time vector leaves or enters a normal state with regular time data new time vector jumps are appended to this matrix as they are identified and the identification continues for all the measurement subsystems containing signals of interest when the complete set of time vectors from all included subsystems are checked for jumps the elements of j r m 1 are sorted in ascending order j is finally used to construct time intervals free from time vector jumps in all the signals by looping through the elements of j the time intervals free from time vector jumps are saved to a matrix q r q 2 where q is the number of intervals see eq 4 each interval has a starting t 1 and ending t 2 time instant by defining a minimum duration t min that all time intervals should meet a rejection of time intervals shorter than t min can be included in the loop 4 q t 1 1 t 2 1 t 1 2 t 2 2 t 1 3 t 2 3 t 1 i q t 2 i q after all time intervals are free from time vector jumps the synchronization of the subsystems should be checked synchronization of subsystems means that all signals are mapped to a joint time reference and that the time reference represents the actual time of each physical event prior to the synchronization it should be known whether the recorded timestamps in the data represent the time of the actual measurement or if they represent the time when the measurement arrives the data logger in both cases the time vector of each subsystem can be used to synchronize the data however in measurement setups where the timestamps represent the arrival of the measurement to the data logger a thorough investigation of signal and system delays should be carried out low pass filter frequencies applied to the digital signal is also important to consider since they induce a delay going from multiple time vectors representative for each measurement subsystem to a joint time reference representative for the complete set of data implies a selection of the most representative time reference the following section presents a time reference selection technique for selecting the subsystem that best represents the complete set of systems first the summed difference between the time reference arrays t s i and t s j of two subsystems s i and s j are calculated for all m subsystems each sum is organized in a matrix see fig 2 the total time difference between subsystem j and i 1 m is found by adding up all elements in each column forming the column sum for subsystem j denoted cs j shown in eq 5 the column sum cs j is further weighted to a weighted column sum wcs j by the number of applied signals in the subsystem relative to the total number of applied signals in all subsystems represented by a count function as in eq 6 this step is to avoid excessive amount of interpolation in the data the next step is to select the most representative time reference for all signals as the subsystem with lowest weighted sum of time differences this time reference is finally used to establish a modified joint time reference t ˆ that has uniform spacing in time i e has a constant sampling interval t s this is an important step with reference to an upcoming frequency analysis or digital filtering in the ship performance analysis 5 cs j i 1 m t s j t s i 6 wcs j cs j c o u n t s j i 1 m c o u n t s i the modified joint time reference is established from a first time instant t s t a r t followed by adding the constant sampling interval t s to the previous time instant up to the last time instant before a time vector jump takes place this is repeated for each time interval i 1 q between the time vector jumps as given by q in eq 4 the uniform sampling interval t s should preferably be the same sampling interval as is configured in the daq the first time instant in each interval t s t a r t i needs a careful selection to avoid excessive amount of interpolation in the data in short this means that the final time reference should seek maximum overlap with its parent time vector this can be done by identifying a time shift δ t i that minimizes the squared difference s i between the original time vector and the modified time vector for the jump free interval i the minimization problem is 7 s i k 1 t k i t ˆ k i δ t i 2 8 s i δ t i 0 which gives 9 δ t i 1 p i k 1 p i t k i t 1 i k 1 t s 10 t s t a r t i t 1 i δ t i where p i is the length of the jump free time vector i that runs from t 1 i to t 2 i as given in eq 4 the first time instant t s t a r t i of the modified time vector for the jump free interval i is then given as in eq 10 and the corresponding modified time vector is found as 11 t ˆ i t s t a r t i t s t a r t i t s t s t a r t i 2 t s t s t a r t i n t s n n is the number of elements in t ˆ i and should satisfy eq 12 this is to ensure that the elements of t ˆ i is within the jump free interval between t 1 i and t 2 i by resampling all the data free from time vector jumps to this modified joint time reference the data set will be completely synchronized with a minimum amount of computational effort and the introduction of interpolation errors is minimized 12 n t 2 i t s t a r t i t s swider 2018 described the available methods for data resampling as resampling using low pass filters fir comb filter integrating cic lagrange interpolation spline function and resampling in frequency domain due to the optimized selection of the modified time vector t ˆ a recommended practice for the data resampling is to simply use linear interpolation or a low order spline interpolation due to various reasons there are situations where a time vector can be distorted or even unavailable which means that signal synchronization by use of time vectors is not feasible in order to synchronize the subsystems without the use of time vectors it is either required that some variables are measured by more than one subsystem or that some variables can be combined to establish new complementary variables which enables use of the cross correlation function to check for system delays in fig 3 a time series example that shows poor synchronization of two subsystems is given the example shows the rotational speed of the propeller shaft of a ship in of maximum measured by two different subsystems by visual inspection a distinct time delay between the signals is found swider and pedersen 2017 presented a synchronization method that identifies time delays by maximizing the cross correlation function r x y between two signals x and y the signals should measure the same physical property but should be handled by two different subsystems a straightforward implementation of this method identifies the average time delay for the input signals swider and pedersen 2017 reported that the delay can change over time for example due to gaps in the data logger and recommended a split of data into smaller time windows for which the time delay is estimated the approach of splitting signals into smaller time windows to account for time varying delays is however not necessary when following the time vector jump identification technique presented in this paper by first identifying the time vector jumps the complete data set is naturally divided into continuous time intervals where synchronization by the use of the average time delay is suitable 2 3 outlier detection outlier detection is used to detect and where appropriate remove anomalous samples from data hodge and austin 2004 an outlier can briefly be described as a data point that is not based on a true physical value other commonly used notions are spikes or drop outs but the main concept is that the values depart from the main modes of variability of the majority of the data gervini 2012 hereby when referring to outliers the term covers all data points that most probably are unphysical this includes spikes repeated values and drop outs where drop outs appear as zero a certain sensor dependent value or nan examples of spikes drop outs and repeated values are shown in a time series of wind anemometer data in fig 4 including detailed inset plots that illustrate the nature of outliers identified by visual inspection for this particular signal the events of drop outs and repeated values take place at the same time and last for approximately ten seconds some of the drop outs appear as zeros other as a certain but non persistent negative value similarly as for the drop outs the spikes can appear interchangeably with repeated values as for example identified in the inset plot corresponding to data around time index 6200 into the time series in other situations the spikes behave very different such as shown in fig 5 where spikes in the propeller rpm data measured on the propeller shaft are identified in this case the spike value more or less remains persistent for a short period of time until the signal starts decreasing towards a value similar to what was the case prior to the spike incident this behavior is probably caused by signal clipping yet experience shows that the maximum value is not necessarily consistent and certainly not across various measurements this complicates the identification of such spike data in fig 5 the inset plot is given to show the true variability of the propeller rpm that is concealed by the scaling of the y axis due to the various behavior of outliers there are unfortunately no such thing as a universal outlier detector various approaches have their pros and cons depending on the data structure dimensionality parameter distribution etc as a coarse classification hodge and austin 2004 separated the fundamentals of outlier detection based on the amount of prior knowledge of data normality and abnormality from outlier detection without any prior knowledge of the data outlier detection having knowledge of normality of the data to outlier detection having knowledge of both normality and abnormality for most ship operation and navigational data knowledge of data normality is generally available as the sensor installations measure predefined physical properties through systems usually having known system configurations with relevance for onboard ship performance and navigation monitoring systems perera 2016 developed a fault detection method considering normality of data through linearization of ship performance and navigation conditions by the use of principal component analysis pca the method assumed single gaussian type distributions only as most performance and navigational data generally are not of single gaussian type the method depends on an appropriate pre clustering of the performance and navigational data detecting outliers without any prior knowledge of the data is less robust than incorporating either or both normality and abnormality without information of the normal state the abnormal data can be hard to separate from the normal data particularly in data sets having a considerable amount of outliers one simple way of including information of data normality is by using physical laws and specific domain knowledge of the feature being measured based on such domain experience the maximum and minimum values a process variable can take can be set from which outliers can be identified such outliers are usually referred to as obvious outliers qin 1997 yet there are several types of outliers that obey the physical limits of the measurement variable spikes repeated values and drop outs might be present within the physical constraints of a variable but still represent unphysical measurements spikes are recognized as data points representing sudden changes relative to the previous data points in stationary conditions sudden changes are more or less straightforward to identify in more time varying conditions such as during heavy weather ship maneuvering acceleration and deceleration course change etc the spikes can be more troublesome to identify amongst all the data points representing physical variations outlier detection should however work under both stationary and non stationary conditions to overcome the complexity of various types of outliers found in a wide range of signals the method for outlier detection is separated into blocks that are specialized towards identifying a particular nature of outliers first of all this simplifies use of domain knowledge for including information on abnormality as various types of outliers can be identified separately secondly this simplifies adaption to alternative domains and new use of the methods in each block the identified outliers are added to an array o f j individually for each of the selected features f 1 f 2 f f this is for assembling the complete set of outliers for each feature variable as to prepare for an upcoming outlier replacement the blocks are presented in the succeeding sections outlier replacement is described subsequently 2 3 1 block 1 obvious outliers the first block runs a detection of outliers based on physical constraints that is by simply setting a minimum and a maximum value for each measurement variable the minimum and maximum values should be based on knowledge of the sensor and the physical process being measured sensor knowledge deals with the operating range of the sensor for example the maximum torque a shaft torque sensor can measure physical knowledge deals with the possible values a source of measurement can generate for example the maximum rpm of the engine naturally the engine rpm cannot possibly take negative values which means that the minimum value for the engine rpm should be zero the minimum and maximum values for each feature f j are set to allow for the full range of possible values to avoid introducing additional signal clipping it is recommended to set the minimum and maximum values slightly lower and higher than the actual sensor physical limits the time index to the data points that exceed the maximum and minimum limits are saved to o f j 2 3 2 block 2 repeated values the second block runs a check for repeated values remark that this is relevant for continuous variables only which rules out measurements that either have been rounded off to a very few number of digits or measurements that are pre filtered using e g a median filter continuous variables can take all values meaning that a certain value repeating itself might indicate a problem with either the sensor or the daq for that reason there is doubt whether or not these particular measurements relate to physical behavior repeated values are identified using the first differenced series of each feature for each synchronized time interval given as the row element i of matrix q in eq 4 the first differenced series y f j i of the feature values y f j i y 1 y 2 y 3 y n f j of feature f j is found as 13 y f j i y f j i k y f j i k 1 k 2 t 2 i t 1 i 1 the time index k to all repeated values for feature f j are found by searching for y f j i 0 when repeated values are identified the time index is added to o f j note that because repeated values are identified from the differenced series each time index added to o f j must be increased by 1 before they are added to the outlier array experience has shown that repeated values might as well occur interchangeably with drop outs or spikes examples of this is found in the inset plots in fig 4 where a certain value repeats itself immediately after a spike or drop out to identify such behavior the first differenced series however now with time lag 2 is found for each synchronized time interval the series is referred to as y f j i k 2 and is expressed in eq 14 the time index k to all repeated values for feature f j are found by searching for y f j i k 2 0 when repeated values are identified the time index is added to o f j similar as for time lag 1 each time index added to o f j must be increased by 1 before they are added to the outlier array 14 y f j i k 2 y f j i k y f j i k 2 k 3 t 2 i t 1 i 1 2 3 3 block 3 drop outs signal drop outs appear as zero a certain sensor dependent value or nan values they can be identified by simply searching for a match between the feature values and 0 or nan presence of certain sensor dependent values are not straightforward to identify as they are individual for the particular feature however sensor dependent values taking place subsequently will nevertheless be identified in block 2 similar as for the other outlier detection blocks the time indices to all drop outs should be added to o f j when searching for zeros one should be aware of the nature of the particular feature if zero is a likely physical value marking zeros as outliers should be avoided 2 3 4 block 4 spikes spikes are seen as sudden changes towards values either far outside the entirety of the feature data set or values that significantly deviate from the rest of the data points in a similar context with respect to time series data a similar context generally refers to samples taking place in a temporal proximity detection of spikes should work under both stationary and non stationary conditions hansen 2011 presented use of two methods for detecting spikes in data collected by the ship performance monitoring system onboard a postpanamax container vessel the first method was a spike detection rule based on evaluating the running mean and the running standard deviation in a defined time frame to compare a sample with previous and future values similar methods are straightforward to implement and mostly effective but yet best suited for stationary conditions the second method presented by hansen 2011 was the cusum cumulative sum test that incorporates a statistical framework into spike detection the cusum test is generally effective in stationary conditions however experience with ship monitoring data has indicated some challenges with detection of false positives the suggested approach for spike detection working in both stationary and non stationary conditions is by using digital filters this was also recommended by swider 2018 in most cases the linear filters are applicable such as low pass and band pass filters in other cases nonlinear filters are more suitable such as the median filter detecting outliers using digital filters is similar to comparing sample values with a running mean and standard deviation however the running mean is replaced by a proper low pass filtered version of the signal the standard deviation σ y see eq 15 is evaluated from the frequency content above the low pass cutoff frequency that is from the difference between the base signal y and the filtered signal f y expressed as y in eq 16 the standard deviation σ y is used to form a spike detection envelope around f y for which exterior samples are marked as outliers the width of this envelope controls the spike detection sensitivity further control is given to the spike detection by using some constant m representing the number of standard deviations from f y the samples are allowed to vary in total this forms a spike detection as mathematically expressed in eq 17 an example of wind speed data with an envelope of 5 σ y m 5 is shown in fig 7 the example is extracted from the same wind speed data shown in fig 4 and a low pass cutoff frequency of 0 1 hz is used for the filtered signal f y 15 σ y 1 n i 1 n y i y 2 16 y y f y 17 y m σ y the cutoff frequency and the envelope constant m control the spike detection by lowering the cutoff frequency more of the higher frequency variations are potentially identified as spikes the standard deviation σ y will however naturally increase when the cutoff frequency is lowered causing an increased signal envelope and by that allowing larger variations relative to f y the envelope constant m has a direct influence on the spike detection in terms of adjusting the accepted distance from f y the signal is allowed to vary a general recommendation is to set m 3 8 more specifically m 5 is usually sufficient for each feature variable the cutoff frequency should be set relative to the expected frequencies of known system dynamics a general recommendation is to set the cutoff frequency slightly below the highest frequency of known dynamics note however that the sampling frequency and hence the nyquist frequency limits the highest frequency that can be observed in the data to construct an example a ship sailing at 10 knots in head sea waves with mean wave period of 10 s will get a frequency of encounter around 0 13 hz the encountering waves will cause the most high frequent physical system dynamics in terms of vessel surging if the daq samples speed over ground at a frequency f s 2 0 13 hz the surging can be observed in the data by following our recommendations for spike detection the cutoff frequency for low pass filtering should be set slightly below the highest frequency representing physical behavior a cutoff around 0 10 hz is therefore convenient to illustrate how this relates to the ship monitoring data an example of sog data and low pass filtered sog data with an envelope of 5 σ y m 5 is shown in fig 6 the filter noticeably removes the high frequency oscillations while the envelope outlines the variability caused by vessel surging by using a spike detection rule as expressed in eq 17 the envelope will effectively identify spikes as for example can be seen around time index 6290 in fig 6 a second example of outlier detection is shown in fig 7 based on wind speed measurements fluctuations in a wind field are typically of a more low frequency type compared to waves with periods reported to range from a couple of minutes up to several hours in the north sea vincent et al 2011 as wind and waves usually occur together there might be some variability in the wind speed measurements originating from vessel surging in situations where this is most prominent the vessel surging is however usually negligible compared to the wind speeds so the filtering may rather consider the typical frequencies in the wind field itself assuming fluctuations with periods down to three minutes the cutoff frequency can be set around 5 0e 3 hz as shown in fig 7 this noticeably removes the high frequency oscillations while the envelope using m 5 outlines the more frequent variability yet the envelope will effectively work as a spike identifier as for example can be seen around time index 2500 filters require uniform sampled data above all there should be no jumps in the time vector data it is therefore essential to both run the check for time vector jumps and perform the time synchronization before initiating the block of spike detection 2 3 5 outlier replacement as much as identification of outliers is an important topic in data preparation it is just as important to consider how to deal with the outliers for each feature f j outliers are identified and saved to o f j because detection of outliers are separated into blocks duplicates of outliers may be indexed and added to the outlier arrays as a first step of dealing with the outliers unique indices should be identified and extracted from o f j as well as sorted in ascending order the unique and sorted indices are written to the modified outlier array o ˆ f j outliers may come as individual occurrences and or in clusters of consecutive values pyle 1999 p 322 this is the reason for adding feature specific outliers to an array during outlier detection rather than performing a direct outlier replacement as it gives more control of the outliers o ˆ f j are used to separate between individual outliers and clusters of consecutive outliers for which data rejection may seem more reasonable than data replacement extracting the clusters of consecutive outliers follows a similar strategy as for time vector jumps by identifying when the first differenced series of o ˆ f j by consistent notation given as o f j exceeds a certain limit because the features have been synchronized using an equally spaced time vector with interval t s this limit is nothing else than equal to t s using mathematical notation all individual outliers or clusters of outliers are separated into outlier intervals by searching for o f j t s the end of the outlier interval t 2 i is the time instant in o f j for the index in o f j at which o f j t s is satisfied the start of the next outlier interval t 1 i 1 is then the subsequent time instant in o f j the time indices of the starting point t 1 i and the end t 2 i of each outlier interval i are saved to the two column matrix w as shown in eq 18 18 w t 1 1 t 2 1 t 1 2 t 2 2 t 1 3 t 2 3 t 1 i w t 2 i w for individual occurrences of outliers or even for small clusters of outliers a simple and effective outlier replacement seems the most reasonable for longer clusters of consecutive outliers it might be more reasonable to reject rather than to replace the data the decision between outlier replacement and rejection should be based on a maximum allowed number of consecutive outliers that in combination with w decides which outlier intervals should be rejected and which outlier intervals should be replaced the maximum number of consecutive outliers that seem reasonable to replace depends on the application of the data using the original resolution of data should limit the accepted number of consecutive outliers compared to using windows of data for which features such as mean and standard deviation are extracted the outlier replacement values should not introduce a pattern into the data that is not actually present the simplest form of outlier replacement is by using linear interpolation between two adjacent data points next quadratic cubic or spline interpolation there should however be reasons to expect a nonlinear variation between consecutive samples before using a higher order interpolation method than linear interpolation an even more sophisticated approach for outlier replacement is by using a digital filter for which the pattern and variation in the data can be preserved up to a certain frequency for individual outliers a simple linear interpolation is however generally sufficient for consecutive outliers yet up to the maximum limit a low pass digital filter is recommended for outlier replacement outlier replacement through either interpolation or by using a digital filter have to consider time vector jumps outliers should be replaced considering the adjacent measurements only not by approximations running across a jump in time filtering or interpolating across jumps in time can possibly introduce non existing patterns to the data it is therefore highly recommended to use the time intervals free from time vector jumps given by q in eq 4 to construct the data basis for interpolation or digital filtering the replacement values are generated from information that is already present in other measurements and regardless of replacement method the estimated values are somewhat smoothed to preserve some of the variability noise can be added to the replacement values in that case the noise should be based on the existing variability e g by sampling from a gaussian distribution with zero mean and standard deviation equal to the upfront standard deviation of the measurement variable for a ship operation and performance analysis adding noise to the outlier replacement is however generally not important as data will be averaged over a certain window 2 4 data validation data validation is a term that may refer to the general process of checking data quality similar to data preparation with the aim of detecting faulty measurements to finally arrive at a reliable data set in this paper data validation refers to the more stand alone process of checking whether the measurements are reasonable data integrity is another term often used in computer science however this is somewhat more related to the integrity in storage like file system consistency accessibility of data and avoiding corrupted files sivathanu et al 2005 data free from outliers time vector jumps and with complete time synchronization may appear as good quality data during an individual examination however seen in relation to other measurement sources the data may be unphysical for example a ship at service speed having zero rotational speed of the propeller or a propeller having maximum rotational speed while the engine is standby there are various reasons for the mismatch between signals such as mis calibrated sensors error in routing of signals sensor drift various signal disturbances and other hardware or software related malfunctions data validation is the final data preparation step to ensure that such unphysical data is rejected as input to the ship performance analysis in cases where historical measurement data is available and it is reasonable to believe that this data can be trusted new measurements can be validated against regression models that are based on similar data in other cases where no such prior reference to a proper and reliable signal behavior is at hand there are generally two ways to perform data validation that are relevant for ship monitoring data the most straightforward way is a direct validation between sensors measuring the same property a ship may have largely dependent on ship class coexistent subsystems such as multiple gps units compasses motion reference units mru and wind sensors for which data validity can be checked by directly comparing the similarity of the data a second way to perform data validation is by connecting measurements through various combinations both linear and non linear to establish new variables from which time series similarity can be evaluated that is using physical knowledge and domain knowledge in particular to calculate properties that additionally are measured by dedicated sensors in the absence of such dedicated sensors data validation may even be performed between two calculated properties for ships in particular there are numerous possible variable connections and some examples are listed in table 1 the approach to data validation goes through a similarity measure referred to as d with a complimentary subscript a number of strategies for time series similarity measures exist from absolute similarity e g singular vector decomposition canonical correlation analysis regression and correlation analysis to relative similarity measures such as distance measures e g euclidean distance correlation measures e g correlation coefficient or principal component analysis pca fourier transform and metric based measures lhermitte et al 2011 the strategies have gained focus within domains such as pattern recognition climatology and oceanography serving as decision criterion in several time series clustering and classification techniques each having their strengths and weaknesses as further discussed in lhermitte et al 2011 in data preparation the aim is to validate the various data sources rather than performing a precise pattern recognition so a simple strategy for similarity estimation can be accepted when measurements are either coexistent or combined to express the same physical property a perfect time series similarity should have a linear correlation coefficient d c c equal to one this means that both strength and direction of the linear relationship between the two variables are intact d c c is however a measure of the linear relationship and does not evaluate the direct difference in time series values which means that it is unable to reveal amplitude scaling or amplitude translation therefore the difference in or preferably the ratio between the arithmetic average of each corresponding time series should include as a complementary similarity measure this ratio between averages is referred to as d r a and is mathematically expressed in eq 19 amplitude scaling may be caused by e g improper placement of a sensor or by energy pickup in sensor wiring while amplitude translation may be a typical result of improper sensor calibration in eq 19 subscript 1 and 2 of y represent feature 1 and 2 for which the ratio of arithmetic average is found superscript i represent the time vector interval index as given in eq 4 19 d r a y 1 i y 2 i t t 1 i t 2 i y 1 t t t 1 i t 2 i y 2 t if either the linear correlation coefficient or the ratio between the average levels is far from unity the time series are considered not being similar this generally indicates that at least one of the measurement sources is not suited for data analysis or mathematical modeling the appropriate actions to take will depend on certain conditions in situations where more than two coexistent sensors are available each one of them can be validated against the others if this results in a certain measurement source standing out in terms of low data similarity relative to the other coexistent sensors the particular measurement should me ignored similar strategy can be used in cases where multiple combined measurements are available if however the available coexistent or combined measurement sources limits to two this kind of strategy is not feasible the data validity procedure should then rather evaluate which measurement that seems the most reasonable a simple way of considering reasonableness is to check for obvious errors for example to check if either of the two measurements have no variation if no obvious errors can be identified the suggested approach is to construct a new variable that is the average of the two measurements in practice there might be situations where special attention should be given either d c c or d r a if the data analysis depends on the mean value of a signal rather than instantaneous values similarity expressed through d r a should be given more emphasis over d c c this is e g the case when analyzing ship performance as the impact from individual waves on ship speed and propulsion power should be filtered using time averaging if the data analysis rather depends on variability such as standard deviation or a frequency analysis d c c should be given more emphasis over d r a a relevant type of analysis is e g analysis of vessel motions for shipboard sea state estimation which recently has gained interest in the literature nielsen 2017 interpretation of far from unity is case specific so whether a similarity should be accepted or not depends on the monitoring system and each individual sensor the use of data validation through d c c and d r a may therefore be considered more informative rather than conclusive with respect to d c c there might be need for filtering the data before checking the correlation between measurements the sensor noise typically varies among a collection of sensors and this has a direct influence on d c c in a wide range of data analyses the high frequency content such as sensor noise is in any case irrelevant for the result hence it is not necessarily critical that two coexistent or combined measurements correlate in the sense of a complete frequency resolution if high frequency content rather should be disregarded low pass filtered versions of the measurements should be used for calculating d c c however note that identical cutoff frequency must be used for the low pass filtered measurements entering the calculation of the correlation coefficient the validity of a measurement should preferably not be evaluated directly for the complete data set as a signal disturbance may come and go or a sensor may perform a self calibration the data can be valid in parts of the data set it is therefore recommended to do the data validation in batches of data e g corresponding to the time intervals free from time vector jumps as given in matrix q see eq 4 the time intervals free from time vector jumps are even ready for filtering as each interval is associated with a regularly spaced time vector 2 5 data extraction depending on the planned type of data analysis there are various reasons for extracting parts of the data set data extraction is also known as splitting of data or data clustering the general reason for doing data extraction is that inference of monitored data should consider the conditions during data acquisition as this basically forms the assumptions for interpreting the data this is particularly important when building data based mathematical models as it helps choosing the proper modeling tools and methods and to ensure that limitations and assumptions in the methods are fully met examples of data extraction methods can be port to port trips which can be used for analyzing performance of weather routing services fuel consumption and optimal speed in transit extraction of specific operational modes which can be used for assessment of power system design swider 2018 detailed analysis of maneuvers or other special cases of operations as for example dynamic positioning dp extraction of data for which a particular thruster configuration is operative as for example a thruster running with constant rotational speed rpm or constant power or a propeller running with constant blade pitch in a wide range of data analyses a general requirement is that the data is sampled under stationary conditions that is there are no transient behavior in the data and inference can be made based on a single realization if statistical parameters are estimated under the assumption of stationarity while some non stationary behavior is present it is likely that the parameter estimates will be biased for a ship there are a number of ways that stationarity can be interpreted stationarity in ship speed thrust admission ship course ship motions and weather conditions to mention some of them as the motivation behind data extraction is to get control of the input data to the various types of analyses the choice of method to extract data should be selected thereafter a combination of methods might also be the most reasonable choice for data extraction in most practical applications assessment of stationarity in the data is required at least to some extent stationarity is also probably the most tricky requirement when it comes to data extraction with respect to analysis of ship performance the quality of the analysis is among other factors inversely connected to the amount of transient behavior in the data a primitive but fast and interpretable consideration is to study ship performance under a port to port trip that is analyzing consumed power or consumed fuel relative to the forward speed without including low speed maneuvering a further improvement of this analysis is to filter out voluntary changes of operational control variables during the transit such as forward thrust caused by changes in propeller rpm or ship heading caused by azimuth or rudder control for the purpose of preparing data for a ship performance analysis the following sections present two methods of data extraction the first section presents a simple method to extract data acquired during transit between two ports a so called trip identifier the subsequent section presents a computationally efficient method to extract stationary parts of the in service measurement data based on the work presented in dalheim and steen 2020 2 5 1 port to port trips many ships operate on a more or less scheduled route when it comes to which ports and destinations they are serving this typically gives a circular pattern to the anchoring which in combination with a geospatial mapping tool can be used to identify port departure and arrival if no geospatial mapping tool is available the time of arrival and departure can be identified using geofences or virtual perimeters of a geographical area around the relevant destinations in combination with the geographical position of the ship a geofence can notify the point in time when leaving and entering a destination from which data can labeled as a trip there are however many ships that have more flexible schedules which makes use of geofencing more cumbersome less precise and by that less relevant a more general procedure is therefore to identify trips by using the measured ship speed during a trip the ship will usually enter transit mode when low speed maneuvering is completed and similarly end its transit when initiating low speed maneuvering the start of a trip in transit mode can therefore be identified when the ship speed exceeds a certain limit and correspondingly end when the speed goes below this limit the speed limit should to some extent be set depending on ship type size and the area of operation but a forward speed of 4 knots is found to be useful exceptions are for ships typically operating at low speed for example trawlers for which it is necessary to combine the forward speed with measurements of the force in the trawl or by using propeller rpm for identification instead of ship speed 2 5 2 stationary data identification of stationary parts of in service measurement data is a more complex type of data extraction yet an essential type of data extraction with respect to performing a ship performance analysis of high quality it concerns splitting of data into time intervals for which one can assume that certain physical properties are free from transient behavior in statistics the strongest form of stationarity is referred to as s t r o n g s t r i c t or c o m p l e t e stationarity a weaker form of a stationarity is referred to as n th order w e a k l y stationary for which all joint moments up to order n exist and are time invariant box and jenkins 1976 p 8 time series analysis often consider second order weakly stationarity which means that a time series has constant mean and variance for many practical applications though the requirements are even less strict and the condition of s t e a d y s t a t e is rather used steady state refers to a condition where the process has a constant mean and does not require the associated noise and disturbances to be stationary steady state parts of time series data are formed by identifying time points at which certain properties of the time series data change this is referred to as change point detection dalheim and steen 2020 developed a change point detector based on hypothesis testing of the process value inside a moving window the basic assumption was that the underlying process could be modeled by a deterministic linear trend model as expressed in eq 20 in the equation a t refers to a zero mean white noise process with constant variance σ a 2 b 0 represents the intercept of the linear model and b 1 t the linear deterministic drift component formed by the slope b 1 and the relative time t within the moving window starting from t 0 for all windows under the assumption of independent normal innovations a t the null hypothesis that the process signal is stationary about the window sample intercept b 0 can be tested using a two tailed t test on b ˆ 1 based on the t value in eq 21 the estimate of the linear slope b ˆ 1 is found by ordinary least squares estimation the actual interpretation of what i s significant needs to be considered for the particular application of the steady state detector in general it concerns identifying the critical variables for what we aim to study using steady state models a thorough interpretation of steady state relevant for a number of ship monitoring data analyses can be found in dalheim and steen 2020 the present work limits to identifying data sampled under a constant command of the ship more specifically the identification of time intervals at which the propeller rotational speed rpm and the propeller pitch angle are kept constant which is required for the most common types of ship performance modeling 20 z t b 0 b 1 t a t 21 t 1 b ˆ 1 σ ˆ b 1 the steady state detector has two parameters that must be set the significance level α and the window length n the significance level controls the accepted slope in the window by representing the probability of rejecting a zero slope b 1 0 when a zero slope in fact is true i e the probability of conducting a type i error if steady state in a process value is critical for the application of the time series data the steady state detection must ensure a low probability of incorrectly accepting a zero slope this will increase the reliability in the steady state data but might at the same time cause a rejection of large parts of the data set which is unfavorable for data completeness similarly the less critical variables should accept a higher slope in the data window which means accepting a higher probability of conducting a type ii error the second parameter the window length is the number of samples used to form the moving window this is essential in the consideration of which effects to remove from the data a long window is e g well suited for detecting non stationarity in slow processes like sensor drift causing the sensor value to accumulate with time a long window is however not suited for detecting unsteady behavior with short duration in general the window length should exceed the autocorrelation persistence of known system dynamics that are acceptable even for a condition of steady state but yet short enough to detect undesirable changes of short duration 2 6 overview of data preparation the suggested procedures for preparing ship monitoring data for a ship operation and performance analysis have been presented the entire process of data preparation from initially possessing roughly raw historical time series data to the completion of a fully utilizable and functional data set ready to analyze has been split into minor basic parts as a means to offer excellent overview control and simple customization the data preparation steps are summarized in the flow diagram given in fig 8 3 results the data preparation tools have been developed and evaluated using two separate sets of times series data each of them corresponding to one complete year of data 365 days the data is sampled at 1 hz by the in service monitoring systems installed on two ships a platform supply vessel psv and a general cargo multipurpose vessel mpv both designed by kongsberg maritime as the psv is mainly serving offshore platforms in the north sea it has an overall length of almost 100 m beam and max draft of 20 m and 7 m respectively and a dead weight of about 5000 dwt the vessel is equipped with diesel electric machinery and azimuthing propulsion system consisting of twin azipull type azp100cp the typical service speed of the vessel is about 10 12 knots the mpv is mainly carrying cargo along the norwegian coast it has an overall length of almost 120 m beam and max draft of 20 m and 5 m respectively and a dead weight of about 5000 dwt the vessel is purely run on liquefied natural gas lng and is fitted with a hybrid shaft generator rudder and a single screw controllable pitch propeller the typical service speed of the vessel is about 15 knots the in service monitoring system installed on each of the vessels collect sensor data from selected vessel equipment the data acquisition is divided into different systems that provides measurement data to the data logger the data logger on each vessel is configured to sample at a frequency of 1 hz the data logger further provides time stamps to the incoming data which means that each system based collection of measurement data gets its own time stamp the data is stored on a server running on the ship and data transfer to shore is performed on a regular basis the following sections evaluate the methods developed for data preparation of ship in service data with regard to a ship operation and performance analysis the evaluation of the methods is structured according to the recommended practice given in section 2 3 1 feature selection each of the two case vessels has more than 100 sensors installed from which measurement data can be extracted for a ship operation and performance analysis there is a certain but limited set of measurement variables that is required for doing a proper analysis in table 2 a short list of features selected for doing a ship operation and performance analysis is given the first column indicates from which system the measurements are acquired from the second column of the table presents descriptive names of the variables that are measured 3 2 time vector jumps and synchronization evaluation of time vector jump identification is carried out by summing up the total number of time intervals free from time vector jumps as well as the total number of samples that is removed due to jump identification in the evaluation the tolerance of t relative to a time vector with uniform sampling is set as half of the intended sampling interval t s 1 s e g such that k σ t 0 5 s with reference to eq 2 to avoid unnecessary short time intervals a minimum duration of 60 s is set for the intervals free from time vector jumps for the psv the one year data set has to be split into 31 time intervals in order to avoid time vector jumps in terms of amount of data this means that 5 6 of the data has to be removed corresponding to 494 h of data for the mpv the one year data set has to be split into 541 time intervals in order to avoid time vector jumps even though time vector jumps occur more frequently for the mpv the jumps are generally shorter in length in terms of amount of data only 1 0 of the data has to be removed corresponding to 86 h of data the established intervals free from time vector jumps are suited for checking the time synchronization because all jumps are removed maximization of the cross correlation function can be used directly to identify the average time delay between signals 3 3 outlier detection outlier detection is evaluated by summing up the total number of outliers identified in each of the two one year data sets results are given in table 3 and table 4 for the psv and the mpv respectively the amount of data identified as outliers relative to the total amount of data is given in the rightmost columns in the tables for the psv the amount of outliers in the data is generally below 1 except for the longitude position of the vessel for which outliers constitutes 1 02 of the one year data set similar amounts of outliers are detected for the mpv i e mostly less than 1 the propeller shaft thrust measurement however reveals a large amount of outliers amounting to nearly 20 of the data set the main cause of this is found to be drop outs to negative values where each drop out has a significant time persistence next the rudder angle measurement has a considerable amount of outliers with nearly 8 of the data set identified as outliers similar as for the thrust measurement the outliers are mainly drop outs to either a large or to a small rudder angle with significant time persistence during the recent outlier detection no limit for the maximum number of consecutive outliers that decides upon data replacement or data rejection was set the quantities listed in tables 3 and 4 are hence referring to the amount of data that should either be replaced or rejected for further use 3 4 data validation to demonstrate and evaluate the method for data validation two examples of time series data showing poor data similarity in terms of either the linear correlation coefficient d c c or the ratio between averages d r a are shown the corresponding similarity measures are given in table 5 for each of the two examples the first example fig 9 shows the wind speed measured by two coexistent wind anemometers onboard the psv the value of d r a indicates that the two coexistent measurements are not equal in terms of their mean value d r a 78 in addition d c c indicates a linear correlation below unity d c c 92 considering the time series data in fig 9 the reduced linear correlation is apparently caused by a stronger drop in wind speed measured by sensor 1 compared to sensor 2 about halfway into the time series the second example fig 10 shows the roll angle measured by two coexistent mrus onboard the psv the value of d r a indicates that the two coexistent measurements are far from equal in terms of their mean value d r a 330 the linear correlation is however very close to unity d c c 98 this behavior is also evident in the figure showing that the two coexistent measurements follow each other however at two different mean levels 3 5 data extraction evaluation of data extraction is carried out by presenting various examples of time series intervals formed by applying the data extraction methods as presented in section 2 5 first a simple port to port trip identification is shown for each of the two case vessels then examples of steady state identification are shown using various data from the two case vessels 3 5 1 port to port trips an example of trip identification using speed over ground measured on the psv is shown in fig 11 the speed limit is set to 4 knots the identified trip has a duration of approximately 8 5 h and consists mainly of transit operation at service speed of 12 14 knots in fig 12 a similar trip identification for the mpv is shown the identified trip has a duration of approximately 19 5 h and consists mainly of transit operation at service speed of 13 15 knots in both cases the time series data before and after the identified trip is found to be mainly low speed maneuvering of short duration trip identification based on speed over ground measurements is a very primitive tool to extract data of transit operation yet it is straightforward to implement and gives a fast and robust splitting of the data into trips 3 5 2 stationary data data extraction based on identification of steady state time intervals has been tested and evaluated using time series data from the psv fig 13 presents three examples of steady state identification on ship control variables that are critical for a ship performance analysis i e the propeller rpm the propeller pitch and the ship heading the time series data of the propeller rpm and the propeller pitch are extracted from the same time interval this interval takes place in between two time vector jumps and lasts for about 100 min the ship heading data is extracted from a separate time interval lasting for about 210 min the reason for presenting a separate time interval is simply because the ship heading was constant throughout the time interval used for the propeller rpm and pitch the color in the figures indicates the local state identification with green color representing the time intervals where the particular variable probably is at steady state the three measurement variables are all checked for steady state using a significance level α 1 but with individually selected window lengths for the propeller rpm measurement a window of 5 min n 300 is used evaluating the result presented in fig 13 a shows that the method successfully rejects the two parts of the time series that by visual inspection clearly is not at steady state more specifically the rpm drop and rebuild between time 18 and 32 min and between time 40 and 46 min into the time series the propeller pitch angle is checked for steady state using a window of 30 s n 30 the short window length is set because changes in propeller pitch angle generally occur more frequently and are of shorter duration compared to the propeller rpm the result is presented in fig 13 b showing how the propeller pitch angle measured in of maximum pitch angle is reduced and increased between time 18 and 48 min into the time series the steady state detection rejects most parts of this data however due to the small window there are even some short time intervals in between that are accepted as steady state e g between time 22 and 27 min the third example of steady state identification considers the ship heading using α 1 and a window of 20 min n 1200 the long window is set because a change in ship heading generally is a slow process expected to occur infrequently during a traditional transit operation the result is shown in fig 13 c and agrees well with visual inspection short intervals of apparently steady state data have been rejected due to non sufficient length compared to the window size the small but distinct changes in heading are successfully rejected as steady state for example as shown between time 30 and 50 min 3 6 data preparation for ship performance analysis the presented data preparation tools are evaluated with respect to a ship performance analysis of a platform supply vessel psv and a general cargo multipurpose vessel mpv the result of a thorough data preparation is high quality data fully customized for the particular type of analysis high quality means that errors distortions and unphysical relationships are omitted as input to the data analysis fully customized means that only data relevant for the particular analysis is extracted from the data set to evaluate the final result of the data preparation tools applied on ship monitoring data a ship performance evaluation in terms of a speed power analysis is given for each of the two case vessels except from the data preparation no additional corrections are made to the speed and propulsion power data a plot of the propulsion power vs the forward speed is descriptive in that it presents the variation in consumed power relative to the variation in speed the plot is particularly descriptive for the ship performance if shown together with the calm water speed power relation as it provides a more precise impression of both the amount of operational data not matching the expected calm water relation as well as how far the operational data deviates from the expected calm water relation fig 14 shows the speed power data from the one year data set of the psv along with curves for the calm water speed power relation at three different vessel draughts the blue colored markers represent data prior to application of the data preparation tools corresponding to 30 537 481 samples note however that data exceeding the physical constraints of either the propulsion power or the forward speed are left out as the most extreme values explode the dimensions of the axes making the majority of data unreadable for the psv the amount of data exceeding the physical constraints and therefore not shown in the figure amounts to approximately 150 000 samples corresponding to 32 h of operation the speed power plot illustrates that the data preparation tools removes unphysical data as well as data that is likely to originate from unsteady behavior it shows that the prepared data becomes more fitted to the calm water curves as a lower baseline and that the data for which the forward speed of the vessel is low while the propulsion power is high is removed from the prepared data set out of the one year data set from the psv 59 7 of the data was removed during data preparation in combination with port to port trips data extraction while 73 3 of the data was removed during data preparation in combination with steady state identification of propulsion power propeller pitch angle and ship heading similarly as for the psv the speed power data from the one year data set of the mpv is shown in fig 15 the blue colored markers represent data prior to application of the data preparation tools corresponding to 31 234 048 samples for this vessel the amount of data exceeding the physical constraints of either the propulsion power or the ship speed corresponds to approximately 1 h of operation the speed power plot from the mpv data illustrates the performance of the data preparation tools very well the prepared data fits nicely to the calm water curves as a lower baseline and the majority of the data showing a combination of low forward speed and high propulsion power is removed from the prepared data set out of the one year data set from the mpv 70 0 of the data was removed during data preparation in combination with port to port trips data extraction while 80 8 of the data was removed during data preparation in combination with steady state identification of propeller rpm propeller pitch angle and ship heading the most prominent difference between the two speed power plots based on the psv and the mpv ship monitoring data sets is the lower left region of the scattered data representing low forward speed and medium propulsion power for the psv a major part of this data persists in the prepared data set for the mpv most of this data is removed in the prepared data set this difference can be explained by domain knowledge and logical reasoning the psv operates in a more exposed wave and wind environment compared to the mpv which means that a larger speed loss is expected to take place the psv also has a more unfavorable ship length to wave length ratio which also affects the speed loss the mpv is therefore expected to have less amount of data in the low forward speed medium propulsion power region corresponding to large speed loss compared to the psv 4 conclusion a stepwise recommended practice for preparation of in service measurement data for ship operation and performance analysis has been presented and evaluated the presented methods for preparation of in service measurement data have been demonstrated and shown to be efficient tools for obtaining high quality in service data it is shown how the data preparation improves a ship performance analysis by presenting a speed propulsion power relation for two case vessels having different vessel designs it is generally recommended to follow this procedure for data preparation concerning most kinds of time series data from continuous monitoring of physical processes however it is still encouraged to use specific domain knowledge during the implementation this is particularly relevant during data extraction both in terms of selecting variables and in setting the necessary parameters for steady state identification by following this practice more focus can be given to the actual data analysis compared to the data preparation still preserving that only high quality data is used as input to the data analysis credit authorship contribution statement øyvind øksnes dalheim conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization sverre steen conceptualization supervision writing review editing funding acquisition project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research presented in this paper was carried out in the kongsberg maritime university technology centre at the norwegian university of science and technology in trondheim it was partly financed directly by kongsberg maritime through the grant to the university technology centre and partly by the project innocurrent which is financed by the the research council of norway grant number 282385 and kongsberg maritime the authors gratefully acknowledge kongsberg maritime for providing the full scale data used in the research 
21700,an increasing number of ships are being equipped with sensors and devices for monitoring of operational behavior and the amount and access to operational data is gradually increasing due to various reasons described in this paper the operational data may contain erroneous data points that are critical to assess prior to performing data analysis or building mathematical and statistical models in this paper a stepwise method for preparation of data for ship operation and performance analysis is presented the method deals with removing jumps in the time series data including loss of time synchronization between different measurement subsystems outlier detection including repeated samples dropouts and spikes and data selection and extraction including stationarity detection the final result is a data set free from disturbances distortions and undesired physical effects that can be used to improve the quality of a ship operation and performance analysis keywords data preparation data preprocessing outlier detection synchronization steady state detection data extraction 1 introduction ship operation and performance evaluation based on real ship operational data is gradually becoming more relevant as the amount and access to operational data improves the growing amount of operational data is facilitated by an increasing number of ships being equipped with sensors and devices for monitoring the operational behavior the complexity of the systems varies from simple systems monitoring navigational variables such as position speed course and heading to more sophisticated systems monitoring fuel consumption propeller torque and or thrust propeller rpm ship motions rudder azimuth angle rotating machinery vibrations heavy consumers and even some weather parameters increasing amount and access to large data sets of ships in operation is however not equivalent to a better understanding of real ship behavior at least the researcher should be aware of the data quality but as the interest in data processing increases a more systematic view on the methods to handle the data is required over time new techniques and tools for modeling have been developed e g machine learning implementations such as deep learning which has changed and improved the capabilities of mathematical and statistical modeling however what has not changed at all being almost a law of nature is the so called gigo garbage in garbage out pyle 1999 p 23 that is the quality of a data analysis will generally reflect the quality of the input data good data preparation is therefore essential to practical modeling in the real world pyle 1999 p 24 a related and widely used term is data preprocessing 17 p 112 introduced eight steps of data preparation from the initial activity of accessing the data to the final process of building the data model the overall purpose of data preparation is to transform data sets in such a way that the information content is best exposed to the modeling tool pyle 1999 p 122 in this paper it is assumed that data is available this means that data is collected but equally important that the data is accessible to the user in terms of legal ownership data format and data connectivity it is also assumed that the model strategy is selected i e that the user has knowledge of the most suitable models to build for the ship operation and performance analysis it should however be noted that issues concerning data accessibility are not so rare experience shows that lack of standards in terms of e g type of sensor sensor quality sensor naming schemes signal meta data information ship instrumentation and interfaces data recorders data communication and data transmission highly limits the accessibility of the data lack of standards or simply just ignoring available standards during preparation for in service monitoring might become particularly challenging in a future signal interpretation and will require a more careful adaption of methods and procedures to new installations scarce documentation of sensor quality with sensor descriptions and signal meta data information may lead to the final question whether or not it will be virtually possible to prepare the data for analysis along with entire fleets gradually becoming more digitized standardization of ship instrumentation is fortunately getting more and more attention including from ship classification societies and international federations with international standards such as iso15926 iso 2011 and iso19848 iso 2018 other relevant tools that have been developed are the functional mock up interface fmi the sfi system and imos common maritime data structure cmds initiative to further improve the utilization of ship in service data and to ease the process of preparing vessels for in service monitoring as well as maintaining sensors and relevant instrumentation a continued focus towards global standards for in service monitoring should be maintained this will further encourage the objectives and ambitions related to the development of a general data preparation toolbox assuming data is collected and accessible the data preparation starts with selecting the signals that according to the selected model strategy contain the required information for the analysis in literature this is referred to as feature selection or reduction of data width that is known to have a significant contribution to the overall computational effort with a subset of features in hand it is further critical to ensure that the data quality is sufficient by identification and correction of signal distortions and disturbances going from physical ship behavior to a final data sample includes several steps and the steps can introduce various kinds of disturbances and signal distortions to the data first of all each sensor has its individual quality in terms of a range and accuracy specification that sets the premises for capturing the physical behavior and the level of sensitivity from the physical sensor or measurement device the signal enters the transducer which converts the physical measurement into an electrical signal the electrical signal is further amplified using a signal amplifier the signal then goes through an analog to digital conversion adc that samples the analog signal from the sensor and converts it to a stream of binary values the stream of binary values finally enters the data logger the transducers amplifiers adc and data logger form the components of what is referred to as the data acquisition system daq all parts of a daq can potentially introduce distortions and disturbances to the data vaseghi 2008 the most common distortions and disturbances are excessive instrumentation noise signal clipping intermittent noise spikes temporary signal dropouts power line pickup and spurious trends bendat and piersol 2010 in addition to the concern regarding the quality of each individual signal unphysical relationship between the signals may also be present this happens particularly if the analysis exploits data originating from multiple subsystems and is seen as a missing time synchronization or time delay of the signal swider and pedersen 2017 use of operational data for modeling of ship behavior has to consider to what extent all of the data all of the time is suitable for doing the intended analyses data depth or just simply the length of the time series does not have quite the same impact on computational effort as data width pyle 1999 p 120 yet more important the subset of data should reflect the relationships that the model tries to analyze in this paper depth reduction is referred to as data extraction indicating that proper time intervals of the time series data are extracted from the complete data set to form intervals of data suited for the particular analysis of interest data extraction is also known as splitting of data for a wide range of practical purposes for ship operation and performance analysis the data extraction deals with identification of stationary time intervals other special cases can be extraction of port to port trips extraction of specific operational modes engine configurations severity of weather parameters etc it has been found that data preparation generally takes approximately 80 of the total data engineering effort zhang et al 2010 and in the recent literature particularly in data mining applications there has been a more focused effort into data preparation the research emphasizes development of practical techniques and methodologies for data preparation zhang et al 2010 while literature puts effort into data preparation as a complete process in relation to general data mining approaches there is limited literature on the details of preparing ship monitoring data for analysis a review of recent literature shows that petersen 2011 summarized some of the most important aspects of the data preparation process for mining of ship operation data with a short presentation of asynchronously sampled data missing values and outliers and feature extraction for further improvements the authors suggested to study the feature extraction process as well as the data extraction process considering window size relative to the application the selected models and features in more detail hansen 2011 presented an overview of the required steps from data acquisition to statistical analysis of ship performance including discussion of sampling rate stationarity time synchronization and spike removal the descriptions of sampling rate stationarity and time synchronization were of a more general type regarding spike detection a more detailed discussion was given with instructions of two methods to detect spikes in monitored ship data a considerable amount of material related to fault detection and fault tolerant systems has been published by the control community for ships particularly related to control of general ship components engine propulsion system rudder etc a fault tolerant system is characterized by inherent fault detection procedures that initiate necessary decisions in order to prevent a further propagation of their effects blanke et al 2015 a virtual example of fault detection developed for shipboard monitoring and decision support systems was presented by lajic and nielsen 2009 nielsen et al 2012 summarized important findings on fault tolerant monitoring and decision support systems by using a frequency domain model to detect faults in ship motion variables used in sea state estimation rong et al 2020 developed a method for probabilistic characterization of ship trajectories along a given route that enabled real time ship trajectory anomaly detection fault detection in a control perspective is generally solved under real time constraints considering past information up to the current time instant during analysis of historical data e g in a ship performance analysis one has the advantage of rather using sets of time series data which enables delayless filtering of the sensor data swider 2018 introduced the concept of data preprocessing in relation to analysis of power systems onboard ships using monitored data a thorough introduction to the most common sources of distortions was given as well as mathematical descriptions of methods for investigating data quality and relation between signals for data cleaning the concept of digital filtering was presented but no instructions or practical examples of spike removal removal of repeated values or zero dropping were given methods for time synchronization were presented and further elaborated in swider and pedersen 2017 in this paper we present a stepwise method for preparation of onboard monitored operational and navigational data for ship operation and performance analysis the work is motivated by the increased activity in the use of operational data combined with a missing general procedure for preparing the data for analysis along with detailed instructions for implementation of the methods the present literature describes some of the available methods for data preparation however it has been found that the descriptions of the methods are incomplete and often exclude explicit guidelines on how the methods should be implemented in addition the important discussion considering more of a physical interpretation of the methods as well as how methodical input parameters relate to the data is usually ignored using a combination of methods from different sources poses additional challenges with regard to the order in which the methods should be implemented it is also likely that the methods will be overlapping or even worse that some parts of the preparation will be incomplete the main contribution of this paper is therefore to unify the most physical interpretable methods for data preparation in a stepwise procedure that is easy to implement that considers in which order the methods should be applied and which assures that the data is compatible between all the relevant steps the methods for data preparation that are presented are not only applicable for ships exclusively but more or less required for all kinds of operational analysis of real world data domain knowledge is however beneficial due to better assessment of data quality and for better control of the input to the data analysis 2 preparing data for analysis the concept of data preparation contains all steps to prepare and preprocess the operational data for its particular analysis that is selecting features for analysis combining data quality assessment with data quality improvement that removes erroneous data regions and running procedures for data extraction the aim is to prepare a final data set free from disturbances distortions and undesired physical effects that improves the quality of the final results of a ship operation and performance analysis a laborious quality assessment of input data will generally repay itself in terms of higher quality in the ship operation and performance analysis and form a basis for building mathematical and statistical models with higher precision the description of data preparation is structured according to an order that is recommended by the authors for the best result of data preparation it is recommended to follow this order during implementation of the methods the first stage is to select all relevant features this is followed by identification of missing data and loss of time synchronization for the selected features after missing or unsynchronized data are identified the still intact time series intervals are further prepared by identifying and removing erroneous data referred to as outlier detection finally a suitable practice of data extraction is applied 2 1 feature selection the first stage in data preparation is to select the features that comprise all information required for doing the intended analyses forming the total set of features f 1 f 2 f f features are the various measurement data that can be extracted from the monitoring system for instance motion measurements propeller rpm wind speed rudder angle etc by selecting particular features the data analyst determines which data that should be presented to the model pyle 1999 feature selection is however not to be misinterpreted as feature extraction whose intention is to map the useful information content into a lower dimensional feature space meyer bäse and schmid 2014 a thorough check of the available signals is advised as to ensure that all the required information for further use is included yet limited to the amount of information that actually will be used in order to reduce complexity and following computational effort a list of available signals including details of the variables and their units should preferably be at hand however experience shows that such a systematic overview is generally missing and that the documentation of the measurements can be rather insufficient in that case the configuration file in the data logger can be informative with respect to descriptions of the signals care should always be taken regarding the origin of measurement its unit and whether the signal is measured or calculated it is during the stage of feature selection that misinterpretations of measurements are identified and it is recommended to put effort into this stage 2 2 time vector jumps and synchronization a ship typically has a variety of subsystems onboard depending on size complexity primary purpose and usage etc this can for example be systems for energy production propulsion control fire alarm main engines cranes heating ventilation and air conditioning hvac navigation cargo etc when designing and setting up ship monitoring systems an important design perspective is how to set up and fetch data from all the sensors installed on the ship this applies to everything from routing of signals to the sampling rates and internal filters of the measurement variables when available a general approach is to fetch data from the main control unit of each system in the system control unit multiple signals are assembled together and the unit may have ports and options for data export in other cases data has to be collected directly from each individual sensor for ship operation and performance monitoring the systems and sensors must communicate with a server that samples and stores the data unfortunately in various situations delays server latency or other interruptions may occur that prevents the data samples to be logged in accordance with the system configuration other incidents can cause conflicts in the communication channels between the server and the measurement devices if there is an interruption in the data stream to the data logger the result can be an inconsistent time series of operational data in the data set this is typically revealed as temporary delays or dropouts giving nonuniform spacing of data in time referred to as time vector jumps for the individual signal it is important to identify such jumps in the data prior to applying filters making time averages and analyzing the frequency content of the signal when combining several measurement variables for a ship operation and performance analysis loss of time synchronization between the variables can also be a problem this happens mainly if the data acquisition is separated into different modules or systems and or if various filter frequencies are applied before the data arrives at the data logger loss of time synchronization might also happen if a signal having a gps based time stamp i e coordinated universal time utc is to be merged with a signal getting its time stamp from the onboard daq this is particularly a concern if the ship experiences shifts in time zones for which the relative difference between two time vectors might change it is generally recommended to avoid local time stamps for all kinds of in service monitoring and data processing and rather use a fixed reference time stamp such as the unix timestamp in this way it is made explicit to the data analyst that the time reference is absolute and that no further considerations regarding shift in time zones are necessary if the time stamp however is given by e g the daq in a local time format it is recommended to transform the time vector to unix time prior to any further processing of the data complementary information regarding time zone should preferably be used for the transformation if not available the time zone can be established from gps positional data in the data set the various losses of time synchronization show as corrupted correlations and unphysical relationships between the measured variables which is further critical for the building of robust mathematical and statistical models time vector jumps can be identified as outliers in the first order differenced series of the time vector if the time vector t t 1 t 2 t n consists of n discrete timestamps the first order differenced series t is found as 1 t t i t i 1 t 2 t 1 t 3 t 2 t n t n 1 i 2 n where t has a length of n 1 the standard deviation σ t of t is expressed in eq 3 if a tolerance of k number of standard deviations from the ideal uniformly spaced time vector is accepted the criteria for which an unintended jump in the time vector takes place between time index i and time index i 1 can be mathematically expressed as 2 t i 1 f s k σ t where f s is the sampling frequency in the daq 3 σ t 1 n 2 i 1 n 1 t i t 2 in fig 1 an example of time vector jump identification is presented using k 1 the time vector used in the example originates from the dynamic positioning dp system which is responsible for collecting signals from the global positioning system gps gyro wind sensor and the motion reference unit mru ten situations of time vector jumps larger than σ t are identified in this example as illustrated in fig 1 for the ease of implementation the tolerance of t relative to a time vector with uniform sampling may also be set as a constant number a general suggestion is to use half of the intended sampling interval as the fixed tolerance e g such that k σ t 1 2 f s when time vector jumps are identified the corresponding time t i at which the jump takes place is saved to a matrix j regardless of whether the time vector leaves or enters a normal state with regular time data new time vector jumps are appended to this matrix as they are identified and the identification continues for all the measurement subsystems containing signals of interest when the complete set of time vectors from all included subsystems are checked for jumps the elements of j r m 1 are sorted in ascending order j is finally used to construct time intervals free from time vector jumps in all the signals by looping through the elements of j the time intervals free from time vector jumps are saved to a matrix q r q 2 where q is the number of intervals see eq 4 each interval has a starting t 1 and ending t 2 time instant by defining a minimum duration t min that all time intervals should meet a rejection of time intervals shorter than t min can be included in the loop 4 q t 1 1 t 2 1 t 1 2 t 2 2 t 1 3 t 2 3 t 1 i q t 2 i q after all time intervals are free from time vector jumps the synchronization of the subsystems should be checked synchronization of subsystems means that all signals are mapped to a joint time reference and that the time reference represents the actual time of each physical event prior to the synchronization it should be known whether the recorded timestamps in the data represent the time of the actual measurement or if they represent the time when the measurement arrives the data logger in both cases the time vector of each subsystem can be used to synchronize the data however in measurement setups where the timestamps represent the arrival of the measurement to the data logger a thorough investigation of signal and system delays should be carried out low pass filter frequencies applied to the digital signal is also important to consider since they induce a delay going from multiple time vectors representative for each measurement subsystem to a joint time reference representative for the complete set of data implies a selection of the most representative time reference the following section presents a time reference selection technique for selecting the subsystem that best represents the complete set of systems first the summed difference between the time reference arrays t s i and t s j of two subsystems s i and s j are calculated for all m subsystems each sum is organized in a matrix see fig 2 the total time difference between subsystem j and i 1 m is found by adding up all elements in each column forming the column sum for subsystem j denoted cs j shown in eq 5 the column sum cs j is further weighted to a weighted column sum wcs j by the number of applied signals in the subsystem relative to the total number of applied signals in all subsystems represented by a count function as in eq 6 this step is to avoid excessive amount of interpolation in the data the next step is to select the most representative time reference for all signals as the subsystem with lowest weighted sum of time differences this time reference is finally used to establish a modified joint time reference t ˆ that has uniform spacing in time i e has a constant sampling interval t s this is an important step with reference to an upcoming frequency analysis or digital filtering in the ship performance analysis 5 cs j i 1 m t s j t s i 6 wcs j cs j c o u n t s j i 1 m c o u n t s i the modified joint time reference is established from a first time instant t s t a r t followed by adding the constant sampling interval t s to the previous time instant up to the last time instant before a time vector jump takes place this is repeated for each time interval i 1 q between the time vector jumps as given by q in eq 4 the uniform sampling interval t s should preferably be the same sampling interval as is configured in the daq the first time instant in each interval t s t a r t i needs a careful selection to avoid excessive amount of interpolation in the data in short this means that the final time reference should seek maximum overlap with its parent time vector this can be done by identifying a time shift δ t i that minimizes the squared difference s i between the original time vector and the modified time vector for the jump free interval i the minimization problem is 7 s i k 1 t k i t ˆ k i δ t i 2 8 s i δ t i 0 which gives 9 δ t i 1 p i k 1 p i t k i t 1 i k 1 t s 10 t s t a r t i t 1 i δ t i where p i is the length of the jump free time vector i that runs from t 1 i to t 2 i as given in eq 4 the first time instant t s t a r t i of the modified time vector for the jump free interval i is then given as in eq 10 and the corresponding modified time vector is found as 11 t ˆ i t s t a r t i t s t a r t i t s t s t a r t i 2 t s t s t a r t i n t s n n is the number of elements in t ˆ i and should satisfy eq 12 this is to ensure that the elements of t ˆ i is within the jump free interval between t 1 i and t 2 i by resampling all the data free from time vector jumps to this modified joint time reference the data set will be completely synchronized with a minimum amount of computational effort and the introduction of interpolation errors is minimized 12 n t 2 i t s t a r t i t s swider 2018 described the available methods for data resampling as resampling using low pass filters fir comb filter integrating cic lagrange interpolation spline function and resampling in frequency domain due to the optimized selection of the modified time vector t ˆ a recommended practice for the data resampling is to simply use linear interpolation or a low order spline interpolation due to various reasons there are situations where a time vector can be distorted or even unavailable which means that signal synchronization by use of time vectors is not feasible in order to synchronize the subsystems without the use of time vectors it is either required that some variables are measured by more than one subsystem or that some variables can be combined to establish new complementary variables which enables use of the cross correlation function to check for system delays in fig 3 a time series example that shows poor synchronization of two subsystems is given the example shows the rotational speed of the propeller shaft of a ship in of maximum measured by two different subsystems by visual inspection a distinct time delay between the signals is found swider and pedersen 2017 presented a synchronization method that identifies time delays by maximizing the cross correlation function r x y between two signals x and y the signals should measure the same physical property but should be handled by two different subsystems a straightforward implementation of this method identifies the average time delay for the input signals swider and pedersen 2017 reported that the delay can change over time for example due to gaps in the data logger and recommended a split of data into smaller time windows for which the time delay is estimated the approach of splitting signals into smaller time windows to account for time varying delays is however not necessary when following the time vector jump identification technique presented in this paper by first identifying the time vector jumps the complete data set is naturally divided into continuous time intervals where synchronization by the use of the average time delay is suitable 2 3 outlier detection outlier detection is used to detect and where appropriate remove anomalous samples from data hodge and austin 2004 an outlier can briefly be described as a data point that is not based on a true physical value other commonly used notions are spikes or drop outs but the main concept is that the values depart from the main modes of variability of the majority of the data gervini 2012 hereby when referring to outliers the term covers all data points that most probably are unphysical this includes spikes repeated values and drop outs where drop outs appear as zero a certain sensor dependent value or nan examples of spikes drop outs and repeated values are shown in a time series of wind anemometer data in fig 4 including detailed inset plots that illustrate the nature of outliers identified by visual inspection for this particular signal the events of drop outs and repeated values take place at the same time and last for approximately ten seconds some of the drop outs appear as zeros other as a certain but non persistent negative value similarly as for the drop outs the spikes can appear interchangeably with repeated values as for example identified in the inset plot corresponding to data around time index 6200 into the time series in other situations the spikes behave very different such as shown in fig 5 where spikes in the propeller rpm data measured on the propeller shaft are identified in this case the spike value more or less remains persistent for a short period of time until the signal starts decreasing towards a value similar to what was the case prior to the spike incident this behavior is probably caused by signal clipping yet experience shows that the maximum value is not necessarily consistent and certainly not across various measurements this complicates the identification of such spike data in fig 5 the inset plot is given to show the true variability of the propeller rpm that is concealed by the scaling of the y axis due to the various behavior of outliers there are unfortunately no such thing as a universal outlier detector various approaches have their pros and cons depending on the data structure dimensionality parameter distribution etc as a coarse classification hodge and austin 2004 separated the fundamentals of outlier detection based on the amount of prior knowledge of data normality and abnormality from outlier detection without any prior knowledge of the data outlier detection having knowledge of normality of the data to outlier detection having knowledge of both normality and abnormality for most ship operation and navigational data knowledge of data normality is generally available as the sensor installations measure predefined physical properties through systems usually having known system configurations with relevance for onboard ship performance and navigation monitoring systems perera 2016 developed a fault detection method considering normality of data through linearization of ship performance and navigation conditions by the use of principal component analysis pca the method assumed single gaussian type distributions only as most performance and navigational data generally are not of single gaussian type the method depends on an appropriate pre clustering of the performance and navigational data detecting outliers without any prior knowledge of the data is less robust than incorporating either or both normality and abnormality without information of the normal state the abnormal data can be hard to separate from the normal data particularly in data sets having a considerable amount of outliers one simple way of including information of data normality is by using physical laws and specific domain knowledge of the feature being measured based on such domain experience the maximum and minimum values a process variable can take can be set from which outliers can be identified such outliers are usually referred to as obvious outliers qin 1997 yet there are several types of outliers that obey the physical limits of the measurement variable spikes repeated values and drop outs might be present within the physical constraints of a variable but still represent unphysical measurements spikes are recognized as data points representing sudden changes relative to the previous data points in stationary conditions sudden changes are more or less straightforward to identify in more time varying conditions such as during heavy weather ship maneuvering acceleration and deceleration course change etc the spikes can be more troublesome to identify amongst all the data points representing physical variations outlier detection should however work under both stationary and non stationary conditions to overcome the complexity of various types of outliers found in a wide range of signals the method for outlier detection is separated into blocks that are specialized towards identifying a particular nature of outliers first of all this simplifies use of domain knowledge for including information on abnormality as various types of outliers can be identified separately secondly this simplifies adaption to alternative domains and new use of the methods in each block the identified outliers are added to an array o f j individually for each of the selected features f 1 f 2 f f this is for assembling the complete set of outliers for each feature variable as to prepare for an upcoming outlier replacement the blocks are presented in the succeeding sections outlier replacement is described subsequently 2 3 1 block 1 obvious outliers the first block runs a detection of outliers based on physical constraints that is by simply setting a minimum and a maximum value for each measurement variable the minimum and maximum values should be based on knowledge of the sensor and the physical process being measured sensor knowledge deals with the operating range of the sensor for example the maximum torque a shaft torque sensor can measure physical knowledge deals with the possible values a source of measurement can generate for example the maximum rpm of the engine naturally the engine rpm cannot possibly take negative values which means that the minimum value for the engine rpm should be zero the minimum and maximum values for each feature f j are set to allow for the full range of possible values to avoid introducing additional signal clipping it is recommended to set the minimum and maximum values slightly lower and higher than the actual sensor physical limits the time index to the data points that exceed the maximum and minimum limits are saved to o f j 2 3 2 block 2 repeated values the second block runs a check for repeated values remark that this is relevant for continuous variables only which rules out measurements that either have been rounded off to a very few number of digits or measurements that are pre filtered using e g a median filter continuous variables can take all values meaning that a certain value repeating itself might indicate a problem with either the sensor or the daq for that reason there is doubt whether or not these particular measurements relate to physical behavior repeated values are identified using the first differenced series of each feature for each synchronized time interval given as the row element i of matrix q in eq 4 the first differenced series y f j i of the feature values y f j i y 1 y 2 y 3 y n f j of feature f j is found as 13 y f j i y f j i k y f j i k 1 k 2 t 2 i t 1 i 1 the time index k to all repeated values for feature f j are found by searching for y f j i 0 when repeated values are identified the time index is added to o f j note that because repeated values are identified from the differenced series each time index added to o f j must be increased by 1 before they are added to the outlier array experience has shown that repeated values might as well occur interchangeably with drop outs or spikes examples of this is found in the inset plots in fig 4 where a certain value repeats itself immediately after a spike or drop out to identify such behavior the first differenced series however now with time lag 2 is found for each synchronized time interval the series is referred to as y f j i k 2 and is expressed in eq 14 the time index k to all repeated values for feature f j are found by searching for y f j i k 2 0 when repeated values are identified the time index is added to o f j similar as for time lag 1 each time index added to o f j must be increased by 1 before they are added to the outlier array 14 y f j i k 2 y f j i k y f j i k 2 k 3 t 2 i t 1 i 1 2 3 3 block 3 drop outs signal drop outs appear as zero a certain sensor dependent value or nan values they can be identified by simply searching for a match between the feature values and 0 or nan presence of certain sensor dependent values are not straightforward to identify as they are individual for the particular feature however sensor dependent values taking place subsequently will nevertheless be identified in block 2 similar as for the other outlier detection blocks the time indices to all drop outs should be added to o f j when searching for zeros one should be aware of the nature of the particular feature if zero is a likely physical value marking zeros as outliers should be avoided 2 3 4 block 4 spikes spikes are seen as sudden changes towards values either far outside the entirety of the feature data set or values that significantly deviate from the rest of the data points in a similar context with respect to time series data a similar context generally refers to samples taking place in a temporal proximity detection of spikes should work under both stationary and non stationary conditions hansen 2011 presented use of two methods for detecting spikes in data collected by the ship performance monitoring system onboard a postpanamax container vessel the first method was a spike detection rule based on evaluating the running mean and the running standard deviation in a defined time frame to compare a sample with previous and future values similar methods are straightforward to implement and mostly effective but yet best suited for stationary conditions the second method presented by hansen 2011 was the cusum cumulative sum test that incorporates a statistical framework into spike detection the cusum test is generally effective in stationary conditions however experience with ship monitoring data has indicated some challenges with detection of false positives the suggested approach for spike detection working in both stationary and non stationary conditions is by using digital filters this was also recommended by swider 2018 in most cases the linear filters are applicable such as low pass and band pass filters in other cases nonlinear filters are more suitable such as the median filter detecting outliers using digital filters is similar to comparing sample values with a running mean and standard deviation however the running mean is replaced by a proper low pass filtered version of the signal the standard deviation σ y see eq 15 is evaluated from the frequency content above the low pass cutoff frequency that is from the difference between the base signal y and the filtered signal f y expressed as y in eq 16 the standard deviation σ y is used to form a spike detection envelope around f y for which exterior samples are marked as outliers the width of this envelope controls the spike detection sensitivity further control is given to the spike detection by using some constant m representing the number of standard deviations from f y the samples are allowed to vary in total this forms a spike detection as mathematically expressed in eq 17 an example of wind speed data with an envelope of 5 σ y m 5 is shown in fig 7 the example is extracted from the same wind speed data shown in fig 4 and a low pass cutoff frequency of 0 1 hz is used for the filtered signal f y 15 σ y 1 n i 1 n y i y 2 16 y y f y 17 y m σ y the cutoff frequency and the envelope constant m control the spike detection by lowering the cutoff frequency more of the higher frequency variations are potentially identified as spikes the standard deviation σ y will however naturally increase when the cutoff frequency is lowered causing an increased signal envelope and by that allowing larger variations relative to f y the envelope constant m has a direct influence on the spike detection in terms of adjusting the accepted distance from f y the signal is allowed to vary a general recommendation is to set m 3 8 more specifically m 5 is usually sufficient for each feature variable the cutoff frequency should be set relative to the expected frequencies of known system dynamics a general recommendation is to set the cutoff frequency slightly below the highest frequency of known dynamics note however that the sampling frequency and hence the nyquist frequency limits the highest frequency that can be observed in the data to construct an example a ship sailing at 10 knots in head sea waves with mean wave period of 10 s will get a frequency of encounter around 0 13 hz the encountering waves will cause the most high frequent physical system dynamics in terms of vessel surging if the daq samples speed over ground at a frequency f s 2 0 13 hz the surging can be observed in the data by following our recommendations for spike detection the cutoff frequency for low pass filtering should be set slightly below the highest frequency representing physical behavior a cutoff around 0 10 hz is therefore convenient to illustrate how this relates to the ship monitoring data an example of sog data and low pass filtered sog data with an envelope of 5 σ y m 5 is shown in fig 6 the filter noticeably removes the high frequency oscillations while the envelope outlines the variability caused by vessel surging by using a spike detection rule as expressed in eq 17 the envelope will effectively identify spikes as for example can be seen around time index 6290 in fig 6 a second example of outlier detection is shown in fig 7 based on wind speed measurements fluctuations in a wind field are typically of a more low frequency type compared to waves with periods reported to range from a couple of minutes up to several hours in the north sea vincent et al 2011 as wind and waves usually occur together there might be some variability in the wind speed measurements originating from vessel surging in situations where this is most prominent the vessel surging is however usually negligible compared to the wind speeds so the filtering may rather consider the typical frequencies in the wind field itself assuming fluctuations with periods down to three minutes the cutoff frequency can be set around 5 0e 3 hz as shown in fig 7 this noticeably removes the high frequency oscillations while the envelope using m 5 outlines the more frequent variability yet the envelope will effectively work as a spike identifier as for example can be seen around time index 2500 filters require uniform sampled data above all there should be no jumps in the time vector data it is therefore essential to both run the check for time vector jumps and perform the time synchronization before initiating the block of spike detection 2 3 5 outlier replacement as much as identification of outliers is an important topic in data preparation it is just as important to consider how to deal with the outliers for each feature f j outliers are identified and saved to o f j because detection of outliers are separated into blocks duplicates of outliers may be indexed and added to the outlier arrays as a first step of dealing with the outliers unique indices should be identified and extracted from o f j as well as sorted in ascending order the unique and sorted indices are written to the modified outlier array o ˆ f j outliers may come as individual occurrences and or in clusters of consecutive values pyle 1999 p 322 this is the reason for adding feature specific outliers to an array during outlier detection rather than performing a direct outlier replacement as it gives more control of the outliers o ˆ f j are used to separate between individual outliers and clusters of consecutive outliers for which data rejection may seem more reasonable than data replacement extracting the clusters of consecutive outliers follows a similar strategy as for time vector jumps by identifying when the first differenced series of o ˆ f j by consistent notation given as o f j exceeds a certain limit because the features have been synchronized using an equally spaced time vector with interval t s this limit is nothing else than equal to t s using mathematical notation all individual outliers or clusters of outliers are separated into outlier intervals by searching for o f j t s the end of the outlier interval t 2 i is the time instant in o f j for the index in o f j at which o f j t s is satisfied the start of the next outlier interval t 1 i 1 is then the subsequent time instant in o f j the time indices of the starting point t 1 i and the end t 2 i of each outlier interval i are saved to the two column matrix w as shown in eq 18 18 w t 1 1 t 2 1 t 1 2 t 2 2 t 1 3 t 2 3 t 1 i w t 2 i w for individual occurrences of outliers or even for small clusters of outliers a simple and effective outlier replacement seems the most reasonable for longer clusters of consecutive outliers it might be more reasonable to reject rather than to replace the data the decision between outlier replacement and rejection should be based on a maximum allowed number of consecutive outliers that in combination with w decides which outlier intervals should be rejected and which outlier intervals should be replaced the maximum number of consecutive outliers that seem reasonable to replace depends on the application of the data using the original resolution of data should limit the accepted number of consecutive outliers compared to using windows of data for which features such as mean and standard deviation are extracted the outlier replacement values should not introduce a pattern into the data that is not actually present the simplest form of outlier replacement is by using linear interpolation between two adjacent data points next quadratic cubic or spline interpolation there should however be reasons to expect a nonlinear variation between consecutive samples before using a higher order interpolation method than linear interpolation an even more sophisticated approach for outlier replacement is by using a digital filter for which the pattern and variation in the data can be preserved up to a certain frequency for individual outliers a simple linear interpolation is however generally sufficient for consecutive outliers yet up to the maximum limit a low pass digital filter is recommended for outlier replacement outlier replacement through either interpolation or by using a digital filter have to consider time vector jumps outliers should be replaced considering the adjacent measurements only not by approximations running across a jump in time filtering or interpolating across jumps in time can possibly introduce non existing patterns to the data it is therefore highly recommended to use the time intervals free from time vector jumps given by q in eq 4 to construct the data basis for interpolation or digital filtering the replacement values are generated from information that is already present in other measurements and regardless of replacement method the estimated values are somewhat smoothed to preserve some of the variability noise can be added to the replacement values in that case the noise should be based on the existing variability e g by sampling from a gaussian distribution with zero mean and standard deviation equal to the upfront standard deviation of the measurement variable for a ship operation and performance analysis adding noise to the outlier replacement is however generally not important as data will be averaged over a certain window 2 4 data validation data validation is a term that may refer to the general process of checking data quality similar to data preparation with the aim of detecting faulty measurements to finally arrive at a reliable data set in this paper data validation refers to the more stand alone process of checking whether the measurements are reasonable data integrity is another term often used in computer science however this is somewhat more related to the integrity in storage like file system consistency accessibility of data and avoiding corrupted files sivathanu et al 2005 data free from outliers time vector jumps and with complete time synchronization may appear as good quality data during an individual examination however seen in relation to other measurement sources the data may be unphysical for example a ship at service speed having zero rotational speed of the propeller or a propeller having maximum rotational speed while the engine is standby there are various reasons for the mismatch between signals such as mis calibrated sensors error in routing of signals sensor drift various signal disturbances and other hardware or software related malfunctions data validation is the final data preparation step to ensure that such unphysical data is rejected as input to the ship performance analysis in cases where historical measurement data is available and it is reasonable to believe that this data can be trusted new measurements can be validated against regression models that are based on similar data in other cases where no such prior reference to a proper and reliable signal behavior is at hand there are generally two ways to perform data validation that are relevant for ship monitoring data the most straightforward way is a direct validation between sensors measuring the same property a ship may have largely dependent on ship class coexistent subsystems such as multiple gps units compasses motion reference units mru and wind sensors for which data validity can be checked by directly comparing the similarity of the data a second way to perform data validation is by connecting measurements through various combinations both linear and non linear to establish new variables from which time series similarity can be evaluated that is using physical knowledge and domain knowledge in particular to calculate properties that additionally are measured by dedicated sensors in the absence of such dedicated sensors data validation may even be performed between two calculated properties for ships in particular there are numerous possible variable connections and some examples are listed in table 1 the approach to data validation goes through a similarity measure referred to as d with a complimentary subscript a number of strategies for time series similarity measures exist from absolute similarity e g singular vector decomposition canonical correlation analysis regression and correlation analysis to relative similarity measures such as distance measures e g euclidean distance correlation measures e g correlation coefficient or principal component analysis pca fourier transform and metric based measures lhermitte et al 2011 the strategies have gained focus within domains such as pattern recognition climatology and oceanography serving as decision criterion in several time series clustering and classification techniques each having their strengths and weaknesses as further discussed in lhermitte et al 2011 in data preparation the aim is to validate the various data sources rather than performing a precise pattern recognition so a simple strategy for similarity estimation can be accepted when measurements are either coexistent or combined to express the same physical property a perfect time series similarity should have a linear correlation coefficient d c c equal to one this means that both strength and direction of the linear relationship between the two variables are intact d c c is however a measure of the linear relationship and does not evaluate the direct difference in time series values which means that it is unable to reveal amplitude scaling or amplitude translation therefore the difference in or preferably the ratio between the arithmetic average of each corresponding time series should include as a complementary similarity measure this ratio between averages is referred to as d r a and is mathematically expressed in eq 19 amplitude scaling may be caused by e g improper placement of a sensor or by energy pickup in sensor wiring while amplitude translation may be a typical result of improper sensor calibration in eq 19 subscript 1 and 2 of y represent feature 1 and 2 for which the ratio of arithmetic average is found superscript i represent the time vector interval index as given in eq 4 19 d r a y 1 i y 2 i t t 1 i t 2 i y 1 t t t 1 i t 2 i y 2 t if either the linear correlation coefficient or the ratio between the average levels is far from unity the time series are considered not being similar this generally indicates that at least one of the measurement sources is not suited for data analysis or mathematical modeling the appropriate actions to take will depend on certain conditions in situations where more than two coexistent sensors are available each one of them can be validated against the others if this results in a certain measurement source standing out in terms of low data similarity relative to the other coexistent sensors the particular measurement should me ignored similar strategy can be used in cases where multiple combined measurements are available if however the available coexistent or combined measurement sources limits to two this kind of strategy is not feasible the data validity procedure should then rather evaluate which measurement that seems the most reasonable a simple way of considering reasonableness is to check for obvious errors for example to check if either of the two measurements have no variation if no obvious errors can be identified the suggested approach is to construct a new variable that is the average of the two measurements in practice there might be situations where special attention should be given either d c c or d r a if the data analysis depends on the mean value of a signal rather than instantaneous values similarity expressed through d r a should be given more emphasis over d c c this is e g the case when analyzing ship performance as the impact from individual waves on ship speed and propulsion power should be filtered using time averaging if the data analysis rather depends on variability such as standard deviation or a frequency analysis d c c should be given more emphasis over d r a a relevant type of analysis is e g analysis of vessel motions for shipboard sea state estimation which recently has gained interest in the literature nielsen 2017 interpretation of far from unity is case specific so whether a similarity should be accepted or not depends on the monitoring system and each individual sensor the use of data validation through d c c and d r a may therefore be considered more informative rather than conclusive with respect to d c c there might be need for filtering the data before checking the correlation between measurements the sensor noise typically varies among a collection of sensors and this has a direct influence on d c c in a wide range of data analyses the high frequency content such as sensor noise is in any case irrelevant for the result hence it is not necessarily critical that two coexistent or combined measurements correlate in the sense of a complete frequency resolution if high frequency content rather should be disregarded low pass filtered versions of the measurements should be used for calculating d c c however note that identical cutoff frequency must be used for the low pass filtered measurements entering the calculation of the correlation coefficient the validity of a measurement should preferably not be evaluated directly for the complete data set as a signal disturbance may come and go or a sensor may perform a self calibration the data can be valid in parts of the data set it is therefore recommended to do the data validation in batches of data e g corresponding to the time intervals free from time vector jumps as given in matrix q see eq 4 the time intervals free from time vector jumps are even ready for filtering as each interval is associated with a regularly spaced time vector 2 5 data extraction depending on the planned type of data analysis there are various reasons for extracting parts of the data set data extraction is also known as splitting of data or data clustering the general reason for doing data extraction is that inference of monitored data should consider the conditions during data acquisition as this basically forms the assumptions for interpreting the data this is particularly important when building data based mathematical models as it helps choosing the proper modeling tools and methods and to ensure that limitations and assumptions in the methods are fully met examples of data extraction methods can be port to port trips which can be used for analyzing performance of weather routing services fuel consumption and optimal speed in transit extraction of specific operational modes which can be used for assessment of power system design swider 2018 detailed analysis of maneuvers or other special cases of operations as for example dynamic positioning dp extraction of data for which a particular thruster configuration is operative as for example a thruster running with constant rotational speed rpm or constant power or a propeller running with constant blade pitch in a wide range of data analyses a general requirement is that the data is sampled under stationary conditions that is there are no transient behavior in the data and inference can be made based on a single realization if statistical parameters are estimated under the assumption of stationarity while some non stationary behavior is present it is likely that the parameter estimates will be biased for a ship there are a number of ways that stationarity can be interpreted stationarity in ship speed thrust admission ship course ship motions and weather conditions to mention some of them as the motivation behind data extraction is to get control of the input data to the various types of analyses the choice of method to extract data should be selected thereafter a combination of methods might also be the most reasonable choice for data extraction in most practical applications assessment of stationarity in the data is required at least to some extent stationarity is also probably the most tricky requirement when it comes to data extraction with respect to analysis of ship performance the quality of the analysis is among other factors inversely connected to the amount of transient behavior in the data a primitive but fast and interpretable consideration is to study ship performance under a port to port trip that is analyzing consumed power or consumed fuel relative to the forward speed without including low speed maneuvering a further improvement of this analysis is to filter out voluntary changes of operational control variables during the transit such as forward thrust caused by changes in propeller rpm or ship heading caused by azimuth or rudder control for the purpose of preparing data for a ship performance analysis the following sections present two methods of data extraction the first section presents a simple method to extract data acquired during transit between two ports a so called trip identifier the subsequent section presents a computationally efficient method to extract stationary parts of the in service measurement data based on the work presented in dalheim and steen 2020 2 5 1 port to port trips many ships operate on a more or less scheduled route when it comes to which ports and destinations they are serving this typically gives a circular pattern to the anchoring which in combination with a geospatial mapping tool can be used to identify port departure and arrival if no geospatial mapping tool is available the time of arrival and departure can be identified using geofences or virtual perimeters of a geographical area around the relevant destinations in combination with the geographical position of the ship a geofence can notify the point in time when leaving and entering a destination from which data can labeled as a trip there are however many ships that have more flexible schedules which makes use of geofencing more cumbersome less precise and by that less relevant a more general procedure is therefore to identify trips by using the measured ship speed during a trip the ship will usually enter transit mode when low speed maneuvering is completed and similarly end its transit when initiating low speed maneuvering the start of a trip in transit mode can therefore be identified when the ship speed exceeds a certain limit and correspondingly end when the speed goes below this limit the speed limit should to some extent be set depending on ship type size and the area of operation but a forward speed of 4 knots is found to be useful exceptions are for ships typically operating at low speed for example trawlers for which it is necessary to combine the forward speed with measurements of the force in the trawl or by using propeller rpm for identification instead of ship speed 2 5 2 stationary data identification of stationary parts of in service measurement data is a more complex type of data extraction yet an essential type of data extraction with respect to performing a ship performance analysis of high quality it concerns splitting of data into time intervals for which one can assume that certain physical properties are free from transient behavior in statistics the strongest form of stationarity is referred to as s t r o n g s t r i c t or c o m p l e t e stationarity a weaker form of a stationarity is referred to as n th order w e a k l y stationary for which all joint moments up to order n exist and are time invariant box and jenkins 1976 p 8 time series analysis often consider second order weakly stationarity which means that a time series has constant mean and variance for many practical applications though the requirements are even less strict and the condition of s t e a d y s t a t e is rather used steady state refers to a condition where the process has a constant mean and does not require the associated noise and disturbances to be stationary steady state parts of time series data are formed by identifying time points at which certain properties of the time series data change this is referred to as change point detection dalheim and steen 2020 developed a change point detector based on hypothesis testing of the process value inside a moving window the basic assumption was that the underlying process could be modeled by a deterministic linear trend model as expressed in eq 20 in the equation a t refers to a zero mean white noise process with constant variance σ a 2 b 0 represents the intercept of the linear model and b 1 t the linear deterministic drift component formed by the slope b 1 and the relative time t within the moving window starting from t 0 for all windows under the assumption of independent normal innovations a t the null hypothesis that the process signal is stationary about the window sample intercept b 0 can be tested using a two tailed t test on b ˆ 1 based on the t value in eq 21 the estimate of the linear slope b ˆ 1 is found by ordinary least squares estimation the actual interpretation of what i s significant needs to be considered for the particular application of the steady state detector in general it concerns identifying the critical variables for what we aim to study using steady state models a thorough interpretation of steady state relevant for a number of ship monitoring data analyses can be found in dalheim and steen 2020 the present work limits to identifying data sampled under a constant command of the ship more specifically the identification of time intervals at which the propeller rotational speed rpm and the propeller pitch angle are kept constant which is required for the most common types of ship performance modeling 20 z t b 0 b 1 t a t 21 t 1 b ˆ 1 σ ˆ b 1 the steady state detector has two parameters that must be set the significance level α and the window length n the significance level controls the accepted slope in the window by representing the probability of rejecting a zero slope b 1 0 when a zero slope in fact is true i e the probability of conducting a type i error if steady state in a process value is critical for the application of the time series data the steady state detection must ensure a low probability of incorrectly accepting a zero slope this will increase the reliability in the steady state data but might at the same time cause a rejection of large parts of the data set which is unfavorable for data completeness similarly the less critical variables should accept a higher slope in the data window which means accepting a higher probability of conducting a type ii error the second parameter the window length is the number of samples used to form the moving window this is essential in the consideration of which effects to remove from the data a long window is e g well suited for detecting non stationarity in slow processes like sensor drift causing the sensor value to accumulate with time a long window is however not suited for detecting unsteady behavior with short duration in general the window length should exceed the autocorrelation persistence of known system dynamics that are acceptable even for a condition of steady state but yet short enough to detect undesirable changes of short duration 2 6 overview of data preparation the suggested procedures for preparing ship monitoring data for a ship operation and performance analysis have been presented the entire process of data preparation from initially possessing roughly raw historical time series data to the completion of a fully utilizable and functional data set ready to analyze has been split into minor basic parts as a means to offer excellent overview control and simple customization the data preparation steps are summarized in the flow diagram given in fig 8 3 results the data preparation tools have been developed and evaluated using two separate sets of times series data each of them corresponding to one complete year of data 365 days the data is sampled at 1 hz by the in service monitoring systems installed on two ships a platform supply vessel psv and a general cargo multipurpose vessel mpv both designed by kongsberg maritime as the psv is mainly serving offshore platforms in the north sea it has an overall length of almost 100 m beam and max draft of 20 m and 7 m respectively and a dead weight of about 5000 dwt the vessel is equipped with diesel electric machinery and azimuthing propulsion system consisting of twin azipull type azp100cp the typical service speed of the vessel is about 10 12 knots the mpv is mainly carrying cargo along the norwegian coast it has an overall length of almost 120 m beam and max draft of 20 m and 5 m respectively and a dead weight of about 5000 dwt the vessel is purely run on liquefied natural gas lng and is fitted with a hybrid shaft generator rudder and a single screw controllable pitch propeller the typical service speed of the vessel is about 15 knots the in service monitoring system installed on each of the vessels collect sensor data from selected vessel equipment the data acquisition is divided into different systems that provides measurement data to the data logger the data logger on each vessel is configured to sample at a frequency of 1 hz the data logger further provides time stamps to the incoming data which means that each system based collection of measurement data gets its own time stamp the data is stored on a server running on the ship and data transfer to shore is performed on a regular basis the following sections evaluate the methods developed for data preparation of ship in service data with regard to a ship operation and performance analysis the evaluation of the methods is structured according to the recommended practice given in section 2 3 1 feature selection each of the two case vessels has more than 100 sensors installed from which measurement data can be extracted for a ship operation and performance analysis there is a certain but limited set of measurement variables that is required for doing a proper analysis in table 2 a short list of features selected for doing a ship operation and performance analysis is given the first column indicates from which system the measurements are acquired from the second column of the table presents descriptive names of the variables that are measured 3 2 time vector jumps and synchronization evaluation of time vector jump identification is carried out by summing up the total number of time intervals free from time vector jumps as well as the total number of samples that is removed due to jump identification in the evaluation the tolerance of t relative to a time vector with uniform sampling is set as half of the intended sampling interval t s 1 s e g such that k σ t 0 5 s with reference to eq 2 to avoid unnecessary short time intervals a minimum duration of 60 s is set for the intervals free from time vector jumps for the psv the one year data set has to be split into 31 time intervals in order to avoid time vector jumps in terms of amount of data this means that 5 6 of the data has to be removed corresponding to 494 h of data for the mpv the one year data set has to be split into 541 time intervals in order to avoid time vector jumps even though time vector jumps occur more frequently for the mpv the jumps are generally shorter in length in terms of amount of data only 1 0 of the data has to be removed corresponding to 86 h of data the established intervals free from time vector jumps are suited for checking the time synchronization because all jumps are removed maximization of the cross correlation function can be used directly to identify the average time delay between signals 3 3 outlier detection outlier detection is evaluated by summing up the total number of outliers identified in each of the two one year data sets results are given in table 3 and table 4 for the psv and the mpv respectively the amount of data identified as outliers relative to the total amount of data is given in the rightmost columns in the tables for the psv the amount of outliers in the data is generally below 1 except for the longitude position of the vessel for which outliers constitutes 1 02 of the one year data set similar amounts of outliers are detected for the mpv i e mostly less than 1 the propeller shaft thrust measurement however reveals a large amount of outliers amounting to nearly 20 of the data set the main cause of this is found to be drop outs to negative values where each drop out has a significant time persistence next the rudder angle measurement has a considerable amount of outliers with nearly 8 of the data set identified as outliers similar as for the thrust measurement the outliers are mainly drop outs to either a large or to a small rudder angle with significant time persistence during the recent outlier detection no limit for the maximum number of consecutive outliers that decides upon data replacement or data rejection was set the quantities listed in tables 3 and 4 are hence referring to the amount of data that should either be replaced or rejected for further use 3 4 data validation to demonstrate and evaluate the method for data validation two examples of time series data showing poor data similarity in terms of either the linear correlation coefficient d c c or the ratio between averages d r a are shown the corresponding similarity measures are given in table 5 for each of the two examples the first example fig 9 shows the wind speed measured by two coexistent wind anemometers onboard the psv the value of d r a indicates that the two coexistent measurements are not equal in terms of their mean value d r a 78 in addition d c c indicates a linear correlation below unity d c c 92 considering the time series data in fig 9 the reduced linear correlation is apparently caused by a stronger drop in wind speed measured by sensor 1 compared to sensor 2 about halfway into the time series the second example fig 10 shows the roll angle measured by two coexistent mrus onboard the psv the value of d r a indicates that the two coexistent measurements are far from equal in terms of their mean value d r a 330 the linear correlation is however very close to unity d c c 98 this behavior is also evident in the figure showing that the two coexistent measurements follow each other however at two different mean levels 3 5 data extraction evaluation of data extraction is carried out by presenting various examples of time series intervals formed by applying the data extraction methods as presented in section 2 5 first a simple port to port trip identification is shown for each of the two case vessels then examples of steady state identification are shown using various data from the two case vessels 3 5 1 port to port trips an example of trip identification using speed over ground measured on the psv is shown in fig 11 the speed limit is set to 4 knots the identified trip has a duration of approximately 8 5 h and consists mainly of transit operation at service speed of 12 14 knots in fig 12 a similar trip identification for the mpv is shown the identified trip has a duration of approximately 19 5 h and consists mainly of transit operation at service speed of 13 15 knots in both cases the time series data before and after the identified trip is found to be mainly low speed maneuvering of short duration trip identification based on speed over ground measurements is a very primitive tool to extract data of transit operation yet it is straightforward to implement and gives a fast and robust splitting of the data into trips 3 5 2 stationary data data extraction based on identification of steady state time intervals has been tested and evaluated using time series data from the psv fig 13 presents three examples of steady state identification on ship control variables that are critical for a ship performance analysis i e the propeller rpm the propeller pitch and the ship heading the time series data of the propeller rpm and the propeller pitch are extracted from the same time interval this interval takes place in between two time vector jumps and lasts for about 100 min the ship heading data is extracted from a separate time interval lasting for about 210 min the reason for presenting a separate time interval is simply because the ship heading was constant throughout the time interval used for the propeller rpm and pitch the color in the figures indicates the local state identification with green color representing the time intervals where the particular variable probably is at steady state the three measurement variables are all checked for steady state using a significance level α 1 but with individually selected window lengths for the propeller rpm measurement a window of 5 min n 300 is used evaluating the result presented in fig 13 a shows that the method successfully rejects the two parts of the time series that by visual inspection clearly is not at steady state more specifically the rpm drop and rebuild between time 18 and 32 min and between time 40 and 46 min into the time series the propeller pitch angle is checked for steady state using a window of 30 s n 30 the short window length is set because changes in propeller pitch angle generally occur more frequently and are of shorter duration compared to the propeller rpm the result is presented in fig 13 b showing how the propeller pitch angle measured in of maximum pitch angle is reduced and increased between time 18 and 48 min into the time series the steady state detection rejects most parts of this data however due to the small window there are even some short time intervals in between that are accepted as steady state e g between time 22 and 27 min the third example of steady state identification considers the ship heading using α 1 and a window of 20 min n 1200 the long window is set because a change in ship heading generally is a slow process expected to occur infrequently during a traditional transit operation the result is shown in fig 13 c and agrees well with visual inspection short intervals of apparently steady state data have been rejected due to non sufficient length compared to the window size the small but distinct changes in heading are successfully rejected as steady state for example as shown between time 30 and 50 min 3 6 data preparation for ship performance analysis the presented data preparation tools are evaluated with respect to a ship performance analysis of a platform supply vessel psv and a general cargo multipurpose vessel mpv the result of a thorough data preparation is high quality data fully customized for the particular type of analysis high quality means that errors distortions and unphysical relationships are omitted as input to the data analysis fully customized means that only data relevant for the particular analysis is extracted from the data set to evaluate the final result of the data preparation tools applied on ship monitoring data a ship performance evaluation in terms of a speed power analysis is given for each of the two case vessels except from the data preparation no additional corrections are made to the speed and propulsion power data a plot of the propulsion power vs the forward speed is descriptive in that it presents the variation in consumed power relative to the variation in speed the plot is particularly descriptive for the ship performance if shown together with the calm water speed power relation as it provides a more precise impression of both the amount of operational data not matching the expected calm water relation as well as how far the operational data deviates from the expected calm water relation fig 14 shows the speed power data from the one year data set of the psv along with curves for the calm water speed power relation at three different vessel draughts the blue colored markers represent data prior to application of the data preparation tools corresponding to 30 537 481 samples note however that data exceeding the physical constraints of either the propulsion power or the forward speed are left out as the most extreme values explode the dimensions of the axes making the majority of data unreadable for the psv the amount of data exceeding the physical constraints and therefore not shown in the figure amounts to approximately 150 000 samples corresponding to 32 h of operation the speed power plot illustrates that the data preparation tools removes unphysical data as well as data that is likely to originate from unsteady behavior it shows that the prepared data becomes more fitted to the calm water curves as a lower baseline and that the data for which the forward speed of the vessel is low while the propulsion power is high is removed from the prepared data set out of the one year data set from the psv 59 7 of the data was removed during data preparation in combination with port to port trips data extraction while 73 3 of the data was removed during data preparation in combination with steady state identification of propulsion power propeller pitch angle and ship heading similarly as for the psv the speed power data from the one year data set of the mpv is shown in fig 15 the blue colored markers represent data prior to application of the data preparation tools corresponding to 31 234 048 samples for this vessel the amount of data exceeding the physical constraints of either the propulsion power or the ship speed corresponds to approximately 1 h of operation the speed power plot from the mpv data illustrates the performance of the data preparation tools very well the prepared data fits nicely to the calm water curves as a lower baseline and the majority of the data showing a combination of low forward speed and high propulsion power is removed from the prepared data set out of the one year data set from the mpv 70 0 of the data was removed during data preparation in combination with port to port trips data extraction while 80 8 of the data was removed during data preparation in combination with steady state identification of propeller rpm propeller pitch angle and ship heading the most prominent difference between the two speed power plots based on the psv and the mpv ship monitoring data sets is the lower left region of the scattered data representing low forward speed and medium propulsion power for the psv a major part of this data persists in the prepared data set for the mpv most of this data is removed in the prepared data set this difference can be explained by domain knowledge and logical reasoning the psv operates in a more exposed wave and wind environment compared to the mpv which means that a larger speed loss is expected to take place the psv also has a more unfavorable ship length to wave length ratio which also affects the speed loss the mpv is therefore expected to have less amount of data in the low forward speed medium propulsion power region corresponding to large speed loss compared to the psv 4 conclusion a stepwise recommended practice for preparation of in service measurement data for ship operation and performance analysis has been presented and evaluated the presented methods for preparation of in service measurement data have been demonstrated and shown to be efficient tools for obtaining high quality in service data it is shown how the data preparation improves a ship performance analysis by presenting a speed propulsion power relation for two case vessels having different vessel designs it is generally recommended to follow this procedure for data preparation concerning most kinds of time series data from continuous monitoring of physical processes however it is still encouraged to use specific domain knowledge during the implementation this is particularly relevant during data extraction both in terms of selecting variables and in setting the necessary parameters for steady state identification by following this practice more focus can be given to the actual data analysis compared to the data preparation still preserving that only high quality data is used as input to the data analysis credit authorship contribution statement øyvind øksnes dalheim conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization sverre steen conceptualization supervision writing review editing funding acquisition project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research presented in this paper was carried out in the kongsberg maritime university technology centre at the norwegian university of science and technology in trondheim it was partly financed directly by kongsberg maritime through the grant to the university technology centre and partly by the project innocurrent which is financed by the the research council of norway grant number 282385 and kongsberg maritime the authors gratefully acknowledge kongsberg maritime for providing the full scale data used in the research 
21701,the conventional extrapolation of ship resistance from model tests to full scale presumes that the coefficient of wave making resistance c w depends on the froude number only this leads to the assumption that c w of a ship is identical to c w of its scaled model however this assumption is challenged in shallow water due to viscous effects which are represented by the reynolds number re in this study different scales different re of the wigley hull and the kcs hull are used to investigate the scale effects on c w numerically after verification and validation systematic computations are performed for both ships and their scaled models in various shallow water conditions based on the results significantly larger values of c w are found for the kcs at model scale in very shallow water suggesting that the conventional extrapolation has to be reconsidered additionally this study reveals the relationship between the changes in frictional resistance coefficient c f and the changes in c w caused by shallow water which benefits the prediction of shallow water effects on c w finally use of a larger ship model where the re is also higher is recommended for resistance tests in shallow water to reduce scale effects on c w keywords scale effect wave making resistance resistance extrapolation shallow water 1 introduction generally it is not easy to obtain the resistance of a full scale ship directly conducting ship model tests therefore acts as an important technique to predict the full scale ship resistance during the tests the coefficient of wave making resistance c w is commonly assumed to be a function of froude number fr only i e independent of viscosity thus c w remains identical for a ship and its scaled model ittc 2017a this assumption acts as the basis of resistance extrapolation from model scale to full scale after model tests however researchers have shown that viscosity does have an effect on ship generated waves ship generated waves will be damped by water viscosity and cumberbatch 1965 found that the diverging wave system is damped more heavily than the transverse waves calculations conducted by gotman 2002 showed that a part of the bow wave system is damped by viscosity and will not participate in the interaction with the stern wave system likewise the stern wave system is also damped during its propagation as a result c w achieved in viscous flow is also different from that using potential theory for instance small errors might be caused due to the damping if one uses wave cut analysis sharma 1963 to obtain c w as indicated by stern 1986 the development of the ship s boundary layer is influenced by ship waves the other way around ship waves will be affected also by the alternation of the ship s boundary layer consequently similar to the frictional resistance coefficient c f which strongly depends on the ship s boundary layer c w will also show scale effects here being described by the reynolds number re according to the numerical calculations conducted by raven et al 2008 the wave height of ship generated waves at full scale is larger than that at model scale indicating that the computed c w at model scale underestimates a real ship s wave making resistance furthermore more recently terziev et al 2018 using a geosim analysis argued that c w does not show clear relationship with neither scale factors nor re although it was demonstrated that c w is a function of both froude number and reynolds number a difference in c w caused by scale effects is generally a small part of the total resistance in deep water for instance raven et al 2008 computed c w at both model scale and full scale for the hamburg test case and the difference between the two values is about 3 3 of the total resistance at full scale besides terziev et al 2018 examined the kcs and the change in c w between model scale and full scale was up to 13 1 of the total resistance at full scale after using the traditional extrapolation method ittc 2017a those differences at c w will not make a big difference 5 in the total resistance at full scale zeng 2019 nevertheless more significant discrepancies can be observed in shallow water the most obvious difference in ship generated waves is the change in the angle of the divergent waves known as kelvin angle based on which the subcritical speed regime critical regime and supercritical regime are determined havelock 1908 generally the value of c w rises significantly when the depth froude number fr h approaches the critical region fr h 1 but decreases rapidly immediately after this region in the supercritical region the trend that c w increases with fr h is restored since most shallow water vessels sail within the subcritical regime this study will specifically focus on this regime in this regime wave properties will be subject to change compared to the deep water case for instance ship generated waves will become faster lamb 1932 higher putnam and johson 1949 and longer mucha et al 2016 in shallow water restricted space accelerates the flow around the hull and as a result the ship s boundary layer becomes thinner and the wave resistance related to the ship s boundary layer is altered accordingly additionally the presence of bottom friction can cause a shear current above the fairway floor ellingsen 2014 li and ellingsen 2016 and an extra boundary layer is formed there this additional boundary layer can induce a shrinkage in the ship s boundary layer due to restricted under keel clearance the problem will become even more complicated when these two boundary layers touch each other and such a situation is expected to vary with reynolds number thus a hypothesis is proposed that scale effects on c w will be more significant in shallow water according to this study the difference of c w between model scale and full scale can reach 46 6 of the total resistance of a ship at full scale therefore the basis of resistance extrapolation i e c w is insensitive to re as mentioned above is challenged however to the best of the authors knowledge there is no research considering scale effects and shallow water effects on c w simultaneously this study is performed to understand the mechanism of scale effects on c w and to improve the reliability of the ship s resistance extrapolation in shallow water cfd computational fluid dynamics techniques are applied to obtain c w separately two distinct hull forms the wigley hull and the kcs kriso container ship hull for both of which a large amount of validation data exists are used in this investigation since the purpose is to reveal the mechanism of scale effects on c w in shallow water the trim sinkage propulsion system and ship appendices which are not decisive factors for this mechanism are not considered for simplification this article contains five sections section 2 discusses a method for calculating c w and the setup of numerical cases section 3 shows the verification and validation v v results and analysis are given in section 4 and conclusions are drawn in section 5 2 method 2 1 the approach for obtaining wave making resistance numerically nominally the wave making resistance r w is caused by the energy transferred from the ship hull to the wave system in deep water where the effects of viscosity on r w are minor wave pattern resistance can be seen as the whole wave making resistance and can be calculated both numerically through inviscid cfd computations raven 1996 and experimentally through e g the wave cut analysis sharma 1963 however the accuracy of both methods aforementioned is threatened by the combination of viscosity effects and shallow water effects zeng et al 2019b a popular way to obtain r w separately is conducting two types of resistance test one with free surface and another with the free surface suppressed double body test for a bare hull the coefficient of the total resistance c t can be decomposed into three parts coefficients of frictional resistance c f viscous pressure resistance c vp and wave making resistance c w which is shown in equation 1 1 c t c f c v p c w in equation 1 c f is calculated by integrating the shear force on the hull surface in equation 2 below subscripts fre and dou are used to represent the results from the scenarios with free surface and double body tests respectively as the c w dou 0 the difference of c t between the two types of situation can be written as 2 c t f r e c t d o u c f f r e c v p f r e c w c f d o u c v p d o u 1 k f r e c f f r e 1 k d o u c f d o u c w the symbol k indicates the form factor which is the ratio between c vp and c f based on equation 2 c w can be obtained through 3 c w c t f r e c t d o u 1 k f r e c f f r e 1 k d o u c f d o u on the right side of equation 3 the variable k fre cannot be achieved directly and precisely through cfd calculations to solve this problem two methods to determine c w exist assumption i 4 1 k f r e c f f r e 1 k d o u c f d o u the above assumption indicates that the viscous part of resistance computed with free surface is exactly the same as the total resistance achieved by a double body calculation based on this assumption equation 3 becomes 5 c w c t f r e c t d o u therefore c w is simply the difference between the total forces calculated with and without free surface this approach is applied frequently especially with the development of cfd techniques e g raven et al 2008 however the treatment mentioned above requires the viscous part of the resistance to be identical in both cases if c f in one case is higher than another c vp should be lower to maintain assumption i based on this c vp appears to be inversely proportional to c f which contradicts the conventional understanding of the form factor to remedy this contradiction the second approach can be applied assumption ii 6 k f r e k d o u equation 6 assumes the form factor k remains the same for both cases with free surface and its corresponding double body test since most ships in shallow water navigate at a relatively low speed waves generated by the ship hull generally have a small wave height which makes the pressure distribution on the hull as well as the wetted surface almost identical between the cases with and without free surface except for very limited areas near the free surface in addition for the two ships i e the wigley hull and the kcs as will be discussed in section 2 2 1 that will be used in this study the streamlined stern helps prevent wave induced flow separation at the aft by which the pressure field behind the stern remains similar for both conditions thus the forces on the hull are similar for both cases with and without free surface therefore since c f and c vp are computed based on the same wetted surface the form factor can thus be seen as identical with minor errors for both cases i e c vp is proportional to c f which underpins assumption ii mentioned above consequently equation 3 becomes 7 c w c t f r e c t d o u 1 k d o u c f f r e c f d o u assumption ii will be implemented in this study all coefficients on the right side of equation 7 can be obtained through cfd computations which makes it possible to determine c w separately and numerically in shallow water 2 2 setup of cases 2 2 1 ship information in this study the ship model scale which is expressed by the reynolds number re is proposed as an additional influencing factor on wave making resistance in shallow water i e c w f fr re according to the research of zeng et al 2019a a ship with a higher block coefficient c b which represents the fullness of a ship tends to show more obvious scale effects on the viscous part of the resistance in shallow water therefore the scale effects on c w depend on the ship s fullness and two ships with a distinctly different fullness the wigley hull and the kcs are selected since a large amount of validating data is available the underwater part for each ship is shown in fig 1 the wigley hull is a representative of slender ships it has no flat bottom and c b 0 445 the surface of the wigley hull can be defined precisely by equation 8 e g kajitani et al 1983 8 y b l 1 2 x l 2 1 z t 2 where b is the ship s beam l the ship s length due to the symmetry of the wigley hull the length between perpendiculars l pp is identical to l and x y z are the coordinates in a cartesian coordinate system x is positive in the navigation direction y is positive to port and z is positive upward this coordinate system is also valid for the kcs except for the position of the origin for the wigley hull the origin is the intersection of the midsection the symmetric plane and the design waterline plane for the kcs the origin is the intersection of the aft perpendicular and the zero waterline plane compared to the wigley hull the kcs hull has a much fuller shape c b 0 651 and a large area of the flat bottom see e g kim et al 2001 for more details more information about these two ships at full scale is listed in table 1 for the full scale wigley hull the length and the design velocity are set deliberately to 75 m and 5 196 m s corresponding to 18 705 km h for an inland vessel respectively which are representative values for typical inland ships the velocity of the full scale kcs is 7 893 m s at which the depth froude number fr h is the same as the wigley hull thus enabling a clear comparison specific values of velocities are determined based on an easily interpretable value of reynolds number re i e lg re 8 50 for the wigley hull and lg re 9 20 for the kcs at full scale to study scale effects on wave making resistance different scale factors that lead to a length of ship models within 1 5 m 15 m are selected which covers the typical range of the model length used by most towing tanks in the world again specific values for the scale factor are chosen to ensure the wigley hull and the kcs hull have the same value of re as shown in table 2 it should be pointed out that the re starts at lg re 6 0 although a laminar boundary layer would cover half of a flat plate at lg re 6 0 based on the research of eça and hoekstra 2008 it is found that for the ship hulls in this study about 90 instead of 50 of the hull will be covered with a turbulent boundary layer due to the initial turbulence intensity and the 3d hull effects thus the influence of the laminar flow at lg re 6 0 can be considered as negligible in the computation of ship resistance for each selected ship the froude number fr is kept as constant a commonly used non dimensional factor y which represents how far the first grid point is located from the wall for each case is also shown in table 2 the value of y is estimated prior to the calculations as will be discussed in detail in section 3 1 1 2 2 2 waterway dimensions shallow water conditions are realized by adjusting the vertical position of the waterway floor which can be described by the water depth ship draft ratio h t four shallow water scenarios with h t equals 2 0 1 5 1 3 and 1 2 are applied and one deep water case h t 15 is included for comparison as shown in table 3 combined with table 2 there will be 70 cases in total in this study in this study the waterway is assumed to be only limited in water depth thus the lateral boundary should be far enough away from the ship to avoid blockage effects regardless of the boundary condition assigned to it according to ittc 2017 and also the cfd computations performed by zeng et al 2019a the blockage factor m which is the ratio between the area of ship s midsection and the area of the wetted waterway section should be less than 3 to eliminate blockage effects therefore the water width ship length ratio w l pp is adjusted to meet the requirement as shown also in table 3 for comparison purposes the depth froude numbers fr h for the wigley hull and the kcs are designed to be identical for each h t fr h higher than 0 7000 is rarely found for vessels sailing in shallow water and is therefore not discussed 2 2 3 numerical settings 2 2 3 1 computational domain and boundary conditions due to the symmetry of the ship half of the domain is used in the computations the inlet boundary is 1 l pp in front of the ship and the outlet boundary is 3 l pp behind the ship for cases with free surface the top boundary is located 0 5 l pp above the designed waterline plane the position of the bottom varies with h t sketches for the computational domain are shown in fig 2 boundary conditions for both cases are also shown in fig 2 the ship hull is a non slip wall and fixed in the domain water comes from the inlet boundary with the same velocity as the ship s design speed the bottom boundary is a moving wall which is non slip and moving at the same speed as the incident flow for computations without free surface the dirichlet boundary condition is applied for the velocity inlet boundary where the value of input velocity is given before simulations the neumann boundary condition is used for the outflow boundary where the diffusion flux for all flow variables is zero in the direction normal to the outlet plane for computations with free surface the vof volume of fluid technique and the open channel boundary condition are used to adjust to the open channel method pressure inlet and pressure outlet are applied for the inlet and outlet boundary respectively 2 2 3 2 mesh and solver for all cases in this study a hexahedral mesh is generated through icem version 18 1 the underwater part of the mesh is identical for the condition with free surface and its corresponding double body case in terms of c w calculation the grids close to the hull and the waterway floor are refined in order to properly capture the complexity of the flow an example is shown in fig 3 for the kcs with h t 1 2 the thickness of the first layer of the mesh adjacent to the hull depends on the choice of y which will be discussed in detail in section 3 1 verification all cfd computations are run on a commercial solver ansys fluent version 18 1 the turbulence is resolved approximately by solving the reynolds averaged navier stokes rans equations with the application of the sst k ω model the steady pressure based solver is used the pressure and the velocity are calculated in a coupled manner the discretization methods for gradient and pressure are least squares cell based and presto pressure staggering option respectively the discretization method is second order upwind for momentum turbulent kinetic energy and specific dissipation rate 3 verification and validation in this section the code fluent is firstly verified by evaluating the uncertainties of spatial discretization the uncertainties of temporal discretization and the effects of y on wave making resistance afterward the code is validated by computing the wave profile close to the ship hull and the total resistance 3 1 verification 3 1 1 spatial discretization uncertainty in the solver fluent the velocity and the pressure in the flow field are not solved continuously their values are calculated in the center of the grid cells and the interpolation method is utilized if no computed point exists thus to reduce the numerical errors caused by mesh to an acceptable level the uncertainties of the spatial discretization are evaluated this verification follows the method proposed by eça and hoekstra 2014 which is shown as follows 9 s r e φ 0 β p i 1 n φ i φ 0 β α i p 2 where φ i is the key variable to be evaluated which will be the frictional resistance coefficient c f and the total resistance coefficient c t φ 0 β p are constants derived from a fitting curve of φ i the value of p indicates the order of accuracy the uncertainty can be obtained through 10 u φ i f s φ i φ 0 s d φ i φ 0 β α i p where s d is the standard deviation f s 1 25 if 0 5 p 2 1 otherwise f s 3 in order to use this method at least four sets of mesh are required in the experiments conducted by kim et al 2001 a 1 31 6 ship model of the kcs is applied the froude number is 0 26 and is also used in this verification the refinement factor r in each direction is 1 25 and four sets of mesh are implemented in table 4 the number of grid cells the results of c f and c t and the number of grid nodes per wavelength n are listed in this verification a constant value of y 50 is used it was determined prior to the simulations through equation 11 11 y u y υ u τ ρ τ c f 57 1 2 ρ v 2 where u is the friction velocity y is the exact distance m of the first grid point from the wall υ water kinematic viscosity τ the shear stress ρ water density c f57 the frictional resistance coefficient calculated by the ittc 1957 line and v the water velocity based on table 4 the method of eça and hoekstra 2014 mentioned above is applied to calculate the uncertainties of c f and c t generally the geometrical similarity should be maintained in the complete computational field based on this assumption the distance between the first grid point and the wall described by y varies in those grid sets however different values of y also determine whether a wall function is applied or not and the results of c f will be affected accordingly consequently scatters might be caused leading to an unprecise asymptotic region therefore a constant wall y is applied and the grid distribution in other places is geometrically similar the spatial discretization errors and uncertainties of c f and c t of the 1 31 6 kcs for the finest mesh mesh set no 1 are calculated and shown in table 5 table 5 shows that the uncertainties of both c f and c t caused by spatial discretization are less than 2 which is acceptable for a numerical calculation therefore the finest grid set is selected in the subsequent sections however the spatial convergence study is specifically for the 1 31 6 scaled kcs at fr 0 26 and y 50 as mentioned in section 2 2 2 there will be 70 cases in total it is not practical to perform such verification for all cases therefore a more general rule which is the number of nodes per wavelength applicable to all other cases is discussed since the density of grid points per wave period determines the accuracy of wave profile and thus influences the wave making resistance the number of nodes per wave height and or per wavelength is a good candidate to act as a general key factor for spatial convergence study in this subsection the number of grid points over the height of the wave is about 10 and the aspect ratio of the cells near the free surface is at the magnitude of 10 this setting was proven to be suitable and increasing the number of grid points in one wave height will make a minor contribution to the sharpness of the wave profile javanmardi 2015 therefore this study will focus on the choice of the number of grid points per wavelength linear wave theory airy 1841 is applied to predict the number of wavelengths along with the ship hull based on this theory the number of ship generated waves within a ship length distance n is a function of froude number fr 12 n 1 2 π f r 2 equation 12 makes it possible to estimate the wavelength and thus the number of grid points per wavelength n before numerical calculations in table 4 the value of n for each mesh set is shown in the last column a wave cut at y 2b is depicted in fig 4 for each case in the range of x 2 5 l pp 1 5 l pp based on fig 4 it can be found that the wave profile generated with n 56 has a relatively large deviation compared to n 104 where the wave profile is assumed to be the most accurate therefore n 56 is not considered for the area close to the hull where a high accuracy of the wave profile is required in the range of n 70 104 the sharpness of the wave profile increases with a refinement of the mesh but the differences are becoming smaller which means the refinement of the mesh only makes small contributions to the wave sharpness therefore to balance the accuracy and computation costs n 56 is guaranteed for the far field and n 70 is guaranteed for the area close to the ship hull by which the accuracy of the calculated resistance and the wave sharpness close to the hull are assured the number of cells finally applied for each case in deep water are shown in table 6 the number of cells for each shallow water case is not listed since the number of cells decreas corresponding to the value of under keel clearance and other parts remain the same as the deep water case 3 1 2 temporal discretization uncertainty in addition to the verification of spatial discretization an appropriate time step should be selected to guarantee a good convergence the basic requirement in a cfd computation is that the courant number c v δt δx where v is the flow velocity δt the time step applied and δx the length interval should be less than one in ittc 2017b a more rigorous requirement δt 0 01l u is suggested where l is ship length and u ship speed during the simulations a steady solver is used but the automatic pseudo transient time step is enabled in fluent δt is selected automatically ansys 2017 by 13 δ t min δ t u δ t p δ t g δ t r o t δ t c o m p r e s s where δt u is the convective time scale δt p the dynamic time scale δt g the gravitational time scale δt rot the rotational time scale and δt compress the compressible time scale details can be found in ansys 2017 the physical time step is controlled by the time scale factor in this temporal verification case no 4 in table 4 is used again the refinement factor is 1 25 and four values of the time step are applied the uncertainties caused by temporal discretization for the case δt 2 are shown in table 7 in table 7 although the uncertainties are calculated for δt 2 not the smallest time step the uncertainties for both c f and c t are very small 0 02 therefore δt 2 is used for all subsequent calculations to balance computing accuracy and time 3 1 3 the choice of y the y dependency of the wave making resistance is studied in this subsection according to ittc 2017b y 1 is recommended when a near wall turbulence model is used and 30 y 100 is recommended when a wall function is used however those suggested regions only cover a limited range of y also the value of y is not a constant along with a ship hull in the numerical results which will make the near wall meshing work extremely complicated if the rules mentioned above are met rigorously to solve this problem many industrial cfd codes apply the so called y insensitive wall treatments by using blending functions for the buffer region and the fully turbulent outer region e g the menter lechner treatment is applied for ω equation models in fluent ansys 2017 in principle the choice of y will influence the results for shear stress on a non slip wall and the frictional resistance can be affected by y in this study since wave making resistance is assumed to also depend on reynolds number the choice of y may also make a difference in the wave resistance this subsection is established to test whether the wave making resistance is invariant with y if the sst k ω model is used in fluent according to the research of zeng et al 2019a the resistance of the kcs is more sensitive to water depth than the wigley hull therefore the case of the kcs in shallow water h t 1 2 is selected for this y test about the choice of re lg re 7 4 is used since the mesh quality is generally not acceptable by the solver when y 150 for lg re 7 4 and an excessively large number of cells is obtained when y 8 for lg re 7 4 the values of y used in this study are shown in table 8 a deep water h t 15 0 case is analysed for comparison the selected y varies from 1 to 400 which spreads over all the regions in the inner and outer boundary layer due to a limitation on available physical memory cases with more than 12 million grid points are not performed which are marked by in table 8 for the case with y 400 the first computed point is in the outer layer which is included to study the usability of the code in this specific region the results of c w using the method proposed in section 2 1 are shown in fig 5 cfd results of c f and the results calculated by ittc 1957 and katsui et al 2005 are also shown for demonstration from fig 5 it can be derived that the fluctuation of c w at h t 15 is about 20 compared to its average c w at h t 1 2 varies within 2 compared to the c w average the absolute fluctuations at h t 15 and at h t 1 2 are at the same order of magnitude despite their distinctly different relative values however the average c w at h t 1 2 is 242 higher than h t 15 which is one order of magnitude larger than the individual fluctuations it means that shallow water effect on c w of the kcs is one order of magnitude larger than the influence of y for c f at h t 15 a different choice of y will cause 3 differences in c f compared to its average value for both conditions with and without free surface besides for the same choice of y whether the free surface is considered will hardly change c f 1 for c f at h t 1 2 similar to the deep water condition the choice of y leads to 3 difference on c f for both free surface and double body conditions nevertheless for the same y with and without free surface the difference can reach up to 6 which is much larger than in the deep water condition it should be mentioned that the influence of this discrepancy can be eliminated using equation 7 to calculate c w in deep water condition the values of c f are close to the lines given by ittc57 and katsui et al this phenomenon qualitatively proves the reliability of c f computation since none of these two lines can be seen as completely accurate for the prediction of ship s friction when y 400 the code can still provide reasonable results for c f and c w which means that placing the first grid point in the outer layer can be practically acceptable based on this code therefore since shallow water effects on c w of the kcs is one order larger than the influence of y c w is seen as independent of y in this study for each specific case the value of y for each reynolds number is already listed in table 2 for a computation with free surface and its corresponding double body calculation the same y is applied 3 2 validation the cfd code applied in this study is validated using publishedmodel tests the key variables are the free surface elevation along with the hull and the total resistance coefficient c t for the wigley hull a test with a 2 5 m long wigley model performed by kajitani et al 1983 is applied and a cfd case in deep water with n 80 close to the hull fr 0 316 and y 4 is used for the kcs an experiment with a 1 31 6 model conducted by kim et al 2001 is applied and a cfd case with n 104 close to the hull fr 0 26 and y 50 is used in fig 6 a comparison is made for the free surface elevation η generated by the cfd computation and the experimental data it can be seen that for both the wigley hull and the kcs the cfd results have a good agreement with the experiments small differences are observed in a limited area close to the bow and stern which might be caused by a high pressure gradient combined with a relatively coarse mesh a refinement of the mesh can help to improve the results however the error is located in a small area and its influence on the total resistance is not significant which will be discussed later for the wigley hull the value of c t computed by cfd code is 5 286 10 3 it is 2 65 larger than the test result given by kajitani et al c t 5 149 10 3 for the kcs the computed c t is 3 447 10 3 which is 3 10 smaller than the test result 3 557 10 3 errors in both cases are considered acceptable for a numerical calculation as a supplement the validation standard uncertainty u val can be calculated by equation 14 following the method proposed by asme ptc committee 2009 14 u v a l u n u m 2 u i n p u t 2 u d 2 where u num is the numerical uncertainty derived from the verification u input the input uncertainty and u d the standard uncertainty of the experimental data in section 3 1 since the value of u num for the kcs was discussed it is possible to calculate the u val for the kcs as the spatial discretization uncertainty is two orders higher than the temporal discretization uncertainty the former is used to represent the u num in addition since the input parameters such as the velocity free surface position etc are exactly the same as in the real world the value of u input can be seen as negligible for the uncertainty of experiments u d of the total resistance a value of 1 was provided for the kcs kim et al 2001 consequently based on equation 14 the validation standard uncertainty u val for the kcs is derived as 2 01 which is seen as acceptable for a simulation therefore it is concluded that the selected code with the settings used in this study is able to generate acceptable results of both wave profile and ship resistance it will be used for the systematic calculations in the following section 4 results and discussion 4 1 cfd results and analysis cfd results of c w calculated following the method mentioned in section 2 1 at different scales of the wigley hull and the kcs listed in table 2 with various depth froude number fr h listed in table 3 are shown in fig 7 based on fig 7 scale effects on wave making resistance for both ships are analysed as follows when fr h 0 5422 the wave resistance coefficient c w can still be seen as independent of the reynolds number for both ships the traditional extrapolation in which c w is only a function of froude number is still reliable when fr h 0 6261 c w of the kcs at model scale begins to show significantly larger values than full scale e g c w of the kcs increases by 44 at lg re 6 0 compared to lg re 9 2 however c w of the wigley hull is insensitive to reynolds number re at this fr h which indicates that the ship form plays an important role in the scale dependency or re dependency of c w when fr h 0 6725 more significant effects of re on c w are observed for the kcs e g for fr h 0 7000 c w of the kcs increases by 218 6 at lg re 6 0 compared to lg re 9 2 the increment of c w 1 446 10 3 at lg re 6 0 even reaches the same order of magnitude as c f 1 823 10 3 at lg re 9 2 such a change of c w is 14 9 of c t at the model scale and takes approximately 46 6 of c t at full scale for slender ships such as the wigley hull however much smaller increments 27 of c w can be found at low re range and will also not cause large errors on c t even for fr h 0 6725 in general scale effects on c w are decreasing with an increasing reynolds number this is in line with the common sense that the effect of viscosity on ship resistance becomes smaller when the reynolds number is larger therefore the traditional assumption that the wave making resistance coefficient is independent of ship model scales is still valid at fr h 0 5422 for both ships and with all values of fr h for slender ships like the wigley hull in these conditions the conventional extrapolation of ship resistance from model tests can be applied in shallow water without any corrections however the extrapolation should be reevaluated when 0 5422 fr h 0 7000 for fuller ships like the kcs since its re dependency of c w is confirmed in this study 4 2 discussion according to the analysis in section 4 1 when the reynolds number is relatively low and the ship is relatively full the kcs an obvious increase at c w is found in shallow water coincidently the frictional resistance coefficient c f also increases compared to full scale ships in similar conditions zeng et al 2019a this phenomenon provides a hint that the changes in c w in shallow water have a strong relationship with the changes in c f for the model scale the thickness of the boundary layer on the ship s bottom can reach the same magnitude as the under keel clearance ukc however this generally does not apply to full scale ships an example is given in fig 8 in this figure contours of velocity for part of the space under the kcs are shown for lg re 6 0 and lg re 9 2 as is depicted in fig 8 the boundary layer on the ship s bottom at lg re 6 0 is much more obvious compared to lg re 9 2 for lg re 6 0 the boundary layer grows faster from the bow to the stern making the flow velocity and also pressure distribution in the under keel space completely different from the scenario of lg re 9 2 therefore the similarity of flow structures at model scale and full scale cannot be guaranteed in shallow water this is the physical explanation for why yet unconsidered scale effects need to be considered in shallow water since the flow field around the hull is altered by shallow water and viscosity the shear stress c f related and the pressure c w related on the ship hull are also changed accordingly and simultaneously thus as mentioned before a relationship between the changes at c w and the changes at c f in shallow water is expected if this relationship is established performing computations with free surface only can provide enough information to estimate possible scale effects on c w in this case the efforts of conducting double body computations can be saved in this study δc w or δc f is defined by subtracting c w or c f in a shallow water case by c w or c f in the deep water case at the same re and fr h i e δc w or δc f represents shallow water effects on the wave making or frictional resistance coefficient based on the cfd results δc w plotted against δc f for both the wigley hull and the kcs are shown in fig 9 for wigley hull the maximum δc f is less than 3 0 10 4 and the corresponding δc w is about 3 0 10 4 however for the kcs which is much fuller than the wigley hull the maximum δc f is about 8 0 10 3 and the corresponding δc w reaches 15 0 10 4 which is four times larger than in the wigley case this phenomenon reveals the ship form dependency of both δc f and δc w based on all the points in fig 9 a relation between δc f and δc w can be fitted with r 2 0 96 coefficient of determination using matlab fr h 0 7 15 δ c w 1596 δ c f 2 0 183 δ c f based on equation 15 if the frictional resistance of a ship increases due to shallow water effects the wave resistance of this ship will also increase accordingly this generally confirms the strong relationship between δc f and δc w and the viscosity dependency of c w in shallow water is also consolidated it should be pointed out that the character h t does not appear in equation 15 because shallow water effects have already been included in δc f equation 15 is applicable for the wigley hull and the kcs when fr h 0 7 which is in line with the range implemented in this study furthermore based on fig 5 right part c f derived from double body computations shows minor differences compared to computations with free surface therefore the increase of c f due to shallow water effects provided by double body computations can also be used to predict the scale effects on c w even though its physical basis is not as strong as equation 15 in this case only double body calculations are required and computations with free surface which demand more computing efforts can be avoided finally a recommendation is given for resistance tests in shallow water if the bank effects are at an acceptablely low level the ship model should be as large as possible to reduce scale effects on the wave making resistance particularly for relatively full ships which are more sensitive to limited water depth the extrapolation of resistance to full scale should be reevaluated in shallow water cases 5 conclusions in this study the scale effects on the coefficient of wave making resistance c w in shallow water have been discussed for two distinct hull forms the wigley hull and the kcs an approach for obtaining c w separately is discussed based on cfd computations with and without free surface after calculating c w with different values of y the effect of water depth on c w is shown to be one order higher than the effect of y based on the results of c w at different ship model scales several conclusions can be drawn as follows the traditional assumption that the wave making resistance coefficient is independent of ship model scale is still valid for fr h 0 5422 and all values of fr h for slender ships like the wigley hull scale effects are observed for a relatively full ship in shallow water i e the conditions of the kcs at 0 5422 fr h 0 7000 for these conditions reynolds number has a significant influence on c w and the traditional extrapolation of resistance to full scale should be reconsidered a strong relationship is found for the changes in the coefficient of frictional resistance c f and the changes in c w between model scale and full scale this finding can help to save computing efforts i e the alterations in c f which are easier to determine in numerical computations can be applied to predict scale effects on c w in general scale effects on c w decrease with an increasing reynolds number if the bank and blockage effects are at an acceptably low level the ship model should be as large as possible to reduce scale effects on wave making resistance the hull form dependency of the scale effects on c w is observed in this study but detailed effects of ship parameters cannot be provided since only two ship forms are analysed more ships with different dimensions and hull coefficients are required to provide more usable information which is recommended for future research credit authorship contribution statement qingsong zeng conceptualization methodology software validation formal analysis investigation writing original draft robert hekkenberg methodology resources supervision writing review editing cornel thill validation resources supervision writing review editing hans hopman supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work is financially supported by the china scholarship council csc no 201506950009 the authors also appreciate the contribution of cartesius the dutch national supercomputer with pilot project no 17172 based on which most numerical computations in this study are realized 
21701,the conventional extrapolation of ship resistance from model tests to full scale presumes that the coefficient of wave making resistance c w depends on the froude number only this leads to the assumption that c w of a ship is identical to c w of its scaled model however this assumption is challenged in shallow water due to viscous effects which are represented by the reynolds number re in this study different scales different re of the wigley hull and the kcs hull are used to investigate the scale effects on c w numerically after verification and validation systematic computations are performed for both ships and their scaled models in various shallow water conditions based on the results significantly larger values of c w are found for the kcs at model scale in very shallow water suggesting that the conventional extrapolation has to be reconsidered additionally this study reveals the relationship between the changes in frictional resistance coefficient c f and the changes in c w caused by shallow water which benefits the prediction of shallow water effects on c w finally use of a larger ship model where the re is also higher is recommended for resistance tests in shallow water to reduce scale effects on c w keywords scale effect wave making resistance resistance extrapolation shallow water 1 introduction generally it is not easy to obtain the resistance of a full scale ship directly conducting ship model tests therefore acts as an important technique to predict the full scale ship resistance during the tests the coefficient of wave making resistance c w is commonly assumed to be a function of froude number fr only i e independent of viscosity thus c w remains identical for a ship and its scaled model ittc 2017a this assumption acts as the basis of resistance extrapolation from model scale to full scale after model tests however researchers have shown that viscosity does have an effect on ship generated waves ship generated waves will be damped by water viscosity and cumberbatch 1965 found that the diverging wave system is damped more heavily than the transverse waves calculations conducted by gotman 2002 showed that a part of the bow wave system is damped by viscosity and will not participate in the interaction with the stern wave system likewise the stern wave system is also damped during its propagation as a result c w achieved in viscous flow is also different from that using potential theory for instance small errors might be caused due to the damping if one uses wave cut analysis sharma 1963 to obtain c w as indicated by stern 1986 the development of the ship s boundary layer is influenced by ship waves the other way around ship waves will be affected also by the alternation of the ship s boundary layer consequently similar to the frictional resistance coefficient c f which strongly depends on the ship s boundary layer c w will also show scale effects here being described by the reynolds number re according to the numerical calculations conducted by raven et al 2008 the wave height of ship generated waves at full scale is larger than that at model scale indicating that the computed c w at model scale underestimates a real ship s wave making resistance furthermore more recently terziev et al 2018 using a geosim analysis argued that c w does not show clear relationship with neither scale factors nor re although it was demonstrated that c w is a function of both froude number and reynolds number a difference in c w caused by scale effects is generally a small part of the total resistance in deep water for instance raven et al 2008 computed c w at both model scale and full scale for the hamburg test case and the difference between the two values is about 3 3 of the total resistance at full scale besides terziev et al 2018 examined the kcs and the change in c w between model scale and full scale was up to 13 1 of the total resistance at full scale after using the traditional extrapolation method ittc 2017a those differences at c w will not make a big difference 5 in the total resistance at full scale zeng 2019 nevertheless more significant discrepancies can be observed in shallow water the most obvious difference in ship generated waves is the change in the angle of the divergent waves known as kelvin angle based on which the subcritical speed regime critical regime and supercritical regime are determined havelock 1908 generally the value of c w rises significantly when the depth froude number fr h approaches the critical region fr h 1 but decreases rapidly immediately after this region in the supercritical region the trend that c w increases with fr h is restored since most shallow water vessels sail within the subcritical regime this study will specifically focus on this regime in this regime wave properties will be subject to change compared to the deep water case for instance ship generated waves will become faster lamb 1932 higher putnam and johson 1949 and longer mucha et al 2016 in shallow water restricted space accelerates the flow around the hull and as a result the ship s boundary layer becomes thinner and the wave resistance related to the ship s boundary layer is altered accordingly additionally the presence of bottom friction can cause a shear current above the fairway floor ellingsen 2014 li and ellingsen 2016 and an extra boundary layer is formed there this additional boundary layer can induce a shrinkage in the ship s boundary layer due to restricted under keel clearance the problem will become even more complicated when these two boundary layers touch each other and such a situation is expected to vary with reynolds number thus a hypothesis is proposed that scale effects on c w will be more significant in shallow water according to this study the difference of c w between model scale and full scale can reach 46 6 of the total resistance of a ship at full scale therefore the basis of resistance extrapolation i e c w is insensitive to re as mentioned above is challenged however to the best of the authors knowledge there is no research considering scale effects and shallow water effects on c w simultaneously this study is performed to understand the mechanism of scale effects on c w and to improve the reliability of the ship s resistance extrapolation in shallow water cfd computational fluid dynamics techniques are applied to obtain c w separately two distinct hull forms the wigley hull and the kcs kriso container ship hull for both of which a large amount of validation data exists are used in this investigation since the purpose is to reveal the mechanism of scale effects on c w in shallow water the trim sinkage propulsion system and ship appendices which are not decisive factors for this mechanism are not considered for simplification this article contains five sections section 2 discusses a method for calculating c w and the setup of numerical cases section 3 shows the verification and validation v v results and analysis are given in section 4 and conclusions are drawn in section 5 2 method 2 1 the approach for obtaining wave making resistance numerically nominally the wave making resistance r w is caused by the energy transferred from the ship hull to the wave system in deep water where the effects of viscosity on r w are minor wave pattern resistance can be seen as the whole wave making resistance and can be calculated both numerically through inviscid cfd computations raven 1996 and experimentally through e g the wave cut analysis sharma 1963 however the accuracy of both methods aforementioned is threatened by the combination of viscosity effects and shallow water effects zeng et al 2019b a popular way to obtain r w separately is conducting two types of resistance test one with free surface and another with the free surface suppressed double body test for a bare hull the coefficient of the total resistance c t can be decomposed into three parts coefficients of frictional resistance c f viscous pressure resistance c vp and wave making resistance c w which is shown in equation 1 1 c t c f c v p c w in equation 1 c f is calculated by integrating the shear force on the hull surface in equation 2 below subscripts fre and dou are used to represent the results from the scenarios with free surface and double body tests respectively as the c w dou 0 the difference of c t between the two types of situation can be written as 2 c t f r e c t d o u c f f r e c v p f r e c w c f d o u c v p d o u 1 k f r e c f f r e 1 k d o u c f d o u c w the symbol k indicates the form factor which is the ratio between c vp and c f based on equation 2 c w can be obtained through 3 c w c t f r e c t d o u 1 k f r e c f f r e 1 k d o u c f d o u on the right side of equation 3 the variable k fre cannot be achieved directly and precisely through cfd calculations to solve this problem two methods to determine c w exist assumption i 4 1 k f r e c f f r e 1 k d o u c f d o u the above assumption indicates that the viscous part of resistance computed with free surface is exactly the same as the total resistance achieved by a double body calculation based on this assumption equation 3 becomes 5 c w c t f r e c t d o u therefore c w is simply the difference between the total forces calculated with and without free surface this approach is applied frequently especially with the development of cfd techniques e g raven et al 2008 however the treatment mentioned above requires the viscous part of the resistance to be identical in both cases if c f in one case is higher than another c vp should be lower to maintain assumption i based on this c vp appears to be inversely proportional to c f which contradicts the conventional understanding of the form factor to remedy this contradiction the second approach can be applied assumption ii 6 k f r e k d o u equation 6 assumes the form factor k remains the same for both cases with free surface and its corresponding double body test since most ships in shallow water navigate at a relatively low speed waves generated by the ship hull generally have a small wave height which makes the pressure distribution on the hull as well as the wetted surface almost identical between the cases with and without free surface except for very limited areas near the free surface in addition for the two ships i e the wigley hull and the kcs as will be discussed in section 2 2 1 that will be used in this study the streamlined stern helps prevent wave induced flow separation at the aft by which the pressure field behind the stern remains similar for both conditions thus the forces on the hull are similar for both cases with and without free surface therefore since c f and c vp are computed based on the same wetted surface the form factor can thus be seen as identical with minor errors for both cases i e c vp is proportional to c f which underpins assumption ii mentioned above consequently equation 3 becomes 7 c w c t f r e c t d o u 1 k d o u c f f r e c f d o u assumption ii will be implemented in this study all coefficients on the right side of equation 7 can be obtained through cfd computations which makes it possible to determine c w separately and numerically in shallow water 2 2 setup of cases 2 2 1 ship information in this study the ship model scale which is expressed by the reynolds number re is proposed as an additional influencing factor on wave making resistance in shallow water i e c w f fr re according to the research of zeng et al 2019a a ship with a higher block coefficient c b which represents the fullness of a ship tends to show more obvious scale effects on the viscous part of the resistance in shallow water therefore the scale effects on c w depend on the ship s fullness and two ships with a distinctly different fullness the wigley hull and the kcs are selected since a large amount of validating data is available the underwater part for each ship is shown in fig 1 the wigley hull is a representative of slender ships it has no flat bottom and c b 0 445 the surface of the wigley hull can be defined precisely by equation 8 e g kajitani et al 1983 8 y b l 1 2 x l 2 1 z t 2 where b is the ship s beam l the ship s length due to the symmetry of the wigley hull the length between perpendiculars l pp is identical to l and x y z are the coordinates in a cartesian coordinate system x is positive in the navigation direction y is positive to port and z is positive upward this coordinate system is also valid for the kcs except for the position of the origin for the wigley hull the origin is the intersection of the midsection the symmetric plane and the design waterline plane for the kcs the origin is the intersection of the aft perpendicular and the zero waterline plane compared to the wigley hull the kcs hull has a much fuller shape c b 0 651 and a large area of the flat bottom see e g kim et al 2001 for more details more information about these two ships at full scale is listed in table 1 for the full scale wigley hull the length and the design velocity are set deliberately to 75 m and 5 196 m s corresponding to 18 705 km h for an inland vessel respectively which are representative values for typical inland ships the velocity of the full scale kcs is 7 893 m s at which the depth froude number fr h is the same as the wigley hull thus enabling a clear comparison specific values of velocities are determined based on an easily interpretable value of reynolds number re i e lg re 8 50 for the wigley hull and lg re 9 20 for the kcs at full scale to study scale effects on wave making resistance different scale factors that lead to a length of ship models within 1 5 m 15 m are selected which covers the typical range of the model length used by most towing tanks in the world again specific values for the scale factor are chosen to ensure the wigley hull and the kcs hull have the same value of re as shown in table 2 it should be pointed out that the re starts at lg re 6 0 although a laminar boundary layer would cover half of a flat plate at lg re 6 0 based on the research of eça and hoekstra 2008 it is found that for the ship hulls in this study about 90 instead of 50 of the hull will be covered with a turbulent boundary layer due to the initial turbulence intensity and the 3d hull effects thus the influence of the laminar flow at lg re 6 0 can be considered as negligible in the computation of ship resistance for each selected ship the froude number fr is kept as constant a commonly used non dimensional factor y which represents how far the first grid point is located from the wall for each case is also shown in table 2 the value of y is estimated prior to the calculations as will be discussed in detail in section 3 1 1 2 2 2 waterway dimensions shallow water conditions are realized by adjusting the vertical position of the waterway floor which can be described by the water depth ship draft ratio h t four shallow water scenarios with h t equals 2 0 1 5 1 3 and 1 2 are applied and one deep water case h t 15 is included for comparison as shown in table 3 combined with table 2 there will be 70 cases in total in this study in this study the waterway is assumed to be only limited in water depth thus the lateral boundary should be far enough away from the ship to avoid blockage effects regardless of the boundary condition assigned to it according to ittc 2017 and also the cfd computations performed by zeng et al 2019a the blockage factor m which is the ratio between the area of ship s midsection and the area of the wetted waterway section should be less than 3 to eliminate blockage effects therefore the water width ship length ratio w l pp is adjusted to meet the requirement as shown also in table 3 for comparison purposes the depth froude numbers fr h for the wigley hull and the kcs are designed to be identical for each h t fr h higher than 0 7000 is rarely found for vessels sailing in shallow water and is therefore not discussed 2 2 3 numerical settings 2 2 3 1 computational domain and boundary conditions due to the symmetry of the ship half of the domain is used in the computations the inlet boundary is 1 l pp in front of the ship and the outlet boundary is 3 l pp behind the ship for cases with free surface the top boundary is located 0 5 l pp above the designed waterline plane the position of the bottom varies with h t sketches for the computational domain are shown in fig 2 boundary conditions for both cases are also shown in fig 2 the ship hull is a non slip wall and fixed in the domain water comes from the inlet boundary with the same velocity as the ship s design speed the bottom boundary is a moving wall which is non slip and moving at the same speed as the incident flow for computations without free surface the dirichlet boundary condition is applied for the velocity inlet boundary where the value of input velocity is given before simulations the neumann boundary condition is used for the outflow boundary where the diffusion flux for all flow variables is zero in the direction normal to the outlet plane for computations with free surface the vof volume of fluid technique and the open channel boundary condition are used to adjust to the open channel method pressure inlet and pressure outlet are applied for the inlet and outlet boundary respectively 2 2 3 2 mesh and solver for all cases in this study a hexahedral mesh is generated through icem version 18 1 the underwater part of the mesh is identical for the condition with free surface and its corresponding double body case in terms of c w calculation the grids close to the hull and the waterway floor are refined in order to properly capture the complexity of the flow an example is shown in fig 3 for the kcs with h t 1 2 the thickness of the first layer of the mesh adjacent to the hull depends on the choice of y which will be discussed in detail in section 3 1 verification all cfd computations are run on a commercial solver ansys fluent version 18 1 the turbulence is resolved approximately by solving the reynolds averaged navier stokes rans equations with the application of the sst k ω model the steady pressure based solver is used the pressure and the velocity are calculated in a coupled manner the discretization methods for gradient and pressure are least squares cell based and presto pressure staggering option respectively the discretization method is second order upwind for momentum turbulent kinetic energy and specific dissipation rate 3 verification and validation in this section the code fluent is firstly verified by evaluating the uncertainties of spatial discretization the uncertainties of temporal discretization and the effects of y on wave making resistance afterward the code is validated by computing the wave profile close to the ship hull and the total resistance 3 1 verification 3 1 1 spatial discretization uncertainty in the solver fluent the velocity and the pressure in the flow field are not solved continuously their values are calculated in the center of the grid cells and the interpolation method is utilized if no computed point exists thus to reduce the numerical errors caused by mesh to an acceptable level the uncertainties of the spatial discretization are evaluated this verification follows the method proposed by eça and hoekstra 2014 which is shown as follows 9 s r e φ 0 β p i 1 n φ i φ 0 β α i p 2 where φ i is the key variable to be evaluated which will be the frictional resistance coefficient c f and the total resistance coefficient c t φ 0 β p are constants derived from a fitting curve of φ i the value of p indicates the order of accuracy the uncertainty can be obtained through 10 u φ i f s φ i φ 0 s d φ i φ 0 β α i p where s d is the standard deviation f s 1 25 if 0 5 p 2 1 otherwise f s 3 in order to use this method at least four sets of mesh are required in the experiments conducted by kim et al 2001 a 1 31 6 ship model of the kcs is applied the froude number is 0 26 and is also used in this verification the refinement factor r in each direction is 1 25 and four sets of mesh are implemented in table 4 the number of grid cells the results of c f and c t and the number of grid nodes per wavelength n are listed in this verification a constant value of y 50 is used it was determined prior to the simulations through equation 11 11 y u y υ u τ ρ τ c f 57 1 2 ρ v 2 where u is the friction velocity y is the exact distance m of the first grid point from the wall υ water kinematic viscosity τ the shear stress ρ water density c f57 the frictional resistance coefficient calculated by the ittc 1957 line and v the water velocity based on table 4 the method of eça and hoekstra 2014 mentioned above is applied to calculate the uncertainties of c f and c t generally the geometrical similarity should be maintained in the complete computational field based on this assumption the distance between the first grid point and the wall described by y varies in those grid sets however different values of y also determine whether a wall function is applied or not and the results of c f will be affected accordingly consequently scatters might be caused leading to an unprecise asymptotic region therefore a constant wall y is applied and the grid distribution in other places is geometrically similar the spatial discretization errors and uncertainties of c f and c t of the 1 31 6 kcs for the finest mesh mesh set no 1 are calculated and shown in table 5 table 5 shows that the uncertainties of both c f and c t caused by spatial discretization are less than 2 which is acceptable for a numerical calculation therefore the finest grid set is selected in the subsequent sections however the spatial convergence study is specifically for the 1 31 6 scaled kcs at fr 0 26 and y 50 as mentioned in section 2 2 2 there will be 70 cases in total it is not practical to perform such verification for all cases therefore a more general rule which is the number of nodes per wavelength applicable to all other cases is discussed since the density of grid points per wave period determines the accuracy of wave profile and thus influences the wave making resistance the number of nodes per wave height and or per wavelength is a good candidate to act as a general key factor for spatial convergence study in this subsection the number of grid points over the height of the wave is about 10 and the aspect ratio of the cells near the free surface is at the magnitude of 10 this setting was proven to be suitable and increasing the number of grid points in one wave height will make a minor contribution to the sharpness of the wave profile javanmardi 2015 therefore this study will focus on the choice of the number of grid points per wavelength linear wave theory airy 1841 is applied to predict the number of wavelengths along with the ship hull based on this theory the number of ship generated waves within a ship length distance n is a function of froude number fr 12 n 1 2 π f r 2 equation 12 makes it possible to estimate the wavelength and thus the number of grid points per wavelength n before numerical calculations in table 4 the value of n for each mesh set is shown in the last column a wave cut at y 2b is depicted in fig 4 for each case in the range of x 2 5 l pp 1 5 l pp based on fig 4 it can be found that the wave profile generated with n 56 has a relatively large deviation compared to n 104 where the wave profile is assumed to be the most accurate therefore n 56 is not considered for the area close to the hull where a high accuracy of the wave profile is required in the range of n 70 104 the sharpness of the wave profile increases with a refinement of the mesh but the differences are becoming smaller which means the refinement of the mesh only makes small contributions to the wave sharpness therefore to balance the accuracy and computation costs n 56 is guaranteed for the far field and n 70 is guaranteed for the area close to the ship hull by which the accuracy of the calculated resistance and the wave sharpness close to the hull are assured the number of cells finally applied for each case in deep water are shown in table 6 the number of cells for each shallow water case is not listed since the number of cells decreas corresponding to the value of under keel clearance and other parts remain the same as the deep water case 3 1 2 temporal discretization uncertainty in addition to the verification of spatial discretization an appropriate time step should be selected to guarantee a good convergence the basic requirement in a cfd computation is that the courant number c v δt δx where v is the flow velocity δt the time step applied and δx the length interval should be less than one in ittc 2017b a more rigorous requirement δt 0 01l u is suggested where l is ship length and u ship speed during the simulations a steady solver is used but the automatic pseudo transient time step is enabled in fluent δt is selected automatically ansys 2017 by 13 δ t min δ t u δ t p δ t g δ t r o t δ t c o m p r e s s where δt u is the convective time scale δt p the dynamic time scale δt g the gravitational time scale δt rot the rotational time scale and δt compress the compressible time scale details can be found in ansys 2017 the physical time step is controlled by the time scale factor in this temporal verification case no 4 in table 4 is used again the refinement factor is 1 25 and four values of the time step are applied the uncertainties caused by temporal discretization for the case δt 2 are shown in table 7 in table 7 although the uncertainties are calculated for δt 2 not the smallest time step the uncertainties for both c f and c t are very small 0 02 therefore δt 2 is used for all subsequent calculations to balance computing accuracy and time 3 1 3 the choice of y the y dependency of the wave making resistance is studied in this subsection according to ittc 2017b y 1 is recommended when a near wall turbulence model is used and 30 y 100 is recommended when a wall function is used however those suggested regions only cover a limited range of y also the value of y is not a constant along with a ship hull in the numerical results which will make the near wall meshing work extremely complicated if the rules mentioned above are met rigorously to solve this problem many industrial cfd codes apply the so called y insensitive wall treatments by using blending functions for the buffer region and the fully turbulent outer region e g the menter lechner treatment is applied for ω equation models in fluent ansys 2017 in principle the choice of y will influence the results for shear stress on a non slip wall and the frictional resistance can be affected by y in this study since wave making resistance is assumed to also depend on reynolds number the choice of y may also make a difference in the wave resistance this subsection is established to test whether the wave making resistance is invariant with y if the sst k ω model is used in fluent according to the research of zeng et al 2019a the resistance of the kcs is more sensitive to water depth than the wigley hull therefore the case of the kcs in shallow water h t 1 2 is selected for this y test about the choice of re lg re 7 4 is used since the mesh quality is generally not acceptable by the solver when y 150 for lg re 7 4 and an excessively large number of cells is obtained when y 8 for lg re 7 4 the values of y used in this study are shown in table 8 a deep water h t 15 0 case is analysed for comparison the selected y varies from 1 to 400 which spreads over all the regions in the inner and outer boundary layer due to a limitation on available physical memory cases with more than 12 million grid points are not performed which are marked by in table 8 for the case with y 400 the first computed point is in the outer layer which is included to study the usability of the code in this specific region the results of c w using the method proposed in section 2 1 are shown in fig 5 cfd results of c f and the results calculated by ittc 1957 and katsui et al 2005 are also shown for demonstration from fig 5 it can be derived that the fluctuation of c w at h t 15 is about 20 compared to its average c w at h t 1 2 varies within 2 compared to the c w average the absolute fluctuations at h t 15 and at h t 1 2 are at the same order of magnitude despite their distinctly different relative values however the average c w at h t 1 2 is 242 higher than h t 15 which is one order of magnitude larger than the individual fluctuations it means that shallow water effect on c w of the kcs is one order of magnitude larger than the influence of y for c f at h t 15 a different choice of y will cause 3 differences in c f compared to its average value for both conditions with and without free surface besides for the same choice of y whether the free surface is considered will hardly change c f 1 for c f at h t 1 2 similar to the deep water condition the choice of y leads to 3 difference on c f for both free surface and double body conditions nevertheless for the same y with and without free surface the difference can reach up to 6 which is much larger than in the deep water condition it should be mentioned that the influence of this discrepancy can be eliminated using equation 7 to calculate c w in deep water condition the values of c f are close to the lines given by ittc57 and katsui et al this phenomenon qualitatively proves the reliability of c f computation since none of these two lines can be seen as completely accurate for the prediction of ship s friction when y 400 the code can still provide reasonable results for c f and c w which means that placing the first grid point in the outer layer can be practically acceptable based on this code therefore since shallow water effects on c w of the kcs is one order larger than the influence of y c w is seen as independent of y in this study for each specific case the value of y for each reynolds number is already listed in table 2 for a computation with free surface and its corresponding double body calculation the same y is applied 3 2 validation the cfd code applied in this study is validated using publishedmodel tests the key variables are the free surface elevation along with the hull and the total resistance coefficient c t for the wigley hull a test with a 2 5 m long wigley model performed by kajitani et al 1983 is applied and a cfd case in deep water with n 80 close to the hull fr 0 316 and y 4 is used for the kcs an experiment with a 1 31 6 model conducted by kim et al 2001 is applied and a cfd case with n 104 close to the hull fr 0 26 and y 50 is used in fig 6 a comparison is made for the free surface elevation η generated by the cfd computation and the experimental data it can be seen that for both the wigley hull and the kcs the cfd results have a good agreement with the experiments small differences are observed in a limited area close to the bow and stern which might be caused by a high pressure gradient combined with a relatively coarse mesh a refinement of the mesh can help to improve the results however the error is located in a small area and its influence on the total resistance is not significant which will be discussed later for the wigley hull the value of c t computed by cfd code is 5 286 10 3 it is 2 65 larger than the test result given by kajitani et al c t 5 149 10 3 for the kcs the computed c t is 3 447 10 3 which is 3 10 smaller than the test result 3 557 10 3 errors in both cases are considered acceptable for a numerical calculation as a supplement the validation standard uncertainty u val can be calculated by equation 14 following the method proposed by asme ptc committee 2009 14 u v a l u n u m 2 u i n p u t 2 u d 2 where u num is the numerical uncertainty derived from the verification u input the input uncertainty and u d the standard uncertainty of the experimental data in section 3 1 since the value of u num for the kcs was discussed it is possible to calculate the u val for the kcs as the spatial discretization uncertainty is two orders higher than the temporal discretization uncertainty the former is used to represent the u num in addition since the input parameters such as the velocity free surface position etc are exactly the same as in the real world the value of u input can be seen as negligible for the uncertainty of experiments u d of the total resistance a value of 1 was provided for the kcs kim et al 2001 consequently based on equation 14 the validation standard uncertainty u val for the kcs is derived as 2 01 which is seen as acceptable for a simulation therefore it is concluded that the selected code with the settings used in this study is able to generate acceptable results of both wave profile and ship resistance it will be used for the systematic calculations in the following section 4 results and discussion 4 1 cfd results and analysis cfd results of c w calculated following the method mentioned in section 2 1 at different scales of the wigley hull and the kcs listed in table 2 with various depth froude number fr h listed in table 3 are shown in fig 7 based on fig 7 scale effects on wave making resistance for both ships are analysed as follows when fr h 0 5422 the wave resistance coefficient c w can still be seen as independent of the reynolds number for both ships the traditional extrapolation in which c w is only a function of froude number is still reliable when fr h 0 6261 c w of the kcs at model scale begins to show significantly larger values than full scale e g c w of the kcs increases by 44 at lg re 6 0 compared to lg re 9 2 however c w of the wigley hull is insensitive to reynolds number re at this fr h which indicates that the ship form plays an important role in the scale dependency or re dependency of c w when fr h 0 6725 more significant effects of re on c w are observed for the kcs e g for fr h 0 7000 c w of the kcs increases by 218 6 at lg re 6 0 compared to lg re 9 2 the increment of c w 1 446 10 3 at lg re 6 0 even reaches the same order of magnitude as c f 1 823 10 3 at lg re 9 2 such a change of c w is 14 9 of c t at the model scale and takes approximately 46 6 of c t at full scale for slender ships such as the wigley hull however much smaller increments 27 of c w can be found at low re range and will also not cause large errors on c t even for fr h 0 6725 in general scale effects on c w are decreasing with an increasing reynolds number this is in line with the common sense that the effect of viscosity on ship resistance becomes smaller when the reynolds number is larger therefore the traditional assumption that the wave making resistance coefficient is independent of ship model scales is still valid at fr h 0 5422 for both ships and with all values of fr h for slender ships like the wigley hull in these conditions the conventional extrapolation of ship resistance from model tests can be applied in shallow water without any corrections however the extrapolation should be reevaluated when 0 5422 fr h 0 7000 for fuller ships like the kcs since its re dependency of c w is confirmed in this study 4 2 discussion according to the analysis in section 4 1 when the reynolds number is relatively low and the ship is relatively full the kcs an obvious increase at c w is found in shallow water coincidently the frictional resistance coefficient c f also increases compared to full scale ships in similar conditions zeng et al 2019a this phenomenon provides a hint that the changes in c w in shallow water have a strong relationship with the changes in c f for the model scale the thickness of the boundary layer on the ship s bottom can reach the same magnitude as the under keel clearance ukc however this generally does not apply to full scale ships an example is given in fig 8 in this figure contours of velocity for part of the space under the kcs are shown for lg re 6 0 and lg re 9 2 as is depicted in fig 8 the boundary layer on the ship s bottom at lg re 6 0 is much more obvious compared to lg re 9 2 for lg re 6 0 the boundary layer grows faster from the bow to the stern making the flow velocity and also pressure distribution in the under keel space completely different from the scenario of lg re 9 2 therefore the similarity of flow structures at model scale and full scale cannot be guaranteed in shallow water this is the physical explanation for why yet unconsidered scale effects need to be considered in shallow water since the flow field around the hull is altered by shallow water and viscosity the shear stress c f related and the pressure c w related on the ship hull are also changed accordingly and simultaneously thus as mentioned before a relationship between the changes at c w and the changes at c f in shallow water is expected if this relationship is established performing computations with free surface only can provide enough information to estimate possible scale effects on c w in this case the efforts of conducting double body computations can be saved in this study δc w or δc f is defined by subtracting c w or c f in a shallow water case by c w or c f in the deep water case at the same re and fr h i e δc w or δc f represents shallow water effects on the wave making or frictional resistance coefficient based on the cfd results δc w plotted against δc f for both the wigley hull and the kcs are shown in fig 9 for wigley hull the maximum δc f is less than 3 0 10 4 and the corresponding δc w is about 3 0 10 4 however for the kcs which is much fuller than the wigley hull the maximum δc f is about 8 0 10 3 and the corresponding δc w reaches 15 0 10 4 which is four times larger than in the wigley case this phenomenon reveals the ship form dependency of both δc f and δc w based on all the points in fig 9 a relation between δc f and δc w can be fitted with r 2 0 96 coefficient of determination using matlab fr h 0 7 15 δ c w 1596 δ c f 2 0 183 δ c f based on equation 15 if the frictional resistance of a ship increases due to shallow water effects the wave resistance of this ship will also increase accordingly this generally confirms the strong relationship between δc f and δc w and the viscosity dependency of c w in shallow water is also consolidated it should be pointed out that the character h t does not appear in equation 15 because shallow water effects have already been included in δc f equation 15 is applicable for the wigley hull and the kcs when fr h 0 7 which is in line with the range implemented in this study furthermore based on fig 5 right part c f derived from double body computations shows minor differences compared to computations with free surface therefore the increase of c f due to shallow water effects provided by double body computations can also be used to predict the scale effects on c w even though its physical basis is not as strong as equation 15 in this case only double body calculations are required and computations with free surface which demand more computing efforts can be avoided finally a recommendation is given for resistance tests in shallow water if the bank effects are at an acceptablely low level the ship model should be as large as possible to reduce scale effects on the wave making resistance particularly for relatively full ships which are more sensitive to limited water depth the extrapolation of resistance to full scale should be reevaluated in shallow water cases 5 conclusions in this study the scale effects on the coefficient of wave making resistance c w in shallow water have been discussed for two distinct hull forms the wigley hull and the kcs an approach for obtaining c w separately is discussed based on cfd computations with and without free surface after calculating c w with different values of y the effect of water depth on c w is shown to be one order higher than the effect of y based on the results of c w at different ship model scales several conclusions can be drawn as follows the traditional assumption that the wave making resistance coefficient is independent of ship model scale is still valid for fr h 0 5422 and all values of fr h for slender ships like the wigley hull scale effects are observed for a relatively full ship in shallow water i e the conditions of the kcs at 0 5422 fr h 0 7000 for these conditions reynolds number has a significant influence on c w and the traditional extrapolation of resistance to full scale should be reconsidered a strong relationship is found for the changes in the coefficient of frictional resistance c f and the changes in c w between model scale and full scale this finding can help to save computing efforts i e the alterations in c f which are easier to determine in numerical computations can be applied to predict scale effects on c w in general scale effects on c w decrease with an increasing reynolds number if the bank and blockage effects are at an acceptably low level the ship model should be as large as possible to reduce scale effects on wave making resistance the hull form dependency of the scale effects on c w is observed in this study but detailed effects of ship parameters cannot be provided since only two ship forms are analysed more ships with different dimensions and hull coefficients are required to provide more usable information which is recommended for future research credit authorship contribution statement qingsong zeng conceptualization methodology software validation formal analysis investigation writing original draft robert hekkenberg methodology resources supervision writing review editing cornel thill validation resources supervision writing review editing hans hopman supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work is financially supported by the china scholarship council csc no 201506950009 the authors also appreciate the contribution of cartesius the dutch national supercomputer with pilot project no 17172 based on which most numerical computations in this study are realized 
21702,a variety of cylinder configurations are used in civil engineering applications however upstream structures can disturb incoming flows and cause the instability of downstream structures in this study the wake induced vibrations wiv of two tandem cylinders were numerically simulated at subcritical reynolds numbers the effectiveness of the numerical method was demonstrated by comparing with previous experimental results the energy transmission during the occurrence of wiv was investigated in detail and the effect of the damping ratio on energy transmission was further studied the results showed that the wiv of the downstream cylinder can effectively absorb flow energy and the absorbed energy fluctuates and roughly increases over time when compared with vortex induced vibration a downstream cylinder can absorb more energy during the occurrence of wiv and the absorbed energy increases as the reduced velocity of the incoming flow increases in addition although structural damping reduces the vibration amplitude it promotes the energy transmission in wiv and the power of the flow force and the power coefficient linearly increase as the damping ratio increases keywords flow induced vibration wake induced vibration tandem cylinders energy transmission 1 introduction a variety of cylinder configurations such as stay cables suspenders and oil pipelines have been widely used in civil engineering applications they are prone to wind or flow induced vibrations chen et al 2015 jing et al 2017 2018 gao et al 2018 specifically when cylinders are tandemly arranged the upstream structures disturb the incoming flow and cause instability in downstream structures this type of flow induced vibration is referred to as wake induced vibration wiv research on wiv began in the first half of the 20th century carmo 2009 sumner 2010 and bearman 2011 comprehensively reviewed the progress achieved before 2010 previous studies primarily focused on the flow patterns aerodynamic hydraulic force coefficient response characteristics and wiv excitation mechanisms for downstream cylinders igarashi 1981 1984 investigated the flow field of two tandem circular cylinders when the ratio of the distance between the cylinder centers to the cylinder diameter l d varied from 1 03 to 5 0 they classified the flow field into six patterns with respect to the l d and reynolds number r e u d ν where u is the incoming wind speed and ν is the kinematic viscosity zdravkovich 1987 subdivided these flow patterns into three basic types 1 single bluff body behavior 1 0 l d 1 2 1 8 2 shear layer attachment behavior 1 2 1 8 l d 3 4 3 8 and 3 cylinder vortex shedding behavior 3 4 3 8 l d similar classifications were proposed by xu and zhou 2004 zhou and yiu 2006 and carmo et al 2010 2011 gu and sun 1999 and sumner et al 2000 2005 investigated the flow features of staggered cylinders gu and sun 1999 classified the flow field into three patterns wake shear and neighborhood interference while sumner et al 2000 2005 classified the flow field into nine patterns recently using large eddy simulation li et al 2018 studied at small gap ratios the flow around two tandem circular cylinders near a plane wall subburaj and vengadesan 2019 numerically investigated the effect of the froude number on downstream cylinder parameters e g the mean forces and the flow characteristics at a reynolds number of 180 ma et al 2019 investigated the hydrodynamic characteristic of two tandem flexible cylinders under the spacing ratios of 4 0 6 0 8 0 10 0 and 16 0 zhang and melbourne 1992 alam et al 2003 and sumner and schenstead 2006 investigated the variation characteristics for the aerodynamic hydraulic force coefficients of cylinders in a tandem arrangement they reported that a sharp increase in the aerodynamic hydraulic force coefficients of cylinders appears when l d is in the range from 3 5 to 3 8 depending on reynolds number using flow visualization techniques in a flowing soap film system with r e 99 8 yang and stremler 2019 found that the experimental critical spacing for l d is in the range between 2 9 and 4 1 non inclusively assi et al 2010a studied the downstream cylinder and constructed several detailed maps of the means and fluctuations for the drag and lift force coefficients recently hu and kwok 2020 use machine learning ml techniques to train models to predict wind pressures around circular cylinders schewe and jacobs 2019 experimentally investigated the effect of reynolds numbers that varied from subcritical to trans critical values 2 105 r e 6 106 on the aerodynamic forces of two tandem circular cylinders l d 1 56 using subcritical r e 2 2 104 and supercritical r e 3 0 106 reynolds numbers hu et al 2019 numerically studied the instantaneous flows structures pressure distributions and hydrodynamic forces of two tandem cylinders when l d varied from 2 0 to 5 0 through numerical simulation at a high subcritical reynolds number of r e 1 4 105 wu et al 2019 presented three critical aerodynamic phenomena at the downstream cylinder 1 negative drag force 2 inner lift force and 3 outer lift force as l d varied from 1 5 to 4 and the incidence angle increased from 0 to 90 zdravkovich and medeiros 1991 investigated the effects of m ζ where m is the mass ratio and ζ is the damping ratio on the responses of wiv and concluded that it was challenging to suppress wiv when m ζ increased when the separation ratio l d was 4 75 hover et al 2001 observed that strong vibrations occurred for all flow velocities that were higher than a critical threshold the vibration amplitude reached 1 9d at the reduced wind speed of 17 assi et al 2006 2010a measured the responses of a pair of rigid cylinders in a water channel and observed that in the absence of unsteady vortices no wiv occurred for the downstream cylinder chaplin and batten 2014 developed a unique experiment setup in which a rigid downstream cylinder simultaneously underwent wake and vortex induced vibrations in multiple modes they speculated that the participation of higher modes or multiple direction vibrations significantly influenced the feature of the flow structure interaction li et al 2013 experimentally studied the wiv of a downstream cylinder and its characteristics including the vibration amplitude velocity range and dominant wiv frequency huera huarte and bearman 2011 and huera huarte and gharib 2011 reproduced wiv using two long flexible cylinders in a water tunnel and observed that for near wake interference 2 0 l d 4 0 the cylinders experienced three types of oscillation vortex induced vibration viv wiv and combinations of both for the far wake interference 4 0 l d 8 0 the downstream cylinder also primarily experienced wiv and exhibited larger amplitudes at higher reduced velocities recently huera huarte et al 2016 observed higher multimode vibrations and synchronization regions that were dependent on the structural modes they concluded that l d does not exert a strong influence on the vibration frequency and amplitude whereas the incoming wake enhanced the vibration amplitude to a considerable extent he et al 2018 simulated wiv in a wind tunnel and successfully suppressed it using an elastic crosstie armin et al 2018 investigated the effect of the spacing gap on the dynamic behavior of two flexibly mounted tandem cylinders at different reynolds numbers ranging from 8 7 103 to 5 2 104 similarly xu et al 2019 studied the vibration responses of tandem elastically mounted circular cylinders in a water channel under spacing gaps of l d 1 57 2 57 3 57 and 4 57 chen et al 2020 numerically simulated the complex wivs of four aligned hangers behind a bridge tower compared with the classic karman vortex shedding induced vibration chen et al 2015 and rain wind induced cable vibration jing et al 2015 2017 for circular cylinders in a group the excitation mechanisms are substantially more complicated zdravkovich 1997 proposed a wake displacement mechanism mysa et al 2016 emphasized the importance of phase lag between the lift force and vibration displacement after studying the differences between wiv and viv carmo et al 2011 reported that the physical mechanism was related to the oscillatory flow in the gap which for the downstream cylinder alternately shifted the foremost point of stillness along the curve of the wall toward the upstream assi et al 2010a 2010b and bearman 2011 addressed the importance of unsteady vortices shed from the upstream cylinder and speculated that the wiv was excited by the unsteady vortex structure interaction between the upwind wake and the downwind cylinder assi et al 2013 2014 then proposed a new concept wake stiffness to explain the characteristics of the displacement and frequency of the wiv recently due to environmental concerns and climate change renewable and clean energy has become popular hydrokinetic energy as a renewable source has attracted attention khan et al 2009 hu et al 2016 derakhshandeh et al 2015 tried to absorb the hydrokinetic energy in wiv and experimentally investigated the effects of cylinder arrangements and reynolds numbers on the energy absorption of downstream cylinders their results showed that wiv has great potential for hydrokinetic energy absorption ding et al 2019 numerically studied tandem cylinders on springs with the 2d spalart allmaras turbulence model for hydrokinetic power conversion at reynolds numbers of 30 000 r e 120 000 however since it is a new concept a study on the efficiency of energy absorption in the wiv process is insufficient to understand the characteristics and mechanisms of wiv energy convertors in this study the wiv of two tandem cylinders is investigated through computational fluid dynamic cfd simulation at subcritical reynolds numbers 3750 18750 the energy transmission in wiv and the effect of the damping ratio on energy transmission are analyzed using a time domain method 2 methodology and model 2 1 physical model two cylinders were arranged in tandem as shown in fig 1 the diameter d of both cylinders is 50 mm and the center to center distance l of the two cylinders is 200 mm resulting in an l d of 4 the upstream cylinder was rigidly fixed and the downstream cylinder was mounted elastically in the transversal direction with an effective spring constant k and an effective damping constant c the linear mass of the cylinder m was set to 2600 kg m3 corresponding to the mass ratio m ρ c ρ w where ρ c is the density of cylinder and ρ w is the density of water of 2 6 the natural frequency f 0 and damping ratio ζ of the downstream cylinder were set to 0 3 hz and 0 7 respectively this physical model is consistent with the experimental model of assi et al 2010a the flow forces and vibration response of the downstream model were experimentally measured and verified to be reliable the present cfd results can be easily verified through comparison with the previous experimental results 2 2 computational method in the present study the two dimensional 2d cfd method was used to simulate the flow forces and vibration response of the wiv at subcritical reynolds numbers the 2d cfd method had been verified to be effective to simulate the fluid structured interaction fsi of wiv at high reynolds numbers by previous research dhiman et al 2017 performed 2d computation of flow and heat transfer over single cylinder and two tandem cylinders in subcritical regime and proved that the force coefficients agree with experiments ding et al 2015 simulated the flow induced motions of multiple circular cylinders by using 2d urans simulations in the range of 30000 r e 120000 their simulation results were in excellent agreement with experiments the vibration response and flow forces of the downstream cylinder were calculated in the workbench system of ansys stolarski et al 2018 in this system the fsi was simulated by using the system coupling module to couple the fluent and transient structural modules the surface of the downstream cylinder was set as system coupling in the fluent module and fluid and solid interface in the transient structural module this method realizes the force and displacement transmission between the fluent and transient structural modules in each fsi step the flow field and forces were first calculated in the fluent module next the forces as external loads were transmitted into the transient structural module to calculate the vibration responses the vibration responses were sent back into the fluent module to update the location and mesh of the cylinders stolarski et al 2018 the flow over the cylinders was treated as an incompressible viscous fluid governed by the incompressible navier stokes equations that express the conservation of mass and momentum 1 u i x i 0 2 u i t u i u j x j p ρ x i υ x j u i x j f i i j 1 2 3 where u i or u j is the velocity component in the x y or z direction ρ is the density p is the pressure ν represents the kinematic coefficient of viscosity and f i denotes the body force in the i direction in this study flow was considered a newtonian fluid of density ρ 1000 kg m3 and kinematic viscosity of ν 10 6 m2 s a discrete event simulation des model was employed for turbulence calculation and developed as a hybridization technique for realistic simulations of turbulent flows with high reynolds numbers and large separation it combined the fine tuned rans methodology in the attached boundary layers and the large eddy simulation les in the shear layers and separated flow regions travin et al 2000 successfully applied des in practice for simulations of flows over circular cylinders strelets 2001 menter and kuntz 2004 and spalart et al 2006 further refined the des approach and applied it for massive separated flows a des approach for the simulation of viv for high reynolds number flows was also explored nguyen and nguyen 2016 the des formulations were based on the shear stress transport sst k ω turbulence model the governing equations were solved using the unstructured collocated finite volume method in an arbitrary lagrangian eulerian framework with implicit pressure and splitting operators piso for pressure velocity coupling nguyen et al 2018 in the transverse direction the vibration responses of the downstream cylinder are governed by the kinetic equation of a spring mass damper system with a single degree of freedom 3 m y c y k y f y where y is the transverse displacement c is the structural damping constant k is the spring constant and f y is the aerodynamic force in the y direction as calculated in the fluent module the buoyancy force is not considered in the present study 2 3 computational domain and mesh fig 2 shows the computational domain and mesh topology around the tandem cylinders the computational domain is 49d in length and 20d in height the block ratio is calculated as 5 we set the left side boundary condition as the inlet and the right side boundary condition as the pressure outlet both the top and bottom boundary conditions and the cylinder s surface were set as no slip walls stolarski et al 2018 the mesh in the computational domain was generated using the icem tool in ansys the mesh is coarse in the peripheral domain and refined in the domain close to the cylinders as shown in fig 2 in the refined domain the size of the grid cells gradually increased from the cylinder surface to the outside the boundary layers around the cylinder surface met y 1 because the des simulations required strict mesh grading of the boundary layer mesh the whole region of flow field was set as dynamic mesh zone in order to adapt to the vibration of the downstream cylinder the dynamic mesh was based on the diffusion smoothing method in the fluent module the diffusion function was set as boundary distance and the value of diffusion parameter was set as 2 this approach adapted the deformation of mesh to the cylinder motions while maintaining smoothness and preserving mesh quality in the boundary layer regions of solid body motions 3 results and discussion 3 1 validation of numerical grid convergence to validate the numerical grid convergence we calculated the aerodynamic forces of the two cylinders using coarse medium and fine grids at a reynolds number of 1 5 104 we summarized the results and compared them with those by assi et al 2013 nguyen et al 2018 and kitagawa and ohta 2008 in table 1 c d denotes the mean drag coefficient and c l represents the root mean square rms of the lift coefficient the grid convergence index gci f s ε r p 1 where the safety factor f s 1 25 ε is the relative error between the results of two girds r is the grid refinement ratio and p 4 is the order of convergence roache 1994 based on the drag coefficient of the downstream cylinder the mean of c l for the cylinders approached a converged value 0 52 in both the medium and fine grid cases for the medium to fine grid cases the gci is less than 4 the numerical prediction approaches the asymptotic numerical value therefore the medium grid was employed in the subsequent simulation because it was cost effective and could sufficiently guarantee numerical grid convergence 3 2 wake induced vibration of two cylinders in tandem arrangement to reveal the characteristics of wiv both the response and lift force were simultaneously monitored during the simulation fig 3 shows the time history and power spectral density of the displacement and lift force coefficient with respect to the reduced velocity u r u df 0 where u is the velocity of the incoming flow of 5 10 15 20 and 25 strong vibrations occurred for all reduced velocities the vibration amplitude increased as the reduced velocity increased the rms of displacements are shown and compared with the experimental results of assi et al 2010a fig 4 the current numerical results agree with the experimental results only one dominant frequency appears in the power spectral density curve of the displacement at the reduced velocity of 5 the dominant reduced frequency is 0 2 which corresponds with the vortex shedding frequency of cylinders therefore the vibration is vortex induced when the reduced velocity is above 5 the dominating reduced frequency is lower than the vortex shedding frequency and slowly decreases as the reduced velocity increases these results also agree with previous experimental results fig 5 the power spectral density of the lift force coefficient shows that there is only one peak in the case of u r 5 which corresponds to the vortex shedding frequency when the reduced velocity is above 5 there are two dominating frequency peaks in the spectrum curve including the vortex shedding frequency and the vibration frequency of the downstream cylinder the power at the vortex shedding frequency exceeds those at the vibration frequency fig 4 these results agree with those of nguyen et al 2018 3 3 energy transmission in wake induced vibrations the above simulation results show that the wiv of the downstream cylinder is strong and continuous to maintain this type of vibration the cylinder must absorb energy from the incoming flow to understand the wiv mechanism we need to study the associated energy transmission over time therefore the energy consumption during wiv was calculated using a time domain analysis method for an oscillating structure under dynamic loading conditions the work performed by a dynamic force over a period t on the unit area of the downstream cylinder w t can be calculated by the following formula 4 w t t f t d y t d l where f t is the dynamic force y t is the displacement t is the time period t is time and l is the length of the downstream cylinder because wiv is simplified as a classic spring dampened system solely under flow conditions the wiv of a downstream cylinder encounters various forces including inertia damping resilience and flow forces the work done by the flow force represents the energy from the incoming flow the work done by the damping force represents the energy consumption of the vibration system because the collected data were discrete points eq 4 is written in a discrete form 5 w n n f i d y i d l where n is the time step number in this study only the vertical vibration of the downstream cylinder was considered therefore the flow force was the lift force the lift force f i and the displacement y i of the downstream cylinder were extracted from the numerical simulation results the damping force at each step was calculated as follows 6 c i y i y i 1 δ t c where δ t is the time step substituting eqs 5 and 6 into eq 4 the time history of the work performed by flow force and damping force was calculated to evaluate the speed of energy transmission the power of the flow force is calculated as follows 7 p h h t t where h t is the total work done by the flow force that represents the transmitted energy from the incoming flow the power of the damping force is calculated with this equation 8 p d d t t where d t is the total work consumed by the damping force the average transmitted energy is further nondimensionalized as a power coefficient to evaluate the efficiency 9 η w i v p h p f l u i d where p fluid ½ ρu 3 d 2 l is the fluid power given by bernitsas and raghavan 2004 in which l is the length of the cylinder the flow and damping work during the wiv fig 3 were calculated and are shown in fig 6 the time history curves of the flow work in fig 6 a show that the energy transmission fluctuates and unevenly increases with time the fluctuation of the curves indicates that the flow forces do positive and negative work during the wiv however the unevenly increasing tendency verifies that the flow force performs positive total work the vibration system absorbs energy from the incoming flow additionally as the slope of the fitting curves increases when the reduced velocity increases more energy transmission occurs for the higher reduced velocity cases for example the energy transmission increases from 0 0074 j m2 s to 0 0734 j m2 s as the reduced velocity increases from 10 to 25 fig 6 b shows the time history of work done by the damping force which represents the wiv energy consumption the damping forces always perform negative work and the accumulated negative work continuously increases with time in addition the growth rate of negative work for the damping force increases as the reduced velocity increases because of the stronger vibration and higher vibration frequency to further reveal the transmission process of the flow energy the time history of the displacement lift force and flow work in a single vibration period are shown in fig 7 the results confirm that the lift force has a higher frequency than the displacement during this period of vibration the sign of the lift force changed seven times and the displacement curve has two inflexions the lift force not only depends on the displacement of the downstream model but also relates to the vortex shed from the upstream model as explained by assi et al 2013 according to equation 4 the flow work depends on both the lift force and displacement during this period of vibration the sign of the lift force changed seven times and the displacement curve has two inflexions therefore the flow work curve has nine inflexions when the sign of the lift force agrees with that of the vibration velocity the flow force creates positive work otherwise it creates negative work fig 8 shows the power of flow and damping forces and the power coefficient with respect to various reduced velocities for the flow forces fig 8 a the power always increases as the reduced velocity increases from 5 to 25 more energy is transmitted into the system as the reduced velocity increases specifically compared with the viv case u r 5 more energy is transmitted when wiv occurs u r 10 25 there is an inflection point in the curve at the reduced velocity of 20 the growth rate of the curve increases when the reduced velocity is below 20 and then decreases when it is above 20 for the damping force the negative power also increases as the reduced velocity increases however in contrast with the flow force the inflection point appears at the reduced velocity of 15 when the reduced velocity exceeds 15 the growth rate is much higher the power coefficient with respect to various reduced velocities fig 8 c shows that the power coefficient decreases as the reduced velocity increases when u r 5 the power coefficient was approximately 2 2 while those of other cases were lower than 0 7 specifically there is a noticeable drop when the reduced velocity increases from 5 to 10 these results indicate that although more energy is transmitted when wiv occurs the viv has higher transmission efficiency 3 4 effect of damping ratio on wiv and energy transmission the response of wiv for cylinders is influenced by many parameters including mass ratio damping ratio the natural frequency of the system inflow velocity reynolds number and the distance between cylinders as summarized by assi et al 2010a 10 y ˆ d f ρ u d μ u d f 0 x 0 d m ζ in this section we changed the damping force coefficient and investigated how the damping ratio affected the responses of wiv and energy transmission the spacing ratio between the two cylinders remained unchanged and the reduced velocity was fixed at 20 corresponding to a reynolds number of 15000 fig 9 shows the rms of the nondimensional displacement the vibration amplitude continuously decreases as the damping ratio increases as the damping ratio increases from 1 to 25 the rms of the displacement decreases from 1 5 to 0 78 a 48 change wiv also occurs even when the damping ratio reaches 25 therefore adding damping ratio is not effective at suppressing the wiv of cylinders in agreement with cai et al 2020 the work done by the flow and damping forces with respect to various damping ratios is shown in fig 10 similar to those in fig 6 a the flow forces generally perform positive work and the vibration system continuously absorbs energy from the incoming flow in addition when the damping ratio increases although the vibration decreases the system receives more energy from the incoming flow for instance as the damping ratio increases from 1 to 25 the slope of the fitting curves increases from 0 0661 j m2 s to 0 4293 j m2 s therefore wiv shows potential for harvesting energy derakhshandeh et al 2015 specifically the damping force continuously performs negative work and as the damping ratio increases it consumes more energy fig 11 shows the power of flow and damping forces and the power coefficient with respect to damping ratios the power of the flow and damping forces always linearly increases as the damping ratio increases fig 11 a and b the fitting curve shows that 1 increase in the damping ratio correlates with an 0 014 w m2 increase in the energy absorbed by the vibration system the power coefficient linearly increases as the damping ratio increases fig 11 c when the damping ratio is 1 the power coefficient is approximately 0 6 and when the damping ratio is 25 the power coefficient is 3 1 this result further verifies that the wiv of cylinders can be utilized to collect energy from water or air flow 4 conclusions in this study the wiv of two tandem cylinders was numerically simulated over a range of reynolds numbers 3750 18750 the energy transmission for wiv was analyzed using a time domain method and the effect of the damping ratio on the energy transmission was investigated from the results we derived these four conclusions 1 the numerical method successfully reproduced wiv for two tandem cylinders under subcritical reynolds number conditions 3750 18750 and the numerical results agree with those reported by previous experiments 2 the flow forces perform both negative and positive work in wiv but the overall work is positive the vibration system absorbs energy from the incoming flow and the absorbed energy fluctuates unevenly increasing over time 3 when compared with viv the vibration system can absorb more energy from the incoming flow in wiv and the absorbed energy increases when the reduced velocity of the incoming flow increases the wiv of cylinders has the potential to collect energy from water or air flow 4 structural damping reduces the vibration amplitude but promotes energy transmission in wiv the power of the flow forces and the power coefficient linearly increase as the damping ratio increases this result further verifies that the wiv of cylinders can be utilized to collect energy from water flow or airflow if we can reliably absorb hydrodynamic energy from downstream cylinders more efficient and cost effective structures can be used in design and construction phases credit authorship contribution statement xu hui he supervision methodology funding acquisition writing original draft sida ai methodology writing original draft data curation haiquan jing methodology data curation writing review editing acknowledgement this research was financially supported by the national natural science foundations of china china no 51708559 51925808 u1934209 u1534206 natural science foundation of hunan province china no 2019jj50819 and the national key r d program of china china no 2017yfb1201204 
21702,a variety of cylinder configurations are used in civil engineering applications however upstream structures can disturb incoming flows and cause the instability of downstream structures in this study the wake induced vibrations wiv of two tandem cylinders were numerically simulated at subcritical reynolds numbers the effectiveness of the numerical method was demonstrated by comparing with previous experimental results the energy transmission during the occurrence of wiv was investigated in detail and the effect of the damping ratio on energy transmission was further studied the results showed that the wiv of the downstream cylinder can effectively absorb flow energy and the absorbed energy fluctuates and roughly increases over time when compared with vortex induced vibration a downstream cylinder can absorb more energy during the occurrence of wiv and the absorbed energy increases as the reduced velocity of the incoming flow increases in addition although structural damping reduces the vibration amplitude it promotes the energy transmission in wiv and the power of the flow force and the power coefficient linearly increase as the damping ratio increases keywords flow induced vibration wake induced vibration tandem cylinders energy transmission 1 introduction a variety of cylinder configurations such as stay cables suspenders and oil pipelines have been widely used in civil engineering applications they are prone to wind or flow induced vibrations chen et al 2015 jing et al 2017 2018 gao et al 2018 specifically when cylinders are tandemly arranged the upstream structures disturb the incoming flow and cause instability in downstream structures this type of flow induced vibration is referred to as wake induced vibration wiv research on wiv began in the first half of the 20th century carmo 2009 sumner 2010 and bearman 2011 comprehensively reviewed the progress achieved before 2010 previous studies primarily focused on the flow patterns aerodynamic hydraulic force coefficient response characteristics and wiv excitation mechanisms for downstream cylinders igarashi 1981 1984 investigated the flow field of two tandem circular cylinders when the ratio of the distance between the cylinder centers to the cylinder diameter l d varied from 1 03 to 5 0 they classified the flow field into six patterns with respect to the l d and reynolds number r e u d ν where u is the incoming wind speed and ν is the kinematic viscosity zdravkovich 1987 subdivided these flow patterns into three basic types 1 single bluff body behavior 1 0 l d 1 2 1 8 2 shear layer attachment behavior 1 2 1 8 l d 3 4 3 8 and 3 cylinder vortex shedding behavior 3 4 3 8 l d similar classifications were proposed by xu and zhou 2004 zhou and yiu 2006 and carmo et al 2010 2011 gu and sun 1999 and sumner et al 2000 2005 investigated the flow features of staggered cylinders gu and sun 1999 classified the flow field into three patterns wake shear and neighborhood interference while sumner et al 2000 2005 classified the flow field into nine patterns recently using large eddy simulation li et al 2018 studied at small gap ratios the flow around two tandem circular cylinders near a plane wall subburaj and vengadesan 2019 numerically investigated the effect of the froude number on downstream cylinder parameters e g the mean forces and the flow characteristics at a reynolds number of 180 ma et al 2019 investigated the hydrodynamic characteristic of two tandem flexible cylinders under the spacing ratios of 4 0 6 0 8 0 10 0 and 16 0 zhang and melbourne 1992 alam et al 2003 and sumner and schenstead 2006 investigated the variation characteristics for the aerodynamic hydraulic force coefficients of cylinders in a tandem arrangement they reported that a sharp increase in the aerodynamic hydraulic force coefficients of cylinders appears when l d is in the range from 3 5 to 3 8 depending on reynolds number using flow visualization techniques in a flowing soap film system with r e 99 8 yang and stremler 2019 found that the experimental critical spacing for l d is in the range between 2 9 and 4 1 non inclusively assi et al 2010a studied the downstream cylinder and constructed several detailed maps of the means and fluctuations for the drag and lift force coefficients recently hu and kwok 2020 use machine learning ml techniques to train models to predict wind pressures around circular cylinders schewe and jacobs 2019 experimentally investigated the effect of reynolds numbers that varied from subcritical to trans critical values 2 105 r e 6 106 on the aerodynamic forces of two tandem circular cylinders l d 1 56 using subcritical r e 2 2 104 and supercritical r e 3 0 106 reynolds numbers hu et al 2019 numerically studied the instantaneous flows structures pressure distributions and hydrodynamic forces of two tandem cylinders when l d varied from 2 0 to 5 0 through numerical simulation at a high subcritical reynolds number of r e 1 4 105 wu et al 2019 presented three critical aerodynamic phenomena at the downstream cylinder 1 negative drag force 2 inner lift force and 3 outer lift force as l d varied from 1 5 to 4 and the incidence angle increased from 0 to 90 zdravkovich and medeiros 1991 investigated the effects of m ζ where m is the mass ratio and ζ is the damping ratio on the responses of wiv and concluded that it was challenging to suppress wiv when m ζ increased when the separation ratio l d was 4 75 hover et al 2001 observed that strong vibrations occurred for all flow velocities that were higher than a critical threshold the vibration amplitude reached 1 9d at the reduced wind speed of 17 assi et al 2006 2010a measured the responses of a pair of rigid cylinders in a water channel and observed that in the absence of unsteady vortices no wiv occurred for the downstream cylinder chaplin and batten 2014 developed a unique experiment setup in which a rigid downstream cylinder simultaneously underwent wake and vortex induced vibrations in multiple modes they speculated that the participation of higher modes or multiple direction vibrations significantly influenced the feature of the flow structure interaction li et al 2013 experimentally studied the wiv of a downstream cylinder and its characteristics including the vibration amplitude velocity range and dominant wiv frequency huera huarte and bearman 2011 and huera huarte and gharib 2011 reproduced wiv using two long flexible cylinders in a water tunnel and observed that for near wake interference 2 0 l d 4 0 the cylinders experienced three types of oscillation vortex induced vibration viv wiv and combinations of both for the far wake interference 4 0 l d 8 0 the downstream cylinder also primarily experienced wiv and exhibited larger amplitudes at higher reduced velocities recently huera huarte et al 2016 observed higher multimode vibrations and synchronization regions that were dependent on the structural modes they concluded that l d does not exert a strong influence on the vibration frequency and amplitude whereas the incoming wake enhanced the vibration amplitude to a considerable extent he et al 2018 simulated wiv in a wind tunnel and successfully suppressed it using an elastic crosstie armin et al 2018 investigated the effect of the spacing gap on the dynamic behavior of two flexibly mounted tandem cylinders at different reynolds numbers ranging from 8 7 103 to 5 2 104 similarly xu et al 2019 studied the vibration responses of tandem elastically mounted circular cylinders in a water channel under spacing gaps of l d 1 57 2 57 3 57 and 4 57 chen et al 2020 numerically simulated the complex wivs of four aligned hangers behind a bridge tower compared with the classic karman vortex shedding induced vibration chen et al 2015 and rain wind induced cable vibration jing et al 2015 2017 for circular cylinders in a group the excitation mechanisms are substantially more complicated zdravkovich 1997 proposed a wake displacement mechanism mysa et al 2016 emphasized the importance of phase lag between the lift force and vibration displacement after studying the differences between wiv and viv carmo et al 2011 reported that the physical mechanism was related to the oscillatory flow in the gap which for the downstream cylinder alternately shifted the foremost point of stillness along the curve of the wall toward the upstream assi et al 2010a 2010b and bearman 2011 addressed the importance of unsteady vortices shed from the upstream cylinder and speculated that the wiv was excited by the unsteady vortex structure interaction between the upwind wake and the downwind cylinder assi et al 2013 2014 then proposed a new concept wake stiffness to explain the characteristics of the displacement and frequency of the wiv recently due to environmental concerns and climate change renewable and clean energy has become popular hydrokinetic energy as a renewable source has attracted attention khan et al 2009 hu et al 2016 derakhshandeh et al 2015 tried to absorb the hydrokinetic energy in wiv and experimentally investigated the effects of cylinder arrangements and reynolds numbers on the energy absorption of downstream cylinders their results showed that wiv has great potential for hydrokinetic energy absorption ding et al 2019 numerically studied tandem cylinders on springs with the 2d spalart allmaras turbulence model for hydrokinetic power conversion at reynolds numbers of 30 000 r e 120 000 however since it is a new concept a study on the efficiency of energy absorption in the wiv process is insufficient to understand the characteristics and mechanisms of wiv energy convertors in this study the wiv of two tandem cylinders is investigated through computational fluid dynamic cfd simulation at subcritical reynolds numbers 3750 18750 the energy transmission in wiv and the effect of the damping ratio on energy transmission are analyzed using a time domain method 2 methodology and model 2 1 physical model two cylinders were arranged in tandem as shown in fig 1 the diameter d of both cylinders is 50 mm and the center to center distance l of the two cylinders is 200 mm resulting in an l d of 4 the upstream cylinder was rigidly fixed and the downstream cylinder was mounted elastically in the transversal direction with an effective spring constant k and an effective damping constant c the linear mass of the cylinder m was set to 2600 kg m3 corresponding to the mass ratio m ρ c ρ w where ρ c is the density of cylinder and ρ w is the density of water of 2 6 the natural frequency f 0 and damping ratio ζ of the downstream cylinder were set to 0 3 hz and 0 7 respectively this physical model is consistent with the experimental model of assi et al 2010a the flow forces and vibration response of the downstream model were experimentally measured and verified to be reliable the present cfd results can be easily verified through comparison with the previous experimental results 2 2 computational method in the present study the two dimensional 2d cfd method was used to simulate the flow forces and vibration response of the wiv at subcritical reynolds numbers the 2d cfd method had been verified to be effective to simulate the fluid structured interaction fsi of wiv at high reynolds numbers by previous research dhiman et al 2017 performed 2d computation of flow and heat transfer over single cylinder and two tandem cylinders in subcritical regime and proved that the force coefficients agree with experiments ding et al 2015 simulated the flow induced motions of multiple circular cylinders by using 2d urans simulations in the range of 30000 r e 120000 their simulation results were in excellent agreement with experiments the vibration response and flow forces of the downstream cylinder were calculated in the workbench system of ansys stolarski et al 2018 in this system the fsi was simulated by using the system coupling module to couple the fluent and transient structural modules the surface of the downstream cylinder was set as system coupling in the fluent module and fluid and solid interface in the transient structural module this method realizes the force and displacement transmission between the fluent and transient structural modules in each fsi step the flow field and forces were first calculated in the fluent module next the forces as external loads were transmitted into the transient structural module to calculate the vibration responses the vibration responses were sent back into the fluent module to update the location and mesh of the cylinders stolarski et al 2018 the flow over the cylinders was treated as an incompressible viscous fluid governed by the incompressible navier stokes equations that express the conservation of mass and momentum 1 u i x i 0 2 u i t u i u j x j p ρ x i υ x j u i x j f i i j 1 2 3 where u i or u j is the velocity component in the x y or z direction ρ is the density p is the pressure ν represents the kinematic coefficient of viscosity and f i denotes the body force in the i direction in this study flow was considered a newtonian fluid of density ρ 1000 kg m3 and kinematic viscosity of ν 10 6 m2 s a discrete event simulation des model was employed for turbulence calculation and developed as a hybridization technique for realistic simulations of turbulent flows with high reynolds numbers and large separation it combined the fine tuned rans methodology in the attached boundary layers and the large eddy simulation les in the shear layers and separated flow regions travin et al 2000 successfully applied des in practice for simulations of flows over circular cylinders strelets 2001 menter and kuntz 2004 and spalart et al 2006 further refined the des approach and applied it for massive separated flows a des approach for the simulation of viv for high reynolds number flows was also explored nguyen and nguyen 2016 the des formulations were based on the shear stress transport sst k ω turbulence model the governing equations were solved using the unstructured collocated finite volume method in an arbitrary lagrangian eulerian framework with implicit pressure and splitting operators piso for pressure velocity coupling nguyen et al 2018 in the transverse direction the vibration responses of the downstream cylinder are governed by the kinetic equation of a spring mass damper system with a single degree of freedom 3 m y c y k y f y where y is the transverse displacement c is the structural damping constant k is the spring constant and f y is the aerodynamic force in the y direction as calculated in the fluent module the buoyancy force is not considered in the present study 2 3 computational domain and mesh fig 2 shows the computational domain and mesh topology around the tandem cylinders the computational domain is 49d in length and 20d in height the block ratio is calculated as 5 we set the left side boundary condition as the inlet and the right side boundary condition as the pressure outlet both the top and bottom boundary conditions and the cylinder s surface were set as no slip walls stolarski et al 2018 the mesh in the computational domain was generated using the icem tool in ansys the mesh is coarse in the peripheral domain and refined in the domain close to the cylinders as shown in fig 2 in the refined domain the size of the grid cells gradually increased from the cylinder surface to the outside the boundary layers around the cylinder surface met y 1 because the des simulations required strict mesh grading of the boundary layer mesh the whole region of flow field was set as dynamic mesh zone in order to adapt to the vibration of the downstream cylinder the dynamic mesh was based on the diffusion smoothing method in the fluent module the diffusion function was set as boundary distance and the value of diffusion parameter was set as 2 this approach adapted the deformation of mesh to the cylinder motions while maintaining smoothness and preserving mesh quality in the boundary layer regions of solid body motions 3 results and discussion 3 1 validation of numerical grid convergence to validate the numerical grid convergence we calculated the aerodynamic forces of the two cylinders using coarse medium and fine grids at a reynolds number of 1 5 104 we summarized the results and compared them with those by assi et al 2013 nguyen et al 2018 and kitagawa and ohta 2008 in table 1 c d denotes the mean drag coefficient and c l represents the root mean square rms of the lift coefficient the grid convergence index gci f s ε r p 1 where the safety factor f s 1 25 ε is the relative error between the results of two girds r is the grid refinement ratio and p 4 is the order of convergence roache 1994 based on the drag coefficient of the downstream cylinder the mean of c l for the cylinders approached a converged value 0 52 in both the medium and fine grid cases for the medium to fine grid cases the gci is less than 4 the numerical prediction approaches the asymptotic numerical value therefore the medium grid was employed in the subsequent simulation because it was cost effective and could sufficiently guarantee numerical grid convergence 3 2 wake induced vibration of two cylinders in tandem arrangement to reveal the characteristics of wiv both the response and lift force were simultaneously monitored during the simulation fig 3 shows the time history and power spectral density of the displacement and lift force coefficient with respect to the reduced velocity u r u df 0 where u is the velocity of the incoming flow of 5 10 15 20 and 25 strong vibrations occurred for all reduced velocities the vibration amplitude increased as the reduced velocity increased the rms of displacements are shown and compared with the experimental results of assi et al 2010a fig 4 the current numerical results agree with the experimental results only one dominant frequency appears in the power spectral density curve of the displacement at the reduced velocity of 5 the dominant reduced frequency is 0 2 which corresponds with the vortex shedding frequency of cylinders therefore the vibration is vortex induced when the reduced velocity is above 5 the dominating reduced frequency is lower than the vortex shedding frequency and slowly decreases as the reduced velocity increases these results also agree with previous experimental results fig 5 the power spectral density of the lift force coefficient shows that there is only one peak in the case of u r 5 which corresponds to the vortex shedding frequency when the reduced velocity is above 5 there are two dominating frequency peaks in the spectrum curve including the vortex shedding frequency and the vibration frequency of the downstream cylinder the power at the vortex shedding frequency exceeds those at the vibration frequency fig 4 these results agree with those of nguyen et al 2018 3 3 energy transmission in wake induced vibrations the above simulation results show that the wiv of the downstream cylinder is strong and continuous to maintain this type of vibration the cylinder must absorb energy from the incoming flow to understand the wiv mechanism we need to study the associated energy transmission over time therefore the energy consumption during wiv was calculated using a time domain analysis method for an oscillating structure under dynamic loading conditions the work performed by a dynamic force over a period t on the unit area of the downstream cylinder w t can be calculated by the following formula 4 w t t f t d y t d l where f t is the dynamic force y t is the displacement t is the time period t is time and l is the length of the downstream cylinder because wiv is simplified as a classic spring dampened system solely under flow conditions the wiv of a downstream cylinder encounters various forces including inertia damping resilience and flow forces the work done by the flow force represents the energy from the incoming flow the work done by the damping force represents the energy consumption of the vibration system because the collected data were discrete points eq 4 is written in a discrete form 5 w n n f i d y i d l where n is the time step number in this study only the vertical vibration of the downstream cylinder was considered therefore the flow force was the lift force the lift force f i and the displacement y i of the downstream cylinder were extracted from the numerical simulation results the damping force at each step was calculated as follows 6 c i y i y i 1 δ t c where δ t is the time step substituting eqs 5 and 6 into eq 4 the time history of the work performed by flow force and damping force was calculated to evaluate the speed of energy transmission the power of the flow force is calculated as follows 7 p h h t t where h t is the total work done by the flow force that represents the transmitted energy from the incoming flow the power of the damping force is calculated with this equation 8 p d d t t where d t is the total work consumed by the damping force the average transmitted energy is further nondimensionalized as a power coefficient to evaluate the efficiency 9 η w i v p h p f l u i d where p fluid ½ ρu 3 d 2 l is the fluid power given by bernitsas and raghavan 2004 in which l is the length of the cylinder the flow and damping work during the wiv fig 3 were calculated and are shown in fig 6 the time history curves of the flow work in fig 6 a show that the energy transmission fluctuates and unevenly increases with time the fluctuation of the curves indicates that the flow forces do positive and negative work during the wiv however the unevenly increasing tendency verifies that the flow force performs positive total work the vibration system absorbs energy from the incoming flow additionally as the slope of the fitting curves increases when the reduced velocity increases more energy transmission occurs for the higher reduced velocity cases for example the energy transmission increases from 0 0074 j m2 s to 0 0734 j m2 s as the reduced velocity increases from 10 to 25 fig 6 b shows the time history of work done by the damping force which represents the wiv energy consumption the damping forces always perform negative work and the accumulated negative work continuously increases with time in addition the growth rate of negative work for the damping force increases as the reduced velocity increases because of the stronger vibration and higher vibration frequency to further reveal the transmission process of the flow energy the time history of the displacement lift force and flow work in a single vibration period are shown in fig 7 the results confirm that the lift force has a higher frequency than the displacement during this period of vibration the sign of the lift force changed seven times and the displacement curve has two inflexions the lift force not only depends on the displacement of the downstream model but also relates to the vortex shed from the upstream model as explained by assi et al 2013 according to equation 4 the flow work depends on both the lift force and displacement during this period of vibration the sign of the lift force changed seven times and the displacement curve has two inflexions therefore the flow work curve has nine inflexions when the sign of the lift force agrees with that of the vibration velocity the flow force creates positive work otherwise it creates negative work fig 8 shows the power of flow and damping forces and the power coefficient with respect to various reduced velocities for the flow forces fig 8 a the power always increases as the reduced velocity increases from 5 to 25 more energy is transmitted into the system as the reduced velocity increases specifically compared with the viv case u r 5 more energy is transmitted when wiv occurs u r 10 25 there is an inflection point in the curve at the reduced velocity of 20 the growth rate of the curve increases when the reduced velocity is below 20 and then decreases when it is above 20 for the damping force the negative power also increases as the reduced velocity increases however in contrast with the flow force the inflection point appears at the reduced velocity of 15 when the reduced velocity exceeds 15 the growth rate is much higher the power coefficient with respect to various reduced velocities fig 8 c shows that the power coefficient decreases as the reduced velocity increases when u r 5 the power coefficient was approximately 2 2 while those of other cases were lower than 0 7 specifically there is a noticeable drop when the reduced velocity increases from 5 to 10 these results indicate that although more energy is transmitted when wiv occurs the viv has higher transmission efficiency 3 4 effect of damping ratio on wiv and energy transmission the response of wiv for cylinders is influenced by many parameters including mass ratio damping ratio the natural frequency of the system inflow velocity reynolds number and the distance between cylinders as summarized by assi et al 2010a 10 y ˆ d f ρ u d μ u d f 0 x 0 d m ζ in this section we changed the damping force coefficient and investigated how the damping ratio affected the responses of wiv and energy transmission the spacing ratio between the two cylinders remained unchanged and the reduced velocity was fixed at 20 corresponding to a reynolds number of 15000 fig 9 shows the rms of the nondimensional displacement the vibration amplitude continuously decreases as the damping ratio increases as the damping ratio increases from 1 to 25 the rms of the displacement decreases from 1 5 to 0 78 a 48 change wiv also occurs even when the damping ratio reaches 25 therefore adding damping ratio is not effective at suppressing the wiv of cylinders in agreement with cai et al 2020 the work done by the flow and damping forces with respect to various damping ratios is shown in fig 10 similar to those in fig 6 a the flow forces generally perform positive work and the vibration system continuously absorbs energy from the incoming flow in addition when the damping ratio increases although the vibration decreases the system receives more energy from the incoming flow for instance as the damping ratio increases from 1 to 25 the slope of the fitting curves increases from 0 0661 j m2 s to 0 4293 j m2 s therefore wiv shows potential for harvesting energy derakhshandeh et al 2015 specifically the damping force continuously performs negative work and as the damping ratio increases it consumes more energy fig 11 shows the power of flow and damping forces and the power coefficient with respect to damping ratios the power of the flow and damping forces always linearly increases as the damping ratio increases fig 11 a and b the fitting curve shows that 1 increase in the damping ratio correlates with an 0 014 w m2 increase in the energy absorbed by the vibration system the power coefficient linearly increases as the damping ratio increases fig 11 c when the damping ratio is 1 the power coefficient is approximately 0 6 and when the damping ratio is 25 the power coefficient is 3 1 this result further verifies that the wiv of cylinders can be utilized to collect energy from water or air flow 4 conclusions in this study the wiv of two tandem cylinders was numerically simulated over a range of reynolds numbers 3750 18750 the energy transmission for wiv was analyzed using a time domain method and the effect of the damping ratio on the energy transmission was investigated from the results we derived these four conclusions 1 the numerical method successfully reproduced wiv for two tandem cylinders under subcritical reynolds number conditions 3750 18750 and the numerical results agree with those reported by previous experiments 2 the flow forces perform both negative and positive work in wiv but the overall work is positive the vibration system absorbs energy from the incoming flow and the absorbed energy fluctuates unevenly increasing over time 3 when compared with viv the vibration system can absorb more energy from the incoming flow in wiv and the absorbed energy increases when the reduced velocity of the incoming flow increases the wiv of cylinders has the potential to collect energy from water or air flow 4 structural damping reduces the vibration amplitude but promotes energy transmission in wiv the power of the flow forces and the power coefficient linearly increase as the damping ratio increases this result further verifies that the wiv of cylinders can be utilized to collect energy from water flow or airflow if we can reliably absorb hydrodynamic energy from downstream cylinders more efficient and cost effective structures can be used in design and construction phases credit authorship contribution statement xu hui he supervision methodology funding acquisition writing original draft sida ai methodology writing original draft data curation haiquan jing methodology data curation writing review editing acknowledgement this research was financially supported by the national natural science foundations of china china no 51708559 51925808 u1934209 u1534206 natural science foundation of hunan province china no 2019jj50819 and the national key r d program of china china no 2017yfb1201204 
21703,to investigate the dynamic behavior of a complex system an accurate updated finite element fe model is essentially required numerical model updating which is performed based on valid experimental data is imprecise without taking the related uncertainties into account in this study both structural and parametric uncertainties are considered within model updating of an offshore jacket platform through time history analysis for the first time the experimental test is implemented employing a shake table and a scaled hydro elastic model of the case study for updating the fe model a three step updating procedure is implemented through eight distinct scenarios in the first step three unknown structural parameters are calibrated over ten distinct groups of elements in the fe model by using particle swarm optimization algorithm pso in the second step the damping matrix coefficients are also updated through the optimization process in the third step the model form error is considered utilizing four mathematical functions to decrease the parametric uncertainty and improve the fe model accuracy based on the results by employing the proposed methodology approximately 98 percent fitness is observed between the experimental and updated numerical model according to the results not only reducing both structural and parametric uncertainties is essential but also calibrating the damping matrix for updating a numerical model and improving the fe model accuracy is of great importance the developed methodology which is applied to a sophisticated structural system is strongly recommended for updating the systems that existence of an accurate updated numerical model is vital keywords numerical model updating uncertainty complex structural system shake table test offshore jacket type structure 1 introduction predicting accurate dynamic behavior of an actual complex system in situ is one of the main engineering concerns dynamic behavior prediction is performed on the basis of idealized engineering designs which is based on numerical finite element fe models jaishi and ren 2005 this prediction may not precisely represent all physical aspects of a complex structural system possibly because of inaccurate values of material property improper boundary conditions damping modeling difficulties and so forth hong et al 2016 uncertainties which is the main reason of the inaccuracy can be categorized into three distinct groups related to the fe or any computer model 1 numerical uncertainty defined as inaccuracy in mathematical equations of the problem 2 parameter uncertainty described as imprecision in model parameters definition and 3 structural uncertainty identified as inexactness and incompleteness in engineering principles modeling atamturktur and farajpour 2013 kennedy and o hagan 2001 kennedy et al 2002 among these sources of uncertainties parametric uncertainty has been proven to be the most influential source of error in fe model updating astroza and alessandri 2018 astroza et al 2019a b even if the fe model has been built according to exact design drawings the structural behavior of the system requires improvement to assure withstanding of the primary system against any probable environmental loads hokmabady et al 2019 generally considering any possible categorized uncertainty groups within the numerical calculation is of great importance to approach a high accurate and updated numerical model however many numerical model updating methods have been introduced in the literature rageh et al 2020 bakir et al 2007 jaishi and ren 2005 brownjohn and xia 2000 numerical model updating can be classified into direct methods essentially non iterative and the iterative methods mojtahedi et al 2019 in the direct method due to alterations of dynamic matrices in the numerical model during the updating procedure the physical meanings of the real structure cannot be maintained the iterative method provides almost significant updating parameters to be updated which is mainly performed based on minimizing an objective function collins et al 2012 collins et al 2012 used eigen data sensitivity as an objective function in their study the frequency response function frf data was also considered to update the numerical fe model by hong et al 2016 however damping was neglected in most of the previous studies its significant role in updating the numerical models has been investigated in some limited research astroza et al 2019a b mottershead et al 2011 taylan et al 2012 arora et al 2009 adhikari 2000 2002 and its exact role in updating a complex system is yet to be investigated astroza and alessandri 2018 showed that model uncertainty may have great detrimental impacts when the updated fe model is used for damage detection in the case of large modeling uncertainty sanayei et al 2002 investigated the estimation of modeling error significance with respect to type and locations of the measurement error function types the uncertain parameter location and unknown parameters selection they concluded that the mentioned parameters have an efficient effect on the quality of the parameter estimation zsarnóczay and baker 2020 focused on how calibration methods affect model uncertainty they have utilized the improvement of component model methods for any structural system all uncertainty sources should be evaluated to quantify their effects on a computer model generally two major methods for developing a mathematical model can be considered as probabilistic methods with statistical characteristics of the responses and or parametric modeling najafian 2007 parametric models offer a number of potential advantages including representation parsimony improved accuracy improved resolution and improved tracking of the system dynamics lotfollahi yaghin et al 2011 numerical model updating which can be performed by calibrating some numerical parameters is defined as the adjustment of a set of associated parameters through computational science and engineering code so that the model agreement be maximized with respect to an experimental data set actually to reduce the numerical and experimental model disagreement among all above mentioned numerical parametric and structural uncertainties the second and the third ones might be considered for model updating basically calibrating the input parameters of a model without considering structural uncertainty might gain mathematically correct outcomes but physically incorrect solutions atamturktur and farajpour 2013 kennedy and o hagan 2001 kennedy et al 2002 for reducing parametric uncertainty calibrating system uncertain parameters such as modulus of elasticity an iterative procedure should be performed the third factor or the structural uncertainty which is resulted from simplifying assumptions and idealizations of the problem such as linear behavior assumption of a system whereas the behavior is nonlinear in reality can be reduced by employing model form error through decreasing incorrectness of assumptions and modeling decisions the main objective of the current study is to present an efficient and practical model updating method considering uncertainties for a three dimensional space frame jacket model for the first time numerically and experimentally on the other hand in this study a method is proposed to train the model form error within a complex structural system actually model updating is performed for the first time by considering parametric and structural uncertainties through a purely optimization based approach which exposes the new method of reducing the uncertainties within an appropriate optimization process the proposed updating method is implemented by using eight distinct scenarios in a three step procedure in the first step mass and stiffness matrices are updated over an optimization based framework using experimental data which is obtained through a shake table test employing a scaled hydro elastic model of three dimensional fixed offshore jacket platform reducing the parametric uncertainty is performed by calibrating different structural parameters such as shear modulus elasticity modulus and mass density of the jacket members basically the simultaneous effect of the parametric and structural uncertainties on updating a complex system through time history analysis is yet to be investigated in this regard the members of the jacket platform are categorized into ten distinct groups based on their place and importance each updating parameters of the members are optimized separately using particle swarm optimization pso algorithm over the second step the damping matrix is updated by utilizing the updated mass and stiffness matrices and optimizing two damping coefficient matrices which is performed in updating an offshore jacket platform for the first time in the third step to reduce the structural uncertainty the model form error term is employed as a discrepancy term through four different mathematical functions the functions are chosen to study the efficiency of the discrepancy term within the optimization and updating procedures the efficiency of different discrepancy functions in updating a complex three dimensional system is also presented in offshore structural field in this study based on the results the disagreement between the experimental data and the numerical model is decreased significantly by employing both calibration parameters and using all proposed discrepancy functions although calibration of uncertain parameters is of great importance damping matrix calibration has a key role in updating the numerical model based on the results the highest fitness occurred as the damping matrix is updated and the first discrepancy function scenario is considered for updating the fe model also to date the authors are not aware of any study assessing the frequency response of the system without updating the system frequency directly for this reason the natural frequency as one of the most important engineering parameters is also investigated in this study all the mentioned updating steps procedure and developed methodology are presented for the first time in an offshore structural field the methodology is recommended to be applied on the updating process of the structural systems that presence of an accurate and experimental based numerical model is essential 2 experimental study in this manuscript two distinct experiments are carried out in the first test a shake table experiment is conducted on a scaled hydro elastic experimental model of an offshore jacket platform in modal analysis laboratory of university of tabriz to obtain the time history response of the jacket some details of the shake table facilities including the experimental model are presented in fig 1 the specification of the shake table apparatus and the scaled experimental model are listed in tables 1 and 2 respectively to perform the experimental test four light uni axial accelerometers 4507 bruel kjaer are implemented in x direction of the jacket for response measurement the accelerometers are installed on each level of the scaled model to measure the system response as shown in fig 1 a random vibration signal is applied on the scaled model in a frequency range of 1 50 hz amplitude of 4 m s 2 and duration of 20 s the test is repeated 3 times to omit any possible unintentional errors time history of acceleration is recorded as of the output of the first experiment in the second test to gain the experimental frequencies a modal analysis is implemented on the same scaled hydro elastic model of the jacket in the laboratory the external excitation based on white noise signals is enforced by the shake table using two light uni axial accelerometers 4508 b k in both the x and y directions on each joint for response measurement the frequency sampling of the test setup is chosen as 32 khz and the frequency range is taken in a range between 0 and 200 hz during the test the structural responses are recorded as frfs the recorded data are sent to the me scope software package for post processing using a curve fitting tool modal curve fitting is the process used to gain a set of modal parameters the natural frequencies of the scaled model are obtained as of the output of the second experiment 3 theoretical background in this section the theories that are used to model the objective function including the mathematical background of the parametric and structural uncertainties and the discrepancy term formulations are presented the methodology is discussed through four distinct sub sections for the current case study as follows 3 1 model updating i parametric uncertainty a relation can be defined between the experimental model response and the actual response of the prototype in reality as expressed in eq 1 kennedy and o hagan 2001 1 y o b s x i ζ ˆ x i ε x i i 1 n where y o b s x i ε x i ζ ˆ x i and n denote the experimental data the experimental error the actual response of the physical system and the number of the experimental data respectively actual response of the system can also be substituted by the summation of the numerical model including model form error as follows 2 y o b s x i y s i m x i θ ψ x i ε x i i 1 n where y s i m x i and ψ x i are the numerical model and model form error respectively x refers to control parameter which is defined as time in this study and θ denotes the input parameters of the model which cannot be controlled or adjusted during experimental test and are considered as calibration parameters in the numerical model kennedy and o hagan 2001 kennedy et al 2002 to define the parametric uncertainty which means imprecision in model parameters definition some uncertain parameters calibration parameters of the model need to be calibrated through an iteration process in this regard the calibration parameters are considered as modulus of elasticity e shear modulus g mass density md of the members and coefficients of the damping matrix β and γ in this paper for efficiency of the uncertain parameters in updating the model the members are separated into ten distinct groups based on their location and importance as shown in fig 2 3 2 model updating ii structural uncertainty structural uncertainty which is described as inexactness and incompleteness in modeling can be decreased by defining a model form error within the calculation process the model form error which is introduced in eq 2 definitely depends on the nature of the experimental model to possibly decrease the disagreement between the experimental and numerical model kennedy et al 2002 the model form error is substituted with a discrepancy term for training a model to fit the known values of model form error in the separated experimental settings by considering the discrepancy model instead of model form error eq 2 is rewritten as follows 3 y o b s x i y s i m x i θ δ x i α ε x i i 1 n where δ and α denote the discrepancy model and the nonphysical coefficients of the discrepancy model respectively in this study four mathematical functions are taken into account as of the discrepancy models the mathematical functions are considered separately in each optimization process to find the most efficient function the functions are specified as follows 4 δ 1 x α α 0 e x α 1 α 2 5 δ 2 x α α 0 sin α 1 x α 2 α 4 cos α 5 x α 6 6 δ 3 x α α 0 x 4 α 1 x 3 α 2 x 2 α 3 x α 4 7 δ 4 x α α 0 e α 0 sin α 1 x α 2 α 4 cos α 5 x α 6 where δ 1 to δ 4 represent the first to fourth discrepancy functions the functions are considered as of a continuous and differentiable function the concept of the discrepancy function is versatile in that many forms of functions combinations of functions or other polynomial forms such as legendre or bessel polynomials and trigonometric functions such as sine or cosine functions the functions in this study are chosen based on three concepts i according to the basics of the experimental data which is sine based white noise δ 2 ii in regards to the previously mentioned fundamental which is possibility of selecting any continuous and differentiable functions δ 1 and δ 3 iii a combination form of the first and the second concepts δ 4 it should be indicated that any other continuous and differentiable functions can be used instead kennedy and o hagan 2001 the coefficients of the functions should be trained based on the available experimental data set 3 3 model updating iii optimization procedure to minimize the disagreement between the numerical and experimental data simultaneously by decreasing the structural and parametric uncertainty an objective function and an optimization algorithm might be defined for this purpose the main objective function as sum of squared errors sse is specified as follows 8 f α θ i 1 n y o b s x i y s i m x i θ δ x i α 2 i 1 n where the term f α θ is the objective function by inputs of α and θ as the nonphysical coefficents of the discrepancy term and the calibration parameters respectively as it is seen in the objective function both structural and parametric uncertainties are taken into account for minimizing the sse which is specified as objective function of the problem an appropriate optimization algorithm must be used in this regard pso algorithm which is a robust optimization method for nonlinear non convex and discontinuous domains is employed pso is a nature inspired evolutionary algorithm that inspired from the behavior of the birds in a swarm eberhart and kennedy 1995 the optimization procedure is defined as a controlled loop between the matlab and frame3dd the details of which are discussed in the following section 3 4 model updating iv numerical modeling and parameters definition the jacket platform is modelled numerically by using the mass and stiffness matrices which can be the best solution for the complex space frame optimization process based on the matrix equation of the motion as follows dowson 1983 9 m u c u k u f where m and k are mass stiffness matrices of the jacket which are specified as two 228 228 matrices respectively mass and stiffness matrices are gained by using the frame3dd software henri and gavin 2010 with 38 nodes each with 6 degrees of freedom and final 109 members with no effects of non linearity in modeling however assuming linearity in modeling adds more uncertainties into the problem this assumption causes just more decrement in model form error vectors u u u and f are defiend as acceleration velocity displacement and the force vectors respectively the damping matrix is also defined as a calibration parameter in this study the matrix is defined as a combination of mass and stiffness matrices and the coefficents of the matrices are considered as calibration parameter the rayleigh technique is used to define the initial value of the optimization process to improve the accuracy of the coefficients and their efficiency the coefficents are defined with the same size of the mass and stiffness matrices for this purpose two different 12 12 submatrices with 144 elements are proposed and the matrices are repeated 19 times to create two 228 coefficent matrices each for mass and stiffness matrices as shown in fig 3 the proposed coefficient matrices are chosen based on a simple parametric study in which the required optimization time and the final aquired results are compared based on the parametric study the most efficient matrix size among eleven various sizes are gained as 12 12 by increasing the size of the coefficient matrices both the time and results are getting better logically up to 12 12 matrices but then as larger matrices are employed the optimization time increases irrationally and the final result improves inefficiently through the optimization process only the 12 12 submatrices 144 elements are supposed to be calibrated for minimizing the objective function through the optimization process a time integration method newmark beta nb method in this manuscript is employed chopra 1995 based on the selected calibration parameter and the defined discrepancy functions eq 8 is rewritten as follows 10 f i 1 n x o b s t i x s i m t i e 1 e 10 g 1 g 10 m d 1 m d 10 β 1 β 144 γ 1 γ 144 δ t i α 0 α 1 α 2 α 3 α 4 α 5 α 6 2 i 1 n some details about numerical model updating which is done through the optimization process are discussed in table 3 the algorithm of the proposed updating strategy can be described as follows the initial value of the calibration parameters is defined inside of frame3dd input file the pso algorithm is initialized inside matlab using two distinct files the first file includes the main parameters of the pso algorithm and the upper and lower values of the calibration parameters and the second file includes i the inputs of the pso algorithm specified as e g md alpha beta and discrepancy function coefficients ii java codes to run frame3dd software inside of the code to gain the new mass and stiffness matrices using new optimized values iii loading the mass and stiffness matrices iv building a new damping matrices using alpha beta values and mass and stiffness matrices v loading the experimental data vi using newmark beta method to simulate the same experimental code numerically to compare the results and vii defining the objective and the discrepancy functions the procedure of controlled loop is iterated to reach a minmum for the objective function to update the numerical model based on the unknown parameters calibration the initial values upper and lower bound values are specified as listed in tables 4 7 the values for the upper and lower bounds are taken based on the importance of the jacket members and the initial values of the modulus of elasticity shear modulus and mass density are chosen based on the specification of the steel the percentage of upper and lower bounds are taken based on the most common acceptable engineering manufacturing error value 5 in this regard 5 is chosen for the less important members members with insignificant structural importance such as internal members due to more possible manufacturing inspection and welding errors and 3 for the most important members members with significant structural importance such as main jacket leg because of higher levels of manufacturing and welding inspections although defining the same value for upper and lower bounds 3 percent for all members in tables 4 6 is possible the final results does not experience any changes due to the presence of the model form error functions in the proposed methodology which can cover the existence of uncertainties in the problem such as some difference in upper and lower bounds or the system non linearity the initial values of β and γ as damping coefficients are taken using two percent of damping ratio to gain the initial value of the damping coefficients the first and the fifth natural frequencies of the primary structure are considered based on rayleigh technique the first five mode shapes are taken in accordance with the fact that these mode shapes capture the most of the system energy for the numerical calculation the time step is taken based on the experimental results as 0 00651 s to match the experimental and numerical data over almost 12 s of time span however the main time span of the experimental study is 20 s but to prevent any unintentional errors some seconds of the first and the end sections of the experimental results are ignored the random signal which is use for the experimental test is shown in fig 4 4 results and discussion model updating of an offshore jacket platform as a complex space frame is investigated in this study in this regard the numerical fe model is updated based on the experimental shake table test using four accelerometers located on the four experimental scaled model of the jacket structural levels for the numerical modeling the same implemented experimental force is used the experimental and numerical acceleration time history on the jacket deck under the same random signal is shown in fig 5 and the validity of the results is assessed using the rms index as listed in table 8 the differences between the experimental and numerical acceleration time history rms is 3 4 percent which represents the validity of the recorded data in the experimental test the jacket deck acceleration time history in both experimental and the numerical fe model is demonstrated in fig 6 over the limited time span for more clarification although the rms result indicates that both experimental and numerical results are in an acceptable range because of the existing discrepancy between the results the numerical response of the system the numerical model cannot be used as an accurate fe model for further investigation for this reason model updating of the numerical fe model is inevitable for model updating of the fe model eight different scenarios are defined to investigate the proposed method performance the first and the second four scenarios are defined as model updating with and without considering the model form error the defined scenarios are listed in table 9 the pso algorithm is employed for optimizing the objective function for every scenario the optimization process is repeated by 50 runs each with swarm size of 20 through 100 iterations although the algorithm might converge to a local minimum in some runs due to using high number of runs ignoring some out of bound results and averaging the final results for each optimized parameter the results are rational the updating procedure is performed considering both parametric and structural uncertainties aside from ensuring the calibration parameters convergence to their true values it must be certified that the trained discrepancy model represents a true representation of model incompleteness the defined objective function given in eq 10 is approximately zero after 70 iterations the values of calibration parameters in all ten distinct structural groups are gained as a mean of all valid runs the mean value of e g and md as of calibration parameters are listed in tables 10 12 respectively due to the presence of modulus of elasticity in all scenarios the values of e is listed for all four scenarios in table 10 on the other hand the shear modulus is not considered in the first scenario which is the reason of its absence for scenario one in table 11 also due to the absence of mass density in the first two scenarios the values are limited to the third and fourth scenarios in table 12 although the value of the calibration parameters is listed in above mentioned tables the results should be presented graphically to investigate the efficiency of each calibration parameter in model updating procedure because illustrating the whole acceleration time history for studying the calibration procedure is not possible the time history is just presented for a limited time span 7s 8s in all updating scenarios the performance of the first four defined scenarios on the acceleration time history is shown in fig 7 as it is shown in fig 7a by employing the first scenario the performance of the fe model is poorly improved in comparison to the base numerical model based on fig 7b and c the second and the third scenarios consideration improved the fe model response significantly the highest fitness among the first four scenarios occurred as the damping matrix coefficients are updated according to fig 7d there is a significant fitness between the experimental and updated fe model by employing the fourth scenario the updated portion of β and γ matrices are presented in appendix 1 for assessment of the methodology of this manuscript data fitness index known as mean squared error mse is used the mse of the updated acceleration time history through the first four scenarios in comparison with the experimental data are listed in table 13 to evaluate the performance of the discrepancy model on model updating procedure the second four scenarios are defined all of these scenarios are based on considering both parametric uncertainty calibration parameters and a certain discrepancy model the difference between the experiment the third scenario the fourth scenario with two 1 1 coeffient matrices and the fourth scenario with two 12 12 coefficient matrices are shown in fig 8 and table 14 according to fig 8 by considering scaler quantities for the damping matrix the time history of the numerical model is updated insignificantly although the data is fitted to the experimental data gradually using the scaler matrices and the mse value is decreased 23 percent reduction in mse is 78 percent employing the 12 12 coefficient matrices which indicate more 50 percent fitness between the data based on the results there is a significant fitness between the experimental and updated fe model by employing the fourth scenario with 12 12 matrix coefficients which indicates not only the importance of the damping coefficients updating but also the necessity of updating the coefficients as a matrix instead of a scaler quantity however updating the whole damping coefficients matrix instead of a portion is highly recommended the effectiveness of the four specified mathematical functions in each scenario on the acceleration time history is illustrated in fig 9 as it is seen the difference between the experimental and numerical simulation is equal to 19 69 m s 2 which is a high value gradually the value of mse index decreases through employing the scenarios in updating procedure although the data is fitted to the experimental data gradually and the mse value is decreased 6 12 and 26 percent by using the first to third scenarios the fitness is significantly higher as the fourth scenario is taken into account about 78 percent reduction by using the fourth scenario indicates the importance of damping matrix updating within the numerical model updating procedure based on fig 9a the updated numerical model is well fitted to the experimental model by implementing the first discrepancy function the fitness improves as the sixth and seventh scenarios are employed see fig 9b and c however the fitness of the whole acceleration time history is significant in the fifth sixth and seventh scenarios the peaks are yet poorly fitted according to fig 9d there is a great agreement between the experimental and updated numerical model by taking the eighth scenario into account the agreement is not only on the whole performance but also on some peak points which shows the capability of the employed function the scenario eight which is about considering the fourth discrepancy function into the calculation process performed much better in comparison to other discrepancy functions basically as the second and the fourth functions are used for the discrepancy reduction the maximum decrement occurs that might be because of the sine nature of the functions which is so similar to the nature of the experimental outcomes however the highest fitness by using the fourth discrepancy function is might be caused by the mathematical function s combined form which is a combination of exponential and trigonometric functions the mse of the updated acceleration time history with considering the discrepancy functions through the second four scenarios is listed in table 15 according to table 15 the value of mse is decreased by almost 48 percent in comparison with the scenario four which is calibrating without considering the discrepancy model as the first discrepancy function is taken into account the decrement of mse is about 53 and 46 percent for the scenarios six and seven respectively in comparison to the scenario four the highest decrement occurred as the eighth scenario is implemented the decrement which is due to the highest fitness between the numerical updated model by using scenario eight and the experimental data is approximately 90 and 98 percent in comparison to the scenario four and the base numerical model respectively to reach an accurate numerical model through model updating procedure investigating the natural frequency of the updated models and its comparison to the experimental model which can be considered as the most important factor in the dynamic behavior of a structure is inevitable natural frequencies of experimental numerical and updating scenarios are listed in table 16 based on the results of table 16 there is an obvious difference between the natural frequencies of the experimental and base numerical models as the updating scenarios are considered for updating the numerical model the natural frequencies in all modes started getting closer to the experimental model the first frequencies of the scenarios one two and three are decreasing gradually but as the scenario four is considered the frequency is decreased more the decrement is also significant in scenario five even in comparison to the fourth scenario this can be caused by the number of calibration parameters which are taken into account in scenario four and also because of using the discrepancy model in scenario five for the first time the gradual decrement gets higher as combined discrepancy function is considered as the model form error in the eighth scenario in which the natural frequency is significantly matched to the natural frequency of the experimental model as it is also seen in table 16 the lowest difference between the updated numerical and experimental model is obtained as 0 2 percent when the eighth scenario is employed the introduced developed methodology of the present study is widely useful in such technologies that can be applied to complex structural systems to provide an accurate numerical model with fewer false alarms 5 conclusion in this manuscript an efficient and practical model updating method considering both parametric and structural uncertainties is presented as a real condition approach for uncertainty analysis through calibrating uncertain model parameters and structural uncertainties based on time history analysis the method is proposed by a three step updating procedure in the first step mass and stiffness matrices are updated using the experimental data which is gained by a shake table test of a fixed offshore jacket platform scaled hydro elastic model in the second step the parametric uncertainty reduction procedure is considered by calibrating different structural parameters as modulus of elasticity shear modulus and mass density of structural elements at the same time for updating a complex system in this regard the structural members of the jacket platform are categorized into ten distinct groups the updating calculation is performed using particle swarm optimization algorithm finally the damping matrix coefficients are also calibrated and the updated damping matrix is used based on updated mass and stiffness matrices in the third step the structural uncertainty reduction procedure is taken into account for this purpose model form error is employed as a discrepancy model by representing four different mathematical functions the efficiency and effectiveness of each discrepancy model are investigated through the optimization and updating procedure all the mentioned updating steps procedure and developed methodology are presented for the first time in an offshore structural field and it can be recommended to be applied on complex structural systems to provide an accurate and experimental based numerical model based on the results although the disagreement between the experimental data and numerical model are decreased employing the calibration parameters the highest decrement occurs as the proposed discrepancy functions are defined as a discrepancy model among the specified discrepancy functions as the second and the fourth functions are utilized for the discrepancy reduction the maximum decrement occurs that might be because of the sine nature of the functions which is so similar to the nature of the experimental outcomes however the highest fitness in the fourth discrepancy function is might be caused by the mathematical function s combined form which is a combination of exponential and trigonometric functions on the other hand the results show that the damping matrix calibration has a key role in the numerical model updating procedure as a final step of the study the natural frequency of the experimental and all updated numerical models are investigated according to the results before updating the numerical model an obvious difference exists between the experimental and base numerical model the existed difference is decreased significantly as the updating scenarios are employed the highest decrement about 78 and 98 percent occurred as the damping matrix updating scenario scenario four and the scenario including the fourth discrepancy function scenario eight are employed in fact this might be due to the sine nature of the functions which is so similar to the nature of the experiment because of the importance of the natural frequencies it is seen that the natural frequencies in all modes started getting closer to the experimental model by implementing all defined updating scenarios the highest agreement in the natural frequencies value observed as sixth and the eighth scenarios are specified for the numerical model updating procedure based on the results the presented updating methodology of this study can be considered as one of the robust updating procedures for approaching an accurate fe model of complex systems credit authorship contribution statement hamid hokmabady conceptualization investigation software data curation formal analysis methodology writing original draft writing review editing alireza mojtahedi supervision conceptualization resources funding acquisition project administration samira mohammadyzadeh validation software formal analysis data curation visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is supported by a research grant of the university of tabriz number 2749 appendix 1 the updated portion of the damping matrix coefficients is obtained for the fourth scenario as follows it should be noted that the values of matrices are gained with five to eight decimals but due to limitationsthe precision of the matrices is reduced to two and four decimals a1 β 0 26 0 32 0 298 0 30 0 27 0 25 0 32 0 31 0 25 0 24 0 25 0 28 0 31 0 32 0 25 0 31 0 27 0 35 0 31 0 34 0 32 0 31 0 27 0 29 0 26 0 29 0 31 0 25 0 32 0 30 0 27 0 27 0 28 0 27 0 29 0 33 0 30 0 28 0 33 0 26 0 32 0 33 0 30 0 29 0 32 0 28 0 34 0 26 0 27 0 30 0 27 0 26 0 30 0 28 0 35 0 33 0 35 0 26 0 25 0 30 0 27 0 27 0 34 0 33 0 29 0 31 0 31 0 29 0 34 0 33 0 34 0 29 0 30 0 24 0 30 0 26 0 27 0 29 0 32 0 31 0 30 0 32 0 24 0 30 0 26 0 28 0 26 0 27 0 28 0 30 0 24 0 32 0 31 0 34 0 31 0 33 0 33 0 33 0 29 0 34 0 29 0 30 0 27 0 33 0 33 0 26 0 27 0 30 0 25 0 28 0 26 0 29 0 32 0 29 0 28 0 32 0 29 0 29 0 15 0 31 0 31 0 33 0 35 0 35 0 30 0 31 0 28 0 30 0 30 0 28 0 20 0 32 0 34 0 30 0 27 0 31 0 30 0 35 0 32 0 34 0 36 0 27 0 22 0 25 12 12 a2 γ 0 0008 0 0007 0 0008 0 0007 0 0009 0 0008 0 0007 0 0007 0 0008 0 0008 0 0009 0 0009 0 0009 0 0008 0 0008 0 0008 0 0009 0 0008 0 0009 0 0009 0 0009 0 0007 0 0009 0 0009 0 0007 0 0007 0 0009 0 0009 0 0008 0 0009 0 0007 0 0008 0 0009 0 0007 0 0008 0 0008 0 0009 0 0007 0 0009 0 0008 0 0008 0 0007 0 0008 0 0007 0 0007 0 0007 0 0008 0 0007 0 0009 0 0009 0 0007 0 0007 0 0007 0 0009 0 0008 0 0008 0 0009 0 0008 0 0009 0 0007 0 0007 0 0007 0 0007 0 0007 0 0009 0 0009 0 0007 0 0007 0 0008 0 0008 0 0008 0 0008 0 0009 0 0008 0 0007 0 0009 0 0009 0 0008 0 0009 0 0009 0 0007 0 0007 0 0009 0 0009 0 0007 0 0008 0 0009 0 0009 0 0009 0 0007 0 0007 0 0009 0 0007 0 0008 0 0008 0 0008 0 0008 0 0007 0 0009 0 0009 0 0008 0 0009 0 0008 0 0007 0 0008 0 0007 0 0009 0 0007 0 0007 0 0009 0 0009 0 0009 0 0009 0 0008 0 0008 0 0008 0 0007 0 0008 0 0007 0 0008 0 0008 0 0009 0 0008 0 0009 0 0008 0 0007 0 0009 0 0007 0 0008 0 0009 0 0008 0 0008 0 0007 0 0007 0 0008 0 0008 0 0009 0 0007 0 0007 0 0007 0 0009 0 0009 0 0009 0 0007 12 12 
21703,to investigate the dynamic behavior of a complex system an accurate updated finite element fe model is essentially required numerical model updating which is performed based on valid experimental data is imprecise without taking the related uncertainties into account in this study both structural and parametric uncertainties are considered within model updating of an offshore jacket platform through time history analysis for the first time the experimental test is implemented employing a shake table and a scaled hydro elastic model of the case study for updating the fe model a three step updating procedure is implemented through eight distinct scenarios in the first step three unknown structural parameters are calibrated over ten distinct groups of elements in the fe model by using particle swarm optimization algorithm pso in the second step the damping matrix coefficients are also updated through the optimization process in the third step the model form error is considered utilizing four mathematical functions to decrease the parametric uncertainty and improve the fe model accuracy based on the results by employing the proposed methodology approximately 98 percent fitness is observed between the experimental and updated numerical model according to the results not only reducing both structural and parametric uncertainties is essential but also calibrating the damping matrix for updating a numerical model and improving the fe model accuracy is of great importance the developed methodology which is applied to a sophisticated structural system is strongly recommended for updating the systems that existence of an accurate updated numerical model is vital keywords numerical model updating uncertainty complex structural system shake table test offshore jacket type structure 1 introduction predicting accurate dynamic behavior of an actual complex system in situ is one of the main engineering concerns dynamic behavior prediction is performed on the basis of idealized engineering designs which is based on numerical finite element fe models jaishi and ren 2005 this prediction may not precisely represent all physical aspects of a complex structural system possibly because of inaccurate values of material property improper boundary conditions damping modeling difficulties and so forth hong et al 2016 uncertainties which is the main reason of the inaccuracy can be categorized into three distinct groups related to the fe or any computer model 1 numerical uncertainty defined as inaccuracy in mathematical equations of the problem 2 parameter uncertainty described as imprecision in model parameters definition and 3 structural uncertainty identified as inexactness and incompleteness in engineering principles modeling atamturktur and farajpour 2013 kennedy and o hagan 2001 kennedy et al 2002 among these sources of uncertainties parametric uncertainty has been proven to be the most influential source of error in fe model updating astroza and alessandri 2018 astroza et al 2019a b even if the fe model has been built according to exact design drawings the structural behavior of the system requires improvement to assure withstanding of the primary system against any probable environmental loads hokmabady et al 2019 generally considering any possible categorized uncertainty groups within the numerical calculation is of great importance to approach a high accurate and updated numerical model however many numerical model updating methods have been introduced in the literature rageh et al 2020 bakir et al 2007 jaishi and ren 2005 brownjohn and xia 2000 numerical model updating can be classified into direct methods essentially non iterative and the iterative methods mojtahedi et al 2019 in the direct method due to alterations of dynamic matrices in the numerical model during the updating procedure the physical meanings of the real structure cannot be maintained the iterative method provides almost significant updating parameters to be updated which is mainly performed based on minimizing an objective function collins et al 2012 collins et al 2012 used eigen data sensitivity as an objective function in their study the frequency response function frf data was also considered to update the numerical fe model by hong et al 2016 however damping was neglected in most of the previous studies its significant role in updating the numerical models has been investigated in some limited research astroza et al 2019a b mottershead et al 2011 taylan et al 2012 arora et al 2009 adhikari 2000 2002 and its exact role in updating a complex system is yet to be investigated astroza and alessandri 2018 showed that model uncertainty may have great detrimental impacts when the updated fe model is used for damage detection in the case of large modeling uncertainty sanayei et al 2002 investigated the estimation of modeling error significance with respect to type and locations of the measurement error function types the uncertain parameter location and unknown parameters selection they concluded that the mentioned parameters have an efficient effect on the quality of the parameter estimation zsarnóczay and baker 2020 focused on how calibration methods affect model uncertainty they have utilized the improvement of component model methods for any structural system all uncertainty sources should be evaluated to quantify their effects on a computer model generally two major methods for developing a mathematical model can be considered as probabilistic methods with statistical characteristics of the responses and or parametric modeling najafian 2007 parametric models offer a number of potential advantages including representation parsimony improved accuracy improved resolution and improved tracking of the system dynamics lotfollahi yaghin et al 2011 numerical model updating which can be performed by calibrating some numerical parameters is defined as the adjustment of a set of associated parameters through computational science and engineering code so that the model agreement be maximized with respect to an experimental data set actually to reduce the numerical and experimental model disagreement among all above mentioned numerical parametric and structural uncertainties the second and the third ones might be considered for model updating basically calibrating the input parameters of a model without considering structural uncertainty might gain mathematically correct outcomes but physically incorrect solutions atamturktur and farajpour 2013 kennedy and o hagan 2001 kennedy et al 2002 for reducing parametric uncertainty calibrating system uncertain parameters such as modulus of elasticity an iterative procedure should be performed the third factor or the structural uncertainty which is resulted from simplifying assumptions and idealizations of the problem such as linear behavior assumption of a system whereas the behavior is nonlinear in reality can be reduced by employing model form error through decreasing incorrectness of assumptions and modeling decisions the main objective of the current study is to present an efficient and practical model updating method considering uncertainties for a three dimensional space frame jacket model for the first time numerically and experimentally on the other hand in this study a method is proposed to train the model form error within a complex structural system actually model updating is performed for the first time by considering parametric and structural uncertainties through a purely optimization based approach which exposes the new method of reducing the uncertainties within an appropriate optimization process the proposed updating method is implemented by using eight distinct scenarios in a three step procedure in the first step mass and stiffness matrices are updated over an optimization based framework using experimental data which is obtained through a shake table test employing a scaled hydro elastic model of three dimensional fixed offshore jacket platform reducing the parametric uncertainty is performed by calibrating different structural parameters such as shear modulus elasticity modulus and mass density of the jacket members basically the simultaneous effect of the parametric and structural uncertainties on updating a complex system through time history analysis is yet to be investigated in this regard the members of the jacket platform are categorized into ten distinct groups based on their place and importance each updating parameters of the members are optimized separately using particle swarm optimization pso algorithm over the second step the damping matrix is updated by utilizing the updated mass and stiffness matrices and optimizing two damping coefficient matrices which is performed in updating an offshore jacket platform for the first time in the third step to reduce the structural uncertainty the model form error term is employed as a discrepancy term through four different mathematical functions the functions are chosen to study the efficiency of the discrepancy term within the optimization and updating procedures the efficiency of different discrepancy functions in updating a complex three dimensional system is also presented in offshore structural field in this study based on the results the disagreement between the experimental data and the numerical model is decreased significantly by employing both calibration parameters and using all proposed discrepancy functions although calibration of uncertain parameters is of great importance damping matrix calibration has a key role in updating the numerical model based on the results the highest fitness occurred as the damping matrix is updated and the first discrepancy function scenario is considered for updating the fe model also to date the authors are not aware of any study assessing the frequency response of the system without updating the system frequency directly for this reason the natural frequency as one of the most important engineering parameters is also investigated in this study all the mentioned updating steps procedure and developed methodology are presented for the first time in an offshore structural field the methodology is recommended to be applied on the updating process of the structural systems that presence of an accurate and experimental based numerical model is essential 2 experimental study in this manuscript two distinct experiments are carried out in the first test a shake table experiment is conducted on a scaled hydro elastic experimental model of an offshore jacket platform in modal analysis laboratory of university of tabriz to obtain the time history response of the jacket some details of the shake table facilities including the experimental model are presented in fig 1 the specification of the shake table apparatus and the scaled experimental model are listed in tables 1 and 2 respectively to perform the experimental test four light uni axial accelerometers 4507 bruel kjaer are implemented in x direction of the jacket for response measurement the accelerometers are installed on each level of the scaled model to measure the system response as shown in fig 1 a random vibration signal is applied on the scaled model in a frequency range of 1 50 hz amplitude of 4 m s 2 and duration of 20 s the test is repeated 3 times to omit any possible unintentional errors time history of acceleration is recorded as of the output of the first experiment in the second test to gain the experimental frequencies a modal analysis is implemented on the same scaled hydro elastic model of the jacket in the laboratory the external excitation based on white noise signals is enforced by the shake table using two light uni axial accelerometers 4508 b k in both the x and y directions on each joint for response measurement the frequency sampling of the test setup is chosen as 32 khz and the frequency range is taken in a range between 0 and 200 hz during the test the structural responses are recorded as frfs the recorded data are sent to the me scope software package for post processing using a curve fitting tool modal curve fitting is the process used to gain a set of modal parameters the natural frequencies of the scaled model are obtained as of the output of the second experiment 3 theoretical background in this section the theories that are used to model the objective function including the mathematical background of the parametric and structural uncertainties and the discrepancy term formulations are presented the methodology is discussed through four distinct sub sections for the current case study as follows 3 1 model updating i parametric uncertainty a relation can be defined between the experimental model response and the actual response of the prototype in reality as expressed in eq 1 kennedy and o hagan 2001 1 y o b s x i ζ ˆ x i ε x i i 1 n where y o b s x i ε x i ζ ˆ x i and n denote the experimental data the experimental error the actual response of the physical system and the number of the experimental data respectively actual response of the system can also be substituted by the summation of the numerical model including model form error as follows 2 y o b s x i y s i m x i θ ψ x i ε x i i 1 n where y s i m x i and ψ x i are the numerical model and model form error respectively x refers to control parameter which is defined as time in this study and θ denotes the input parameters of the model which cannot be controlled or adjusted during experimental test and are considered as calibration parameters in the numerical model kennedy and o hagan 2001 kennedy et al 2002 to define the parametric uncertainty which means imprecision in model parameters definition some uncertain parameters calibration parameters of the model need to be calibrated through an iteration process in this regard the calibration parameters are considered as modulus of elasticity e shear modulus g mass density md of the members and coefficients of the damping matrix β and γ in this paper for efficiency of the uncertain parameters in updating the model the members are separated into ten distinct groups based on their location and importance as shown in fig 2 3 2 model updating ii structural uncertainty structural uncertainty which is described as inexactness and incompleteness in modeling can be decreased by defining a model form error within the calculation process the model form error which is introduced in eq 2 definitely depends on the nature of the experimental model to possibly decrease the disagreement between the experimental and numerical model kennedy et al 2002 the model form error is substituted with a discrepancy term for training a model to fit the known values of model form error in the separated experimental settings by considering the discrepancy model instead of model form error eq 2 is rewritten as follows 3 y o b s x i y s i m x i θ δ x i α ε x i i 1 n where δ and α denote the discrepancy model and the nonphysical coefficients of the discrepancy model respectively in this study four mathematical functions are taken into account as of the discrepancy models the mathematical functions are considered separately in each optimization process to find the most efficient function the functions are specified as follows 4 δ 1 x α α 0 e x α 1 α 2 5 δ 2 x α α 0 sin α 1 x α 2 α 4 cos α 5 x α 6 6 δ 3 x α α 0 x 4 α 1 x 3 α 2 x 2 α 3 x α 4 7 δ 4 x α α 0 e α 0 sin α 1 x α 2 α 4 cos α 5 x α 6 where δ 1 to δ 4 represent the first to fourth discrepancy functions the functions are considered as of a continuous and differentiable function the concept of the discrepancy function is versatile in that many forms of functions combinations of functions or other polynomial forms such as legendre or bessel polynomials and trigonometric functions such as sine or cosine functions the functions in this study are chosen based on three concepts i according to the basics of the experimental data which is sine based white noise δ 2 ii in regards to the previously mentioned fundamental which is possibility of selecting any continuous and differentiable functions δ 1 and δ 3 iii a combination form of the first and the second concepts δ 4 it should be indicated that any other continuous and differentiable functions can be used instead kennedy and o hagan 2001 the coefficients of the functions should be trained based on the available experimental data set 3 3 model updating iii optimization procedure to minimize the disagreement between the numerical and experimental data simultaneously by decreasing the structural and parametric uncertainty an objective function and an optimization algorithm might be defined for this purpose the main objective function as sum of squared errors sse is specified as follows 8 f α θ i 1 n y o b s x i y s i m x i θ δ x i α 2 i 1 n where the term f α θ is the objective function by inputs of α and θ as the nonphysical coefficents of the discrepancy term and the calibration parameters respectively as it is seen in the objective function both structural and parametric uncertainties are taken into account for minimizing the sse which is specified as objective function of the problem an appropriate optimization algorithm must be used in this regard pso algorithm which is a robust optimization method for nonlinear non convex and discontinuous domains is employed pso is a nature inspired evolutionary algorithm that inspired from the behavior of the birds in a swarm eberhart and kennedy 1995 the optimization procedure is defined as a controlled loop between the matlab and frame3dd the details of which are discussed in the following section 3 4 model updating iv numerical modeling and parameters definition the jacket platform is modelled numerically by using the mass and stiffness matrices which can be the best solution for the complex space frame optimization process based on the matrix equation of the motion as follows dowson 1983 9 m u c u k u f where m and k are mass stiffness matrices of the jacket which are specified as two 228 228 matrices respectively mass and stiffness matrices are gained by using the frame3dd software henri and gavin 2010 with 38 nodes each with 6 degrees of freedom and final 109 members with no effects of non linearity in modeling however assuming linearity in modeling adds more uncertainties into the problem this assumption causes just more decrement in model form error vectors u u u and f are defiend as acceleration velocity displacement and the force vectors respectively the damping matrix is also defined as a calibration parameter in this study the matrix is defined as a combination of mass and stiffness matrices and the coefficents of the matrices are considered as calibration parameter the rayleigh technique is used to define the initial value of the optimization process to improve the accuracy of the coefficients and their efficiency the coefficents are defined with the same size of the mass and stiffness matrices for this purpose two different 12 12 submatrices with 144 elements are proposed and the matrices are repeated 19 times to create two 228 coefficent matrices each for mass and stiffness matrices as shown in fig 3 the proposed coefficient matrices are chosen based on a simple parametric study in which the required optimization time and the final aquired results are compared based on the parametric study the most efficient matrix size among eleven various sizes are gained as 12 12 by increasing the size of the coefficient matrices both the time and results are getting better logically up to 12 12 matrices but then as larger matrices are employed the optimization time increases irrationally and the final result improves inefficiently through the optimization process only the 12 12 submatrices 144 elements are supposed to be calibrated for minimizing the objective function through the optimization process a time integration method newmark beta nb method in this manuscript is employed chopra 1995 based on the selected calibration parameter and the defined discrepancy functions eq 8 is rewritten as follows 10 f i 1 n x o b s t i x s i m t i e 1 e 10 g 1 g 10 m d 1 m d 10 β 1 β 144 γ 1 γ 144 δ t i α 0 α 1 α 2 α 3 α 4 α 5 α 6 2 i 1 n some details about numerical model updating which is done through the optimization process are discussed in table 3 the algorithm of the proposed updating strategy can be described as follows the initial value of the calibration parameters is defined inside of frame3dd input file the pso algorithm is initialized inside matlab using two distinct files the first file includes the main parameters of the pso algorithm and the upper and lower values of the calibration parameters and the second file includes i the inputs of the pso algorithm specified as e g md alpha beta and discrepancy function coefficients ii java codes to run frame3dd software inside of the code to gain the new mass and stiffness matrices using new optimized values iii loading the mass and stiffness matrices iv building a new damping matrices using alpha beta values and mass and stiffness matrices v loading the experimental data vi using newmark beta method to simulate the same experimental code numerically to compare the results and vii defining the objective and the discrepancy functions the procedure of controlled loop is iterated to reach a minmum for the objective function to update the numerical model based on the unknown parameters calibration the initial values upper and lower bound values are specified as listed in tables 4 7 the values for the upper and lower bounds are taken based on the importance of the jacket members and the initial values of the modulus of elasticity shear modulus and mass density are chosen based on the specification of the steel the percentage of upper and lower bounds are taken based on the most common acceptable engineering manufacturing error value 5 in this regard 5 is chosen for the less important members members with insignificant structural importance such as internal members due to more possible manufacturing inspection and welding errors and 3 for the most important members members with significant structural importance such as main jacket leg because of higher levels of manufacturing and welding inspections although defining the same value for upper and lower bounds 3 percent for all members in tables 4 6 is possible the final results does not experience any changes due to the presence of the model form error functions in the proposed methodology which can cover the existence of uncertainties in the problem such as some difference in upper and lower bounds or the system non linearity the initial values of β and γ as damping coefficients are taken using two percent of damping ratio to gain the initial value of the damping coefficients the first and the fifth natural frequencies of the primary structure are considered based on rayleigh technique the first five mode shapes are taken in accordance with the fact that these mode shapes capture the most of the system energy for the numerical calculation the time step is taken based on the experimental results as 0 00651 s to match the experimental and numerical data over almost 12 s of time span however the main time span of the experimental study is 20 s but to prevent any unintentional errors some seconds of the first and the end sections of the experimental results are ignored the random signal which is use for the experimental test is shown in fig 4 4 results and discussion model updating of an offshore jacket platform as a complex space frame is investigated in this study in this regard the numerical fe model is updated based on the experimental shake table test using four accelerometers located on the four experimental scaled model of the jacket structural levels for the numerical modeling the same implemented experimental force is used the experimental and numerical acceleration time history on the jacket deck under the same random signal is shown in fig 5 and the validity of the results is assessed using the rms index as listed in table 8 the differences between the experimental and numerical acceleration time history rms is 3 4 percent which represents the validity of the recorded data in the experimental test the jacket deck acceleration time history in both experimental and the numerical fe model is demonstrated in fig 6 over the limited time span for more clarification although the rms result indicates that both experimental and numerical results are in an acceptable range because of the existing discrepancy between the results the numerical response of the system the numerical model cannot be used as an accurate fe model for further investigation for this reason model updating of the numerical fe model is inevitable for model updating of the fe model eight different scenarios are defined to investigate the proposed method performance the first and the second four scenarios are defined as model updating with and without considering the model form error the defined scenarios are listed in table 9 the pso algorithm is employed for optimizing the objective function for every scenario the optimization process is repeated by 50 runs each with swarm size of 20 through 100 iterations although the algorithm might converge to a local minimum in some runs due to using high number of runs ignoring some out of bound results and averaging the final results for each optimized parameter the results are rational the updating procedure is performed considering both parametric and structural uncertainties aside from ensuring the calibration parameters convergence to their true values it must be certified that the trained discrepancy model represents a true representation of model incompleteness the defined objective function given in eq 10 is approximately zero after 70 iterations the values of calibration parameters in all ten distinct structural groups are gained as a mean of all valid runs the mean value of e g and md as of calibration parameters are listed in tables 10 12 respectively due to the presence of modulus of elasticity in all scenarios the values of e is listed for all four scenarios in table 10 on the other hand the shear modulus is not considered in the first scenario which is the reason of its absence for scenario one in table 11 also due to the absence of mass density in the first two scenarios the values are limited to the third and fourth scenarios in table 12 although the value of the calibration parameters is listed in above mentioned tables the results should be presented graphically to investigate the efficiency of each calibration parameter in model updating procedure because illustrating the whole acceleration time history for studying the calibration procedure is not possible the time history is just presented for a limited time span 7s 8s in all updating scenarios the performance of the first four defined scenarios on the acceleration time history is shown in fig 7 as it is shown in fig 7a by employing the first scenario the performance of the fe model is poorly improved in comparison to the base numerical model based on fig 7b and c the second and the third scenarios consideration improved the fe model response significantly the highest fitness among the first four scenarios occurred as the damping matrix coefficients are updated according to fig 7d there is a significant fitness between the experimental and updated fe model by employing the fourth scenario the updated portion of β and γ matrices are presented in appendix 1 for assessment of the methodology of this manuscript data fitness index known as mean squared error mse is used the mse of the updated acceleration time history through the first four scenarios in comparison with the experimental data are listed in table 13 to evaluate the performance of the discrepancy model on model updating procedure the second four scenarios are defined all of these scenarios are based on considering both parametric uncertainty calibration parameters and a certain discrepancy model the difference between the experiment the third scenario the fourth scenario with two 1 1 coeffient matrices and the fourth scenario with two 12 12 coefficient matrices are shown in fig 8 and table 14 according to fig 8 by considering scaler quantities for the damping matrix the time history of the numerical model is updated insignificantly although the data is fitted to the experimental data gradually using the scaler matrices and the mse value is decreased 23 percent reduction in mse is 78 percent employing the 12 12 coefficient matrices which indicate more 50 percent fitness between the data based on the results there is a significant fitness between the experimental and updated fe model by employing the fourth scenario with 12 12 matrix coefficients which indicates not only the importance of the damping coefficients updating but also the necessity of updating the coefficients as a matrix instead of a scaler quantity however updating the whole damping coefficients matrix instead of a portion is highly recommended the effectiveness of the four specified mathematical functions in each scenario on the acceleration time history is illustrated in fig 9 as it is seen the difference between the experimental and numerical simulation is equal to 19 69 m s 2 which is a high value gradually the value of mse index decreases through employing the scenarios in updating procedure although the data is fitted to the experimental data gradually and the mse value is decreased 6 12 and 26 percent by using the first to third scenarios the fitness is significantly higher as the fourth scenario is taken into account about 78 percent reduction by using the fourth scenario indicates the importance of damping matrix updating within the numerical model updating procedure based on fig 9a the updated numerical model is well fitted to the experimental model by implementing the first discrepancy function the fitness improves as the sixth and seventh scenarios are employed see fig 9b and c however the fitness of the whole acceleration time history is significant in the fifth sixth and seventh scenarios the peaks are yet poorly fitted according to fig 9d there is a great agreement between the experimental and updated numerical model by taking the eighth scenario into account the agreement is not only on the whole performance but also on some peak points which shows the capability of the employed function the scenario eight which is about considering the fourth discrepancy function into the calculation process performed much better in comparison to other discrepancy functions basically as the second and the fourth functions are used for the discrepancy reduction the maximum decrement occurs that might be because of the sine nature of the functions which is so similar to the nature of the experimental outcomes however the highest fitness by using the fourth discrepancy function is might be caused by the mathematical function s combined form which is a combination of exponential and trigonometric functions the mse of the updated acceleration time history with considering the discrepancy functions through the second four scenarios is listed in table 15 according to table 15 the value of mse is decreased by almost 48 percent in comparison with the scenario four which is calibrating without considering the discrepancy model as the first discrepancy function is taken into account the decrement of mse is about 53 and 46 percent for the scenarios six and seven respectively in comparison to the scenario four the highest decrement occurred as the eighth scenario is implemented the decrement which is due to the highest fitness between the numerical updated model by using scenario eight and the experimental data is approximately 90 and 98 percent in comparison to the scenario four and the base numerical model respectively to reach an accurate numerical model through model updating procedure investigating the natural frequency of the updated models and its comparison to the experimental model which can be considered as the most important factor in the dynamic behavior of a structure is inevitable natural frequencies of experimental numerical and updating scenarios are listed in table 16 based on the results of table 16 there is an obvious difference between the natural frequencies of the experimental and base numerical models as the updating scenarios are considered for updating the numerical model the natural frequencies in all modes started getting closer to the experimental model the first frequencies of the scenarios one two and three are decreasing gradually but as the scenario four is considered the frequency is decreased more the decrement is also significant in scenario five even in comparison to the fourth scenario this can be caused by the number of calibration parameters which are taken into account in scenario four and also because of using the discrepancy model in scenario five for the first time the gradual decrement gets higher as combined discrepancy function is considered as the model form error in the eighth scenario in which the natural frequency is significantly matched to the natural frequency of the experimental model as it is also seen in table 16 the lowest difference between the updated numerical and experimental model is obtained as 0 2 percent when the eighth scenario is employed the introduced developed methodology of the present study is widely useful in such technologies that can be applied to complex structural systems to provide an accurate numerical model with fewer false alarms 5 conclusion in this manuscript an efficient and practical model updating method considering both parametric and structural uncertainties is presented as a real condition approach for uncertainty analysis through calibrating uncertain model parameters and structural uncertainties based on time history analysis the method is proposed by a three step updating procedure in the first step mass and stiffness matrices are updated using the experimental data which is gained by a shake table test of a fixed offshore jacket platform scaled hydro elastic model in the second step the parametric uncertainty reduction procedure is considered by calibrating different structural parameters as modulus of elasticity shear modulus and mass density of structural elements at the same time for updating a complex system in this regard the structural members of the jacket platform are categorized into ten distinct groups the updating calculation is performed using particle swarm optimization algorithm finally the damping matrix coefficients are also calibrated and the updated damping matrix is used based on updated mass and stiffness matrices in the third step the structural uncertainty reduction procedure is taken into account for this purpose model form error is employed as a discrepancy model by representing four different mathematical functions the efficiency and effectiveness of each discrepancy model are investigated through the optimization and updating procedure all the mentioned updating steps procedure and developed methodology are presented for the first time in an offshore structural field and it can be recommended to be applied on complex structural systems to provide an accurate and experimental based numerical model based on the results although the disagreement between the experimental data and numerical model are decreased employing the calibration parameters the highest decrement occurs as the proposed discrepancy functions are defined as a discrepancy model among the specified discrepancy functions as the second and the fourth functions are utilized for the discrepancy reduction the maximum decrement occurs that might be because of the sine nature of the functions which is so similar to the nature of the experimental outcomes however the highest fitness in the fourth discrepancy function is might be caused by the mathematical function s combined form which is a combination of exponential and trigonometric functions on the other hand the results show that the damping matrix calibration has a key role in the numerical model updating procedure as a final step of the study the natural frequency of the experimental and all updated numerical models are investigated according to the results before updating the numerical model an obvious difference exists between the experimental and base numerical model the existed difference is decreased significantly as the updating scenarios are employed the highest decrement about 78 and 98 percent occurred as the damping matrix updating scenario scenario four and the scenario including the fourth discrepancy function scenario eight are employed in fact this might be due to the sine nature of the functions which is so similar to the nature of the experiment because of the importance of the natural frequencies it is seen that the natural frequencies in all modes started getting closer to the experimental model by implementing all defined updating scenarios the highest agreement in the natural frequencies value observed as sixth and the eighth scenarios are specified for the numerical model updating procedure based on the results the presented updating methodology of this study can be considered as one of the robust updating procedures for approaching an accurate fe model of complex systems credit authorship contribution statement hamid hokmabady conceptualization investigation software data curation formal analysis methodology writing original draft writing review editing alireza mojtahedi supervision conceptualization resources funding acquisition project administration samira mohammadyzadeh validation software formal analysis data curation visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is supported by a research grant of the university of tabriz number 2749 appendix 1 the updated portion of the damping matrix coefficients is obtained for the fourth scenario as follows it should be noted that the values of matrices are gained with five to eight decimals but due to limitationsthe precision of the matrices is reduced to two and four decimals a1 β 0 26 0 32 0 298 0 30 0 27 0 25 0 32 0 31 0 25 0 24 0 25 0 28 0 31 0 32 0 25 0 31 0 27 0 35 0 31 0 34 0 32 0 31 0 27 0 29 0 26 0 29 0 31 0 25 0 32 0 30 0 27 0 27 0 28 0 27 0 29 0 33 0 30 0 28 0 33 0 26 0 32 0 33 0 30 0 29 0 32 0 28 0 34 0 26 0 27 0 30 0 27 0 26 0 30 0 28 0 35 0 33 0 35 0 26 0 25 0 30 0 27 0 27 0 34 0 33 0 29 0 31 0 31 0 29 0 34 0 33 0 34 0 29 0 30 0 24 0 30 0 26 0 27 0 29 0 32 0 31 0 30 0 32 0 24 0 30 0 26 0 28 0 26 0 27 0 28 0 30 0 24 0 32 0 31 0 34 0 31 0 33 0 33 0 33 0 29 0 34 0 29 0 30 0 27 0 33 0 33 0 26 0 27 0 30 0 25 0 28 0 26 0 29 0 32 0 29 0 28 0 32 0 29 0 29 0 15 0 31 0 31 0 33 0 35 0 35 0 30 0 31 0 28 0 30 0 30 0 28 0 20 0 32 0 34 0 30 0 27 0 31 0 30 0 35 0 32 0 34 0 36 0 27 0 22 0 25 12 12 a2 γ 0 0008 0 0007 0 0008 0 0007 0 0009 0 0008 0 0007 0 0007 0 0008 0 0008 0 0009 0 0009 0 0009 0 0008 0 0008 0 0008 0 0009 0 0008 0 0009 0 0009 0 0009 0 0007 0 0009 0 0009 0 0007 0 0007 0 0009 0 0009 0 0008 0 0009 0 0007 0 0008 0 0009 0 0007 0 0008 0 0008 0 0009 0 0007 0 0009 0 0008 0 0008 0 0007 0 0008 0 0007 0 0007 0 0007 0 0008 0 0007 0 0009 0 0009 0 0007 0 0007 0 0007 0 0009 0 0008 0 0008 0 0009 0 0008 0 0009 0 0007 0 0007 0 0007 0 0007 0 0007 0 0009 0 0009 0 0007 0 0007 0 0008 0 0008 0 0008 0 0008 0 0009 0 0008 0 0007 0 0009 0 0009 0 0008 0 0009 0 0009 0 0007 0 0007 0 0009 0 0009 0 0007 0 0008 0 0009 0 0009 0 0009 0 0007 0 0007 0 0009 0 0007 0 0008 0 0008 0 0008 0 0008 0 0007 0 0009 0 0009 0 0008 0 0009 0 0008 0 0007 0 0008 0 0007 0 0009 0 0007 0 0007 0 0009 0 0009 0 0009 0 0009 0 0008 0 0008 0 0008 0 0007 0 0008 0 0007 0 0008 0 0008 0 0009 0 0008 0 0009 0 0008 0 0007 0 0009 0 0007 0 0008 0 0009 0 0008 0 0008 0 0007 0 0007 0 0008 0 0008 0 0009 0 0007 0 0007 0 0007 0 0009 0 0009 0 0009 0 0007 12 12 
21704,the flow induced vibration fiv of multiple flexible cylinders typically involves multi mode and complex flow structure interactions the fiv characteristics of two staggered flexible cylinders with unequal diameters are experimentally studied in this paper the two flexible cylinders have aspect ratios of 350 and 181 and mass ratios of 1 90 and 1 47 and are free to oscillate in both the cross flow cf and in line il directions according to the relative positions of the two cylinders 10 different staggered arrangements are studied p d 6 where p is the centre to centre spacing and d is the small cylinder diameter α 15 30 45 60 and 75 where α is the position angle of the downstream cylinder the multi mode fiv behaviours of the two staggered flexible cylinders with unequal diameters were investigated with respect to various aspects e g strain and displacement responses dominant frequencies and dominant modes due to the presence of the small cylinder the cf vibration of the large cylinder was suppressed at α 15 and 30 when the large cylinder was upstream or downstream furthermore the cf and il response amplitudes of the small cylinder were significantly enhanced by flow interactions at various position angles when the small cylinder was located downstream the fiv behaviours were most greatly affected at small and large position angles α 15 or 75 in addition the wake induced flutter phenomenon was observed in the il fiv response when the small cylinder was downstream however this phenomenon was not observed when the large cylinder was located downstream keywords flow induced vibration fiv flexible cylinder staggered arrangement unequal diameter wake induced flutter 1 introduction as the demand for marine energy resources increases many cylindrical structures are being used in offshore engineering such as subsea pipelines risers and mooring lines in practical engineering applications of cylindrical structures subjected to fluid flows vortex shedding occurs causing vibration for more details regarding the flow induced vibration fiv of an isolated cylinder several classic review papers are available by sumner et al 2000 sarpkaya 2004 williamson 2004 gabbai 2005 and bearman 2011 in the case of two cylinders the mutual interference of their flow fields results in more complex flow patterns and structural responses to better understand the interference effects researchers have conducted a series of experimental studies of the flow around two identical cylinders zdravkovich and pridden 1977 moretti 1993 however multi cylinder systems with unequal diameters are often used for various operational functions such as drilling and production the fiv responses of identical cylinders are actually a special case and are of practical use in contrast this paper will systematically discuss the fiv response of two staggered cylinders with unequal diameters in different arrangements numerous studies have been performed on the fiv mechanisms of two identical cylinders it is more common for cylinders to be arranged in a staggered arrangement than in side by side and tandem arrangements kim et al 2009 kim and alam 2015 xu et al 2019 here several points are proposed for the fiv response characteristics of two staggered rigid cylinders the gap flow switch mechanism and wake galloping mechanism play important roles in the vibration patterns of two cylinders griffith et al 2017 changing the cross flow cf and in line il spacing ratio of the cylinders in various arrangements can result in changes in the influence of the two cylinders on each other in some studies the fiv responses of the upstream cylinder were similar to those of an isolated cylinder however at smaller spacing ratios the vibration response of the upstream cylinder may be affected by the feedback effect of the downstream cylinder vibration specifically the upstream cylinder may experience large amplitude vibrations prasanth and mittal 2009 huang and herfjord 2013 williamson and govardhan 2004 furthermore the vibration amplitude of the downstream cylinder was larger than that of an isolated cylinder in most studies when the spacing ratio was in the interference region the downstream cylinder was affected by the upstream cylindrical wake when the il displacements of the downstream cylinder were large wake induced flutter was observed under these conditions the ratio of the cf natural frequency to the il natural frequency was 1 0 assi et al 2010 and the lift and drag of the downstream cylinders also had the same dominant frequency prasanth and mittal 2009 moreover the trajectory of the downstream cylinder was elliptical flexible cylindrical structures are widely used in the engineering field since flexible cylinders can excite higher vibration modes and multi mode vibrations the fiv of two flexible identical cylinders is more complicated than that of two rigid cylinders for two side by side flexible cylinders the vibration of the two cylinders was synchronized when the cf spacing ratio was less than 3 5 huera huarte and gharib 2011 sanaati and kato 2014 based on experiments xu et al 2018a observed that two cylinders still strongly interact with each other in the il direction when the cf spacing ratio is 8 0 this mutual interference influenced the cf displacement and increased the il displacement for two tandem flexible cylinders the vibration response of the upstream cylinder was not sensitive to the varied il spacing ratios in contrast the downstream cylinder was affected by the wake of the upstream cylinder and its response was dominated by low frequencies and modes the wake induced vibration wiv of a flexible cylinder might not appear due to multi mode vibrations bearman 2011 huera huarte and gharib 2011 xu et al 2018b xu et al 2020 for two staggered flexible cylinders when the position angle α 20 the cylinder downstream of an identical stationary cylinder behaves like an isolated cylinder because it is outside the wake of the upstream cylinder brika and laneville 1999 experimentally evaluated the hydrodynamic motions of two flexible circular cylinders with tandem and staggered arrangements the separations ranged from 7 to 25 d and reynolds number ranged from 5000 to 27 000 it was also observed that as the spacing increases the maximum vibration amplitude decreased slightly and the velocity at which this maximum occurs also decreased for the staggered arrangement the increase in the position angle reduced the synchronization area when the angle exceeded 20 the downstream cylinder behaved like an isolated cylinder for two cylinders with unequal diameters that are free to vibrate the mutual interaction between the cylinders is more complicated than that of two identical cylinders zdravkovich 1987 introduced the classification of three interference regions around two stationary identical cylinders including proximity interference wake interference and a combination of the two whether the diameters of two cylinders are equal or unequal the mutual interaction in side by side arrangements is proximity interference three different flow regimes coupled vortex streets biased gap flow and single vortex flow have been observed depending on the cf spacing ratio sumner 2010 as the cf spacing ratio decreases the strouhal number st of the large cylinder increases while the st of the small cylinder decreases after coupled vortex streets occur the st of the small cylinder jumps to a value that is lower than the st of the large cylinder song et al 2015 moreover when the upstream cylinder is larger the types of interference for two different cylinders in tandem include wake interference and proximity interference the flow regime can also be divided into three regimes the co shedding regime reattachment regime and extended body regime alam and zhou 2008 zhao et al 2005 for two cylinders with unequal diameters in a staggered arrangement the downstream cylinder is located in the wake interference and proximity interference regimes vortex shedding has been found to be sensitive to both the position angle and the spacing ratio between two cylinders dalton et al 2001 the classification of unequal diameter cylinders is similar to that of tandem cylinders zhao et al 2007 or staggered identical cylinders sumner 2010 assi 2009 the fiv response of two cylinders with unequal diameters was quite different from that of two identical cylinders rahmanian et al 2014a 2014b pearcey et al 2017 the vibration amplitudes of two identical cylinders in tandem decrease with increases in the il spacing ratio even with a constant cf spacing ratio assi et al 2010 moreover the vibration response of a cylinder is affected by both the spacing ratio and the diameter ratio qin et al 2017 studied the cf fiv in an elastically mounted large cylinder in the wake of a smaller stationary cylinder the diameter ratio and the spacing ratio p d where p is the centre to centre spacing of a bundle of two cylinders and d is the smaller cylinder diameter were varied from 0 2 to 1 0 and from 2 0 to 6 5 respectively as the il spacing ratio increased violent vibrations in the downstream large cylinder occurred at smaller diameter ratios the upstream small cylinder wake was narrow and the shear layer tended to switch direction from one side to the other huang and andy 2011 also mentioned that the cf vibration of the downstream cylinder was affected by the wake of the upstream cylinder in addition to self vortex shedding moreover lam and to 2003 investigated the vibration characteristics of a downstream rigid cylinder with a diameter half that of an upstream cylinder the cf and il spacing ratios were varied from 0 to 2 82 and from 0 to 4 68 respectively those authors observed that the fiv in the flexible cylinder was greatly suppressed in the side by side arrangement and in the tandem or near tandem arrangement when the amplitude ratio becomes larger there is a tendency for the locking range to narrow yokoi and hirao 2009 carried out model tests on two side by side cylinders with d d 0 5 and p d 3 5 6 5 both increases in the vibration frequency of the cylinder and changes in the flow pattern occurred in response to changes in p d similar to the behaviour of two identical cylinders the large and small cylinders had different lock in ranges that were wider than those of an isolated cylinder lam and to 2003 observed that the response curves of staggered cylinders were also greatly modified by the broadening of the lock in resonance range huang and andy 2013 also studied two rigid cylinders of different diameters in staggered arrangements when a larger cylinder is placed upstream the drag coefficient of the small cylinder downstream is dependent upon the spacing ratio and the diameter ratio the higher the ratio is the larger the drag coefficient the mean lift exhibited an opposite trend all of the downstream cylindrical response coefficients are similar to the responses of the two equal diameter cylinders described above as mentioned above little work has been done on the fiv responses of two flexible cylinders with unequal diameters traditional studies have focused on the flow structures of two stationary cylinders or the fiv of rigid cylinders through the study of two identical cylinders xu et al 2018a 2019b it has been recognized that the multi mode and high amplitude responses of a flexible cylinder can effectively reflect the fiv characteristics this conclusion was also the basis for studying fatigue damage and structural damage therefore it is necessary to conduct experimental studies on flexible cylinders with unequal diameters to identify interesting fiv phenomena the remainder of this paper is organized as follows sections 2 and 3 detail the description of the experimental setup and the methods used for processing the test data the experimental results presented include the dominant mode the dimensionless displacement amplitude and the dominant frequency which are discussed in sections 4 and 5 wake induced flutter is presented in section 6 section 7 draws some conclusions based on the present analysis of the experimental results 2 model experimental setup the position of the small cylinder relative to the large cylinder is defined by the spacing ratio p d and the position angle α as shown in fig 1 the cf direction is perpendicular to the oncoming flow while the il direction is parallel to the flow direction thus in a schematic diagram of a bundle of two cylinders the diameter of the large cylinder is d and the diameter of the smaller cylinder is d the centre to centre spacing of a bundle of two cylinders is p and the chosen spacing ratio is p d 6 0 in previous experimental studies on the fiv of two equal diameter flexible cylinders in a side by side arrangement when the spacing ratio is smaller than 6 0 apparent proximity interference exists in the cf direction assi and gustavo 2014 huera huarte and gharib 2011 xu et al 2018a for two tandem cylinders at p d 6 the mean root mean square rms cf to il displacement amplitude ratio was the largest and the downstream cylinder was in the interference region xu et al 2018b however since flexible cylinders have a greater displacement response than fixed cylinders the corresponding flow areas of flexible cylinders are different than those of fixed cylinders therefore in the test the oscillations of two unequal flexible cylinders are expected to show mutual interference at p d 6 0 the position angle α is the angle between the flow direction and the line connecting the centres of the two cylinders when α 0 and 90 the cylinders are in tandem and side by side arrangements respectively to clearly describe the staggered spatial positions five angles at equal intervals α 15 30 45 60 and 75 are defined between α 0 and α 90 moreover the experiment is divided into two cases in fig 1 in case i the small cylinder is located downstream of the large cylinder in case ii the large cylinder is located upstream of the small cylinder consequently 10 different staggered arrangements are established in a series of experiments labelled case i a e and case ii a e the area was divided into four colours to delineate the four types of flow regions classified by zdravkovich 1987 the interference of two rigid cylinders was divided into three groups according to the centre to centre distance and the direction of the approaching flow proximity interference occurs if the cylinder is not submerged in the wake of the other wake interference occurs when the downstream cylinder is partially or fully submerged in the wake of the upstream cylinder the no interference regime occurs when there is negligibly weak interference between the two cylinders in offshore engineering applications pipes with different functions are generally designed to have different sizes and the diameter ratio of risers with different diameters can typically vary from 1 to 4 in our two case experiment the two cylinders are denoted the small cylinder and the large cylinder the diameter of the small cylinder is d 0 016 m and the diameter of the large cylinder is d 0 031 m hence the diameter ratio is 0 5 song et al 2007 found that the interaction between two tandem cylinders is very strong when d d is approximately 0 75 in addition using two cylinders with diameters of d 0 031 m and d 0 016 m lam and to 2003 studied the fiv response of a flexible cylinder located near a large cylinder zhao et al 2007 also conducted research on two unequal diameter cylinders with a diameter ratio of 0 5 to ensure comparability with the previously observed experimental phenomena the diameter ratio selected in this experiment was 0 5 each cylinder model was 5 60 m long and consisted of an outer silicone tube and an inner copper tube as shown in fig 2 the copper pipe had an outer diameter of 0 008 m while the diameters of the silicone tube were 0 016 m and 0 031 m the copper pipe and the silicone tube were closely attached to each other and their movements were exactly the same the two cylinders were free to vibrate in both the cf and il directions and had some identical parameters as presented in table 1 seven measurement points were evenly distributed in the axial direction of the cylinder and were labelled g1 g7 four strain gauges were divided into two groups connected to the outer surface of the copper pipe to monitor the bending strains in the cf direction and the il direction during each working condition sampling was performed after the carriage reached a stable towing velocity and the sampling frequency was 100 hz the sampling duration of each test run was 50 s the data were collected after the transport reached a stable velocity the waiting time between two consecutive runs was 15 min to calm the disturbed water and more than 70 runs were performed for all experimental cases the laboratory experiments were carried out in a water towing tank at the state key laboratory of hydraulic engineering simulation and safety tianjin university china this tank was 137 0 m long 7 0 m wide and 3 3 m deep and was equipped with a carriage the experimental device was mounted on the carriage and moved along the two smooth tracks at the top of the water tank to simulate a uniform flow the towing velocity in our experiments started at 0 05 m s and increased at a rate of 0 05 m s to 1 0 m s for all tests the initial axial pretension of the cylinder was equal to 450 n fig 3 shows that the experimental setup consists of a total of 13 components the main components were the supporting structure vertical supporting rods supporting plates and guide plates cylinder models and axial tension system the guide plate was mounted on the supporting plate by a number of long bolts to avoid interference flow generated by the supporting plates and the supporting rods ensuring that the incoming flow was two dimensional two flexible cylinders with different diameters were mounted on two guide dials that were fixed to the supporting plate dial the supporting plate dial as illustrated in fig 3 was used to change the position angle of the cylinders five position angles in both cases were tested α 15 30 45 60 and 75 a universal joint was used to connect the end of each flexible cylindrical model to the support dial cylinder model providing boundary conditions the steel wires and the load cells were connected to the other end of two cylinders through the pulleys and continuously connected to the spring a tensioner was applied to adjust the axial tension of the flexible cylinders and springs were used to ensure a gradual change in the axial tension 3 data analysis methodology to obtain the displacement response of the two flexible cylinders in the cf and il directions a modal analysis method was used to reconstruct the displacement information of the cylinder from the filtered strain signal it is assumed that the vibration displacements of the cylindrical structures at any time can be expressed as a linear superposition of a series of natural modes according to the strain information of different discrete points such as measurement points g1 g7 in this paper the displacement information of any location along the cylindrical structure can be obtained here only the cf displacement reconstruction is described as an example 1 y z t n 1 w n t ϕ n z z 0 l where y z t is the cf displacement z is the coordinate along the axis of the cylinder t is time l is the cylinder length ϕ n z is the mode shape w n t is the modal weight and n is the order of the vibration mode in our tests the cylinder with a pretension of 450 n can be simplified as a bernoulli euler beam with the pinned pinned boundary condition thus the mode shape of displacement can be written as 2 ϕ n z sin π n z l z 0 l furthermore the pinned pinned boundary conditions of the cylinders were utilized in the experiments the displacement response was reconstructed based on the relationship between the curvature and strain 3 ε z m t r n 1 π n l sin π n z l w n t where ε z m t is the strain signal at location z m and r is the outer radius of the copper pipe where z m denotes the strain gauges g1 g7 placed along the axis m 1 7 the modal weight w n t can be calculated according to eq 3 the lowest mode that is excited when the riser vibrates is n 1 and the highest mode that participates in vibration is n 2 so the vibration displacement of the riser should be approximated only by the n n 2 n 1 1 modal functions involved in the vibration in this paper seven strain gauges were attached in the experiment and the highest can be excited to the 7th mode therefore n 1 1 and n 2 7 then the formula can be expanded into a system of equations corresponding to a certain time t as follows 4 a m n π l 2 n 1 2 sin n 1 π z 1 l n 1 1 2 sin n 1 1 π z 1 l n 2 2 sin n 2 π z 1 l n 1 2 sin n 1 π z 2 l n 1 1 2 sin n 1 1 π z 2 l n 2 2 sin n 2 π z 2 l n 1 2 sin n 1 π z m l n 1 1 2 sin n 1 1 π z m l n 2 2 sin n 2 π z m l 5 w n 1 w n 1 t w n 1 1 t w n 2 t t 6 b m 1 ε z 1 t r ε z 2 t r ε z m t r t where a m n b n 1 and w m 1 are matrices the formula is written as follows 7 a w b this method is a modal decomposition method using filtered strain data as an input signal the value of the modal weight function w n t can be calculated by eq 1 and then the spatial displacement information can be solved more details of the modal analysis method are presented in lie and kaasen 2006 taking the fiv response of the small cylinder as an example the modal analysis method is explained as shown in fig 4 the small cylinder has a position angle α 45 and the towing velocity is u 0 45 m s in case i where u is the towing velocity of the carriage based on the modal weight distribution results eq 1 is used to reconstruct the displacement response the first column shows the time histories of the cf strain at the seven measurement points the second column shows the seven modal weights in the cf direction and the third column shows time varying dimensionless displacements at the seven measurement points along the cylinder axis the modes from the 4th to 7th are not excited and the 2nd mode dominates the vibration the maximum displacement amplitude is obtained at g6 with a peak value of nearly 3 0d furthermore a weaker vibration is observed in the middle of the cylinder at g4 which also indicates that the cf response is dominated by the 2nd mode in this example 4 cf fiv responses in this section the cf fiv characteristics of two cylinders with different diameters are studied by discussing the maximum rms values of the dimensionless amplitude the dominant frequencies and the dominant vibration modes in the cf direction herein the reduced velocity is defined by the flow velocity and the diameter and fundamental frequency of the cylinder because the diameters of the two cylinders in this paper are not equal the reduced velocity v r is defined for the small cylinder for convenience unless otherwise stated notably the reduced velocities are defined as v r u df s 1 where f s 1 is the fundamental frequency 1st mode frequency of the small cylinder in still water calculated from 8 f s 1 t a m 1 π l 2 e i m 1 1 2 2 l where m 1 represents the mass which is the sum of the structural mass m s1 and the added mass m a1 ρπd 2 4 ρ is the fluid density and ei and t a are the bending stiffness and axial tension of the cylinder model respectively the dominant cf modes of the small and large cylinders are illustrated in fig 5 and the counterparts of the isolated cylinder are provided for comparison fiv cannot be excited and random errors will occur in the measurement results at lower flow velocities hence the data collection began at a towing velocity of 0 15 m s which corresponds to v r 3 76 it should be noted that the dominant mode is the mode with the highest modal weight in eq 1 the dominant cf modes of the two cylinders increase from the lower mode to the higher mode with increasing v r see fig 5 comparing the large and small cylinders with an isolated cylinder the cylinders are less affected when they are the upstream cylinder nevertheless the modes are influenced at some reduced velocities when the cylinder is the downstream cylinder on the one hand when the small cylinder is the downstream cylinder as in case i e α 75 the mode is reduced from 4 to 3 and then rises to 4 with increasing v r from 22 54 to 25 05 the large cylinder also exhibits a similar phenomenon as in case i c α 45 the mode is reduced from 3 to 2 and then rises to 3 with increasing v r from 17 53 to 21 29 this phenomenon occurs because there may be more than one modal contribution at a certain reduced velocity resulting in competition between two adjacent modes because this modal competition is sensitive to wake interference this effect is more pronounced for cylinders that are downstream however for the small downstream cylinder in case i a α 15 the dominant mode only excited the 3rd mode owing to the wake shielding effect this phenomenon was also found in the downstream cylinders of models involving two tandem flexible cylinders xu et al 2018b hence when the cf spacing ratio is small α 15 the downstream cylinder may be affected by wake shielding figs 6 and 7 show the dimensionless dominant frequency of two cylinders f cf f s 1 and f cf f l 1 corresponding to the reduced velocity v r in the cf direction the fundamental frequency f s 1 of the small cylinder is mentioned above and is based on eq 9 the fundamental frequency f l 1 of the large cylinder can be calculated from 9 f l 1 t a m 2 π l 2 e i m 2 1 2 2 l where m 2 represents the mass which is the sum of the structural mass m s2 and the added mass m a2 ρπd 2 4 the fast fourier transform fft method is used to calculate the dominant frequency based on the time varying displacement st is referred to as the dimensionless vortex shedding frequency as shown in figs 6 and 7 dominant the cf frequencies of the large and small cylinders match the dominant cf modes which increase as v r increases at some reduced velocities the dominant cf frequencies of the two staggered cylinders are larger than those of an isolated cylinder which corresponds to the phenomenon in which two unequal diameter cylinders enter the higher order vibration mode earlier the dominant frequency has an obvious relationship with the position angle α as the position angle α increases the dominant frequency becomes increasingly similar to that of an isolated cylinder for example the dominant cf dimensionless frequencies of the small cylinder are most similar to those of an isolated cylinder at α 75 whether the cylinder is upstream or downstream compared with that of an isolated cylinder the oscillation frequencies of both large and small cylinders are lower when the cylinders are downstream and α 15 due to the mutual influence of the two cylinders the vortex shedding frequency is slightly suppressed this observation shows that the cf spacing is the main factor affecting st zhao et al 2007 found an interaction mode in which there were strong interactions between the vortex shedding of a large cylinder and the shedding of a small cylinder when the small cylinder was located in the rear upper side of the large cylinder the shedding behind the cylinder was influenced by the shear layers behind the gap zhao et al 2005 for two tandem flexible cylinders the st of the downstream cylinder was lower the cf spacing of the two cylinders changes due to vibration xu et al 2018b when the cf spacing of two side by side flexible cylinders is less than 6d both cylinders exhibited low dominant frequencies xu et al 2018a this finding indicates that the vortex shedding frequencies of the cylinders in the proximity interference zone are affected this phenomenon also explains why the dominant frequencies of the upstream cylinder are slightly reduced as shown in fig 8 to study the vortex shedding frequency of two flexible cylinders with unequal diameters the st is calculated based on the frequency data in figs 6 and 7 the calculation formula can be written as 10 s t f s d u s t f s d u where it is assumed that the vortex shedding frequency is the dominant frequency in the fiv response some researchers have also adopted similar methods gao et al 2015 xu et al 2018b to intuitively reflect the st with varied α a horizontal line representing the st corresponding to the isolated cylinder is given in fig 8 the st values calculated for the large cylinder and the small cylinder according to the dominant cf frequencies are approximately the same as those of a corresponding isolated cylinder the st is not sensitive to changes in the position angle the corresponding dominant frequencies are similarly characterized fig 9 illustrates the maximum cf rms dimensionless displacements of the small cylinders versus the reduced velocity in the two cases the rms displacements can reflect the magnitude of the response of a cylinder and can be calculated as follows 11 y m a x r m s m a x 1 i n y r m s z i x m a x r m s m a x 1 i n x r m s z i the dimensionless amplitudes of the small cylinder at different position angles α are generally similar to those of an isolated cylinder all y max rms d values of the small cylinders are in the range of 0 0 2 0 the displacement amplitude varies with the reduced velocity within a mode and decreases as the dominant mode changes however the behaviours of y max rms d differ between case i and case ii that is whether the small cylinder is the downstream or upstream cylinder for example the maximum cf amplitude is approximately 1 74 in case ii and 1 49 in case i at α 75 in fig 9 a the y max rms d of the small cylinder is significantly lower than that of an isolated cylinder at α 15 and 75 in cases i a and e since the diameter ratio d d 0 5 the wake interference of the upstream cylinder is larger than that of an equal diameter cylinder due to the difference in diameter wake interference only appears when the cf or il spacing is large because both the diameter and vibration displacement of the upstream large cylinder affect the formation of the gap flow therefore gap flow is only found between the two staggered cylinders at a larger or smaller position angle and the gap flow under these conditions is more intense than the gap flow at other angles after careful observation the small cylinder is insensitive to changes in the position angle when it is located upstream in case ii the decrease in several cf amplitudes is due to vortex shedding generated by the small cylinder being disturbed by the large cylinder except at α 15 at which the behaviour is similar to that of the upstream cylinder in a model involving two tandem flexible cylinders when the il spacing is 4d the y max rms d of the small cylinder is slightly lower than that of an isolated cylinder xu et al 2018b in addition some y max rms d values of the upstream cylinders are higher than that of an isolated cylinder at each angle based on experiments prasanth and mittal et al 2009 found that an upstream rigid cylinder also has a larger cf displacement than an isolated cylinder qin et al 2017 found that violent cylinder vibration is primarily associated with the lift force induced by the shifting of gap shear layers from one side of the downstream cylinder to the other many researchers have extensively discussed the wiv phenomenon of downstream cylinders in tandem arrangements that oscillate freely in the cf direction when the reduced velocity ranges from 3 76 to 12 52 the displacement responses of the small cylinder at some position angles are significantly different from the displacement responses of an isolated cylinder as shown in fig 9 as shown in fig 10 for small cylinders at α 15 and 30 in case ii y max rms d consistently increases with an increase in v r before the reduced velocity reaches 12 52 the first difference from the observations of previous studies is that the maximum y max rms d is not significantly larger than that of an isolated cylinder in our experiments at position angle α 30 this type of escalation results in a peak y max rms d of approximately 1 73 and the corresponding value of the isolated single cylinder is 1 19 in addition these effects show that when v r exceeds 12 52 for both position angles α 15 and 30 the cf amplitude of the small cylinder stops increasing and returns to a level corresponding to the amplitude of the isolated cylinder in fig 9 the second difference is that a previous study observed the wiv phenomenon in downstream cylinders in our experiments the small cylinder also exhibits the wiv phenomenon as the upstream cylinder these differences may be affected by the reynolds number and the relative positional change between the two cylinders huang and herfjord 2013 studied fixed and elastically supported rigid cylinders of dissimilar diameters for the upstream large cylinder the vortex induced vibration viv was similar to the classical lock in response unless the spacing was less than 2d in summary the effect of a large cylinder on a small cylinder located upstream does not inhibit its vibration or even increase the displacement value however for the large cylinder the performance of the cf dimensionless displacement is quite different from that of the small cylinder as shown in fig 11 the difference between the isolated cylinder and the large cylinder is remarkable as presented in fig 11 a and b the cf dimensionless displacement amplitude of the large cylinder can reach approximately 3 45 in case i e α 75 in the v r range from 6 26 to 20 04 the y max rms d of the large cylinder is relatively low with a value of approximately 1 50 and there is no upward trend which is obviously different from the behaviour of the isolated cylinder for two staggered identical rigid cylinders there was also a phenomenon in which the downstream cylinder affected the upstream cylinder prasanth and mittal 2009 huang and herfjord 2013 it can be seen from the y max rms d values of the large cylinder that the large cylinder is greatly affected by the different position angles in fig 11 at lower angles of incidence such as α 15 and α 30 the small cylinder suppresses the vibrations of the large cylinder this response is contrary to the cf displacement response of the downstream elastic cylinders in a previous study bao et al 2011 those authors studied the flow interference of two staggered identical cylinders with a spacing ratio of 4 the cf vibration of the large cylinder is suppressed at small position angles α 15 30 and the cf dimensionless displacement coincides with that of the isolated cylinder at large position angles the response of the large cylinder when it was the upstream cylinder was discussed by alam and zhou 2008 the presence of the downstream cylinder acts to slow down the flow around the upstream cylinder such that the frequency of the vortex shedding of the upstream cylinders decreases when the large cylinder is the downstream cylinder the mechanism is the same as that of two cylinders with the same diameter and is related to the wake interference of the upstream small cylinder the fiv response of a flexible cylinder can be analysed by the behaviour of standing waves and travelling waves due to the combination of travelling waves and standing waves an asymmetry in the displacement distribution is created fig 12 shows the dimensionless displacement contours of the spatiotemporal variation in the cf direction at some representative reduced velocities namely u 0 40 m s 0 55 m s 0 80 m s and 0 95 m s corresponding to v r 10 02 13 78 20 04 and 23 80 respectively the 2nd mode is dominant in the cf direction for the small and large cylinders at v r 10 02 and for the isolated cylinder increasing v r to 23 08 the higher modes of vibration are gradually excited in the cf direction the small cylinder excites the 4th mode and the large cylinder excites the 3rd mode which is consistent with the dominant mode of fig 5 a comparison of fig 12 a and b shows that the large cylinder is in good agreement with the corresponding isolated cylinder this result is similar to the phenomenon observed in a previous study xu et al 2018a the asymmetry of the spanwise evolution of the two cylinders could be due to the increasing gap flow between the two cylinders as v r increases the combination of travelling waves and standing waves makes the asymmetric distribution of the small cylinder more obvious which can be attributed to the combination of adjacent vibration modes the fiv responses of flexible cylinders have been shown to be complicated due to variation in the response along the axis 5 il fiv responses in the same manner as in the previous section the il fiv responses of the two cylinders are discussed in this section the dominant il modes of the small and large cylinders are illustrated in fig 13 and an isolated cylinder is provided for comparison the dominant il mode of two unequal cylinders is more complex than the dominant cf mode higher order modes are excited which makes the response of the flexible cylinder in the il direction more complex than that in the cf direction the dominant modes of the small cylinder in the il direction no longer appear to have a consistently positive relationship with reduced velocity instead a jump is observed when the small cylinder is located downstream of the large cylinder the dominant il mode jumps from the 2nd to the 4th mode at position angles α 45 and 75 as v r increases from 7 52 to 8 77 the higher modes are excited earlier for two cylinders in a staggered position than for an isolated cylinder in case ii the dominant il modes of the downstream small cylinder are obviously different from those of the isolated cylinder the dominant il mode jumps occur at low reduced velocities v r 7 52 and 8 77 and high reduced velocities v r 23 80 and 25 05 at several position angles α 15 and 75 the small cylinder has a lower dominant il mode than the isolated cylinder at the same rate of decrease at low reduced velocities the il vibration of the large cylinder is controlled by the 1st mode at high reduced velocities the dominant il mode is only excited to the 4th mode the isolated cylinder is excited to the 6th mode there are two reasons for this phenomenon when the small cylinder is at a position angle α 15 it is located in the wake of the large cylinder and is affected by the upstream shielding effect this situation is similar to that of the downstream cylinder in a system with two identical cylinders in tandem xu et al 2018b when the small cylinder is at a position angle of α 75 it is located in the proximity interference regime compared to the case of α 15 this position is associated with a wake shield effect the relationship between the lower dominant il mode of the small cylinder and the wake shield effect is not strong and should be related to the wake induced flutter however the dominant il modes of the large cylinder are similar to the dominant il modes of the isolated cylinder with modes in the range from the 2nd mode to the 4th mode the data in the il direction also have a monotonously increasing relationship with a reduction in the velocity hence the behaviour of the large cylinder is significantly different from that of the small cylinder the dominant modes of the large cylinder in the cf and il directions are similar to those in the isolated state in addition regardless of whether the large cylinder is located upstream or downstream or at different position angles it is only slightly affected by the presence of the small cylinder this is clearly different from the behaviour of two staggered cylinders with equal diameters the large cylinder is considered the main cylinder and the small cylinder is regarded as the subsidiary cylinder when the diameter ratio d d is reduced to 0 5 the effect of the subsidiary cylinder on the main cylinder is negligible figs 14 and 15 illustrate the dominant dimensionless frequencies of the small and large cylinders respectively some jump points are observed in both figures which correspond to mode jumps in the dominant il mode when the small cylinder is upstream the dominant il frequency generally increases linearly and is close to the dominant il frequency of the isolated cylinder however when the small cylinder is downstream of the large cylinder there are more jump points indicating that mode jumping is frequent in addition in case i e α 75 the il frequencies of the small cylinder are lower than the il frequencies of the isolated cylinder and approximate its cf frequencies hence the decrease in the dominant il modes of cylinder 2 indicates the appearance of wake induced flutter in addition to several jump points the dominant il dimensionless frequencies of the large cylinder basically increase as the reduced velocity increases see fig 14 moreover regardless of the position of the large cylinder the dominant il frequency of the large cylinder is substantially the same as the dominant il frequency of the isolated cylinder from the combination of figs 7 and 15 the dominant frequencies of the large cylinder in both the il and cf directions are insensitive to the presence of a small cylinder the st in fig 16 is calculated based on the frequency data in figs 14 and 15 it can be seen from the st values of the small cylinder in case ii and the large cylinder in case i that the vortex shedding frequency of the upstream cylinder is similar to that of the isolated cylinder except for the downstream small cylinder in case i the st in the il direction is approximately twice that in the cf direction for the downstream small cylinder in case i as the position angle increases from 15 to 75 the st varies from 0 281 to 0 172 when the position angle is α 75 the st values of 0 172 in the il direction and 0 160 in the cf direction are similar fig 17 illustrates the maximum il rms dimensionless displacements of the large and small cylinders versus the reduced velocity in cases i and ii the procedure for calculating the maximum il rms displacement x max rms is the same as that of y max rms the displacement response in the il direction varies significantly at different position angles at a position angle α 15 the small cylinder x max rms d exhibits a similar trend to the isolated cylinder x max rms d except for some larger values at reduced velocities as the position angle increases α 30 and 45 at high reduced velocities v r 18 79 25 05 the difference between the displacement response behaviours of the small cylinders and the isolated cylinder becomes larger regardless of case i or case ii it is observed that the x max rms d of the small cylinder is larger than that of the isolated cylinder when the position angle is increased to 60 the small cylinder exhibits similar behaviour to the isolated cylinder again the cf and il spacing changes as the position angle changes as mentioned x max rms d is sensitive to changes in cf and il spacing when the position angle reaches 75 the x max rms d of the small cylinder in case i differs from that of the isolated cylinder the il displacement of the small cylinder increases continuously after the il displacement of the isolated cylinder reaches a local peak the x max rms d of the small cylinder can increase to values 2 3 times higher than the corresponding value of the isolated cylinder the increase in il displacement is one characteristic of wake induced flutter prasanth and mittal 2009 fig 18 shows that the il maximum rms amplitude of the large cylinder is more similar to that of the isolated cylinder than that of the small cylinder the x max rms d of the large cylinder is lower than the corresponding value of the isolated cylinder at higher reduced velocities see α 30 45 60 and 75 nevertheless for case ii and α 15 the large cylinder has several x max rms d values that are larger than those of the isolated cylinder generally the x max rms d values in case ii are more consistent than the x max rms d values in case i but the general trend is similar the presence of the small cylinder can be considered to have little effect on the large cylinder in the il direction this is consistent with our view summarized from the dominant mode and dominant frequency see figs 13 and 15 the fluctuation of the large cylinder at α 45 will be larger than that at α 45 because the large cylinder is in the proximity and wake interference zones however the small cylinder has a more pronounced effect on the suppression of vibration in the large cylinder in the cf direction especially at α 45 see fig 11 in addition a wavelet transform was applied to the vibration signals of the rising displacement points as shown in fig 19 the il vibration of the large cylinder located downstream at v r 16 28 17 53 and α 75 indicates a typical multi frequency resonance the dominant frequency f il is approximately 3 5 hz and a harmonic component of 1 5 times the dominant frequency is observed in the spectrum i e f il 5 2 hz additionally harmonic components 0 5 and 2 times the dominant response frequency are also observed these results could be explained by the flow characteristics of the side by side arrangement in a staggered configuration when the cylindrical gap is narrowed mutual interference occurs and a deflected flow is formed yokoi and hirao 2009 song et al 2015 therefore the vibration of the small cylinder can be affected fig 20 clearly shows that different displacement responses are exhibited at the seven points in the il direction of the large and small cylinders the chosen example exhibits wake induced flutter case i and α 75 the spatial distribution of the il rms displacement along the length of the large cylinder is close to that of the isolated cylinder at different v r values the il response of the large cylinder at reduced velocities v r 10 02 13 78 is the 3rd mode and standing waves are observed additionally travelling waves are observed in the il displacement of the small cylinder for the small cylinder at v r 13 78 the combined standing wave and travelling wave are dominant as v r increases to higher reduced velocities v r 20 04 23 08 the small cylinder is still dominated by the 3rd mode and the large cylinder is dominated by the 4th mode however the il displacement distribution curve of the isolated cylinder has five peaks representing the 5th vibration mode at the same reduced velocity both standing waves and travelling waves are observed moreover the amplitude of the small cylinder is significantly larger than that of the isolated cylinder for example the peak amplitude of the small cylinder approximately 0 8 is nearly double that of the isolated cylinder approximately 0 4 at v r 20 04 the il displacement is enlarged and dominated by the travelling wave when wake induced flutter occurs 6 wake induced flutter phenomenon fig 14 shows that the dominant il frequency of the small cylinder was always low in case i e α 75 as shown in fig 21 when the small cylinder is the downstream cylinder the same dimensionless dominant frequency is observed in the cf and il directions when v r 5 01 8 77 and 16 28 25 05 this phenomenon is related to the occurrence of wake induced flutter when the cylinders are in a staggered arrangement thus in this section we discuss the wake induced flutter observed in our experiments the wake induced flutter acts on the downstream cylinder resulting in a large il displacement and an elliptical motion trajectory naudascher and rockwel 1994 assi 2009 this wake induced flutter is a coupled mode flutter in which two prominent frequency components are observed in the il direction the higher frequency component is related to the vortex shedding of the cylinder the lower frequency component is similar to the dominant cf frequency which is a typical feature of wake induced flutter a similar phenomenon was observed in our previous experimental study of two tandem and staggered flexible cylinders xu et al 2018b xu et al 2020 like all coupled mode flutter phenomena the wake induced flutter phenomena occur only within a limited range of x y frequency coalescence i e only when the horizontal and vertical frequencies differ slightly obviously when the wake induced flutter phenomenon acts on the small cylinder in case i e α 75 at v r 25 05 in fig 22 the corresponding trajectories of the measurement points g1 g7 have an elliptical orbit in addition the trajectory is not axisymmetric due to the asymmetrical nature of the wake interference this trajectory indicates that the oscillation frequencies in the il and cf directions have the same value the wake induced flutter can be excited in an unstable flow and can be maintained by a stable fluid force in the wake naudascher and rockwel 1994 the observations above show that the wake induced flutter response of the small cylinder is affected by vortex shedding from the large cylinder the small cylinder located downstream can continuously obtain energy from the wake of the large cylinder when the cylinder follows this elliptical trajectory the corresponding displacement increases see figs 17 and 20 when the x y trajectory of the downstream cylinder is an elliptical orbit as depicted in fig 22 it will move through different gradients of steady lift and drag in addition the cylinder can only circulate in the high drag zone and the low drag zone in a coupled lateral motion mittal et al 2001 2004 explained the mechanism of the wake induced flutter of flexible cylinders from the perspective of flow energy conversion and analysed the vortex shedding mechanism that study is similar to the study of rahmanian et al 2014a b which describes the x y trajectories of a cylinder exhibiting elliptical trajectories at similar positions these authors numerically studied the two degrees of freedom viv of two mechanically coupled cylinders with a diameter ratio of 0 1 examination of the time varying il spectrum in fig 23 reveals that there are three frequency components of approximately 8 hz 15 hz and 23 hz in the selected time period 20 50 s at the seven measurement points the higher frequency components 15 hz and 23 hz are approximately twice and three times as high as the lower frequency component which is close to the dominant il frequency of the isolated cylinder in addition the lower frequencies dominate however due to the apparent low frequency component the il displacement of the downstream cylinders still increases significantly hence the remarkable low frequency il component of the downstream cylinder is one of the typical signs of wake induced flutter fig 24 shows the response trajectories of the large flexible cylinders at seven measurement points along the length with different reduced velocities in case ii for the large cylinder at the same position angle α 75 the motion trajectory is an extremely asymmetrical 8 shape at g1 g7 similar behaviours of the x y trajectories were observed in the experiment of two side by side flexible cylinders by xu et al 2018a the 8 shape in the figure is basically symmetrical because there is only one frequency component in the il displacement fig 25 presents the dominant il and cf frequency components at measurement points g2 g4 and g6 the il frequency component is approximately 8 and the cf frequency component is approximately 4 because the frequency component ratio of cf and il is 1 2 an 8 shape is observed at the measurement point when the upstream cylinder is the small cylinder it has little effect on the large cylinder downstream in this situation the large cylinder is not located in the wake field of the small cylinder and the release of vortices from the small cylinder does not affect the large cylinder both cylinders exhibit vortex shedding and anti phase synchronization similar to the behaviour of side by side cylinders sumner 2010 in contrast when the small cylinder is located in the wake of the large cylinder it is subject to interaction with the vortices shed from the upstream cylinder this interaction is asymmetrical resulting in unstable fluid forces acting on the small cylinder specifically these conditions result in large il displacement and an elliptical motion trajectory 7 conclusions the fiv response of two flexible cylinders with different diameters is studied experimentally in this paper the spacing ratio is constant p d 6 and the two cylinders are studied at different position angles α 15 30 45 60 and 75 in two cases by analysing the dominant frequencies the dominant modes and the maximum rms displacement amplitudes the interaction between the two cylinders in terms of vibration response characteristics at different spatial positions is discussed the following main conclusions from the 2 cases are described as follows 1 in case i the large cylinder is located upstream of the small cylinder for the large cylinder the il fiv responses are similar to those of an isolated cylinder the cf response of the large cylinder is affected by the small cylinder the cf vibrations of the large cylinder at α 15 and 30 v r 12 54 20 04 are lower than those of the isolated cylinder the large cylinder oscillates in the il direction with dominant frequencies and dominant modes similar to those of the isolated cylinder for the small cylinder the cf vibration is suppressed at α 15 while the il vibration is slightly larger at α 15 owing to the wake shield effects a typical wake induced flutter phenomenon is observed in the small cylinder at α 75 and v r 5 01 8 77 and 16 28 25 05 the peak values of the il displacement are approximately twice as high as those of the isolated cylinder in this situation the dominant il modes and frequencies of the small cylinder are the same as those in the cf direction and the x y trajectory exhibits an elliptical shape 2 in case ii the small cylinder is located upstream of the large cylinder at α 15 and 30 the cf displacements of the large cylinder remain low v r 12 54 20 04 while the cf displacements of the small cylinder increase with the reduced velocity v r 3 76 12 52 at larger values of α the cf responses of the large and small cylinders are similar to that of the corresponding isolated cylinder harmonic components are observed in the il displacement of the large cylinder due to the presence of the small cylinder which leads to a larger il displacement at larger and smaller α values 15 and 75 the response of the small cylinder is controlled by the lower mode and the il displacement values are also larger 3 the fiv characteristics of the two flexible cylinders with unequal diameters are summarized by comparing them to the fiv responses of the identical flexible cylinders in tandem and side by side arrangements in the side by side arrangement the vibration of flexible cylinders is affected by proximity interference resulting in increased cf and il displacement in the tandem arrangement the downstream cylinder responds differently under the wake shield effect and wake interference for two flexible cylinders with unequal diameters the fiv responses of both the large and small cylinders are different in the cf direction the vibration of the large cylinder is suppressed at low position angles when the diameter ratio decreases to 0 5 the large cylinder behaves like an isolated cylinder in contrast the behaviour of the small cylinder is more complicated because it is mainly reflected by wake interference when the small cylinder is located downstream at a position angle of α 75 the vibration caused by the wake induced flutter can dominate the behaviour of the small cylinder this experimental study focuses on the dynamic response of two staggered flexible cylinders with unequal diameters due to the fixed spacing ratio and diameter ratio the relationship between the two factors and the fiv response still needs to be further studied nevertheless the conclusions are of great significance for the design of engineering structures involving long flexible cylinders in future work more scenarios with different spacing and diameter ratios should be studied in addition more information would be provided by studying the flow fields around the cylinders credit authorship contribution statement wanhai xu investigation qiannan zhang methodology jiang lai writing original draft qicheng wang formal analysis yang yu writing original draft declaration of competing interest all authors of this manuscript have directly participated in the planning execution and or analysis of this study the contents of this manuscript have not been copyrighted or published previously the contents of this manuscript are not now under consideration for publication elsewhere there are no directly related manuscripts or abstracts published or unpublished by any authors of this manuscript acknowledgments this work is supported by national natural science foundation of china grants nos 51679167 and 51979193 
21704,the flow induced vibration fiv of multiple flexible cylinders typically involves multi mode and complex flow structure interactions the fiv characteristics of two staggered flexible cylinders with unequal diameters are experimentally studied in this paper the two flexible cylinders have aspect ratios of 350 and 181 and mass ratios of 1 90 and 1 47 and are free to oscillate in both the cross flow cf and in line il directions according to the relative positions of the two cylinders 10 different staggered arrangements are studied p d 6 where p is the centre to centre spacing and d is the small cylinder diameter α 15 30 45 60 and 75 where α is the position angle of the downstream cylinder the multi mode fiv behaviours of the two staggered flexible cylinders with unequal diameters were investigated with respect to various aspects e g strain and displacement responses dominant frequencies and dominant modes due to the presence of the small cylinder the cf vibration of the large cylinder was suppressed at α 15 and 30 when the large cylinder was upstream or downstream furthermore the cf and il response amplitudes of the small cylinder were significantly enhanced by flow interactions at various position angles when the small cylinder was located downstream the fiv behaviours were most greatly affected at small and large position angles α 15 or 75 in addition the wake induced flutter phenomenon was observed in the il fiv response when the small cylinder was downstream however this phenomenon was not observed when the large cylinder was located downstream keywords flow induced vibration fiv flexible cylinder staggered arrangement unequal diameter wake induced flutter 1 introduction as the demand for marine energy resources increases many cylindrical structures are being used in offshore engineering such as subsea pipelines risers and mooring lines in practical engineering applications of cylindrical structures subjected to fluid flows vortex shedding occurs causing vibration for more details regarding the flow induced vibration fiv of an isolated cylinder several classic review papers are available by sumner et al 2000 sarpkaya 2004 williamson 2004 gabbai 2005 and bearman 2011 in the case of two cylinders the mutual interference of their flow fields results in more complex flow patterns and structural responses to better understand the interference effects researchers have conducted a series of experimental studies of the flow around two identical cylinders zdravkovich and pridden 1977 moretti 1993 however multi cylinder systems with unequal diameters are often used for various operational functions such as drilling and production the fiv responses of identical cylinders are actually a special case and are of practical use in contrast this paper will systematically discuss the fiv response of two staggered cylinders with unequal diameters in different arrangements numerous studies have been performed on the fiv mechanisms of two identical cylinders it is more common for cylinders to be arranged in a staggered arrangement than in side by side and tandem arrangements kim et al 2009 kim and alam 2015 xu et al 2019 here several points are proposed for the fiv response characteristics of two staggered rigid cylinders the gap flow switch mechanism and wake galloping mechanism play important roles in the vibration patterns of two cylinders griffith et al 2017 changing the cross flow cf and in line il spacing ratio of the cylinders in various arrangements can result in changes in the influence of the two cylinders on each other in some studies the fiv responses of the upstream cylinder were similar to those of an isolated cylinder however at smaller spacing ratios the vibration response of the upstream cylinder may be affected by the feedback effect of the downstream cylinder vibration specifically the upstream cylinder may experience large amplitude vibrations prasanth and mittal 2009 huang and herfjord 2013 williamson and govardhan 2004 furthermore the vibration amplitude of the downstream cylinder was larger than that of an isolated cylinder in most studies when the spacing ratio was in the interference region the downstream cylinder was affected by the upstream cylindrical wake when the il displacements of the downstream cylinder were large wake induced flutter was observed under these conditions the ratio of the cf natural frequency to the il natural frequency was 1 0 assi et al 2010 and the lift and drag of the downstream cylinders also had the same dominant frequency prasanth and mittal 2009 moreover the trajectory of the downstream cylinder was elliptical flexible cylindrical structures are widely used in the engineering field since flexible cylinders can excite higher vibration modes and multi mode vibrations the fiv of two flexible identical cylinders is more complicated than that of two rigid cylinders for two side by side flexible cylinders the vibration of the two cylinders was synchronized when the cf spacing ratio was less than 3 5 huera huarte and gharib 2011 sanaati and kato 2014 based on experiments xu et al 2018a observed that two cylinders still strongly interact with each other in the il direction when the cf spacing ratio is 8 0 this mutual interference influenced the cf displacement and increased the il displacement for two tandem flexible cylinders the vibration response of the upstream cylinder was not sensitive to the varied il spacing ratios in contrast the downstream cylinder was affected by the wake of the upstream cylinder and its response was dominated by low frequencies and modes the wake induced vibration wiv of a flexible cylinder might not appear due to multi mode vibrations bearman 2011 huera huarte and gharib 2011 xu et al 2018b xu et al 2020 for two staggered flexible cylinders when the position angle α 20 the cylinder downstream of an identical stationary cylinder behaves like an isolated cylinder because it is outside the wake of the upstream cylinder brika and laneville 1999 experimentally evaluated the hydrodynamic motions of two flexible circular cylinders with tandem and staggered arrangements the separations ranged from 7 to 25 d and reynolds number ranged from 5000 to 27 000 it was also observed that as the spacing increases the maximum vibration amplitude decreased slightly and the velocity at which this maximum occurs also decreased for the staggered arrangement the increase in the position angle reduced the synchronization area when the angle exceeded 20 the downstream cylinder behaved like an isolated cylinder for two cylinders with unequal diameters that are free to vibrate the mutual interaction between the cylinders is more complicated than that of two identical cylinders zdravkovich 1987 introduced the classification of three interference regions around two stationary identical cylinders including proximity interference wake interference and a combination of the two whether the diameters of two cylinders are equal or unequal the mutual interaction in side by side arrangements is proximity interference three different flow regimes coupled vortex streets biased gap flow and single vortex flow have been observed depending on the cf spacing ratio sumner 2010 as the cf spacing ratio decreases the strouhal number st of the large cylinder increases while the st of the small cylinder decreases after coupled vortex streets occur the st of the small cylinder jumps to a value that is lower than the st of the large cylinder song et al 2015 moreover when the upstream cylinder is larger the types of interference for two different cylinders in tandem include wake interference and proximity interference the flow regime can also be divided into three regimes the co shedding regime reattachment regime and extended body regime alam and zhou 2008 zhao et al 2005 for two cylinders with unequal diameters in a staggered arrangement the downstream cylinder is located in the wake interference and proximity interference regimes vortex shedding has been found to be sensitive to both the position angle and the spacing ratio between two cylinders dalton et al 2001 the classification of unequal diameter cylinders is similar to that of tandem cylinders zhao et al 2007 or staggered identical cylinders sumner 2010 assi 2009 the fiv response of two cylinders with unequal diameters was quite different from that of two identical cylinders rahmanian et al 2014a 2014b pearcey et al 2017 the vibration amplitudes of two identical cylinders in tandem decrease with increases in the il spacing ratio even with a constant cf spacing ratio assi et al 2010 moreover the vibration response of a cylinder is affected by both the spacing ratio and the diameter ratio qin et al 2017 studied the cf fiv in an elastically mounted large cylinder in the wake of a smaller stationary cylinder the diameter ratio and the spacing ratio p d where p is the centre to centre spacing of a bundle of two cylinders and d is the smaller cylinder diameter were varied from 0 2 to 1 0 and from 2 0 to 6 5 respectively as the il spacing ratio increased violent vibrations in the downstream large cylinder occurred at smaller diameter ratios the upstream small cylinder wake was narrow and the shear layer tended to switch direction from one side to the other huang and andy 2011 also mentioned that the cf vibration of the downstream cylinder was affected by the wake of the upstream cylinder in addition to self vortex shedding moreover lam and to 2003 investigated the vibration characteristics of a downstream rigid cylinder with a diameter half that of an upstream cylinder the cf and il spacing ratios were varied from 0 to 2 82 and from 0 to 4 68 respectively those authors observed that the fiv in the flexible cylinder was greatly suppressed in the side by side arrangement and in the tandem or near tandem arrangement when the amplitude ratio becomes larger there is a tendency for the locking range to narrow yokoi and hirao 2009 carried out model tests on two side by side cylinders with d d 0 5 and p d 3 5 6 5 both increases in the vibration frequency of the cylinder and changes in the flow pattern occurred in response to changes in p d similar to the behaviour of two identical cylinders the large and small cylinders had different lock in ranges that were wider than those of an isolated cylinder lam and to 2003 observed that the response curves of staggered cylinders were also greatly modified by the broadening of the lock in resonance range huang and andy 2013 also studied two rigid cylinders of different diameters in staggered arrangements when a larger cylinder is placed upstream the drag coefficient of the small cylinder downstream is dependent upon the spacing ratio and the diameter ratio the higher the ratio is the larger the drag coefficient the mean lift exhibited an opposite trend all of the downstream cylindrical response coefficients are similar to the responses of the two equal diameter cylinders described above as mentioned above little work has been done on the fiv responses of two flexible cylinders with unequal diameters traditional studies have focused on the flow structures of two stationary cylinders or the fiv of rigid cylinders through the study of two identical cylinders xu et al 2018a 2019b it has been recognized that the multi mode and high amplitude responses of a flexible cylinder can effectively reflect the fiv characteristics this conclusion was also the basis for studying fatigue damage and structural damage therefore it is necessary to conduct experimental studies on flexible cylinders with unequal diameters to identify interesting fiv phenomena the remainder of this paper is organized as follows sections 2 and 3 detail the description of the experimental setup and the methods used for processing the test data the experimental results presented include the dominant mode the dimensionless displacement amplitude and the dominant frequency which are discussed in sections 4 and 5 wake induced flutter is presented in section 6 section 7 draws some conclusions based on the present analysis of the experimental results 2 model experimental setup the position of the small cylinder relative to the large cylinder is defined by the spacing ratio p d and the position angle α as shown in fig 1 the cf direction is perpendicular to the oncoming flow while the il direction is parallel to the flow direction thus in a schematic diagram of a bundle of two cylinders the diameter of the large cylinder is d and the diameter of the smaller cylinder is d the centre to centre spacing of a bundle of two cylinders is p and the chosen spacing ratio is p d 6 0 in previous experimental studies on the fiv of two equal diameter flexible cylinders in a side by side arrangement when the spacing ratio is smaller than 6 0 apparent proximity interference exists in the cf direction assi and gustavo 2014 huera huarte and gharib 2011 xu et al 2018a for two tandem cylinders at p d 6 the mean root mean square rms cf to il displacement amplitude ratio was the largest and the downstream cylinder was in the interference region xu et al 2018b however since flexible cylinders have a greater displacement response than fixed cylinders the corresponding flow areas of flexible cylinders are different than those of fixed cylinders therefore in the test the oscillations of two unequal flexible cylinders are expected to show mutual interference at p d 6 0 the position angle α is the angle between the flow direction and the line connecting the centres of the two cylinders when α 0 and 90 the cylinders are in tandem and side by side arrangements respectively to clearly describe the staggered spatial positions five angles at equal intervals α 15 30 45 60 and 75 are defined between α 0 and α 90 moreover the experiment is divided into two cases in fig 1 in case i the small cylinder is located downstream of the large cylinder in case ii the large cylinder is located upstream of the small cylinder consequently 10 different staggered arrangements are established in a series of experiments labelled case i a e and case ii a e the area was divided into four colours to delineate the four types of flow regions classified by zdravkovich 1987 the interference of two rigid cylinders was divided into three groups according to the centre to centre distance and the direction of the approaching flow proximity interference occurs if the cylinder is not submerged in the wake of the other wake interference occurs when the downstream cylinder is partially or fully submerged in the wake of the upstream cylinder the no interference regime occurs when there is negligibly weak interference between the two cylinders in offshore engineering applications pipes with different functions are generally designed to have different sizes and the diameter ratio of risers with different diameters can typically vary from 1 to 4 in our two case experiment the two cylinders are denoted the small cylinder and the large cylinder the diameter of the small cylinder is d 0 016 m and the diameter of the large cylinder is d 0 031 m hence the diameter ratio is 0 5 song et al 2007 found that the interaction between two tandem cylinders is very strong when d d is approximately 0 75 in addition using two cylinders with diameters of d 0 031 m and d 0 016 m lam and to 2003 studied the fiv response of a flexible cylinder located near a large cylinder zhao et al 2007 also conducted research on two unequal diameter cylinders with a diameter ratio of 0 5 to ensure comparability with the previously observed experimental phenomena the diameter ratio selected in this experiment was 0 5 each cylinder model was 5 60 m long and consisted of an outer silicone tube and an inner copper tube as shown in fig 2 the copper pipe had an outer diameter of 0 008 m while the diameters of the silicone tube were 0 016 m and 0 031 m the copper pipe and the silicone tube were closely attached to each other and their movements were exactly the same the two cylinders were free to vibrate in both the cf and il directions and had some identical parameters as presented in table 1 seven measurement points were evenly distributed in the axial direction of the cylinder and were labelled g1 g7 four strain gauges were divided into two groups connected to the outer surface of the copper pipe to monitor the bending strains in the cf direction and the il direction during each working condition sampling was performed after the carriage reached a stable towing velocity and the sampling frequency was 100 hz the sampling duration of each test run was 50 s the data were collected after the transport reached a stable velocity the waiting time between two consecutive runs was 15 min to calm the disturbed water and more than 70 runs were performed for all experimental cases the laboratory experiments were carried out in a water towing tank at the state key laboratory of hydraulic engineering simulation and safety tianjin university china this tank was 137 0 m long 7 0 m wide and 3 3 m deep and was equipped with a carriage the experimental device was mounted on the carriage and moved along the two smooth tracks at the top of the water tank to simulate a uniform flow the towing velocity in our experiments started at 0 05 m s and increased at a rate of 0 05 m s to 1 0 m s for all tests the initial axial pretension of the cylinder was equal to 450 n fig 3 shows that the experimental setup consists of a total of 13 components the main components were the supporting structure vertical supporting rods supporting plates and guide plates cylinder models and axial tension system the guide plate was mounted on the supporting plate by a number of long bolts to avoid interference flow generated by the supporting plates and the supporting rods ensuring that the incoming flow was two dimensional two flexible cylinders with different diameters were mounted on two guide dials that were fixed to the supporting plate dial the supporting plate dial as illustrated in fig 3 was used to change the position angle of the cylinders five position angles in both cases were tested α 15 30 45 60 and 75 a universal joint was used to connect the end of each flexible cylindrical model to the support dial cylinder model providing boundary conditions the steel wires and the load cells were connected to the other end of two cylinders through the pulleys and continuously connected to the spring a tensioner was applied to adjust the axial tension of the flexible cylinders and springs were used to ensure a gradual change in the axial tension 3 data analysis methodology to obtain the displacement response of the two flexible cylinders in the cf and il directions a modal analysis method was used to reconstruct the displacement information of the cylinder from the filtered strain signal it is assumed that the vibration displacements of the cylindrical structures at any time can be expressed as a linear superposition of a series of natural modes according to the strain information of different discrete points such as measurement points g1 g7 in this paper the displacement information of any location along the cylindrical structure can be obtained here only the cf displacement reconstruction is described as an example 1 y z t n 1 w n t ϕ n z z 0 l where y z t is the cf displacement z is the coordinate along the axis of the cylinder t is time l is the cylinder length ϕ n z is the mode shape w n t is the modal weight and n is the order of the vibration mode in our tests the cylinder with a pretension of 450 n can be simplified as a bernoulli euler beam with the pinned pinned boundary condition thus the mode shape of displacement can be written as 2 ϕ n z sin π n z l z 0 l furthermore the pinned pinned boundary conditions of the cylinders were utilized in the experiments the displacement response was reconstructed based on the relationship between the curvature and strain 3 ε z m t r n 1 π n l sin π n z l w n t where ε z m t is the strain signal at location z m and r is the outer radius of the copper pipe where z m denotes the strain gauges g1 g7 placed along the axis m 1 7 the modal weight w n t can be calculated according to eq 3 the lowest mode that is excited when the riser vibrates is n 1 and the highest mode that participates in vibration is n 2 so the vibration displacement of the riser should be approximated only by the n n 2 n 1 1 modal functions involved in the vibration in this paper seven strain gauges were attached in the experiment and the highest can be excited to the 7th mode therefore n 1 1 and n 2 7 then the formula can be expanded into a system of equations corresponding to a certain time t as follows 4 a m n π l 2 n 1 2 sin n 1 π z 1 l n 1 1 2 sin n 1 1 π z 1 l n 2 2 sin n 2 π z 1 l n 1 2 sin n 1 π z 2 l n 1 1 2 sin n 1 1 π z 2 l n 2 2 sin n 2 π z 2 l n 1 2 sin n 1 π z m l n 1 1 2 sin n 1 1 π z m l n 2 2 sin n 2 π z m l 5 w n 1 w n 1 t w n 1 1 t w n 2 t t 6 b m 1 ε z 1 t r ε z 2 t r ε z m t r t where a m n b n 1 and w m 1 are matrices the formula is written as follows 7 a w b this method is a modal decomposition method using filtered strain data as an input signal the value of the modal weight function w n t can be calculated by eq 1 and then the spatial displacement information can be solved more details of the modal analysis method are presented in lie and kaasen 2006 taking the fiv response of the small cylinder as an example the modal analysis method is explained as shown in fig 4 the small cylinder has a position angle α 45 and the towing velocity is u 0 45 m s in case i where u is the towing velocity of the carriage based on the modal weight distribution results eq 1 is used to reconstruct the displacement response the first column shows the time histories of the cf strain at the seven measurement points the second column shows the seven modal weights in the cf direction and the third column shows time varying dimensionless displacements at the seven measurement points along the cylinder axis the modes from the 4th to 7th are not excited and the 2nd mode dominates the vibration the maximum displacement amplitude is obtained at g6 with a peak value of nearly 3 0d furthermore a weaker vibration is observed in the middle of the cylinder at g4 which also indicates that the cf response is dominated by the 2nd mode in this example 4 cf fiv responses in this section the cf fiv characteristics of two cylinders with different diameters are studied by discussing the maximum rms values of the dimensionless amplitude the dominant frequencies and the dominant vibration modes in the cf direction herein the reduced velocity is defined by the flow velocity and the diameter and fundamental frequency of the cylinder because the diameters of the two cylinders in this paper are not equal the reduced velocity v r is defined for the small cylinder for convenience unless otherwise stated notably the reduced velocities are defined as v r u df s 1 where f s 1 is the fundamental frequency 1st mode frequency of the small cylinder in still water calculated from 8 f s 1 t a m 1 π l 2 e i m 1 1 2 2 l where m 1 represents the mass which is the sum of the structural mass m s1 and the added mass m a1 ρπd 2 4 ρ is the fluid density and ei and t a are the bending stiffness and axial tension of the cylinder model respectively the dominant cf modes of the small and large cylinders are illustrated in fig 5 and the counterparts of the isolated cylinder are provided for comparison fiv cannot be excited and random errors will occur in the measurement results at lower flow velocities hence the data collection began at a towing velocity of 0 15 m s which corresponds to v r 3 76 it should be noted that the dominant mode is the mode with the highest modal weight in eq 1 the dominant cf modes of the two cylinders increase from the lower mode to the higher mode with increasing v r see fig 5 comparing the large and small cylinders with an isolated cylinder the cylinders are less affected when they are the upstream cylinder nevertheless the modes are influenced at some reduced velocities when the cylinder is the downstream cylinder on the one hand when the small cylinder is the downstream cylinder as in case i e α 75 the mode is reduced from 4 to 3 and then rises to 4 with increasing v r from 22 54 to 25 05 the large cylinder also exhibits a similar phenomenon as in case i c α 45 the mode is reduced from 3 to 2 and then rises to 3 with increasing v r from 17 53 to 21 29 this phenomenon occurs because there may be more than one modal contribution at a certain reduced velocity resulting in competition between two adjacent modes because this modal competition is sensitive to wake interference this effect is more pronounced for cylinders that are downstream however for the small downstream cylinder in case i a α 15 the dominant mode only excited the 3rd mode owing to the wake shielding effect this phenomenon was also found in the downstream cylinders of models involving two tandem flexible cylinders xu et al 2018b hence when the cf spacing ratio is small α 15 the downstream cylinder may be affected by wake shielding figs 6 and 7 show the dimensionless dominant frequency of two cylinders f cf f s 1 and f cf f l 1 corresponding to the reduced velocity v r in the cf direction the fundamental frequency f s 1 of the small cylinder is mentioned above and is based on eq 9 the fundamental frequency f l 1 of the large cylinder can be calculated from 9 f l 1 t a m 2 π l 2 e i m 2 1 2 2 l where m 2 represents the mass which is the sum of the structural mass m s2 and the added mass m a2 ρπd 2 4 the fast fourier transform fft method is used to calculate the dominant frequency based on the time varying displacement st is referred to as the dimensionless vortex shedding frequency as shown in figs 6 and 7 dominant the cf frequencies of the large and small cylinders match the dominant cf modes which increase as v r increases at some reduced velocities the dominant cf frequencies of the two staggered cylinders are larger than those of an isolated cylinder which corresponds to the phenomenon in which two unequal diameter cylinders enter the higher order vibration mode earlier the dominant frequency has an obvious relationship with the position angle α as the position angle α increases the dominant frequency becomes increasingly similar to that of an isolated cylinder for example the dominant cf dimensionless frequencies of the small cylinder are most similar to those of an isolated cylinder at α 75 whether the cylinder is upstream or downstream compared with that of an isolated cylinder the oscillation frequencies of both large and small cylinders are lower when the cylinders are downstream and α 15 due to the mutual influence of the two cylinders the vortex shedding frequency is slightly suppressed this observation shows that the cf spacing is the main factor affecting st zhao et al 2007 found an interaction mode in which there were strong interactions between the vortex shedding of a large cylinder and the shedding of a small cylinder when the small cylinder was located in the rear upper side of the large cylinder the shedding behind the cylinder was influenced by the shear layers behind the gap zhao et al 2005 for two tandem flexible cylinders the st of the downstream cylinder was lower the cf spacing of the two cylinders changes due to vibration xu et al 2018b when the cf spacing of two side by side flexible cylinders is less than 6d both cylinders exhibited low dominant frequencies xu et al 2018a this finding indicates that the vortex shedding frequencies of the cylinders in the proximity interference zone are affected this phenomenon also explains why the dominant frequencies of the upstream cylinder are slightly reduced as shown in fig 8 to study the vortex shedding frequency of two flexible cylinders with unequal diameters the st is calculated based on the frequency data in figs 6 and 7 the calculation formula can be written as 10 s t f s d u s t f s d u where it is assumed that the vortex shedding frequency is the dominant frequency in the fiv response some researchers have also adopted similar methods gao et al 2015 xu et al 2018b to intuitively reflect the st with varied α a horizontal line representing the st corresponding to the isolated cylinder is given in fig 8 the st values calculated for the large cylinder and the small cylinder according to the dominant cf frequencies are approximately the same as those of a corresponding isolated cylinder the st is not sensitive to changes in the position angle the corresponding dominant frequencies are similarly characterized fig 9 illustrates the maximum cf rms dimensionless displacements of the small cylinders versus the reduced velocity in the two cases the rms displacements can reflect the magnitude of the response of a cylinder and can be calculated as follows 11 y m a x r m s m a x 1 i n y r m s z i x m a x r m s m a x 1 i n x r m s z i the dimensionless amplitudes of the small cylinder at different position angles α are generally similar to those of an isolated cylinder all y max rms d values of the small cylinders are in the range of 0 0 2 0 the displacement amplitude varies with the reduced velocity within a mode and decreases as the dominant mode changes however the behaviours of y max rms d differ between case i and case ii that is whether the small cylinder is the downstream or upstream cylinder for example the maximum cf amplitude is approximately 1 74 in case ii and 1 49 in case i at α 75 in fig 9 a the y max rms d of the small cylinder is significantly lower than that of an isolated cylinder at α 15 and 75 in cases i a and e since the diameter ratio d d 0 5 the wake interference of the upstream cylinder is larger than that of an equal diameter cylinder due to the difference in diameter wake interference only appears when the cf or il spacing is large because both the diameter and vibration displacement of the upstream large cylinder affect the formation of the gap flow therefore gap flow is only found between the two staggered cylinders at a larger or smaller position angle and the gap flow under these conditions is more intense than the gap flow at other angles after careful observation the small cylinder is insensitive to changes in the position angle when it is located upstream in case ii the decrease in several cf amplitudes is due to vortex shedding generated by the small cylinder being disturbed by the large cylinder except at α 15 at which the behaviour is similar to that of the upstream cylinder in a model involving two tandem flexible cylinders when the il spacing is 4d the y max rms d of the small cylinder is slightly lower than that of an isolated cylinder xu et al 2018b in addition some y max rms d values of the upstream cylinders are higher than that of an isolated cylinder at each angle based on experiments prasanth and mittal et al 2009 found that an upstream rigid cylinder also has a larger cf displacement than an isolated cylinder qin et al 2017 found that violent cylinder vibration is primarily associated with the lift force induced by the shifting of gap shear layers from one side of the downstream cylinder to the other many researchers have extensively discussed the wiv phenomenon of downstream cylinders in tandem arrangements that oscillate freely in the cf direction when the reduced velocity ranges from 3 76 to 12 52 the displacement responses of the small cylinder at some position angles are significantly different from the displacement responses of an isolated cylinder as shown in fig 9 as shown in fig 10 for small cylinders at α 15 and 30 in case ii y max rms d consistently increases with an increase in v r before the reduced velocity reaches 12 52 the first difference from the observations of previous studies is that the maximum y max rms d is not significantly larger than that of an isolated cylinder in our experiments at position angle α 30 this type of escalation results in a peak y max rms d of approximately 1 73 and the corresponding value of the isolated single cylinder is 1 19 in addition these effects show that when v r exceeds 12 52 for both position angles α 15 and 30 the cf amplitude of the small cylinder stops increasing and returns to a level corresponding to the amplitude of the isolated cylinder in fig 9 the second difference is that a previous study observed the wiv phenomenon in downstream cylinders in our experiments the small cylinder also exhibits the wiv phenomenon as the upstream cylinder these differences may be affected by the reynolds number and the relative positional change between the two cylinders huang and herfjord 2013 studied fixed and elastically supported rigid cylinders of dissimilar diameters for the upstream large cylinder the vortex induced vibration viv was similar to the classical lock in response unless the spacing was less than 2d in summary the effect of a large cylinder on a small cylinder located upstream does not inhibit its vibration or even increase the displacement value however for the large cylinder the performance of the cf dimensionless displacement is quite different from that of the small cylinder as shown in fig 11 the difference between the isolated cylinder and the large cylinder is remarkable as presented in fig 11 a and b the cf dimensionless displacement amplitude of the large cylinder can reach approximately 3 45 in case i e α 75 in the v r range from 6 26 to 20 04 the y max rms d of the large cylinder is relatively low with a value of approximately 1 50 and there is no upward trend which is obviously different from the behaviour of the isolated cylinder for two staggered identical rigid cylinders there was also a phenomenon in which the downstream cylinder affected the upstream cylinder prasanth and mittal 2009 huang and herfjord 2013 it can be seen from the y max rms d values of the large cylinder that the large cylinder is greatly affected by the different position angles in fig 11 at lower angles of incidence such as α 15 and α 30 the small cylinder suppresses the vibrations of the large cylinder this response is contrary to the cf displacement response of the downstream elastic cylinders in a previous study bao et al 2011 those authors studied the flow interference of two staggered identical cylinders with a spacing ratio of 4 the cf vibration of the large cylinder is suppressed at small position angles α 15 30 and the cf dimensionless displacement coincides with that of the isolated cylinder at large position angles the response of the large cylinder when it was the upstream cylinder was discussed by alam and zhou 2008 the presence of the downstream cylinder acts to slow down the flow around the upstream cylinder such that the frequency of the vortex shedding of the upstream cylinders decreases when the large cylinder is the downstream cylinder the mechanism is the same as that of two cylinders with the same diameter and is related to the wake interference of the upstream small cylinder the fiv response of a flexible cylinder can be analysed by the behaviour of standing waves and travelling waves due to the combination of travelling waves and standing waves an asymmetry in the displacement distribution is created fig 12 shows the dimensionless displacement contours of the spatiotemporal variation in the cf direction at some representative reduced velocities namely u 0 40 m s 0 55 m s 0 80 m s and 0 95 m s corresponding to v r 10 02 13 78 20 04 and 23 80 respectively the 2nd mode is dominant in the cf direction for the small and large cylinders at v r 10 02 and for the isolated cylinder increasing v r to 23 08 the higher modes of vibration are gradually excited in the cf direction the small cylinder excites the 4th mode and the large cylinder excites the 3rd mode which is consistent with the dominant mode of fig 5 a comparison of fig 12 a and b shows that the large cylinder is in good agreement with the corresponding isolated cylinder this result is similar to the phenomenon observed in a previous study xu et al 2018a the asymmetry of the spanwise evolution of the two cylinders could be due to the increasing gap flow between the two cylinders as v r increases the combination of travelling waves and standing waves makes the asymmetric distribution of the small cylinder more obvious which can be attributed to the combination of adjacent vibration modes the fiv responses of flexible cylinders have been shown to be complicated due to variation in the response along the axis 5 il fiv responses in the same manner as in the previous section the il fiv responses of the two cylinders are discussed in this section the dominant il modes of the small and large cylinders are illustrated in fig 13 and an isolated cylinder is provided for comparison the dominant il mode of two unequal cylinders is more complex than the dominant cf mode higher order modes are excited which makes the response of the flexible cylinder in the il direction more complex than that in the cf direction the dominant modes of the small cylinder in the il direction no longer appear to have a consistently positive relationship with reduced velocity instead a jump is observed when the small cylinder is located downstream of the large cylinder the dominant il mode jumps from the 2nd to the 4th mode at position angles α 45 and 75 as v r increases from 7 52 to 8 77 the higher modes are excited earlier for two cylinders in a staggered position than for an isolated cylinder in case ii the dominant il modes of the downstream small cylinder are obviously different from those of the isolated cylinder the dominant il mode jumps occur at low reduced velocities v r 7 52 and 8 77 and high reduced velocities v r 23 80 and 25 05 at several position angles α 15 and 75 the small cylinder has a lower dominant il mode than the isolated cylinder at the same rate of decrease at low reduced velocities the il vibration of the large cylinder is controlled by the 1st mode at high reduced velocities the dominant il mode is only excited to the 4th mode the isolated cylinder is excited to the 6th mode there are two reasons for this phenomenon when the small cylinder is at a position angle α 15 it is located in the wake of the large cylinder and is affected by the upstream shielding effect this situation is similar to that of the downstream cylinder in a system with two identical cylinders in tandem xu et al 2018b when the small cylinder is at a position angle of α 75 it is located in the proximity interference regime compared to the case of α 15 this position is associated with a wake shield effect the relationship between the lower dominant il mode of the small cylinder and the wake shield effect is not strong and should be related to the wake induced flutter however the dominant il modes of the large cylinder are similar to the dominant il modes of the isolated cylinder with modes in the range from the 2nd mode to the 4th mode the data in the il direction also have a monotonously increasing relationship with a reduction in the velocity hence the behaviour of the large cylinder is significantly different from that of the small cylinder the dominant modes of the large cylinder in the cf and il directions are similar to those in the isolated state in addition regardless of whether the large cylinder is located upstream or downstream or at different position angles it is only slightly affected by the presence of the small cylinder this is clearly different from the behaviour of two staggered cylinders with equal diameters the large cylinder is considered the main cylinder and the small cylinder is regarded as the subsidiary cylinder when the diameter ratio d d is reduced to 0 5 the effect of the subsidiary cylinder on the main cylinder is negligible figs 14 and 15 illustrate the dominant dimensionless frequencies of the small and large cylinders respectively some jump points are observed in both figures which correspond to mode jumps in the dominant il mode when the small cylinder is upstream the dominant il frequency generally increases linearly and is close to the dominant il frequency of the isolated cylinder however when the small cylinder is downstream of the large cylinder there are more jump points indicating that mode jumping is frequent in addition in case i e α 75 the il frequencies of the small cylinder are lower than the il frequencies of the isolated cylinder and approximate its cf frequencies hence the decrease in the dominant il modes of cylinder 2 indicates the appearance of wake induced flutter in addition to several jump points the dominant il dimensionless frequencies of the large cylinder basically increase as the reduced velocity increases see fig 14 moreover regardless of the position of the large cylinder the dominant il frequency of the large cylinder is substantially the same as the dominant il frequency of the isolated cylinder from the combination of figs 7 and 15 the dominant frequencies of the large cylinder in both the il and cf directions are insensitive to the presence of a small cylinder the st in fig 16 is calculated based on the frequency data in figs 14 and 15 it can be seen from the st values of the small cylinder in case ii and the large cylinder in case i that the vortex shedding frequency of the upstream cylinder is similar to that of the isolated cylinder except for the downstream small cylinder in case i the st in the il direction is approximately twice that in the cf direction for the downstream small cylinder in case i as the position angle increases from 15 to 75 the st varies from 0 281 to 0 172 when the position angle is α 75 the st values of 0 172 in the il direction and 0 160 in the cf direction are similar fig 17 illustrates the maximum il rms dimensionless displacements of the large and small cylinders versus the reduced velocity in cases i and ii the procedure for calculating the maximum il rms displacement x max rms is the same as that of y max rms the displacement response in the il direction varies significantly at different position angles at a position angle α 15 the small cylinder x max rms d exhibits a similar trend to the isolated cylinder x max rms d except for some larger values at reduced velocities as the position angle increases α 30 and 45 at high reduced velocities v r 18 79 25 05 the difference between the displacement response behaviours of the small cylinders and the isolated cylinder becomes larger regardless of case i or case ii it is observed that the x max rms d of the small cylinder is larger than that of the isolated cylinder when the position angle is increased to 60 the small cylinder exhibits similar behaviour to the isolated cylinder again the cf and il spacing changes as the position angle changes as mentioned x max rms d is sensitive to changes in cf and il spacing when the position angle reaches 75 the x max rms d of the small cylinder in case i differs from that of the isolated cylinder the il displacement of the small cylinder increases continuously after the il displacement of the isolated cylinder reaches a local peak the x max rms d of the small cylinder can increase to values 2 3 times higher than the corresponding value of the isolated cylinder the increase in il displacement is one characteristic of wake induced flutter prasanth and mittal 2009 fig 18 shows that the il maximum rms amplitude of the large cylinder is more similar to that of the isolated cylinder than that of the small cylinder the x max rms d of the large cylinder is lower than the corresponding value of the isolated cylinder at higher reduced velocities see α 30 45 60 and 75 nevertheless for case ii and α 15 the large cylinder has several x max rms d values that are larger than those of the isolated cylinder generally the x max rms d values in case ii are more consistent than the x max rms d values in case i but the general trend is similar the presence of the small cylinder can be considered to have little effect on the large cylinder in the il direction this is consistent with our view summarized from the dominant mode and dominant frequency see figs 13 and 15 the fluctuation of the large cylinder at α 45 will be larger than that at α 45 because the large cylinder is in the proximity and wake interference zones however the small cylinder has a more pronounced effect on the suppression of vibration in the large cylinder in the cf direction especially at α 45 see fig 11 in addition a wavelet transform was applied to the vibration signals of the rising displacement points as shown in fig 19 the il vibration of the large cylinder located downstream at v r 16 28 17 53 and α 75 indicates a typical multi frequency resonance the dominant frequency f il is approximately 3 5 hz and a harmonic component of 1 5 times the dominant frequency is observed in the spectrum i e f il 5 2 hz additionally harmonic components 0 5 and 2 times the dominant response frequency are also observed these results could be explained by the flow characteristics of the side by side arrangement in a staggered configuration when the cylindrical gap is narrowed mutual interference occurs and a deflected flow is formed yokoi and hirao 2009 song et al 2015 therefore the vibration of the small cylinder can be affected fig 20 clearly shows that different displacement responses are exhibited at the seven points in the il direction of the large and small cylinders the chosen example exhibits wake induced flutter case i and α 75 the spatial distribution of the il rms displacement along the length of the large cylinder is close to that of the isolated cylinder at different v r values the il response of the large cylinder at reduced velocities v r 10 02 13 78 is the 3rd mode and standing waves are observed additionally travelling waves are observed in the il displacement of the small cylinder for the small cylinder at v r 13 78 the combined standing wave and travelling wave are dominant as v r increases to higher reduced velocities v r 20 04 23 08 the small cylinder is still dominated by the 3rd mode and the large cylinder is dominated by the 4th mode however the il displacement distribution curve of the isolated cylinder has five peaks representing the 5th vibration mode at the same reduced velocity both standing waves and travelling waves are observed moreover the amplitude of the small cylinder is significantly larger than that of the isolated cylinder for example the peak amplitude of the small cylinder approximately 0 8 is nearly double that of the isolated cylinder approximately 0 4 at v r 20 04 the il displacement is enlarged and dominated by the travelling wave when wake induced flutter occurs 6 wake induced flutter phenomenon fig 14 shows that the dominant il frequency of the small cylinder was always low in case i e α 75 as shown in fig 21 when the small cylinder is the downstream cylinder the same dimensionless dominant frequency is observed in the cf and il directions when v r 5 01 8 77 and 16 28 25 05 this phenomenon is related to the occurrence of wake induced flutter when the cylinders are in a staggered arrangement thus in this section we discuss the wake induced flutter observed in our experiments the wake induced flutter acts on the downstream cylinder resulting in a large il displacement and an elliptical motion trajectory naudascher and rockwel 1994 assi 2009 this wake induced flutter is a coupled mode flutter in which two prominent frequency components are observed in the il direction the higher frequency component is related to the vortex shedding of the cylinder the lower frequency component is similar to the dominant cf frequency which is a typical feature of wake induced flutter a similar phenomenon was observed in our previous experimental study of two tandem and staggered flexible cylinders xu et al 2018b xu et al 2020 like all coupled mode flutter phenomena the wake induced flutter phenomena occur only within a limited range of x y frequency coalescence i e only when the horizontal and vertical frequencies differ slightly obviously when the wake induced flutter phenomenon acts on the small cylinder in case i e α 75 at v r 25 05 in fig 22 the corresponding trajectories of the measurement points g1 g7 have an elliptical orbit in addition the trajectory is not axisymmetric due to the asymmetrical nature of the wake interference this trajectory indicates that the oscillation frequencies in the il and cf directions have the same value the wake induced flutter can be excited in an unstable flow and can be maintained by a stable fluid force in the wake naudascher and rockwel 1994 the observations above show that the wake induced flutter response of the small cylinder is affected by vortex shedding from the large cylinder the small cylinder located downstream can continuously obtain energy from the wake of the large cylinder when the cylinder follows this elliptical trajectory the corresponding displacement increases see figs 17 and 20 when the x y trajectory of the downstream cylinder is an elliptical orbit as depicted in fig 22 it will move through different gradients of steady lift and drag in addition the cylinder can only circulate in the high drag zone and the low drag zone in a coupled lateral motion mittal et al 2001 2004 explained the mechanism of the wake induced flutter of flexible cylinders from the perspective of flow energy conversion and analysed the vortex shedding mechanism that study is similar to the study of rahmanian et al 2014a b which describes the x y trajectories of a cylinder exhibiting elliptical trajectories at similar positions these authors numerically studied the two degrees of freedom viv of two mechanically coupled cylinders with a diameter ratio of 0 1 examination of the time varying il spectrum in fig 23 reveals that there are three frequency components of approximately 8 hz 15 hz and 23 hz in the selected time period 20 50 s at the seven measurement points the higher frequency components 15 hz and 23 hz are approximately twice and three times as high as the lower frequency component which is close to the dominant il frequency of the isolated cylinder in addition the lower frequencies dominate however due to the apparent low frequency component the il displacement of the downstream cylinders still increases significantly hence the remarkable low frequency il component of the downstream cylinder is one of the typical signs of wake induced flutter fig 24 shows the response trajectories of the large flexible cylinders at seven measurement points along the length with different reduced velocities in case ii for the large cylinder at the same position angle α 75 the motion trajectory is an extremely asymmetrical 8 shape at g1 g7 similar behaviours of the x y trajectories were observed in the experiment of two side by side flexible cylinders by xu et al 2018a the 8 shape in the figure is basically symmetrical because there is only one frequency component in the il displacement fig 25 presents the dominant il and cf frequency components at measurement points g2 g4 and g6 the il frequency component is approximately 8 and the cf frequency component is approximately 4 because the frequency component ratio of cf and il is 1 2 an 8 shape is observed at the measurement point when the upstream cylinder is the small cylinder it has little effect on the large cylinder downstream in this situation the large cylinder is not located in the wake field of the small cylinder and the release of vortices from the small cylinder does not affect the large cylinder both cylinders exhibit vortex shedding and anti phase synchronization similar to the behaviour of side by side cylinders sumner 2010 in contrast when the small cylinder is located in the wake of the large cylinder it is subject to interaction with the vortices shed from the upstream cylinder this interaction is asymmetrical resulting in unstable fluid forces acting on the small cylinder specifically these conditions result in large il displacement and an elliptical motion trajectory 7 conclusions the fiv response of two flexible cylinders with different diameters is studied experimentally in this paper the spacing ratio is constant p d 6 and the two cylinders are studied at different position angles α 15 30 45 60 and 75 in two cases by analysing the dominant frequencies the dominant modes and the maximum rms displacement amplitudes the interaction between the two cylinders in terms of vibration response characteristics at different spatial positions is discussed the following main conclusions from the 2 cases are described as follows 1 in case i the large cylinder is located upstream of the small cylinder for the large cylinder the il fiv responses are similar to those of an isolated cylinder the cf response of the large cylinder is affected by the small cylinder the cf vibrations of the large cylinder at α 15 and 30 v r 12 54 20 04 are lower than those of the isolated cylinder the large cylinder oscillates in the il direction with dominant frequencies and dominant modes similar to those of the isolated cylinder for the small cylinder the cf vibration is suppressed at α 15 while the il vibration is slightly larger at α 15 owing to the wake shield effects a typical wake induced flutter phenomenon is observed in the small cylinder at α 75 and v r 5 01 8 77 and 16 28 25 05 the peak values of the il displacement are approximately twice as high as those of the isolated cylinder in this situation the dominant il modes and frequencies of the small cylinder are the same as those in the cf direction and the x y trajectory exhibits an elliptical shape 2 in case ii the small cylinder is located upstream of the large cylinder at α 15 and 30 the cf displacements of the large cylinder remain low v r 12 54 20 04 while the cf displacements of the small cylinder increase with the reduced velocity v r 3 76 12 52 at larger values of α the cf responses of the large and small cylinders are similar to that of the corresponding isolated cylinder harmonic components are observed in the il displacement of the large cylinder due to the presence of the small cylinder which leads to a larger il displacement at larger and smaller α values 15 and 75 the response of the small cylinder is controlled by the lower mode and the il displacement values are also larger 3 the fiv characteristics of the two flexible cylinders with unequal diameters are summarized by comparing them to the fiv responses of the identical flexible cylinders in tandem and side by side arrangements in the side by side arrangement the vibration of flexible cylinders is affected by proximity interference resulting in increased cf and il displacement in the tandem arrangement the downstream cylinder responds differently under the wake shield effect and wake interference for two flexible cylinders with unequal diameters the fiv responses of both the large and small cylinders are different in the cf direction the vibration of the large cylinder is suppressed at low position angles when the diameter ratio decreases to 0 5 the large cylinder behaves like an isolated cylinder in contrast the behaviour of the small cylinder is more complicated because it is mainly reflected by wake interference when the small cylinder is located downstream at a position angle of α 75 the vibration caused by the wake induced flutter can dominate the behaviour of the small cylinder this experimental study focuses on the dynamic response of two staggered flexible cylinders with unequal diameters due to the fixed spacing ratio and diameter ratio the relationship between the two factors and the fiv response still needs to be further studied nevertheless the conclusions are of great significance for the design of engineering structures involving long flexible cylinders in future work more scenarios with different spacing and diameter ratios should be studied in addition more information would be provided by studying the flow fields around the cylinders credit authorship contribution statement wanhai xu investigation qiannan zhang methodology jiang lai writing original draft qicheng wang formal analysis yang yu writing original draft declaration of competing interest all authors of this manuscript have directly participated in the planning execution and or analysis of this study the contents of this manuscript have not been copyrighted or published previously the contents of this manuscript are not now under consideration for publication elsewhere there are no directly related manuscripts or abstracts published or unpublished by any authors of this manuscript acknowledgments this work is supported by national natural science foundation of china grants nos 51679167 and 51979193 
