index,text
4650,the calibration of tipping bucket rain gauges tbrs before installation is an important but very time consuming task especially at low rainfall intensities to address the time consumption this paper developed a novel method and calibration system to improve the tbr calibration efficiency two peristaltic pumps were adopted in this method one pump provided some simulated rainfall intensities and another pump provided high rainfall intensities termed accelerated rainfall intensities to quickly inject a given amount of water into the tbr bucket before tipping to verify the feasibility of the novel method this investigation performed comparison experiments with three different types of tbrs in addition various accelerated rainfall intensities and ratios of the injected water volume to the total volume of the bucket were combined to conduct experiments at three simulated rainfall intensities of less than 1 mm min 1 to obtain the optimal schemes and maximize the time saving ratio β the results of the comparison experiments demonstrated that the performances of the new and conventional methods were quite close notably the average errors differed by less than 0 32 according to the anova results all p values were greater than 0 05 and most were greater than 0 1 therefore there was no significant difference between the results of the two methods verifying the feasibility of the new method the scheme based experimental results show that β can exceed 45 and reach 89 thus the novel method can greatly reduce the required calibration time in summary the fast calibration method proposed in this work is feasible for solving the time consumption problem and can increase the availability of tbrs in hydrology meteorology and other sciences keywords tipping bucket rain gauge fast calibration rainfall intensity time saving ratio calibration system 1 introduction precipitation measurements are vital and have been widely applied in meteorology hydrology and other sciences bianchi et al 2013 grimaldi et al 2015 but the accurate measurement of precipitation is a rather complicated task colli et al 2018 liu et al 2013 ross et al 2020 manual rain gauges tipping bucket rain gauges tbrs and weighing rain gauges are the three main types of measurement equipment for precipitation wmo 2006 with the advantages of a simple structure long life cycle ability to be installed in remote areas and high degree of automation cai et al 2020 the tbr has become the main device for rainfall observation and has been widely used in automatic precipitation monitoring and experimental research worldwide giles 2010 haselow et al 2019 liu and gu 2018 upton and rahimi 2003 however tbrs are known to underestimate rainfall at high rainfall intensities due to rainwater loss during the rotation of the bucket molini et al 2005 this underestimation can be remedied by tbr calibration marsalek 1981 tbr calibration can be generally divided into static calibration and dynamic calibration humphrey et al 1997 sypka 2019 in static calibration methods a pipette is adopted to determine the volume of water required to make the bucket tip and the influence of the rainfall intensity is not taken into consideration the concept and first method of dynamic calibration were proposed by calder and kidd 1978 this approach which considers the influence of the rainfall intensity and aims to calibrate the tbr while the buckets are in motion has been proven to be effective calder and kidd 1978 humphrey et al 1997 because of the significance of tbr calibration some study groups and institutions have established laboratory calibration systems to improve the tbr measurement accuracy colli et al 2014 humphrey et al 1997 lanza et al 2006 santana et al 2015 vasvári 2005 the existing literature has shown that both tbrs iida et al 2018 lanza and vuerich 2009 niemczynowicz 1986 and tipping bucket flow meters tbfs edwards et al 1974 takanori et al 2018 need to be calibrated before installation but due to the uncertainty of the field environment these devices should be recalibrated after long term observation therefore potential issues can arise involving regular maintenance and recalibration which are needed to ensure the accuracy of measurements lanza et al 2006 shedekar et al 2016 wills 2013 the curve obtained by tbr calibration can provide high quality rainfall intensity measurements after suitable correction lanza et al 2006 in general the calculated values of error are plotted versus the simulated rainfall intensities is to define a calibration curve for a tbr colli et al 2014 although the measurement error cannot be completely eliminated calibration can minimize the measurement error and promote the correction of field data from tbrs shedekar et al 2016 according to data observed with multiple types of rain gauges rainfall intensity frequencies under 0 2 mm min 1 and 0 5 mm min 1 at the experimental site account for more than 50 and 90 of the results respectively liao et al 2020a therefore tbrs need to be calibrated at low rainfall intensities such as 0 1 or 0 2 mm min 1 to improve the accuracy of rainfall measurements tbr calibration at low rainfall intensities is necessary but time consuming humphrey et al 1997 liao et al 2020b and the tbr cannot collect data during the calibration period in addition under laboratory conditions the evaporation losses from the bucket increase nearly linearly with time rolf 1998 if the time required for calibration in the laboratory is too long errors caused by evaporation may occur humphrey et al 1997 designed an automated calibration system for tbrs but this system relies on the conventional calibration method and requires much time in previous studies most researchers used only one pump to simulate different rainfall intensities however to simulate high precision flow one proposed flow rate generation system adopted two pumps for calibration when the flow rate was below 18 ml min 1 a low intensity pump was activated and when the flow rate was greater than 18 ml min 1 a high intensity pump was activated colli et al 2013 2014 this improvement was innovative and improved the accuracy of simulating the rainfall intensity but the tbr calibration time issue remains as a prerequisite for the success of many applications calibration remains a challenging and time consuming task for devices such as sensors and instruments quoc and andrew 2009 moreover calibration is even considered a necessary evil duchowski 2017 because calibration is necessary but can be cumbersome expensive or time consuming despite the effort devoted to tbr calibration research few works have investigated a fast tbr calibration method therefore the present work proposed a novel and fast tbr calibration method and a corresponding system was constructed two high precision peristaltic pumps were adapted in this system pump 1 was used to simulate the rainfall intensity and pump 2 was used to improve the calibration efficiency the main objectives of this article are to 1 establish a novel method and system for fast tbr calibration 2 verify the feasibility of the method and system through comparison experiments and 3 select preferred schemes for fast tbr calibration 2 materials and methods 2 1 a novel method for fast tbr calibration the calibration time mainly depends on a variety of factors including the receiver area resolution number of tips and rainfall intensity selected first the time required for conventional calibration tc needs to be determined this time can be recorded by a stopwatch niemczynowicz 1986 or calculated by a formula as follows 1 t c v 0 0 1 s i where v0 is the tbr bucket volume ml s is the receiver area cm2 and i is the rainfall intensity simulated by the peristaltic pump mm min 1 when the rainfall intensity is very low the calibration is time consuming the tbr will take away a part of the rainwater during the bucket rotation process and the greater the rainfall intensity is the greater the rainwater loss therefore without influencing the bucket rotation process an additional acceleration pump can be used to supplement the water with relatively high flow rate this can be considered acceleration therefore the above formula can be revised 2 t a v 0 α 0 1 s i 1 i 2 v 0 1 α 0 1 s i 1 where ta is the calibration time obtained with the new method by subtracting the start time of the program from the end time which is recorded by a computer as described in the next section α is the ratio of the injected water volume to the total volume of the bucket and i1 and i2 are the rainfall intensities simulated by pump 1 and pump 2 respectively the adoption of pump 2 can help reduce the calibration time and the time saving ratio β can be calculated by the following formula 3 β t c t a t c 100 the idea proposed here is theoretically feasible however experimental research is still required to verify the feasibility of the method in addition the tbr error and water mass per bucket were used to quantitatively evaluate the results in general the error can be calculated by the following formula liao et al 2020b 4 e 0 1 h s ρ n m r m r 100 where e is the tbr error h is the resolution mm n is the number of tips ρ is the density of deionized water 1 g cm 3 and mr is the rainwater flow into the bucket as recorded by balance 1 another two electronic balances can record the water masses flowing out of from the left and right buckets separately the value for each bucket on the left side is recorded by balance 2 similarly the value for each bucket on the right side is recorded by balance 3 2 2 a novel system for fast tbr calibration a new tbr calibration system fig 1 was designed to perform laboratory simulations of various rainfall intensities with functions such as water supply weighing measurement and automatic counting compared to conventional calibration systems liao et al 2020b shedekar et al 2016 this new system offers significant improvements especially for peristaltic pumps various rainfall intensities were simulated with two high precision peristaltic pumps two pumps with different flow rate ranges can be adapted to accurately control is pump 1 lls plus kamoer china flow rate within 1 150 ml min 1 the inner and outer diameters of the pump tube are 1 6 mm and 4 8 mm respectively provides a rainfall intensity of less than 1 mm min 1 pump 2 lls plus kamoer china flow rate within 1 352 ml min 1 the inner and outer diameters of the pump tube are 4 mm and 7 2 mm respectively has a greater water supply capacity than pump 1 and provides rainfall intensities greater than 1 mm min 1 both pumps were calibrated before the experiment the calibration curve is shown in fig 1 c the sample size at each point was 3 to ensure the accuracy of is and the two pump calibration results have a good functional relationship with r2 values greater than 0 99 pump 2 had two functions in the calibration system first it served as a simulated pump when is was greater than 1 mm min 1 and for is values less than 1 mm min 1 it quickly injected a given amount of water into the bucket before tipping to reduce the calibration time the software of the novel calibration system was compiled in the matlab programming language and the interfaces have two parts as shown in fig 2 a and b fig 2 a shows the counter pump system including three sections parameters the counter and the peristaltic pump the relevant tbr parameters and other experimental parameters can be set in the parameters section and they include the model id receiver area number of experiments resolution number of tips pump 1 rainfall intensity and calculated flow moreover this section can save read and check the above parameters the counter section can record the tipping time display the number of tips in real time and reset these two parameters the peristaltic pump section can open the serial port apply the calibration curve to the pump control the running of pumps 1 and 2 input the rainfall intensity of pump 2 and input the value of α fig 2 b shows the balance system with three sections the balance parameters and calibration results the balance section can record and display real time data for the three balances at a frequency of 1 s in addition this section can display the real time is of pump 1 and reset and close the three electronic balances the parameter section can receive parameters saved from the counter pump system the calibration results section displays the tbr error and the errors from left and right bucket tipping checks the mass the rainwater masses input into the calibration system minus the rainwater masses output from the calibration system which can be used to check the quality of the calibration the actual flow rate and the calibration results the right side of fig 2 b shows the water mass changes recorded by the three balances during the calibration process in real time at a frequency of one second when the bucket rotates to the horizontal position it triggers the electronic counter usb04232m12 west tech china one second after triggering pump 2 injects a given amount of water into the bucket because the rotation time of the tipping bucket is less than one second liao et al 2020b it is sufficient to set the interval to one second at the end of each calibration the results are automatically saved to a file for subsequent analysis and processing 2 3 experimental settings 2 3 1 comparison experiments in this research tbrs with jdz05 tr525i and hobo models were used for laboratory experiments fig 3 and their parameters are detailed in table 1 in addition there are two kinds of comparison experiments fast calibration fc and conventional calibration cc according to the preliminary experimental analysis the following parameters were selected for the comparison experiment between the fast and conventional calibration i2 was set as 6 mm min 1 α was set as 0 8 for jdz05 i2 was set as 6 mm min 1 α was set as 0 6 for tr525i i2 was set as 4 mm min 1 and α was set as 0 6 for hobo see table 2 the values of i2 and α in tr525i and hobo were smaller than those in jdz05 due to the smaller resolution of the former group fc and cc experiments were carried out 12 times at 0 2 0 5 and 1 mm min 1 rainfall intensities for pump 1 for each tbr and each run encompassed 20 tips one way analysis of variance anova was performed with a significance level of 0 05 to test the difference between the fast and cc methods under three is values for each type of tbr when the p value was higher than 0 05 no significant difference existed between the compared groups armstrong et al 2002 kaufmann and schering 2014 2 3 2 selection of the fast calibration scheme to ensure the success and rapidity of the experiment two experimental principles were proposed namely the safety principle and the speed principle in the safety principle pump 2 was stopped during the rotation of the bucket if pump 2 was still working during the bucket rotation process acceleration failed this failure should be avoided in fc in addition in the speed principle under the premise that the safety principle is guaranteed β can be increased as much as possible thus a trade off exists between i2 and α for the three tbrs tested various values of i2 and α see table 3 were selected to perform the experiment for the three is values to obtain the optimal i2 and α and to maximize the value of β the laboratory experiment was conducted between 9 00 am and 9 00 pm during the experiment the amount of evaporation in the laboratory was measured and the evaporation was 0 68 g h 1 on average the size of the container 211 cm2 used to measure evaporation was the same as the size of the rainwater receiver see fig 1 the laboratory temperature was 25 4 0 15 and the humidity was 66 2 2 72 3 results and discussion 3 1 comparison experiments fig 4 shows a box plot based on the results of the tbr error and a gaussian distribution is shown on the right side of the box plot the results of the two comparative experiments are very close for the three is values table 4 presents the detailed results of the comparative experiment for the tbrs tested for the average tbr error eave and the median the largest differences between the two experiments are 0 32 and 0 43 respectively hobo i1 0 5 mm min 1 for the maximum tbr error emax and minimum tbr error emin the largest differences are 0 3 and 0 66 respectively hobo i1 0 2 mm min 1 in addition the differences in the standard deviations are very small all less than 0 1 therefore the difference in the error between the fast and conventional calibrations was small and all differences were less than 0 66 the p values were all greater than 0 05 and most of them were greater than 0 1 thus there was no significant difference between the two comparison experiments for jdz05 and hobo p 0 1 for the three is values for tr525i when i1 0 5 and 1 mm min 1 p 0 1 and when i1 0 2 mm min 1 0 05 p 0 1 this may be affected by evaporation during the experiment however the results for the two comparative groups still show no significant difference the water masses of the left and right buckets of jdz05 were recorded by balances 2 and 3 fig 5 shows that in the two comparative experiments the water masses of the left and right buckets of jdz05 are very close and normally distributed for the left bucket water mass of jdz05 the average mass difference between each bucket for the two groups does not exceed 0 02 g under the three is furthermore according to the anova p 0 05 i2 0 2 mm min 1 and p 0 1 i2 0 5 and 1 mm min 1 in addition for the right bucket the average mass difference was not more than 0 03 g and p 0 1 i2 0 2 mm min 1 p 0 1 i2 0 5 mm min 1 and p 0 05 i2 1 mm min 1 these findings reveal that there is no significant difference in the water mass per bucket of jdz05 between the two comparative experiments 3 2 selection of the fast calibration scheme for the same i1 various i2 and α values can be used to calculate different β according to eq 3 for the three tbrs three different i2 and α were combined to obtain β for the three is values for constant i2 β increased with increasing α however for constant α β did not increase with increasing i2 especially for jdz05 fig 6 the main reason for this result is that the acceleration of pump 2 takes a certain amount of time when i2 is set too large for example higher than 5 mm min 1 the acceleration process has ended before the set rainfall intensity is reached leading to the underestimation of β associated with the performance of the pump to satisfy the safety and speed principles the selection of i2 and α should be nontrivial if these two parameters are too low the time saving effect will not be apparent however if these two parameters are too high the safety principle may not be met therefore it is critical to select an appropriate combination of i2 and α because the resolution of jdz05 is the largest among the three types of tbrs the water mass per tip is the largest the values of i2 and α can be larger than those for the other tbr types in contrast the smaller the resolution is the smaller the values of i2 and α should be table 3 details the β values of the three tbrs for various i2 and α for jdz05 the ranges of β are 64 89 58 86 and 52 77 for the three is values however when i1 1 mm min 1 β is missing i2 5 mm min 1 α 0 9 because the safety principle is not met thus fast performance failed hence given the tbr resolution and i1 the trade off between i2 and α is the key to ensuring the success of the fc and to optimizing β for tr525i the ranges of β were 45 67 47 67 and 47 71 for hobo the ranges of β were 54 68 49 66 and 46 63 collectively for the three tbrs β can reach more than 45 and even up to 89 jdz05 i1 0 2 mm min 1 i2 0 5 mm min 1 and α 0 9 at the three is values which indicates that the novel method proposed here can effectively reduce the time required for tbr calibration 3 3 fast calibration combined with field data the wmo recommended time resolution for rainfall intensity measurement is one minute lanza and stagi 2009 wmo 2006 a tbr shanghai sl3 1 0 1 mm resolution with double layers of tipping buckets stagnaro et al 2016 was used to measure the rainfall with a sampling frequency of one minute fig 7 shows the measurements recorded by sl3 1 at the chuzhou scientific hydrology laboratory from 2018 to 2019 rainfall within intensities of 0 1 0 5 mm min 1 and 0 1 1 mm min 1 accounted for approximately 78 and 91 of the total rainfall respectively the frequencies of rainfall intensities of 0 1 0 5 mm min 1 and 0 1 1 mm min 1 were nearly 96 and 99 respectively however rainfall with intensities of 1 1 2 mm min 1 and 2 1 3 mm min 1 accounts for approximately 7 and 2 of the total rainfall respectively moreover the frequencies of rainfall intensities of 1 1 2 mm min 1 and 2 1 3 mm min 1 account for approximately 0 87 and 0 13 respectively therefore the measurements of rainfall indicate that low rainfall intensities account for the majority of rainfall events and rainfall intensities greater than 0 5 mm min 1 account for a rather low proportion of all intensities since most rainfall is of low intensity future calibration should focus on low rainfall intensities previous studies suffered from time consuming tbr calibration for example it takes approximately 7 h to calibrate a 0 1 mm tbr with ten rainfall intensities the rainfall range is 6 240 mm h equal to 0 1 4 mm min 1 and more than 90 of the calibration time is spent on rainfall intensities of less than 0 5 mm min 1 humphrey et al 1997 given the same tipping times if a tbr has a large resolution it requires more time than tbrs with low resolutions for a tbr with a 0 2 mm resolution according to the average inter tip time at nine rainfall intensities the rainfall range is 6 7 511 3 mm h equal to 0 11 8 52 mm min 1 colli et al 2013 nearly 82 of the calibration time is devoted to rainfall intensities less than 0 5 mm min 1 tbrs should be calibrated before installation and recalibrated after periodic observation so that the rainfall data obtained have high accuracy and reliability iida et al 2018 lanza et al 2010 due to the time consumption of tbr calibration some tbrs are not calibrated before installation hu et al 2020 are not recalibrated for long term use or are calibrated with heavy rainfall intensities for example 2 mm min 1 in addition excessively frequent tbr calibration wastes considerable time however infrequent calibration or a lack of calibration risks measurement inaccuracy to calibrate or not to calibrate that is the question purchasing and installing tbrs is not a one time occurrence the need for calibration and maintenance should be considered part of the associated work therefore the proposed method in this paper provides a notable advantage for future tbr calibration improves the speed of tbr calibration and facilitates accurate rainfall measurements 4 conclusion the existing literature shows that the problem of tbr calibration time consumption has long existed and has not yet been solved to solve this long standing problem this research proposed a novel method and established a system for fast tbr calibration the proposed novel method and new calibration system designed can greatly reduce the calibration time and improve the efficiency of tbr calibration especially when the rainfall intensity is less than 0 5 mm min 1 three different types of tbrs were used to verify the feasibility of the novel method the research shows that the results of the new method and the conventional method are very similar in addition according to the anova results all of the p values are greater than 0 05 and most of them are greater than 0 1 so there is no significant difference between the results of fc and cc which verifies the accuracy of the fc the parameter β can reflect the effectiveness of fc for the same i1 various i2 and α values determine β and β increases with increasing α however the acceleration of pump 2 takes a certain amount of time so β does not increase as i2 increases the preferred scheme for fc of three tbrs can be selected based on the results in table 3 for the three tbrs tested β can reach more than 45 even up to 89 at three is values therefore fc can solve the time consuming tbr calibration problem at rainfall intensities less than 0 5 mm min 1 compared with cc fc can greatly reduce the time required for tbr or tbf calibration in addition this approach can also reduce the error of tbr calibration caused by evaporation credit authorship contribution statement minhan liao investigation methodology validation writing original draft aimin liao conceptualization methodology software writing review editing jiufu liu project administration supervision zhao cai investigation software hongwei liu software data curation tao ma resources validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key research and development program of china 2017yfc0405700 2017yfc0403500 the national natural science foundation of china 91647203 91847301 many thanks to niu wang chaoyu zheng and tongping liu of chuzhou scientific hydrology laboratory for supporting this work appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125782 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4650,the calibration of tipping bucket rain gauges tbrs before installation is an important but very time consuming task especially at low rainfall intensities to address the time consumption this paper developed a novel method and calibration system to improve the tbr calibration efficiency two peristaltic pumps were adopted in this method one pump provided some simulated rainfall intensities and another pump provided high rainfall intensities termed accelerated rainfall intensities to quickly inject a given amount of water into the tbr bucket before tipping to verify the feasibility of the novel method this investigation performed comparison experiments with three different types of tbrs in addition various accelerated rainfall intensities and ratios of the injected water volume to the total volume of the bucket were combined to conduct experiments at three simulated rainfall intensities of less than 1 mm min 1 to obtain the optimal schemes and maximize the time saving ratio β the results of the comparison experiments demonstrated that the performances of the new and conventional methods were quite close notably the average errors differed by less than 0 32 according to the anova results all p values were greater than 0 05 and most were greater than 0 1 therefore there was no significant difference between the results of the two methods verifying the feasibility of the new method the scheme based experimental results show that β can exceed 45 and reach 89 thus the novel method can greatly reduce the required calibration time in summary the fast calibration method proposed in this work is feasible for solving the time consumption problem and can increase the availability of tbrs in hydrology meteorology and other sciences keywords tipping bucket rain gauge fast calibration rainfall intensity time saving ratio calibration system 1 introduction precipitation measurements are vital and have been widely applied in meteorology hydrology and other sciences bianchi et al 2013 grimaldi et al 2015 but the accurate measurement of precipitation is a rather complicated task colli et al 2018 liu et al 2013 ross et al 2020 manual rain gauges tipping bucket rain gauges tbrs and weighing rain gauges are the three main types of measurement equipment for precipitation wmo 2006 with the advantages of a simple structure long life cycle ability to be installed in remote areas and high degree of automation cai et al 2020 the tbr has become the main device for rainfall observation and has been widely used in automatic precipitation monitoring and experimental research worldwide giles 2010 haselow et al 2019 liu and gu 2018 upton and rahimi 2003 however tbrs are known to underestimate rainfall at high rainfall intensities due to rainwater loss during the rotation of the bucket molini et al 2005 this underestimation can be remedied by tbr calibration marsalek 1981 tbr calibration can be generally divided into static calibration and dynamic calibration humphrey et al 1997 sypka 2019 in static calibration methods a pipette is adopted to determine the volume of water required to make the bucket tip and the influence of the rainfall intensity is not taken into consideration the concept and first method of dynamic calibration were proposed by calder and kidd 1978 this approach which considers the influence of the rainfall intensity and aims to calibrate the tbr while the buckets are in motion has been proven to be effective calder and kidd 1978 humphrey et al 1997 because of the significance of tbr calibration some study groups and institutions have established laboratory calibration systems to improve the tbr measurement accuracy colli et al 2014 humphrey et al 1997 lanza et al 2006 santana et al 2015 vasvári 2005 the existing literature has shown that both tbrs iida et al 2018 lanza and vuerich 2009 niemczynowicz 1986 and tipping bucket flow meters tbfs edwards et al 1974 takanori et al 2018 need to be calibrated before installation but due to the uncertainty of the field environment these devices should be recalibrated after long term observation therefore potential issues can arise involving regular maintenance and recalibration which are needed to ensure the accuracy of measurements lanza et al 2006 shedekar et al 2016 wills 2013 the curve obtained by tbr calibration can provide high quality rainfall intensity measurements after suitable correction lanza et al 2006 in general the calculated values of error are plotted versus the simulated rainfall intensities is to define a calibration curve for a tbr colli et al 2014 although the measurement error cannot be completely eliminated calibration can minimize the measurement error and promote the correction of field data from tbrs shedekar et al 2016 according to data observed with multiple types of rain gauges rainfall intensity frequencies under 0 2 mm min 1 and 0 5 mm min 1 at the experimental site account for more than 50 and 90 of the results respectively liao et al 2020a therefore tbrs need to be calibrated at low rainfall intensities such as 0 1 or 0 2 mm min 1 to improve the accuracy of rainfall measurements tbr calibration at low rainfall intensities is necessary but time consuming humphrey et al 1997 liao et al 2020b and the tbr cannot collect data during the calibration period in addition under laboratory conditions the evaporation losses from the bucket increase nearly linearly with time rolf 1998 if the time required for calibration in the laboratory is too long errors caused by evaporation may occur humphrey et al 1997 designed an automated calibration system for tbrs but this system relies on the conventional calibration method and requires much time in previous studies most researchers used only one pump to simulate different rainfall intensities however to simulate high precision flow one proposed flow rate generation system adopted two pumps for calibration when the flow rate was below 18 ml min 1 a low intensity pump was activated and when the flow rate was greater than 18 ml min 1 a high intensity pump was activated colli et al 2013 2014 this improvement was innovative and improved the accuracy of simulating the rainfall intensity but the tbr calibration time issue remains as a prerequisite for the success of many applications calibration remains a challenging and time consuming task for devices such as sensors and instruments quoc and andrew 2009 moreover calibration is even considered a necessary evil duchowski 2017 because calibration is necessary but can be cumbersome expensive or time consuming despite the effort devoted to tbr calibration research few works have investigated a fast tbr calibration method therefore the present work proposed a novel and fast tbr calibration method and a corresponding system was constructed two high precision peristaltic pumps were adapted in this system pump 1 was used to simulate the rainfall intensity and pump 2 was used to improve the calibration efficiency the main objectives of this article are to 1 establish a novel method and system for fast tbr calibration 2 verify the feasibility of the method and system through comparison experiments and 3 select preferred schemes for fast tbr calibration 2 materials and methods 2 1 a novel method for fast tbr calibration the calibration time mainly depends on a variety of factors including the receiver area resolution number of tips and rainfall intensity selected first the time required for conventional calibration tc needs to be determined this time can be recorded by a stopwatch niemczynowicz 1986 or calculated by a formula as follows 1 t c v 0 0 1 s i where v0 is the tbr bucket volume ml s is the receiver area cm2 and i is the rainfall intensity simulated by the peristaltic pump mm min 1 when the rainfall intensity is very low the calibration is time consuming the tbr will take away a part of the rainwater during the bucket rotation process and the greater the rainfall intensity is the greater the rainwater loss therefore without influencing the bucket rotation process an additional acceleration pump can be used to supplement the water with relatively high flow rate this can be considered acceleration therefore the above formula can be revised 2 t a v 0 α 0 1 s i 1 i 2 v 0 1 α 0 1 s i 1 where ta is the calibration time obtained with the new method by subtracting the start time of the program from the end time which is recorded by a computer as described in the next section α is the ratio of the injected water volume to the total volume of the bucket and i1 and i2 are the rainfall intensities simulated by pump 1 and pump 2 respectively the adoption of pump 2 can help reduce the calibration time and the time saving ratio β can be calculated by the following formula 3 β t c t a t c 100 the idea proposed here is theoretically feasible however experimental research is still required to verify the feasibility of the method in addition the tbr error and water mass per bucket were used to quantitatively evaluate the results in general the error can be calculated by the following formula liao et al 2020b 4 e 0 1 h s ρ n m r m r 100 where e is the tbr error h is the resolution mm n is the number of tips ρ is the density of deionized water 1 g cm 3 and mr is the rainwater flow into the bucket as recorded by balance 1 another two electronic balances can record the water masses flowing out of from the left and right buckets separately the value for each bucket on the left side is recorded by balance 2 similarly the value for each bucket on the right side is recorded by balance 3 2 2 a novel system for fast tbr calibration a new tbr calibration system fig 1 was designed to perform laboratory simulations of various rainfall intensities with functions such as water supply weighing measurement and automatic counting compared to conventional calibration systems liao et al 2020b shedekar et al 2016 this new system offers significant improvements especially for peristaltic pumps various rainfall intensities were simulated with two high precision peristaltic pumps two pumps with different flow rate ranges can be adapted to accurately control is pump 1 lls plus kamoer china flow rate within 1 150 ml min 1 the inner and outer diameters of the pump tube are 1 6 mm and 4 8 mm respectively provides a rainfall intensity of less than 1 mm min 1 pump 2 lls plus kamoer china flow rate within 1 352 ml min 1 the inner and outer diameters of the pump tube are 4 mm and 7 2 mm respectively has a greater water supply capacity than pump 1 and provides rainfall intensities greater than 1 mm min 1 both pumps were calibrated before the experiment the calibration curve is shown in fig 1 c the sample size at each point was 3 to ensure the accuracy of is and the two pump calibration results have a good functional relationship with r2 values greater than 0 99 pump 2 had two functions in the calibration system first it served as a simulated pump when is was greater than 1 mm min 1 and for is values less than 1 mm min 1 it quickly injected a given amount of water into the bucket before tipping to reduce the calibration time the software of the novel calibration system was compiled in the matlab programming language and the interfaces have two parts as shown in fig 2 a and b fig 2 a shows the counter pump system including three sections parameters the counter and the peristaltic pump the relevant tbr parameters and other experimental parameters can be set in the parameters section and they include the model id receiver area number of experiments resolution number of tips pump 1 rainfall intensity and calculated flow moreover this section can save read and check the above parameters the counter section can record the tipping time display the number of tips in real time and reset these two parameters the peristaltic pump section can open the serial port apply the calibration curve to the pump control the running of pumps 1 and 2 input the rainfall intensity of pump 2 and input the value of α fig 2 b shows the balance system with three sections the balance parameters and calibration results the balance section can record and display real time data for the three balances at a frequency of 1 s in addition this section can display the real time is of pump 1 and reset and close the three electronic balances the parameter section can receive parameters saved from the counter pump system the calibration results section displays the tbr error and the errors from left and right bucket tipping checks the mass the rainwater masses input into the calibration system minus the rainwater masses output from the calibration system which can be used to check the quality of the calibration the actual flow rate and the calibration results the right side of fig 2 b shows the water mass changes recorded by the three balances during the calibration process in real time at a frequency of one second when the bucket rotates to the horizontal position it triggers the electronic counter usb04232m12 west tech china one second after triggering pump 2 injects a given amount of water into the bucket because the rotation time of the tipping bucket is less than one second liao et al 2020b it is sufficient to set the interval to one second at the end of each calibration the results are automatically saved to a file for subsequent analysis and processing 2 3 experimental settings 2 3 1 comparison experiments in this research tbrs with jdz05 tr525i and hobo models were used for laboratory experiments fig 3 and their parameters are detailed in table 1 in addition there are two kinds of comparison experiments fast calibration fc and conventional calibration cc according to the preliminary experimental analysis the following parameters were selected for the comparison experiment between the fast and conventional calibration i2 was set as 6 mm min 1 α was set as 0 8 for jdz05 i2 was set as 6 mm min 1 α was set as 0 6 for tr525i i2 was set as 4 mm min 1 and α was set as 0 6 for hobo see table 2 the values of i2 and α in tr525i and hobo were smaller than those in jdz05 due to the smaller resolution of the former group fc and cc experiments were carried out 12 times at 0 2 0 5 and 1 mm min 1 rainfall intensities for pump 1 for each tbr and each run encompassed 20 tips one way analysis of variance anova was performed with a significance level of 0 05 to test the difference between the fast and cc methods under three is values for each type of tbr when the p value was higher than 0 05 no significant difference existed between the compared groups armstrong et al 2002 kaufmann and schering 2014 2 3 2 selection of the fast calibration scheme to ensure the success and rapidity of the experiment two experimental principles were proposed namely the safety principle and the speed principle in the safety principle pump 2 was stopped during the rotation of the bucket if pump 2 was still working during the bucket rotation process acceleration failed this failure should be avoided in fc in addition in the speed principle under the premise that the safety principle is guaranteed β can be increased as much as possible thus a trade off exists between i2 and α for the three tbrs tested various values of i2 and α see table 3 were selected to perform the experiment for the three is values to obtain the optimal i2 and α and to maximize the value of β the laboratory experiment was conducted between 9 00 am and 9 00 pm during the experiment the amount of evaporation in the laboratory was measured and the evaporation was 0 68 g h 1 on average the size of the container 211 cm2 used to measure evaporation was the same as the size of the rainwater receiver see fig 1 the laboratory temperature was 25 4 0 15 and the humidity was 66 2 2 72 3 results and discussion 3 1 comparison experiments fig 4 shows a box plot based on the results of the tbr error and a gaussian distribution is shown on the right side of the box plot the results of the two comparative experiments are very close for the three is values table 4 presents the detailed results of the comparative experiment for the tbrs tested for the average tbr error eave and the median the largest differences between the two experiments are 0 32 and 0 43 respectively hobo i1 0 5 mm min 1 for the maximum tbr error emax and minimum tbr error emin the largest differences are 0 3 and 0 66 respectively hobo i1 0 2 mm min 1 in addition the differences in the standard deviations are very small all less than 0 1 therefore the difference in the error between the fast and conventional calibrations was small and all differences were less than 0 66 the p values were all greater than 0 05 and most of them were greater than 0 1 thus there was no significant difference between the two comparison experiments for jdz05 and hobo p 0 1 for the three is values for tr525i when i1 0 5 and 1 mm min 1 p 0 1 and when i1 0 2 mm min 1 0 05 p 0 1 this may be affected by evaporation during the experiment however the results for the two comparative groups still show no significant difference the water masses of the left and right buckets of jdz05 were recorded by balances 2 and 3 fig 5 shows that in the two comparative experiments the water masses of the left and right buckets of jdz05 are very close and normally distributed for the left bucket water mass of jdz05 the average mass difference between each bucket for the two groups does not exceed 0 02 g under the three is furthermore according to the anova p 0 05 i2 0 2 mm min 1 and p 0 1 i2 0 5 and 1 mm min 1 in addition for the right bucket the average mass difference was not more than 0 03 g and p 0 1 i2 0 2 mm min 1 p 0 1 i2 0 5 mm min 1 and p 0 05 i2 1 mm min 1 these findings reveal that there is no significant difference in the water mass per bucket of jdz05 between the two comparative experiments 3 2 selection of the fast calibration scheme for the same i1 various i2 and α values can be used to calculate different β according to eq 3 for the three tbrs three different i2 and α were combined to obtain β for the three is values for constant i2 β increased with increasing α however for constant α β did not increase with increasing i2 especially for jdz05 fig 6 the main reason for this result is that the acceleration of pump 2 takes a certain amount of time when i2 is set too large for example higher than 5 mm min 1 the acceleration process has ended before the set rainfall intensity is reached leading to the underestimation of β associated with the performance of the pump to satisfy the safety and speed principles the selection of i2 and α should be nontrivial if these two parameters are too low the time saving effect will not be apparent however if these two parameters are too high the safety principle may not be met therefore it is critical to select an appropriate combination of i2 and α because the resolution of jdz05 is the largest among the three types of tbrs the water mass per tip is the largest the values of i2 and α can be larger than those for the other tbr types in contrast the smaller the resolution is the smaller the values of i2 and α should be table 3 details the β values of the three tbrs for various i2 and α for jdz05 the ranges of β are 64 89 58 86 and 52 77 for the three is values however when i1 1 mm min 1 β is missing i2 5 mm min 1 α 0 9 because the safety principle is not met thus fast performance failed hence given the tbr resolution and i1 the trade off between i2 and α is the key to ensuring the success of the fc and to optimizing β for tr525i the ranges of β were 45 67 47 67 and 47 71 for hobo the ranges of β were 54 68 49 66 and 46 63 collectively for the three tbrs β can reach more than 45 and even up to 89 jdz05 i1 0 2 mm min 1 i2 0 5 mm min 1 and α 0 9 at the three is values which indicates that the novel method proposed here can effectively reduce the time required for tbr calibration 3 3 fast calibration combined with field data the wmo recommended time resolution for rainfall intensity measurement is one minute lanza and stagi 2009 wmo 2006 a tbr shanghai sl3 1 0 1 mm resolution with double layers of tipping buckets stagnaro et al 2016 was used to measure the rainfall with a sampling frequency of one minute fig 7 shows the measurements recorded by sl3 1 at the chuzhou scientific hydrology laboratory from 2018 to 2019 rainfall within intensities of 0 1 0 5 mm min 1 and 0 1 1 mm min 1 accounted for approximately 78 and 91 of the total rainfall respectively the frequencies of rainfall intensities of 0 1 0 5 mm min 1 and 0 1 1 mm min 1 were nearly 96 and 99 respectively however rainfall with intensities of 1 1 2 mm min 1 and 2 1 3 mm min 1 accounts for approximately 7 and 2 of the total rainfall respectively moreover the frequencies of rainfall intensities of 1 1 2 mm min 1 and 2 1 3 mm min 1 account for approximately 0 87 and 0 13 respectively therefore the measurements of rainfall indicate that low rainfall intensities account for the majority of rainfall events and rainfall intensities greater than 0 5 mm min 1 account for a rather low proportion of all intensities since most rainfall is of low intensity future calibration should focus on low rainfall intensities previous studies suffered from time consuming tbr calibration for example it takes approximately 7 h to calibrate a 0 1 mm tbr with ten rainfall intensities the rainfall range is 6 240 mm h equal to 0 1 4 mm min 1 and more than 90 of the calibration time is spent on rainfall intensities of less than 0 5 mm min 1 humphrey et al 1997 given the same tipping times if a tbr has a large resolution it requires more time than tbrs with low resolutions for a tbr with a 0 2 mm resolution according to the average inter tip time at nine rainfall intensities the rainfall range is 6 7 511 3 mm h equal to 0 11 8 52 mm min 1 colli et al 2013 nearly 82 of the calibration time is devoted to rainfall intensities less than 0 5 mm min 1 tbrs should be calibrated before installation and recalibrated after periodic observation so that the rainfall data obtained have high accuracy and reliability iida et al 2018 lanza et al 2010 due to the time consumption of tbr calibration some tbrs are not calibrated before installation hu et al 2020 are not recalibrated for long term use or are calibrated with heavy rainfall intensities for example 2 mm min 1 in addition excessively frequent tbr calibration wastes considerable time however infrequent calibration or a lack of calibration risks measurement inaccuracy to calibrate or not to calibrate that is the question purchasing and installing tbrs is not a one time occurrence the need for calibration and maintenance should be considered part of the associated work therefore the proposed method in this paper provides a notable advantage for future tbr calibration improves the speed of tbr calibration and facilitates accurate rainfall measurements 4 conclusion the existing literature shows that the problem of tbr calibration time consumption has long existed and has not yet been solved to solve this long standing problem this research proposed a novel method and established a system for fast tbr calibration the proposed novel method and new calibration system designed can greatly reduce the calibration time and improve the efficiency of tbr calibration especially when the rainfall intensity is less than 0 5 mm min 1 three different types of tbrs were used to verify the feasibility of the novel method the research shows that the results of the new method and the conventional method are very similar in addition according to the anova results all of the p values are greater than 0 05 and most of them are greater than 0 1 so there is no significant difference between the results of fc and cc which verifies the accuracy of the fc the parameter β can reflect the effectiveness of fc for the same i1 various i2 and α values determine β and β increases with increasing α however the acceleration of pump 2 takes a certain amount of time so β does not increase as i2 increases the preferred scheme for fc of three tbrs can be selected based on the results in table 3 for the three tbrs tested β can reach more than 45 even up to 89 at three is values therefore fc can solve the time consuming tbr calibration problem at rainfall intensities less than 0 5 mm min 1 compared with cc fc can greatly reduce the time required for tbr or tbf calibration in addition this approach can also reduce the error of tbr calibration caused by evaporation credit authorship contribution statement minhan liao investigation methodology validation writing original draft aimin liao conceptualization methodology software writing review editing jiufu liu project administration supervision zhao cai investigation software hongwei liu software data curation tao ma resources validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national key research and development program of china 2017yfc0405700 2017yfc0403500 the national natural science foundation of china 91647203 91847301 many thanks to niu wang chaoyu zheng and tongping liu of chuzhou scientific hydrology laboratory for supporting this work appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125782 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4651,gates in dams and irrigation canals are used for controlling discharge and for water regulation to determine the discharge under a gate the discharge coefficient c d must be quantified this study investigates the effect of sill shape under a vertical sluice gate on c d the study also includes the influence of height the investigated shapes are comprised of polyhedral and non polyhedral sills multiple nonlinear regression mnlr is applied to predict c d values and the results show that circular sills under the gate can increase c d by 23 31 a circular sill with a 3 cm diameter has the highest c d and trapezoidal sills have the lowest c d on the other hand semicircular sills have moderate values of c d the most influential parameters affecting c d are h 1 p and z g where h 1 is the upstream head over the sill crest p is the sill wetted perimeter z is the height of sill and g is the gate opening using dimensionless parameters and regression analysis an equation for predicting c d in free flow conditions with and without a sill is presented the equation agrees with previously published results and can be implemented for predicting c d in sluice gates with and without sills to within 6 accuracy keywords sluice gate discharge coefficient sill regression nomenclature a cross section of flow m2 b channel width m cd the gate discharge coefficient dimentionless cc gate contraction coefficient dimentionless df degree of freedom g the gate opening m g acceleration due to gravity m s2 h upstream water depth m h1 the upstream water depth is measured on the sill m p sill wetted perimeter m q the flow discharge m3 s q discharge per unit width of canal m2 s rn the reynolds number dimentionless rs sill hydraulic radius m re the relative error dimentionless r2 coefficient of determination dimentionless rmse root mean squared error in this study is dimentionless xioi the i th observed value of the discharge coefficient dimentionless yipi the i th predicted value of the discharge coefficient dimentionless n number of data dimentionless z height of sill m φ sill shape factor dimentionless ρ water density kg m3 μ water dynamic viscosity n s m2 1 introduction flood control structures are used to adjust water levels in water supply channels and to control water released from dams simons 1979 gates are one of the most important type of such structures due to the simple hydraulic equation that characterizes sluice gates these types of structures have been used extensively in many situtations alhamid 1999 there are multiple types of gates each having advantages and disadvantages the specific gate type can be selected according to the application weyer 2001 flow through sluice gates is divided into two types i free surface flow and ii submerged flow and the discharge coefficients for two categories are different gates have been extensively used in irrigation canals at the top of dam spillways and at exits from lakes to channels erdbrink 2014 erdbrink et al 2014 natural or artificial un erodible obstacles and a control point such as a diversion dam or a regulator gate can reduce and limit degradation in rivers khaleel and othman 1997 carried out a study on the effect of clear water released from a sluice gate fixed upstream of an alluvial laboratory channel fusegates are commonly utilized to increase reservoir capacity they maintain higher water levels upstream of spillways in a recent publication shahkarami 2020 studied an installation of a set of fusegates along the river base that provided a barrier for incident flow without the need for an extra flood mitigating structures various types of gates include underpass gates where water moves from under the gate and the discharge is controlled by the gate opening rate the most important and usable underflow gates are sluice and radial gates swamee 1992 estimating the flow discharge under a gate has been an essential problem in many water engineering projects belaud et al 2009 yousif et al 2019 however accurate estimation of flow requires knowledge of the discharge coefficient the nature of flow under gates have been theoretically and experimentally studied by many researchers with henderson 1966 ohtsu and yasuda 1994 rajaratnam 1977 rajaratnam and subramanya 1967 swamee 1992 as representative examples according to recent studies a sill under the gate can improve gate operation alhamid 1999 the benefits of a sill under a radial gate include the prevention of the effects of sediment on the operation of the gate the increase of c d and subsequently increass the flow under the gate in fact a sill under the gate reduces the height of the gates and decreases the force of the water pressure consequently the weight of the gate also decreases therefore the presence of a properly positioned and shaped sill is expected to improve the performance of a gate on the other hand installation of a sill in an unsuitable position under the sluice gate may cause negative effects on c d for example salmasi et al 2019 studied the effect of sill location on c d for radial gates they tested two cases i a sill located upstream of the gate and ii a sill located under the gate the results showed that when the radial gate is open and sills are positioned upstream gates case i the sill operates as a barrier and reduces c d but in case ii the sill location has a positive effect on c d negm et al 1995 investigated the characteristics of a free hydraulic jump downstream of silled sluice gates they studied the sequent depth the length and the energy loss ratios of the hydraulic jump downstream of the sluice gate the results showed that the under gate sill increases both the sequent depth and the length of hydraulic jump ratios and while it decreases the energy loss ratio compared to the case of no sill negative effect the first modern study on sluice gates was completed by rajaratnam and subramanya 1967 they concluded that the value of c d is directly related to the g h ratio and for g h 0 3 the value of c d can be calculated from eq 1 1 c d 0 0297 g h 0 589 where c d is the gate discharge coefficient g is the gate opening and h is the upstream water depth swamee 1992 presented eq 2 for a free surface flow from nonlinear regression using results from henry 1950 2 c d 0 611 h g h 15 g 0 071 swamee 1992 also referred to the inequality h 0 81y 2 y 2 g 0 72 for free flow under a sluice gate otherwise submerged flow would occur from under the sluice gate shivapur and shesha prakash 2005 conducted a laboratory investigation to determine c d for vertical and inclined gates they investigated four gate angles of values zero gate is perpendicular to the flow direction 15 30 and 45 degrees angles along the vertical and inclined to the upstream for greater accuracy in measuring the flow discharge a volumetric method was used the reservoir volume was 4 53 m3 the vertical gate causes flow convergence underneath it and the increased convergence can increase values of c d they presented eq 3 for determining the c d for free flow conditions with the gate angle in radians in the vertical direction α 3 c d 0 645 1 0 35 α 1 25 h g h 15 g 0 072 shivapur and shesha prakash 2005 also presented eq 4 to determine the c d for submerged flow with factors that are defined in fig 1 4 c d 0 645 1 0 152 α 0 7 h g h 15 g 0 072 0 9052 y 2 h 2 0 3781 y 2 h 0 8394 the c d for an inclined gate oriented 45 in the upstream direction was 25 88 higher than for the vertical gate with free flow this value was obtained for submerged flow conditions equal to 11 24 do amaral et al 2005 refered to the influence of water depth fluctuations in the main channel on discharge through sluice gates in irrigation channels they evaluated a flow regulator to reduce flow variations in the secondary channels which in turn causes water level variation in the main channels results showed that the flow control provided by the automatic flow regulator was more effective than that provided by the sluice gate in habibzadeh et al 2011 the energy loss between the gate upstream and contraction flow sections was determined for free flows the energy loss is caused by rotational flow upstream of the gate the effect of energy loss was deteremined by kv 2 2 2g in which k is the loss coefficient and v 2 is the velocity at the contraction flow section the results indicated that the energy loss coefficient k for the free flow was 0 062 and for the submerged flow it was about 0 088 nasehi and salmasi 2012 solved conservation equations for energy and momentum and they produced 5200 datapoints to determining values of c d for sluice gates two regression equations were obtained for flow in both free and submerged conditions the results indicated that the proposed method corresponded to the diagram proposed by henry 1950 in that study the contraction coefficient of the gate was assumed to be 0 61 khalili shayan and farhoudi 2013 examined the characteristics for free and submerged flows from sluice and radial gates by using energy and momentum equations they validated their calculations with experimental data quang et al 2019 used intermittent irrigation through the operation of irrigation pumps and sluice gates the goal was to mitigate the emissions of greenhouse gases from rice paddy fields in the red river delta vietnam in another study akbari et al 2019 used a gated piano key weir gpkw to predict discharge coefficients there slide gates were installed on piano key weirs pkw to increase water discharge ghosh et al 2014 referred to the formation of ponds by construction of river diversion barrages deposition of sediment in ponds due to the relatively low water velocities reduces the pond capacity they investigated the effectiveness of sluice gates following the removal of sediment mounds or shoals from the barrage pond a review of the previous studies shows that discharge coefficients for vertical sluice gates are available in chart fashion the most well known chart was generated in the work of henry 1950 a high level of non linearity in the hydraulic parameters motivates the use of charts instead of equations in cases where a sill is placed underneath the gate and as the complexity and non linearity increase geometric variables of the sill are also important parameters in addition to the parameters already mentioned thus the drawback of the classic methods for determining discharge coefficients is that charts require interpolation and can increase errors the present study was conducted using an experimental dataset for a vertical slide gate and with sills located under the vertical gates an appropriate shape of the sill for use with vertical sluice gates was sought fabricated sills are positioned underneath the vertical sluice gate one goal is the estimation of the effect of sill shape on the flow the experiments were conducted in a horizontal rectangular flume with free flow subsequently the performance of multiple nonlinear regression mnlr correlations are investigated for predicting c d values 2 theoretical analysis fig 1 indicates the longitudinal cross section of a vertical sluice gate with a circular sill under free flow conditions considering fig 1 and its combination with energy conservation eqs 5 and 6 are obtained henderson 1966 5 q c d g 2 g h z 6 c d c c 1 c c g h z where q is the discharge per unit width of the canal c d is the gate discharge coefficient g is the gate opening g is the acceleration due to gravity h is the upstream water depth z is the sill height and c c is the gate contraction coefficient the ratio of water depth downstream of the sluice gate y 1 to the gate opening g is defined as c c the minimum depth y 1 that occurs downstream of a sluice gate is known as the vena contracta rajaratnam and subramanya 1967 noted that the vena contracta occurs at a distance of about 1 15 times the gate opening g typically c c 0 611 is used for practical design purposes and this value has sufficient precision for many applications henderson 1966 more recently habibzadeh et al 2011 assigned the value of 0 611 for c c to investigate the role of energy loss in hydraulics of sluice gates so that this value has seen continued usage it is worth noting that in laboratory experiments measurement of the discharge can be done with high accuracy there is no need for assuming c c in fact with eq 5 c d can calculated directly and without knowledge of c c for submerged flows eqs 5 and 6 can also be used and c d will depend on g y 2 and g h here y 2 is the downstream flow depth for free flow conditions y 2 has little or no effect on discharge so c d is solely a function of g h henry 1950 presented the values of c d for free and submerged flows in a non dimensional graph in that study the sluice gate did not include a sill under the gate 3 materials and methods 3 1 experimental setup experiments were carried out in the hydraulic labrotary at the university of tabriz in iran the present study utilized experimental data obtained in a flume with plexiglas walls that allow visual inspection of the flow the flume length is 10 m and the width is 0 35 m the flume depth is 1 5 m at upstream locations and the depth reduces to 0 9 m downstream there are two controlling gates installed in the flume including the vertical gate one gate is in the studied section and the other is at the end of the flume flow was generated using a pump with a maximum capacity of 50 l s the discharge was measured by a calibrated triangular weir flow depths were measured with a point gauge with a precision of 0 1 mm fig 2 illustrates the experimental flume laboratory set up including the water reservoir head tank underground reservoir and a triangular weir to measure the discharge fig 3 shows the flow under the vertical sluice gate under supercritical conditions the sills were made of waterproof wood and covered with a thin layer of laminated oil to maintain their shape as indicated in fig 3 sills in the bed were fixed in a way that their crest was under the gate nine of these sills were 5 cm high and circle sills were 2 35 3 3 and 8 cm in height different flow discharges were considered that ranged from 10 to 50 l s for the four gate openings g twelve different sills were studied the cross section of these sills have five different shapes triangular trapezoidal circular semicircular and round faced these sill shapes are illustrated in fig 4 with their dimensional nomenclature to calculate c d eq 5 which was a simplified form of the energy equation was used fig 1 as indicated earlier and as will be discussed shortly the effects of the shape and the height of the sills were investigated 3 2 dimensional analysis of cd for the investigated sluice gates for free flow under sluice gates dimensionless analysis reveals that c d is a function of the following parameters 7 f 1 ρ q b g μ h z g 0 where ρ is the density of water q is the flow discharge b is the width of the canal flume g is acceleration due to gravity μ represents the dynamic viscosity of water h is the upstream water depth z is the height of the sill g is the gate opening and φ is the sill shape factor that is related to the sill wetted perimeter p and to the sill hydraulic radius r s as expressed eq 8 8 f 2 r s p the hydraulic radius of the sill is defined by r s a p where a is the cross sectional area of the flow and p is its wetted perimeter according to the buckingham pi theorem c d for free flow under the sluice gate is related to input parameters as shown in the following 9 f 3 h 1 p z g r s g r s h 1 c d q g 2 g h 1 r n ρqq μ h 1 0 in eq 9 h 1 is the upstream water depth measured on the sill h 1 h z r n is the reynolds number and its effect is neglected for the highly turbulent flow that occurs under the gate with some simplification and by neglecting reynolds number effects eq 10 is obtained 10 c d f 4 h 1 p z g r s g r s h 1 the main advantage of using dimensionless parameters is to reduce the number of variables in the analysis in hydraulic experiments it is a common practice to use dimensionless parameters because it decreases the number of tests another advantage of dimensional analysis is that it enables the results to be generalized to other situations as noted previously this study was conducted for four gate openings g four dimensionless parameters z g h 1 p r s g and r s h 1 are used for estimaton of c d thus by variation of z p g and r s a total of 188 datapoints were made available which was adequate for this type of hydraulic study 3 3 statistical measures the performance criteria include the coefficient of correlation r2 and the root mean square error rmse the statistical measures are represented by eqs 11 and 12 akbari et al 2019 coefficient of determination r2 11 r 2 n x i y i x i y i n x i 2 x i 2 n y i 2 y i 2 2 root mean squared error rmse 12 rmse i 1 n x i y i 2 n where x i and y i are the i th observed and predicted values of the discharge coefficient respectively and n is the total number of data in this study the dependent parameter is c d and the independent parameters are z g h 1 p r s g and r s h 1 statistical characteristics of these dimensionless parameters are provided in table 1 4 results and discussion as previously mentioned four circular sills with diameters of 2 35 cm sill 1 3 3 cm sill 2 5 cm sill 3 and 8 cm sill 4 were tested fig 5 shows that the sill height is an important factor that affects c d the gate with a sill had a coefficient of discharge greater than for the gate without a sill also when the sill height rises c d first increases until it reaches a maximum value and thereafter it decreases a 5 cm sill height for the circular shape provided the highest discharge coefficient fig 5 indicates that by decreasing the gate opening g the discharge coefficient increases by reducing the opening of the gate the flow through the gate experiences greater convergence and with increasing velocity the hydrostatic pressure is reduced consequently the pressure becomes less than γ w h 1 where γ w is the specific gravity of the water the reduction in water pressure and water suction increases c d rajaratnam and humphries 1982 indicated that the pressure decrease due to the gate installation is created at a location 5g from the upstream of the gate use of a circular sill with 5 cm diameter sill no 3 increases the discharge coefficient by 23 31 the asymptotic value of c d is 0 77 as h z g continues to increase 4 1 polyhedron sill by fixing the downstream slope of a polyhedral sill to 1 5 vertical to horizontal the effect of upstream slope can be investigated three triangular sills with upstream slopes of 1 v 0h 1 v 1h and 1 v 2h were utilized in fig 6 the variation of c d is presented against the non dimensional parameter h z g the figure indicates that especially for h z g values below 8 the effect of the upstream slope is large but for larger values of this ratio the effect of the slope is minimal an upstream slope of 1 v 2h was found to be optimal because it provides maximum c d sill 7 the hydraulic reason for this is that for a lower upstream slope the flow lines adjacent to the gate slowly change the direction and more gradual change reduces energy loss by fixing the sill upstream slope to 1 v 1h the effect of the sill downstream slope was tested three trapezoidal sills with downstream slopes of 1 v 0h 1 v 3h and 1 v 5h were used fig 7 indicates that the downstream slope has a positive effect on c d and among trapezoidal sills the downstream slope of 1 v 3h had the greatest effect on c d sill no 9 here a more gradual downstream slope causes the flow lines emerging from the gate to slowly change direction which reduces the energy loss but for the downstream slope of 1 v 5h as the slope decreases the length of the slope increases with a steep face the energy loss increases 4 2 non polyhedron sills fig 8 indicates the effect of a non polyhedron sill on c d the results are represented for three different sills with a height of 5 cm fig 8 shows that a circular sill sill no 3 had the largest c d compared to the other cases a circle sill with a 5 cm diameter resulted in a modest increase of about 28 6 compared to non sill c d values the semicircular sill sill 11 resulted in a moderate increase of 19 compared to the non sill c d value in addition the rounded face sill with a triangular tail section sill 12 resulted in a minimal increase of 12 5 in the c d value 4 3 development of multiple non linear regression mnlr equations 4 3 1 gates without sills in fig 9 c d values for gates without a sill from the present study are compared with the results of the experiments from five other studies including rajaratnam and subramanya 1967 rajaratnam 1977 negm et al 1995 swamee 1992 and shivapur and shesha prakash 2005 the coefficients of eq 2 were evaluated based on the present data and eq 13 was used to estimate c d for vertical sluice gates without sills and with free flow condition 13 c d 0 63 h g h 15 g 0 067 eq 13 corresponds to the available data from the other studies in fig 9 and predicts the c d value to within a maximum error of 5 the accuracy criteria for derivation of eq 13 are r2 0 882 and rmse 0 017 4 3 2 gates with sills for the polyhedral sill sill 12 the downstream slope and the shape of the crest were the main shape parameters a form factor based on the the wetted perimeter p and hydraulic radius r s a p was utilized a is the sill cross section area using nonlinear regression analysis eq 14 was obtained 14 c d 0 63 h 1 g h 1 15 g 0 067 1 z g 0 366 1 h 1 p 0 045 1 r s g 0 523 1 r s h 1 0 413 eq 14 can be used for gates with or without a sill and for free flow conditions the statistical measures used to characterize eq 14 are r2 0 867 and rmse 0 042 the range of validity for eq 14 is 0 0 h 1 p 16 3 0 0 r s g 0 13 0 0 z g 0 4 and 0 0 r s h 1 0 04 with eq 14 c d can be predicted with a maximum error 6 for gates without a sill z is zero p is infinite and h 1 is equal to h under these circumstances eq 14 can be transformed to eq 13 the regression technique has been used to obtain the coefficients and powers of eq 14 in the present study the spss software version 22 was used it is also worth noting that the power of 0 071 in swamee 1992 s equation was changed to 0 067 swamee 1992 obtained eq 4 from the experimental results of henry 1950 for a gate without a sill and under free flow conditions eq 14 can be used as a replacement of the equation obtained by swamee 1992 it can also be used both for gates with and without sills eq 14 consists of two terms the first term includes a previously derived equation eq 13 for vertical sluice gates without sills the second term involves four dimensionless parameters z g h 1 p r s g and r s h 1 in a powered nonlinear multiplication function in fact the second term reflects the effect of sill geometrics z p and r s on c d combination of these two terms with the multiplication operator allows for calculation of c d eq 14 shows that by increasing the sill wetted perimeter c d is reduced in fact increasing the sill wetted perimeter causes more water to come into contact with the sill surface which results in a greater loss of energy the loss of energy in turn reduces the discharge the analyses of variance anova for eq 14 is provided in table 2 the sum of squares metric from eq 14 is 65 665 and the residual is 0 025 low mean squares for regression and residuals indicate the robustness of the proposed equation for predicting c d in table 2 df in column 3 refers to degree of freedome the correlations between dependent variable c d and independent variables z g h 1 p r s g r s h 1 g and h 1 is presented in table 3 for free flow conditions the double star sign refers to a correlation that is significant at the 0 01 level 2 tailed a pearson correlation shows that all independent variables are significant for predicting c d table 3 shows that the most influential parameters for predicting c d are h 1 p z g r s g and r s h 1 respectively fig 10 indicates the comparison between the measured and the computed discharge coefficients and helps with the identification of acceptable matchs between the experimental and predicted values a bisector line y x is added to the figure blue line points closer to bisector line represent higher accuracy and therefore prediction ability the sill height is an important factor for determining c d values and values of c d decrease with increasing sill height as expected conversely as z increases c d increases in fig 11 it can be clearly seen that the developed equation predict c d values with suitable accuracy fig 11 presents variations of c d versus h 1 p for four different values of dimensionless parameter h 1 g fig 11 shows that by increasing h 1 p c d first decreases slightly and then increases a physical reason for this behavior is that at first with a slight decrease in p the flow lines approaching the gate suddenly converge and this phenomenon causes a slight decrease in c d with further decrease in p the energy loss is reduced which in turn increases c d on the other hand fig 11 indicates that with the increase of h 1 g c d also increases in other words increasing the upstream water depth or reducing the opening of the gate both cause an increase in c d these factors led to greater convergence of flow under the gate which in turn increases c d fig 12 indicates variations in c d versus the ratio of the sill hydraulic radius to the gate opening r s g for four values of the non dimensional factor h 1 g it is seen that by increasing r s g c d is first reduced and then later increases its decrease is caused by the increased flow resistance and the greater energy loss with increasing hydraulic radius and the increase is due to the convergence of the flow paths beyond the gate which increases the resistance to the flow the final value of c d for the gate with a sill is 0 78 and the final value for the gate without a sill is 0 61 fig 13 indicates variations in c d versus the ratio of the sill hydraulic radius to the upstream water depth which was measured on the sill r s h 1 for four values of the non dimensional factor z g the z g factor ranged from 0 5 to 2 for the circular sill it can be seen that by increasing r s h 1 c d decreases it appears that the convergence of the flow lines passing under the gate causes this phenomenon 5 conclusions estimation of c d is essential for discharge measurements in irrigaton canals this study uses a multiple nonlinear regression mnlr technique for predicting discharge coefficients c d in sluice gates equipped with sills in the present study 12 sills with different geometries have been tested under a vertical slide gate these shapes consisted of circular semicircular triangular trapezoidal and rounded faces with a triangular tail experiments were carried out at the university of tabriz iran and totaled 188 laboratory measurements the results of this study show that a sill positioned under a vertical gate had a positive effect on the flow it increased the values of c d the shape and height of the sill are important factors that can influence the value of c d the circular sill was the most effective shape and the triangular sill was more effective than other polyhedral shapes values of c d without a sill were compared with the results of the experiments done from five prior studies the mnlr model predictions of c d are reasonable with r2 0 882 and rmse 0 017 for the case of a sluice gate without a sill a general mnlr equation was derived for the two cases of sluice gates with and without sills with accuracy of r2 0 867 and rmse 0 042 the analyses of variance anova and correlations between dependent variable c d with independent variables showed that the most significant parameters affecting c d are h 1 p and z g r s g and r s h 1 respectively the suggested equation can be implemented for prediction of c d in sluice gates with and without sills to better than 6 error in subsequent studies more experiments could be carried out to increase the amount of data for obtaining correlation coefficients and reducing errors another suggestion would be investigating gates with submerge flows declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors ethical approval this article does not contain any studies with human participants or animals performed by any of the authors 
4651,gates in dams and irrigation canals are used for controlling discharge and for water regulation to determine the discharge under a gate the discharge coefficient c d must be quantified this study investigates the effect of sill shape under a vertical sluice gate on c d the study also includes the influence of height the investigated shapes are comprised of polyhedral and non polyhedral sills multiple nonlinear regression mnlr is applied to predict c d values and the results show that circular sills under the gate can increase c d by 23 31 a circular sill with a 3 cm diameter has the highest c d and trapezoidal sills have the lowest c d on the other hand semicircular sills have moderate values of c d the most influential parameters affecting c d are h 1 p and z g where h 1 is the upstream head over the sill crest p is the sill wetted perimeter z is the height of sill and g is the gate opening using dimensionless parameters and regression analysis an equation for predicting c d in free flow conditions with and without a sill is presented the equation agrees with previously published results and can be implemented for predicting c d in sluice gates with and without sills to within 6 accuracy keywords sluice gate discharge coefficient sill regression nomenclature a cross section of flow m2 b channel width m cd the gate discharge coefficient dimentionless cc gate contraction coefficient dimentionless df degree of freedom g the gate opening m g acceleration due to gravity m s2 h upstream water depth m h1 the upstream water depth is measured on the sill m p sill wetted perimeter m q the flow discharge m3 s q discharge per unit width of canal m2 s rn the reynolds number dimentionless rs sill hydraulic radius m re the relative error dimentionless r2 coefficient of determination dimentionless rmse root mean squared error in this study is dimentionless xioi the i th observed value of the discharge coefficient dimentionless yipi the i th predicted value of the discharge coefficient dimentionless n number of data dimentionless z height of sill m φ sill shape factor dimentionless ρ water density kg m3 μ water dynamic viscosity n s m2 1 introduction flood control structures are used to adjust water levels in water supply channels and to control water released from dams simons 1979 gates are one of the most important type of such structures due to the simple hydraulic equation that characterizes sluice gates these types of structures have been used extensively in many situtations alhamid 1999 there are multiple types of gates each having advantages and disadvantages the specific gate type can be selected according to the application weyer 2001 flow through sluice gates is divided into two types i free surface flow and ii submerged flow and the discharge coefficients for two categories are different gates have been extensively used in irrigation canals at the top of dam spillways and at exits from lakes to channels erdbrink 2014 erdbrink et al 2014 natural or artificial un erodible obstacles and a control point such as a diversion dam or a regulator gate can reduce and limit degradation in rivers khaleel and othman 1997 carried out a study on the effect of clear water released from a sluice gate fixed upstream of an alluvial laboratory channel fusegates are commonly utilized to increase reservoir capacity they maintain higher water levels upstream of spillways in a recent publication shahkarami 2020 studied an installation of a set of fusegates along the river base that provided a barrier for incident flow without the need for an extra flood mitigating structures various types of gates include underpass gates where water moves from under the gate and the discharge is controlled by the gate opening rate the most important and usable underflow gates are sluice and radial gates swamee 1992 estimating the flow discharge under a gate has been an essential problem in many water engineering projects belaud et al 2009 yousif et al 2019 however accurate estimation of flow requires knowledge of the discharge coefficient the nature of flow under gates have been theoretically and experimentally studied by many researchers with henderson 1966 ohtsu and yasuda 1994 rajaratnam 1977 rajaratnam and subramanya 1967 swamee 1992 as representative examples according to recent studies a sill under the gate can improve gate operation alhamid 1999 the benefits of a sill under a radial gate include the prevention of the effects of sediment on the operation of the gate the increase of c d and subsequently increass the flow under the gate in fact a sill under the gate reduces the height of the gates and decreases the force of the water pressure consequently the weight of the gate also decreases therefore the presence of a properly positioned and shaped sill is expected to improve the performance of a gate on the other hand installation of a sill in an unsuitable position under the sluice gate may cause negative effects on c d for example salmasi et al 2019 studied the effect of sill location on c d for radial gates they tested two cases i a sill located upstream of the gate and ii a sill located under the gate the results showed that when the radial gate is open and sills are positioned upstream gates case i the sill operates as a barrier and reduces c d but in case ii the sill location has a positive effect on c d negm et al 1995 investigated the characteristics of a free hydraulic jump downstream of silled sluice gates they studied the sequent depth the length and the energy loss ratios of the hydraulic jump downstream of the sluice gate the results showed that the under gate sill increases both the sequent depth and the length of hydraulic jump ratios and while it decreases the energy loss ratio compared to the case of no sill negative effect the first modern study on sluice gates was completed by rajaratnam and subramanya 1967 they concluded that the value of c d is directly related to the g h ratio and for g h 0 3 the value of c d can be calculated from eq 1 1 c d 0 0297 g h 0 589 where c d is the gate discharge coefficient g is the gate opening and h is the upstream water depth swamee 1992 presented eq 2 for a free surface flow from nonlinear regression using results from henry 1950 2 c d 0 611 h g h 15 g 0 071 swamee 1992 also referred to the inequality h 0 81y 2 y 2 g 0 72 for free flow under a sluice gate otherwise submerged flow would occur from under the sluice gate shivapur and shesha prakash 2005 conducted a laboratory investigation to determine c d for vertical and inclined gates they investigated four gate angles of values zero gate is perpendicular to the flow direction 15 30 and 45 degrees angles along the vertical and inclined to the upstream for greater accuracy in measuring the flow discharge a volumetric method was used the reservoir volume was 4 53 m3 the vertical gate causes flow convergence underneath it and the increased convergence can increase values of c d they presented eq 3 for determining the c d for free flow conditions with the gate angle in radians in the vertical direction α 3 c d 0 645 1 0 35 α 1 25 h g h 15 g 0 072 shivapur and shesha prakash 2005 also presented eq 4 to determine the c d for submerged flow with factors that are defined in fig 1 4 c d 0 645 1 0 152 α 0 7 h g h 15 g 0 072 0 9052 y 2 h 2 0 3781 y 2 h 0 8394 the c d for an inclined gate oriented 45 in the upstream direction was 25 88 higher than for the vertical gate with free flow this value was obtained for submerged flow conditions equal to 11 24 do amaral et al 2005 refered to the influence of water depth fluctuations in the main channel on discharge through sluice gates in irrigation channels they evaluated a flow regulator to reduce flow variations in the secondary channels which in turn causes water level variation in the main channels results showed that the flow control provided by the automatic flow regulator was more effective than that provided by the sluice gate in habibzadeh et al 2011 the energy loss between the gate upstream and contraction flow sections was determined for free flows the energy loss is caused by rotational flow upstream of the gate the effect of energy loss was deteremined by kv 2 2 2g in which k is the loss coefficient and v 2 is the velocity at the contraction flow section the results indicated that the energy loss coefficient k for the free flow was 0 062 and for the submerged flow it was about 0 088 nasehi and salmasi 2012 solved conservation equations for energy and momentum and they produced 5200 datapoints to determining values of c d for sluice gates two regression equations were obtained for flow in both free and submerged conditions the results indicated that the proposed method corresponded to the diagram proposed by henry 1950 in that study the contraction coefficient of the gate was assumed to be 0 61 khalili shayan and farhoudi 2013 examined the characteristics for free and submerged flows from sluice and radial gates by using energy and momentum equations they validated their calculations with experimental data quang et al 2019 used intermittent irrigation through the operation of irrigation pumps and sluice gates the goal was to mitigate the emissions of greenhouse gases from rice paddy fields in the red river delta vietnam in another study akbari et al 2019 used a gated piano key weir gpkw to predict discharge coefficients there slide gates were installed on piano key weirs pkw to increase water discharge ghosh et al 2014 referred to the formation of ponds by construction of river diversion barrages deposition of sediment in ponds due to the relatively low water velocities reduces the pond capacity they investigated the effectiveness of sluice gates following the removal of sediment mounds or shoals from the barrage pond a review of the previous studies shows that discharge coefficients for vertical sluice gates are available in chart fashion the most well known chart was generated in the work of henry 1950 a high level of non linearity in the hydraulic parameters motivates the use of charts instead of equations in cases where a sill is placed underneath the gate and as the complexity and non linearity increase geometric variables of the sill are also important parameters in addition to the parameters already mentioned thus the drawback of the classic methods for determining discharge coefficients is that charts require interpolation and can increase errors the present study was conducted using an experimental dataset for a vertical slide gate and with sills located under the vertical gates an appropriate shape of the sill for use with vertical sluice gates was sought fabricated sills are positioned underneath the vertical sluice gate one goal is the estimation of the effect of sill shape on the flow the experiments were conducted in a horizontal rectangular flume with free flow subsequently the performance of multiple nonlinear regression mnlr correlations are investigated for predicting c d values 2 theoretical analysis fig 1 indicates the longitudinal cross section of a vertical sluice gate with a circular sill under free flow conditions considering fig 1 and its combination with energy conservation eqs 5 and 6 are obtained henderson 1966 5 q c d g 2 g h z 6 c d c c 1 c c g h z where q is the discharge per unit width of the canal c d is the gate discharge coefficient g is the gate opening g is the acceleration due to gravity h is the upstream water depth z is the sill height and c c is the gate contraction coefficient the ratio of water depth downstream of the sluice gate y 1 to the gate opening g is defined as c c the minimum depth y 1 that occurs downstream of a sluice gate is known as the vena contracta rajaratnam and subramanya 1967 noted that the vena contracta occurs at a distance of about 1 15 times the gate opening g typically c c 0 611 is used for practical design purposes and this value has sufficient precision for many applications henderson 1966 more recently habibzadeh et al 2011 assigned the value of 0 611 for c c to investigate the role of energy loss in hydraulics of sluice gates so that this value has seen continued usage it is worth noting that in laboratory experiments measurement of the discharge can be done with high accuracy there is no need for assuming c c in fact with eq 5 c d can calculated directly and without knowledge of c c for submerged flows eqs 5 and 6 can also be used and c d will depend on g y 2 and g h here y 2 is the downstream flow depth for free flow conditions y 2 has little or no effect on discharge so c d is solely a function of g h henry 1950 presented the values of c d for free and submerged flows in a non dimensional graph in that study the sluice gate did not include a sill under the gate 3 materials and methods 3 1 experimental setup experiments were carried out in the hydraulic labrotary at the university of tabriz in iran the present study utilized experimental data obtained in a flume with plexiglas walls that allow visual inspection of the flow the flume length is 10 m and the width is 0 35 m the flume depth is 1 5 m at upstream locations and the depth reduces to 0 9 m downstream there are two controlling gates installed in the flume including the vertical gate one gate is in the studied section and the other is at the end of the flume flow was generated using a pump with a maximum capacity of 50 l s the discharge was measured by a calibrated triangular weir flow depths were measured with a point gauge with a precision of 0 1 mm fig 2 illustrates the experimental flume laboratory set up including the water reservoir head tank underground reservoir and a triangular weir to measure the discharge fig 3 shows the flow under the vertical sluice gate under supercritical conditions the sills were made of waterproof wood and covered with a thin layer of laminated oil to maintain their shape as indicated in fig 3 sills in the bed were fixed in a way that their crest was under the gate nine of these sills were 5 cm high and circle sills were 2 35 3 3 and 8 cm in height different flow discharges were considered that ranged from 10 to 50 l s for the four gate openings g twelve different sills were studied the cross section of these sills have five different shapes triangular trapezoidal circular semicircular and round faced these sill shapes are illustrated in fig 4 with their dimensional nomenclature to calculate c d eq 5 which was a simplified form of the energy equation was used fig 1 as indicated earlier and as will be discussed shortly the effects of the shape and the height of the sills were investigated 3 2 dimensional analysis of cd for the investigated sluice gates for free flow under sluice gates dimensionless analysis reveals that c d is a function of the following parameters 7 f 1 ρ q b g μ h z g 0 where ρ is the density of water q is the flow discharge b is the width of the canal flume g is acceleration due to gravity μ represents the dynamic viscosity of water h is the upstream water depth z is the height of the sill g is the gate opening and φ is the sill shape factor that is related to the sill wetted perimeter p and to the sill hydraulic radius r s as expressed eq 8 8 f 2 r s p the hydraulic radius of the sill is defined by r s a p where a is the cross sectional area of the flow and p is its wetted perimeter according to the buckingham pi theorem c d for free flow under the sluice gate is related to input parameters as shown in the following 9 f 3 h 1 p z g r s g r s h 1 c d q g 2 g h 1 r n ρqq μ h 1 0 in eq 9 h 1 is the upstream water depth measured on the sill h 1 h z r n is the reynolds number and its effect is neglected for the highly turbulent flow that occurs under the gate with some simplification and by neglecting reynolds number effects eq 10 is obtained 10 c d f 4 h 1 p z g r s g r s h 1 the main advantage of using dimensionless parameters is to reduce the number of variables in the analysis in hydraulic experiments it is a common practice to use dimensionless parameters because it decreases the number of tests another advantage of dimensional analysis is that it enables the results to be generalized to other situations as noted previously this study was conducted for four gate openings g four dimensionless parameters z g h 1 p r s g and r s h 1 are used for estimaton of c d thus by variation of z p g and r s a total of 188 datapoints were made available which was adequate for this type of hydraulic study 3 3 statistical measures the performance criteria include the coefficient of correlation r2 and the root mean square error rmse the statistical measures are represented by eqs 11 and 12 akbari et al 2019 coefficient of determination r2 11 r 2 n x i y i x i y i n x i 2 x i 2 n y i 2 y i 2 2 root mean squared error rmse 12 rmse i 1 n x i y i 2 n where x i and y i are the i th observed and predicted values of the discharge coefficient respectively and n is the total number of data in this study the dependent parameter is c d and the independent parameters are z g h 1 p r s g and r s h 1 statistical characteristics of these dimensionless parameters are provided in table 1 4 results and discussion as previously mentioned four circular sills with diameters of 2 35 cm sill 1 3 3 cm sill 2 5 cm sill 3 and 8 cm sill 4 were tested fig 5 shows that the sill height is an important factor that affects c d the gate with a sill had a coefficient of discharge greater than for the gate without a sill also when the sill height rises c d first increases until it reaches a maximum value and thereafter it decreases a 5 cm sill height for the circular shape provided the highest discharge coefficient fig 5 indicates that by decreasing the gate opening g the discharge coefficient increases by reducing the opening of the gate the flow through the gate experiences greater convergence and with increasing velocity the hydrostatic pressure is reduced consequently the pressure becomes less than γ w h 1 where γ w is the specific gravity of the water the reduction in water pressure and water suction increases c d rajaratnam and humphries 1982 indicated that the pressure decrease due to the gate installation is created at a location 5g from the upstream of the gate use of a circular sill with 5 cm diameter sill no 3 increases the discharge coefficient by 23 31 the asymptotic value of c d is 0 77 as h z g continues to increase 4 1 polyhedron sill by fixing the downstream slope of a polyhedral sill to 1 5 vertical to horizontal the effect of upstream slope can be investigated three triangular sills with upstream slopes of 1 v 0h 1 v 1h and 1 v 2h were utilized in fig 6 the variation of c d is presented against the non dimensional parameter h z g the figure indicates that especially for h z g values below 8 the effect of the upstream slope is large but for larger values of this ratio the effect of the slope is minimal an upstream slope of 1 v 2h was found to be optimal because it provides maximum c d sill 7 the hydraulic reason for this is that for a lower upstream slope the flow lines adjacent to the gate slowly change the direction and more gradual change reduces energy loss by fixing the sill upstream slope to 1 v 1h the effect of the sill downstream slope was tested three trapezoidal sills with downstream slopes of 1 v 0h 1 v 3h and 1 v 5h were used fig 7 indicates that the downstream slope has a positive effect on c d and among trapezoidal sills the downstream slope of 1 v 3h had the greatest effect on c d sill no 9 here a more gradual downstream slope causes the flow lines emerging from the gate to slowly change direction which reduces the energy loss but for the downstream slope of 1 v 5h as the slope decreases the length of the slope increases with a steep face the energy loss increases 4 2 non polyhedron sills fig 8 indicates the effect of a non polyhedron sill on c d the results are represented for three different sills with a height of 5 cm fig 8 shows that a circular sill sill no 3 had the largest c d compared to the other cases a circle sill with a 5 cm diameter resulted in a modest increase of about 28 6 compared to non sill c d values the semicircular sill sill 11 resulted in a moderate increase of 19 compared to the non sill c d value in addition the rounded face sill with a triangular tail section sill 12 resulted in a minimal increase of 12 5 in the c d value 4 3 development of multiple non linear regression mnlr equations 4 3 1 gates without sills in fig 9 c d values for gates without a sill from the present study are compared with the results of the experiments from five other studies including rajaratnam and subramanya 1967 rajaratnam 1977 negm et al 1995 swamee 1992 and shivapur and shesha prakash 2005 the coefficients of eq 2 were evaluated based on the present data and eq 13 was used to estimate c d for vertical sluice gates without sills and with free flow condition 13 c d 0 63 h g h 15 g 0 067 eq 13 corresponds to the available data from the other studies in fig 9 and predicts the c d value to within a maximum error of 5 the accuracy criteria for derivation of eq 13 are r2 0 882 and rmse 0 017 4 3 2 gates with sills for the polyhedral sill sill 12 the downstream slope and the shape of the crest were the main shape parameters a form factor based on the the wetted perimeter p and hydraulic radius r s a p was utilized a is the sill cross section area using nonlinear regression analysis eq 14 was obtained 14 c d 0 63 h 1 g h 1 15 g 0 067 1 z g 0 366 1 h 1 p 0 045 1 r s g 0 523 1 r s h 1 0 413 eq 14 can be used for gates with or without a sill and for free flow conditions the statistical measures used to characterize eq 14 are r2 0 867 and rmse 0 042 the range of validity for eq 14 is 0 0 h 1 p 16 3 0 0 r s g 0 13 0 0 z g 0 4 and 0 0 r s h 1 0 04 with eq 14 c d can be predicted with a maximum error 6 for gates without a sill z is zero p is infinite and h 1 is equal to h under these circumstances eq 14 can be transformed to eq 13 the regression technique has been used to obtain the coefficients and powers of eq 14 in the present study the spss software version 22 was used it is also worth noting that the power of 0 071 in swamee 1992 s equation was changed to 0 067 swamee 1992 obtained eq 4 from the experimental results of henry 1950 for a gate without a sill and under free flow conditions eq 14 can be used as a replacement of the equation obtained by swamee 1992 it can also be used both for gates with and without sills eq 14 consists of two terms the first term includes a previously derived equation eq 13 for vertical sluice gates without sills the second term involves four dimensionless parameters z g h 1 p r s g and r s h 1 in a powered nonlinear multiplication function in fact the second term reflects the effect of sill geometrics z p and r s on c d combination of these two terms with the multiplication operator allows for calculation of c d eq 14 shows that by increasing the sill wetted perimeter c d is reduced in fact increasing the sill wetted perimeter causes more water to come into contact with the sill surface which results in a greater loss of energy the loss of energy in turn reduces the discharge the analyses of variance anova for eq 14 is provided in table 2 the sum of squares metric from eq 14 is 65 665 and the residual is 0 025 low mean squares for regression and residuals indicate the robustness of the proposed equation for predicting c d in table 2 df in column 3 refers to degree of freedome the correlations between dependent variable c d and independent variables z g h 1 p r s g r s h 1 g and h 1 is presented in table 3 for free flow conditions the double star sign refers to a correlation that is significant at the 0 01 level 2 tailed a pearson correlation shows that all independent variables are significant for predicting c d table 3 shows that the most influential parameters for predicting c d are h 1 p z g r s g and r s h 1 respectively fig 10 indicates the comparison between the measured and the computed discharge coefficients and helps with the identification of acceptable matchs between the experimental and predicted values a bisector line y x is added to the figure blue line points closer to bisector line represent higher accuracy and therefore prediction ability the sill height is an important factor for determining c d values and values of c d decrease with increasing sill height as expected conversely as z increases c d increases in fig 11 it can be clearly seen that the developed equation predict c d values with suitable accuracy fig 11 presents variations of c d versus h 1 p for four different values of dimensionless parameter h 1 g fig 11 shows that by increasing h 1 p c d first decreases slightly and then increases a physical reason for this behavior is that at first with a slight decrease in p the flow lines approaching the gate suddenly converge and this phenomenon causes a slight decrease in c d with further decrease in p the energy loss is reduced which in turn increases c d on the other hand fig 11 indicates that with the increase of h 1 g c d also increases in other words increasing the upstream water depth or reducing the opening of the gate both cause an increase in c d these factors led to greater convergence of flow under the gate which in turn increases c d fig 12 indicates variations in c d versus the ratio of the sill hydraulic radius to the gate opening r s g for four values of the non dimensional factor h 1 g it is seen that by increasing r s g c d is first reduced and then later increases its decrease is caused by the increased flow resistance and the greater energy loss with increasing hydraulic radius and the increase is due to the convergence of the flow paths beyond the gate which increases the resistance to the flow the final value of c d for the gate with a sill is 0 78 and the final value for the gate without a sill is 0 61 fig 13 indicates variations in c d versus the ratio of the sill hydraulic radius to the upstream water depth which was measured on the sill r s h 1 for four values of the non dimensional factor z g the z g factor ranged from 0 5 to 2 for the circular sill it can be seen that by increasing r s h 1 c d decreases it appears that the convergence of the flow lines passing under the gate causes this phenomenon 5 conclusions estimation of c d is essential for discharge measurements in irrigaton canals this study uses a multiple nonlinear regression mnlr technique for predicting discharge coefficients c d in sluice gates equipped with sills in the present study 12 sills with different geometries have been tested under a vertical slide gate these shapes consisted of circular semicircular triangular trapezoidal and rounded faces with a triangular tail experiments were carried out at the university of tabriz iran and totaled 188 laboratory measurements the results of this study show that a sill positioned under a vertical gate had a positive effect on the flow it increased the values of c d the shape and height of the sill are important factors that can influence the value of c d the circular sill was the most effective shape and the triangular sill was more effective than other polyhedral shapes values of c d without a sill were compared with the results of the experiments done from five prior studies the mnlr model predictions of c d are reasonable with r2 0 882 and rmse 0 017 for the case of a sluice gate without a sill a general mnlr equation was derived for the two cases of sluice gates with and without sills with accuracy of r2 0 867 and rmse 0 042 the analyses of variance anova and correlations between dependent variable c d with independent variables showed that the most significant parameters affecting c d are h 1 p and z g r s g and r s h 1 respectively the suggested equation can be implemented for prediction of c d in sluice gates with and without sills to better than 6 error in subsequent studies more experiments could be carried out to increase the amount of data for obtaining correlation coefficients and reducing errors another suggestion would be investigating gates with submerge flows declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors ethical approval this article does not contain any studies with human participants or animals performed by any of the authors 
4652,a new finite analytic method fam was proposed to obtain a stable and accurate solution of highly nonlinear richards equation re for simulating flow through heterogeneous soils while the exponent hydraulic conductivity function gardner model was used to linearize re the variable has dyadic characteristics at the interface node between two different soil materials to overcome the dyadic characteristics at the interface node we derived a formula of fam based on the conversations of mass and energy at the interface node this new formula does not require additional iteration steps besides the proposed method is easy for coding and takes advantage of the strengths in mixed form re through three numerical experiments fam was compared to analytical solutions and modified picard finite different method mpfd to evaluate its accuracy and efficiency our results indicated that the proposed method could obtain highly accurate and stable numerical solutions and reduce the mass balance errors significantly also fam is less sensitive to the grid size compared to mpfd keywords finite analytic method layered soils analytical solution modified picard finite different method 1 introduction due to the nonlinearity of parameters and the mathematical characteristics of the nonlinear richards equation there are many difficulties encountered in solving the nonlinear re suk and park 2019 zha et al 2019 in addition to deformation induced by soil moisture movement in the vadose zone schrefler and xiaoyong 1993 loret and khalili 2000 sheng et al 2003 khoshghalb and khalili 2013 solving the richards equation re has been a topic of interest for nearly half a century celia et al 1987 li et al 2016 pan and wierenga 1995 suk and park 2019 generally re has three forms according to the types of variables celia et al 1990 the pressure head form h based the water content form θ based and the mixed form advantages of the θ based re arise from the fact that the relationship between hydraulic diffusivity d θ and water content generally is less nonlinear than that between hydraulic conductivity k θ and water content the θ based re also yields good mass conservation even using coarse grids zha et al 2013b moreover it is quite suitable for handling infiltration into an initially dry soil brunone et al 2003 the mixed form re combines the advantages of h based and θ based re while circumventing difficulties associated with the h based and θ based re approaches zhang et al 2016 for this reason the θ based and mixed form re have been frequently used for simulating water flow in uniform soils where water content is continuous throughout the soil nevertheless soils are rarely uniform over multiple length scales and layered soils are ubiquitous farthing and ogden 2017 in layered soils the water content is discontinuous across the soil materials with different unsaturated hydraulic properties assouline 2013 to retain the advantages of the θ based re form for simulating flow in layered soils a so called primary variable switching approach was developed to resolve the water content discontinuity across the soil materials interface brunner and simmons 2012 krabbenhøft 2007 likewise hills et al 1989 developed a model based on one dimensional θ based re for unsaturated flow into layered soils they found that this situation created a spurious flux schaudt and morrill 2002 combined the method by romano et al 1998 with the inherent numerical efficiency of the θ based re they reported that the approach could not guarantee the global mass conservation when a wetting front reaches a heterogeneous interface under heavy infiltration condition the θ based re for layered soils using the method of lines mol was proposed by matthews et al 2004 and matthews et al 2006 they found that mol may introduce significant errors in the storage term due to the supposition of flux continuity at the interface recently zeng et al 2018 developed a generalized switching method which combines the advantages of h based and θ based re using a semi implicit flux estimation algorithm generally all these algorithms for θ based re lead to non smooth transition between the two primary variables which cause the solution far from the true solution krabbenhøft 2007 zha et al 2017 this is likely to attribute to the fact that moisture gradient in the θ based re does not represent the energy gradient which drives water flowing through heterogeneous media yeh et al 2015 p 157 158 consequently the h based re has been widely adopted for simulating water flow in multiple soil layers celia et al 1990 romano et al 1998 simunek et al 2006 numerical schemes for solving h based re however often yield severely global mass balance errors allen and murphy 1986 celia et al 1987 milly 1984 van genuchten 1982 these errors are owing to the numerical evaluation of the capacity term c h milly 1984 especially for infiltration in relatively dry soils to overcome this problem rathfelder and abriola 1994 suggested the use of the standard chord slope approximation of capacity term c h to obtain good mass balance later romano et al 1998 developed an algorithm based on h based re yielding results close to the analytical solution and with right mass balance brunone et al 2003 further investigated the performance of the model developed by romano et al 1998 besides gastó et al 2002 and schymanski et al 2008 found that the geometric averaging of conductivities in their model could lead to large errors especially for simulating infiltration in dry sand for overcoming the highly nonlinear nature of re many transformation techniques have also been used chen and dai 2016 for instance ross 1990 proposed a hyperbolic sine function of pressure head to simulate water flow in the vadose zone this approach requires a parameter β to be determined a priori which is difficult to estimate as it is a function of medium and simulation variables williams et al 2000 kirchhoff transformation is another viable method bakker and nieber 2004 ji et al 2008 ross and bristow 1990 suk and park 2019 zhang et al 2015 2018 2016 the kirchhoff transformation has some advantages over others since the transform of the pressure head permits large grid sizes while maintaining acceptable accuracy even in dry soil conditions ross and bristow 1990 however such a transformation could cause undesirable discontinuity for the transformed variable at the interface between different soil materials this discontinuity often creates difficulties for numerical solutions zha et al 2019 and leads to incorrect flux when heterogeneity is present zha et al 2013a besides it may lead to convergence problems due to slope discontinuities at the wet end of k h function as a result ross 1990 reduced these problems by removing the discontinuity in the θ h function more recently ji et al 2008 used the kirchhoff transformation and a complementary function to separate the nonlinear hyperbolic characteristic from the linear parabolic part of re they reported that the kirchhoff transform could lead to satisfactory results nevertheless they only considered the discontinuity in saturated hydraulic conductivity values ks in layered soils under steady state infiltration likewise suk and park 2019 developed a method which avoids the dyadic characteristics of kirchhoff transformation at the soil material interfaces their results showed that the proposed method was computationally efficient accurate and robust overall the re is one of the difficult equations to be solved reliably and accurately in the field of hydrosciences due to its highly nonlinear nature farthing and ogden 2017 as a result efficient methods to solve re remain to be found zha et al 2019 the finite analytic method fam chen and chen 1984 was originally applied in groundwater flow by hwang et al 1985 for a two dimensional groundwater solute transport problem the advantage of fam is that it incorporates local approximate analytic solutions of a linear or linearized differential equation into the finite difference or finite element formulation with this approach fam obtains more accurate and stable numerical solution than the conventional numerical methods over the same local grids civan 1995 zeng and li 1987 despite its advantages the application of fam to unsaturated flow problems requires the linearization of the re e g tsai et al 1993 while the method applies well to two dimensional transient unsaturated flow in layered soils tsai et al 1993 reported that the method does not guarantee mass conservation consequently they suggested that fam should be extended to solve mixed form re for mass conservation zhang et al 2016 were the first who applied fam to solve the mixed form re recently suk and park 2019 reported that fam is accurate and successfully compared with other numerical methods however until now fam has only been applied to flow in homogeneous or layered soils with different ks zhang et al 2015 2018 2016 albeit variability of ks plays an important role in flow through unsaturated media the variability of the rate of change of k h i e α of gardner s model see eq 2 has been found to have profound impacts on unsaturated flow and solute transport khaleel et al 2002 yeh et al 1985a 1985b 1985c yeh 1989 in addition the sudden change in α between layered soils leads to a drastic change in k h and poses a great challenge to numerical solution techniques this numerical issue has rarely been explored by previous investigations this study proposes a new fam which can effectively handle the discontinuity of ks s and αs across the boundary between different soils for simulating water flow in layered soils in this paper a detailed description of the approach to handle the discontinuity of the transformed variable by using fam is provided afterward the results of fam are compared with those of analytical solutions by srivastava and yeh 1991 and the solutions from the widely used modified picard finite difference method mpfd celia et al 1990 during transient infiltration in soils with the discontinuity in ks then the results of fam and mpfd are compared with the analytical solutions by yeh 1989 for steady state infiltration in soils with discontinuity in both ks and α lastly we evaluate the results of fam for transient infiltration into three layered soils with discontinuity in ks s and αs with those by mpfd 2 description of the model the water flow in the unsaturated zone in a one dimensional domain can be described by the re celia et al 1990 1 θ t z k h h z k h z where h cm is the pressure head k h cm h is the unsaturated hydraulic conductivity of the soil z cm denotes the vertical dimension where the upward direction is positive θ cm3 cm3 is the soil moisture content t h represents time the hydraulic conductivity is described by the gardner model gardner 1958 2 k h k s e x p α g h in which k s cm h is the saturated hydraulic conductivity α g 1 cm is a soil index parameter related to the pore size distribution two types of constitutive mathematical models were applied for describing the soil water characteristic curve one is the gardner model gardner 1958 hereafter type 1 model in which 3 θ θ r θ s θ r e x p α g h where θ s cm3 cm3 and θ r cm3 cm3 represent the saturated and residual soil moisture content respectively the other one is the van genuchten model van genuchten 1980 which is called the type 2 model 4 θ h θ s θ r 1 α vg h n m θ r in which m 1 1 n and n are dimensionless parameters and α vg 1 cm is related to the inverse of the air entry suction 2 1 numerical implementation of fam using the hydraulic conductivity in eq 2 the eq 1 can be written as srivastava and yeh 1991 5 2 u z 2 α g u z α g θ k u t where u e x p α g h then adopting the type 1 model for the soil water characteristic curve one can derive 6 θ u θ s θ r k s likewise using the type 2 model for the soil water characteristic curve the following relationship can be derived 7 θ u α vg m n θ s θ r α vg α g l o g u n 1 α g u 1 α vg α g l o g u n m 1 as a consequence eq 5 can be expressed as 8 2 u z 2 2 b u z f where 9 b 0 5 α g 10 f α g θ u u n 1 u n δ t eq 8 can be solved analytically in a small element with the boundary and initial conditions u z 0 exp α g h z 0 are determined as 11 u z t b 1 b 2 exp 2 b z f 2 b z 12 u δ z t b 1 b 2 exp 2 b δ z f 2 b δ z 13 u δ z t b 1 b 2 exp 2 b δ z f 2 b δ z in which the coefficients of b 1 and b 2 in eqs 11 to 13 could be found in terms of nodal values at the element boundaries based on zhang et al 2015 2016 we can obtain the analytic solution for nodal point i an algebraic equation giving the nodal value k i n 1 14 u i n 1 a i u i 1 n 1 c i u i 1 n 1 r i b i where 15 a i 1 t h b δ z 16 b i 2 α g x δ t d θ du 17 c i 1 t h b δ z 18 r i α g x u i n δ t 19 x δ z t h b δ z b and th is the hyperbolic tangent function 2 2 algorithm for simulating water movement in layered soils in this section we illustrate how to handle the discontinuity of u variable first we focus on node i fig 1 which is at the interface between soil j and soil j 1 the sudden change in soil hydraulic properties α g at the interface between different layers j and j 1 results in a discontinuity in the variable of u while the variable u is discontinuous between the interface the pressure head is continuous at the interface besides the fluxes across the interface between different soils must be equal according to the principle of mass conservation 20 h i h i 21 q i q i where the superscript and indicate one side and the other side of the interface application of eq 2 to eq 20 eq 20 can be written 22 1 α g ln α g u i 1 α g ln α g u i based on bakker and nieber 2004 this equation may be written as 23 ln α g u i ln α g u i v ln α g u i in which v α g α g 1 taking the exponent of both sides of eq 23 gives 24 u i α g α g α g u i v u i eq 21 can be written as 25 k s u z i α g k s u i k s u z i α g k s u i based on eq 18 and 19 in zhang et al 2015 eq 25 can be written as 26 k s 2 δ z u i 2 4 u i 1 3 u i α g k s u i k s 2 δ z u i 2 u i 1 3 u i α g k s u i application of eq 24 to eq 26 eq 26 can be written 27 u i 4 w 1 u i 1 w 1 u i 2 4 w 2 u i 1 w 2 u i 2 2 w 2 w 4 3 w 1 w 3 w 5 where w 1 k s 2 δ z w 2 k s 2 δ z w 3 α g k s w 4 α g k s and w 5 α g α g α g u i v it should be noted that the nodes i 1 and i 1 in the neighborhood of the material interface the formulas of the grids i 1 and i 1 are as follow 28 u i 1 n 1 a i u i n 1 c i u i 2 n 1 r i b i 29 u i 1 n 1 a i u i 2 n 1 c i u i n 1 r i b i where ai bi ci and ri are defined in eqs 15 18 the set of algebraic eqs 14 27 28 and 29 are solved with associated boundary conditions by using sor iterative method zhang et al 2015 3 numerical examples we assessed the usefulness of fam using three numerical experiments i e case 1 case 2 and case 3 fig 2 in case 1 the results of the experiments were compared with the analytical solution by srivastava and yeh 1991 who presented an analytical solution for wetting scenarios in two layered soils this analytical solution has been widely adopted for testing numerical methods ji et al 2008 matthews et al 2004 suk and park 2019 in addition we compared fam s performance with those by mpfd celia et al 1990 in this case we consider a one dimensional vertical infiltration in a column with two soil layers where each layer had a thickness of 100 cm the upper boundary was set equal to the rate of 0 9 cm h and the lower boundary was a constant pressure head 0 cm i e the water table α g s of the two soil layers were set to be 0 1 1 cm but the saturated hydraulic conductivities ks of the upper and lower layers were 1 and 10 cm h respectively the saturated soil moisture content θ s was 0 4 cm3 cm3 and residual soil moisture content θ r was 0 06 cm3 cm3 they were assumed to be the same for the two soil layers the initial condition was obtained from the analytical solution for an infiltration rate equal to 0 1 cm h at the top boundary two different spatial discretizations were considered one was 200 elements of 1 cm in length another was 40 elements of 5 cm in length we used an adaptive time stepping approach in fam and mpfd the parameters are listed in table 1 in case 2 we tested fam for simulating the flow in three layered soils with different ks and α g in this case we used the analytical solution by yeh 1989 which considers steady state flow through multi layered soils with different ks and α g we then compared the performance of fam with those by mpfd celia et al 1990 finally we evaluated the solution from fam with the solution from mpfd for transient flow in the three layered soils with different ks s and α g s in case 3 in case 3 there is no analytical solution available for comparison in cases 1 and 2 where analytical solutions are available we used three criteria to evaluate the numerical performance of fam first the local error is calculated 30 ξ z t 1 h z t numerical h z t analytical 100 in which h z t numerical is the result of fam or mpfd respectively h z t analytical denotes the analytical solutions from yeh 1989 or srivastava and yeh 1991 the second is the mass balance error which can be carried out in the profile as follows 31 δ t 1 m t m 0 numerical m t m 0 analytical 100 in which m t and m 0 are the initial mass and the mass at a time t in the flow domain respectively the last one is the root mean squared error 32 l 2 h 1 n i 1 n 1 δ z i 2 h analytical z i t h numerical z i t d z 2 where i 1 2 n is the node number 4 results case 1 comparison with those by fam mpfd and analytical solution by srivastava and yeh 1991 few analytical solutions to re for layered soil profiles are available except for works by aylor and parlange 1973 warrick 1991 and srivastava and yeh 1991 the solutions by aylor and parlange 1973 and warrick 1991 were developed for specialized hydraulic parameter functions not commonly used in numerical models the solution by srivastava and yeh 1991 used the type 1 functions widely used in the numerical models this case involves vertical infiltration towards the water table through a two layered soil system consisting of two homogeneous layers the thickness of each layer is 100 cm with the residual water content the saturated water content and α taken as 0 06 cm3 cm3 0 4 cm3 cm3 and 0 1 1 cm respectively table 1 the lower and upper layers of the saturated hydraulic conductivities are equal to 10 and 1 cm h respectively the boundary condition at the soil surface is a constant flux and the steady state infiltration profile at a flow rate equal to 0 1 cm h is taken as the initial pressure head profile srivastava and yeh 1991 then the boundary condition at the soil surface is a constant infiltration rate 0 9 cm h two grid sizes 1 and 5 cm were employed and an adaptive time step was used in the simulation simulated pressure head profiles by fam and the analytical solution at 1 5 10 20 and 100 h are presented in fig 3 a for the grid size 1 cm and fig 3b for the grid size 5 cm both figures show that the solutions from fam are in good agreement with those from analytical solutions fam however yields some errors near the wetting front at the initial stage when the grid size is equal to 5 cm distribution of ξ z t local error eq 30 vs z for the fam using a fine grid size 1 cm is exhibited in fig 4 a it shows that fam yields excellent numerical results overall the absolute of the local error is smaller than 0 4 fig 4a the largest error occurred at the initial infiltration process and the error decreases with the time similarly when the coarse grid size 5 cm was used fam produced an absolute of local error of less than 6 fig 4b notice that close to the layer interface fam slightly overestimates the analytical solutions in the upper soil layer and it underestimates in the lower soil layer in both spatial sizes the ξ z t at the layer interface for fam gradually increases to a maximum of about 0 15 when the grid size equal to 1 cm as compared with 2 2 for the grid size equal to 5 cm the simulated head profiles by mpfd are also compared with those of the analytical solution the local errors of mpfd associated with 1 cm and 5 cm grid sizes are depicted in fig 4c and 4d respectively revealing that the largest local error equaled to 7 0 is larger than that fam 0 4 when the grid size is 1 cm the local error ξ z t of mpfd at the layer interface grows with time and it stabilizes to 3 3 which is larger than that fam when mpfd used the coarse grid size the error becomes even larger the absolute value of ξ z t reaches the maximum value of 22 near the surface ground at the initial infiltration process besides the error at the layer interface eventually became large and the maximum error exceeds 15 these results manifest that mpfd is sensitive to coarse grid size and leads to significant errors especially at the layer interface the proposed algorithm can obtain a more accurate solution than mpfd especially at the interface when coarse grids are used the l 2 h in fig 5 demonstrates that the l 2 h for fam are smaller than that for the mpfd similar tendencies were found in computational cost indicated by the number of iterations shown in fig 6 the mass balance error δ t for transient flow into the two layer soil system is shown in fig 7 notice that the δ t s of fam using both grid sizes are almost identical after 10 h with a peak value of about 1 3 when the grid size equal to 1 cm the δ t of mpfd reduces as time increases however when the grid size equals to 5 cm there was a maximum mass balance error at an early stage of the infiltration process the maximum error reaches 15 and then it reduces it should be noted that the error associated with mpfd is highly dependent on the grid size in other words the mass balance error level associated with mpfd is higher than those of fam for the most part of the simulation time case 2 comparison with those by fam mpfd and analytical solution by yeh 1989 case 2 considers one dimensional unsaturated flow in a heterogeneous layered soil column which consists of three layers the thicknesses are 50 50 and 100 cm from lower to the upper layers respectively the lower boundary condition is the fixed pressure head 0 cm i e the water table the top boundary condition is the fixed flux 0 1 cm h the spatial step is adopted for 1 cm the α g 1 cm of the upper middle and lower layers are set to 0 1 0 2 and 0 1 respectively the parameters are displayed in table 1 since the analytical solution for the transient flow is not available in this case we compared the results of fam and mpfd with those of a steady state analytical solution by yeh 1989 the analytical solution was derived for one dimensional steady state vertical infiltration in unsaturated soils hydraulic conductivity and pressure head relationship was assumed to be described by type 1 model then the analytical solution is as following 33 h 1 α l n e x p α z h 0 q k s exp α z q k s where z is the elevation cm h 0 is the specified head at z 0 cm and q is the flux at the surface cm h eq 33 is valid only if 34 0 exp α z h 0 q k s exp α z q k s 1 the analytical solution can be applied to layered soils with different ks s and αs that is with given soil parameters of the bottom layer and the h 0 at z 0 eq 33 can determine the pressure head at the interface between this layer and the overlying layer then because the flow is steady and 1 d the pressure head and flux in the lower layer must equal those in the upper layer at the interface the distribution of the pressure head in the overlying layer can be determined using eq 33 and the pressure head at the interface as the prescribed head h 0 in eq 33 for determining the pressure head profile in the overlying layer the same principle can be applied to additional layers therefore we can easily obtain the pressure head distribution in any number of soil layers the pressure head distributions over depth from the analytical solution and fam are shown in fig 8 a which shows that the pressure head profiles of fam are in excellent agreement with those obtained from the analytical solution thus the proposed method could effectively handle the discontinuous α g at the layer interface mpfd was also used to simulate the pressure head profile for case 2 a plot of local error between the solutions of fam and mpfd over the 200 cm profile with three soil layers are in fig 8b this plot indicates that fam solutions are in excellent agreement with the analytical solution with a local error being the order of 100 with a peak of error 1 at the layer interface on the other hand mpfd yields an error larger than 4 0 the root mean square error of fam is 0 12 but mpfd yields the root mean square error larger than 0 3 the mass balance error for mpfd is 0 13 the value of mass balance error for fam is 0 08 these results confirm that the numerical performance of fam is better than mpfd case 3 transient unsaturated flow in a three layered soil the parameters for this case 3 are displayed in table 1 the bottom boundary was the specified head equal to 0 cm and the top boundary was a prescribed flux of 0 1 cm h the initial condition was 50 cm along the soil column analytical solutions are not available for calculating pressure head profiles in this case to compare the results of fam for this reason we compare the results of fam to the results of mpfd fam selected grid size equal to 1 cm mpfd used a relatively smaller grid size 0 5 cm to simulate water flow in the soil column the choice of 0 5 cm to ensure its accuracy as demonstrated previously the resulting pressure heads of the mpfd are displayed in fig 9 along with those of fam at 1 5 10 and 50 h according to the figure the results from fam could not be visibly distinguished from the mpfd this result indicates that the numerical results from fam are reasonably well matched with the mpfd that is the proposed method could effectively handle the discontinuous soil parameters such as k s and α g for transient flow 5 discussion as depicted in figs 4 and 7 the local and mass balance errors for the proposed fam are consistently lower than those of the mpfd in particular the results in fig 4 reveal that fam solutions agree with the analytical values near the layer interface even when the grid size is equal to 5 cm on one hand this outcome is attributed to the fact that the gravity term is in the analytical solution embedded in eq 8 zhang et al 2016 on the other hand the errors of fam mostly occur at the initial infiltration stage these errors reflect the fact that using the first order finite difference approach to time derivative in eq 10 may introduce errors especially for the situation with a large peclect number tsai et al 2005 furthermore mpfd results deviate significantly from analytical values near the interface between different soils the fact that mpfd uses a backward difference scheme to calculate the term k z and an averaging scheme for evaluating the parameter k i is likely the cause these aforementioned factors apparently lead to large error or even divergence when hydraulic conductivities change rapidly thus selected averaging scheme for determining the parameter k i can influence the accuracy of the solution from mpfd for the entire computational domain especially for layered soils zeng et al 2018 reached a similar conclusion overall fam is robust because it controls the numerical stability and accuracy by direct incorporation of the boundary conditions into the numerical discretization procedure in a physically meaningful and mathematically consistent manner without the use of artificial fixing methods and fictitious points to simulate water flow in a heterogeneous porous medium we used two conditions of continuity the pressure head and exchanged fluxes across the interface node according to the principle of mass conservation the proposed formula did not need an additional iteration step thus it is computationally efficient also it is easy to implement in cases 1 2 and 3 we evaluated the application of the proposed formula with layered soils the comparison of analytical solutions and the results of mpfd in figs 4 6 and 7 validates fam comparing fam with mpfd in term of accuracy we find that fam performed better than mpfd while using fine grid sizes both fam and mpfd performed equally well and fam yields significant error reduction for pressure head for a coarse grid size the above results manifest that fam is suitable for simulating water flow in layered soils our numerical experiments also indicated that for calculating infiltration processes in uniform and layered soils with errors of a few percent fam is more efficient and accurate than mpfd moreover we emphasized that although fam was applied to soils with the exponential model gardner model in this paper it has been extended to soils based on the brooks corey model zhang et al 2016 which is another widely employed soil constitutive relations to simulate water flow in the vadose zone however it is challenging to implement the van genuchten model into fam at this moment to overcome this problem one may use conversion formulas between the van genuchten and gardner models ghezzehei et al 2007 ji et al 2008 as reported in ji et al 2008 using the conversion formula of zhu et al 2004 could obtain comparable results lastly we recognize that hydraulic hysteresis and deformation can impact soil moisture movement in the vadose zone ghaffaripour et al 2019 hydraulic hysteresis generally involves the non unique relationship between soil moisture and pressure head during wetting and drying processes yang et al 2012 soil deformation could change the soil hydraulic properties unless highly accurate prediction of small scale infiltration and solution transport processes are required most studies have ignored the effect of these two phenomena zha et al 2017 zeng et al 2018 suk and park 2019 due to their complexity they are certainly future research topics 6 conclusion in this paper a new fam is proposed to simulate water flow in heterogeneous layered porous media fam can effectively control the numerical stability and accuracy more importantly it directly incorporates the boundary conditions into the numerical discretization procedure in a physically meaningful and mathematically consistent manner to simulate water flow in the heterogeneous porous medium fam used two conditions of continuity the pressure head and exchanged fluxes across the interface node according to the principle of mass conservation it used a method to linearize the eq 22 and combined with eq 25 to derive a formula that can be incorporated in the numerical method our results show that the formula reduces the iteration step and increases computing efficiency moreover it is easy to implement all the examples presented for assessing the numerical accuracy of the proposed method demonstrate that fam has better performances than that mpfd unambiguously the robustness of fam however deserves further investigation for simulating flow in large scale field problems credit authorship contribution statement zaiyong zhang writing original draft conceptualization methodology wenke wang funding acquisition supervision chengcheng gong visualization writing original draft tian chyi jim yeh writing review editing lei duan writing review editing zhoufeng wang validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national natural science foundation of china no 40472131 u1603243 the key research and development program of shaanxi program no 2020sf 405 the fundamental research funds for the central universities chd 300102290302 and the special fund for basic scientific research business of central public research institutes no y519015 the first author is grateful to the outstanding chinese and foreign youth exchange program of china association of science and technology gong chengcheng is very grateful to the chinese scholarship council no 201906560022 for providing an opportunity to be a visiting student at the university of the neuchatel switzerland 
4652,a new finite analytic method fam was proposed to obtain a stable and accurate solution of highly nonlinear richards equation re for simulating flow through heterogeneous soils while the exponent hydraulic conductivity function gardner model was used to linearize re the variable has dyadic characteristics at the interface node between two different soil materials to overcome the dyadic characteristics at the interface node we derived a formula of fam based on the conversations of mass and energy at the interface node this new formula does not require additional iteration steps besides the proposed method is easy for coding and takes advantage of the strengths in mixed form re through three numerical experiments fam was compared to analytical solutions and modified picard finite different method mpfd to evaluate its accuracy and efficiency our results indicated that the proposed method could obtain highly accurate and stable numerical solutions and reduce the mass balance errors significantly also fam is less sensitive to the grid size compared to mpfd keywords finite analytic method layered soils analytical solution modified picard finite different method 1 introduction due to the nonlinearity of parameters and the mathematical characteristics of the nonlinear richards equation there are many difficulties encountered in solving the nonlinear re suk and park 2019 zha et al 2019 in addition to deformation induced by soil moisture movement in the vadose zone schrefler and xiaoyong 1993 loret and khalili 2000 sheng et al 2003 khoshghalb and khalili 2013 solving the richards equation re has been a topic of interest for nearly half a century celia et al 1987 li et al 2016 pan and wierenga 1995 suk and park 2019 generally re has three forms according to the types of variables celia et al 1990 the pressure head form h based the water content form θ based and the mixed form advantages of the θ based re arise from the fact that the relationship between hydraulic diffusivity d θ and water content generally is less nonlinear than that between hydraulic conductivity k θ and water content the θ based re also yields good mass conservation even using coarse grids zha et al 2013b moreover it is quite suitable for handling infiltration into an initially dry soil brunone et al 2003 the mixed form re combines the advantages of h based and θ based re while circumventing difficulties associated with the h based and θ based re approaches zhang et al 2016 for this reason the θ based and mixed form re have been frequently used for simulating water flow in uniform soils where water content is continuous throughout the soil nevertheless soils are rarely uniform over multiple length scales and layered soils are ubiquitous farthing and ogden 2017 in layered soils the water content is discontinuous across the soil materials with different unsaturated hydraulic properties assouline 2013 to retain the advantages of the θ based re form for simulating flow in layered soils a so called primary variable switching approach was developed to resolve the water content discontinuity across the soil materials interface brunner and simmons 2012 krabbenhøft 2007 likewise hills et al 1989 developed a model based on one dimensional θ based re for unsaturated flow into layered soils they found that this situation created a spurious flux schaudt and morrill 2002 combined the method by romano et al 1998 with the inherent numerical efficiency of the θ based re they reported that the approach could not guarantee the global mass conservation when a wetting front reaches a heterogeneous interface under heavy infiltration condition the θ based re for layered soils using the method of lines mol was proposed by matthews et al 2004 and matthews et al 2006 they found that mol may introduce significant errors in the storage term due to the supposition of flux continuity at the interface recently zeng et al 2018 developed a generalized switching method which combines the advantages of h based and θ based re using a semi implicit flux estimation algorithm generally all these algorithms for θ based re lead to non smooth transition between the two primary variables which cause the solution far from the true solution krabbenhøft 2007 zha et al 2017 this is likely to attribute to the fact that moisture gradient in the θ based re does not represent the energy gradient which drives water flowing through heterogeneous media yeh et al 2015 p 157 158 consequently the h based re has been widely adopted for simulating water flow in multiple soil layers celia et al 1990 romano et al 1998 simunek et al 2006 numerical schemes for solving h based re however often yield severely global mass balance errors allen and murphy 1986 celia et al 1987 milly 1984 van genuchten 1982 these errors are owing to the numerical evaluation of the capacity term c h milly 1984 especially for infiltration in relatively dry soils to overcome this problem rathfelder and abriola 1994 suggested the use of the standard chord slope approximation of capacity term c h to obtain good mass balance later romano et al 1998 developed an algorithm based on h based re yielding results close to the analytical solution and with right mass balance brunone et al 2003 further investigated the performance of the model developed by romano et al 1998 besides gastó et al 2002 and schymanski et al 2008 found that the geometric averaging of conductivities in their model could lead to large errors especially for simulating infiltration in dry sand for overcoming the highly nonlinear nature of re many transformation techniques have also been used chen and dai 2016 for instance ross 1990 proposed a hyperbolic sine function of pressure head to simulate water flow in the vadose zone this approach requires a parameter β to be determined a priori which is difficult to estimate as it is a function of medium and simulation variables williams et al 2000 kirchhoff transformation is another viable method bakker and nieber 2004 ji et al 2008 ross and bristow 1990 suk and park 2019 zhang et al 2015 2018 2016 the kirchhoff transformation has some advantages over others since the transform of the pressure head permits large grid sizes while maintaining acceptable accuracy even in dry soil conditions ross and bristow 1990 however such a transformation could cause undesirable discontinuity for the transformed variable at the interface between different soil materials this discontinuity often creates difficulties for numerical solutions zha et al 2019 and leads to incorrect flux when heterogeneity is present zha et al 2013a besides it may lead to convergence problems due to slope discontinuities at the wet end of k h function as a result ross 1990 reduced these problems by removing the discontinuity in the θ h function more recently ji et al 2008 used the kirchhoff transformation and a complementary function to separate the nonlinear hyperbolic characteristic from the linear parabolic part of re they reported that the kirchhoff transform could lead to satisfactory results nevertheless they only considered the discontinuity in saturated hydraulic conductivity values ks in layered soils under steady state infiltration likewise suk and park 2019 developed a method which avoids the dyadic characteristics of kirchhoff transformation at the soil material interfaces their results showed that the proposed method was computationally efficient accurate and robust overall the re is one of the difficult equations to be solved reliably and accurately in the field of hydrosciences due to its highly nonlinear nature farthing and ogden 2017 as a result efficient methods to solve re remain to be found zha et al 2019 the finite analytic method fam chen and chen 1984 was originally applied in groundwater flow by hwang et al 1985 for a two dimensional groundwater solute transport problem the advantage of fam is that it incorporates local approximate analytic solutions of a linear or linearized differential equation into the finite difference or finite element formulation with this approach fam obtains more accurate and stable numerical solution than the conventional numerical methods over the same local grids civan 1995 zeng and li 1987 despite its advantages the application of fam to unsaturated flow problems requires the linearization of the re e g tsai et al 1993 while the method applies well to two dimensional transient unsaturated flow in layered soils tsai et al 1993 reported that the method does not guarantee mass conservation consequently they suggested that fam should be extended to solve mixed form re for mass conservation zhang et al 2016 were the first who applied fam to solve the mixed form re recently suk and park 2019 reported that fam is accurate and successfully compared with other numerical methods however until now fam has only been applied to flow in homogeneous or layered soils with different ks zhang et al 2015 2018 2016 albeit variability of ks plays an important role in flow through unsaturated media the variability of the rate of change of k h i e α of gardner s model see eq 2 has been found to have profound impacts on unsaturated flow and solute transport khaleel et al 2002 yeh et al 1985a 1985b 1985c yeh 1989 in addition the sudden change in α between layered soils leads to a drastic change in k h and poses a great challenge to numerical solution techniques this numerical issue has rarely been explored by previous investigations this study proposes a new fam which can effectively handle the discontinuity of ks s and αs across the boundary between different soils for simulating water flow in layered soils in this paper a detailed description of the approach to handle the discontinuity of the transformed variable by using fam is provided afterward the results of fam are compared with those of analytical solutions by srivastava and yeh 1991 and the solutions from the widely used modified picard finite difference method mpfd celia et al 1990 during transient infiltration in soils with the discontinuity in ks then the results of fam and mpfd are compared with the analytical solutions by yeh 1989 for steady state infiltration in soils with discontinuity in both ks and α lastly we evaluate the results of fam for transient infiltration into three layered soils with discontinuity in ks s and αs with those by mpfd 2 description of the model the water flow in the unsaturated zone in a one dimensional domain can be described by the re celia et al 1990 1 θ t z k h h z k h z where h cm is the pressure head k h cm h is the unsaturated hydraulic conductivity of the soil z cm denotes the vertical dimension where the upward direction is positive θ cm3 cm3 is the soil moisture content t h represents time the hydraulic conductivity is described by the gardner model gardner 1958 2 k h k s e x p α g h in which k s cm h is the saturated hydraulic conductivity α g 1 cm is a soil index parameter related to the pore size distribution two types of constitutive mathematical models were applied for describing the soil water characteristic curve one is the gardner model gardner 1958 hereafter type 1 model in which 3 θ θ r θ s θ r e x p α g h where θ s cm3 cm3 and θ r cm3 cm3 represent the saturated and residual soil moisture content respectively the other one is the van genuchten model van genuchten 1980 which is called the type 2 model 4 θ h θ s θ r 1 α vg h n m θ r in which m 1 1 n and n are dimensionless parameters and α vg 1 cm is related to the inverse of the air entry suction 2 1 numerical implementation of fam using the hydraulic conductivity in eq 2 the eq 1 can be written as srivastava and yeh 1991 5 2 u z 2 α g u z α g θ k u t where u e x p α g h then adopting the type 1 model for the soil water characteristic curve one can derive 6 θ u θ s θ r k s likewise using the type 2 model for the soil water characteristic curve the following relationship can be derived 7 θ u α vg m n θ s θ r α vg α g l o g u n 1 α g u 1 α vg α g l o g u n m 1 as a consequence eq 5 can be expressed as 8 2 u z 2 2 b u z f where 9 b 0 5 α g 10 f α g θ u u n 1 u n δ t eq 8 can be solved analytically in a small element with the boundary and initial conditions u z 0 exp α g h z 0 are determined as 11 u z t b 1 b 2 exp 2 b z f 2 b z 12 u δ z t b 1 b 2 exp 2 b δ z f 2 b δ z 13 u δ z t b 1 b 2 exp 2 b δ z f 2 b δ z in which the coefficients of b 1 and b 2 in eqs 11 to 13 could be found in terms of nodal values at the element boundaries based on zhang et al 2015 2016 we can obtain the analytic solution for nodal point i an algebraic equation giving the nodal value k i n 1 14 u i n 1 a i u i 1 n 1 c i u i 1 n 1 r i b i where 15 a i 1 t h b δ z 16 b i 2 α g x δ t d θ du 17 c i 1 t h b δ z 18 r i α g x u i n δ t 19 x δ z t h b δ z b and th is the hyperbolic tangent function 2 2 algorithm for simulating water movement in layered soils in this section we illustrate how to handle the discontinuity of u variable first we focus on node i fig 1 which is at the interface between soil j and soil j 1 the sudden change in soil hydraulic properties α g at the interface between different layers j and j 1 results in a discontinuity in the variable of u while the variable u is discontinuous between the interface the pressure head is continuous at the interface besides the fluxes across the interface between different soils must be equal according to the principle of mass conservation 20 h i h i 21 q i q i where the superscript and indicate one side and the other side of the interface application of eq 2 to eq 20 eq 20 can be written 22 1 α g ln α g u i 1 α g ln α g u i based on bakker and nieber 2004 this equation may be written as 23 ln α g u i ln α g u i v ln α g u i in which v α g α g 1 taking the exponent of both sides of eq 23 gives 24 u i α g α g α g u i v u i eq 21 can be written as 25 k s u z i α g k s u i k s u z i α g k s u i based on eq 18 and 19 in zhang et al 2015 eq 25 can be written as 26 k s 2 δ z u i 2 4 u i 1 3 u i α g k s u i k s 2 δ z u i 2 u i 1 3 u i α g k s u i application of eq 24 to eq 26 eq 26 can be written 27 u i 4 w 1 u i 1 w 1 u i 2 4 w 2 u i 1 w 2 u i 2 2 w 2 w 4 3 w 1 w 3 w 5 where w 1 k s 2 δ z w 2 k s 2 δ z w 3 α g k s w 4 α g k s and w 5 α g α g α g u i v it should be noted that the nodes i 1 and i 1 in the neighborhood of the material interface the formulas of the grids i 1 and i 1 are as follow 28 u i 1 n 1 a i u i n 1 c i u i 2 n 1 r i b i 29 u i 1 n 1 a i u i 2 n 1 c i u i n 1 r i b i where ai bi ci and ri are defined in eqs 15 18 the set of algebraic eqs 14 27 28 and 29 are solved with associated boundary conditions by using sor iterative method zhang et al 2015 3 numerical examples we assessed the usefulness of fam using three numerical experiments i e case 1 case 2 and case 3 fig 2 in case 1 the results of the experiments were compared with the analytical solution by srivastava and yeh 1991 who presented an analytical solution for wetting scenarios in two layered soils this analytical solution has been widely adopted for testing numerical methods ji et al 2008 matthews et al 2004 suk and park 2019 in addition we compared fam s performance with those by mpfd celia et al 1990 in this case we consider a one dimensional vertical infiltration in a column with two soil layers where each layer had a thickness of 100 cm the upper boundary was set equal to the rate of 0 9 cm h and the lower boundary was a constant pressure head 0 cm i e the water table α g s of the two soil layers were set to be 0 1 1 cm but the saturated hydraulic conductivities ks of the upper and lower layers were 1 and 10 cm h respectively the saturated soil moisture content θ s was 0 4 cm3 cm3 and residual soil moisture content θ r was 0 06 cm3 cm3 they were assumed to be the same for the two soil layers the initial condition was obtained from the analytical solution for an infiltration rate equal to 0 1 cm h at the top boundary two different spatial discretizations were considered one was 200 elements of 1 cm in length another was 40 elements of 5 cm in length we used an adaptive time stepping approach in fam and mpfd the parameters are listed in table 1 in case 2 we tested fam for simulating the flow in three layered soils with different ks and α g in this case we used the analytical solution by yeh 1989 which considers steady state flow through multi layered soils with different ks and α g we then compared the performance of fam with those by mpfd celia et al 1990 finally we evaluated the solution from fam with the solution from mpfd for transient flow in the three layered soils with different ks s and α g s in case 3 in case 3 there is no analytical solution available for comparison in cases 1 and 2 where analytical solutions are available we used three criteria to evaluate the numerical performance of fam first the local error is calculated 30 ξ z t 1 h z t numerical h z t analytical 100 in which h z t numerical is the result of fam or mpfd respectively h z t analytical denotes the analytical solutions from yeh 1989 or srivastava and yeh 1991 the second is the mass balance error which can be carried out in the profile as follows 31 δ t 1 m t m 0 numerical m t m 0 analytical 100 in which m t and m 0 are the initial mass and the mass at a time t in the flow domain respectively the last one is the root mean squared error 32 l 2 h 1 n i 1 n 1 δ z i 2 h analytical z i t h numerical z i t d z 2 where i 1 2 n is the node number 4 results case 1 comparison with those by fam mpfd and analytical solution by srivastava and yeh 1991 few analytical solutions to re for layered soil profiles are available except for works by aylor and parlange 1973 warrick 1991 and srivastava and yeh 1991 the solutions by aylor and parlange 1973 and warrick 1991 were developed for specialized hydraulic parameter functions not commonly used in numerical models the solution by srivastava and yeh 1991 used the type 1 functions widely used in the numerical models this case involves vertical infiltration towards the water table through a two layered soil system consisting of two homogeneous layers the thickness of each layer is 100 cm with the residual water content the saturated water content and α taken as 0 06 cm3 cm3 0 4 cm3 cm3 and 0 1 1 cm respectively table 1 the lower and upper layers of the saturated hydraulic conductivities are equal to 10 and 1 cm h respectively the boundary condition at the soil surface is a constant flux and the steady state infiltration profile at a flow rate equal to 0 1 cm h is taken as the initial pressure head profile srivastava and yeh 1991 then the boundary condition at the soil surface is a constant infiltration rate 0 9 cm h two grid sizes 1 and 5 cm were employed and an adaptive time step was used in the simulation simulated pressure head profiles by fam and the analytical solution at 1 5 10 20 and 100 h are presented in fig 3 a for the grid size 1 cm and fig 3b for the grid size 5 cm both figures show that the solutions from fam are in good agreement with those from analytical solutions fam however yields some errors near the wetting front at the initial stage when the grid size is equal to 5 cm distribution of ξ z t local error eq 30 vs z for the fam using a fine grid size 1 cm is exhibited in fig 4 a it shows that fam yields excellent numerical results overall the absolute of the local error is smaller than 0 4 fig 4a the largest error occurred at the initial infiltration process and the error decreases with the time similarly when the coarse grid size 5 cm was used fam produced an absolute of local error of less than 6 fig 4b notice that close to the layer interface fam slightly overestimates the analytical solutions in the upper soil layer and it underestimates in the lower soil layer in both spatial sizes the ξ z t at the layer interface for fam gradually increases to a maximum of about 0 15 when the grid size equal to 1 cm as compared with 2 2 for the grid size equal to 5 cm the simulated head profiles by mpfd are also compared with those of the analytical solution the local errors of mpfd associated with 1 cm and 5 cm grid sizes are depicted in fig 4c and 4d respectively revealing that the largest local error equaled to 7 0 is larger than that fam 0 4 when the grid size is 1 cm the local error ξ z t of mpfd at the layer interface grows with time and it stabilizes to 3 3 which is larger than that fam when mpfd used the coarse grid size the error becomes even larger the absolute value of ξ z t reaches the maximum value of 22 near the surface ground at the initial infiltration process besides the error at the layer interface eventually became large and the maximum error exceeds 15 these results manifest that mpfd is sensitive to coarse grid size and leads to significant errors especially at the layer interface the proposed algorithm can obtain a more accurate solution than mpfd especially at the interface when coarse grids are used the l 2 h in fig 5 demonstrates that the l 2 h for fam are smaller than that for the mpfd similar tendencies were found in computational cost indicated by the number of iterations shown in fig 6 the mass balance error δ t for transient flow into the two layer soil system is shown in fig 7 notice that the δ t s of fam using both grid sizes are almost identical after 10 h with a peak value of about 1 3 when the grid size equal to 1 cm the δ t of mpfd reduces as time increases however when the grid size equals to 5 cm there was a maximum mass balance error at an early stage of the infiltration process the maximum error reaches 15 and then it reduces it should be noted that the error associated with mpfd is highly dependent on the grid size in other words the mass balance error level associated with mpfd is higher than those of fam for the most part of the simulation time case 2 comparison with those by fam mpfd and analytical solution by yeh 1989 case 2 considers one dimensional unsaturated flow in a heterogeneous layered soil column which consists of three layers the thicknesses are 50 50 and 100 cm from lower to the upper layers respectively the lower boundary condition is the fixed pressure head 0 cm i e the water table the top boundary condition is the fixed flux 0 1 cm h the spatial step is adopted for 1 cm the α g 1 cm of the upper middle and lower layers are set to 0 1 0 2 and 0 1 respectively the parameters are displayed in table 1 since the analytical solution for the transient flow is not available in this case we compared the results of fam and mpfd with those of a steady state analytical solution by yeh 1989 the analytical solution was derived for one dimensional steady state vertical infiltration in unsaturated soils hydraulic conductivity and pressure head relationship was assumed to be described by type 1 model then the analytical solution is as following 33 h 1 α l n e x p α z h 0 q k s exp α z q k s where z is the elevation cm h 0 is the specified head at z 0 cm and q is the flux at the surface cm h eq 33 is valid only if 34 0 exp α z h 0 q k s exp α z q k s 1 the analytical solution can be applied to layered soils with different ks s and αs that is with given soil parameters of the bottom layer and the h 0 at z 0 eq 33 can determine the pressure head at the interface between this layer and the overlying layer then because the flow is steady and 1 d the pressure head and flux in the lower layer must equal those in the upper layer at the interface the distribution of the pressure head in the overlying layer can be determined using eq 33 and the pressure head at the interface as the prescribed head h 0 in eq 33 for determining the pressure head profile in the overlying layer the same principle can be applied to additional layers therefore we can easily obtain the pressure head distribution in any number of soil layers the pressure head distributions over depth from the analytical solution and fam are shown in fig 8 a which shows that the pressure head profiles of fam are in excellent agreement with those obtained from the analytical solution thus the proposed method could effectively handle the discontinuous α g at the layer interface mpfd was also used to simulate the pressure head profile for case 2 a plot of local error between the solutions of fam and mpfd over the 200 cm profile with three soil layers are in fig 8b this plot indicates that fam solutions are in excellent agreement with the analytical solution with a local error being the order of 100 with a peak of error 1 at the layer interface on the other hand mpfd yields an error larger than 4 0 the root mean square error of fam is 0 12 but mpfd yields the root mean square error larger than 0 3 the mass balance error for mpfd is 0 13 the value of mass balance error for fam is 0 08 these results confirm that the numerical performance of fam is better than mpfd case 3 transient unsaturated flow in a three layered soil the parameters for this case 3 are displayed in table 1 the bottom boundary was the specified head equal to 0 cm and the top boundary was a prescribed flux of 0 1 cm h the initial condition was 50 cm along the soil column analytical solutions are not available for calculating pressure head profiles in this case to compare the results of fam for this reason we compare the results of fam to the results of mpfd fam selected grid size equal to 1 cm mpfd used a relatively smaller grid size 0 5 cm to simulate water flow in the soil column the choice of 0 5 cm to ensure its accuracy as demonstrated previously the resulting pressure heads of the mpfd are displayed in fig 9 along with those of fam at 1 5 10 and 50 h according to the figure the results from fam could not be visibly distinguished from the mpfd this result indicates that the numerical results from fam are reasonably well matched with the mpfd that is the proposed method could effectively handle the discontinuous soil parameters such as k s and α g for transient flow 5 discussion as depicted in figs 4 and 7 the local and mass balance errors for the proposed fam are consistently lower than those of the mpfd in particular the results in fig 4 reveal that fam solutions agree with the analytical values near the layer interface even when the grid size is equal to 5 cm on one hand this outcome is attributed to the fact that the gravity term is in the analytical solution embedded in eq 8 zhang et al 2016 on the other hand the errors of fam mostly occur at the initial infiltration stage these errors reflect the fact that using the first order finite difference approach to time derivative in eq 10 may introduce errors especially for the situation with a large peclect number tsai et al 2005 furthermore mpfd results deviate significantly from analytical values near the interface between different soils the fact that mpfd uses a backward difference scheme to calculate the term k z and an averaging scheme for evaluating the parameter k i is likely the cause these aforementioned factors apparently lead to large error or even divergence when hydraulic conductivities change rapidly thus selected averaging scheme for determining the parameter k i can influence the accuracy of the solution from mpfd for the entire computational domain especially for layered soils zeng et al 2018 reached a similar conclusion overall fam is robust because it controls the numerical stability and accuracy by direct incorporation of the boundary conditions into the numerical discretization procedure in a physically meaningful and mathematically consistent manner without the use of artificial fixing methods and fictitious points to simulate water flow in a heterogeneous porous medium we used two conditions of continuity the pressure head and exchanged fluxes across the interface node according to the principle of mass conservation the proposed formula did not need an additional iteration step thus it is computationally efficient also it is easy to implement in cases 1 2 and 3 we evaluated the application of the proposed formula with layered soils the comparison of analytical solutions and the results of mpfd in figs 4 6 and 7 validates fam comparing fam with mpfd in term of accuracy we find that fam performed better than mpfd while using fine grid sizes both fam and mpfd performed equally well and fam yields significant error reduction for pressure head for a coarse grid size the above results manifest that fam is suitable for simulating water flow in layered soils our numerical experiments also indicated that for calculating infiltration processes in uniform and layered soils with errors of a few percent fam is more efficient and accurate than mpfd moreover we emphasized that although fam was applied to soils with the exponential model gardner model in this paper it has been extended to soils based on the brooks corey model zhang et al 2016 which is another widely employed soil constitutive relations to simulate water flow in the vadose zone however it is challenging to implement the van genuchten model into fam at this moment to overcome this problem one may use conversion formulas between the van genuchten and gardner models ghezzehei et al 2007 ji et al 2008 as reported in ji et al 2008 using the conversion formula of zhu et al 2004 could obtain comparable results lastly we recognize that hydraulic hysteresis and deformation can impact soil moisture movement in the vadose zone ghaffaripour et al 2019 hydraulic hysteresis generally involves the non unique relationship between soil moisture and pressure head during wetting and drying processes yang et al 2012 soil deformation could change the soil hydraulic properties unless highly accurate prediction of small scale infiltration and solution transport processes are required most studies have ignored the effect of these two phenomena zha et al 2017 zeng et al 2018 suk and park 2019 due to their complexity they are certainly future research topics 6 conclusion in this paper a new fam is proposed to simulate water flow in heterogeneous layered porous media fam can effectively control the numerical stability and accuracy more importantly it directly incorporates the boundary conditions into the numerical discretization procedure in a physically meaningful and mathematically consistent manner to simulate water flow in the heterogeneous porous medium fam used two conditions of continuity the pressure head and exchanged fluxes across the interface node according to the principle of mass conservation it used a method to linearize the eq 22 and combined with eq 25 to derive a formula that can be incorporated in the numerical method our results show that the formula reduces the iteration step and increases computing efficiency moreover it is easy to implement all the examples presented for assessing the numerical accuracy of the proposed method demonstrate that fam has better performances than that mpfd unambiguously the robustness of fam however deserves further investigation for simulating flow in large scale field problems credit authorship contribution statement zaiyong zhang writing original draft conceptualization methodology wenke wang funding acquisition supervision chengcheng gong visualization writing original draft tian chyi jim yeh writing review editing lei duan writing review editing zhoufeng wang validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national natural science foundation of china no 40472131 u1603243 the key research and development program of shaanxi program no 2020sf 405 the fundamental research funds for the central universities chd 300102290302 and the special fund for basic scientific research business of central public research institutes no y519015 the first author is grateful to the outstanding chinese and foreign youth exchange program of china association of science and technology gong chengcheng is very grateful to the chinese scholarship council no 201906560022 for providing an opportunity to be a visiting student at the university of the neuchatel switzerland 
4653,data mining algorithms such as artificial neural networks ann and k nearest neighbour knn have proven their merits in pedotransfer function modelling kriging is a well known algorithm for spatial interpolation but in this study it is proposed as an alternative data mining technique it was compared to knn as a benchmark pedotransfer function to predict soil water retention for a wide range of datasets containing soil data from both temperate and tropical regions the performance of both methods was compared through monte carlo cross validation and the precision of the predictions was assessed with an ensemble procedure across all datasets a significant improvement in prediction bias accuracy and precision was found with kriging compared to knn moreover it was demonstrated how predictions with kriging are more robust and insensitive to non correlated predictor variables and how the optimized hyperparameters provide additional insight in the training dataset properties kriging was found to be a accurate precise and robust data mining solution for pedotransfer function modelling keywords data mining water retention curve k nearest neighbours precision nomenclature list of symbols c covariance k kernel function x predictor variable at prediction x predictor variable λ prediction weight std y standard deviation of a response variable y std yt standard deviation of a transformed response variable y ν gaussian radial kernel partial sill parameter σ y average ensemble standard deviation ϕ lagrange multiplier σ noise white noise kernel parameter σ y ensemble standard deviation k n number of neighbours in knn k r number of neighbours in kriging l gaussian radial kernel length scale parameters n x number of predictor variables p knn power parameter y response prediction y response variable 1 introduction soil plays a key role in numerous processes in the earth s ecosystem yet an often encountered obstacle is the lack of data to describe the properties of the soil adequately for example hydrological models or land surface models require a detailed description of the hydraulic and thermal soil properties but these properties are cumbersome and unfeasible to measure at large scale van looy et al 2017 on the other hand detailed data is available from more routinely measured soil properties such as texture bulk density and organic matter content pedotransfer functions ptf essentially exploit the relation between these soil properties and allow to predict the soil data that is needed from the data that is readily available bouma 1989 wösten et al 2001 throughout the years various approaches have been used to develop ptfs the classical pedotransfer functions were tabular reference values for soil texture classes or multivariate linear regression methods saxton et al 1986 vereecken et al 1989 rawls et al 1991 cornelis et al 2001 they are still widely used because of their simplicity and often low input requirements typically they have only a limited range of validity as they do not manage to capture the complex behaviour of soil properties with this basic approach or because they are based on a limited dataset tropical soils are a classic example where often they fail and yet are needed the most due to limited datasets high variability and complex behaviour schaap 2005 minasny and hartemink 2011 botula et al 2014 in the past decades data mining algorithms have proven to be superior compared to traditional regression methods given the advantages of being flexible and having no a priori assumptions of linearity they are capable to overcome the limitations of multivariate linear regression to a certain extent some widespread data mining methods used for ptfs are artificial neural networks ann schaap et al 2001 support vector machines svm twarakavi et al 2009 k nearest neighbour knn nemes et al 2006 and random forest tóth et al 2014 more recently ptfs using gaussian process regression have gained interest and have demonstrated a high potential kotlar et al 2019 ballabio et al 2019 al dosary et al 2019 in this study a variant of gaussian process regression gpr is evaluated i e kriging williams et al 1996 rasmussen and williams 2006 kriging is a geostatistical interpolation method originally developed for improved ore content prediction in mining krige 1951 matheron 1963 nowadays it is an essential tool for spatial interpolation in domains such as geology geotechnics soulie et al 1990 precision agriculture wollenhaupt et al 1994 and fisheries little et al 1997 it has become an successful interpolation method for non spatial variables as well in particular as a metamodelling tool sacks et al 1989 simpson et al 2001 wang and shan 2007 kleijnen 2009 in this study kriging is introduced as a data mining technique for ptfs in an attempt to improve the results obtained with the established methods the inception of this idea comes from the similarity between knn and spatial interpolation with inverse distance weighting idw in a context of spatial interpolation predictions with kriging are often found to be more accurate than with idw zimmerman et al 1999 li and heap 2011 it is our hypothesis that this will also be the case for the interpolation of non spatial variables with kriging compared to knn this idea has been coined before van looy et al 2017 but only limited research has been committed to this topic ramos et al 2014 used kriging in a similar way to predict water retention properties but used only two predictor dimensions i e two soil texture fractions however the algorithm is not restricted to two or three predictor dimensions as in spatial interpolation a more generalized methodology is presented in this study knn is one of the best performing ptf algorithms making it suitable as a benchmark to compare kriging with the established ptf methods haghverdi et al 2010 haghverdi et al 2015 nguyen et al 2017 the performance of interpolation methods is affected by the sampling density data variance spatial correlation and other properties of the dataset zimmerman et al 1999 li and heap 2011 therefore this evaluation was done for a range of datasets containing soil water retention data and soil properties from temperate and tropical regions the main objectives of this study are to introduce kriging as a ptf method and to compare the accuracy and precision of the predictions with knn across a range of datasets 2 materials and methods 2 1 kriging algorithm the algorithm used here is ordinary kriging it is a variant of gpr and is a well established method in geostatistics contrary to gpr not the complete training dataset is used in the prediction but only a selection of the nearest neighbours furthermore the mean of the response variable is assumed to be unknown and locally stationary i e for the nearest neighbours kriging is also referred to as best linear unbiased predictor blup it is linear in the sense that the predictions are a weighted linear combination of the training data 1 y x i 1 k r λ i y i where y is the predicted response variable for the vector of prediction variables x k r is the number of training data samples y i in the search neighbourhood and λ i is the weight for each of those samples the length of x is determined by the number of predictor variables n x kriging is unbiased as it imposes the condition that the mean error is zero it can be proven that this leads to 2 i 1 k r λ i 1 it is the best predictor as the core concept behind the algorithm is the minimization of the second moment of the prediction error from which follows 3 i 1 k r λ i x c x i x j ϕ c x i x for j 1 k r where c is the covariance note that a mathematically identical method can be derived in function of semivariance and ϕ is the lagrange multiplier bilonick 1991 pham 2005 cressie 2015 the covariance describes the autocorrelation of the response variable y in terms of lag distance of a predictor variable the covariance can be modelled using a kernel function k in this study the anisotropic gaussian radial basis function with white noise was used duvenaud 2014 4 c x x k x x ν 2 exp i 1 n x x i x i 2 2 l i 2 σ noise 2 δ x x where x i and x i are the predictor variables in x and x n x is the number of predictor variables ν 2 is the partial sill l i is the length scale parameter of the predictor variable σ noise 2 is the white noise variance and δ x x is the dirac delta function note that anisotropy is achieved by specifying different values of l for each predictor variable the hyperparameters ν l and σ noise are fitted to the training dataset by maximizing the log marginal likelihood rasmussen and williams 2006 the fitted hyperparameters of the covariance kernel provide some insight in the properties of the dataset prediction variables with a large length scale imply a low sensitivity of the response variable to this predictor variable furthermore the nugget effect i e the ratio between σ noise 2 and σ noise 2 ν 2 indicates how much of the variability in the response dataset is attributed to inherent uncertainty in the dataset it can be attributed to natural randomness measurement uncertainty or missing additional predictor variables to reduce the computational load a subset of the total training dataset is used to make the prediction in this case k r samples with the highest c x x were selected consequently the anisotropy in the dataset is reflected in the neighbourhood sample selection an example is shown in fig 1 after the selection of neighbours the vector with the weights λ is calculated as shown in the eqs 5 8 a contains the covariance between the selected neighbours b contains the covariance between the neighbours and the input and y k contains the response variable of the selected neighbours 5 a a 1 1 a 1 2 a 1 k r 1 a 2 1 a 2 2 a 2 k r 1 a k r 1 a k r 2 a k r k r 1 1 1 1 0 a i j c x i x j 6 b b 1 b 2 b k r 1 b i c x i x 7 λ λ 1 λ 2 λ k r ϕ y k y 1 y 2 y k r 0 8 λ a 1 b the weighted sum of response variable of the neighbours returns the prediction y 9 y λ y k all calculations were done in python the code and demo are available at https github com jandepue kriging ptf 2 2 k nearest neighbours to evaluate the performance of this method it was compared to the knn algorithm as applied in e g nemes et al 2006 and botula et al 2013 in comparison to other methods such as svm ann linear regression it is amongst the best performing and most flexible ptf algorithms nemes et al 2006 lakzian et al 2010 patil et al 2012 nguyen et al 2017 similar to kriging the prediction is a weighted sum of samples in the training dataset but the selection of neighbours and attribution of weights solely depends on the euclidean distance in the predictor space x x i and a power parameter p eq 10 an example is show in fig 1 all calculations were done in python the code and demo of the knn algorithm is available at https github com jandepue knn ptf 10 y x i 1 k n λ i x y i λ i x x x i i 1 k n x x i p i 1 k n x x i i 1 k n x x i p 2 3 evaluation 2 3 1 datasets the quality of a ptf or any data mining application in general largely depends on the training dataset to properly evaluate the performance of this ptf a range of soil datasets of various sizes and origins predictor and response variables was used a summary with predictor and response variables and some basic statistics is given in table 1 a more detailed analysis of the correlation between predictor and response variables is given in the supplements lowercongo is a dataset which was originally used in botula et al 2013 it consists of 139 samples collected by botula 2013 in lower congo pearson correlations are highest for bulk density 0 80 at pf 0 and sand 0 94 clay 0 94 at pf 4 2 ph is the predictor variable with the lowest correlation max 0 20 in this dataset flanders is a dataset of 155 samples collected in agricultural fields in flanders and cover all major textural classes according to the belgian textural triangle samples were taken from three layers i e the topsoil 0 30 cm the compacted subsoil 30 60 cm and the subsoil 60 90 cm van der bolt et al 2016 this is the dataset with the lowest overall variation in water retention data the pearson correlation is the highest for clay content over the whole range of the water retention curve 0 71 0 88 carbon content has the lowest overall correlation max 0 20 mekong is a dataset from the mekong delta in vietnam developed by nguyen et al 2015 containing 158 samples taken from crop lands bulk density has the highest pearson correlation at pf 0 0 72 and clay at pf 4 2 0 88 the stability index as defined by nguyen et al 2015 has an overall low correlation max 0 14 unsoda refers to the unsaturated soil hydraulic database nemes et al 2001 it is a large open database of soil properties mostly of north american and european origins a selection of 491 samples was made to retain samples with all important predictor properties texture and bulk density and response properties the water retention data in the unsaturated soil hydraulic database is not restricted to a standardized set of matric potentials to obtain a uniform dataset with a fixed set of matric heads for each sample some points on the water retention curve are approximations by averaging of nearest points within a pf range of 0 1 all four predictor variables have a high correlation with the response variables min 0 46 overall sand has the highest correlation 0 79 0 81 igbp dis is the international geosphere biosphere programme igbp database from the international soil reference and information centre isric tempel et al 1996 this open dataset contains 1772 samples and detailed soil texture data covering both temperate and tropical soils cec has the highest pearson correlation at pf 2 0 0 88 and clay at pf 4 2 0 88 overall caco3 has the lowest correlation max 0 03 and a high standard deviation 14 41 euhydi is the european hydropedological data inventory weynants et al 2013 consisting of data from 18 countries with contributions from 29 institutions in the european union this is the largest dataset used in this study a selection was made based on the availability of soil properties which led to 2 versions of this dataset euhydi containing the basic predictor variables and euhydi full with a wider range of predictor variables due to predictor data availability euhydi contains 2248 samples whereas euhydi full contains 687 samples also here some points of the water retention curve are obtained by averaging of nearest points within a pf range of 0 1 clay has the highest correlation over the whole range of the retention curve for euhydi 0 75 0 77 and also for euhydi full but to a lower degree 0 55 0 64 the same is observed for other predictor variables in this dataset it seems that the euhydi full subselection results not only in a smaller amount of samples but the data contains less linear correlation as well the selection of predictor variables in machine learning methods is an important factor influencing the result the presence of irrelevant predictors could be detrimental to the prediction accuracy schaap et al 2001 nemes et al 2003 to evaluate the robustness of the kriging and knn algorithms three additional random predictor variables uniform distribution between 0 and 1 are introduced in lowercongo correlations max 0 21 the resulting perturbated dataset is labelled lowercongo spike the size of the training dataset remained unchanged the difference in rmse between the predictions with lowercongo and lowercongo spike are an indication of the sensitivity to uncorrelated predictors variables as some variables in the dataset are not normally distributed we have applied a box cox power transformation to each predictor and response variable with optimized lamba parameter to maximize the log likelihood function box and cox 1964 the resulting histograms and probability plots are given in the supplementary material overall an improved normality was obtained note similar results to the ones presented here were obtained without box cox power transformation as well the resulting predictions were backtransformed for validation see below 2 3 2 hyperparameter optimization the performance of the knn algorithm depends on the hyperparameters k n and p in an exploratory study a brute force minimization of the rmse with these parameters was performed to evaluate the response surfaces the rmse validation objective surfaces and the optimum for the response variables in all datasets are given in the supplements in accordance to findings in literature it was found that the optimal k n for knn was correlated to the size of the training dataset nemes et al 2006 however a near optimal performance can be achieved for 5 k n 60 given the correct tuning of p in most cases increasing k n is then compensated by increasing the influence of the closest neighbours with p an exception here was the euhydi dataset where optimal performance was found at high k n and low p which results in a smooth prediction similar to knn the number of neighbours considered for each prediction could influence the performance of the kriging algorithm the effect of hyperparameter k r was therefore evaluated as well the effect of k r on the accuracy of the kriging predictions is given in the supplements the sensitivity to k r was fairly low in particular when k r 20 contrary to knn the optimal performance was rarely found at k r 20 a typical property of the kriging algorithm is the so called declustering and shielding effect selected training data samples which are close together in the predictor space are of less influence for the prediction this explains why in contrast to knn k r is fairly insensitive to a too high setting since the effect of the amount of neighbours was limited it was chosen to compare both methods using the same amount of neighbours i e k n k r 50 it was verified that a comparison using the optimal k n lead to similar results 2 3 3 validation the validation indices used to evaluate the performance of both algorithms are mean error me root mean square error rmse and nash sutcliffe efficiency coefficient ns me and rmse respectively indicate the bias and accuracy of the predictions and ns assesses the overall predictive power of the algorithm they were calculated as in eqs 11 13 in which y and y o are the predicted and observed values and m is the number of samples significant differences in the validation indices between both methods were evaluated with the wilcoxon rank sum test 11 me m y y o m 12 rmse m y y o 2 m 13 ns 1 m y o y 2 m y o y o 2 with each prediction of a ptf there is an associated uncertainty this uncertainty is not only related to the accuracy of the prediction but also to its precision precision is defined as the closeness of agreement between test results iso5725 1 1994 1994 it is related to the variability of the training dataset as well as the robustness of the ptf algorithm a low prediction precision can be associated with a less densely sampled region of the predictor space a high local response variable uncertainty in the dataset or the sensitivity of the ptf algorithm to outliers it can be used to determine prediction intervals for the prediction but is not an indicator of the accuracy of the prediction schaap and leij 1998 schaap et al 2001 nemes et al 2006 botula et al 2013 to evaluate the precision of a prediction an ensemble of 100 predictions was created using a random 80 subset of the training dataset from the resulting ensemble of 100 predictions for each validation sample the mean gives the predicted value y and the ensemble standard deviation σ y indicates the precision of the prediction it was verified that the number of repetitions in the ensemble was sufficiently large to achieve stable results not shown the average ensemble standard deviation for all predictions of a response variable σ y was calculated to evaluate the average precision of the predictions 14 σ y m σ y m 2 m to achieve an independent evaluation a monte carlo cross validation was performed burman 1989 the datasets were randomly resampled into 70 training dataset and 30 test dataset the training dataset was used to optimize the hyperparameters i e p for knn and covariance kernel fit for kriging and the test dataset was used for validation this was repeated 10 times to guarantee stable results the validation indices me rmse ns and σ y were calculated for the concatenated results i e micro averaged 3 results 3 1 hyperparameter optimization the relative contribution of ν and σ noise is shown in fig 2 a the kriging hyperparameters of the euhydi and euhydi full dataset had a very high nugget effect which would indicate a smooth prediction this is also reflected in the optimized knn hyperparameters for those datasets ν and σ noise are scaled by the standard deviation of the associated box cox transformed response variable std yt to allow intercomparison between the datasets the prediction is most sensitive to predictor variables with a short length scale i e less smooth predictions to illustrate this the length scale of bulk density and clay are plotted here in function of the matric potential pf of the predicted water content fig 3 it is well established that bulk density is a soil property which is more related to water content at lower pf values whereas the influence of texture increases at high pf this is reflected in these results as well the length scale parameter of bulk density overall increases with pf whereas the opposite is found for clay a notable exception is found for the flanders datasets where the length scale parameter decreases with pf an overview of the fitted covariance kernel length scale parameters is shown in fig 2b datasets with an overall short length scale like euhydi have a low covariance at short distances on the contrary the mekong dataset has a high covariance furthermore the range of the length scales indicates the anisotropy in the dataset the lowercongo flanders and mekong dataset express a much larger anisotropy than euhydi 3 2 evaluation given the optimized hyperparameters and k n k r 50 the performance of the kriging algorithm was compared to the knn performance for all datasets scatterplots of the resulting me rmse and ns are shown in fig 4 the full validation results are given in table 2 together with the mean of the validation indices and the result of a wilcoxon rank sum test to check for significant differences between knn and kriging the bias in the predictions indicated by me was reasonably small for both methods across all datasets the mean me was negligable yet a significant improvement in the absolute value of me was found with kriging as also illustrated in fig 4a overall both methods achieved excellent results ns 0 70 and rmse 0 050 m3m 3 the overall rmse and ns were significantly better for kriging the most accurate predictions were found with the lowercongo and flanders datasets the least accurate predictions were for igpb dis at pf 2 0 and 2 5 the predictions were more accurate with kriging than with knn over the full pf range for the flanders mekong igbp dis datasets and most of lowercongo dataset in the case of the unsoda dataset the predictions were more accurate with knn and both methods achieved similar performance for euhydi and euhydi full the precision of the predictions indicated by σ y is shown in fig 4d an overall major and significant improvement was achieved using kriging notable exceptions were some of the lowercongo response variables as well as the euhydi dataset the robustness of the algorithms to predictor variable selection was tested by comparing the accuracy of the predictions with the lowercongo and lowercongo spike dataset the effect of the random predictor variables on the accuracy of knn and kriging is shown in fig 5 where a substantial decrease in ns is found with knn the kriging predictions were fairly insensitive to the presence of random variables 4 discussion excellent results were achieved with both methods across all datasets but the predictions with kriging were significantly less biased and more accurate than the predictions with knn the results here are comparable to outcomes of other studies for temperate soils schaap et al 2001 reported a rmse of 0 068 m3m 3 with an ann parametric ptf based on the unsoda dataset with kriging a rmse of 0 055 m3m 3 is found using the same predictors but excluding the error due to the van genuchten model fit a study by tóth et al 2015 using european datasets achieved a higher accuracy of 0 030 m3m 3 with regression trees and mlr nguyen et al 2017 reported a rmse of 0 050 m3m 3 using knn and ann for the mekong dataset similar to the results found here the same dataset using svm or mlr resulted in a lower accuracy of 0 066 m3m 3 when comparing kriging to knn considerable improvements in accuracy were found for less densely sampled datasets i e lowercongo flanders and mekong this coincides with improvements in precision for those datasets the robustness of kriging for smaller datasets is promising for ptfs in regions where data is sparse such as the tropical regions particularly in developing countries an important difference between knn and kriging occurs when uncorrelated predictor variables are present as demonstrated with the lowercongo spike experiment in such case the prediction accuracy of knn decreases significantly more than with kriging the covariance of the dataset is at the core of the kriging algorithm modelling it with an anisotropic kernel function allows kriging to discriminate between the importance of each predictor the length scale parameters of the kernel provide useful insight in the sensitivity of the prediction to a predictor variable as demonstrated with bulk density in fig 3 expected physical relations are revealed the accuracy of the predictions with kriging was in particular better for datasets with a high degree of anisotropy i e lowercongo flanders mekong and igpb dis as indicated by the wide range of length scales of the predictors in fig 2 in some datasets like unsoda or euhydi the correlation with the response variables is very high for all predictor variables in those datasets the isotropic knn algorithm has a similar performance compared to kriging the study of kotlar et al 2019 also demonstrated that the feature selection capability is a valuable trait of gpr the limiting factor for the accuracy of the predictions with any ptf algorithm is the inherent uncertainty in the training dataset which can be attributed to missing predictor variables natural randomness or measurement uncertainty wösten et al 2001 this is quantified by the σ noise parameter of the covariance kernel in fig 6 it is illustrated that the accuracy of the predictions with kriging approach this limit to allow intercomparison rmse and ν are scaled by the standard deviation of the corresponding response variables std y and box cox transformed variables std yt respectively in this study the main factor determining the performance of ptfs is thus the training dataset and not the algorithm the introduction of additional water retention data as predictor variables can improve the performance of a ptf drastically vereecken et al 2010 furthermore simple mlr ptfs trained on local datasets can outperform machine learning ptf trained on a global dataset weynants et al 2009 in that perspective the gain of using kriging compared to knn is marginal still the accuracy robustness and feature selectiveness of the algorithm are promising traits in the light of developing best performing ptfs based on global datasets machine learning methods are often criticized for being a black boxes which are hard to interpret castelvecchi 2016 lipton 2018 however kriging relies on the statistical properties of the dataset which are translated into hyperparameters of the covariance kernel function this study demonstrates that these hyperparameters provide useful insights such as the predictive power of variables or the inherent uncertainty in the dataset in short kriging is a valuable technique for ptf development resulting in accurate and robust predictions in comparison to knn it reduces the need for expert knowledge in the selection of predictor variables moreover its hyperparameters can assist the interpretation of the results 5 conclusion the overall aim of this study was to evaluate whether kriging is a useful pedotransfer method this was done by comparing it for a wide range of datasets to a benchmark pedotransfer modelling approach the knn method kriging is a interpolation method which uses at its core the covariance of the dataset the covariance is modelled using an anisotropic kernel function which describes the relevance of each predictor variable to a response variable and quantifies the amount of inherent uncertainty in the dataset this reduces the need for expert knowledge to select predictor variables when using this method and improves the robustness of the predictions the monte carlo cross validation showed that kriging significantly outperforms knn in terms of bias accuracy and precision furthermore interpretation of the covariance kernel parameters can provide useful insights in the training datasets and resulting predictions we conclude that kriging is a accurate precise and robust data mining solution for pedotransfer functions credit authorship contribution statement jan de pue conceptualization methodology software formal analysis writing original draft yves dady botula software data curation writing review editing phuong m nguyen data curation writing review editing marc van meirvenne supervision wim m cornelis writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we greatly acknowledge the countless researchers and technicians who allow studies like this to be done by sharing their datasets in particular the contribution of maarten volckaert for lab analysis of samples in the flanders congo and mekong datasets we thank the anonymous reviewers for their constructive feedback we are grateful to sci hub for providing open and free access to scientific knowledge for everyone all calculations were done in python using scipy and matplotlib packages the code is available at https github com jandepue kriging ptf and https github com jandepue knn ptf appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2020 125770 supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
4653,data mining algorithms such as artificial neural networks ann and k nearest neighbour knn have proven their merits in pedotransfer function modelling kriging is a well known algorithm for spatial interpolation but in this study it is proposed as an alternative data mining technique it was compared to knn as a benchmark pedotransfer function to predict soil water retention for a wide range of datasets containing soil data from both temperate and tropical regions the performance of both methods was compared through monte carlo cross validation and the precision of the predictions was assessed with an ensemble procedure across all datasets a significant improvement in prediction bias accuracy and precision was found with kriging compared to knn moreover it was demonstrated how predictions with kriging are more robust and insensitive to non correlated predictor variables and how the optimized hyperparameters provide additional insight in the training dataset properties kriging was found to be a accurate precise and robust data mining solution for pedotransfer function modelling keywords data mining water retention curve k nearest neighbours precision nomenclature list of symbols c covariance k kernel function x predictor variable at prediction x predictor variable λ prediction weight std y standard deviation of a response variable y std yt standard deviation of a transformed response variable y ν gaussian radial kernel partial sill parameter σ y average ensemble standard deviation ϕ lagrange multiplier σ noise white noise kernel parameter σ y ensemble standard deviation k n number of neighbours in knn k r number of neighbours in kriging l gaussian radial kernel length scale parameters n x number of predictor variables p knn power parameter y response prediction y response variable 1 introduction soil plays a key role in numerous processes in the earth s ecosystem yet an often encountered obstacle is the lack of data to describe the properties of the soil adequately for example hydrological models or land surface models require a detailed description of the hydraulic and thermal soil properties but these properties are cumbersome and unfeasible to measure at large scale van looy et al 2017 on the other hand detailed data is available from more routinely measured soil properties such as texture bulk density and organic matter content pedotransfer functions ptf essentially exploit the relation between these soil properties and allow to predict the soil data that is needed from the data that is readily available bouma 1989 wösten et al 2001 throughout the years various approaches have been used to develop ptfs the classical pedotransfer functions were tabular reference values for soil texture classes or multivariate linear regression methods saxton et al 1986 vereecken et al 1989 rawls et al 1991 cornelis et al 2001 they are still widely used because of their simplicity and often low input requirements typically they have only a limited range of validity as they do not manage to capture the complex behaviour of soil properties with this basic approach or because they are based on a limited dataset tropical soils are a classic example where often they fail and yet are needed the most due to limited datasets high variability and complex behaviour schaap 2005 minasny and hartemink 2011 botula et al 2014 in the past decades data mining algorithms have proven to be superior compared to traditional regression methods given the advantages of being flexible and having no a priori assumptions of linearity they are capable to overcome the limitations of multivariate linear regression to a certain extent some widespread data mining methods used for ptfs are artificial neural networks ann schaap et al 2001 support vector machines svm twarakavi et al 2009 k nearest neighbour knn nemes et al 2006 and random forest tóth et al 2014 more recently ptfs using gaussian process regression have gained interest and have demonstrated a high potential kotlar et al 2019 ballabio et al 2019 al dosary et al 2019 in this study a variant of gaussian process regression gpr is evaluated i e kriging williams et al 1996 rasmussen and williams 2006 kriging is a geostatistical interpolation method originally developed for improved ore content prediction in mining krige 1951 matheron 1963 nowadays it is an essential tool for spatial interpolation in domains such as geology geotechnics soulie et al 1990 precision agriculture wollenhaupt et al 1994 and fisheries little et al 1997 it has become an successful interpolation method for non spatial variables as well in particular as a metamodelling tool sacks et al 1989 simpson et al 2001 wang and shan 2007 kleijnen 2009 in this study kriging is introduced as a data mining technique for ptfs in an attempt to improve the results obtained with the established methods the inception of this idea comes from the similarity between knn and spatial interpolation with inverse distance weighting idw in a context of spatial interpolation predictions with kriging are often found to be more accurate than with idw zimmerman et al 1999 li and heap 2011 it is our hypothesis that this will also be the case for the interpolation of non spatial variables with kriging compared to knn this idea has been coined before van looy et al 2017 but only limited research has been committed to this topic ramos et al 2014 used kriging in a similar way to predict water retention properties but used only two predictor dimensions i e two soil texture fractions however the algorithm is not restricted to two or three predictor dimensions as in spatial interpolation a more generalized methodology is presented in this study knn is one of the best performing ptf algorithms making it suitable as a benchmark to compare kriging with the established ptf methods haghverdi et al 2010 haghverdi et al 2015 nguyen et al 2017 the performance of interpolation methods is affected by the sampling density data variance spatial correlation and other properties of the dataset zimmerman et al 1999 li and heap 2011 therefore this evaluation was done for a range of datasets containing soil water retention data and soil properties from temperate and tropical regions the main objectives of this study are to introduce kriging as a ptf method and to compare the accuracy and precision of the predictions with knn across a range of datasets 2 materials and methods 2 1 kriging algorithm the algorithm used here is ordinary kriging it is a variant of gpr and is a well established method in geostatistics contrary to gpr not the complete training dataset is used in the prediction but only a selection of the nearest neighbours furthermore the mean of the response variable is assumed to be unknown and locally stationary i e for the nearest neighbours kriging is also referred to as best linear unbiased predictor blup it is linear in the sense that the predictions are a weighted linear combination of the training data 1 y x i 1 k r λ i y i where y is the predicted response variable for the vector of prediction variables x k r is the number of training data samples y i in the search neighbourhood and λ i is the weight for each of those samples the length of x is determined by the number of predictor variables n x kriging is unbiased as it imposes the condition that the mean error is zero it can be proven that this leads to 2 i 1 k r λ i 1 it is the best predictor as the core concept behind the algorithm is the minimization of the second moment of the prediction error from which follows 3 i 1 k r λ i x c x i x j ϕ c x i x for j 1 k r where c is the covariance note that a mathematically identical method can be derived in function of semivariance and ϕ is the lagrange multiplier bilonick 1991 pham 2005 cressie 2015 the covariance describes the autocorrelation of the response variable y in terms of lag distance of a predictor variable the covariance can be modelled using a kernel function k in this study the anisotropic gaussian radial basis function with white noise was used duvenaud 2014 4 c x x k x x ν 2 exp i 1 n x x i x i 2 2 l i 2 σ noise 2 δ x x where x i and x i are the predictor variables in x and x n x is the number of predictor variables ν 2 is the partial sill l i is the length scale parameter of the predictor variable σ noise 2 is the white noise variance and δ x x is the dirac delta function note that anisotropy is achieved by specifying different values of l for each predictor variable the hyperparameters ν l and σ noise are fitted to the training dataset by maximizing the log marginal likelihood rasmussen and williams 2006 the fitted hyperparameters of the covariance kernel provide some insight in the properties of the dataset prediction variables with a large length scale imply a low sensitivity of the response variable to this predictor variable furthermore the nugget effect i e the ratio between σ noise 2 and σ noise 2 ν 2 indicates how much of the variability in the response dataset is attributed to inherent uncertainty in the dataset it can be attributed to natural randomness measurement uncertainty or missing additional predictor variables to reduce the computational load a subset of the total training dataset is used to make the prediction in this case k r samples with the highest c x x were selected consequently the anisotropy in the dataset is reflected in the neighbourhood sample selection an example is shown in fig 1 after the selection of neighbours the vector with the weights λ is calculated as shown in the eqs 5 8 a contains the covariance between the selected neighbours b contains the covariance between the neighbours and the input and y k contains the response variable of the selected neighbours 5 a a 1 1 a 1 2 a 1 k r 1 a 2 1 a 2 2 a 2 k r 1 a k r 1 a k r 2 a k r k r 1 1 1 1 0 a i j c x i x j 6 b b 1 b 2 b k r 1 b i c x i x 7 λ λ 1 λ 2 λ k r ϕ y k y 1 y 2 y k r 0 8 λ a 1 b the weighted sum of response variable of the neighbours returns the prediction y 9 y λ y k all calculations were done in python the code and demo are available at https github com jandepue kriging ptf 2 2 k nearest neighbours to evaluate the performance of this method it was compared to the knn algorithm as applied in e g nemes et al 2006 and botula et al 2013 in comparison to other methods such as svm ann linear regression it is amongst the best performing and most flexible ptf algorithms nemes et al 2006 lakzian et al 2010 patil et al 2012 nguyen et al 2017 similar to kriging the prediction is a weighted sum of samples in the training dataset but the selection of neighbours and attribution of weights solely depends on the euclidean distance in the predictor space x x i and a power parameter p eq 10 an example is show in fig 1 all calculations were done in python the code and demo of the knn algorithm is available at https github com jandepue knn ptf 10 y x i 1 k n λ i x y i λ i x x x i i 1 k n x x i p i 1 k n x x i i 1 k n x x i p 2 3 evaluation 2 3 1 datasets the quality of a ptf or any data mining application in general largely depends on the training dataset to properly evaluate the performance of this ptf a range of soil datasets of various sizes and origins predictor and response variables was used a summary with predictor and response variables and some basic statistics is given in table 1 a more detailed analysis of the correlation between predictor and response variables is given in the supplements lowercongo is a dataset which was originally used in botula et al 2013 it consists of 139 samples collected by botula 2013 in lower congo pearson correlations are highest for bulk density 0 80 at pf 0 and sand 0 94 clay 0 94 at pf 4 2 ph is the predictor variable with the lowest correlation max 0 20 in this dataset flanders is a dataset of 155 samples collected in agricultural fields in flanders and cover all major textural classes according to the belgian textural triangle samples were taken from three layers i e the topsoil 0 30 cm the compacted subsoil 30 60 cm and the subsoil 60 90 cm van der bolt et al 2016 this is the dataset with the lowest overall variation in water retention data the pearson correlation is the highest for clay content over the whole range of the water retention curve 0 71 0 88 carbon content has the lowest overall correlation max 0 20 mekong is a dataset from the mekong delta in vietnam developed by nguyen et al 2015 containing 158 samples taken from crop lands bulk density has the highest pearson correlation at pf 0 0 72 and clay at pf 4 2 0 88 the stability index as defined by nguyen et al 2015 has an overall low correlation max 0 14 unsoda refers to the unsaturated soil hydraulic database nemes et al 2001 it is a large open database of soil properties mostly of north american and european origins a selection of 491 samples was made to retain samples with all important predictor properties texture and bulk density and response properties the water retention data in the unsaturated soil hydraulic database is not restricted to a standardized set of matric potentials to obtain a uniform dataset with a fixed set of matric heads for each sample some points on the water retention curve are approximations by averaging of nearest points within a pf range of 0 1 all four predictor variables have a high correlation with the response variables min 0 46 overall sand has the highest correlation 0 79 0 81 igbp dis is the international geosphere biosphere programme igbp database from the international soil reference and information centre isric tempel et al 1996 this open dataset contains 1772 samples and detailed soil texture data covering both temperate and tropical soils cec has the highest pearson correlation at pf 2 0 0 88 and clay at pf 4 2 0 88 overall caco3 has the lowest correlation max 0 03 and a high standard deviation 14 41 euhydi is the european hydropedological data inventory weynants et al 2013 consisting of data from 18 countries with contributions from 29 institutions in the european union this is the largest dataset used in this study a selection was made based on the availability of soil properties which led to 2 versions of this dataset euhydi containing the basic predictor variables and euhydi full with a wider range of predictor variables due to predictor data availability euhydi contains 2248 samples whereas euhydi full contains 687 samples also here some points of the water retention curve are obtained by averaging of nearest points within a pf range of 0 1 clay has the highest correlation over the whole range of the retention curve for euhydi 0 75 0 77 and also for euhydi full but to a lower degree 0 55 0 64 the same is observed for other predictor variables in this dataset it seems that the euhydi full subselection results not only in a smaller amount of samples but the data contains less linear correlation as well the selection of predictor variables in machine learning methods is an important factor influencing the result the presence of irrelevant predictors could be detrimental to the prediction accuracy schaap et al 2001 nemes et al 2003 to evaluate the robustness of the kriging and knn algorithms three additional random predictor variables uniform distribution between 0 and 1 are introduced in lowercongo correlations max 0 21 the resulting perturbated dataset is labelled lowercongo spike the size of the training dataset remained unchanged the difference in rmse between the predictions with lowercongo and lowercongo spike are an indication of the sensitivity to uncorrelated predictors variables as some variables in the dataset are not normally distributed we have applied a box cox power transformation to each predictor and response variable with optimized lamba parameter to maximize the log likelihood function box and cox 1964 the resulting histograms and probability plots are given in the supplementary material overall an improved normality was obtained note similar results to the ones presented here were obtained without box cox power transformation as well the resulting predictions were backtransformed for validation see below 2 3 2 hyperparameter optimization the performance of the knn algorithm depends on the hyperparameters k n and p in an exploratory study a brute force minimization of the rmse with these parameters was performed to evaluate the response surfaces the rmse validation objective surfaces and the optimum for the response variables in all datasets are given in the supplements in accordance to findings in literature it was found that the optimal k n for knn was correlated to the size of the training dataset nemes et al 2006 however a near optimal performance can be achieved for 5 k n 60 given the correct tuning of p in most cases increasing k n is then compensated by increasing the influence of the closest neighbours with p an exception here was the euhydi dataset where optimal performance was found at high k n and low p which results in a smooth prediction similar to knn the number of neighbours considered for each prediction could influence the performance of the kriging algorithm the effect of hyperparameter k r was therefore evaluated as well the effect of k r on the accuracy of the kriging predictions is given in the supplements the sensitivity to k r was fairly low in particular when k r 20 contrary to knn the optimal performance was rarely found at k r 20 a typical property of the kriging algorithm is the so called declustering and shielding effect selected training data samples which are close together in the predictor space are of less influence for the prediction this explains why in contrast to knn k r is fairly insensitive to a too high setting since the effect of the amount of neighbours was limited it was chosen to compare both methods using the same amount of neighbours i e k n k r 50 it was verified that a comparison using the optimal k n lead to similar results 2 3 3 validation the validation indices used to evaluate the performance of both algorithms are mean error me root mean square error rmse and nash sutcliffe efficiency coefficient ns me and rmse respectively indicate the bias and accuracy of the predictions and ns assesses the overall predictive power of the algorithm they were calculated as in eqs 11 13 in which y and y o are the predicted and observed values and m is the number of samples significant differences in the validation indices between both methods were evaluated with the wilcoxon rank sum test 11 me m y y o m 12 rmse m y y o 2 m 13 ns 1 m y o y 2 m y o y o 2 with each prediction of a ptf there is an associated uncertainty this uncertainty is not only related to the accuracy of the prediction but also to its precision precision is defined as the closeness of agreement between test results iso5725 1 1994 1994 it is related to the variability of the training dataset as well as the robustness of the ptf algorithm a low prediction precision can be associated with a less densely sampled region of the predictor space a high local response variable uncertainty in the dataset or the sensitivity of the ptf algorithm to outliers it can be used to determine prediction intervals for the prediction but is not an indicator of the accuracy of the prediction schaap and leij 1998 schaap et al 2001 nemes et al 2006 botula et al 2013 to evaluate the precision of a prediction an ensemble of 100 predictions was created using a random 80 subset of the training dataset from the resulting ensemble of 100 predictions for each validation sample the mean gives the predicted value y and the ensemble standard deviation σ y indicates the precision of the prediction it was verified that the number of repetitions in the ensemble was sufficiently large to achieve stable results not shown the average ensemble standard deviation for all predictions of a response variable σ y was calculated to evaluate the average precision of the predictions 14 σ y m σ y m 2 m to achieve an independent evaluation a monte carlo cross validation was performed burman 1989 the datasets were randomly resampled into 70 training dataset and 30 test dataset the training dataset was used to optimize the hyperparameters i e p for knn and covariance kernel fit for kriging and the test dataset was used for validation this was repeated 10 times to guarantee stable results the validation indices me rmse ns and σ y were calculated for the concatenated results i e micro averaged 3 results 3 1 hyperparameter optimization the relative contribution of ν and σ noise is shown in fig 2 a the kriging hyperparameters of the euhydi and euhydi full dataset had a very high nugget effect which would indicate a smooth prediction this is also reflected in the optimized knn hyperparameters for those datasets ν and σ noise are scaled by the standard deviation of the associated box cox transformed response variable std yt to allow intercomparison between the datasets the prediction is most sensitive to predictor variables with a short length scale i e less smooth predictions to illustrate this the length scale of bulk density and clay are plotted here in function of the matric potential pf of the predicted water content fig 3 it is well established that bulk density is a soil property which is more related to water content at lower pf values whereas the influence of texture increases at high pf this is reflected in these results as well the length scale parameter of bulk density overall increases with pf whereas the opposite is found for clay a notable exception is found for the flanders datasets where the length scale parameter decreases with pf an overview of the fitted covariance kernel length scale parameters is shown in fig 2b datasets with an overall short length scale like euhydi have a low covariance at short distances on the contrary the mekong dataset has a high covariance furthermore the range of the length scales indicates the anisotropy in the dataset the lowercongo flanders and mekong dataset express a much larger anisotropy than euhydi 3 2 evaluation given the optimized hyperparameters and k n k r 50 the performance of the kriging algorithm was compared to the knn performance for all datasets scatterplots of the resulting me rmse and ns are shown in fig 4 the full validation results are given in table 2 together with the mean of the validation indices and the result of a wilcoxon rank sum test to check for significant differences between knn and kriging the bias in the predictions indicated by me was reasonably small for both methods across all datasets the mean me was negligable yet a significant improvement in the absolute value of me was found with kriging as also illustrated in fig 4a overall both methods achieved excellent results ns 0 70 and rmse 0 050 m3m 3 the overall rmse and ns were significantly better for kriging the most accurate predictions were found with the lowercongo and flanders datasets the least accurate predictions were for igpb dis at pf 2 0 and 2 5 the predictions were more accurate with kriging than with knn over the full pf range for the flanders mekong igbp dis datasets and most of lowercongo dataset in the case of the unsoda dataset the predictions were more accurate with knn and both methods achieved similar performance for euhydi and euhydi full the precision of the predictions indicated by σ y is shown in fig 4d an overall major and significant improvement was achieved using kriging notable exceptions were some of the lowercongo response variables as well as the euhydi dataset the robustness of the algorithms to predictor variable selection was tested by comparing the accuracy of the predictions with the lowercongo and lowercongo spike dataset the effect of the random predictor variables on the accuracy of knn and kriging is shown in fig 5 where a substantial decrease in ns is found with knn the kriging predictions were fairly insensitive to the presence of random variables 4 discussion excellent results were achieved with both methods across all datasets but the predictions with kriging were significantly less biased and more accurate than the predictions with knn the results here are comparable to outcomes of other studies for temperate soils schaap et al 2001 reported a rmse of 0 068 m3m 3 with an ann parametric ptf based on the unsoda dataset with kriging a rmse of 0 055 m3m 3 is found using the same predictors but excluding the error due to the van genuchten model fit a study by tóth et al 2015 using european datasets achieved a higher accuracy of 0 030 m3m 3 with regression trees and mlr nguyen et al 2017 reported a rmse of 0 050 m3m 3 using knn and ann for the mekong dataset similar to the results found here the same dataset using svm or mlr resulted in a lower accuracy of 0 066 m3m 3 when comparing kriging to knn considerable improvements in accuracy were found for less densely sampled datasets i e lowercongo flanders and mekong this coincides with improvements in precision for those datasets the robustness of kriging for smaller datasets is promising for ptfs in regions where data is sparse such as the tropical regions particularly in developing countries an important difference between knn and kriging occurs when uncorrelated predictor variables are present as demonstrated with the lowercongo spike experiment in such case the prediction accuracy of knn decreases significantly more than with kriging the covariance of the dataset is at the core of the kriging algorithm modelling it with an anisotropic kernel function allows kriging to discriminate between the importance of each predictor the length scale parameters of the kernel provide useful insight in the sensitivity of the prediction to a predictor variable as demonstrated with bulk density in fig 3 expected physical relations are revealed the accuracy of the predictions with kriging was in particular better for datasets with a high degree of anisotropy i e lowercongo flanders mekong and igpb dis as indicated by the wide range of length scales of the predictors in fig 2 in some datasets like unsoda or euhydi the correlation with the response variables is very high for all predictor variables in those datasets the isotropic knn algorithm has a similar performance compared to kriging the study of kotlar et al 2019 also demonstrated that the feature selection capability is a valuable trait of gpr the limiting factor for the accuracy of the predictions with any ptf algorithm is the inherent uncertainty in the training dataset which can be attributed to missing predictor variables natural randomness or measurement uncertainty wösten et al 2001 this is quantified by the σ noise parameter of the covariance kernel in fig 6 it is illustrated that the accuracy of the predictions with kriging approach this limit to allow intercomparison rmse and ν are scaled by the standard deviation of the corresponding response variables std y and box cox transformed variables std yt respectively in this study the main factor determining the performance of ptfs is thus the training dataset and not the algorithm the introduction of additional water retention data as predictor variables can improve the performance of a ptf drastically vereecken et al 2010 furthermore simple mlr ptfs trained on local datasets can outperform machine learning ptf trained on a global dataset weynants et al 2009 in that perspective the gain of using kriging compared to knn is marginal still the accuracy robustness and feature selectiveness of the algorithm are promising traits in the light of developing best performing ptfs based on global datasets machine learning methods are often criticized for being a black boxes which are hard to interpret castelvecchi 2016 lipton 2018 however kriging relies on the statistical properties of the dataset which are translated into hyperparameters of the covariance kernel function this study demonstrates that these hyperparameters provide useful insights such as the predictive power of variables or the inherent uncertainty in the dataset in short kriging is a valuable technique for ptf development resulting in accurate and robust predictions in comparison to knn it reduces the need for expert knowledge in the selection of predictor variables moreover its hyperparameters can assist the interpretation of the results 5 conclusion the overall aim of this study was to evaluate whether kriging is a useful pedotransfer method this was done by comparing it for a wide range of datasets to a benchmark pedotransfer modelling approach the knn method kriging is a interpolation method which uses at its core the covariance of the dataset the covariance is modelled using an anisotropic kernel function which describes the relevance of each predictor variable to a response variable and quantifies the amount of inherent uncertainty in the dataset this reduces the need for expert knowledge to select predictor variables when using this method and improves the robustness of the predictions the monte carlo cross validation showed that kriging significantly outperforms knn in terms of bias accuracy and precision furthermore interpretation of the covariance kernel parameters can provide useful insights in the training datasets and resulting predictions we conclude that kriging is a accurate precise and robust data mining solution for pedotransfer functions credit authorship contribution statement jan de pue conceptualization methodology software formal analysis writing original draft yves dady botula software data curation writing review editing phuong m nguyen data curation writing review editing marc van meirvenne supervision wim m cornelis writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we greatly acknowledge the countless researchers and technicians who allow studies like this to be done by sharing their datasets in particular the contribution of maarten volckaert for lab analysis of samples in the flanders congo and mekong datasets we thank the anonymous reviewers for their constructive feedback we are grateful to sci hub for providing open and free access to scientific knowledge for everyone all calculations were done in python using scipy and matplotlib packages the code is available at https github com jandepue kriging ptf and https github com jandepue knn ptf appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2020 125770 supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
4654,the development of run of river hydropower requires the flow duration curve fdc to estimate the electricity production as obtaining an fdc based on gauging station streamflow requires significant cost and time i e more than several years it is important to predict the fdc in the absence of streamflow data an analytical probabilistic model of streamflow dynamics p q model can calculate the fdc which requires several rainfall and runoff recession parameters to estimate the recession parameters in the absence of discharge data we selected two approaches the geomorphic recession flow model grfm and geological recession approach gra the grfm and gra associate the river network and geology respectively with runoff recession features this study aims to comprehend the characteristics of the grfm and gra employed in the p q model by targeting 57 basins throughout japan we found different performance trends between the grfm and gra that corresponded to specific basin characteristics while the grfm performed well in high precipitation basins the gra performed well in basins with abundant unconfined groundwater contributions these results agree with the features in the derivations of the grfm and gra in addition we found a complementary relationship between the grfm and gra based on the baseflow index bfi which suggests that the complementary relationship is one method to improve the performance of the p q model in the absence of streamflow data keywords flow duration curve river network geology hydropower basin characteristics baseflow index 1 introduction japan is characterized by a unique combination of geomorphological and climatic features including steep watersheds and heavy rainfall oguchi et al 2001 which indicate its suitability for hydropower energy production bildirici 2019 recent developments in small scale hydropower plants have captured the country s attention as the japanese government introduced a feed in tariff for small scale hydropower schemes in 2012 fujii et al 2017 in particular run of river hydropower schemes are strongly dependent on the use of the flow duration curve fdc to plan plant capacity i e design flow and to set environmental flow standards for the protection of riverine ecosystems poff et al 1997 castellarin et al 2013 basso and botter 2012 obtaining an fdc based on gauging station streamflow however requires significant cost and time i e more than several years therefore predicting the fdc in the absence of streamflow data is important botter et al 2007 botter et al 2009 developed an analytical probabilistic model of streamflow dynamics hereafter referred to as the p q model which describes the steady state probability distribution function of daily streamflow as the fdc can be mathematically computed as the complement of the cumulative density function cdf of daily streamflow the p q model can also express the fdc botter et al 2008 numerous studies have successfully applied the p q model to a wide range of hydro climatic regimes ceola et al 2010 doulatyari et al 2015 2017 lazzaro et al 2013 santos et al 2018 2019 the p q model requires a limited number of climatic and physiographic parameters doulatyari et al 2015 proposed a framework to estimate these parameters based only on catchment scale climatic and geomorphologic features this indicates that the p q model has the ability to predict the fdc in the absence of streamflow data the parameters were composed of the mean rainfall depth α frequency of effective rainfall events λ and runoff recession parameters a and k doulatyari et al 2015 doulatyari et al 2017 assigned α using observed daily rainfall data and estimated λ by applying a water balance model the runoff recession parameters a and k were computed via a geomorphic recession flow model grfm developed by biswal and marani 2010 as the grfm relates the runoff recession to the river network the recession parameters can be obtained by analyzing geomorphological data i e digital elevation models dems biswal and marani 2014 carlier et al 2018 pointed out that few studies have considered geological features within the runoff recession in comparison with those that have considered surface features e g topography land use and soil type nevertheless musiake et al 1981 found distinct differences in low flows that corresponded to six geological classifications throughout japan subsequently takahasi et al 1983 proposed runoff recession parameters corresponding to the geological classification based on the runoff recession during dry days therefore applying these parameters to the p q model may be a suitable approach to estimate the fdc in the absence of streamflow in this study we expand the parameterization framework proposed by doulatyari et al 2015 by adding the geological recession approach gra this study aims to 1 comprehend the characteristics of the grfm and gra employed for the parameterization of the p q model and 2 investigate the relationship between the performance of each model and the basin characteristics fig 1 shows the work flow of this study first 57 target basins in japan with negligible anthropogenic impacts were selected to estimate the frequency of effective rainfall events λ it is necessary to estimate the mean runoff coefficient i e the ratio of the mean discharge to mean precipitation by applying a water balance model doulatyari et al 2015 2017 we note that doulatyari et al 2015 have already evaluated the performances of four water balance models for the p q model in addition the present study aims to comprehend the characteristics of the grfm and gra for the p q model therefore we applied the observed value for the mean runoff coefficient fig 1 next we evaluated the performance of the p q model with the application of the grfm and gra furthermore we prepared 184 basin characteristics related to the climate runoff land use geology soil topography and vegetation in each basin finally we investigated the relationships between the performance of each model and the basin characteristics 2 study basins and basin characteristics to evaluate the performance of the p q model it was necessary to eliminate any anthropogenic influences on the discharge data obtained from the study basins the japanese ministry of land infrastructure transport and tourism releases daily discharge data in their database of dams see http mudam nilim go jp home we set the following selection criteria for dam basins 1 there were no dams and hydropower stations upstream 2 the forest coverage rates were 70 which was implemented to eliminate the effect of impervious surfaces caused by human induced land use changes e g urbanization 3 a minimum of 10 years of discharge records were available and 4 the basin had a minimum catchment size of 10 km2 to reduce sampling errors beck et al 2015 based on these criteria we selected 57 basins throughout japan see supplementary fig s1 the average forest coverage rate basin size and data period were 94 71 100 63 0 km2 10 4 470 0 km2 and 21 2 years 12 23 years respectively see supplementary table s1 japan has one of the heaviest annual snowfalls in the world kazama et al 2008 as snowmelt runoff may disrupt evaluations of the performance of the grfm and gra we targeted the period from june to november to eliminate the effect of snowmelt runoff as previously mentioned we set 184 basin characteristics related to climate runoff land use geology soil and vegetation indices to investigate their impacts on the performance of the p q model except for the runoff indices the data sources and methods used to calculate the basin characteristics are described in the supplementary materials as we employed the runoff indices associated with the parameters of the p q model see supplementary table s2 the calculation methods are described in sections 4 1 and 4 2 3 calculation of p q model 3 1 model framework the p q model is one of several analytical probabilistic models for streamflow dynamics which describes the steady state probability distribution function of the daily streamflow botter et al 2007 2009 this model originated from the analysis of long term soil water dynamics within the root zone rodriguez iturbe and porporato 2004 see supplementary fig s2 rodriguez iturbe and porporato 2004 successfully described soil water dynamics by applying the following three processes first they applied a stochastic rainfall model where the daily rainfall depth α and rainfall intervals 1 λp both followed an exponential distribution i e a marked poisson process second they considered linear soil water losses due to evapotranspiration third they considered an instantaneous deep percolation that produces effective rainfall if the soil moisture exceeded a threshold due to rainfall which contributed to an increment of the basin storage s botter et al 2009 obtained a new marked poisson process between the exceedance i e effective rainfall depth and effective rainfall interval 1 λ linking runoff q to s using a nonlinear reservoir model which developed the p q model the water balance of s s t can be expressed as eq 1 1 ds t dt q t ξ t where q t is the runoff in time t and ξ t represents the stochastic increment of s due to effective rainfall the nonlinear reservoir model can be described as eq 2 2 q t k b s t n where kb and n are parameters with respect to runoff recession the temporal dynamics of q can be expressed by assigning eq 2 to eq 1 as eq 3 3 dq t dt k q t a ξ q t where a and k are the runoff recession exponent and coefficient respectively and ξq t represents the stochastic increment of q due to the effective rainfall we note that the recession parameters a and k are linked to kb and n by eqs 4 and 5 4 a 2 1 n 5 k n k b 1 n botter et al 2009 developed the p q model by applying the marked poisson process to s and the nonlinear reservoir model eq 2 which can be described as eq 6 6 p q c q a exp q 2 a α k 2 a λ q 1 a k 1 a where α is the mean rainfall depth on rainy days λ is the mean frequency of effective rainfall and c is the normalizing constant we note that eq 6 is intended for a 1 which represents a significant portion of basins worldwide biswal and marani 2010 mutzner et al 2013 the fdc d q in eq 7 expresses the complement of the cdf of q which can be expressed as eq 7 7 d q q p x d x the above model is intended for subsurface contributions to streamflow and does not include the effects of faster surface contributions or snow accumulation and melting processes however according to botter et al 2009 the subsurface contributions to streamflow considerably exceed the surface contributions particularly at daily timescales and in the absence of extensive impermeable surfaces in addition the p q model assumes the spatial homogeneity of climate and landscape properties due to the derivation notably the p q model has been applied successfully in relatively small catchments i e catchment size 500 km2 ceola et al 2010 lazzaro et al 2013 santos et al 2018 2019 similar to the range of our target basins 10 4 470 0 km2 3 2 model evaluation we constructed an fdc for the entire streamflow record to yield a long term representation of the streamflow regime vogel and fennessey 1995 the fits of the p q model were assessed by adopting the kolmogorov smirnov distance cks ceola et al 2010 santos et al 2018 2019 this indicator expresses the maximum distance between the observed and calculated cdf for daily streamflow as we aim to investigate the relationships between model performance and basin characteristics we conducted a spearman s rank correlation analysis between the cks and basin characteristics 4 parameter estimation for the p q model the p q model requires four parameters i e α λ a and k to predict the fdc in this study we applied the observed data for α and λ these details are described in appendix a and b respectively this section shows how to estimate the recession parameters in the grfm and gra 4 1 recession parameters a k in the grfm biswal and marani 2010 developed the grfm to estimate recession parameters based on river network morphology fig 2 according to biswal and marani 2010 the discharge at a basin outlet is approximately equal to the water drained by various subsurface storage units of the basin at that time as expressed by eq 8 8 q q t g t a where g t is the length of the active drainage network adn at the basin q t is the flow drained per unit adn length and a is the basin size biswal and marani 2010 assumed that q t was spatially constant the dynamics of q can be expressed as eq 9 9 dq dt 1 a q t dg t dt dq t dt g t on the right side of eq 9 the first term expresses the runoff recession due to a retraction of the adn while the second term expresses the runoff recession due to a decrease in the drainage rate per unit channel length fig 2 provides a schematic diagram expressing the retraction of the adn the grfm assumes that the first term becomes dominant based on observations from previous studies i e dq t dt 0 the grfm further assumes a retraction speed i e c dl dt if l is the distance of an adn tip from its farthest channel head fig 2 the grfm sets l c t by assuming that c is constant in space and time these assumptions allow us to set g t g l t which further allows us to develop eqs 9 into 10 10 dq dt 1 a q dg t dt 1 a qc dg l dl q c n l a where g l is the total length of the adn at l from the channel heads at the same time the number of channel links become n l dg l dl focusing on the runoff recession period we can eliminate the effect of effective rainfall in eq 3 i e ξ q t 0 as follows 11 dq t dt k q t a equation 11 can be further developed by assigning eqs 8 and 10 as follows 12 n l a ρ g l a a where ρ k q a 1 c equation 12 allows us to estimate the recession exponent a using the river network morphology we obtained n l and g l by analyzing 90 m resolution hydrosheds dem data lehner et al 2008 based on the river network algorithm proposed by biswal and marani 2014 we estimated a using the least squares method based on the relationship between n l and g l we note that biswal and marani 2014 assigned n l 2 as a lower limit for the least squares method hence we also applied this threshold to the least squares method which resulted in a the recession coefficient k was calculated as a function of a the derivation of which is described in appendix c 4 2 recession parameters a k in the gra ding 1966 proposed a nonlinear storage discharge relationship for an unconfined aquifer as follows 13 q b t 2 s 2 where bt is the parameter with respect to the runoff recession this relationship has often been used for long term runoff analysis in hill slope basins ando et al 1983 1984 equation 13 indicates that n 2 and k b b t 2 in eq 2 wittenberg 1999 referred to n 2 as the theoretical standard value for the storage discharge relationship for unconfined aquifers assigning n 2 and k b b t 2 in eqs 4 and 5 respectively we obtain a 1 5 and eq 14 14 k 2 b t ding 1966 also expressed a recession curve equation for an unconfined aquifer as follows 15 1 q n 1 q 0 b t t n where q 0 is the initial baseflow discharge equation 15 agrees with a special form i e a 1 5 of the recession curve equation proposed by wittenberg 1999 first takahasi et al 1983 set q 0 as q on the third day after a peak with a minimum recession period of 10 days next they used the least squares method for the recession periods to calculate bt for 59 basins in japan as a result they proposed a representative seasonal bt value that corresponded to six geological types as classified by musiake et al 1981 in this study we applied bt by averaging the values from summer and autumn due to the target season i e june to november see supplementary table s5 the six geological types were classified using the japanese national land numerical information nlni database see http nlftp mlit go jp ksj e index html with a resolution of 1 km we averaged bt corresponding to the rate of the geological type in the basin in addition we observed bt in our target basins using the least squares method as described above finally we obtained k based on the geological type and observations by assigning bt to eq 14 we note that the baseflow index bfi which is defined as the ratio of the mean long term baseflow to the total streamflow smakhtin 2001 was selected as a basin characteristic in this study we computed the bfi using the recursive digital filter proposed by van dijk 2010 because this method applies the storage discharge relationship to the runoff model in common with the p q model eq 2 as we assumed that the baseflow contribution was subject to unconfined aquifers we applied a 1 5 and the observed k to the digital filter method 5 results 5 1 recession parameters in the p q model first we present the estimation processes for the recession parameters as an example the jozankei and sanzai basins with catchment sizes of 104 and 29 km2 respectively were selected for the example fig 3 a fig 3 b shows the relationship between n l and g l following the analysis of 90 m resolution dem data based on the river network algorithm biswal and marani 2014 we calculated a in the grfm by using the least squares method for eq 12 based on the relationship we note that n l 2 was selected as a lower limit for the least squares method in accordance with biswal and marani 2014 fig 3 c shows the 1 km resolution geological map based on the nlni database for the gra in the sanzai basin we only obtained the bt corresponding to mesozoic strata because of the geological homogeneity in this area because the jozankei basin is geologically heterogeneous i e it contains tertiary volcanic rock and tertiary strata we averaged the bt corresponding to the rate of the geological type in the basin these processes allowed us to obtain the recession parameters in the absence of streamflow data table 1 shows the results of the parameters in the p q model the averaged a in the grfm 2 06 was larger than that in the gra 1 50 which means that faster runoff recession occurred in the grfm in comparison to that in the gra in addition the coefficient of variation of k in the gra 0 25 was lower than that of the grfm 0 42 considering that a in the gra was constant our results are indicative of lower variations in runoff recession among the basins in the gra in comparison to those in the grfm 5 2 performance of the p q model with grfm and gra figs 4 and 5 show the results of the probability densities for the daily streamflow and fdcs respectively fig 6 presents the results of the cks for the grfm and gra where a lower cks value i e c ks 0 indicates a better performance in the p q model the median cks was lower in the grfm 0 21 than that in the gra 0 30 which indicates that the overall performance of the grfm was better than that of the gra fig 6 however the cks distribution range for the grfm was wider than that of the gra fig 6 we also conducted a spearman s rank correlation analysis between the cks values estimated from both models for each basin to investigate performance trends as a result there was a significant negative correlation for the performance between the grfm and gra ρ 0 65 p 0 01 which indicates that the performance trends were opposite between both models 5 3 relationships between p q model performance and basin characteristics tables 2 and 3 list the results of the spearman s rank correlation analysis between the cks and basin characteristics for the grfm and gra respectively ρ 0 50 p 0 01 although the trends of these correlations positive or negative were opposite between both models tables 2 and 3 the bfi and mean temperature showed significant correlations in the grfm and gra the performance of the gra was also positively correlated with the rain indices table 3 we also observed that climate indices except for the bfi mainly influenced the performances in both models tables 2 and 3 6 discussion 6 1 differences in the performance characteristics between the grfm and gra we obtained opposite trends for the performances between the grfm and gra ρ 0 65 p 0 01 as well as for the correlations between the performances and basin characteristics of both models tables 2 and 3 to discuss these results we focus on the differences in the derivation between both models biswal and marani 2010 derived the grfm by linking adn dynamics to the runoff recession fig 2 according to biswal and marani 2014 the adn can express a relatively rapid response as the first term on the right side of eq 9 expresses the adn retraction biswal and marani 2010 eliminated the second term in this study the cks in the grfm has a negative and significant correlation with the mean temperature tmean table 2 we investigated the relationship between the α and tmean which exhibited a significant positive correlation ρ 0 73 p 0 01 fujibe 2015 also reported that extreme precipitation has a positive correlation with the mean temperature throughout japan these observations indicate that the grfm tends to be characterized by a high performance in basins with elevated precipitation which suggests that the adn retraction controls the runoff recession on the other hand the second term on the right hand side of eq 9 expresses the runoff recession caused by phreatic aquifers biswal and marani 2014 i e the boussinesq equation brutsaert and nieber 1977 according to ding 2013 eq 15 is an alternate expression of the boussinesq model for unconfined aquifers which forms the basis of the gra we calculated the bfi by applying the boussinesq model which had a significant correlated with the cks in the gra ρ 0 77 p 0 01 table 3 this result indicates that the gra tended to exhibit a high performance in basins with abundant unconfined groundwater contributions as the study basins were selected from the most upstream dam basins they had a relatively steep geomorphological feature several studies conducted sprinkling field experiments to comprehend the mechanism of subsurface flow in a steep catchment in the oregon coast range anderson et al 1997 torres et al 1998 montgomery and dietrich 2002 integrating these experimental results montgomery and dietrich 2002 conceptualized that rapid subsurface flow in near surface fractured bedrock and deeper bedrock flow generates runoff in steep catchments this study shows that the performance of the gra became poor when increasing the mean maximum daily rainfall depth pmax table 3 which may derive from the difficulty to express the rapid subsurface flow by the gra we observed good poor performance of the gra grfm in relation to the low tmean although we eliminated the effect of snowmelt runoff by limiting the target period i e june to november japan has one of the highest annual snowfall rates in the world kazama et al 2008 in addition the snowmelt component exerts a strong influence on groundwater recharge earman et al 2006 these facts indicate that the target basins with low tmean can produce abundant groundwater contributions as a result of the snowmelt component even during the non snowmelt season given the derivation of the grfm and gra we can consider these conditions as being agreeable disagreeable with the gra grfm 6 2 performance improvements to the grfm and gra the overall performance of the grfm was better than that of gra whereas the performance of the grfm was associated with a large error variability fig 7 to improve the performance of the grfm we focus on the calculation of a in the grfm agrfm in fact the agrfm was calculated using the least squares method based on the relationship between n l and g l fig 3 b we assigned n l 2 as the lower limit for the least squares method in accordance with biswal and marani 2014 as the threshold of n l directly affects the agrfm it should be possible to obtain the appropriate threshold therefore we searched for the optimal performance in the grfm by changing the threshold of n l from 1 to 100 which provided a significant improvement to the grfm fig 7 fig 8 shows the median cks in the grfm when changing the threshold of n l which indicates that there is an appropriate threshold value while we used dem data with a 90 m resolution for our calculations previous studies calculated the agrfm using a resolution of 30 m biswal and marani 2010 2014 doulatyari et al 2015 2017 we should also investigate an appropriate relationship between the resolution of the dem data and the agrfm we evaluated the performance improvement in the gra by applying the observed k fig 7 although the performance of the gra improved by applying the observed k we observed limitations to this improvement fig 7 nevertheless the gra exhibited a high performance in basins with abundant unconfined groundwater contributions table 3 these observations suggest that we can appropriately apply the gra only to unconfined groundwater contributions by separating the direct and groundwater contributions from streamflow ando et al 1983 1984 developed a hydrological model by applying the boussinesq model to the groundwater contribution applying the recursive digital filter van dijk 2010 to the separation may be one of the most appropriate approaches because the digital filter can reflect the boussinesq model after improvements future studies should evaluate the gra s ability to capture streamflow characteristics 6 3 complementary relationship between the grfm and gra we found that the performance trends responses to basin characteristics and derivation background were opposite between the grfm and gra which indicates that there is a complementary relationship between both models we discuss the potential to improve the performance by selecting the model based on the basin characteristics as the bfi has a significant correlation with the performance of both models tables 2 and 3 we employed the bfi as a criterion to select the model fig 9 shows the results of complementary relationship between the grfm and gra based on the bfi we note that we show the complementary relationship in fig 9 when applying the original models fig 6 and optimized models fig 7 in addition the threshold of the bfi in fig 9 indicates the lower limit to select the cks in the gra both cases showed the best performance when the threshold of the bfi was equal 0 75 fig 9 which outperformed the case that individually applied the grfm and gra figs 6 and 7 therefore we can conclude that improving the performance by applying the complementary relationship between the grfm and gra based on the bfi is useful certain studies have developed global bfi maps with high accuracy beck et al 2013 2015 which may be useful for the criterion of the complementary relationship in the absence of streamflow data 7 conclusions we introduced the grfm and gra in the parameterization framework for the p q model whose characteristics were evaluated throughout japan the grfm can express a relatively rapid response because of its derivation we observed that the grfm performed well in basins with high precipitation which agrees with the features of its derivation the overall performance of the grfm was better than that of the gra in addition optimizing the threshold of n l in the calculation of agrfm significantly improved the performance of the grfm the gra originated from the boussinesq model for unconfined aquifers we observed that the gra performed well in basins with abundant unconfined groundwater contributions which agrees with the features of its derivation our results also indicate that the gra is unsuitable for basins with a high rapid flow contribution although the performance of the gra improved by applying the observed k we observed limitations to this improvement therefore we recommend that the gra should only be appropriately applied to unconfined groundwater contributions we also evaluated a complementary relationship between the grfm and gra based on the bfi which outperformed the case that individually applied the grfm and gra this result suggests that the complementary relationship between the grfm and gra is one of methods to improve the performance of the p q model in the absence of streamflow data credit authorship contribution statement ryosuke arai conceptualization methodology software validation formal analysis writing original draft visualization yasushi toyoda supervision project administration funding acquisition so kazama writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a mean rainfall depth on rainy days α in this study rain indices including α were estimated using aphro jp which is a database of observed daily rainfall with a resolution of 5 km throughout japan kamiguchi et al 2010 appendix b mean frequency of effective rainfall λ according to doulatyari et al 2015 the long term mean rainfall p and long term mean streamflow q can be expressed as p α λ p and q α λ respectively where λp is the mean frequency of daily rainfall and λ is the mean frequency of effective rainfall the relationship between λ and λp can be expressed by eq b 1 b 1 λ ϕ λ p where ϕ q p is the mean runoff coefficient although a water balance model can estimate ϕ doulatyari et al 2015 we aim to comprehend the characteristics of the grfm and gra for the p q model in the present study therefore we applied the observed ϕ to avoid the impact on the performance of the p q model appendix c recession coefficient k in the grfm to calculate the recession coefficient k the grfm assumes a long term mean in eq 9 which results in q q d d where d d g a and q α λ d d thus k can be expressed as eq c 1 c 1 k ρ c q 1 a θ α λ 1 a where θ ρ c d d 1 a is a function of the retraction speed c according to biswal and marani 2014 there is no method to observe c however they hypothesized that there is a functional relationship between k and the maximum subsurface discharge which can be expressed by eq c 2 c 2 k 1 a 1 t n q n 1 a where qn is the discharge observed on the nth day after a peak if qn is the long term mean discharge q α λ we can use eqs c 1 and c 2 to express θ as eq c 3 c 3 θ 1 a 1 t n in this study we assumed that q occurs at the middle of the effective rainfall interval 1 λ which resulted in t n 1 2 λ hence we obtained k appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125745 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 
4654,the development of run of river hydropower requires the flow duration curve fdc to estimate the electricity production as obtaining an fdc based on gauging station streamflow requires significant cost and time i e more than several years it is important to predict the fdc in the absence of streamflow data an analytical probabilistic model of streamflow dynamics p q model can calculate the fdc which requires several rainfall and runoff recession parameters to estimate the recession parameters in the absence of discharge data we selected two approaches the geomorphic recession flow model grfm and geological recession approach gra the grfm and gra associate the river network and geology respectively with runoff recession features this study aims to comprehend the characteristics of the grfm and gra employed in the p q model by targeting 57 basins throughout japan we found different performance trends between the grfm and gra that corresponded to specific basin characteristics while the grfm performed well in high precipitation basins the gra performed well in basins with abundant unconfined groundwater contributions these results agree with the features in the derivations of the grfm and gra in addition we found a complementary relationship between the grfm and gra based on the baseflow index bfi which suggests that the complementary relationship is one method to improve the performance of the p q model in the absence of streamflow data keywords flow duration curve river network geology hydropower basin characteristics baseflow index 1 introduction japan is characterized by a unique combination of geomorphological and climatic features including steep watersheds and heavy rainfall oguchi et al 2001 which indicate its suitability for hydropower energy production bildirici 2019 recent developments in small scale hydropower plants have captured the country s attention as the japanese government introduced a feed in tariff for small scale hydropower schemes in 2012 fujii et al 2017 in particular run of river hydropower schemes are strongly dependent on the use of the flow duration curve fdc to plan plant capacity i e design flow and to set environmental flow standards for the protection of riverine ecosystems poff et al 1997 castellarin et al 2013 basso and botter 2012 obtaining an fdc based on gauging station streamflow however requires significant cost and time i e more than several years therefore predicting the fdc in the absence of streamflow data is important botter et al 2007 botter et al 2009 developed an analytical probabilistic model of streamflow dynamics hereafter referred to as the p q model which describes the steady state probability distribution function of daily streamflow as the fdc can be mathematically computed as the complement of the cumulative density function cdf of daily streamflow the p q model can also express the fdc botter et al 2008 numerous studies have successfully applied the p q model to a wide range of hydro climatic regimes ceola et al 2010 doulatyari et al 2015 2017 lazzaro et al 2013 santos et al 2018 2019 the p q model requires a limited number of climatic and physiographic parameters doulatyari et al 2015 proposed a framework to estimate these parameters based only on catchment scale climatic and geomorphologic features this indicates that the p q model has the ability to predict the fdc in the absence of streamflow data the parameters were composed of the mean rainfall depth α frequency of effective rainfall events λ and runoff recession parameters a and k doulatyari et al 2015 doulatyari et al 2017 assigned α using observed daily rainfall data and estimated λ by applying a water balance model the runoff recession parameters a and k were computed via a geomorphic recession flow model grfm developed by biswal and marani 2010 as the grfm relates the runoff recession to the river network the recession parameters can be obtained by analyzing geomorphological data i e digital elevation models dems biswal and marani 2014 carlier et al 2018 pointed out that few studies have considered geological features within the runoff recession in comparison with those that have considered surface features e g topography land use and soil type nevertheless musiake et al 1981 found distinct differences in low flows that corresponded to six geological classifications throughout japan subsequently takahasi et al 1983 proposed runoff recession parameters corresponding to the geological classification based on the runoff recession during dry days therefore applying these parameters to the p q model may be a suitable approach to estimate the fdc in the absence of streamflow in this study we expand the parameterization framework proposed by doulatyari et al 2015 by adding the geological recession approach gra this study aims to 1 comprehend the characteristics of the grfm and gra employed for the parameterization of the p q model and 2 investigate the relationship between the performance of each model and the basin characteristics fig 1 shows the work flow of this study first 57 target basins in japan with negligible anthropogenic impacts were selected to estimate the frequency of effective rainfall events λ it is necessary to estimate the mean runoff coefficient i e the ratio of the mean discharge to mean precipitation by applying a water balance model doulatyari et al 2015 2017 we note that doulatyari et al 2015 have already evaluated the performances of four water balance models for the p q model in addition the present study aims to comprehend the characteristics of the grfm and gra for the p q model therefore we applied the observed value for the mean runoff coefficient fig 1 next we evaluated the performance of the p q model with the application of the grfm and gra furthermore we prepared 184 basin characteristics related to the climate runoff land use geology soil topography and vegetation in each basin finally we investigated the relationships between the performance of each model and the basin characteristics 2 study basins and basin characteristics to evaluate the performance of the p q model it was necessary to eliminate any anthropogenic influences on the discharge data obtained from the study basins the japanese ministry of land infrastructure transport and tourism releases daily discharge data in their database of dams see http mudam nilim go jp home we set the following selection criteria for dam basins 1 there were no dams and hydropower stations upstream 2 the forest coverage rates were 70 which was implemented to eliminate the effect of impervious surfaces caused by human induced land use changes e g urbanization 3 a minimum of 10 years of discharge records were available and 4 the basin had a minimum catchment size of 10 km2 to reduce sampling errors beck et al 2015 based on these criteria we selected 57 basins throughout japan see supplementary fig s1 the average forest coverage rate basin size and data period were 94 71 100 63 0 km2 10 4 470 0 km2 and 21 2 years 12 23 years respectively see supplementary table s1 japan has one of the heaviest annual snowfalls in the world kazama et al 2008 as snowmelt runoff may disrupt evaluations of the performance of the grfm and gra we targeted the period from june to november to eliminate the effect of snowmelt runoff as previously mentioned we set 184 basin characteristics related to climate runoff land use geology soil and vegetation indices to investigate their impacts on the performance of the p q model except for the runoff indices the data sources and methods used to calculate the basin characteristics are described in the supplementary materials as we employed the runoff indices associated with the parameters of the p q model see supplementary table s2 the calculation methods are described in sections 4 1 and 4 2 3 calculation of p q model 3 1 model framework the p q model is one of several analytical probabilistic models for streamflow dynamics which describes the steady state probability distribution function of the daily streamflow botter et al 2007 2009 this model originated from the analysis of long term soil water dynamics within the root zone rodriguez iturbe and porporato 2004 see supplementary fig s2 rodriguez iturbe and porporato 2004 successfully described soil water dynamics by applying the following three processes first they applied a stochastic rainfall model where the daily rainfall depth α and rainfall intervals 1 λp both followed an exponential distribution i e a marked poisson process second they considered linear soil water losses due to evapotranspiration third they considered an instantaneous deep percolation that produces effective rainfall if the soil moisture exceeded a threshold due to rainfall which contributed to an increment of the basin storage s botter et al 2009 obtained a new marked poisson process between the exceedance i e effective rainfall depth and effective rainfall interval 1 λ linking runoff q to s using a nonlinear reservoir model which developed the p q model the water balance of s s t can be expressed as eq 1 1 ds t dt q t ξ t where q t is the runoff in time t and ξ t represents the stochastic increment of s due to effective rainfall the nonlinear reservoir model can be described as eq 2 2 q t k b s t n where kb and n are parameters with respect to runoff recession the temporal dynamics of q can be expressed by assigning eq 2 to eq 1 as eq 3 3 dq t dt k q t a ξ q t where a and k are the runoff recession exponent and coefficient respectively and ξq t represents the stochastic increment of q due to the effective rainfall we note that the recession parameters a and k are linked to kb and n by eqs 4 and 5 4 a 2 1 n 5 k n k b 1 n botter et al 2009 developed the p q model by applying the marked poisson process to s and the nonlinear reservoir model eq 2 which can be described as eq 6 6 p q c q a exp q 2 a α k 2 a λ q 1 a k 1 a where α is the mean rainfall depth on rainy days λ is the mean frequency of effective rainfall and c is the normalizing constant we note that eq 6 is intended for a 1 which represents a significant portion of basins worldwide biswal and marani 2010 mutzner et al 2013 the fdc d q in eq 7 expresses the complement of the cdf of q which can be expressed as eq 7 7 d q q p x d x the above model is intended for subsurface contributions to streamflow and does not include the effects of faster surface contributions or snow accumulation and melting processes however according to botter et al 2009 the subsurface contributions to streamflow considerably exceed the surface contributions particularly at daily timescales and in the absence of extensive impermeable surfaces in addition the p q model assumes the spatial homogeneity of climate and landscape properties due to the derivation notably the p q model has been applied successfully in relatively small catchments i e catchment size 500 km2 ceola et al 2010 lazzaro et al 2013 santos et al 2018 2019 similar to the range of our target basins 10 4 470 0 km2 3 2 model evaluation we constructed an fdc for the entire streamflow record to yield a long term representation of the streamflow regime vogel and fennessey 1995 the fits of the p q model were assessed by adopting the kolmogorov smirnov distance cks ceola et al 2010 santos et al 2018 2019 this indicator expresses the maximum distance between the observed and calculated cdf for daily streamflow as we aim to investigate the relationships between model performance and basin characteristics we conducted a spearman s rank correlation analysis between the cks and basin characteristics 4 parameter estimation for the p q model the p q model requires four parameters i e α λ a and k to predict the fdc in this study we applied the observed data for α and λ these details are described in appendix a and b respectively this section shows how to estimate the recession parameters in the grfm and gra 4 1 recession parameters a k in the grfm biswal and marani 2010 developed the grfm to estimate recession parameters based on river network morphology fig 2 according to biswal and marani 2010 the discharge at a basin outlet is approximately equal to the water drained by various subsurface storage units of the basin at that time as expressed by eq 8 8 q q t g t a where g t is the length of the active drainage network adn at the basin q t is the flow drained per unit adn length and a is the basin size biswal and marani 2010 assumed that q t was spatially constant the dynamics of q can be expressed as eq 9 9 dq dt 1 a q t dg t dt dq t dt g t on the right side of eq 9 the first term expresses the runoff recession due to a retraction of the adn while the second term expresses the runoff recession due to a decrease in the drainage rate per unit channel length fig 2 provides a schematic diagram expressing the retraction of the adn the grfm assumes that the first term becomes dominant based on observations from previous studies i e dq t dt 0 the grfm further assumes a retraction speed i e c dl dt if l is the distance of an adn tip from its farthest channel head fig 2 the grfm sets l c t by assuming that c is constant in space and time these assumptions allow us to set g t g l t which further allows us to develop eqs 9 into 10 10 dq dt 1 a q dg t dt 1 a qc dg l dl q c n l a where g l is the total length of the adn at l from the channel heads at the same time the number of channel links become n l dg l dl focusing on the runoff recession period we can eliminate the effect of effective rainfall in eq 3 i e ξ q t 0 as follows 11 dq t dt k q t a equation 11 can be further developed by assigning eqs 8 and 10 as follows 12 n l a ρ g l a a where ρ k q a 1 c equation 12 allows us to estimate the recession exponent a using the river network morphology we obtained n l and g l by analyzing 90 m resolution hydrosheds dem data lehner et al 2008 based on the river network algorithm proposed by biswal and marani 2014 we estimated a using the least squares method based on the relationship between n l and g l we note that biswal and marani 2014 assigned n l 2 as a lower limit for the least squares method hence we also applied this threshold to the least squares method which resulted in a the recession coefficient k was calculated as a function of a the derivation of which is described in appendix c 4 2 recession parameters a k in the gra ding 1966 proposed a nonlinear storage discharge relationship for an unconfined aquifer as follows 13 q b t 2 s 2 where bt is the parameter with respect to the runoff recession this relationship has often been used for long term runoff analysis in hill slope basins ando et al 1983 1984 equation 13 indicates that n 2 and k b b t 2 in eq 2 wittenberg 1999 referred to n 2 as the theoretical standard value for the storage discharge relationship for unconfined aquifers assigning n 2 and k b b t 2 in eqs 4 and 5 respectively we obtain a 1 5 and eq 14 14 k 2 b t ding 1966 also expressed a recession curve equation for an unconfined aquifer as follows 15 1 q n 1 q 0 b t t n where q 0 is the initial baseflow discharge equation 15 agrees with a special form i e a 1 5 of the recession curve equation proposed by wittenberg 1999 first takahasi et al 1983 set q 0 as q on the third day after a peak with a minimum recession period of 10 days next they used the least squares method for the recession periods to calculate bt for 59 basins in japan as a result they proposed a representative seasonal bt value that corresponded to six geological types as classified by musiake et al 1981 in this study we applied bt by averaging the values from summer and autumn due to the target season i e june to november see supplementary table s5 the six geological types were classified using the japanese national land numerical information nlni database see http nlftp mlit go jp ksj e index html with a resolution of 1 km we averaged bt corresponding to the rate of the geological type in the basin in addition we observed bt in our target basins using the least squares method as described above finally we obtained k based on the geological type and observations by assigning bt to eq 14 we note that the baseflow index bfi which is defined as the ratio of the mean long term baseflow to the total streamflow smakhtin 2001 was selected as a basin characteristic in this study we computed the bfi using the recursive digital filter proposed by van dijk 2010 because this method applies the storage discharge relationship to the runoff model in common with the p q model eq 2 as we assumed that the baseflow contribution was subject to unconfined aquifers we applied a 1 5 and the observed k to the digital filter method 5 results 5 1 recession parameters in the p q model first we present the estimation processes for the recession parameters as an example the jozankei and sanzai basins with catchment sizes of 104 and 29 km2 respectively were selected for the example fig 3 a fig 3 b shows the relationship between n l and g l following the analysis of 90 m resolution dem data based on the river network algorithm biswal and marani 2014 we calculated a in the grfm by using the least squares method for eq 12 based on the relationship we note that n l 2 was selected as a lower limit for the least squares method in accordance with biswal and marani 2014 fig 3 c shows the 1 km resolution geological map based on the nlni database for the gra in the sanzai basin we only obtained the bt corresponding to mesozoic strata because of the geological homogeneity in this area because the jozankei basin is geologically heterogeneous i e it contains tertiary volcanic rock and tertiary strata we averaged the bt corresponding to the rate of the geological type in the basin these processes allowed us to obtain the recession parameters in the absence of streamflow data table 1 shows the results of the parameters in the p q model the averaged a in the grfm 2 06 was larger than that in the gra 1 50 which means that faster runoff recession occurred in the grfm in comparison to that in the gra in addition the coefficient of variation of k in the gra 0 25 was lower than that of the grfm 0 42 considering that a in the gra was constant our results are indicative of lower variations in runoff recession among the basins in the gra in comparison to those in the grfm 5 2 performance of the p q model with grfm and gra figs 4 and 5 show the results of the probability densities for the daily streamflow and fdcs respectively fig 6 presents the results of the cks for the grfm and gra where a lower cks value i e c ks 0 indicates a better performance in the p q model the median cks was lower in the grfm 0 21 than that in the gra 0 30 which indicates that the overall performance of the grfm was better than that of the gra fig 6 however the cks distribution range for the grfm was wider than that of the gra fig 6 we also conducted a spearman s rank correlation analysis between the cks values estimated from both models for each basin to investigate performance trends as a result there was a significant negative correlation for the performance between the grfm and gra ρ 0 65 p 0 01 which indicates that the performance trends were opposite between both models 5 3 relationships between p q model performance and basin characteristics tables 2 and 3 list the results of the spearman s rank correlation analysis between the cks and basin characteristics for the grfm and gra respectively ρ 0 50 p 0 01 although the trends of these correlations positive or negative were opposite between both models tables 2 and 3 the bfi and mean temperature showed significant correlations in the grfm and gra the performance of the gra was also positively correlated with the rain indices table 3 we also observed that climate indices except for the bfi mainly influenced the performances in both models tables 2 and 3 6 discussion 6 1 differences in the performance characteristics between the grfm and gra we obtained opposite trends for the performances between the grfm and gra ρ 0 65 p 0 01 as well as for the correlations between the performances and basin characteristics of both models tables 2 and 3 to discuss these results we focus on the differences in the derivation between both models biswal and marani 2010 derived the grfm by linking adn dynamics to the runoff recession fig 2 according to biswal and marani 2014 the adn can express a relatively rapid response as the first term on the right side of eq 9 expresses the adn retraction biswal and marani 2010 eliminated the second term in this study the cks in the grfm has a negative and significant correlation with the mean temperature tmean table 2 we investigated the relationship between the α and tmean which exhibited a significant positive correlation ρ 0 73 p 0 01 fujibe 2015 also reported that extreme precipitation has a positive correlation with the mean temperature throughout japan these observations indicate that the grfm tends to be characterized by a high performance in basins with elevated precipitation which suggests that the adn retraction controls the runoff recession on the other hand the second term on the right hand side of eq 9 expresses the runoff recession caused by phreatic aquifers biswal and marani 2014 i e the boussinesq equation brutsaert and nieber 1977 according to ding 2013 eq 15 is an alternate expression of the boussinesq model for unconfined aquifers which forms the basis of the gra we calculated the bfi by applying the boussinesq model which had a significant correlated with the cks in the gra ρ 0 77 p 0 01 table 3 this result indicates that the gra tended to exhibit a high performance in basins with abundant unconfined groundwater contributions as the study basins were selected from the most upstream dam basins they had a relatively steep geomorphological feature several studies conducted sprinkling field experiments to comprehend the mechanism of subsurface flow in a steep catchment in the oregon coast range anderson et al 1997 torres et al 1998 montgomery and dietrich 2002 integrating these experimental results montgomery and dietrich 2002 conceptualized that rapid subsurface flow in near surface fractured bedrock and deeper bedrock flow generates runoff in steep catchments this study shows that the performance of the gra became poor when increasing the mean maximum daily rainfall depth pmax table 3 which may derive from the difficulty to express the rapid subsurface flow by the gra we observed good poor performance of the gra grfm in relation to the low tmean although we eliminated the effect of snowmelt runoff by limiting the target period i e june to november japan has one of the highest annual snowfall rates in the world kazama et al 2008 in addition the snowmelt component exerts a strong influence on groundwater recharge earman et al 2006 these facts indicate that the target basins with low tmean can produce abundant groundwater contributions as a result of the snowmelt component even during the non snowmelt season given the derivation of the grfm and gra we can consider these conditions as being agreeable disagreeable with the gra grfm 6 2 performance improvements to the grfm and gra the overall performance of the grfm was better than that of gra whereas the performance of the grfm was associated with a large error variability fig 7 to improve the performance of the grfm we focus on the calculation of a in the grfm agrfm in fact the agrfm was calculated using the least squares method based on the relationship between n l and g l fig 3 b we assigned n l 2 as the lower limit for the least squares method in accordance with biswal and marani 2014 as the threshold of n l directly affects the agrfm it should be possible to obtain the appropriate threshold therefore we searched for the optimal performance in the grfm by changing the threshold of n l from 1 to 100 which provided a significant improvement to the grfm fig 7 fig 8 shows the median cks in the grfm when changing the threshold of n l which indicates that there is an appropriate threshold value while we used dem data with a 90 m resolution for our calculations previous studies calculated the agrfm using a resolution of 30 m biswal and marani 2010 2014 doulatyari et al 2015 2017 we should also investigate an appropriate relationship between the resolution of the dem data and the agrfm we evaluated the performance improvement in the gra by applying the observed k fig 7 although the performance of the gra improved by applying the observed k we observed limitations to this improvement fig 7 nevertheless the gra exhibited a high performance in basins with abundant unconfined groundwater contributions table 3 these observations suggest that we can appropriately apply the gra only to unconfined groundwater contributions by separating the direct and groundwater contributions from streamflow ando et al 1983 1984 developed a hydrological model by applying the boussinesq model to the groundwater contribution applying the recursive digital filter van dijk 2010 to the separation may be one of the most appropriate approaches because the digital filter can reflect the boussinesq model after improvements future studies should evaluate the gra s ability to capture streamflow characteristics 6 3 complementary relationship between the grfm and gra we found that the performance trends responses to basin characteristics and derivation background were opposite between the grfm and gra which indicates that there is a complementary relationship between both models we discuss the potential to improve the performance by selecting the model based on the basin characteristics as the bfi has a significant correlation with the performance of both models tables 2 and 3 we employed the bfi as a criterion to select the model fig 9 shows the results of complementary relationship between the grfm and gra based on the bfi we note that we show the complementary relationship in fig 9 when applying the original models fig 6 and optimized models fig 7 in addition the threshold of the bfi in fig 9 indicates the lower limit to select the cks in the gra both cases showed the best performance when the threshold of the bfi was equal 0 75 fig 9 which outperformed the case that individually applied the grfm and gra figs 6 and 7 therefore we can conclude that improving the performance by applying the complementary relationship between the grfm and gra based on the bfi is useful certain studies have developed global bfi maps with high accuracy beck et al 2013 2015 which may be useful for the criterion of the complementary relationship in the absence of streamflow data 7 conclusions we introduced the grfm and gra in the parameterization framework for the p q model whose characteristics were evaluated throughout japan the grfm can express a relatively rapid response because of its derivation we observed that the grfm performed well in basins with high precipitation which agrees with the features of its derivation the overall performance of the grfm was better than that of the gra in addition optimizing the threshold of n l in the calculation of agrfm significantly improved the performance of the grfm the gra originated from the boussinesq model for unconfined aquifers we observed that the gra performed well in basins with abundant unconfined groundwater contributions which agrees with the features of its derivation our results also indicate that the gra is unsuitable for basins with a high rapid flow contribution although the performance of the gra improved by applying the observed k we observed limitations to this improvement therefore we recommend that the gra should only be appropriately applied to unconfined groundwater contributions we also evaluated a complementary relationship between the grfm and gra based on the bfi which outperformed the case that individually applied the grfm and gra this result suggests that the complementary relationship between the grfm and gra is one of methods to improve the performance of the p q model in the absence of streamflow data credit authorship contribution statement ryosuke arai conceptualization methodology software validation formal analysis writing original draft visualization yasushi toyoda supervision project administration funding acquisition so kazama writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a mean rainfall depth on rainy days α in this study rain indices including α were estimated using aphro jp which is a database of observed daily rainfall with a resolution of 5 km throughout japan kamiguchi et al 2010 appendix b mean frequency of effective rainfall λ according to doulatyari et al 2015 the long term mean rainfall p and long term mean streamflow q can be expressed as p α λ p and q α λ respectively where λp is the mean frequency of daily rainfall and λ is the mean frequency of effective rainfall the relationship between λ and λp can be expressed by eq b 1 b 1 λ ϕ λ p where ϕ q p is the mean runoff coefficient although a water balance model can estimate ϕ doulatyari et al 2015 we aim to comprehend the characteristics of the grfm and gra for the p q model in the present study therefore we applied the observed ϕ to avoid the impact on the performance of the p q model appendix c recession coefficient k in the grfm to calculate the recession coefficient k the grfm assumes a long term mean in eq 9 which results in q q d d where d d g a and q α λ d d thus k can be expressed as eq c 1 c 1 k ρ c q 1 a θ α λ 1 a where θ ρ c d d 1 a is a function of the retraction speed c according to biswal and marani 2014 there is no method to observe c however they hypothesized that there is a functional relationship between k and the maximum subsurface discharge which can be expressed by eq c 2 c 2 k 1 a 1 t n q n 1 a where qn is the discharge observed on the nth day after a peak if qn is the long term mean discharge q α λ we can use eqs c 1 and c 2 to express θ as eq c 3 c 3 θ 1 a 1 t n in this study we assumed that q occurs at the middle of the effective rainfall interval 1 λ which resulted in t n 1 2 λ hence we obtained k appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125745 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 
