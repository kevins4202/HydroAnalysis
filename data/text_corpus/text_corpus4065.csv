index,text
20325,decision making in emergency situations is a risky and uncertain process due to the limited information and lack of time some key problem parameters such as the time required to complete important response tasks must be estimated and are therefore prone to errors other parameters such as the probability of occurrence of a consequential event will typically change as the response operation progresses as a result there should be a dynamic probabilistic risk assessment framework to assess the risk level of decision scenarios and facilitate the decision making process in this paper a methodology for dynamic probabilistic risk assessment of decision making in emergencies for complex marine systems is proposed in this method a dynamic event sequence diagram is introduced that helps to quantify events probabilities as a function of time as well as environmental and operational variables considering events interdependencies and uncertainties in addition the effects of time required 1 1 time required refers to the time needed to perform each level of decision making process detection diagnosis decision making execution and time available 2 2 time available is the time remaining before an accident happens in a system it is derived from the dynamic simulator of the system the dynamic simulator calculates the time remaining before a collision based on the system components status operation and environmental conditions at the time of incident for performing a decision in emergency are considered in the risk model in this methodology probabilistic models including bayesian network and monte carlo simulation are utilized to quantify the uncertain behavior of the decision making process in complex marine systems a computational study is also conducted to evaluate the methodology performance in terms of effectiveness and efficiency computational results show that the proposed approach can obtain optimal solutions for large and practical problem sizes keywords dynamic probabilistic risk assessment complex systems human machine interaction decision making response time model bayesian network monte carlo method dynamic event tree dynamic positioning system table of nomenclature symbol description α shape parameter β inverse scale parameter a t i time allocated to event i bn bayesian network c p conditional probability hep human error probability k p modified bessel function m spar h multiplier p i probability of event i p i i 1 connection probability between event i and events event i 1 p s f performance shaping factor rt response time t i occurrence time for event i t time required for event i 1 introduction industrial accidents may cause losses of life or injury social and economic disorders or environmental pollution when an incident occurs the relevant decision makers need to decide what actions to take instantly to mitigate or minimize the potential negative effects in most cases the decision making process in incidents especially in emergency cases 3 3 an emergency case or situation is an unplanned or imminent event that affects or threatens the health safety or welfare of people property and infrastructure and which requires a significant and coordinated response the defining characteristic of an emergency event or situation is that usual resources are overwhelmed or have the potential to be overwhelmed are complicated due to the limited time and information as time passes more information may become available however the consequences of the incident would be worse therefore having more information about system health status and risk level of decision making process at the early stages is an important research topic in complex systems in many risk assessment and management studies the main focus is on the static risk i e the risk and safety level of different scenarios without considering the dynamic nature of the system zhang et al 2017 norazahar et al 2017 over the past decades studies have been conducted to deal with dynamic risk assessment problems often dynamic event trees connected to fault trees bns are used to analyze the dynamic behavior of complex systems in the risk assessment process hakobyan et al 2008 barua et al 2020 zhang et al 2018 kanes et al 2017 meng et al 2019 li et al 2019a 2019b norazahar et al 2018 devooght et al devooght and smidts 1996 were among the first pioneers that presented the dynamic event tree method tombuyses et al 1998 and kloos et al kloos and peschke 2006 coupled the dynamic event tree method with monte carlo simulation for dynamic reliability problems bi et al bi and si 2012 proposed a dynamic risk model based on the master logic diagram mld for an oil spill scenario events in the mld diagram are valued based on the simulation results this diagram is used to identify the consequence contributors of an oil spill scenario which was then tracked and grouped into classes including environmental damage asset loss health impact social effect and their contributing individual events in the bottom hierarchy of the mld other methods include go flow matsuoka and kobayashi 1988 dynamic flow methodology dfm yau and guarro 1996 and dynamic simulation of the complex system coupled with a risk assessment model cojazzi 1996 izquierdo and labeau 2004 vorobyev and kudinov 2011 for instance wang et al 2016 proposed a dynamic risk assessment method for chemical processes the model is updated continuously by monitoring key variables in a process in addition the consequences are estimated using dynamic loss functions considering multiple key state variables one of the main risk elements in risk assessment of decision making process is human factors in boring and gertman 2016 principles of human reliability analysis and quantification are presented and in kolaczkowski 2005a good practices for implementing these principles are discussed the u s nuclear regulatory commission nrc has developed a guideline for quantification of human reliability analyses hras to support risk informed regulatory decision making us nuclear regulatory commission 2006 in these studies human reliability is analyzed using bayesian networks bns fault trees fts event trees ets or standardized plant analysis risk human reliability analysis spar h method the spar h method is used as a part of risk assessment in different applications ranging from nuclear power plants boring and gertman 2016 to fire accidents in complex systems lewis et al 2010 spar h method helps to quantify the effect of performance shaping factors on the human error probability hep one of the important performance shaping factors is the available time at the time of incident in hogenboom et al 2021 the importance of time in the risk of dynamic positioning operations has been pointed out by analyzing time using different methods in this study different interviews with dynamic positioning operators have been performed and results illustrate that the effects of time available and time should be considered in human reliability analysis having more information about the system health status and risk level could help operators to make better decisions in a shorter time decreasing hep significantly in emergency situations the time required 4 4 time required refers to the time needed to perform each level of decision making process detection diagnosis decision making execution and time available 5 5 time available is the time remaining before an accident happens in a system it is derived from the dynamic simulator of the system the dynamic simulator calculates the time remaining before a collision based on the system components status operation and environmental conditions at the time of incident are two time related factors that affect human error and probability and decision making process during an incident in real incidents the decision making and system response process needs some time to be performed which is known as time required in addition to time required time available should be estimated and addressed in a decision making risk model if the time available far exceeds the time required and there are not multiple competing tasks the estimated hep is not expected to be strongly influenced by time however if there is not enough or barely enough time to act the estimated hep is expected to be quite high kolaczkowski 2005b which may lead to failure in the emergency decision making available time could be evaluated using system dynamic simulation based on available sensor data at the time of incident initial event and the time required could be estimated based on human response time models even though contributions have been proposed to define and consider time available and time required in the decision making process murchison and gilmore 2018 wreathall et al 2003 joe et al 2015 swain and guttmann 1983 there is no concrete quantification method for evaluating hep as a function of time available and time required in addition interdependencies among response time 6 6 in this study the response time is equal to the time required to perform human related events of decision making steps detection diagnosis decision making and execution is barely addressed decision making steps are highly interdependent and response time of each step affect the other steps performance moreover system operation is affected by decisions dynamically as a result to have an accurate decision making model the interactions among decision making steps as well as human machine interactions should be considered in the modeling procedure the interactions between system and human in a dynamic environment are considered in a study carried out by chang et al chang and mosleh 2007a 2007b 2007c 2007d 2007e the objective of the present study is to develop a decision making risk assessment framework that considers the dynamic nature of decision making steps and their interdependencies with considering time available and time required for each step in the proposed framework the probability of a scenario is calculated as a function of previous events probabilities and occurrence time utne et al 2011 the method is based on a dynamic event sequence diagram desd that gets inputs from response time models and bayesian networks in order to quantify the occurrence time and probability of each event respectively there are multiple alternative decision scenarios in an emergency situation with different risk levels the novelties of the proposed dynamic probabilistic risk assessment method are the ability to calculate the decision making failure probability as a function of time available and time required operator response time and other performance shaping factors consider human machine interdependencies by updating time available for next decision making events based on the current system and operator s status and operating conditions use data driven response time models to evaluate time required for all decision making events including detection diagnosis decision making and execution consider environmental system and human factors uncertainties using bayesian network models utilize the monte carlo method to model the stochastic behavior of variables such as operators detection diagnosis decision making and execution response times the paper is organized as follows section 2 presents the general form of the proposed methodology section 3 models the operator s decision making process in a dynamic positioning dp drilling unit as a case study in section 4 an emergency situation is described and based on the developed model in section 3 the probability of failure of decision making process is evaluated in this section the effects of available time and incident complexity on the decision making risk level is analyzed then section 5 discusses the outcomes and proposes future research directions finally in section 6 conclusions are presented 2 methodology different temporal orderings of events could potentially lead to different scenarios as a result it is crucial to know the allocated time available in an incident according to the reviewed literature villa et al 2016 current dynamic event sequence diagrams esds can only handle time delays in this regard however this study extends the dynamic esd framework to consider time allocated 7 7 time allocated is the time spent on an event when there is a sufficient time time allocated to each event is equal to the time required to each event and update the following events accordingly fig 1 presents a dynamic event sequence diagram as can be seen there are different phases phase i phase i 1 etc defined based on time intervals phases include multiple event alternatives in a time interval e g event i represents an event that happens between time ti and ti 1 the probability of each event is denoted by p i e the probability of event i is pi the time allocated to each event is presented as a t i e the time allocated to event i is a t i as presented in fig 1 the connections between events are probabilistic according to the figure after event i two different events event i 1 1 and event i 1 2 with different probabilities pi i 1 1 pi i 1 2 can occur these connection probabilities depend on the system s environmental and operating conditions parhizkar et al 2020a parhizkar mosleh as well as time allocated to the previous events the constraints presented in the figure illustrates the environmental and operational conditions system boundary and requirements that affect connection probability quantifications fig 2 presents an event flow diagram of a decision making process in an emergency in this figure different phases of the decision making including detection diagnosis decision making and execution are presented in each phase there are various events that should be defined for the case under study in fig 2 some event examples for different phases are presented the presented phases in fig 2 are detection the first step of the decision making process presented as a first phase column in the event flow diagram fig 2 this event presents that the initiating event should be detected first then other steps of the decision making could be performed diagnosis the next step is diagnosis that could be performed based on different methods such as monitoring and or communication each method could be presented as one or multiple events in the diagnosis column decision making after the diagnosis process different scenarios of recovery are proposed and compared in this phase execution the last step of the decision making process is execution actions could be performed manually automatically or combined which are presented in this phase in the proposed method events convey two important types of information i e probability and time the probability of an event is the measure of the chance that the event will occur and it depends on environmental and operational factors including technical human and organizational risk factors that should be defined based on the scope of the study the event probability can be calculated using a bn that is presented in fig 3 different bn structures could represent human behavior error in order to quantify a bn conditional probabilities among all the nodes should be available in this study the structure of the bn is simplified to enable quantification of all conditional probabilities accurately the affecting factors performance shaping factors psf on human behavior error are determined according to whaley et al 2011 in this study it is assumed that psf factors are independent in the bayesian network bayes rule is utilized to quantify the child node human behavior error in fig 3 in the bayes rule we need the probability of parent nodes and conditional probabilities of each arc connection between nodes to quantify a child node the probabilities of the parent nodes of the bn fig 3 are defined based on the available evidence such as sensor data at the time of incident conditional probabilities of the bn can be calculated based on spar h method byeet al 2017 spar h method is a human reliability assessment tool that uses psfs to quantify the probability of human error psfs are the aspects of human behavior and the environment that can affect human performance such as stress level of training and task complexity based on this method the hep can be quantified using eq 1 1 c p p s f s when 3 or more negative psf influences are present in the equation above the conditional probability should be computed as a composite psf score used in conjunction with the adjustment factor negative psfs are present anytime a multiplier greater than 1 is selected the composite psf score is computed by multiplying all the assigned psf values then the adjustment factor below is applied to compute the conditional probabilities the first term of the equation presents psfs for human errors related to the diagnosis tasks e g detection diagnosis making a decision and the second term is psfs of human errors related to action tasks e g execution groth and swiler 2012 2 c p 0 01 p s f s 0 01 p s f s 1 1 0 001 p s f s 0 001 p s f s 1 1 where 0 01 and 0 001 are nominal human error probabilities for detection diagnosis and action execution tasks respectively these numbers are derived based on several studies on human behavior and human error quantifications byeet al 2017 psfs are multipliers of each parent node that impact the human performance these values are highly dependent on the type of event and their values could be found in related references byeet al 2017 has presented psfs for operator s on board in a dynamic positioning drilling unit for instance for stress psf factor there are three spar h levels as follow that can be used to quantify stress psf at different situations extreme a level of disruptive stress in which the performance of most people will deteriorate drastically this is likely to occur when the onset of the stressor is sudden and the stressing situation persists for long periods this level is also associated with the feeling of threat to one s physical well being or to one s self esteem or professional status and is qualitatively different from lesser degrees of high stress e g catastrophic failures can result in extreme stress for operating personnel because of the potential for radioactive release in this situation the stress psf factor is equal to 25 byeet al 2017 high a level of stress higher than the nominal level e g multiple instruments and annunciators alarm unexpectedly and at the same time loud continuous noise impact s ability to focus attention on the task the consequences of the task represent a threat to facility safety in this situation the stress psf factor is equal to 5 byeet al 2017 nominal the level of stress that is conducive to good performance in this situation the stress psf factor is equal to 1 byeet al 2017 for other psfs such as fitness for duty complexity ergonomics etc there are different categories and psf values accordingly the psf values are used in eqs 1 and 2 to quantify conditional probabilities of each parent nodes these conditional probabilities as well as parent nodes probabilities are taken as inputs in bayes rules in the bayesian network to calculate the human behavior child node probability the human behavior node could particularly model the detection section 3 1 diagnosis section 3 2 decision making section 3 3 and execution processes section 3 4 one of the main innovations of the proposed methodology is in the quantification process of conditional probability of the time node the time refers to the time allocated to the event the conditional probability as a function of the time allocated to an event could follow different patterns in this study a linear function based on the spar h method principles is proposed in spar h method the failure probability of an event diagnosis or action tasks is calculated using eqs 1 and 2 byeet al 2017 table 1 presents the spar h multiplier presented as psfs in eqs 1 and 2 and event probabilities for four different allocated times byeet al 2017 the values in the table give four probabilities at four different allocated times red dots presented in fig 4 in order to make the conditional probability function continuous it is assumed that the function follows a linear pattern at the other allocated times as presented in fig 4 the functions of linear lines between dots could be calculated based on the time required and time allocated to the tasks for instance for diagnostic tasks the linear functions could be calculated as eqs 3 6 3 c p t i m e 1 0 3355 t 3 a t a t 1 3 t 4 c p t i m e 1 0 3355 1 0 0917 1 0 3355 t a t 1 3 t a t 2 3 t 5 c p t i m e 1 0 0917 1 0 01 1 0 0917 t a t 2 3 t a t t 6 c p t i m e 1 0 01 t a t for action tasks the constants of the linear equations should be updated based on the numbers presented in table 1 as can be seen the linear functions depend on the time required t and time allocated at to each task in the case study section these functions are updated according to the required time for each task the time allocated at to each event depends on the nature of the event events with a technical basis such as automatic shutdown of a system engine part load operation etc could have a specific time required that depends on the machinery limitations however there are other types of events with human interference such as monitoring diagnosis execution etc in these cases time allocated is a function of various environmental operational and behavioral parameters such as experience training stress level etc and this creates parametric uncertainties that evolve in complexity as one moves from one complex emergency to another the time allocated could be evaluated using data driven probabilistic models for instance in hockley 1984 batur et al 2018 zandt 2002 different distributions for human response time allocated time are proposed for instance a human response time could follow inverse gamma lognormal gamma or generalized gamma distributions operators allocate time to the remaining decision making events based on the remaining time available for instance when there is enough time available nominal time according to table 1 recovery action could be performed however in situations with barely adequate time defined in table 1 emergency actions such as emergency shutdown are performed to avoid accidents at the time of incident time available is derived from the dynamic simulator of the system the dynamic simulator consists of dynamic models 8 8 dynamic models help understand the system behavior these models are either from fundamental relationships first principles physics based or and derived from data empirical that rely on knowledge of the process of system components and calculates the time remaining before accident failure based on the system components status operation and environmental conditions at the time of incident as time passes the time available decreases based on the time allocated to each event in the proposed methodology the effect of remaining time on the upcoming decision making events probabilities are quantified using eqs 3 6 the derived conditional probabilities will be used as the conditional probabilities of the time node in the bayesian network fig 3 in addition the conditional probabilities of other bayesian network nodes such as fitness for duty stress complexity etc will be evaluated using eqs 1 and 2 all conditional probabilities will be used to quantify the child node hep of the bayesian network using bayes rules in the quantification process of the bayesian network it is assumed that parent nodes of the bayesian network are independent fig 5 presents the flow diagram of the proposed methodology in the response time model the time allocated to each decision making event is evaluated the allocated times are used to calculate the conditional probability of the time node based on table 1 and eqs 3 6 the dynamic simulator performs basic calculations to derive available time using sensor data sensor data include all data from different sensors installed in the system that are used to measure system operating conditions and performance such as temperature pressure mass flow rate position velocity power etc the sensor data is used to estimate the available time before an accident for instance in a vessel using sensors the vessel velocity and its distance from an obstacle can be measures in the vessel dynamic simulator available time before collision is estimated using these sensor data in addition to sensor data that can be used for available time calculation crew characteristics are used in the spar h model to calculate parent nodes probabilities psf factors of bns for instance according to a crew member behavior we can estimate the probability of fitness for duty stress level etc of the crew member these probabilities are used to calculate human error probability using the bn fig 3 in addition the system under study could have technical components such as engine control system etc the failure success probability of these technical components could be calculated using fault tree methods the output of fault trees in addition to human error probability are used to calculate failure success probabilities of the esd events and consequently to evaluate the probability of end states in the framework using hybrid causal logic hcl methodology the hcl methodology contains algorithms that convert ets and fts into equivalent binary decision diagrams bdds a bdd is a rooted directed acyclic graph with an unconstrained number of in edges and two out edges one for each two states such as true or false of any given variable a bdd is a binary decision tree over the boolean variables where identical boolean expressions are unified thus a bdd has two terminal nodes labeled 0 false and 1 true representing the final value of the logical expression røed et al 2009 the hcl algorithm is a major extension of bdds the hcl layers of esds or ets and fts are included through transformation into bdds and linked to the bns layer by properly handling the dependencies wang 2007 as we can see in fig 6 linking bns to eds and ft models provides a way for explicitly accounting for potentially complex and often hidden interdependencies of risk models elements as an example we note that basic events b and c which appear in different fts of fig 6 are in fact interdependent as they are both linked to the same bn of other risk factors the main outcome of the methodology fig 5 is the probability of the end states of the presented esd in fig 2 the end states could be system failure or success and the methodology proposed in the paper evaluates the success failure probabilities of the decision making process in emergency situations as mentioned the allocated time to each event is a stochastic variable and could take different values depending on environmental operational and human characteristics therefore there is not a single result for end state probabilities a method to consider the stochastic behavior of allocated times is monte carlo mc method mc is a class of computational algorithm that performs repeated random sampling samples are randomly selected from a distribution dataset then the samples are taken as model inputs and results are generated accordingly in the presented methodology fig 5 samples could be randomly selected from response time distributions of each event i e the samples include four random allocated times for detection diagnosis decision making and execution process derived from their response time distributions then end state probabilities are calculated using the presented methodology in fig 5 the random sampling process is repeated for the predefined total number of mc simulations the output of mc is a distribution of end state probabilities presenting all model outputs for every samples this is further exemplified in the next section with a case study on a dynamic positioning dp system in a mobile offshore drilling rig unit modu 3 case study the proposed methodology is applied to a dp system in a modu the dp is a computer controlled system used to automatically maintain a ship or vessel s position and heading by using its own propellers and thrusters the studied dp system enables positioning of an offshore drilling unit an offshore drilling unit operates in a green zone inside a yellow limit presented in fig 7 chen et al 2008 when an initiating event happens the vessel loses the capability to maintain position and may enter the yellow zone whenever the vessel passes the yellow limit the operation of the unit must be stopped and the operator starts to prepare for disconnection when the vessel passes the red limit emergency disconnection must be initiated to disconnect the riser and shut in the well failure of disconnection may lead to damage of riser blowout preventer or wellhead and hydrocarbon influx kick which can cause vessel downtime significant financial losses and environmental damages the event flow diagram for the case study is presented in fig 8 as can be seen at the first level the abnormalities should be detected then the operator starts monitoring to diagnose any undesired deviations in the system in the decision making stage crews may share some knowledge based information that could help them in the next step of making a decision then one or some of the recovery tasks i e change position reference recalibrate reference origin and deselect faulty sensor is to be executed the formulated tasks are transformed into sequenced muscle movements and the tasks are executed in the last stage if any of the events fails the drilling unit will pass the red limit and the disconnection should be performed disconnection could be performed by the operator either manually or automatically in both cases there is a probability of failure therefore possible end states are dc disconnect properly md mechanical damage to due disconnection failure and ok system maintains position and returns to safe zone in auto and manual disconnection level the failure of hardware software and human components are modeled using fault trees sections 3 5 and 3 6 respectively the hardware components are the power system including power generation units switches ups and hardware parts of the control system computer software component includes the software parts of the control system computer however in all other levels detection diagnosis decision making execution and disconnection execution it is assumed that there is no failure in hardware and software and the only possible failure is due to human factors the next step is the quantification of events which is presented in the following subsections for each event 3 1 detection at the first stage the operator should detect deviations from normal operation first phase column presented in fig 8 the probability of detection p d e t e c t i o n depends on time fitness for duty stress complexity ergonomics training and work processes and could be calculated based on the bn presented in fig 9 the conditional probabilities of all parent nodes except time are quantified using eqs 1 and 2 and the multipliers of each parent node are derived from byeet al 2017 the conditional probability of the time node i e allocated time to the detection could be calculated based on eqs 3 6 according to byeet al 2017 the detection of an initiating event in a dp drilling unit takes approximately 23 s therefore based on table 1 and eqs 3 6 the conditional probability function of the time node for the detection event can be calculated according to the reviewed literature the response time rt of operator s detection follows the gamma distribution palmer et al 2011 the gamma distribution is a two parameter category of the continuous probability distributions eq 7 presents a general form of the gamma distribution the gamma distribution can be parameterized in terms of a shape parameter α and an inverse scale parameter β 1 θ 7 f x α β β α x α 1 e β x γ α in palmer et al 2011 it is shown that the best value for shape and scale parameters for the detection response time are 2 and 400 respectively fig 10 presents the shape of the gamma distribution with these parameters and the mean value of 23 s based on the presented distribution allocated time to the detection process can be estimated and using the estimated allocated time the conditional probability of the time node for the detection event can be calculated eqs 3 6 3 2 diagnosis in this step the operator tries to diagnose failures and errors in the system by monitoring vessel screens and the environment second phase column presented in fig 8 after the detection of an initiating event the dp operator monitors deviations based on the data perceived from one or several information sources including alarm event list vessel position plot from the dp console hydro acoustic position reference system screen position reference system information from dp console thruster output power consumption vibration of bridge and acoustic noise depending on vessel size and bridge location in addition the dp operator s will actively search and process the information in order to perform failure diagnosis generally according to these data the dp operator s could determine likely failures and the severity of the situation the probability of diagnosis depends on multiple factors and could be calculated using the bn model as presented in fig 11 the conditional probabilities of all the parent nodes except the time node are quantified using eqs 1 and 2 and the multipliers are derived from byeet al 2017 based on expert judgment it is assumed that the highlighted nodes have the most impact thus higher conditional probabilities are assigned to these nodes in comparison to other parent nodes the time required for the diagnosis process is about 20 s chen et al 2008 therefore according to table 1 and eqs 3 6 the conditional probability of the time node could be calculated the time allocated to the diagnosis process is stochastic according to ma et al 2016 the best distribution that fits human response time is the generalized inverse gamma distribution in probability theory and statistics the generalized inverse gaussian distribution gig is a three parameter category of continuous probability distributions the general form of the gig distribution is presented in eq 8 8 f x a b p 2 2 k p a b x p 1 e a x b x 2 x 0 where kp is a modified bessel function of the second kind a 0 b 0 and p are real parameters of the function in this study the time allocated to the diagnosis process is assumed to follow the gig distribution a b and p are considered to be equal to 1 1 0 5 respectively these factors give a narrow tail that shows that there are some diagnosis processes that may take longer time in addition these factors give the mean value of the distribution equal to 20 s which is the average time required for the diagnosis process according to chen et al 2008 based on the presented distribution allocated time to the diagnosis process can be estimated and using the estimated allocated time the conditional probability of the time node for the diagnosis event can be calculated eqs 3 6 3 3 decision making in this step crews communicate and interact to understand the situation in a better way and to be able to make an appropriate decision in a short time third phase column presented in fig 8 finally the recovery tasks are concluded by an operator based on the gathered information and time and operational constraints three main decisions could be performed as recovery tasks in a dp drilling unit in short time chen et al 2008 1 change position reference i e deselect the faulty position reference and select an alternative position reference 2 recalibrate reference origin in dp control system 3 deselect faulty vessel sensor the probability of successful decision making depends on multiple factors and could be calculated using the bn presented in fig 13 the conditional probabilities of all parent nodes except the time node are quantified using eqs 1 and 2 and the multipliers are derived from byeet al 2017 based on expert judgment it is assumed that the highlighted red node has the most and highlighted blue nodes have the least impact on successful decision making process the decision making process takes about 5 s chen et al 2008 therefore based on table 1 and eqs 3 6 the conditional probability of the time node for the decision making event can be evaluated the time spent at this step follows the gig distribution as the diagnosis step however as the time required for this step is shorter than previous steps chen et al 2008 a b and p parameters are considered equal to 2 1 and 0 respectively fig 14 presents the gig distribution for time allocated to the decision making the mean value of the distribution is equal to 5 s chen et al 2008 based on the presented distribution allocated time to the decision making process can be estimated and using the estimated allocated time the conditional probability of the time node for the decision making event can be calculated eqs 3 6 3 4 execution at this phase the formulated recovery task from the previous step is executed fourth phase column presented in fig 8 the probability of execution depends on multiple factors including time fitness for duty stress ergonomics training and work processes and can be calculated using the bn presented in fig 15 the conditional probabilities of all parent nodes except the time node are quantified using eqs 1 and 2 and the multipliers are derived from byeet al 2017 the execution time process takes about 3 s chen et al 2008 therefore based on table 1 and eqs 3 6 the conditional probability of the time node for the execution event can be evaluated the response time of execution follows gig distribution as in previous stages however as the time required for this step is shorter than previous ones a b and p parameters are considered equal to 2 1 and 0 respectively with 3 s mean value chen et al 2008 based on the presented distribution allocated time to the execution process can be estimated and using the estimated allocated time the conditional probability of the time node for the execution event can be calculated eqs 3 6 3 5 auto dc if the vessel movement could not be controlled it will enter the red zone fifth phase column presented in fig 8 after entering the red zone the vessel must be disconnected disconnection can be performed automatically or manually the probability of auto disconnection mostly depends on technical factors of the dp drilling unit and can be calculated using the fault tree presented in fig 17 parhizkar et al 2020b the frequencies of basic events are presented in parhizkar et al 2020b 3 6 manual dc another option after entering the red zone is manual disconnection fifth phase column presented in fig 8 the probability of manual disconnection depends on technical and human factors the related fault tree and bn of the manual disconnection is presented in fig 18 and fig 19 respectively parhizkar et al 2020b the frequencies of the fault tree basic events are presented in parhizkar et al 2020b as shown one of the initial events of the fault tree is human error that could be quantified using the bn shown in fig 19 parhizkar et al 2020b the fault tree and bn are developed based on international marine contractors association imca annual reports on station keeping incidents from 2004 to 2016 analysis parhizkar et al 2020b it should be noted that the parent nodes are connected to all human error types however for simplicity this is not included in the figure 3 7 disconnection execution after selecting the method of disconnection the disconnection dc execution will be performed sixth phase column presented in fig 8 the probability of dc execution follows the same function as presented for the execution stage in addition the time allocated to dc execution consists of two main intervals one is the time allocated to activating the emergency disconnection by the operator controller which is an execution process and its response time follows the same pattern as the execution stage this time interval is denoted by disconnection execution in the results section the other time interval is the time it takes for the vessel to be disconnected and get back into a stable position according to chen et al 2008 it takes the vessel approximately 40 s to be disconnected and get back to a stable position this time interval is denoted by disconnection in the results section 3 8 end states end states are the states at the end of the pathways last phase column presented in fig 8 they are classified into groups that can lead to successes or severity of consequences in the case under study three possible end states are considered as follow ok the drilling unit could maintain position and return to green region to operate normally dc disconnection the drilling unit is disconnected appropriately md mechanical damage the drilling unit is not disconnected appropriately and as a result mechanical and or environmental damages occur 3 9 general solution algorithm in the proposed model for the case study bayesian networks and fault trees presented in section 3 are solved and failure probabilities of each event is calculated and finally based on fig 8 system end state probabilities are calculated the data flow starts with the monte carlo method the time allocated to each event is a random value from a gamma gig distribution in order to have a more realistic result the monte carlo method is used and random times required for detection diagnosis decision making and execution are selected from the generated distributions figs 10 figure 12 fig 14 and fig 16 time available is calculated based on the sensor data ambient and operational conditions using the dynamic simulator in the dynamic simulator the operational and environmental conditions of the dp system including wave current power system control system and propulsion system characteristics are taken as inputs using dynamic simulation the position and the velocity of the dp system over time are calculated the position and velocity of the dp system are used to calculate the time available before collision happens the required times random numbers selected from distributions and the time available are used to evaluate conditional probabilities using spar h method table 1 and eqs 3 6 the conditional probabilities as well as sensor data and crew characteristics enter bayesian networks and the failure probabilities of the human related events are quantified the failure probabilities of technical events are evaluated using fault trees afterall the end state probabilities of the esd are calculated based on the derived probability of each event this process is repeated for the predefined total number of monte carlo simulations at each iteration a random number from time allocated distributions will be selected and the process will be followed again and end state probabilities will be calculated 4 results 4 1 scope identification in the case study a dp drilling unit problem is provided to illustrate the methodology effectiveness it is assumed that an initiating event has happened and the system has entered the yellow region based on the system dynamic simulation results the system will enter the red region after 500s therefore the time available for decision making and recovery action to get back to the position is 500s on average this is sufficient time to diagnose and take action it is assumed that the disconnection would be performed automatically if required it is assumed that the operator procedure and the human machine interface have nominal effect on performance according to whaley et al 2011 the quality of the procedures is adequate and they are assumed to be followed procedures do not reduce nor to a large degree increase performance in addition the human machine interface and physical working environment has neither a negative nor a positive effect on performance all of the safety critical information is easily available and no human machine interface related issues are interfering with carrying out the task in addition crew characteristics are assumed as follow stress level operator s does not experience threat stress and the stress level has not a negative effect on performance training the operator s has training on the task s in this scenario and has the necessary knowledge and experience to be prepared for and to do the task s in this scenario the level of training does not reduce performance nor to a large degree improve performance fitness for duty the operators have good attitudes to safety and work conduct and there is explicit management support to prioritize safety when that is appropriate the operator s also shows mindfulness about safety work processes the teamwork is adequate on one or several teamwork factors that have been identified as important for the performance of the task or scenario in question teamwork has neither a negative nor a large positive effect on performance in addition failure frequencies of basic events in fault trees are assumed equal to values presented in parhizkar et al 2020b these assumptions are taken as inputs to the flow diagram illustrated in fig 20 and the probabilities of events as well as end states fig 8 are calculated which is presented in section 4 2 moreover sensitivity analyses on inputs are performed in section 4 3 incident scenarios with different available times adequate time available barely adequate time available inadequate time available are compared and in section 4 4 the results for incident scenarios with different complexity level are presented and compared 4 2 dynamic probabilistic risk assessment fig 21 presents the probability distribution of all events in the decision making process including execution the results are converged after selecting 10 000 random times allocated to each event the values on the y axis are probability 10e4 e g number 200 on y axis presents 200 10e4 0 02 as can be seen event probabilities are mostly between 0 8 and 1 as the time available before entering the red region is greater than the time required to make decision and execution each event will have an adequate time to be performed as a result their accuracy event probability has a high level in addition as can be seen the disconnection event has a constant probability of 0 9403 in all runs the reason is that the disconnection process has a fixed time allocated as mentioned in section 3 7 therefore the related fault tree and bn result in the same value for all 10 000 runs however in other events detection diagnosis decision making execution and disconnection execution the probability of the event has a distribution this is because the probability of these events are functions of the time allocated which has a probability distribution at each run a random number from the time allocated distribution is selected and then the event probability is calculated accordingly thus there are distributions for the mentioned events probabilities which are presented in fig 21 as mentioned before the end states of the scenario are ok disconnection dc and mechanical damage md fig 22 presents the occurrence probabilities and the mode values of these end states the mode values present the most frequent result of the end states after running for 10 000 times as is illustrated the mode of the ok probability distribution is 0 951 it means that the probability of decision making action taking and get vessel back to a safe position in less than 500s is 0 951 disconnection refers to an appropriate disconnection without any damage to the system and its probability is 0 046 md is a failure in proper disconnection the mode probability of md is 0 004 for the scenario under study fig 23 presents the time allocated distribution of all events in the decision making and execution process as can be seen distributions follow almost the same pattern as the human rt distributions as presented in figs 10 figure 12 fig 14 and fig 16 the results are derived based on the 10 000 runs as the number of runs increases the pattern would be more similar to the presented human rt distributions according to byeet al 2017 there are some overlaps between the performed tasks in the decision making process steps considering the values presented in byeet al 2017 chen et al 2008 the distribution of the overall time allocated from detecting an initiating event up to the end states is presented in fig 24 the mode of the distribution is 74 3 s in other words the decision making process from detection to taking action takes about 74 3 s 4 3 effect of time available on risk level after the detection of an initiating event operator s should make a decision and take recovery actions before the vessel enters the red region this forces a time constraint on the decision making process the time constraint depends on the nature of the incident vessel type water deepness and other environmental factors a dynamic simulator can be used to calculate this time constraint after an initiating event vessel position incident details and vessel characteristics are used as inputs to the simulator and the simulator shows how long it will take for the vessel enters the red region this time span is the time available to make a decision and perform a recovery action before entering the red region in this section the system risk level for three different scenarios i e adequate time 500s barely adequate time 200s and inadequate time 100s are compared these timelines are inferred from byeet al 2017 marius et al 2018 fig 25 presents the probability of end states as a function of the time allocated for the scenario with adequate time available in the graphs each dot represents one run out of 10 000 times run of the model it is shown that as the time allocated increases the probability of ok increases and reaches to 0 951 after about 150s i e the probability of proper decision making action taking and get vessel back to the safe position in 150s is 0 951 on the other hand the probabilities of md and dc decrease with increasing the allocated time md and dc end states approach 0 004 and 0 046 respectively the approached value of dc is higher than md due the adequate time available for the disconnection process when there is sufficient time available the disconnection could be performed appropriately and its probability would be higher than md fig 26 presents probability of end states as a function of time allocated for the barely adequate time scenario in this scenario it is assumed that the time available for decision making and taking recovery actions and get vessel back to a stable position is 200s as can be seen in the ok probability graph some of the runs resulted in approximately 0 values shown in red circle these runs present scenarios in which operator s decision making or taking action has taken longer than time available 200s and vessel is entered red region in this scenario due to the lack of time the probability of appropriate disconnection is low and as a result it is highly probable that vessel loss its position fig 27 illustrates the probability of end states for a scenario with inadequate time available in this scenario the time available for decision making action taking and get vessel back to a safe position is 100s as can be seen in graphs most of the runs take more than time available 100s consequently the ok probability approaches 0 001 and md approaches 0 998 as the time available is inadequate there is no time to have an appropriate disconnection and in most cases the disconnection process results in mechanical damage table 2 summarizes results of the three scenarios of adequate barely adequate and inadequate time available the presented values are the mode value of the probability distribution of each end state as presented in figs 25 27 the mode value is the most frequent value presented in the distributions therefore the sum of the probabilities presented in each column of table 2 are not equal to one as they are not presenting a specific scenario s end state in addition as can be seen by decreasing the time available the probability of appropriate disconnection is approaching to zero the reason is that it is assumed that in all scenarios the decision making process follows the same pattern as presented in fig 8 operator s try to diagnose make decision execute and if vessel enters red region take disconnection action therefore by decreasing the time available there would not be sufficient time for end events such as disconnection moreover in the inadequate time available scenario there is a very low probability that the vessel gets back into its stable position and the probability of md is equal to 0 998 4 4 effect of incident complexity on risk level the studied incident is not very complex and task complexity has neither a negative nor a positive effect on operator s performance in this section a comparison between the studied incident normal case and a case with complex tasks complex case is performed in the complex case the tasks that should be performed are moderately complex there is some ambiguity in what needs to be diagnosed or executed several variables are involved perhaps with some concurrent diagnoses or actions i e evolution performed periodically with many steps in this situation operator s performance is influenced negatively fig 28 presents the probability distribution of all events for both simple and complex cases the blue graphs are the same as graphs presented in fig 21 in fig 28 most parts of the distributions have overlap however it can be inferred that the probabilities of all decision making events decrease in the complex case due to the negative influence of complexity on operator s performance however this effect is more significant in the diagnosis process the reason is that complexity affects diagnosis performance dramatically and this is shown in the related bn presented in fig 11 in addition it is depicted that complexity has the least effect on the decision making process since at this step making decisions based on the available diagnosed information would be performed and task complexity does not be affected the successful decision making step considerably this is depicted in the successful decision making bn presented in fig 13 fig 29 presents the probability of end states for both the normal and complex cases the ok probability decreases approximately to 0 186 19 in the complex case in addition in the complex case the ok probability increases more slightly as a function of the time allocated however in the normal case the rate of increase is sharper this shows that in the complex case it takes more time to make an appropriate decision and take action as a result the rate of increase is not as sharp as in the normal case 5 discussion 5 1 the dynamic nature of the study the proposed framework aims to consider uncertain and time dependent risk influent factors and implement frequent updating of risk related information during decision making phases the proposed event flow diagram concept combines the static analysis of bns and fault trees with the dynamic analysis of event dependency and occurrence probability section 2 this combined analysis reveals that incident consequences are highly time dependent and operator s can face an increased risk level as the time available for a specific incident decreases figs 25 27 more specifically the proposed methodology considers time dependency in different parts of an analysis including 1 the model updates the event connections using updates from sensor data and a dynamic simulator of the system as a result over time the event sequence diagram is updated 2 the main difference between the proposed methodology and conventional methods is in the way that the model considers the failure probabilities as a function of required available and allocated time to each event the conditional probability of the time parent node in the bayesian networks figs 9 figure 11 figure 13 figure 15 are dependent on the required available and allocated time to each event eqs 3 6 the available time at each phase of the dynamic event sequence diagram fig 8 is calculated based on the available time of incident minus time spent in the previous phases as the probability of an event depends on the available time and the available time depends on the time spent on the previous events we could say that the probability of an event depends on the allocated time to the previous events that is one of the main novelties of this research that resulted in more realistic system failure probabilities in emergency situations 3 in the proposed framework all events have a time allocated human response time the human response time depends on the nature of the event and various environmental and physical factors that make the response time prediction complex many researchers have conducted studies on predicting the human response time and there are many experimental data in this regard in this study the time allocated distributions for detection diagnosis decision making and execution processes are estimated by using data driven methods eqs 7 and 8 5 2 the model applicability domain in this paper a dynamic probabilistic risk assessment method for the decision making process in emergencies is proposed section 2 the proposed event flow diagram fig 2 is applicable to different complex systems and application areas in an emergency the model is able to predict dynamic probabilistic risk of decision scenarios over time however it should be noted that the related dynamic simulator of the system bns and fault trees should be adapted to each system accordingly however the concept and the steps that should be followed remains the same as the presented case study section 3 5 3 response time uncertainties in the studied case the process is simulated 10 000 times section 4 2 in each run response times of detection diagnosis decision making and execution are randomly selected from response time distribution models then the probability of each event is calculated accordingly the results of every run are collected and a distribution of the results are presented in all graphs in the result section using this method response time uncertainties in decision making process is considered in the risk evaluation process 5 4 decision support tool the end states probabilities as a function of time are presented for all runs figs 25 27 from the results it can be seen that probability has an upper bound that could be reached in an adequate time span this approached value as a function of time could assist decision making process so that it could play a function for a similar situation for example the average required response time to reach maximum risk level could be derived for a different incident this value is a critical information for operator s in emergencies to make an optimal decision such as recovery actions or shut down scenarios not only the average response time but also the maximum response time is an important metric for making decision those could be derived from the presented graphs these are some examples of novel insights derived from the proposed model compared to the state of the art risk assessment studies as we have considered dynamic probabilistic dependencies in general the results of the model end state probabilities could provide inputs to a decision support tool a decision support tool assists operator s in making better and or faster decisions in a decision support tool powerful predication capabilities are utilized that help operators improve the way they approach available information and assist them to have a better understanding about system behavior the proposed dynamic risk assessment model in this paper could provide information about failure probabilities as a function of time for multiple decision scenarios this information can be used in decision support tools and improves their prediction capabilities significantly 5 5 future work one of the main paths for future research is the potential in developing the current methodology from an analysis tool into an online decision support tool dynamic probabilistic risk assessment delivers a better risk picture and allow for making decisions according to the needs going from a re active emergency management to a pro active approach where decision scenarios could be analyzed and anticipated based on real time information one possibility would be to simulate all alternative decision scenarios and provide an approximate time scale and risk level of each scenario another option would be to allow the operator s to be informed about the event and sequence probabilities in the near future knowing this information could help operator s to readjust system configuration with improved knowledge about the system 6 conclusion in this study a dynamic probabilistic risk assessment method for the decision making process in emergencies is proposed the framework is able to model the interactions between complex system operation and the decision making process in a very short execution time the predicted risk level is probabilistic and is updated over time by getting more information about system and human operations the complexity associated with system and human models and their interactions is considered by the event flow diagram concept introduced in this study in this concept all events in a decision scenario have probabilities that are functions of the time allocated response time these functions are calculated based on the nature of the events the concept considers system uncertainties using the bayesian network method and data driven distributions finally the monte carlo method is utilized to model stochastic behavior of the system and human responses a case study is performed on a dynamic positioning mobile offshore drilling unit and results show that the proposed framework is able to evaluate the risk level of a decision scenario for an incident a sensitivity analysis on the time available for decision making and incident complexity are performed and promising results have been reported not only with regards to risk assessment of decision scenarios but also with regards to the computational cost less than 1 s per run the interconnections between human and technical factors are modeled using the dpra method and more accurate risk levels of decision scenarios are achieved credit authorship contribution statement tarannom parhizkar conceptualization methodology data curation formal analysis modeling validation writing original draft ingrid bouwer utne methodology writing review editing supervision jan erik vinnem methodology writing review editing supervision ali mosleh conceptualization methodology supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20325,decision making in emergency situations is a risky and uncertain process due to the limited information and lack of time some key problem parameters such as the time required to complete important response tasks must be estimated and are therefore prone to errors other parameters such as the probability of occurrence of a consequential event will typically change as the response operation progresses as a result there should be a dynamic probabilistic risk assessment framework to assess the risk level of decision scenarios and facilitate the decision making process in this paper a methodology for dynamic probabilistic risk assessment of decision making in emergencies for complex marine systems is proposed in this method a dynamic event sequence diagram is introduced that helps to quantify events probabilities as a function of time as well as environmental and operational variables considering events interdependencies and uncertainties in addition the effects of time required 1 1 time required refers to the time needed to perform each level of decision making process detection diagnosis decision making execution and time available 2 2 time available is the time remaining before an accident happens in a system it is derived from the dynamic simulator of the system the dynamic simulator calculates the time remaining before a collision based on the system components status operation and environmental conditions at the time of incident for performing a decision in emergency are considered in the risk model in this methodology probabilistic models including bayesian network and monte carlo simulation are utilized to quantify the uncertain behavior of the decision making process in complex marine systems a computational study is also conducted to evaluate the methodology performance in terms of effectiveness and efficiency computational results show that the proposed approach can obtain optimal solutions for large and practical problem sizes keywords dynamic probabilistic risk assessment complex systems human machine interaction decision making response time model bayesian network monte carlo method dynamic event tree dynamic positioning system table of nomenclature symbol description α shape parameter β inverse scale parameter a t i time allocated to event i bn bayesian network c p conditional probability hep human error probability k p modified bessel function m spar h multiplier p i probability of event i p i i 1 connection probability between event i and events event i 1 p s f performance shaping factor rt response time t i occurrence time for event i t time required for event i 1 introduction industrial accidents may cause losses of life or injury social and economic disorders or environmental pollution when an incident occurs the relevant decision makers need to decide what actions to take instantly to mitigate or minimize the potential negative effects in most cases the decision making process in incidents especially in emergency cases 3 3 an emergency case or situation is an unplanned or imminent event that affects or threatens the health safety or welfare of people property and infrastructure and which requires a significant and coordinated response the defining characteristic of an emergency event or situation is that usual resources are overwhelmed or have the potential to be overwhelmed are complicated due to the limited time and information as time passes more information may become available however the consequences of the incident would be worse therefore having more information about system health status and risk level of decision making process at the early stages is an important research topic in complex systems in many risk assessment and management studies the main focus is on the static risk i e the risk and safety level of different scenarios without considering the dynamic nature of the system zhang et al 2017 norazahar et al 2017 over the past decades studies have been conducted to deal with dynamic risk assessment problems often dynamic event trees connected to fault trees bns are used to analyze the dynamic behavior of complex systems in the risk assessment process hakobyan et al 2008 barua et al 2020 zhang et al 2018 kanes et al 2017 meng et al 2019 li et al 2019a 2019b norazahar et al 2018 devooght et al devooght and smidts 1996 were among the first pioneers that presented the dynamic event tree method tombuyses et al 1998 and kloos et al kloos and peschke 2006 coupled the dynamic event tree method with monte carlo simulation for dynamic reliability problems bi et al bi and si 2012 proposed a dynamic risk model based on the master logic diagram mld for an oil spill scenario events in the mld diagram are valued based on the simulation results this diagram is used to identify the consequence contributors of an oil spill scenario which was then tracked and grouped into classes including environmental damage asset loss health impact social effect and their contributing individual events in the bottom hierarchy of the mld other methods include go flow matsuoka and kobayashi 1988 dynamic flow methodology dfm yau and guarro 1996 and dynamic simulation of the complex system coupled with a risk assessment model cojazzi 1996 izquierdo and labeau 2004 vorobyev and kudinov 2011 for instance wang et al 2016 proposed a dynamic risk assessment method for chemical processes the model is updated continuously by monitoring key variables in a process in addition the consequences are estimated using dynamic loss functions considering multiple key state variables one of the main risk elements in risk assessment of decision making process is human factors in boring and gertman 2016 principles of human reliability analysis and quantification are presented and in kolaczkowski 2005a good practices for implementing these principles are discussed the u s nuclear regulatory commission nrc has developed a guideline for quantification of human reliability analyses hras to support risk informed regulatory decision making us nuclear regulatory commission 2006 in these studies human reliability is analyzed using bayesian networks bns fault trees fts event trees ets or standardized plant analysis risk human reliability analysis spar h method the spar h method is used as a part of risk assessment in different applications ranging from nuclear power plants boring and gertman 2016 to fire accidents in complex systems lewis et al 2010 spar h method helps to quantify the effect of performance shaping factors on the human error probability hep one of the important performance shaping factors is the available time at the time of incident in hogenboom et al 2021 the importance of time in the risk of dynamic positioning operations has been pointed out by analyzing time using different methods in this study different interviews with dynamic positioning operators have been performed and results illustrate that the effects of time available and time should be considered in human reliability analysis having more information about the system health status and risk level could help operators to make better decisions in a shorter time decreasing hep significantly in emergency situations the time required 4 4 time required refers to the time needed to perform each level of decision making process detection diagnosis decision making execution and time available 5 5 time available is the time remaining before an accident happens in a system it is derived from the dynamic simulator of the system the dynamic simulator calculates the time remaining before a collision based on the system components status operation and environmental conditions at the time of incident are two time related factors that affect human error and probability and decision making process during an incident in real incidents the decision making and system response process needs some time to be performed which is known as time required in addition to time required time available should be estimated and addressed in a decision making risk model if the time available far exceeds the time required and there are not multiple competing tasks the estimated hep is not expected to be strongly influenced by time however if there is not enough or barely enough time to act the estimated hep is expected to be quite high kolaczkowski 2005b which may lead to failure in the emergency decision making available time could be evaluated using system dynamic simulation based on available sensor data at the time of incident initial event and the time required could be estimated based on human response time models even though contributions have been proposed to define and consider time available and time required in the decision making process murchison and gilmore 2018 wreathall et al 2003 joe et al 2015 swain and guttmann 1983 there is no concrete quantification method for evaluating hep as a function of time available and time required in addition interdependencies among response time 6 6 in this study the response time is equal to the time required to perform human related events of decision making steps detection diagnosis decision making and execution is barely addressed decision making steps are highly interdependent and response time of each step affect the other steps performance moreover system operation is affected by decisions dynamically as a result to have an accurate decision making model the interactions among decision making steps as well as human machine interactions should be considered in the modeling procedure the interactions between system and human in a dynamic environment are considered in a study carried out by chang et al chang and mosleh 2007a 2007b 2007c 2007d 2007e the objective of the present study is to develop a decision making risk assessment framework that considers the dynamic nature of decision making steps and their interdependencies with considering time available and time required for each step in the proposed framework the probability of a scenario is calculated as a function of previous events probabilities and occurrence time utne et al 2011 the method is based on a dynamic event sequence diagram desd that gets inputs from response time models and bayesian networks in order to quantify the occurrence time and probability of each event respectively there are multiple alternative decision scenarios in an emergency situation with different risk levels the novelties of the proposed dynamic probabilistic risk assessment method are the ability to calculate the decision making failure probability as a function of time available and time required operator response time and other performance shaping factors consider human machine interdependencies by updating time available for next decision making events based on the current system and operator s status and operating conditions use data driven response time models to evaluate time required for all decision making events including detection diagnosis decision making and execution consider environmental system and human factors uncertainties using bayesian network models utilize the monte carlo method to model the stochastic behavior of variables such as operators detection diagnosis decision making and execution response times the paper is organized as follows section 2 presents the general form of the proposed methodology section 3 models the operator s decision making process in a dynamic positioning dp drilling unit as a case study in section 4 an emergency situation is described and based on the developed model in section 3 the probability of failure of decision making process is evaluated in this section the effects of available time and incident complexity on the decision making risk level is analyzed then section 5 discusses the outcomes and proposes future research directions finally in section 6 conclusions are presented 2 methodology different temporal orderings of events could potentially lead to different scenarios as a result it is crucial to know the allocated time available in an incident according to the reviewed literature villa et al 2016 current dynamic event sequence diagrams esds can only handle time delays in this regard however this study extends the dynamic esd framework to consider time allocated 7 7 time allocated is the time spent on an event when there is a sufficient time time allocated to each event is equal to the time required to each event and update the following events accordingly fig 1 presents a dynamic event sequence diagram as can be seen there are different phases phase i phase i 1 etc defined based on time intervals phases include multiple event alternatives in a time interval e g event i represents an event that happens between time ti and ti 1 the probability of each event is denoted by p i e the probability of event i is pi the time allocated to each event is presented as a t i e the time allocated to event i is a t i as presented in fig 1 the connections between events are probabilistic according to the figure after event i two different events event i 1 1 and event i 1 2 with different probabilities pi i 1 1 pi i 1 2 can occur these connection probabilities depend on the system s environmental and operating conditions parhizkar et al 2020a parhizkar mosleh as well as time allocated to the previous events the constraints presented in the figure illustrates the environmental and operational conditions system boundary and requirements that affect connection probability quantifications fig 2 presents an event flow diagram of a decision making process in an emergency in this figure different phases of the decision making including detection diagnosis decision making and execution are presented in each phase there are various events that should be defined for the case under study in fig 2 some event examples for different phases are presented the presented phases in fig 2 are detection the first step of the decision making process presented as a first phase column in the event flow diagram fig 2 this event presents that the initiating event should be detected first then other steps of the decision making could be performed diagnosis the next step is diagnosis that could be performed based on different methods such as monitoring and or communication each method could be presented as one or multiple events in the diagnosis column decision making after the diagnosis process different scenarios of recovery are proposed and compared in this phase execution the last step of the decision making process is execution actions could be performed manually automatically or combined which are presented in this phase in the proposed method events convey two important types of information i e probability and time the probability of an event is the measure of the chance that the event will occur and it depends on environmental and operational factors including technical human and organizational risk factors that should be defined based on the scope of the study the event probability can be calculated using a bn that is presented in fig 3 different bn structures could represent human behavior error in order to quantify a bn conditional probabilities among all the nodes should be available in this study the structure of the bn is simplified to enable quantification of all conditional probabilities accurately the affecting factors performance shaping factors psf on human behavior error are determined according to whaley et al 2011 in this study it is assumed that psf factors are independent in the bayesian network bayes rule is utilized to quantify the child node human behavior error in fig 3 in the bayes rule we need the probability of parent nodes and conditional probabilities of each arc connection between nodes to quantify a child node the probabilities of the parent nodes of the bn fig 3 are defined based on the available evidence such as sensor data at the time of incident conditional probabilities of the bn can be calculated based on spar h method byeet al 2017 spar h method is a human reliability assessment tool that uses psfs to quantify the probability of human error psfs are the aspects of human behavior and the environment that can affect human performance such as stress level of training and task complexity based on this method the hep can be quantified using eq 1 1 c p p s f s when 3 or more negative psf influences are present in the equation above the conditional probability should be computed as a composite psf score used in conjunction with the adjustment factor negative psfs are present anytime a multiplier greater than 1 is selected the composite psf score is computed by multiplying all the assigned psf values then the adjustment factor below is applied to compute the conditional probabilities the first term of the equation presents psfs for human errors related to the diagnosis tasks e g detection diagnosis making a decision and the second term is psfs of human errors related to action tasks e g execution groth and swiler 2012 2 c p 0 01 p s f s 0 01 p s f s 1 1 0 001 p s f s 0 001 p s f s 1 1 where 0 01 and 0 001 are nominal human error probabilities for detection diagnosis and action execution tasks respectively these numbers are derived based on several studies on human behavior and human error quantifications byeet al 2017 psfs are multipliers of each parent node that impact the human performance these values are highly dependent on the type of event and their values could be found in related references byeet al 2017 has presented psfs for operator s on board in a dynamic positioning drilling unit for instance for stress psf factor there are three spar h levels as follow that can be used to quantify stress psf at different situations extreme a level of disruptive stress in which the performance of most people will deteriorate drastically this is likely to occur when the onset of the stressor is sudden and the stressing situation persists for long periods this level is also associated with the feeling of threat to one s physical well being or to one s self esteem or professional status and is qualitatively different from lesser degrees of high stress e g catastrophic failures can result in extreme stress for operating personnel because of the potential for radioactive release in this situation the stress psf factor is equal to 25 byeet al 2017 high a level of stress higher than the nominal level e g multiple instruments and annunciators alarm unexpectedly and at the same time loud continuous noise impact s ability to focus attention on the task the consequences of the task represent a threat to facility safety in this situation the stress psf factor is equal to 5 byeet al 2017 nominal the level of stress that is conducive to good performance in this situation the stress psf factor is equal to 1 byeet al 2017 for other psfs such as fitness for duty complexity ergonomics etc there are different categories and psf values accordingly the psf values are used in eqs 1 and 2 to quantify conditional probabilities of each parent nodes these conditional probabilities as well as parent nodes probabilities are taken as inputs in bayes rules in the bayesian network to calculate the human behavior child node probability the human behavior node could particularly model the detection section 3 1 diagnosis section 3 2 decision making section 3 3 and execution processes section 3 4 one of the main innovations of the proposed methodology is in the quantification process of conditional probability of the time node the time refers to the time allocated to the event the conditional probability as a function of the time allocated to an event could follow different patterns in this study a linear function based on the spar h method principles is proposed in spar h method the failure probability of an event diagnosis or action tasks is calculated using eqs 1 and 2 byeet al 2017 table 1 presents the spar h multiplier presented as psfs in eqs 1 and 2 and event probabilities for four different allocated times byeet al 2017 the values in the table give four probabilities at four different allocated times red dots presented in fig 4 in order to make the conditional probability function continuous it is assumed that the function follows a linear pattern at the other allocated times as presented in fig 4 the functions of linear lines between dots could be calculated based on the time required and time allocated to the tasks for instance for diagnostic tasks the linear functions could be calculated as eqs 3 6 3 c p t i m e 1 0 3355 t 3 a t a t 1 3 t 4 c p t i m e 1 0 3355 1 0 0917 1 0 3355 t a t 1 3 t a t 2 3 t 5 c p t i m e 1 0 0917 1 0 01 1 0 0917 t a t 2 3 t a t t 6 c p t i m e 1 0 01 t a t for action tasks the constants of the linear equations should be updated based on the numbers presented in table 1 as can be seen the linear functions depend on the time required t and time allocated at to each task in the case study section these functions are updated according to the required time for each task the time allocated at to each event depends on the nature of the event events with a technical basis such as automatic shutdown of a system engine part load operation etc could have a specific time required that depends on the machinery limitations however there are other types of events with human interference such as monitoring diagnosis execution etc in these cases time allocated is a function of various environmental operational and behavioral parameters such as experience training stress level etc and this creates parametric uncertainties that evolve in complexity as one moves from one complex emergency to another the time allocated could be evaluated using data driven probabilistic models for instance in hockley 1984 batur et al 2018 zandt 2002 different distributions for human response time allocated time are proposed for instance a human response time could follow inverse gamma lognormal gamma or generalized gamma distributions operators allocate time to the remaining decision making events based on the remaining time available for instance when there is enough time available nominal time according to table 1 recovery action could be performed however in situations with barely adequate time defined in table 1 emergency actions such as emergency shutdown are performed to avoid accidents at the time of incident time available is derived from the dynamic simulator of the system the dynamic simulator consists of dynamic models 8 8 dynamic models help understand the system behavior these models are either from fundamental relationships first principles physics based or and derived from data empirical that rely on knowledge of the process of system components and calculates the time remaining before accident failure based on the system components status operation and environmental conditions at the time of incident as time passes the time available decreases based on the time allocated to each event in the proposed methodology the effect of remaining time on the upcoming decision making events probabilities are quantified using eqs 3 6 the derived conditional probabilities will be used as the conditional probabilities of the time node in the bayesian network fig 3 in addition the conditional probabilities of other bayesian network nodes such as fitness for duty stress complexity etc will be evaluated using eqs 1 and 2 all conditional probabilities will be used to quantify the child node hep of the bayesian network using bayes rules in the quantification process of the bayesian network it is assumed that parent nodes of the bayesian network are independent fig 5 presents the flow diagram of the proposed methodology in the response time model the time allocated to each decision making event is evaluated the allocated times are used to calculate the conditional probability of the time node based on table 1 and eqs 3 6 the dynamic simulator performs basic calculations to derive available time using sensor data sensor data include all data from different sensors installed in the system that are used to measure system operating conditions and performance such as temperature pressure mass flow rate position velocity power etc the sensor data is used to estimate the available time before an accident for instance in a vessel using sensors the vessel velocity and its distance from an obstacle can be measures in the vessel dynamic simulator available time before collision is estimated using these sensor data in addition to sensor data that can be used for available time calculation crew characteristics are used in the spar h model to calculate parent nodes probabilities psf factors of bns for instance according to a crew member behavior we can estimate the probability of fitness for duty stress level etc of the crew member these probabilities are used to calculate human error probability using the bn fig 3 in addition the system under study could have technical components such as engine control system etc the failure success probability of these technical components could be calculated using fault tree methods the output of fault trees in addition to human error probability are used to calculate failure success probabilities of the esd events and consequently to evaluate the probability of end states in the framework using hybrid causal logic hcl methodology the hcl methodology contains algorithms that convert ets and fts into equivalent binary decision diagrams bdds a bdd is a rooted directed acyclic graph with an unconstrained number of in edges and two out edges one for each two states such as true or false of any given variable a bdd is a binary decision tree over the boolean variables where identical boolean expressions are unified thus a bdd has two terminal nodes labeled 0 false and 1 true representing the final value of the logical expression røed et al 2009 the hcl algorithm is a major extension of bdds the hcl layers of esds or ets and fts are included through transformation into bdds and linked to the bns layer by properly handling the dependencies wang 2007 as we can see in fig 6 linking bns to eds and ft models provides a way for explicitly accounting for potentially complex and often hidden interdependencies of risk models elements as an example we note that basic events b and c which appear in different fts of fig 6 are in fact interdependent as they are both linked to the same bn of other risk factors the main outcome of the methodology fig 5 is the probability of the end states of the presented esd in fig 2 the end states could be system failure or success and the methodology proposed in the paper evaluates the success failure probabilities of the decision making process in emergency situations as mentioned the allocated time to each event is a stochastic variable and could take different values depending on environmental operational and human characteristics therefore there is not a single result for end state probabilities a method to consider the stochastic behavior of allocated times is monte carlo mc method mc is a class of computational algorithm that performs repeated random sampling samples are randomly selected from a distribution dataset then the samples are taken as model inputs and results are generated accordingly in the presented methodology fig 5 samples could be randomly selected from response time distributions of each event i e the samples include four random allocated times for detection diagnosis decision making and execution process derived from their response time distributions then end state probabilities are calculated using the presented methodology in fig 5 the random sampling process is repeated for the predefined total number of mc simulations the output of mc is a distribution of end state probabilities presenting all model outputs for every samples this is further exemplified in the next section with a case study on a dynamic positioning dp system in a mobile offshore drilling rig unit modu 3 case study the proposed methodology is applied to a dp system in a modu the dp is a computer controlled system used to automatically maintain a ship or vessel s position and heading by using its own propellers and thrusters the studied dp system enables positioning of an offshore drilling unit an offshore drilling unit operates in a green zone inside a yellow limit presented in fig 7 chen et al 2008 when an initiating event happens the vessel loses the capability to maintain position and may enter the yellow zone whenever the vessel passes the yellow limit the operation of the unit must be stopped and the operator starts to prepare for disconnection when the vessel passes the red limit emergency disconnection must be initiated to disconnect the riser and shut in the well failure of disconnection may lead to damage of riser blowout preventer or wellhead and hydrocarbon influx kick which can cause vessel downtime significant financial losses and environmental damages the event flow diagram for the case study is presented in fig 8 as can be seen at the first level the abnormalities should be detected then the operator starts monitoring to diagnose any undesired deviations in the system in the decision making stage crews may share some knowledge based information that could help them in the next step of making a decision then one or some of the recovery tasks i e change position reference recalibrate reference origin and deselect faulty sensor is to be executed the formulated tasks are transformed into sequenced muscle movements and the tasks are executed in the last stage if any of the events fails the drilling unit will pass the red limit and the disconnection should be performed disconnection could be performed by the operator either manually or automatically in both cases there is a probability of failure therefore possible end states are dc disconnect properly md mechanical damage to due disconnection failure and ok system maintains position and returns to safe zone in auto and manual disconnection level the failure of hardware software and human components are modeled using fault trees sections 3 5 and 3 6 respectively the hardware components are the power system including power generation units switches ups and hardware parts of the control system computer software component includes the software parts of the control system computer however in all other levels detection diagnosis decision making execution and disconnection execution it is assumed that there is no failure in hardware and software and the only possible failure is due to human factors the next step is the quantification of events which is presented in the following subsections for each event 3 1 detection at the first stage the operator should detect deviations from normal operation first phase column presented in fig 8 the probability of detection p d e t e c t i o n depends on time fitness for duty stress complexity ergonomics training and work processes and could be calculated based on the bn presented in fig 9 the conditional probabilities of all parent nodes except time are quantified using eqs 1 and 2 and the multipliers of each parent node are derived from byeet al 2017 the conditional probability of the time node i e allocated time to the detection could be calculated based on eqs 3 6 according to byeet al 2017 the detection of an initiating event in a dp drilling unit takes approximately 23 s therefore based on table 1 and eqs 3 6 the conditional probability function of the time node for the detection event can be calculated according to the reviewed literature the response time rt of operator s detection follows the gamma distribution palmer et al 2011 the gamma distribution is a two parameter category of the continuous probability distributions eq 7 presents a general form of the gamma distribution the gamma distribution can be parameterized in terms of a shape parameter α and an inverse scale parameter β 1 θ 7 f x α β β α x α 1 e β x γ α in palmer et al 2011 it is shown that the best value for shape and scale parameters for the detection response time are 2 and 400 respectively fig 10 presents the shape of the gamma distribution with these parameters and the mean value of 23 s based on the presented distribution allocated time to the detection process can be estimated and using the estimated allocated time the conditional probability of the time node for the detection event can be calculated eqs 3 6 3 2 diagnosis in this step the operator tries to diagnose failures and errors in the system by monitoring vessel screens and the environment second phase column presented in fig 8 after the detection of an initiating event the dp operator monitors deviations based on the data perceived from one or several information sources including alarm event list vessel position plot from the dp console hydro acoustic position reference system screen position reference system information from dp console thruster output power consumption vibration of bridge and acoustic noise depending on vessel size and bridge location in addition the dp operator s will actively search and process the information in order to perform failure diagnosis generally according to these data the dp operator s could determine likely failures and the severity of the situation the probability of diagnosis depends on multiple factors and could be calculated using the bn model as presented in fig 11 the conditional probabilities of all the parent nodes except the time node are quantified using eqs 1 and 2 and the multipliers are derived from byeet al 2017 based on expert judgment it is assumed that the highlighted nodes have the most impact thus higher conditional probabilities are assigned to these nodes in comparison to other parent nodes the time required for the diagnosis process is about 20 s chen et al 2008 therefore according to table 1 and eqs 3 6 the conditional probability of the time node could be calculated the time allocated to the diagnosis process is stochastic according to ma et al 2016 the best distribution that fits human response time is the generalized inverse gamma distribution in probability theory and statistics the generalized inverse gaussian distribution gig is a three parameter category of continuous probability distributions the general form of the gig distribution is presented in eq 8 8 f x a b p 2 2 k p a b x p 1 e a x b x 2 x 0 where kp is a modified bessel function of the second kind a 0 b 0 and p are real parameters of the function in this study the time allocated to the diagnosis process is assumed to follow the gig distribution a b and p are considered to be equal to 1 1 0 5 respectively these factors give a narrow tail that shows that there are some diagnosis processes that may take longer time in addition these factors give the mean value of the distribution equal to 20 s which is the average time required for the diagnosis process according to chen et al 2008 based on the presented distribution allocated time to the diagnosis process can be estimated and using the estimated allocated time the conditional probability of the time node for the diagnosis event can be calculated eqs 3 6 3 3 decision making in this step crews communicate and interact to understand the situation in a better way and to be able to make an appropriate decision in a short time third phase column presented in fig 8 finally the recovery tasks are concluded by an operator based on the gathered information and time and operational constraints three main decisions could be performed as recovery tasks in a dp drilling unit in short time chen et al 2008 1 change position reference i e deselect the faulty position reference and select an alternative position reference 2 recalibrate reference origin in dp control system 3 deselect faulty vessel sensor the probability of successful decision making depends on multiple factors and could be calculated using the bn presented in fig 13 the conditional probabilities of all parent nodes except the time node are quantified using eqs 1 and 2 and the multipliers are derived from byeet al 2017 based on expert judgment it is assumed that the highlighted red node has the most and highlighted blue nodes have the least impact on successful decision making process the decision making process takes about 5 s chen et al 2008 therefore based on table 1 and eqs 3 6 the conditional probability of the time node for the decision making event can be evaluated the time spent at this step follows the gig distribution as the diagnosis step however as the time required for this step is shorter than previous steps chen et al 2008 a b and p parameters are considered equal to 2 1 and 0 respectively fig 14 presents the gig distribution for time allocated to the decision making the mean value of the distribution is equal to 5 s chen et al 2008 based on the presented distribution allocated time to the decision making process can be estimated and using the estimated allocated time the conditional probability of the time node for the decision making event can be calculated eqs 3 6 3 4 execution at this phase the formulated recovery task from the previous step is executed fourth phase column presented in fig 8 the probability of execution depends on multiple factors including time fitness for duty stress ergonomics training and work processes and can be calculated using the bn presented in fig 15 the conditional probabilities of all parent nodes except the time node are quantified using eqs 1 and 2 and the multipliers are derived from byeet al 2017 the execution time process takes about 3 s chen et al 2008 therefore based on table 1 and eqs 3 6 the conditional probability of the time node for the execution event can be evaluated the response time of execution follows gig distribution as in previous stages however as the time required for this step is shorter than previous ones a b and p parameters are considered equal to 2 1 and 0 respectively with 3 s mean value chen et al 2008 based on the presented distribution allocated time to the execution process can be estimated and using the estimated allocated time the conditional probability of the time node for the execution event can be calculated eqs 3 6 3 5 auto dc if the vessel movement could not be controlled it will enter the red zone fifth phase column presented in fig 8 after entering the red zone the vessel must be disconnected disconnection can be performed automatically or manually the probability of auto disconnection mostly depends on technical factors of the dp drilling unit and can be calculated using the fault tree presented in fig 17 parhizkar et al 2020b the frequencies of basic events are presented in parhizkar et al 2020b 3 6 manual dc another option after entering the red zone is manual disconnection fifth phase column presented in fig 8 the probability of manual disconnection depends on technical and human factors the related fault tree and bn of the manual disconnection is presented in fig 18 and fig 19 respectively parhizkar et al 2020b the frequencies of the fault tree basic events are presented in parhizkar et al 2020b as shown one of the initial events of the fault tree is human error that could be quantified using the bn shown in fig 19 parhizkar et al 2020b the fault tree and bn are developed based on international marine contractors association imca annual reports on station keeping incidents from 2004 to 2016 analysis parhizkar et al 2020b it should be noted that the parent nodes are connected to all human error types however for simplicity this is not included in the figure 3 7 disconnection execution after selecting the method of disconnection the disconnection dc execution will be performed sixth phase column presented in fig 8 the probability of dc execution follows the same function as presented for the execution stage in addition the time allocated to dc execution consists of two main intervals one is the time allocated to activating the emergency disconnection by the operator controller which is an execution process and its response time follows the same pattern as the execution stage this time interval is denoted by disconnection execution in the results section the other time interval is the time it takes for the vessel to be disconnected and get back into a stable position according to chen et al 2008 it takes the vessel approximately 40 s to be disconnected and get back to a stable position this time interval is denoted by disconnection in the results section 3 8 end states end states are the states at the end of the pathways last phase column presented in fig 8 they are classified into groups that can lead to successes or severity of consequences in the case under study three possible end states are considered as follow ok the drilling unit could maintain position and return to green region to operate normally dc disconnection the drilling unit is disconnected appropriately md mechanical damage the drilling unit is not disconnected appropriately and as a result mechanical and or environmental damages occur 3 9 general solution algorithm in the proposed model for the case study bayesian networks and fault trees presented in section 3 are solved and failure probabilities of each event is calculated and finally based on fig 8 system end state probabilities are calculated the data flow starts with the monte carlo method the time allocated to each event is a random value from a gamma gig distribution in order to have a more realistic result the monte carlo method is used and random times required for detection diagnosis decision making and execution are selected from the generated distributions figs 10 figure 12 fig 14 and fig 16 time available is calculated based on the sensor data ambient and operational conditions using the dynamic simulator in the dynamic simulator the operational and environmental conditions of the dp system including wave current power system control system and propulsion system characteristics are taken as inputs using dynamic simulation the position and the velocity of the dp system over time are calculated the position and velocity of the dp system are used to calculate the time available before collision happens the required times random numbers selected from distributions and the time available are used to evaluate conditional probabilities using spar h method table 1 and eqs 3 6 the conditional probabilities as well as sensor data and crew characteristics enter bayesian networks and the failure probabilities of the human related events are quantified the failure probabilities of technical events are evaluated using fault trees afterall the end state probabilities of the esd are calculated based on the derived probability of each event this process is repeated for the predefined total number of monte carlo simulations at each iteration a random number from time allocated distributions will be selected and the process will be followed again and end state probabilities will be calculated 4 results 4 1 scope identification in the case study a dp drilling unit problem is provided to illustrate the methodology effectiveness it is assumed that an initiating event has happened and the system has entered the yellow region based on the system dynamic simulation results the system will enter the red region after 500s therefore the time available for decision making and recovery action to get back to the position is 500s on average this is sufficient time to diagnose and take action it is assumed that the disconnection would be performed automatically if required it is assumed that the operator procedure and the human machine interface have nominal effect on performance according to whaley et al 2011 the quality of the procedures is adequate and they are assumed to be followed procedures do not reduce nor to a large degree increase performance in addition the human machine interface and physical working environment has neither a negative nor a positive effect on performance all of the safety critical information is easily available and no human machine interface related issues are interfering with carrying out the task in addition crew characteristics are assumed as follow stress level operator s does not experience threat stress and the stress level has not a negative effect on performance training the operator s has training on the task s in this scenario and has the necessary knowledge and experience to be prepared for and to do the task s in this scenario the level of training does not reduce performance nor to a large degree improve performance fitness for duty the operators have good attitudes to safety and work conduct and there is explicit management support to prioritize safety when that is appropriate the operator s also shows mindfulness about safety work processes the teamwork is adequate on one or several teamwork factors that have been identified as important for the performance of the task or scenario in question teamwork has neither a negative nor a large positive effect on performance in addition failure frequencies of basic events in fault trees are assumed equal to values presented in parhizkar et al 2020b these assumptions are taken as inputs to the flow diagram illustrated in fig 20 and the probabilities of events as well as end states fig 8 are calculated which is presented in section 4 2 moreover sensitivity analyses on inputs are performed in section 4 3 incident scenarios with different available times adequate time available barely adequate time available inadequate time available are compared and in section 4 4 the results for incident scenarios with different complexity level are presented and compared 4 2 dynamic probabilistic risk assessment fig 21 presents the probability distribution of all events in the decision making process including execution the results are converged after selecting 10 000 random times allocated to each event the values on the y axis are probability 10e4 e g number 200 on y axis presents 200 10e4 0 02 as can be seen event probabilities are mostly between 0 8 and 1 as the time available before entering the red region is greater than the time required to make decision and execution each event will have an adequate time to be performed as a result their accuracy event probability has a high level in addition as can be seen the disconnection event has a constant probability of 0 9403 in all runs the reason is that the disconnection process has a fixed time allocated as mentioned in section 3 7 therefore the related fault tree and bn result in the same value for all 10 000 runs however in other events detection diagnosis decision making execution and disconnection execution the probability of the event has a distribution this is because the probability of these events are functions of the time allocated which has a probability distribution at each run a random number from the time allocated distribution is selected and then the event probability is calculated accordingly thus there are distributions for the mentioned events probabilities which are presented in fig 21 as mentioned before the end states of the scenario are ok disconnection dc and mechanical damage md fig 22 presents the occurrence probabilities and the mode values of these end states the mode values present the most frequent result of the end states after running for 10 000 times as is illustrated the mode of the ok probability distribution is 0 951 it means that the probability of decision making action taking and get vessel back to a safe position in less than 500s is 0 951 disconnection refers to an appropriate disconnection without any damage to the system and its probability is 0 046 md is a failure in proper disconnection the mode probability of md is 0 004 for the scenario under study fig 23 presents the time allocated distribution of all events in the decision making and execution process as can be seen distributions follow almost the same pattern as the human rt distributions as presented in figs 10 figure 12 fig 14 and fig 16 the results are derived based on the 10 000 runs as the number of runs increases the pattern would be more similar to the presented human rt distributions according to byeet al 2017 there are some overlaps between the performed tasks in the decision making process steps considering the values presented in byeet al 2017 chen et al 2008 the distribution of the overall time allocated from detecting an initiating event up to the end states is presented in fig 24 the mode of the distribution is 74 3 s in other words the decision making process from detection to taking action takes about 74 3 s 4 3 effect of time available on risk level after the detection of an initiating event operator s should make a decision and take recovery actions before the vessel enters the red region this forces a time constraint on the decision making process the time constraint depends on the nature of the incident vessel type water deepness and other environmental factors a dynamic simulator can be used to calculate this time constraint after an initiating event vessel position incident details and vessel characteristics are used as inputs to the simulator and the simulator shows how long it will take for the vessel enters the red region this time span is the time available to make a decision and perform a recovery action before entering the red region in this section the system risk level for three different scenarios i e adequate time 500s barely adequate time 200s and inadequate time 100s are compared these timelines are inferred from byeet al 2017 marius et al 2018 fig 25 presents the probability of end states as a function of the time allocated for the scenario with adequate time available in the graphs each dot represents one run out of 10 000 times run of the model it is shown that as the time allocated increases the probability of ok increases and reaches to 0 951 after about 150s i e the probability of proper decision making action taking and get vessel back to the safe position in 150s is 0 951 on the other hand the probabilities of md and dc decrease with increasing the allocated time md and dc end states approach 0 004 and 0 046 respectively the approached value of dc is higher than md due the adequate time available for the disconnection process when there is sufficient time available the disconnection could be performed appropriately and its probability would be higher than md fig 26 presents probability of end states as a function of time allocated for the barely adequate time scenario in this scenario it is assumed that the time available for decision making and taking recovery actions and get vessel back to a stable position is 200s as can be seen in the ok probability graph some of the runs resulted in approximately 0 values shown in red circle these runs present scenarios in which operator s decision making or taking action has taken longer than time available 200s and vessel is entered red region in this scenario due to the lack of time the probability of appropriate disconnection is low and as a result it is highly probable that vessel loss its position fig 27 illustrates the probability of end states for a scenario with inadequate time available in this scenario the time available for decision making action taking and get vessel back to a safe position is 100s as can be seen in graphs most of the runs take more than time available 100s consequently the ok probability approaches 0 001 and md approaches 0 998 as the time available is inadequate there is no time to have an appropriate disconnection and in most cases the disconnection process results in mechanical damage table 2 summarizes results of the three scenarios of adequate barely adequate and inadequate time available the presented values are the mode value of the probability distribution of each end state as presented in figs 25 27 the mode value is the most frequent value presented in the distributions therefore the sum of the probabilities presented in each column of table 2 are not equal to one as they are not presenting a specific scenario s end state in addition as can be seen by decreasing the time available the probability of appropriate disconnection is approaching to zero the reason is that it is assumed that in all scenarios the decision making process follows the same pattern as presented in fig 8 operator s try to diagnose make decision execute and if vessel enters red region take disconnection action therefore by decreasing the time available there would not be sufficient time for end events such as disconnection moreover in the inadequate time available scenario there is a very low probability that the vessel gets back into its stable position and the probability of md is equal to 0 998 4 4 effect of incident complexity on risk level the studied incident is not very complex and task complexity has neither a negative nor a positive effect on operator s performance in this section a comparison between the studied incident normal case and a case with complex tasks complex case is performed in the complex case the tasks that should be performed are moderately complex there is some ambiguity in what needs to be diagnosed or executed several variables are involved perhaps with some concurrent diagnoses or actions i e evolution performed periodically with many steps in this situation operator s performance is influenced negatively fig 28 presents the probability distribution of all events for both simple and complex cases the blue graphs are the same as graphs presented in fig 21 in fig 28 most parts of the distributions have overlap however it can be inferred that the probabilities of all decision making events decrease in the complex case due to the negative influence of complexity on operator s performance however this effect is more significant in the diagnosis process the reason is that complexity affects diagnosis performance dramatically and this is shown in the related bn presented in fig 11 in addition it is depicted that complexity has the least effect on the decision making process since at this step making decisions based on the available diagnosed information would be performed and task complexity does not be affected the successful decision making step considerably this is depicted in the successful decision making bn presented in fig 13 fig 29 presents the probability of end states for both the normal and complex cases the ok probability decreases approximately to 0 186 19 in the complex case in addition in the complex case the ok probability increases more slightly as a function of the time allocated however in the normal case the rate of increase is sharper this shows that in the complex case it takes more time to make an appropriate decision and take action as a result the rate of increase is not as sharp as in the normal case 5 discussion 5 1 the dynamic nature of the study the proposed framework aims to consider uncertain and time dependent risk influent factors and implement frequent updating of risk related information during decision making phases the proposed event flow diagram concept combines the static analysis of bns and fault trees with the dynamic analysis of event dependency and occurrence probability section 2 this combined analysis reveals that incident consequences are highly time dependent and operator s can face an increased risk level as the time available for a specific incident decreases figs 25 27 more specifically the proposed methodology considers time dependency in different parts of an analysis including 1 the model updates the event connections using updates from sensor data and a dynamic simulator of the system as a result over time the event sequence diagram is updated 2 the main difference between the proposed methodology and conventional methods is in the way that the model considers the failure probabilities as a function of required available and allocated time to each event the conditional probability of the time parent node in the bayesian networks figs 9 figure 11 figure 13 figure 15 are dependent on the required available and allocated time to each event eqs 3 6 the available time at each phase of the dynamic event sequence diagram fig 8 is calculated based on the available time of incident minus time spent in the previous phases as the probability of an event depends on the available time and the available time depends on the time spent on the previous events we could say that the probability of an event depends on the allocated time to the previous events that is one of the main novelties of this research that resulted in more realistic system failure probabilities in emergency situations 3 in the proposed framework all events have a time allocated human response time the human response time depends on the nature of the event and various environmental and physical factors that make the response time prediction complex many researchers have conducted studies on predicting the human response time and there are many experimental data in this regard in this study the time allocated distributions for detection diagnosis decision making and execution processes are estimated by using data driven methods eqs 7 and 8 5 2 the model applicability domain in this paper a dynamic probabilistic risk assessment method for the decision making process in emergencies is proposed section 2 the proposed event flow diagram fig 2 is applicable to different complex systems and application areas in an emergency the model is able to predict dynamic probabilistic risk of decision scenarios over time however it should be noted that the related dynamic simulator of the system bns and fault trees should be adapted to each system accordingly however the concept and the steps that should be followed remains the same as the presented case study section 3 5 3 response time uncertainties in the studied case the process is simulated 10 000 times section 4 2 in each run response times of detection diagnosis decision making and execution are randomly selected from response time distribution models then the probability of each event is calculated accordingly the results of every run are collected and a distribution of the results are presented in all graphs in the result section using this method response time uncertainties in decision making process is considered in the risk evaluation process 5 4 decision support tool the end states probabilities as a function of time are presented for all runs figs 25 27 from the results it can be seen that probability has an upper bound that could be reached in an adequate time span this approached value as a function of time could assist decision making process so that it could play a function for a similar situation for example the average required response time to reach maximum risk level could be derived for a different incident this value is a critical information for operator s in emergencies to make an optimal decision such as recovery actions or shut down scenarios not only the average response time but also the maximum response time is an important metric for making decision those could be derived from the presented graphs these are some examples of novel insights derived from the proposed model compared to the state of the art risk assessment studies as we have considered dynamic probabilistic dependencies in general the results of the model end state probabilities could provide inputs to a decision support tool a decision support tool assists operator s in making better and or faster decisions in a decision support tool powerful predication capabilities are utilized that help operators improve the way they approach available information and assist them to have a better understanding about system behavior the proposed dynamic risk assessment model in this paper could provide information about failure probabilities as a function of time for multiple decision scenarios this information can be used in decision support tools and improves their prediction capabilities significantly 5 5 future work one of the main paths for future research is the potential in developing the current methodology from an analysis tool into an online decision support tool dynamic probabilistic risk assessment delivers a better risk picture and allow for making decisions according to the needs going from a re active emergency management to a pro active approach where decision scenarios could be analyzed and anticipated based on real time information one possibility would be to simulate all alternative decision scenarios and provide an approximate time scale and risk level of each scenario another option would be to allow the operator s to be informed about the event and sequence probabilities in the near future knowing this information could help operator s to readjust system configuration with improved knowledge about the system 6 conclusion in this study a dynamic probabilistic risk assessment method for the decision making process in emergencies is proposed the framework is able to model the interactions between complex system operation and the decision making process in a very short execution time the predicted risk level is probabilistic and is updated over time by getting more information about system and human operations the complexity associated with system and human models and their interactions is considered by the event flow diagram concept introduced in this study in this concept all events in a decision scenario have probabilities that are functions of the time allocated response time these functions are calculated based on the nature of the events the concept considers system uncertainties using the bayesian network method and data driven distributions finally the monte carlo method is utilized to model stochastic behavior of the system and human responses a case study is performed on a dynamic positioning mobile offshore drilling unit and results show that the proposed framework is able to evaluate the risk level of a decision scenario for an incident a sensitivity analysis on the time available for decision making and incident complexity are performed and promising results have been reported not only with regards to risk assessment of decision scenarios but also with regards to the computational cost less than 1 s per run the interconnections between human and technical factors are modeled using the dpra method and more accurate risk levels of decision scenarios are achieved credit authorship contribution statement tarannom parhizkar conceptualization methodology data curation formal analysis modeling validation writing original draft ingrid bouwer utne methodology writing review editing supervision jan erik vinnem methodology writing review editing supervision ali mosleh conceptualization methodology supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20326,in this paper the hydrodynamic performance of cycloidal propeller with flap at the trailing edge are investigated by cfd computational fluid dynamics method without losing the generality the study is based on three blade cycloidal propeller the cfd model is first validated against experimental result in the literature on this basis the influence of flap on the hydrodynamics is investigated by enforcing three different flap motion patterns which are anti virtual camber motion sinusoidal motion and anti virtual camber plus sinusoidal motion the simulation results show that the anti virtual camber and sinusoidal motions are effective to reduce the side thrust and increase the efficiency at high advance coefficient respectively and these two effects can be achieved at the same time by the linear superposition of these two types of motions the mechanisms of the flow with flaps and its influence on the hydrodynamic performance of the cycloidal propeller are analyzed keywords cycloidal propeller flap virtual camber side thrust efficiency wake vortex 1 introduction the cycloidal propeller also known as the vertical axis straight wing propeller consists of multiple blades as shown in fig 1 the blades are rectangular in shape and are usually installed vertically on the bottom of the ship when the blades revolve around the propeller axis they also rotate with respect to its own pitching center to adjust the angle of attack so that the blades generate thrust in the same direction when they are in different positions as shown in fig 2 by controlling the blade pitching angle during the circulating motion around the propeller axis the direction and magnitude of thrust can be easily adjusted in any direction in the plane perpendicular to the propeller axis without a separate rudder the excellent maneuverability of the cycloidal propeller make it possess the characteristics of a controllable pitch propeller cpp therefore it is suitable for ships that require high maneuverability such as tug ferries luxury yachts minesweepers floating crane platform supply vessel psv jürgens et al 2007 etc it can also be used as a special type of turbine which can be used for water conservancy tides tidal currents and inland river power generation huangsheng 2007 cycloidal propellers began to be used in the 1920s the most typical ones are the kirsten boeing propeller in the united states and the voith schneider propeller in germany compared with the application of cycloidal propeller its theoretical and experimental research was carried out relatively late in the 1950s isay 1956 proposed the dual potential flow theory haberman haberman and caster 1962 compiled the method proposed by isay into machine language for calculation but the calculation result still cannot accurately predict the performance of the cycloidal propeller in the 1960s taniguchi 1962 proposed a quasi steady flow model which was consistent with the experimental results under a moderate advancement coefficient 0 4 0 5 but the theoretical and experimental deviations were large under a large eccentricity haberman haberman and harley 1961 uses the method proposed by taniguchi to calculate the hydrodynamic performance of the cycloidal propeller the calculated results are compared with the 2 3 and 6 blade propeller experiments done by the dtmb david taylor model basin laboratory and the calculated values are consistent with the experimental values on the other hand a series of experimental studies were conducted by nakonechny 1961 nakonechny 1961 manen 1966 van manen 1966 ficken and dickerson 1969 ficken and dickerson 1969 dickerson and dobay 1975 dickerson and dobay 1970 bose and lai 1989 bose and lai 1989 li 1991 li 1991 veitch 1992 veitch 1992 etc it is worth mentioning that the experiment conducted by ficken and dickerson 1969 provides a detailed parameterization study on the cycloidal propeller including eccentricity advance coefficient number of blades etc which is consequently being widely used as reference for numerical model validation zhu 1982 chen 2013 yang 2017 zhang et al 2017 with the rapid development of computational technology cfd technology has been widely used for flow simulation with complicated conditions many scholars use the cfd method to simulate the performance of cycloidal rotors and hydro turbine for example kim kim et al 2003 used the cfd and experimental methods to study the influence of rotational speed eccentric phase angle eccentric amplitude rotor radius and number of blades on the thrust of the cycloidal rotor in the hovering state the results show that the thrust and the required power are squared and cubed of the rotational speed respectively hu hu et al 2019 used the cfd method to study the effect of blade aspect ratio and taper ratio on the hovering performance of cycloidal rotor the results show that the hovering efficiency of the cycloidal rotor increases slightly with the increase of the aspect ratio and decreases with the decrease of the taper ratio bakhtiari bakhtiari and ghassemi 2020 et al used the cfd method to simulate the cycloidal propeller with different parameters the results show that the maximum efficiency increases with the increase of the pitch and decreases with the increase of the blade thickness and the number of blades the simulation results have also been used to train the neural network and the obtained mathematical model can efficiently predict the hydrodynamic performance the cfd method provides a powerful tool for the hydrodynamic performance optimization hwang hwang et al 2009 et al used the cfd method to optimize the individual blade motion pattern and achieve the performance increase by about 25 zhao zhao et al 2013 et al used experiments and cfd methods to study the influence of the blade s predetermined angle of attack on the cycloidal hydro turbine which ends up with the conclusion that the positive predetermined angle of attack can help improve the hydrodynamic performance as an effective way to alter the local flow feature of the individual blade using flaps at the trailing edge can be very helpful in terms of hydrodynamic performance improvement for example liu liu et al 2019 used the cfd method to study the influence of trailing edge flaps on the aerodynamic performance and noise characteristics of vertical axis wind turbines the results show that the trailing edge flap helps to increase the power coefficient of the wind turbine at high tip speed ratio tsr bianchini bianchini et al 2019 et al used the cfd method to study the influence of gurney flaps on the aerodynamic performance of wind turbines the results of the study showed that gurney flaps can help improve the aerodynamic performance of wind turbines as a typical undesirable hydrodynamic feature the side thrust which is perpendicular to the main thrust direction causes inconvenience for the maneuverability control system design of ships how to eliminate the unwanted side thrust while still maintain or even improve the hydrodynamic efficiency would be an important and useful topic for the design and application of cycloidal propellers as pointed out by halder 2018 halder et al 2018 the so called virtual camber effect has a great influence on the side thrust this paper tries to use flaps at the trailing edge of blades to counteract the virtual camber effect and further improve the hydrodynamic efficiency the remaining part of the paper is organized as follows in section 2 the basic principles of the cycloidal propeller are introduced including the hydrodynamic performance of the cycloidal propeller and the virtual camber effect of the blades in section 3 the research methods used in this article are introduced and compared with experimental results in section 4 the effects of different flap rotation patterns on the main thrust coefficient side thrust coefficient and efficiency are studied in section 5 the main findings and future research plan are discussed 2 hydrodynamics of cycloidal propeller 2 1 basic principles of cycloidal propeller fig 3 shows the movement characteristics of a single blade of the cycloidal propeller the blade motion can be decomposed into two parts first the blade makes a circular motion around the point o and the rotational angular velocity is ω secondly the blade makes a pitch motion around its own rotation center o the blade pitch motion is designed to make sure that the straight line passing o is always perpendicular to the chord line intersects at a point n as shown in fig 3 the intersection point n is called the eccentric point the main thrust direction of the cycloidal propeller is always perpendicular to on the magnitude and direction of the thrust of the cycloidal propeller can be controlled by changing the position of the eccentric point n the ratio of on and the radius r of the cycloidal propeller is called the eccentricity e θ is the rotation angle of the blade the angle β between the chord line and the tangent to the trajectory circle is called the pitch angle of the blade and β is the rotation rate of the blade around the center of rotation the definitions of e β β and ω are given in eqns 1 4 the blade pitch angle β and its time derivative β for a complete circle are shown in fig 4 the hydrodynamic performance of the cycloidal propeller can be described by the following parameters in eqns 5 9 ρ is the density of the medium v a is the velocity of advance m s n is the propeller rotation speed rps d is the rotation diameter m l is the blade length m j is the advance coefficient k t k s k q are the main thrust coefficient side thrust coefficient and torque coefficient respectively t s q are the main thrust side thrust and torque respectively η is the hydrodynamic efficiency 5 j v a n d 6 k t t ρ n 2 d 3 l 7 k s s ρ n 2 d 3 l 8 k q q ρ n 2 d 4 l 9 η j 2 π k t k q 2 2 dynamic virtual camber for cycloidal propeller the blade motion consists of overall circular motion around point o and local pitch motion around point o as shown in fig 3 therefore the combination effect of uniform incoming flow and the blade motion makes the equivalent angle of attack for each position along the blade is different which is shown in fig 5 this variation of the angle of attack will produce the so called virtual camber effects yun et al 2004 the equivalent angle of attack along the blade chord can be calculated as follows fig 6 shows the blade velocity component the black solid line represents the blade position v i is the incoming flow velocity γ is the angle between the incoming flow velocity and the vertical axis x represents the distance between the point on the blade chord line and the blade rotation center r is the propeller radius and r is the orbital radius at the point x from the rotation center of the blade ω r represents the tangential velocity from the point x distance from the rotation center on the chord line v r e s represents the resultant velocity of the point at the position x from the rotation center α x represents the actual point angle of attack halder halder et al 2018 gave the distribution of the equivalent angle of attack α x at different x positions along the chord length 10 α x x tan 1 x ω β v i cos γ β ω r sin β ω r cos β v i sin γ β fig 7 shows the actual chord line and the virtual chord line of the cycloidal propeller at different azimuths it can be seen that when the azimuth angle is 0 the virtual camber effect is not significant whereas the virtual camber significantly deviates from the accrual chord for 180 azimuth angle for the case shown in fig 7 in the left half circle the virtual camber reduces the effective angle of attack whereas the effect is just the opposite in the right half circle kim et al 2003 this indicates that the propeller performance can be adjusted by dynamically changing the blade pitch motion which is further discussed in next section 2 3 effect of flap and its geometry the existence of virtual camber will alter the otherwise symmetrically distributed hydrodynamic force with respect to main thrust direction which will end up with a net side thrust kan 2010 theoretically this uneven hydrodynamic distribution along the blade as mentioned in section 2 2 can be adjusted dynamically by changing the pitching pattern of the blade during the circular motion a proper dynamic blade pitching motion can potentially eliminate the undesirable side thrust and even further improve the performance such as hydrodynamic efficiency it can be found in fig 7 that the virtual camber effect mainly affects the chord line towards the trailing edge side therefore a simple but effective way to adjust the local pitch angle would be adding flaps on the trailing edge as intuitively illustrated in fig 8 the flap will alter the equivalent angle of attack around the trailing edge area and to a large extent recover the hydrodynamic distribution status corresponding to the original physical chord i e the altered virtual camber blue line has been shifted towards the physical chord line black line as shown in fig 9 the angle formed by the physical chord line and the line from blade pitch center to the end of the virtual camber is used as a quantitive measure of the magnitude of the virtual camber in this study this angle σ is defined as eqn 11 the effect of three different flap motion patterns are investigated in this paper i e a anti virtual camber pattern the side thrust is due to the virtual camber effect the force generated perpendicular to the forward direction during the rotation of the blade cannot cancel each other out by enforcing motion pattern that can offset the virtual camber effect the unwanted side thrust is intended to be eliminated b sinusoidal motion fig 7 shows that the virtual camber and in left half circle reduces the effective angle of attack and the virtual camber in right half circle increases the effective angle of attack therefore in order to increase the angle of attack at different azimuths in left half circle the flap should rotate to the other side of the virtual camber and in right half circle the flap should rotate to the same side of the virtual camber as a result the overall thrust of the propeller is expected to be increased by enforcing a sinusoidal motion on the flap during the circular motion c superposition of anti virtual camber and sinusoidal motion based on the results of the two patterns in a and b the superposition of them is tested with the aim of achieving both goals simutanuesly as shown in fig 10 as for the shape of the airfoil naca0012 is selected as the base shape the tail part of naca0012 is chosen as the flap the parameters that defines the shape is given in table 1 where c is the chord length of the blade l is the length of the main wing w is the length of the flap d is the width of the wing slit w c is the relative length of the flap and d c is the relative width of the wing slit for the length of the flap some studies zu et al 2015 imply that the increase of flap would reduce the lift drag ratio the performance is expected to be affected by the flap length and amplitude of the motion in this paper the major concern is whether flap motion patterns mentioned above that can achieve the desired purposes the influence of relative length and motion amplitude would need further detailed investigations which is planned in the near future 3 cfd model and validation 3 1 cfd model in this paper the cfd method is used to investigate the hydrodynamics of the cycloidal propeller with flaps the cfd simulation is conducted by star ccm software the time averaged navier stokes equations as provided in eq 12 is used as governing equations for the flow 12 t ρ u i x j ρ u i u j p x i x j μ u i x j ρ u i u j s i where ρ is fluid density u is velocity p is pressure μ is fluid viscosity s is the external force per unit volume of fluid and ρ u i u j is reynolds stress according to the eddy viscosity assumption proposed by boussinesq 1877 the relationship between the reynolds stress and the average velocity gradient is established as in eqn 13 13 ρ u i u j μ t u i x j u j x i 2 3 ρ k μ t u i x i δ i j where μ t is the turbulent viscosity u i is the time average velocity and k is the turbulent kinetic energy the s s t k ω turbulence model is used to simulate the turbulent viscosity 14 μ t ρ k min a ω a 1 s f 2 15 f 2 tanh max 2 k β ω d 500 ν d 2 ω 2 the transmission equations of turbulent kinetic energy k and unit dissipation rate ω are as follows 16 t ρ k x i ρ k u i x j μ σ k μ t k x j p k ρ β f β ω k ω 0 k 0 s k 17 t ρ ω x j ρ ω u j x j μ σ ω μ t ω x j p ω ρ β f β ω 2 ω 0 2 s ω where σ k and σ ω are model coefficients p k and p ω are production terms f β is the free shear modification factor f β is the vortex stretching modification factor s k and s ω are the user specified source terms k 0 and ω 0 are the ambient turbulence values that counteract turbulence decay 18 σ k f 1 σ k 1 1 f 1 σ k 2 19 σ ω f 1 σ ω 1 1 f 1 σ ω 2 where σ k 1 0 85 σ k 2 1 σ ω 1 0 5 σ ω 2 0 856 3 2 model validation 3 2 1 validation against experiment in order to check the accuracy of the cfd model the experiment conducted by n l ficken and m c dickerson ficken and dickerson 1969 is first numerically reproduced the airfoil with the middle d section was selected for this 2d simulation whose shape is shown in fig 11 the parameters of the airfoil is given in table 2 the main thrust coefficient torque coefficient and efficiency of the three blade cycloidal propeller at different advancement coefficient j 0 2 25 with eccentricity e 0 7 are calculated fig 12 shows the boundary conditions and meshing of the computational domain the domain size is set to 5d from the cycloidal propeller on the left 10d from the cycloidal propeller on the right and 5d from both the upper and lower sides the left side is set as the velocity inlet the right side is set as the pressure outlet and the upper and lower sides are symmetry planes the overlapping grid technology is used to simulate the complex motion of the blade the s s t k ω turbulence model is used and the blade boundary layer is refined to make the first layer yplus value 1 the accuracy of numerical simulation is dependent on the way of meshing in order to check the mesh convergence property three sets of meshes are tested in this paper the mesh parameters are shown in table 3 the eccentricity and advance coefficient are chosen as e 0 7 and j 1 0 respectively as shown in fig 13 the values of k t and k q show no significant difference between different meshes which shows good convergence property of the adopted meshing structure in order to achieve the balance between efficiency and accuracy the medium mesh is selected for the following example as for the time step in this paper based on the size of the adopted mesh and the principle of cfl courant friedrichs lewy number 1 the time step is selected as t 0 001s fig 14 shows that the thrust coefficient torque coefficient and efficiency of the cycloidal propeller are in good agreement with the experimental values for a large scope of advance coefficient used here which confirms the good accuracy of the mesh used in this paper 3 2 2 comparison between cases with and without flaps it can be seen from fig 10 that there is a wing slit d between the flap and the main wing in order to accurately evaluate the effect of flap motion on the hydrodynamic performance of the propeller it is necessary to estimate the effect by the wing slit itself on the hydrodynamic performance the specific parameters are shown in table 1 in section 2 3 fig 15 shows the meshing for this case the comparison between adding flaps without turning the flaps and no flaps cases are shown in fig 16 it is clear that except for the peak the thrust coefficient k t and torque coefficient k q of the blade with wing slit and the blade without flap match each other well although the peak and trough k t value is affected by adding the flaps 1 42 and 14 02 the average value of k t and k q which is more important for evaluating the overall hydrodynamic performance of the cycloidal propeller are hardly affected as shown in table 4 this is helpful to confirm that the hydrodynamic difference discussed in section 4 is not caused by the slit itself but the motion of the flap 4 results and discussion 4 1 the results for flaps rotate with anti virtual camber pattern in this section the anti virtual camber flap motion is tested to see whether it can offset the undesired side thrust as mentioned in section 2 3 the flap geometry and its motion amplitude will certainly affect the hydrodynamics which will form another separate study in this paper the value of σ 2 σ is defined in eqn 11 is adopted for the flap rotation as a typical anti virtual camber motion amplitude fig 17 shows the flap rotation angles at different azimuth angles under different advance coefficients when the eccentricity e 0 4 it can be seen from fig 17 a that as the advance coefficient increases the virtual camber effect and consequently the flap rotation angle is becoming larger this implies that the effect might be more significant under large advance coefficient which is further discussed below fig 18 shows the flap pitching angle at different azimuth angles as shown in fig 19 the flap motion can hardly affect kt kq and η but the side thrust coefficient ks is significantly reduced for the whole range of advance coefficients studied here more specifically for the cases without flaps the absolute value of the side thrust coefficient gradually increases with the increase of the advance coefficient and reaches its peak ks 0 455 at j 1 2 for the cases with anti virtual camber flap motions the side thrust coefficient can be very effectively reduced the side thrust is even completed eliminated at j 1 on average the reduction rate is about 75 89 absolute value for relatively larger advance coefficients this offset effect tends to be weakened which is expected to be related to the flap length and motion amplitude the optimal flap geometry and motion pattern will be further studied in the future study nevertheless the concept that using flap with anti virtual camber motion can indeed offset the undesired side thrust fig 20 shows the main and side thrusts of a single blade in two successive circles of rotating which clearly shows the periodicity of the hydrodynamic force in terms of the main thrust the flap reduces both the peak and though values without affecting the mean value as shown in fig 20 a for the side thrust both the fluctuation i e peak and though and the mean value are significantly reduced by the flap the mean value of the side thrust for the cases without flaps is 45 5665n while the result of the cases with flaps is 0 56n which means the reduction rate is about 98 absolute value the using of flap can greatly reduce the force fluctuation and therefore improve the steadiness of the thrust the flow mechanism behind this offset effect by flaps is discussed as follows fig 21 shows the vortex field of the cycloidal propeller under j 1 0 conditions where positive vortex intensity represents anticlockwise circulation and negative value means the opposite hu et al 2020 compared with the cases without flap fig 21 a and c the most distinguishable feature caused by flaps fig 21 b and d is the more symmetric distribution of the vorticity field with respect to incoming flow direction the side thrust of the no flap case is pointing towards 180 azimuth direction i e downward which is just opposite to the unsymmetrical vorticity field distribution this implies that the clear correlation between vorticity field shape and side thrust more specifically under j 0 8 i e fig 21 a and b the angles of upper and lower envelope lines of the vorticity field with respect to the incoming flow direction for cases with flap are 3 and 2 respectively whereas the no flap cases are 5 and 3 for the case with j 1 0 fig 21 c and d where the side thrust is completely offset the symmetry of the vorticity field is more clear i e the upper and lower angles are 2 and 2 respectively 4 2 the results for flaps rotate with sinusoidal motion in this section the flap motion patterns that can improve the hydrodynamic efficiency is studied as discussed in section 2 3 for the specific settings in fig 7 the virtual camber will reduce and increase the effective angle of attack in left and right half circle respectively therefore the sinusoidal type flap motion can be used to counteract and enhance the virtual camber effect in the left and right half circles respectively that is in left half circle the flap rotates clockwise around the flap rotation center i e anti virtual camber motion in right half circle the flap rotates anticlockwise around the flap rotation center i e enhancing the virtual camber effect as for the amplitude of the flap motion a typical value of 5 is chosen and the detailed investigations of the optimal value is not the major concern in this study fig 22 a shows the flap pitching angle within a full circular motion period fig 23 shows the flap pitching angle at different azimuth angles fig 24 shows the comparison of the kt kq ks and η with and without flaps it is clear that both the main thrust and torque increase under the flap pitching with sinusoidal type motion for the hydrodynamic efficiency when the advance coefficient j 0 8 compared with the rotation without flaps the efficiency shows very little difference for the cases with sinusoidally rotating flaps which means the growth rate of thrust and torque is basically the same for larger advance coefficient i e j 0 8 the efficiency for cases with sinusoidally rotating flaps is significantly higher than that of no flap cases for the advance coefficient j 1 0 and 1 2 the efficiencies are increased by 3 86 and 50 respectively for the side thrust coefficient the flap has opposite effects under small and large advance coefficients i e for the range of 0 j 0 5 absolute value of ks is larger for cases with sinusoidally rotating flaps whereas for 0 5 j 1 2 ks is reduced by the flap motion with the maximum reduction rate of 14 3 at j 1 2 fig 25 shows the forces on a single blade in two successive circles of rotation with and without flaps compared with the cases without flaps the main effect of flap is the reduction of the negative value in the main thrust direction it is reduced by 33 absolute value at an azimuth of 90 this helps the increase of the average main thrust by 133 6 the side thrust is almost not affected by the sinusoidal flap motions fig 26 shows the comparison of vorticity field with and without the effect of flaps from the comparison of fig 26 a and b in a full circle as the flaps rotate according to the law of sinusoidal higher intensity vortexes are generated at the tail of the blades the vortex generated in left half circle has a positive effect on the flow field in right half circle 4 3 the results for flaps rotate with linear superposition of anti virtual camber and sinusoidal motion in the previous sections the side thrust eliminating i e the anti virtual camber motion and efficiency improving i e the sinusoidal motion types of flap motions have been tested it has been confirmed that they can achieve the corresponding goals in this section the combination of these two types of motions are tried to see if their hydrodynamic effects i e reducing side thrust and improving efficiency can be achieved simutanuesly the flap pitching pattern is the direct superposition of the motions in section 4 1 and 4 2 which are shown in fig 27 for different advance coefficients as shown in fig 28 the superposition of two types of motions indeed achieve the expected combined effect i e the absolute value of the side thrust is considerably reduced after j 0 2 and the hydrodynamic efficiency starts to increase after j 0 6 the maximum side thrust reduction rate and efficiency increase rate are 88 89 and 43 47 j 1 2 respectively the forces of a single blade in two successive circles are shown in fig 29 the main features of the forces are very similar to the results with anti virtual camber moving flaps in fig 20 which indicates the dominant effect comes from anti virtual camber motion compared with no flap cases the mean values of main thrust increase rate and side thrust reduction rate are 116 35 and 91 38 respectively absolute value fig 30 shows the vorticity field comparison with and without flaps similarly to the cases in section 4 2 the rotating flaps produce higher intensity vortex at the same time the symmetry of the vorticity field with respect to the incoming flow direction is also altered by the flaps motion i e the angles of upper and lower envelope lines of the vorticity field with respect to the incoming flow direction for cases with flap are 2 and 3 whereas the no flap cases are 5 and 2 unlike the case shown in fig 21 the vorticity field with flap is not perfect symmetrical which is due to the fact that the side thrust is not completely offset in this case i e the ks is about 0 05 for j 1 2 as shown in fig 28 this again shows the correlation between the shape of the vorticity field and its thrust directions 5 conclusion in this paper the concept of improving the hydrodynamic performance of the cycloidal propeller by adding flaps at the trailing edge of the blade is investigated three different types of flap motions i e the anti virtual camber sinusoidal and their linear superposition are tested the main findings of this study are as follows 1 when the flaps rotate according to the law of anti virtual camber the side thrust coefficient can be significantly reduced for the whole range of advance coefficients the maximum reduction rate can be up to 99 87 for the tested cases 2 when the flaps rotate according to the sinusoidal law both the main thrust coefficient and torque coefficient are considerably increased for the whole range of advance coefficients however the efficiency is only increased under relatively high advance coefficients the maximum efficiency increase can reach 50 23 for j 1 2 in this study 3 when the flaps rotate according to the linear superposition of anti virtual camber and sinusoidal law the side thrust eliminating and efficiency improving goals can be achieved simutanuesly the efficiency improvement is also only for large advance coefficients but the side thrust reduction is valid for the whole range of advance coefficients the above mentioned results are based on the typical flap length and motion amplitude a comprehensive research about the influence of the flap length and the rotation angle amplitude will be conducted in the future credit authorship contribution statement zhe sun conceptualization methodology investigation supervision writing original draft funding acquisition heng li data curation investigation validation writing original draft software visualization zhen hui liu writing review editing wen quan wang funding acquisition gui yong zhang project administration funding acquisition zhi zong funding acquisition yi chen jiang funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by the national natural science foundation of china no 51809035 52061135107 51639003 national key research and development program of china 2019yfc0312400 open project of state key laboratory of deep sea mineral resources development and utilization technology grant no sh 2020 kf a01 liao ning revitalization talents program no xlyc1908027 fundamental research funds for the central universities no dut20td108 dut20lab308 to which the authors are most grateful 
20326,in this paper the hydrodynamic performance of cycloidal propeller with flap at the trailing edge are investigated by cfd computational fluid dynamics method without losing the generality the study is based on three blade cycloidal propeller the cfd model is first validated against experimental result in the literature on this basis the influence of flap on the hydrodynamics is investigated by enforcing three different flap motion patterns which are anti virtual camber motion sinusoidal motion and anti virtual camber plus sinusoidal motion the simulation results show that the anti virtual camber and sinusoidal motions are effective to reduce the side thrust and increase the efficiency at high advance coefficient respectively and these two effects can be achieved at the same time by the linear superposition of these two types of motions the mechanisms of the flow with flaps and its influence on the hydrodynamic performance of the cycloidal propeller are analyzed keywords cycloidal propeller flap virtual camber side thrust efficiency wake vortex 1 introduction the cycloidal propeller also known as the vertical axis straight wing propeller consists of multiple blades as shown in fig 1 the blades are rectangular in shape and are usually installed vertically on the bottom of the ship when the blades revolve around the propeller axis they also rotate with respect to its own pitching center to adjust the angle of attack so that the blades generate thrust in the same direction when they are in different positions as shown in fig 2 by controlling the blade pitching angle during the circulating motion around the propeller axis the direction and magnitude of thrust can be easily adjusted in any direction in the plane perpendicular to the propeller axis without a separate rudder the excellent maneuverability of the cycloidal propeller make it possess the characteristics of a controllable pitch propeller cpp therefore it is suitable for ships that require high maneuverability such as tug ferries luxury yachts minesweepers floating crane platform supply vessel psv jürgens et al 2007 etc it can also be used as a special type of turbine which can be used for water conservancy tides tidal currents and inland river power generation huangsheng 2007 cycloidal propellers began to be used in the 1920s the most typical ones are the kirsten boeing propeller in the united states and the voith schneider propeller in germany compared with the application of cycloidal propeller its theoretical and experimental research was carried out relatively late in the 1950s isay 1956 proposed the dual potential flow theory haberman haberman and caster 1962 compiled the method proposed by isay into machine language for calculation but the calculation result still cannot accurately predict the performance of the cycloidal propeller in the 1960s taniguchi 1962 proposed a quasi steady flow model which was consistent with the experimental results under a moderate advancement coefficient 0 4 0 5 but the theoretical and experimental deviations were large under a large eccentricity haberman haberman and harley 1961 uses the method proposed by taniguchi to calculate the hydrodynamic performance of the cycloidal propeller the calculated results are compared with the 2 3 and 6 blade propeller experiments done by the dtmb david taylor model basin laboratory and the calculated values are consistent with the experimental values on the other hand a series of experimental studies were conducted by nakonechny 1961 nakonechny 1961 manen 1966 van manen 1966 ficken and dickerson 1969 ficken and dickerson 1969 dickerson and dobay 1975 dickerson and dobay 1970 bose and lai 1989 bose and lai 1989 li 1991 li 1991 veitch 1992 veitch 1992 etc it is worth mentioning that the experiment conducted by ficken and dickerson 1969 provides a detailed parameterization study on the cycloidal propeller including eccentricity advance coefficient number of blades etc which is consequently being widely used as reference for numerical model validation zhu 1982 chen 2013 yang 2017 zhang et al 2017 with the rapid development of computational technology cfd technology has been widely used for flow simulation with complicated conditions many scholars use the cfd method to simulate the performance of cycloidal rotors and hydro turbine for example kim kim et al 2003 used the cfd and experimental methods to study the influence of rotational speed eccentric phase angle eccentric amplitude rotor radius and number of blades on the thrust of the cycloidal rotor in the hovering state the results show that the thrust and the required power are squared and cubed of the rotational speed respectively hu hu et al 2019 used the cfd method to study the effect of blade aspect ratio and taper ratio on the hovering performance of cycloidal rotor the results show that the hovering efficiency of the cycloidal rotor increases slightly with the increase of the aspect ratio and decreases with the decrease of the taper ratio bakhtiari bakhtiari and ghassemi 2020 et al used the cfd method to simulate the cycloidal propeller with different parameters the results show that the maximum efficiency increases with the increase of the pitch and decreases with the increase of the blade thickness and the number of blades the simulation results have also been used to train the neural network and the obtained mathematical model can efficiently predict the hydrodynamic performance the cfd method provides a powerful tool for the hydrodynamic performance optimization hwang hwang et al 2009 et al used the cfd method to optimize the individual blade motion pattern and achieve the performance increase by about 25 zhao zhao et al 2013 et al used experiments and cfd methods to study the influence of the blade s predetermined angle of attack on the cycloidal hydro turbine which ends up with the conclusion that the positive predetermined angle of attack can help improve the hydrodynamic performance as an effective way to alter the local flow feature of the individual blade using flaps at the trailing edge can be very helpful in terms of hydrodynamic performance improvement for example liu liu et al 2019 used the cfd method to study the influence of trailing edge flaps on the aerodynamic performance and noise characteristics of vertical axis wind turbines the results show that the trailing edge flap helps to increase the power coefficient of the wind turbine at high tip speed ratio tsr bianchini bianchini et al 2019 et al used the cfd method to study the influence of gurney flaps on the aerodynamic performance of wind turbines the results of the study showed that gurney flaps can help improve the aerodynamic performance of wind turbines as a typical undesirable hydrodynamic feature the side thrust which is perpendicular to the main thrust direction causes inconvenience for the maneuverability control system design of ships how to eliminate the unwanted side thrust while still maintain or even improve the hydrodynamic efficiency would be an important and useful topic for the design and application of cycloidal propellers as pointed out by halder 2018 halder et al 2018 the so called virtual camber effect has a great influence on the side thrust this paper tries to use flaps at the trailing edge of blades to counteract the virtual camber effect and further improve the hydrodynamic efficiency the remaining part of the paper is organized as follows in section 2 the basic principles of the cycloidal propeller are introduced including the hydrodynamic performance of the cycloidal propeller and the virtual camber effect of the blades in section 3 the research methods used in this article are introduced and compared with experimental results in section 4 the effects of different flap rotation patterns on the main thrust coefficient side thrust coefficient and efficiency are studied in section 5 the main findings and future research plan are discussed 2 hydrodynamics of cycloidal propeller 2 1 basic principles of cycloidal propeller fig 3 shows the movement characteristics of a single blade of the cycloidal propeller the blade motion can be decomposed into two parts first the blade makes a circular motion around the point o and the rotational angular velocity is ω secondly the blade makes a pitch motion around its own rotation center o the blade pitch motion is designed to make sure that the straight line passing o is always perpendicular to the chord line intersects at a point n as shown in fig 3 the intersection point n is called the eccentric point the main thrust direction of the cycloidal propeller is always perpendicular to on the magnitude and direction of the thrust of the cycloidal propeller can be controlled by changing the position of the eccentric point n the ratio of on and the radius r of the cycloidal propeller is called the eccentricity e θ is the rotation angle of the blade the angle β between the chord line and the tangent to the trajectory circle is called the pitch angle of the blade and β is the rotation rate of the blade around the center of rotation the definitions of e β β and ω are given in eqns 1 4 the blade pitch angle β and its time derivative β for a complete circle are shown in fig 4 the hydrodynamic performance of the cycloidal propeller can be described by the following parameters in eqns 5 9 ρ is the density of the medium v a is the velocity of advance m s n is the propeller rotation speed rps d is the rotation diameter m l is the blade length m j is the advance coefficient k t k s k q are the main thrust coefficient side thrust coefficient and torque coefficient respectively t s q are the main thrust side thrust and torque respectively η is the hydrodynamic efficiency 5 j v a n d 6 k t t ρ n 2 d 3 l 7 k s s ρ n 2 d 3 l 8 k q q ρ n 2 d 4 l 9 η j 2 π k t k q 2 2 dynamic virtual camber for cycloidal propeller the blade motion consists of overall circular motion around point o and local pitch motion around point o as shown in fig 3 therefore the combination effect of uniform incoming flow and the blade motion makes the equivalent angle of attack for each position along the blade is different which is shown in fig 5 this variation of the angle of attack will produce the so called virtual camber effects yun et al 2004 the equivalent angle of attack along the blade chord can be calculated as follows fig 6 shows the blade velocity component the black solid line represents the blade position v i is the incoming flow velocity γ is the angle between the incoming flow velocity and the vertical axis x represents the distance between the point on the blade chord line and the blade rotation center r is the propeller radius and r is the orbital radius at the point x from the rotation center of the blade ω r represents the tangential velocity from the point x distance from the rotation center on the chord line v r e s represents the resultant velocity of the point at the position x from the rotation center α x represents the actual point angle of attack halder halder et al 2018 gave the distribution of the equivalent angle of attack α x at different x positions along the chord length 10 α x x tan 1 x ω β v i cos γ β ω r sin β ω r cos β v i sin γ β fig 7 shows the actual chord line and the virtual chord line of the cycloidal propeller at different azimuths it can be seen that when the azimuth angle is 0 the virtual camber effect is not significant whereas the virtual camber significantly deviates from the accrual chord for 180 azimuth angle for the case shown in fig 7 in the left half circle the virtual camber reduces the effective angle of attack whereas the effect is just the opposite in the right half circle kim et al 2003 this indicates that the propeller performance can be adjusted by dynamically changing the blade pitch motion which is further discussed in next section 2 3 effect of flap and its geometry the existence of virtual camber will alter the otherwise symmetrically distributed hydrodynamic force with respect to main thrust direction which will end up with a net side thrust kan 2010 theoretically this uneven hydrodynamic distribution along the blade as mentioned in section 2 2 can be adjusted dynamically by changing the pitching pattern of the blade during the circular motion a proper dynamic blade pitching motion can potentially eliminate the undesirable side thrust and even further improve the performance such as hydrodynamic efficiency it can be found in fig 7 that the virtual camber effect mainly affects the chord line towards the trailing edge side therefore a simple but effective way to adjust the local pitch angle would be adding flaps on the trailing edge as intuitively illustrated in fig 8 the flap will alter the equivalent angle of attack around the trailing edge area and to a large extent recover the hydrodynamic distribution status corresponding to the original physical chord i e the altered virtual camber blue line has been shifted towards the physical chord line black line as shown in fig 9 the angle formed by the physical chord line and the line from blade pitch center to the end of the virtual camber is used as a quantitive measure of the magnitude of the virtual camber in this study this angle σ is defined as eqn 11 the effect of three different flap motion patterns are investigated in this paper i e a anti virtual camber pattern the side thrust is due to the virtual camber effect the force generated perpendicular to the forward direction during the rotation of the blade cannot cancel each other out by enforcing motion pattern that can offset the virtual camber effect the unwanted side thrust is intended to be eliminated b sinusoidal motion fig 7 shows that the virtual camber and in left half circle reduces the effective angle of attack and the virtual camber in right half circle increases the effective angle of attack therefore in order to increase the angle of attack at different azimuths in left half circle the flap should rotate to the other side of the virtual camber and in right half circle the flap should rotate to the same side of the virtual camber as a result the overall thrust of the propeller is expected to be increased by enforcing a sinusoidal motion on the flap during the circular motion c superposition of anti virtual camber and sinusoidal motion based on the results of the two patterns in a and b the superposition of them is tested with the aim of achieving both goals simutanuesly as shown in fig 10 as for the shape of the airfoil naca0012 is selected as the base shape the tail part of naca0012 is chosen as the flap the parameters that defines the shape is given in table 1 where c is the chord length of the blade l is the length of the main wing w is the length of the flap d is the width of the wing slit w c is the relative length of the flap and d c is the relative width of the wing slit for the length of the flap some studies zu et al 2015 imply that the increase of flap would reduce the lift drag ratio the performance is expected to be affected by the flap length and amplitude of the motion in this paper the major concern is whether flap motion patterns mentioned above that can achieve the desired purposes the influence of relative length and motion amplitude would need further detailed investigations which is planned in the near future 3 cfd model and validation 3 1 cfd model in this paper the cfd method is used to investigate the hydrodynamics of the cycloidal propeller with flaps the cfd simulation is conducted by star ccm software the time averaged navier stokes equations as provided in eq 12 is used as governing equations for the flow 12 t ρ u i x j ρ u i u j p x i x j μ u i x j ρ u i u j s i where ρ is fluid density u is velocity p is pressure μ is fluid viscosity s is the external force per unit volume of fluid and ρ u i u j is reynolds stress according to the eddy viscosity assumption proposed by boussinesq 1877 the relationship between the reynolds stress and the average velocity gradient is established as in eqn 13 13 ρ u i u j μ t u i x j u j x i 2 3 ρ k μ t u i x i δ i j where μ t is the turbulent viscosity u i is the time average velocity and k is the turbulent kinetic energy the s s t k ω turbulence model is used to simulate the turbulent viscosity 14 μ t ρ k min a ω a 1 s f 2 15 f 2 tanh max 2 k β ω d 500 ν d 2 ω 2 the transmission equations of turbulent kinetic energy k and unit dissipation rate ω are as follows 16 t ρ k x i ρ k u i x j μ σ k μ t k x j p k ρ β f β ω k ω 0 k 0 s k 17 t ρ ω x j ρ ω u j x j μ σ ω μ t ω x j p ω ρ β f β ω 2 ω 0 2 s ω where σ k and σ ω are model coefficients p k and p ω are production terms f β is the free shear modification factor f β is the vortex stretching modification factor s k and s ω are the user specified source terms k 0 and ω 0 are the ambient turbulence values that counteract turbulence decay 18 σ k f 1 σ k 1 1 f 1 σ k 2 19 σ ω f 1 σ ω 1 1 f 1 σ ω 2 where σ k 1 0 85 σ k 2 1 σ ω 1 0 5 σ ω 2 0 856 3 2 model validation 3 2 1 validation against experiment in order to check the accuracy of the cfd model the experiment conducted by n l ficken and m c dickerson ficken and dickerson 1969 is first numerically reproduced the airfoil with the middle d section was selected for this 2d simulation whose shape is shown in fig 11 the parameters of the airfoil is given in table 2 the main thrust coefficient torque coefficient and efficiency of the three blade cycloidal propeller at different advancement coefficient j 0 2 25 with eccentricity e 0 7 are calculated fig 12 shows the boundary conditions and meshing of the computational domain the domain size is set to 5d from the cycloidal propeller on the left 10d from the cycloidal propeller on the right and 5d from both the upper and lower sides the left side is set as the velocity inlet the right side is set as the pressure outlet and the upper and lower sides are symmetry planes the overlapping grid technology is used to simulate the complex motion of the blade the s s t k ω turbulence model is used and the blade boundary layer is refined to make the first layer yplus value 1 the accuracy of numerical simulation is dependent on the way of meshing in order to check the mesh convergence property three sets of meshes are tested in this paper the mesh parameters are shown in table 3 the eccentricity and advance coefficient are chosen as e 0 7 and j 1 0 respectively as shown in fig 13 the values of k t and k q show no significant difference between different meshes which shows good convergence property of the adopted meshing structure in order to achieve the balance between efficiency and accuracy the medium mesh is selected for the following example as for the time step in this paper based on the size of the adopted mesh and the principle of cfl courant friedrichs lewy number 1 the time step is selected as t 0 001s fig 14 shows that the thrust coefficient torque coefficient and efficiency of the cycloidal propeller are in good agreement with the experimental values for a large scope of advance coefficient used here which confirms the good accuracy of the mesh used in this paper 3 2 2 comparison between cases with and without flaps it can be seen from fig 10 that there is a wing slit d between the flap and the main wing in order to accurately evaluate the effect of flap motion on the hydrodynamic performance of the propeller it is necessary to estimate the effect by the wing slit itself on the hydrodynamic performance the specific parameters are shown in table 1 in section 2 3 fig 15 shows the meshing for this case the comparison between adding flaps without turning the flaps and no flaps cases are shown in fig 16 it is clear that except for the peak the thrust coefficient k t and torque coefficient k q of the blade with wing slit and the blade without flap match each other well although the peak and trough k t value is affected by adding the flaps 1 42 and 14 02 the average value of k t and k q which is more important for evaluating the overall hydrodynamic performance of the cycloidal propeller are hardly affected as shown in table 4 this is helpful to confirm that the hydrodynamic difference discussed in section 4 is not caused by the slit itself but the motion of the flap 4 results and discussion 4 1 the results for flaps rotate with anti virtual camber pattern in this section the anti virtual camber flap motion is tested to see whether it can offset the undesired side thrust as mentioned in section 2 3 the flap geometry and its motion amplitude will certainly affect the hydrodynamics which will form another separate study in this paper the value of σ 2 σ is defined in eqn 11 is adopted for the flap rotation as a typical anti virtual camber motion amplitude fig 17 shows the flap rotation angles at different azimuth angles under different advance coefficients when the eccentricity e 0 4 it can be seen from fig 17 a that as the advance coefficient increases the virtual camber effect and consequently the flap rotation angle is becoming larger this implies that the effect might be more significant under large advance coefficient which is further discussed below fig 18 shows the flap pitching angle at different azimuth angles as shown in fig 19 the flap motion can hardly affect kt kq and η but the side thrust coefficient ks is significantly reduced for the whole range of advance coefficients studied here more specifically for the cases without flaps the absolute value of the side thrust coefficient gradually increases with the increase of the advance coefficient and reaches its peak ks 0 455 at j 1 2 for the cases with anti virtual camber flap motions the side thrust coefficient can be very effectively reduced the side thrust is even completed eliminated at j 1 on average the reduction rate is about 75 89 absolute value for relatively larger advance coefficients this offset effect tends to be weakened which is expected to be related to the flap length and motion amplitude the optimal flap geometry and motion pattern will be further studied in the future study nevertheless the concept that using flap with anti virtual camber motion can indeed offset the undesired side thrust fig 20 shows the main and side thrusts of a single blade in two successive circles of rotating which clearly shows the periodicity of the hydrodynamic force in terms of the main thrust the flap reduces both the peak and though values without affecting the mean value as shown in fig 20 a for the side thrust both the fluctuation i e peak and though and the mean value are significantly reduced by the flap the mean value of the side thrust for the cases without flaps is 45 5665n while the result of the cases with flaps is 0 56n which means the reduction rate is about 98 absolute value the using of flap can greatly reduce the force fluctuation and therefore improve the steadiness of the thrust the flow mechanism behind this offset effect by flaps is discussed as follows fig 21 shows the vortex field of the cycloidal propeller under j 1 0 conditions where positive vortex intensity represents anticlockwise circulation and negative value means the opposite hu et al 2020 compared with the cases without flap fig 21 a and c the most distinguishable feature caused by flaps fig 21 b and d is the more symmetric distribution of the vorticity field with respect to incoming flow direction the side thrust of the no flap case is pointing towards 180 azimuth direction i e downward which is just opposite to the unsymmetrical vorticity field distribution this implies that the clear correlation between vorticity field shape and side thrust more specifically under j 0 8 i e fig 21 a and b the angles of upper and lower envelope lines of the vorticity field with respect to the incoming flow direction for cases with flap are 3 and 2 respectively whereas the no flap cases are 5 and 3 for the case with j 1 0 fig 21 c and d where the side thrust is completely offset the symmetry of the vorticity field is more clear i e the upper and lower angles are 2 and 2 respectively 4 2 the results for flaps rotate with sinusoidal motion in this section the flap motion patterns that can improve the hydrodynamic efficiency is studied as discussed in section 2 3 for the specific settings in fig 7 the virtual camber will reduce and increase the effective angle of attack in left and right half circle respectively therefore the sinusoidal type flap motion can be used to counteract and enhance the virtual camber effect in the left and right half circles respectively that is in left half circle the flap rotates clockwise around the flap rotation center i e anti virtual camber motion in right half circle the flap rotates anticlockwise around the flap rotation center i e enhancing the virtual camber effect as for the amplitude of the flap motion a typical value of 5 is chosen and the detailed investigations of the optimal value is not the major concern in this study fig 22 a shows the flap pitching angle within a full circular motion period fig 23 shows the flap pitching angle at different azimuth angles fig 24 shows the comparison of the kt kq ks and η with and without flaps it is clear that both the main thrust and torque increase under the flap pitching with sinusoidal type motion for the hydrodynamic efficiency when the advance coefficient j 0 8 compared with the rotation without flaps the efficiency shows very little difference for the cases with sinusoidally rotating flaps which means the growth rate of thrust and torque is basically the same for larger advance coefficient i e j 0 8 the efficiency for cases with sinusoidally rotating flaps is significantly higher than that of no flap cases for the advance coefficient j 1 0 and 1 2 the efficiencies are increased by 3 86 and 50 respectively for the side thrust coefficient the flap has opposite effects under small and large advance coefficients i e for the range of 0 j 0 5 absolute value of ks is larger for cases with sinusoidally rotating flaps whereas for 0 5 j 1 2 ks is reduced by the flap motion with the maximum reduction rate of 14 3 at j 1 2 fig 25 shows the forces on a single blade in two successive circles of rotation with and without flaps compared with the cases without flaps the main effect of flap is the reduction of the negative value in the main thrust direction it is reduced by 33 absolute value at an azimuth of 90 this helps the increase of the average main thrust by 133 6 the side thrust is almost not affected by the sinusoidal flap motions fig 26 shows the comparison of vorticity field with and without the effect of flaps from the comparison of fig 26 a and b in a full circle as the flaps rotate according to the law of sinusoidal higher intensity vortexes are generated at the tail of the blades the vortex generated in left half circle has a positive effect on the flow field in right half circle 4 3 the results for flaps rotate with linear superposition of anti virtual camber and sinusoidal motion in the previous sections the side thrust eliminating i e the anti virtual camber motion and efficiency improving i e the sinusoidal motion types of flap motions have been tested it has been confirmed that they can achieve the corresponding goals in this section the combination of these two types of motions are tried to see if their hydrodynamic effects i e reducing side thrust and improving efficiency can be achieved simutanuesly the flap pitching pattern is the direct superposition of the motions in section 4 1 and 4 2 which are shown in fig 27 for different advance coefficients as shown in fig 28 the superposition of two types of motions indeed achieve the expected combined effect i e the absolute value of the side thrust is considerably reduced after j 0 2 and the hydrodynamic efficiency starts to increase after j 0 6 the maximum side thrust reduction rate and efficiency increase rate are 88 89 and 43 47 j 1 2 respectively the forces of a single blade in two successive circles are shown in fig 29 the main features of the forces are very similar to the results with anti virtual camber moving flaps in fig 20 which indicates the dominant effect comes from anti virtual camber motion compared with no flap cases the mean values of main thrust increase rate and side thrust reduction rate are 116 35 and 91 38 respectively absolute value fig 30 shows the vorticity field comparison with and without flaps similarly to the cases in section 4 2 the rotating flaps produce higher intensity vortex at the same time the symmetry of the vorticity field with respect to the incoming flow direction is also altered by the flaps motion i e the angles of upper and lower envelope lines of the vorticity field with respect to the incoming flow direction for cases with flap are 2 and 3 whereas the no flap cases are 5 and 2 unlike the case shown in fig 21 the vorticity field with flap is not perfect symmetrical which is due to the fact that the side thrust is not completely offset in this case i e the ks is about 0 05 for j 1 2 as shown in fig 28 this again shows the correlation between the shape of the vorticity field and its thrust directions 5 conclusion in this paper the concept of improving the hydrodynamic performance of the cycloidal propeller by adding flaps at the trailing edge of the blade is investigated three different types of flap motions i e the anti virtual camber sinusoidal and their linear superposition are tested the main findings of this study are as follows 1 when the flaps rotate according to the law of anti virtual camber the side thrust coefficient can be significantly reduced for the whole range of advance coefficients the maximum reduction rate can be up to 99 87 for the tested cases 2 when the flaps rotate according to the sinusoidal law both the main thrust coefficient and torque coefficient are considerably increased for the whole range of advance coefficients however the efficiency is only increased under relatively high advance coefficients the maximum efficiency increase can reach 50 23 for j 1 2 in this study 3 when the flaps rotate according to the linear superposition of anti virtual camber and sinusoidal law the side thrust eliminating and efficiency improving goals can be achieved simutanuesly the efficiency improvement is also only for large advance coefficients but the side thrust reduction is valid for the whole range of advance coefficients the above mentioned results are based on the typical flap length and motion amplitude a comprehensive research about the influence of the flap length and the rotation angle amplitude will be conducted in the future credit authorship contribution statement zhe sun conceptualization methodology investigation supervision writing original draft funding acquisition heng li data curation investigation validation writing original draft software visualization zhen hui liu writing review editing wen quan wang funding acquisition gui yong zhang project administration funding acquisition zhi zong funding acquisition yi chen jiang funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by the national natural science foundation of china no 51809035 52061135107 51639003 national key research and development program of china 2019yfc0312400 open project of state key laboratory of deep sea mineral resources development and utilization technology grant no sh 2020 kf a01 liao ning revitalization talents program no xlyc1908027 fundamental research funds for the central universities no dut20td108 dut20lab308 to which the authors are most grateful 
20327,the effect of ambient turbulence intensity on the flow induced oscillations of rigid circular cylinders with symmetric and asymmetric local turbulence stimulation is studied cylinders oscillate in one degree of freedom transversely to a steady uniform flow two dimensional unsteady reynolds average navier stokes equations with the spalart allmaras turbulence model are used to solve the problem numerically three freestream turbulence intensity values 0 2 1 5 are used to study the influence of turbulence intensity on vortex pattern simulation results are compared with experimental data measured in the marine renewable energy laboratory of the university of michigan in the range of 30 000 re 110 000 the amplitude ratio lift coefficient vortex modes and the interactions between vortices and cylinders are observed and discussed major conclusions are a vortex patterns strongly depend on the freestream ambient turbulence intensity b low turbulence intensity can generate multi vortex patterns at high re c high turbulence intensity results in fewer separations of a shed vortex into multiple vortices inducing emergence of elongated vortex patterns keywords turbulence intensity vortex induced vibration galloping symmetric turbulence stimulation asymmetric turbulence stimulation 1 introduction flow induced oscillations fio exist in many engineering areas especially in wind engineering and ocean engineering fio can cause fatigue damage to buildings such as bridges high chimneys marine oil and gas pipelines and offshore platforms in general elongated elastic bodies with bluff cross sections are susceptible to fio a well known case is the collapse of the tacoma narrows bridge due to flutter instability in 1940 the most frequent fio phenomenon is vortex induced vibration viv which was first observed by leonardo da vinci in 1504 strouhal provided the first mathematical formulation in 1878 feng 1963 measured viv response and pressure distribution for an elastically fixed cylinder in wind flow in 1968 in air the amplitude response consists of two parts namely the initial branch and the lower branch in water khalak and williamson 1996 that viv has four flow branches namely the initial branch the upper branch the lower branch and desynchronization a bluff cross section body in a flow shed large scale vortices in their wake for all reynolds numbers with the exception of three narrow regimes bernitsas 2016 depending on the relation between the body natural frequency and the vortex shedding frequency viv may initiate basic vortex shedding patterns were identified by williamson and roshko 1988 williamson and govardhan 2004 and the basic ones are shown in fig 1 by park et al 2016 p means a pair of vortices rotating in opposite directions and s indicates a single vortex flemming and williamson 2005 found the corresponding 2c vortex mode including two co rotating vortices in each half cycle which appears in the high amplitude upper branch 2t vortex wake mode was found by jauvtis and williamson 2004 comprising a triplet of vortices to form in each half cycle it becomes a super upper branch of high amplitude response that emerges in two dimensional motion when the mass ratio is less than 6 the viv of a smooth circular cylinder as a typical bluff body has been investigated by a large number of researchers and their findings are summarized in review papers by sarpkaya 2004 and williamson and govardhan 2004 we can find that different flow parameters lead to different wake structures in the present simulation we will visualize our research result based on the shedding vortex structure introduced by previous studies mentioned above galloping is another form of fio that was known as early as 1907 when lanchester described an aerial tourbillion the galloping response has some similarities to viv but it is fundamentally different the major similarity is that they both exhibit large amplitude oscillations primarily transversely to the incoming flow there are numerous differences with the most important being the driving fsi fluid structure interaction mechanism in viv vortices the size of the boundary layer shed at the separation point and move into the shear layer about half of the vorticity in a shear layer rolls up into a large scale vortex which of course caries flow memory on the contrary galloping is an instability phenomenon and there is no memory in the excitation there are vortices shedding during galloping but the hydrodynamic force they induce on the body is not the major one and may or may not be in phase with the galloping force bernitsas 2016 thus in modeling galloping the fundamental assumption is that the fluid force is quasi steady which means the fluid force on the structure is determined solely by the instantaneous relative velocity and angle of attack of the flow on the structure blevins and scanlan 1977 galloping has the characteristics of large amplitude and low frequency it is an instability induced by asymmetry which may be due to the body geometry or nonuniform up steam flow typically fio initiates with viv at higher velocity galloping is initiated when the asymmetry condition exists galloping onset may occur prior to the end of the viv range a non cylindrical bluff body like a square bokaian and geoola 1984 or a cylinder with appendages achenbach 1971 may be excited into galloping it should be noted that a body may be symmetric with respect to the absolute flow direction but not necessarily to the relative one which includes the velocity of the body in fio flow asymmetry may also induce galloping as in the case of a smooth cylinder in the wake of another body fio typically is suppressed in engineering applications because of its destructive nature research has demonstrated that we can benefit from it bernitsas et al 2008 introduced a current energy converter cec named vivace vortex induced vibration for aquatic clean energy and tested it in the marine renewable energy laboratory mrelab of the university of michigan vivace generates energy by converting hydrokinetic energy to mechanical in the oscillator in fio and subsequently to electricity in a later study bernitsas team chang et al 2011 park et al 2013 ding et al 2016 enhanced the vibration of the cylinder by selective surface roughness which is called passive turbulence control ptc systematic data were obtained and the cec was continually improved increasing its energy output in 2013 park et al 2013 conducted a series of experiments on the ptc position in the mrelab and established the ptc to fim map shown in fig 2 for ptc consisting of p60 commercial grade sand paper this type of ptc is used in this work as well park et al 2017 further studied the ptc to fim map to understand its robustness to zone coverage and hierarchy of zone dominance in order to further study the mechanism of ptc many researchers have focused their attention on the two dimensional geometric structure most of them using a bluff cross section body with trip wires the ptc of asymmetric distribution has a significant impact on the dynamics of a cylinder in fio nebres et al 1993 parezanović et al 2015 studied the wake characteristics of a two dimensional bluff body under a small control cylinder when the diameter of control cylinders is large enough to cause mean flow change not only the damping but also fluctuations of the drag of the main cylinder increase significantly the increased oscillations are much higher than the vortex shedding in timescales and are caused by the intermittent attachment and detachment of the flow on and from the control cylinder the work by ekmekci and rockwell 2010 identified two locations that are critical for the implementation of a single span wise wire on the basis of the near wake characteristics they showed that a surface wire d d 0 029 at θ c 1 55 location leads to extension in the stream wise length of the time averaged near wake bubble while a wire at θ c 2 65 results in contraction for re 10 000 research on ptc in the mrelab concentrated on symmetric roughness it is necessary to consider asymmetric roughness for understanding the mechanism of ptc to further improve a cec like the vivace system zhang et al 2018 investigated the rigid cylinder with asymmetric roughness in flow induced oscillations fio both experimentally and numerically they found out that just like the ptc cylinder with symmetric roughness there are four branches in the viv range for the one sided ptc cylinder further the amplitude of the one sided ptc cylinder is not symmetric around the equilibrium position the asymmetry in the amplitude response becomes stronger with increasing flow velocity increasing actual ptc location angle and decreasing damping ratio all of the experiments of mrelab were carried out in low turbulence free surface water ltfsw channel which has turbulence intensity normalized by the free stream velocity reported at 0 095 walker et al 1996 the influence of turbulence intensity has not been considered in prior research by cfd ding et al 2013 except recently by zhang et al 2018 nevertheless related research shows that the turbulence intensity has a profound influence on fio of a cylinder zhang et al 2018 in a wind tunnel or water channel the turbulence intensity is low and usually less than 5 so the influence of turbulence intensity should be taken into account in real application of the vivace converter in river and ocean currents or tides furthermore the literature on fim response under a turbulent flow re 5 105 is scarce most experimental and computational research in the open literature studies a bluff body placed in subcritical flow although in typical engineering applications re 5 105 and the flow is super critical further the turbulence intensity is less than 1 and the turbulence integral length scale is not controlled or measured motion induced forces of turbulence influence are not well understood wu and kareem 2012 matsumoto et al 1993 concluded that the effects of turbulence on fio are rather complicated and the interaction between the vorticity in the wake and vortices induced by the body s motion is uncertain compared to the investigations of a static body studies of the effect of turbulence intensity on flow induced motion of spring mounted cylinders are much scarcer some of the limited studies are mentioned next wu and kareem 2012 speculated that free stream turbulence can stabilize or destabilize the fim response depending on the relative intensity of the von karman to the motion induced vortices specifically if the von karman vortices dominate the presence of free stream turbulence would reduce the structural response and vice versa jubran et al 1992 showed that an increase in turbulence intensity leads to decrease of amplitude in the lock in region for a smooth cylinder while the increase of turbulence intensity in the galloping region increases the amplitude of oscillation daniels et al 2016 numerically studied the effect of turbulence intensity on the flow induced vibration of a rectangular cross section prism the increase of turbulence intensity reduced the amplitude of the structure in the flow direction and the transverse direction blackburn and melbourne 1997 studied experimentally the forced vibration of a cylinder immersed in a turbulent flow and analyzed the force on the cylinder the study showed that the lift spectrum has fewer peaks in the turbulent flow when compared with a smooth flow so et al 2008 experimentally studied the influence of free turbulence on the vortex induced vibration of a flexible cylinder free stream turbulence increases the shedding frequency of the vortex in the lock in region but does not change the natural frequency of the oscillator the overall effect of free stream turbulence can thus be interpreted using the ratio of energy variation free stream turbulence feeds energy to the oscillating cylinder in general and this energy transmission reaches a maximum at the lock in point and rapidly declines following the lock in region in order to clearly understand the influence of turbulence intensity in fim for a roughness cylinder two types of a cylinder with asymmetric roughness and symmetric roughness are studied in this work this paper focuses on the trsl3 30 000 re 110 000 flow regime which the shear layer is fully turbulent and fluctuating lift is high zdravkovich 1997 the simulation method implemented is a two dimensional unsteady rans method with the spalart allmaras turbulent model in ansys fluent software dynamic mesh technology and user defined functions for solving the oscillator equation are used to get more accurate results the numerical domain and grid generation are presented in section 2 in section 3 the physical model used in cfd and model tests is presented the governing equations consist of a turbulence model and the oscillator equation and are presented in section 4 in section 5 numerical results of amplitude response and vortex structures are compared and discussed with experiments conducted in the ltfsw channel of the mrelab conclusions are provided at the end 2 numerical model 2 1 numerical domain and boundary conditions for a single cylinder with distributed surface roughness the numerical domain is set as a rectangular area of 35d 13d d is the cylinder diameter as shown in fig 3 five boundaries of inflow outflow top bottom and the cylinder surface bound the numerical domain the initial position is located at the center of the region in the y direction the length between the inflow boundary and the center of the cylinder is set at 8d the downstream distance of the domain is determined to be 27d the reasons for setting up the domain like this is to ensure that the conditions at the outflow are close to the assumed fully developed flow conditions u x 0 p x c c means constant value for fully developed boundary condition the velocity profile is unchanged but the pressure drop still exits and to simulate adequately the channel conditions without the influence of the free surface which requires a minimum distance of three diameters away from the cylinder at all times the inflow boundary is set as a uniform and constant velocity the zero velocity gradient condition which is the fully developed condition is applied at the outflow boundary the bottom condition is defined as a wall boundary to match the experimental condition the effect of the free surface present in the paper was not considered in this numerical study and the top boundary is simplified by modeling it as a wall which was proven to be satisfactory in previous studies ding et al 2015 2016 ptc in the form of sandpaper strips was introduced in the mrelab to increase the efficiency and power density of the vivace hydrokinetic energy converter two configurations of a cylinder with asymmetric roughness and symmetric roughness are used in this paper a cylinder with symmetric roughness means that a pair of straight roughness strips are pasted on the surface of the cylinder symmetrically with respect to the forward stagnation point as shown in fig 4 covering circumferential surface area of 16 on a d 3 5 88 9 mm cylinder the location angle α ptc 20 is measured in degrees from the forward stagnation point in the corresponding ideal flow the asymmetric roughness configuration is that only one straight roughness strip is pasted in the lower half part of the cylinder covered circumferential surface area and location angle are the same for each sandpaper strip in symmetric and asymmetric ptc based on previous research by park et al 2013 sand strips with roughness designation p60 are used as ptc in this study table 1 shows the details of the roughness strip used in this study 2 2 grid generation and resolution a two dimensional and structured grid was used in this paper with the multi block grid generation technique for a non uniform grid which guarantees satisfactory calculation precision with moderate computational time corresponding to the multi block technique the interface technique which is shown in fig 3 as two dashed lines and in fig 6 as two red lines is used in the overlapping of two neighboring zones the subdomain in the vicinity of the cylinder is a 2d 2d square block where the grid density for the near wall region is enhanced to solve for high resolution in flow properties both the symmetric and asymmetric two structure grids around the cylinder are shown in fig 5 at high re galloping was observed and the maximum amplitude reached was nearly 2 5d in the cfd simulations large mesh deformations occur with the cylinder undergoing galloping in order to minimize the mesh deformation a dynamic mesh technique of topological change the layering method is used in the present study the cylinder and the 2d 2d square block fig 6 move synchronously to make sure the grid near the cylinder remains the same in the whole moving process for comparatively more accurate results especially for the integration of the pressure on the cylinder surface their moving velocity is determined by the user defined function udf routine the cell height adjacent to the moving block is properly set to ensure that the grid density remains almost the same with the initially generated grid as the block is moved in order to determine the overall grid resolution to achieve a convergent and accurate solution in a reasonable computational time a grid sensitivity study was conducted using three different grid densities for a stationary cylinder the drag coefficient c d and lift coefficient c l for different grid are compared in fig 7 it can be seen that for both the medium and fine grids the results are almost the same when c d and c l are stable furthermore the grid parameters and selected results are listed in table 2 where c d average is the time average value of the drag coefficient and c l max is the average value of the peaks of the lift coefficient as shown in table 2 compared with the fine grid the deviations of c d average and c l max for the medium grid are 1 9 and 0 46 respectively thus the medium grid resolution total 126327 cells for the ptc cylinder was selected in the present work the grid in this paper is fine enough to generate convergent results compared to the 60252 cell grid used by ding et al 2016 as for the boundary layer of the wall of ptc cylinder the two layer boundary mesh was used in the step region and correspondingly most of y value is less than 9 zhang et al 2018 according to the subdivisions of the near wall region in ansys help 2019 the y of the viscous sublayer is less than 5 although the y value in our simulation still bigger than 1 we have enough reason to believe that most of the first layer boundary mesh in our simulation are located in the viscous sublayer so our result is reasonable a more detailed boundary layer grid study can be found in the paper by zhang et al 2018 3 physical model a controller called virtual damper spring vck system has been used to replace the physical dampers and springs of the oscillators in the mrelab of the university of michigan the controller does not include the hydrodynamic force in the closed control loop and thus replace the physical oscillator without biasing the experimental measurements the system damping is identified using an elaborate system identification process and removed from the system to add a predetermined function linear or nonlinear and any values of the stiffness or damping parameters a mathematically accurate linear viscous damping is introduced which is hardly achievable in engineering applications and yet used in modeling oscillators in textbooks details on the vck system can be found in sun et al 2015 a virtual spring of stiffness k 600 n m is selected in the experimental system the total damping c total is defined as c t o t a l c s t r u c t u r e c h a r n e s s where c s t r u c t u r e is the existing system damping due to losses in the transmission system in this paper c s t r u c t u r e is set to correspond to ζ s t r u c t u r e 0 02 c h a r n e s s is the damping added through vck that converts the mechanical energy in the oscillating cylinder to electrical energy simulating a power take off pto system the relation between c t o t a l and ζ t o t a l can be expressed using the following equation ζ t o t a l c t o t a l 2 m o s c k the parameters of the experimental apparatus are listed in table 3 4 governing equations 4 1 turbulence model the transient viscous flow is described by numerical approximation of the incompressible 2d urans equations with the one equation spalart allmaras spalart et al 1992 turbulence model the turbulence model can be described as follows 1 u i x i 0 2 u i t u j u i x j 1 ρ p x i x j 2 v s j i u j u i where ν is the molecular kinematic viscosity u i is the mean flow velocity vector and s j i is the mean strain rate tensor 3 s j i 1 2 u i x j u j x i τ i j u i u j is defined as the reynolds stress a common method employs the boussinesq approximation to relate the reynolds stresses to the mean strain rate tensor in the spalart allmaras model as 4 τ i j 2 μ t s j i where μ i is the dynamic eddy viscosity the defining equation is as follow 5 μ t ρ υ f υ 1 and f υ 1 χ 3 χ 3 c υ 1 3 χ υ υ υ is the intermediate working variable of the turbulence model and obeys the following transport equation 6 υ t u j υ x j c b 1 s υ c w 1 f w υ d 2 1 σ x j υ υ υ x j c b 2 υ x i υ x i where the constant terms are c v 1 7 1 c b 1 0 1355 c w 1 3 2391 c b 2 0 622 more definitions of functions and constants are given by spalart et al 1992 4 2 oscillator equation the classical linear time invariant mass damper spring oscillator model is used to describe the cylinder dynamics in fio as shown in fig 8 the one degree of freedom equation of motion is 7 m o s c y c t o t a l y k y f where m osc is the total oscillating mass of the cylinder and attachments including one third of the spring mass f is the total hydrodynamic lift force which is calculated at a certain moment by 8 d f n p n d y isolating the acceleration term y at a certain moment from equation 7 yields 9 y n f n c t o t a l y n k y n m o s c the cylinder is assumed to be at the origin and stable at initial time so the initial conditions in mathematical terms are y 0 0 y 0 0 when the acceleration of the cylinder is known its velocity can be calculated by 10 y n 1 y n y n δ t the displacement of the cylinder in fio can therefore be written as 11 y n 1 y n y n 1 δ t 1 2 y n δ t 2 in the next time increment the cylinder will move at a velocity of y n 1 the flow domain will change then return to equation 8 and continue from equation 9 to equation 11 this generates the next step y and y the loop continues in this way and the algorithm advances in time simulating the fio it should be emphasized that fio is a fluid structure interaction fsi problem after each time circle the new velocity is imposed on the oscillator then the fluid field is modified thus the cylinder is subjected to the new hydrodynamic lift force and moves in response 5 results and discussion a series of numerical simulations for three different turbulence intensity i values 0 2 1 and 5 are performed to predict hydrodynamic loads and response of a spring mounted cylinder with asymmetric and symmetric roughness by using 2d urans the results are compared with experimental data from the ltfsw channel of the mrelab in simulations the cylinder starts from the equilibrium position of y 0 with zero initial velocity while in experiments the velocity was increased in steps and measurements start when steady state is reached more details can be found in sun et al 2016 at high reynolds number solving 2d urans equations is challenging specifically the separation point is not forecasted correctly for smooth cylinders for re 10 000 experimental data show that the separation points and the forward stagnation point oscillate due to vortex shedding alone by 5 10 even for a stationary cylinder therefore it is difficult to use 2d urans to simulate properly this unique feature of cylinder flows when re 10 000 in this paper however in order to force the separation point both in the simulations and in the experiments the asymmetric and symmetric roughness are applied to modify the surface geometry of the cylinder with proper modeling of ptc the 2d urans simulations exhibit several salient features of the flow resulting in an excellent agreement with experiments wu et al 2014 thus the code developed for fio of a single cylinder with asymmetric and symmetric roughness can be used with confidence to predict flow properties which are difficult to be measured experimentally at such high reynolds numbers detailed explanation can be found in zhang et al 2018 in this section the results of the amplitude time histories of displacement to diameter ratio and lift coefficient for a single cylinder with asymmetric and symmetric roughness are provided first then the vortex patterns at different reynolds numbers are discussed 5 1 cylinder with asymmetric roughness in the experimental tests and numerical simulations the spring stiffness k is set equal to 600 n m and the total damping ratio is set at 0 02 with the corresponding damping c total 2 64 n m the reynolds number range is 30 000 re 100 000 and the corresponding reduced velocity range is 3 95 u 13 18 where u u f n w a t e r d 5 1 1 amplitude ratio the amplitude ratio a d vs u graphs obtained by the numerical study and experimental measurements are compared in fig 9 in the experiment the amplitude ratio a d of the cylinder is calculated by averaging the absolute values of the 60 highest negative and positive peaks following the transient in the present simulations highest negative and positive peaks are recorded and averaged after the transient which is typically 30 s long the error bar shows the range in which the peak value of amplitude deviates from the average value by one standard deviation for i 0 2 the simulation results compare very well with the experimental data where the turbulence intensity of i is less than 0 1 xu et al 2017 that is both have low turbulence intensity in the comparison in fig 9 results are presented for three different values of turbulent intensity none of the three can match exactly that of the flow in the experiments which after all cannot be perfectly uniformly distributed in the channel flow for the low turbulence intensity i 0 2 the simulation results are in good agreement with the experimental data except for the transition between initial and the upper viv branches this is attributed to the fact that the experimental conditions cannot possibly matching the cfd conditions at a very critical point of the viv range specifically at the end of the initial branch towards the upper branch the vortex pattern changes from 2s to 2p this is a very sensitive transition as can be attested for example by the hysteresis phenomenon at that point as reported by williamson and his associates about 20 years ago in addition the urans model cannot capture the boundary layer separation point accurately an issue further exaggerated by the stream turbulence intensity within the tested reynolds number range four regions are clearly observed in the amplitude ratio curve the initial branch of viv the upper branch of viv transition from viv to galloping and galloping the maximum displacement of the oscillating cylinder reached in galloping is around 1 8d in both numerical calculations and experiments the detailed validation of the numerical simulation and experimental results can be found in zhang et al 2018 viv and galloping response are two most frequently occurring fios in viv the oscillation frequency of the cylinder is equal to the wake frequency defined by single of multiple vortices shedding in clusters singles pairs etc alternatingly from the two sides of the cylinder this is called synchronization or lock in sarpkaya 2004 two alternate interpretations are still discussed in the literature a lock in of vortex shedding frequency to the frequency of oscillation williamson and govardhan 2004 b variable fluid added mass altering the natural frequency of the oscillating body in water resulting in variable frequency resonance as the flow velocity increases vikestad et al 2000 a most recent development revealed an eigen relation at the interface between fluid and structure explaining all experimental facts established on viv over more than 100 years bernitsas et al 2019 and the argument between the two prevailing theories a and b the galloping generation mechanism is the interruption of communication between the separated upper and lower flows it is instigated by geometric or flow asymmetry blevins and scanlan 1977 the a d of upper branch of viv and galloping are compared in fig 10 where the abscissa is the turbulence intensity i as the turbulence intensity increases to 5 the amplitude ratio decreases more obviously at re 90 000 which is in the galloping branch in order to further study the upper branch and galloping displacement time histories in the upper branch and galloping for different turbulence intensity are given in fig 11 the displacement ratio for i 0 2 is non uniform in time but it also shows a distinguishable repetitive pattern for 1 and 5 turbulence intensity the displacement ratio time histories are highly uniform the lift coefficient time histories in the upper branch and galloping for different turbulence intensity are also shown in fig 11 like the displacement ratio curve the lift coefficient is also unstable at low turbulence it is clearly observed that the displacement ratio and lift coefficient time histories are asymmetrical at the neutral position which can be attributed to its structural asymmetry 5 1 2 vortex modes this subsection presents the vortex structures observations of a cylinder with asymmetric roughness in the simulations as mentioned earlier there are several basic forms of the near wake vortex pattern related to fio in earlier work by wu et al 2014 the simulation results showed that transition between branches is accompanied by vortex pattern change and non uniform amplitude response on the other hand the vortex pattern is stable and the amplitude is uniform when the oscillating cylinder is in the same fio region according to sun et al 2016 the frequency ratio of a cylinder with symmetric roughness is a little less than one in galloping there is enough time in one full oscillation to observe the vortex shedding process in order to compare the vortex patterns at different reynolds numbers in each specific case a total of eight pictures with a time interval of 0 125 s are shown in each of figs 12 23 to study the process of vortex initiation growth shedding and interaction with other vortices the following observations can be made based on the wake patterns shown in figs 12 23 the dashed lines in all the graphs represent the equilibrium position a re 30 000 u 3 95 this is the initial branch of viv for the asymmetric roughness cylinder for i 0 2 i 1 and i 5 in figs 12 14 a total of two pairs of vortices shed one from each cylinder side along where a small vortex is attached to a dominant vortex in each pair of vortices this vortex pattern is quasi 2p it means that two pairs of vortices shed per cycle but in each pair one vortex is much weaker than the other wu et al 2014 during the oscillation the quasi 2p mode can be observed in the mode transition from 2s to 2p although the same vortex structure appears for all three turbulence intensity values there are some differences between them as the turbulence intensity increases the wake vortices become weaker and they disperse more rapidly at high turbulence intensities b re 50 000 u 6 59 re is located in the upper branch of viv different from re 30 000 the three turbulence intensities show different wake vortex modes for i 0 2 the vortex shedding process is shown in fig 15 for 2 s due to the highly uniform nature of the displacement ratio time history more than one vortex pattern may be observed two vortex shedding patterns were observed p qp and t qt qp means quasi pair though it is a pair of vortices one is much weaker than the other ding et al 2016 qt has a similar definition in this paper which means one vortex in the triplet is much weaker than the other two vortices p s vortex mode appears at i 1 in fig 16 compared with p qp vortex mode of i 0 2 the large turbulence intensity increases the vortex diffusion and the identification of the weaker vortex in qp becomes difficult the high turbulence intensity forces the weaker vortex to cancel with its pairing stronger vortex so that qp changes to s as for i 5 in fig 17 it is more difficult for the weaker vortex to form and shed and the specific qp mode of vortex cannot be clearly distinguished the turbulence intensity is the ratio of root mean square of the turbulent velocity fluctuations over the mean velocity high turbulence intensity means high turbulent velocity fluctuation which can induce violent mixing in the fluid and this phenomenon is more obvious when vortices of opposite rotation are mixed saumweber et al 2003 kanani et al 2018 so in our study the high turbulence intensity can force the qp vortex pair to dissolve the weaker vortex and convert to s c re 70 000 u 9 23 this is in the transition region from the upper branch to galloping that is galloping initiates early due to low damping before the end of the viv lower branch and desynchronization the t s p vortex mode can be clearly seen for i 0 2 in fig 18 when turbulence intensity increases to 1 fewer distinct vortices shed and the vortex structure changes to t p as shown in fig 19 the turbulence intensity further increases to 5 as re 50 000 and i 5 vortex shedding becomes unclear in fig 20 the vortices get weaker with the turbulence intensity increase and vortices dissipate earlier at higher turbulence intensity d re 100 000 u 13 18 this is in the fully developed galloping region the vortex mode is t s s t for i 0 2 in fig 21 in fig 22 t qt s vortex structure is observed at i 1 as for i 5 with the aid of high flow velocity the shed of the vortex from the cylinder becomes more difficult and the vortex becomes longer in fig 23 in order to further study the elongated vortex the contour map is shown in fig 24 the elongated vortex actually contains multiple vortex cores specifically seven vortex cores in this case that is a number of vortices are formed and shed but due to the influence of high turbulence intensity and high in coming flow velocity the identification of distinct vortices in this case is difficult and the vortices are mixed together to form an elongated vortex on the whole in summary the number of the vortices shed in one cycle increases as the re increases and as the turbulence intensity increases vortices become weaker and harder to exist as individual distinguishable vortices vortex modes of quasi 2p p qp p s and t p etc are observed it is important to note that all wake vortex patterns are asymmetrical albeit some are difficult to discern the asymmetry of the wake structures is attributed to the asymmetric distribution of roughness on the cylinder furthermore this can explain why the displacement ratios and lift coefficient time histories are asymmetrical at the y 0 position as mentioned in section 5 1 1 at low re the low turbulence intensity can make the trailing vortex forming a clear two row vortex street at high re and low turbulence intensity i the multi vortex structure weakens sometimes even being eliminated and the two row vortex street pattern reappearing but with the increase of the in flow re the increased turbulence intensity of the two row vortex street can obviously emerge it is mainly because the high turbulence intensity filters out the small eddies around the large vortex so that the multi vortex structure is returned to the two row vortex street structure as studied in zhang et al 2018 and explained by bernitsas 2016 2d urans codes fail to predict accurately the separation point in smooth cylinders for re 10 000 for one sided ptc cylinder the ptc side has additional layers which can force the boundary layer to separate at this point and the simulation work shows good accordance with the experiment on the other hand for the smooth side in the simulation and especially at high flow velocity it is hard to capture the oscillation of the separation point a minor detail of major influence in viv hence the shear layer on the smooth side of the cylinder is hard to be cut off by its counterpart ptc side shear layer wake fig 23 which forms the elongated vortex the high turbulence intensity can further hinder the formation of the multi vortex hence the vortex number of the smooth side is less than that of the ptc side compared to the symmetric two sided ptc cylinder which is presented in the next section 5 2 the asymmetric one sided ptc cylinder makes the alternating lift smaller especially at high turbulence intensity and correspondingly the negative amplitude is lower than the positive amplitude 5 1 3 cylinder frequency the non dimensionless vibration frequency of the oscillator is shown in fig 25 generally the vibration frequency of the oscillator is always locked near the natural frequency it also can be seen that the turbulence intensity certainly has influence on the frequency data especially for the viv branch with the increase of the turbulence intensity the vibration frequency decreases slightly while for the galloping branch the frequency remains almost unchanged the variation of frequency with the coming flow velocity is almost consistent with that in the paper by ding et al 2016 and sun et al 2016 5 2 cylinder with symmetric roughness in this section the corresponding case of a cylinder with symmetric ptc is studied to be consistent with the asymmetric cylinder study in section 5 1 the spring stiffness k is also set equal to 600 n m and the damping ratio is 0 02 the corresponding damping is 2 64 n m in the experimental tests the reynolds number range is 30 000 re 110 000 and the corresponding reduced velocity range is 3 49 u 12 78 more details can be found in sun et al 2016 5 2 1 cylinder displacement the amplitude ratio graphs obtained by numerical simulation are shown in fig 26 and the experimental data are from sun et al 2016 for i 0 2 compared with the experimental data the amplitude ratio plot from the present 2d urans results follows the same trend within the test reynolds number range four regions of the initial branch of viv the upper branch of viv transition from viv to galloping and galloping are clearly observed in the amplitude ratio curve the maximum amplitude of the oscillating cylinder reached in galloping is about 2 0d in the experiments in the numerical simulation the maximum amplitude is around 2 3d unlike the cylinder with asymmetric roughness the amplitude of galloping does not drop when the turbulence intensity increased to 5 a d in the upper branch and galloping are compared in fig 27 where the abscissa is the turbulence intensity i as the turbulence intensity increases to 5 the amplitude ratio decreases in the upper branch of viv but at re 110 000 which is in the galloping region the amplitude is almost unchanged this is confirmation of the accuracy of the numerical calculations as the driving force in galloping is not related to the vortex lock in mechanism or the vortex strength in order to further study the upper branch and galloping the time displacement histories of the upper branch and galloping for different turbulence intensity values are given in fig 28 the first obvious difference with the cylinder with asymmetric roughness is that in the symmetric ptc cases the transient is significantly longer the displacement ratio time histories of i 0 2 in the upper branch is non uniform and with turbulence intensity increase from 0 2 to 5 the displacement ratio time histories become gradually uniform in the galloping displacement ratio time histories of both i 0 2 and i 1 are highly unstable the lift coefficient time histories in the upper branch and in galloping for different turbulence intensity are also shown in fig 28 like the displacement ratio curves the lift coefficient graphs have the same trend when displacement ratios and lift coefficient time histories are non uniform at low turbulence intensity in essence the galloping is an unstable phenomenon and it s hard to identify the symmetry or asymmetry of the time histories curve with the increase of turbulence intensity there is transition from nonuniform oscillation to uniform oscillation as in the case of i 1 re 50 000 for i 5 the displacement ratio and lift coefficient curves are symmetrical which is different from a cylinder with asymmetric roughness 5 2 2 vortex modes the vortex modes in the wake of a cylinder with symmetric roughness of 2d urans simulations are presented in this section to make it consistent with the analysis in section 5 1 of the cylinder with asymmetric roughness similar wake structure series of frames from animations are used the following observations can be made based on the wake patterns shown in figs 29 40 a re 30 000 u 3 49 the oscillating cylinder with asymmetric roughness is in the initial branch of viv for i 0 2 i 1 and i 5 in figs 29 31 the 2s mode of vortex shedding can be clearly observed this mode is similar to the classical von karman street in the wake of a stationary cylinder two single vortices with opposite direction of rotation shed from the oscillating cylinder with symmetric roughness during one oscillation cycle although the same vortex structures appear for all three turbulence intensity values there are some differences among them as turbulence intensity increases the wake vortices become weaker that is the vortices disperse more rapidly at higher turbulence intensities b re 50 000 u 5 81 this is the upper branch of viv contrary to the re 30 000 cases where all three i value resulted in similar vortex modes in the case of re 50 000 the three turbulence intensities show different wake vortex structures for i 0 2 2p vortex mode is observed in fig 32 that is two pair of vortices with opposite direction of rotation shed from the oscillating cylinder with symmetric roughness during one oscillation cycle the p s vortex mode appears at i 1 in fig 33 compared with 2p vortex mode of i 0 2 the larger turbulence intensity increases the vortex diffusion and the small vortex in a pair is not formed so that one p changes to s as for i 5 it is more difficult for vortex to shed in fig 34 and shedding vortices are linked together c re 70 000 u 8 13 this re belongs to end of the upper branch of viv and beginning of the transition to galloping the 2t vortex mode can be clearly watched for i 0 2 in fig 35 when turbulence intensity increases to 1 fewer vortices shed and mode changes to p t in fig 36 the turbulence intensity further increases to 5 and as in the case of re 50 000 and i 5 though the shed vortices are partly connected the vortex mode can be considered as 2p in fig 37 d re 110 000 u 12 78 the amplitude ratio curve has been in the galloping the vortex mode is t s s t or 2t for i 0 2 as shown in fig 38 qt s s qt or t s t s vortex mode are displayed at i 1 in fig 39 vortex pattern is different in the two cycles which causes the different force on the cylinder thus as shown in fig 27 the oscillation process is not steady and more vortices correspond to the larger amplitude the above is the reason for the larger standard deviation in fig 27 some vortices become weaker with the turbulence intensity increase and that is the reason of mode changing between i 0 2 and i 1 as for i 5 the shedding vortices are linked in fig 40 and it is difficult to label the specific mode for all cases a conclusion similar to the case of cylinder with asymmetric roughness can be made the number of the vortices shed in one cycle increases as the re increases at low turbulence intensity the shedding vortices form the multi vortex mode because of the shear layer effect there are small eddies near the shedding large vortex with the increase of turbulence intensity and the higher number of small eddies the vortex modes become unclear because of the dissipating effect of the high turbulence intensity correspondingly discerning of the multi vortices becomes more difficult vortex modes of 2s 2p 2t and t s s t etc are observed it is important to note that all wake vortex patterns are symmetrical due to the symmetrical roughness about y 0 of the cylinder 6 conclusions the flow induced oscillation fio of a single rigid cylinder with asymmetric and symmetric roughness was investigated using two dimensional unsteady reynolds averaged navier stokes equations with the spalart allmaras turbulence model at high reynolds numbers 30 000 re 110 000 in the trsl3 flow regime simulation results were compared with experimental measurements conducted in the ltfsw channel of the mrelab of the university of michigan the results including amplitude response lift coefficient and vortex modes were analyzed turbulence was varied as parameter for studying its effect on vortex shedding form and the wake of cylinders with turbulence stimulation applied through local surface roughness the following conclusions can be drawn 1 as the turbulence intensity increases to 5 the amplitude ratio of the cylinder with asymmetric roughness decreases this is more pronounced in galloping for the cylinder with symmetric roughness the amplitude ratio is almost unchanged in galloping 2 asymmetry of oscillation becomes less pronounced with the increase of the turbulence intensity further the time histories of the displacement ratio and lift coefficient become more uniform 3 the number of vortices shed in one cycle increases as the re number increases but decreases with increase of turbulence intensity at low turbulence intensity the shedding vortices form the multi vortex mode at the higher flow velocity and high turbulence intensity the vortex structure of an asymmetric ptc cylinder displays the multi elongated vortex mode with the increase of turbulence intensity the affiliated small eddies become less discernible as a result it becomes difficult to identify multi vortex modes 4 at low re the low turbulence intensity made the vortex wake form a clear two row vortex street at high re with low turbulence intensity the multi vortex mode weakened and sometimes it even eliminated the two row vortex street pattern with the increase of the re number of the in coming flow though the turbulence intensity at which the two row vortex street can emerge clearly also increased 5 closely related to the turbulence stimulation asymmetry the displacement ratio and lift coefficient time histories of the cylinder with asymmetric roughness are asymmetrical about the equilibrium position two different vortex modes may occur when the displacement ratio time history is highly non uniform 6 for the cylinder with asymmetric roughness at i 0 2 the vortex patterns appear in the following order as the flow velocity and thus the generated vorticity increases quasi 2p p qp or t qt p s p s and t s s t re changes from 30 000 to 100 000 the fio regimes are the initial branch of viv the upper branch of viv transition from viv to galloping and galloping and it is important to note that all wake vortex modes are not symmetrical 7 for a cylinder with symmetric roughness at i 0 2 as re increases from 30 000 to 100 000 in the flow regions of the initial viv branch the upper viv branch transition from viv to galloping and galloping vortex modes of 2s 2p 2t and t s s t or 2t are observed author contributions dr dahai zhang and dr hai sun conceived of the comparison and the understanding of turbulence intensity on the vortex pattern via the cfd analysis via the experimental observations dr sun developed the virtual spring damping system with the discussion with dr michael bernitsas we were encouraged to investigate this phenomenon experimentally and numerically dr zhang and mr wenhao wang carried out the cfd analysis and generated the figures for all the turbulences dr sun carried out the experiment dr sun and dr zhang wrote the manuscript with support from dr bernitsas dr zhang mr wang and dr sun contributed to the design and implementation of the research to the analysis of the results and to the writing of the manuscript the result and discussions section are written by dr bernitsas dr sun dr wenjun declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by a the natural science foundation of shandong province of china grant no zr2018mee032 b the natural science foundation no 51609053 c the fundamental research funds for the central universities grant no 18cx02131a d cooperative agreement de ee0006780 between the u s department of energy and vortex hydro energy the mrelab is subcontractor through the university of michigan 
20327,the effect of ambient turbulence intensity on the flow induced oscillations of rigid circular cylinders with symmetric and asymmetric local turbulence stimulation is studied cylinders oscillate in one degree of freedom transversely to a steady uniform flow two dimensional unsteady reynolds average navier stokes equations with the spalart allmaras turbulence model are used to solve the problem numerically three freestream turbulence intensity values 0 2 1 5 are used to study the influence of turbulence intensity on vortex pattern simulation results are compared with experimental data measured in the marine renewable energy laboratory of the university of michigan in the range of 30 000 re 110 000 the amplitude ratio lift coefficient vortex modes and the interactions between vortices and cylinders are observed and discussed major conclusions are a vortex patterns strongly depend on the freestream ambient turbulence intensity b low turbulence intensity can generate multi vortex patterns at high re c high turbulence intensity results in fewer separations of a shed vortex into multiple vortices inducing emergence of elongated vortex patterns keywords turbulence intensity vortex induced vibration galloping symmetric turbulence stimulation asymmetric turbulence stimulation 1 introduction flow induced oscillations fio exist in many engineering areas especially in wind engineering and ocean engineering fio can cause fatigue damage to buildings such as bridges high chimneys marine oil and gas pipelines and offshore platforms in general elongated elastic bodies with bluff cross sections are susceptible to fio a well known case is the collapse of the tacoma narrows bridge due to flutter instability in 1940 the most frequent fio phenomenon is vortex induced vibration viv which was first observed by leonardo da vinci in 1504 strouhal provided the first mathematical formulation in 1878 feng 1963 measured viv response and pressure distribution for an elastically fixed cylinder in wind flow in 1968 in air the amplitude response consists of two parts namely the initial branch and the lower branch in water khalak and williamson 1996 that viv has four flow branches namely the initial branch the upper branch the lower branch and desynchronization a bluff cross section body in a flow shed large scale vortices in their wake for all reynolds numbers with the exception of three narrow regimes bernitsas 2016 depending on the relation between the body natural frequency and the vortex shedding frequency viv may initiate basic vortex shedding patterns were identified by williamson and roshko 1988 williamson and govardhan 2004 and the basic ones are shown in fig 1 by park et al 2016 p means a pair of vortices rotating in opposite directions and s indicates a single vortex flemming and williamson 2005 found the corresponding 2c vortex mode including two co rotating vortices in each half cycle which appears in the high amplitude upper branch 2t vortex wake mode was found by jauvtis and williamson 2004 comprising a triplet of vortices to form in each half cycle it becomes a super upper branch of high amplitude response that emerges in two dimensional motion when the mass ratio is less than 6 the viv of a smooth circular cylinder as a typical bluff body has been investigated by a large number of researchers and their findings are summarized in review papers by sarpkaya 2004 and williamson and govardhan 2004 we can find that different flow parameters lead to different wake structures in the present simulation we will visualize our research result based on the shedding vortex structure introduced by previous studies mentioned above galloping is another form of fio that was known as early as 1907 when lanchester described an aerial tourbillion the galloping response has some similarities to viv but it is fundamentally different the major similarity is that they both exhibit large amplitude oscillations primarily transversely to the incoming flow there are numerous differences with the most important being the driving fsi fluid structure interaction mechanism in viv vortices the size of the boundary layer shed at the separation point and move into the shear layer about half of the vorticity in a shear layer rolls up into a large scale vortex which of course caries flow memory on the contrary galloping is an instability phenomenon and there is no memory in the excitation there are vortices shedding during galloping but the hydrodynamic force they induce on the body is not the major one and may or may not be in phase with the galloping force bernitsas 2016 thus in modeling galloping the fundamental assumption is that the fluid force is quasi steady which means the fluid force on the structure is determined solely by the instantaneous relative velocity and angle of attack of the flow on the structure blevins and scanlan 1977 galloping has the characteristics of large amplitude and low frequency it is an instability induced by asymmetry which may be due to the body geometry or nonuniform up steam flow typically fio initiates with viv at higher velocity galloping is initiated when the asymmetry condition exists galloping onset may occur prior to the end of the viv range a non cylindrical bluff body like a square bokaian and geoola 1984 or a cylinder with appendages achenbach 1971 may be excited into galloping it should be noted that a body may be symmetric with respect to the absolute flow direction but not necessarily to the relative one which includes the velocity of the body in fio flow asymmetry may also induce galloping as in the case of a smooth cylinder in the wake of another body fio typically is suppressed in engineering applications because of its destructive nature research has demonstrated that we can benefit from it bernitsas et al 2008 introduced a current energy converter cec named vivace vortex induced vibration for aquatic clean energy and tested it in the marine renewable energy laboratory mrelab of the university of michigan vivace generates energy by converting hydrokinetic energy to mechanical in the oscillator in fio and subsequently to electricity in a later study bernitsas team chang et al 2011 park et al 2013 ding et al 2016 enhanced the vibration of the cylinder by selective surface roughness which is called passive turbulence control ptc systematic data were obtained and the cec was continually improved increasing its energy output in 2013 park et al 2013 conducted a series of experiments on the ptc position in the mrelab and established the ptc to fim map shown in fig 2 for ptc consisting of p60 commercial grade sand paper this type of ptc is used in this work as well park et al 2017 further studied the ptc to fim map to understand its robustness to zone coverage and hierarchy of zone dominance in order to further study the mechanism of ptc many researchers have focused their attention on the two dimensional geometric structure most of them using a bluff cross section body with trip wires the ptc of asymmetric distribution has a significant impact on the dynamics of a cylinder in fio nebres et al 1993 parezanović et al 2015 studied the wake characteristics of a two dimensional bluff body under a small control cylinder when the diameter of control cylinders is large enough to cause mean flow change not only the damping but also fluctuations of the drag of the main cylinder increase significantly the increased oscillations are much higher than the vortex shedding in timescales and are caused by the intermittent attachment and detachment of the flow on and from the control cylinder the work by ekmekci and rockwell 2010 identified two locations that are critical for the implementation of a single span wise wire on the basis of the near wake characteristics they showed that a surface wire d d 0 029 at θ c 1 55 location leads to extension in the stream wise length of the time averaged near wake bubble while a wire at θ c 2 65 results in contraction for re 10 000 research on ptc in the mrelab concentrated on symmetric roughness it is necessary to consider asymmetric roughness for understanding the mechanism of ptc to further improve a cec like the vivace system zhang et al 2018 investigated the rigid cylinder with asymmetric roughness in flow induced oscillations fio both experimentally and numerically they found out that just like the ptc cylinder with symmetric roughness there are four branches in the viv range for the one sided ptc cylinder further the amplitude of the one sided ptc cylinder is not symmetric around the equilibrium position the asymmetry in the amplitude response becomes stronger with increasing flow velocity increasing actual ptc location angle and decreasing damping ratio all of the experiments of mrelab were carried out in low turbulence free surface water ltfsw channel which has turbulence intensity normalized by the free stream velocity reported at 0 095 walker et al 1996 the influence of turbulence intensity has not been considered in prior research by cfd ding et al 2013 except recently by zhang et al 2018 nevertheless related research shows that the turbulence intensity has a profound influence on fio of a cylinder zhang et al 2018 in a wind tunnel or water channel the turbulence intensity is low and usually less than 5 so the influence of turbulence intensity should be taken into account in real application of the vivace converter in river and ocean currents or tides furthermore the literature on fim response under a turbulent flow re 5 105 is scarce most experimental and computational research in the open literature studies a bluff body placed in subcritical flow although in typical engineering applications re 5 105 and the flow is super critical further the turbulence intensity is less than 1 and the turbulence integral length scale is not controlled or measured motion induced forces of turbulence influence are not well understood wu and kareem 2012 matsumoto et al 1993 concluded that the effects of turbulence on fio are rather complicated and the interaction between the vorticity in the wake and vortices induced by the body s motion is uncertain compared to the investigations of a static body studies of the effect of turbulence intensity on flow induced motion of spring mounted cylinders are much scarcer some of the limited studies are mentioned next wu and kareem 2012 speculated that free stream turbulence can stabilize or destabilize the fim response depending on the relative intensity of the von karman to the motion induced vortices specifically if the von karman vortices dominate the presence of free stream turbulence would reduce the structural response and vice versa jubran et al 1992 showed that an increase in turbulence intensity leads to decrease of amplitude in the lock in region for a smooth cylinder while the increase of turbulence intensity in the galloping region increases the amplitude of oscillation daniels et al 2016 numerically studied the effect of turbulence intensity on the flow induced vibration of a rectangular cross section prism the increase of turbulence intensity reduced the amplitude of the structure in the flow direction and the transverse direction blackburn and melbourne 1997 studied experimentally the forced vibration of a cylinder immersed in a turbulent flow and analyzed the force on the cylinder the study showed that the lift spectrum has fewer peaks in the turbulent flow when compared with a smooth flow so et al 2008 experimentally studied the influence of free turbulence on the vortex induced vibration of a flexible cylinder free stream turbulence increases the shedding frequency of the vortex in the lock in region but does not change the natural frequency of the oscillator the overall effect of free stream turbulence can thus be interpreted using the ratio of energy variation free stream turbulence feeds energy to the oscillating cylinder in general and this energy transmission reaches a maximum at the lock in point and rapidly declines following the lock in region in order to clearly understand the influence of turbulence intensity in fim for a roughness cylinder two types of a cylinder with asymmetric roughness and symmetric roughness are studied in this work this paper focuses on the trsl3 30 000 re 110 000 flow regime which the shear layer is fully turbulent and fluctuating lift is high zdravkovich 1997 the simulation method implemented is a two dimensional unsteady rans method with the spalart allmaras turbulent model in ansys fluent software dynamic mesh technology and user defined functions for solving the oscillator equation are used to get more accurate results the numerical domain and grid generation are presented in section 2 in section 3 the physical model used in cfd and model tests is presented the governing equations consist of a turbulence model and the oscillator equation and are presented in section 4 in section 5 numerical results of amplitude response and vortex structures are compared and discussed with experiments conducted in the ltfsw channel of the mrelab conclusions are provided at the end 2 numerical model 2 1 numerical domain and boundary conditions for a single cylinder with distributed surface roughness the numerical domain is set as a rectangular area of 35d 13d d is the cylinder diameter as shown in fig 3 five boundaries of inflow outflow top bottom and the cylinder surface bound the numerical domain the initial position is located at the center of the region in the y direction the length between the inflow boundary and the center of the cylinder is set at 8d the downstream distance of the domain is determined to be 27d the reasons for setting up the domain like this is to ensure that the conditions at the outflow are close to the assumed fully developed flow conditions u x 0 p x c c means constant value for fully developed boundary condition the velocity profile is unchanged but the pressure drop still exits and to simulate adequately the channel conditions without the influence of the free surface which requires a minimum distance of three diameters away from the cylinder at all times the inflow boundary is set as a uniform and constant velocity the zero velocity gradient condition which is the fully developed condition is applied at the outflow boundary the bottom condition is defined as a wall boundary to match the experimental condition the effect of the free surface present in the paper was not considered in this numerical study and the top boundary is simplified by modeling it as a wall which was proven to be satisfactory in previous studies ding et al 2015 2016 ptc in the form of sandpaper strips was introduced in the mrelab to increase the efficiency and power density of the vivace hydrokinetic energy converter two configurations of a cylinder with asymmetric roughness and symmetric roughness are used in this paper a cylinder with symmetric roughness means that a pair of straight roughness strips are pasted on the surface of the cylinder symmetrically with respect to the forward stagnation point as shown in fig 4 covering circumferential surface area of 16 on a d 3 5 88 9 mm cylinder the location angle α ptc 20 is measured in degrees from the forward stagnation point in the corresponding ideal flow the asymmetric roughness configuration is that only one straight roughness strip is pasted in the lower half part of the cylinder covered circumferential surface area and location angle are the same for each sandpaper strip in symmetric and asymmetric ptc based on previous research by park et al 2013 sand strips with roughness designation p60 are used as ptc in this study table 1 shows the details of the roughness strip used in this study 2 2 grid generation and resolution a two dimensional and structured grid was used in this paper with the multi block grid generation technique for a non uniform grid which guarantees satisfactory calculation precision with moderate computational time corresponding to the multi block technique the interface technique which is shown in fig 3 as two dashed lines and in fig 6 as two red lines is used in the overlapping of two neighboring zones the subdomain in the vicinity of the cylinder is a 2d 2d square block where the grid density for the near wall region is enhanced to solve for high resolution in flow properties both the symmetric and asymmetric two structure grids around the cylinder are shown in fig 5 at high re galloping was observed and the maximum amplitude reached was nearly 2 5d in the cfd simulations large mesh deformations occur with the cylinder undergoing galloping in order to minimize the mesh deformation a dynamic mesh technique of topological change the layering method is used in the present study the cylinder and the 2d 2d square block fig 6 move synchronously to make sure the grid near the cylinder remains the same in the whole moving process for comparatively more accurate results especially for the integration of the pressure on the cylinder surface their moving velocity is determined by the user defined function udf routine the cell height adjacent to the moving block is properly set to ensure that the grid density remains almost the same with the initially generated grid as the block is moved in order to determine the overall grid resolution to achieve a convergent and accurate solution in a reasonable computational time a grid sensitivity study was conducted using three different grid densities for a stationary cylinder the drag coefficient c d and lift coefficient c l for different grid are compared in fig 7 it can be seen that for both the medium and fine grids the results are almost the same when c d and c l are stable furthermore the grid parameters and selected results are listed in table 2 where c d average is the time average value of the drag coefficient and c l max is the average value of the peaks of the lift coefficient as shown in table 2 compared with the fine grid the deviations of c d average and c l max for the medium grid are 1 9 and 0 46 respectively thus the medium grid resolution total 126327 cells for the ptc cylinder was selected in the present work the grid in this paper is fine enough to generate convergent results compared to the 60252 cell grid used by ding et al 2016 as for the boundary layer of the wall of ptc cylinder the two layer boundary mesh was used in the step region and correspondingly most of y value is less than 9 zhang et al 2018 according to the subdivisions of the near wall region in ansys help 2019 the y of the viscous sublayer is less than 5 although the y value in our simulation still bigger than 1 we have enough reason to believe that most of the first layer boundary mesh in our simulation are located in the viscous sublayer so our result is reasonable a more detailed boundary layer grid study can be found in the paper by zhang et al 2018 3 physical model a controller called virtual damper spring vck system has been used to replace the physical dampers and springs of the oscillators in the mrelab of the university of michigan the controller does not include the hydrodynamic force in the closed control loop and thus replace the physical oscillator without biasing the experimental measurements the system damping is identified using an elaborate system identification process and removed from the system to add a predetermined function linear or nonlinear and any values of the stiffness or damping parameters a mathematically accurate linear viscous damping is introduced which is hardly achievable in engineering applications and yet used in modeling oscillators in textbooks details on the vck system can be found in sun et al 2015 a virtual spring of stiffness k 600 n m is selected in the experimental system the total damping c total is defined as c t o t a l c s t r u c t u r e c h a r n e s s where c s t r u c t u r e is the existing system damping due to losses in the transmission system in this paper c s t r u c t u r e is set to correspond to ζ s t r u c t u r e 0 02 c h a r n e s s is the damping added through vck that converts the mechanical energy in the oscillating cylinder to electrical energy simulating a power take off pto system the relation between c t o t a l and ζ t o t a l can be expressed using the following equation ζ t o t a l c t o t a l 2 m o s c k the parameters of the experimental apparatus are listed in table 3 4 governing equations 4 1 turbulence model the transient viscous flow is described by numerical approximation of the incompressible 2d urans equations with the one equation spalart allmaras spalart et al 1992 turbulence model the turbulence model can be described as follows 1 u i x i 0 2 u i t u j u i x j 1 ρ p x i x j 2 v s j i u j u i where ν is the molecular kinematic viscosity u i is the mean flow velocity vector and s j i is the mean strain rate tensor 3 s j i 1 2 u i x j u j x i τ i j u i u j is defined as the reynolds stress a common method employs the boussinesq approximation to relate the reynolds stresses to the mean strain rate tensor in the spalart allmaras model as 4 τ i j 2 μ t s j i where μ i is the dynamic eddy viscosity the defining equation is as follow 5 μ t ρ υ f υ 1 and f υ 1 χ 3 χ 3 c υ 1 3 χ υ υ υ is the intermediate working variable of the turbulence model and obeys the following transport equation 6 υ t u j υ x j c b 1 s υ c w 1 f w υ d 2 1 σ x j υ υ υ x j c b 2 υ x i υ x i where the constant terms are c v 1 7 1 c b 1 0 1355 c w 1 3 2391 c b 2 0 622 more definitions of functions and constants are given by spalart et al 1992 4 2 oscillator equation the classical linear time invariant mass damper spring oscillator model is used to describe the cylinder dynamics in fio as shown in fig 8 the one degree of freedom equation of motion is 7 m o s c y c t o t a l y k y f where m osc is the total oscillating mass of the cylinder and attachments including one third of the spring mass f is the total hydrodynamic lift force which is calculated at a certain moment by 8 d f n p n d y isolating the acceleration term y at a certain moment from equation 7 yields 9 y n f n c t o t a l y n k y n m o s c the cylinder is assumed to be at the origin and stable at initial time so the initial conditions in mathematical terms are y 0 0 y 0 0 when the acceleration of the cylinder is known its velocity can be calculated by 10 y n 1 y n y n δ t the displacement of the cylinder in fio can therefore be written as 11 y n 1 y n y n 1 δ t 1 2 y n δ t 2 in the next time increment the cylinder will move at a velocity of y n 1 the flow domain will change then return to equation 8 and continue from equation 9 to equation 11 this generates the next step y and y the loop continues in this way and the algorithm advances in time simulating the fio it should be emphasized that fio is a fluid structure interaction fsi problem after each time circle the new velocity is imposed on the oscillator then the fluid field is modified thus the cylinder is subjected to the new hydrodynamic lift force and moves in response 5 results and discussion a series of numerical simulations for three different turbulence intensity i values 0 2 1 and 5 are performed to predict hydrodynamic loads and response of a spring mounted cylinder with asymmetric and symmetric roughness by using 2d urans the results are compared with experimental data from the ltfsw channel of the mrelab in simulations the cylinder starts from the equilibrium position of y 0 with zero initial velocity while in experiments the velocity was increased in steps and measurements start when steady state is reached more details can be found in sun et al 2016 at high reynolds number solving 2d urans equations is challenging specifically the separation point is not forecasted correctly for smooth cylinders for re 10 000 experimental data show that the separation points and the forward stagnation point oscillate due to vortex shedding alone by 5 10 even for a stationary cylinder therefore it is difficult to use 2d urans to simulate properly this unique feature of cylinder flows when re 10 000 in this paper however in order to force the separation point both in the simulations and in the experiments the asymmetric and symmetric roughness are applied to modify the surface geometry of the cylinder with proper modeling of ptc the 2d urans simulations exhibit several salient features of the flow resulting in an excellent agreement with experiments wu et al 2014 thus the code developed for fio of a single cylinder with asymmetric and symmetric roughness can be used with confidence to predict flow properties which are difficult to be measured experimentally at such high reynolds numbers detailed explanation can be found in zhang et al 2018 in this section the results of the amplitude time histories of displacement to diameter ratio and lift coefficient for a single cylinder with asymmetric and symmetric roughness are provided first then the vortex patterns at different reynolds numbers are discussed 5 1 cylinder with asymmetric roughness in the experimental tests and numerical simulations the spring stiffness k is set equal to 600 n m and the total damping ratio is set at 0 02 with the corresponding damping c total 2 64 n m the reynolds number range is 30 000 re 100 000 and the corresponding reduced velocity range is 3 95 u 13 18 where u u f n w a t e r d 5 1 1 amplitude ratio the amplitude ratio a d vs u graphs obtained by the numerical study and experimental measurements are compared in fig 9 in the experiment the amplitude ratio a d of the cylinder is calculated by averaging the absolute values of the 60 highest negative and positive peaks following the transient in the present simulations highest negative and positive peaks are recorded and averaged after the transient which is typically 30 s long the error bar shows the range in which the peak value of amplitude deviates from the average value by one standard deviation for i 0 2 the simulation results compare very well with the experimental data where the turbulence intensity of i is less than 0 1 xu et al 2017 that is both have low turbulence intensity in the comparison in fig 9 results are presented for three different values of turbulent intensity none of the three can match exactly that of the flow in the experiments which after all cannot be perfectly uniformly distributed in the channel flow for the low turbulence intensity i 0 2 the simulation results are in good agreement with the experimental data except for the transition between initial and the upper viv branches this is attributed to the fact that the experimental conditions cannot possibly matching the cfd conditions at a very critical point of the viv range specifically at the end of the initial branch towards the upper branch the vortex pattern changes from 2s to 2p this is a very sensitive transition as can be attested for example by the hysteresis phenomenon at that point as reported by williamson and his associates about 20 years ago in addition the urans model cannot capture the boundary layer separation point accurately an issue further exaggerated by the stream turbulence intensity within the tested reynolds number range four regions are clearly observed in the amplitude ratio curve the initial branch of viv the upper branch of viv transition from viv to galloping and galloping the maximum displacement of the oscillating cylinder reached in galloping is around 1 8d in both numerical calculations and experiments the detailed validation of the numerical simulation and experimental results can be found in zhang et al 2018 viv and galloping response are two most frequently occurring fios in viv the oscillation frequency of the cylinder is equal to the wake frequency defined by single of multiple vortices shedding in clusters singles pairs etc alternatingly from the two sides of the cylinder this is called synchronization or lock in sarpkaya 2004 two alternate interpretations are still discussed in the literature a lock in of vortex shedding frequency to the frequency of oscillation williamson and govardhan 2004 b variable fluid added mass altering the natural frequency of the oscillating body in water resulting in variable frequency resonance as the flow velocity increases vikestad et al 2000 a most recent development revealed an eigen relation at the interface between fluid and structure explaining all experimental facts established on viv over more than 100 years bernitsas et al 2019 and the argument between the two prevailing theories a and b the galloping generation mechanism is the interruption of communication between the separated upper and lower flows it is instigated by geometric or flow asymmetry blevins and scanlan 1977 the a d of upper branch of viv and galloping are compared in fig 10 where the abscissa is the turbulence intensity i as the turbulence intensity increases to 5 the amplitude ratio decreases more obviously at re 90 000 which is in the galloping branch in order to further study the upper branch and galloping displacement time histories in the upper branch and galloping for different turbulence intensity are given in fig 11 the displacement ratio for i 0 2 is non uniform in time but it also shows a distinguishable repetitive pattern for 1 and 5 turbulence intensity the displacement ratio time histories are highly uniform the lift coefficient time histories in the upper branch and galloping for different turbulence intensity are also shown in fig 11 like the displacement ratio curve the lift coefficient is also unstable at low turbulence it is clearly observed that the displacement ratio and lift coefficient time histories are asymmetrical at the neutral position which can be attributed to its structural asymmetry 5 1 2 vortex modes this subsection presents the vortex structures observations of a cylinder with asymmetric roughness in the simulations as mentioned earlier there are several basic forms of the near wake vortex pattern related to fio in earlier work by wu et al 2014 the simulation results showed that transition between branches is accompanied by vortex pattern change and non uniform amplitude response on the other hand the vortex pattern is stable and the amplitude is uniform when the oscillating cylinder is in the same fio region according to sun et al 2016 the frequency ratio of a cylinder with symmetric roughness is a little less than one in galloping there is enough time in one full oscillation to observe the vortex shedding process in order to compare the vortex patterns at different reynolds numbers in each specific case a total of eight pictures with a time interval of 0 125 s are shown in each of figs 12 23 to study the process of vortex initiation growth shedding and interaction with other vortices the following observations can be made based on the wake patterns shown in figs 12 23 the dashed lines in all the graphs represent the equilibrium position a re 30 000 u 3 95 this is the initial branch of viv for the asymmetric roughness cylinder for i 0 2 i 1 and i 5 in figs 12 14 a total of two pairs of vortices shed one from each cylinder side along where a small vortex is attached to a dominant vortex in each pair of vortices this vortex pattern is quasi 2p it means that two pairs of vortices shed per cycle but in each pair one vortex is much weaker than the other wu et al 2014 during the oscillation the quasi 2p mode can be observed in the mode transition from 2s to 2p although the same vortex structure appears for all three turbulence intensity values there are some differences between them as the turbulence intensity increases the wake vortices become weaker and they disperse more rapidly at high turbulence intensities b re 50 000 u 6 59 re is located in the upper branch of viv different from re 30 000 the three turbulence intensities show different wake vortex modes for i 0 2 the vortex shedding process is shown in fig 15 for 2 s due to the highly uniform nature of the displacement ratio time history more than one vortex pattern may be observed two vortex shedding patterns were observed p qp and t qt qp means quasi pair though it is a pair of vortices one is much weaker than the other ding et al 2016 qt has a similar definition in this paper which means one vortex in the triplet is much weaker than the other two vortices p s vortex mode appears at i 1 in fig 16 compared with p qp vortex mode of i 0 2 the large turbulence intensity increases the vortex diffusion and the identification of the weaker vortex in qp becomes difficult the high turbulence intensity forces the weaker vortex to cancel with its pairing stronger vortex so that qp changes to s as for i 5 in fig 17 it is more difficult for the weaker vortex to form and shed and the specific qp mode of vortex cannot be clearly distinguished the turbulence intensity is the ratio of root mean square of the turbulent velocity fluctuations over the mean velocity high turbulence intensity means high turbulent velocity fluctuation which can induce violent mixing in the fluid and this phenomenon is more obvious when vortices of opposite rotation are mixed saumweber et al 2003 kanani et al 2018 so in our study the high turbulence intensity can force the qp vortex pair to dissolve the weaker vortex and convert to s c re 70 000 u 9 23 this is in the transition region from the upper branch to galloping that is galloping initiates early due to low damping before the end of the viv lower branch and desynchronization the t s p vortex mode can be clearly seen for i 0 2 in fig 18 when turbulence intensity increases to 1 fewer distinct vortices shed and the vortex structure changes to t p as shown in fig 19 the turbulence intensity further increases to 5 as re 50 000 and i 5 vortex shedding becomes unclear in fig 20 the vortices get weaker with the turbulence intensity increase and vortices dissipate earlier at higher turbulence intensity d re 100 000 u 13 18 this is in the fully developed galloping region the vortex mode is t s s t for i 0 2 in fig 21 in fig 22 t qt s vortex structure is observed at i 1 as for i 5 with the aid of high flow velocity the shed of the vortex from the cylinder becomes more difficult and the vortex becomes longer in fig 23 in order to further study the elongated vortex the contour map is shown in fig 24 the elongated vortex actually contains multiple vortex cores specifically seven vortex cores in this case that is a number of vortices are formed and shed but due to the influence of high turbulence intensity and high in coming flow velocity the identification of distinct vortices in this case is difficult and the vortices are mixed together to form an elongated vortex on the whole in summary the number of the vortices shed in one cycle increases as the re increases and as the turbulence intensity increases vortices become weaker and harder to exist as individual distinguishable vortices vortex modes of quasi 2p p qp p s and t p etc are observed it is important to note that all wake vortex patterns are asymmetrical albeit some are difficult to discern the asymmetry of the wake structures is attributed to the asymmetric distribution of roughness on the cylinder furthermore this can explain why the displacement ratios and lift coefficient time histories are asymmetrical at the y 0 position as mentioned in section 5 1 1 at low re the low turbulence intensity can make the trailing vortex forming a clear two row vortex street at high re and low turbulence intensity i the multi vortex structure weakens sometimes even being eliminated and the two row vortex street pattern reappearing but with the increase of the in flow re the increased turbulence intensity of the two row vortex street can obviously emerge it is mainly because the high turbulence intensity filters out the small eddies around the large vortex so that the multi vortex structure is returned to the two row vortex street structure as studied in zhang et al 2018 and explained by bernitsas 2016 2d urans codes fail to predict accurately the separation point in smooth cylinders for re 10 000 for one sided ptc cylinder the ptc side has additional layers which can force the boundary layer to separate at this point and the simulation work shows good accordance with the experiment on the other hand for the smooth side in the simulation and especially at high flow velocity it is hard to capture the oscillation of the separation point a minor detail of major influence in viv hence the shear layer on the smooth side of the cylinder is hard to be cut off by its counterpart ptc side shear layer wake fig 23 which forms the elongated vortex the high turbulence intensity can further hinder the formation of the multi vortex hence the vortex number of the smooth side is less than that of the ptc side compared to the symmetric two sided ptc cylinder which is presented in the next section 5 2 the asymmetric one sided ptc cylinder makes the alternating lift smaller especially at high turbulence intensity and correspondingly the negative amplitude is lower than the positive amplitude 5 1 3 cylinder frequency the non dimensionless vibration frequency of the oscillator is shown in fig 25 generally the vibration frequency of the oscillator is always locked near the natural frequency it also can be seen that the turbulence intensity certainly has influence on the frequency data especially for the viv branch with the increase of the turbulence intensity the vibration frequency decreases slightly while for the galloping branch the frequency remains almost unchanged the variation of frequency with the coming flow velocity is almost consistent with that in the paper by ding et al 2016 and sun et al 2016 5 2 cylinder with symmetric roughness in this section the corresponding case of a cylinder with symmetric ptc is studied to be consistent with the asymmetric cylinder study in section 5 1 the spring stiffness k is also set equal to 600 n m and the damping ratio is 0 02 the corresponding damping is 2 64 n m in the experimental tests the reynolds number range is 30 000 re 110 000 and the corresponding reduced velocity range is 3 49 u 12 78 more details can be found in sun et al 2016 5 2 1 cylinder displacement the amplitude ratio graphs obtained by numerical simulation are shown in fig 26 and the experimental data are from sun et al 2016 for i 0 2 compared with the experimental data the amplitude ratio plot from the present 2d urans results follows the same trend within the test reynolds number range four regions of the initial branch of viv the upper branch of viv transition from viv to galloping and galloping are clearly observed in the amplitude ratio curve the maximum amplitude of the oscillating cylinder reached in galloping is about 2 0d in the experiments in the numerical simulation the maximum amplitude is around 2 3d unlike the cylinder with asymmetric roughness the amplitude of galloping does not drop when the turbulence intensity increased to 5 a d in the upper branch and galloping are compared in fig 27 where the abscissa is the turbulence intensity i as the turbulence intensity increases to 5 the amplitude ratio decreases in the upper branch of viv but at re 110 000 which is in the galloping region the amplitude is almost unchanged this is confirmation of the accuracy of the numerical calculations as the driving force in galloping is not related to the vortex lock in mechanism or the vortex strength in order to further study the upper branch and galloping the time displacement histories of the upper branch and galloping for different turbulence intensity values are given in fig 28 the first obvious difference with the cylinder with asymmetric roughness is that in the symmetric ptc cases the transient is significantly longer the displacement ratio time histories of i 0 2 in the upper branch is non uniform and with turbulence intensity increase from 0 2 to 5 the displacement ratio time histories become gradually uniform in the galloping displacement ratio time histories of both i 0 2 and i 1 are highly unstable the lift coefficient time histories in the upper branch and in galloping for different turbulence intensity are also shown in fig 28 like the displacement ratio curves the lift coefficient graphs have the same trend when displacement ratios and lift coefficient time histories are non uniform at low turbulence intensity in essence the galloping is an unstable phenomenon and it s hard to identify the symmetry or asymmetry of the time histories curve with the increase of turbulence intensity there is transition from nonuniform oscillation to uniform oscillation as in the case of i 1 re 50 000 for i 5 the displacement ratio and lift coefficient curves are symmetrical which is different from a cylinder with asymmetric roughness 5 2 2 vortex modes the vortex modes in the wake of a cylinder with symmetric roughness of 2d urans simulations are presented in this section to make it consistent with the analysis in section 5 1 of the cylinder with asymmetric roughness similar wake structure series of frames from animations are used the following observations can be made based on the wake patterns shown in figs 29 40 a re 30 000 u 3 49 the oscillating cylinder with asymmetric roughness is in the initial branch of viv for i 0 2 i 1 and i 5 in figs 29 31 the 2s mode of vortex shedding can be clearly observed this mode is similar to the classical von karman street in the wake of a stationary cylinder two single vortices with opposite direction of rotation shed from the oscillating cylinder with symmetric roughness during one oscillation cycle although the same vortex structures appear for all three turbulence intensity values there are some differences among them as turbulence intensity increases the wake vortices become weaker that is the vortices disperse more rapidly at higher turbulence intensities b re 50 000 u 5 81 this is the upper branch of viv contrary to the re 30 000 cases where all three i value resulted in similar vortex modes in the case of re 50 000 the three turbulence intensities show different wake vortex structures for i 0 2 2p vortex mode is observed in fig 32 that is two pair of vortices with opposite direction of rotation shed from the oscillating cylinder with symmetric roughness during one oscillation cycle the p s vortex mode appears at i 1 in fig 33 compared with 2p vortex mode of i 0 2 the larger turbulence intensity increases the vortex diffusion and the small vortex in a pair is not formed so that one p changes to s as for i 5 it is more difficult for vortex to shed in fig 34 and shedding vortices are linked together c re 70 000 u 8 13 this re belongs to end of the upper branch of viv and beginning of the transition to galloping the 2t vortex mode can be clearly watched for i 0 2 in fig 35 when turbulence intensity increases to 1 fewer vortices shed and mode changes to p t in fig 36 the turbulence intensity further increases to 5 and as in the case of re 50 000 and i 5 though the shed vortices are partly connected the vortex mode can be considered as 2p in fig 37 d re 110 000 u 12 78 the amplitude ratio curve has been in the galloping the vortex mode is t s s t or 2t for i 0 2 as shown in fig 38 qt s s qt or t s t s vortex mode are displayed at i 1 in fig 39 vortex pattern is different in the two cycles which causes the different force on the cylinder thus as shown in fig 27 the oscillation process is not steady and more vortices correspond to the larger amplitude the above is the reason for the larger standard deviation in fig 27 some vortices become weaker with the turbulence intensity increase and that is the reason of mode changing between i 0 2 and i 1 as for i 5 the shedding vortices are linked in fig 40 and it is difficult to label the specific mode for all cases a conclusion similar to the case of cylinder with asymmetric roughness can be made the number of the vortices shed in one cycle increases as the re increases at low turbulence intensity the shedding vortices form the multi vortex mode because of the shear layer effect there are small eddies near the shedding large vortex with the increase of turbulence intensity and the higher number of small eddies the vortex modes become unclear because of the dissipating effect of the high turbulence intensity correspondingly discerning of the multi vortices becomes more difficult vortex modes of 2s 2p 2t and t s s t etc are observed it is important to note that all wake vortex patterns are symmetrical due to the symmetrical roughness about y 0 of the cylinder 6 conclusions the flow induced oscillation fio of a single rigid cylinder with asymmetric and symmetric roughness was investigated using two dimensional unsteady reynolds averaged navier stokes equations with the spalart allmaras turbulence model at high reynolds numbers 30 000 re 110 000 in the trsl3 flow regime simulation results were compared with experimental measurements conducted in the ltfsw channel of the mrelab of the university of michigan the results including amplitude response lift coefficient and vortex modes were analyzed turbulence was varied as parameter for studying its effect on vortex shedding form and the wake of cylinders with turbulence stimulation applied through local surface roughness the following conclusions can be drawn 1 as the turbulence intensity increases to 5 the amplitude ratio of the cylinder with asymmetric roughness decreases this is more pronounced in galloping for the cylinder with symmetric roughness the amplitude ratio is almost unchanged in galloping 2 asymmetry of oscillation becomes less pronounced with the increase of the turbulence intensity further the time histories of the displacement ratio and lift coefficient become more uniform 3 the number of vortices shed in one cycle increases as the re number increases but decreases with increase of turbulence intensity at low turbulence intensity the shedding vortices form the multi vortex mode at the higher flow velocity and high turbulence intensity the vortex structure of an asymmetric ptc cylinder displays the multi elongated vortex mode with the increase of turbulence intensity the affiliated small eddies become less discernible as a result it becomes difficult to identify multi vortex modes 4 at low re the low turbulence intensity made the vortex wake form a clear two row vortex street at high re with low turbulence intensity the multi vortex mode weakened and sometimes it even eliminated the two row vortex street pattern with the increase of the re number of the in coming flow though the turbulence intensity at which the two row vortex street can emerge clearly also increased 5 closely related to the turbulence stimulation asymmetry the displacement ratio and lift coefficient time histories of the cylinder with asymmetric roughness are asymmetrical about the equilibrium position two different vortex modes may occur when the displacement ratio time history is highly non uniform 6 for the cylinder with asymmetric roughness at i 0 2 the vortex patterns appear in the following order as the flow velocity and thus the generated vorticity increases quasi 2p p qp or t qt p s p s and t s s t re changes from 30 000 to 100 000 the fio regimes are the initial branch of viv the upper branch of viv transition from viv to galloping and galloping and it is important to note that all wake vortex modes are not symmetrical 7 for a cylinder with symmetric roughness at i 0 2 as re increases from 30 000 to 100 000 in the flow regions of the initial viv branch the upper viv branch transition from viv to galloping and galloping vortex modes of 2s 2p 2t and t s s t or 2t are observed author contributions dr dahai zhang and dr hai sun conceived of the comparison and the understanding of turbulence intensity on the vortex pattern via the cfd analysis via the experimental observations dr sun developed the virtual spring damping system with the discussion with dr michael bernitsas we were encouraged to investigate this phenomenon experimentally and numerically dr zhang and mr wenhao wang carried out the cfd analysis and generated the figures for all the turbulences dr sun carried out the experiment dr sun and dr zhang wrote the manuscript with support from dr bernitsas dr zhang mr wang and dr sun contributed to the design and implementation of the research to the analysis of the results and to the writing of the manuscript the result and discussions section are written by dr bernitsas dr sun dr wenjun declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by a the natural science foundation of shandong province of china grant no zr2018mee032 b the natural science foundation no 51609053 c the fundamental research funds for the central universities grant no 18cx02131a d cooperative agreement de ee0006780 between the u s department of energy and vortex hydro energy the mrelab is subcontractor through the university of michigan 
20328,a zonal detached eddy simulation zdes is suitable for large scale open channel flows with a free surface e g river flow in zdes only a local region is required to be investigated using large eddy simulation les to obtain a high resolution of vortical structures in hydraulic engineering in this study a fully non hydrostatic free surface flow model is developed for a zdes type model the focus is to analyse the critical strategy of the turbulent forcing method which is very important for the zdes type model a well validated synthetic eddy method was established using a numerical framework and applied to generate velocity fluctuations based on the synthetic turbulent velocity a new formulation of the body force term was fed into the momentum equations a test case of a fully developed open channel flow with a free surface was used to verify the numerical strategy then another common flow problem of a free surface flow over a fixed dune was adopted to further validate the numerical approach the results show that the proposed numerical strategy can promote the application of the hybrid reynolds averaged navier stokes les method in natural large scale open channel flow simulation keywords hybrid rans and les zdes synthesised turbulence forcing term non hydrostatic model 1 introduction a sufficiently resolved large eddy simulation les without wall functions is important for investigating complex open channel flows with a free surface yue et al 2005 2006 2006 chou and fringer 2008 hinterberger et al 2007 2008 2008 garcia et al 2009 balen et al 2010 most of the studies focused on flows with experimental scales at low reynolds numbers the primary obstacle to practical les of natural water flows involving complex solid bottoms at high reynolds numbers is still the computational cost to reduce this cost wall modelled les wmles strategies are feasible because the near wall hydrodynamics are modelled instead of being resolved deck et al 2014 for natural river flows the horizontal scale is extremely large to fully implement the wmles and it requires hybrid reynolds averaged navier stokes rans les strategies to eliminate the prohibitive computational cost the present study is primarily concerned with the potential use of zonal detached eddy simulation zdes which is a type of hybrid rans les method in hydraulic engineering although the hybrid rans les method only the detached eddy simulation des type method is considered in this study is beneficial implementing advanced methodologies for turbulent flow simulations involves some critical issues one is the grey area connecting the rans and les domains which induces the model stress depletion msd problem and results in a mismatch between the mean velocity profiles of the experiments and simulations the msd problem results in an underestimation of the mean skin friction on the wall the classic des model spalart et al 1997 was formulated to overcome the msd problem by using undated strategies called delayed des ddes spalart et al 2006 and improved ddes shur et al 2008 deck 2005 proposed the zdes to overcome the msd issue in a different way deck 2012 classified the typical flow problems into three categories and proposed different strategies for different geometries the purpose of the present study is to develop a zdes method for natural free surface flow simulations e g river flow this type of flow is constrained by a gentle bottom slope and the free surface suits best des mode iii as categorised by deck 2012 which is often recognised as the wmles mode for mode iii the switching from the rans mode to the les mode in the inner boundary layer occurs at a given altitude prescribed by the user the selection of the interface height has been investigated in a series of studies deck et al 2011 2014 laraufie and deck 2013 implementing advanced methodologies for wall turbulence simulations is still challenging and one of the issues is how to accelerate the generation of les content in the les domain using the rans field information to generate inflow data for the les domain is insufficient precursor calculations and recycling methods are acknowledged to be efficient in providing les content for inflow conditions however considering the complex geometry of most industrial simulations velocity fluctuations are expected to rely on synthetic turbulence generation one of the most advanced methods was proposed by jarrin et al 2006 then pamiès et al 2009 further extended the basic synthetic eddy method sem to generate near physical turbulence the generated velocity fluctuations are usually superimposed on the mean velocity as the inflow condition jarrin et al 2006 deck 2012 on the other hand the body forcing method allows the force to act directly on the flow and not only on the boundaries deck et al 2018 synthetic turbulence can be used to generate forcing fluctuations to trigger the equations to resolve large scale turbulence for example by synthesising body shear stresses davidson and billson 2006 the dynamic stochastic forcing method has been validated efficient for accelerating the transition from rans to les poimelli et al 2003 keating and piomelli 2006 although the body force generation methods are distinctly different sagaut et al 2013 most of the published methods have been applied in aerodynamic simulations but their application in water flows with a free surface is limited as previously mentioned a common river flow with a free surface can be classified as mode iii as proposed by deck 2012 the primary purpose of this study is to promote the advanced methodologies in practical hydraulic engineering where only a local domain is required to be simulated by les here a non hydrostatic shallow water flow model is extended to a zdes type model a new body force expression is proposed in the momentum equations the sem and formulation of the body force terms are first presented in section 2 the numerical model and relative higher order numerical scheme are outlined in section 3 in section 4 a very challenging test case i e full boundary layer flow over a flat plate is adopted to validate the numerical strategy furthermore another test case of a flow over a fixed dune is used to verify the model ability in simulating a common river flow with a local cavity finally the conclusions drawn are presented 2 generation of synthetic turbulent body force 2 1 sem a turbulent trigger module was developed and embedded into the present free surface shallow water flow numerical model first a series of time variant stochastic turbulent velocities were numerically generated then the generated turbulent velocities were used to synthesise the body force as a dynamic forcing method the formulated synthetic body force terms were introduced into the momentum equations to trigger the les content jarrin et al 2006 proposed an sem in which coherent eddies were randomly generated both in time and space following this principle a stochastic signal was built for each velocity component with a given shape and prescribed reynolds stresses to create turbulent structures pamiès et al 2009 the velocity fluctuation is given by eq 1 and the cholesky decomposition a i j for a prescribed reynolds stress tensor r i j is provided in eq 2 1 u i x y z j 1 3 a i j u j x y z i 1 2 3 2 a r 11 0 0 r 21 a 11 r 22 a 21 2 0 r 31 a 11 r 32 a 21 a 31 a 22 r 33 a 31 2 a 32 2 where u j is a centred random sequence with unit variance and zero covariance the stochastic signal u j is normalised by a i j z to create a random velocity fluctuation the reynolds stress tensor r i j z which is obtained by a precursor numerical les method or extracted from rans simulations can be prescribed experimentally laraufie and deck 2013 deck et al 2018 in eq 1 x y and z are the spatial coordinates in the streamwise spanwise and vertical directions respectively the entire random signal u j is generated using eq 3 the details of the sem can be found in the study by jarrin et al 2006 and pamiès et al 2009 3 u j x y z p 1 p k 1 n p ε k ξ j p t t k l p t l p t φ j p y y k l p y ψ j p z z k l p z the three non dimensional functions in eq 3 are shape functions with the timescale and length scale assigned to each structure the expressions of the shape functions follow those of pamiès et al 2009 eq 3 slightly differs from that of pamiès et al 2009 in which the summations of the turbulent structures are averaged by a parameter n p analysis of the shape function in eq 3 indicates that a gaussian function is used the gaussian function defines the turbulent spot shape and the velocity at one selected point can be considered as the summation of all the induced velocities weighted by the gaussian shape function compared to random fluctuations the sem generates near physical stochastic signals of large scale energy containing structures 2 2 synthetic turbulent body forces in a common hybrid rans les model the les region is usually located downstream of the rans region and the interface plane is actually the inlet for the les computational domain the synthetic turbulent velocity is usually superimposed on the mean flow extracted from the rans calculation at the interface the instantaneous velocity is decomposed as follows 4 u i u i u i i 1 2 3 where u i is the mean velocity and u i is calculated using eq 1 a modified spatial filtering process is decomposed as 5 u i u j u i u i u j u j u i u j u i u j u j u i u i u j i j 1 2 3 in an arbitrary les model the last three terms on the right side of eq 5 are modelled as reynolds stresses the decomposed reynolds stresses can be formulated by using synthetic fluctuation velocities the newly formulated stresses are further added into the momentum equations as a body force to induce the les content davidson and billson 2006 proposed a method for calculating the body force at the interface between the rans and les regions in which only the term u i u j was synthesised and added to the control volume the newly formulated body force is validated in the test cases because the forcing term is added in a finite volume context the term for adding reynolds stresses in the momentum equation i i 1 2 3 i e in the x y and z coordinates respectively is integrated in the control volume digital spatial filtering as follows 6 f i v x j u i u j u j u i u i u j d v k 1 n s u i u j u j u i u i u f n j δ s k j 1 2 3 where δ s is the control volume surface area ns is the number of the control volume surfaces n j is the projection of the normal unit of surface k in j coordinate and f denotes the value of the control volume surface in the strategy proposed by davidson and billson 2006 only the third term u i u j in eq 6 was added to the discretised momentum equations considering the spatial filtering process of les the modified body forces are theoretically more complete test cases verify the performance of the modified body force used in the dynamic forcing method 3 implementation of zdes model 3 1 numerical model description the present in house code model hydroflow can numerically solve incompressible water flow equations based on combined horizontal unstructured grids and vertical layered grids in σ coordinate fig 1 the relationship between the σ and z coordinates is given by σ z ζ h ζ where z 0 is the still water level swl in the computational domain σ 0 refers to the free surface and σ 1 refers to the bottom the computational coordinate is efficient and accurate for fixing the temporally varying free surface and uneven bottom the full hydrodynamic model is extended from the well known shallow water equations based on the hydrostatic assumption by introducing a non hydrostatic pressure gradient into the momentum equations zhang et al 2014 2017 the extended model greatly widens the applicability when the hydrostatic assumption is invalid the governing equations are as follows 7 ζ t q x x q y y q σ σ 0 8 q x t q x u x q x v y q x ω σ g d ζ x d ρ 0 p n x x υ t q x x y υ t q x y 1 d σ υ t d q x σ d f x 9 q y t q y u x q y v y q y ω σ g d ζ y d ρ 0 p n y x υ t q y x y υ t q y y 1 d σ υ t d q y σ d f y 10 q z t q z u x q z v y q z ω σ 1 ρ 0 p n σ x υ t q z x y υ t q z y 1 d σ υ t d q z σ d f z where q x d u q y d v q z d w q σ d ω u v w are the respective velocities in the x y and z directions and ω is the vertical velocity in the σ coordinate framework the symbol d h ζ denotes the total water depth in which h is the still water depth and ζ is the free surface elevation the variable p n is the non hydrostatic pressure which differs from the hydrostatic pressure p h ρ g ζ z moreover g is the gravitational acceleration and υ is the molecular viscous coefficient the introduced vertical velocity in the σ coordinate is calculated as 11 q σ q z d q x d σ d x ζ x q y d σ d y ζ y σ d t ζ t the eddy viscosity υ t is determined using the one equation spalart allmaras turbulence model in which the advection and diffusion equation for the auxiliary variable υ is given by 12 d υ t d υ u x d υ v y d υ ω σ d c b 1 s υ d c w 1 f w υ d z d e s 2 1 σ x υ t υ d υ x y υ t υ d υ y d σ υ t υ d υ d σ c b 2 σ d υ x 2 d υ y 2 d υ d σ 2 the eddy viscosity υ t is calculated from υ using 13 υ t υ f v 1 where f v 1 χ 3 χ 3 c v 1 3 χ υ υ and υ is the molecular viscosity the function f w is calculated as f w g 1 c w 3 6 g 6 c w 3 6 1 6 with g r c w 2 r 6 r r υ s κ 2 d 2 s s υ κ 2 d 2 f v 2 and f v 2 1 χ 1 χ f v 1 here s is the magnitude of the strain rate tensor calculated as s 2 ω i j ω i j with ω i j 1 2 u i x j u j x i the constants in the above equations are c b 1 0 1355 σ 2 3 c b 2 0 622 κ 0 41 c w 1 c b 1 κ 2 1 c b 2 σ c w 2 0 3 c w 3 2 0 and c v 1 7 1 in eq 12 the length scale d z d e s in the destruction term is determined as the smaller value between the rans and les length scales the present study is only concerned with mode iii of the zdes proposed by deck 2012 which requires the definition of the interface altitude d w int e r f a c e in eq 14 14 d z d e s d z d e s i i i d w min d w c d e s δ i f d w d w interface o t h e r w i s e where δ δ x δ y δ z 1 3 c d e s 0 65 and d w is the distance to the nearest wall in the les domain i e d w d w interface the rans functions are modified as f v 1 1 f v 2 0 and f w 1 a series of second order total variation diminishing tvd schemes have been employed to discretise the convection terms of the governing equations the numerical details and validation of the model using the rans approach have been reported by zhang et al 2014 and zhang et al 2017 the established shallow water flow model based on des has been applied to open channel flow over dunes zhang et al 2015 flow through a cylinder patch zhang et al 2019 and free surface flow around dikes zhang et al 2020 in the above mentioned applications of des there are no synthetic eddies being fed into the les domain because of massive separation however as mentioned above numerical strategies are urgently required to overcome the msd problem when using the sem in open channel flow over a gentle bottom slope the present zdes strategy is based on the studies by deck 2012 and sagaut et al 2013 it is unrealistic to implement a full les of natural river flow with a free surface because of the excessive computational cost a zdes type model is practical because les is only required and implemented in a focused local domain in the present implementation strategy a local les region is embedded within a large rans domain synthetic turbulent fluctuations are generated and considered as the dynamic body force to induce the les content in the transitional zone 3 2 high order numerical scheme studies have validated the performance of high order numerical schemes for advanced numerical methodologies a high order numerical scheme based on structured meshes is relatively easy to implement with a lower computational cost however practical applications of high order methods require simulations to be implemented on unstructured meshes dumbser and kaser 2007 tsoutsanis et al 2011 2018 the meshes used in the present model are composed of a horizontal unstructured grid and a vertical structured grid fig 2 an efficient one dimensional 1d two dimensional 2d high order numerical scheme is proposed to discretise the governing equations in the vertical structured grid system an efficient fifth order weighted essentially non oscillatory weno scheme jiang and shu 1996 is employed on the horizontal unstructured grid a fifth order interpolation scheme that approximately follows the weno scheme is implemented it is worth noting that the mixed numerical scheme is only efficient and applicable for the present grid system fig 2 3 2 1 discretisation scheme on the horizontal plane on unstructured grids most weno schemes utilise a linear or non linear combination of various reconstruction polynomials from the central stencil and directional stencils dumbser and käser 2007 tsoutsanis et al 2011 2018 the numerical scheme order is achieved by extending the polynomials on a selected stencil to a higher order a similar method in the construction of polynomials from tsoutsanis et al 2018 was employed but with a simplified scheme in the stencil selection dumbser and käser 2007 noted that a central stencil is usually the best for smooth solutions a very large weighted coefficient was assigned for the polynomial based on the central stencil and the possibility of neglecting the directional stencil for smooth solutions was verified for popular open channel flows the flow discontinuity is unintended in the present numerical model only the central stencil is selected to construct a high order interpolation polynomial the proposed method cannot be called a weno type scheme because the conventional weighted combination of the polynomials from three stencils is simplified but it has a similar approach on the horizontal computational plane the union of all elements is represented as 15 γ ω i 1 i m t i where t i is the target element for reconstructing the flow variables in which index i ranges from 1 to the total number of elements im on one target element t m the following reconstruction stencil is adopted 16 s m n 1 n t j n where the central stencil contains n elements and j n is the mapping from the local index n to the global indexation of the elements in s m the first element in the stencil n 1 is the considered element t m i e j 1 m the number of reconstructed degrees of freedom in two dimensions is calculated as k 1 2 m 1 m 2 1 with the degree m of the polynomials the reconstruction procedure involves building a high order polynomial p x y such that it has the same cell averaged dummy variable φ x y in the target cell t m i e 17 φ m 1 t m t m φ x y d s 1 t m t m p x y d s to build up the polynomial the reconstruction procedure uses the cell averaged φ m on the target cell t m from the reconstructed central stencil s m composed of neighbouring n cells the reformulated polynomial function with order m is written as 18 p x y k 0 k α k ψ k x y φ 0 k 1 k α k ψ k x y the unknown degrees of freedom α k are determined by requiring the cell average of polynomial p x y to be equal to the cell average of variable φ j n for each cell t j n in stencil s m which is expressed as 19 φ j n 1 t j n t j n p x y d x d y φ m 1 t j n t j n k 1 k α k ψ k x y ⅆ x d y where φ m φ 0 on the target cell t m it is recommended to use more cells in the stencil to overcome the numerical instability and then a total of n 1 5 k neighbouring cells is used to construct the stencil in the present model the polynomial function is constructed by the following algebraic function 20 p x y φ m k 1 m a α 1 α 2 x x m α 1 y y m α 2 where α 1 α 2 k and x m y m is the centre coordinate of the target cell i e cell m for each cell t j n in the stencil the cell integration calculation in eq 19 is replaced by 21 t j n k 1 m a α 1 α 2 x x m α 1 y y m α 2 d x d y k 1 m a α 1 α 2 t j n x x m α 1 y y m α 2 d x d y considering a general integration t j n x x m α d a on a selected cell t j n we first rewrite the integrated function as x x m x x n x n x m x n x m 1 x x n x n x m where x x n x n x m 1 the coordinate x n y n is the centre of cell t j n in the stencil using the first order taylor expansion the integrated function is approximated as follows 22 x x m α x n x m α 1 x x n x n x m α x n x m α 1 α x x n x n x m furthermore the integrated function in eq 21 is approximated as 23 x x m α 1 y y m α 2 x n x m α 1 y n y m α 2 1 α 1 x x n x n x m 1 α 2 y y m y n y m x n x m α 1 y n y m α 2 1 α 1 x x n x n x m α 2 y y n y n y m α 1 α 2 x x n x n x m y y n y n y m substituting eq 23 into eq 21 the integration on cell t j n is calculated as follows t j n x x m α 1 y y m α 2 d x d y x n x m α 1 y n y m α 2 t j n i i i i i i i v d x d y considering a structured grid the integration t j n i i i i i i v d x d y is approximately equal to zero for a regular cell geometry however for a general unstructured grid the numerical integrations of terms ii iii and iv are not very efficient because of the irregular cell shape the above integration calculation depends on the cell geometry considering a circular cell ω j n with radius r of the same area i e ω j n t j n π r 2 the numerical integrations on the equivalent circular cell are calculated as ω j n i i d x d y 0 r 0 2 π α 1 r cos θ x n x m d r d θ α 1 x n x m 0 r 0 2 π r cos θ d r d θ 0 ω j n i i i d x d y ω j n α 2 y y n y n y m d x d y α 2 y n y m 0 r 0 2 π r sin θ d r d θ 0 ω j n i v d x d y ω j n α 1 α 2 x x n x n x m y y n y n y m d x d y α 1 α 2 x n x m y n y m 0 r 0 2 π r 2 cos θ sin θ d r d θ 0 it is commonly required that the geometry of the unstructured grid be as regular as possible to reduce numerical errors the integration t j n i i i i i i v d x d y is approximated as zero analysing the above numerical process the integration calculation aims to quantify the interpolation coefficients of the polynomial function 19 neglecting partial integrated functions can be remedied in the following process of fitting the interpolation coefficients the final integration of eq 21 is written as k 1 m a α 1 α 2 t j n x x m α 1 y y m α 2 d x d y k 1 m a α 1 α 2 x n x m α 1 y n y m α 2 t j n 24 by substituting the simplified calculation in eq 19 the cell averaged dummy variable is calculated as follows 25 φ m k 1 m a α 1 α 2 x n x m α 1 y n y m α 2 φ n n 1 n there are k unknown coefficients a α 1 α 2 in eq 25 however the number of elements n in the selected stencil is larger than k to avoid numerical instability because eq 25 becomes overdetermined with n k a least squares technique is employed to solve the unknown coefficients tsoutsanis et al 2018 a common expression of the governing equation of coefficients a α 1 α 2 is given by 26 a a b where matrix a is based on the selected stencil elements which are only calculated once and stored matrix a contains unknown coefficients in matrix form and b denotes the terms at the right side the above equation is solved to calculate the unknown variables in the following form 27 a a t a 1 a t b a qr decomposition based on the householder transformation is employed where the pseudo inverse is decomposed in an orthogonal matrix q and an upper triangular matrix r the term a t a in eq 27 is calculated as follows 28 a t a q r t q r r t r although the above high order interpolation scheme requires more computational cost the calculation is only performed once at the initialisation stage of the numerical simulation thus the computational cost increase is only slight as soon as the degrees of freedom a α 1 α 2 are calculated the corresponding reconstruction polynomials are given as 29 φ x φ m x m y m k 1 m a α 1 α 2 x x m α 1 y y m α 2 on the horizontal cell the general integration of a dummy variable φ along the border of target cell t m is written as 30 t m φ d l t m φ m x m y m k 1 m a α 1 α 2 x x m α 1 y y m α 2 d l where t m is the border of target horizontal cell t m to calculate the integration t m x x m α 1 y y m α 2 d l a locally transformed coordinate is introduced which is illustrated in fig 3 defining a temporary variable t 0 t the arbitrary coordinates x y are transformed into local coordinates x x 1 t sin α and y y 1 t cos α in the local coordinate frame vector n is the normal of the cell border and t is the length of the segment the start point x 1 y 1 and end point x 2 y 2 are indexed in an anticlockwise direction around the target cell centre the final calculation of t m x x m α 1 y y m α 2 d l proceeds in local coordinates as follows 31 t m x x m α 1 y y m α 2 d l s 1 n s t s m x x m α 1 y y m α 2 d l s s 1 n s 0 t s x 1 t sin α x m α 1 y 1 t cos α y m α 2 d t where ns is the number of segments constituting target cell t m eq 31 is further calculated by numerical schemes e g the legendre gauss integration method 3 3 weno scheme in the vertical plane the present numerical model employs a grid system composed of an unstructured horizontal mesh and a structured vertical mesh fig 2 the weno scheme based on a structured grid system is relatively simpler than that based on an unstructured grid system for a general 1d coordinate shown in fig 4 the target value f ˆ i 1 2 w e n o is reconstructed from the points in the stencils three stencils namely i 2 i 1 i i 1 i i 1 and i i 1 i 2 are used to construct the interpolation polynomial function a second order lagrange interpolation function is used as the polynomial function which is expressed as 32 p x m 1 3 n 1 n m 3 x x n x m x n φ m using the polynomial function a dummy variant φ at the interface point i 1 2 is formulated using 33 φ i 1 2 k p x i 1 2 m 1 3 n 1 n m 3 x i 1 2 x n k x m k x n k φ m k in eq 33 the superscript indexes the stencil order number k 1 2 3 and the subscript identifies the cell order 1 2 3 in the selected stencil k the reconstructed variant φ ˆ i 1 2 w e n o is finally composed of non linear weight coefficients ω k which are calculated as follows 34 φ ˆ i 1 2 w e n o k 1 3 ω k φ i 1 2 k the definition and calculation of the non linear weight coefficients ω k which are employed in this study had been adequately studied by jiang and shu 1996 in the present model both degrees of freedom for the horizontal discretisation scheme and vertical weno scheme are only calculated once before the program proceeds and saved in the computer memory the scheme is robust and the additional computational cost is not significant 4 results and discussion aiming at the primary motivation we applied the zdes model to a shallow water flow with only a local les domain embedded in a global rans domain two test cases were adopted to verify the numerical method the first test case is a fully developed flat plate turbulent boundary layer flow which is a very popular benchmark for advanced numerical schemes the second test case is shallow water flow over a fixed dune which is very common in natural river flows 4 1 model validation by simulating a fully developed flat plate turbulent boundary layer flow 4 1 1 test case implementation shallow water flow is typically restrained by a gentle bottom topography and varying free surface which approximates a boundary layer flow characterised by the water depth as the boundary layer height the flow over a flat plate is very challenging when focusing on the simulation of a small scale turbulent coherent structure the test case implemented a shallow water channel flow with a free surface and only a local region was modelled by les which is consistent with the purpose of this study the still water depth l was 5 cm and the channel length and width were 200 cm and 20 cm respectively a local les region with a length of 100 cm long was modelled with refined horizontal meshes fig 5 the turbulent flow might suffer from a delay in the formation of instabilities owing to the convection of eddy viscosity from the upstream rans region the test case can be considered as the most challenging benchmark for the zdes type method where no strong massive separation is induced by the local geometry i e mode iii proposed by deck 2012 in the rans mode the selected open channel flow was steady whereas the flow was unsteady in the les mode the computational domain was decomposed into rans regions upstream and downstream of the les region steady inflow and outflow conditions were specified at the inlet and outlet respectively there was no velocity fluctuation superimposed on the inflow velocity the synthetic eddies were fed within the transitional zone connecting the upstream rans and les regions the simulated fully developed turbulent flow in the les region was compared with the experimental data and published results to validate the proposed numerical method the friction velocity u τ τ w ρ was calculated to be approximately 0 012 m s 1 the reynolds number based on the momentum thickness θ and free stream velocity u 0 was calculated as re θ 1100 the grid nearest to the bottom in the wall normal direction was calculated as δ z 1 which is commonly required to satisfy the non slip solid wall boundary condition the spanwise grid was δ y 30 the normalised grid scale in the les region was calculated as δ x 60 and δ y 30 mode iii of zdes deck 2012 was implemented in the test case and the zonal strategy is depicted in fig 5 in the les region fig 5 the interface altitude d w int e r f a c e parallel to the bottom was prescribed in this test case the interface altitude d w int e r f a c e was fixed at 50 wall units deck et al 2011 numerically investigated the effect of the interface altitude including its contribution to the mean velocity profile skin friction and the calculated reynolds stresses the effect was not monotonous and depended on the grid resolution conversely fixing the interface altitude to a near inner layer position e g 50 wall units or an outer layer position e g 100 wall units would result in an intuitive reduction in the skin friction error deck et al 2014 thoroughly investigated the effect of the interface altitude on the simulation of a spatially developing flat plate turbulent boundary layer the results reveal that an interface altitude of 0 1 δ boundary layer height leads to the best estimation of the skin friction in their work a grid resolution of δ x 200 was used for test cases with different interface altitudes however the grid resolution was not fine enough to simulate the turbulent coherent structures in the near inner layer when the interface altitude was fixed at 50 wall units basically the lower the interface altitude the better the estimated turbulence but the skin friction is commonly underestimated nevertheless the accuracy depends on the grid resolution as distinctly revealed by the simulations performed by deck et al 2011 where the zdes approach with a classical grid resolution required by les provided the best results for shallow water flow the boundary layer height is near the water depth and a lower interface height is required to induce more les content the physical time step was set to 2 10 4 s which led to the criterion δ t u 2 δ t c f d υ 1 where u and υ are the friction velocity and kinematic viscosity respectively finally the simulation was initially proceeded until a statistical steady flow was obtained in the les region it lasted for approximately 15 large eddy turnover time h u τ to record the flow data for statistical analysis for the sem it is necessary to prescribe a target reynolds stress tensor r i j z and its cholesky decomposition a i j z eq 2 in this study the profile of a i j z for the flat plate boundary layer flow is consistent with that by pamiès et al 2009 4 2 validation of the numerical method two modifications of the sem in the literature were implemented in the present study in the revised eq 3 the normalisation parameter by pamiès et al 2009 is omitted the new formula can be validated by analysing the synthetic fluctuation velocity which should approximate the targets in eq 4 based on the concept of the method time series of synthetic streamwise fluctuation velocities calculated by the two formulas were recorded and statistically analysed fig 6 plots the records at three different water depths the synthetic fluctuation velocities obtained using eq 3 are significantly larger than those calculated using the formula by pamiès et al 2009 the peak value of the streamwise fluctuation velocity estimated by their formula is nearly less than 0 02 however a much higher fluctuation velocity magnitude was reported in their experiments and numerical simulations pamiès et al 2009 the statistical turbulent intensities estimated by the two methods are listed in table 1 which shows a good agreement between the values of the new formula and those reported by pamiès et al 2009 in addition to the quantitative comparison of the synthetic turbulent intensity the simulated vortical structures are helpful for evaluating the model performance fig 7 shows snapshots of the vortical structures simulated by the two formulas using the isosurface of q it is clear that the les content is underpredicted when the formula by pamiès et al 2009 is used and a much longer adaptation distance is observed in the present study the body forcing calculation in the sem is given by eq 6 the proposed method can be validated by comparing the simulated les content for the des type approach the suppression of les content is obviously severe which results in an underestimated wall friction and an altered log law velocity profile for a flat plane boundary layer flow in the following analysis the original approach is denoted as the partial stress mode psm whereas the updated approach is referred to as the full stress mode fsm for the psm only the forcing term u i u j in eq 6 is added to the momentum equation which nearly follows that of davidson and billson 2006 for the fsm all forcing terms in eq 6 are added to the momentum equations the dynamic forcing method for the hybrid rans les model was validated and highlighted by davidson and billson 2006 the present test case mainly focuses on the efficiency of the forcing terms for triggering turbulent fluctuations and reducing the adaptation distance the positive effect of the updated body force formulation can be intuitively identified using the modelled instantaneous vortical structures snapshots of the isosurface of q are displayed in fig 8 to validate the two forcing methods efficiently fig 8 a indicates a slowly developing turbulent flow downstream of the inlet of the les domain by the psm in comparison the fsm induces more intensive turbulence and distinctly shortens the adaptation distance fig 8 b after validating the new body forcing method only the fsm was adopted in the succeeding test cases because of the clear deficiency of the psm for the above validation of the new body forcing method high order numerical schemes were used for both the psm and fsm cases it is well known that high order numerical schemes are more accurate than lower order schemes in refined turbulent flow simulations the performance of the high order numerical scheme proposed in the present study was verified by carrying out an additional comparative test case using a second order osher tvd scheme fig 9 a shows a snapshot of the instantaneous vortical structures simulated using the second order scheme compared to the simulation with the high order scheme fig 9 b the les content is slightly underestimated which results in a longer adaptation distance for fully developing turbulence for the dynamic forcing method in the les type model the body force sources are commonly spread in a region downstream of the inlet in the present scheme the synthetic eddies are numerically generated in a vertical plane perpendicular to the streamwise flow i e the inlet of the les region to strongly induce turbulence the body forces are continuously fed within a region downstream of the rans domain into the les domain it is worth mentioning that the adaptation zone from rans to les can be shortened by extending the streamwise body force seeding region laraufie et al 2011 deck et al 2018 fig 10 b presents a snapshot of the instantaneous vortical structure identified by the isosurface of q using the fsm with a high order numerical scheme by specifying a longer eddy seeding zone the les content is intensively triggered and the adaptation distance is shortened compared with that by only introducing disturbance in a single inlet plane fig 10 a the isosurface of q can be efficiently used to intuitively identify the turbulent structures and roughly highlight the efficiency of the approaches in les content simulation the primary objective of the sem is to shorten the adaptation distance from rans to full les which is very critical for distinguishing the different approaches the fact that the skin friction on the wall is underestimated by les is well known and requires efficient strategies for reducing the simulation error fig 11 shows the skin friction coefficient errors estimated by different approaches where the skin friction coefficient estimated by rans is used to normalise the results the adaptation distance estimated by the psm is the longest among all test cases and the convergence is attained at 20h using the fsm the adaptation distance is significantly shortened which indicates a quicker development of the les content thus the high order numerical scheme is superior to the second order scheme in accelerating the les content evolution downstream of the inlet by comparing all test cases extending the dynamic forcing region results in the most accurate estimation of the skin friction with approximately 10 error and the shortest adaptation distance in fig 11 the results without the sem are not presented because of its clear deficiency in inducing the les content 4 3 validation using experimental data and published results the statistical flow variants were calculated for 15 large eddy turnover times h u τ after the initial transient period for a fully turbulent open channel flow the theoretical logarithmic law leads to a good streamwise velocity profile based on the water depth the simulated velocities at the centre of the les region were compared with the theoretical analysis to validate the numerical approach fig 12 exhibits a noticeable shift in the logarithmic law for the mean velocity profile without synthesised eddies fed into the les region it is evident that the simulations using the body forcing method result in a more accurate mean velocity profile in fig 12 the simulation results labelled as shorter zone show that only a single vertical plane is specified at the upstream interface between the rans and les regions the results labelled as longer zone indicate that an extended dynamic forcing length is specified downstream of the interface in this test case three parallel vertical planes composed the longer zone pamiès et al 2009 proposed the characteristic eddy scales for boundary layer flow the characteristic longitudinal length of eddies was considered as a reference for specifying the plane gap to avoid mutual disturbance from the synthetic eddies in the classification of typical flow problems by deck 2012 the flat plate boundary layer flow is the most challenging for the des type method and the dynamic forcing method is proved necessary in advanced numerical methodologies in the present test case the interface altitude above the bottom was fixed at z 50 beyond which the les mode was triggered the solved reynolds stresses in the rans region under the interface were underestimated compared to the published direct numerical simulation dns results and experimental results dashed lines in fig 13 the sums of the solved and modelled reynolds stresses coincide well with the published results solid lines in fig 13 the dns results spalart 1998 and experimental results de graaff and eaton 2000 naguib and hites 1995 confirm similar turbulence fluctuation profiles the present simulation estimates a reasonable distribution of the reynolds stresses compared with previously published results both the published simulation results and the experimental results are focused on the aerodynamic flat plate boundary layer flow under a zero pressure gradient in the present test case the open channel flow with a free surface behaves similarly to a boundary layer flow but the pressure gradient is not zero for a lower froude number flow the slope of the free surface is very small and the free surface effect can often be neglected it should be noted that the total water depth in this test case is only approximately 600 wall units which is not very deep the discrepancy between the present simulation results and those in the literature may be due to the influence of the free surface the sem has been validated to be necessary for les type simulations in a local domain the reliability of this numerical strategy can be further validated by analysing the spectral content of the velocity fluctuation the les filtering operation is actually affected by the mesh scale the implicit critical filtering scale was identified through an abrupt cutoff located near f c u c 2 δ x where u c is the local convection velocity and is represented by the inflow mean velocity the sampling frequency was then chosen according to the cutoff frequency to avoid insufficient temporal resolution of the signal records fig 14 illustrates the power spectrum of the velocity fluctuation at three altitudes i e z 30 100 and 500 although the gauge at z 30 was fixed under the interface the turbulence structures penetrated the interface into the rans domain overall the power spectra content reveals a fully developed turbulent boundary layer flow the sem and dynamic forcing strategy have been fully validated by the challenging boundary layer flow simulation in a natural river flow the sand bed slope is usually gentle and the flow is not massively separated as that of an almost attached boundary layer flow it is important to implement dynamic forcing to trigger the les type simulation especially by means of a near physical turbulent fluctuation generated by the sem to formulate the body forces 4 4 model verification by simulating shallow water flow over a local dune 4 4 1 test case implementation over a sharp step topography the massively separated flow is usually considered as a benchmark for numerical model validation in natural rivers the bottom sand dunes are commonly visible with milder undulations the insufficient les content from the upstream flow induces an inaccurate inflow condition for the simulation in the downstream les domain to promote the zdes type model in natural river flow simulations we specified a local les region embedded in the rans region this domain decomposition strategy is practical for large scale natural river flow simulations with a comprehensive consideration of the computational cost and simulation resolution in this test case the single dune geometry is the same as that in the experiments of balachandar et al 2002 the geometry of the dune is depicted in fig 15 the coordinate system was defined with x indicating the main stream direction y the spanwise direction and z the upward direction the reynolds number which was calculated based on the water depth and the free surface velocity at the inlet of the domain was 5 7 104 the froude number was 0 44 based on the same flow parameters the three dimensional domain covered the dune within a 400 mm long and 200 mm wide area the horizontal grid was uniform with a scale of 4 mm while the vertical grid was stretched from the bottom with a ratio of 1 05 until a nearly uniform grid in the three coordinate directions was attained the grid point nearest to the bottom was fixed at approximately 1 6z within the viscosity boundary layer the horizontal grid scale in the les domain was approximately δ x δ y 50 wall units the interface altitude was prescribed at 50 wall units the computational domain was extended upstream and downstream with a gradually enlarged grid length within the rans region fig 16 the physical time step was set as 1 10 4 s satisfying the criterion δ t u 2 δ t c f d υ 1 where u and υ are respectively the friction velocity and kinematic viscosity synthetic eddies were fed into the les region across the upstream interface in this test case only the new method and the high order numerical scheme were used with reference to the above boundary layer flow simulation 4 5 sem verification in the present test case the incoming open channel flow simulated by rans is steady and fully developed the les content must be superimposed on the rans content through the interface at x 1 h upstream of the dune crest the synthetic fluctuations were injected into the les domain using the dynamic forcing approach the target reynolds stress profile of a flat plate boundary layer flow was extracted from pamiès et al 2009 in the category proposed by deck 2012 it is unnecessary to numerically stimulate the les content evolution for massively separated flows induced by sharp geometries in the present test case there is a slope with a ratio of 1 2 in the local dune domain to validate the necessity of the sem a test case without the sem was carried out in addition to the simulation with the sem a global view of the turbulence evolution identified by an isosurface of q was established to validate the performance of the sem it is evident that the les content is weakly stimulated without the sem fig 17 a compared to the simulation with the sem fig 17 b the remarkable delay in the evolution of the les content leads to the well known result of an underestimated skin friction coefficient furthermore an insufficient les content results in unrealistic mean velocities i e an inaccurate mean flow structure fig 18 a displays an abnormally enlarged separation flow bubble in the test case without synthetic eddies fed into the les region in contrast fig 18 b shows a well predicted mean flow structure by simulation with the sem the comparison between the results with and without the sem highlighted the better performance of the sem and the dynamic forcing method the results revealed the importance of introducing synthetic eddies although the flow was massively separated by the sharp topography it is worth noting that this is not in conflict with the findings by deck 2012 first the present bottom geometry might not be very sharp to meet the conditions for type i or ii flow second the les region was extended upstream of the dune to eliminate the effect of numerical mode switching in practice the upstream flat plane boundary layer flow must be accurately simulated to provide an accurate inlet condition for the downstream les based on the experience of a flat plane boundary layer flow using the zdes implementing synthetic eddies is critical to ensure simulation accuracy in practice it is also necessary to push the interface between the rans and les far away from the key study area to eliminate the influence induced by the numerical mode switching the instantaneous spatial evolutions of the vortical structures and mean flow structures qualitatively highlight the performance of the sem and the dynamic forcing approach further quantitative validation of the model is presented in the next section 4 6 validation by experiments the above analysis has proved the importance of the sem and dynamic forcing approach for stimulating the les content in the following analysis only the simulation with the sem is further verified by experiments the flow signals during 15 large eddy turnover times l u τ were recorded to calculate the mean flow variables in the experiments six vertical lines were laid to measure the velocity fig 19 presents a comparison between the calculated streamwise velocity and the experimental data at the six selected streamwise locations i e x h 2 4 5 6 12 and 18 see also fig 15 the results without the sem clearly overpredicted the mean streamwise velocities above z 0 under z 0 particularly at x h 5 6 and 7 the simulated reverse velocities deviate noticeably from the experimental results in contrast the results with the sem agree well with the measurements the resolved reynolds stresses are commonly used to verify the model performance in predicting the les content fig 20 compares the calculated results against the experimental data at the selected measurement sites the flow passing through the dune crest exhibits a stronger shear flow which generates the most intensive turbulence the simulations with the sem indicate a better agreement between the reynolds stress profiles and the experimental results the simulations without the sem underpredicted the reynolds stresses compared with those using the sem both simulations with and without the sem underpredicted the peak value of the reynolds stress at x h 2 and 4 and significantly underestimated the reynolds stresses in the region above the dune crest i e z 0 referring to the physical experiments a series of 22 dunes were fixed and only the local flow field covering the 17th dune region was measured balachandar et al 2002 in the experiments the incoming flow gradually developed downstream of the first dune at the gauging sites a fully developed turbulence flow was obtained in a statistically steady state the local inflow injected into the 17th dune region should contain large scale eddies induced by the upstream dune topography in the present work the selected target reynolds stresses as the inflow condition for the les region are extracted from a flat plate boundary layer flow instead of the natural flows of the experiment in the literature an imposing periodic boundary condition method is usually adopted to achieve turbulent flow simulations yue et al 2005 2006 the outcomes may be due to the inflow boundary condition containing more natural turbulence information extracted from the downstream flow the sem in the present work used the target reynolds stresses of a flat plane boundary layer flow to synthesise the fluctuation velocity it is speculated that the selected target reynolds stress profiles will deviate from the experimental data arraying several dunes upstream of the concerned simulation region can be considered as a physical disturbance to induce turbulence instead of the numerical sem in this regard zhang et al 2015 implemented a des approach to simulate open channel flow over a series of dunes without synthetic eddies fed into the les domain the grid resolution was approximately δ x δ y 60 covering the dunes and a second order tvd scheme was adopted the grid resolution used by zhang et al 2015 is similar to that in the present work but the total number of grids is several times larger and the computational cost is certainly higher the modelled les content within the first dune zone was clearly insufficient however the turbulence was gradually triggered downstream fig 21 a in their simulation the upstream dunes acted as flow disturbance generators to stimulate the les content fed into the downstream dune zones fig 21 indicates that the les content triggered in a single dune region by the sem is comparable to those in the downstream zone of a series of dunes in the study by zhang et al 2015 fig 21 only presents a qualitative proof of the performance of the sem on les content resolution by identifying the vortical structures and quantitative validations are further revealed in fig 22 the published results of the reynolds stresses estimated by zhang et al 2015 are again plotted in fig 22 where the numerical results are extracted at the same gauging sites except in the last dune zone the results by zhang et al 2015 coincide better with the experimental data than the present results especially at z 0 the comparison implies that the upstream inflow by zhang et al 2015 contained much physical les content however the synthetic turbulence is numerically generated based on the prescribed targeted reynolds stresses of a flat plate boundary layer flow rather than natural flow the analysis again highlights the effect of the turbulence information contained in the inflow the strategy proposed by zhang et al 2015 is similar to that by deck et al 2018 i e inducing turbulence by physical disturbance the total number of grids used by zhang et al 2015 is approximately five times that of the present single dune simulation which results in a much higher computational cost the sem is efficient in providing turbulent inflow conditions at a lower computational cost and can distinctly promote the simulation accuracy improving the target reynolds stress profile may be practical for advancing the simulation which is another issue beyond the scope of the present work 5 conclusion the standard hybrid rans les approach performs poorly because the les content is severely suppressed owing to the insufficient turbulent content fed from the rans region into the les region to improve the performance of the hybrid model it is essential to feed the les content at the interface the more realistic the shape and scale distributions of the synthesised turbulent structures the shorter the adaptation distance the sem produces spatial and temporal correlations of fully developed turbulence compared to the random white noisy method and is especially practical and efficient for flows constrained by complex geometries against the cycling method using the synthesised turbulent velocity fluctuation to generate a body forcing term a new forcing method was proposed and validated the results showed a better performance of the les content development in the les domain downstream of the rans domain the present zdes model is extended from a non hydrostatic shallow water flow model currently the non hydrostatic model is mainly applied in water wave simulations in the rans mode because the main focus is on free surface flows on a larger spatial scale e g river flow the present work verified the applicability of the non hydrostatic model in investigating turbulent coherent structures using a numerical model it is expected to promote the application of the zdes approach for simulating shallow water flow with natural geometries credit authorship contribution statement jingxin zhang methodology software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was sponsored by the national key r d program of china no 2019yfb1503700 
20328,a zonal detached eddy simulation zdes is suitable for large scale open channel flows with a free surface e g river flow in zdes only a local region is required to be investigated using large eddy simulation les to obtain a high resolution of vortical structures in hydraulic engineering in this study a fully non hydrostatic free surface flow model is developed for a zdes type model the focus is to analyse the critical strategy of the turbulent forcing method which is very important for the zdes type model a well validated synthetic eddy method was established using a numerical framework and applied to generate velocity fluctuations based on the synthetic turbulent velocity a new formulation of the body force term was fed into the momentum equations a test case of a fully developed open channel flow with a free surface was used to verify the numerical strategy then another common flow problem of a free surface flow over a fixed dune was adopted to further validate the numerical approach the results show that the proposed numerical strategy can promote the application of the hybrid reynolds averaged navier stokes les method in natural large scale open channel flow simulation keywords hybrid rans and les zdes synthesised turbulence forcing term non hydrostatic model 1 introduction a sufficiently resolved large eddy simulation les without wall functions is important for investigating complex open channel flows with a free surface yue et al 2005 2006 2006 chou and fringer 2008 hinterberger et al 2007 2008 2008 garcia et al 2009 balen et al 2010 most of the studies focused on flows with experimental scales at low reynolds numbers the primary obstacle to practical les of natural water flows involving complex solid bottoms at high reynolds numbers is still the computational cost to reduce this cost wall modelled les wmles strategies are feasible because the near wall hydrodynamics are modelled instead of being resolved deck et al 2014 for natural river flows the horizontal scale is extremely large to fully implement the wmles and it requires hybrid reynolds averaged navier stokes rans les strategies to eliminate the prohibitive computational cost the present study is primarily concerned with the potential use of zonal detached eddy simulation zdes which is a type of hybrid rans les method in hydraulic engineering although the hybrid rans les method only the detached eddy simulation des type method is considered in this study is beneficial implementing advanced methodologies for turbulent flow simulations involves some critical issues one is the grey area connecting the rans and les domains which induces the model stress depletion msd problem and results in a mismatch between the mean velocity profiles of the experiments and simulations the msd problem results in an underestimation of the mean skin friction on the wall the classic des model spalart et al 1997 was formulated to overcome the msd problem by using undated strategies called delayed des ddes spalart et al 2006 and improved ddes shur et al 2008 deck 2005 proposed the zdes to overcome the msd issue in a different way deck 2012 classified the typical flow problems into three categories and proposed different strategies for different geometries the purpose of the present study is to develop a zdes method for natural free surface flow simulations e g river flow this type of flow is constrained by a gentle bottom slope and the free surface suits best des mode iii as categorised by deck 2012 which is often recognised as the wmles mode for mode iii the switching from the rans mode to the les mode in the inner boundary layer occurs at a given altitude prescribed by the user the selection of the interface height has been investigated in a series of studies deck et al 2011 2014 laraufie and deck 2013 implementing advanced methodologies for wall turbulence simulations is still challenging and one of the issues is how to accelerate the generation of les content in the les domain using the rans field information to generate inflow data for the les domain is insufficient precursor calculations and recycling methods are acknowledged to be efficient in providing les content for inflow conditions however considering the complex geometry of most industrial simulations velocity fluctuations are expected to rely on synthetic turbulence generation one of the most advanced methods was proposed by jarrin et al 2006 then pamiès et al 2009 further extended the basic synthetic eddy method sem to generate near physical turbulence the generated velocity fluctuations are usually superimposed on the mean velocity as the inflow condition jarrin et al 2006 deck 2012 on the other hand the body forcing method allows the force to act directly on the flow and not only on the boundaries deck et al 2018 synthetic turbulence can be used to generate forcing fluctuations to trigger the equations to resolve large scale turbulence for example by synthesising body shear stresses davidson and billson 2006 the dynamic stochastic forcing method has been validated efficient for accelerating the transition from rans to les poimelli et al 2003 keating and piomelli 2006 although the body force generation methods are distinctly different sagaut et al 2013 most of the published methods have been applied in aerodynamic simulations but their application in water flows with a free surface is limited as previously mentioned a common river flow with a free surface can be classified as mode iii as proposed by deck 2012 the primary purpose of this study is to promote the advanced methodologies in practical hydraulic engineering where only a local domain is required to be simulated by les here a non hydrostatic shallow water flow model is extended to a zdes type model a new body force expression is proposed in the momentum equations the sem and formulation of the body force terms are first presented in section 2 the numerical model and relative higher order numerical scheme are outlined in section 3 in section 4 a very challenging test case i e full boundary layer flow over a flat plate is adopted to validate the numerical strategy furthermore another test case of a flow over a fixed dune is used to verify the model ability in simulating a common river flow with a local cavity finally the conclusions drawn are presented 2 generation of synthetic turbulent body force 2 1 sem a turbulent trigger module was developed and embedded into the present free surface shallow water flow numerical model first a series of time variant stochastic turbulent velocities were numerically generated then the generated turbulent velocities were used to synthesise the body force as a dynamic forcing method the formulated synthetic body force terms were introduced into the momentum equations to trigger the les content jarrin et al 2006 proposed an sem in which coherent eddies were randomly generated both in time and space following this principle a stochastic signal was built for each velocity component with a given shape and prescribed reynolds stresses to create turbulent structures pamiès et al 2009 the velocity fluctuation is given by eq 1 and the cholesky decomposition a i j for a prescribed reynolds stress tensor r i j is provided in eq 2 1 u i x y z j 1 3 a i j u j x y z i 1 2 3 2 a r 11 0 0 r 21 a 11 r 22 a 21 2 0 r 31 a 11 r 32 a 21 a 31 a 22 r 33 a 31 2 a 32 2 where u j is a centred random sequence with unit variance and zero covariance the stochastic signal u j is normalised by a i j z to create a random velocity fluctuation the reynolds stress tensor r i j z which is obtained by a precursor numerical les method or extracted from rans simulations can be prescribed experimentally laraufie and deck 2013 deck et al 2018 in eq 1 x y and z are the spatial coordinates in the streamwise spanwise and vertical directions respectively the entire random signal u j is generated using eq 3 the details of the sem can be found in the study by jarrin et al 2006 and pamiès et al 2009 3 u j x y z p 1 p k 1 n p ε k ξ j p t t k l p t l p t φ j p y y k l p y ψ j p z z k l p z the three non dimensional functions in eq 3 are shape functions with the timescale and length scale assigned to each structure the expressions of the shape functions follow those of pamiès et al 2009 eq 3 slightly differs from that of pamiès et al 2009 in which the summations of the turbulent structures are averaged by a parameter n p analysis of the shape function in eq 3 indicates that a gaussian function is used the gaussian function defines the turbulent spot shape and the velocity at one selected point can be considered as the summation of all the induced velocities weighted by the gaussian shape function compared to random fluctuations the sem generates near physical stochastic signals of large scale energy containing structures 2 2 synthetic turbulent body forces in a common hybrid rans les model the les region is usually located downstream of the rans region and the interface plane is actually the inlet for the les computational domain the synthetic turbulent velocity is usually superimposed on the mean flow extracted from the rans calculation at the interface the instantaneous velocity is decomposed as follows 4 u i u i u i i 1 2 3 where u i is the mean velocity and u i is calculated using eq 1 a modified spatial filtering process is decomposed as 5 u i u j u i u i u j u j u i u j u i u j u j u i u i u j i j 1 2 3 in an arbitrary les model the last three terms on the right side of eq 5 are modelled as reynolds stresses the decomposed reynolds stresses can be formulated by using synthetic fluctuation velocities the newly formulated stresses are further added into the momentum equations as a body force to induce the les content davidson and billson 2006 proposed a method for calculating the body force at the interface between the rans and les regions in which only the term u i u j was synthesised and added to the control volume the newly formulated body force is validated in the test cases because the forcing term is added in a finite volume context the term for adding reynolds stresses in the momentum equation i i 1 2 3 i e in the x y and z coordinates respectively is integrated in the control volume digital spatial filtering as follows 6 f i v x j u i u j u j u i u i u j d v k 1 n s u i u j u j u i u i u f n j δ s k j 1 2 3 where δ s is the control volume surface area ns is the number of the control volume surfaces n j is the projection of the normal unit of surface k in j coordinate and f denotes the value of the control volume surface in the strategy proposed by davidson and billson 2006 only the third term u i u j in eq 6 was added to the discretised momentum equations considering the spatial filtering process of les the modified body forces are theoretically more complete test cases verify the performance of the modified body force used in the dynamic forcing method 3 implementation of zdes model 3 1 numerical model description the present in house code model hydroflow can numerically solve incompressible water flow equations based on combined horizontal unstructured grids and vertical layered grids in σ coordinate fig 1 the relationship between the σ and z coordinates is given by σ z ζ h ζ where z 0 is the still water level swl in the computational domain σ 0 refers to the free surface and σ 1 refers to the bottom the computational coordinate is efficient and accurate for fixing the temporally varying free surface and uneven bottom the full hydrodynamic model is extended from the well known shallow water equations based on the hydrostatic assumption by introducing a non hydrostatic pressure gradient into the momentum equations zhang et al 2014 2017 the extended model greatly widens the applicability when the hydrostatic assumption is invalid the governing equations are as follows 7 ζ t q x x q y y q σ σ 0 8 q x t q x u x q x v y q x ω σ g d ζ x d ρ 0 p n x x υ t q x x y υ t q x y 1 d σ υ t d q x σ d f x 9 q y t q y u x q y v y q y ω σ g d ζ y d ρ 0 p n y x υ t q y x y υ t q y y 1 d σ υ t d q y σ d f y 10 q z t q z u x q z v y q z ω σ 1 ρ 0 p n σ x υ t q z x y υ t q z y 1 d σ υ t d q z σ d f z where q x d u q y d v q z d w q σ d ω u v w are the respective velocities in the x y and z directions and ω is the vertical velocity in the σ coordinate framework the symbol d h ζ denotes the total water depth in which h is the still water depth and ζ is the free surface elevation the variable p n is the non hydrostatic pressure which differs from the hydrostatic pressure p h ρ g ζ z moreover g is the gravitational acceleration and υ is the molecular viscous coefficient the introduced vertical velocity in the σ coordinate is calculated as 11 q σ q z d q x d σ d x ζ x q y d σ d y ζ y σ d t ζ t the eddy viscosity υ t is determined using the one equation spalart allmaras turbulence model in which the advection and diffusion equation for the auxiliary variable υ is given by 12 d υ t d υ u x d υ v y d υ ω σ d c b 1 s υ d c w 1 f w υ d z d e s 2 1 σ x υ t υ d υ x y υ t υ d υ y d σ υ t υ d υ d σ c b 2 σ d υ x 2 d υ y 2 d υ d σ 2 the eddy viscosity υ t is calculated from υ using 13 υ t υ f v 1 where f v 1 χ 3 χ 3 c v 1 3 χ υ υ and υ is the molecular viscosity the function f w is calculated as f w g 1 c w 3 6 g 6 c w 3 6 1 6 with g r c w 2 r 6 r r υ s κ 2 d 2 s s υ κ 2 d 2 f v 2 and f v 2 1 χ 1 χ f v 1 here s is the magnitude of the strain rate tensor calculated as s 2 ω i j ω i j with ω i j 1 2 u i x j u j x i the constants in the above equations are c b 1 0 1355 σ 2 3 c b 2 0 622 κ 0 41 c w 1 c b 1 κ 2 1 c b 2 σ c w 2 0 3 c w 3 2 0 and c v 1 7 1 in eq 12 the length scale d z d e s in the destruction term is determined as the smaller value between the rans and les length scales the present study is only concerned with mode iii of the zdes proposed by deck 2012 which requires the definition of the interface altitude d w int e r f a c e in eq 14 14 d z d e s d z d e s i i i d w min d w c d e s δ i f d w d w interface o t h e r w i s e where δ δ x δ y δ z 1 3 c d e s 0 65 and d w is the distance to the nearest wall in the les domain i e d w d w interface the rans functions are modified as f v 1 1 f v 2 0 and f w 1 a series of second order total variation diminishing tvd schemes have been employed to discretise the convection terms of the governing equations the numerical details and validation of the model using the rans approach have been reported by zhang et al 2014 and zhang et al 2017 the established shallow water flow model based on des has been applied to open channel flow over dunes zhang et al 2015 flow through a cylinder patch zhang et al 2019 and free surface flow around dikes zhang et al 2020 in the above mentioned applications of des there are no synthetic eddies being fed into the les domain because of massive separation however as mentioned above numerical strategies are urgently required to overcome the msd problem when using the sem in open channel flow over a gentle bottom slope the present zdes strategy is based on the studies by deck 2012 and sagaut et al 2013 it is unrealistic to implement a full les of natural river flow with a free surface because of the excessive computational cost a zdes type model is practical because les is only required and implemented in a focused local domain in the present implementation strategy a local les region is embedded within a large rans domain synthetic turbulent fluctuations are generated and considered as the dynamic body force to induce the les content in the transitional zone 3 2 high order numerical scheme studies have validated the performance of high order numerical schemes for advanced numerical methodologies a high order numerical scheme based on structured meshes is relatively easy to implement with a lower computational cost however practical applications of high order methods require simulations to be implemented on unstructured meshes dumbser and kaser 2007 tsoutsanis et al 2011 2018 the meshes used in the present model are composed of a horizontal unstructured grid and a vertical structured grid fig 2 an efficient one dimensional 1d two dimensional 2d high order numerical scheme is proposed to discretise the governing equations in the vertical structured grid system an efficient fifth order weighted essentially non oscillatory weno scheme jiang and shu 1996 is employed on the horizontal unstructured grid a fifth order interpolation scheme that approximately follows the weno scheme is implemented it is worth noting that the mixed numerical scheme is only efficient and applicable for the present grid system fig 2 3 2 1 discretisation scheme on the horizontal plane on unstructured grids most weno schemes utilise a linear or non linear combination of various reconstruction polynomials from the central stencil and directional stencils dumbser and käser 2007 tsoutsanis et al 2011 2018 the numerical scheme order is achieved by extending the polynomials on a selected stencil to a higher order a similar method in the construction of polynomials from tsoutsanis et al 2018 was employed but with a simplified scheme in the stencil selection dumbser and käser 2007 noted that a central stencil is usually the best for smooth solutions a very large weighted coefficient was assigned for the polynomial based on the central stencil and the possibility of neglecting the directional stencil for smooth solutions was verified for popular open channel flows the flow discontinuity is unintended in the present numerical model only the central stencil is selected to construct a high order interpolation polynomial the proposed method cannot be called a weno type scheme because the conventional weighted combination of the polynomials from three stencils is simplified but it has a similar approach on the horizontal computational plane the union of all elements is represented as 15 γ ω i 1 i m t i where t i is the target element for reconstructing the flow variables in which index i ranges from 1 to the total number of elements im on one target element t m the following reconstruction stencil is adopted 16 s m n 1 n t j n where the central stencil contains n elements and j n is the mapping from the local index n to the global indexation of the elements in s m the first element in the stencil n 1 is the considered element t m i e j 1 m the number of reconstructed degrees of freedom in two dimensions is calculated as k 1 2 m 1 m 2 1 with the degree m of the polynomials the reconstruction procedure involves building a high order polynomial p x y such that it has the same cell averaged dummy variable φ x y in the target cell t m i e 17 φ m 1 t m t m φ x y d s 1 t m t m p x y d s to build up the polynomial the reconstruction procedure uses the cell averaged φ m on the target cell t m from the reconstructed central stencil s m composed of neighbouring n cells the reformulated polynomial function with order m is written as 18 p x y k 0 k α k ψ k x y φ 0 k 1 k α k ψ k x y the unknown degrees of freedom α k are determined by requiring the cell average of polynomial p x y to be equal to the cell average of variable φ j n for each cell t j n in stencil s m which is expressed as 19 φ j n 1 t j n t j n p x y d x d y φ m 1 t j n t j n k 1 k α k ψ k x y ⅆ x d y where φ m φ 0 on the target cell t m it is recommended to use more cells in the stencil to overcome the numerical instability and then a total of n 1 5 k neighbouring cells is used to construct the stencil in the present model the polynomial function is constructed by the following algebraic function 20 p x y φ m k 1 m a α 1 α 2 x x m α 1 y y m α 2 where α 1 α 2 k and x m y m is the centre coordinate of the target cell i e cell m for each cell t j n in the stencil the cell integration calculation in eq 19 is replaced by 21 t j n k 1 m a α 1 α 2 x x m α 1 y y m α 2 d x d y k 1 m a α 1 α 2 t j n x x m α 1 y y m α 2 d x d y considering a general integration t j n x x m α d a on a selected cell t j n we first rewrite the integrated function as x x m x x n x n x m x n x m 1 x x n x n x m where x x n x n x m 1 the coordinate x n y n is the centre of cell t j n in the stencil using the first order taylor expansion the integrated function is approximated as follows 22 x x m α x n x m α 1 x x n x n x m α x n x m α 1 α x x n x n x m furthermore the integrated function in eq 21 is approximated as 23 x x m α 1 y y m α 2 x n x m α 1 y n y m α 2 1 α 1 x x n x n x m 1 α 2 y y m y n y m x n x m α 1 y n y m α 2 1 α 1 x x n x n x m α 2 y y n y n y m α 1 α 2 x x n x n x m y y n y n y m substituting eq 23 into eq 21 the integration on cell t j n is calculated as follows t j n x x m α 1 y y m α 2 d x d y x n x m α 1 y n y m α 2 t j n i i i i i i i v d x d y considering a structured grid the integration t j n i i i i i i v d x d y is approximately equal to zero for a regular cell geometry however for a general unstructured grid the numerical integrations of terms ii iii and iv are not very efficient because of the irregular cell shape the above integration calculation depends on the cell geometry considering a circular cell ω j n with radius r of the same area i e ω j n t j n π r 2 the numerical integrations on the equivalent circular cell are calculated as ω j n i i d x d y 0 r 0 2 π α 1 r cos θ x n x m d r d θ α 1 x n x m 0 r 0 2 π r cos θ d r d θ 0 ω j n i i i d x d y ω j n α 2 y y n y n y m d x d y α 2 y n y m 0 r 0 2 π r sin θ d r d θ 0 ω j n i v d x d y ω j n α 1 α 2 x x n x n x m y y n y n y m d x d y α 1 α 2 x n x m y n y m 0 r 0 2 π r 2 cos θ sin θ d r d θ 0 it is commonly required that the geometry of the unstructured grid be as regular as possible to reduce numerical errors the integration t j n i i i i i i v d x d y is approximated as zero analysing the above numerical process the integration calculation aims to quantify the interpolation coefficients of the polynomial function 19 neglecting partial integrated functions can be remedied in the following process of fitting the interpolation coefficients the final integration of eq 21 is written as k 1 m a α 1 α 2 t j n x x m α 1 y y m α 2 d x d y k 1 m a α 1 α 2 x n x m α 1 y n y m α 2 t j n 24 by substituting the simplified calculation in eq 19 the cell averaged dummy variable is calculated as follows 25 φ m k 1 m a α 1 α 2 x n x m α 1 y n y m α 2 φ n n 1 n there are k unknown coefficients a α 1 α 2 in eq 25 however the number of elements n in the selected stencil is larger than k to avoid numerical instability because eq 25 becomes overdetermined with n k a least squares technique is employed to solve the unknown coefficients tsoutsanis et al 2018 a common expression of the governing equation of coefficients a α 1 α 2 is given by 26 a a b where matrix a is based on the selected stencil elements which are only calculated once and stored matrix a contains unknown coefficients in matrix form and b denotes the terms at the right side the above equation is solved to calculate the unknown variables in the following form 27 a a t a 1 a t b a qr decomposition based on the householder transformation is employed where the pseudo inverse is decomposed in an orthogonal matrix q and an upper triangular matrix r the term a t a in eq 27 is calculated as follows 28 a t a q r t q r r t r although the above high order interpolation scheme requires more computational cost the calculation is only performed once at the initialisation stage of the numerical simulation thus the computational cost increase is only slight as soon as the degrees of freedom a α 1 α 2 are calculated the corresponding reconstruction polynomials are given as 29 φ x φ m x m y m k 1 m a α 1 α 2 x x m α 1 y y m α 2 on the horizontal cell the general integration of a dummy variable φ along the border of target cell t m is written as 30 t m φ d l t m φ m x m y m k 1 m a α 1 α 2 x x m α 1 y y m α 2 d l where t m is the border of target horizontal cell t m to calculate the integration t m x x m α 1 y y m α 2 d l a locally transformed coordinate is introduced which is illustrated in fig 3 defining a temporary variable t 0 t the arbitrary coordinates x y are transformed into local coordinates x x 1 t sin α and y y 1 t cos α in the local coordinate frame vector n is the normal of the cell border and t is the length of the segment the start point x 1 y 1 and end point x 2 y 2 are indexed in an anticlockwise direction around the target cell centre the final calculation of t m x x m α 1 y y m α 2 d l proceeds in local coordinates as follows 31 t m x x m α 1 y y m α 2 d l s 1 n s t s m x x m α 1 y y m α 2 d l s s 1 n s 0 t s x 1 t sin α x m α 1 y 1 t cos α y m α 2 d t where ns is the number of segments constituting target cell t m eq 31 is further calculated by numerical schemes e g the legendre gauss integration method 3 3 weno scheme in the vertical plane the present numerical model employs a grid system composed of an unstructured horizontal mesh and a structured vertical mesh fig 2 the weno scheme based on a structured grid system is relatively simpler than that based on an unstructured grid system for a general 1d coordinate shown in fig 4 the target value f ˆ i 1 2 w e n o is reconstructed from the points in the stencils three stencils namely i 2 i 1 i i 1 i i 1 and i i 1 i 2 are used to construct the interpolation polynomial function a second order lagrange interpolation function is used as the polynomial function which is expressed as 32 p x m 1 3 n 1 n m 3 x x n x m x n φ m using the polynomial function a dummy variant φ at the interface point i 1 2 is formulated using 33 φ i 1 2 k p x i 1 2 m 1 3 n 1 n m 3 x i 1 2 x n k x m k x n k φ m k in eq 33 the superscript indexes the stencil order number k 1 2 3 and the subscript identifies the cell order 1 2 3 in the selected stencil k the reconstructed variant φ ˆ i 1 2 w e n o is finally composed of non linear weight coefficients ω k which are calculated as follows 34 φ ˆ i 1 2 w e n o k 1 3 ω k φ i 1 2 k the definition and calculation of the non linear weight coefficients ω k which are employed in this study had been adequately studied by jiang and shu 1996 in the present model both degrees of freedom for the horizontal discretisation scheme and vertical weno scheme are only calculated once before the program proceeds and saved in the computer memory the scheme is robust and the additional computational cost is not significant 4 results and discussion aiming at the primary motivation we applied the zdes model to a shallow water flow with only a local les domain embedded in a global rans domain two test cases were adopted to verify the numerical method the first test case is a fully developed flat plate turbulent boundary layer flow which is a very popular benchmark for advanced numerical schemes the second test case is shallow water flow over a fixed dune which is very common in natural river flows 4 1 model validation by simulating a fully developed flat plate turbulent boundary layer flow 4 1 1 test case implementation shallow water flow is typically restrained by a gentle bottom topography and varying free surface which approximates a boundary layer flow characterised by the water depth as the boundary layer height the flow over a flat plate is very challenging when focusing on the simulation of a small scale turbulent coherent structure the test case implemented a shallow water channel flow with a free surface and only a local region was modelled by les which is consistent with the purpose of this study the still water depth l was 5 cm and the channel length and width were 200 cm and 20 cm respectively a local les region with a length of 100 cm long was modelled with refined horizontal meshes fig 5 the turbulent flow might suffer from a delay in the formation of instabilities owing to the convection of eddy viscosity from the upstream rans region the test case can be considered as the most challenging benchmark for the zdes type method where no strong massive separation is induced by the local geometry i e mode iii proposed by deck 2012 in the rans mode the selected open channel flow was steady whereas the flow was unsteady in the les mode the computational domain was decomposed into rans regions upstream and downstream of the les region steady inflow and outflow conditions were specified at the inlet and outlet respectively there was no velocity fluctuation superimposed on the inflow velocity the synthetic eddies were fed within the transitional zone connecting the upstream rans and les regions the simulated fully developed turbulent flow in the les region was compared with the experimental data and published results to validate the proposed numerical method the friction velocity u τ τ w ρ was calculated to be approximately 0 012 m s 1 the reynolds number based on the momentum thickness θ and free stream velocity u 0 was calculated as re θ 1100 the grid nearest to the bottom in the wall normal direction was calculated as δ z 1 which is commonly required to satisfy the non slip solid wall boundary condition the spanwise grid was δ y 30 the normalised grid scale in the les region was calculated as δ x 60 and δ y 30 mode iii of zdes deck 2012 was implemented in the test case and the zonal strategy is depicted in fig 5 in the les region fig 5 the interface altitude d w int e r f a c e parallel to the bottom was prescribed in this test case the interface altitude d w int e r f a c e was fixed at 50 wall units deck et al 2011 numerically investigated the effect of the interface altitude including its contribution to the mean velocity profile skin friction and the calculated reynolds stresses the effect was not monotonous and depended on the grid resolution conversely fixing the interface altitude to a near inner layer position e g 50 wall units or an outer layer position e g 100 wall units would result in an intuitive reduction in the skin friction error deck et al 2014 thoroughly investigated the effect of the interface altitude on the simulation of a spatially developing flat plate turbulent boundary layer the results reveal that an interface altitude of 0 1 δ boundary layer height leads to the best estimation of the skin friction in their work a grid resolution of δ x 200 was used for test cases with different interface altitudes however the grid resolution was not fine enough to simulate the turbulent coherent structures in the near inner layer when the interface altitude was fixed at 50 wall units basically the lower the interface altitude the better the estimated turbulence but the skin friction is commonly underestimated nevertheless the accuracy depends on the grid resolution as distinctly revealed by the simulations performed by deck et al 2011 where the zdes approach with a classical grid resolution required by les provided the best results for shallow water flow the boundary layer height is near the water depth and a lower interface height is required to induce more les content the physical time step was set to 2 10 4 s which led to the criterion δ t u 2 δ t c f d υ 1 where u and υ are the friction velocity and kinematic viscosity respectively finally the simulation was initially proceeded until a statistical steady flow was obtained in the les region it lasted for approximately 15 large eddy turnover time h u τ to record the flow data for statistical analysis for the sem it is necessary to prescribe a target reynolds stress tensor r i j z and its cholesky decomposition a i j z eq 2 in this study the profile of a i j z for the flat plate boundary layer flow is consistent with that by pamiès et al 2009 4 2 validation of the numerical method two modifications of the sem in the literature were implemented in the present study in the revised eq 3 the normalisation parameter by pamiès et al 2009 is omitted the new formula can be validated by analysing the synthetic fluctuation velocity which should approximate the targets in eq 4 based on the concept of the method time series of synthetic streamwise fluctuation velocities calculated by the two formulas were recorded and statistically analysed fig 6 plots the records at three different water depths the synthetic fluctuation velocities obtained using eq 3 are significantly larger than those calculated using the formula by pamiès et al 2009 the peak value of the streamwise fluctuation velocity estimated by their formula is nearly less than 0 02 however a much higher fluctuation velocity magnitude was reported in their experiments and numerical simulations pamiès et al 2009 the statistical turbulent intensities estimated by the two methods are listed in table 1 which shows a good agreement between the values of the new formula and those reported by pamiès et al 2009 in addition to the quantitative comparison of the synthetic turbulent intensity the simulated vortical structures are helpful for evaluating the model performance fig 7 shows snapshots of the vortical structures simulated by the two formulas using the isosurface of q it is clear that the les content is underpredicted when the formula by pamiès et al 2009 is used and a much longer adaptation distance is observed in the present study the body forcing calculation in the sem is given by eq 6 the proposed method can be validated by comparing the simulated les content for the des type approach the suppression of les content is obviously severe which results in an underestimated wall friction and an altered log law velocity profile for a flat plane boundary layer flow in the following analysis the original approach is denoted as the partial stress mode psm whereas the updated approach is referred to as the full stress mode fsm for the psm only the forcing term u i u j in eq 6 is added to the momentum equation which nearly follows that of davidson and billson 2006 for the fsm all forcing terms in eq 6 are added to the momentum equations the dynamic forcing method for the hybrid rans les model was validated and highlighted by davidson and billson 2006 the present test case mainly focuses on the efficiency of the forcing terms for triggering turbulent fluctuations and reducing the adaptation distance the positive effect of the updated body force formulation can be intuitively identified using the modelled instantaneous vortical structures snapshots of the isosurface of q are displayed in fig 8 to validate the two forcing methods efficiently fig 8 a indicates a slowly developing turbulent flow downstream of the inlet of the les domain by the psm in comparison the fsm induces more intensive turbulence and distinctly shortens the adaptation distance fig 8 b after validating the new body forcing method only the fsm was adopted in the succeeding test cases because of the clear deficiency of the psm for the above validation of the new body forcing method high order numerical schemes were used for both the psm and fsm cases it is well known that high order numerical schemes are more accurate than lower order schemes in refined turbulent flow simulations the performance of the high order numerical scheme proposed in the present study was verified by carrying out an additional comparative test case using a second order osher tvd scheme fig 9 a shows a snapshot of the instantaneous vortical structures simulated using the second order scheme compared to the simulation with the high order scheme fig 9 b the les content is slightly underestimated which results in a longer adaptation distance for fully developing turbulence for the dynamic forcing method in the les type model the body force sources are commonly spread in a region downstream of the inlet in the present scheme the synthetic eddies are numerically generated in a vertical plane perpendicular to the streamwise flow i e the inlet of the les region to strongly induce turbulence the body forces are continuously fed within a region downstream of the rans domain into the les domain it is worth mentioning that the adaptation zone from rans to les can be shortened by extending the streamwise body force seeding region laraufie et al 2011 deck et al 2018 fig 10 b presents a snapshot of the instantaneous vortical structure identified by the isosurface of q using the fsm with a high order numerical scheme by specifying a longer eddy seeding zone the les content is intensively triggered and the adaptation distance is shortened compared with that by only introducing disturbance in a single inlet plane fig 10 a the isosurface of q can be efficiently used to intuitively identify the turbulent structures and roughly highlight the efficiency of the approaches in les content simulation the primary objective of the sem is to shorten the adaptation distance from rans to full les which is very critical for distinguishing the different approaches the fact that the skin friction on the wall is underestimated by les is well known and requires efficient strategies for reducing the simulation error fig 11 shows the skin friction coefficient errors estimated by different approaches where the skin friction coefficient estimated by rans is used to normalise the results the adaptation distance estimated by the psm is the longest among all test cases and the convergence is attained at 20h using the fsm the adaptation distance is significantly shortened which indicates a quicker development of the les content thus the high order numerical scheme is superior to the second order scheme in accelerating the les content evolution downstream of the inlet by comparing all test cases extending the dynamic forcing region results in the most accurate estimation of the skin friction with approximately 10 error and the shortest adaptation distance in fig 11 the results without the sem are not presented because of its clear deficiency in inducing the les content 4 3 validation using experimental data and published results the statistical flow variants were calculated for 15 large eddy turnover times h u τ after the initial transient period for a fully turbulent open channel flow the theoretical logarithmic law leads to a good streamwise velocity profile based on the water depth the simulated velocities at the centre of the les region were compared with the theoretical analysis to validate the numerical approach fig 12 exhibits a noticeable shift in the logarithmic law for the mean velocity profile without synthesised eddies fed into the les region it is evident that the simulations using the body forcing method result in a more accurate mean velocity profile in fig 12 the simulation results labelled as shorter zone show that only a single vertical plane is specified at the upstream interface between the rans and les regions the results labelled as longer zone indicate that an extended dynamic forcing length is specified downstream of the interface in this test case three parallel vertical planes composed the longer zone pamiès et al 2009 proposed the characteristic eddy scales for boundary layer flow the characteristic longitudinal length of eddies was considered as a reference for specifying the plane gap to avoid mutual disturbance from the synthetic eddies in the classification of typical flow problems by deck 2012 the flat plate boundary layer flow is the most challenging for the des type method and the dynamic forcing method is proved necessary in advanced numerical methodologies in the present test case the interface altitude above the bottom was fixed at z 50 beyond which the les mode was triggered the solved reynolds stresses in the rans region under the interface were underestimated compared to the published direct numerical simulation dns results and experimental results dashed lines in fig 13 the sums of the solved and modelled reynolds stresses coincide well with the published results solid lines in fig 13 the dns results spalart 1998 and experimental results de graaff and eaton 2000 naguib and hites 1995 confirm similar turbulence fluctuation profiles the present simulation estimates a reasonable distribution of the reynolds stresses compared with previously published results both the published simulation results and the experimental results are focused on the aerodynamic flat plate boundary layer flow under a zero pressure gradient in the present test case the open channel flow with a free surface behaves similarly to a boundary layer flow but the pressure gradient is not zero for a lower froude number flow the slope of the free surface is very small and the free surface effect can often be neglected it should be noted that the total water depth in this test case is only approximately 600 wall units which is not very deep the discrepancy between the present simulation results and those in the literature may be due to the influence of the free surface the sem has been validated to be necessary for les type simulations in a local domain the reliability of this numerical strategy can be further validated by analysing the spectral content of the velocity fluctuation the les filtering operation is actually affected by the mesh scale the implicit critical filtering scale was identified through an abrupt cutoff located near f c u c 2 δ x where u c is the local convection velocity and is represented by the inflow mean velocity the sampling frequency was then chosen according to the cutoff frequency to avoid insufficient temporal resolution of the signal records fig 14 illustrates the power spectrum of the velocity fluctuation at three altitudes i e z 30 100 and 500 although the gauge at z 30 was fixed under the interface the turbulence structures penetrated the interface into the rans domain overall the power spectra content reveals a fully developed turbulent boundary layer flow the sem and dynamic forcing strategy have been fully validated by the challenging boundary layer flow simulation in a natural river flow the sand bed slope is usually gentle and the flow is not massively separated as that of an almost attached boundary layer flow it is important to implement dynamic forcing to trigger the les type simulation especially by means of a near physical turbulent fluctuation generated by the sem to formulate the body forces 4 4 model verification by simulating shallow water flow over a local dune 4 4 1 test case implementation over a sharp step topography the massively separated flow is usually considered as a benchmark for numerical model validation in natural rivers the bottom sand dunes are commonly visible with milder undulations the insufficient les content from the upstream flow induces an inaccurate inflow condition for the simulation in the downstream les domain to promote the zdes type model in natural river flow simulations we specified a local les region embedded in the rans region this domain decomposition strategy is practical for large scale natural river flow simulations with a comprehensive consideration of the computational cost and simulation resolution in this test case the single dune geometry is the same as that in the experiments of balachandar et al 2002 the geometry of the dune is depicted in fig 15 the coordinate system was defined with x indicating the main stream direction y the spanwise direction and z the upward direction the reynolds number which was calculated based on the water depth and the free surface velocity at the inlet of the domain was 5 7 104 the froude number was 0 44 based on the same flow parameters the three dimensional domain covered the dune within a 400 mm long and 200 mm wide area the horizontal grid was uniform with a scale of 4 mm while the vertical grid was stretched from the bottom with a ratio of 1 05 until a nearly uniform grid in the three coordinate directions was attained the grid point nearest to the bottom was fixed at approximately 1 6z within the viscosity boundary layer the horizontal grid scale in the les domain was approximately δ x δ y 50 wall units the interface altitude was prescribed at 50 wall units the computational domain was extended upstream and downstream with a gradually enlarged grid length within the rans region fig 16 the physical time step was set as 1 10 4 s satisfying the criterion δ t u 2 δ t c f d υ 1 where u and υ are respectively the friction velocity and kinematic viscosity synthetic eddies were fed into the les region across the upstream interface in this test case only the new method and the high order numerical scheme were used with reference to the above boundary layer flow simulation 4 5 sem verification in the present test case the incoming open channel flow simulated by rans is steady and fully developed the les content must be superimposed on the rans content through the interface at x 1 h upstream of the dune crest the synthetic fluctuations were injected into the les domain using the dynamic forcing approach the target reynolds stress profile of a flat plate boundary layer flow was extracted from pamiès et al 2009 in the category proposed by deck 2012 it is unnecessary to numerically stimulate the les content evolution for massively separated flows induced by sharp geometries in the present test case there is a slope with a ratio of 1 2 in the local dune domain to validate the necessity of the sem a test case without the sem was carried out in addition to the simulation with the sem a global view of the turbulence evolution identified by an isosurface of q was established to validate the performance of the sem it is evident that the les content is weakly stimulated without the sem fig 17 a compared to the simulation with the sem fig 17 b the remarkable delay in the evolution of the les content leads to the well known result of an underestimated skin friction coefficient furthermore an insufficient les content results in unrealistic mean velocities i e an inaccurate mean flow structure fig 18 a displays an abnormally enlarged separation flow bubble in the test case without synthetic eddies fed into the les region in contrast fig 18 b shows a well predicted mean flow structure by simulation with the sem the comparison between the results with and without the sem highlighted the better performance of the sem and the dynamic forcing method the results revealed the importance of introducing synthetic eddies although the flow was massively separated by the sharp topography it is worth noting that this is not in conflict with the findings by deck 2012 first the present bottom geometry might not be very sharp to meet the conditions for type i or ii flow second the les region was extended upstream of the dune to eliminate the effect of numerical mode switching in practice the upstream flat plane boundary layer flow must be accurately simulated to provide an accurate inlet condition for the downstream les based on the experience of a flat plane boundary layer flow using the zdes implementing synthetic eddies is critical to ensure simulation accuracy in practice it is also necessary to push the interface between the rans and les far away from the key study area to eliminate the influence induced by the numerical mode switching the instantaneous spatial evolutions of the vortical structures and mean flow structures qualitatively highlight the performance of the sem and the dynamic forcing approach further quantitative validation of the model is presented in the next section 4 6 validation by experiments the above analysis has proved the importance of the sem and dynamic forcing approach for stimulating the les content in the following analysis only the simulation with the sem is further verified by experiments the flow signals during 15 large eddy turnover times l u τ were recorded to calculate the mean flow variables in the experiments six vertical lines were laid to measure the velocity fig 19 presents a comparison between the calculated streamwise velocity and the experimental data at the six selected streamwise locations i e x h 2 4 5 6 12 and 18 see also fig 15 the results without the sem clearly overpredicted the mean streamwise velocities above z 0 under z 0 particularly at x h 5 6 and 7 the simulated reverse velocities deviate noticeably from the experimental results in contrast the results with the sem agree well with the measurements the resolved reynolds stresses are commonly used to verify the model performance in predicting the les content fig 20 compares the calculated results against the experimental data at the selected measurement sites the flow passing through the dune crest exhibits a stronger shear flow which generates the most intensive turbulence the simulations with the sem indicate a better agreement between the reynolds stress profiles and the experimental results the simulations without the sem underpredicted the reynolds stresses compared with those using the sem both simulations with and without the sem underpredicted the peak value of the reynolds stress at x h 2 and 4 and significantly underestimated the reynolds stresses in the region above the dune crest i e z 0 referring to the physical experiments a series of 22 dunes were fixed and only the local flow field covering the 17th dune region was measured balachandar et al 2002 in the experiments the incoming flow gradually developed downstream of the first dune at the gauging sites a fully developed turbulence flow was obtained in a statistically steady state the local inflow injected into the 17th dune region should contain large scale eddies induced by the upstream dune topography in the present work the selected target reynolds stresses as the inflow condition for the les region are extracted from a flat plate boundary layer flow instead of the natural flows of the experiment in the literature an imposing periodic boundary condition method is usually adopted to achieve turbulent flow simulations yue et al 2005 2006 the outcomes may be due to the inflow boundary condition containing more natural turbulence information extracted from the downstream flow the sem in the present work used the target reynolds stresses of a flat plane boundary layer flow to synthesise the fluctuation velocity it is speculated that the selected target reynolds stress profiles will deviate from the experimental data arraying several dunes upstream of the concerned simulation region can be considered as a physical disturbance to induce turbulence instead of the numerical sem in this regard zhang et al 2015 implemented a des approach to simulate open channel flow over a series of dunes without synthetic eddies fed into the les domain the grid resolution was approximately δ x δ y 60 covering the dunes and a second order tvd scheme was adopted the grid resolution used by zhang et al 2015 is similar to that in the present work but the total number of grids is several times larger and the computational cost is certainly higher the modelled les content within the first dune zone was clearly insufficient however the turbulence was gradually triggered downstream fig 21 a in their simulation the upstream dunes acted as flow disturbance generators to stimulate the les content fed into the downstream dune zones fig 21 indicates that the les content triggered in a single dune region by the sem is comparable to those in the downstream zone of a series of dunes in the study by zhang et al 2015 fig 21 only presents a qualitative proof of the performance of the sem on les content resolution by identifying the vortical structures and quantitative validations are further revealed in fig 22 the published results of the reynolds stresses estimated by zhang et al 2015 are again plotted in fig 22 where the numerical results are extracted at the same gauging sites except in the last dune zone the results by zhang et al 2015 coincide better with the experimental data than the present results especially at z 0 the comparison implies that the upstream inflow by zhang et al 2015 contained much physical les content however the synthetic turbulence is numerically generated based on the prescribed targeted reynolds stresses of a flat plate boundary layer flow rather than natural flow the analysis again highlights the effect of the turbulence information contained in the inflow the strategy proposed by zhang et al 2015 is similar to that by deck et al 2018 i e inducing turbulence by physical disturbance the total number of grids used by zhang et al 2015 is approximately five times that of the present single dune simulation which results in a much higher computational cost the sem is efficient in providing turbulent inflow conditions at a lower computational cost and can distinctly promote the simulation accuracy improving the target reynolds stress profile may be practical for advancing the simulation which is another issue beyond the scope of the present work 5 conclusion the standard hybrid rans les approach performs poorly because the les content is severely suppressed owing to the insufficient turbulent content fed from the rans region into the les region to improve the performance of the hybrid model it is essential to feed the les content at the interface the more realistic the shape and scale distributions of the synthesised turbulent structures the shorter the adaptation distance the sem produces spatial and temporal correlations of fully developed turbulence compared to the random white noisy method and is especially practical and efficient for flows constrained by complex geometries against the cycling method using the synthesised turbulent velocity fluctuation to generate a body forcing term a new forcing method was proposed and validated the results showed a better performance of the les content development in the les domain downstream of the rans domain the present zdes model is extended from a non hydrostatic shallow water flow model currently the non hydrostatic model is mainly applied in water wave simulations in the rans mode because the main focus is on free surface flows on a larger spatial scale e g river flow the present work verified the applicability of the non hydrostatic model in investigating turbulent coherent structures using a numerical model it is expected to promote the application of the zdes approach for simulating shallow water flow with natural geometries credit authorship contribution statement jingxin zhang methodology software writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was sponsored by the national key r d program of china no 2019yfb1503700 
20329,to investigate the influence of the flow pattern of the flow field on the resistance of a ship with a moonpool and the characteristics of the flow in the moonpool during smooth water navigation the star ccm software was used the calculation results were verified by the experimental data of the pool showing that the flow pattern of the moonpool has a great influence on the resistance performance of the ship with the moonpool the force and the flow field of the moonpool have a great nonlinear change in the process from transition state to turbulence state the flow in the moonpool also affects the forces on the hull the main factors of the resistance of the moonpool and the fluctuation of the flow field are the constant shedding of the vortex street at the front of the moonpool which causes the periodic change of the resistance of the moonpool and the phenomena of piston and sloshing the reynolds number is the key similarity number that determines the characteristics of the moonpool flow field and determines the flow pattern and vortex shedding law keywords moonpool smooth water resistance flow regime reynolds number 1 introduction moonpool is a vertical opening in the hull located near the mid ship that is frequently found in drilling ships and diving support vessels which offers protection from the environment during the retraction and discharge of several tools and vehicles into the water however since the increase of free liquid level and the decrease of profile smoothnessthe moonpool resulting from the setup of moonpool the resistance and seakeeping performance of the ship with moonpool are adversely affected the typical movements of the fluid in the moonpool include the vertical motion of the water column piston mode and the water movement in the longitudinal direction sloshing mode the movement of the vortex the rolling and breaking of the free surface and the vibration of the waves on the deck and hull may occur in the meantime several previous studies have focused on the influence of the moonpool on the ship s motion when the ship operates at zero speed in waves using various approaches such as experimental studies model tests theoretical studies and numerical simulations aalbers et al aalbers 1984 investigated the hydrodynamics of the moonpool and established a mathematical model that describes the relative water movement in the moonpool they obtained the empirical results with respect to the influence of the damping mechanisms and behaviour of the water column motion in contrast fukuda et al fukda 1977 studied the behaviour of the fluid in the moonpool and its effects on the motion of the ship through model tests under certain sets of conditions which were summarized as piston and sloshing motions moreover they have summarized the empirical equations of the natural period and amplitude of the moonpool oscillation molin et al molin 2001 used the linearized potential flow theory to derive the theoretical formulas for the natural frequencies of the piston modes and the sloth modes of the moonpool in two and three dimensions ravinthrakumar et al 2020 found out that the hydrodynamic coupling of the ship and the moonpool is highly dependent to the moonpool s volume relative to the submerged ship s volume using experimental studies and numerical calculations of the moonpool at different scales ommani et al 2018 used a finite volume solver with linearized boundary conditions to obtain the moonpool response under forced vertical motion in contrast it is also important to consider the influence of the fluid movement in the tank on the navigation resistance performance of the ship in the sailing state many scholars have studied the increase of the resistance caused by the lunar tank through model tests and numerical methods gatski et al gatski and speziale 1993 proposed an explicit algebraic stress model easm to simulate the free surface around the hull and proposed that the water movement in the moonpool would cause resonance when it reached the natural frequency ahmed et al ahmed and soares 2009 used potential flow and viscous flow finite volume methods to simulate the free surface flow of vlcc hull morphology and compared them with the existing results the geometry of the moonpool is one of the important parameters for the formation of the vortex hammargren et al törnblom and hammargren 2012 used open source software openfoam to simplify and simulate three dimensional flows with two dimensional flows and calculate the drag of the drillship with step moonpool huang et al 2016 used the computational fluid dynamics cfd software to calculate the resistance of the moonpool ship and provided some reference for the design of the moonpool through the analysis of the results van veer et al van t veer and tholen 2008 proposed an assumption that a linear relationship between the amplitude of the moonpool oscillation and the increase of the resistance exists based on the assumption and revealed experimental data a prediction model for the additional resistance of the moonpool in the piston and sloping oscillation modes was proposed it is necessary to improve the type of the lunar tank to reduce the increase of the resistance because the installation of the lunar tank worsens the resistance performance of the ship hendriks et al 2018 proposed the method of setting a cavity in front of the moonpool to slow down the flow and reduce the flow resistance of ships during navigation yang et al 2019 put forward the method of setting the inclined front wall of the moonpool and setting the concave structure behind the moonpool to reduce the resistance of ships during navigation sivabalan et al ponnappan et al 2018 calculated the flow field of the moonpool with different cross section forms through cfd and obtained the relationship between the resonance frequency of the moonpool and the shape of the moonpool in practical engineering practice the change of flow pattern especially the fluid change of model scale flow field is very common in the past studies although some conclusions have been obtained for the static water navigation resistance of ships with moonpool there are few studies on the influence of the flow regime on the resistance performance and flow characteristics of the moonpool however the influence of reynolds number on the moonpool resistance and flow characteristics is seldom studied because froude number is generally used in ship resistance experiments to plan the working conditions in this paper star ccm software is used to simulate the smooth water navigation process of the moonpool ship including steady calculation and unsteady calculation the influence of the moonpool on the ship resistance performance is obtained by analysing the resistance components and the relationship between the flow pattern of the flow field and the moonpool resistance increase is obtained by analysing the flow field data the fluctuation law of each phenomenon of moonpool flow is obtained through spectrum analysis of the time variation of flow field data finally the conclusion of this paper is summarized and the prospect of future research is proposed 2 introduction of models and working conditions the model used in this study is a deep sea drillship model with a moonpool in the middle as shown in fig 1 the dimensional parameters of the model are listed in table 1 in which l b is the ratio of the length and width of the model cb is the block coefficient cwp is the midship section coefficient lm is the length of the moonpool bm is the width of moonpool lfm is the length between the fore perpendicular and moonpool and lpp is the distance between the fore perpendicular and after perpendicular in this study we used the model with scale 1 60 both the experiments and calculations of the model are carried out according to the same froude number with equal spacing as the real ship working condition the specific working condition setting is shown in table 2 the equation of froude number f r is 1 f r v g l where v is the incoming flow velocity g is the gravitational acceleration and l is the characteristic length two models were used for the experiment and analysis in this study to study the influence of the moonpool structure on the ship s navigation the first model is named m1 which does not have a moonpool structure but has a completely closed hull and the second one is named m2 which has both the moonpool structure and a completely closed hull 3 numerical model and meshing 3 1 numerical model in this study the separation flow solver star ccm which is based on the finite volume method is used to simulate and analyse the static water navigation performance of the ship with moonpool the governing equation is solved by coupling based on pressure in which the convection term is spatially discretized using the second order upwind scheme and the dissipation term is spatially discretized using the second order central difference scheme the motion of an incompressible newtonian fluid satisfies the continuity equation and momentum conservation equation weiss and smith 1995 choi and sung 2009 2 ρ t ρ u i x i 0 3 ρ u i t x j ρ u i u j p x i x j μ u i x j ρ u i u j s j where u i is the time average of the velocity component i i a 1 2 3 u j is the time average of the velocity components j j 1 2 3 p is the time average of the pressure ρ is the fluid density μ is the dynamic viscosity coefficient ρ u i u j is the reynolds stress term and s j is the generalized source term of the momentum equation equations 2 and 3 are combined with the k ε turbulence model which is commonly used in simulating the flow characteristics of turbulent flow conditions in this study the volume of fluid vof method was used to capture the change in the water free surface hirt and nichols 1981 in which v is the designed calculation area v 1 is the volume of fluid 1 and v 2 is the volume of fluid 2 4 α x t δ 1 x v 1 δ 0 x v 2 for the flow field composed of two incompatible fluids α x t is satisfied by eq 5 in which 5 α t u α 0 where u u v w is the velocity field of the fluid moreover the vof function c i j k is defined as the integral of α x t on the grid cell divided by the cell volume 6 c i j k 1 δ v i j k i i j k α x t d v and meet 7 c t u c 0 using eq 7 when c 1 the grid is filled with fluid 1 when c 0 the mesh does not contain fluid 1 and when 0 c 1 the grid contains a free liquid level 3 2 establishment of the computing domain and partition of volume grid the drillship model employed in this study and the hull model were symmetrical to each other in the middle longitudinal section therefore the half ship was selected as the research object in the calculation domain the range of the calculation domain in the axial direction was 2 0 x 3 0 lpp the range of the calculation domain in the spanwise direction was 0 0 y 2 lpp and the range of the calculation domain in the vertical direction was 2 5 z 1 0 lpp see fig 2 for the diagram of the computing domain and its boundary in this study the mesh topology and refinement region of both the m1 and m2 are the same the star ccm software which was set in the meshing model of the drilling ship model for the surface remesher operation of the ship surface grid was used for all grid generation the surface remesher was used for the processing and generating of the surface triangulation of a high quality surface grid when the grid was ready the prism layer mesh was used in capturing the boundary layer on the surface of the model in which the y values of the surface is in the 30 to 60 range corresponding to the thickness of the first layer of the grid which is in the range of 0 8 1 mm castro et al 2011 when dividing the volume grid more grids are allocated in areas with a large flow field variation in addition the cfd mesh can be encrypted in different forms through different shaped volume control areas fig 3 shows the schematic of the different refinements in different areas of the drillship the hull refinement body is composed of four enciphers nearest near and far in contrast the surface refinement body consists of four enciphers coarse medium thin and finest meanwhile the kelvin wave refinement body consists of two enciphers far field and near field and the moonpool refinement bow refinement and stern refinement consist of a single encipher table 3 shows the proportion of the number of grids in each region the grids in all regions have overlapping parts fig 4 shows the distribution of the generated grid in the middle and longitudinal sections according to ittc recommendations a minimum of 20 grid points should be used in the vertical direction where the free surface is expected recommended procedu 2011a in this study approximately 30 40 grid points are present in the vertical direction of the wave position through the form of an encrypted grid in the free surface and the dissipation of wave height should be controlled 3 3 comparisons between the cfd results and test data on the model scale the finer the grid size is the more accurate the result is however the calculation time increases because of the large number of grid cells to be assessed therefore to determine the mesh size and mesh number with acceptable numerical accuracy the m2 model s f r 0 142 condition was selected to study the mesh convergence and the four grid schemes are based on improved proportions 2 celik et al 2008 the total number of grids and the calculated errors for each grid scheme are presented in table 4 and fig 5 the error is defined as r r t r t 100 where r is the total resistance of the model obtained by numerical calculation and r t is the total resistance obtained experimentally the measurements on this deep sea drillship model were provided by the marine design and research institute of china maric as shown in fig 5 further refinement for grids at grid3 results in a large increase in the number of cells resulting to the increase in the needed calculation time moreover it is apparent that there is no significant difference between schemes 3 and 4 therefore we have chosen grid3 as the optimal grid scheme 4 results and discussion of the stationary calculation 4 1 accuracy analysis of the steady resistance fig 6 a and b show the comparison of experimental and numerical calculation results for m1 and m2 models respectively in which the abscissa represents the froude number of the simulated working condition the blue curve represents the total resistance value of the model calculated numerically the red curve represents the total resistance value of the model tested in the pool with its corresponding ordinate shown on the left side and the green curve represents the relative error between the numerical calculated value and the experimental value of the pool with its corresponding ordinate shown on the right side as can be seen in the figure the resistance of the model increases as the froude number increases while the relative error between the numerically calculated value and the experimental value of the pool remains within a certain range among which the relative error of the m1 model is no more than 2 2 and that of the m2 model is no more than 4 1 therefore it can be considered that the numerical calculation results obtained from the numerical model and the meshing strategy are accurate 4 2 steady resistance data analysis fig 7 shows the comparison of the total resistance obtained between the m1 and m2 models in which the abscissa represents the froude number of the simulated working condition the red bar represents the total resistance of the m1 model the blue bar represents the total resistance of the m2 model with its corresponding ordinate shown on the left side and the green curve represents the increase in the drag ratio of the moonpool that is the percentage of drag increase of the moonpool model compared with that of the non moonpool model the equation is rm2 rm1 rm1 100 and the vertical coordinate corresponding to it is expressed on the right side as shown in fig 7 the total resistance of the ship model significantly increased after the moonpool structure was set when f r 0 077 the increase in the moonpool resistance is very small only 3 4 however when f r 0 098 the moonpool resistance significantly increased to 29 6 moreover it is worth noting that when the froude number is increased to 0 142 there is a negligible increase in the moonpool resistance and remained at approximately 30 however when f r 0 142 the moonpool resistance increased continuously resulting to an increase in the curvature of the curve and the ratio of the moonpool resistance in the cfd calculation the force of the hull and the moonpool structure can be monitored separately to analyse the influence of the moonpool on the resistance fig 8 compares the hull resistance of the drillship model with the moonpool resistance and the total resistance of m1 the abscissa represents the froude number of the simulated working condition the red bar represents the hull force of the m2 model the blue bar represents the moonpool force of the m2 model and the purple bar represents the total resistance value of the m1 model and its corresponding ordinate is expressed on the left side and the green curve represents the proportion of the moonpool force in the m2 total resistance the formula is rm rm2 100 where rm represents the moonpool resistance and the vertical coordinate corresponding to it is expressed on the right side as shown in fig 8 when the froude number increases from 0 077 to 0 120 the proportion of moonpool stress continues to increase reaching up to 38 6 in contrast when f r was increased from 0 120 to 0 142 the moonpool stress ratio dramatically decreased from 38 6 to 17 9 however when f r 0 142 the moonpool stress ratio continued to increase from 17 9 to 26 4 when f r 0 184 which was only slightly higher than the moonpool stress ratio 23 2 when f r 0 077 meanwhile the comparison between the hull force of the m2 model and the total resistance of the m1 model can also be seen in fig 8 because of the moonpool structure set at the bottom of the ship the lacking of bottom brings a wetted surface reduction to m2 the wetted surface difference between m1 and m2 is floor area of moonpool since it is at the bottom of the ship the bottom plate is only subject to the frictional resistance caused by fluid movement if the moonpool and the hull force are independent of each other since the setting of the moonpool structure has no effect on the hull force the hull force of the m2 model should be slightly smaller than the total resistance of the m1 model and only differs from the frictional resistance of the moonpool mouth as shown in fig 8 however this assumption is not met when the froude number increases from 0 077 to 0 120 the total resistance of the m1 model is slightly larger than that of the m2 model while the total resistance of the m1 model is slightly smaller than that of the m2 model when the froude number increases from 0 142 to 0 184 therefore the moonpool and force on the hull are not independent of each other and the setting of the moonpool structure has an impact on the force on the hull 4 3 steady flow field analysis and discussion as shown in figs 7 and 8 regardless of the increase in the ratio of the moonpool resistance the proportion of the moonpool force and the comparison between the total resistance of the m1 model and the hull force of the m2 model do not change linearly with the froude number there is one rule however when f r 0 077 0 120 and another when f r 0 141 0 184 the steady flow field is analysed below to explain this phenomenon fig 9 shows the wave making diagram of free liquid surface under various working conditions the upper part of each diagram is the wave making diagram of m1 and the lower part is the wave making diagram of m2 it can be seen that both m1 and m2 generate waves in the bow and the waves are at a kelvin angle with the direction of travel careful observation shows that when f r 0 077 0 120 the wave formation of m1 and m2 is consistent in the front part but inconsistent in the back part which is bounded by a straight line with the kelvin angle as the angle at the beginning of leading edge of the moonpool represented by the red dotted line in the figure the wave making of m1 is significantly different from that of m2 the wave making of the latter part of m2 almost disappears and no longer appears regular wave making when f r 0 141 0 184 the wave making of m1 and m2 is consistent in the anterior and posterior parts thus it can be seen that the flow in the moonpool will have an influence on the ship s wave making and the influence is significant when f r 0 077 0 120 which is consistent with the rule obtained from the resistance curve namely the flow state is different between f r 0 077 0 120 and f r 0 141 0 184 fig 10 shows the vorticity distribution at the bottom of the ship under various working conditions in the figure the middle longitudinal section is taken as the boundary and the calculated results of m1 and m2 are placed on both sides of the middle longitudinal section respectively for visual comparison the upper left part of the figure is the calculated results of m2 and the lower right part is the calculated results of m1 in the figure blue grey and white represents the free liquid surface the hull and the vortex defined by q criterion respectively the formula of q criterion is as follows 10 q 1 2 b f 2 a f 2 fig 9 also shows the isosurface of q at 10s 2 as shown in fig 10 the vorticity distribution of m1 is relatively small under each working condition which mainly consists of bilge vorticity wake vorticity and vorticity of the raised part of the hull shape the vorticity distribution of m2 is different owing to the influence of the structure of the moonpool a large number of vortexes were generated after the water passed through the moonpool and covered the hull hind by observing f r 0 077 0 120 it can be seen that vortexes flow out of the rear of the moonpool and cover the hull surface along a straight line with an angle of kelvin represented by the red dotted line in the figure these vortexes flowing out of the moonpool have a large range covering the entire hull behind and the intersection of the hull and the liquid level thus affecting the wave formation when f r 0 141 0 184 we can see that although the vortex also covers the rear of the hull the scope is obviously small it no longer covers the surface of the hull but partly covers the surface of the hull in the form of fine vortexes in addition the scope of the vortex at the intersection of the hull and the liquid level was small and its influence on wave formation was limited it can be seen from the results that the m2 model presents two different states in f r 0 077 0 120 and f r 0 141 0 184 in fluid mechanics there are two distinct states of fluid movement namely laminar flow and turbulence which can be transformed into each other from layer to turbulence transition by observing the flow field performance of the m2 model it can be seen that the entire flow field is relatively stable in the range of f r 0 141 0 184 and only slightly differs from that of m1 moreover with the increase in froude number the properties of the flow field follow a linear monotone rule however the m2 model is chaotic when f r 0 077 0 120 and its influence on the resistance and wave generation is greater than that between f r 0 141 0 184 during the transition from f r 0 077 0 120 to f r 0 141 0 184 the flow field morphology changed significantly therefore it can be concluded that the flow field is in a stable turbulent state when f r 0 141 0 184 in the range of f r 0 077 0 120 the flow field is in an unstable transition state to verify this point we examined the section near the wall of the bottom of the ship and observed the velocity cloud map at this interface as shown in fig 11 the colours in the figure represent the combined velocity near the wall of the bottom of the ship the right side is the bow direction and the water flows from right to left as can be seen from the figure the velocity distribution near the bottom of the ship is not uniform in the range of f r 0 077 0 120 and some local velocity extreme areas appear in front of the moonpool which is a turbulent spot structure the formation of turbulent patches indicates the transition state of flow field kachanov 1994 klebanoff et al 1962 with the increase in the froude number the turbulent spot structures mix with each other and eventually disappear and the velocity distribution tends to average the unevenness of the hull s transverse direction the longitudinal direction in the figure in the flow field is due to the influence of the hull s shape the whole process is a typical boundary layer transition on a plate which can confirm the correctness of the flow pattern of the flow field referring to problems of flows around a circular cylinder when entering the turbulent state the resistance coefficient of the object suddenly decreases to the minimum value and then continues to increase with an increase in the reynolds number this can explain the sudden change in the proportion curve of the moonpool force in fig 8 schlichting 1991 in the study of fluid flow state reynolds number is generally used to analyse and estimate the flow state when the reynolds number of flow field is less than the lower critical reynolds number the flow field is laminar when the reynolds number of the flow field is greater than the upper critical reynolds number the flow field is turbulent when the reynolds number of the flow field is between the lower critical reynolds number and the upper critical reynolds number the flow field is in a transition state the formula of reynolds number is 11 r e v l v the reynolds numbers corresponding to the working conditions in this study are listed in table 5 in this study the average interval froude number is used to set up the working condition because it belongs to the research of ship resistance in the case of the same scale both the froude number and reynolds number have a linear relationship with the inflow velocity therefore each working condition in this study also varies with the reynolds number of the average interval the reynolds number increases linearly with the increase in froude number and the flow field changes with the increase in reynolds number which is consistent with the research results of fluid flow pattern it can be inferred that reynolds number is a dimensionless number that determines the flow state and determines the state of the flow field and the resistance performance of the moonpool ship model of smooth water navigation in this study the lower critical reynolds number is less than 1 75 106 and the upper critical reynolds number is between 2 75 106 and 3 25 106 when f r 0 077 0 120 the reynolds number of the flow field is between the lower critical reynolds number and the upper critical reynolds number and is in the transition state when f r 0 141 0 184 the reynolds number of the flow field is greater than the upper critical reynolds number and it is in a turbulent state 4 4 size effects discussion because of the high cost of actual ship construction recent studies on ship resistance generally adopt the water tank test method or a numerical test of the ship model with a certain scale and the conversion of real ship resistance however because the exact similarity between the ship model and the real ship is not guaranteed the size effect will exist in the conversion process currently both the two dimensional conversion method based on froude s viewpoint and the three dimensional conversion method based on hughes s viewpoint require the same froude number for model ship and real ship recommended procedu 2011b therefore the research in this paper is also based on the same froude number in the above study it is concluded that reynolds number is similar to the number that plays a decisive role in the increase of the resistance of the moonpool structure if the scale conversion is carried out the size effect caused by viscosity will inevitably exist thus the feasibility of the two dimensional and three dimensional conversion methods is worth discussing we use the same mesh division method to carry out cfd calculation for m1 and m2 models with scale 1 40 and fr 0 163 at the same time the two dimensional and three dimensional conversion methods were used to convert the resistance of the model with scale 1 60 to a model with scale 1 40 and then compared with the cfd results the form factor of the three dimensional conversion method is obtained by prohaska method recommended procedu 2011b table 6 shows the comparison of the calculated data of the two scaling ratios here r60 represents the total resistance calculated by cfd with the scale 1 60 r40 represents the total resistance calculated by cfd with the scale 1 60 r40 2 represents the total resistance calculated by two dimensional conversion method with a scale 1 40 r40 3 represents the total resistance with the scale 1 40 calculated by three dimensional conversion method with a scale 1 40 the term er2 represent the relative errors between r40 2 and r40 and er3 represent the relative errors between r40 3 and r40 there are some errors in the results of the two dimensional and three dimensional conversion methods the error in the two dimensional conversion method is obviously larger than that of the three dimensional conversion method and the error in the m2 model with the moonpool structure is obviously larger than that of the m1 model without the moonpool structure the error in the three dimensional conversion method is 5 448 for the conversion to real scale the error may be even larger for the two dimensional conversion method the ship resistance is divided into the frictional resistance related to reynolds number and the residuary resistance related to froude number the ship frictional resistance is calculated by equivalent plate theory and the total resistance is then obtained by adding the residuary resistance for the ship with moonpool this method ignores the force of moonpool which is also affected by reynolds number and thus the resistance after conversion is obviously low and the error is large for the three dimensional conversion method the ship resistance is divided into the frictional resistance the viscous resistance related to reynolds number and the wave making resistance related to froude number the ratio of viscous resistance to frictional resistance is considered to be a constant for ships with moonpool this method converts the moonpool resistance to viscous resistance having said that from the perspective of the result of section 4 2 we can see that moonpool and hull are not independent of each other and the structure of the moonpool has an impact on hull the relationship between the moonpool resistance and hull frictional resistance is not a simple linear relationship thus the error is lower than the two dimensional conversion method and that for the three dimensional conversion method results is lower than cfd results in general the use of traditional methods for resistance conversion for the ship with the moonpool will result in a large error we will continue to pay attention to the conversion method for the ship with the moonpool and in hope that can eventually achieve an accurate moonpool resistance conversion 5 results and discussion of the unsteady flow field calculation 5 1 unsteady calculation method steady calculation involves time homogenization of the flow field and the calculation results can intuitively reflect the overall situation of the flow field including the force and vortex distribution however to obtain the change rule of the flow field with time the transient state must be used and unsteady calculations are carried out in accordance with the time step in this study the steady calculation results are taken as the initial conditions of the flow field and then the unsteady calculation function of star ccm was used to carry out the implicit unsteady calculation of the flow field the unsteady solution is calculated with a time step of 0 01s 100 hz and the unsteady flow field data under various working conditions were obtained 5 2 analysis and discussion of unsteady settlement results fig 12 shows the spectrum analysis curve of the model forces in which a c and e are the spectrum graphs of the total resistance hull force and moonpool force when fr 0 098 b d and f are the spectrum graphs of the total resistance hull force and moonpool force when fr 0 163 in the figure the upper time domain graph is the change curve of the force with time the abscissa represents the time and the ordinate represents the difference between the instantaneous force and average value δ r the formula δ r r t r r t calculates the resistance at a certain moment in the frequency domain diagram shown in fig 12 the abscissa is the frequency of force fluctuation and the ordinate is the amplitude corresponding to the frequency as shown in fig 12 regardless of the total resistance hull resistance and moonpool resistance as time changes and continues to fluctuate the moonpool resistance fluctuation amplitude is greater than the fluctuation amplitude of the hull resistance the moonpool resistance in f r 0 098 fluctuating frequency amplitude is greater than the hull resistance fluctuation frequency amplitude and is approximately 100 when f r 0 163 moonpool resistance fluctuating frequency amplitude is greater than the hull resistance fluctuation frequency amplitude and is approximately 730 from total resistance frequency domain graph and moonpool domain graph two curves can be observed that they are similar with frequency or amplitude it can be seen that the fluctuation of the moonpool resistance plays a dominant role in the fluctuation of the ship s resistance during the smooth water navigation fig 13 shows the flow field of the moonpool in a fluctuating period when fr 0 163 the section is the middle longitudinal section of the ship the right side of the figure is the bow direction and the water flows from right to left the lines in the figure are streamlines in the flow field and the coloured bars represent the vorticity field the time of each figure corresponds to the mark in fig 12 f at the time t 0t fig 13 a there is a large scale vortex behind the moonpool occupying approximately 2 3 of the space of the flow field of the moonpool at this time there is no vortex in front of the moonpool but the streamlines can be seen in the leading edge showing a tendency to form vortices at the time t 1 6 fig 13 b the original vortex moves backward along with the coming flow a small part of the original vortex in the bottom of the moonpool flow out of the moonpool with the coming flow making the vortex smaller the remaining parts of the original vortex stay within the moonpool because of the wall of the moonpool at the same time the leading edge of the moonpool has created a new vortex that is smaller than the original vortex in the process from t 1 6t fig 13 b to t 1 2 t fig 13 d the vortex formed by the leading edge constantly moves backwards at the moment t 1 2 t the two vortices merge to form a new vortex occupying approximately 3 4 of the space of the moonpool flow field in the process from t 1 2t fig 13 d to t 5 6t fig 13 f the vortex keeps moving backwards at the same time due to the flow at the bottom of the moonpool a small part of the vortex flows through the trailing edge of the moonpool to the aft of the ship which reduces the size of the vortex to some extent after t 5 6t the flow field returns to t 0t thus forming a complete cycle of change it can be seen that the main cause of the fluctuation in the moonpool is the regular shedding of fluid in the front edge of the moonpool the fluid particles move from the front of the moonpool along the bottom to the stern when they reach the front edge of the moonpool the pressure changes dramatically owing to the sudden change in the shape of the wall under the action of strong friction the velocity of the fluid particles decreases to zero and the flow reverses under the action of pressure and the boundary layer is thickened the backflow eventually forms a vortex and the size of the vortex continues to increase the vortex disintegrates and moves backward with the current this is similar to the typical flow around a blunt body in essence the adverse pressure gradient region in the flow field leads to the detachment of the boundary layer and periodic shedding vortices are generated therefore many rules of moonpool flow are similar to the flow around a blunt body as can be seen from fig 12 the fluctuation when f r 0 098 presents an irregular state while the fluctuation when f r 0 163 is a regular state fluctuating in accordance with a single frequency referring to problems of flows around circular cylinder when the flow field is in transition the flow field is in an unstable state and there is no obvious regular vortex however when the flow field is in complete turbulence the amplitude field of the flow frequency fluctuation becomes stable and the regular vortex street is re established klebanoff et al 1962 these phenomena were consistent with previous estimations of the flow pattern fig 14 shows the main frequency fluctuation strouhal number curve and the main frequency fluctuation amplitude curve of each working condition the formula of strauhal number is as follows 12 s t f l v used to characterize the fluctuation frequency of flow from the observation of the two curves it can be seen that when f r 0 077 0 098 the amplitude of the main frequency fluctuation is extremely low and there is no regular vortex street when f r 0 141 0 184 regular vortex streets are established and the amplitude of both the strauhal number and the dominant frequency increase linearly with the increase in froude number reynolds number when f r 0 120 the fluctuation amplitude of the dominant frequency increases sharply and there are obvious regular vortices whereas when f r 0 120 it decreases suddenly because of the resonance phenomenon that occurs at f r 0 120 when f r 0 120 the strouhal number of its dominant frequency fluctuation is 4 353 whereas according to fukudade s equation fukda 1977 13 t 2 π d 0 41 s g the strouhal number of natural frequency is 4 768 when f r 0 120 it can be seen that the main frequency of the moonpool vortex street in this working condition is close to the natural frequency of the moonpool structure resulting in a significant increase in amplitude and resonance this is another problem that should be paid attention to in the actual project piston and sloshing in the moonpool should also be analysed due to their adverse effects on the equipment and structure the piston phenomenon occurs when the fluid oscillates violently up and down in the vertical direction which is similar to the movement of a piston in an engine cylinder it is essentially a periodic change in the volume of the fluid in the moonpool which was monitored to analyse the piston motion fig 15 shows the curve and spectrum of the fluid volume change in the moonpool with time when f r 0 163 the fluid volume change is the difference between the fluid volume in the moonpool at the current moment and the fluid volume in smooth water where δ v v t v v t is the fluid volume in the moonpool at a certain moment and v is the fluid volume in the moonpool in smooth water as shown in fig 15 the fluid volume in the moonpool fluctuated regularly over time and the frequency of fluctuation was the same as the stress frequency fig 12 f therefore it can be inferred that the vortex street that regularly breaks off the leading edge of the moonpool is the dominant factor of the fluid volume change in the moonpool and the volume in the moonpool changes with the evolution of the vortex street as shown in the figure corresponds to fig 12 f and fig 13 it can be inferred that the phase of the volume fluctuation is not consistent with that of the force fluctuation with a difference of approximately one sixth of a cycle the minimum value of the volume corresponds to t 5 6 t fig 13 f when the two vortices have completely fused and developed to the last dimension and the maximum volume corresponds to t 1 3 t fig 13 c when the vortex at the front edge of the moonpool has completely broken off and starts to merge with the vortex at the rear it can be further verified using δ v which is negative indicating that the volume of fluid in the moonpool after flowing is smaller than that in smooth water this is because when the fluid flows the pressure on the horizontal surface at the bottom of the moonpool decreases resulting in an overall decline in the water plane in the moonpool the sloshing phenomenon occurs when the free surface of the fluid in the moonpool oscillates violently from side to side along the horizontal direction similar to the sloshing movement of the liquid in the water tank as shown in fig 13 the free surface is with the rule of shedding vortex street moonpool front and volatility mainly with the spiral movement change free liquid surface so you can see as the vortex shedding and backward movement free liquid surface in the moonpool of cyclical fluctuations in the rear both the piston and sloshing phenomenon are major causes the continuous flow and vortex shedding the pool with a month of ship caused by their own heave movement when still piston and sloshing formation mechanism is different fukda 1977 molin 2001 so the phenomenon is also different especially the hydrostatic sailing sloshing phenomenon occurs only in pool at the back of the month as a result of free fluid in the face of the impact of the moonpool also occurred after the moonpool wall the pool with a month before and after the ship sloshing when still flow impact is different 6 conclusion to investigate the influence of the flow pattern of the flow field on the resistance of the ship with the moonpool during smooth water navigation and the characteristics of the flow in the moonpool during navigation a ship model with a moonpool was calculated and studied using the star ccm software the results can be summarized as follows 1 the cfd results are consistent with the test data which verifies the applicability of this method in analysing the resistance of ships with moonpool 2 the flow field of the flow pattern of the moonpool demonstrates a great influence on the ship s resistance when the flow field is in the process of transitioning to the turbulent state the resistance ratio size of the moonpool ship wave vorticity distribution and flow fluctuation characteristics have significant nonlinear changes therefore it is necessary to identify the flow pattern of the moonpool to perform the analysis of the ship s resistance 3 in the process of smooth water navigation the moonpool and the hull are not independent of each other which means that the flow in the moonpool has an influence on the resistance of the hull and wave generation therefore when investigating the effect of the moonpool on ships smooth water navigation it is necessary not only focus on the moonpool itself 4 using the two dimensional and three dimensional conversion methods for resistance conversion for the ship with the moonpool will lead to a large error we will continue to pay attention to the conversion method for the ship with the moonpool and hope that accuracy will improve with the moonpool resistance conversion method eventually 5 in the smooth water navigation the dominant factor of the moonpool resistance and the fluctuation of the flow field is the continuous shedding of the vortex street at the front of the moonpool the constant shedding of the vortex leads to the periodic fluctuations of the force on the moonpool as well as the occurrence of pistons and sloshing the research on the suppression of the moonpool resistance should focus on the control of the vortex 6 despite the continuous flow and vortex shedding reynolds number demonstrates its influence on both the steady and unsteady data that were gathered in the pool it was concluded that the ship s resistance should not be ignored in the study and to accurately predict the performance of the model tests with respect to the resistance the current model of the moonpool should be used than to adjust the experimental method credit authorship contribution statement xiuyuan zhang conceptualization methodology validation liping sun supervision cong sun writing review editing chao wang formal analysis data curation cheng chen formal analysis data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the present work was supported by the national natural science foundation of china grant no 51679052 and the high tech ship research project of miit grant no 2017 614 
20329,to investigate the influence of the flow pattern of the flow field on the resistance of a ship with a moonpool and the characteristics of the flow in the moonpool during smooth water navigation the star ccm software was used the calculation results were verified by the experimental data of the pool showing that the flow pattern of the moonpool has a great influence on the resistance performance of the ship with the moonpool the force and the flow field of the moonpool have a great nonlinear change in the process from transition state to turbulence state the flow in the moonpool also affects the forces on the hull the main factors of the resistance of the moonpool and the fluctuation of the flow field are the constant shedding of the vortex street at the front of the moonpool which causes the periodic change of the resistance of the moonpool and the phenomena of piston and sloshing the reynolds number is the key similarity number that determines the characteristics of the moonpool flow field and determines the flow pattern and vortex shedding law keywords moonpool smooth water resistance flow regime reynolds number 1 introduction moonpool is a vertical opening in the hull located near the mid ship that is frequently found in drilling ships and diving support vessels which offers protection from the environment during the retraction and discharge of several tools and vehicles into the water however since the increase of free liquid level and the decrease of profile smoothnessthe moonpool resulting from the setup of moonpool the resistance and seakeeping performance of the ship with moonpool are adversely affected the typical movements of the fluid in the moonpool include the vertical motion of the water column piston mode and the water movement in the longitudinal direction sloshing mode the movement of the vortex the rolling and breaking of the free surface and the vibration of the waves on the deck and hull may occur in the meantime several previous studies have focused on the influence of the moonpool on the ship s motion when the ship operates at zero speed in waves using various approaches such as experimental studies model tests theoretical studies and numerical simulations aalbers et al aalbers 1984 investigated the hydrodynamics of the moonpool and established a mathematical model that describes the relative water movement in the moonpool they obtained the empirical results with respect to the influence of the damping mechanisms and behaviour of the water column motion in contrast fukuda et al fukda 1977 studied the behaviour of the fluid in the moonpool and its effects on the motion of the ship through model tests under certain sets of conditions which were summarized as piston and sloshing motions moreover they have summarized the empirical equations of the natural period and amplitude of the moonpool oscillation molin et al molin 2001 used the linearized potential flow theory to derive the theoretical formulas for the natural frequencies of the piston modes and the sloth modes of the moonpool in two and three dimensions ravinthrakumar et al 2020 found out that the hydrodynamic coupling of the ship and the moonpool is highly dependent to the moonpool s volume relative to the submerged ship s volume using experimental studies and numerical calculations of the moonpool at different scales ommani et al 2018 used a finite volume solver with linearized boundary conditions to obtain the moonpool response under forced vertical motion in contrast it is also important to consider the influence of the fluid movement in the tank on the navigation resistance performance of the ship in the sailing state many scholars have studied the increase of the resistance caused by the lunar tank through model tests and numerical methods gatski et al gatski and speziale 1993 proposed an explicit algebraic stress model easm to simulate the free surface around the hull and proposed that the water movement in the moonpool would cause resonance when it reached the natural frequency ahmed et al ahmed and soares 2009 used potential flow and viscous flow finite volume methods to simulate the free surface flow of vlcc hull morphology and compared them with the existing results the geometry of the moonpool is one of the important parameters for the formation of the vortex hammargren et al törnblom and hammargren 2012 used open source software openfoam to simplify and simulate three dimensional flows with two dimensional flows and calculate the drag of the drillship with step moonpool huang et al 2016 used the computational fluid dynamics cfd software to calculate the resistance of the moonpool ship and provided some reference for the design of the moonpool through the analysis of the results van veer et al van t veer and tholen 2008 proposed an assumption that a linear relationship between the amplitude of the moonpool oscillation and the increase of the resistance exists based on the assumption and revealed experimental data a prediction model for the additional resistance of the moonpool in the piston and sloping oscillation modes was proposed it is necessary to improve the type of the lunar tank to reduce the increase of the resistance because the installation of the lunar tank worsens the resistance performance of the ship hendriks et al 2018 proposed the method of setting a cavity in front of the moonpool to slow down the flow and reduce the flow resistance of ships during navigation yang et al 2019 put forward the method of setting the inclined front wall of the moonpool and setting the concave structure behind the moonpool to reduce the resistance of ships during navigation sivabalan et al ponnappan et al 2018 calculated the flow field of the moonpool with different cross section forms through cfd and obtained the relationship between the resonance frequency of the moonpool and the shape of the moonpool in practical engineering practice the change of flow pattern especially the fluid change of model scale flow field is very common in the past studies although some conclusions have been obtained for the static water navigation resistance of ships with moonpool there are few studies on the influence of the flow regime on the resistance performance and flow characteristics of the moonpool however the influence of reynolds number on the moonpool resistance and flow characteristics is seldom studied because froude number is generally used in ship resistance experiments to plan the working conditions in this paper star ccm software is used to simulate the smooth water navigation process of the moonpool ship including steady calculation and unsteady calculation the influence of the moonpool on the ship resistance performance is obtained by analysing the resistance components and the relationship between the flow pattern of the flow field and the moonpool resistance increase is obtained by analysing the flow field data the fluctuation law of each phenomenon of moonpool flow is obtained through spectrum analysis of the time variation of flow field data finally the conclusion of this paper is summarized and the prospect of future research is proposed 2 introduction of models and working conditions the model used in this study is a deep sea drillship model with a moonpool in the middle as shown in fig 1 the dimensional parameters of the model are listed in table 1 in which l b is the ratio of the length and width of the model cb is the block coefficient cwp is the midship section coefficient lm is the length of the moonpool bm is the width of moonpool lfm is the length between the fore perpendicular and moonpool and lpp is the distance between the fore perpendicular and after perpendicular in this study we used the model with scale 1 60 both the experiments and calculations of the model are carried out according to the same froude number with equal spacing as the real ship working condition the specific working condition setting is shown in table 2 the equation of froude number f r is 1 f r v g l where v is the incoming flow velocity g is the gravitational acceleration and l is the characteristic length two models were used for the experiment and analysis in this study to study the influence of the moonpool structure on the ship s navigation the first model is named m1 which does not have a moonpool structure but has a completely closed hull and the second one is named m2 which has both the moonpool structure and a completely closed hull 3 numerical model and meshing 3 1 numerical model in this study the separation flow solver star ccm which is based on the finite volume method is used to simulate and analyse the static water navigation performance of the ship with moonpool the governing equation is solved by coupling based on pressure in which the convection term is spatially discretized using the second order upwind scheme and the dissipation term is spatially discretized using the second order central difference scheme the motion of an incompressible newtonian fluid satisfies the continuity equation and momentum conservation equation weiss and smith 1995 choi and sung 2009 2 ρ t ρ u i x i 0 3 ρ u i t x j ρ u i u j p x i x j μ u i x j ρ u i u j s j where u i is the time average of the velocity component i i a 1 2 3 u j is the time average of the velocity components j j 1 2 3 p is the time average of the pressure ρ is the fluid density μ is the dynamic viscosity coefficient ρ u i u j is the reynolds stress term and s j is the generalized source term of the momentum equation equations 2 and 3 are combined with the k ε turbulence model which is commonly used in simulating the flow characteristics of turbulent flow conditions in this study the volume of fluid vof method was used to capture the change in the water free surface hirt and nichols 1981 in which v is the designed calculation area v 1 is the volume of fluid 1 and v 2 is the volume of fluid 2 4 α x t δ 1 x v 1 δ 0 x v 2 for the flow field composed of two incompatible fluids α x t is satisfied by eq 5 in which 5 α t u α 0 where u u v w is the velocity field of the fluid moreover the vof function c i j k is defined as the integral of α x t on the grid cell divided by the cell volume 6 c i j k 1 δ v i j k i i j k α x t d v and meet 7 c t u c 0 using eq 7 when c 1 the grid is filled with fluid 1 when c 0 the mesh does not contain fluid 1 and when 0 c 1 the grid contains a free liquid level 3 2 establishment of the computing domain and partition of volume grid the drillship model employed in this study and the hull model were symmetrical to each other in the middle longitudinal section therefore the half ship was selected as the research object in the calculation domain the range of the calculation domain in the axial direction was 2 0 x 3 0 lpp the range of the calculation domain in the spanwise direction was 0 0 y 2 lpp and the range of the calculation domain in the vertical direction was 2 5 z 1 0 lpp see fig 2 for the diagram of the computing domain and its boundary in this study the mesh topology and refinement region of both the m1 and m2 are the same the star ccm software which was set in the meshing model of the drilling ship model for the surface remesher operation of the ship surface grid was used for all grid generation the surface remesher was used for the processing and generating of the surface triangulation of a high quality surface grid when the grid was ready the prism layer mesh was used in capturing the boundary layer on the surface of the model in which the y values of the surface is in the 30 to 60 range corresponding to the thickness of the first layer of the grid which is in the range of 0 8 1 mm castro et al 2011 when dividing the volume grid more grids are allocated in areas with a large flow field variation in addition the cfd mesh can be encrypted in different forms through different shaped volume control areas fig 3 shows the schematic of the different refinements in different areas of the drillship the hull refinement body is composed of four enciphers nearest near and far in contrast the surface refinement body consists of four enciphers coarse medium thin and finest meanwhile the kelvin wave refinement body consists of two enciphers far field and near field and the moonpool refinement bow refinement and stern refinement consist of a single encipher table 3 shows the proportion of the number of grids in each region the grids in all regions have overlapping parts fig 4 shows the distribution of the generated grid in the middle and longitudinal sections according to ittc recommendations a minimum of 20 grid points should be used in the vertical direction where the free surface is expected recommended procedu 2011a in this study approximately 30 40 grid points are present in the vertical direction of the wave position through the form of an encrypted grid in the free surface and the dissipation of wave height should be controlled 3 3 comparisons between the cfd results and test data on the model scale the finer the grid size is the more accurate the result is however the calculation time increases because of the large number of grid cells to be assessed therefore to determine the mesh size and mesh number with acceptable numerical accuracy the m2 model s f r 0 142 condition was selected to study the mesh convergence and the four grid schemes are based on improved proportions 2 celik et al 2008 the total number of grids and the calculated errors for each grid scheme are presented in table 4 and fig 5 the error is defined as r r t r t 100 where r is the total resistance of the model obtained by numerical calculation and r t is the total resistance obtained experimentally the measurements on this deep sea drillship model were provided by the marine design and research institute of china maric as shown in fig 5 further refinement for grids at grid3 results in a large increase in the number of cells resulting to the increase in the needed calculation time moreover it is apparent that there is no significant difference between schemes 3 and 4 therefore we have chosen grid3 as the optimal grid scheme 4 results and discussion of the stationary calculation 4 1 accuracy analysis of the steady resistance fig 6 a and b show the comparison of experimental and numerical calculation results for m1 and m2 models respectively in which the abscissa represents the froude number of the simulated working condition the blue curve represents the total resistance value of the model calculated numerically the red curve represents the total resistance value of the model tested in the pool with its corresponding ordinate shown on the left side and the green curve represents the relative error between the numerical calculated value and the experimental value of the pool with its corresponding ordinate shown on the right side as can be seen in the figure the resistance of the model increases as the froude number increases while the relative error between the numerically calculated value and the experimental value of the pool remains within a certain range among which the relative error of the m1 model is no more than 2 2 and that of the m2 model is no more than 4 1 therefore it can be considered that the numerical calculation results obtained from the numerical model and the meshing strategy are accurate 4 2 steady resistance data analysis fig 7 shows the comparison of the total resistance obtained between the m1 and m2 models in which the abscissa represents the froude number of the simulated working condition the red bar represents the total resistance of the m1 model the blue bar represents the total resistance of the m2 model with its corresponding ordinate shown on the left side and the green curve represents the increase in the drag ratio of the moonpool that is the percentage of drag increase of the moonpool model compared with that of the non moonpool model the equation is rm2 rm1 rm1 100 and the vertical coordinate corresponding to it is expressed on the right side as shown in fig 7 the total resistance of the ship model significantly increased after the moonpool structure was set when f r 0 077 the increase in the moonpool resistance is very small only 3 4 however when f r 0 098 the moonpool resistance significantly increased to 29 6 moreover it is worth noting that when the froude number is increased to 0 142 there is a negligible increase in the moonpool resistance and remained at approximately 30 however when f r 0 142 the moonpool resistance increased continuously resulting to an increase in the curvature of the curve and the ratio of the moonpool resistance in the cfd calculation the force of the hull and the moonpool structure can be monitored separately to analyse the influence of the moonpool on the resistance fig 8 compares the hull resistance of the drillship model with the moonpool resistance and the total resistance of m1 the abscissa represents the froude number of the simulated working condition the red bar represents the hull force of the m2 model the blue bar represents the moonpool force of the m2 model and the purple bar represents the total resistance value of the m1 model and its corresponding ordinate is expressed on the left side and the green curve represents the proportion of the moonpool force in the m2 total resistance the formula is rm rm2 100 where rm represents the moonpool resistance and the vertical coordinate corresponding to it is expressed on the right side as shown in fig 8 when the froude number increases from 0 077 to 0 120 the proportion of moonpool stress continues to increase reaching up to 38 6 in contrast when f r was increased from 0 120 to 0 142 the moonpool stress ratio dramatically decreased from 38 6 to 17 9 however when f r 0 142 the moonpool stress ratio continued to increase from 17 9 to 26 4 when f r 0 184 which was only slightly higher than the moonpool stress ratio 23 2 when f r 0 077 meanwhile the comparison between the hull force of the m2 model and the total resistance of the m1 model can also be seen in fig 8 because of the moonpool structure set at the bottom of the ship the lacking of bottom brings a wetted surface reduction to m2 the wetted surface difference between m1 and m2 is floor area of moonpool since it is at the bottom of the ship the bottom plate is only subject to the frictional resistance caused by fluid movement if the moonpool and the hull force are independent of each other since the setting of the moonpool structure has no effect on the hull force the hull force of the m2 model should be slightly smaller than the total resistance of the m1 model and only differs from the frictional resistance of the moonpool mouth as shown in fig 8 however this assumption is not met when the froude number increases from 0 077 to 0 120 the total resistance of the m1 model is slightly larger than that of the m2 model while the total resistance of the m1 model is slightly smaller than that of the m2 model when the froude number increases from 0 142 to 0 184 therefore the moonpool and force on the hull are not independent of each other and the setting of the moonpool structure has an impact on the force on the hull 4 3 steady flow field analysis and discussion as shown in figs 7 and 8 regardless of the increase in the ratio of the moonpool resistance the proportion of the moonpool force and the comparison between the total resistance of the m1 model and the hull force of the m2 model do not change linearly with the froude number there is one rule however when f r 0 077 0 120 and another when f r 0 141 0 184 the steady flow field is analysed below to explain this phenomenon fig 9 shows the wave making diagram of free liquid surface under various working conditions the upper part of each diagram is the wave making diagram of m1 and the lower part is the wave making diagram of m2 it can be seen that both m1 and m2 generate waves in the bow and the waves are at a kelvin angle with the direction of travel careful observation shows that when f r 0 077 0 120 the wave formation of m1 and m2 is consistent in the front part but inconsistent in the back part which is bounded by a straight line with the kelvin angle as the angle at the beginning of leading edge of the moonpool represented by the red dotted line in the figure the wave making of m1 is significantly different from that of m2 the wave making of the latter part of m2 almost disappears and no longer appears regular wave making when f r 0 141 0 184 the wave making of m1 and m2 is consistent in the anterior and posterior parts thus it can be seen that the flow in the moonpool will have an influence on the ship s wave making and the influence is significant when f r 0 077 0 120 which is consistent with the rule obtained from the resistance curve namely the flow state is different between f r 0 077 0 120 and f r 0 141 0 184 fig 10 shows the vorticity distribution at the bottom of the ship under various working conditions in the figure the middle longitudinal section is taken as the boundary and the calculated results of m1 and m2 are placed on both sides of the middle longitudinal section respectively for visual comparison the upper left part of the figure is the calculated results of m2 and the lower right part is the calculated results of m1 in the figure blue grey and white represents the free liquid surface the hull and the vortex defined by q criterion respectively the formula of q criterion is as follows 10 q 1 2 b f 2 a f 2 fig 9 also shows the isosurface of q at 10s 2 as shown in fig 10 the vorticity distribution of m1 is relatively small under each working condition which mainly consists of bilge vorticity wake vorticity and vorticity of the raised part of the hull shape the vorticity distribution of m2 is different owing to the influence of the structure of the moonpool a large number of vortexes were generated after the water passed through the moonpool and covered the hull hind by observing f r 0 077 0 120 it can be seen that vortexes flow out of the rear of the moonpool and cover the hull surface along a straight line with an angle of kelvin represented by the red dotted line in the figure these vortexes flowing out of the moonpool have a large range covering the entire hull behind and the intersection of the hull and the liquid level thus affecting the wave formation when f r 0 141 0 184 we can see that although the vortex also covers the rear of the hull the scope is obviously small it no longer covers the surface of the hull but partly covers the surface of the hull in the form of fine vortexes in addition the scope of the vortex at the intersection of the hull and the liquid level was small and its influence on wave formation was limited it can be seen from the results that the m2 model presents two different states in f r 0 077 0 120 and f r 0 141 0 184 in fluid mechanics there are two distinct states of fluid movement namely laminar flow and turbulence which can be transformed into each other from layer to turbulence transition by observing the flow field performance of the m2 model it can be seen that the entire flow field is relatively stable in the range of f r 0 141 0 184 and only slightly differs from that of m1 moreover with the increase in froude number the properties of the flow field follow a linear monotone rule however the m2 model is chaotic when f r 0 077 0 120 and its influence on the resistance and wave generation is greater than that between f r 0 141 0 184 during the transition from f r 0 077 0 120 to f r 0 141 0 184 the flow field morphology changed significantly therefore it can be concluded that the flow field is in a stable turbulent state when f r 0 141 0 184 in the range of f r 0 077 0 120 the flow field is in an unstable transition state to verify this point we examined the section near the wall of the bottom of the ship and observed the velocity cloud map at this interface as shown in fig 11 the colours in the figure represent the combined velocity near the wall of the bottom of the ship the right side is the bow direction and the water flows from right to left as can be seen from the figure the velocity distribution near the bottom of the ship is not uniform in the range of f r 0 077 0 120 and some local velocity extreme areas appear in front of the moonpool which is a turbulent spot structure the formation of turbulent patches indicates the transition state of flow field kachanov 1994 klebanoff et al 1962 with the increase in the froude number the turbulent spot structures mix with each other and eventually disappear and the velocity distribution tends to average the unevenness of the hull s transverse direction the longitudinal direction in the figure in the flow field is due to the influence of the hull s shape the whole process is a typical boundary layer transition on a plate which can confirm the correctness of the flow pattern of the flow field referring to problems of flows around a circular cylinder when entering the turbulent state the resistance coefficient of the object suddenly decreases to the minimum value and then continues to increase with an increase in the reynolds number this can explain the sudden change in the proportion curve of the moonpool force in fig 8 schlichting 1991 in the study of fluid flow state reynolds number is generally used to analyse and estimate the flow state when the reynolds number of flow field is less than the lower critical reynolds number the flow field is laminar when the reynolds number of the flow field is greater than the upper critical reynolds number the flow field is turbulent when the reynolds number of the flow field is between the lower critical reynolds number and the upper critical reynolds number the flow field is in a transition state the formula of reynolds number is 11 r e v l v the reynolds numbers corresponding to the working conditions in this study are listed in table 5 in this study the average interval froude number is used to set up the working condition because it belongs to the research of ship resistance in the case of the same scale both the froude number and reynolds number have a linear relationship with the inflow velocity therefore each working condition in this study also varies with the reynolds number of the average interval the reynolds number increases linearly with the increase in froude number and the flow field changes with the increase in reynolds number which is consistent with the research results of fluid flow pattern it can be inferred that reynolds number is a dimensionless number that determines the flow state and determines the state of the flow field and the resistance performance of the moonpool ship model of smooth water navigation in this study the lower critical reynolds number is less than 1 75 106 and the upper critical reynolds number is between 2 75 106 and 3 25 106 when f r 0 077 0 120 the reynolds number of the flow field is between the lower critical reynolds number and the upper critical reynolds number and is in the transition state when f r 0 141 0 184 the reynolds number of the flow field is greater than the upper critical reynolds number and it is in a turbulent state 4 4 size effects discussion because of the high cost of actual ship construction recent studies on ship resistance generally adopt the water tank test method or a numerical test of the ship model with a certain scale and the conversion of real ship resistance however because the exact similarity between the ship model and the real ship is not guaranteed the size effect will exist in the conversion process currently both the two dimensional conversion method based on froude s viewpoint and the three dimensional conversion method based on hughes s viewpoint require the same froude number for model ship and real ship recommended procedu 2011b therefore the research in this paper is also based on the same froude number in the above study it is concluded that reynolds number is similar to the number that plays a decisive role in the increase of the resistance of the moonpool structure if the scale conversion is carried out the size effect caused by viscosity will inevitably exist thus the feasibility of the two dimensional and three dimensional conversion methods is worth discussing we use the same mesh division method to carry out cfd calculation for m1 and m2 models with scale 1 40 and fr 0 163 at the same time the two dimensional and three dimensional conversion methods were used to convert the resistance of the model with scale 1 60 to a model with scale 1 40 and then compared with the cfd results the form factor of the three dimensional conversion method is obtained by prohaska method recommended procedu 2011b table 6 shows the comparison of the calculated data of the two scaling ratios here r60 represents the total resistance calculated by cfd with the scale 1 60 r40 represents the total resistance calculated by cfd with the scale 1 60 r40 2 represents the total resistance calculated by two dimensional conversion method with a scale 1 40 r40 3 represents the total resistance with the scale 1 40 calculated by three dimensional conversion method with a scale 1 40 the term er2 represent the relative errors between r40 2 and r40 and er3 represent the relative errors between r40 3 and r40 there are some errors in the results of the two dimensional and three dimensional conversion methods the error in the two dimensional conversion method is obviously larger than that of the three dimensional conversion method and the error in the m2 model with the moonpool structure is obviously larger than that of the m1 model without the moonpool structure the error in the three dimensional conversion method is 5 448 for the conversion to real scale the error may be even larger for the two dimensional conversion method the ship resistance is divided into the frictional resistance related to reynolds number and the residuary resistance related to froude number the ship frictional resistance is calculated by equivalent plate theory and the total resistance is then obtained by adding the residuary resistance for the ship with moonpool this method ignores the force of moonpool which is also affected by reynolds number and thus the resistance after conversion is obviously low and the error is large for the three dimensional conversion method the ship resistance is divided into the frictional resistance the viscous resistance related to reynolds number and the wave making resistance related to froude number the ratio of viscous resistance to frictional resistance is considered to be a constant for ships with moonpool this method converts the moonpool resistance to viscous resistance having said that from the perspective of the result of section 4 2 we can see that moonpool and hull are not independent of each other and the structure of the moonpool has an impact on hull the relationship between the moonpool resistance and hull frictional resistance is not a simple linear relationship thus the error is lower than the two dimensional conversion method and that for the three dimensional conversion method results is lower than cfd results in general the use of traditional methods for resistance conversion for the ship with the moonpool will result in a large error we will continue to pay attention to the conversion method for the ship with the moonpool and in hope that can eventually achieve an accurate moonpool resistance conversion 5 results and discussion of the unsteady flow field calculation 5 1 unsteady calculation method steady calculation involves time homogenization of the flow field and the calculation results can intuitively reflect the overall situation of the flow field including the force and vortex distribution however to obtain the change rule of the flow field with time the transient state must be used and unsteady calculations are carried out in accordance with the time step in this study the steady calculation results are taken as the initial conditions of the flow field and then the unsteady calculation function of star ccm was used to carry out the implicit unsteady calculation of the flow field the unsteady solution is calculated with a time step of 0 01s 100 hz and the unsteady flow field data under various working conditions were obtained 5 2 analysis and discussion of unsteady settlement results fig 12 shows the spectrum analysis curve of the model forces in which a c and e are the spectrum graphs of the total resistance hull force and moonpool force when fr 0 098 b d and f are the spectrum graphs of the total resistance hull force and moonpool force when fr 0 163 in the figure the upper time domain graph is the change curve of the force with time the abscissa represents the time and the ordinate represents the difference between the instantaneous force and average value δ r the formula δ r r t r r t calculates the resistance at a certain moment in the frequency domain diagram shown in fig 12 the abscissa is the frequency of force fluctuation and the ordinate is the amplitude corresponding to the frequency as shown in fig 12 regardless of the total resistance hull resistance and moonpool resistance as time changes and continues to fluctuate the moonpool resistance fluctuation amplitude is greater than the fluctuation amplitude of the hull resistance the moonpool resistance in f r 0 098 fluctuating frequency amplitude is greater than the hull resistance fluctuation frequency amplitude and is approximately 100 when f r 0 163 moonpool resistance fluctuating frequency amplitude is greater than the hull resistance fluctuation frequency amplitude and is approximately 730 from total resistance frequency domain graph and moonpool domain graph two curves can be observed that they are similar with frequency or amplitude it can be seen that the fluctuation of the moonpool resistance plays a dominant role in the fluctuation of the ship s resistance during the smooth water navigation fig 13 shows the flow field of the moonpool in a fluctuating period when fr 0 163 the section is the middle longitudinal section of the ship the right side of the figure is the bow direction and the water flows from right to left the lines in the figure are streamlines in the flow field and the coloured bars represent the vorticity field the time of each figure corresponds to the mark in fig 12 f at the time t 0t fig 13 a there is a large scale vortex behind the moonpool occupying approximately 2 3 of the space of the flow field of the moonpool at this time there is no vortex in front of the moonpool but the streamlines can be seen in the leading edge showing a tendency to form vortices at the time t 1 6 fig 13 b the original vortex moves backward along with the coming flow a small part of the original vortex in the bottom of the moonpool flow out of the moonpool with the coming flow making the vortex smaller the remaining parts of the original vortex stay within the moonpool because of the wall of the moonpool at the same time the leading edge of the moonpool has created a new vortex that is smaller than the original vortex in the process from t 1 6t fig 13 b to t 1 2 t fig 13 d the vortex formed by the leading edge constantly moves backwards at the moment t 1 2 t the two vortices merge to form a new vortex occupying approximately 3 4 of the space of the moonpool flow field in the process from t 1 2t fig 13 d to t 5 6t fig 13 f the vortex keeps moving backwards at the same time due to the flow at the bottom of the moonpool a small part of the vortex flows through the trailing edge of the moonpool to the aft of the ship which reduces the size of the vortex to some extent after t 5 6t the flow field returns to t 0t thus forming a complete cycle of change it can be seen that the main cause of the fluctuation in the moonpool is the regular shedding of fluid in the front edge of the moonpool the fluid particles move from the front of the moonpool along the bottom to the stern when they reach the front edge of the moonpool the pressure changes dramatically owing to the sudden change in the shape of the wall under the action of strong friction the velocity of the fluid particles decreases to zero and the flow reverses under the action of pressure and the boundary layer is thickened the backflow eventually forms a vortex and the size of the vortex continues to increase the vortex disintegrates and moves backward with the current this is similar to the typical flow around a blunt body in essence the adverse pressure gradient region in the flow field leads to the detachment of the boundary layer and periodic shedding vortices are generated therefore many rules of moonpool flow are similar to the flow around a blunt body as can be seen from fig 12 the fluctuation when f r 0 098 presents an irregular state while the fluctuation when f r 0 163 is a regular state fluctuating in accordance with a single frequency referring to problems of flows around circular cylinder when the flow field is in transition the flow field is in an unstable state and there is no obvious regular vortex however when the flow field is in complete turbulence the amplitude field of the flow frequency fluctuation becomes stable and the regular vortex street is re established klebanoff et al 1962 these phenomena were consistent with previous estimations of the flow pattern fig 14 shows the main frequency fluctuation strouhal number curve and the main frequency fluctuation amplitude curve of each working condition the formula of strauhal number is as follows 12 s t f l v used to characterize the fluctuation frequency of flow from the observation of the two curves it can be seen that when f r 0 077 0 098 the amplitude of the main frequency fluctuation is extremely low and there is no regular vortex street when f r 0 141 0 184 regular vortex streets are established and the amplitude of both the strauhal number and the dominant frequency increase linearly with the increase in froude number reynolds number when f r 0 120 the fluctuation amplitude of the dominant frequency increases sharply and there are obvious regular vortices whereas when f r 0 120 it decreases suddenly because of the resonance phenomenon that occurs at f r 0 120 when f r 0 120 the strouhal number of its dominant frequency fluctuation is 4 353 whereas according to fukudade s equation fukda 1977 13 t 2 π d 0 41 s g the strouhal number of natural frequency is 4 768 when f r 0 120 it can be seen that the main frequency of the moonpool vortex street in this working condition is close to the natural frequency of the moonpool structure resulting in a significant increase in amplitude and resonance this is another problem that should be paid attention to in the actual project piston and sloshing in the moonpool should also be analysed due to their adverse effects on the equipment and structure the piston phenomenon occurs when the fluid oscillates violently up and down in the vertical direction which is similar to the movement of a piston in an engine cylinder it is essentially a periodic change in the volume of the fluid in the moonpool which was monitored to analyse the piston motion fig 15 shows the curve and spectrum of the fluid volume change in the moonpool with time when f r 0 163 the fluid volume change is the difference between the fluid volume in the moonpool at the current moment and the fluid volume in smooth water where δ v v t v v t is the fluid volume in the moonpool at a certain moment and v is the fluid volume in the moonpool in smooth water as shown in fig 15 the fluid volume in the moonpool fluctuated regularly over time and the frequency of fluctuation was the same as the stress frequency fig 12 f therefore it can be inferred that the vortex street that regularly breaks off the leading edge of the moonpool is the dominant factor of the fluid volume change in the moonpool and the volume in the moonpool changes with the evolution of the vortex street as shown in the figure corresponds to fig 12 f and fig 13 it can be inferred that the phase of the volume fluctuation is not consistent with that of the force fluctuation with a difference of approximately one sixth of a cycle the minimum value of the volume corresponds to t 5 6 t fig 13 f when the two vortices have completely fused and developed to the last dimension and the maximum volume corresponds to t 1 3 t fig 13 c when the vortex at the front edge of the moonpool has completely broken off and starts to merge with the vortex at the rear it can be further verified using δ v which is negative indicating that the volume of fluid in the moonpool after flowing is smaller than that in smooth water this is because when the fluid flows the pressure on the horizontal surface at the bottom of the moonpool decreases resulting in an overall decline in the water plane in the moonpool the sloshing phenomenon occurs when the free surface of the fluid in the moonpool oscillates violently from side to side along the horizontal direction similar to the sloshing movement of the liquid in the water tank as shown in fig 13 the free surface is with the rule of shedding vortex street moonpool front and volatility mainly with the spiral movement change free liquid surface so you can see as the vortex shedding and backward movement free liquid surface in the moonpool of cyclical fluctuations in the rear both the piston and sloshing phenomenon are major causes the continuous flow and vortex shedding the pool with a month of ship caused by their own heave movement when still piston and sloshing formation mechanism is different fukda 1977 molin 2001 so the phenomenon is also different especially the hydrostatic sailing sloshing phenomenon occurs only in pool at the back of the month as a result of free fluid in the face of the impact of the moonpool also occurred after the moonpool wall the pool with a month before and after the ship sloshing when still flow impact is different 6 conclusion to investigate the influence of the flow pattern of the flow field on the resistance of the ship with the moonpool during smooth water navigation and the characteristics of the flow in the moonpool during navigation a ship model with a moonpool was calculated and studied using the star ccm software the results can be summarized as follows 1 the cfd results are consistent with the test data which verifies the applicability of this method in analysing the resistance of ships with moonpool 2 the flow field of the flow pattern of the moonpool demonstrates a great influence on the ship s resistance when the flow field is in the process of transitioning to the turbulent state the resistance ratio size of the moonpool ship wave vorticity distribution and flow fluctuation characteristics have significant nonlinear changes therefore it is necessary to identify the flow pattern of the moonpool to perform the analysis of the ship s resistance 3 in the process of smooth water navigation the moonpool and the hull are not independent of each other which means that the flow in the moonpool has an influence on the resistance of the hull and wave generation therefore when investigating the effect of the moonpool on ships smooth water navigation it is necessary not only focus on the moonpool itself 4 using the two dimensional and three dimensional conversion methods for resistance conversion for the ship with the moonpool will lead to a large error we will continue to pay attention to the conversion method for the ship with the moonpool and hope that accuracy will improve with the moonpool resistance conversion method eventually 5 in the smooth water navigation the dominant factor of the moonpool resistance and the fluctuation of the flow field is the continuous shedding of the vortex street at the front of the moonpool the constant shedding of the vortex leads to the periodic fluctuations of the force on the moonpool as well as the occurrence of pistons and sloshing the research on the suppression of the moonpool resistance should focus on the control of the vortex 6 despite the continuous flow and vortex shedding reynolds number demonstrates its influence on both the steady and unsteady data that were gathered in the pool it was concluded that the ship s resistance should not be ignored in the study and to accurately predict the performance of the model tests with respect to the resistance the current model of the moonpool should be used than to adjust the experimental method credit authorship contribution statement xiuyuan zhang conceptualization methodology validation liping sun supervision cong sun writing review editing chao wang formal analysis data curation cheng chen formal analysis data curation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the present work was supported by the national natural science foundation of china grant no 51679052 and the high tech ship research project of miit grant no 2017 614 
